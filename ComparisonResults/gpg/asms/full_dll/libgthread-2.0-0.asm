;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	E2BBE0CD0DFC4C86DDC88FC950CCDA62
; Input	CRC32 :	572895C8

; File Name   :	C:\compspace\compare\gpg\dlls\full\libgthread-2.0-0.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	65C40000
; Section 1. (virtual address 00001000)
; Virtual size			: 000016B4 (   5812.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 65C41000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_65C41000	proc near		; DATA XREF: .CRT:65C4800Co

Size		= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	[esp+1Ch+Size],	80h ; Size
		call	malloc
		mov	ebx, eax
		mov	[esp+1Ch+Size],	eax
		call	sub_65C41820
		test	ebx, ebx
		mov	ds:dword_65C453AC, eax
		mov	ds:dword_65C453A8, eax
		mov	eax, 1
		jz	short loc_65C41035
		mov	dword ptr [ebx], 0
		xor	al, al

loc_65C41035:				; CODE XREF: sub_65C41000+2Bj
		add	esp, 18h
		pop	ebx
		retn
sub_65C41000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C41040	proc near		; CODE XREF: sub_65C41260+A0p
					; sub_65C41260+124p ...

dwMilliseconds	= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	ebx
		sub	esp, 14h
		mov	edx, [esp+1Ch+arg_4]
		test	edx, edx
		jnz	short loc_65C410C6
		mov	edx, ds:dword_65C45000
		xor	eax, eax
		test	edx, edx
		jle	short loc_65C410BE
		sub	edx, 1
		mov	ebx, ds:Sleep
		mov	ds:dword_65C45000, edx
		jmp	short loc_65C4107C
; ---------------------------------------------------------------------------
		align 10h

loc_65C41070:				; CODE XREF: sub_65C41040+5Dj
		mov	[esp+1Ch+dwMilliseconds], 3E8h ; dwMilliseconds
		call	ebx ; Sleep
		sub	esp, 4

loc_65C4107C:				; CODE XREF: sub_65C41040+28j
		mov	[esp+1Ch+var_14], 0
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+dwMilliseconds], offset dword_65C453B0
		call	sub_65C425D0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_65C41070
		mov	eax, ds:dword_65C453B4
		cmp	eax, 2
		jz	loc_65C41183
		mov	[esp+1Ch+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, 1

loc_65C410BE:				; CODE XREF: sub_65C41040+17j
					; sub_65C41040+8Ej
		add	esp, 14h
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_65C410C6:				; CODE XREF: sub_65C41040+Bj
		cmp	edx, 1
		mov	eax, 1
		jnz	short loc_65C410BE
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_65C410F5
; ---------------------------------------------------------------------------

loc_65C410E1:				; CODE XREF: sub_65C41040+D2j
		cmp	eax, ebx
		jz	loc_65C411F7
		mov	[esp+1Ch+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_65C410F5:				; CODE XREF: sub_65C41040+9Fj
		mov	[esp+1Ch+var_14], 0
		mov	[esp+1Ch+var_18], ebx
		mov	[esp+1Ch+dwMilliseconds], offset dword_65C453B0
		call	sub_65C425D0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_65C410E1
		xor	ebx, ebx

loc_65C41116:				; CODE XREF: sub_65C41040+1BCj
		mov	eax, ds:dword_65C453B4
		cmp	eax, 1
		jz	loc_65C41224
		mov	eax, ds:dword_65C453B4
		test	eax, eax
		jz	loc_65C41201

loc_65C41131:				; CODE XREF: sub_65C41040+1DFj
					; sub_65C41040+1F0j
		mov	eax, ds:dword_65C453B4
		cmp	eax, 1
		jz	loc_65C41235

loc_65C4113F:				; CODE XREF: sub_65C41040+213j
		test	ebx, ebx
		jnz	short loc_65C4114A
		lock xchg ebx, ds:dword_65C453B0

loc_65C4114A:				; CODE XREF: sub_65C41040+101j
		mov	eax, ds:off_65C4417C
		test	eax, eax
		jz	short loc_65C4116F
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], 2
		mov	[esp+1Ch+var_14], edx
		mov	edx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+dwMilliseconds], edx
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_65C4116F:				; CODE XREF: sub_65C41040+111j
		add	ds:dword_65C45000, 1
		add	esp, 14h
		mov	eax, 1
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_65C41183:				; CODE XREF: sub_65C41040+67j
		mov	eax, ds:dword_65C453AC
		mov	[esp+1Ch+dwMilliseconds], eax
		call	sub_65C41810
		test	eax, eax
		mov	ebx, eax
		jz	short loc_65C411D7
		mov	eax, ds:dword_65C453A8
		mov	[esp+1Ch+dwMilliseconds], eax
		call	sub_65C41810
		mov	esi, eax

loc_65C411A5:				; CODE XREF: sub_65C41040+170j
		sub	esi, 4
		cmp	ebx, esi
		ja	short loc_65C411BB

loc_65C411AC:				; CODE XREF: sub_65C41040+179j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_65C411A5
		sub	esi, 4
		call	eax
		cmp	ebx, esi
		jbe	short loc_65C411AC

loc_65C411BB:				; CODE XREF: sub_65C41040+16Aj
		mov	[esp+1Ch+dwMilliseconds], ebx ;	Memory
		call	free
		mov	ds:dword_65C453A8, 0
		mov	ds:dword_65C453AC, 0

loc_65C411D7:				; CODE XREF: sub_65C41040+154j
		mov	ds:dword_65C453B4, 0
		xor	eax, eax
		lock xchg eax, ds:dword_65C453B0
		add	esp, 14h
		mov	eax, 1
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_65C411F7:				; CODE XREF: sub_65C41040+A3j
		mov	ebx, 1
		jmp	loc_65C41116
; ---------------------------------------------------------------------------

loc_65C41201:				; CODE XREF: sub_65C41040+EBj
		mov	[esp+1Ch+var_18], offset dword_65C48010
		mov	[esp+1Ch+dwMilliseconds], offset dword_65C48008
		mov	ds:dword_65C453B4, 1
		call	_initterm
		jmp	loc_65C41131
; ---------------------------------------------------------------------------

loc_65C41224:				; CODE XREF: sub_65C41040+DEj
		mov	[esp+1Ch+dwMilliseconds], 1Fh
		call	_amsg_exit
		jmp	loc_65C41131
; ---------------------------------------------------------------------------

loc_65C41235:				; CODE XREF: sub_65C41040+F9j
		mov	[esp+1Ch+var_18], offset dword_65C48004
		mov	[esp+1Ch+dwMilliseconds], offset dword_65C48000
		call	_initterm
		mov	ds:dword_65C453B4, 2
		jmp	loc_65C4113F
sub_65C41040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C41260	proc near		; CODE XREF: DllEntryPoint+1Ep

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 2Ch
		test	edx, edx
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, eax
		mov	[esp+2Ch+var_C], esi
		mov	esi, edx
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, ecx
		mov	[esp+2Ch+var_8], edi
		mov	dword_65C43004,	edx
		jnz	loc_65C41314
		mov	eax, ds:dword_65C45000
		xor	edi, edi
		test	eax, eax
		jz	short loc_65C412B9
		call	sub_65C41AD0
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C425F0
		sub	esp, 0Ch
		mov	edi, eax

loc_65C412B0:				; CODE XREF: sub_65C41260+D8j
					; sub_65C41260+E1j ...
		cmp	esi, 3
		jz	short loc_65C412E0
		test	esi, esi
		jz	short loc_65C412E0

loc_65C412B9:				; CODE XREF: sub_65C41260+30j
					; sub_65C41260+B2j ...
		mov	eax, edi
		mov	ebx, [esp+2Ch+var_10]
		mov	dword_65C43004,	0FFFFFFFFh
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C412E0:				; CODE XREF: sub_65C41260+53j
					; sub_65C41260+57j
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C42600
		sub	esp, 0Ch
		mov	edi, eax
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C41040
		sub	esp, 0Ch
		test	eax, eax
		mov	eax, 0
		cmovz	edi, eax
		jmp	short loc_65C412B9
; ---------------------------------------------------------------------------

loc_65C41314:				; CODE XREF: sub_65C41260+21j
		call	sub_65C41AD0
		lea	eax, [esi-1]
		cmp	eax, 1
		jbe	short loc_65C41391

loc_65C41321:				; CODE XREF: sub_65C41260+19Aj
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C425F0
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jnz	loc_65C412B0
		cmp	esi, 1
		jnz	loc_65C412B0
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C425F0
		sub	esp, 0Ch
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C42600
		sub	esp, 0Ch
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C41040
		sub	esp, 0Ch
		jmp	loc_65C412B0
; ---------------------------------------------------------------------------

loc_65C41391:				; CODE XREF: sub_65C41260+BFj
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C41040
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jz	loc_65C412B9
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C42600
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jnz	short loc_65C413F0
		cmp	esi, 1
		jnz	loc_65C412B9
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C41040
		sub	esp, 0Ch
		jmp	loc_65C412B9
; ---------------------------------------------------------------------------
		align 10h

loc_65C413F0:				; CODE XREF: sub_65C41260+165j
		cmp	esi, 1
		jnz	short loc_65C413FF
		call	sub_65C41E00
		jmp	loc_65C41321
; ---------------------------------------------------------------------------

loc_65C413FF:				; CODE XREF: sub_65C41260+193j
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 2
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65C425F0
		sub	esp, 0Ch
		mov	edi, eax
		jmp	loc_65C412B0
sub_65C41260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
		public DllEntryPoint
DllEntryPoint	proc near

var_10		= dword	ptr -10h
hinstDLL	= dword	ptr  4
fdwReason	= dword	ptr  8
lpReserved	= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	edx, [esp+1Ch+fdwReason]
		mov	ds:dword_65C45018, 0
		cmp	edx, 1
		jz	short loc_65C41450

loc_65C41436:				; CODE XREF: DllEntryPoint+3Dj
		mov	ecx, [esp+1Ch+lpReserved]
		mov	eax, [esp+1Ch+hinstDLL]
		call	sub_65C41260
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_65C41450:				; CODE XREF: DllEntryPoint+14j
		mov	[esp+1Ch+var_10], edx
		call	sub_65C41E20
		mov	edx, [esp+1Ch+var_10]
		jmp	short loc_65C41436
DllEntryPoint	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65C41460	proc near		; CODE XREF: sub_65C42680+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_65C43018
		test	eax, eax
		jz	short locret_65C414AB
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_65C4149E
		mov	[esp+18h+lpProcName], offset ProcName ;	"_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_65C4149E:				; CODE XREF: sub_65C41460+26j
		test	edx, edx
		jz	short locret_65C414AB
		mov	[esp+18h+lpModuleName],	offset dword_65C43018
		call	edx

locret_65C414AB:			; CODE XREF: sub_65C41460+Dj
					; sub_65C41460+40j
		leave
		retn
sub_65C41460	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_65C414B0()
sub_65C414B0	proc near		; DATA XREF: sub_65C42680+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_65C414B0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. g_thread_init

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public g_thread_init
g_thread_init	proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_65C414E8
		mov	[esp+18h+var_10], offset aGthreadSystemN ; "GThread system no longer supports custo"...
		mov	[esp+18h+var_14], 10h
		mov	[esp+18h+var_18], offset aGthread ; "GThread"
		call	g_log

locret_65C414E8:			; CODE XREF: g_thread_init+Aj
		leave
		retn
g_thread_init	endp

; Exported entry   2. g_thread_init_with_errorcheck_mutexes

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public g_thread_init_with_errorcheck_mutexes
g_thread_init_with_errorcheck_mutexes proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_65C41522
		mov	[esp+28h+var_18], offset aVtableNull ; "vtable == NULL"
		mov	[esp+28h+var_1C], offset aG_thread_init_ ; "g_thread_init_with_errorcheck_mutexes"
		mov	[esp+28h+var_20], 2Eh
		mov	[esp+28h+var_24], offset a____Glib2_41_5 ; "../../glib-2.41.5/gthread/gthread-impl."...
		mov	[esp+28h+var_28], offset aGthread ; "GThread"
		call	g_assertion_message_expr

loc_65C41522:				; CODE XREF: g_thread_init_with_errorcheck_mutexes+Aj
		mov	[esp+28h+var_20], offset aGthreadSyste_0 ; "GThread system no longer supports error"...
		mov	[esp+28h+var_24], 10h
		mov	[esp+28h+var_28], offset aGthread ; "GThread"
		call	g_log
		leave
		retn
g_thread_init_with_errorcheck_mutexes endp

; [00000006 BYTES: COLLAPSED FUNCTION g_log]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION g_assertion_message_expr]
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_65C41550(_onexit_t)
sub_65C41550	proc near		; CODE XREF: sub_65C41610+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_65C453AC
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_65C41810
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_65C415F0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_65C453AC
		mov	[esp+2Ch+Func],	eax
		call	sub_65C41810
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_65C453A8
		mov	[esp+2Ch+Func],	eax
		call	sub_65C41810
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_65C41820
		mov	ds:dword_65C453AC, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_65C41820
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_65C453A8, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C415F0:				; CODE XREF: sub_65C41550+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_65C41550	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_65C41610(_onexit_t)
sub_65C41610	proc near		; CODE XREF: sub_65C41E00-27p
					; sub_65C42680+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_65C41550
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_65C41610	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:65C4801Co

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_65C41650
		cmp	eax, 3
		jz	short loc_65C41650
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_65C41650:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_65C42120
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_65C41040+12Ap
					; DATA XREF: .rdata:off_65C4417Co ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_65C416C4
		cmp	dword_65C4300C,	2
		jz	short loc_65C416A6
		mov	dword_65C4300C,	2

loc_65C416A6:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_65C417B3
		cmp	eax, 1
		jz	loc_65C41752

loc_65C416B8:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_65C416C4:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_65C453C0, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_65C417E3
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_65C453BC, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_65C453B8, eax
		jz	loc_65C417E3
		mov	ecx, ds:dword_65C453BC
		test	ecx, ecx
		jz	short loc_65C41773
		test	eax, eax
		jz	short loc_65C41773
		mov	dword_65C4300C,	1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_65C41752:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_65C42120
		jmp	loc_65C416B8
; ---------------------------------------------------------------------------

loc_65C41773:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_65C453B8, 0
		mov	ds:dword_65C453BC, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_65C41793:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_65C4300C,	0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_65C417B3:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_65C48028
		cmp	ebx, offset dword_65C48028
		jz	loc_65C416B8

loc_65C417C4:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_65C417CC
		call	eax

loc_65C417CC:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_65C48028
		jnz	short loc_65C417C4
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_65C417E3:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_65C453B8, 0
		mov	ds:dword_65C453BC, 0
		jmp	short loc_65C41793
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C41810	proc near		; CODE XREF: sub_65C41040+14Bp
					; sub_65C41040+15Ep ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_65C41810	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C41820	proc near		; CODE XREF: sub_65C41000+15p
					; sub_65C41550+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_65C41820	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_65C41830(char	*Format, char ArgList)
sub_65C41830	proc near		; CODE XREF: sub_65C41890+1DDp
					; sub_65C41890+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_65C41830	endp

; ---------------------------------------------------------------------------
		jmp	short sub_65C41890
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_65C41890(size_t Size)
sub_65C41890	proc near		; CODE XREF: .text:65C41881j
					; sub_65C41AD0+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_65C45024
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_65C41A72
		mov	eax, ds:dword_65C45020
		xor	esi, esi

loc_65C418B4:				; CODE XREF: sub_65C41890+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_65C418C9
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_65C419A0

loc_65C418C9:				; CODE XREF: sub_65C41890+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_65C418B4

loc_65C418D3:				; CODE XREF: sub_65C41890+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_65C422D0
		test	eax, eax
		mov	edi, eax
		jz	loc_65C41A99
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_65C45020
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_65C423B0
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_65C45020
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_65C41A79
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_65C41A21

loc_65C4194F:				; CODE XREF: sub_65C41890+194j
					; sub_65C41890+1C6j
		add	ds:dword_65C45024, 1

loc_65C41956:				; CODE XREF: sub_65C41890+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_65C41AA9
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_65C419A8

loc_65C4197F:				; CODE XREF: sub_65C41890+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_65C41993:				; CODE XREF: sub_65C41890+162j
					; sub_65C41890+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C419A0:				; CODE XREF: sub_65C41890+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_65C41956
; ---------------------------------------------------------------------------

loc_65C419A8:				; CODE XREF: sub_65C41890+EDj
		cmp	eax, 40h
		jz	short loc_65C4197F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_65C41993
		cmp	eax, 4
		jz	short loc_65C41993
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_65C41A21:				; CODE XREF: sub_65C41890+B9j
		cmp	eax, 40h
		jz	loc_65C4194F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_65C45020
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_65C4194F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset Format ; "	VirtualProtect failed with code	0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_65C41830
; ---------------------------------------------------------------------------

loc_65C41A72:				; CODE XREF: sub_65C41890+17j
		xor	esi, esi
		jmp	loc_65C418D3
; ---------------------------------------------------------------------------

loc_65C41A79:				; CODE XREF: sub_65C41890+ACj
		mov	eax, ds:dword_65C45020
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_65C41830
; ---------------------------------------------------------------------------

loc_65C41A99:				; CODE XREF: sub_65C41890+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_65C41830
; ---------------------------------------------------------------------------

loc_65C41AA9:				; CODE XREF: sub_65C41890+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_65C41830
sub_65C41890	endp

; ---------------------------------------------------------------------------
		db 0EBh	; ë
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65C41AD0	proc near		; CODE XREF: sub_65C41260+32p
					; sub_65C41260:loc_65C41314p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_65C4501C
		test	eax, eax
		jz	short loc_65C41AF0

loc_65C41AE2:				; CODE XREF: sub_65C41AD0+66j
					; sub_65C41AD0+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C41AF0:				; CODE XREF: sub_65C41AD0+10j
		mov	ds:dword_65C4501C, 1
		call	sub_65C42310
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_65C42580
		mov	ds:dword_65C45024, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_65C45020, eax
		mov	eax, offset dword_65C44298
		sub	eax, offset dword_65C44298
		cmp	eax, 7
		jle	short loc_65C41AE2
		cmp	eax, 0Bh
		mov	ebx, offset dword_65C44298
		jle	loc_65C41C30
		mov	eax, ds:dword_65C44298
		test	eax, eax
		jnz	short loc_65C41B60
		mov	eax, ds:dword_65C4429C
		test	eax, eax
		jz	loc_65C41C1C
		lea	esi, [esi+0]

loc_65C41B60:				; CODE XREF: sub_65C41AD0+7Dj
					; sub_65C41AD0+164j ...
		cmp	ebx, offset dword_65C44298
		jnb	loc_65C41AE2
		mov	esi, 65C40000h

loc_65C41B71:				; CODE XREF: sub_65C41AD0+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_65C41890
		cmp	ebx, offset dword_65C44298
		jb	short loc_65C41B71

loc_65C41B95:				; CODE XREF: sub_65C41AD0+24Bj
		mov	ecx, ds:dword_65C45024
		test	ecx, ecx
		jle	loc_65C41AE2
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_65C41BC2
; ---------------------------------------------------------------------------
		align 10h

loc_65C41BB0:				; CODE XREF: sub_65C41AD0+FDj
					; sub_65C41AD0+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_65C45024
		jge	loc_65C41AE2

loc_65C41BC2:				; CODE XREF: sub_65C41AD0+DDj
		mov	eax, ds:dword_65C45020
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_65C41BB0
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_65C41D42
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_65C45020
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_65C41BB0
; ---------------------------------------------------------------------------

loc_65C41C1C:				; CODE XREF: sub_65C41AD0+86j
		mov	eax, ds:dword_65C442A0
		test	eax, eax
		jnz	short loc_65C41C45
		mov	ebx, offset dword_65C442A4
		lea	esi, [esi+0]

loc_65C41C30:				; CODE XREF: sub_65C41AD0+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_65C41B60
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_65C41B60

loc_65C41C45:				; CODE XREF: sub_65C41AD0+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_65C41D65
		add	ebx, 0Ch
		cmp	ebx, offset dword_65C44298
		jnb	loc_65C41AE2

loc_65C41C60:				; CODE XREF: sub_65C41AD0+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 65C40000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+65C40000h]
		jz	short loc_65C41CBA
		cmp	edx, 20h
		jz	short loc_65C41CF0
		cmp	edx, 8
		jz	short loc_65C41C9A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_65C41830
; ---------------------------------------------------------------------------

loc_65C41C9A:				; CODE XREF: sub_65C41AD0+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_65C41CC5
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 65C40000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_65C41CE1
; ---------------------------------------------------------------------------

loc_65C41CBA:				; CODE XREF: sub_65C41AD0+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_65C41D20

loc_65C41CC5:				; CODE XREF: sub_65C41AD0+1D3j
		sub	edi, ecx
		sub	edi, 65C40000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_65C41D33
		cmp	edx, 20h
		jz	short loc_65C41CFF
		cmp	edx, 8
		jnz	short loc_65C41D0C

loc_65C41CE1:				; CODE XREF: sub_65C41AD0+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_65C41890
		jmp	short loc_65C41D0C
; ---------------------------------------------------------------------------

loc_65C41CF0:				; CODE XREF: sub_65C41AD0+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 65C40000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_65C41CFF:				; CODE XREF: sub_65C41AD0+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_65C41890

loc_65C41D0C:				; CODE XREF: sub_65C41AD0+20Fj
					; sub_65C41AD0+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_65C44298
		jb	loc_65C41C60
		jmp	loc_65C41B95
; ---------------------------------------------------------------------------

loc_65C41D20:				; CODE XREF: sub_65C41AD0+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 65C40000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_65C41D33:				; CODE XREF: sub_65C41AD0+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_65C41890
		jmp	short loc_65C41D0C
; ---------------------------------------------------------------------------

loc_65C41D42:				; CODE XREF: sub_65C41AD0+11Bj
		add	ebx, ds:dword_65C45020
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_65C41830
; ---------------------------------------------------------------------------

loc_65C41D65:				; CODE XREF: sub_65C41AD0+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_65C41830
sub_65C41AD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_65C41D80()
sub_65C41D80	proc near		; DATA XREF: sub_65C41E00:loc_65C41DD2o
		sub	esp, 0Ch
		mov	eax, off_65C43008
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_65C41DA7
		xchg	ax, ax

loc_65C41D90:				; CODE XREF: sub_65C41D80+25j
		call	eax
		mov	eax, off_65C43008
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_65C43008, edx
		test	eax, eax
		jnz	short loc_65C41D90

loc_65C41DA7:				; CODE XREF: sub_65C41D80+Cj
		add	esp, 0Ch
		retn
sub_65C41D80	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_65C41E00

loc_65C41DB0:				; CODE XREF: sub_65C41E00+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_65C426A0
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_65C41DE3

loc_65C41DBF:				; CODE XREF: sub_65C41E00-9j
		test	ebx, ebx
		jz	short loc_65C41DD2

loc_65C41DC3:				; CODE XREF: sub_65C41E00-30j
		call	ds:dword_65C426A0[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_65C41DC3

loc_65C41DD2:				; CODE XREF: sub_65C41E00-3Fj
		mov	[esp+1Ch+var_1C], offset sub_65C41D80 ;	_onexit_t
		call	sub_65C41610
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_65C41DE3:				; CODE XREF: sub_65C41E00-43j
		xor	ebx, ebx
		jmp	short loc_65C41DE9
; ---------------------------------------------------------------------------

loc_65C41DE7:				; CODE XREF: sub_65C41E00-Bj
		mov	ebx, eax

loc_65C41DE9:				; CODE XREF: sub_65C41E00-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_65C426A0[eax*4]
		test	edx, edx
		jnz	short loc_65C41DE7
		jmp	short loc_65C41DBF
; END OF FUNCTION CHUNK	FOR sub_65C41E00
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C41E00	proc near		; CODE XREF: sub_65C41260+195p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 65C41DB0 SIZE 00000049 BYTES

		mov	ecx, ds:dword_65C45028
		test	ecx, ecx
		jz	short loc_65C41E10
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C41E10:				; CODE XREF: sub_65C41E00+8j
		mov	ds:dword_65C45028, 1
		jmp	short loc_65C41DB0
sub_65C41E00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C41E20	proc near		; CODE XREF: DllEntryPoint+34p

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_65C43010
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_65C41E70
		not	eax
		mov	dword_65C43014,	eax

loc_65C41E56:				; CODE XREF: sub_65C41E20+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C41E70:				; CODE XREF: sub_65C41E20+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_65C41EE2

loc_65C41ED2:				; CODE XREF: sub_65C41E20+CCj
		mov	dword_65C43010,	ebp
		mov	dword_65C43014,	eax
		jmp	loc_65C41E56
; ---------------------------------------------------------------------------

loc_65C41EE2:				; CODE XREF: sub_65C41E20+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_65C41ED2
sub_65C41E20	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_65C45104, edx
		mov	ds:dword_65C45320, 0C0000409h
		mov	ds:dword_65C45324, 1
		mov	ds:dword_65C450F8, eax
		mov	ds:dword_65C4532C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_65C450EC, eax
		mov	eax, dword_65C43010
		mov	[ebp-10h], eax
		mov	eax, dword_65C43014
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_65C44278
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C41F80	proc near		; CODE XREF: sub_65C42120+79p
					; sub_65C42120:loc_65C421B2p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_65C4539C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_65C41FD5
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_65C41FB0:				; CODE XREF: sub_65C41F80+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_65C41FCE
		test	esi, esi
		jz	short loc_65C41FCE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_65C41FCE:				; CODE XREF: sub_65C41F80+40j
					; sub_65C41F80+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_65C41FB0

loc_65C41FD5:				; CODE XREF: sub_65C41F80+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_65C41F80	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_65C45380
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_65C42014

loc_65C42006:				; CODE XREF: .text:65C4207Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_65C42014:				; CODE XREF: .text:65C42004j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_65C42077
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_65C4539C
		mov	ds:dword_65C4539C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_65C42077:				; CODE XREF: .text:65C4202Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_65C42006
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_65C45380
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_65C42098
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_65C42098:				; CODE XREF: .text:65C4208Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_65C4539C
		sub	esp, 4
		test	edx, edx
		jz	short loc_65C420CF
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_65C420C8
		jmp	short loc_65C42106
; ---------------------------------------------------------------------------
		align 10h

loc_65C420C0:				; CODE XREF: .text:65C420CDj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_65C420E6
		mov	edx, eax

loc_65C420C8:				; CODE XREF: .text:65C420B6j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_65C420C0

loc_65C420CF:				; CODE XREF: .text:65C420B0j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_65C420DF:				; CODE XREF: .text:65C42104j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_65C420E6:				; CODE XREF: .text:65C420C4j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_65C420EC:				; CODE XREF: .text:65C42110j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_65C420DF
; ---------------------------------------------------------------------------

loc_65C42106:				; CODE XREF: .text:65C420B8j
		mov	eax, [edx+8]
		mov	ds:dword_65C4539C, eax
		mov	eax, edx
		jmp	short loc_65C420EC
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C42120	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_65C42170
		jb	short loc_65C42140
		cmp	eax, 3
		jz	short loc_65C42190

loc_65C42133:				; CODE XREF: sub_65C42120+31j
					; sub_65C42120+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C42140:				; CODE XREF: sub_65C42120+Cj
		mov	eax, ds:dword_65C45380
		test	eax, eax
		jnz	short loc_65C421B2

loc_65C42149:				; CODE XREF: sub_65C42120+97j
		mov	eax, ds:dword_65C45380
		cmp	eax, 1
		jnz	short loc_65C42133
		mov	ds:dword_65C45380, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_65C42133
; ---------------------------------------------------------------------------
		align 10h

loc_65C42170:				; CODE XREF: sub_65C42120+Aj
		mov	eax, ds:dword_65C45380
		test	eax, eax
		jz	short loc_65C421A0

loc_65C42179:				; CODE XREF: sub_65C42120+90j
		mov	ds:dword_65C45380, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C42190:				; CODE XREF: sub_65C42120+11j
		mov	eax, ds:dword_65C45380
		test	eax, eax
		jz	short loc_65C42133
		call	sub_65C41F80
		jmp	short loc_65C42133
; ---------------------------------------------------------------------------

loc_65C421A0:				; CODE XREF: sub_65C42120+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_65C42179
; ---------------------------------------------------------------------------

loc_65C421B2:				; CODE XREF: sub_65C42120+27j
		call	sub_65C41F80
		jmp	short loc_65C42149
sub_65C42120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C421C0	proc near		; CODE XREF: .text:65C42261p
					; sub_65C422D0+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_65C421D0

locret_65C421CD:			; CODE XREF: sub_65C421C0+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C421D0:				; CODE XREF: sub_65C421C0+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_65C421CD
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_65C421C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C421F0	proc near		; CODE XREF: sub_65C422D0+2Bp
					; .text:65C42414p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_65C4222E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_65C42214:				; CODE XREF: sub_65C421F0+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_65C42222
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_65C4222E

loc_65C42222:				; CODE XREF: sub_65C421F0+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_65C42214
		xor	eax, eax

loc_65C4222E:				; CODE XREF: sub_65C421F0+19j
					; sub_65C421F0+30j
		pop	ebx
		pop	esi
		retn
sub_65C421F0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_65C42240
; ---------------------------------------------------------------------------
		align 10h

loc_65C42240:				; CODE XREF: .text:65C42231j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_65C422B3
		mov	dword ptr [esp], 65C40000h
		call	sub_65C421C0
		test	eax, eax
		jz	short loc_65C422B3
		mov	eax, ds:65C4003Ch
		movzx	ebp, word ptr [eax+65C40006h]
		movzx	edx, word ptr [eax+65C40014h]
		add	eax, 65C40000h
		test	ebp, ebp
		jz	short loc_65C422B3
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_65C4229B
; ---------------------------------------------------------------------------

loc_65C42291:				; CODE XREF: .text:65C422B1j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_65C422C0

loc_65C4229B:				; CODE XREF: .text:65C4228Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_65C42291

loc_65C422B3:				; CODE XREF: .text:65C42258j
					; .text:65C42268j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C422C0:				; CODE XREF: .text:65C42299j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C422D0	proc near		; CODE XREF: sub_65C41890+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 65C40000h
		call	sub_65C421C0
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_65C42300
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 65C40000h
		sub	eax, 65C40000h
		mov	[esp+8+var_4], eax
		call	sub_65C421F0

loc_65C42300:				; CODE XREF: sub_65C422D0+15j
		add	esp, 8
		retn
sub_65C422D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C42310	proc near		; CODE XREF: sub_65C41AD0+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 65C40000h
		call	sub_65C421C0
		xor	edx, edx
		test	eax, eax
		jz	short loc_65C42331
		mov	eax, ds:65C4003Ch
		movzx	edx, word ptr [eax+65C40006h]

loc_65C42331:				; CODE XREF: sub_65C42310+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_65C42310	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 65C40000h
		mov	ebx, [esp+10h]
		call	sub_65C421C0
		xor	edx, edx
		test	eax, eax
		jz	short loc_65C42399
		mov	eax, ds:65C4003Ch
		movzx	ecx, word ptr [eax+65C40006h]
		movzx	esi, word ptr [eax+65C40014h]
		add	eax, 65C40000h
		test	ecx, ecx
		jz	short loc_65C42399
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_65C42380:				; CODE XREF: .text:65C42395j
		test	byte ptr [edx+27h], 20h
		jz	short loc_65C4238D
		test	ebx, ebx
		jz	short loc_65C42399
		sub	ebx, 1

loc_65C4238D:				; CODE XREF: .text:65C42384j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_65C42380
		xor	edx, edx

loc_65C42399:				; CODE XREF: .text:65C42359j
					; .text:65C42375j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_65C423B0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C423B0	proc near		; CODE XREF: sub_65C41890+70p
					; .text:65C423A1j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 65C40000h
		call	sub_65C421C0
		xor	edx, edx
		test	eax, eax
		mov	eax, 65C40000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_65C423B0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_65C423E0
; ---------------------------------------------------------------------------
		align 10h

loc_65C423E0:				; CODE XREF: .text:65C423D1j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 65C40000h
		call	sub_65C421C0
		test	eax, eax
		jnz	short loc_65C42400

loc_65C423F6:				; CODE XREF: .text:65C4241Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C42400:				; CODE XREF: .text:65C423F4j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 65C40000h
		sub	eax, 65C40000h
		mov	[esp+4], eax
		call	sub_65C421F0
		test	eax, eax
		jz	short loc_65C423F6
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C42430	proc near		; CODE XREF: .text:65C424DAp

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 65C40000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_65C421C0
		test	eax, eax
		jz	short loc_65C424A1
		mov	eax, ds:65C4003Ch
		mov	esi, [eax+65C40080h]
		test	esi, esi
		jz	short loc_65C424A1
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 65C40000h
		call	sub_65C421F0
		test	eax, eax
		jz	short loc_65C424A1
		add	esi, 65C40000h
		jnz	short loc_65C42486
		jmp	short loc_65C424A1
; ---------------------------------------------------------------------------
		align 10h

loc_65C42480:				; CODE XREF: sub_65C42430+66j
		sub	ebx, 1
		add	esi, 14h

loc_65C42486:				; CODE XREF: sub_65C42430+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_65C42494
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_65C424B0

loc_65C42494:				; CODE XREF: sub_65C42430+5Bj
		test	ebx, ebx
		jg	short loc_65C42480
		mov	edi, [esi+0Ch]
		add	edi, 65C40000h

loc_65C424A1:				; CODE XREF: sub_65C42430+1Aj
					; sub_65C42430+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_65C424B0:				; CODE XREF: sub_65C42430+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_65C42430	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_65C453A4
		test	eax, eax
		jz	short loc_65C424D2

loc_65C424CD:				; CODE XREF: .text:65C42557j
					; .text:65C42575j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_65C424D2:				; CODE XREF: .text:65C424CBj
		xor	eax, eax

loc_65C424D4:				; CODE XREF: .text:65C42542j
		mov	[esp], eax
		lea	ebx, [eax+1]
		call	sub_65C42430
		test	eax, eax
		jz	short loc_65C42560
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_65C424F0
		cmp	dl, 6Dh
		jnz	short loc_65C42540

loc_65C424F0:				; CODE XREF: .text:65C424E9j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_65C424FE
		cmp	dl, 73h
		jnz	short loc_65C42540

loc_65C424FE:				; CODE XREF: .text:65C424F7j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_65C4250C
		cmp	dl, 76h
		jnz	short loc_65C42540

loc_65C4250C:				; CODE XREF: .text:65C42505j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_65C4251A
		cmp	dl, 63h
		jnz	short loc_65C42540

loc_65C4251A:				; CODE XREF: .text:65C42513j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_65C42528
		cmp	dl, 72h
		jnz	short loc_65C42540

loc_65C42528:				; CODE XREF: .text:65C42521j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_65C42544
		cmp	dl, 74h
		jz	short loc_65C42544
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_65C42544
		xchg	ax, ax

loc_65C42540:				; CODE XREF: .text:65C424EEj
					; .text:65C424FCj ...
		mov	eax, ebx
		jmp	short loc_65C424D4
; ---------------------------------------------------------------------------

loc_65C42544:				; CODE XREF: .text:65C4252Fj
					; .text:65C42534j ...
		mov	[esp], eax
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_65C453A4, eax
		jnz	loc_65C424CD
		lea	esi, [esi+0]

loc_65C42560:				; CODE XREF: .text:65C424E1j
		mov	dword ptr [esp], offset	aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_65C453A4, eax
		jmp	loc_65C424CD
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C42580	proc near		; CODE XREF: sub_65C41AD0+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_65C425A2

loc_65C4258D:				; CODE XREF: sub_65C42580+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_65C4258D

loc_65C425A2:				; CODE XREF: sub_65C42580+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_65C42580	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_65C425D0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C425D0	proc near		; CODE XREF: sub_65C41040+53p
					; sub_65C41040+C8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_65C425D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C425F0	proc near		; CODE XREF: sub_65C41260+46p
					; sub_65C41260+CCp ...
		mov	eax, 1
		retn	0Ch
sub_65C425F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65C42600	proc near		; CODE XREF: sub_65C41260+8Bp
					; sub_65C41260+10Dp ...
		mov	eax, 1
		retn	0Ch
sub_65C42600	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65C42680	proc near		; DATA XREF: .text:65C426A4o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_65C41460
		mov	[esp+18h+var_18], offset sub_65C414B0 ;	_onexit_t
		call	sub_65C41610
		leave
		retn
sub_65C42680	endp

; ---------------------------------------------------------------------------
		align 10h
dword_65C426A0	dd 0FFFFFFFFh		; DATA XREF: sub_65C41E00-4Cr
					; sub_65C41E00:loc_65C41DC3r ...
		dd offset sub_65C42680
		dd 0
		dd 0FFFFFFFFh
dword_65C426B0	dd 54h dup(0)		; DATA XREF: .data:off_65C43008o
		dd 200h	dup(?)
_text		ends

; Section 2. (virtual address 00003000)
; Virtual size			: 0000001C (	 28.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00001C00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 65C43000h
		dd 0FFFFFFFFh
dword_65C43004	dd 0FFFFFFFFh		; DATA XREF: sub_65C41260+1Bw
					; sub_65C41260+5Fw
off_65C43008	dd offset dword_65C426B0 ; DATA	XREF: sub_65C41D80+3r
					; sub_65C41D80+12r ...
dword_65C4300C	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_65C43010	dd 0BB40E64Eh		; DATA XREF: sub_65C41E20+3r
					; sub_65C41E20:loc_65C41ED2w ...
dword_65C43014	dd 44BF19B1h		; DATA XREF: sub_65C41E20+31w
					; sub_65C41E20+B8w ...
dword_65C43018	dd 0			; DATA XREF: sub_65C41460+6r
					; sub_65C41460+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00004000)
; Virtual size			: 00000298 (	664.)
; Section size in file		: 00000400 (   1024.)
; Offset to raw	data for section: 00001E00
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 65C44000h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_65C41460+Fo
; CHAR ProcName[]
ProcName	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_65C41460+28o
		align 20h
aGthreadSystemN	db 'GThread system no longer supports custom thread implementations.',0
					; DATA XREF: g_thread_init+Co
aGthread	db 'GThread',0          ; DATA XREF: g_thread_init+1Co
					; g_thread_init_with_errorcheck_mutexes+2Co ...
aVtableNull	db 'vtable == NULL',0   ; DATA XREF: g_thread_init_with_errorcheck_mutexes+Co
a____Glib2_41_5	db '../../glib-2.41.5/gthread/gthread-impl.c',0
					; DATA XREF: g_thread_init_with_errorcheck_mutexes+24o
		align 4
aGthreadSyste_0	db 'GThread system no longer supports errorcheck mutexes.',0
					; DATA XREF: g_thread_init_with_errorcheck_mutexes:loc_65C41522o
		align 10h
aG_thread_init_	db 'g_thread_init_with_errorcheck_mutexes',0
					; DATA XREF: g_thread_init_with_errorcheck_mutexes+14o
		align 20h
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_65C4417C	dd offset TlsCallback_0	; DATA XREF: sub_65C41040:loc_65C4114Ar
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_65C41830+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_65C41890+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_65C41890+1F9o
					; sub_65C41890+225o ...
		align 10h
; char Format[]
Format		db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_65C41890+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_65C41AD0+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_65C41AD0+1B7o
		align 4
off_65C44278	dd offset dword_65C45320 ; DATA	XREF: .text:65C41F48o
		dd offset dword_65C45040
aMsvcrt_dll:				; DATA XREF: .text:loc_65C42560o
		unicode	0, <msvcrt.dll>,0
		align 4
dword_65C44298	dd 0			; DATA XREF: sub_65C41AD0+59o
					; sub_65C41AD0+5Eo ...
dword_65C4429C	dd 0			; DATA XREF: sub_65C41AD0+7Fr
dword_65C442A0	dd 0			; DATA XREF: sub_65C41AD0:loc_65C41C1Cr
dword_65C442A4	dd 57h dup(0)		; DATA XREF: sub_65C41AD0+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00005000)
; Virtual size			: 000003D4 (	980.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 65C45000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_65C45000	dd ?			; DATA XREF: sub_65C41040+Dr
					; sub_65C41040+22w ...
		align 10h
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_65C45018	dd ?			; DATA XREF: DllEntryPoint+7w
dword_65C4501C	dd ?			; DATA XREF: sub_65C41AD0+9r
					; sub_65C41AD0:loc_65C41AF0w
dword_65C45020	dd ?			; DATA XREF: sub_65C41890+1Dr
					; sub_65C41890+58r ...
dword_65C45024	dd ?			; DATA XREF: sub_65C41890+Br
					; sub_65C41890:loc_65C4194Fw ...
dword_65C45028	dd ?			; DATA XREF: sub_65C41E00r
					; sub_65C41E00:loc_65C41E10w
		align 20h
dword_65C45040	dd 2Bh dup(?)		; DATA XREF: .rdata:65C4427Co
dword_65C450EC	dd ?			; DATA XREF: .text:65C41F2Aw
		dd 2 dup(?)
dword_65C450F8	dd ?			; DATA XREF: .text:65C41F16w
		dd 2 dup(?)
dword_65C45104	dd ?			; DATA XREF: .text:65C41EFCw
		dd 86h dup(?)
dword_65C45320	dd ?			; DATA XREF: .text:65C41F02w
					; .rdata:off_65C44278o
dword_65C45324	dd ?			; DATA XREF: .text:65C41F0Cw
		dd ?
dword_65C4532C	dd ?			; DATA XREF: .text:65C41F1Bw
		align 80h
dword_65C45380	dd ?			; DATA XREF: .text:65C41FF3r
					; .text:65C42084r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_65C41F80+7o
					; sub_65C41F80:loc_65C41FD5o ...
dword_65C4539C	dd ?			; DATA XREF: sub_65C41F80+14r
					; .text:65C42048r ...
		dd ?
dword_65C453A4	dd ?			; DATA XREF: .text:65C424C4r
					; .text:65C42552w ...
dword_65C453A8	dd ?			; DATA XREF: sub_65C41000+21w
					; sub_65C41040+156r ...
dword_65C453AC	dd ?			; DATA XREF: sub_65C41000+1Cw
					; sub_65C41040:loc_65C41183r ...
dword_65C453B0	dd ?			; DATA XREF: sub_65C41040+4Co
					; sub_65C41040+C1o ...
dword_65C453B4	dd ?			; DATA XREF: sub_65C41040+5Fr
					; sub_65C41040:loc_65C41116r ...
dword_65C453B8	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_65C41773w ...
dword_65C453BC	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_65C453C0	dd ?			; DATA XREF: TlsCallback_0:loc_65C416C4w
		align 1000h
_bss		ends

;
; Imports from libglib-2.0-0.dll
;
; Section 6. (virtual address 00007000)
; Virtual size			: 00000538 (   1336.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00002400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_g_assertion_message_expr:dword
					; DATA XREF: g_assertion_message_exprr
		extrn __imp_g_log:dword	; DATA XREF: g_logr

;
; Imports from KERNEL32.dll
;
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_65C42120+44p
					; DATA XREF: sub_65C42120+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_65C41F80+Ep
					; .text:65C42042p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:65C41F58p
					; DATA XREF: .text:65C41F58r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_65C41E20+6Cp
					; DATA XREF: sub_65C41E20+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_65C41E20+74p
					; DATA XREF: sub_65C41E20+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_65C41890+1CCp
					; sub_65C41F80+3Cp
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_65C41460+16p
					; .text:65C42547p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_65C41460+33p
					; TlsCallback_0+7Cp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_65C41E20+57p
					; DATA XREF: sub_65C41E20+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_65C41E20+7Cp
					; DATA XREF: sub_65C41E20+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_65C42120+87p
					; DATA XREF: sub_65C42120+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_65C41F80+5Cp
					; .text:65C42060p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: TlsCallback_0+55p
					; DATA XREF: TlsCallback_0+55r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: .text:65C42567p
					; DATA XREF: .text:65C42567r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_65C41E20+8Bp
					; DATA XREF: sub_65C41E20+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: .text:65C41F3Fp
					; DATA XREF: .text:65C41F3Fr
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_65C41040+37p
					; sub_65C41040+B0p
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:65C41F69p
					; DATA XREF: .text:65C41F69r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_65C41F80+35p
					; DATA XREF: sub_65C41F80+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:65C41F4Fp
					; DATA XREF: .text:65C41F4Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_65C41890+142p
					; sub_65C41890+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_65C41890+A1p
					; sub_65C41890+D9p ...

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_65C41830+4r
					; sub_65C41830+3Cr
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_65C41550+A3p
					; DATA XREF: sub_65C41550+A3r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr


; Section 7. (virtual address 00008000)
; Virtual size			: 0000002C (	 44.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00002A00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 65C48000h
dword_65C48000	dd 0			; DATA XREF: sub_65C41040+1FDo
dword_65C48004	dd 0			; DATA XREF: sub_65C41040:loc_65C41235o
dword_65C48008	dd 0			; DATA XREF: sub_65C41040+1C9o
		dd offset sub_65C41000
dword_65C48010	dd 2 dup(0)		; DATA XREF: sub_65C41040:loc_65C41201o
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 8
dword_65C48028	dd 76h dup(0)		; DATA XREF: TlsCallback_0:loc_65C417B3o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 8. (virtual address 00009000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00002C00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 65C49000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end DllEntryPoint
