;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	39AA4A8346BD25C573D614F2D0F46EB6
; Input	CRC32 :	0D4B0752

; File Name   :	C:\compspace\compare\gpg\dlls\full\gpg2keys_hkp.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 0000B064 (  45156.)
; Section size in file		: 0000B200 (  45568.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00412004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_410504
		mov	[esp+2Ch+var_1C], offset dword_410018
		mov	[esp+2Ch+var_24], offset dword_41000C
		mov	[esp+2Ch+var_28], offset dword_410008
		mov	ds:dword_410018, eax
		mov	eax, ds:dword_410508
		mov	[esp+2Ch+var_2C], offset dword_410004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_41001C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00412010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_410514, 1
		mov	ds:dword_410510, 1
		mov	ds:dword_41050C, 1
		mov	ds:dword_410520, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_410014, eax
		mov	eax, ds:dword_410524
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_409F90
		mov	edx, ds:dword_410528
		mov	ds:dword_4108DC, eax
		mov	ds:dword_4108E0, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_40A2D0
		cmp	dword_40D01C, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_40A270
		call	sub_40A260
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_40B040
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_410524
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_4108E4
		call	sub_40B0B0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_4108E8
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_4108E8
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_410000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_4108E8
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_4108E4

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_40F780
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_40A580
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_41052C, eax
		call	sub_40AB30
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_40ABF0
		mov	eax, ds:dword_410524
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_4108C4, eax
		mov	eax, 0Ah
		mov	ds:dword_4108CC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_4108C8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_410004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_410008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_410008, eax
		call	sub_40AC80
		mov	eax, ds:__initenv
		mov	edx, ds:dword_41000C
		mov	[eax], edx
		mov	eax, ds:dword_41000C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_410008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_410004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_402A9B
		mov	esi, ds:dword_410014
		test	esi, esi
		mov	ds:dword_410010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_410000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_410010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_4108E8
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_4108E8
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_412008
		mov	[esp+88h+dwMilliseconds], offset dword_412000
		call	_initterm
		mov	ds:dword_4108E8, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_4108E8, 1
		mov	[esp+88h+lpProcName], offset dword_412018
		mov	[esp+88h+dwMilliseconds], offset dword_41200C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_410524, 1
		call	sub_40ACA0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_410524, 0
		call	sub_40ACA0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_40C030+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_40D044
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_40D044
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_40C030+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4015C8(void *, size_t, size_t, FILE *)
sub_4015C8	proc near		; DATA XREF: sub_40262A+207o

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_410148
		test	eax, eax
		jnz	short loc_4015FB
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ch
		jnz	short loc_4015F1
		mov	ds:dword_41014C, 1

loc_4015F1:				; CODE XREF: sub_4015C8+1Dj
		mov	ds:dword_410148, 1

loc_4015FB:				; CODE XREF: sub_4015C8+Dj
		mov	eax, ds:dword_41014C
		test	eax, eax
		jnz	short loc_401629
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Size],	eax ; Size
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		cmp	eax, [ebp+arg_8]
		jnz	short loc_401632

loc_401629:				; CODE XREF: sub_4015C8+3Aj
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		jmp	short locret_401637
; ---------------------------------------------------------------------------

loc_401632:				; CODE XREF: sub_4015C8+5Fj
		mov	eax, 0

locret_401637:				; CODE XREF: sub_4015C8+68j
		leave
		retn
sub_4015C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401639(char *, char *)
sub_401639	proc near		; CODE XREF: sub_401700+42Cp
					; sub_401CC0+1E4p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40168E
		cmp	[ebp+var_C], 0
		jz	short loc_40168E
		mov	eax, [ebp+var_C]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40168E
		mov	eax, [ebp+var_C]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0

loc_40168E:				; CODE XREF: sub_401639+31j
					; sub_401639+37j ...
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcat
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_401639	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4016A6	proc near		; CODE XREF: sub_402232+B8p
					; sub_40262A+ECp

var_18		= dword	ptr -18h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 14h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4016F7
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_18]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jz	short loc_4016F7
		mov	eax, [ebp+var_8]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4016F7
		mov	eax, [ebp+arg_4]
		add	eax, 1
		jmp	short loc_4016FA
; ---------------------------------------------------------------------------

loc_4016F7:				; CODE XREF: sub_4016A6+Fj
					; sub_4016A6+37j ...
		mov	eax, [ebp+arg_4]

loc_4016FA:				; CODE XREF: sub_4016A6+4Fj
		add	esp, 14h
		pop	edi
		pop	ebp
		retn
sub_4016A6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401700	proc near		; CODE XREF: sub_402A9B+D77p

Src		= dword	ptr -9C8h
Format		= dword	ptr -9C4h
File		= dword	ptr -9C0h
var_9BC		= dword	ptr -9BCh
var_9AC		= dword	ptr -9ACh
Buf		= byte ptr -9A5h
var_59D		= byte ptr -59Dh
var_597		= byte ptr -597h
Dest		= byte ptr -586h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
Memory		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 9BCh
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 1
		mov	[ebp+Memory], 0
		mov	[ebp+var_2C], 0
		mov	[ebp+var_30], 0
		mov	[ebp+var_34], 0
		jmp	short loc_4017A3
; ---------------------------------------------------------------------------

loc_40173F:				; CODE XREF: sub_401700+C4j
		mov	edx, offset Format ; "KEY%*[ ]%16s%*[ ]%5s\n"
		lea	eax, [ebp+Buf]
		lea	ecx, [ebp+var_59D]
		mov	[esp+9C8h+var_9BC], ecx
		lea	ecx, [ebp+var_597]
		mov	[esp+9C8h+File], ecx
		mov	[esp+9C8h+Format], edx ; Format
		mov	[esp+9C8h+Src],	eax ; Src
		call	sscanf
		cmp	eax, 2
		jnz	short loc_4017A3
		lea	eax, [ebp+var_59D]
		mov	edx, eax
		mov	eax, offset aBegin ; "BEGIN"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4017A3
		mov	[ebp+var_1C], 1
		jmp	short loc_4017CA
; ---------------------------------------------------------------------------

loc_4017A3:				; CODE XREF: sub_401700+3Dj
					; sub_401700+6Dj ...
		mov	eax, ds:File
		mov	[esp+9C8h+File], eax ; File
		mov	[esp+9C8h+Format], 408h	; MaxCount
		lea	eax, [ebp+Buf]
		mov	[esp+9C8h+Src],	eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_40173F

loc_4017CA:				; CODE XREF: sub_401700+A1j
		cmp	[ebp+var_1C], 0
		jnz	loc_401930
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 1
		mov	[ebp+var_24], 0
		jmp	loc_401C67
; ---------------------------------------------------------------------------

loc_4017E9:				; CODE XREF: sub_401700+252j
		mov	edx, offset aKey16s3s ;	"KEY%*[	]%16s%*[ ]%3s\n"
		lea	eax, [ebp+Buf]
		lea	ecx, [ebp+var_59D]
		mov	[esp+9C8h+var_9BC], ecx
		lea	ecx, [ebp+var_597]
		mov	[esp+9C8h+File], ecx
		mov	[esp+9C8h+Format], edx ; Format
		mov	[esp+9C8h+Src],	eax ; Src
		call	sscanf
		cmp	eax, 2
		jnz	short loc_401850
		lea	eax, [ebp+var_59D]
		mov	edx, eax
		mov	eax, offset aEnd ; "END"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401850
		mov	[ebp+var_20], 1
		jmp	loc_401958
; ---------------------------------------------------------------------------

loc_401850:				; CODE XREF: sub_401700+117j
					; sub_401700+142j
		lea	eax, [ebp+Buf]
		mov	[ebp+var_9AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_30]
		cmp	eax, [ebp+var_34]
		jbe	short loc_4018E9
		add	[ebp+var_34], 0C8h
		mov	eax, [ebp+var_34]
		add	eax, 1
		mov	[esp+9C8h+Format], eax ; NewSize
		mov	eax, [ebp+Memory]
		mov	[esp+9C8h+Src],	eax ; Memory
		call	realloc
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jnz	short loc_4018E3
		mov	eax, [ebp+Memory]
		mov	[esp+9C8h+Src],	eax ; Memory
		call	free
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory\n"
		mov	[esp+9C8h+var_9BC], edx	; File
		mov	[esp+9C8h+File], 17h ; Count
		mov	[esp+9C8h+Format], 1 ; Size
		mov	[esp+9C8h+Src],	eax ; Str
		call	fwrite
		mov	[ebp+var_24], 5
		jmp	loc_401C67
; ---------------------------------------------------------------------------

loc_4018E3:				; CODE XREF: sub_401700+1A3j
		mov	eax, [ebp+var_38]
		mov	[ebp+Memory], eax

loc_4018E9:				; CODE XREF: sub_401700+17Ej
		lea	eax, [ebp+Buf]
		mov	edx, [ebp+var_30]
		mov	ecx, [ebp+Memory]
		add	edx, ecx
		mov	[esp+9C8h+Format], eax ; Source
		mov	[esp+9C8h+Src],	edx ; Dest
		call	strcpy
		lea	eax, [ebp+Buf]
		mov	[ebp+var_9AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_30], eax
		jmp	short loc_401931
; ---------------------------------------------------------------------------

loc_401930:				; CODE XREF: sub_401700+CEj
		nop

loc_401931:				; CODE XREF: sub_401700+22Ej
		mov	eax, ds:File
		mov	[esp+9C8h+File], eax ; File
		mov	[esp+9C8h+Format], 408h	; MaxCount
		lea	eax, [ebp+Buf]
		mov	[esp+9C8h+Src],	eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_4017E9

loc_401958:				; CODE XREF: sub_401700+14Bj
		cmp	[ebp+var_20], 0
		jnz	short loc_401993
		mov	edx, offset aGpgkeysNoKeySE ; "gpgkeys:	no KEY %s END found\n"
		mov	eax, ds:dword_410028
		lea	ecx, [ebp+var_597]
		mov	[esp+9C8h+File], ecx
		mov	[esp+9C8h+Format], edx ; Format
		mov	[esp+9C8h+Src],	eax ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 1
		mov	[ebp+var_24], 8
		jmp	loc_401C67
; ---------------------------------------------------------------------------

loc_401993:				; CODE XREF: sub_401700+25Cj
		mov	eax, [ebp+var_30]
		mov	[esp+9C8h+Format], eax
		mov	eax, [ebp+Memory]
		mov	[esp+9C8h+Src],	eax
		mov	eax, ds:curl_escape
		call	eax ; curl_escape
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_4019E3
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory\n"
		mov	[esp+9C8h+var_9BC], edx	; File
		mov	[esp+9C8h+File], 17h ; Count
		mov	[esp+9C8h+Format], 1 ; Size
		mov	[esp+9C8h+Src],	eax ; Str
		call	fwrite
		mov	[ebp+var_24], 5
		jmp	loc_401C67
; ---------------------------------------------------------------------------

loc_4019E3:				; CODE XREF: sub_401700+2AEj
		mov	eax, [ebp+Memory]
		mov	[esp+9C8h+Src],	eax ; Memory
		call	free
		mov	[esp+9C8h+File], 0
		mov	eax, [ebp+var_2C]
		mov	[esp+9C8h+Format], eax
		mov	[esp+9C8h+Src],	offset aKeytext	; "keytext="
		call	sub_406863
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_401A45
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory\n"
		mov	[esp+9C8h+var_9BC], edx	; File
		mov	[esp+9C8h+File], 17h ; Count
		mov	[esp+9C8h+Format], 1 ; Size
		mov	[esp+9C8h+Src],	eax ; Str
		call	fwrite
		mov	[ebp+var_24], 5
		jmp	loc_401C67
; ---------------------------------------------------------------------------

loc_401A45:				; CODE XREF: sub_401700+310j
		mov	eax, ds:Source
		mov	[esp+9C8h+Format], eax ; Source
		lea	eax, [ebp+Dest]
		mov	[esp+9C8h+Src],	eax ; Dest
		call	strcpy
		mov	ebx, offset asc_40E0B9 ; "://"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_9AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Dest]
		add	edx, eax
		mov	eax, [ebx]
		mov	[edx], eax
		mov	eax, ds:dword_410030
		mov	eax, [eax+4]
		mov	[esp+9C8h+Format], eax ; Source
		lea	eax, [ebp+Dest]
		mov	[esp+9C8h+Src],	eax ; Dest
		call	strcat
		mov	ebx, offset asc_40E0BD ; ":"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_9AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Dest]
		add	edx, eax
		movzx	eax, word ptr [ebx]
		mov	[edx], ax
		mov	eax, ds:dword_410144
		mov	[esp+9C8h+Format], eax ; Source
		lea	eax, [ebp+Dest]
		mov	[esp+9C8h+Src],	eax ; Dest
		call	strcat
		mov	eax, ds:dword_410030
		mov	eax, [eax+14h]
		mov	[esp+9C8h+Format], eax ; Source
		lea	eax, [ebp+Dest]
		mov	[esp+9C8h+Src],	eax ; Dest
		call	strcat
		mov	[esp+9C8h+Format], offset aPksAdd ; "/pks/add"
		lea	eax, [ebp+Dest]
		mov	[esp+9C8h+Src],	eax ; char *
		call	sub_401639
		mov	eax, ds:dword_410030
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_401B5E
		mov	edx, offset aGpgkeysHttpUrl ; "gpgkeys:	HTTP URL is `%s'\n"
		mov	eax, ds:dword_410028
		lea	ecx, [ebp+Dest]
		mov	[esp+9C8h+File], ecx
		mov	[esp+9C8h+Format], edx ; Format
		mov	[esp+9C8h+Src],	eax ; File
		call	fprintf

loc_401B5E:				; CODE XREF: sub_401700+43Cj
		mov	[ebp+var_3C], 2712h
		mov	edx, [ebp+var_3C]
		mov	eax, ds:dword_41002C
		lea	ecx, [ebp+Dest]
		mov	[esp+9C8h+File], ecx
		mov	[esp+9C8h+Format], edx
		mov	[esp+9C8h+Src],	eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[ebp+var_40], 2Fh
		mov	edx, [ebp+var_40]
		mov	eax, ds:dword_41002C
		mov	[esp+9C8h+File], 1
		mov	[esp+9C8h+Format], edx
		mov	[esp+9C8h+Src],	eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[ebp+var_44], 271Fh
		mov	edx, [ebp+var_44]
		mov	eax, ds:dword_41002C
		mov	ecx, [ebp+Memory]
		mov	[esp+9C8h+File], ecx
		mov	[esp+9C8h+Format], edx
		mov	[esp+9C8h+Src],	eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[ebp+var_48], 2Dh
		mov	edx, [ebp+var_48]
		mov	eax, ds:dword_41002C
		mov	[esp+9C8h+File], 1
		mov	[esp+9C8h+Format], edx
		mov	[esp+9C8h+Src],	eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_41002C
		mov	[esp+9C8h+Src],	eax
		mov	eax, ds:curl_easy_perform
		call	eax ; curl_easy_perform
		mov	[ebp+var_4C], eax
		cmp	[ebp+var_4C], 0
		jz	short loc_401C40
		mov	edx, offset aGpgkeysHttpPos ; "gpgkeys:	HTTP post error	%d: %s\n"
		mov	eax, ds:dword_410028
		mov	[esp+9C8h+var_9BC], offset dword_410040
		mov	ecx, [ebp+var_4C]
		mov	[esp+9C8h+File], ecx
		mov	[esp+9C8h+Format], edx ; Format
		mov	[esp+9C8h+Src],	eax ; File
		call	fprintf
		mov	eax, [ebp+var_4C]
		mov	[esp+9C8h+Src],	eax
		call	sub_4045A5
		mov	[ebp+var_24], eax
		jmp	short loc_401C67
; ---------------------------------------------------------------------------

loc_401C40:				; CODE XREF: sub_401700+509j
		mov	edx, offset aKeySSent ;	"\nKEY %s SENT\n"
		mov	eax, ds:dword_410024
		lea	ecx, [ebp+var_597]
		mov	[esp+9C8h+File], ecx
		mov	[esp+9C8h+Format], edx ; Format
		mov	[esp+9C8h+Src],	eax ; File
		call	fprintf
		mov	[ebp+var_24], 0

loc_401C67:				; CODE XREF: sub_401700+E4j
					; sub_401700+1DEj ...
		mov	eax, [ebp+Memory]
		mov	[esp+9C8h+Src],	eax ; void *
		call	sub_404E81
		mov	eax, [ebp+var_2C]
		mov	[esp+9C8h+Src],	eax
		mov	eax, ds:curl_free
		call	eax ; curl_free
		cmp	[ebp+var_24], 0
		jz	short loc_401CB2
		cmp	[ebp+var_1C], 0
		jz	short loc_401CB2
		mov	edx, offset aKeySFailedD ; "KEY	%s FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	ecx, [ebp+var_24]
		mov	[esp+9C8h+var_9BC], ecx
		lea	ecx, [ebp+var_597]
		mov	[esp+9C8h+File], ecx
		mov	[esp+9C8h+Format], edx ; Format
		mov	[esp+9C8h+Src],	eax ; File
		call	fprintf

loc_401CB2:				; CODE XREF: sub_401700+583j
					; sub_401700+589j
		mov	eax, [ebp+var_24]
		add	esp, 9BCh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401700	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401CC0	proc near		; CODE XREF: sub_402A9B+CA8p

File		= dword	ptr -608h
Format		= dword	ptr -604h
Count		= dword	ptr -600h
var_5FC		= dword	ptr -5FCh
var_5EC		= dword	ptr -5ECh
var_5DC		= dword	ptr -5DCh
var_5D8		= byte ptr -5D8h
var_5C0		= dword	ptr -5C0h
Dest		= byte ptr -5BBh
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Source		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5FCh
		lea	eax, [ebp+var_5D8]
		mov	edx, eax
		mov	ecx, 0
		mov	eax, 1Ch
		mov	ebx, eax
		and	ebx, 0FFFFFFFCh
		mov	eax, 0

loc_401CE8:				; CODE XREF: sub_401CC0+30j
		mov	[edx+eax], ecx
		add	eax, 4
		cmp	eax, ebx
		jb	short loc_401CE8
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset a0x	; "0x"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401D20
		add	[ebp+arg_0], 2

loc_401D20:				; CODE XREF: sub_401CC0+5Aj
		mov	edx, offset aKey0xSBegin ; "KEY	0x%s BEGIN\n"
		mov	eax, ds:dword_410024
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_5EC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5EC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 20h
		jnz	short loc_401DBD
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysHkpKeys ; "gpgkeys:	HKP keyservers do not support "...
		mov	[esp+608h+var_5FC], edx	; File
		mov	[esp+608h+Count], 37h ;	Count
		mov	[esp+608h+Format], 1 ; Size
		mov	[esp+608h+File], eax ; Str
		call	fwrite
		mov	edx, offset aKey0xSFailedD ; "KEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	[esp+608h+var_5FC], 2
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		mov	eax, 2
		jmp	loc_402227
; ---------------------------------------------------------------------------

loc_401DBD:				; CODE XREF: sub_401CC0+A5j
		mov	eax, ds:Source
		mov	[esp+608h+Format], eax ; Source
		lea	eax, [ebp+Dest]
		mov	[esp+608h+File], eax ; Dest
		call	strcpy
		mov	ebx, offset asc_40E0B9 ; "://"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_5EC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5EC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Dest]
		add	edx, eax
		mov	eax, [ebx]
		mov	[edx], eax
		mov	eax, ds:dword_410030
		mov	eax, [eax+4]
		mov	[esp+608h+Format], eax ; Source
		lea	eax, [ebp+Dest]
		mov	[esp+608h+File], eax ; Dest
		call	strcat
		mov	ebx, offset asc_40E0BD ; ":"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_5EC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5EC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Dest]
		add	edx, eax
		movzx	eax, word ptr [ebx]
		mov	[edx], ax
		mov	eax, ds:dword_410144
		mov	[esp+608h+Format], eax ; Source
		lea	eax, [ebp+Dest]
		mov	[esp+608h+File], eax ; Dest
		call	strcat
		mov	eax, ds:dword_410030
		mov	eax, [eax+14h]
		mov	[esp+608h+Format], eax ; Source
		lea	eax, [ebp+Dest]
		mov	[esp+608h+File], eax ; Dest
		call	strcat
		mov	[esp+608h+Format], offset aPksLookup?opGe ; "/pks/lookup?op=get&options=mr&search=0x"
		lea	eax, [ebp+Dest]
		mov	[esp+608h+File], eax ; char *
		call	sub_401639
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_5EC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5EC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 27h
		jbe	short loc_401EE5
		mov	eax, [ebp+var_20]
		sub	eax, 28h
		add	eax, [ebp+arg_0]
		mov	[ebp+Source], eax
		jmp	short loc_401F13
; ---------------------------------------------------------------------------

loc_401EE5:				; CODE XREF: sub_401CC0+215j
		cmp	[ebp+var_20], 0Fh
		jbe	short loc_401EF9
		mov	eax, [ebp+var_20]
		sub	eax, 10h
		add	eax, [ebp+arg_0]
		mov	[ebp+Source], eax
		jmp	short loc_401F13
; ---------------------------------------------------------------------------

loc_401EF9:				; CODE XREF: sub_401CC0+229j
		cmp	[ebp+var_20], 7
		jbe	short loc_401F0D
		mov	eax, [ebp+var_20]
		sub	eax, 8
		add	eax, [ebp+arg_0]
		mov	[ebp+Source], eax
		jmp	short loc_401F13
; ---------------------------------------------------------------------------

loc_401F0D:				; CODE XREF: sub_401CC0+23Dj
		mov	eax, [ebp+arg_0]
		mov	[ebp+Source], eax

loc_401F13:				; CODE XREF: sub_401CC0+223j
					; sub_401CC0+237j ...
		mov	eax, [ebp+Source]
		mov	[esp+608h+Format], eax ; Source
		lea	eax, [ebp+Dest]
		mov	[esp+608h+File], eax ; Dest
		call	strcat
		mov	eax, ds:dword_410030
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_401F55
		mov	edx, offset aGpgkeysHttpUrl ; "gpgkeys:	HTTP URL is `%s'\n"
		mov	eax, ds:dword_410028
		lea	ecx, [ebp+Dest]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf

loc_401F55:				; CODE XREF: sub_401CC0+273j
		mov	[ebp+var_24], 2712h
		mov	edx, [ebp+var_24]
		mov	eax, ds:dword_41002C
		lea	ecx, [ebp+Dest]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx
		mov	[esp+608h+File], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[ebp+var_28], 4E2Bh
		mov	edx, [ebp+var_28]
		mov	eax, ds:dword_41002C
		mov	[esp+608h+Count], offset sub_404779
		mov	[esp+608h+Format], edx
		mov	[esp+608h+File], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_410024
		mov	[ebp+var_5C0], eax
		mov	[ebp+var_2C], 2711h
		mov	edx, [ebp+var_2C]
		mov	eax, ds:dword_41002C
		lea	ecx, [ebp+var_5D8]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx
		mov	[esp+608h+File], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_41002C
		mov	[esp+608h+File], eax
		mov	eax, ds:curl_easy_perform
		call	eax ; curl_easy_perform
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	short loc_402042
		mov	edx, offset aGpgkeysHttpFet ; "gpgkeys:	HTTP fetch error %d: %s\n"
		mov	eax, ds:dword_410028
		mov	[esp+608h+var_5FC], offset dword_410040
		mov	ecx, [ebp+var_30]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		mov	eax, [ebp+var_30]
		mov	[esp+608h+File], eax
		call	sub_4045A5
		mov	ecx, offset aKey0xSFailed_0 ; "\nKEY 0x%s FAILED %d\n"
		mov	edx, ds:dword_410024
		mov	[esp+608h+var_5FC], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+608h+Count], eax
		mov	[esp+608h+Format], ecx ; Format
		mov	[esp+608h+File], edx ; File
		call	fprintf
		jmp	loc_402222
; ---------------------------------------------------------------------------

loc_402042:				; CODE XREF: sub_401CC0+329j
		mov	[ebp+var_5DC], 0
		lea	eax, [ebp+var_5D8]
		mov	[esp+608h+File], eax
		call	sub_404955
		mov	[ebp+var_34], 200002h
		mov	edx, [ebp+var_34]
		mov	eax, ds:dword_41002C
		lea	ecx, [ebp+var_5DC]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx
		mov	[esp+608h+File], eax
		mov	eax, ds:curl_easy_getinfo
		call	eax ; curl_easy_getinfo
		mov	eax, ds:dword_410030
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_4020AE
		mov	ecx, [ebp+var_5DC]
		mov	edx, offset aGpgkeysHttpRes ; "gpgkeys:	HTTP response code is %ld\n"
		mov	eax, ds:dword_410028
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf

loc_4020AE:				; CODE XREF: sub_401CC0+3CCj
		mov	eax, [ebp+var_5DC]
		cmp	eax, 0C8h
		jnz	loc_40218F
		movzx	eax, [ebp+var_5D8]
		and	eax, 4
		test	al, al
		jnz	loc_40216D
		movzx	eax, [ebp+var_5D8]
		and	eax, 2
		test	al, al
		jz	short loc_402126
		mov	edx, offset aGpgkeysKeySPar ; "gpgkeys:	key %s partially retrieved (pr"...
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailed_0 ; "\nKEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	[esp+608h+var_5FC], 8
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		jmp	loc_402222
; ---------------------------------------------------------------------------

loc_402126:				; CODE XREF: sub_401CC0+41Dj
		mov	edx, offset aGpgkeysKeySCan ; "gpgkeys:	key %s can't be retrieved\n"
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailed_0 ; "\nKEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	[esp+608h+var_5FC], 4
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		jmp	loc_402222
; ---------------------------------------------------------------------------

loc_40216D:				; CODE XREF: sub_401CC0+40Bj
		mov	edx, offset aKey0xSEnd ; "\nKEY	0x%s END\n"
		mov	eax, ds:dword_410024
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		jmp	loc_402222
; ---------------------------------------------------------------------------

loc_40218F:				; CODE XREF: sub_401CC0+3F9j
		mov	eax, [ebp+var_5DC]
		cmp	eax, 194h
		jnz	short loc_4021E0
		mov	edx, offset aGpgkeysKeySNot ; "gpgkeys:	key %s not found on keyserver\"...
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailed_0 ; "\nKEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	[esp+608h+var_5FC], 6
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		jmp	short loc_402222
; ---------------------------------------------------------------------------

loc_4021E0:				; CODE XREF: sub_401CC0+4DAj
		mov	edx, offset aGpgkeysKeySCan ; "gpgkeys:	key %s can't be retrieved\n"
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailed_0 ; "\nKEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	[esp+608h+var_5FC], 4
		mov	ecx, [ebp+arg_0]
		mov	[esp+608h+Count], ecx
		mov	[esp+608h+Format], edx ; Format
		mov	[esp+608h+File], eax ; File
		call	fprintf

loc_402222:				; CODE XREF: sub_401CC0+37Dj
					; sub_401CC0+461j ...
		mov	eax, 0

loc_402227:				; CODE XREF: sub_401CC0+F8j
		add	esp, 5FCh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401CC0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402232	proc near		; CODE XREF: sub_402A9B+D12p

Str		= dword	ptr -88h
Size		= dword	ptr -84h
Count		= dword	ptr -80h
File		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 1
		lea	eax, [ebp+var_54]
		mov	edx, eax
		mov	ecx, 0
		mov	eax, 1Ch
		mov	ebx, eax
		and	ebx, 0FFFFFFFCh
		mov	eax, 0

loc_402262:				; CODE XREF: sub_402232+38j
		mov	[edx+eax], ecx
		add	eax, 4
		cmp	eax, ebx
		jb	short loc_402262
		add	edx, eax
		mov	[esp+88h+Size],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		mov	eax, ds:curl_escape
		call	eax ; curl_escape
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_4022BF
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory\n"
		mov	[esp+88h+File],	edx ; File
		mov	[esp+88h+Count], 17h ; Count
		mov	[esp+88h+Size],	1 ; Size
		mov	[esp+88h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_20], 5
		jmp	loc_4025DD
; ---------------------------------------------------------------------------

loc_4022BF:				; CODE XREF: sub_402232+58j
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_4022D2
		mov	ebx, offset aExactOn ; "&exact=on"
		jmp	short loc_4022D7
; ---------------------------------------------------------------------------

loc_4022D2:				; CODE XREF: sub_402232+97j
		mov	ebx, offset Src

loc_4022D7:				; CODE XREF: sub_402232+9Ej
		mov	eax, ds:dword_410030
		mov	eax, [eax+14h]
		mov	[esp+88h+Size],	offset aPksLookup?op_0 ; "/pks/lookup?op=get&options=mr&search="
		mov	[esp+88h+Str], eax
		call	sub_4016A6
		mov	edx, ds:dword_410030
		mov	edi, [edx+14h]
		mov	esi, ds:dword_410144
		mov	edx, ds:dword_410030
		mov	ecx, [edx+4]
		mov	edx, ds:Source
		mov	[esp+88h+var_64], 0
		mov	[esp+88h+var_68], ebx
		mov	ebx, [ebp+var_24]
		mov	[esp+88h+var_6C], ebx
		mov	[esp+88h+var_70], eax
		mov	[esp+88h+var_74], edi
		mov	[esp+88h+var_78], esi
		mov	[esp+88h+File],	offset asc_40E0BD ; ":"
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	offset asc_40E0B9 ; "://"
		mov	[esp+88h+Str], edx
		call	sub_406863
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_402384
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory\n"
		mov	[esp+88h+File],	edx ; File
		mov	[esp+88h+Count], 17h ; Count
		mov	[esp+88h+Size],	1 ; Size
		mov	[esp+88h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_20], 5
		jmp	loc_4025DD
; ---------------------------------------------------------------------------

loc_402384:				; CODE XREF: sub_402232+11Dj
		mov	edx, offset aNameSBegin	; "NAME	%s BEGIN\n"
		mov	eax, ds:dword_410024
		mov	ecx, [ebp+arg_0]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf
		mov	eax, ds:dword_410030
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_4023CB
		mov	edx, offset aGpgkeysHttpUrl ; "gpgkeys:	HTTP URL is `%s'\n"
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+var_1C]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf

loc_4023CB:				; CODE XREF: sub_402232+17Aj
		mov	[ebp+var_28], 2712h
		mov	edx, [ebp+var_28]
		mov	eax, ds:dword_41002C
		mov	ecx, [ebp+var_1C]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx
		mov	[esp+88h+Str], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[ebp+var_2C], 4E2Bh
		mov	edx, [ebp+var_2C]
		mov	eax, ds:dword_41002C
		mov	[esp+88h+Count], offset	sub_404779
		mov	[esp+88h+Size],	edx
		mov	[esp+88h+Str], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_410024
		mov	[ebp+var_3C], eax
		mov	[ebp+var_30], 2711h
		mov	edx, [ebp+var_30]
		mov	eax, ds:dword_41002C
		lea	ecx, [ebp+var_54]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx
		mov	[esp+88h+Str], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_41002C
		mov	[esp+88h+Str], eax
		mov	eax, ds:curl_easy_perform
		call	eax ; curl_easy_perform
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_402490
		mov	edx, offset aGpgkeysHttpFet ; "gpgkeys:	HTTP fetch error %d: %s\n"
		mov	eax, ds:dword_410028
		mov	[esp+88h+File],	offset dword_410040
		mov	ecx, [ebp+var_34]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Str], eax
		call	sub_4045A5
		mov	[ebp+var_20], eax
		jmp	loc_4025DD
; ---------------------------------------------------------------------------

loc_402490:				; CODE XREF: sub_402232+224j
		mov	[ebp+var_58], 0
		lea	eax, [ebp+var_54]
		mov	[esp+88h+Str], eax
		call	sub_404955
		mov	[ebp+var_38], 200002h
		mov	edx, [ebp+var_38]
		mov	eax, ds:dword_41002C
		lea	ecx, [ebp+var_58]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx
		mov	[esp+88h+Str], eax
		mov	eax, ds:curl_easy_getinfo
		call	eax ; curl_easy_getinfo
		mov	eax, ds:dword_410030
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_4024F0
		mov	ecx, [ebp+var_58]
		mov	edx, offset aGpgkeysHttpRes ; "gpgkeys:	HTTP response code is %ld\n"
		mov	eax, ds:dword_410028
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf

loc_4024F0:				; CODE XREF: sub_402232+29Fj
		mov	eax, [ebp+var_58]
		cmp	eax, 0C8h
		jnz	loc_402589
		movzx	eax, [ebp+var_54]
		and	eax, 4
		test	al, al
		jnz	short loc_402563
		movzx	eax, [ebp+var_54]
		and	eax, 2
		test	al, al
		jz	short loc_40253D
		mov	edx, offset aGpgkeysKeySPar ; "gpgkeys:	key %s partially retrieved (pr"...
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+arg_0]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf
		mov	[ebp+var_20], 8
		jmp	loc_4025DD
; ---------------------------------------------------------------------------

loc_40253D:				; CODE XREF: sub_402232+2E0j
		mov	edx, offset aGpgkeysKeySCan ; "gpgkeys:	key %s can't be retrieved\n"
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+arg_0]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf
		mov	[ebp+var_20], 4
		jmp	short loc_4025DD
; ---------------------------------------------------------------------------

loc_402563:				; CODE XREF: sub_402232+2D5j
		mov	edx, offset aNameSEnd ;	"\nNAME	%s END\n"
		mov	eax, ds:dword_410024
		mov	ecx, [ebp+arg_0]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf
		mov	[ebp+var_20], 0
		jmp	short loc_4025DD
; ---------------------------------------------------------------------------

loc_402589:				; CODE XREF: sub_402232+2C6j
		mov	eax, [ebp+var_58]
		cmp	eax, 194h
		jnz	short loc_4025B9
		mov	edx, offset aGpgkeysKeySNot ; "gpgkeys:	key %s not found on keyserver\"...
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+arg_0]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf
		mov	[ebp+var_20], 6
		jmp	short loc_4025DD
; ---------------------------------------------------------------------------

loc_4025B9:				; CODE XREF: sub_402232+35Fj
		mov	edx, offset aGpgkeysKeySCan ; "gpgkeys:	key %s can't be retrieved\n"
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+arg_0]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf
		mov	[ebp+var_20], 4

loc_4025DD:				; CODE XREF: sub_402232+88j
					; sub_402232+14Dj ...
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax
		mov	eax, ds:curl_free
		call	eax ; curl_free
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+Str], eax ; void *
		call	sub_404E81
		cmp	[ebp+var_20], 0
		jz	short loc_40261F
		mov	edx, offset aNameSFailedD ; "\nNAME %s FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	ecx, [ebp+var_20]
		mov	[esp+88h+File],	ecx
		mov	ecx, [ebp+arg_0]
		mov	[esp+88h+Count], ecx
		mov	[esp+88h+Size],	edx ; Format
		mov	[esp+88h+Str], eax ; File
		call	fprintf

loc_40261F:				; CODE XREF: sub_402232+3C7j
		mov	eax, [ebp+var_20]
		add	esp, 7Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_402232	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40262A	proc near		; CODE XREF: sub_402A9B+F51p

File		= dword	ptr -78h
Format		= dword	ptr -74h
Count		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 1
		lea	eax, [ebp+arg_0]
		mov	[esp+78h+File],	eax
		call	sub_40445C
		mov	[ebp+var_24], eax
		mov	eax, ds:dword_410030
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40267F
		mov	ecx, [ebp+arg_0]
		mov	edx, offset aGpgkeysSearchT ; "gpgkeys:	search type is %d, and key is "...
		mov	eax, ds:dword_410028
		mov	[esp+78h+var_6C], ecx
		mov	ecx, [ebp+var_24]
		mov	[esp+78h+Count], ecx
		mov	[esp+78h+Format], edx ;	Format
		mov	[esp+78h+File],	eax ; File
		call	fprintf

loc_40267F:				; CODE XREF: sub_40262A+2Fj
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Format], 0
		mov	[esp+78h+File],	eax
		mov	eax, ds:curl_escape
		call	eax ; curl_escape
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_4026D0
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory\n"
		mov	[esp+78h+var_6C], edx ;	File
		mov	[esp+78h+Count], 17h ; Count
		mov	[esp+78h+Format], 1 ; Size
		mov	[esp+78h+File],	eax ; Str
		call	fwrite
		mov	[ebp+var_20], 5
		jmp	loc_4028DF
; ---------------------------------------------------------------------------

loc_4026D0:				; CODE XREF: sub_40262A+71j
		cmp	[ebp+var_24], 5
		jz	short loc_4026DC
		cmp	[ebp+var_24], 4
		jnz	short loc_4026E3

loc_4026DC:				; CODE XREF: sub_40262A+AAj
		mov	eax, offset a0x	; "0x"
		jmp	short loc_4026E8
; ---------------------------------------------------------------------------

loc_4026E3:				; CODE XREF: sub_40262A+B0j
		mov	eax, offset Src

loc_4026E8:				; CODE XREF: sub_40262A+B7j
		mov	[ebp+var_2C], eax
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_4026FE
		mov	ebx, offset aExactOn ; "&exact=on"
		jmp	short loc_402703
; ---------------------------------------------------------------------------

loc_4026FE:				; CODE XREF: sub_40262A+CBj
		mov	ebx, offset Src

loc_402703:				; CODE XREF: sub_40262A+D2j
		mov	eax, ds:dword_410030
		mov	eax, [eax+14h]
		mov	[esp+78h+Format], offset aPksLookup?opIn ; "/pks/lookup?op=index&options=mr&search="
		mov	[esp+78h+File],	eax
		call	sub_4016A6
		mov	edx, ds:dword_410030
		mov	edi, [edx+14h]
		mov	esi, ds:dword_410144
		mov	edx, ds:dword_410030
		mov	ecx, [edx+4]
		mov	edx, ds:Source
		mov	[esp+78h+var_50], 0
		mov	[esp+78h+var_54], ebx
		mov	ebx, [ebp+var_28]
		mov	[esp+78h+var_58], ebx
		mov	ebx, [ebp+var_2C]
		mov	[esp+78h+var_5C], ebx
		mov	[esp+78h+var_60], eax
		mov	[esp+78h+var_64], edi
		mov	[esp+78h+var_68], esi
		mov	[esp+78h+var_6C], offset asc_40E0BD ; ":"
		mov	[esp+78h+Count], ecx
		mov	[esp+78h+Format], offset asc_40E0B9 ; "://"
		mov	[esp+78h+File],	edx
		call	sub_406863
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4027B7
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory\n"
		mov	[esp+78h+var_6C], edx ;	File
		mov	[esp+78h+Count], 17h ; Count
		mov	[esp+78h+Format], 1 ; Size
		mov	[esp+78h+File],	eax ; Str
		call	fwrite
		mov	[ebp+var_20], 5
		jmp	loc_4028DF
; ---------------------------------------------------------------------------

loc_4027B7:				; CODE XREF: sub_40262A+158j
		mov	ecx, [ebp+arg_0]
		mov	edx, offset aSearchSBegin ; "SEARCH %s BEGIN\n"
		mov	eax, ds:dword_410024
		mov	[esp+78h+Count], ecx
		mov	[esp+78h+Format], edx ;	Format
		mov	[esp+78h+File],	eax ; File
		call	fprintf
		mov	eax, ds:dword_410030
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_4027FE
		mov	edx, offset aGpgkeysHttpUrl ; "gpgkeys:	HTTP URL is `%s'\n"
		mov	eax, ds:dword_410028
		mov	ecx, [ebp+var_1C]
		mov	[esp+78h+Count], ecx
		mov	[esp+78h+Format], edx ;	Format
		mov	[esp+78h+File],	eax ; File
		call	fprintf

loc_4027FE:				; CODE XREF: sub_40262A+1B5j
		mov	[ebp+var_30], 2712h
		mov	edx, [ebp+var_30]
		mov	eax, ds:dword_41002C
		mov	ecx, [ebp+var_1C]
		mov	[esp+78h+Count], ecx
		mov	[esp+78h+Format], edx
		mov	[esp+78h+File],	eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[ebp+var_34], 4E2Bh
		mov	edx, [ebp+var_34]
		mov	eax, ds:dword_41002C
		mov	[esp+78h+Count], offset	sub_4015C8
		mov	[esp+78h+Format], edx
		mov	[esp+78h+File],	eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[ebp+var_38], 2711h
		mov	ecx, ds:dword_410024
		mov	edx, [ebp+var_38]
		mov	eax, ds:dword_41002C
		mov	[esp+78h+Count], ecx
		mov	[esp+78h+Format], edx
		mov	[esp+78h+File],	eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_41002C
		mov	[esp+78h+File],	eax
		mov	eax, ds:curl_easy_perform
		call	eax ; curl_easy_perform
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_4028BB
		mov	edx, offset aGpgkeysHttpSea ; "gpgkeys:	HTTP search error %d: %s\n"
		mov	eax, ds:dword_410028
		mov	[esp+78h+var_6C], offset dword_410040
		mov	ecx, [ebp+var_3C]
		mov	[esp+78h+Count], ecx
		mov	[esp+78h+Format], edx ;	Format
		mov	[esp+78h+File],	eax ; File
		call	fprintf
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+File],	eax
		call	sub_4045A5
		mov	[ebp+var_20], eax
		jmp	short loc_4028DF
; ---------------------------------------------------------------------------

loc_4028BB:				; CODE XREF: sub_40262A+25Aj
		mov	ecx, [ebp+arg_0]
		mov	edx, offset aSearchSEnd	; "\nSEARCH %s END\n"
		mov	eax, ds:dword_410024
		mov	[esp+78h+Count], ecx
		mov	[esp+78h+Format], edx ;	Format
		mov	[esp+78h+File],	eax ; File
		call	fprintf
		mov	[ebp+var_20], 0

loc_4028DF:				; CODE XREF: sub_40262A+A1j
					; sub_40262A+188j ...
		mov	eax, [ebp+var_28]
		mov	[esp+78h+File],	eax
		mov	eax, ds:curl_free
		call	eax ; curl_free
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+File],	eax ; void *
		call	sub_404E81
		cmp	[ebp+var_20], 0
		jz	short loc_402921
		mov	ecx, [ebp+arg_0]
		mov	edx, offset aSearchSFailedD ; "\nSEARCH	%s FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	ebx, [ebp+var_20]
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+Count], ecx
		mov	[esp+78h+Format], edx ;	Format
		mov	[esp+78h+File],	eax ; File
		call	fprintf

loc_402921:				; CODE XREF: sub_40262A+2D1j
		mov	eax, [ebp+var_20]
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40262A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40292C	proc near		; CODE XREF: sub_402A9B+E74p

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		cmp	[ebp+arg_0], 0
		jz	loc_4029FC
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 4
		jnz	loc_4029F4
		mov	edx, ds:dword_410024
		mov	eax, offset aSearch ; "SEARCH "
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 7 ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		jmp	short loc_40299F
; ---------------------------------------------------------------------------

loc_402976:				; CODE XREF: sub_40292C+77j
		mov	ecx, [ebp+arg_0]
		mov	edx, offset aS	; "%s "
		mov	eax, ds:dword_410024
		mov	[esp+18h+Count], ecx
		mov	[esp+18h+Size],	edx ; Format
		mov	[esp+18h+Str], eax ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+408h]
		mov	[ebp+arg_0], eax

loc_40299F:				; CODE XREF: sub_40292C+48j
		cmp	[ebp+arg_0], 0
		jnz	short loc_402976
		mov	edx, offset aFailedD ; "FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	ecx, [ebp+arg_4]
		mov	[esp+18h+Count], ecx
		mov	[esp+18h+Size],	edx ; Format
		mov	[esp+18h+Str], eax ; File
		call	fprintf
		jmp	short loc_4029FD
; ---------------------------------------------------------------------------

loc_4029C4:				; CODE XREF: sub_40292C+CCj
		mov	ecx, [ebp+arg_0]
		mov	edx, offset aKeySFailedD ; "KEY	%s FAILED %d\n"
		mov	eax, ds:dword_410024
		mov	ebx, [ebp+arg_4]
		mov	[esp+18h+File],	ebx
		mov	[esp+18h+Count], ecx
		mov	[esp+18h+Size],	edx ; Format
		mov	[esp+18h+Str], eax ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+408h]
		mov	[ebp+arg_0], eax

loc_4029F4:				; CODE XREF: sub_40292C+1Bj
		cmp	[ebp+arg_0], 0
		jnz	short loc_4029C4
		jmp	short loc_4029FD
; ---------------------------------------------------------------------------

loc_4029FC:				; CODE XREF: sub_40292C+Bj
		nop

loc_4029FD:				; CODE XREF: sub_40292C+96j
					; sub_40292C+CEj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_40292C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402A03(FILE *)
sub_402A03	proc near		; CODE XREF: sub_402A9B+129p
					; sub_402A9B+151p

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, offset aHHelpHelp ; "-h, --help\thelp\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 10h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aVMachineReadab ; "-V\t\tmachine readable version\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 1Dh ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aVersionHumanRe ; "--version\thuman	readable version\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 21h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aOOutputToThisF ; "-o\t\toutput to this file\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 18h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		leave
		retn
sub_402A03	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402A9B	proc near		; CODE XREF: sub_401180+265p

Format		= dword	ptr -5ACh
Mode		= dword	ptr -5A8h
MaxCount	= dword	ptr -5A4h
File		= dword	ptr -5A0h
var_590		= dword	ptr -590h
Str1		= byte ptr -57Dh
var_47D		= byte ptr -47Dh
var_47C		= dword	ptr -47Ch
Src		= byte ptr -478h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
Dest		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Memory		= dword	ptr -20h
Source		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 5A0h
		call	sub_40AC80
		mov	[esp+5ACh+var_10], 1
		mov	[esp+5ACh+var_14], 0
		mov	[esp+5ACh+var_18], 0
		mov	[esp+5ACh+Source], 0
		mov	[esp+5ACh+Memory], 0
		mov	[esp+5ACh+var_24], 0
		mov	[esp+5ACh+var_38], 0
		mov	[esp+5ACh+var_28], 0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	ds:dword_410028, eax
		cmp	[ebp+arg_0], 1
		jle	short loc_402B7E
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, offset aVersion ; "--version"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_402B7E
		mov	eax, offset aGpgkeys_hkpGnu ; "gpgkeys_hkp (GnuPG) %s\n"
		mov	[esp+5ACh+Mode], offset	a2_0_30	; "2.0.30"
		mov	[esp+5ACh+Format], eax ; Format
		call	printf
		mov	eax, ds:curl_version
		call	eax ; curl_version
		mov	edx, offset aUsesS ; "Uses: %s\n"
		mov	[esp+5ACh+Mode], eax
		mov	[esp+5ACh+Format], edx ; Format
		call	printf
		mov	eax, 0
		jmp	loc_403AFE
; ---------------------------------------------------------------------------

loc_402B7E:				; CODE XREF: sub_402A9B+7Dj
					; sub_402A9B+AAj
		cmp	[ebp+arg_0], 1
		jle	loc_402C94
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, offset aHelp ; "--help"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_402C94
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+5ACh+Format], eax ; FILE *
		call	sub_402A03
		mov	eax, 0
		jmp	loc_403AFE
; ---------------------------------------------------------------------------

loc_402BD3:				; CODE XREF: sub_402A9B+222j
		mov	eax, [esp+5ACh+var_3C]
		cmp	eax, 56h
		jz	short loc_402BFB
		cmp	eax, 6Fh
		jz	short loc_402C2F
		mov	eax, ds:dword_410028
		mov	[esp+5ACh+Format], eax ; FILE *
		call	sub_402A03
		mov	eax, 0
		jmp	loc_403AFE
; ---------------------------------------------------------------------------

loc_402BFB:				; CODE XREF: sub_402A9B+142j
		mov	eax, offset aDS	; "%d\n%s\n"
		mov	edx, ds:_iob
		add	edx, 20h
		mov	[esp+5ACh+File], offset	a2_0_30	; "2.0.30"
		mov	[esp+5ACh+MaxCount], 1
		mov	[esp+5ACh+Mode], eax ; Format
		mov	[esp+5ACh+Format], edx ; File
		call	fprintf
		mov	eax, 0
		jmp	loc_403AFE
; ---------------------------------------------------------------------------

loc_402C2F:				; CODE XREF: sub_402A9B+147j
		mov	edx, offset Mode ; "w"
		mov	eax, ds:Filename
		mov	[esp+5ACh+Mode], edx ; Mode
		mov	[esp+5ACh+Format], eax ; Filename
		call	fopen
		mov	ds:dword_410024, eax
		mov	eax, ds:dword_410024
		test	eax, eax
		jnz	short loc_402C93
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+5ACh+Format], eax ; int
		call	strerror
		mov	ebx, ds:Filename
		mov	ecx, offset aGpgkeysCannotO ; "gpgkeys:	Cannot open output file	`%s': "...
		mov	edx, ds:dword_410028
		mov	[esp+5ACh+File], eax
		mov	[esp+5ACh+MaxCount], ebx
		mov	[esp+5ACh+Mode], ecx ; Format
		mov	[esp+5ACh+Format], edx ; File
		call	fprintf
		mov	eax, 1
		jmp	loc_403AFE
; ---------------------------------------------------------------------------

loc_402C93:				; CODE XREF: sub_402A9B+1B6j
		nop

loc_402C94:				; CODE XREF: sub_402A9B+E7j
					; sub_402A9B+118j
		mov	[esp+5ACh+MaxCount], offset aHvo ; "hVo:"
		mov	eax, [ebp+arg_4]
		mov	[esp+5ACh+Mode], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+5ACh+Format], eax
		call	sub_40BB30
		mov	[esp+5ACh+var_3C], eax
		cmp	[esp+5ACh+var_3C], 0FFFFFFFFh
		jnz	loc_402BD3
		mov	eax, dword_40D024
		cmp	[ebp+arg_0], eax
		jle	short loc_402D41
		mov	edx, offset aR	; "r"
		mov	eax, dword_40D024
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+5ACh+Mode], edx ; Mode
		mov	[esp+5ACh+Format], eax ; Filename
		call	fopen
		mov	ds:File, eax
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_402D41
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+5ACh+Format], eax ; int
		call	strerror
		mov	edx, dword_40D024
		shl	edx, 2
		add	edx, [ebp+arg_4]
		mov	ebx, [edx]
		mov	ecx, offset aGpgkeysCanno_0 ; "gpgkeys:	Cannot open input file `%s': %"...
		mov	edx, ds:dword_410028
		mov	[esp+5ACh+File], eax
		mov	[esp+5ACh+MaxCount], ebx
		mov	[esp+5ACh+Mode], ecx ; Format
		mov	[esp+5ACh+Format], edx ; File
		call	fprintf
		mov	eax, 1
		jmp	loc_403AFE
; ---------------------------------------------------------------------------

loc_402D41:				; CODE XREF: sub_402A9B+230j
					; sub_402A9B+25Cj
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_402D54
		mov	eax, ds:_iob
		mov	ds:File, eax

loc_402D54:				; CODE XREF: sub_402A9B+2ADj
		mov	eax, ds:dword_410024
		test	eax, eax
		jnz	short loc_402D6A
		mov	eax, ds:_iob
		add	eax, 20h
		mov	ds:dword_410024, eax

loc_402D6A:				; CODE XREF: sub_402A9B+2C0j
		call	sub_403BC8
		mov	ds:dword_410030, eax
		mov	eax, ds:dword_410030
		test	eax, eax
		jnz	loc_402F6E
		mov	eax, 5
		jmp	loc_403AFE
; ---------------------------------------------------------------------------

loc_402D8B:				; CODE XREF: sub_402A9B+4FCj
		movzx	eax, [esp+5ACh+Src]
		cmp	al, 0Ah
		jz	loc_402F9F
		mov	eax, ds:dword_410030
		mov	[esp+5ACh+Mode], eax ; int
		lea	eax, [esp+5ACh+Src]
		mov	[esp+5ACh+Format], eax ; char *
		call	sub_403CD5
		mov	[esp+5ACh+var_40], eax
		cmp	[esp+5ACh+var_40], 0
		jle	short loc_402DD7
		mov	eax, [esp+5ACh+var_40]
		mov	[esp+5ACh+var_10], eax
		jmp	loc_403A2A
; ---------------------------------------------------------------------------

loc_402DD7:				; CODE XREF: sub_402A9B+327j
		cmp	[esp+5ACh+var_40], 0
		jz	loc_402F71
		mov	edx, offset aOption256s	; "OPTION %256s\n"
		lea	eax, [esp+5ACh+Src]
		lea	ecx, [esp+5ACh+Str1]
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx ; Format
		mov	[esp+5ACh+Format], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_402F75
		mov	[esp+5ACh+var_2C], 0
		lea	eax, [esp+5ACh+Str1]
		mov	[esp+5ACh+var_30], eax
		mov	[esp+5ACh+var_47D], 0
		mov	[esp+5ACh+MaxCount], 3 ; MaxCount
		mov	[esp+5ACh+Mode], offset	Str ; "no-"
		lea	eax, [esp+5ACh+Str1]
		mov	[esp+5ACh+Format], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402E67
		mov	[esp+5ACh+var_2C], 1
		lea	eax, [esp+5ACh+Str1]
		add	eax, 3
		mov	[esp+5ACh+var_30], eax

loc_402E67:				; CODE XREF: sub_402A9B+3B1j
		mov	[esp+5ACh+MaxCount], 0Ah ; MaxCount
		mov	[esp+5ACh+Mode], offset	aHttpProxy ; "http-proxy"
		mov	eax, [esp+5ACh+var_30]
		mov	[esp+5ACh+Format], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	loc_402F2D
		cmp	[esp+5ACh+var_2C], 0
		jz	short loc_402EC1
		mov	eax, [esp+5ACh+Memory]
		mov	[esp+5ACh+Format], eax ; Memory
		call	free
		mov	[esp+5ACh+Format], offset Src ;	Src
		call	_strdup
		mov	[esp+5ACh+Memory], eax
		jmp	loc_402F74
; ---------------------------------------------------------------------------

loc_402EC1:				; CODE XREF: sub_402A9B+3FDj
		mov	eax, [esp+5ACh+var_30]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	loc_402F74
		mov	eax, [esp+5ACh+var_30]
		add	eax, 0Bh
		mov	[esp+5ACh+var_590], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+5ACh+var_590]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 7Fh
		ja	short loc_402F74
		mov	eax, [esp+5ACh+Memory]
		mov	[esp+5ACh+Format], eax ; Memory
		call	free
		mov	eax, [esp+5ACh+var_30]
		add	eax, 0Bh
		mov	[esp+5ACh+Format], eax ; Src
		call	_strdup
		mov	[esp+5ACh+Memory], eax
		jmp	short loc_402F74
; ---------------------------------------------------------------------------

loc_402F2D:				; CODE XREF: sub_402A9B+3EFj
		mov	[esp+5ACh+Mode], offset	Str2 ; "try-dns-srv"
		mov	eax, [esp+5ACh+var_30]
		mov	[esp+5ACh+Format], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402F74
		cmp	[esp+5ACh+var_2C], 0
		jz	short loc_402F61
		mov	[esp+5ACh+var_28], 0
		jmp	short loc_402F74
; ---------------------------------------------------------------------------

loc_402F61:				; CODE XREF: sub_402A9B+4B7j
		mov	[esp+5ACh+var_28], 1
		jmp	short loc_402F74
; ---------------------------------------------------------------------------

loc_402F6E:				; CODE XREF: sub_402A9B+2E0j
		nop
		jmp	short loc_402F75
; ---------------------------------------------------------------------------

loc_402F71:				; CODE XREF: sub_402A9B+344j
		nop
		jmp	short loc_402F75
; ---------------------------------------------------------------------------

loc_402F74:				; CODE XREF: sub_402A9B+421j
					; sub_402A9B+435j ...
		nop

loc_402F75:				; CODE XREF: sub_402A9B+36Dj
					; sub_402A9B+4D4j ...
		mov	eax, ds:File
		mov	[esp+5ACh+MaxCount], eax ; File
		mov	[esp+5ACh+Mode], 408h ;	MaxCount
		lea	eax, [esp+5ACh+Src]
		mov	[esp+5ACh+Format], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_402D8B
		jmp	short loc_402FA0
; ---------------------------------------------------------------------------

loc_402F9F:				; CODE XREF: sub_402A9B+2FAj
		nop

loc_402FA0:				; CODE XREF: sub_402A9B+502j
		mov	eax, ds:dword_410030
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_402FE3
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysNoSchem ; "gpgkeys:	no scheme supplied!\n"
		mov	[esp+5ACh+File], edx ; File
		mov	[esp+5ACh+MaxCount], 1Dh ; Count
		mov	[esp+5ACh+Mode], 1 ; Size
		mov	[esp+5ACh+Format], eax ; Str
		call	fwrite
		mov	[esp+5ACh+var_10], 7Fh
		jmp	loc_403A2A
; ---------------------------------------------------------------------------

loc_402FE3:				; CODE XREF: sub_402A9B+50Fj
		mov	eax, ds:dword_410030
		mov	eax, [eax+0Ch]
		mov	[esp+5ACh+Mode], offset	aHkps ;	"hkps"
		mov	[esp+5ACh+Format], eax
		call	sub_404C14
		test	eax, eax
		jnz	short loc_403015
		mov	ds:Source, offset aHttps ; "https"
		mov	ds:dword_410144, offset	a443 ; "443"
		jmp	short loc_403029
; ---------------------------------------------------------------------------

loc_403015:				; CODE XREF: sub_402A9B+562j
		mov	ds:Source, offset aHttp	; "http"
		mov	ds:dword_410144, offset	a11371 ; "11371"

loc_403029:				; CODE XREF: sub_402A9B+578j
		mov	eax, ds:dword_410030
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_403061
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysNoKeyse ; "gpgkeys:	no keyserver host provided\n"
		mov	[esp+5ACh+File], edx ; File
		mov	[esp+5ACh+MaxCount], 24h ; Count
		mov	[esp+5ACh+Mode], 1 ; Size
		mov	[esp+5ACh+Format], eax ; Str
		call	fwrite
		jmp	loc_403A2A
; ---------------------------------------------------------------------------

loc_403061:				; CODE XREF: sub_402A9B+598j
		mov	eax, ds:dword_410030
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_4030A8
		call	sub_403B8A
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4030A8
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysUnableT ; "gpgkeys:	unable to register timeout han"...
		mov	[esp+5ACh+File], edx ; File
		mov	[esp+5ACh+MaxCount], 2Ch ; Count
		mov	[esp+5ACh+Mode], 1 ; Size
		mov	[esp+5ACh+Format], eax ; Str
		call	fwrite
		mov	eax, 1
		jmp	loc_403AFE
; ---------------------------------------------------------------------------

loc_4030A8:				; CODE XREF: sub_402A9B+5D0j
					; sub_402A9B+5DAj
		mov	[esp+5ACh+Format], 3
		mov	eax, ds:curl_global_init
		call	eax ; curl_global_init
		mov	eax, ds:curl_easy_init
		call	eax ; curl_easy_init
		mov	ds:dword_41002C, eax
		mov	eax, ds:dword_41002C
		test	eax, eax
		jnz	short loc_403102
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysUnabl_0 ; "gpgkeys:	unable to initialize curl\n"
		mov	[esp+5ACh+File], edx ; File
		mov	[esp+5ACh+MaxCount], 23h ; Count
		mov	[esp+5ACh+Mode], 1 ; Size
		mov	[esp+5ACh+Format], eax ; Str
		call	fwrite
		mov	[esp+5ACh+var_10], 1
		jmp	loc_403A2A
; ---------------------------------------------------------------------------

loc_403102:				; CODE XREF: sub_402A9B+62Ej
		mov	eax, ds:dword_410030
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40318C
		mov	eax, ds:curl_version
		call	eax ; curl_version
		mov	ecx, offset aGpgkeysCurlVer ; "gpgkeys:	curl version = %s\n"
		mov	edx, ds:dword_410028
		mov	[esp+5ACh+MaxCount], eax
		mov	[esp+5ACh+Mode], ecx ; Format
		mov	[esp+5ACh+Format], edx ; File
		call	fprintf
		mov	[esp+5ACh+var_44], 2735h
		mov	ecx, ds:dword_410028
		mov	edx, [esp+5ACh+var_44]
		mov	eax, ds:dword_41002C
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[esp+5ACh+var_48], 29h
		mov	edx, [esp+5ACh+var_48]
		mov	eax, ds:dword_41002C
		mov	[esp+5ACh+MaxCount], 1
		mov	[esp+5ACh+Mode], edx
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt

loc_40318C:				; CODE XREF: sub_402A9B+671j
		mov	eax, ds:dword_410030
		mov	eax, [eax+8]
		test	eax, eax
		jnz	loc_40322E
		cmp	[esp+5ACh+var_28], 0
		jz	loc_40322E
		mov	eax, ds:dword_410030
		mov	eax, [eax+0Ch]
		mov	[esp+5ACh+Mode], offset	aHkp ; "hkp"
		mov	[esp+5ACh+Format], eax
		call	sub_404C14
		test	eax, eax
		jnz	short loc_4031D3
		mov	[esp+5ACh+var_4C], offset aPgpkeyHttp ;	"pgpkey-http"
		jmp	short loc_403207
; ---------------------------------------------------------------------------

loc_4031D3:				; CODE XREF: sub_402A9B+729j
		mov	eax, ds:dword_410030
		mov	eax, [eax+0Ch]
		mov	[esp+5ACh+Mode], offset	aHkps ;	"hkps"
		mov	[esp+5ACh+Format], eax
		call	sub_404C14
		test	eax, eax
		jnz	short loc_4031FC
		mov	[esp+5ACh+var_4C], offset aPgpkeyHttps ; "pgpkey-https"
		jmp	short loc_403207
; ---------------------------------------------------------------------------

loc_4031FC:				; CODE XREF: sub_402A9B+752j
		mov	[esp+5ACh+var_4C], 0

loc_403207:				; CODE XREF: sub_402A9B+736j
					; sub_402A9B+75Fj
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysTryDnsS ; "gpgkeys:	try-dns-srv was	requested, but"...
		mov	[esp+5ACh+File], edx ; File
		mov	[esp+5ACh+MaxCount], 38h ; Count
		mov	[esp+5ACh+Mode], 1 ; Size
		mov	[esp+5ACh+Format], eax ; Str
		call	fwrite

loc_40322E:				; CODE XREF: sub_402A9B+6FBj
					; sub_402A9B+709j
		mov	eax, ds:dword_410030
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_403247
		mov	eax, ds:dword_410030
		mov	eax, [eax+8]
		mov	ds:dword_410144, eax

loc_403247:				; CODE XREF: sub_402A9B+79Dj
		mov	[esp+5ACh+var_50], 271Ah
		mov	edx, [esp+5ACh+var_50]
		mov	eax, ds:dword_41002C
		mov	[esp+5ACh+MaxCount], offset dword_410040
		mov	[esp+5ACh+Mode], edx
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_410030
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_4032B1
		mov	[esp+5ACh+var_54], 2715h
		mov	eax, ds:dword_410030
		mov	ecx, [eax+10h]
		mov	edx, [esp+5ACh+var_54]
		mov	eax, ds:dword_41002C
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt

loc_4032B1:				; CODE XREF: sub_402A9B+7E3j
		mov	[esp+5ACh+var_58], 40h
		mov	eax, ds:dword_410030
		movzx	eax, byte ptr [eax+1Ch]
		shr	al, 3
		and	eax, 1
		movzx	ecx, al
		mov	edx, [esp+5ACh+var_58]
		mov	eax, ds:dword_41002C
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_410030
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_403329
		mov	[esp+5ACh+var_5C], 2751h
		mov	eax, ds:dword_410030
		mov	ecx, [eax+2Ch]
		mov	edx, [esp+5ACh+var_5C]
		mov	eax, ds:dword_41002C
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt

loc_403329:				; CODE XREF: sub_402A9B+85Bj
		mov	[esp+5ACh+Mode], offset	aPragmaNoCache ; "Pragma: no-cache"
		mov	eax, [esp+5ACh+var_24]
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_slist_append
		call	eax ; curl_slist_append
		mov	[esp+5ACh+var_24], eax
		cmp	[esp+5ACh+var_24], 0
		jz	short loc_403373
		mov	[esp+5ACh+Mode], offset	aCacheControlNo	; "Cache-Control: no-cache"
		mov	eax, [esp+5ACh+var_24]
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_slist_append
		call	eax ; curl_slist_append
		mov	[esp+5ACh+var_24], eax

loc_403373:				; CODE XREF: sub_402A9B+8B6j
		cmp	[esp+5ACh+var_24], 0
		jnz	short loc_4033B4
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysOutOf_0 ; "gpgkeys:	out of memory when building HT"...
		mov	[esp+5ACh+File], edx ; File
		mov	[esp+5ACh+MaxCount], 32h ; Count
		mov	[esp+5ACh+Mode], 1 ; Size
		mov	[esp+5ACh+Format], eax ; Str
		call	fwrite
		mov	[esp+5ACh+var_10], 5
		jmp	loc_403A2A
; ---------------------------------------------------------------------------

loc_4033B4:				; CODE XREF: sub_402A9B+8E0j
		mov	[esp+5ACh+var_60], 2727h
		mov	edx, [esp+5ACh+var_60]
		mov	eax, ds:dword_41002C
		mov	ecx, [esp+5ACh+var_24]
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		cmp	[esp+5ACh+Memory], 0
		jz	short loc_40341E
		mov	[esp+5ACh+var_64], 2714h
		mov	edx, [esp+5ACh+var_64]
		mov	eax, ds:dword_41002C
		mov	ecx, [esp+5ACh+Memory]
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt

loc_40341E:				; CODE XREF: sub_402A9B+951j
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_403464
		nop

loc_40342B:				; CODE XREF: sub_402A9B+9C2j
		mov	eax, ds:File
		mov	[esp+5ACh+MaxCount], eax ; File
		mov	[esp+5ACh+Mode], 408h ;	MaxCount
		lea	eax, [esp+5ACh+Src]
		mov	[esp+5ACh+Format], eax ; Buf
		call	fgets
		test	eax, eax
		jz	loc_4035F7
		movzx	eax, [esp+5ACh+Src]
		cmp	al, 0Ah
		jnz	short loc_40342B
		jmp	loc_4035F7
; ---------------------------------------------------------------------------

loc_403464:				; CODE XREF: sub_402A9B+98Dj
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_40348C
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_40348C
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 4
		jnz	loc_4035CA

loc_40348C:				; CODE XREF: sub_402A9B+9D3j
					; sub_402A9B+9DFj ...
		mov	eax, ds:File
		mov	[esp+5ACh+MaxCount], eax ; File
		mov	[esp+5ACh+Mode], 408h ;	MaxCount
		lea	eax, [esp+5ACh+Src]
		mov	[esp+5ACh+Format], eax ; Buf
		call	fgets
		test	eax, eax
		jz	loc_4035C7
		movzx	eax, [esp+5ACh+Src]
		cmp	al, 0Ah
		jz	loc_4035F6
		movzx	eax, [esp+5ACh+Src]
		test	al, al
		jz	loc_4035F6
		mov	[esp+5ACh+Format], 40Ch	; Size
		call	malloc
		mov	[esp+5ACh+Dest], eax
		cmp	[esp+5ACh+Dest], 0
		jnz	short loc_403528
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysOutOf_1 ; "gpgkeys:	out of memory while building k"...
		mov	[esp+5ACh+File], edx ; File
		mov	[esp+5ACh+MaxCount], 2Fh ; Count
		mov	[esp+5ACh+Mode], 1 ; Size
		mov	[esp+5ACh+Format], eax ; Str
		call	fwrite
		mov	[esp+5ACh+var_10], 5
		jmp	loc_403A2A
; ---------------------------------------------------------------------------

loc_403528:				; CODE XREF: sub_402A9B+A54j
		lea	edx, [esp+5ACh+Src]
		mov	eax, [esp+5ACh+Dest]
		mov	[esp+5ACh+Mode], edx ; Source
		mov	[esp+5ACh+Format], eax ; Dest
		call	strcpy
		lea	eax, [esp+5ACh+Src]
		mov	[esp+5ACh+var_590], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+5ACh+var_590]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		lea	edx, [eax-1]
		mov	eax, [esp+5ACh+Dest]
		mov	byte ptr [eax+edx], 0
		mov	eax, [esp+5ACh+Dest]
		mov	dword ptr [eax+408h], 0
		cmp	[esp+5ACh+var_18], 0
		jnz	short loc_4035A0
		mov	eax, [esp+5ACh+Dest]
		mov	[esp+5ACh+var_18], eax
		jmp	short loc_4035B4
; ---------------------------------------------------------------------------

loc_4035A0:				; CODE XREF: sub_402A9B+AF3j
		mov	eax, [esp+5ACh+Source]
		mov	edx, [esp+5ACh+Dest]
		mov	[eax+408h], edx

loc_4035B4:				; CODE XREF: sub_402A9B+B03j
		mov	eax, [esp+5ACh+Dest]
		mov	[esp+5ACh+Source], eax
		jmp	loc_40348C
; ---------------------------------------------------------------------------

loc_4035C7:				; CODE XREF: sub_402A9B+A13j
		nop
		jmp	short loc_4035F6
; ---------------------------------------------------------------------------

loc_4035CA:				; CODE XREF: sub_402A9B+9EBj
		mov	edx, ds:dword_410028
		mov	eax, offset aGpgkeysNoKey_0 ; "gpgkeys:	no keyserver command specified"...
		mov	[esp+5ACh+File], edx ; File
		mov	[esp+5ACh+MaxCount], 28h ; Count
		mov	[esp+5ACh+Mode], 1 ; Size
		mov	[esp+5ACh+Format], eax ; Str
		call	fwrite
		jmp	loc_403A2A
; ---------------------------------------------------------------------------

loc_4035F6:				; CODE XREF: sub_402A9B+A23j
					; sub_402A9B+A33j ...
		nop

loc_4035F7:				; CODE XREF: sub_402A9B+9B2j
					; sub_402A9B+9C4j
		mov	edx, offset aVersionD ;	"VERSION %d\n"
		mov	eax, ds:dword_410024
		mov	[esp+5ACh+MaxCount], 1
		mov	[esp+5ACh+Mode], edx ; Format
		mov	[esp+5ACh+Format], eax ; File
		call	fprintf
		mov	edx, offset aProgramS ;	"PROGRAM %s\n\n"
		mov	eax, ds:dword_410024
		mov	[esp+5ACh+MaxCount], offset a2_0_30 ; "2.0.30"
		mov	[esp+5ACh+Mode], edx ; Format
		mov	[esp+5ACh+Format], eax ; File
		call	fprintf
		mov	eax, ds:dword_410030
		mov	eax, [eax+20h]
		cmp	eax, 1
		jbe	loc_40370D
		mov	eax, ds:dword_410030
		mov	ecx, [eax+4]
		mov	edx, offset aHostS ; "Host:\t\t%s\n"
		mov	eax, ds:dword_410028
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx ; Format
		mov	[esp+5ACh+Format], eax ; File
		call	fprintf
		mov	eax, ds:dword_410030
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_403694
		mov	eax, ds:dword_410030
		mov	ecx, [eax+8]
		mov	edx, offset aPortS ; "Port:\t\t%s\n"
		mov	eax, ds:dword_410028
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx ; Format
		mov	[esp+5ACh+Format], eax ; File
		call	fprintf

loc_403694:				; CODE XREF: sub_402A9B+BD5j
		mov	eax, ds:dword_410030
		mov	eax, [eax+14h]
		mov	edx, eax
		mov	eax, offset asc_40E714 ; "/"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4036E3
		mov	eax, ds:dword_410030
		mov	ecx, [eax+14h]
		mov	edx, offset aPathS ; "Path:\t\t%s\n"
		mov	eax, ds:dword_410028
		mov	[esp+5ACh+MaxCount], ecx
		mov	[esp+5ACh+Mode], edx ; Format
		mov	[esp+5ACh+Format], eax ; File
		call	fprintf

loc_4036E3:				; CODE XREF: sub_402A9B+C24j
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		mov	[esp+5ACh+Format], eax
		call	sub_4043E0
		mov	ecx, offset aCommandS ;	"Command:\t%s\n"
		mov	edx, ds:dword_410028
		mov	[esp+5ACh+MaxCount], eax
		mov	[esp+5ACh+Mode], ecx ; Format
		mov	[esp+5ACh+Format], edx ; File
		call	fprintf

loc_40370D:				; CODE XREF: sub_402A9B+BA3j
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_403777
		mov	eax, [esp+5ACh+var_18]
		mov	[esp+5ACh+Source], eax
		jmp	short loc_403768
; ---------------------------------------------------------------------------

loc_403729:				; CODE XREF: sub_402A9B+CD5j
		mov	eax, ds:dword_410030
		mov	eax, [eax+28h]
		mov	[esp+5ACh+Format], eax
		call	sub_403B80
		mov	eax, [esp+5ACh+Source]
		mov	[esp+5ACh+Format], eax
		call	sub_401CC0
		test	eax, eax
		jz	short loc_403754
		add	[esp+5ACh+var_14], 1

loc_403754:				; CODE XREF: sub_402A9B+CAFj
		mov	eax, [esp+5ACh+Source]
		mov	eax, [eax+408h]
		mov	[esp+5ACh+Source], eax

loc_403768:				; CODE XREF: sub_402A9B+C8Cj
		cmp	[esp+5ACh+Source], 0
		jnz	short loc_403729
		jmp	loc_403A13
; ---------------------------------------------------------------------------

loc_403777:				; CODE XREF: sub_402A9B+C7Cj
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_4037E1
		mov	eax, [esp+5ACh+var_18]
		mov	[esp+5ACh+Source], eax
		jmp	short loc_4037D2
; ---------------------------------------------------------------------------

loc_403793:				; CODE XREF: sub_402A9B+D3Fj
		mov	eax, ds:dword_410030
		mov	eax, [eax+28h]
		mov	[esp+5ACh+Format], eax
		call	sub_403B80
		mov	eax, [esp+5ACh+Source]
		mov	[esp+5ACh+Format], eax
		call	sub_402232
		test	eax, eax
		jz	short loc_4037BE
		add	[esp+5ACh+var_14], 1

loc_4037BE:				; CODE XREF: sub_402A9B+D19j
		mov	eax, [esp+5ACh+Source]
		mov	eax, [eax+408h]
		mov	[esp+5ACh+Source], eax

loc_4037D2:				; CODE XREF: sub_402A9B+CF6j
		cmp	[esp+5ACh+Source], 0
		jnz	short loc_403793
		jmp	loc_403A13
; ---------------------------------------------------------------------------

loc_4037E1:				; CODE XREF: sub_402A9B+CE6j
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_403833
		mov	[esp+5ACh+var_47C], 0

loc_4037F8:				; CODE XREF: sub_402A9B+D91j
		mov	eax, ds:dword_410030
		mov	eax, [eax+28h]
		mov	[esp+5ACh+Format], eax
		call	sub_403B80
		lea	eax, [esp+5ACh+var_47C]
		mov	[esp+5ACh+Format], eax
		call	sub_401700
		test	eax, eax
		jz	short loc_403823
		add	[esp+5ACh+var_14], 1

loc_403823:				; CODE XREF: sub_402A9B+D7Ej
		mov	eax, [esp+5ACh+var_47C]
		test	eax, eax
		jz	short loc_4037F8
		jmp	loc_403A13
; ---------------------------------------------------------------------------

loc_403833:				; CODE XREF: sub_402A9B+D50j
		mov	eax, ds:dword_410030
		mov	eax, [eax]
		cmp	eax, 4
		jnz	loc_403A0E
		mov	[esp+5ACh+var_6C], 0
		mov	[esp+5ACh+var_34], 0
		mov	eax, ds:dword_410030
		mov	eax, [eax+28h]
		mov	[esp+5ACh+Format], eax
		call	sub_403B80
		mov	eax, [esp+5ACh+var_18]
		mov	[esp+5ACh+Source], eax
		jmp	short loc_4038C5
; ---------------------------------------------------------------------------

loc_403879:				; CODE XREF: sub_402A9B+E32j
		mov	eax, [esp+5ACh+Source]
		mov	[esp+5ACh+var_590], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+5ACh+var_590]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [esp+5ACh+var_34]
		add	eax, edx
		add	eax, 1
		mov	[esp+5ACh+var_34], eax
		mov	eax, [esp+5ACh+Source]
		mov	eax, [eax+408h]
		mov	[esp+5ACh+Source], eax

loc_4038C5:				; CODE XREF: sub_402A9B+DDCj
		cmp	[esp+5ACh+Source], 0
		jnz	short loc_403879
		mov	eax, [esp+5ACh+var_34]
		add	eax, 1
		mov	[esp+5ACh+Format], eax ; Size
		call	malloc
		mov	[esp+5ACh+var_6C], eax
		cmp	[esp+5ACh+var_6C], 0
		jnz	short loc_403919
		mov	[esp+5ACh+var_10], 5
		mov	[esp+5ACh+Mode], 5
		mov	eax, [esp+5ACh+var_18]
		mov	[esp+5ACh+Format], eax
		call	sub_40292C
		jmp	loc_403A2A
; ---------------------------------------------------------------------------

loc_403919:				; CODE XREF: sub_402A9B+E55j
		mov	eax, [esp+5ACh+var_6C]
		mov	byte ptr [eax],	0
		mov	eax, [esp+5ACh+var_18]
		mov	[esp+5ACh+Source], eax
		jmp	short loc_403998
; ---------------------------------------------------------------------------

loc_403933:				; CODE XREF: sub_402A9B+F05j
		mov	eax, [esp+5ACh+Source]
		mov	[esp+5ACh+Mode], eax ; Source
		mov	eax, [esp+5ACh+var_6C]
		mov	[esp+5ACh+Format], eax ; Dest
		call	strcat
		mov	ebx, offset asc_40E72E ; " "
		mov	eax, [esp+5ACh+var_6C]
		mov	[esp+5ACh+var_590], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+5ACh+var_590]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [esp+5ACh+var_6C]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		mov	eax, [esp+5ACh+Source]
		mov	eax, [eax+408h]
		mov	[esp+5ACh+Source], eax

loc_403998:				; CODE XREF: sub_402A9B+E96j
		cmp	[esp+5ACh+Source], 0
		jnz	short loc_403933
		mov	eax, [esp+5ACh+var_6C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4039E2
		mov	eax, [esp+5ACh+var_6C]
		mov	[esp+5ACh+var_590], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+5ACh+var_590]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [esp+5ACh+var_6C]
		mov	byte ptr [eax],	0

loc_4039E2:				; CODE XREF: sub_402A9B+F13j
		mov	eax, [esp+5ACh+var_6C]
		mov	[esp+5ACh+Format], eax
		call	sub_40262A
		test	eax, eax
		jz	short loc_4039FD
		add	[esp+5ACh+var_14], 1

loc_4039FD:				; CODE XREF: sub_402A9B+F58j
		mov	eax, [esp+5ACh+var_6C]
		mov	[esp+5ACh+Format], eax ; Memory
		call	free
		jmp	short loc_403A13
; ---------------------------------------------------------------------------

loc_403A0E:				; CODE XREF: sub_402A9B+DA2j
		call	abort
; ---------------------------------------------------------------------------

loc_403A13:				; CODE XREF: sub_402A9B+CD7j
					; sub_402A9B+D41j ...
		cmp	[esp+5ACh+var_14], 0
		jnz	short loc_403A5D
		mov	[esp+5ACh+var_10], 0
		jmp	short loc_403A5D
; ---------------------------------------------------------------------------

loc_403A2A:				; CODE XREF: sub_402A9B+337j
					; sub_402A9B+543j ...
		jmp	short loc_403A5D
; ---------------------------------------------------------------------------

loc_403A2C:				; CODE XREF: sub_402A9B+FCAj
		mov	eax, [esp+5ACh+var_18]
		mov	[esp+5ACh+var_70], eax
		mov	eax, [esp+5ACh+var_18]
		mov	eax, [eax+408h]
		mov	[esp+5ACh+var_18], eax
		mov	eax, [esp+5ACh+var_70]
		mov	[esp+5ACh+Format], eax ; Memory
		call	free

loc_403A5D:				; CODE XREF: sub_402A9B+F80j
					; sub_402A9B+F8Dj ...
		cmp	[esp+5ACh+var_18], 0
		jnz	short loc_403A2C
		mov	edx, ds:File
		mov	eax, ds:_iob
		cmp	edx, eax
		jz	short loc_403A83
		mov	eax, ds:File
		mov	[esp+5ACh+Format], eax ; File
		call	fclose

loc_403A83:				; CODE XREF: sub_402A9B+FD9j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:dword_410024
		cmp	edx, eax
		jz	short loc_403AA1
		mov	eax, ds:dword_410024
		mov	[esp+5ACh+Format], eax ; File
		call	fclose

loc_403AA1:				; CODE XREF: sub_402A9B+FF7j
		mov	eax, ds:dword_410030
		mov	[esp+5ACh+Format], eax ; void *
		call	sub_403C5A
		mov	eax, [esp+5ACh+var_24]
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_slist_free_all
		call	eax ; curl_slist_free_all
		mov	eax, [esp+5ACh+var_38]
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_slist_free_all
		call	eax ; curl_slist_free_all
		mov	eax, ds:dword_41002C
		test	eax, eax
		jz	short loc_403AE8
		mov	eax, ds:dword_41002C
		mov	[esp+5ACh+Format], eax
		mov	eax, ds:curl_easy_cleanup
		call	eax ; curl_easy_cleanup

loc_403AE8:				; CODE XREF: sub_402A9B+103Cj
		mov	eax, [esp+5ACh+Memory]
		mov	[esp+5ACh+Format], eax ; Memory
		call	free
		mov	eax, [esp+5ACh+var_10]

loc_403AFE:				; CODE XREF: sub_402A9B+DEj
					; sub_402A9B+133j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_402A9B	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403B80	proc near		; CODE XREF: sub_402A9B+C99p
					; sub_402A9B+D03p ...
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_403B80	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403B8A	proc near		; CODE XREF: sub_402A9B+5D2p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_403B8A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_410160
		test	eax, eax
		jnz	short locret_403BC6
		mov	dword ptr [esp+4], offset dword_410180
		mov	dword ptr [esp], 202h
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		mov	ds:dword_410160, 1

locret_403BC6:				; CODE XREF: .text:00403BA1j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403BC8	proc near		; CODE XREF: sub_402A9B:loc_402D6Ap

NumOfElements	= dword	ptr -28h
SizeOfElements	= dword	ptr -24h
Memory		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+SizeOfElements], 30h ;	SizeOfElements
		mov	[esp+28h+NumOfElements], 1 ; NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jz	short loc_403C55
		mov	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 2
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 4
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 8
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		mov	dword ptr [eax+28h], 78h
		mov	[esp+28h+NumOfElements], offset	asc_40E730 ; "/"
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+Memory]
		mov	[eax+14h], edx
		mov	eax, [ebp+Memory]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_403C55
		mov	eax, [ebp+Memory]
		mov	[esp+28h+NumOfElements], eax ; Memory
		call	free
		mov	[ebp+Memory], 0

loc_403C55:				; CODE XREF: sub_403BC8+21j
					; sub_403BC8+79j
		mov	eax, [ebp+Memory]
		leave
		retn
sub_403BC8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403C5A(void *)
sub_403C5A	proc near		; CODE XREF: sub_402A9B+100Ep

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_403CD3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_403CD3:				; CODE XREF: sub_403C5A+Aj
		leave
		retn
sub_403C5A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403CD5(char *, int)
sub_403CD5	proc near		; CODE XREF: sub_402A9B+313p

Src		= dword	ptr -0A28h
Format		= dword	ptr -0A24h
MaxCount	= dword	ptr -0A20h
var_A11		= byte ptr -0A11h
var_911		= byte ptr -911h
var_910		= byte ptr -910h
var_510		= byte ptr -510h
var_50F		= byte ptr -50Fh
var_10F		= byte ptr -10Fh
var_10E		= byte ptr -10Eh
var_8E		= byte ptr -8Eh
var_8D		= byte ptr -8Dh
var_79		= byte ptr -79h
var_78		= byte ptr -78h
var_6E		= byte ptr -6Eh
var_6D		= byte ptr -6Dh
var_1D		= byte ptr -1Dh
Str1		= byte ptr -1Ch
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0A28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jnz	short loc_403CF2
		mov	eax, 0
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403CF2:				; CODE XREF: sub_403CD5+11j
		mov	edx, offset aCommand7s ; "COMMAND %7s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+Str1]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_403DB2
		mov	[ebp+var_15], 0
		mov	[esp+0A28h+Format], offset aGet	; "get"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_403D3E
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1
		jmp	short loc_403DA8
; ---------------------------------------------------------------------------

loc_403D3E:				; CODE XREF: sub_403CD5+5Cj
		mov	[esp+0A28h+Format], offset aGetname ; "getname"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_403D62
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 2
		jmp	short loc_403DA8
; ---------------------------------------------------------------------------

loc_403D62:				; CODE XREF: sub_403CD5+80j
		mov	[esp+0A28h+Format], offset aSend ; "send"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_403D86
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 3
		jmp	short loc_403DA8
; ---------------------------------------------------------------------------

loc_403D86:				; CODE XREF: sub_403CD5+A4j
		mov	[esp+0A28h+Format], offset aSearch_0 ; "search"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_403DA8
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 4

loc_403DA8:				; CODE XREF: sub_403CD5+67j
					; sub_403CD5+8Bj ...
		mov	eax, 0
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403DB2:				; CODE XREF: sub_403CD5+3Bj
		mov	edx, offset aHost80s ; "HOST %80s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_6D]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_403E15
		mov	[ebp+var_1D], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_6D]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_403E0B
		mov	eax, 5
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403E0B:				; CODE XREF: sub_403CD5+12Aj
		mov	eax, 0
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403E15:				; CODE XREF: sub_403CD5+FBj
		mov	edx, offset aPort10s ; "PORT %10s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_78]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_403E78
		mov	[ebp+var_6E], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_78]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_403E6E
		mov	eax, 5
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403E6E:				; CODE XREF: sub_403CD5+18Dj
		mov	eax, 0
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403E78:				; CODE XREF: sub_403CD5+15Ej
		mov	edx, offset aScheme20s ; "SCHEME %20s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_8D]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_403EE1
		mov	[ebp+var_79], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_8D]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_403ED7
		mov	eax, 5
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403ED7:				; CODE XREF: sub_403CD5+1F6j
		mov	eax, 0
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403EE1:				; CODE XREF: sub_403CD5+1C4j
		mov	edx, offset aAuth128s ;	"AUTH %128s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_10E]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_403F4D
		mov	[ebp+var_8E], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_10E]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_403F43
		mov	eax, 5
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403F43:				; CODE XREF: sub_403CD5+262j
		mov	eax, 0
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403F4D:				; CODE XREF: sub_403CD5+22Dj
		mov	edx, offset aPath1024s ; "PATH %1024s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_50F]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_403FB9
		mov	[ebp+var_10F], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_50F]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_403FAF
		mov	eax, 5
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403FAF:				; CODE XREF: sub_403CD5+2CEj
		mov	eax, 0
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_403FB9:				; CODE XREF: sub_403CD5+299j
		mov	edx, offset aOpaque1024s ; "OPAQUE %1024s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_910]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_404025
		mov	[ebp+var_510], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+18h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_910]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	short loc_40401B
		mov	eax, 5
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_40401B:				; CODE XREF: sub_403CD5+33Aj
		mov	eax, 0
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_404025:				; CODE XREF: sub_403CD5+305j
		mov	edx, offset aVersionD_0	; "VERSION %d\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_14]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_404061
		mov	eax, [ebp+var_14]
		cmp	eax, 1
		jz	short loc_404057
		mov	eax, 3
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_404057:				; CODE XREF: sub_403CD5+376j
		mov	eax, 0
		jmp	locret_4043DE
; ---------------------------------------------------------------------------

loc_404061:				; CODE XREF: sub_403CD5+36Ej
		mov	edx, offset aOption256 ; "OPTION %256[^\n]\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_A11]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_4043D9
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_A11]
		mov	[ebp+var_10], eax
		mov	[ebp+var_911], 0
		mov	[esp+0A28h+MaxCount], 3	; MaxCount
		mov	[esp+0A28h+Format], offset aNo_0 ; "no-"
		lea	eax, [ebp+var_A11]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_4040D6
		mov	[ebp+var_C], 1
		lea	eax, [ebp+var_A11]
		add	eax, 3
		mov	[ebp+var_10], eax

loc_4040D6:				; CODE XREF: sub_403CD5+3ECj
		mov	[esp+0A28h+MaxCount], 7	; MaxCount
		mov	[esp+0A28h+Format], offset aVerbose ; "verbose"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_404148
		cmp	[ebp+var_C], 0
		jz	short loc_40410C
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+20h], 0
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_40410C:				; CODE XREF: sub_403CD5+426j
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_404134
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+20h], edx
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_404134:				; CODE XREF: sub_403CD5+442j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_4]
		mov	[eax+20h], edx
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_404148:				; CODE XREF: sub_403CD5+420j
		mov	[esp+0A28h+Format], offset aIncludeDisable ; "include-disabled"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_40418B
		cmp	[ebp+var_C], 0
		jz	short loc_404179
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+1Ch], dl
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_404179:				; CODE XREF: sub_403CD5+490j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 1
		mov	[eax+1Ch], dl
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_40418B:				; CODE XREF: sub_403CD5+48Aj
		mov	[esp+0A28h+Format], offset aIncludeRevoked ; "include-revoked"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_4041CE
		cmp	[ebp+var_C], 0
		jz	short loc_4041BC
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+1Ch], dl
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_4041BC:				; CODE XREF: sub_403CD5+4D3j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 2
		mov	[eax+1Ch], dl
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_4041CE:				; CODE XREF: sub_403CD5+4CDj
		mov	[esp+0A28h+Format], offset aIncludeSubkeys ; "include-subkeys"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_404211
		cmp	[ebp+var_C], 0
		jz	short loc_4041FF
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFBh
		mov	[eax+1Ch], dl
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_4041FF:				; CODE XREF: sub_403CD5+516j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 4
		mov	[eax+1Ch], dl
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_404211:				; CODE XREF: sub_403CD5+510j
		mov	[esp+0A28h+Format], offset aCheckCert ;	"check-cert"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_404254
		cmp	[ebp+var_C], 0
		jz	short loc_404242
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFF7h
		mov	[eax+1Ch], dl
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_404242:				; CODE XREF: sub_403CD5+559j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 8
		mov	[eax+1Ch], dl
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_404254:				; CODE XREF: sub_403CD5+553j
		mov	[esp+0A28h+MaxCount], 5	; MaxCount
		mov	[esp+0A28h+Format], offset aDebug ; "debug"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_4042D2
		cmp	[ebp+var_C], 0
		jz	short loc_40428A
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+24h], 0
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_40428A:				; CODE XREF: sub_403CD5+5A4j
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_4042B2
		mov	eax, [ebp+var_10]
		add	eax, 6
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+24h], edx
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_4042B2:				; CODE XREF: sub_403CD5+5C0j
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4043D9
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+24h], 1
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_4042D2:				; CODE XREF: sub_403CD5+59Ej
		mov	[esp+0A28h+MaxCount], 7	; MaxCount
		mov	[esp+0A28h+Format], offset aTimeout ; "timeout"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_404350
		cmp	[ebp+var_C], 0
		jz	short loc_404308
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+28h], 0
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_404308:				; CODE XREF: sub_403CD5+622j
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_404330
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+28h], edx
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_404330:				; CODE XREF: sub_403CD5+63Ej
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4043D9
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+28h], 78h
		jmp	loc_4043D9
; ---------------------------------------------------------------------------

loc_404350:				; CODE XREF: sub_403CD5+61Cj
		mov	[esp+0A28h+MaxCount], 0Ch ; MaxCount
		mov	[esp+0A28h+Format], offset aCaCertFile ; "ca-cert-file"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_4043D9
		cmp	[ebp+var_C], 0
		jz	short loc_404391
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+2Ch], 0
		jmp	short loc_4043D9
; ---------------------------------------------------------------------------

loc_404391:				; CODE XREF: sub_403CD5+6A0j
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_4043D9
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_10]
		add	eax, 0Dh
		mov	[esp+0A28h+Format], 0
		mov	[esp+0A28h+Src], eax
		call	sub_40580B
		mov	edx, [ebp+arg_4]
		mov	[edx+2Ch], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	short loc_4043D9
		mov	eax, 5
		jmp	short locret_4043DE
; ---------------------------------------------------------------------------

loc_4043D9:				; CODE XREF: sub_403CD5+3ADj
					; sub_403CD5+432j ...
		mov	eax, 0FFFFFFFFh

locret_4043DE:				; CODE XREF: sub_403CD5+18j
					; sub_403CD5+D8j ...
		leave
		retn
sub_403CD5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4043E0	proc near		; CODE XREF: sub_402A9B+C52p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 4	; switch 5 cases
		ja	short loc_40441B ; jumptable 004043F6 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_40E844
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4043F8:				; CODE XREF: sub_4043E0+16j
					; DATA XREF: .rdata:off_40E844o
		mov	eax, offset aUnknown ; jumptable 004043F6 case 0
		jmp	short loc_404420
; ---------------------------------------------------------------------------

loc_4043FF:				; CODE XREF: sub_4043E0+16j
					; DATA XREF: .rdata:off_40E844o
		mov	eax, offset aGet_0 ; jumptable 004043F6	case 1
		jmp	short loc_404420
; ---------------------------------------------------------------------------

loc_404406:				; CODE XREF: sub_4043E0+16j
					; DATA XREF: .rdata:off_40E844o
		mov	eax, offset aGetname_0 ; jumptable 004043F6 case 2
		jmp	short loc_404420
; ---------------------------------------------------------------------------

loc_40440D:				; CODE XREF: sub_4043E0+16j
					; DATA XREF: .rdata:off_40E844o
		mov	eax, offset aSend_0 ; jumptable	004043F6 case 3
		jmp	short loc_404420
; ---------------------------------------------------------------------------

loc_404414:				; CODE XREF: sub_4043E0+16j
					; DATA XREF: .rdata:off_40E844o
		mov	eax, offset aSearch_1 ;	jumptable 004043F6 case	4
		jmp	short loc_404420
; ---------------------------------------------------------------------------

loc_40441B:				; CODE XREF: sub_4043E0+7j
		mov	eax, offset a?	; jumptable 004043F6 default case

loc_404420:				; CODE XREF: sub_4043E0+1Dj
					; sub_4043E0+24j ...
		pop	ebp
		retn
sub_4043E0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_404450
; ---------------------------------------------------------------------------

loc_40442A:				; CODE XREF: .text:00404458j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_40444C
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc

loc_40444C:				; CODE XREF: .text:00404432j
		add	dword ptr [ebp+0Ch], 1

loc_404450:				; CODE XREF: .text:00404428j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40442A
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40445C	proc near		; CODE XREF: sub_40262A+1Dp

Str		= dword	ptr -28h
Control		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 2Ah	; switch 23 cases
		cmp	eax, 16h
		ja	loc_40459A	; jumptable 00404481 default case
		mov	eax, ds:off_40E870[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_404483:				; CODE XREF: sub_40445C+25j
					; DATA XREF: .rdata:off_40E870o
		mov	eax, [ebp+arg_0] ; jumptable 00404481 case 42
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_40459F
; ---------------------------------------------------------------------------

loc_40449A:				; CODE XREF: sub_40445C+25j
					; DATA XREF: .rdata:off_40E870o
		mov	eax, [ebp+arg_0] ; jumptable 00404481 case 61
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 1
		jmp	loc_40459F
; ---------------------------------------------------------------------------

loc_4044B1:				; CODE XREF: sub_40445C+25j
					; DATA XREF: .rdata:off_40E870o
		mov	eax, [ebp+arg_0] ; jumptable 00404481 case 60
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 2
		jmp	loc_40459F
; ---------------------------------------------------------------------------

loc_4044C8:				; CODE XREF: sub_40445C+25j
					; DATA XREF: .rdata:off_40E870o
		mov	eax, [ebp+arg_0] ; jumptable 00404481 case 64
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 3
		jmp	loc_40459F
; ---------------------------------------------------------------------------

loc_4044DF:				; CODE XREF: sub_40445C+25j
					; DATA XREF: .rdata:off_40E870o
		mov	eax, [ebp+arg_0] ; jumptable 00404481 case 48
		mov	eax, [eax]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 78h
		jnz	loc_40459A	; jumptable 00404481 default case
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Ah
		jnz	short loc_404546
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+Control], offset Control ; "abcdefABCDEF1234567890x"
		mov	[esp+28h+Str], eax ; Str
		call	strspn
		cmp	eax, 0Ah
		jnz	short loc_404546
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 5
		jmp	short loc_40459F
; ---------------------------------------------------------------------------

loc_404546:				; CODE XREF: sub_40445C+BAj
					; sub_40445C+D4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 12h
		jnz	short loc_40459A ; jumptable 00404481 default case
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+Control], offset Control ; "abcdefABCDEF1234567890x"
		mov	[esp+28h+Str], eax ; Str
		call	strspn
		cmp	eax, 12h
		jnz	short loc_40459A ; jumptable 00404481 default case
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 4
		jmp	short loc_40459F
; ---------------------------------------------------------------------------

loc_40459A:				; CODE XREF: sub_40445C+18j
					; sub_40445C+25j ...
		mov	eax, 0		; jumptable 00404481 default case

loc_40459F:				; CODE XREF: sub_40445C+39j
					; sub_40445C+50j ...
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_40445C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4045A5	proc near		; CODE XREF: sub_401700+536p
					; sub_401CC0+356p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 1
		jz	short loc_4045C8
		cmp	eax, 1
		jb	short loc_4045C1
		cmp	eax, 7
		jz	short loc_4045CF
		cmp	eax, 13h
		jz	short loc_4045D6
		jmp	short loc_4045DD
; ---------------------------------------------------------------------------

loc_4045C1:				; CODE XREF: sub_4045A5+Ej
		mov	eax, 0
		jmp	short loc_4045E2
; ---------------------------------------------------------------------------

loc_4045C8:				; CODE XREF: sub_4045A5+9j
		mov	eax, 7Fh
		jmp	short loc_4045E2
; ---------------------------------------------------------------------------

loc_4045CF:				; CODE XREF: sub_4045A5+13j
		mov	eax, 9
		jmp	short loc_4045E2
; ---------------------------------------------------------------------------

loc_4045D6:				; CODE XREF: sub_4045A5+18j
		mov	eax, 6
		jmp	short loc_4045E2
; ---------------------------------------------------------------------------

loc_4045DD:				; CODE XREF: sub_4045A5+1Aj
		mov	eax, 1

loc_4045E2:				; CODE XREF: sub_4045A5+21j
					; sub_4045A5+28j ...
		pop	ebp
		retn
sub_4045A5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4045E4	proc near		; CODE XREF: sub_404779+ACp

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	loc_40476B
; ---------------------------------------------------------------------------

loc_4045FC:				; CODE XREF: sub_4045E4+57j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	ecx, [ebp+arg_0]
		add	edx, ecx
		movzx	ecx, byte ptr [edx]
		mov	edx, [ebp+var_10]
		mov	[edx+eax+8], cl
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		add	[ebp+var_C], 1
		jmp	short loc_40462A
; ---------------------------------------------------------------------------

loc_404629:				; CODE XREF: sub_4045E4+18Dj
		nop

loc_40462A:				; CODE XREF: sub_4045E4+43j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, 2
		jg	short loc_40463D
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	short loc_4045FC

loc_40463D:				; CODE XREF: sub_4045E4+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, 3
		jnz	loc_40476B
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_40E8CC[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		mov	ecx, eax
		and	ecx, 30h
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+9]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_40E8CC[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+9]
		movzx	eax, al
		shl	eax, 2
		mov	ecx, eax
		and	ecx, 3Ch
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+0Ah]
		shr	al, 6
		movzx	eax, al
		and	eax, 3
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_40E8CC[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+0Ah]
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_40E8CC[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		lea	edx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, 45h
		jle	short loc_404761
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 0Ah ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0

loc_404761:				; CODE XREF: sub_4045E4+15Bj
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0

loc_40476B:				; CODE XREF: sub_4045E4+13j
					; sub_4045E4+62j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_404629
		leave
		retn
sub_4045E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404779	proc near		; DATA XREF: sub_401CC0+2CBo
					; sub_402232+1CCo

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 1
		test	al, al
		jnz	short loc_404800
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		test	eax, eax
		jnz	short loc_4047AD
		mov	eax, 0
		jmp	locret_404953
; ---------------------------------------------------------------------------

loc_4047AD:				; CODE XREF: sub_404779+28j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4047EB
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		or	edx, 8
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, offset aBeginPgpPublic ; "-----BEGIN PGP PUBLIC KEY BLOCK-----\n\"...
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 26h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_4047F5
; ---------------------------------------------------------------------------

loc_4047EB:				; CODE XREF: sub_404779+3Cj
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+14h], offset aBeginPgpPubl_0 ; "-----BEGIN PGP PUBLIC KEY BLOCK-----"

loc_4047F5:				; CODE XREF: sub_404779+70j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		or	edx, 1
		mov	[eax], dl

loc_404800:				; CODE XREF: sub_404779+1Dj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 8
		test	al, al
		jz	short loc_40482F
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		mov	edx, [ebp+arg_C]
		mov	[esp+28h+Count], edx
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_4045E4
		jmp	loc_40494C
; ---------------------------------------------------------------------------

loc_40482F:				; CODE XREF: sub_404779+92j
		mov	[ebp+var_C], 0
		jmp	loc_40492F
; ---------------------------------------------------------------------------

loc_40483B:				; CODE XREF: sub_404779+1CDj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	loc_4048E5
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4048EF
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jz	short loc_40489D
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl
		jmp	short loc_4048EF
; ---------------------------------------------------------------------------

loc_40489D:				; CODE XREF: sub_404779+115j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		or	edx, 2
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+14h], offset aEndPgpPublicKe ; "-----END	PGP PUBLIC KEY BLOCK-----"
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, offset aBeginPgpPubl_0 ; "-----BEGIN PGP PUBLIC KEY BLOCK-----"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 24h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_40492B
; ---------------------------------------------------------------------------

loc_4048E5:				; CODE XREF: sub_404779+E0j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 0

loc_4048EF:				; CODE XREF: sub_404779+108j
					; sub_404779+122j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jz	short loc_40492B
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_40492B
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_14]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Size],	edx ; File
		mov	[esp+28h+Str], eax ; Ch
		call	fputc

loc_40492B:				; CODE XREF: sub_404779+16Aj
					; sub_404779+181j ...
		add	[ebp+var_C], 1

loc_40492F:				; CODE XREF: sub_404779+BDj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 4
		test	al, al
		jnz	short loc_40494C
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		ja	loc_40483B

loc_40494C:				; CODE XREF: sub_404779+B1j
					; sub_404779+1C1j
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]

locret_404953:				; CODE XREF: sub_404779+2Fj
		leave
		retn
sub_404779	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404955	proc near		; CODE XREF: sub_401CC0+395p
					; sub_402232+26Bp

Str		= dword	ptr -18h
File		= dword	ptr -14h
Count		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 8
		test	al, al
		jz	locret_404AF6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 2
		jnz	loc_404A31
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_40E8CC[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		mov	ecx, eax
		and	ecx, 30h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+9]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_40E8CC[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+9]
		movzx	eax, al
		shl	eax, 2
		and	eax, 3Ch
		movzx	eax, ds:byte_40E8CC[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+File],	eax ; File
		mov	[esp+18h+Str], 3Dh ; Ch
		call	fputc
		jmp	loc_404AC4
; ---------------------------------------------------------------------------

loc_404A31:				; CODE XREF: sub_404955+20j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 1
		jnz	loc_404AC4
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_40E8CC[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		and	eax, 30h
		movzx	eax, ds:byte_40E8CC[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+File],	eax ; File
		mov	[esp+18h+Str], 3Dh ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+File],	eax ; File
		mov	[esp+18h+Str], 3Dh ; Ch
		call	fputc

loc_404AC4:				; CODE XREF: sub_404955+D7j
					; sub_404955+E5j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, offset aEndPgpPublic_0 ; "\n-----END PGP PUBLIC KEY BLOCK-----"
		mov	[esp+18h+var_C], edx ; File
		mov	[esp+18h+Count], 23h ; Count
		mov	[esp+18h+File],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl

locret_404AF6:				; CODE XREF: sub_404955+11j
		leave
		retn
sub_404955	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_404B26
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_404B26
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_404B7D
; ---------------------------------------------------------------------------

loc_404B26:				; CODE XREF: .text:00404B06j
					; .text:00404B10j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_404B4E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_404B4E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_404B7D
; ---------------------------------------------------------------------------

loc_404B4E:				; CODE XREF: .text:00404B2Ej
					; .text:00404B38j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_404B76
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_404B76
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_404B7D
; ---------------------------------------------------------------------------

loc_404B76:				; CODE XREF: .text:00404B56j
					; .text:00404B60j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_404BFA
; ---------------------------------------------------------------------------

loc_404B7D:				; CODE XREF: .text:00404B24j
					; .text:00404B4Cj ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_404BA6
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_404BA6
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_404BF7
; ---------------------------------------------------------------------------

loc_404BA6:				; CODE XREF: .text:00404B89j
					; .text:00404B93j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_404BCB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_404BCB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_404BF7
; ---------------------------------------------------------------------------

loc_404BCB:				; CODE XREF: .text:00404BAEj
					; .text:00404BB8j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_404BF0
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_404BF0
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_404BF7
; ---------------------------------------------------------------------------

loc_404BF0:				; CODE XREF: .text:00404BD3j
					; .text:00404BDDj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_404BFA
; ---------------------------------------------------------------------------

loc_404BF7:				; CODE XREF: .text:00404BA4j
					; .text:00404BC9j ...
		mov	eax, [ebp-4]

locret_404BFA:				; CODE XREF: .text:00404B7Bj
					; .text:00404BF5j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404BFC	proc near		; CODE XREF: sub_404C14+35p
					; sub_404C14+48p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_404C0F
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_404C0F
		and	[ebp+arg_0], 0FFFFFFDFh

loc_404C0F:				; CODE XREF: sub_404BFC+7j
					; sub_404BFC+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_404BFC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404C14	proc near		; CODE XREF: sub_402A9B+55Bp
					; sub_402A9B+722p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_404C6F
		mov	eax, 0
		jmp	loc_404CC8
; ---------------------------------------------------------------------------

loc_404C2D:				; CODE XREF: sub_404C14+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_404C65
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_404BFC
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_404BFC
		cmp	ebx, eax
		jnz	short loc_404C86

loc_404C65:				; CODE XREF: sub_404C14+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_404C70
; ---------------------------------------------------------------------------

loc_404C6F:				; CODE XREF: sub_404C14+Dj
		nop

loc_404C70:				; CODE XREF: sub_404C14+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404C87
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404C2D
		jmp	short loc_404C87
; ---------------------------------------------------------------------------

loc_404C86:				; CODE XREF: sub_404C14+4Fj
		nop

loc_404C87:				; CODE XREF: sub_404C14+64j
					; sub_404C14+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_404CC3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_404BFC
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_404BFC
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_404CC8
; ---------------------------------------------------------------------------

loc_404CC3:				; CODE XREF: sub_404C14+81j
		mov	eax, 0

loc_404CC8:				; CODE XREF: sub_404C14+14j
					; sub_404C14+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_404C14	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_404CD0	proc near		; CODE XREF: sub_404D24+1Ap
					; .text:00404DD8p ...

File		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+18h+File],	eax ; int
		call	strerror
		mov	edx, offset aErrorAllocatin ; "error allocating	enough memory: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+Format], edx ;	Format
		mov	[esp+18h+File],	ecx ; File
		call	fprintf
		mov	[esp+18h+File],	2 ; Code
		call	exit
sub_404CD0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404D11(size_t)
sub_404D11	proc near		; CODE XREF: sub_405476+29Ap
					; sub_4064ED+A5p ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_404D11	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404D24(size_t)
sub_404D24	proc near		; CODE XREF: .text:004050C0p
					; .text:00405435p ...

Size		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404D43
		call	sub_404CD0
; ---------------------------------------------------------------------------

loc_404D43:				; CODE XREF: sub_404D24+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_404D24	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404D48(char *)
sub_404D48	proc near		; CODE XREF: sub_405476+1B9p
					; sub_406863+13p

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jz	short loc_404D94
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+Dest]
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy

loc_404D94:				; CODE XREF: sub_404D48+38j
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_404D48	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_404DDD
		call	sub_404CD0
; ---------------------------------------------------------------------------

loc_404DDD:				; CODE XREF: .text:00404DD6j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404DE2(size_t, size_t)
sub_404DE2	proc near		; CODE XREF: sub_408E4A+188p
					; sub_408E4A+2DEp

NumOfElements	= dword	ptr -18h
SizeOfElements	= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+SizeOfElements], eax ;	SizeOfElements
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+NumOfElements], eax ; NumOfElements
		call	calloc
		leave
		retn
sub_404DE2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	calloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_404E22
		call	sub_404CD0
; ---------------------------------------------------------------------------

loc_404E22:				; CODE XREF: .text:00404E1Bj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404E27(char *)
sub_404E27	proc near		; CODE XREF: .text:0040539Ep
					; .text:004053AEp ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_404E66
		call	sub_404CD0
; ---------------------------------------------------------------------------

loc_404E66:				; CODE XREF: sub_404E27+38j
		mov	eax, [ebp+Dest]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_404E27	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404E81(void *)
sub_404E81	proc near		; CODE XREF: sub_401700+56Dp
					; sub_402232+3BEp ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_404E98
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_404E98:				; CODE XREF: sub_404E81+Aj
		leave
		retn
sub_404E81	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404E9C(char *)
sub_404E9C	proc near		; CODE XREF: sub_405476+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_404EDF
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_404ED5
; ---------------------------------------------------------------------------

loc_404EC1:				; CODE XREF: sub_404E9C+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_404ED1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_404ED1:				; CODE XREF: sub_404E9C+2Dj
		add	[ebp+var_C], 1

loc_404ED5:				; CODE XREF: sub_404E9C+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404EC1

loc_404EDF:				; CODE XREF: sub_404E9C+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_404E9C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_404FB5
; ---------------------------------------------------------------------------

loc_404F08:				; CODE XREF: .text:00404FB9j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_404FAD
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_404F5A
; ---------------------------------------------------------------------------

loc_404F4E:				; CODE XREF: .text:00404F8Aj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_404F5A:				; CODE XREF: .text:00404F4Cj
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_404F8C
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_404F4E

loc_404F8C:				; CODE XREF: .text:00404F5Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404F9B
		mov	eax, [ebp-18h]
		jmp	short loc_404FC4
; ---------------------------------------------------------------------------

loc_404F9B:				; CODE XREF: .text:00404F94j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_404FAD:				; CODE XREF: .text:00404F32j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_404FB5:				; CODE XREF: .text:00404F03j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_404F08
		mov	eax, 0

loc_404FC4:				; CODE XREF: .text:00404F99j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_405093
; ---------------------------------------------------------------------------

loc_404FEE:				; CODE XREF: .text:00405097j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4060AD
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4060AD
		cmp	ebx, eax
		jnz	short loc_40508B
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_40503C
; ---------------------------------------------------------------------------

loc_405030:				; CODE XREF: .text:00405068j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_40503C:				; CODE XREF: .text:0040502Ej
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40506A
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4060AD
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4060AD
		cmp	ebx, eax
		jz	short loc_405030

loc_40506A:				; CODE XREF: .text:00405040j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405079
		mov	eax, [ebp-18h]
		jmp	short loc_4050A2
; ---------------------------------------------------------------------------

loc_405079:				; CODE XREF: .text:00405072j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_40508B:				; CODE XREF: .text:00405014j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_405093:				; CODE XREF: .text:00404FE9j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_404FEE
		mov	eax, 0

loc_4050A2:				; CODE XREF: .text:00405077j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_405107
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4050C8
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_404D24
		mov	[ebp+8], eax

loc_4050C8:				; CODE XREF: .text:004050B8j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_4050F1
; ---------------------------------------------------------------------------

loc_4050DA:				; CODE XREF: .text:004050FFj
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_4050F1:				; CODE XREF: .text:004050D8j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_405101
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4050DA

loc_405101:				; CODE XREF: .text:004050F5j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_405107:				; CODE XREF: .text:004050B2j
		mov	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_405124
; ---------------------------------------------------------------------------

loc_405120:				; CODE XREF: .text:00405143j
		add	dword ptr [ebp-10h], 1

loc_405124:				; CODE XREF: .text:0040511Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405145
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_405120

loc_405145:				; CODE XREF: .text:0040512Cj
		mov	dword ptr [ebp-14h], 0
		jmp	short loc_405182
; ---------------------------------------------------------------------------

loc_40514E:				; CODE XREF: .text:00405195j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_405173
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_40517A
		mov	eax, [ebp-0Ch]
		mov	[ebp-14h], eax
		jmp	short loc_40517A
; ---------------------------------------------------------------------------

loc_405173:				; CODE XREF: .text:00405163j
		mov	dword ptr [ebp-14h], 0

loc_40517A:				; CODE XREF: .text:00405169j
					; .text:00405171j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1

loc_405182:				; CODE XREF: .text:0040514Cj
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40514E
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_4051A3
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0

loc_4051A3:				; CODE XREF: .text:0040519Bj
		mov	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_4051ED
; ---------------------------------------------------------------------------

loc_4051BD:				; CODE XREF: .text:004051F5j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_4051E2
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_4051E9
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_4051E9
; ---------------------------------------------------------------------------

loc_4051E2:				; CODE XREF: .text:004051D2j
		mov	dword ptr [ebp-10h], 0

loc_4051E9:				; CODE XREF: .text:004051D8j
					; .text:004051E0j
		add	dword ptr [ebp-0Ch], 1

loc_4051ED:				; CODE XREF: .text:004051BBj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4051BD
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_405203
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_405203:				; CODE XREF: .text:004051FBj
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405208(int, int, char	*)
sub_405208	proc near		; CODE XREF: .text:0040529Fp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_40525D
; ---------------------------------------------------------------------------

loc_405224:				; CODE XREF: sub_405208+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_40524E
		cmp	[ebp+var_10], 0
		jnz	short loc_405255
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_405255
; ---------------------------------------------------------------------------

loc_40524E:				; CODE XREF: sub_405208+36j
		mov	[ebp+var_10], 0

loc_405255:				; CODE XREF: sub_405208+3Cj
					; sub_405208+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_40525D:				; CODE XREF: sub_405208+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_405224
		cmp	[ebp+var_10], 0
		jz	short loc_40527F
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_405282
; ---------------------------------------------------------------------------

loc_40527F:				; CODE XREF: sub_405208+61j
		mov	eax, [ebp+arg_4]

locret_405282:				; CODE XREF: sub_405208+75j
		leave
		retn
sub_405208	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_40E9CC ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405208
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4052A6(int, int, char	*)
sub_4052A6	proc near		; CODE XREF: .text:00405337p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4052FB
; ---------------------------------------------------------------------------

loc_4052C2:				; CODE XREF: sub_4052A6+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4052EC
		cmp	[ebp+var_10], 0
		jnz	short loc_4052F3
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_4052F3
; ---------------------------------------------------------------------------

loc_4052EC:				; CODE XREF: sub_4052A6+36j
		mov	[ebp+var_10], 0

loc_4052F3:				; CODE XREF: sub_4052A6+3Cj
					; sub_4052A6+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_4052FB:				; CODE XREF: sub_4052A6+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_4052C2
		cmp	[ebp+var_10], 0
		jz	short loc_405317
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_40531A
; ---------------------------------------------------------------------------

loc_405317:				; CODE XREF: sub_4052A6+61j
		mov	eax, [ebp+arg_4]

locret_40531A:				; CODE XREF: sub_4052A6+6Fj
		leave
		retn
sub_4052A6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_40E9CC ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4052A6
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4053A5
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4053A5
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4053A5
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404E27
		jmp	short locret_4053B3
; ---------------------------------------------------------------------------

loc_4053A5:				; CODE XREF: .text:0040535Ej
					; .text:0040537Aj ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_404E27

locret_4053B3:				; CODE XREF: .text:004053A3j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40541D
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40541D
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40541D
		mov	dword ptr [esp], offset	a_ ; "."
		call	sub_404E27
		jmp	short locret_405462
; ---------------------------------------------------------------------------

loc_40541D:				; CODE XREF: .text:004053D5j
					; .text:004053F1j ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	sub_404D24
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_405462:				; CODE XREF: .text:0040541Bj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405464	proc near		; CODE XREF: sub_405476+144p
					; sub_405476+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_405464	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405476	proc near		; CODE XREF: .text:004057FEp
					; sub_40580B+23p

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40553D
; ---------------------------------------------------------------------------

loc_4054C3:				; CODE XREF: sub_405476+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_405539
		cmp	[ebp+arg_0], 0
		jz	short loc_405522
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_407334
; ---------------------------------------------------------------------------

loc_405522:				; CODE XREF: sub_405476+8Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_4057D1
; ---------------------------------------------------------------------------

loc_405539:				; CODE XREF: sub_405476+88j
		add	[ebp+var_C], 1

loc_40553D:				; CODE XREF: sub_405476+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_4054C3
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_4056F4
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_405597
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40560D

loc_405597:				; CODE XREF: sub_405476+112j
		mov	[esp+0C8h+VarName], offset VarName ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4055C8
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_405464
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_4055C8:				; CODE XREF: sub_405476+134j
		cmp	[ebp+var_20], 0
		jz	loc_4056F3
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4056F3
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_4056F3
; ---------------------------------------------------------------------------

loc_40560D:				; CODE XREF: sub_405476+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_405626
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_404E27
		mov	[ebp+Str], eax
		jmp	short loc_405647
; ---------------------------------------------------------------------------

loc_405626:				; CODE XREF: sub_405476+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_404D48
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_405647
		mov	eax, 0
		jmp	loc_4057D1
; ---------------------------------------------------------------------------

loc_405647:				; CODE XREF: sub_405476+1AEj
					; sub_405476+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_405669
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_405669:				; CODE XREF: sub_405476+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_405464
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_404E81
		cmp	[ebp+var_20], 0
		jz	short loc_4056EA
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_4056F4
; ---------------------------------------------------------------------------

loc_4056EA:				; CODE XREF: sub_405476+248j
		mov	[ebp+var_14], 1
		jmp	short loc_4056F4
; ---------------------------------------------------------------------------

loc_4056F3:				; CODE XREF: sub_405476+156j
					; sub_405476+164j ...
		nop

loc_4056F4:				; CODE XREF: sub_405476+101j
					; sub_405476+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_40570A
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_404D24
		mov	[ebp+var_1C], eax
		jmp	short loc_405733
; ---------------------------------------------------------------------------

loc_40570A:				; CODE XREF: sub_405476+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_404D11
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_405733
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_404E81
		mov	eax, 0
		jmp	loc_4057D1
; ---------------------------------------------------------------------------

loc_405733:				; CODE XREF: sub_405476+292j
					; sub_405476+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_405764
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_4063B9
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_4063B9
		mov	[ebp+var_24], eax
		jmp	short loc_405779
; ---------------------------------------------------------------------------

loc_405764:				; CODE XREF: sub_405476+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_4063B9
		mov	[ebp+var_24], eax

loc_405779:				; CODE XREF: sub_405476+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_404E81
		mov	[ebp+var_C], 0
		jmp	short loc_4057B8
; ---------------------------------------------------------------------------

loc_40578D:				; CODE XREF: sub_405476+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_4063B9
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_4057B8:				; CODE XREF: sub_405476+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_40578D
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_404E9C

loc_4057D1:				; CODE XREF: sub_405476+BEj
					; sub_405476+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_405476	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 1
		call	sub_405476
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40580B	proc near		; CODE XREF: sub_403CD5+6E8p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 0
		call	sub_405476
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40580B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_4058B0
; ---------------------------------------------------------------------------

loc_405844:				; CODE XREF: .text:004058C2j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4058A8
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_4058A8
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_405894
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4058A8

loc_405894:				; CODE XREF: .text:00405888j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4058C4
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4058C4

loc_4058A8:				; CODE XREF: .text:00405852j
					; .text:0040587Ej ...
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1

loc_4058B0:				; CODE XREF: .text:00405842j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4058C4
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405844

loc_4058C4:				; CODE XREF: .text:0040589Cj
					; .text:004058A6j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4058D8
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4058EC

loc_4058D8:				; CODE XREF: .text:004058CCj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4058F3
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4058F3

loc_4058EC:				; CODE XREF: .text:004058D6j
		mov	eax, 0
		jmp	short loc_405921
; ---------------------------------------------------------------------------

loc_4058F3:				; CODE XREF: .text:004058E0j
					; .text:004058EAj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_405921:				; CODE XREF: .text:004058F1j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_405955
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_405955
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4059AC
; ---------------------------------------------------------------------------

loc_405955:				; CODE XREF: .text:00405935j
					; .text:0040593Fj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40597D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40597D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4059AC
; ---------------------------------------------------------------------------

loc_40597D:				; CODE XREF: .text:0040595Dj
					; .text:00405967j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4059A5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4059A5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4059AC
; ---------------------------------------------------------------------------

loc_4059A5:				; CODE XREF: .text:00405985j
					; .text:0040598Fj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_405A29
; ---------------------------------------------------------------------------

loc_4059AC:				; CODE XREF: .text:00405953j
					; .text:0040597Bj ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4059D5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4059D5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_405A26
; ---------------------------------------------------------------------------

loc_4059D5:				; CODE XREF: .text:004059B8j
					; .text:004059C2j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4059FA
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4059FA
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_405A26
; ---------------------------------------------------------------------------

loc_4059FA:				; CODE XREF: .text:004059DDj
					; .text:004059E7j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_405A1F
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_405A1F
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_405A26
; ---------------------------------------------------------------------------

loc_405A1F:				; CODE XREF: .text:00405A02j
					; .text:00405A0Cj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_405A29
; ---------------------------------------------------------------------------

loc_405A26:				; CODE XREF: .text:004059D3j
					; .text:004059F8j ...
		mov	eax, [ebp-4]

locret_405A29:				; CODE XREF: .text:004059AAj
					; .text:00405A24j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405A2B(FILE *, int, int, int,	int)
sub_405A2B	proc near		; CODE XREF: sub_405BE4+29p
					; .text:00405D21p

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_405BD5
; ---------------------------------------------------------------------------

loc_405A43:				; CODE XREF: sub_405A2B+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_405A91
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_405A91
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_405A91
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_405A91
		cmp	[ebp+arg_C], 0
		jnz	short loc_405A83
		cmp	[ebp+arg_10], 0
		jz	loc_405BAD

loc_405A83:				; CODE XREF: sub_405A2B+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_405BAD

loc_405A91:				; CODE XREF: sub_405A2B+20j
					; sub_405A2B+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_405ACE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_405BC9
; ---------------------------------------------------------------------------

loc_405ACE:				; CODE XREF: sub_405A2B+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_405AF4
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_405BC9
; ---------------------------------------------------------------------------

loc_405AF4:				; CODE XREF: sub_405A2B+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_405B1A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_405BC9
; ---------------------------------------------------------------------------

loc_405B1A:				; CODE XREF: sub_405A2B+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_405B40
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_405BC9
; ---------------------------------------------------------------------------

loc_405B40:				; CODE XREF: sub_405A2B+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_405B63
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_405BC9
; ---------------------------------------------------------------------------

loc_405B63:				; CODE XREF: sub_405A2B+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405B86
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_405BC9
; ---------------------------------------------------------------------------

loc_405B86:				; CODE XREF: sub_405A2B+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_405BC9
; ---------------------------------------------------------------------------

loc_405BAD:				; CODE XREF: sub_405A2B+52j
					; sub_405A2B+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_405BC9:				; CODE XREF: sub_405A2B+9Ej
					; sub_405A2B+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_405BD5:				; CODE XREF: sub_405A2B+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_405A43
		mov	eax, [ebp+var_10]
		leave
		retn
sub_405A2B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405BE4(FILE *, int, int, int)
sub_405BE4	proc near		; CODE XREF: sub_405C14+B7p
					; .text:00405D77p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_405A2B
		leave
		retn
sub_405BE4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405C14(FILE *, int, int, int)
sub_405C14	proc near		; CODE XREF: .text:00405DCDp

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_405C3D
; ---------------------------------------------------------------------------

loc_405C2A:				; CODE XREF: sub_405C14+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_405C47
		add	[ebp+var_C], 1

loc_405C3D:				; CODE XREF: sub_405C14+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_405C2A
		jmp	short loc_405C48
; ---------------------------------------------------------------------------

loc_405C47:				; CODE XREF: sub_405C14+23j
		nop

loc_405C48:				; CODE XREF: sub_405C14+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_405CB0
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_40819B
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; void *
		call	sub_404E81
		mov	eax, [ebp+var_C]
		jmp	short loc_405CD0
; ---------------------------------------------------------------------------

loc_405CB0:				; CODE XREF: sub_405C14+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_405BE4

loc_405CD0:				; CODE XREF: sub_405C14+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_405C14	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_405D28
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405A2B
		jmp	short loc_405D2D
; ---------------------------------------------------------------------------

loc_405D28:				; CODE XREF: .text:00405CE1j
		mov	eax, 0

loc_405D2D:				; CODE XREF: .text:00405D26j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_405D7E
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405BE4
		jmp	short loc_405D83
; ---------------------------------------------------------------------------

loc_405D7E:				; CODE XREF: .text:00405D3Ej
		mov	eax, 0

loc_405D83:				; CODE XREF: .text:00405D7Cj
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_405DD4
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405C14
		jmp	short loc_405DD9
; ---------------------------------------------------------------------------

loc_405DD4:				; CODE XREF: .text:00405D94j
		mov	eax, 0

loc_405DD9:				; CODE XREF: .text:00405DD2j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 1
		jmp	loc_405E89
; ---------------------------------------------------------------------------

loc_405E03:				; CODE XREF: .text:00405E8Dj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_405E35
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_405E35
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_405E35
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_405E7D
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_405E7D

loc_405E35:				; CODE XREF: .text:00405E0Bj
					; .text:00405E15j ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_405E71
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_405E71
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_405E71
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_405E71
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_405E71
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405E77

loc_405E71:				; CODE XREF: .text:00405E3Dj
					; .text:00405E47j ...
		add	dword ptr [ebp-10h], 2
		jmp	short loc_405E81
; ---------------------------------------------------------------------------

loc_405E77:				; CODE XREF: .text:00405E6Fj
		add	dword ptr [ebp-10h], 5
		jmp	short loc_405E81
; ---------------------------------------------------------------------------

loc_405E7D:				; CODE XREF: .text:00405E29j
					; .text:00405E33j
		add	dword ptr [ebp-10h], 1

loc_405E81:				; CODE XREF: .text:00405E75j
					; .text:00405E7Bj
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_405E89:				; CODE XREF: .text:00405DFEj
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_405E03
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-18h]
		mov	[ebp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_404D24
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-14h], eax
		jmp	loc_405FC6
; ---------------------------------------------------------------------------

loc_405EB8:				; CODE XREF: .text:00405FCAj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_405EF2
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_405EF2
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_405EF2
		cmp	dword ptr [ebp+10h], 0
		jz	loc_405FAD
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_405FAD

loc_405EF2:				; CODE XREF: .text:00405EC0j
					; .text:00405ECAj ...
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_405F15
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	6Eh
		add	dword ptr [ebp-14h], 1
		jmp	loc_405FBE
; ---------------------------------------------------------------------------

loc_405F15:				; CODE XREF: .text:00405F04j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_405F2E
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	72h
		add	dword ptr [ebp-14h], 1
		jmp	loc_405FBE
; ---------------------------------------------------------------------------

loc_405F2E:				; CODE XREF: .text:00405F1Dj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_405F44
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	66h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_405FBE
; ---------------------------------------------------------------------------

loc_405F44:				; CODE XREF: .text:00405F36j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_405F5A
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	76h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_405FBE
; ---------------------------------------------------------------------------

loc_405F5A:				; CODE XREF: .text:00405F4Cj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_405F70
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	62h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_405FBE
; ---------------------------------------------------------------------------

loc_405F70:				; CODE XREF: .text:00405F62j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405F86
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	30h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_405FBE
; ---------------------------------------------------------------------------

loc_405F86:				; CODE XREF: .text:00405F78j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sprintf
		add	dword ptr [ebp-14h], 3
		jmp	short loc_405FBE
; ---------------------------------------------------------------------------

loc_405FAD:				; CODE XREF: .text:00405EDEj
					; .text:00405EECj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1

loc_405FBE:				; CODE XREF: .text:00405F10j
					; .text:00405F29j ...
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_405FC6:				; CODE XREF: .text:00405EB3j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_405EB8
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_406007
; ---------------------------------------------------------------------------

loc_405FEA:				; CODE XREF: .text:0040600Fj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_406003
		add	dword ptr [ebp-4], 1

loc_406003:				; CODE XREF: .text:00405FFDj
		add	dword ptr [ebp+8], 1

loc_406007:				; CODE XREF: .text:00405FE8j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405FEA
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jnz	short loc_40602C
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+8], eax

loc_40602C:				; CODE XREF: .text:00406020j
		mov	eax, [ebp+8]
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0FFh
		mov	dword ptr [esp+10h], offset dword_410320
		mov	dword ptr [esp+0Ch], 400h
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 1000h
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset dword_410320
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_406089
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_406089
		mov	eax, 1
		jmp	short loc_40608E
; ---------------------------------------------------------------------------

loc_406089:				; CODE XREF: .text:0040607Aj
					; .text:00406080j
		mov	eax, 0

loc_40608E:				; CODE XREF: .text:00406087j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_4060A6
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_4060A6
		mov	eax, 1
		jmp	short loc_4060AB
; ---------------------------------------------------------------------------

loc_4060A6:				; CODE XREF: .text:00406097j
					; .text:0040609Dj
		mov	eax, 0

loc_4060AB:				; CODE XREF: .text:004060A4j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4060AD	proc near		; CODE XREF: .text:00404FFAp
					; .text:0040500Dp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_4060C0
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_4060C0
		and	[ebp+arg_0], 0FFFFFFDFh

loc_4060C0:				; CODE XREF: sub_4060AD+7j
					; sub_4060AD+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_4060AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4060C5	proc near		; CODE XREF: .text:004061CAp
					; .text:004061DEp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_4060D8
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_4060D8
		or	[ebp+arg_0], 20h

loc_4060D8:				; CODE XREF: sub_4060C5+7j
					; sub_4060C5+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_4060C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4060DD	proc near		; CODE XREF: .text:004075EEp
					; .text:00407605p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_406138
		mov	eax, 0
		jmp	loc_406191
; ---------------------------------------------------------------------------

loc_4060F6:				; CODE XREF: sub_4060DD+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_40612E
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_4060AD
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_4060AD
		cmp	ebx, eax
		jnz	short loc_40614F

loc_40612E:				; CODE XREF: sub_4060DD+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_406139
; ---------------------------------------------------------------------------

loc_406138:				; CODE XREF: sub_4060DD+Dj
		nop

loc_406139:				; CODE XREF: sub_4060DD+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406150
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4060F6
		jmp	short loc_406150
; ---------------------------------------------------------------------------

loc_40614F:				; CODE XREF: sub_4060DD+4Fj
		nop

loc_406150:				; CODE XREF: sub_4060DD+64j
					; sub_4060DD+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_40618C
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_4060AD
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_4060AD
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_406191
; ---------------------------------------------------------------------------

loc_40618C:				; CODE XREF: sub_4060DD+81j
		mov	eax, 0

loc_406191:				; CODE XREF: sub_4060DD+14j
					; sub_4060DD+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_4060DD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_4061B7
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_4061BE

loc_4061B7:				; CODE XREF: .text:004061AFj
		mov	eax, 0
		jmp	short locret_406215
; ---------------------------------------------------------------------------

loc_4061BE:				; CODE XREF: .text:004061B5j
					; .text:00406205j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4060C5
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4060C5
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_406207
		cmp	byte ptr [ebp-9], 0
		jz	short loc_406207
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_4061BE

loc_406207:				; CODE XREF: .text:004061EEj
					; .text:004061F4j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_406215:				; CODE XREF: .text:004061BCj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406217	proc near		; CODE XREF: .text:00406398p
					; .text:004075B1p

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_4062C7
		mov	eax, 0
		jmp	loc_4062D6
; ---------------------------------------------------------------------------

loc_406240:				; CODE XREF: sub_406217+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4062BB
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_4060AD
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_4060AD
		cmp	ebx, eax
		jz	short loc_4062BB
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4062B4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_4060AD
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_4060AD
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_4062B9
; ---------------------------------------------------------------------------

loc_4062B4:				; CODE XREF: sub_406217+6Fj
		mov	eax, 0

loc_4062B9:				; CODE XREF: sub_406217+9Bj
		jmp	short loc_4062D6
; ---------------------------------------------------------------------------

loc_4062BB:				; CODE XREF: sub_406217+37j
					; sub_406217+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_4062C7:				; CODE XREF: sub_406217+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_406240
		mov	eax, 0

loc_4062D6:				; CODE XREF: sub_406217+24j
					; sub_406217:loc_4062B9j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_406217	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_406308
		mov	eax, 0
		jmp	short loc_40634F
; ---------------------------------------------------------------------------

loc_4062EE:				; CODE XREF: .text:0040631Bj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_40631F
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_406309
; ---------------------------------------------------------------------------

loc_406308:				; CODE XREF: .text:004062E5j
		nop

loc_406309:				; CODE XREF: .text:00406306j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406320
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4062EE
		jmp	short loc_406320
; ---------------------------------------------------------------------------

loc_40631F:				; CODE XREF: .text:004062FCj
		nop

loc_406320:				; CODE XREF: .text:00406311j
					; .text:0040631Dj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_40634A
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_40634F
; ---------------------------------------------------------------------------

loc_40634A:				; CODE XREF: .text:0040632Ej
		mov	eax, 0

loc_40634F:				; CODE XREF: .text:004062ECj
					; .text:00406348j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_406362
		mov	eax, [ebp+8]
		jmp	short locret_4063B7
; ---------------------------------------------------------------------------

loc_406362:				; CODE XREF: .text:0040635Bj
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_4063B2
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_4063AA
; ---------------------------------------------------------------------------

loc_406384:				; CODE XREF: .text:004063B0j
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_406217
		test	eax, eax
		jnz	short loc_4063A6
		mov	eax, [ebp-4]
		jmp	short locret_4063B7
; ---------------------------------------------------------------------------

loc_4063A6:				; CODE XREF: .text:0040639Fj
		add	dword ptr [ebp-4], 1

loc_4063AA:				; CODE XREF: .text:00406382j
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_406384

loc_4063B2:				; CODE XREF: .text:00406368j
		mov	eax, 0

locret_4063B7:				; CODE XREF: .text:00406360j
					; .text:004063A4j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4063B9	proc near		; CODE XREF: sub_405476+2D8p
					; sub_405476+2E4p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_4063D1
; ---------------------------------------------------------------------------

loc_4063BE:				; CODE XREF: sub_4063B9+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_4063D1:				; CODE XREF: sub_4063B9+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4063BE
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_4063B9	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_406404
		mov	eax, 0
		jmp	locret_4064AF
; ---------------------------------------------------------------------------

loc_406404:				; CODE XREF: .text:004063F8j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40641B
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406474

loc_40641B:				; CODE XREF: .text:0040640Cj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_406433
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_406489
; ---------------------------------------------------------------------------

loc_406433:				; CODE XREF: .text:00406428j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_406446
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_406489
; ---------------------------------------------------------------------------

loc_406446:				; CODE XREF: .text:0040643Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406459
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_406489
; ---------------------------------------------------------------------------

loc_406459:				; CODE XREF: .text:0040644Ej
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_406489
; ---------------------------------------------------------------------------

loc_406474:				; CODE XREF: .text:00406419j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_406489:				; CODE XREF: .text:00406431j
					; .text:00406444j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4064A3
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_4064AC
; ---------------------------------------------------------------------------

loc_4064A3:				; CODE XREF: .text:0040648Dj
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_4064AC:				; CODE XREF: .text:004064A1j
		mov	eax, [ebp-10h]

locret_4064AF:				; CODE XREF: .text:004063FFj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+10h]
		add	[ebp-4], eax
		jmp	short loc_4064E0
; ---------------------------------------------------------------------------

loc_4064C5:				; CODE XREF: .text:004064E4j
		sub	dword ptr [ebp-4], 1
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+0Ch]
		jnz	short loc_4064DC
		mov	eax, [ebp-4]
		jmp	short locret_4064EB
; ---------------------------------------------------------------------------

loc_4064DC:				; CODE XREF: .text:004064D5j
		sub	dword ptr [ebp+10h], 1

loc_4064E0:				; CODE XREF: .text:004064C3j
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_4064C5
		mov	eax, 0

locret_4064EB:				; CODE XREF: .text:004064DAj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4064ED(int, char *, int)
sub_4064ED	proc near		; CODE XREF: .text:0040671Dp
					; .text:0040673Fp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_406503
		mov	eax, 0
		jmp	locret_406700
; ---------------------------------------------------------------------------

loc_406503:				; CODE XREF: sub_4064ED+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_406559
; ---------------------------------------------------------------------------

loc_406512:				; CODE XREF: sub_4064ED+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_406551
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_406551
		cmp	[ebp+arg_4], 0
		jz	short loc_406555
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_406555

loc_406551:				; CODE XREF: sub_4064ED+30j
					; sub_4064ED+3Dj
		add	[ebp+var_10], 1

loc_406555:				; CODE XREF: sub_4064ED+43j
					; sub_4064ED+62j
		add	[ebp+var_C], 1

loc_406559:				; CODE XREF: sub_4064ED+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406512
		cmp	[ebp+arg_8], 0
		jz	short loc_406584
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_404D24
		mov	[ebp+var_14], eax
		jmp	short loc_4065AA
; ---------------------------------------------------------------------------

loc_406584:				; CODE XREF: sub_4064ED+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_404D11
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4065AA
		mov	eax, 0
		jmp	locret_406700
; ---------------------------------------------------------------------------

loc_4065AA:				; CODE XREF: sub_4064ED+95j
					; sub_4064ED+B1j
		mov	[ebp+var_C], 0
		jmp	loc_4066E6
; ---------------------------------------------------------------------------

loc_4065B6:				; CODE XREF: sub_4064ED+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_4065EC
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_4066E2
; ---------------------------------------------------------------------------

loc_4065EC:				; CODE XREF: sub_4064ED+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_406622
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_4066E2
; ---------------------------------------------------------------------------

loc_406622:				; CODE XREF: sub_4064ED+107j
		cmp	[ebp+arg_4], 0
		jz	loc_4066D0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_4066D0
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_406683
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_40668F
; ---------------------------------------------------------------------------

loc_406683:				; CODE XREF: sub_4064ED+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_40668F:				; CODE XREF: sub_4064ED+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4066BC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_4066C8
; ---------------------------------------------------------------------------

loc_4066BC:				; CODE XREF: sub_4064ED+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_4066C8:				; CODE XREF: sub_4064ED+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_4066E2
; ---------------------------------------------------------------------------

loc_4066D0:				; CODE XREF: sub_4064ED+139j
					; sub_4064ED+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_4066E2:				; CODE XREF: sub_4064ED+FAj
					; sub_4064ED+130j ...
		add	[ebp+arg_0], 1

loc_4066E6:				; CODE XREF: sub_4064ED+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4065B6
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_406700:				; CODE XREF: sub_4064ED+11j
					; sub_4064ED+B8j
		leave
		retn
sub_4064ED	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4064ED
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4064ED
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406746	proc near		; CODE XREF: sub_406863+32p
					; .text:004068D4p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4067DF
; ---------------------------------------------------------------------------

loc_406792:				; CODE XREF: sub_406746+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_4067DB
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_40685A
; ---------------------------------------------------------------------------

loc_4067DB:				; CODE XREF: sub_406746+7Fj
		add	[ebp+var_C], 1

loc_4067DF:				; CODE XREF: sub_406746+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_406792
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax ; size_t
		call	sub_404D11
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_406857
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_406849
; ---------------------------------------------------------------------------

loc_406829:				; CODE XREF: sub_406746+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_4063B9
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_406849:				; CODE XREF: sub_406746+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_406829

loc_406857:				; CODE XREF: sub_406746+D2j
		mov	eax, [ebp+var_18]

loc_40685A:				; CODE XREF: sub_406746+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_406746	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406863	proc near		; CODE XREF: sub_401700+304p
					; sub_402232+111p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_406880
		mov	[esp+28h+var_28], offset word_40EA06 ; char *
		call	sub_404D48
		mov	[ebp+var_C], eax
		jmp	short loc_40689D
; ---------------------------------------------------------------------------

loc_406880:				; CODE XREF: sub_406863+Aj
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406746
		mov	[ebp+var_C], eax

loc_40689D:				; CODE XREF: sub_406863+1Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406863	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4068BF
		mov	dword ptr [esp], offset	word_40EA06
		call	sub_404E27
		mov	[ebp-0Ch], eax
		jmp	short loc_4068DC
; ---------------------------------------------------------------------------

loc_4068BF:				; CODE XREF: .text:004068ACj
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406746
		mov	[ebp-0Ch], eax

loc_4068DC:				; CODE XREF: .text:004068BDj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_406950
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_40691B
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 25h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		jmp	short loc_406944
; ---------------------------------------------------------------------------

loc_40691B:				; CODE XREF: .text:004068EEj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 16h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite

loc_406944:				; CODE XREF: .text:00406919j
		mov	dword ptr [esp], 2
		call	exit
; ---------------------------------------------------------------------------

loc_406950:				; CODE XREF: .text:004068E0j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_4104AC
		mov	[ebp-4], eax
		cmp	dword ptr [ebp+8], 0
		jz	short loc_406976
		mov	ds:dword_4104AC, 0

loc_406976:				; CODE XREF: .text:0040696Aj
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4104AC
		add	eax, 1
		mov	ds:dword_4104AC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40698D(char *Filename, int FileHandle)
sub_40698D	proc near		; CODE XREF: sub_406BEC+21p
					; .text:00406C28p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_410420
		test	eax, eax
		jz	short loc_4069D7
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:dword_410420
		cmp	edx, eax
		jz	short loc_4069CD
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:dword_410420
		cmp	edx, eax
		jz	short loc_4069CD
		mov	eax, ds:dword_410420
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_4069CD:				; CODE XREF: sub_40698D+20j
					; sub_40698D+31j
		mov	ds:dword_410420, 0

loc_4069D7:				; CODE XREF: sub_40698D+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_406A1F
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_40EA58 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_406A1F
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_406A1F:				; CODE XREF: sub_40698D+4Ej
					; sub_40698D+76j
		cmp	[ebp+Filename],	0
		jz	short loc_406A75
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_406A61
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406A61
		mov	eax, 1
		jmp	short loc_406A66
; ---------------------------------------------------------------------------

loc_406A61:				; CODE XREF: sub_40698D+BEj
					; sub_40698D+CBj
		mov	eax, 0

loc_406A66:				; CODE XREF: sub_40698D+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406A7C
		add	[ebp+Filename],	9
		jmp	short loc_406A7C
; ---------------------------------------------------------------------------

loc_406A75:				; CODE XREF: sub_40698D+96j
		mov	[ebp+var_10], 0

loc_406A7C:				; CODE XREF: sub_40698D+E0j
					; sub_40698D+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_406AB8
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_406B13
; ---------------------------------------------------------------------------

loc_406AB8:				; CODE XREF: sub_40698D+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_406AD7
		mov	eax, offset aA	; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_406B13
; ---------------------------------------------------------------------------

loc_406AD7:				; CODE XREF: sub_40698D+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_406AEA
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_406B13
; ---------------------------------------------------------------------------

loc_406AEA:				; CODE XREF: sub_40698D+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_406AFD
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_406B13
; ---------------------------------------------------------------------------

loc_406AFD:				; CODE XREF: sub_40698D+161j
		mov	[esp+28h+Size],	offset aA ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_406B13:				; CODE XREF: sub_40698D+129j
					; sub_40698D+148j ...
		mov	dword_40D000, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_406BA8
		cmp	[ebp+Filename],	0
		jz	short loc_406B65
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_406B9B
; ---------------------------------------------------------------------------

loc_406B65:				; CODE XREF: sub_40698D+19Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_406B9B:				; CODE XREF: sub_40698D+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_406BCB
; ---------------------------------------------------------------------------

loc_406BA8:				; CODE XREF: sub_40698D+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_406BCB:				; CODE XREF: sub_40698D+219j
		mov	eax, [ebp+var_C]
		mov	ds:dword_410420, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_4104A4, eax
		mov	ds:dword_4104A8, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40698D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406BEC(char *)
sub_406BEC	proc near		; CODE XREF: sub_406DAE+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_406BFD
		mov	eax, [ebp+arg_0]
		jmp	short loc_406C02
; ---------------------------------------------------------------------------

loc_406BFD:				; CODE XREF: sub_406BEC+Aj
		mov	eax, offset asc_40EA58 ; "-"

loc_406C02:				; CODE XREF: sub_406BEC+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_40698D
		leave
		retn
sub_406BEC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_40698D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_41049C, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_406C6A
		mov	dword ptr [esp+8], 4Fh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	byte_410440
		call	strncpy
		mov	ds:byte_41048F,	0

loc_406C6A:				; CODE XREF: .text:00406C46j
		mov	eax, [ebp+0Ch]
		and	eax, 1
		mov	ds:dword_410494, eax
		mov	eax, [ebp+0Ch]
		and	eax, 2
		mov	ds:dword_410490, eax
		mov	eax, [ebp+0Ch]
		and	eax, 4
		mov	ds:dword_410498, eax
		mov	eax, [ebp+0Ch]
		and	eax, 100h
		mov	ds:dword_4104A0, eax
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_406D0C
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_410494
		test	eax, eax
		jz	short loc_406CC4
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_406CC4:				; CODE XREF: .text:00406CB3j
		mov	eax, ds:dword_410490
		test	eax, eax
		jz	short loc_406CDC
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_406CDC:				; CODE XREF: .text:00406CCBj
		mov	eax, ds:dword_410498
		test	eax, eax
		jz	short loc_406CF4
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_406CF4:				; CODE XREF: .text:00406CE3j
		mov	eax, ds:dword_4104A0
		test	eax, eax
		jz	short loc_406D0C
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_406D0C:				; CODE XREF: .text:00406CA1j
					; .text:00406CFBj
		mov	eax, offset byte_410440
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_410420
		test	eax, eax
		jz	short loc_406D47
		mov	eax, ds:dword_410420
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_406D47
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_406D47
		mov	eax, 1
		jmp	short locret_406D67
; ---------------------------------------------------------------------------

loc_406D47:				; CODE XREF: .text:00406D20j
					; .text:00406D36j ...
		mov	eax, dword_40D000
		cmp	eax, 0FFFFFFFFh
		jz	short loc_406D62
		mov	eax, dword_40D000
		cmp	eax, [ebp+8]
		jnz	short loc_406D62
		mov	eax, 1
		jmp	short locret_406D67
; ---------------------------------------------------------------------------

loc_406D62:				; CODE XREF: .text:00406D4Fj
					; .text:00406D59j
		mov	eax, 0

locret_406D67:				; CODE XREF: .text:00406D45j
					; .text:00406D60j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_410420
		test	eax, eax
		jnz	short loc_406D82
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_406D87
; ---------------------------------------------------------------------------

loc_406D82:				; CODE XREF: .text:00406D76j
		mov	eax, ds:dword_410420

loc_406D87:				; CODE XREF: .text:00406D80j
		mov	[esp], eax
		call	_fileno
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_410420
		test	eax, eax
		jnz	short loc_406DA7
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_406DAC
; ---------------------------------------------------------------------------

loc_406DA7:				; CODE XREF: .text:00406D9Bj
		mov	eax, ds:dword_410420

loc_406DAC:				; CODE XREF: .text:00406DA5j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406DAE(int, char *Format, va_list ArgList)
sub_406DAE	proc near		; CODE XREF: sub_407131+22p
					; .text:00407174p ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_410420
		test	eax, eax
		jnz	short loc_406DF1
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_406BEC
		mov	eax, ds:dword_410420
		test	eax, eax
		jnz	short loc_406DF1
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_40BDA0

loc_406DF1:				; CODE XREF: sub_406DAE+10j
					; sub_406DAE+25j
		mov	eax, ds:dword_4104A8
		test	eax, eax
		jz	short loc_406E15
		cmp	[ebp+arg_0], 1
		jz	short loc_406E15
		mov	eax, ds:dword_410420
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_406E15:				; CODE XREF: sub_406DAE+4Aj
					; sub_406DAE+50j
		mov	ds:dword_4104A8, 0
		cmp	[ebp+arg_0], 1
		jz	loc_406FAC
		mov	eax, ds:dword_410490
		test	eax, eax
		jz	loc_406EC5
		mov	eax, ds:dword_4104A4
		test	eax, eax
		jnz	loc_406EC5
		mov	[esp+58h+var_58], 0
		call	sub_40BE70
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_40BE80
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:dword_410420
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_406EC5:				; CODE XREF: sub_406DAE+82j
					; sub_406DAE+8Fj
		mov	eax, ds:dword_410494
		test	eax, eax
		jnz	short loc_406ED7
		mov	eax, ds:dword_4104A4
		test	eax, eax
		jz	short loc_406EEE

loc_406ED7:				; CODE XREF: sub_406DAE+11Ej
		mov	edx, ds:dword_410420
		mov	eax, offset byte_410440
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_406EEE:				; CODE XREF: sub_406DAE+127j
		mov	eax, ds:dword_410498
		test	eax, eax
		jnz	short loc_406F00
		mov	eax, ds:dword_4104A4
		test	eax, eax
		jz	short loc_406F5A

loc_406F00:				; CODE XREF: sub_406DAE+147j
		mov	eax, ds:dword_41049C
		test	eax, eax
		jz	short loc_406F39
		mov	eax, ds:dword_41049C
		call	eax ; dword_41049C
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:dword_410420
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_406F5A
; ---------------------------------------------------------------------------

loc_406F39:				; CODE XREF: sub_406DAE+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU	; "[%u]"
		mov	eax, ds:dword_410420
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_406F5A:				; CODE XREF: sub_406DAE+150j
					; sub_406DAE+189j
		mov	eax, ds:dword_410490
		test	eax, eax
		jz	short loc_406F6C
		mov	eax, ds:dword_4104A4
		test	eax, eax
		jz	short loc_406F81

loc_406F6C:				; CODE XREF: sub_406DAE+1B3j
		mov	eax, ds:dword_410420
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_406F81:				; CODE XREF: sub_406DAE+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_406F97
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_406F97
		add	[ebp+Format], 1
		jmp	short loc_406FAC
; ---------------------------------------------------------------------------

loc_406F97:				; CODE XREF: sub_406DAE+1D7j
					; sub_406DAE+1E1j
		mov	eax, ds:dword_410420
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_406FAC:				; CODE XREF: sub_406DAE+75j
					; sub_406DAE+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_407040	; jumptable 00406FC3 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_40EB88
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406FC5:				; CODE XREF: sub_406DAE+215j
					; DATA XREF: .rdata:off_40EB88o
		mov	edx, ds:dword_410420 ; jumptable 00406FC3 case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_407060
; ---------------------------------------------------------------------------

loc_406FEE:				; CODE XREF: sub_406DAE+215j
					; DATA XREF: .rdata:off_40EB88o
		mov	edx, ds:dword_410420 ; jumptable 00406FC3 case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_407060
; ---------------------------------------------------------------------------

loc_407017:				; CODE XREF: sub_406DAE+215j
					; DATA XREF: .rdata:off_40EB88o
		mov	edx, ds:dword_410420 ; jumptable 00406FC3 case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_407060
; ---------------------------------------------------------------------------

loc_407040:				; CODE XREF: sub_406DAE+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	00406FC3 default case
		mov	eax, ds:dword_410420
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_407060
; ---------------------------------------------------------------------------

loc_40705F:				; CODE XREF: sub_406DAE+215j
					; DATA XREF: .rdata:off_40EB88o
		nop			; jumptable 00406FC3 cases 0-4

loc_407060:				; CODE XREF: sub_406DAE+23Ej
					; sub_406DAE+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_4070D0
		mov	eax, ds:dword_410420
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4070C3
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4070C3
		mov	ds:dword_4104A8, 1
		jmp	short loc_4070D0
; ---------------------------------------------------------------------------

loc_4070C3:				; CODE XREF: sub_406DAE+2DBj
					; sub_406DAE+307j
		mov	eax, ds:dword_410420
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_4070D0:				; CODE XREF: sub_406DAE+2B6j
					; sub_406DAE+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_407100
		mov	eax, ds:dword_4104A8
		test	eax, eax
		jz	short loc_4070F4
		mov	eax, ds:dword_410420
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_4070F4:				; CODE XREF: sub_406DAE+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_407100:				; CODE XREF: sub_406DAE+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_407129
		mov	eax, ds:dword_4104A8
		test	eax, eax
		jz	short loc_407124
		mov	eax, ds:dword_410420
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_407124:				; CODE XREF: sub_406DAE+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_407129:				; CODE XREF: sub_406DAE+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_406DAE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407131(int, char *, char)
sub_407131	proc near		; CODE XREF: sub_407334+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_406DAE
		leave
		retn
sub_407131	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406DAE
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40717B(char *, char)
sub_40717B	proc near		; CODE XREF: sub_407368+8Ep
					; sub_407368+C4p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_406DAE
		leave
		retn
sub_40717B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 4
		call	sub_406DAE
		mov	eax, ds:dword_4104AC
		cmp	eax, 752Fh
		jg	short locret_4071E6
		mov	eax, ds:dword_4104AC
		add	eax, 1
		mov	ds:dword_4104AC, eax

locret_4071E6:				; CODE XREF: .text:004071D7j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 5
		call	sub_406DAE
		call	abort
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 6
		call	sub_406DAE
		call	abort

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407242(char *, char)
sub_407242	proc near		; CODE XREF: .text:004072C0p

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_406DAE
		leave
		retn
sub_407242	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40726C(char *, char)
sub_40726C	proc near		; CODE XREF: .text:004072E5p
					; .text:00407308p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_406DAE
		leave
		retn
sub_40726C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4072C5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4072C5
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40EBA8
		call	sub_407242

loc_4072C5:				; CODE XREF: .text:004072A6j
					; .text:004072B0j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_407320
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x ; "%02X"
		call	sub_40726C
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_407311
; ---------------------------------------------------------------------------

loc_4072F4:				; CODE XREF: .text:0040731Ej
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_0 ; " %02X"
		call	sub_40726C
		add	dword ptr [ebp-0Ch], 1

loc_407311:				; CODE XREF: .text:004072F2j
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_4072F4

loc_407320:				; CODE XREF: .text:004072C9j
		cmp	dword ptr [ebp+8], 0
		jz	short locret_407332
		mov	dword ptr [esp], offset	asc_40EBB7 ; "\n"
		call	sub_40726C

locret_407332:				; CODE XREF: .text:00407324j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_407334	proc near		; CODE XREF: sub_405476+A7p
					; sub_4079C9+6C5p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_407131
		call	abort
sub_407334	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407368	proc near		; CODE XREF: .text:004076E2p
					; .text:0040772Bp ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_4073FD
		cmp	[ebp+arg_0], 0
		jz	short loc_4073C1
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4073C1
		mov	eax, ds:dword_4104F0
		mov	[ebp+var_1C], eax
		mov	ds:dword_4104F0, 1
		jmp	short loc_4073D3
; ---------------------------------------------------------------------------

loc_4073C1:				; CODE XREF: sub_407368+1Bj
					; sub_407368+43j
		mov	eax, ds:dword_4104F4
		mov	[ebp+var_1C], eax
		mov	ds:dword_4104F4, 1

loc_4073D3:				; CODE XREF: sub_407368+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_40743B
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_409CD4
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40717B
		jmp	short loc_40743B
; ---------------------------------------------------------------------------

loc_4073FD:				; CODE XREF: sub_407368+15j
		mov	eax, ds:dword_4104F8
		test	eax, eax
		jnz	short loc_407431
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_409CD4
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40717B

loc_407431:				; CODE XREF: sub_407368+9Cj
		mov	ds:dword_4104F8, 1

loc_40743B:				; CODE XREF: sub_407368+6Fj
					; sub_407368+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_40745F
		mov	off_40D004, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_4104C0, 0
		mov	ds:dword_4104C4, 0

loc_40745F:				; CODE XREF: sub_407368+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_407368	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jnz	loc_407571
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407492
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp-0Ch], eax

loc_407492:				; CODE XREF: .text:00407486j
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp-0Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4104D0
		call	sprintf
		mov	dword ptr [ebp+8], offset dword_4104D0
		mov	dword ptr [ebp-10h], offset aCp936 ; "CP936"
		jmp	loc_407563
; ---------------------------------------------------------------------------

loc_4074C1:				; CODE XREF: .text:0040756Bj
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4104D0
		call	strcmp
		test	eax, eax
		jz	short loc_4074EF
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_407519
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407519

loc_4074EF:				; CODE XREF: .text:004074D6j
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp-10h]
		mov	[ebp+8], eax
		jmp	short loc_407571
; ---------------------------------------------------------------------------

loc_407519:				; CODE XREF: .text:004074E0j
					; .text:004074EDj
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax

loc_407563:				; CODE XREF: .text:004074BCj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4074C1

loc_407571:				; CODE XREF: .text:00407472j
					; .text:00407517j
		mov	eax, [ebp+8]
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_4075D6
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], offset aIso ; "iso"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406217
		test	eax, eax
		jnz	short loc_4075D6
		add	dword ptr [ebp+8], 3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_4075D2
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_4075D6

loc_4075D2:				; CODE XREF: .text:004075C6j
		add	dword ptr [ebp+8], 1

loc_4075D6:				; CODE XREF: .text:00407599j
					; .text:004075B8j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40763C
		mov	dword ptr [esp+4], offset a88591 ; "8859-1"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4060DD
		test	eax, eax
		jz	short loc_40763C
		mov	dword ptr [esp+4], offset a646 ; "646"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4060DD
		test	eax, eax
		jz	short loc_40763C
		mov	dword ptr [esp+4], offset aAscii ; "ASCII"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4060DD
		test	eax, eax
		jz	short loc_40763C
		mov	dword ptr [esp+4], offset aAnsi_x3_41968 ; "ANSI_X3.4-1968"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4060DD
		test	eax, eax
		jnz	short loc_40765F

loc_40763C:				; CODE XREF: .text:004075DEj
					; .text:004075F5j ...
		mov	off_40D004, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_4104C0, 0
		mov	ds:dword_4104C4, 0
		jmp	loc_40775E
; ---------------------------------------------------------------------------

loc_40765F:				; CODE XREF: .text:0040763Aj
		mov	dword ptr [esp+4], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4060DD
		test	eax, eax
		jz	short loc_40768D
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4060DD
		test	eax, eax
		jnz	short loc_4076B0

loc_40768D:				; CODE XREF: .text:00407674j
		mov	off_40D004, offset aUtf8 ; "utf-8"
		mov	ds:dword_4104C0, 1
		mov	ds:dword_4104C4, 0
		jmp	loc_40775E
; ---------------------------------------------------------------------------

loc_4076B0:				; CODE XREF: .text:0040768Bj
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	libiconv_open
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_4076EE
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_407368
		mov	eax, 0FFFFFFFFh
		jmp	short loc_407763
; ---------------------------------------------------------------------------

loc_4076EE:				; CODE XREF: .text:004076CAj
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	libiconv_close
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	libiconv_open
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_407737
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	sub_407368
		mov	eax, 0FFFFFFFFh
		jmp	short loc_407763
; ---------------------------------------------------------------------------

loc_407737:				; CODE XREF: .text:00407713j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	libiconv_close
		mov	eax, [ebp-14h]
		mov	off_40D004, eax
		mov	ds:dword_4104C0, 0
		mov	ds:dword_4104C4, 1

loc_40775E:				; CODE XREF: .text:0040765Aj
					; .text:004076ABj
		mov	eax, 0

loc_407763:				; CODE XREF: .text:004076ECj
					; .text:00407735j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_40D004
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4104C0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40777D(char *)
sub_40777D	proc near		; CODE XREF: sub_40777D+129p

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_4104C0
		test	eax, eax
		jz	short loc_4077AF
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_404E27
		mov	[ebp+var_20], eax
		jmp	loc_4079BE
; ---------------------------------------------------------------------------

loc_4077AF:				; CODE XREF: sub_40777D+1Dj
		mov	eax, ds:dword_4104C4
		test	eax, eax
		jnz	loc_407865
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_4077DA
; ---------------------------------------------------------------------------

loc_4077C4:				; CODE XREF: sub_40777D+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4077D6
		add	[ebp+var_28], 1

loc_4077D6:				; CODE XREF: sub_40777D+53j
		add	[ebp+var_1C], 1

loc_4077DA:				; CODE XREF: sub_40777D+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4077C4
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_404D24
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_407850
; ---------------------------------------------------------------------------

loc_407803:				; CODE XREF: sub_40777D+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40783D
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_40784C
; ---------------------------------------------------------------------------

loc_40783D:				; CODE XREF: sub_40777D+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_40784C:				; CODE XREF: sub_40777D+BEj
		add	[ebp+var_1C], 1

loc_407850:				; CODE XREF: sub_40777D+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407803
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_4079BE
; ---------------------------------------------------------------------------

loc_407865:				; CODE XREF: sub_40777D+39j
		mov	eax, off_40D004
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_4078B0
		mov	eax, off_40D004
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_407368
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_40777D
		jmp	loc_4079C1
; ---------------------------------------------------------------------------

loc_4078B0:				; CODE XREF: sub_40777D+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_4078CE
; ---------------------------------------------------------------------------

loc_4078B8:				; CODE XREF: sub_40777D+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4078CA
		add	[ebp+var_28], 5

loc_4078CA:				; CODE XREF: sub_40777D+147j
		add	[ebp+var_1C], 1

loc_4078CE:				; CODE XREF: sub_40777D+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4078B8
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_404D24
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4079AD
		mov	eax, ds:dword_4104CC
		test	eax, eax
		jnz	short loc_40798F
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_40D004
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_409CD4
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_40717B

loc_40798F:				; CODE XREF: sub_40777D+1D3j
		mov	ds:dword_4104CC, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_4079B3
; ---------------------------------------------------------------------------

loc_4079AD:				; CODE XREF: sub_40777D+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_4079B3:				; CODE XREF: sub_40777D+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_4079BE:				; CODE XREF: sub_40777D+2Dj
					; sub_40777D+E3j
		mov	eax, [ebp+var_20]

loc_4079C1:				; CODE XREF: sub_40777D+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40777D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4079C9	proc near		; CODE XREF: sub_4079C9+797p
					; sub_40819B+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_4079ED:				; CODE XREF: sub_4079C9+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_407F8F
; ---------------------------------------------------------------------------

loc_407A12:				; CODE XREF: sub_4079C9+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_407A71
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_407A6A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_407A36
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_407A6A

loc_407A36:				; CODE XREF: sub_4079C9+61j
		cmp	[ebp+var_24], 0
		jz	short loc_407A61
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_407A61:				; CODE XREF: sub_4079C9+71j
		add	[ebp+var_1C], 4
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407A6A:				; CODE XREF: sub_4079C9+57j
					; sub_4079C9+6Bj
		mov	[ebp+var_30], 0

loc_407A71:				; CODE XREF: sub_4079C9+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_407DA4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_407BFC
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_407BDC
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_407ACD
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_407ACD
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_407ACD
		cmp	[ebp+arg_8], 0
		jz	loc_407BDC
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_407BDC

loc_407ACD:				; CODE XREF: sub_4079C9+D2j
					; sub_4079C9+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_407AE1
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_407AE1:				; CODE XREF: sub_4079C9+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_407B92	; jumptable 00407AFA default case
		mov	eax, ds:off_40EDD0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407AFC:				; CODE XREF: sub_4079C9+131j
					; DATA XREF: .rdata:off_40EDD0o
		add	[ebp+var_1C], 1	; jumptable 00407AFA case 10
		cmp	[ebp+var_24], 0
		jz	loc_407BC3
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_407BC3
; ---------------------------------------------------------------------------

loc_407B19:				; CODE XREF: sub_4079C9+131j
					; DATA XREF: .rdata:off_40EDD0o
		add	[ebp+var_1C], 1	; jumptable 00407AFA case 13
		cmp	[ebp+var_24], 0
		jz	loc_407BC6
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_407BC6
; ---------------------------------------------------------------------------

loc_407B36:				; CODE XREF: sub_4079C9+131j
					; DATA XREF: .rdata:off_40EDD0o
		add	[ebp+var_1C], 1	; jumptable 00407AFA case 12
		cmp	[ebp+var_24], 0
		jz	loc_407BC9
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_407BC9
; ---------------------------------------------------------------------------

loc_407B50:				; CODE XREF: sub_4079C9+131j
					; DATA XREF: .rdata:off_40EDD0o
		add	[ebp+var_1C], 1	; jumptable 00407AFA case 11
		cmp	[ebp+var_24], 0
		jz	short loc_407BCC
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_407BCC
; ---------------------------------------------------------------------------

loc_407B66:				; CODE XREF: sub_4079C9+131j
					; DATA XREF: .rdata:off_40EDD0o
		add	[ebp+var_1C], 1	; jumptable 00407AFA case 8
		cmp	[ebp+var_24], 0
		jz	short loc_407BCF
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_407BCF
; ---------------------------------------------------------------------------

loc_407B7C:				; CODE XREF: sub_4079C9+131j
					; DATA XREF: .rdata:off_40EDD0o
		add	[ebp+var_1C], 1	; jumptable 00407AFA case 0
		cmp	[ebp+var_24], 0
		jz	short loc_407BD2
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_407BD2
; ---------------------------------------------------------------------------

loc_407B92:				; CODE XREF: sub_4079C9+124j
					; sub_4079C9+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 00407AFA default case
		cmp	[ebp+var_24], 0
		jz	short loc_407BD5
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_407BD5
; ---------------------------------------------------------------------------

loc_407BC3:				; CODE XREF: sub_4079C9+13Bj
					; sub_4079C9+14Bj
		nop
		jmp	short loc_407BD6
; ---------------------------------------------------------------------------

loc_407BC6:				; CODE XREF: sub_4079C9+158j
					; sub_4079C9+168j
		nop
		jmp	short loc_407BD6
; ---------------------------------------------------------------------------

loc_407BC9:				; CODE XREF: sub_4079C9+175j
					; sub_4079C9+185j
		nop
		jmp	short loc_407BD6
; ---------------------------------------------------------------------------

loc_407BCC:				; CODE XREF: sub_4079C9+18Fj
					; sub_4079C9+19Bj
		nop
		jmp	short loc_407BD6
; ---------------------------------------------------------------------------

loc_407BCF:				; CODE XREF: sub_4079C9+1A5j
					; sub_4079C9+1B1j
		nop
		jmp	short loc_407BD6
; ---------------------------------------------------------------------------

loc_407BD2:				; CODE XREF: sub_4079C9+1BBj
					; sub_4079C9+1C7j
		nop
		jmp	short loc_407BD6
; ---------------------------------------------------------------------------

loc_407BD5:				; CODE XREF: sub_4079C9+1D1j
					; sub_4079C9+1F8j
		nop

loc_407BD6:				; CODE XREF: sub_4079C9+1FBj
					; sub_4079C9+1FEj ...
		nop
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407BDC:				; CODE XREF: sub_4079C9+C4j
					; sub_4079C9+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_407BF3
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_407BF3:				; CODE XREF: sub_4079C9+217j
		add	[ebp+var_1C], 1
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407BFC:				; CODE XREF: sub_4079C9+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_407C45
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407C45:				; CODE XREF: sub_4079C9+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_407C8E
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407C8E:				; CODE XREF: sub_4079C9+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_407CD7
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407CD7:				; CODE XREF: sub_4079C9+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_407D20
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407D20:				; CODE XREF: sub_4079C9+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_407D69
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407D69:				; CODE XREF: sub_4079C9+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_407D94
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_407D94:				; CODE XREF: sub_4079C9+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407DA4:				; CODE XREF: sub_4079C9+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_407DBC
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_407E4A

loc_407DBC:				; CODE XREF: sub_4079C9+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_407E24
		mov	[ebp+var_10], 0
		jmp	short loc_407DF7
; ---------------------------------------------------------------------------

loc_407DCB:				; CODE XREF: sub_4079C9+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_407DF7:				; CODE XREF: sub_4079C9+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_407DCB
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_407E24:				; CODE XREF: sub_4079C9+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407E4A:				; CODE XREF: sub_4079C9+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_407F87
		mov	eax, ds:dword_4104C0
		test	eax, eax
		jz	short loc_407EC7
		cmp	[ebp+var_24], 0
		jz	short loc_407EB5
		mov	[ebp+var_10], 0
		jmp	short loc_407EAD
; ---------------------------------------------------------------------------

loc_407E95:				; CODE XREF: sub_4079C9+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_407EAD:				; CODE XREF: sub_4079C9+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_407E95

loc_407EB5:				; CODE XREF: sub_4079C9+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_407F87
; ---------------------------------------------------------------------------

loc_407EC7:				; CODE XREF: sub_4079C9+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_407F0B
		cmp	[ebp+var_24], 0
		jz	short loc_407EFC
		mov	[ebp+var_10], 0
		jmp	short loc_407EF4
; ---------------------------------------------------------------------------

loc_407EDC:				; CODE XREF: sub_4079C9+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_407EF4:				; CODE XREF: sub_4079C9+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_407EDC

loc_407EFC:				; CODE XREF: sub_4079C9+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_407F87
; ---------------------------------------------------------------------------

loc_407F0B:				; CODE XREF: sub_4079C9+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_407F34
		cmp	[ebp+var_28], 0FFh
		ja	short loc_407F34
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_407F87
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_407F87
; ---------------------------------------------------------------------------

loc_407F34:				; CODE XREF: sub_4079C9+546j
					; sub_4079C9+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_407F77
		mov	[ebp+var_10], 0
		jmp	short loc_407F6F
; ---------------------------------------------------------------------------

loc_407F43:				; CODE XREF: sub_4079C9+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_407F6F:				; CODE XREF: sub_4079C9+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_407F43

loc_407F77:				; CODE XREF: sub_4079C9+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_407F87:				; CODE XREF: sub_4079C9+9Cj
					; sub_4079C9+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_407F8F:				; CODE XREF: sub_4079C9+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_407A12
		cmp	[ebp+var_20], 0
		jnz	short loc_407FBB
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_404D24
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_4079ED
; ---------------------------------------------------------------------------

loc_407FBB:				; CODE XREF: sub_4079C9+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_40818B
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_40D004
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_40802F
		mov	eax, off_40D004
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_407368
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404E81
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_40819B
		jmp	loc_408194
; ---------------------------------------------------------------------------

loc_40802F:				; CODE XREF: sub_4079C9+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_408093
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_407334
; ---------------------------------------------------------------------------

loc_408093:				; CODE XREF: sub_4079C9+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_404D24
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_40816A
		mov	eax, ds:dword_4104C8
		test	eax, eax
		jnz	short loc_40811D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_40D004
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_409CD4
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_40717B

loc_40811D:				; CODE XREF: sub_4079C9+715j
		mov	ds:dword_4104C8, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404E81
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404E81
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_4079C9
		mov	[ebp+var_34], eax
		jmp	short loc_40817B
; ---------------------------------------------------------------------------

loc_40816A:				; CODE XREF: sub_4079C9+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404E81

loc_40817B:				; CODE XREF: sub_4079C9+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_408194
; ---------------------------------------------------------------------------

loc_40818B:				; CODE XREF: sub_4079C9+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_408194:				; CODE XREF: sub_4079C9+661j
					; sub_4079C9+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4079C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40819B	proc near		; CODE XREF: sub_405C14+50p
					; sub_4079C9+65Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4104C4
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4079C9
		leave
		retn
sub_40819B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_open
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_close
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408224(char *)
sub_408224	proc near		; CODE XREF: .text:0040940Bp
					; .text:00409D48p

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408251
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408251
		mov	eax, [ebp+var_C]
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408251:				; CODE XREF: sub_408224+19j
					; sub_408224+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408277
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408277
		mov	eax, [ebp+var_C]
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408277:				; CODE XREF: sub_408224+3Fj
					; sub_408224+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40829E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40829E
		mov	eax, [ebp+var_C]
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40829E:				; CODE XREF: sub_408224+66j
					; sub_408224+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_408D64	; jumptable 004082E0 default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_40F384
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4082E2:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aAf_za ; jumptable 004082E0	case 54
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4082EC:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSq_al ; jumptable 004082E0	case 28
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4082F6:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aAm_et ; jumptable 004082E0	case 94
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408300:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		cmp	[ebp+var_1C], 10h ; jumptable 004082E0 case 1
		ja	loc_4083B9	; jumptable 00408317 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40F56C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_408319:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_sa ; jumptable 00408317	case 1
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408323:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_iq ; jumptable 00408317	case 2
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40832D:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_eg ; jumptable 00408317	case 3
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408337:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_ly ; jumptable 00408317	case 4
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408341:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_dz ; jumptable 00408317	case 5
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40834B:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_ma ; jumptable 00408317	case 6
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408355:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_tn ; jumptable 00408317	case 7
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40835F:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_om ; jumptable 00408317	case 8
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408369:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_ye ; jumptable 00408317	case 9
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408373:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_sy ; jumptable 00408317	case 10
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40837D:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_jo ; jumptable 00408317	case 11
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408387:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_lb ; jumptable 00408317	case 12
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408391:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_kw ; jumptable 00408317	case 13
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40839B:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_ae ; jumptable 00408317	case 14
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4083A5:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_bh ; jumptable 00408317	case 15
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4083AF:				; CODE XREF: sub_408224+F3j
					; DATA XREF: .rdata:off_40F56Co
		mov	eax, offset aAr_qa ; jumptable 00408317	case 16
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4083B9:				; CODE XREF: sub_408224+E0j
					; sub_408224+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 00408317 default case
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4083C3:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aHy_am ; jumptable 004082E0	case 43
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4083CD:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aAs_in ; jumptable 004082E0	case 77
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4083D7:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 44
		cmp	eax, 1
		jz	short loc_4083E6
		cmp	eax, 2
		jz	short loc_4083F0
		jmp	short loc_4083FA
; ---------------------------------------------------------------------------

loc_4083E6:				; CODE XREF: sub_408224+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4083F0:				; CODE XREF: sub_408224+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4083FA:				; CODE XREF: sub_408224+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408404:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aEu	; jumptable 004082E0 case 45
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40840E:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aBe_by ; jumptable 004082E0	case 35
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408418:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 69
		cmp	eax, 1
		jz	short loc_408427
		cmp	eax, 2
		jz	short loc_408431
		jmp	short loc_40843B
; ---------------------------------------------------------------------------

loc_408427:				; CODE XREF: sub_408224+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408431:				; CODE XREF: sub_408224+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40843B:				; CODE XREF: sub_408224+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408445:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aBg_bg ; jumptable 004082E0	case 2
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40844F:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aMy_mm ; jumptable 004082E0	case 85
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408459:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aKm_kh ; jumptable 004082E0	case 83
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408463:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aCa_es ; jumptable 004082E0	case 3
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40846D:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aChr_us ; jumptable	004082E0 case 92
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408477:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		cmp	[ebp+var_1C], 5	; jumptable 004082E0 case 4
		ja	short loc_4084BE ; jumptable 0040848A default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40F5B0
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40848C:				; CODE XREF: sub_408224+266j
					; DATA XREF: .rdata:off_40F5B0o
		mov	eax, offset aZh_tw ; jumptable 0040848A	case 1
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408496:				; CODE XREF: sub_408224+266j
					; DATA XREF: .rdata:off_40F5B0o
		mov	eax, offset aZh_cn ; jumptable 0040848A	case 2
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4084A0:				; CODE XREF: sub_408224+266j
					; DATA XREF: .rdata:off_40F5B0o
		mov	eax, offset aZh_hk ; jumptable 0040848A	case 3
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4084AA:				; CODE XREF: sub_408224+266j
					; DATA XREF: .rdata:off_40F5B0o
		mov	eax, offset aZh_sg ; jumptable 0040848A	case 4
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4084B4:				; CODE XREF: sub_408224+266j
					; DATA XREF: .rdata:off_40F5B0o
		mov	eax, offset aZh_mo ; jumptable 0040848A	case 5
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4084BE:				; CODE XREF: sub_408224+257j
					; sub_408224+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 0040848A default case
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4084C8:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 26
		cmp	eax, 2
		jz	short loc_4084E4
		cmp	eax, 3
		jz	short loc_4084EE
		cmp	eax, 1
		jnz	short loc_4084F8
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4084E4:				; CODE XREF: sub_408224+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4084EE:				; CODE XREF: sub_408224+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4084F8:				; CODE XREF: sub_408224+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408502:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aCs_cz ; jumptable 004082E0	case 5
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40850C:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aDa_dk ; jumptable 004082E0	case 6
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408516:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aDiv_mv ; jumptable	004082E0 case 101
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408520:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 19
		cmp	eax, 1
		jz	short loc_40852F
		cmp	eax, 2
		jz	short loc_408539
		jmp	short loc_408543
; ---------------------------------------------------------------------------

loc_40852F:				; CODE XREF: sub_408224+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408539:				; CODE XREF: sub_408224+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408543:				; CODE XREF: sub_408224+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40854D:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aBin_ng ; jumptable	004082E0 case 102
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408557:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		cmp	[ebp+var_1C], 12h ; jumptable 004082E0 case 9
		ja	loc_408624	; jumptable 0040856E default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40F5C8
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_408570:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_us ; jumptable 0040856E	case 1
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40857A:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_gb ; jumptable 0040856E	case 2
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408584:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_au ; jumptable 0040856E	case 3
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40858E:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_ca ; jumptable 0040856E	case 4
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408598:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_nz ; jumptable 0040856E	case 5
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085A2:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_ie ; jumptable 0040856E	case 6
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085AC:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_za ; jumptable 0040856E	case 7
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085B6:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_jm ; jumptable 0040856E	case 8
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085C0:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_gd ; jumptable 0040856E	case 9
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085CA:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_bz ; jumptable 0040856E	case 10
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085D4:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_tt ; jumptable 0040856E	case 11
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085DE:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_zw ; jumptable 0040856E	case 12
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085E8:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_ph ; jumptable 0040856E	case 13
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085F2:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_id ; jumptable 0040856E	case 14
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4085FC:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_hk ; jumptable 0040856E	case 15
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408606:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_in ; jumptable 0040856E	case 16
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408610:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_my ; jumptable 0040856E	case 17
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40861A:				; CODE XREF: sub_408224+34Aj
					; DATA XREF: .rdata:off_40F5C8o
		mov	eax, offset aEn_sg ; jumptable 0040856E	case 18
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408624:				; CODE XREF: sub_408224+337j
					; sub_408224+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn	; jumptable 0040856E default case
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40862E:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aEt_ee ; jumptable 004082E0	case 37
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408638:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aFo_fo ; jumptable 004082E0	case 56
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408642:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aFa_ir ; jumptable 004082E0	case 41
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40864C:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aFi_fi ; jumptable 004082E0	case 11
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408656:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		cmp	[ebp+var_1C], 0Fh ; jumptable 004082E0 case 12
		ja	loc_408705	; jumptable 0040866D default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40F614
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40866F:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_fr ; jumptable 0040866D	case 1
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408679:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_be ; jumptable 0040866D	case 2
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408683:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_ca ; jumptable 0040866D	case 3
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40868D:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_ch ; jumptable 0040866D	case 4
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408697:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_lu ; jumptable 0040866D	case 5
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086A1:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_mc ; jumptable 0040866D	case 6
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086AB:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr	; jumptable 0040866D case 7
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086B5:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_re ; jumptable 0040866D	case 8
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086BF:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_cg ; jumptable 0040866D	case 9
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086C9:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_sn ; jumptable 0040866D	case 10
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086D3:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_cm ; jumptable 0040866D	case 11
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086DD:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_ci ; jumptable 0040866D	case 12
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086E7:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_ml ; jumptable 0040866D	case 13
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086F1:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_ma ; jumptable 0040866D	case 14
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4086FB:				; CODE XREF: sub_408224+449j
					; DATA XREF: .rdata:off_40F614o
		mov	eax, offset aFr_ht ; jumptable 0040866D	case 15
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408705:				; CODE XREF: sub_408224+436j
					; sub_408224+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 0040866D default case
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40870F:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aFy_nl ; jumptable 004082E0	case 98
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408719:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aFul_ng ; jumptable	004082E0 case 103
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408723:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 60
		cmp	eax, 1
		jz	short loc_408732
		cmp	eax, 2
		jz	short loc_40873C
		jmp	short loc_408746
; ---------------------------------------------------------------------------

loc_408732:				; CODE XREF: sub_408224+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40873C:				; CODE XREF: sub_408224+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408746:				; CODE XREF: sub_408224+50Cj
		mov	eax, offset aC	; "C"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408750:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aGl_es ; jumptable 004082E0	case 86
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40875A:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aKa_ge ; jumptable 004082E0	case 55
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408764:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		cmp	[ebp+var_1C], 5	; jumptable 004082E0 case 7
		ja	short loc_4087AB ; jumptable 00408777 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40F654
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_408779:				; CODE XREF: sub_408224+553j
					; DATA XREF: .rdata:off_40F654o
		mov	eax, offset aDe_de ; jumptable 00408777	case 1
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408783:				; CODE XREF: sub_408224+553j
					; DATA XREF: .rdata:off_40F654o
		mov	eax, offset aDe_ch ; jumptable 00408777	case 2
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40878D:				; CODE XREF: sub_408224+553j
					; DATA XREF: .rdata:off_40F654o
		mov	eax, offset aDe_at ; jumptable 00408777	case 3
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408797:				; CODE XREF: sub_408224+553j
					; DATA XREF: .rdata:off_40F654o
		mov	eax, offset aDe_lu ; jumptable 00408777	case 4
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087A1:				; CODE XREF: sub_408224+553j
					; DATA XREF: .rdata:off_40F654o
		mov	eax, offset aDe_li ; jumptable 00408777	case 5
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087AB:				; CODE XREF: sub_408224+544j
					; sub_408224+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 00408777 default case
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087B5:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aEl_gr ; jumptable 004082E0	case 8
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087BF:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aGn_py ; jumptable 004082E0	case 116
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087C9:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aGu_in ; jumptable 004082E0	case 71
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087D3:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aHa_ng ; jumptable 004082E0	case 104
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087DD:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aCpe_us ; jumptable	004082E0 case 117
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087E7:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aHe_il ; jumptable 004082E0	case 13
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087F1:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aHi_in ; jumptable 004082E0	case 57
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4087FB:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aHu_hu ; jumptable 004082E0	case 14
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408805:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aNic_ng ; jumptable	004082E0 case 105
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40880F:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aIs_is ; jumptable 004082E0	case 15
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408819:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aIbo_ng ; jumptable	004082E0 case 112
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408823:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aId_id ; jumptable 004082E0	case 33
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40882D:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aIu_ca ; jumptable 004082E0	case 93
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408837:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 16
		cmp	eax, 1
		jz	short loc_408846
		cmp	eax, 2
		jz	short loc_408850
		jmp	short loc_40885A
; ---------------------------------------------------------------------------

loc_408846:				; CODE XREF: sub_408224+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408850:				; CODE XREF: sub_408224+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40885A:				; CODE XREF: sub_408224+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408864:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aJa_jp ; jumptable 004082E0	case 17
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40886E:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aKn_in ; jumptable 004082E0	case 75
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408878:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aKau_ng ; jumptable	004082E0 case 113
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408882:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 96
		cmp	eax, 1
		jz	short loc_408891
		cmp	eax, 2
		jz	short loc_40889B
		jmp	short loc_4088A5
; ---------------------------------------------------------------------------

loc_408891:				; CODE XREF: sub_408224+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40889B:				; CODE XREF: sub_408224+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088A5:				; CODE XREF: sub_408224+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088AF:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aKk_kz ; jumptable 004082E0	case 63
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088B9:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aKok_in ; jumptable	004082E0 case 87
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088C3:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aKo_kr ; jumptable 004082E0	case 18
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088CD:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aKy_kg ; jumptable 004082E0	case 64
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088D7:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aLo_la ; jumptable 004082E0	case 84
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088E1:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aLa_va ; jumptable 004082E0	case 118
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088EB:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aLv_lv ; jumptable 004082E0	case 38
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088F5:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aLt_lt ; jumptable 004082E0	case 39
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4088FF:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aMk_mk ; jumptable 004082E0	case 47
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408909:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 62
		cmp	eax, 1
		jz	short loc_408918
		cmp	eax, 2
		jz	short loc_408922
		jmp	short loc_40892C
; ---------------------------------------------------------------------------

loc_408918:				; CODE XREF: sub_408224+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408922:				; CODE XREF: sub_408224+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40892C:				; CODE XREF: sub_408224+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408936:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aMl_in ; jumptable 004082E0	case 76
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408940:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aMt_mt ; jumptable 004082E0	case 58
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40894A:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aMni_in ; jumptable	004082E0 case 88
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408954:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aMr_in ; jumptable 004082E0	case 78
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40895E:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aMn	; jumptable 004082E0 case 80
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408968:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 97
		cmp	eax, 1
		jz	short loc_408977
		cmp	eax, 2
		jz	short loc_408981
		jmp	short loc_40898B
; ---------------------------------------------------------------------------

loc_408977:				; CODE XREF: sub_408224+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408981:				; CODE XREF: sub_408224+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_40898B:				; CODE XREF: sub_408224+751j
		mov	eax, offset aNe	; "ne"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408995:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 20
		cmp	eax, 1
		jz	short loc_4089A4
		cmp	eax, 2
		jz	short loc_4089AE
		jmp	short loc_4089B8
; ---------------------------------------------------------------------------

loc_4089A4:				; CODE XREF: sub_408224+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4089AE:				; CODE XREF: sub_408224+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4089B8:				; CODE XREF: sub_408224+77Ej
		mov	eax, offset aNo_1 ; "no"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4089C2:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aOr_in ; jumptable 004082E0	case 72
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4089CC:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aOm_et ; jumptable 004082E0	case 114
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4089D6:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aPap_an ; jumptable	004082E0 case 121
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4089E0:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aPs	; jumptable 004082E0 case 99
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4089EA:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aPl_pl ; jumptable 004082E0	case 21
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_4089F4:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 22
		cmp	eax, 1
		jz	short loc_408A0B
		cmp	eax, 2
		jnz	short loc_408A15
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A0B:				; CODE XREF: sub_408224+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A15:				; CODE XREF: sub_408224+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A1F:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 70
		cmp	eax, 1
		jnz	short loc_408A31
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A31:				; CODE XREF: sub_408224+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A3B:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aRm_ch ; jumptable 004082E0	case 23
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A45:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 24
		cmp	eax, 1
		jnz	short loc_408A57
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A57:				; CODE XREF: sub_408224+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A61:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aRu	; jumptable 004082E0 case 25
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A6B:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSe_no ; jumptable 004082E0	case 59
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A75:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSa_in ; jumptable 004082E0	case 79
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A7F:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 89
		test	eax, eax
		jz	short loc_408A8D
		cmp	eax, 1
		jz	short loc_408A97
		jmp	short loc_408AA1
; ---------------------------------------------------------------------------

loc_408A8D:				; CODE XREF: sub_408224+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408A97:				; CODE XREF: sub_408224+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408AA1:				; CODE XREF: sub_408224+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408AAB:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSi_lk ; jumptable 004082E0	case 91
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408AB5:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSk_sk ; jumptable 004082E0	case 27
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408ABF:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSl_si ; jumptable 004082E0	case 36
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408AC9:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSo_so ; jumptable 004082E0	case 119
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408AD3:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aWen_de ; jumptable	004082E0 case 46
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408ADD:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		cmp	[ebp+var_1C], 14h ; jumptable 004082E0 case 10
		ja	loc_408BBE	; jumptable 00408AF4 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40F66C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_408AF6:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_es ; jumptable 00408AF4	case 1
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B00:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_mx ; jumptable 00408AF4	case 2
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B0A:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_es@modern ; jumptable 00408AF4 case 3
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B14:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_gt ; jumptable 00408AF4	case 4
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B1E:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_cr ; jumptable 00408AF4	case 5
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B28:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_pa ; jumptable 00408AF4	case 6
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B32:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_do ; jumptable 00408AF4	case 7
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B3C:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_ve ; jumptable 00408AF4	case 8
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B46:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_co ; jumptable 00408AF4	case 9
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B50:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_pe ; jumptable 00408AF4	case 10
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B5A:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_ar ; jumptable 00408AF4	case 11
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B64:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_ec ; jumptable 00408AF4	case 12
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B6E:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_cl ; jumptable 00408AF4	case 13
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B78:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_uy ; jumptable 00408AF4	case 14
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B82:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_py ; jumptable 00408AF4	case 15
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B8C:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_bo ; jumptable 00408AF4	case 16
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408B96:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_sv ; jumptable 00408AF4	case 17
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408BA0:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_hn ; jumptable 00408AF4	case 18
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408BAA:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_ni ; jumptable 00408AF4	case 19
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408BB4:				; CODE XREF: sub_408224+8D0j
					; DATA XREF: .rdata:off_40F66Co
		mov	eax, offset aEs_pr ; jumptable 00408AF4	case 20
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408BBE:				; CODE XREF: sub_408224+8BDj
					; sub_408224+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 00408AF4 default case
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408BC8:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aBnt_tz ; jumptable	004082E0 case 48
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408BD2:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSw_ke ; jumptable 004082E0	case 65
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408BDC:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 29
		cmp	eax, 1
		jz	short loc_408BEB
		cmp	eax, 2
		jz	short loc_408BF5
		jmp	short loc_408BFF
; ---------------------------------------------------------------------------

loc_408BEB:				; CODE XREF: sub_408224+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408BF5:				; CODE XREF: sub_408224+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408BFF:				; CODE XREF: sub_408224+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C09:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSyr_tr ; jumptable	004082E0 case 90
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C13:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTl_ph ; jumptable 004082E0	case 100
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C1D:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTg_tj ; jumptable 004082E0	case 40
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C27:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 95
		cmp	eax, 1
		jz	short loc_408C36
		cmp	eax, 2
		jz	short loc_408C40
		jmp	short loc_408C4A
; ---------------------------------------------------------------------------

loc_408C36:				; CODE XREF: sub_408224+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C40:				; CODE XREF: sub_408224+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C4A:				; CODE XREF: sub_408224+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C54:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTa	; jumptable 004082E0 case 73
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C5E:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTt_ru ; jumptable 004082E0	case 68
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C68:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTe_in ; jumptable 004082E0	case 74
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C72:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTh_th ; jumptable 004082E0	case 30
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C7C:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aBo_cn ; jumptable 004082E0	case 81
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C86:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 115
		test	eax, eax
		jz	short loc_408C94
		cmp	eax, 1
		jz	short loc_408C9E
		jmp	short loc_408CA8
; ---------------------------------------------------------------------------

loc_408C94:				; CODE XREF: sub_408224+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408C9E:				; CODE XREF: sub_408224+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408CA8:				; CODE XREF: sub_408224+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408CB2:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTs_za ; jumptable 004082E0	case 49
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408CBC:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTn_bw ; jumptable 004082E0	case 50
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408CC6:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTr_tr ; jumptable 004082E0	case 31
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408CD0:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aTk_tm ; jumptable 004082E0	case 66
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408CDA:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aUk_ua ; jumptable 004082E0	case 34
		jmp	locret_408D69
; ---------------------------------------------------------------------------

loc_408CE4:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 32
		cmp	eax, 1
		jz	short loc_408CF3
		cmp	eax, 2
		jz	short loc_408CFA
		jmp	short loc_408D01
; ---------------------------------------------------------------------------

loc_408CF3:				; CODE XREF: sub_408224+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408CFA:				; CODE XREF: sub_408224+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D01:				; CODE XREF: sub_408224+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D08:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, [ebp+var_1C] ; jumptable 004082E0 case 67
		cmp	eax, 1
		jz	short loc_408D17
		cmp	eax, 2
		jz	short loc_408D1E
		jmp	short loc_408D25
; ---------------------------------------------------------------------------

loc_408D17:				; CODE XREF: sub_408224+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D1E:				; CODE XREF: sub_408224+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D25:				; CODE XREF: sub_408224+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D2C:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aVen_za ; jumptable	004082E0 case 51
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D33:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aVi_vn ; jumptable 004082E0	case 42
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D3A:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aCy_gb ; jumptable 004082E0	case 82
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D41:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aXh_za ; jumptable 004082E0	case 52
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D48:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aSit_cn ; jumptable	004082E0 case 120
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D4F:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aYi_il ; jumptable 004082E0	case 61
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D56:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aYo_ng ; jumptable 004082E0	case 106
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D5D:				; CODE XREF: sub_408224+BCj
					; DATA XREF: .rdata:off_40F384o
		mov	eax, offset aZu_za ; jumptable 004082E0	case 53
		jmp	short locret_408D69
; ---------------------------------------------------------------------------

loc_408D64:				; CODE XREF: sub_408224+A9j
					; sub_408224+BCj
					; DATA XREF: ...
		mov	eax, offset aC	; jumptable 004082E0 default case

locret_408D69:				; CODE XREF: sub_408224+28j
					; sub_408224+4Ej ...
		leave
		retn
sub_408224	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D6B	proc near		; CODE XREF: sub_408E4A+1EAp
					; sub_408E4A+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_408D6B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D9A	proc near		; CODE XREF: sub_409A19+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_408DE3
; ---------------------------------------------------------------------------

loc_408DAF:				; CODE XREF: sub_408D9A+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408DE3
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_408DE3:				; CODE XREF: sub_408D9A+13j
					; sub_408D9A+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408DAF
		mov	eax, [ebp+var_4]
		leave
		retn
sub_408D9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408DF2(void *)
sub_408DF2	proc near		; CODE XREF: .text:00409631p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E81
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E81
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_408E37
; ---------------------------------------------------------------------------

loc_408E1E:				; CODE XREF: sub_408DF2+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E81
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_408E37:				; CODE XREF: sub_408DF2+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_408E1E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E81
		leave
		retn
sub_408DF2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408E4A(char *)
sub_408E4A	proc near		; CODE XREF: .text:00409602p

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset aRb	; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_408E87
		mov	eax, 0
		jmp	loc_40917E
; ---------------------------------------------------------------------------

loc_408E87:				; CODE XREF: sub_408E4A+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_408ED0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_408ED0
		cmp	[ebp+var_20], 1Bh
		ja	short loc_408EE5

loc_408ED0:				; CODE XREF: sub_408E4A+5Bj
					; sub_408E4A+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_40917E
; ---------------------------------------------------------------------------

loc_408EE5:				; CODE XREF: sub_408E4A+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_408EFE
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_404D11
		jmp	short loc_408F03
; ---------------------------------------------------------------------------

loc_408EFE:				; CODE XREF: sub_408E4A+A3j
		mov	eax, 0

loc_408F03:				; CODE XREF: sub_408E4A+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_408F21
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_40917E
; ---------------------------------------------------------------------------

loc_408F21:				; CODE XREF: sub_408E4A+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_408F2D:				; CODE XREF: sub_408E4A+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_408F79
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E81
		mov	eax, 0
		jmp	loc_40917E
; ---------------------------------------------------------------------------

loc_408F79:				; CODE XREF: sub_408E4A+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_408F2D
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_408FC3
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_408FC3
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E81
		mov	eax, 0
		jmp	loc_40917E
; ---------------------------------------------------------------------------

loc_408FC3:				; CODE XREF: sub_408E4A+156j
					; sub_408E4A+162j
		mov	[esp+68h+Mode],	28h ; size_t
		mov	[esp+68h+Filename], 1 ;	size_t
		call	sub_404DE2
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_408FF5
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E81
		mov	eax, 0
		jmp	loc_40917E
; ---------------------------------------------------------------------------

loc_408FF5:				; CODE XREF: sub_408E4A+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40903B
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_408D6B
		jmp	short loc_409041
; ---------------------------------------------------------------------------

loc_40903B:				; CODE XREF: sub_408E4A+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_409041:				; CODE XREF: sub_408E4A+1EFj
		test	eax, eax
		jnz	loc_409141
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_409063
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_408D6B
		jmp	short loc_409069
; ---------------------------------------------------------------------------

loc_409063:				; CODE XREF: sub_408E4A+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_409069:				; CODE XREF: sub_408E4A+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_409089
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_408D6B
		jmp	short loc_40908F
; ---------------------------------------------------------------------------

loc_409089:				; CODE XREF: sub_408E4A+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_40908F:				; CODE XREF: sub_408E4A+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4090B4
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_408D6B
		jmp	short loc_4090BA
; ---------------------------------------------------------------------------

loc_4090B4:				; CODE XREF: sub_408E4A+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_4090BA:				; CODE XREF: sub_408E4A+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4090DF
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_408D6B
		jmp	short loc_4090E5
; ---------------------------------------------------------------------------

loc_4090DF:				; CODE XREF: sub_408E4A+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_4090E5:				; CODE XREF: sub_408E4A+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_409105
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_408D6B
		jmp	short loc_40910B
; ---------------------------------------------------------------------------

loc_409105:				; CODE XREF: sub_408E4A+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_40910B:				; CODE XREF: sub_408E4A+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4 ; size_t
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_404DE2
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40917B
		jmp	short loc_40915E
; ---------------------------------------------------------------------------

loc_409141:				; CODE XREF: sub_408E4A+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E81
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E81
		mov	eax, 0
		jmp	short loc_40917E
; ---------------------------------------------------------------------------

loc_40915E:				; CODE XREF: sub_408E4A+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E81
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E81
		mov	eax, 0
		jmp	short loc_40917E
; ---------------------------------------------------------------------------

loc_40917B:				; CODE XREF: sub_408E4A+2F3j
		mov	eax, [ebp+var_18]

loc_40917E:				; CODE XREF: sub_408E4A+38j
					; sub_408E4A+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_408E4A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409185(LPCSTR, int, int)
sub_409185	proc near		; CODE XREF: sub_40937C+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_4091D5
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_4091DF

loc_4091D5:				; CODE XREF: sub_409185+44j
		mov	eax, 0
		jmp	locret_409285
; ---------------------------------------------------------------------------

loc_4091DF:				; CODE XREF: sub_409185+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_40920F
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_409285
; ---------------------------------------------------------------------------

loc_40920F:				; CODE XREF: sub_409185+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_404D11
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40922A
		mov	eax, 0
		jmp	short locret_409285
; ---------------------------------------------------------------------------

loc_40922A:				; CODE XREF: sub_409185+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40927A
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_404E81
		mov	eax, 0
		jmp	short locret_409285
; ---------------------------------------------------------------------------

loc_40927A:				; CODE XREF: sub_409185+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_409285:				; CODE XREF: sub_409185+55j
					; sub_409185+88j ...
		leave
		retn
sub_409185	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409287(LPCWSTR, int, int)
sub_409287	proc near		; CODE XREF: sub_40937C+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_4092E7
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_4092F1

loc_4092E7:				; CODE XREF: sub_409287+54j
		mov	eax, 0
		jmp	locret_40937A
; ---------------------------------------------------------------------------

loc_4092F1:				; CODE XREF: sub_409287+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_404D11
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40930F
		mov	eax, 0
		jmp	short locret_40937A
; ---------------------------------------------------------------------------

loc_40930F:				; CODE XREF: sub_409287+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40936F
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_404E81
		mov	eax, 0
		jmp	short locret_40937A
; ---------------------------------------------------------------------------

loc_40936F:				; CODE XREF: sub_409287+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_40937A:				; CODE XREF: sub_409287+65j
					; sub_409287+86j ...
		leave
		retn
sub_409287	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40937C(LPCSTR, int, int)
sub_40937C	proc near		; CODE XREF: sub_4096AE+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_409185
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4093CD
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_409287
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E81
		jmp	short loc_4093D4
; ---------------------------------------------------------------------------

loc_4093CD:				; CODE XREF: sub_40937C+26j
		mov	[ebp+var_C], 0

loc_4093D4:				; CODE XREF: sub_40937C+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_4093DF
		mov	eax, [ebp+var_14]
		jmp	short loc_4093E4
; ---------------------------------------------------------------------------

loc_4093DF:				; CODE XREF: sub_40937C+5Cj
		mov	eax, 0

loc_4093E4:				; CODE XREF: sub_40937C+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40937C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_408224
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_409480
		mov	eax, [ebp-14h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp], eax
		call	sub_404D11
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_409480
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strcpy
		mov	dword ptr [esp+4], 5Fh
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strchr
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_409480
		mov	eax, [ebp-18h]
		mov	byte ptr [eax],	0

loc_409480:				; CODE XREF: .text:00409417j
					; .text:0040944Aj ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_409490
		mov	eax, 0
		jmp	loc_409641
; ---------------------------------------------------------------------------

loc_409490:				; CODE XREF: .text:00409484j
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_404D11
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_409520
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_404E81
		mov	eax, 0
		jmp	loc_409641
; ---------------------------------------------------------------------------

loc_409520:				; CODE XREF: .text:00409509j
		mov	eax, [ebp-20h]
		mov	[ebp-24h], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	eax, [ebp-24h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-24h], 1
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	edx, offset aLc_messages_0 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp-24h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	dword ptr [ebp-24h], 0Dh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp-24h]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_408E4A
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_404E81
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_404E81
		mov	eax, ds:dword_4104FC
		test	eax, eax
		jz	short loc_409636
		mov	eax, ds:dword_4104FC
		mov	[esp], eax
		call	sub_408DF2

loc_409636:				; CODE XREF: .text:00409627j
		mov	eax, [ebp-10h]
		mov	ds:dword_4104FC, eax
		mov	eax, [ebp+0Ch]

loc_409641:				; CODE XREF: .text:0040948Bj
					; .text:0040951Bj
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409648(char *, int, int)
sub_409648	proc near		; CODE XREF: sub_4096AE+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_4096A3
; ---------------------------------------------------------------------------

loc_40965D:				; CODE XREF: sub_409648+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_40968A
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_4096AC
; ---------------------------------------------------------------------------

loc_40968A:				; CODE XREF: sub_409648+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_4096A3:				; CODE XREF: sub_409648+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_40965D
		mov	eax, [ebp+arg_0]

locret_4096AC:				; CODE XREF: sub_409648+40j
		leave
		retn
sub_409648	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4096AE	proc near		; CODE XREF: sub_409A19+158p
					; sub_409A19+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_410500
		test	eax, eax
		jz	short loc_40973A
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4096E8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_408D6B
		jmp	short loc_4096F9
; ---------------------------------------------------------------------------

loc_4096E8:				; CODE XREF: sub_4096AE+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_4096F9:				; CODE XREF: sub_4096AE+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_409722
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_408D6B
		jmp	short loc_409732
; ---------------------------------------------------------------------------

loc_409722:				; CODE XREF: sub_4096AE+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_409732:				; CODE XREF: sub_4096AE+72j
		mov	[ebp+var_14], eax
		jmp	loc_4099E9
; ---------------------------------------------------------------------------

loc_40973A:				; CODE XREF: sub_4096AE+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40992F
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40977C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_408D6B
		jmp	short loc_40978D
; ---------------------------------------------------------------------------

loc_40977C:				; CODE XREF: sub_4096AE+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40978D:				; CODE XREF: sub_4096AE+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4097B6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_408D6B
		jmp	short loc_4097C6
; ---------------------------------------------------------------------------

loc_4097B6:				; CODE XREF: sub_4096AE+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_4097C6:				; CODE XREF: sub_4096AE+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_40937C
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4097FE
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_40991F
; ---------------------------------------------------------------------------

loc_4097FE:				; CODE XREF: sub_4096AE+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_409890
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_409890
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40983D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_408D6B
		jmp	short loc_40984E
; ---------------------------------------------------------------------------

loc_40983D:				; CODE XREF: sub_4096AE+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40984E:				; CODE XREF: sub_4096AE+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_40991F
; ---------------------------------------------------------------------------

loc_409890:				; CODE XREF: sub_4096AE+156j
					; sub_4096AE+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_404D11
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409911
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_40991F
; ---------------------------------------------------------------------------

loc_409911:				; CODE XREF: sub_4096AE+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_40991F:				; CODE XREF: sub_4096AE+14Bj
					; sub_4096AE+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_404E81
		jmp	loc_4099E9
; ---------------------------------------------------------------------------

loc_40992F:				; CODE XREF: sub_4096AE+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_409995
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_409962
; ---------------------------------------------------------------------------

loc_40994F:				; CODE XREF: sub_4096AE+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_40996A
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_409962:				; CODE XREF: sub_4096AE+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_40994F
		jmp	short loc_40996B
; ---------------------------------------------------------------------------

loc_40996A:				; CODE XREF: sub_4096AE+2AAj
		nop

loc_40996B:				; CODE XREF: sub_4096AE+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_409985
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_4099E9
; ---------------------------------------------------------------------------

loc_409985:				; CODE XREF: sub_4096AE+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_4099E9
; ---------------------------------------------------------------------------

loc_409995:				; CODE XREF: sub_4096AE+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4099C0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_408D6B
		jmp	short loc_4099D1
; ---------------------------------------------------------------------------

loc_4099C0:				; CODE XREF: sub_4096AE+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_4099D1:				; CODE XREF: sub_4096AE+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_4099E9:				; CODE XREF: sub_4096AE+87j
					; sub_4096AE+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_409A10
		cmp	[ebp+var_14], 0
		jz	short loc_409A10
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_409648
		jmp	short loc_409A13
; ---------------------------------------------------------------------------

loc_409A10:				; CODE XREF: sub_4096AE+33Fj
					; sub_4096AE+345j
		mov	eax, [ebp+var_10]

loc_409A13:				; CODE XREF: sub_4096AE+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_4096AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409A19(char *, int, int)
sub_409A19	proc near		; CODE XREF: sub_409CD4+1Cp
					; .text:00409D13p ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_4104FC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_409CAB
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_409BE4
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_409BE4
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_408D9A
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_409BA3
; ---------------------------------------------------------------------------

loc_409AB3:				; CODE XREF: sub_409A19+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_409B7B
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_409AEA
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_408D6B
		jmp	short loc_409AFA
; ---------------------------------------------------------------------------

loc_409AEA:				; CODE XREF: sub_409A19+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_409AFA:				; CODE XREF: sub_409A19+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_409B7B
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_409B29
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_408D6B
		jmp	short loc_409B3A
; ---------------------------------------------------------------------------

loc_409B29:				; CODE XREF: sub_409A19+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_409B3A:				; CODE XREF: sub_409A19+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_409B7B
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_4096AE
		jmp	loc_409CC5
; ---------------------------------------------------------------------------

loc_409B7B:				; CODE XREF: sub_409A19+A7j
					; sub_409A19+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_409B9D
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_409BA3
; ---------------------------------------------------------------------------

loc_409B9D:				; CODE XREF: sub_409A19+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_409BA3:				; CODE XREF: sub_409A19+95j
					; sub_409A19+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_409BC7
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_408D6B
		jmp	short loc_409BD7
; ---------------------------------------------------------------------------

loc_409BC7:				; CODE XREF: sub_409A19+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_409BD7:				; CODE XREF: sub_409A19+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_409AB3

loc_409BE4:				; CODE XREF: sub_409A19+23j
					; sub_409A19+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_409C9D
; ---------------------------------------------------------------------------

loc_409BF9:				; CODE XREF: sub_409A19+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_409C30
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_408D6B
		jmp	short loc_409C41
; ---------------------------------------------------------------------------

loc_409C30:				; CODE XREF: sub_409A19+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_409C41:				; CODE XREF: sub_409A19+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_409C63
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_409C9D
; ---------------------------------------------------------------------------

loc_409C63:				; CODE XREF: sub_409A19+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_409C74
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_409C9D
; ---------------------------------------------------------------------------

loc_409C74:				; CODE XREF: sub_409A19+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_4096AE
		jmp	short loc_409CC5
; ---------------------------------------------------------------------------

loc_409C9D:				; CODE XREF: sub_409A19+1DBj
					; sub_409A19+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_409BF9
		jmp	short loc_409CAC
; ---------------------------------------------------------------------------

loc_409CAB:				; CODE XREF: sub_409A19+14j
		nop

loc_409CAC:				; CODE XREF: sub_409A19+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_409CC2
		cmp	[ebp+arg_8], 1
		jnz	short loc_409CBD
		mov	eax, [ebp+arg_0]
		jmp	short loc_409CC0
; ---------------------------------------------------------------------------

loc_409CBD:				; CODE XREF: sub_409A19+29Dj
		mov	eax, [ebp+arg_4]

loc_409CC0:				; CODE XREF: sub_409A19+2A2j
		jmp	short loc_409CC5
; ---------------------------------------------------------------------------

loc_409CC2:				; CODE XREF: sub_409A19+297j
		mov	eax, [ebp+arg_0]

loc_409CC5:				; CODE XREF: sub_409A19+15Dj
					; sub_409A19+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_409A19	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409CD4(char *)
sub_409CD4	proc near		; CODE XREF: sub_407368+78p
					; sub_407368+B8p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_409A19
		leave
		retn
sub_409CD4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_409A19
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409A19
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_408224
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_409D5B
		mov	eax, [ebp-0Ch]
		jmp	short locret_409D60
; ---------------------------------------------------------------------------

loc_409D5B:				; CODE XREF: .text:00409D54j
		mov	eax, offset byte_40F743

locret_409D60:				; CODE XREF: .text:00409D59j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_410500, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00412024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_409DB0
		cmp	eax, 3
		jz	short loc_409DB0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_409DB0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_40AFA0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_40F780o ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_409E24
		cmp	dword_40D018, 2
		jz	short loc_409E06
		mov	dword_40D018, 2

loc_409E06:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_409F13
		cmp	eax, 1
		jz	loc_409EB2

loc_409E18:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_409E24:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_4108D8, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_409F43
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_4108D4, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_4108D0, eax
		jz	loc_409F43
		mov	ecx, ds:dword_4108D4
		test	ecx, ecx
		jz	short loc_409ED3
		test	eax, eax
		jz	short loc_409ED3
		mov	dword_40D018, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_409EB2:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_40AFA0
		jmp	loc_409E18
; ---------------------------------------------------------------------------

loc_409ED3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_4108D0, 0
		mov	ds:dword_4108D4, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_409EF3:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_40D018, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_409F13:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_412030
		cmp	ebx, offset dword_412030
		jz	loc_409E18

loc_409F24:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_409F2C
		call	eax

loc_409F2C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_412030
		jnz	short loc_409F24
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_409F43:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_4108D0, 0
		mov	ds:dword_4108D4, 0
		jmp	short loc_409EF3
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409F70	proc near		; DATA XREF: .CRT:00412014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_409F70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409F80	proc near		; CODE XREF: sub_409FA0+10p
					; sub_409FA0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_409F80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409F90	proc near		; CODE XREF: sub_401060+59p
					; sub_409FA0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_409F90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_409FA0(_onexit_t)
sub_409FA0	proc near		; CODE XREF: sub_40A060+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_4108E0
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_409F80
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_40A040
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_4108E0
		mov	[esp+2Ch+Func],	eax
		call	sub_409F80
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_4108DC
		mov	[esp+2Ch+Func],	eax
		call	sub_409F80
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_409F90
		mov	ds:dword_4108E0, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_409F90
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_4108DC, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A040:				; CODE XREF: sub_409FA0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_409FA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40A060(_onexit_t)
sub_40A060	proc near		; CODE XREF: sub_40AC80-27p
					; sub_40C030+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_409FA0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_40A060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_40A0D7
		cmp	eax, 0C000008Dh
		jb	short loc_40A104

loc_40A09B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_40A0A0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_40A1D0
		test	eax, eax
		jz	short loc_40A0EC
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_40A0CF:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40A0D7:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_40A145
		cmp	eax, 0C0000096h
		jz	short loc_40A112
		cmp	eax, 0C0000093h
		jz	short loc_40A09B

loc_40A0EC:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_41052C
		test	eax, eax
		jz	loc_40A1C3
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_40A104:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_40A150
		cmp	eax, 0C000001Dh
		jnz	short loc_40A0EC

loc_40A112:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_40A187
		test	eax, eax
		jz	short loc_40A0EC
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40A145:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_40A0A0
; ---------------------------------------------------------------------------
		align 10h

loc_40A150:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_40A1A5
		test	eax, eax
		jz	loc_40A0EC
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40A187:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40A0CF
; ---------------------------------------------------------------------------

loc_40A1A5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40A0CF
; ---------------------------------------------------------------------------

loc_40A1C3:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_40A0CF
; ---------------------------------------------------------------------------
		align 10h

loc_40A1D0:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_40A0CF
		mov	[esp+2Ch+var_10], eax
		call	sub_40ABF0
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_40A0CF
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_410530
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_40A251
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_410530
		jmp	short loc_40A257
; ---------------------------------------------------------------------------

loc_40A251:				; CODE XREF: .text:0040A226j
		fstp	st
		fstp	st
		fstp	st

loc_40A257:				; CODE XREF: .text:0040A24Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A260	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_410530, eax
		jmp	__setusermatherr
sub_40A260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A270	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_40A28D
		mov	edx, ds:off_40F8A0[ecx*4]

loc_40A28D:				; CODE XREF: sub_40A270+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_40A270	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A2D0	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_40A2D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_40A2E0(char *Format, char ArgList)
sub_40A2E0	proc near		; CODE XREF: sub_40A340+1DDp
					; sub_40A340+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_40A2E0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_40A340
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_40A340(size_t Size)
sub_40A340	proc near		; CODE XREF: .text:0040A331j
					; sub_40A580+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_41053C
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_40A522
		mov	eax, ds:dword_410538
		xor	esi, esi

loc_40A364:				; CODE XREF: sub_40A340+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_40A379
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_40A450

loc_40A379:				; CODE XREF: sub_40A340+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_40A364

loc_40A383:				; CODE XREF: sub_40A340+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_40A940
		test	eax, eax
		mov	edi, eax
		jz	loc_40A549
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_410538
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_40AA20
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_410538
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_40A529
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_40A4D1

loc_40A3FF:				; CODE XREF: sub_40A340+194j
					; sub_40A340+1C6j
		add	ds:dword_41053C, 1

loc_40A406:				; CODE XREF: sub_40A340+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40A559
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_40A458

loc_40A42F:				; CODE XREF: sub_40A340+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_40A443:				; CODE XREF: sub_40A340+162j
					; sub_40A340+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A450:				; CODE XREF: sub_40A340+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_40A406
; ---------------------------------------------------------------------------

loc_40A458:				; CODE XREF: sub_40A340+EDj
		cmp	eax, 40h
		jz	short loc_40A42F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_40A443
		cmp	eax, 4
		jz	short loc_40A443
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40A4D1:				; CODE XREF: sub_40A340+B9j
		cmp	eax, 40h
		jz	loc_40A3FF
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_410538
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_40A3FF
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_40A2E0
; ---------------------------------------------------------------------------

loc_40A522:				; CODE XREF: sub_40A340+17j
		xor	esi, esi
		jmp	loc_40A383
; ---------------------------------------------------------------------------

loc_40A529:				; CODE XREF: sub_40A340+ACj
		mov	eax, ds:dword_410538
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_40A2E0
; ---------------------------------------------------------------------------

loc_40A549:				; CODE XREF: sub_40A340+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_40A2E0
; ---------------------------------------------------------------------------

loc_40A559:				; CODE XREF: sub_40A340+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_40A2E0
sub_40A340	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A580	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_410534
		test	eax, eax
		jz	short loc_40A5A0

loc_40A592:				; CODE XREF: sub_40A580+66j
					; sub_40A580+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A5A0:				; CODE XREF: sub_40A580+10j
		mov	ds:dword_410534, 1
		call	sub_40A980
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_40B040
		mov	ds:dword_41053C, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_410538, eax
		mov	eax, offset dword_40FB40
		sub	eax, offset dword_40FB40
		cmp	eax, 7
		jle	short loc_40A592
		cmp	eax, 0Bh
		mov	ebx, offset dword_40FB40
		jle	loc_40A6E0
		mov	eax, ds:dword_40FB40
		test	eax, eax
		jnz	short loc_40A610
		mov	eax, ds:dword_40FB44
		test	eax, eax
		jz	loc_40A6CC
		lea	esi, [esi+0]

loc_40A610:				; CODE XREF: sub_40A580+7Dj
					; sub_40A580+164j ...
		cmp	ebx, offset dword_40FB40
		jnb	loc_40A592
		mov	esi, 400000h

loc_40A621:				; CODE XREF: sub_40A580+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_40A340
		cmp	ebx, offset dword_40FB40
		jb	short loc_40A621

loc_40A645:				; CODE XREF: sub_40A580+24Bj
		mov	ecx, ds:dword_41053C
		test	ecx, ecx
		jle	loc_40A592
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_40A672
; ---------------------------------------------------------------------------
		align 10h

loc_40A660:				; CODE XREF: sub_40A580+FDj
					; sub_40A580+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_41053C
		jge	loc_40A592

loc_40A672:				; CODE XREF: sub_40A580+DDj
		mov	eax, ds:dword_410538
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_40A660
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40A7F2
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_410538
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_40A660
; ---------------------------------------------------------------------------

loc_40A6CC:				; CODE XREF: sub_40A580+86j
		mov	eax, ds:dword_40FB48
		test	eax, eax
		jnz	short loc_40A6F5
		mov	ebx, offset dword_40FB4C
		lea	esi, [esi+0]

loc_40A6E0:				; CODE XREF: sub_40A580+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_40A610
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_40A610

loc_40A6F5:				; CODE XREF: sub_40A580+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_40A815
		add	ebx, 0Ch
		cmp	ebx, offset dword_40FB40
		jnb	loc_40A592

loc_40A710:				; CODE XREF: sub_40A580+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_40A76A
		cmp	edx, 20h
		jz	short loc_40A7A0
		cmp	edx, 8
		jz	short loc_40A74A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_40A2E0
; ---------------------------------------------------------------------------

loc_40A74A:				; CODE XREF: sub_40A580+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_40A775
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_40A791
; ---------------------------------------------------------------------------

loc_40A76A:				; CODE XREF: sub_40A580+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_40A7D0

loc_40A775:				; CODE XREF: sub_40A580+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_40A7E3
		cmp	edx, 20h
		jz	short loc_40A7AF
		cmp	edx, 8
		jnz	short loc_40A7BC

loc_40A791:				; CODE XREF: sub_40A580+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_40A340
		jmp	short loc_40A7BC
; ---------------------------------------------------------------------------

loc_40A7A0:				; CODE XREF: sub_40A580+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_40A7AF:				; CODE XREF: sub_40A580+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_40A340

loc_40A7BC:				; CODE XREF: sub_40A580+20Fj
					; sub_40A580+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_40FB40
		jb	loc_40A710
		jmp	loc_40A645
; ---------------------------------------------------------------------------

loc_40A7D0:				; CODE XREF: sub_40A580+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_40A7E3:				; CODE XREF: sub_40A580+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_40A340
		jmp	short loc_40A7BC
; ---------------------------------------------------------------------------

loc_40A7F2:				; CODE XREF: sub_40A580+11Bj
		add	ebx, ds:dword_410538
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_40A2E0
; ---------------------------------------------------------------------------

loc_40A815:				; CODE XREF: sub_40A580+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_40A2E0
sub_40A580	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A830	proc near		; CODE XREF: .text:0040A8D1p
					; sub_40A940+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_40A840

locret_40A83D:				; CODE XREF: sub_40A830+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A840:				; CODE XREF: sub_40A830+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_40A83D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_40A830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A860	proc near		; CODE XREF: sub_40A940+2Bp
					; .text:0040AA84p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_40A89E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_40A884:				; CODE XREF: sub_40A860+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_40A892
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40A89E

loc_40A892:				; CODE XREF: sub_40A860+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_40A884
		xor	eax, eax

loc_40A89E:				; CODE XREF: sub_40A860+19j
					; sub_40A860+30j
		pop	ebx
		pop	esi
		retn
sub_40A860	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40A8B0
; ---------------------------------------------------------------------------
		align 10h

loc_40A8B0:				; CODE XREF: .text:0040A8A1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_40A923
		mov	dword ptr [esp], 400000h
		call	sub_40A830
		test	eax, eax
		jz	short loc_40A923
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_40A923
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_40A90B
; ---------------------------------------------------------------------------

loc_40A901:				; CODE XREF: .text:0040A921j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_40A930

loc_40A90B:				; CODE XREF: .text:0040A8FFj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_40A901

loc_40A923:				; CODE XREF: .text:0040A8C8j
					; .text:0040A8D8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A930:				; CODE XREF: .text:0040A909j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A940	proc near		; CODE XREF: sub_40A340+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_40A830
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_40A970
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_40A860

loc_40A970:				; CODE XREF: sub_40A940+15j
		add	esp, 8
		retn
sub_40A940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A980	proc near		; CODE XREF: sub_40A580+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_40A830
		xor	edx, edx
		test	eax, eax
		jz	short loc_40A9A1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_40A9A1:				; CODE XREF: sub_40A980+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_40A980	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_40A830
		xor	edx, edx
		test	eax, eax
		jz	short loc_40AA09
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_40AA09
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_40A9F0:				; CODE XREF: .text:0040AA05j
		test	byte ptr [edx+27h], 20h
		jz	short loc_40A9FD
		test	ebx, ebx
		jz	short loc_40AA09
		sub	ebx, 1

loc_40A9FD:				; CODE XREF: .text:0040A9F4j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_40A9F0
		xor	edx, edx

loc_40AA09:				; CODE XREF: .text:0040A9C9j
					; .text:0040A9E5j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40AA20
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AA20	proc near		; CODE XREF: sub_40A340+70p
					; .text:0040AA11j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_40A830
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_40AA20	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40AA50
; ---------------------------------------------------------------------------
		align 10h

loc_40AA50:				; CODE XREF: .text:0040AA41j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_40A830
		test	eax, eax
		jnz	short loc_40AA70

loc_40AA66:				; CODE XREF: .text:0040AA8Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40AA70:				; CODE XREF: .text:0040AA64j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_40A860
		test	eax, eax
		jz	short loc_40AA66
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AAA0	proc near		; CODE XREF: sub_40AB30+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_40A830
		test	eax, eax
		jz	short loc_40AB11
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_40AB11
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_40A860
		test	eax, eax
		jz	short loc_40AB11
		add	esi, 400000h
		jnz	short loc_40AAF6
		jmp	short loc_40AB11
; ---------------------------------------------------------------------------
		align 10h

loc_40AAF0:				; CODE XREF: sub_40AAA0+66j
		sub	ebx, 1
		add	esi, 14h

loc_40AAF6:				; CODE XREF: sub_40AAA0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_40AB04
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_40AB20

loc_40AB04:				; CODE XREF: sub_40AAA0+5Bj
		test	ebx, ebx
		jg	short loc_40AAF0
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_40AB11:				; CODE XREF: sub_40AAA0+1Aj
					; sub_40AAA0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40AB20:				; CODE XREF: sub_40AAA0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_40AAA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AB30	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_410540
		test	eax, eax
		jz	short loc_40AB42

loc_40AB3D:				; CODE XREF: sub_40AB30+97j
					; sub_40AB30+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40AB42:				; CODE XREF: sub_40AB30+Bj
		xor	eax, eax

loc_40AB44:				; CODE XREF: sub_40AB30+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_40AAA0
		test	eax, eax
		jz	short loc_40ABD0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_40AB60
		cmp	dl, 6Dh
		jnz	short loc_40ABB0

loc_40AB60:				; CODE XREF: sub_40AB30+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40AB6E
		cmp	dl, 73h
		jnz	short loc_40ABB0

loc_40AB6E:				; CODE XREF: sub_40AB30+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40AB7C
		cmp	dl, 76h
		jnz	short loc_40ABB0

loc_40AB7C:				; CODE XREF: sub_40AB30+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_40AB8A
		cmp	dl, 63h
		jnz	short loc_40ABB0

loc_40AB8A:				; CODE XREF: sub_40AB30+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_40AB98
		cmp	dl, 72h
		jnz	short loc_40ABB0

loc_40AB98:				; CODE XREF: sub_40AB30+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_40ABB4
		cmp	dl, 74h
		jz	short loc_40ABB4
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_40ABB4
		xchg	ax, ax

loc_40ABB0:				; CODE XREF: sub_40AB30+2Ej
					; sub_40AB30+3Cj ...
		mov	eax, ebx
		jmp	short loc_40AB44
; ---------------------------------------------------------------------------

loc_40ABB4:				; CODE XREF: sub_40AB30+6Fj
					; sub_40AB30+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_410540, eax
		jnz	loc_40AB3D
		lea	esi, [esi+0]

loc_40ABD0:				; CODE XREF: sub_40AB30+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_410540, eax
		jmp	loc_40AB3D
sub_40AB30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40ABF0	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_40ABF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40AC00()
sub_40AC00	proc near		; DATA XREF: sub_40AC80:loc_40AC52o
		sub	esp, 0Ch
		mov	eax, off_40D014
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40AC27
		xchg	ax, ax

loc_40AC10:				; CODE XREF: sub_40AC00+25j
		call	eax
		mov	eax, off_40D014
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_40D014, edx
		test	eax, eax
		jnz	short loc_40AC10

loc_40AC27:				; CODE XREF: sub_40AC00+Cj
		add	esp, 0Ch
		retn
sub_40AC00	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_40AC80

loc_40AC30:				; CODE XREF: sub_40AC80+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_40C050
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_40AC63

loc_40AC3F:				; CODE XREF: sub_40AC80-9j
		test	ebx, ebx
		jz	short loc_40AC52

loc_40AC43:				; CODE XREF: sub_40AC80-30j
		call	ds:dword_40C050[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_40AC43

loc_40AC52:				; CODE XREF: sub_40AC80-3Fj
		mov	[esp+1Ch+var_1C], offset sub_40AC00 ; _onexit_t
		call	sub_40A060
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40AC63:				; CODE XREF: sub_40AC80-43j
		xor	ebx, ebx
		jmp	short loc_40AC69
; ---------------------------------------------------------------------------

loc_40AC67:				; CODE XREF: sub_40AC80-Bj
		mov	ebx, eax

loc_40AC69:				; CODE XREF: sub_40AC80-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_40C050[eax*4]
		test	edx, edx
		jnz	short loc_40AC67
		jmp	short loc_40AC3F
; END OF FUNCTION CHUNK	FOR sub_40AC80
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AC80	proc near		; CODE XREF: sub_401180+239p
					; sub_402A9B+Fp

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 0040AC30 SIZE 00000049 BYTES

		mov	ecx, ds:dword_410544
		test	ecx, ecx
		jz	short loc_40AC90
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_40AC90:				; CODE XREF: sub_40AC80+8j
		mov	ds:dword_410544, 1
		jmp	short loc_40AC30
sub_40AC80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40ACA0	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_40D03C
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_40ACF0
		not	eax
		mov	dword_40D040, eax

loc_40ACD6:				; CODE XREF: sub_40ACA0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40ACF0:				; CODE XREF: sub_40ACA0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_40AD62

loc_40AD52:				; CODE XREF: sub_40ACA0+CCj
		mov	dword_40D03C, ebp
		mov	dword_40D040, eax
		jmp	loc_40ACD6
; ---------------------------------------------------------------------------

loc_40AD62:				; CODE XREF: sub_40ACA0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_40AD52
sub_40ACA0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_410624, edx
		mov	ds:dword_410840, 0C0000409h
		mov	ds:dword_410844, 1
		mov	ds:dword_410618, eax
		mov	ds:dword_41084C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_41060C, eax
		mov	eax, dword_40D03C
		mov	[ebp-10h], eax
		mov	eax, dword_40D040
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_40F9C8
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AE00	proc near		; CODE XREF: sub_40AFA0+79p
					; sub_40AFA0:loc_40B032p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_4108BC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_40AE55
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_40AE30:				; CODE XREF: sub_40AE00+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_40AE4E
		test	esi, esi
		jz	short loc_40AE4E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_40AE4E:				; CODE XREF: sub_40AE00+40j
					; sub_40AE00+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_40AE30

loc_40AE55:				; CODE XREF: sub_40AE00+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40AE00	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_4108A0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_40AE94

loc_40AE86:				; CODE XREF: .text:0040AEFCj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40AE94:				; CODE XREF: .text:0040AE84j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_40AEF7
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_4108BC
		mov	ds:dword_4108BC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40AEF7:				; CODE XREF: .text:0040AEACj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_40AE86
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_4108A0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_40AF18
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40AF18:				; CODE XREF: .text:0040AF0Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_4108BC
		sub	esp, 4
		test	edx, edx
		jz	short loc_40AF4F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_40AF48
		jmp	short loc_40AF86
; ---------------------------------------------------------------------------
		align 10h

loc_40AF40:				; CODE XREF: .text:0040AF4Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_40AF66
		mov	edx, eax

loc_40AF48:				; CODE XREF: .text:0040AF36j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_40AF40

loc_40AF4F:				; CODE XREF: .text:0040AF30j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_40AF5F:				; CODE XREF: .text:0040AF84j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40AF66:				; CODE XREF: .text:0040AF44j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_40AF6C:				; CODE XREF: .text:0040AF90j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_40AF5F
; ---------------------------------------------------------------------------

loc_40AF86:				; CODE XREF: .text:0040AF38j
		mov	eax, [edx+8]
		mov	ds:dword_4108BC, eax
		mov	eax, edx
		jmp	short loc_40AF6C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AFA0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_40AFF0
		jb	short loc_40AFC0
		cmp	eax, 3
		jz	short loc_40B010

loc_40AFB3:				; CODE XREF: sub_40AFA0+31j
					; sub_40AFA0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40AFC0:				; CODE XREF: sub_40AFA0+Cj
		mov	eax, ds:dword_4108A0
		test	eax, eax
		jnz	short loc_40B032

loc_40AFC9:				; CODE XREF: sub_40AFA0+97j
		mov	eax, ds:dword_4108A0
		cmp	eax, 1
		jnz	short loc_40AFB3
		mov	ds:dword_4108A0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_40AFB3
; ---------------------------------------------------------------------------
		align 10h

loc_40AFF0:				; CODE XREF: sub_40AFA0+Aj
		mov	eax, ds:dword_4108A0
		test	eax, eax
		jz	short loc_40B020

loc_40AFF9:				; CODE XREF: sub_40AFA0+90j
		mov	ds:dword_4108A0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40B010:				; CODE XREF: sub_40AFA0+11j
		mov	eax, ds:dword_4108A0
		test	eax, eax
		jz	short loc_40AFB3
		call	sub_40AE00
		jmp	short loc_40AFB3
; ---------------------------------------------------------------------------

loc_40B020:				; CODE XREF: sub_40AFA0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_40AFF9
; ---------------------------------------------------------------------------

loc_40B032:				; CODE XREF: sub_40AFA0+27j
		call	sub_40AE00
		jmp	short loc_40AFC9
sub_40AFA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40B040	proc near		; CODE XREF: sub_401180+19p
					; sub_40A580+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_40B062

loc_40B04D:				; CODE XREF: sub_40B040+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_40B04D

loc_40B062:				; CODE XREF: sub_40B040+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_40B040	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40B0B0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40B0B0	proc near		; CODE XREF: sub_401180+A7p
					; .text:0040B0A1j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_40B0B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40B0D0	proc near		; CODE XREF: sub_40B550+EDp
					; sub_40B550+2EFp

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4

		push	ebp
		push	edi
		mov	edi, eax
		push	esi
		mov	esi, ecx
		push	ebx
		sub	esp, 14h
		mov	[esp+24h+var_20], edx
		sub	edx, eax
		mov	eax, esi
		sub	eax, [esp+24h+var_20]
		mov	[esp+24h+var_18], edx
		mov	ecx, [esp+24h+arg_0]
		mov	[esp+24h+var_1C], eax
		mov	eax, edx
		sar	edx, 1Fh
		idiv	[esp+24h+var_1C]
		mov	eax, [esp+24h+var_1C]
		test	edx, edx
		mov	ebx, edx
		jnz	short loc_40B10C
		jmp	short loc_40B17D
; ---------------------------------------------------------------------------

loc_40B108:				; CODE XREF: sub_40B0D0+45j
		mov	eax, ebx
		mov	ebx, edx

loc_40B10C:				; CODE XREF: sub_40B0D0+34j
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	edx, edx
		jnz	short loc_40B108

loc_40B117:				; CODE XREF: sub_40B0D0+B1j
		mov	eax, esi
		sub	eax, edi
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	ebx, ebx
		mov	[esp+24h+var_24], eax
		jle	short loc_40B175
		mov	ebp, [esp+24h+var_20]
		add	ebx, ebp
		mov	[esp+24h+var_14], ebx

loc_40B133:				; CODE XREF: sub_40B0D0+A3j
		mov	eax, [esp+24h+var_24]
		test	eax, eax
		jle	short loc_40B16C
		mov	edi, [ecx+ebp*4]
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_40B145
; ---------------------------------------------------------------------------

loc_40B143:				; CODE XREF: sub_40B0D0+9Aj
		mov	edi, esi

loc_40B145:				; CODE XREF: sub_40B0D0+71j
		mov	esi, [esp+24h+var_1C]
		mov	ebx, eax
		sub	ebx, [esp+24h+var_18]
		add	esi, eax
		cmp	[esp+24h+var_20], eax
		mov	eax, ebx
		cmovg	eax, esi
		add	edx, 1
		lea	ebx, [ecx+eax*4]
		mov	esi, [ebx]
		cmp	edx, [esp+24h+var_24]
		mov	[ebx], edi
		mov	[ecx+ebp*4], esi
		jnz	short loc_40B143

loc_40B16C:				; CODE XREF: sub_40B0D0+68j
		add	ebp, 1
		cmp	ebp, [esp+24h+var_14]
		jnz	short loc_40B133

loc_40B175:				; CODE XREF: sub_40B0D0+57j
		add	esp, 14h
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40B17D:				; CODE XREF: sub_40B0D0+36j
		mov	ebx, [esp+24h+var_1C]
		jmp	short loc_40B117
sub_40B0D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40B190(char *, char)
sub_40B190	proc near		; CODE XREF: sub_40B200+152p
					; sub_40B200+1E8p ...

File		= dword	ptr -1Ch
Format		= dword	ptr -18h
ArgList		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:__argv
		mov	ebx, [esp+1Ch+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[esp+1Ch+Format], offset aS_0 ;	"%s: "
		mov	[esp+1Ch+ArgList], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fprintf
		test	ebx, ebx
		jz	short loc_40B1DD
		lea	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, ds:_iob
		mov	[esp+1Ch+Format], ebx ;	Format
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	vfprintf

loc_40B1DD:				; CODE XREF: sub_40B190+2Fj
		mov	eax, ds:_iob
		mov	[esp+1Ch+File],	0Ah ; Ch
		add	eax, 40h
		mov	[esp+1Ch+Format], eax ;	File
		call	fputc
		add	esp, 18h
		pop	ebx
		retn
sub_40B190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40B200	proc near		; CODE XREF: sub_40B550+220p
					; sub_40B550+5BBp

Str		= dword	ptr -5Ch
Val		= dword	ptr -58h
MaxCount	= dword	ptr -54h
var_44		= dword	ptr -44h
Str1		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	[esp+5Ch+var_24], edx
		mov	edx, off_40D038
		mov	[esp+5Ch+var_38], ecx
		mov	ecx, dword_40D024
		mov	[esp+5Ch+Val], 3Dh ; Val
		mov	[esp+5Ch+var_20], eax
		mov	[esp+5Ch+Str], edx ; Str
		mov	[esp+5Ch+var_2C], ecx
		add	ecx, 1
		mov	[esp+5Ch+Str1],	edx
		mov	[esp+5Ch+var_28], ecx
		mov	dword_40D024, ecx
		call	strchr
		test	eax, eax
		mov	[esp+5Ch+var_34], eax
		jz	loc_40B420
		mov	ebp, eax
		add	eax, 1
		sub	ebp, [esp+5Ch+Str1]
		mov	[esp+5Ch+var_34], eax

loc_40B25D:				; CODE XREF: sub_40B200+22Ej
		mov	ecx, [esp+5Ch+var_38]
		mov	esi, [ecx]
		test	esi, esi
		jz	loc_40B43E
		mov	ebx, ecx
		xor	edi, edi
		add	ebx, 10h
		mov	[esp+5Ch+var_44], ecx
		mov	[esp+5Ch+var_3C], 0FFFFFFFFh
		mov	[esp+5Ch+var_30], 0
		jmp	short loc_40B2B8
; ---------------------------------------------------------------------------

loc_40B288:				; CODE XREF: sub_40B200+F2j
		mov	eax, [esp+5Ch+var_3C]
		mov	ecx, [esp+5Ch+var_44]
		shl	eax, 4
		add	eax, [esp+5Ch+var_38]
		mov	edx, [eax+4]
		cmp	[ecx+4], edx
		jz	short loc_40B300

loc_40B29F:				; CODE XREF: sub_40B200+106j
		mov	[esp+5Ch+var_30], 1

loc_40B2A7:				; CODE XREF: sub_40B200+CEj
					; sub_40B200+EBj ...
		mov	[esp+5Ch+var_44], ebx
		add	ebx, 10h
		add	edi, 1
		mov	esi, [ebx-10h]
		test	esi, esi
		jz	short loc_40B320

loc_40B2B8:				; CODE XREF: sub_40B200+86j
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+MaxCount], ebp	; MaxCount
		mov	[esp+5Ch+Val], esi ; Str2
		mov	[esp+5Ch+Str], edx ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_40B2A7
		mov	[esp+5Ch+Str], esi ; Str
		call	strlen
		cmp	eax, ebp
		jz	loc_40B370
		cmp	ebp, 1
		jnz	short loc_40B2ED
		mov	esi, [esp+5Ch+arg_4]
		test	esi, esi
		jnz	short loc_40B2A7

loc_40B2ED:				; CODE XREF: sub_40B200+E3j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	short loc_40B288
		mov	[esp+5Ch+var_3C], edi
		jmp	short loc_40B2A7
; ---------------------------------------------------------------------------
		align 10h

loc_40B300:				; CODE XREF: sub_40B200+9Dj
		mov	edx, [eax+8]
		cmp	[ecx+8], edx
		jnz	short loc_40B29F
		mov	edx, [eax+0Ch]
		mov	eax, 1
		cmp	[ecx+0Ch], edx
		cmovz	eax, [esp+5Ch+var_30]
		mov	[esp+5Ch+var_30], eax
		jmp	short loc_40B2A7
; ---------------------------------------------------------------------------
		align 10h

loc_40B320:				; CODE XREF: sub_40B200+B6j
		mov	ebx, [esp+5Ch+var_30]
		test	ebx, ebx
		jz	loc_40B433
		mov	ecx, dword_40D028
		test	ecx, ecx
		jz	short loc_40B357
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40B357
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aAmbiguousOptio ;	"ambiguous option -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_40B190

loc_40B357:				; CODE XREF: sub_40B200+134j
					; sub_40B200+13Dj ...
		mov	dword_40D020, 0
		mov	eax, 3Fh

loc_40B366:				; CODE XREF: sub_40B200+1BDj
					; sub_40B200+2EAj ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40B370:				; CODE XREF: sub_40B200+DAj
		mov	[esp+5Ch+var_3C], edi

loc_40B374:				; CODE XREF: sub_40B200+238j
		mov	ebx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+var_34]
		shl	ebx, 4
		add	ebx, [esp+5Ch+var_38]
		test	edx, edx
		setnz	dl
		mov	eax, [ebx+4]
		jnz	short loc_40B3BF

loc_40B38D:				; CODE XREF: sub_40B200+1C1j
		lea	ecx, [eax-1]
		cmp	ecx, 1
		jbe	loc_40B47E

loc_40B399:				; CODE XREF: sub_40B200+28Fj
					; sub_40B200+29Dj ...
		mov	edx, [esp+5Ch+arg_0]
		test	edx, edx
		jz	short loc_40B3AB
		mov	ecx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+arg_0]
		mov	[edx], ecx

loc_40B3AB:				; CODE XREF: sub_40B200+19Fj
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_40B4E7
		mov	edx, [ebx+0Ch]
		mov	[eax], edx
		xor	eax, eax
		jmp	short loc_40B366
; ---------------------------------------------------------------------------

loc_40B3BF:				; CODE XREF: sub_40B200+18Bj
		test	eax, eax
		jnz	short loc_40B38D
		mov	eax, dword_40D028
		test	eax, eax
		jz	short loc_40B3ED
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40B3ED
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aOptionDoesnTTa ;	"option	doesn't take an argument -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_40B190

loc_40B3ED:				; CODE XREF: sub_40B200+1CAj
					; sub_40B200+1D3j
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_40B4EF
		mov	dword_40D020, 0

loc_40B402:				; CODE XREF: sub_40B200+2E2j
					; sub_40B200+2F7j
		mov	edx, [esp+5Ch+var_24]
		xor	eax, eax
		cmp	byte ptr [edx],	3Ah
		setnz	al
		add	esp, 4Ch
		pop	ebx
		lea	eax, [eax+eax*4+3Ah]
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40B420:				; CODE XREF: sub_40B200+4Aj
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], edx ; Str
		call	strlen
		mov	ebp, eax
		jmp	loc_40B25D
; ---------------------------------------------------------------------------

loc_40B433:				; CODE XREF: sub_40B200+126j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	loc_40B374

loc_40B43E:				; CODE XREF: sub_40B200+65j
		mov	ebx, [esp+5Ch+arg_4]
		test	ebx, ebx
		jnz	loc_40B526
		mov	ecx, dword_40D028
		test	ecx, ecx
		jz	loc_40B357
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	loc_40B357
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aUnknownOptionS ;	"unknown option	-- %s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_40B190
		jmp	loc_40B357
; ---------------------------------------------------------------------------

loc_40B47E:				; CODE XREF: sub_40B200+193j
		test	dl, dl
		jz	short loc_40B4FC
		mov	ecx, [esp+5Ch+var_34]
		cmp	eax, 1
		mov	ds:Filename, ecx
		jnz	loc_40B399

loc_40B495:				; CODE XREF: sub_40B200+321j
		mov	ebp, ds:Filename
		test	ebp, ebp
		jnz	loc_40B399
		mov	edi, dword_40D028
		test	edi, edi
		jz	short loc_40B4CA
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40B4CA
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aOptionRequires ;	"option	requires an argument --	%s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_40B190

loc_40B4CA:				; CODE XREF: sub_40B200+2ABj
					; sub_40B200+2B4j
		mov	esi, [ebx+8]
		test	esi, esi
		jz	short loc_40B53A
		mov	dword_40D020, 0

loc_40B4DB:				; CODE XREF: sub_40B200+342j
		sub	dword_40D024, 1
		jmp	loc_40B402
; ---------------------------------------------------------------------------

loc_40B4E7:				; CODE XREF: sub_40B200+1B0j
		mov	eax, [ebx+0Ch]
		jmp	loc_40B366
; ---------------------------------------------------------------------------

loc_40B4EF:				; CODE XREF: sub_40B200+1F2j
		mov	eax, [ebx+0Ch]
		mov	dword_40D020, eax
		jmp	loc_40B402
; ---------------------------------------------------------------------------

loc_40B4FC:				; CODE XREF: sub_40B200+280j
		cmp	eax, 1
		jnz	loc_40B399
		mov	edx, [esp+5Ch+var_28]
		mov	ecx, [esp+5Ch+var_20]
		mov	eax, [ecx+edx*4]
		mov	ds:Filename, eax
		mov	eax, [esp+5Ch+var_2C]
		add	eax, 2
		mov	dword_40D024, eax
		jmp	loc_40B495
; ---------------------------------------------------------------------------

loc_40B526:				; CODE XREF: sub_40B200+244j
		mov	ecx, [esp+5Ch+var_2C]
		mov	eax, 0FFFFFFFFh
		mov	dword_40D024, ecx
		jmp	loc_40B366
; ---------------------------------------------------------------------------

loc_40B53A:				; CODE XREF: sub_40B200+2CFj
		mov	eax, [ebx+0Ch]
		mov	dword_40D020, eax
		jmp	short loc_40B4DB
sub_40B200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40B550	proc near		; CODE XREF: sub_40BB30+24j
					; .text:0040BB86j ...

Str		= dword	ptr -4Ch
Val		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		test	ecx, ecx
		mov	[esp+4Ch+var_24], eax
		mov	edi, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_28], edx
		mov	[esp+4Ch+var_20], ecx
		jz	loc_40B882
		mov	ecx, dword_40D024
		test	ecx, ecx
		jz	loc_40B7D0

loc_40B57D:				; CODE XREF: sub_40B550+294j
		cmp	dword_40D02C, 0FFFFFFFFh
		jz	loc_40B790
		mov	edx, ds:dword_4108FC
		xor	eax, eax
		test	edx, edx
		jnz	loc_40B790
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		cmp	dl, 2Dh
		jz	loc_40B7BE

loc_40B5AA:				; CODE XREF: sub_40B550+268j
		mov	ebp, dword_40D02C
		test	ebp, ebp
		jnz	loc_40B7F0
		cmp	dl, 2Bh
		jz	loc_40B9A7

loc_40B5C1:				; CODE XREF: sub_40B550+276j
					; sub_40B550+2A6j ...
		test	eax, eax
		mov	ds:Filename, 0
		jz	loc_40B66C
		mov	dword_40D030, 0FFFFFFFFh
		mov	dword_40D034, 0FFFFFFFFh
		jmp	short loc_40B668
; ---------------------------------------------------------------------------
		align 10h

loc_40B5F0:				; CODE XREF: sub_40B550+159j
					; sub_40B550+18Ej
		test	edi, 2
		mov	off_40D038, offset byte_40F9F5
		jnz	loc_40B891
		test	edi, 1
		jz	loc_40B882
		mov	ebx, dword_40D034
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40B806
		mov	esi, dword_40D030
		xor	eax, eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_40B65F
		mov	edx, [esp+4Ch+var_28]
		mov	eax, ebx
		mov	ecx, ebp
		sub	ebx, esi
		mov	[esp+4Ch+Str], edx
		mov	edx, esi
		call	sub_40B0D0
		mov	edx, dword_40D024
		mov	eax, ds:dword_4108FC
		mov	dword_40D030, 0FFFFFFFFh
		add	ebx, edx
		mov	dword_40D034, ebx

loc_40B65F:				; CODE XREF: sub_40B550+DCj
					; sub_40B550+2BEj
		add	edx, 1
		mov	dword_40D024, edx

loc_40B668:				; CODE XREF: sub_40B550+97j
		test	eax, eax
		jnz	short loc_40B67D

loc_40B66C:				; CODE XREF: sub_40B550+7Dj
		mov	ebx, off_40D038
		movzx	ecx, byte ptr [ebx]
		test	cl, cl
		jnz	loc_40B707

loc_40B67D:				; CODE XREF: sub_40B550+11Aj
		mov	ebp, dword_40D024
		cmp	ebp, [esp+4Ch+var_24]
		mov	ds:dword_4108FC, 0
		mov	edx, ebp
		jge	loc_40B813
		mov	ecx, [esp+4Ch+var_28]
		mov	ebx, [ecx+ebp*4]
		cmp	byte ptr [ebx],	2Dh
		mov	off_40D038, ebx
		jnz	loc_40B5F0
		movzx	ecx, byte ptr [ebx+1]
		test	cl, cl
		jnz	short loc_40B6E4
		mov	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], 2Dh ; Val
		mov	[esp+4Ch+var_2C], cl
		mov	[esp+4Ch+var_30], ebp
		mov	[esp+4Ch+Str], eax ; Str
		call	strchr
		mov	edx, [esp+4Ch+var_30]
		movzx	ecx, [esp+4Ch+var_2C]
		test	eax, eax
		jz	loc_40B5F0

loc_40B6E4:				; CODE XREF: sub_40B550+165j
		cmp	dword_40D034, 0FFFFFFFFh
		mov	eax, ebx
		jz	short loc_40B6FC
		cmp	dword_40D030, 0FFFFFFFFh
		jz	loc_40BA63

loc_40B6FC:				; CODE XREF: sub_40B550+19Dj
					; sub_40B550+519j
		test	cl, cl
		jnz	loc_40B9F4
		movzx	ecx, byte ptr [ebx]

loc_40B707:				; CODE XREF: sub_40B550+127j
					; sub_40B550+4B0j ...
		mov	esi, [esp+4Ch+arg_0]
		test	esi, esi
		jz	loc_40B8C9
		mov	eax, dword_40D024
		mov	edx, [esp+4Ch+var_28]
		cmp	ebx, [edx+eax*4]
		jz	loc_40B8C9
		cmp	cl, 2Dh
		jz	loc_40BA53
		and	edi, 4
		jz	loc_40B8C9
		xor	eax, eax
		cmp	cl, 3Ah
		jz	short loc_40B759
		movsx	ecx, cl
		mov	[esp+4Ch+Val], ecx ; Val
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		setnz	al
		movzx	eax, al

loc_40B759:				; CODE XREF: sub_40B550+1ECj
					; sub_40B550+50Ej
		mov	[esp+4Ch+Val], eax
		mov	eax, [esp+4Ch+arg_4]
		mov	ecx, [esp+4Ch+arg_0]
		mov	edx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], eax
		mov	eax, [esp+4Ch+var_28]
		call	sub_40B200
		cmp	eax, 0FFFFFFFFh
		mov	esi, eax
		jz	loc_40B8C0

loc_40B780:				; CODE XREF: sub_40B550+5C2j
		mov	off_40D038, offset byte_40F9F5
		jmp	loc_40B887
; ---------------------------------------------------------------------------
		align 10h

loc_40B790:				; CODE XREF: sub_40B550+34j
					; sub_40B550+44j
		mov	[esp+4Ch+Str], offset aPosixly_correc ;	"POSIXLY_CORRECT"
		call	getenv
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		test	eax, eax
		setnz	al
		movzx	eax, al
		cmp	dl, 2Dh
		mov	dword_40D02C, eax
		mov	eax, ds:dword_4108FC
		jnz	loc_40B5AA

loc_40B7BE:				; CODE XREF: sub_40B550+54j
		or	edi, 2
		add	[esp+4Ch+var_20], 1
		jmp	loc_40B5C1
; ---------------------------------------------------------------------------
		align 10h

loc_40B7D0:				; CODE XREF: sub_40B550+27j
		mov	ds:dword_4108FC, 1
		mov	dword_40D024, 1
		jmp	loc_40B57D
; ---------------------------------------------------------------------------
		align 10h

loc_40B7F0:				; CODE XREF: sub_40B550+62j
		and	edi, 0FFFFFFFEh
		cmp	dl, 2Bh
		jnz	loc_40B5C1
		add	[esp+4Ch+var_20], 1
		jmp	loc_40B5C1
; ---------------------------------------------------------------------------

loc_40B806:				; CODE XREF: sub_40B550+CBj
		mov	dword_40D034, ebp
		xor	eax, eax
		jmp	loc_40B65F
; ---------------------------------------------------------------------------

loc_40B813:				; CODE XREF: sub_40B550+143j
		mov	ebx, dword_40D030
		mov	off_40D038, offset byte_40F9F5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40B8AF
		mov	edx, [esp+4Ch+var_28]
		mov	ecx, ebp
		mov	esi, dword_40D034
		mov	[esp+4Ch+Str], edx

loc_40B83B:				; CODE XREF: sub_40B550+4EFj
		mov	eax, esi
		mov	edx, ebx
		call	sub_40B0D0
		sub	esi, ebx
		add	dword_40D024, esi

loc_40B84C:				; CODE XREF: sub_40B550+367j
					; sub_40B550+36Ej ...
		mov	esi, 0FFFFFFFFh
		mov	dword_40D030, 0FFFFFFFFh
		mov	eax, esi
		mov	dword_40D034, 0FFFFFFFFh
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40B86F:				; CODE XREF: sub_40B550+3A9j
		cmp	esi, 2Dh
		jnz	loc_40B9B4
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40B9C1

loc_40B882:				; CODE XREF: sub_40B550+19j
					; sub_40B550+BCj
		mov	esi, 0FFFFFFFFh

loc_40B887:				; CODE XREF: sub_40B550+23Aj
					; sub_40B550+3CDj ...
		add	esp, 3Ch
		mov	eax, esi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40B891:				; CODE XREF: sub_40B550+B0j
		add	ebp, 1
		mov	esi, 1
		mov	ds:Filename, ebx
		mov	eax, esi
		mov	dword_40D024, ebp
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40B8AF:				; CODE XREF: sub_40B550+2D6j
		mov	eax, dword_40D034
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40B84C
		mov	dword_40D024, eax
		jmp	short loc_40B84C
; ---------------------------------------------------------------------------

loc_40B8C0:				; CODE XREF: sub_40B550+22Aj
		mov	ebx, off_40D038
		movzx	ecx, byte ptr [ebx]

loc_40B8C9:				; CODE XREF: sub_40B550+1BDj
					; sub_40B550+1CFj ...
		movsx	esi, cl
		lea	edi, [ebx+1]
		cmp	esi, 3Ah
		mov	off_40D038, edi
		jz	loc_40B9B4
		cmp	esi, 2Dh
		jz	loc_40BA44

loc_40B8E7:				; CODE XREF: sub_40B550+4FEj
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], esi ; Val
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		jz	loc_40B86F
		cmp	esi, 57h
		movzx	edx, byte ptr [eax+1]
		jnz	short loc_40B910
		mov	ecx, [esp+4Ch+arg_0]
		test	ecx, ecx
		jnz	short loc_40B92F

loc_40B910:				; CODE XREF: sub_40B550+3B6j
					; sub_40B550+3E2j
		cmp	dl, 3Ah
		jz	loc_40BA6E
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40B887

loc_40B923:				; CODE XREF: sub_40B550+53Ej
		add	dword_40D024, 1
		jmp	loc_40B887
; ---------------------------------------------------------------------------

loc_40B92F:				; CODE XREF: sub_40B550+3BEj
		cmp	dl, 3Bh
		jnz	short loc_40B910
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40BAF0
		mov	eax, dword_40D024
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_40D024, eax
		jg	loc_40BAE4
		mov	ebp, dword_40D028
		mov	off_40D038, offset byte_40F9F5
		test	ebp, ebp
		jz	short loc_40B986
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40B986
		mov	[esp+4Ch+Val], 57h ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_40B190

loc_40B986:				; CODE XREF: sub_40B550+417j
					; sub_40B550+420j
		mov	dword_40D020, 57h

loc_40B990:				; CODE XREF: sub_40B550+58Fj
		mov	ecx, [esp+4Ch+var_20]
		xor	eax, eax
		cmp	byte ptr [ecx],	3Ah
		setnz	al
		mov	esi, eax
		lea	esi, [esi+esi*4+3Ah]
		jmp	loc_40B887
; ---------------------------------------------------------------------------

loc_40B9A7:				; CODE XREF: sub_40B550+6Bj
		and	edi, 0FFFFFFFEh
		add	[esp+4Ch+var_20], 1
		jmp	loc_40B5C1
; ---------------------------------------------------------------------------

loc_40B9B4:				; CODE XREF: sub_40B550+322j
					; sub_40B550+388j
		cmp	byte ptr [ebx+1], 0
		jnz	short loc_40B9C1
		add	dword_40D024, 1

loc_40B9C1:				; CODE XREF: sub_40B550+32Cj
					; sub_40B550+468j ...
		mov	ebx, dword_40D028
		test	ebx, ebx
		jz	short loc_40B9E4
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40B9E4
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aUnknownOptionC ;	"unknown option	-- %c"
		call	sub_40B190

loc_40B9E4:				; CODE XREF: sub_40B550+479j
					; sub_40B550+482j
		mov	dword_40D020, esi
		mov	esi, 3Fh
		jmp	loc_40B887
; ---------------------------------------------------------------------------

loc_40B9F4:				; CODE XREF: sub_40B550+1AEj
		add	ebx, 1
		cmp	cl, 2Dh
		mov	off_40D038, ebx
		jnz	loc_40B707
		cmp	byte ptr [eax+2], 0
		jnz	loc_40B707
		mov	ebx, dword_40D030
		lea	ecx, [ebp+1]
		mov	dword_40D024, ecx
		mov	off_40D038, offset byte_40F9F5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40B84C
		mov	edx, [esp+4Ch+var_28]
		mov	esi, dword_40D034
		mov	[esp+4Ch+Str], edx
		jmp	loc_40B83B
; ---------------------------------------------------------------------------

loc_40BA44:				; CODE XREF: sub_40B550+391j
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40B9C1
		jmp	loc_40B8E7
; ---------------------------------------------------------------------------

loc_40BA53:				; CODE XREF: sub_40B550+1D8j
		add	ebx, 1
		xor	eax, eax
		mov	off_40D038, ebx
		jmp	loc_40B759
; ---------------------------------------------------------------------------

loc_40BA63:				; CODE XREF: sub_40B550+1A6j
		mov	dword_40D030, ebp
		jmp	loc_40B6FC
; ---------------------------------------------------------------------------

loc_40BA6E:				; CODE XREF: sub_40B550+3C3j
		mov	ds:Filename, 0
		cmp	byte ptr [ebx+1], 0
		jz	short loc_40BA93
		mov	ds:Filename, edi

loc_40BA84:				; CODE XREF: sub_40B550+547j
					; sub_40B550+5D3j
		mov	off_40D038, offset byte_40F9F5
		jmp	loc_40B923
; ---------------------------------------------------------------------------

loc_40BA93:				; CODE XREF: sub_40B550+52Cj
		cmp	byte ptr [eax+2], 3Ah
		jz	short loc_40BA84
		mov	eax, dword_40D024
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_40D024, eax
		jg	short loc_40BB17
		mov	edi, dword_40D028
		mov	off_40D038, offset byte_40F9F5
		test	edi, edi
		jz	short loc_40BAD9
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40BAD9
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_40B190

loc_40BAD9:				; CODE XREF: sub_40B550+56Ej
					; sub_40B550+577j
		mov	dword_40D020, esi
		jmp	loc_40B990
; ---------------------------------------------------------------------------

loc_40BAE4:				; CODE XREF: sub_40B550+3FFj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	off_40D038, eax

loc_40BAF0:				; CODE XREF: sub_40B550+3E8j
		mov	ecx, [esp+4Ch+arg_4]
		mov	edx, [esp+4Ch+var_20]
		mov	eax, [esp+4Ch+var_28]
		mov	[esp+4Ch+Val], 0
		mov	[esp+4Ch+Str], ecx
		mov	ecx, [esp+4Ch+arg_0]
		call	sub_40B200
		mov	esi, eax
		jmp	loc_40B780
; ---------------------------------------------------------------------------

loc_40BB17:				; CODE XREF: sub_40B550+55Aj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	ds:Filename, eax
		jmp	loc_40BA84
sub_40B550	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40BB30	proc near		; CODE XREF: sub_402A9B+20Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_8]
		mov	[esp+arg_4], 0
		mov	[esp+arg_8], 0
		mov	[esp+arg_0], 0
		jmp	sub_40B550
sub_40BB30	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+18h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		mov	[esp+0Ch], ebx
		mov	ebx, [esp+14h]
		mov	dword ptr [esp+10h], 1
		mov	[esp+8], ebx
		pop	ebx
		jmp	sub_40B550
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+18h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		mov	[esp+0Ch], ebx
		mov	ebx, [esp+14h]
		mov	dword ptr [esp+10h], 5
		mov	[esp+8], ebx
		pop	ebx
		jmp	sub_40B550
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_40BBC0	proc near		; CODE XREF: sub_40BDA0+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_40BC0C
		jmp	short loc_40BC14
; ---------------------------------------------------------------------------
		align 10h

loc_40BC00:				; CODE XREF: sub_40BBC0+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_40BC14

loc_40BC0C:				; CODE XREF: sub_40BBC0+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_40BC00

loc_40BC14:				; CODE XREF: sub_40BBC0+39j
					; sub_40BBC0+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_40BC3C
		jmp	short loc_40BC44
; ---------------------------------------------------------------------------
		align 10h

loc_40BC30:				; CODE XREF: sub_40BBC0+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_40BC44

loc_40BC3C:				; CODE XREF: sub_40BBC0+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_40BC30

loc_40BC44:				; CODE XREF: sub_40BBC0+6Aj
					; sub_40BBC0+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_40BD00
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_40BD2E

loc_40BC63:				; CODE XREF: sub_40BBC0+168j
					; sub_40BBC0+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40BD40

loc_40BC93:				; CODE XREF: sub_40BBC0+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_410524
		test	eax, eax
		jz	loc_40BD79
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_40BD61
		cmp	eax, 5
		jnz	short loc_40BD5C
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40BD00:				; CODE XREF: sub_40BBC0+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_40BC63

loc_40BD2E:				; CODE XREF: sub_40BBC0+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_40BC63
; ---------------------------------------------------------------------------
		align 10h

loc_40BD40:				; CODE XREF: sub_40BBC0+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_40BC93
; ---------------------------------------------------------------------------

loc_40BD5C:				; CODE XREF: sub_40BBC0+133j
		call	abort
; ---------------------------------------------------------------------------

loc_40BD61:				; CODE XREF: sub_40BBC0+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_40BD79:				; CODE XREF: sub_40BBC0+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_1 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_40BBC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40BDA0(char *, char *, int)
sub_40BDA0	proc near		; CODE XREF: sub_406DAE+3Ep

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40BE06
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_40BDF0:				; CODE XREF: sub_40BDA0+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_40BDF0
		add	edx, edx

loc_40BE06:				; CODE XREF: sub_40BDA0+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40BE2D
		xor	edi, edi

loc_40BE17:				; CODE XREF: sub_40BDA0+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_40BE17
		add	edx, edx

loc_40BE2D:				; CODE XREF: sub_40BDA0+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_40BBC0
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_40BDA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40BE70	proc near		; CODE XREF: sub_406DAE+9Cp
		jmp	sub_40BE90
sub_40BE70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40BE80	proc near		; CODE XREF: sub_406DAE+AAp
		jmp	sub_40BEA0
sub_40BE80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40BE90	proc near		; CODE XREF: sub_40BE70j
		mov	eax, ds:time
		jmp	eax
sub_40BE90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40BEA0	proc near		; CODE XREF: sub_40BE80j
		mov	eax, ds:localtime
		jmp	eax
sub_40BEA0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sscanf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fgets]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strspn]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C030	proc near		; DATA XREF: .text:0040C054o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_40A060
		leave
		retn
sub_40C030	endp

; ---------------------------------------------------------------------------
		align 10h
dword_40C050	dd 0FFFFFFFFh		; DATA XREF: sub_40AC80-4Cr
					; sub_40AC80:loc_40AC43r ...
		dd offset sub_40C030
		dd 0
		dd 0FFFFFFFFh
dword_40C060	dd 68h dup(0)		; DATA XREF: .data:off_40D014o
		dd 380h	dup(?)
_text		ends

; Section 2. (virtual address 0000D000)
; Virtual size			: 00000048 (	 72.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000B600
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 40D000h
dword_40D000	dd 0FFFFFFFFh		; DATA XREF: sub_40698D:loc_406B13w
					; .text:loc_406D47r ...
; char off_40D004[]
off_40D004	dd offset aIso88591	; DATA XREF: sub_407368+D9w
					; .text:loc_40763Cw ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_40D014	dd offset dword_40C060	; DATA XREF: sub_40AC00+3r
					; sub_40AC00+12r ...
dword_40D018	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_40D01C	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_40D020	dd 3Fh			; DATA XREF: sub_40B200:loc_40B357w
					; sub_40B200+1F8w ...
dword_40D024	dd 1			; DATA XREF: sub_402A9B+228r
					; sub_402A9B+237r ...
dword_40D028	dd 1			; DATA XREF: sub_40B200+12Cr
					; sub_40B200+1C3r ...
dword_40D02C	dd 0FFFFFFFFh		; DATA XREF: sub_40B550:loc_40B57Dr
					; sub_40B550:loc_40B5AAr ...
dword_40D030	dd 0FFFFFFFFh		; DATA XREF: sub_40B550+83w
					; sub_40B550+D1r ...
dword_40D034	dd 0FFFFFFFFh		; DATA XREF: sub_40B550+8Dw
					; sub_40B550+C2r ...
; char *off_40D038
off_40D038	dd offset byte_40F9F5	; DATA XREF: sub_40B200+Br
					; sub_40B550+A6w ...
dword_40D03C	dd 0BB40E64Eh		; DATA XREF: sub_40ACA0+3r
					; sub_40ACA0:loc_40AD52w ...
dword_40D040	dd 44BF19B1h		; DATA XREF: sub_40ACA0+31w
					; sub_40ACA0+B8w ...
dword_40D044	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0000E000)
; Virtual size			: 00001B40 (   6976.)
; Section size in file		: 00001C00 (   7168.)
; Offset to raw	data for section: 0000B800
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 40E000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
; char Format[]
Format		db 'KEY%*[ ]%16s%*[ ]%5s',0Ah,0 ; DATA XREF: sub_401700:loc_40173Fo
aBegin		db 'BEGIN',0            ; DATA XREF: sub_401700+77o
; char aKey16s3s[]
aKey16s3s	db 'KEY%*[ ]%16s%*[ ]%3s',0Ah,0 ; DATA XREF: sub_401700:loc_4017E9o
aEnd		db 'END',0              ; DATA XREF: sub_401700+121o
aGpgkeysOutOfMe	db 'gpgkeys: out of memory',0Ah,0 ; DATA XREF: sub_401700+1B6o
					; sub_401700+2B6o ...
; char aGpgkeysNoKeySE[]
aGpgkeysNoKeySE	db 'gpgkeys: no KEY %s END found',0Ah,0 ; DATA XREF: sub_401700+25Eo
aKeytext	db 'keytext=',0         ; DATA XREF: sub_401700+2FDo
asc_40E0B9	db '://',0              ; DATA XREF: sub_401700+35Co
					; sub_401CC0+114o ...
asc_40E0BD	db ':',0                ; DATA XREF: sub_401700+3AFo
					; sub_401CC0+167o ...
; char aPksAdd[]
aPksAdd		db '/pks/add',0         ; DATA XREF: sub_401700+41Bo
; char aGpgkeysHttpUrl[]
aGpgkeysHttpUrl	db 'gpgkeys: HTTP URL is `%s',27h,0Ah,0 ; DATA XREF: sub_401700+43Eo
					; sub_401CC0+275o ...
		align 4
; char aGpgkeysHttpPos[]
aGpgkeysHttpPos	db 'gpgkeys: HTTP post error %d: %s',0Ah,0 ; DATA XREF: sub_401700+50Bo
; char aKeySSent[]
aKeySSent	db 0Ah			; DATA XREF: sub_401700:loc_401C40o
		db 'KEY %s SENT',0Ah,0
; char aKeySFailedD[]
aKeySFailedD	db 'KEY %s FAILED %d',0Ah,0 ; DATA XREF: sub_401700+58Bo
					; sub_40292C+9Bo
a0x		db '0x',0               ; DATA XREF: sub_401CC0+39o
					; sub_40262A:loc_4026DCo
; char aKey0xSBegin[]
aKey0xSBegin	db 'KEY 0x%s BEGIN',0Ah,0 ; DATA XREF: sub_401CC0:loc_401D20o
aGpgkeysHkpKeys	db 'gpgkeys: HKP keyservers do not support v3 fingerprints',0Ah,0
					; DATA XREF: sub_401CC0+ADo
; char aKey0xSFailedD[]
aKey0xSFailedD	db 'KEY 0x%s FAILED %d',0Ah,0 ; DATA XREF: sub_401CC0+CEo
; char aPksLookup_opGe[]
aPksLookup?opGe	db '/pks/lookup?op=get&options=mr&search=0x',0 ; DATA XREF: sub_401CC0+1D3o
; char aGpgkeysHttpFet[]
aGpgkeysHttpFet	db 'gpgkeys: HTTP fetch error %d: %s',0Ah,0 ; DATA XREF: sub_401CC0+32Bo
					; sub_402232+226o
; char aKey0xSFailed_0[]
aKey0xSFailed_0	db 0Ah			; DATA XREF: sub_401CC0+35Bo
					; sub_401CC0+43Co ...
		db 'KEY 0x%s FAILED %d',0Ah,0
		align 4
; char aGpgkeysHttpRes[]
aGpgkeysHttpRes	db 'gpgkeys: HTTP response code is %ld',0Ah,0 ; DATA XREF: sub_401CC0+3D4o
					; sub_402232+2A4o
; char aGpgkeysKeySPar[]
aGpgkeysKeySPar	db 'gpgkeys: key %s partially retrieved (probably corrupt)',0Ah,0
					; DATA XREF: sub_401CC0+41Fo
					; sub_402232+2E2o
; char aGpgkeysKeySCan[]
aGpgkeysKeySCan	db 'gpgkeys: key %s can',27h,'t be retrieved',0Ah,0
					; DATA XREF: sub_401CC0:loc_402126o
					; sub_401CC0:loc_4021E0o ...
; char aKey0xSEnd[]
aKey0xSEnd	db 0Ah			; DATA XREF: sub_401CC0:loc_40216Do
		db 'KEY 0x%s END',0Ah,0
		align 4
; char aGpgkeysKeySNot[]
aGpgkeysKeySNot	db 'gpgkeys: key %s not found on keyserver',0Ah,0
					; DATA XREF: sub_401CC0+4DCo
					; sub_402232+361o
aExactOn	db '&exact=on',0        ; DATA XREF: sub_402232+99o
					; sub_40262A+CDo
; char Src[2]
Src		db 2 dup(0)		; DATA XREF: sub_402232:loc_4022D2o
					; sub_40262A:loc_4026E3o ...
aPksLookup?op_0	db '/pks/lookup?op=get&options=mr&search=',0 ; DATA XREF: sub_402232+ADo
; char aNameSBegin[]
aNameSBegin	db 'NAME %s BEGIN',0Ah,0 ; DATA XREF: sub_402232:loc_402384o
; char aNameSEnd[]
aNameSEnd	db 0Ah			; DATA XREF: sub_402232:loc_402563o
		db 'NAME %s END',0Ah,0
; char aNameSFailedD[]
aNameSFailedD	db 0Ah			; DATA XREF: sub_402232+3C9o
		db 'NAME %s FAILED %d',0Ah,0
		align 10h
; char aGpgkeysSearchT[]
aGpgkeysSearchT	db 'gpgkeys: search type is %d, and key is "%s"',0Ah,0
					; DATA XREF: sub_40262A+34o
		align 10h
aPksLookup?opIn	db '/pks/lookup?op=index&options=mr&search=',0 ; DATA XREF: sub_40262A+E1o
; char aSearchSBegin[]
aSearchSBegin	db 'SEARCH %s BEGIN',0Ah,0 ; DATA XREF: sub_40262A+190o
		align 4
; char aGpgkeysHttpSea[]
aGpgkeysHttpSea	db 'gpgkeys: HTTP search error %d: %s',0Ah,0 ; DATA XREF: sub_40262A+25Co
; char aSearchSEnd[]
aSearchSEnd	db 0Ah			; DATA XREF: sub_40262A+294o
		db 'SEARCH %s END',0Ah,0
; char aSearchSFailedD[]
aSearchSFailedD	db 0Ah			; DATA XREF: sub_40262A+2D6o
		db 'SEARCH %s FAILED %d',0Ah,0
aSearch		db 'SEARCH ',0          ; DATA XREF: sub_40292C+27o
; char aS[]
aS		db '%s ',0              ; DATA XREF: sub_40292C+4Do
; char aFailedD[]
aFailedD	db 'FAILED %d',0Ah,0    ; DATA XREF: sub_40292C+79o
aHHelpHelp	db '-h, --help',9,'help',0Ah,0 ; DATA XREF: sub_402A03+6o
aVMachineReadab	db '-V',9,9,'machine readable version',0Ah,0 ; DATA XREF: sub_402A03+2Ao
		align 4
aVersionHumanRe	db '--version',9,'human readable version',0Ah,0 ; DATA XREF: sub_402A03+4Eo
aOOutputToThisF	db '-o',9,9,'output to this file',0Ah,0 ; DATA XREF: sub_402A03+72o
aVersion	db '--version',0        ; DATA XREF: sub_402A9B+89o
; char aGpgkeys_hkpGnu[]
aGpgkeys_hkpGnu	db 'gpgkeys_hkp (GnuPG) %s',0Ah,0 ; DATA XREF: sub_402A9B+ACo
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_402A9B+B1o
					; sub_402A9B+16Eo ...
; char aUsesS[]
aUsesS		db 'Uses: %s',0Ah,0     ; DATA XREF: sub_402A9B+C8o
aHelp		db '--help',0           ; DATA XREF: sub_402A9B+F7o
; char aDS[]
aDS		db '%d',0Ah             ; DATA XREF: sub_402A9B:loc_402BFBo
		db '%s',0Ah,0
; char Mode[]
Mode		db 'w',0                ; DATA XREF: sub_402A9B:loc_402C2Fo
		align 4
; char aGpgkeysCannotO[]
aGpgkeysCannotO	db 'gpgkeys: Cannot open output file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_402A9B+1CFo
aHvo		db 'hVo:',0             ; DATA XREF: sub_402A9B:loc_402C94o
; char aR[]
aR		db 'r',0                ; DATA XREF: sub_402A9B+232o
		align 10h
; char aGpgkeysCanno_0[]
aGpgkeysCanno_0	db 'gpgkeys: Cannot open input file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_402A9B+27Do
; char aOption256s[]
aOption256s	db 'OPTION %256s',0Ah,0 ; DATA XREF: sub_402A9B+34Ao
; char Str[]
Str		db 'no-',0              ; DATA XREF: sub_402A9B+399o
; char aHttpProxy[]
aHttpProxy	db 'http-proxy',0       ; DATA XREF: sub_402A9B+3D4o
; char Str2[]
Str2		db 'try-dns-srv',0      ; DATA XREF: sub_402A9B:loc_402F2Do
aGpgkeysNoSchem	db 'gpgkeys: no scheme supplied!',0Ah,0 ; DATA XREF: sub_402A9B+517o
aHkps		db 'hkps',0             ; DATA XREF: sub_402A9B+550o
					; sub_402A9B+740o
aHttps		db 'https',0            ; DATA XREF: sub_402A9B+564o
a443		db '443',0              ; DATA XREF: sub_402A9B+56Eo
aHttp		db 'http',0             ; DATA XREF: sub_402A9B:loc_403015o
a11371		db '11371',0            ; DATA XREF: sub_402A9B+584o
		align 4
aGpgkeysNoKeyse	db 'gpgkeys: no keyserver host provided',0Ah,0 ; DATA XREF: sub_402A9B+5A0o
		align 4
aGpgkeysUnableT	db 'gpgkeys: unable to register timeout handler',0Ah,0
					; DATA XREF: sub_402A9B+5E2o
		align 4
aGpgkeysUnabl_0	db 'gpgkeys: unable to initialize curl',0Ah,0 ; DATA XREF: sub_402A9B+636o
; char aGpgkeysCurlVer[]
aGpgkeysCurlVer	db 'gpgkeys: curl version = %s',0Ah,0 ; DATA XREF: sub_402A9B+67Ao
aHkp		db 'hkp',0              ; DATA XREF: sub_402A9B+717o
aPgpkeyHttp	db 'pgpkey-http',0      ; DATA XREF: sub_402A9B+72Bo
aPgpkeyHttps	db 'pgpkey-https',0     ; DATA XREF: sub_402A9B+754o
		align 4
aGpgkeysTryDnsS	db 'gpgkeys: try-dns-srv was requested, but not SRV capable',0Ah,0
					; DATA XREF: sub_402A9B+772o
aPragmaNoCache	db 'Pragma: no-cache',0 ; DATA XREF: sub_402A9B:loc_403329o
aCacheControlNo	db 'Cache-Control: no-cache',0 ; DATA XREF: sub_402A9B+8B8o
		align 4
aGpgkeysOutOf_0	db 'gpgkeys: out of memory when building HTTP headers',0Ah,0
					; DATA XREF: sub_402A9B+8E8o
		align 4
aGpgkeysOutOf_1	db 'gpgkeys: out of memory while building key list',0Ah,0
					; DATA XREF: sub_402A9B+A5Co
aGpgkeysNoKey_0	db 'gpgkeys: no keyserver command specified',0Ah,0
					; DATA XREF: sub_402A9B+B35o
; char aVersionD[]
aVersionD	db 'VERSION %d',0Ah,0   ; DATA XREF: sub_402A9B:loc_4035F7o
; char aProgramS[]
aProgramS	db 'PROGRAM %s',0Ah     ; DATA XREF: sub_402A9B+B7Ao
		db 0Ah,0
; char aHostS[]
aHostS		db 'Host:',9,9,'%s',0Ah,0 ; DATA XREF: sub_402A9B+BB1o
; char aPortS[]
aPortS		db 'Port:',9,9,'%s',0Ah,0 ; DATA XREF: sub_402A9B+BDFo
asc_40E714	db '/',0                ; DATA XREF: sub_402A9B+C03o
; char aPathS[]
aPathS		db 'Path:',9,9,'%s',0Ah,0 ; DATA XREF: sub_402A9B+C2Eo
; char aCommandS[]
aCommandS	db 'Command:',9,'%s',0Ah,0 ; DATA XREF: sub_402A9B+C57o
asc_40E72E	db ' ',0                ; DATA XREF: sub_402A9B+EB2o
; char asc_40E730[]
asc_40E730	db '/',0                ; DATA XREF: sub_403BC8+5Do
; char aCommand7s[]
aCommand7s	db 'COMMAND %7s',0Ah,0  ; DATA XREF: sub_403CD5:loc_403CF2o
; char aGet[]
aGet		db 'get',0              ; DATA XREF: sub_403CD5+45o
; char aGetname[]
aGetname	db 'getname',0          ; DATA XREF: sub_403CD5:loc_403D3Eo
; char aSend[]
aSend		db 'send',0             ; DATA XREF: sub_403CD5:loc_403D62o
; char aSearch_0[]
aSearch_0	db 'search',0           ; DATA XREF: sub_403CD5:loc_403D86o
; char aHost80s[]
aHost80s	db 'HOST %80s',0Ah,0    ; DATA XREF: sub_403CD5:loc_403DB2o
; char aPort10s[]
aPort10s	db 'PORT %10s',0Ah,0    ; DATA XREF: sub_403CD5:loc_403E15o
; char aScheme20s[]
aScheme20s	db 'SCHEME %20s',0Ah,0  ; DATA XREF: sub_403CD5:loc_403E78o
; char aAuth128s[]
aAuth128s	db 'AUTH %128s',0Ah,0   ; DATA XREF: sub_403CD5:loc_403EE1o
; char aPath1024s[]
aPath1024s	db 'PATH %1024s',0Ah,0  ; DATA XREF: sub_403CD5:loc_403F4Do
; char aOpaque1024s[]
aOpaque1024s	db 'OPAQUE %1024s',0Ah,0 ; DATA XREF: sub_403CD5:loc_403FB9o
; char aVersionD_0[]
aVersionD_0	db 'VERSION %d',0Ah,0   ; DATA XREF: sub_403CD5:loc_404025o
; char aOption256[]
aOption256	db 'OPTION %256[^',0Ah  ; DATA XREF: sub_403CD5:loc_404061o
		db ']',0Ah,0
; char aNo_0[]
aNo_0		db 'no-',0              ; DATA XREF: sub_403CD5+3D2o
; char aVerbose[]
aVerbose	db 'verbose',0          ; DATA XREF: sub_403CD5+409o
; char aIncludeDisable[]
aIncludeDisable	db 'include-disabled',0 ; DATA XREF: sub_403CD5:loc_404148o
; char aIncludeRevoked[]
aIncludeRevoked	db 'include-revoked',0  ; DATA XREF: sub_403CD5:loc_40418Bo
; char aIncludeSubkeys[]
aIncludeSubkeys	db 'include-subkeys',0  ; DATA XREF: sub_403CD5:loc_4041CEo
; char aCheckCert[]
aCheckCert	db 'check-cert',0       ; DATA XREF: sub_403CD5:loc_404211o
; char aDebug[]
aDebug		db 'debug',0            ; DATA XREF: sub_403CD5+587o
; char aTimeout[]
aTimeout	db 'timeout',0          ; DATA XREF: sub_403CD5+605o
; char aCaCertFile[]
aCaCertFile	db 'ca-cert-file',0     ; DATA XREF: sub_403CD5+683o
aUnknown	db 'UNKNOWN',0          ; DATA XREF: sub_4043E0:loc_4043F8o
aGet_0		db 'GET',0              ; DATA XREF: sub_4043E0:loc_4043FFo
aGetname_0	db 'GETNAME',0          ; DATA XREF: sub_4043E0:loc_404406o
aSend_0		db 'SEND',0             ; DATA XREF: sub_4043E0:loc_40440Do
aSearch_1	db 'SEARCH',0           ; DATA XREF: sub_4043E0:loc_404414o
a?		db '?',0                ; DATA XREF: sub_4043E0:loc_40441Bo
off_40E844	dd offset loc_4043F8	; DATA XREF: sub_4043E0+Fo
		dd offset loc_4043FF	; jump table for switch	statement
		dd offset loc_404406
		dd offset loc_40440D
		dd offset loc_404414
; char Control[]
Control		db 'abcdefABCDEF1234567890x',0 ; DATA XREF: sub_40445C+C1o
					; sub_40445C+115o
off_40E870	dd offset loc_404483	; DATA XREF: sub_40445C+1Er
		dd offset loc_40459A	; jump table for switch	statement
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_4044DF
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_4044B1
		dd offset loc_40449A
		dd offset loc_40459A
		dd offset loc_40459A
		dd offset loc_4044C8
byte_40E8CC	db 41h			; DATA XREF: sub_4045E4+7Er
					; sub_4045E4+C1r ...
aBcdefghijklmno	db 'BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',0
		align 10h
aBeginPgpPublic	db '-----BEGIN PGP PUBLIC KEY BLOCK-----',0Ah ; DATA XREF: sub_404779+4Fo
		db 0Ah,0
		align 4
aBeginPgpPubl_0	db '-----BEGIN PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: sub_404779+75o
					; sub_404779+149o
		align 10h
aEndPgpPublicKe	db '-----END PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: sub_404779+132o
		align 4
aEndPgpPublic_0	db 0Ah			; DATA XREF: sub_404955+175o
		db '-----END PGP PUBLIC KEY BLOCK-----',0
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating enough memory: %s',0Ah,0 ; DATA XREF: sub_404CD0+17o
asc_40E9CC	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:0040528Ao
					; .text:00405322o
a_		db '.',0                ; DATA XREF: .text:0040540Fo
		align 4
a____Gnupg22_0_	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_405476+A0o
; char VarName[]
VarName		db 'HOME',0             ; DATA XREF: sub_405476:loc_405597o
; char aX02x[]
aX02x		db 'x%02x',0            ; DATA XREF: sub_405A2B+164o
					; .text:00405F8Fo
; char word_40EA06[]
word_40EA06	dw 0			; DATA XREF: sub_406863+Co
					; .text:004068AEo
aFatalTooManyAr	db 0Ah			; DATA XREF: .text:004068F8o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: .text:00406923o
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_405476+90o
		align 4
asc_40EA58	db '-',0                ; DATA XREF: sub_40698D+55o
					; sub_406BEC:loc_406BFDo
aSocket		db 'socket://',0        ; DATA XREF: sub_40698D+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_40698D+FDo
; char aA[]
aA		db 'a',0                ; DATA XREF: sub_40698D+131o
					; sub_40698D:loc_406AFDo
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40698D+1B1o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_40698D+1E9o
		align 4
; char a____Gnupg22__0[]
a____Gnupg22__0	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_406DAE+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_406DAE+37o
		align 4
; char a04d02d02d02d02[]
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_406DAE+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_406DAE+16Bo
; char aU[]
aU		db '[%u]',0             ; DATA XREF: sub_406DAE+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_406DAE+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_406DAE+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_406DAE+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_406DAE:loc_407040o
		align 4
off_40EB88	dd offset loc_40705F	; DATA XREF: sub_406DAE+20Eo
		dd offset loc_40705F	; jump table for switch	statement
		dd offset loc_40705F
		dd offset loc_40705F
		dd offset loc_40705F
		dd offset loc_406FC5
		dd offset loc_406FEE
		dd offset loc_407017
dword_40EBA8	dd 207325h		; DATA XREF: .text:004072B9o
a02x		db '%02X',0             ; DATA XREF: .text:004072DEo
a02x_0		db ' %02X',0            ; DATA XREF: .text:00407301o
asc_40EBB7	db 0Ah,0		; DATA XREF: .text:00407326o
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_407334+1Bo
		align 4
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_407368+D9o
					; .text:loc_40763Co ...
aUtf8		db 'utf-8',0            ; DATA XREF: sub_407368+22o
					; .text:00407676o ...
		align 4
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_407368+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_407368+B1o
aCpU		db 'CP%u',0             ; DATA XREF: .text:loc_407492o
aCp936		db 'CP936',0            ; DATA XREF: .text:004074B5o
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: .text:004075A3o
a88591		db '8859-1',0           ; DATA XREF: .text:004075E0o
a646		db '646',0              ; DATA XREF: .text:004075F7o
aAscii		db 'ASCII',0            ; DATA XREF: .text:0040760Eo
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: .text:00407625o
aUtf8_0		db 'utf8',0             ; DATA XREF: .text:loc_40765Fo
		align 10h
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_40777D+1EEo
					; sub_4079C9+730o
; char aX02x_0[]
aX02x_0		db '\x%02x',0           ; DATA XREF: sub_4079C9+7Co
					; sub_4079C9+3AFo ...
; char aX02x_1[]
aX02x_1		db 'x%02x',0            ; DATA XREF: sub_4079C9+1DCo
		align 4
a____Gnupg22__1	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_4079C9+6BEo
		align 10h
off_40EDD0	dd offset loc_407B7C	; DATA XREF: sub_4079C9+12Ar
		dd offset loc_407B92	; jump table for switch	statement
		dd offset loc_407B92
		dd offset loc_407B92
		dd offset loc_407B92
		dd offset loc_407B92
		dd offset loc_407B92
		dd offset loc_407B92
		dd offset loc_407B66
		dd offset loc_407B92
		dd offset loc_407AFC
		dd offset loc_407B50
		dd offset loc_407B36
		dd offset loc_407B19
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_4079C9+6AEo
		align 4
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: sub_408224+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_408224:loc_408277o
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_408224:loc_4082E2o
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_408224:loc_4082ECo
aAm_et		db 'am_ET',0            ; DATA XREF: sub_408224:loc_4082F6o
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_408224:loc_408319o
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_408224:loc_408323o
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_408224:loc_40832Do
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_408224:loc_408337o
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_408224:loc_408341o
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_408224:loc_40834Bo
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_408224:loc_408355o
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_408224:loc_40835Fo
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_408224:loc_408369o
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_408224:loc_408373o
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_408224:loc_40837Do
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_408224:loc_408387o
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_408224:loc_408391o
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_408224:loc_40839Bo
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_408224:loc_4083A5o
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_408224:loc_4083AFo
aAr		db 'ar',0               ; DATA XREF: sub_408224:loc_4083B9o
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_408224:loc_4083C3o
aAs_in		db 'as_IN',0            ; DATA XREF: sub_408224:loc_4083CDo
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_408224:loc_4083E6o
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_408224:loc_4083F0o
aAz		db 'az',0               ; DATA XREF: sub_408224:loc_4083FAo
aEu		db 'eu',0               ; DATA XREF: sub_408224:loc_408404o
aBe_by		db 'be_BY',0            ; DATA XREF: sub_408224:loc_40840Eo
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_408224:loc_408427o
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_408224:loc_408431o
aBn		db 'bn',0               ; DATA XREF: sub_408224:loc_40843Bo
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_408224:loc_408445o
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_408224:loc_40844Fo
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_408224:loc_408459o
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_408224:loc_408463o
aChr_us		db 'chr_US',0           ; DATA XREF: sub_408224:loc_40846Do
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_408224:loc_40848Co
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_408224:loc_408496o
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_408224:loc_4084A0o
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_408224:loc_4084AAo
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_408224:loc_4084B4o
aZh		db 'zh',0               ; DATA XREF: sub_408224:loc_4084BEo
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_408224+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_408224:loc_4084E4o
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_408224:loc_4084EEo
aHr		db 'hr',0               ; DATA XREF: sub_408224:loc_4084F8o
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_408224:loc_408502o
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_408224:loc_40850Co
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_408224:loc_408516o
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_408224:loc_40852Fo
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_408224:loc_408539o
aNl		db 'nl',0               ; DATA XREF: sub_408224:loc_408543o
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_408224:loc_40854Do
aEn_us		db 'en_US',0            ; DATA XREF: sub_408224:loc_408570o
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_408224:loc_40857Ao
aEn_au		db 'en_AU',0            ; DATA XREF: sub_408224:loc_408584o
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_408224:loc_40858Eo
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_408224:loc_408598o
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_408224:loc_4085A2o
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_408224:loc_4085ACo
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_408224:loc_4085B6o
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_408224:loc_4085C0o
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_408224:loc_4085CAo
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_408224:loc_4085D4o
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_408224:loc_4085DEo
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_408224:loc_4085E8o
aEn_id		db 'en_ID',0            ; DATA XREF: sub_408224:loc_4085F2o
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_408224:loc_4085FCo
aEn_in		db 'en_IN',0            ; DATA XREF: sub_408224:loc_408606o
aEn_my		db 'en_MY',0            ; DATA XREF: sub_408224:loc_408610o
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_408224:loc_40861Ao
aEn		db 'en',0               ; DATA XREF: sub_408224:loc_408624o
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_408224:loc_40862Eo
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_408224:loc_408638o
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_408224:loc_408642o
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_408224:loc_40864Co
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_408224:loc_40866Fo
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_408224:loc_408679o
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_408224:loc_408683o
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_408224:loc_40868Do
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_408224:loc_408697o
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_408224:loc_4086A1o
aFr		db 'fr',0               ; DATA XREF: sub_408224:loc_4086ABo
					; sub_408224:loc_408705o
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_408224:loc_4086B5o
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_408224:loc_4086BFo
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_408224:loc_4086C9o
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_408224:loc_4086D3o
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_408224:loc_4086DDo
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_408224:loc_4086E7o
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_408224:loc_4086F1o
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_408224:loc_4086FBo
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_408224:loc_40870Fo
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_408224:loc_408719o
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_408224:loc_408732o
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_408224:loc_40873Co
aC		db 'C',0                ; DATA XREF: sub_408224:loc_408746o
					; sub_408224:loc_408D64o
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_408224:loc_408750o
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_408224:loc_40875Ao
aDe_de		db 'de_DE',0            ; DATA XREF: sub_408224:loc_408779o
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_408224:loc_408783o
aDe_at		db 'de_AT',0            ; DATA XREF: sub_408224:loc_40878Do
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_408224:loc_408797o
aDe_li		db 'de_LI',0            ; DATA XREF: sub_408224:loc_4087A1o
aDe		db 'de',0               ; DATA XREF: sub_408224:loc_4087ABo
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_408224:loc_4087B5o
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_408224:loc_4087BFo
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_408224:loc_4087C9o
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_408224:loc_4087D3o
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_408224:loc_4087DDo
aHe_il		db 'he_IL',0            ; DATA XREF: sub_408224:loc_4087E7o
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_408224:loc_4087F1o
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_408224:loc_4087FBo
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_408224:loc_408805o
aIs_is		db 'is_IS',0            ; DATA XREF: sub_408224:loc_40880Fo
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_408224:loc_408819o
aId_id		db 'id_ID',0            ; DATA XREF: sub_408224:loc_408823o
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_408224:loc_40882Do
aIt_it		db 'it_IT',0            ; DATA XREF: sub_408224:loc_408846o
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_408224:loc_408850o
aIt		db 'it',0               ; DATA XREF: sub_408224:loc_40885Ao
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_408224:loc_408864o
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_408224:loc_40886Eo
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_408224:loc_408878o
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_408224:loc_408891o
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_408224:loc_40889Bo
aKs		db 'ks',0               ; DATA XREF: sub_408224:loc_4088A5o
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_408224:loc_4088AFo
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_408224:loc_4088B9o
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_408224:loc_4088C3o
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_408224:loc_4088CDo
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_408224:loc_4088D7o
aLa_va		db 'la_VA',0            ; DATA XREF: sub_408224:loc_4088E1o
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_408224:loc_4088EBo
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_408224:loc_4088F5o
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_408224:loc_4088FFo
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_408224:loc_408918o
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_408224:loc_408922o
aMs		db 'ms',0               ; DATA XREF: sub_408224:loc_40892Co
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_408224:loc_408936o
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_408224:loc_408940o
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_408224:loc_40894Ao
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_408224:loc_408954o
aMn		db 'mn',0               ; DATA XREF: sub_408224:loc_40895Eo
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_408224:loc_408977o
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_408224:loc_408981o
aNe		db 'ne',0               ; DATA XREF: sub_408224:loc_40898Bo
aNo_no		db 'no_NO',0            ; DATA XREF: sub_408224:loc_4089A4o
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_408224:loc_4089AEo
aNo_1		db 'no',0               ; DATA XREF: sub_408224:loc_4089B8o
aOr_in		db 'or_IN',0            ; DATA XREF: sub_408224:loc_4089C2o
aOm_et		db 'om_ET',0            ; DATA XREF: sub_408224:loc_4089CCo
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_408224:loc_4089D6o
aPs		db 'ps',0               ; DATA XREF: sub_408224:loc_4089E0o
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_408224:loc_4089EAo
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_408224+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_408224:loc_408A0Bo
aPt		db 'pt',0               ; DATA XREF: sub_408224:loc_408A15o
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_408224+803o
aPa		db 'pa',0               ; DATA XREF: sub_408224:loc_408A31o
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_408224:loc_408A3Bo
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_408224+829o
aRo		db 'ro',0               ; DATA XREF: sub_408224:loc_408A57o
aRu		db 'ru',0               ; DATA XREF: sub_408224:loc_408A61o
aSe_no		db 'se_NO',0            ; DATA XREF: sub_408224:loc_408A6Bo
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_408224:loc_408A75o
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_408224:loc_408A8Do
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_408224:loc_408A97o
aSd		db 'sd',0               ; DATA XREF: sub_408224:loc_408AA1o
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_408224:loc_408AABo
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_408224:loc_408AB5o
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_408224:loc_408ABFo
aSo_so		db 'so_SO',0            ; DATA XREF: sub_408224:loc_408AC9o
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_408224:loc_408AD3o
aEs_es		db 'es_ES',0            ; DATA XREF: sub_408224:loc_408AF6o
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_408224:loc_408B00o
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_408224:loc_408B0Ao
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_408224:loc_408B14o
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_408224:loc_408B1Eo
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_408224:loc_408B28o
aEs_do		db 'es_DO',0            ; DATA XREF: sub_408224:loc_408B32o
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_408224:loc_408B3Co
aEs_co		db 'es_CO',0            ; DATA XREF: sub_408224:loc_408B46o
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_408224:loc_408B50o
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_408224:loc_408B5Ao
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_408224:loc_408B64o
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_408224:loc_408B6Eo
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_408224:loc_408B78o
aEs_py		db 'es_PY',0            ; DATA XREF: sub_408224:loc_408B82o
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_408224:loc_408B8Co
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_408224:loc_408B96o
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_408224:loc_408BA0o
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_408224:loc_408BAAo
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_408224:loc_408BB4o
aEs		db 'es',0               ; DATA XREF: sub_408224:loc_408BBEo
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_408224:loc_408BC8o
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_408224:loc_408BD2o
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_408224:loc_408BEBo
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_408224:loc_408BF5o
aSv		db 'sv',0               ; DATA XREF: sub_408224:loc_408BFFo
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_408224:loc_408C09o
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_408224:loc_408C13o
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_408224:loc_408C1Do
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_408224:loc_408C36o
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_408224:loc_408C40o
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_408224:loc_408C4Ao
aTa		db 'ta',0               ; DATA XREF: sub_408224:loc_408C54o
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_408224:loc_408C5Eo
aTe_in		db 'te_IN',0            ; DATA XREF: sub_408224:loc_408C68o
aTh_th		db 'th_TH',0            ; DATA XREF: sub_408224:loc_408C72o
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_408224:loc_408C7Co
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_408224:loc_408C94o
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_408224:loc_408C9Eo
aTi		db 'ti',0               ; DATA XREF: sub_408224:loc_408CA8o
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_408224:loc_408CB2o
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_408224:loc_408CBCo
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_408224:loc_408CC6o
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_408224:loc_408CD0o
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_408224:loc_408CDAo
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_408224:loc_408CF3o
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_408224:loc_408CFAo
aUr		db 'ur',0               ; DATA XREF: sub_408224:loc_408D01o
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_408224:loc_408D17o
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_408224:loc_408D1Eo
aUz		db 'uz',0               ; DATA XREF: sub_408224:loc_408D25o
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_408224:loc_408D2Co
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_408224:loc_408D33o
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_408224:loc_408D3Ao
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_408224:loc_408D41o
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_408224:loc_408D48o
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_408224:loc_408D4Fo
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_408224:loc_408D56o
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_408224:loc_408D5Do
		align 4
off_40F384	dd offset loc_408D64, offset loc_408300, offset	loc_408445
					; DATA XREF: sub_408224+B5o
		dd offset loc_408463, offset loc_408477, offset	loc_408502 ; jump table	for switch statement
		dd offset loc_40850C, offset loc_408764, offset	loc_4087B5
		dd offset loc_408557, offset loc_408ADD, offset	loc_40864C
		dd offset loc_408656, offset loc_4087E7, offset	loc_4087FB
		dd offset loc_40880F, offset loc_408837, offset	loc_408864
		dd offset loc_4088C3, offset loc_408520, offset	loc_408995
		dd offset loc_4089EA, offset loc_4089F4, offset	loc_408A3B
		dd offset loc_408A45, offset loc_408A61, offset	loc_4084C8
		dd offset loc_408AB5, offset loc_4082EC, offset	loc_408BDC
		dd offset loc_408C72, offset loc_408CC6, offset	loc_408CE4
		dd offset loc_408823, offset loc_408CDA, offset	loc_40840E
		dd offset loc_408ABF, offset loc_40862E, offset	loc_4088EB
		dd offset loc_4088F5, offset loc_408C1D, offset	loc_408642
		dd offset loc_408D33, offset loc_4083C3, offset	loc_4083D7
		dd offset loc_408404, offset loc_408AD3, offset	loc_4088FF
		dd offset loc_408BC8, offset loc_408CB2, offset	loc_408CBC
		dd offset loc_408D2C, offset loc_408D41, offset	loc_408D5D
		dd offset loc_4082E2, offset loc_40875A, offset	loc_408638
		dd offset loc_4087F1, offset loc_408940, offset	loc_408A6B
		dd offset loc_408723, offset loc_408D4F, offset	loc_408909
		dd offset loc_4088AF, offset loc_4088CD, offset	loc_408BD2
		dd offset loc_408CD0, offset loc_408D08, offset	loc_408C5E
		dd offset loc_408418, offset loc_408A1F, offset	loc_4087C9
		dd offset loc_4089C2, offset loc_408C54, offset	loc_408C68
		dd offset loc_40886E, offset loc_408936, offset	loc_4083CD
		dd offset loc_408954, offset loc_408A75, offset	loc_40895E
		dd offset loc_408C7C, offset loc_408D3A, offset	loc_408459
		dd offset loc_4088D7, offset loc_40844F, offset	loc_408750
		dd offset loc_4088B9, offset loc_40894A, offset	loc_408A7F
		dd offset loc_408C09, offset loc_408AAB, offset	loc_40846D
		dd offset loc_40882D, offset loc_4082F6, offset	loc_408C27
		dd offset loc_408882, offset loc_408968, offset	loc_40870F
		dd offset loc_4089E0, offset loc_408C13, offset	loc_408516
		dd offset loc_40854D, offset loc_408719, offset	loc_4087D3
		dd offset loc_408805, offset loc_408D56, offset	loc_408D64
		dd offset loc_408D64, offset loc_408D64, offset	loc_408D64
		dd offset loc_408D64, offset loc_408819, offset	loc_408878
		dd offset loc_4089CC, offset loc_408C86, offset	loc_4087BF
		dd offset loc_4087DD, offset loc_4088E1, offset	loc_408AC9
		dd offset loc_408D48, offset loc_4089D6
off_40F56C	dd offset loc_4083B9	; DATA XREF: sub_408224+ECo
		dd offset loc_408319	; jump table for switch	statement
		dd offset loc_408323
		dd offset loc_40832D
		dd offset loc_408337
		dd offset loc_408341
		dd offset loc_40834B
		dd offset loc_408355
		dd offset loc_40835F
		dd offset loc_408369
		dd offset loc_408373
		dd offset loc_40837D
		dd offset loc_408387
		dd offset loc_408391
		dd offset loc_40839B
		dd offset loc_4083A5
		dd offset loc_4083AF
off_40F5B0	dd offset loc_4084BE	; DATA XREF: sub_408224+25Fo
		dd offset loc_40848C	; jump table for switch	statement
		dd offset loc_408496
		dd offset loc_4084A0
		dd offset loc_4084AA
		dd offset loc_4084B4
off_40F5C8	dd offset loc_408624	; DATA XREF: sub_408224+343o
		dd offset loc_408570	; jump table for switch	statement
		dd offset loc_40857A
		dd offset loc_408584
		dd offset loc_40858E
		dd offset loc_408598
		dd offset loc_4085A2
		dd offset loc_4085AC
		dd offset loc_4085B6
		dd offset loc_4085C0
		dd offset loc_4085CA
		dd offset loc_4085D4
		dd offset loc_4085DE
		dd offset loc_4085E8
		dd offset loc_4085F2
		dd offset loc_4085FC
		dd offset loc_408606
		dd offset loc_408610
		dd offset loc_40861A
off_40F614	dd offset loc_408705	; DATA XREF: sub_408224+442o
		dd offset loc_40866F	; jump table for switch	statement
		dd offset loc_408679
		dd offset loc_408683
		dd offset loc_40868D
		dd offset loc_408697
		dd offset loc_4086A1
		dd offset loc_4086AB
		dd offset loc_4086B5
		dd offset loc_4086BF
		dd offset loc_4086C9
		dd offset loc_4086D3
		dd offset loc_4086DD
		dd offset loc_4086E7
		dd offset loc_4086F1
		dd offset loc_4086FB
off_40F654	dd offset loc_4087AB	; DATA XREF: sub_408224+54Co
		dd offset loc_408779	; jump table for switch	statement
		dd offset loc_408783
		dd offset loc_40878D
		dd offset loc_408797
		dd offset loc_4087A1
off_40F66C	dd offset loc_408BBE	; DATA XREF: sub_408224+8C9o
		dd offset loc_408AF6	; jump table for switch	statement
		dd offset loc_408B00
		dd offset loc_408B0A
		dd offset loc_408B14
		dd offset loc_408B1E
		dd offset loc_408B28
		dd offset loc_408B32
		dd offset loc_408B3C
		dd offset loc_408B46
		dd offset loc_408B50
		dd offset loc_408B5A
		dd offset loc_408B64
		dd offset loc_408B6E
		dd offset loc_408B78
		dd offset loc_408B82
		dd offset loc_408B8C
		dd offset loc_408B96
		dd offset loc_408BA0
		dd offset loc_408BAA
		dd offset loc_408BB4
; char aRb[3]
aRb		db 'rb',0               ; DATA XREF: sub_408E4A+16o
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: .text:00409404o
					; .text:00409D41o
aLc_messages_0	db '\LC_MESSAGES\',0    ; DATA XREF: .text:00409598o
a_mo		db '.mo',0              ; DATA XREF: .text:004095F0o
		align 4
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_409648+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_4096AE+13Do
					; sub_4096AE:loc_409911o
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_4096AE:loc_409985o
byte_40F743	db 0			; DATA XREF: .text:loc_409D5Bo
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_40F780	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_40A270+3o
		align 4
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_40A270+39o
		align 10h
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_40F8A0o
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0040F8A4o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0040F8A8o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0040F8ACo
		align 4
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0040F8B0o
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0040F8B4o
		align 10h
off_40F8A0	dd offset aArgumentDomain ; DATA XREF: sub_40A270+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_40A2E0+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_40A340+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_40A340+1F9o
					; sub_40A340+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_40A340+1D2o
		align 10h
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_40A580+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_40A580+1B7o
		align 10h
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_40AB30:loc_40ABD0o
		unicode	0, <msvcrt.dll>,0
		align 4
off_40F9C8	dd offset dword_410840	; DATA XREF: .text:0040ADC8o
		dd offset dword_410560
		align 20h
; char aS_0[]
aS_0		db '%s: ',0             ; DATA XREF: sub_40B190+11o
; char aPosixly_correc[]
aPosixly_correc	db 'POSIXLY_CORRECT',0  ; DATA XREF: sub_40B550:loc_40B790o
byte_40F9F5	db 0			; DATA XREF: sub_40B550+A6o
					; sub_40B550:loc_40B780o ...
; char aUnknownOptionC[]
aUnknownOptionC	db 'unknown option -- %c',0 ; DATA XREF: sub_40B550+488o
		align 20h
; char aOptionRequir_0[]
aOptionRequir_0	db 'option requires an argument -- %c',0 ; DATA XREF: sub_40B550+42Ao
					; sub_40B550+57Do
; char aAmbiguousOptio[]
aAmbiguousOptio	db 'ambiguous option -- %.*s',0 ; DATA XREF: sub_40B200+147o
		align 10h
; char aOptionDoesnTTa[]
aOptionDoesnTTa	db 'option doesn',27h,'t take an argument -- %.*s',0
					; DATA XREF: sub_40B200+1DDo
		align 20h
; char aOptionRequires[]
aOptionRequires	db 'option requires an argument -- %s',0 ; DATA XREF: sub_40B200+2BAo
; char aUnknownOptionS[]
aUnknownOptionS	db 'unknown option -- %s',0 ; DATA XREF: sub_40B200+269o
		align 10h
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_40BBC0+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_1[]
aS_1		db '%s',0Ah,0           ; DATA XREF: sub_40BBC0+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_40BBC0+10Fo
		align 10h
dword_40FB40	dd 0			; DATA XREF: sub_40A580+59o
					; sub_40A580+5Eo ...
dword_40FB44	dd 0			; DATA XREF: sub_40A580+7Fr
dword_40FB48	dd 0			; DATA XREF: sub_40A580:loc_40A6CCr
dword_40FB4C	dd 2Dh dup(0)		; DATA XREF: sub_40A580+155o
		align 800h
_rdata		ends

; Section 4. (virtual address 00010000)
; Virtual size			: 00000904 (   2308.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 410000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_410000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_410004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_410008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_41000C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_410010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_410014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_410018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_41001C	dd ?			; DATA XREF: sub_401010+3Aw
; FILE *File
File		dd ?			; DATA XREF: sub_401700:loc_4017A3r
					; sub_401700:loc_401931r ...
; FILE *dword_410024
dword_410024	dd ?			; DATA XREF: sub_401700+545r
					; sub_401700+590r ...
; FILE *dword_410028
dword_410028	dd ?			; DATA XREF: sub_401700+1B0r
					; sub_401700+263r ...
dword_41002C	dd ?			; DATA XREF: sub_401700+468r
					; sub_401700+48Fr ...
; void *dword_410030
dword_410030	dd ?			; DATA XREF: sub_401700+395r
					; sub_401700+401r ...
		align 10h
dword_410040	dd 40h dup(?)		; DATA XREF: sub_401700+515o
					; sub_401CC0+335o ...
; char *Source
Source		dd ?			; DATA XREF: sub_401700:loc_401A45r
					; sub_401CC0:loc_401DBDr ...
; char *dword_410144
dword_410144	dd ?			; DATA XREF: sub_401700+3EAr
					; sub_401CC0+1A2r ...
dword_410148	dd ?			; DATA XREF: sub_4015C8+6r
					; sub_4015C8:loc_4015F1w
dword_41014C	dd ?			; DATA XREF: sub_4015C8+1Fw
					; sub_4015C8:loc_4015FBr
		align 20h
dword_410160	dd ?			; DATA XREF: .text:00403B9Ar
					; .text:00403BBCw
		align 20h
dword_410180	dd 68h dup(?)		; DATA XREF: .text:00403BA3o
dword_410320	dd 40h dup(?)		; DATA XREF: .text:0040603Fo
					; .text:0040606Co
; FILE *dword_410420
dword_410420	dd ?			; DATA XREF: sub_40698D+8r
					; sub_40698D+19r ...
		align 20h
; char byte_410440[79]
byte_410440	db 4Fh dup(?)		; DATA XREF: .text:00406C57o
					; .text:loc_406D0Co ...
byte_41048F	db ?			; DATA XREF: .text:00406C63w
dword_410490	dd ?			; DATA XREF: .text:00406C7Bw
					; .text:loc_406CC4r ...
dword_410494	dd ?			; DATA XREF: .text:00406C70w
					; .text:00406CACr ...
dword_410498	dd ?			; DATA XREF: .text:00406C86w
					; .text:loc_406CDCr ...
dword_41049C	dd ?			; DATA XREF: .text:00406C35w
					; sub_406DAE:loc_406F00r ...
dword_4104A0	dd ?			; DATA XREF: .text:00406C93w
					; .text:loc_406CF4r
dword_4104A4	dd ?			; DATA XREF: sub_40698D+249w
					; sub_406DAE+88r ...
dword_4104A8	dd ?			; DATA XREF: sub_40698D+24Ew
					; sub_406DAE:loc_406DF1r ...
dword_4104AC	dd ?			; DATA XREF: .text:0040695Er
					; .text:0040696Cw ...
		align 20h
dword_4104C0	dd ?			; DATA XREF: sub_407368+E3w
					; .text:00407646w ...
dword_4104C4	dd ?			; DATA XREF: sub_407368+EDw
					; .text:00407650w ...
dword_4104C8	dd ?			; DATA XREF: sub_4079C9+70Er
					; sub_4079C9:loc_40811Dw
dword_4104CC	dd ?			; DATA XREF: sub_40777D+1CCr
					; sub_40777D:loc_40798Fw
dword_4104D0	dd 8 dup(?)		; DATA XREF: .text:004074A2o
					; .text:004074AEo ...
dword_4104F0	dd ?			; DATA XREF: sub_407368+45r
					; sub_407368+4Dw
dword_4104F4	dd ?			; DATA XREF: sub_407368:loc_4073C1r
					; sub_407368+61w
dword_4104F8	dd ?			; DATA XREF: sub_407368:loc_4073FDr
					; sub_407368:loc_407431w
dword_4104FC	dd ?			; DATA XREF: .text:00409620r
					; .text:00409629r ...
dword_410500	dd ?			; DATA XREF: sub_4096AE+7r
					; .text:00409D68w
dword_410504	dd ?			; DATA XREF: sub_401010+3r
dword_410508	dd ?			; DATA XREF: sub_401010+25r
dword_41050C	dd ?			; DATA XREF: sub_401060+22w
dword_410510	dd ?			; DATA XREF: sub_401060+18w
dword_410514	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_410520	dd ?			; DATA XREF: sub_401060+2Cw
dword_410524	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_410528	dd ?			; DATA XREF: sub_401060+5Er
dword_41052C	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_40A0ECr
dword_410530	dd ?			; DATA XREF: .text:0040A213r
					; sub_40A260+4w
dword_410534	dd ?			; DATA XREF: sub_40A580+9r
					; sub_40A580:loc_40A5A0w
dword_410538	dd ?			; DATA XREF: sub_40A340+1Dr
					; sub_40A340+58r ...
dword_41053C	dd ?			; DATA XREF: sub_40A340+Br
					; sub_40A340:loc_40A3FFw ...
dword_410540	dd ?			; DATA XREF: sub_40AB30+4r
					; sub_40AB30+92w ...
dword_410544	dd ?			; DATA XREF: sub_40AC80r
					; sub_40AC80:loc_40AC90w
		align 20h
dword_410560	dd 2Bh dup(?)		; DATA XREF: .rdata:0040F9CCo
dword_41060C	dd ?			; DATA XREF: .text:0040ADAAw
		dd 2 dup(?)
dword_410618	dd ?			; DATA XREF: .text:0040AD96w
		dd 2 dup(?)
dword_410624	dd ?			; DATA XREF: .text:0040AD7Cw
		dd 86h dup(?)
dword_410840	dd ?			; DATA XREF: .text:0040AD82w
					; .rdata:off_40F9C8o
dword_410844	dd ?			; DATA XREF: .text:0040AD8Cw
		dd ?
dword_41084C	dd ?			; DATA XREF: .text:0040AD9Bw
		dd 14h dup(?)
dword_4108A0	dd ?			; DATA XREF: .text:0040AE73r
					; .text:0040AF04r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_40AE00+7o
					; sub_40AE00:loc_40AE55o ...
dword_4108BC	dd ?			; DATA XREF: sub_40AE00+14r
					; .text:0040AEC8r ...
		dd ?
dword_4108C4	dd ?			; DATA XREF: sub_401180+1A8w
dword_4108C8	dd ?			; DATA XREF: sub_401180+1BFw
dword_4108CC	dd ?			; DATA XREF: sub_401180+1B2w
dword_4108D0	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_409ED3w ...
dword_4108D4	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_4108D8	dd ?			; DATA XREF: TlsCallback_0:loc_409E24w
dword_4108DC	dd ?			; DATA XREF: sub_401060+64w
					; sub_409FA0+3Fr ...
dword_4108E0	dd ?			; DATA XREF: sub_401060+69w
					; sub_409FA0+4r ...
dword_4108E4	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_4108E8	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		dd 4 dup(?)
dword_4108FC	dd ?			; DATA XREF: sub_40B550+3Ar
					; sub_40B550+F8r ...
; char *Filename
Filename	dd ?			; DATA XREF: sub_402A9B+199r
					; sub_402A9B+1C9r ...
		align 800h
_bss		ends

;
; Imports from libcurl-4.dll
;
; Section 5. (virtual address 00011000)
; Virtual size			: 00000CD0 (   3280.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 0000D400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn curl_easy_cleanup:dword ;	CODE XREF: sub_402A9B+104Bp
					; DATA XREF: sub_402A9B+1046r
		extrn curl_easy_getinfo:dword ;	CODE XREF: sub_401CC0+3BFp
					; sub_402232+292p
					; DATA XREF: ...
		extrn curl_easy_init:dword ; CODE XREF:	sub_402A9B+620p
					; DATA XREF: sub_402A9B+61Br
		extrn curl_easy_perform:dword ;	CODE XREF: sub_401700+500p
					; sub_401CC0+320p ...
		extrn curl_easy_setopt:dword ; CODE XREF: sub_401700+483p
					; sub_401700+4A8p ...
		extrn curl_escape:dword	; CODE XREF: sub_401700+2A5p
					; sub_402232+4Fp ...
		extrn curl_free:dword	; CODE XREF: sub_401700+57Dp
					; sub_402232+3B6p ...
		extrn curl_global_init:dword ; CODE XREF: sub_402A9B+619p
					; DATA XREF: sub_402A9B+614r
		extrn curl_slist_append:dword ;	CODE XREF: sub_402A9B+8A5p
					; sub_402A9B+8CFp
					; DATA XREF: ...
		extrn curl_slist_free_all:dword	; CODE XREF: sub_402A9B+1022p
					; sub_402A9B+1033p
					; DATA XREF: ...
		extrn curl_version:dword ; CODE	XREF: sub_402A9B+C6p
					; sub_402A9B+678p
					; DATA XREF: ...

;
; Imports from libiconv-2.dll
;
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from KERNEL32.dll
;
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_40AFA0+44p
					; DATA XREF: sub_40AFA0+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_40AE00+Ep
					; .text:0040AEC2p ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	.text:00406067p
					; DATA XREF: .text:00406062r
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: .text:0040748Dp
					; DATA XREF: .text:00407488r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: .text:0040747Dp
					; DATA XREF: .text:00407478r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:0040ADD8p
					; DATA XREF: .text:0040ADD8r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_40ACA0+6Cp
					; DATA XREF: sub_40ACA0+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_40ACA0+74p
					; DATA XREF: sub_40ACA0+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: .text:00406027p
					; sub_40A340+1CCp ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_40BBC0+C2p
					; DATA XREF: sub_40BBC0+C2r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_40AB30+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_40ACA0+57p
					; DATA XREF: sub_40ACA0+57r
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_408224+7Fp
					; DATA XREF: sub_408224:loc_40829Er
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_40ACA0+7Cp
					; DATA XREF: sub_40ACA0+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_40AFA0+87p
					; DATA XREF: sub_40AFA0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_40AE00+5Cp
					; .text:0040AEE0p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: TlsCallback_0+55p
					; DATA XREF: TlsCallback_0+55r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_40AB30+A7p
					; DATA XREF: sub_40AB30+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_409185+38p
					; sub_409185+D5p
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_40ACA0+8Bp
					; DATA XREF: sub_40ACA0+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0040ADBFp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:0040ADE9p
					; DATA XREF: .text:0040ADE9r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_40AE00+35p
					; DATA XREF: sub_40AE00+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0040ADCFp
					; DATA XREF: .text:0040ADCFr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_40A340+142p
					; sub_40A340+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_40A340+A1p
					; sub_40A340+D9p ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_409287+48p
					; sub_409287+C8p
					; DATA XREF: ...

;
; Imports from msvcrt.dll
;
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr

;
; Imports from msvcrt.dll
;
; char **_argv
		extrn __argv:dword	; DATA XREF: sub_40B190+4r
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_409F70r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_402A9B+1BDp
					; sub_402A9B+263p ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: sub_408E4A+57p
					; DATA XREF: sub_408E4A+52r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_402A9B+6Cr
					; sub_402A9B+11Er ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_409FA0+A3p
					; DATA XREF: sub_409FA0+A3r
; int __cdecl stricmp(const char *Str1,	const char *Str2)
		extrn _stricmp:dword	; CODE XREF: sub_402A9B+4A9p
					; sub_403CD5+58p ...
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: sub_402A9B+3ADp
					; sub_402A9B+3EBp ...
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; char *__cdecl	fgets(char *Buf, int MaxCount, FILE *File)
		extrn __imp_fgets:dword	; DATA XREF: fgetsr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputc(int	Ch, FILE *File)
		extrn __imp_fputc:dword	; DATA XREF: fputcr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: .text:0040513Fp
					; .text:0040515Fp ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_40BEA0r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; int sscanf(const char	*Src, const char *Format, ...)
		extrn __imp_sscanf:dword ; DATA	XREF: sscanfr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; size_t __cdecl strspn(const char *Str, const char *Control)
		extrn __imp_strspn:dword ; DATA	XREF: strspnr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_40BE90r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:00404F19p
					; .text:00404F2Ep ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_40BBC0+122p
					; DATA XREF: sub_40BBC0+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: .text:00403BB7p
					; DATA XREF: .text:00403BB2r


; Section 6. (virtual address 00012000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000E200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 412000h
dword_412000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_412008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_41200C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_409F70
dword_412018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_412030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_409F13o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00013000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000E400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 413000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
