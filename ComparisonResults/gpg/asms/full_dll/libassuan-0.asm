;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	DD1278D91B094B83024D4400D58BDA78
; Input	CRC32 :	79FF365B

; File Name   :	C:\compspace\compare\gpg\dlls\full\libassuan-0.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	65880000
; Section 1. (virtual address 00001000)
; Virtual size			: 0000D5C4 (  54724.)
; Section size in file		: 0000D600 (  54784.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 65881000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_65881000	proc near		; DATA XREF: .CRT:6589500Co

Size		= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	[esp+1Ch+Size],	80h ; Size
		call	malloc
		mov	ebx, eax
		mov	[esp+1Ch+Size],	eax
		call	sub_6588D360
		test	ebx, ebx
		mov	ds:dword_658924AC, eax
		mov	ds:dword_658924A8, eax
		mov	eax, 1
		jz	short loc_65881035
		mov	dword ptr [ebx], 0
		xor	al, al

loc_65881035:				; CODE XREF: sub_65881000+2Bj
		add	esp, 18h
		pop	ebx
		retn
sub_65881000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65881040	proc near		; CODE XREF: sub_65881260+A0p
					; sub_65881260+124p ...

dwMilliseconds	= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	ebx
		sub	esp, 14h
		mov	edx, [esp+1Ch+arg_4]
		test	edx, edx
		jnz	short loc_658810C6
		mov	edx, ds:dword_65892000
		xor	eax, eax
		test	edx, edx
		jle	short loc_658810BE
		sub	edx, 1
		mov	ebx, ds:Sleep
		mov	ds:dword_65892000, edx
		jmp	short loc_6588107C
; ---------------------------------------------------------------------------
		align 10h

loc_65881070:				; CODE XREF: sub_65881040+5Dj
		mov	[esp+1Ch+dwMilliseconds], 3E8h ; dwMilliseconds
		call	ebx ; Sleep
		sub	esp, 4

loc_6588107C:				; CODE XREF: sub_65881040+28j
		mov	[esp+1Ch+var_14], 0
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+dwMilliseconds], offset dword_658924B0
		call	sub_6588E120
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_65881070
		mov	eax, ds:dword_658924B4
		cmp	eax, 2
		jz	loc_65881183
		mov	[esp+1Ch+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, 1

loc_658810BE:				; CODE XREF: sub_65881040+17j
					; sub_65881040+8Ej
		add	esp, 14h
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_658810C6:				; CODE XREF: sub_65881040+Bj
		cmp	edx, 1
		mov	eax, 1
		jnz	short loc_658810BE
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_658810F5
; ---------------------------------------------------------------------------

loc_658810E1:				; CODE XREF: sub_65881040+D2j
		cmp	eax, ebx
		jz	loc_658811F7
		mov	[esp+1Ch+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_658810F5:				; CODE XREF: sub_65881040+9Fj
		mov	[esp+1Ch+var_14], 0
		mov	[esp+1Ch+var_18], ebx
		mov	[esp+1Ch+dwMilliseconds], offset dword_658924B0
		call	sub_6588E120
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_658810E1
		xor	ebx, ebx

loc_65881116:				; CODE XREF: sub_65881040+1BCj
		mov	eax, ds:dword_658924B4
		cmp	eax, 1
		jz	loc_65881224
		mov	eax, ds:dword_658924B4
		test	eax, eax
		jz	loc_65881201

loc_65881131:				; CODE XREF: sub_65881040+1DFj
					; sub_65881040+1F0j
		mov	eax, ds:dword_658924B4
		cmp	eax, 1
		jz	loc_65881235

loc_6588113F:				; CODE XREF: sub_65881040+213j
		test	ebx, ebx
		jnz	short loc_6588114A
		lock xchg ebx, ds:dword_658924B0

loc_6588114A:				; CODE XREF: sub_65881040+101j
		mov	eax, ds:off_65891650
		test	eax, eax
		jz	short loc_6588116F
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], 2
		mov	[esp+1Ch+var_14], edx
		mov	edx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+dwMilliseconds], edx
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_6588116F:				; CODE XREF: sub_65881040+111j
		add	ds:dword_65892000, 1
		add	esp, 14h
		mov	eax, 1
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_65881183:				; CODE XREF: sub_65881040+67j
		mov	eax, ds:dword_658924AC
		mov	[esp+1Ch+dwMilliseconds], eax
		call	sub_6588D350
		test	eax, eax
		mov	ebx, eax
		jz	short loc_658811D7
		mov	eax, ds:dword_658924A8
		mov	[esp+1Ch+dwMilliseconds], eax
		call	sub_6588D350
		mov	esi, eax

loc_658811A5:				; CODE XREF: sub_65881040+170j
		sub	esi, 4
		cmp	ebx, esi
		ja	short loc_658811BB

loc_658811AC:				; CODE XREF: sub_65881040+179j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_658811A5
		sub	esi, 4
		call	eax
		cmp	ebx, esi
		jbe	short loc_658811AC

loc_658811BB:				; CODE XREF: sub_65881040+16Aj
		mov	[esp+1Ch+dwMilliseconds], ebx ;	Memory
		call	free
		mov	ds:dword_658924A8, 0
		mov	ds:dword_658924AC, 0

loc_658811D7:				; CODE XREF: sub_65881040+154j
		mov	ds:dword_658924B4, 0
		xor	eax, eax
		lock xchg eax, ds:dword_658924B0
		add	esp, 14h
		mov	eax, 1
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_658811F7:				; CODE XREF: sub_65881040+A3j
		mov	ebx, 1
		jmp	loc_65881116
; ---------------------------------------------------------------------------

loc_65881201:				; CODE XREF: sub_65881040+EBj
		mov	[esp+1Ch+var_18], offset dword_65895010
		mov	[esp+1Ch+dwMilliseconds], offset dword_65895008
		mov	ds:dword_658924B4, 1
		call	_initterm
		jmp	loc_65881131
; ---------------------------------------------------------------------------

loc_65881224:				; CODE XREF: sub_65881040+DEj
		mov	[esp+1Ch+dwMilliseconds], 1Fh
		call	_amsg_exit
		jmp	loc_65881131
; ---------------------------------------------------------------------------

loc_65881235:				; CODE XREF: sub_65881040+F9j
		mov	[esp+1Ch+var_18], offset dword_65895004
		mov	[esp+1Ch+dwMilliseconds], offset dword_65895000
		call	_initterm
		mov	ds:dword_658924B4, 2
		jmp	loc_6588113F
sub_65881040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_65881260	proc near		; CODE XREF: DllEntryPoint+1Ep

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 2Ch
		test	edx, edx
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, eax
		mov	[esp+2Ch+var_C], esi
		mov	esi, edx
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, ecx
		mov	[esp+2Ch+var_8], edi
		mov	dword_6588F144,	edx
		jnz	loc_65881314
		mov	eax, ds:dword_65892000
		xor	edi, edi
		test	eax, eax
		jz	short loc_658812B9
		call	sub_6588D610
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_6588E140
		sub	esp, 0Ch
		mov	edi, eax

loc_658812B0:				; CODE XREF: sub_65881260+D8j
					; sub_65881260+E1j ...
		cmp	esi, 3
		jz	short loc_658812E0
		test	esi, esi
		jz	short loc_658812E0

loc_658812B9:				; CODE XREF: sub_65881260+30j
					; sub_65881260+B2j ...
		mov	eax, edi
		mov	ebx, [esp+2Ch+var_10]
		mov	dword_6588F144,	0FFFFFFFFh
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_658812E0:				; CODE XREF: sub_65881260+53j
					; sub_65881260+57j
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_6588E150
		sub	esp, 0Ch
		mov	edi, eax
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65881040
		sub	esp, 0Ch
		test	eax, eax
		mov	eax, 0
		cmovz	edi, eax
		jmp	short loc_658812B9
; ---------------------------------------------------------------------------

loc_65881314:				; CODE XREF: sub_65881260+21j
		call	sub_6588D610
		lea	eax, [esi-1]
		cmp	eax, 1
		jbe	short loc_65881391

loc_65881321:				; CODE XREF: sub_65881260+19Aj
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_6588E140
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jnz	loc_658812B0
		cmp	esi, 1
		jnz	loc_658812B0
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_6588E140
		sub	esp, 0Ch
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_6588E150
		sub	esp, 0Ch
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65881040
		sub	esp, 0Ch
		jmp	loc_658812B0
; ---------------------------------------------------------------------------

loc_65881391:				; CODE XREF: sub_65881260+BFj
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65881040
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jz	loc_658812B9
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_6588E150
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jnz	short loc_658813F0
		cmp	esi, 1
		jnz	loc_658812B9
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_65881040
		sub	esp, 0Ch
		jmp	loc_658812B9
; ---------------------------------------------------------------------------
		align 10h

loc_658813F0:				; CODE XREF: sub_65881260+165j
		cmp	esi, 1
		jnz	short loc_658813FF
		call	sub_6588D940
		jmp	loc_65881321
; ---------------------------------------------------------------------------

loc_658813FF:				; CODE XREF: sub_65881260+193j
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 2
		mov	[esp+2Ch+var_2C], ebx
		call	sub_6588E140
		sub	esp, 0Ch
		mov	edi, eax
		jmp	loc_658812B0
sub_65881260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
		public DllEntryPoint
DllEntryPoint	proc near

var_10		= dword	ptr -10h
hinstDLL	= dword	ptr  4
fdwReason	= dword	ptr  8
lpReserved	= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	edx, [esp+1Ch+fdwReason]
		mov	ds:dword_65892118, 0
		cmp	edx, 1
		jz	short loc_65881450

loc_65881436:				; CODE XREF: DllEntryPoint+3Dj
		mov	ecx, [esp+1Ch+lpReserved]
		mov	eax, [esp+1Ch+hinstDLL]
		call	sub_65881260
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_65881450:				; CODE XREF: DllEntryPoint+14j
		mov	[esp+1Ch+var_10], edx
		call	sub_6588D960
		mov	edx, [esp+1Ch+var_10]
		jmp	short loc_65881436
DllEntryPoint	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65881460	proc near		; CODE XREF: sub_6588E590+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_6588F158
		test	eax, eax
		jz	short locret_658814AB
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_6588149E
		mov	[esp+18h+lpProcName], offset ProcName ;	"_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_6588149E:				; CODE XREF: sub_65881460+26j
		test	edx, edx
		jz	short locret_658814AB
		mov	[esp+18h+lpModuleName],	offset dword_6588F158
		call	edx

locret_658814AB:			; CODE XREF: sub_65881460+Dj
					; sub_65881460+40j
		leave
		retn
sub_65881460	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_658814B0()
sub_658814B0	proc near		; DATA XREF: sub_6588E590+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_658814B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658814C0	proc near		; CODE XREF: sub_658814E7+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_658814E0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_658814E5
; ---------------------------------------------------------------------------

loc_658814E0:				; CODE XREF: sub_658814C0+7j
		mov	eax, 0

loc_658814E5:				; CODE XREF: sub_658814C0+1Ej
		pop	ebp
		retn
sub_658814C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658814E7	proc near		; CODE XREF: assuan_new_ext+1D1p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_658814FA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_658814FF
; ---------------------------------------------------------------------------

loc_658814FA:				; CODE XREF: sub_658814E7+Aj
		mov	eax, 0Fh

loc_658814FF:				; CODE XREF: sub_658814E7+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_658814C0
		leave
		retn
sub_658814E7	endp

; Exported entry  49. assuan_set_gpg_err_source

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_gpg_err_source
assuan_set_gpg_err_source proc near

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	dword_6588F000,	eax
		pop	ebp
		retn
assuan_set_gpg_err_source endp

; Exported entry  13. assuan_get_gpg_err_source

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_gpg_err_source
assuan_get_gpg_err_source proc near
		push	ebp
		mov	ebp, esp
		mov	eax, dword_6588F000
		pop	ebp
		retn
assuan_get_gpg_err_source endp

; Exported entry  54. assuan_set_malloc_hooks

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_malloc_hooks
assuan_set_malloc_hooks	proc near

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	off_6588F004, edx
		mov	edx, [eax+4]
		mov	off_6588F008, edx
		mov	eax, [eax+8]
		mov	off_6588F00C, eax
		pop	ebp
		retn
assuan_set_malloc_hooks	endp

; Exported entry  16. assuan_get_malloc_hooks

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_malloc_hooks
assuan_get_malloc_hooks	proc near
		push	ebp
		mov	ebp, esp
		mov	eax, offset off_6588F004
		pop	ebp
		retn
assuan_get_malloc_hooks	endp

; Exported entry  52. assuan_set_log_cb

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_log_cb
assuan_set_log_cb proc near

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	off_6588F010, eax
		mov	eax, [ebp+arg_4]
		mov	ds:dword_65892004, eax
		call	sub_65889AD0
		leave
		retn
assuan_set_log_cb endp

; Exported entry  15. assuan_get_log_cb

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_log_cb
assuan_get_log_cb proc near

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	edx, off_6588F010
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	edx, ds:dword_65892004
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		pop	ebp
		retn
assuan_get_log_cb endp

; Exported entry  57. assuan_set_system_hooks

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_system_hooks
assuan_set_system_hooks	proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_14], eax
		mov	[esp+18h+var_18], offset dword_6588F100
		call	sub_6588234C
		leave
		retn
assuan_set_system_hooks	endp

; Exported entry  26. assuan_new_ext

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_new_ext
assuan_new_ext	proc near		; CODE XREF: assuan_new+31p

var_F68		= dword	ptr -0F68h
var_F64		= dword	ptr -0F64h
var_F60		= dword	ptr -0F60h
var_F5C		= dword	ptr -0F5Ch
var_F58		= dword	ptr -0F58h
var_F54		= dword	ptr -0F54h
var_F50		= dword	ptr -0F50h
var_F4C		= dword	ptr -0F4Ch
var_F48		= dword	ptr -0F48h
var_F44		= dword	ptr -0F44h
var_F40		= dword	ptr -0F40h
var_F3C		= dword	ptr -0F3Ch
var_F38		= dword	ptr -0F38h
var_F34		= dword	ptr -0F34h
var_F20		= dword	ptr -0F20h
var_E1C		= dword	ptr -0E1Ch
var_E18		= dword	ptr -0E18h
var_E14		= dword	ptr -0E14h
var_E10		= dword	ptr -0E10h
var_E0C		= dword	ptr -0E0Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0F5Ch
		lea	eax, [ebp+var_F20]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 3BCh
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_F20], eax
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	[ebp+var_E1C], edx
		mov	edx, [eax+4]
		mov	[ebp+var_E18], edx
		mov	eax, [eax+8]
		mov	[ebp+var_E14], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_E10], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_E0C], eax
		lea	eax, [ebp+var_F20]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_20], 2
		mov	[ebp+var_24], offset aAssuan_new_ext ; "assuan_new_ext"
		mov	[ebp+var_28], offset aR_ctx ; "r_ctx"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	edi, [eax+8]
		mov	eax, [ebp+arg_8]
		mov	esi, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_4]
		mov	[esp+0F68h+var_F68], eax
		call	gpg_strsource
		mov	edx, [ebp+var_20]
		mov	ecx, [ebp+arg_10]
		mov	[esp+0F68h+var_F34], ecx
		mov	ecx, [ebp+arg_C]
		mov	[esp+0F68h+var_F38], ecx
		mov	[esp+0F68h+var_F3C], edi
		mov	[esp+0F68h+var_F40], esi
		mov	[esp+0F68h+var_F44], ebx
		mov	ecx, [ebp+arg_8]
		mov	[esp+0F68h+var_F48], ecx
		mov	[esp+0F68h+var_F4C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0F68h+var_F50], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+0F68h+var_F54], eax
		mov	eax, [ebp+var_28]
		mov	[esp+0F68h+var_F58], eax
		mov	eax, [ebp+var_24]
		mov	[esp+0F68h+var_F5C], eax
		mov	[esp+0F68h+var_F60], offset aSSPEnterErr_so ; "%s (%s=%p): enter: err_source = %i (%s)"...
		mov	[esp+0F68h+var_F64], edx
		mov	eax, [ebp+var_1C]
		mov	[esp+0F68h+var_F68], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	[esp+0F68h+var_F64], 0EF0h
		lea	eax, [ebp+var_F20]
		mov	[esp+0F68h+var_F68], eax
		call	sub_65882268
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	loc_65881780
		call	gpg_err_code_from_syserror
		test	eax, eax
		jnz	short loc_65881707
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_2C]
		mov	[esp+0F68h+var_F54], edx
		mov	edx, [ebp+var_28]
		mov	[esp+0F68h+var_F58], edx
		mov	edx, [ebp+var_24]
		mov	[esp+0F68h+var_F5C], edx
		mov	[esp+0F68h+var_F60], offset aSSPLeave ;	"%s (%s=%p): leave\n"
		mov	[esp+0F68h+var_F64], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0F68h+var_F68], eax
		call	sub_65882E28
		mov	eax, 0
		jmp	short loc_6588177B
; ---------------------------------------------------------------------------

loc_65881707:				; CODE XREF: assuan_new_ext+12Aj
		cmp	[ebp+var_30], 0
		jz	short loc_6588171E
		mov	eax, [ebp+var_30]
		mov	eax, [eax]
		mov	[esp+0F68h+var_F68], eax
		call	gpg_strsource
		mov	ebx, eax
		jmp	short loc_65881723
; ---------------------------------------------------------------------------

loc_6588171E:				; CODE XREF: assuan_new_ext+166j
		mov	ebx, offset byte_658900B7

loc_65881723:				; CODE XREF: assuan_new_ext+177j
		call	gpg_err_code_from_syserror
		mov	[esp+0F68h+var_F68], eax
		call	gpg_strerror
		mov	edx, [ebp+var_20]
		mov	[esp+0F68h+var_F4C], ebx
		mov	[esp+0F68h+var_F50], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+0F68h+var_F54], eax
		mov	eax, [ebp+var_28]
		mov	[esp+0F68h+var_F58], eax
		mov	eax, [ebp+var_24]
		mov	[esp+0F68h+var_F5C], eax
		mov	[esp+0F68h+var_F60], offset aSSPErrorSS	; "%s (%s=%p): error: %s <%s>\n"
		mov	[esp+0F68h+var_F64], edx
		mov	eax, [ebp+var_1C]
		mov	[esp+0F68h+var_F68], eax
		call	sub_65882E28
		call	gpg_err_code_from_syserror
		mov	[esp+0F68h+var_F64], eax
		mov	eax, [ebp+var_30]
		mov	[esp+0F68h+var_F68], eax
		call	sub_658814E7

loc_6588177B:				; CODE XREF: assuan_new_ext+160j
		jmp	loc_65881916
; ---------------------------------------------------------------------------

loc_65881780:				; CODE XREF: assuan_new_ext+11Dj
		lea	edx, [ebp+var_F20]
		mov	eax, [ebp+var_30]
		mov	ebx, 0EF0h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_658817A5
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_658817A5:				; CODE XREF: assuan_new_ext+1F0j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_658817BD
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_658817BD:				; CODE XREF: assuan_new_ext+207j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_658817E5
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_658817E5:				; CODE XREF: assuan_new_ext+233j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_658817F3
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_658817F3:				; CODE XREF: assuan_new_ext+245j
		mov	eax, [ebp+var_30]
		mov	edx, dword_6588F100
		mov	[eax+128h], edx
		mov	edx, off_6588F104
		mov	[eax+12Ch], edx
		mov	edx, off_6588F108
		mov	[eax+130h], edx
		mov	edx, off_6588F10C
		mov	[eax+134h], edx
		mov	edx, off_6588F110
		mov	[eax+138h], edx
		mov	edx, off_6588F114
		mov	[eax+13Ch], edx
		mov	edx, off_6588F118
		mov	[eax+140h], edx
		mov	edx, off_6588F11C
		mov	[eax+144h], edx
		mov	edx, off_6588F120
		mov	[eax+148h], edx
		mov	edx, off_6588F124
		mov	[eax+14Ch], edx
		mov	edx, off_6588F128
		mov	[eax+150h], edx
		mov	edx, off_6588F12C
		mov	[eax+154h], edx
		mov	edx, off_6588F130
		mov	[eax+158h], edx
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax+0EE8h], 0FFFFFFFFh
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax+0EECh], 0FFFFFFFFh
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax+1ACh], 0FFFFFFFFh
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax+998h], 0FFFFFFFFh
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax+0D9Ch], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_30]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_30]
		mov	[esp+0F68h+var_F50], edx
		mov	edx, [ebp+var_2C]
		mov	[esp+0F68h+var_F54], edx
		mov	edx, [ebp+var_28]
		mov	[esp+0F68h+var_F58], edx
		mov	edx, [ebp+var_24]
		mov	[esp+0F68h+var_F5C], edx
		mov	[esp+0F68h+var_F60], offset aSSPLeaveCtxP ; "%s	(%s=%p): leave:	ctx=%p\n"
		mov	[esp+0F68h+var_F64], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0F68h+var_F68], eax
		call	sub_65882E28
		mov	eax, 0

loc_65881916:				; CODE XREF: assuan_new_ext:loc_6588177Bj
		add	esp, 0F5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
assuan_new_ext	endp

; Exported entry  25. assuan_new

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_new
assuan_new	proc near		; CODE XREF: assuan_sock_init+31p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	ecx, ds:dword_65892004
		mov	edx, off_6588F010
		mov	eax, dword_6588F000
		mov	[esp+28h+var_18], ecx
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], offset off_6588F004
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_new_ext
		leave
		retn
assuan_new	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65881959	proc near		; CODE XREF: assuan_release+48p
					; assuan_init_socket_server+26Fp ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+164h]
		test	eax, eax
		jz	short locret_6588198A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+164h]
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+164h], 0

locret_6588198A:			; CODE XREF: sub_65881959+11j
		leave
		retn
sub_65881959	endp

; Exported entry  42. assuan_release

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_release
assuan_release	proc near		; CODE XREF: assuan_sock_deinit+1Ep

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	loc_65881A3D
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset aCtx ;	"ctx"
		mov	[esp+38h+var_2C], offset aAssuan_release ; "assuan_release"
		mov	[esp+38h+var_30], offset aSSPCall ; "%s	(%s=%p): call\n"
		mov	[esp+38h+var_34], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65881959
		mov	eax, [ebp+arg_0]
		add	eax, 1ACh
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 7ECh
		jmp	short loc_658819FB
; ---------------------------------------------------------------------------

loc_658819ED:				; CODE XREF: assuan_release+73j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_658819FB:				; CODE XREF: assuan_release+5Fj
		cmp	[ebp+var_10], 0
		jnz	short loc_658819ED
		mov	eax, [ebp+arg_0]
		add	eax, 998h
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 3FCh
		jmp	short loc_65881A23
; ---------------------------------------------------------------------------

loc_65881A15:				; CODE XREF: assuan_release+9Bj
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		sub	[ebp+var_18], 1

loc_65881A23:				; CODE XREF: assuan_release+87j
		cmp	[ebp+var_18], 0
		jnz	short loc_65881A15
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882313
		jmp	short locret_65881A3E
; ---------------------------------------------------------------------------

loc_65881A3D:				; CODE XREF: assuan_release+Aj
		nop

locret_65881A3E:			; CODE XREF: assuan_release+AFj
		leave
		retn
assuan_release	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65881A40	proc near		; CODE XREF: sub_65881ACB+13p
					; sub_65881ACB+43p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_65881A9C
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_65881A9C
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_65881A9C
		mov	eax, 0
		jmp	short locret_65881AC9
; ---------------------------------------------------------------------------

loc_65881A78:				; CODE XREF: sub_65881A40+6Fj
		mov	edx, [ebp+var_4]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp+var_4], eax
		add	[ebp+arg_0], 1
		jmp	short loc_65881A9D
; ---------------------------------------------------------------------------

loc_65881A9C:				; CODE XREF: sub_65881A40+15j
					; sub_65881A40+22j ...
		nop

loc_65881A9D:				; CODE XREF: sub_65881A40+5Aj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_65881AB1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_65881A78

loc_65881AB1:				; CODE XREF: sub_65881A40+65j
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		cmp	[ebp+var_4], 0
		js	short loc_65881AC4
		mov	eax, [ebp+arg_0]
		jmp	short locret_65881AC9
; ---------------------------------------------------------------------------

loc_65881AC4:				; CODE XREF: sub_65881A40+7Dj
		mov	eax, 0

locret_65881AC9:			; CODE XREF: sub_65881A40+36j
					; sub_65881A40+82j
		leave
		retn
sub_65881A40	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65881ACB	proc near		; CODE XREF: sub_65881B58+3Fp
					; sub_65881B58+72p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_4]
		mov	[esp+8+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65881A40
		mov	[ebp+arg_0], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_65881AF6
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jz	short loc_65881AFD

loc_65881AF6:				; CODE XREF: sub_65881ACB+1Fj
		mov	eax, 0
		jmp	short locret_65881B56
; ---------------------------------------------------------------------------

loc_65881AFD:				; CODE XREF: sub_65881ACB+29j
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_8]
		mov	[esp+8+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65881A40
		mov	[ebp+arg_0], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_65881B26
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jz	short loc_65881B2D

loc_65881B26:				; CODE XREF: sub_65881ACB+4Fj
		mov	eax, 0
		jmp	short locret_65881B56
; ---------------------------------------------------------------------------

loc_65881B2D:				; CODE XREF: sub_65881ACB+59j
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_C]
		mov	[esp+8+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65881A40
		mov	[ebp+arg_0], eax
		cmp	[ebp+arg_0], 0
		jnz	short loc_65881B53
		mov	eax, 0
		jmp	short locret_65881B56
; ---------------------------------------------------------------------------

loc_65881B53:				; CODE XREF: sub_65881ACB+7Fj
		mov	eax, [ebp+arg_0]

locret_65881B56:			; CODE XREF: sub_65881ACB+30j
					; sub_65881ACB+60j ...
		leave
		retn
sub_65881ACB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65881B58	proc near		; CODE XREF: assuan_check_version+14p

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		cmp	[ebp+arg_4], 0
		jnz	short loc_65881B6C
		mov	eax, [ebp+arg_0]
		jmp	locret_65881C43
; ---------------------------------------------------------------------------

loc_65881B6C:				; CODE XREF: sub_65881B58+Aj
		cmp	[ebp+arg_0], 0
		jnz	short loc_65881B7C
		mov	eax, 0
		jmp	locret_65881C43
; ---------------------------------------------------------------------------

loc_65881B7C:				; CODE XREF: sub_65881B58+18j
		lea	eax, [ebp+var_14]
		mov	[esp+30h+var_24], eax
		lea	eax, [ebp+var_10]
		mov	[esp+30h+var_28], eax
		lea	eax, [ebp+var_C]
		mov	[esp+30h+var_2C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+30h+var_30], eax
		call	sub_65881ACB
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_65881BAF
		mov	eax, 0
		jmp	locret_65881C43
; ---------------------------------------------------------------------------

loc_65881BAF:				; CODE XREF: sub_65881B58+4Bj
		lea	eax, [ebp+var_20]
		mov	[esp+30h+var_24], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+30h+var_28], eax
		lea	eax, [ebp+var_18]
		mov	[esp+30h+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+30h+var_30], eax
		call	sub_65881ACB
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jnz	short loc_65881BDF
		mov	eax, 0
		jmp	short locret_65881C43
; ---------------------------------------------------------------------------

loc_65881BDF:				; CODE XREF: sub_65881B58+7Ej
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jg	short loc_65881C39
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jnz	short loc_65881BFD
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jg	short loc_65881C39

loc_65881BFD:				; CODE XREF: sub_65881B58+99j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jnz	short loc_65881C1B
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jnz	short loc_65881C1B
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		cmp	edx, eax
		jg	short loc_65881C39

loc_65881C1B:				; CODE XREF: sub_65881B58+ADj
					; sub_65881B58+B7j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jnz	short loc_65881C3E
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jnz	short loc_65881C3E
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		cmp	edx, eax
		jnz	short loc_65881C3E

loc_65881C39:				; CODE XREF: sub_65881B58+8Fj
					; sub_65881B58+A3j ...
		mov	eax, [ebp+arg_0]
		jmp	short locret_65881C43
; ---------------------------------------------------------------------------

loc_65881C3E:				; CODE XREF: sub_65881B58+CBj
					; sub_65881B58+D5j ...
		mov	eax, 0

locret_65881C43:			; CODE XREF: sub_65881B58+Fj
					; sub_65881B58+1Fj ...
		leave
		retn
sub_65881B58	endp

; Exported entry  92. assuan_check_version

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_check_version
assuan_check_version proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], offset a2_4_2 ; "2.4.2"
		call	sub_65881B58
		leave
		retn
assuan_check_version endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65881C60	proc near		; CODE XREF: sub_65881C87+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_65881C80
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_65881C85
; ---------------------------------------------------------------------------

loc_65881C80:				; CODE XREF: sub_65881C60+7j
		mov	eax, 0

loc_65881C85:				; CODE XREF: sub_65881C60+1Ej
		pop	ebp
		retn
sub_65881C60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65881C87	proc near		; CODE XREF: assuan_get_peercred+4Cp
					; assuan_get_peercred+6Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_65881C9A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_65881C9F
; ---------------------------------------------------------------------------

loc_65881C9A:				; CODE XREF: sub_65881C87+Aj
		mov	eax, 0Fh

loc_65881C9F:				; CODE XREF: sub_65881C87+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_65881C60
		leave
		retn
sub_65881C87	endp

; Exported entry  56. assuan_set_pointer

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_pointer
assuan_set_pointer proc	near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_0	; "ctx"
		mov	[esp+28h+var_1C], offset aAssuan_set_poi ; "assuan_set_pointer"
		mov	[esp+28h+var_20], offset aSSPCallUser_po ; "%s (%s=%p):	call: user_pointer=%p\n"
		mov	[esp+28h+var_24], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		cmp	[ebp+arg_0], 0
		jz	short locret_65881D01
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+118h], edx

locret_65881D01:			; CODE XREF: assuan_set_pointer+43j
		leave
		retn
assuan_set_pointer endp

; Exported entry  20. assuan_get_pointer

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_pointer
assuan_get_pointer proc	near

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jnz	short loc_65881D13
		mov	eax, 0
		jmp	short loc_65881D1C
; ---------------------------------------------------------------------------

loc_65881D13:				; CODE XREF: assuan_get_pointer+7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+118h]

loc_65881D1C:				; CODE XREF: assuan_get_pointer+Ej
		pop	ebp
		retn
assuan_get_pointer endp

; Exported entry  48. assuan_set_flag

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_flag
assuan_set_flag	proc near		; CODE XREF: assuan_begin_confidential+1Cp
					; assuan_end_confidential+1Cp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_0	; "ctx"
		mov	[esp+28h+var_1C], offset aAssuan_set_fla ; "assuan_set_flag"
		mov	[esp+28h+var_20], offset aSSPCallFlagIVa ; "%s (%s=%p):	call: flag=%i,value=%i\n"
		mov	[esp+28h+var_24], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		cmp	[ebp+arg_0], 0
		jz	loc_65881E65
		cmp	[ebp+arg_4], 6	; switch 7 cases
		ja	locret_65881E66	; jumptable 65881D85 default case
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		add	eax, offset off_6589018C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_65881D87:				; CODE XREF: assuan_set_flag+67j
					; DATA XREF: .rdata:off_6589018Co
		mov	eax, [ebp+arg_8] ; jumptable 65881D85 case 1
		mov	edx, eax
		and	edx, 1
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+11Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+11Ch], dl
		jmp	locret_65881E66	; jumptable 65881D85 default case
; ---------------------------------------------------------------------------

loc_65881DAE:				; CODE XREF: assuan_set_flag+67j
					; DATA XREF: .rdata:off_6589018Co
		mov	eax, [ebp+arg_8] ; jumptable 65881D85 case 2
		mov	edx, eax
		and	edx, 1
		mov	eax, [ebp+arg_0]
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+11Ch]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+11Ch], dl
		jmp	locret_65881E66	; jumptable 65881D85 default case
; ---------------------------------------------------------------------------

loc_65881DD6:				; CODE XREF: assuan_set_flag+67j
					; DATA XREF: .rdata:off_6589018Co
		mov	eax, [ebp+arg_8] ; jumptable 65881D85 case 3
		mov	edx, eax
		and	edx, 1
		mov	eax, [ebp+arg_0]
		and	edx, 1
		lea	ecx, ds:0[edx*4]
		movzx	edx, byte ptr [eax+11Ch]
		and	edx, 0FFFFFFFBh
		or	edx, ecx
		mov	[eax+11Ch], dl
		jmp	short locret_65881E66 ;	jumptable 65881D85 default case
; ---------------------------------------------------------------------------

loc_65881DFF:				; CODE XREF: assuan_set_flag+67j
					; DATA XREF: .rdata:off_6589018Co
		mov	eax, [ebp+arg_8] ; jumptable 65881D85 case 4
		mov	edx, eax
		and	edx, 1
		mov	eax, [ebp+arg_0]
		and	edx, 1
		lea	ecx, ds:0[edx*8]
		movzx	edx, byte ptr [eax+11Ch]
		and	edx, 0FFFFFFF7h
		or	edx, ecx
		mov	[eax+11Ch], dl
		jmp	short locret_65881E66 ;	jumptable 65881D85 default case
; ---------------------------------------------------------------------------

loc_65881E28:				; CODE XREF: assuan_set_flag+67j
					; DATA XREF: .rdata:off_6589018Co
		mov	eax, [ebp+arg_8] ; jumptable 65881D85 case 5
		mov	edx, eax
		and	edx, 1
		mov	eax, [ebp+arg_0]
		and	edx, 1
		mov	ecx, edx
		shl	ecx, 4
		movzx	edx, byte ptr [eax+11Ch]
		and	edx, 0FFFFFFEFh
		or	edx, ecx
		mov	[eax+11Ch], dl
		jmp	short locret_65881E66 ;	jumptable 65881D85 default case
; ---------------------------------------------------------------------------

loc_65881E4F:				; CODE XREF: assuan_set_flag+67j
					; DATA XREF: .rdata:off_6589018Co
		mov	eax, [ebp+arg_0] ; jumptable 65881D85 case 6
		movzx	edx, byte ptr [eax+11Ch]
		or	edx, 20h
		mov	[eax+11Ch], dl
		nop
		jmp	short locret_65881E66 ;	jumptable 65881D85 default case
; ---------------------------------------------------------------------------

loc_65881E65:				; CODE XREF: assuan_set_flag+4Aj
		nop

locret_65881E66:			; CODE XREF: assuan_set_flag+54j
					; assuan_set_flag+67j ...
		leave			; jumptable 65881D85 default case
		retn
assuan_set_flag	endp

; Exported entry  12. assuan_get_flag

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_flag
assuan_get_flag	proc near

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 2
		mov	[ebp+var_18], offset aAssuan_get_fla ; "assuan_get_flag"
		mov	[ebp+var_1C], offset aCtx_0 ; "ctx"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_30], edx
		mov	edx, [ebp+var_20]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset aSSPEnterFlagI	; "%s (%s=%p): enter: flag=%i\n"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		cmp	[ebp+arg_0], 0
		jnz	short loc_65881EDC
		mov	eax, 0
		jmp	locret_65881FBB
; ---------------------------------------------------------------------------

loc_65881EDC:				; CODE XREF: assuan_get_flag+68j
		cmp	[ebp+arg_4], 6	; switch 7 cases
		ja	loc_65881F80	; jumptable 65881EF3 default case
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		add	eax, offset off_658901F8
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_65881EF5:				; CODE XREF: assuan_get_flag+8Bj
					; DATA XREF: .rdata:off_658901F8o
		mov	eax, [ebp+arg_0] ; jumptable 65881EF3 case 1
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_65881F80 ; jumptable 65881EF3	default	case
; ---------------------------------------------------------------------------

loc_65881F0A:				; CODE XREF: assuan_get_flag+8Bj
					; DATA XREF: .rdata:off_658901F8o
		mov	eax, [ebp+arg_0] ; jumptable 65881EF3 case 2
		movzx	eax, byte ptr [eax+11Ch]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_65881F80 ; jumptable 65881EF3	default	case
; ---------------------------------------------------------------------------

loc_65881F21:				; CODE XREF: assuan_get_flag+8Bj
					; DATA XREF: .rdata:off_658901F8o
		mov	eax, [ebp+arg_0] ; jumptable 65881EF3 case 3
		movzx	eax, byte ptr [eax+11Ch]
		shr	al, 2
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_65881F80 ; jumptable 65881EF3	default	case
; ---------------------------------------------------------------------------

loc_65881F39:				; CODE XREF: assuan_get_flag+8Bj
					; DATA XREF: .rdata:off_658901F8o
		mov	eax, [ebp+arg_0] ; jumptable 65881EF3 case 4
		movzx	eax, byte ptr [eax+11Ch]
		shr	al, 3
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_65881F80 ; jumptable 65881EF3	default	case
; ---------------------------------------------------------------------------

loc_65881F51:				; CODE XREF: assuan_get_flag+8Bj
					; DATA XREF: .rdata:off_658901F8o
		mov	eax, [ebp+arg_0] ; jumptable 65881EF3 case 5
		movzx	eax, byte ptr [eax+11Ch]
		shr	al, 4
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_65881F80 ; jumptable 65881EF3	default	case
; ---------------------------------------------------------------------------

loc_65881F69:				; CODE XREF: assuan_get_flag+8Bj
					; DATA XREF: .rdata:off_658901F8o
		mov	eax, [ebp+arg_0] ; jumptable 65881EF3 case 6
		movzx	eax, byte ptr [eax+11Ch]
		shr	al, 5
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_C], eax
		nop

loc_65881F80:				; CODE XREF: assuan_get_flag+78j
					; assuan_get_flag+8Bj ...
		mov	eax, [ebp+var_14] ; jumptable 65881EF3 default case
		mov	edx, [ebp+var_C]
		mov	[esp+48h+var_30], edx
		mov	edx, [ebp+var_20]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset aSSPLeaveFlag_v ; "%s (%s=%p):	leave: flag_value=%i\n"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, 0

locret_65881FBB:			; CODE XREF: assuan_get_flag+6Fj
		leave
		retn
assuan_get_flag	endp

; Exported entry   2. assuan_begin_confidential

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_begin_confidential
assuan_begin_confidential proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 1
		mov	[esp+18h+var_14], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_flag
		leave
		retn
assuan_begin_confidential endp

; Exported entry   7. assuan_end_confidential

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_end_confidential
assuan_end_confidential	proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_flag
		leave
		retn
assuan_end_confidential	endp

; Exported entry   6. assuan_ctx_set_system_hooks

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_ctx_set_system_hooks
assuan_ctx_set_system_hooks proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+28h+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_0	; "ctx"
		mov	[esp+28h+var_1C], offset aAssuan_set_sys ; "assuan_set_system_hooks"
		mov	[esp+28h+var_20], offset aSSPCallSystem_ ; "%s (%s=%p):	call: system_hooks=%p (vers"...
		mov	[esp+28h+var_24], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+128h]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], edx
		call	sub_6588234C
		leave
		retn
assuan_ctx_set_system_hooks endp

; Exported entry  51. assuan_set_io_monitor

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_io_monitor
assuan_set_io_monitor proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_0	; "ctx"
		mov	[esp+28h+var_1C], offset aAssuan_set_io_ ; "assuan_set_io_monitor"
		mov	[esp+28h+var_20], offset aSSPCallIo_moni ; "%s (%s=%p):	call: io_monitor=%p,hook_da"...
		mov	[esp+28h+var_24], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		cmp	[ebp+arg_0], 0
		jz	short loc_658820CB
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+120h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+124h], edx
		jmp	short locret_658820CC
; ---------------------------------------------------------------------------

loc_658820CB:				; CODE XREF: assuan_set_io_monitor+4Aj
		nop

locret_658820CC:			; CODE XREF: assuan_set_io_monitor+64j
		leave
		retn
assuan_set_io_monitor endp

; Exported entry  47. assuan_set_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_error
assuan_set_error proc near		; CODE XREF: assuan_sendfd+74p
					; assuan_receivefd+53p	...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		cmp	[ebp+arg_8], 0
		jz	short loc_658820E1
		mov	ebx, [ebp+arg_8]
		jmp	short loc_658820E6
; ---------------------------------------------------------------------------

loc_658820E1:				; CODE XREF: assuan_set_error+Cj
		mov	ebx, offset aNone ; "(none)"

loc_658820E6:				; CODE XREF: assuan_set_error+11j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	esi, eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	gpg_strsource
		mov	[esp+38h+var_14], ebx
		mov	[esp+38h+var_18], esi
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset aCtx_0	; "ctx"
		mov	[esp+38h+var_2C], offset aAssuan_set_err ; "assuan_set_error"
		mov	[esp+38h+var_30], offset aSSPCallErrISST ; "%s (%s=%p):	call: err=%i (%s,%s),text=%"...
		mov	[esp+38h+var_34], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+17Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+180h], edx
		mov	eax, [ebp+arg_4]
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
assuan_set_error endp

; Exported entry  19. assuan_get_pid

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_pid
assuan_get_pid	proc near		; CODE XREF: assuan_accept+1A3p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_6588217C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D98h]
		jmp	short loc_65882181
; ---------------------------------------------------------------------------

loc_6588217C:				; CODE XREF: assuan_get_pid+Aj
		mov	eax, 0FFFFFFFFh

loc_65882181:				; CODE XREF: assuan_get_pid+15j
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_0	; "ctx"
		mov	[esp+28h+var_1C], offset aAssuan_get_pid ; "assuan_get_pid"
		mov	[esp+28h+var_20], offset aSSPCallPidI ;	"%s (%s=%p): call: pid=%i\n"
		mov	[esp+28h+var_24], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		cmp	[ebp+arg_0], 0
		jz	short loc_658821D5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D98h]
		test	eax, eax
		jz	short loc_658821D5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D98h]
		jmp	short locret_658821DA
; ---------------------------------------------------------------------------

loc_658821D5:				; CODE XREF: assuan_get_pid+56j
					; assuan_get_pid+63j
		mov	eax, 0FFFFFFFFh

locret_658821DA:			; CODE XREF: assuan_get_pid+6Ej
		leave
		retn
assuan_get_pid	endp

; Exported entry  18. assuan_get_peercred

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_peercred
assuan_get_peercred proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_0	; "ctx"
		mov	[esp+28h+var_1C], offset aAssuan_get_pee ; "assuan_get_peercred"
		mov	[esp+28h+var_20], offset aSSPCall_0 ; "%s (%s=%p): call\n"
		mov	[esp+28h+var_24], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		cmp	[ebp+arg_0], 0
		jnz	short loc_6588222F
		mov	[esp+28h+var_24], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65881C87
		jmp	short locret_65882264
; ---------------------------------------------------------------------------

loc_6588222F:				; CODE XREF: assuan_get_peercred+3Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+15Ch]
		test	eax, eax
		jnz	short loc_65882251
		mov	[esp+28h+var_24], 101h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65881C87
		jmp	short locret_65882264
; ---------------------------------------------------------------------------

loc_65882251:				; CODE XREF: assuan_get_peercred+5Ej
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+160h]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

locret_65882264:			; CODE XREF: assuan_get_peercred+51j
					; assuan_get_peercred+73j
		leave
		retn
assuan_get_peercred endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882268	proc near		; CODE XREF: assuan_new_ext+111p
					; sub_6588327E+36p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+104h]
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	edx
		leave
		retn
sub_65882268	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882281	proc near		; CODE XREF: assuan_register_command+1A5p
					; sub_65887202+95p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+108h]
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	edx
		leave
		retn
sub_65882281	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658822A1	proc near		; CODE XREF: assuan_register_command+11Dp

Dst		= dword	ptr -28h
Val		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_658822DA
		mov	eax, [ebp+var_C]
		mov	edx, 0
		div	[ebp+arg_8]
		cmp	eax, [ebp+arg_4]
		jz	short loc_658822DA
		mov	[esp+28h+Dst], 0Ch
		call	gpg_err_set_errno
		mov	eax, 0
		jmp	short locret_65882311
; ---------------------------------------------------------------------------

loc_658822DA:				; CODE XREF: sub_658822A1+14j
					; sub_658822A1+24j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+104h]
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Dst], eax
		call	edx
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_6588230E
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Val], 0 ; Val
		mov	[esp+28h+Dst], eax ; Dst
		call	memset

loc_6588230E:				; CODE XREF: sub_658822A1+51j
		mov	eax, [ebp+var_10]

locret_65882311:			; CODE XREF: sub_658822A1+37j
		leave
		retn
sub_658822A1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882313	proc near		; CODE XREF: assuan_release+AAp
					; assuan_free+13p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_4], 0
		jz	short locret_65882330
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10Ch]
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	edx

locret_65882330:			; CODE XREF: sub_65882313+Aj
		leave
		retn
sub_65882313	endp

; Exported entry  80. assuan_free

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_free
assuan_free	proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65882313
		leave
		retn
assuan_free	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588234C	proc near		; CODE XREF: assuan_set_system_hooks+14p
					; assuan_ctx_set_system_hooks+5Bp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], offset dword_6588F100
		jz	short loc_658823AC
		mov	edx, offset dword_6588F100
		mov	eax, [ebp+arg_0]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	ecx, [edx+24h]
		mov	[eax+24h], ecx
		mov	ecx, [edx+28h]
		mov	[eax+28h], ecx
		mov	ecx, [edx+2Ch]
		mov	[eax+2Ch], ecx
		mov	edx, [edx+30h]
		mov	[eax+30h], edx

loc_658823AC:				; CODE XREF: sub_6588234C+Aj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 2
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jle	short loc_65882436
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+1Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+20h]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	[eax+24h], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	[eax+28h], edx

loc_65882436:				; CODE XREF: sub_6588234C+70j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, 1
		jle	short loc_65882458
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx

loc_65882458:				; CODE XREF: sub_6588234C+F2j
		pop	ebp
		retn
sub_6588234C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588245A	proc near		; CODE XREF: sub_65883EFD+26p
					; sub_6588A96C+6Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_1	; "ctx"
		mov	[esp+28h+var_1C], offset a_assuan_usleep ; "_assuan_usleep"
		mov	[esp+28h+var_20], offset aSSPCallUsecU ; "%s (%s=%p): call: usec=%u\n"
		mov	[esp+28h+var_24], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+12Ch]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		leave
		retn
sub_6588245A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658824B3	proc near		; CODE XREF: sub_65888CC3+78p
					; sub_65888CC3+AFp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 5
		mov	[ebp+var_14], offset a_assuan_pipe ; "_assuan_pipe"
		mov	[ebp+var_18], offset aCtx_1 ; "ctx"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_658824E7
		mov	eax, offset aReading ; "reading"
		jmp	short loc_658824EC
; ---------------------------------------------------------------------------

loc_658824E7:				; CODE XREF: sub_658824B3+2Bj
		mov	eax, offset aWriting ; "writing"

loc_658824EC:				; CODE XREF: sub_658824B3+32j
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], offset aSSPEnterInheri ; "%s (%s=%p):	enter: inherit_idx=%i (Assu"...
		mov	[esp+48h+var_44], edx
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+130h]
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	edx
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_658825DC
		cmp	[ebp+var_20], 0
		js	short loc_65882593
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_20]
		mov	[esp+48h+var_30], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset aSSPLeaveResult ; "%s (%s=%p):	leave: result=%i\n"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, [ebp+var_20]
		jmp	short loc_658825DA
; ---------------------------------------------------------------------------

loc_65882593:				; CODE XREF: sub_658824B3+A3j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax ;	int
		call	strerror
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], offset aSSPErrorS ; "%s (%s=%p): error: %s\n"
		mov	[esp+48h+var_44], edx
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, [ebp+var_20]

loc_658825DA:				; CODE XREF: sub_658824B3+DEj
		jmp	short locret_65882625
; ---------------------------------------------------------------------------

loc_658825DC:				; CODE XREF: sub_658824B3+99j
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	ecx, [eax]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_2C], ecx
		mov	[esp+48h+var_30], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset aSSPLeaveRead0x ; "%s (%s=%p):	leave: read=0x%x, write=0x%"...
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, 0

locret_65882625:			; CODE XREF: sub_658824B3:loc_658825DAj
		leave
		retn
sub_658824B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882627	proc near		; CODE XREF: sub_65883440+27p
					; sub_65883440+7Dp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_1	; "ctx"
		mov	[esp+28h+var_1C], offset a_assuan_close	; "_assuan_close"
		mov	[esp+28h+var_20], offset aSSPCallFd0xX ; "%s (%s=%p): call: fd=0x%x\n"
		mov	[esp+28h+var_24], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+134h]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		leave
		retn
sub_65882627	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882680	proc near		; CODE XREF: sub_65888CC3+D7p
					; sub_65888CC3+18Ap ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_1	; "ctx"
		mov	[esp+28h+var_1C], offset a_assuan_close_ ; "_assuan_close_inheritable"
		mov	[esp+28h+var_20], offset aSSPCallFd0xX ; "%s (%s=%p): call: fd=0x%x\n"
		mov	[esp+28h+var_24], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+134h]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		leave
		retn
sub_65882680	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658826D9	proc near		; CODE XREF: sub_6588A96C+2Cp
					; sub_6588CB5C+27p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+138h]
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx
		leave
		retn
sub_658826D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882707	proc near		; CODE XREF: sub_6588AA20+21p
					; sub_6588CB8A+27p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+13Ch]
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx
		leave
		retn
sub_65882707	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	edx, [eax+140h]
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	edx, [eax+144h]
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882791	proc near		; CODE XREF: sub_65888CC3+155p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 2
		mov	[ebp+var_18], offset a_assuan_spawn ; "_assuan_spawn"
		mov	[ebp+var_1C], offset aCtx_1 ; "ctx"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_658827C3
		mov	eax, [ebp+arg_8]
		jmp	short loc_658827C8
; ---------------------------------------------------------------------------

loc_658827C3:				; CODE XREF: sub_65882791+2Bj
		mov	eax, offset aNull ; "(null)"

loc_658827C8:				; CODE XREF: sub_65882791+30j
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+arg_24]
		mov	[esp+58h+var_2C], ecx
		mov	ecx, [ebp+arg_20]
		mov	[esp+58h+var_30], ecx
		mov	ecx, [ebp+arg_1C]
		mov	[esp+58h+var_34], ecx
		mov	ecx, [ebp+arg_14]
		mov	[esp+58h+var_38], ecx
		mov	ecx, [ebp+arg_10]
		mov	[esp+58h+var_3C], ecx
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset aSSPEnterNameSF ; "%s (%s=%p):	enter: name=%s,fd_in=0x%x,f"...
		mov	[esp+58h+var_54], edx
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		cmp	[ebp+arg_8], 0
		jz	short loc_65882885
		mov	[ebp+var_C], 0
		jmp	short loc_65882876
; ---------------------------------------------------------------------------

loc_6588282D:				; CODE XREF: sub_65882791+F2j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_C]
		mov	edx, [eax]
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_3C], edx
		mov	edx, [ebp+var_C]
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], offset aSSPCheckArgv2i ; "%s (%s=%p):	check: argv[%2i] = %s\n"
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		add	[ebp+var_C], 1

loc_65882876:				; CODE XREF: sub_65882791+9Aj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_6588282D

loc_65882885:				; CODE XREF: sub_65882791+91j
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_18], 0
		jz	short loc_658828ED
		jmp	short loc_658828DD
; ---------------------------------------------------------------------------

loc_65882894:				; CODE XREF: sub_65882791+15Aj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_18]
		mov	edx, [eax]
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_3C], edx
		mov	edx, [ebp+var_C]
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], offset aSSPCheckFd_chi ; "%s (%s=%p):	check: fd_child_list[%2i] ="...
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		add	[ebp+var_C], 1

loc_658828DD:				; CODE XREF: sub_65882791+101j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_18]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_65882894

loc_658828ED:				; CODE XREF: sub_65882791+FFj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+148h]
		mov	eax, [ebp+arg_24]
		mov	[esp+58h+var_34], eax
		mov	eax, [ebp+arg_20]
		mov	[esp+58h+var_38], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	edx
		mov	[ebp+var_24], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_65882980
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], offset aSSPCheckPid0xX ; "%s (%s=%p):	check: pid = 0x%x\n"
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		jmp	short loc_658829C1
; ---------------------------------------------------------------------------

loc_65882980:				; CODE XREF: sub_65882791+1B3j
		mov	eax, [ebp+arg_C]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_3C], ecx
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], offset aSSPCheckPid0_0 ; "%s (%s=%p):	check: pid = 0x%x (%s)\n"
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28

loc_658829C1:				; CODE XREF: sub_65882791+1EDj
		cmp	[ebp+var_24], 0
		jnz	short loc_65882A02
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_24]
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], offset aSSPLeaveResult ; "%s (%s=%p):	leave: result=%i\n"
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		mov	eax, [ebp+var_24]
		jmp	short locret_65882A43
; ---------------------------------------------------------------------------

loc_65882A02:				; CODE XREF: sub_65882791+234j
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	edx, [ebp+var_14]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset aSSPErrorS ; "%s (%s=%p): error: %s\n"
		mov	[esp+58h+var_54], edx
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		mov	eax, [ebp+var_24]

locret_65882A43:			; CODE XREF: sub_65882791+26Fj
		leave
		retn
sub_65882791	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882A45	proc near		; CODE XREF: sub_65883440+E1p
					; sub_65883D60+E1p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14Ch]
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		leave
		retn
sub_65882A45	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], 5
		mov	dword ptr [ebp-14h], offset a_assuan_socket ; "_assuan_socketpair"
		mov	dword ptr [ebp-18h], offset aCtx_1 ; "ctx"
		mov	eax, [ebp+8]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp+18h]
		mov	[esp+24h], edx
		mov	edx, [ebp+14h]
		mov	[esp+20h], edx
		mov	edx, [ebp+10h]
		mov	[esp+1Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+18h], edx
		mov	edx, [ebp-1Ch]
		mov	[esp+14h], edx
		mov	edx, [ebp-18h]
		mov	[esp+10h], edx
		mov	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], offset aSSPEnterNamesp ; "%s	(%s=%p): enter:	namespace=%i,style=%"...
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_65882E28
		mov	eax, [ebp+8]
		mov	edx, [eax+150h]
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_65882B66
		mov	eax, [ebp+18h]
		add	eax, 4
		mov	ecx, [eax]
		mov	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp-10h]
		mov	[esp+1Ch], ecx
		mov	[esp+18h], edx
		mov	edx, [ebp-1Ch]
		mov	[esp+14h], edx
		mov	edx, [ebp-18h]
		mov	[esp+10h], edx
		mov	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], offset aSSPCheckFilede ; "%s	(%s=%p): check:	filedes	= { 0x%x, 0x"...
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_65882E28

loc_65882B66:				; CODE XREF: .text:65882B20j
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_65882BA7
		mov	eax, [ebp-10h]
		mov	edx, [ebp-20h]
		mov	[esp+18h], edx
		mov	edx, [ebp-1Ch]
		mov	[esp+14h], edx
		mov	edx, [ebp-18h]
		mov	[esp+10h], edx
		mov	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], offset aSSPLeaveResult ; "%s	(%s=%p): leave:	result=%i\n"
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_65882E28
		mov	eax, [ebp-20h]
		jmp	short locret_65882BE8
; ---------------------------------------------------------------------------

loc_65882BA7:				; CODE XREF: .text:65882B6Aj
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	strerror
		mov	edx, [ebp-10h]
		mov	[esp+18h], eax
		mov	eax, [ebp-1Ch]
		mov	[esp+14h], eax
		mov	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aSSPErrorS ; "%s (%s=%p): error: %s\n"
		mov	[esp+4], edx
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_65882E28
		mov	eax, [ebp-20h]

locret_65882BE8:			; CODE XREF: .text:65882BA5j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882BEA	proc near		; CODE XREF: sub_6588A6FC+34p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 5
		mov	[ebp+var_14], offset a_assuan_sock_0 ; "_assuan_socket"
		mov	[ebp+var_18], offset aCtx_1 ; "ctx"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_38], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_3C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_14]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], offset aSSPEnterName_0 ; "%s (%s=%p):	enter: namespace=%i,style=%"...
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+154h]
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	edx
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		js	short loc_65882CBF
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_14]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], offset aSSPLeaveResult ; "%s (%s=%p):	leave: result=%i\n"
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		mov	eax, [ebp+var_20]
		jmp	short locret_65882D06
; ---------------------------------------------------------------------------

loc_65882CBF:				; CODE XREF: sub_65882BEA+98j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	edx, [ebp+var_10]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset aSSPErrorS ; "%s (%s=%p): error: %s\n"
		mov	[esp+58h+var_54], edx
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		mov	eax, [ebp+var_20]

locret_65882D06:			; CODE XREF: sub_65882BEA+D3j
		leave
		retn
sub_65882BEA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882D08	proc near		; CODE XREF: sub_6588AA7E+10Cp
					; sub_6588AA7E+163p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 5
		mov	[ebp+var_14], offset a_assuan_connec ; "_assuan_connect"
		mov	[ebp+var_18], offset aCtx_1 ; "ctx"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_38], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_3C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_14]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], offset aSSPEnterSocket ; "%s (%s=%p):	enter: socket=%i,addr=%p,le"...
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+158h]
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	edx
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		js	short loc_65882DDD
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_14]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], offset aSSPLeaveResult ; "%s (%s=%p):	leave: result=%i\n"
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		mov	eax, [ebp+var_20]
		jmp	short locret_65882E24
; ---------------------------------------------------------------------------

loc_65882DDD:				; CODE XREF: sub_65882D08+98j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	edx, [ebp+var_10]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset aSSPErrorS ; "%s (%s=%p): error: %s\n"
		mov	[esp+58h+var_54], edx
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_65882E28
		mov	eax, [ebp+var_20]

locret_65882E24:			; CODE XREF: sub_65882D08+D3j
		leave
		retn
sub_65882D08	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65882E28	proc near		; CODE XREF: assuan_new_ext+F2p
					; assuan_new_ext+156p ...

Memory		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	loc_65882EF4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+110h]
		test	eax, eax
		jz	loc_65882EF4
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+110h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+114h]
		mov	[esp+28h+var_1C], 0
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Memory], eax
		call	ecx
		test	eax, eax
		jz	short loc_65882EF4
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		lea	edx, [ebp+arg_C]
		lea	eax, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_24], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+Memory], eax
		call	gpgrt_vasprintf
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		js	short loc_65882EF7
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+110h]
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+114h]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Memory], eax
		call	ecx
		mov	eax, [ebp+var_18]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Memory], eax
		call	gpg_err_set_errno
		jmp	short locret_65882EF8
; ---------------------------------------------------------------------------

loc_65882EF4:				; CODE XREF: sub_65882E28+Aj
					; sub_65882E28+1Bj ...
		nop
		jmp	short locret_65882EF8
; ---------------------------------------------------------------------------

loc_65882EF7:				; CODE XREF: sub_65882E28+86j
		nop

locret_65882EF8:			; CODE XREF: sub_65882E28+CAj
					; sub_65882E28+CDj
		leave
		retn
sub_65882E28	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_65882F82
		mov	eax, [ebp+8]
		mov	eax, [eax+110h]
		test	eax, eax
		jz	short loc_65882F82
		mov	eax, [ebp+8]
		mov	ecx, [eax+110h]
		mov	eax, [ebp+8]
		mov	eax, [eax+114h]
		mov	dword ptr [esp+0Ch], 0
		mov	edx, [ebp+10h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	ecx
		test	eax, eax
		jz	short loc_65882F82
		lea	edx, [ebp+18h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	gpgrt_vasprintf
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short locret_65882F83
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		jmp	short locret_65882F83
; ---------------------------------------------------------------------------

loc_65882F82:				; CODE XREF: .text:65882F0Dj
					; .text:65882F1Aj ...
		nop

locret_65882F83:			; CODE XREF: .text:65882F75j
					; .text:65882F80j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_65883032
		lea	edx, [ebp+14h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	gpgrt_vasprintf
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_65882FD8
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	free
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_65882FD8:				; CODE XREF: .text:65882FC0j
		mov	ecx, [ebp-14h]
		mov	eax, [ebp+0Ch]
		mov	edx, [eax]
		mov	eax, offset aSS	; "%s%s"
		mov	[esp+0Ch], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	gpgrt_asprintf
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	free
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	free
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_65883028
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		jmp	short locret_65883033
; ---------------------------------------------------------------------------

loc_65883028:				; CODE XREF: .text:6588301Bj
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short locret_65883033
; ---------------------------------------------------------------------------

loc_65883032:				; CODE XREF: .text:65882F92j
		nop

locret_65883033:			; CODE XREF: .text:65883026j
					; .text:65883030j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_65883080
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aS ; "%s"
		mov	dword ptr [esp+4], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_65882E28
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	free
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		jmp	short locret_65883081
; ---------------------------------------------------------------------------

loc_65883080:				; CODE XREF: .text:65883042j
		nop

locret_65883081:			; CODE XREF: .text:6588307Ej
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	dword ptr [ebp-0Ch], 0
		cmp	dword ptr [ebp+8], 0
		jz	loc_6588322A
		mov	eax, [ebp+8]
		mov	eax, [eax+110h]
		test	eax, eax
		jz	loc_6588322A
		mov	eax, [ebp+8]
		mov	ecx, [eax+110h]
		mov	eax, [ebp+8]
		mov	eax, [eax+114h]
		mov	dword ptr [esp+0Ch], 0
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	ecx
		test	eax, eax
		jnz	loc_6588321B
		jmp	loc_6588322A
; ---------------------------------------------------------------------------

loc_658830E5:				; CODE XREF: .text:65883222j
		lea	eax, [ebp-4Ch]
		mov	[ebp-14h], eax
		lea	eax, [ebp-4Ch]
		add	eax, 22h
		mov	[ebp-18h], eax
		mov	dword ptr [ebp-10h], 0
		jmp	loc_658831C0
; ---------------------------------------------------------------------------

loc_65883100:				; CODE XREF: .text:658831C4j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+24h]
		jnb	loc_65883198
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+20h]
		movzx	eax, byte ptr [eax]
		mov	[ebp-19h], al
		add	dword ptr [ebp-0Ch], 1
		movzx	eax, byte ptr [ebp-19h]
		shr	al, 4
		cmp	al, 9
		ja	short loc_65883133
		movzx	eax, byte ptr [ebp-19h]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_6588313D
; ---------------------------------------------------------------------------

loc_65883133:				; CODE XREF: .text:65883125j
		movzx	eax, byte ptr [ebp-19h]
		shr	al, 4
		add	eax, 57h

loc_6588313D:				; CODE XREF: .text:65883131j
		mov	edx, [ebp-14h]
		mov	[edx], al
		add	dword ptr [ebp-14h], 1
		movzx	eax, byte ptr [ebp-19h]
		and	eax, 0Fh
		cmp	al, 9
		ja	short loc_6588315D
		movzx	eax, byte ptr [ebp-19h]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_65883167
; ---------------------------------------------------------------------------

loc_6588315D:				; CODE XREF: .text:6588314Fj
		movzx	eax, byte ptr [ebp-19h]
		and	eax, 0Fh
		add	eax, 57h

loc_65883167:				; CODE XREF: .text:6588315Bj
		mov	edx, [ebp-14h]
		mov	[edx], al
		add	dword ptr [ebp-14h], 1
		movzx	eax, byte ptr [ebp-19h]
		mov	[esp], eax
		mov	eax, ds:isprint
		call	eax ; isprint
		test	eax, eax
		jz	short loc_65883188
		movzx	eax, byte ptr [ebp-19h]
		jmp	short loc_6588318D
; ---------------------------------------------------------------------------

loc_65883188:				; CODE XREF: .text:65883180j
		mov	eax, 2Eh

loc_6588318D:				; CODE XREF: .text:65883186j
		mov	edx, [ebp-18h]
		mov	[edx], al
		add	dword ptr [ebp-18h], 1
		jmp	short loc_658831AC
; ---------------------------------------------------------------------------

loc_65883198:				; CODE XREF: .text:65883106j
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	20h
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	20h
		add	dword ptr [ebp-14h], 1

loc_658831AC:				; CODE XREF: .text:65883196j
		cmp	dword ptr [ebp-10h], 7
		jnz	short loc_658831BC
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	20h
		add	dword ptr [ebp-14h], 1

loc_658831BC:				; CODE XREF: .text:658831B0j
		add	dword ptr [ebp-10h], 1

loc_658831C0:				; CODE XREF: .text:658830FBj
		cmp	dword ptr [ebp-10h], 0Fh
		jle	loc_65883100
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	20h
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-18h]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-18h], 1
		mov	eax, [ebp-18h]
		mov	byte ptr [eax],	0
		lea	eax, [ebp-4Ch]
		mov	[esp+18h], eax
		mov	eax, [ebp+1Ch]
		mov	[esp+14h], eax
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_65882E28
		jmp	short loc_6588321C
; ---------------------------------------------------------------------------

loc_6588321B:				; CODE XREF: .text:658830DAj
		nop

loc_6588321C:				; CODE XREF: .text:65883219j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+24h]
		jb	loc_658830E5
		jmp	short locret_6588322B
; ---------------------------------------------------------------------------

loc_6588322A:				; CODE XREF: .text:65883094j
					; .text:658830A5j ...
		nop

locret_6588322B:			; CODE XREF: .text:65883228j
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883230	proc near		; CODE XREF: sub_6588327E+11Cp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	[ebp+var_8], 0
		jmp	short loc_6588326F
; ---------------------------------------------------------------------------

loc_65883240:				; CODE XREF: sub_65883230+43j
		mov	eax, [ebp+var_8]
		shl	eax, 2
		mov	edx, [ebp+arg_0]
		mov	ebx, edx
		mov	ecx, eax
		sar	ebx, cl
		mov	eax, ebx
		and	eax, 0Fh
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, offset a0123456789abcd ; "0123456789abcdef"
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		mov	[eax], dl
		add	[ebp+arg_4], 1
		add	[ebp+var_8], 1

loc_6588326F:				; CODE XREF: sub_65883230+Ej
		cmp	[ebp+var_8], 1
		jle	short loc_65883240
		mov	eax, [ebp+arg_4]
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_65883230	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588327E	proc near		; CODE XREF: sub_65889107+11Cp

C		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		shl	eax, 2
		add	eax, 1
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+C], eax
		call	sub_65882268
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_658832D0
		mov	eax, 0
		jmp	loc_658833DB
; ---------------------------------------------------------------------------

loc_658832D0:				; CODE XREF: sub_6588327E+46j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	loc_658833C4
; ---------------------------------------------------------------------------

loc_658832E1:				; CODE XREF: sub_6588327E+14Ej
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 8		; switch 6 cases
		cmp	eax, 5
		ja	short loc_65883335 ; jumptable 65883300	default	case
		mov	eax, ds:off_6589067C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_65883302:				; CODE XREF: sub_6588327E+82j
					; DATA XREF: .rdata:off_6589067Co
		mov	[ebp+var_14], 72h ; jumptable 65883300 case 13
		jmp	loc_658833A2
; ---------------------------------------------------------------------------

loc_6588330E:				; CODE XREF: sub_6588327E+82j
					; DATA XREF: .rdata:off_6589067Co
		mov	[ebp+var_14], 6Eh ; jumptable 65883300 case 10
		jmp	loc_658833A2
; ---------------------------------------------------------------------------

loc_6588331A:				; CODE XREF: sub_6588327E+82j
					; DATA XREF: .rdata:off_6589067Co
		mov	[ebp+var_14], 66h ; jumptable 65883300 case 12
		jmp	short loc_658833A2
; ---------------------------------------------------------------------------

loc_65883323:				; CODE XREF: sub_6588327E+82j
					; DATA XREF: .rdata:off_6589067Co
		mov	[ebp+var_14], 76h ; jumptable 65883300 case 11
		jmp	short loc_658833A2
; ---------------------------------------------------------------------------

loc_6588332C:				; CODE XREF: sub_6588327E+82j
					; DATA XREF: .rdata:off_6589067Co
		mov	[ebp+var_14], 62h ; jumptable 65883300 case 8
		jmp	short loc_658833A2
; ---------------------------------------------------------------------------

loc_65883335:				; CODE XREF: sub_6588327E+79j
					; sub_6588327E+82j
					; DATA XREF: ...
		mov	eax, [ebp+var_C] ; jumptable 65883300 default case
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_65883356
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+38h+C], eax ; C
		mov	eax, ds:isprint
		call	eax ; isprint
		test	eax, eax
		jnz	short loc_65883360

loc_65883356:				; CODE XREF: sub_6588327E+BFj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_65883373

loc_65883360:				; CODE XREF: sub_6588327E+D6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	short loc_658833A2
; ---------------------------------------------------------------------------

loc_65883373:				; CODE XREF: sub_6588327E+E0j
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	78h
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+var_10]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+C], eax
		call	sub_65883230
		mov	[ebp+var_10], eax

loc_658833A2:				; CODE XREF: sub_6588327E+8Bj
					; sub_6588327E+97j ...
		cmp	[ebp+var_14], 0
		jz	short loc_658833C0
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1

loc_658833C0:				; CODE XREF: sub_6588327E+128j
		add	[ebp+var_C], 1

loc_658833C4:				; CODE XREF: sub_6588327E+5Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_658832E1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]

loc_658833DB:				; CODE XREF: sub_6588327E+4Dj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_6588327E	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658833E4	proc near		; CODE XREF: sub_65889AD0:loc_65889B20p
		push	ebp
		mov	ebp, esp
		mov	eax, offset aThisIsLibassua ; "\n\nThis	is Libassuan 2.4.2 - The GnuPG"...
		pop	ebp
		retn
sub_658833E4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658833F0	proc near		; CODE XREF: sub_65883417+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_65883410
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_65883415
; ---------------------------------------------------------------------------

loc_65883410:				; CODE XREF: sub_658833F0+7j
		mov	eax, 0

loc_65883415:				; CODE XREF: sub_658833F0+1Ej
		pop	ebp
		retn
sub_658833F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883417	proc near		; CODE XREF: assuan_client_parse_response+2D7p
					; assuan_transact+E5p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_6588342A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_6588342F
; ---------------------------------------------------------------------------

loc_6588342A:				; CODE XREF: sub_65883417+Aj
		mov	eax, 0Fh

loc_6588342F:				; CODE XREF: sub_65883417+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_658833F0
		leave
		retn
sub_65883417	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883440	proc near		; CODE XREF: sub_65883540+1Fp
					; DATA XREF: sub_65888CC3+232o	...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1ACh]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_6588349C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1ACh]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882627
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+1ACh]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		cmp	edx, eax
		jnz	short loc_6588348F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+998h], 0FFFFFFFFh

loc_6588348F:				; CODE XREF: sub_65883440+40j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1ACh], 0FFFFFFFFh

loc_6588349C:				; CODE XREF: sub_65883440+12j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_658834CF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882627
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+998h], 0FFFFFFFFh

loc_658834CF:				; CODE XREF: sub_65883440+68j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D98h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_65883533
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D98h]
		test	eax, eax
		jz	short loc_65883533
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 1
		movzx	edx, al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D98h]
		mov	[esp+28h+var_18], 0
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882A45
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D98h], 0FFFFFFFFh

loc_65883533:				; CODE XREF: sub_65883440+9Bj
					; sub_65883440+A8j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65889A74
		leave
		retn
sub_65883440	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883540	proc near		; DATA XREF: sub_65888CC3+1F1o
					; sub_65889107+9o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], offset aBye ;	"BYE"
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	assuan_write_line
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65883440
		leave
		retn
sub_65883540	endp

; Exported entry  76. assuan_client_read_response

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_client_read_response
assuan_client_read_response proc near	; CODE XREF: sub_65883A11+2Cp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_6588358C:				; CODE XREF: assuan_client_read_response+48j
					; assuan_client_read_response+73j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_6588412E
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65883EFD
		test	eax, eax
		jnz	short loc_6588358C
		cmp	[ebp+var_1C], 0
		jz	short loc_658835BE
		mov	eax, [ebp+var_1C]
		jmp	locret_6588372A
; ---------------------------------------------------------------------------

loc_658835BE:				; CODE XREF: assuan_client_read_response+4Ej
		mov	eax, [ebp+arg_0]
		add	eax, 1B4h
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588358C
		cmp	[ebp+var_C], 0
		jle	loc_65883715
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jnz	loc_65883715
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	loc_65883715
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		jmp	loc_658836EA
; ---------------------------------------------------------------------------

loc_65883615:				; CODE XREF: assuan_client_read_response+188j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_658836D3
		cmp	[ebp+var_C], 2
		jle	loc_658836D3
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_6588364E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_6588367A
; ---------------------------------------------------------------------------

loc_6588364E:				; CODE XREF: assuan_client_read_response+D3j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_65883669
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_65883678
; ---------------------------------------------------------------------------

loc_65883669:				; CODE XREF: assuan_client_read_response+F0j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_65883678:				; CODE XREF: assuan_client_read_response+101j
		mov	edx, eax

loc_6588367A:				; CODE XREF: assuan_client_read_response+E6j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_65883695
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_658836BC
; ---------------------------------------------------------------------------

loc_65883695:				; CODE XREF: assuan_client_read_response+11Fj
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_658836B0
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_658836BC
; ---------------------------------------------------------------------------

loc_658836B0:				; CODE XREF: assuan_client_read_response+13Aj
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_658836BC:				; CODE XREF: assuan_client_read_response+12Dj
					; assuan_client_read_response+148j
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		add	[ebp+var_10], 2
		sub	[ebp+var_C], 2
		jmp	short loc_658836E6
; ---------------------------------------------------------------------------

loc_658836D3:				; CODE XREF: assuan_client_read_response+B7j
					; assuan_client_read_response+C1j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_658836E6:				; CODE XREF: assuan_client_read_response+16Bj
		sub	[ebp+var_C], 1

loc_658836EA:				; CODE XREF: assuan_client_read_response+AAj
		cmp	[ebp+var_C], 0
		jnz	loc_65883615
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+5A0h], edx

loc_65883715:				; CODE XREF: assuan_client_read_response+79j
					; assuan_client_read_response+87j ...
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0

locret_6588372A:			; CODE XREF: assuan_client_read_response+53j
		leave
		retn
assuan_client_read_response endp

; Exported entry  77. assuan_client_parse_response

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_client_parse_response
assuan_client_parse_response proc near	; CODE XREF: sub_65883A11+5Cp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_8], 0
		jle	short loc_65883778
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jnz	short loc_65883778
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_65883778
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 2
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 2
		jmp	loc_65883A0A
; ---------------------------------------------------------------------------

loc_65883778:				; CODE XREF: assuan_client_parse_response+1Cj
					; assuan_client_parse_response+26j ...
		cmp	[ebp+arg_8], 0
		jle	short loc_658837D7
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 53h
		jnz	short loc_658837D7
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_658837A2
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_658837D7

loc_658837A2:				; CODE XREF: assuan_client_parse_response+67j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 4
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		jmp	short loc_658837C3
; ---------------------------------------------------------------------------

loc_658837B6:				; CODE XREF: assuan_client_parse_response+A4j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_658837C3:				; CODE XREF: assuan_client_parse_response+88j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		add	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_658837B6
		jmp	loc_65883A0A
; ---------------------------------------------------------------------------

loc_658837D7:				; CODE XREF: assuan_client_parse_response+50j
					; assuan_client_parse_response+5Aj ...
		cmp	[ebp+arg_8], 1
		jle	short loc_65883843
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 4Fh
		jnz	short loc_65883843
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Bh
		jnz	short loc_65883843
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_6588380E
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_65883843

loc_6588380E:				; CODE XREF: assuan_client_parse_response+D3j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 1
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 2
		jmp	short loc_6588382F
; ---------------------------------------------------------------------------

loc_65883822:				; CODE XREF: assuan_client_parse_response+110j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_6588382F:				; CODE XREF: assuan_client_parse_response+F4j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		add	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_65883822
		jmp	loc_65883A0A
; ---------------------------------------------------------------------------

loc_65883843:				; CODE XREF: assuan_client_parse_response+AFj
					; assuan_client_parse_response+B9j ...
		cmp	[ebp+arg_8], 2
		jle	short loc_658838BC
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jnz	short loc_658838BC
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 52h
		jnz	short loc_658838BC
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 52h
		jnz	short loc_658838BC
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_65883887
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_658838BC

loc_65883887:				; CODE XREF: assuan_client_parse_response+14Cj
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 3
		jmp	short loc_658838A8
; ---------------------------------------------------------------------------

loc_6588389B:				; CODE XREF: assuan_client_parse_response+189j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_658838A8:				; CODE XREF: assuan_client_parse_response+16Dj
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		add	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_6588389B
		jmp	loc_65883A0A
; ---------------------------------------------------------------------------

loc_658838BC:				; CODE XREF: assuan_client_parse_response+11Bj
					; assuan_client_parse_response+125j ...
		cmp	[ebp+arg_8], 6
		jle	loc_65883979
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 49h
		jnz	loc_65883979
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jnz	loc_65883979
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 51h
		jnz	loc_65883979
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 55h
		jnz	short loc_65883979
		mov	eax, [ebp+arg_4]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 49h
		jnz	short loc_65883979
		mov	eax, [ebp+arg_4]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 52h
		jnz	short loc_65883979
		mov	eax, [ebp+arg_4]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jnz	short loc_65883979
		mov	eax, [ebp+arg_4]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_65883944
		mov	eax, [ebp+arg_4]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_65883979

loc_65883944:				; CODE XREF: assuan_client_parse_response+209j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 3
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 7
		jmp	short loc_65883965
; ---------------------------------------------------------------------------

loc_65883958:				; CODE XREF: assuan_client_parse_response+246j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_65883965:				; CODE XREF: assuan_client_parse_response+22Aj
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		add	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_65883958
		jmp	loc_65883A0A
; ---------------------------------------------------------------------------

loc_65883979:				; CODE XREF: assuan_client_parse_response+194j
					; assuan_client_parse_response+1A2j ...
		cmp	[ebp+arg_8], 2
		jle	short loc_658839D1
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jnz	short loc_658839D1
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jnz	short loc_658839D1
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jnz	short loc_658839D1
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_658839BD
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_658839D1

loc_658839BD:				; CODE XREF: assuan_client_parse_response+282j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 5
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 3
		jmp	short loc_65883A0A
; ---------------------------------------------------------------------------

loc_658839D1:				; CODE XREF: assuan_client_parse_response+251j
					; assuan_client_parse_response+25Bj ...
		cmp	[ebp+arg_8], 0
		jle	short loc_658839F5
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jnz	short loc_658839F5
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 6
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		jmp	short loc_65883A0A
; ---------------------------------------------------------------------------

loc_658839F5:				; CODE XREF: assuan_client_parse_response+2A9j
					; assuan_client_parse_response+2B3j
		mov	[esp+8+var_4], 104h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65883417
		jmp	short locret_65883A0F
; ---------------------------------------------------------------------------

loc_65883A0A:				; CODE XREF: assuan_client_parse_response+47j
					; assuan_client_parse_response+A6j ...
		mov	eax, 0

locret_65883A0F:			; CODE XREF: assuan_client_parse_response+2DCj
		leave
		retn
assuan_client_parse_response endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883A11	proc near		; CODE XREF: assuan_transact+73p
					; assuan_transact+15Ep	...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h

loc_65883A17:				; CODE XREF: sub_65883A11+78j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_client_read_response
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_65883A75
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, [ebp+arg_8]
		mov	[esp+38h+var_28], ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_client_parse_response
		mov	[ebp+var_C], eax

loc_65883A75:				; CODE XREF: sub_65883A11+38j
		cmp	[ebp+var_C], 0
		jnz	short loc_65883A8B
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, 6
		jnz	short loc_65883A8B
		cmp	[ebp+arg_C], 0
		jz	short loc_65883A17

loc_65883A8B:				; CODE XREF: sub_65883A11+68j
					; sub_65883A11+72j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_65883A11	endp

; Exported entry  67. assuan_transact

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_transact(int, char	*, int,	int, int, int, int, int)
		public assuan_transact
assuan_transact	proc near

Str		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	assuan_write_line
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65883AB9
		mov	eax, [ebp+var_C]
		jmp	locret_65883D5E
; ---------------------------------------------------------------------------

loc_65883AB9:				; CODE XREF: assuan_transact+1Fj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	short loc_65883ACD
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_65883AD8

loc_65883ACD:				; CODE XREF: assuan_transact+31j
		mov	eax, 0
		jmp	locret_65883D5E
; ---------------------------------------------------------------------------

loc_65883AD7:				; CODE XREF: assuan_transact+2C5j
		nop

loc_65883AD8:				; CODE XREF: assuan_transact+3Bj
					; assuan_transact+118j	...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		shr	al, 3
		and	eax, 1
		movzx	eax, al
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65883A11
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65883B19
		mov	eax, [ebp+var_C]
		jmp	locret_65883D5E
; ---------------------------------------------------------------------------

loc_65883B19:				; CODE XREF: assuan_transact+7Fj
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+1B4h]
		mov	eax, [ebp+var_1C]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+5A0h]
		mov	eax, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_18]
		test	eax, eax
		jnz	short loc_65883B59
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax ; Str
		call	atoi
		mov	[ebp+var_C], eax
		jmp	loc_65883D5B
; ---------------------------------------------------------------------------

loc_65883B59:				; CODE XREF: assuan_transact+B4j
		mov	eax, [ebp+var_18]
		cmp	eax, 2
		jnz	short loc_65883BAD
		cmp	[ebp+arg_8], 0
		jnz	short loc_65883B82
		mov	[esp+38h+var_34], 109h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65883417
		mov	[ebp+var_C], eax
		jmp	loc_65883D5B
; ---------------------------------------------------------------------------

loc_65883B82:				; CODE XREF: assuan_transact+D5j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Str], eax
		mov	eax, [ebp+arg_8]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_65883D5B
		jmp	loc_65883AD8
; ---------------------------------------------------------------------------

loc_65883BAD:				; CODE XREF: assuan_transact+CFj
		mov	eax, [ebp+var_18]
		cmp	eax, 3
		jnz	loc_65883C94
		cmp	[ebp+arg_10], 0
		jnz	short loc_65883C0E
		mov	[esp+38h+var_34], offset aEnd ;	"END"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	assuan_write_line
		mov	[esp+38h+var_2C], 0
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65883A11
		mov	[esp+38h+var_34], 10Ah
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65883417
		mov	[ebp+var_C], eax
		jmp	loc_65883D5B
; ---------------------------------------------------------------------------

loc_65883C0E:				; CODE XREF: assuan_transact+12Dj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+Str], eax
		mov	eax, [ebp+arg_10]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_65883C49
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	short loc_65883C85
; ---------------------------------------------------------------------------

loc_65883C49:				; CODE XREF: assuan_transact+197j
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_send_data
		mov	[esp+38h+var_2C], 0
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65883A11

loc_65883C85:				; CODE XREF: assuan_transact+1B7j
		cmp	[ebp+var_C], 0
		jnz	loc_65883D5B
		jmp	loc_65883AD8
; ---------------------------------------------------------------------------

loc_65883C94:				; CODE XREF: assuan_transact+123j
		mov	eax, [ebp+var_18]
		cmp	eax, 4
		jnz	short loc_65883CC6
		cmp	[ebp+arg_18], 0
		jz	short loc_65883CB7
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+Str], eax
		mov	eax, [ebp+arg_18]
		call	eax
		mov	[ebp+var_C], eax

loc_65883CB7:				; CODE XREF: assuan_transact+210j
		cmp	[ebp+var_C], 0
		jnz	loc_65883D5B
		jmp	loc_65883AD8
; ---------------------------------------------------------------------------

loc_65883CC6:				; CODE XREF: assuan_transact+20Aj
		mov	eax, [ebp+var_18]
		cmp	eax, 6
		jnz	short loc_65883D0D
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 8
		test	al, al
		jz	short loc_65883D0D
		mov	eax, [ebp+var_1C]
		neg	eax
		add	[ebp+var_10], eax
		cmp	[ebp+arg_18], 0
		jz	short loc_65883D02
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+Str], eax
		mov	eax, [ebp+arg_18]
		call	eax
		mov	[ebp+var_C], eax

loc_65883D02:				; CODE XREF: assuan_transact+25Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_65883D5B
		jmp	loc_65883AD8
; ---------------------------------------------------------------------------

loc_65883D0D:				; CODE XREF: assuan_transact+23Cj
					; assuan_transact+24Dj
		mov	eax, [ebp+var_18]
		cmp	eax, 5
		jnz	short loc_65883D5B
		cmp	[ebp+arg_8], 0
		jnz	short loc_65883D33
		mov	[esp+38h+var_34], 109h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65883417
		mov	[ebp+var_C], eax
		jmp	short loc_65883D5B
; ---------------------------------------------------------------------------

loc_65883D33:				; CODE XREF: assuan_transact+289j
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Str], eax
		mov	eax, [ebp+arg_8]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_65883AD7

loc_65883D5B:				; CODE XREF: assuan_transact+C4j
					; assuan_transact+EDj ...
		mov	eax, [ebp+var_C]

locret_65883D5E:			; CODE XREF: assuan_transact+24j
					; assuan_transact+42j ...
		leave
		retn
assuan_transact	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883D60	proc near		; CODE XREF: sub_65883E6B+Cp
					; DATA XREF: assuan_init_pipe_server+255o ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1ACh]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_65883DBC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1ACh]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882627
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+1ACh]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		cmp	edx, eax
		jnz	short loc_65883DAF
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+998h], 0FFFFFFFFh

loc_65883DAF:				; CODE XREF: sub_65883D60+40j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1ACh], 0FFFFFFFFh

loc_65883DBC:				; CODE XREF: sub_65883D60+12j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_65883DEF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882627
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+998h], 0FFFFFFFFh

loc_65883DEF:				; CODE XREF: sub_65883D60+68j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D98h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_65883E53
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D98h]
		test	eax, eax
		jz	short loc_65883E53
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 1
		movzx	edx, al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D98h]
		mov	[esp+28h+var_18], 0
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882A45
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D98h], 0FFFFFFFFh

loc_65883E53:				; CODE XREF: sub_65883D60+9Bj
					; sub_65883D60+A8j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65889A74
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_658878B2
		leave
		retn
sub_65883D60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883E6B	proc near		; DATA XREF: assuan_init_pipe_server+1A0o
					; assuan_init_socket_server+131o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65883D60
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A4h]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65882313
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1A4h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A8h]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65882313
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1A8h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EB8h]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65882313
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EB8h], 0
		leave
		retn
sub_65883E6B	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883EF0	proc near		; CODE XREF: sub_65883EFD+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_65883EF0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883EFD	proc near		; CODE XREF: assuan_client_read_response+41p
					; assuan_read_line+3Cp	...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	sub_65883EF0
		cmp	eax, 8006h
		jnz	short loc_65883F2F
		mov	[esp+18h+var_14], 186A0h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_6588245A
		mov	eax, 1
		jmp	short locret_65883F34
; ---------------------------------------------------------------------------

loc_65883F2F:				; CODE XREF: sub_65883EFD+16j
		mov	eax, 0

locret_65883F34:			; CODE XREF: sub_65883EFD+30j
		leave
		retn
sub_65883EFD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_65883F36(int,	DWORD)
sub_65883F36	proc near		; CODE XREF: __assuan_pipe+65p
					; __assuan_pipe+11Ap ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_65883F4C
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_4], eax

loc_65883F4C:				; CODE XREF: sub_65883F36+Aj
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], edx	; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, [ebp+arg_0]
		add	eax, 4
		leave
		retn
sub_65883F36	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883F98	proc near		; CODE XREF: sub_65883FBF+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_65883FB8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_65883FBD
; ---------------------------------------------------------------------------

loc_65883FB8:				; CODE XREF: sub_65883F98+7j
		mov	eax, 0

loc_65883FBD:				; CODE XREF: sub_65883F98+1Ej
		pop	ebp
		retn
sub_65883F98	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883FBF	proc near		; CODE XREF: sub_6588412E+3Ep
					; sub_6588412E+239p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_65883FD2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_65883FD7
; ---------------------------------------------------------------------------

loc_65883FD2:				; CODE XREF: sub_65883FBF+Aj
		mov	eax, 0Fh

loc_65883FD7:				; CODE XREF: sub_65883FBF+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_65883F98
		leave
		retn
sub_65883FBF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65883FE8	proc near		; CODE XREF: sub_658846B6+16Cp
					; sub_658846B6+1B9p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_6588403C
; ---------------------------------------------------------------------------

loc_65883FF0:				; CODE XREF: sub_65883FE8+58j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+16Ch]
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_6588402D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_6588403B
		mov	eax, 0FFFFFFFFh
		jmp	short locret_65884047
; ---------------------------------------------------------------------------

loc_6588402D:				; CODE XREF: sub_65883FE8+2Ej
		mov	eax, [ebp+var_C]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+var_C]
		add	[ebp+arg_4], eax
		jmp	short loc_6588403C
; ---------------------------------------------------------------------------

loc_6588403B:				; CODE XREF: sub_65883FE8+3Cj
		nop

loc_6588403C:				; CODE XREF: sub_65883FE8+6j
					; sub_65883FE8+51j
		cmp	[ebp+arg_8], 0
		jnz	short loc_65883FF0
		mov	eax, 0

locret_65884047:			; CODE XREF: sub_65883FE8+43j
		leave
		retn
sub_65883FE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65884049	proc near		; CODE XREF: sub_6588412E+117p
					; sub_6588412E+149p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		jmp	loc_6588411A
; ---------------------------------------------------------------------------

loc_6588406C:				; CODE XREF: sub_65884049+D5j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+168h]
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_658840C2
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_65884119
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 20h
		jnz	short loc_658840BB
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		jmp	short loc_65884127
; ---------------------------------------------------------------------------

loc_658840BB:				; CODE XREF: sub_65884049+65j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588412C
; ---------------------------------------------------------------------------

loc_658840C2:				; CODE XREF: sub_65884049+49j
		cmp	[ebp+var_10], 0
		jnz	short loc_658840D3
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		jmp	short loc_65884127
; ---------------------------------------------------------------------------

loc_658840D3:				; CODE XREF: sub_65884049+7Dj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0Ah
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_6588CBD4
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_65884126
		jmp	short loc_6588411A
; ---------------------------------------------------------------------------

loc_65884119:				; CODE XREF: sub_65884049+57j
		nop

loc_6588411A:				; CODE XREF: sub_65884049+1Ej
					; sub_65884049+CEj
		cmp	[ebp+var_C], 0
		jnz	loc_6588406C
		jmp	short loc_65884127
; ---------------------------------------------------------------------------

loc_65884126:				; CODE XREF: sub_65884049+CCj
		nop

loc_65884127:				; CODE XREF: sub_65884049+70j
					; sub_65884049+88j ...
		mov	eax, 0

locret_6588412C:			; CODE XREF: sub_65884049+77j
		leave
		retn
sub_65884049	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588412E	proc near		; CODE XREF: assuan_client_read_response+2Cp
					; assuan_read_line+27p	...

Dst		= dword	ptr -0B8h
Src		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_AC		= byte ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_90		= byte ptr -90h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Buf		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
MaxCount	= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0B4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		add	eax, 1B4h
		mov	[ebp+Buf], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1B0h]
		test	eax, eax
		jz	short loc_65884176
		mov	[esp+0B8h+Src],	3FFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65883FBF
		jmp	loc_65884621
; ---------------------------------------------------------------------------

loc_65884176:				; CODE XREF: sub_6588412E+2Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+990h]
		mov	[ebp+MaxCount],	eax
		cmp	[ebp+MaxCount],	0
		jz	loc_6588424F
		mov	ecx, [ebp+MaxCount]
		mov	eax, [ebp+arg_0]
		add	eax, 5A4h
		mov	edx, eax
		mov	eax, [ebp+Buf]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+990h], 0
		mov	eax, [ebp+MaxCount]
		mov	[esp+0B8h+Size], eax ; MaxCount
		mov	[esp+0B8h+Src],	0Ah ; Val
		mov	eax, [ebp+Buf]
		mov	[esp+0B8h+Dst],	eax ; Buf
		call	memchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_658841EE
		mov	eax, [ebp+MaxCount]
		mov	[ebp+var_2C], eax
		mov	[ebp+MaxCount],	0
		jmp	loc_6588427F
; ---------------------------------------------------------------------------

loc_658841EE:				; CODE XREF: sub_6588412E+ACj
		cmp	[ebp+MaxCount],	3E9h
		jle	short loc_65884213
		mov	[esp+0B8h+Size], 8Eh ; int
		mov	[esp+0B8h+Src],	offset a____Libassuan2 ; "../../libassuan-2.4.2/src/assuan-buffer"...
		mov	[esp+0B8h+Dst],	offset aAtticlenLinele ; "atticlen < LINELENGTH"
		call	sub_6588E340

loc_65884213:				; CODE XREF: sub_6588412E+C7j
		mov	eax, [ebp+arg_0]
		lea	ecx, [eax+1B0h]
		mov	eax, 3EAh
		sub	eax, [ebp+MaxCount]
		mov	edx, eax
		mov	eax, [ebp+MaxCount]
		add	eax, [ebp+Buf]
		mov	[esp+0B8h+var_A8], ecx
		lea	ecx, [ebp+var_2C]
		mov	dword ptr [esp+0B8h+var_AC], ecx
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65884049
		mov	[ebp+var_C], eax
		jmp	short loc_6588427F
; ---------------------------------------------------------------------------

loc_6588424F:				; CODE XREF: sub_6588412E+58j
		mov	eax, [ebp+arg_0]
		add	eax, 1B0h
		mov	[esp+0B8h+var_A8], eax
		lea	eax, [ebp+var_2C]
		mov	dword ptr [esp+0B8h+var_AC], eax
		mov	[esp+0B8h+Size], 3EAh
		mov	eax, [ebp+Buf]
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65884049
		mov	[ebp+var_C], eax

loc_6588427F:				; CODE XREF: sub_6588412E+BBj
					; sub_6588412E+11Fj
		cmp	[ebp+var_C], 0
		jz	loc_65884371
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+0B8h+Dst],	eax ; int
		call	strerror
		mov	edx, offset aErrorS ; "error: %s"
		mov	dword ptr [esp+0B8h+var_AC], eax ; char
		mov	[esp+0B8h+Size], edx ; char *
		mov	[esp+0B8h+Src],	64h ; size_t
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+Dst],	eax ; char *
		call	sub_6588E410
		mov	[esp+0B8h+var_A0], 0
		mov	[esp+0B8h+var_A4], 0
		mov	[esp+0B8h+var_A8], 0
		mov	dword ptr [esp+0B8h+var_AC], 0
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+Size], eax
		mov	[esp+0B8h+Src],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65889CFE
		cmp	[ebp+var_20], 0Bh
		jnz	short loc_6588434D
		mov	eax, [ebp+var_2C]
		add	eax, [ebp+MaxCount]
		mov	ecx, eax
		mov	edx, [ebp+Buf]
		mov	eax, [ebp+arg_0]
		add	eax, 5A4h
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+994h], 0
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		add	edx, [ebp+MaxCount]
		mov	eax, [ebp+arg_0]
		mov	[eax+990h], edx

loc_6588434D:				; CODE XREF: sub_6588412E+1DCj
		mov	eax, [ebp+var_20]
		mov	[esp+0B8h+Dst],	eax
		call	gpg_err_set_errno
		call	gpg_err_code_from_syserror
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65883FBF
		jmp	loc_65884621
; ---------------------------------------------------------------------------

loc_65884371:				; CODE XREF: sub_6588412E+155j
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_658843F4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1B0h]
		test	eax, eax
		jnz	short loc_658843A1
		mov	[esp+0B8h+Size], 0AEh ;	int
		mov	[esp+0B8h+Src],	offset a____Libassuan2 ; "../../libassuan-2.4.2/src/assuan-buffer"...
		mov	[esp+0B8h+Dst],	offset aCtxInbound_eof ; "ctx->inbound.eof"
		call	sub_6588E340

loc_658843A1:				; CODE XREF: sub_6588412E+255j
		mov	[esp+0B8h+var_A0], 0
		mov	[esp+0B8h+var_A4], 0
		mov	[esp+0B8h+var_A8], 0
		mov	dword ptr [esp+0B8h+var_AC], 0
		mov	[esp+0B8h+Size], offset	aEof ; "eof"
		mov	[esp+0B8h+Src],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65889CFE
		mov	[esp+0B8h+Src],	3FFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65883FBF
		jmp	loc_65884621
; ---------------------------------------------------------------------------

loc_658843F4:				; CODE XREF: sub_6588412E+248j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+994h], 0
		mov	eax, [ebp+var_2C]
		add	eax, [ebp+MaxCount]
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_6588442D
		mov	eax, [ebp+var_2C]
		mov	[esp+0B8h+Size], eax ; MaxCount
		mov	[esp+0B8h+Src],	0Ah ; Val
		mov	eax, [ebp+Buf]
		mov	[esp+0B8h+Dst],	eax ; Buf
		call	memchr
		mov	[ebp+var_14], eax

loc_6588442D:				; CODE XREF: sub_6588412E+2E0j
		cmp	[ebp+var_14], 0
		jz	loc_658845AB
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+Buf]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		cmp	[ebp+var_24], eax
		jge	short loc_658844B5
		mov	eax, [ebp+var_2C]
		sub	eax, [ebp+var_24]
		mov	[ebp+var_28], eax
		mov	ecx, [ebp+var_28]
		mov	eax, [ebp+var_14]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		add	eax, 5A4h
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_14]
		add	edx, 1
		mov	[esp+0B8h+Size], eax
		mov	[esp+0B8h+Src],	0Ah
		mov	[esp+0B8h+Dst],	edx
		call	sub_6588CBD4
		test	eax, eax
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+arg_0]
		mov	[eax+994h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_28]
		mov	[eax+990h], edx

loc_658844B5:				; CODE XREF: sub_6588412E+321j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+Buf]
		jz	short loc_658844CE
		mov	eax, [ebp+var_14]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_658844CE
		sub	[ebp+var_14], 1

loc_658844CE:				; CODE XREF: sub_6588412E+38Dj
					; sub_6588412E+39Aj
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+Buf]
		sub	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+5A0h], edx
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+120h]
		test	eax, eax
		jz	short loc_6588453E
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+120h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		lea	ebx, [eax+1B4h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+124h]
		mov	[esp+0B8h+var_A8], edx
		mov	dword ptr [esp+0B8h+var_AC], ebx
		mov	[esp+0B8h+Size], 0
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	ecx
		mov	[ebp+var_18], eax

loc_6588453E:				; CODE XREF: sub_6588412E+3C9j
		mov	eax, [ebp+var_18]
		and	eax, 2
		test	eax, eax
		jz	short loc_65884555
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+5A0h], 0

loc_65884555:				; CODE XREF: sub_6588412E+418j
		mov	eax, [ebp+var_18]
		and	eax, 1
		test	eax, eax
		jnz	short loc_658845A4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		mov	edx, [ebp+arg_0]
		add	edx, 1B4h
		mov	[esp+0B8h+var_A0], 0
		mov	[esp+0B8h+var_A4], 0
		mov	[esp+0B8h+var_A8], eax
		mov	dword ptr [esp+0B8h+var_AC], edx
		mov	[esp+0B8h+Size], 0
		mov	[esp+0B8h+Src],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65889CFE

loc_658845A4:				; CODE XREF: sub_6588412E+42Fj
		mov	eax, 0
		jmp	short loc_65884621
; ---------------------------------------------------------------------------

loc_658845AB:				; CODE XREF: sub_6588412E+303j
		mov	[esp+0B8h+var_A0], 0
		mov	[esp+0B8h+var_A4], 0
		mov	[esp+0B8h+var_A8], 0
		mov	dword ptr [esp+0B8h+var_AC], 0
		mov	[esp+0B8h+Size], offset	aInvalidLine ; "invalid	line"
		mov	[esp+0B8h+Src],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65889CFE
		mov	eax, [ebp+Buf]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+5A0h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1B0h]
		test	eax, eax
		jz	short loc_6588460D
		mov	eax, 106h
		jmp	short loc_65884612
; ---------------------------------------------------------------------------

loc_6588460D:				; CODE XREF: sub_6588412E+4D6j
		mov	eax, 107h

loc_65884612:				; CODE XREF: sub_6588412E+4DDj
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_65883FBF

loc_65884621:				; CODE XREF: sub_6588412E+43j
					; sub_6588412E+23Ej ...
		add	esp, 0B4h
		pop	ebx
		pop	ebp
		retn
sub_6588412E	endp

; Exported entry  32. assuan_read_line

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_read_line
assuan_read_line proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_6588464B
		mov	[esp+28h+var_24], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65883FBF
		jmp	short locret_65884690
; ---------------------------------------------------------------------------

loc_6588464B:				; CODE XREF: assuan_read_line+Aj
					; assuan_read_line+43j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_6588412E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65883EFD
		test	eax, eax
		jnz	short loc_6588464B
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+1B4h]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_C]

locret_65884690:			; CODE XREF: assuan_read_line+1Fj
		leave
		retn
assuan_read_line endp

; Exported entry  27. assuan_pending_line

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_pending_line
assuan_pending_line proc near		; CODE XREF: assuan_process_next+49p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_658846AF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+994h]
		test	eax, eax
		jz	short loc_658846AF
		mov	eax, 1
		jmp	short loc_658846B4
; ---------------------------------------------------------------------------

loc_658846AF:				; CODE XREF: assuan_pending_line+7j
					; assuan_pending_line+14j
		mov	eax, 0

loc_658846B4:				; CODE XREF: assuan_pending_line+1Bj
		pop	ebp
		retn
assuan_pending_line endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658846B6	proc near		; CODE XREF: assuan_write_line+CEp
					; assuan_accept+100p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_658846EB
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		jmp	short loc_658846F0
; ---------------------------------------------------------------------------

loc_658846EB:				; CODE XREF: sub_658846B6+12j
		mov	eax, 0

loc_658846F0:				; CODE XREF: sub_658846B6+33j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		add	eax, edx
		add	eax, 2
		cmp	eax, 3EAh
		jbe	short loc_65884765
		mov	[esp+48h+var_30], 0
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], offset aSuppliedLineTo ; "supplied line too long - truncated"
		mov	[esp+48h+var_44], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65889CFE
		cmp	[ebp+var_10], 5
		jbe	short loc_6588474D
		mov	[ebp+var_10], 5

loc_6588474D:				; CODE XREF: sub_658846B6+8Ej
		mov	eax, 3E8h
		sub	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_C]
		jnb	short loc_65884765
		mov	eax, 3E7h
		sub	eax, [ebp+var_10]
		mov	[ebp+arg_C], eax

loc_65884765:				; CODE XREF: sub_658846B6+4Dj
					; sub_658846B6+A2j
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+120h]
		test	eax, eax
		jz	short loc_658847B0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+120h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+124h]
		mov	edx, [ebp+arg_C]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	ecx
		mov	[ebp+var_14], eax

loc_658847B0:				; CODE XREF: sub_658846B6+C1j
		mov	eax, [ebp+var_14]
		and	eax, 1
		test	eax, eax
		jnz	short loc_658847FE
		cmp	[ebp+var_10], 0
		jz	short loc_658847C5
		mov	eax, [ebp+arg_4]
		jmp	short loc_658847CA
; ---------------------------------------------------------------------------

loc_658847C5:				; CODE XREF: sub_658846B6+108j
		mov	eax, 0

loc_658847CA:				; CODE XREF: sub_658846B6+10Dj
		mov	edx, [ebp+arg_C]
		mov	[esp+48h+var_30], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65889CFE

loc_658847FE:				; CODE XREF: sub_658846B6+102j
		cmp	[ebp+var_10], 0
		jz	short loc_65884847
		mov	eax, [ebp+var_14]
		and	eax, 2
		test	eax, eax
		jnz	short loc_65884847
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65883FE8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65884847
		call	gpg_err_code_from_syserror
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65883FBF
		mov	[ebp+var_C], eax

loc_65884847:				; CODE XREF: sub_658846B6+14Cj
					; sub_658846B6+156j ...
		cmp	[ebp+var_C], 0
		jnz	loc_658848D5
		mov	eax, [ebp+var_14]
		and	eax, 2
		test	eax, eax
		jnz	short loc_658848D5
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65883FE8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65884894
		call	gpg_err_code_from_syserror
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65883FBF
		mov	[ebp+var_C], eax

loc_65884894:				; CODE XREF: sub_658846B6+1C5j
		cmp	[ebp+var_C], 0
		jnz	short loc_658848D5
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+var_44], offset asc_658907D7 ;	"\n"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65883FE8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_658848D5
		call	gpg_err_code_from_syserror
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65883FBF
		mov	[ebp+var_C], eax

loc_658848D5:				; CODE XREF: sub_658846B6+195j
					; sub_658846B6+1A3j ...
		mov	eax, [ebp+var_C]
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_658846B6	endp

; Exported entry  68. assuan_write_line

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_write_line(int, char *)
		public assuan_write_line
assuan_write_line proc near		; CODE XREF: sub_65883540+14p
					; assuan_transact+13p ...

Str		= dword	ptr -48h
Val		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	[ebp+arg_0], 0
		jnz	short loc_65884903
		mov	[esp+48h+Val], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	sub_65883FBF
		jmp	loc_658849B1
; ---------------------------------------------------------------------------

loc_65884903:				; CODE XREF: assuan_write_line+Bj
		mov	[esp+48h+Val], 0Ah ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588492D
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_6588494C
; ---------------------------------------------------------------------------

loc_6588492D:				; CODE XREF: assuan_write_line+3Fj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1

loc_6588494C:				; CODE XREF: assuan_write_line+4Dj
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65884990
		mov	[esp+48h+var_30], 0
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], offset aSuppliedLineWi ; "supplied line with LF - truncated"
		mov	[esp+48h+Val], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	sub_65889CFE

loc_65884990:				; CODE XREF: assuan_write_line+75j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	sub_658846B6

loc_658849B1:				; CODE XREF: assuan_write_line+20j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
assuan_write_line endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658849B7	proc near		; CODE XREF: assuan_send_data+B5p

Dest		= dword	ptr -48h
Format		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0D90h]
		test	eax, eax
		jz	short loc_658849E1
		mov	eax, 0
		jmp	loc_65884BC2
; ---------------------------------------------------------------------------

loc_658849E1:				; CODE XREF: sub_658849B7+1Ej
		mov	eax, [ebp+var_1C]
		add	eax, 9A0h
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0D8Ch]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		add	[ebp+var_10], eax
		jmp	loc_65884BA9
; ---------------------------------------------------------------------------

loc_65884A03:				; CODE XREF: sub_658849B7+1F6j
		cmp	[ebp+var_14], 0
		jnz	loc_65884A8F
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	44h
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	20h
		add	[ebp+var_10], 1
		add	[ebp+var_14], 2
		jmp	short loc_65884A8F
; ---------------------------------------------------------------------------

loc_65884A27:				; CODE XREF: sub_658849B7+E5j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_65884A45
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_65884A45
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_65884A74

loc_65884A45:				; CODE XREF: sub_658849B7+78j
					; sub_658849B7+82j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset Format ; "%%%02X"
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+Format], eax ;	Format
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_10], 3
		add	[ebp+var_14], 3
		add	[ebp+arg_4], 1
		jmp	short loc_65884A8B
; ---------------------------------------------------------------------------

loc_65884A74:				; CODE XREF: sub_658849B7+8Cj
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+arg_4], 1
		add	[ebp+var_14], 1

loc_65884A8B:				; CODE XREF: sub_658849B7+BBj
		sub	[ebp+var_C], 1

loc_65884A8F:				; CODE XREF: sub_658849B7+50j
					; sub_658849B7+6Ej
		cmp	[ebp+var_C], 0
		jz	short loc_65884A9E
		cmp	[ebp+var_14], 3E5h
		jbe	short loc_65884A27

loc_65884A9E:				; CODE XREF: sub_658849B7+DCj
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+120h]
		test	eax, eax
		jz	short loc_65884AEF
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+120h]
		mov	eax, [ebp+var_1C]
		lea	ebx, [eax+9A0h]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+124h]
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], ebx
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+Format], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	ecx
		mov	[ebp+var_18], eax

loc_65884AEF:				; CODE XREF: sub_658849B7+F9j
		cmp	[ebp+var_14], 3E5h
		jbe	loc_65884BA9
		mov	eax, [ebp+var_18]
		and	eax, 1
		test	eax, eax
		jnz	short loc_65884B45
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+9A0h]
		mov	[esp+48h+var_30], 0
		mov	[esp+48h+var_34], 0
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+Format], 1
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	sub_65889CFE

loc_65884B45:				; CODE XREF: sub_658849B7+14Dj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0Ah
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_18]
		and	eax, 2
		test	eax, eax
		jnz	short loc_65884B97
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+9A0h]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+Format], edx
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	sub_65883FE8
		test	eax, eax
		jz	short loc_65884B97
		call	gpg_err_code_from_syserror
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[eax+0D90h], edx
		mov	eax, 0
		jmp	short loc_65884BC2
; ---------------------------------------------------------------------------

loc_65884B97:				; CODE XREF: sub_658849B7+1A4j
					; sub_658849B7+1C7j
		mov	eax, [ebp+var_1C]
		add	eax, 9A0h
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0

loc_65884BA9:				; CODE XREF: sub_658849B7+47j
					; sub_658849B7+13Fj
		cmp	[ebp+var_C], 0
		jnz	loc_65884A03
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	[eax+0D8Ch], edx
		mov	eax, [ebp+arg_8]

loc_65884BC2:				; CODE XREF: sub_658849B7+25j
					; sub_658849B7+1DEj
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_658849B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65884BC8	proc near		; CODE XREF: assuan_send_data+54p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0D90h]
		test	eax, eax
		jz	short loc_65884BEC
		mov	eax, 0
		jmp	loc_65884D11
; ---------------------------------------------------------------------------

loc_65884BEC:				; CODE XREF: sub_65884BC8+18j
		mov	eax, [ebp+var_10]
		add	eax, 9A0h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0D8Ch]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		add	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+120h]
		test	eax, eax
		jz	short loc_65884C5A
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+120h]
		mov	eax, [ebp+var_10]
		lea	ebx, [eax+9A0h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+124h]
		mov	edx, [ebp+var_18]
		mov	[esp+38h+var_28], edx
		mov	[esp+38h+var_2C], ebx
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	ecx
		mov	[ebp+var_C], eax

loc_65884C5A:				; CODE XREF: sub_65884BC8+53j
		cmp	[ebp+var_18], 0
		jz	loc_65884D0C
		mov	eax, [ebp+var_C]
		and	eax, 1
		test	eax, eax
		jnz	short loc_65884CAD
		mov	eax, [ebp+var_10]
		lea	edx, [eax+9A0h]
		mov	[esp+38h+var_20], 0
		mov	[esp+38h+var_24], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax
		mov	[esp+38h+var_2C], edx
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_65889CFE

loc_65884CAD:				; CODE XREF: sub_65884BC8+A4j
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0Ah
		add	[ebp+var_14], 1
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		and	eax, 2
		test	eax, eax
		jnz	short loc_65884CFF
		mov	eax, [ebp+var_10]
		lea	edx, [eax+9A0h]
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], edx
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_65883FE8
		test	eax, eax
		jz	short loc_65884CFF
		call	gpg_err_code_from_syserror
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+0D90h], edx
		mov	eax, 0
		jmp	short loc_65884D11
; ---------------------------------------------------------------------------

loc_65884CFF:				; CODE XREF: sub_65884BC8+FBj
					; sub_65884BC8+11Ej
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0D8Ch], 0

loc_65884D0C:				; CODE XREF: sub_65884BC8+96j
		mov	eax, 0

loc_65884D11:				; CODE XREF: sub_65884BC8+1Fj
					; sub_65884BC8+135j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_65884BC8	endp

; Exported entry  43. assuan_send_data

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_send_data
assuan_send_data proc near		; CODE XREF: assuan_transact+1AFp
					; assuan_transact+1CFp	...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_65884D3B
		mov	[esp+18h+var_14], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65883FBF
		jmp	locret_65884DEE
; ---------------------------------------------------------------------------

loc_65884D3B:				; CODE XREF: assuan_send_data+Aj
		cmp	[ebp+arg_4], 0
		jnz	short loc_65884D5F
		cmp	[ebp+arg_8], 1
		jbe	short loc_65884D5F
		mov	[esp+18h+var_14], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65883FBF
		jmp	locret_65884DEE
; ---------------------------------------------------------------------------

loc_65884D5F:				; CODE XREF: assuan_send_data+28j
					; assuan_send_data+2Ej
		cmp	[ebp+arg_4], 0
		jnz	short loc_65884DB8
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884BC8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D90h]
		test	eax, eax
		jz	short loc_65884D88
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D90h]
		jmp	short locret_65884DEE
; ---------------------------------------------------------------------------

loc_65884D88:				; CODE XREF: assuan_send_data+64j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+184h]
		test	eax, eax
		jnz	short loc_65884DE9
		cmp	[ebp+arg_8], 1
		jnz	short loc_65884DA2
		mov	eax, offset aCan ; "CAN"
		jmp	short loc_65884DA7
; ---------------------------------------------------------------------------

loc_65884DA2:				; CODE XREF: assuan_send_data+82j
		mov	eax, offset aEnd_0 ; "END"

loc_65884DA7:				; CODE XREF: assuan_send_data+89j
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	assuan_write_line
		jmp	short locret_65884DEE
; ---------------------------------------------------------------------------

loc_65884DB8:				; CODE XREF: assuan_send_data+4Cj
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_658849B7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D90h]
		test	eax, eax
		jz	short loc_65884DE9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D90h]
		jmp	short locret_65884DEE
; ---------------------------------------------------------------------------

loc_65884DE9:				; CODE XREF: assuan_send_data+7Cj
					; assuan_send_data+C5j
		mov	eax, 0

locret_65884DEE:			; CODE XREF: assuan_send_data+1Fj
					; assuan_send_data+43j	...
		leave
		retn
assuan_send_data endp

; Exported entry  44. assuan_sendfd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sendfd
assuan_sendfd	proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_65884E17
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_65884E17
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65883FBF
		jmp	short locret_65884E83
; ---------------------------------------------------------------------------

loc_65884E17:				; CODE XREF: assuan_sendfd+Aj
					; assuan_sendfd+10j
		cmp	[ebp+arg_0], 0
		jnz	short loc_65884E32
		mov	[esp+18h+var_14], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65883FBF
		jmp	short locret_65884E83
; ---------------------------------------------------------------------------

loc_65884E32:				; CODE XREF: assuan_sendfd+2Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+170h]
		test	eax, eax
		jnz	short loc_65884E6B
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65883FBF
		mov	[esp+18h+var_10], offset aServerDoesNotS ; "server does	not support sending and	rec"...
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error
		jmp	short locret_65884E83
; ---------------------------------------------------------------------------

loc_65884E6B:				; CODE XREF: assuan_sendfd+4Dj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+170h]
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx

locret_65884E83:			; CODE XREF: assuan_sendfd+25j
					; assuan_sendfd+40j ...
		leave
		retn
assuan_sendfd	endp

; Exported entry  33. assuan_receivefd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_receivefd
assuan_receivefd proc near		; CODE XREF: assuan_command_parse_fd+1FFp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_65884EA6
		mov	[esp+18h+var_14], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65883FBF
		jmp	short locret_65884EF7
; ---------------------------------------------------------------------------

loc_65884EA6:				; CODE XREF: assuan_receivefd+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+174h]
		test	eax, eax
		jnz	short loc_65884EDF
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65883FBF
		mov	[esp+18h+var_10], offset aServerDoesNotS ; "server does	not support sending and	rec"...
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error
		jmp	short locret_65884EF7
; ---------------------------------------------------------------------------

loc_65884EDF:				; CODE XREF: assuan_receivefd+2Cj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+174h]
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx

locret_65884EF7:			; CODE XREF: assuan_receivefd+1Fj
					; assuan_receivefd+58j
		leave
		retn
assuan_receivefd endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65884EFC	proc near		; CODE XREF: sub_65884F30+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_65884F1C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_65884F21
; ---------------------------------------------------------------------------

loc_65884F1C:				; CODE XREF: sub_65884EFC+7j
		mov	eax, 0

loc_65884F21:				; CODE XREF: sub_65884EFC+1Ej
		pop	ebp
		retn
sub_65884EFC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65884F23	proc near		; CODE XREF: sub_65886A4D+3Ap
					; sub_65886C23+55p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_65884F23	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65884F30	proc near		; CODE XREF: sub_65884F59+21p
					; sub_65884F59+5Cp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_65884F43
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_65884F48
; ---------------------------------------------------------------------------

loc_65884F43:				; CODE XREF: sub_65884F30+Aj
		mov	eax, 0Fh

loc_65884F48:				; CODE XREF: sub_65884F30+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_65884EFC
		leave
		retn
sub_65884F30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65884F59	proc near		; DATA XREF: assuan_register_command+E1o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65884FA7
		mov	[esp+18h+var_14], 50h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884F30
		mov	[esp+18h+var_10], offset aNoHandlerRegis ; "no handler registered"
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_process_done
		jmp	short locret_65884FD1
; ---------------------------------------------------------------------------

loc_65884FA7:				; CODE XREF: sub_65884F59+11j
		mov	[esp+18h+var_14], 50h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884F30
		mov	[esp+18h+var_10], offset aNoHandlerRegis ; "no handler registered"
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error

locret_65884FD1:			; CODE XREF: sub_65884F59+4Cj
		leave
		retn
sub_65884F59	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65884FD3	proc near		; DATA XREF: .data:6588F044o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65884FFB
		mov	[esp+18h+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_process_done
		jmp	short locret_65885000
; ---------------------------------------------------------------------------

loc_65884FFB:				; CODE XREF: sub_65884FD3+11j
		mov	eax, 0

locret_65885000:			; CODE XREF: sub_65884FD3+26j
		leave
		retn
sub_65884FD3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65885002	proc near		; DATA XREF: .data:6588F054o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0ED0h]
		test	eax, eax
		jz	short loc_6588502D
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0ED0h]
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx

loc_6588502D:				; CODE XREF: sub_65885002+11j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885075
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884F30
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_process_done
		jmp	short locret_6588509F
; ---------------------------------------------------------------------------

loc_65885075:				; CODE XREF: sub_65885002+36j
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884F30
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error

locret_6588509F:			; CODE XREF: sub_65885002+71j
		leave
		retn
sub_65885002	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658850A1	proc near		; DATA XREF: .data:6588F064o

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_658850B4
; ---------------------------------------------------------------------------

loc_658850B0:				; CODE XREF: sub_658850A1+1Bj
					; sub_658850A1+25j
		add	[ebp+var_C], 1

loc_658850B4:				; CODE XREF: sub_658850A1+Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_658850B0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_658850B0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_65885149
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_6588511A
		mov	[esp+38h+var_34], 114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aArgumentRequir ; "argument required"
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_set_error
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_process_done
		jmp	short loc_65885144
; ---------------------------------------------------------------------------

loc_6588511A:				; CODE XREF: sub_658850A1+3Cj
		mov	[esp+38h+var_34], 114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aArgumentRequir ; "argument required"
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_set_error

loc_65885144:				; CODE XREF: sub_658850A1+77j
		jmp	loc_6588549B
; ---------------------------------------------------------------------------

loc_65885149:				; CODE XREF: sub_658850A1+2Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_658851CA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_6588519B
		mov	[esp+38h+var_34], 114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aNoOptionNameGi ; "no option name given"
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_set_error
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_process_done
		jmp	short loc_658851C5
; ---------------------------------------------------------------------------

loc_6588519B:				; CODE XREF: sub_658850A1+BDj
		mov	[esp+38h+var_34], 114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aNoOptionNameGi ; "no option name given"
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_set_error

loc_658851C5:				; CODE XREF: sub_658850A1+F8j
		jmp	loc_6588549B
; ---------------------------------------------------------------------------

loc_658851CA:				; CODE XREF: sub_658850A1+B0j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_658851D6
; ---------------------------------------------------------------------------

loc_658851D2:				; CODE XREF: sub_658850A1+15Bj
		add	[ebp+var_10], 1

loc_658851D6:				; CODE XREF: sub_658850A1+12Fj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_658851FE
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_658851FE
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_658851FE
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_658851D2

loc_658851FE:				; CODE XREF: sub_658850A1+13Dj
					; sub_658850A1+147j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_65885360
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_65885220
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_65885232

loc_65885220:				; CODE XREF: sub_658850A1+173j
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		jmp	short loc_65885232
; ---------------------------------------------------------------------------

loc_6588522C:				; CODE XREF: sub_658850A1+19Aj
					; sub_658850A1+1A4j
		add	[ebp+var_10], 1
		jmp	short loc_65885233
; ---------------------------------------------------------------------------

loc_65885232:				; CODE XREF: sub_658850A1+17Dj
					; sub_658850A1+189j
		nop

loc_65885233:				; CODE XREF: sub_658850A1+18Fj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_6588522C
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_6588522C
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	loc_658852FA
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		jmp	short loc_65885265
; ---------------------------------------------------------------------------

loc_65885261:				; CODE XREF: sub_658850A1+1CCj
					; sub_658850A1+1D6j
		add	[ebp+var_10], 1

loc_65885265:				; CODE XREF: sub_658850A1+1BEj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_65885261
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_65885261
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_658852FA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_658852CB
		mov	[esp+38h+var_34], 114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aOptionArgument ; "option argument expected"
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_set_error
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_process_done
		jmp	short loc_658852F5
; ---------------------------------------------------------------------------

loc_658852CB:				; CODE XREF: sub_658850A1+1EDj
		mov	[esp+38h+var_34], 114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aOptionArgument ; "option argument expected"
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_set_error

loc_658852F5:				; CODE XREF: sub_658850A1+228j
		jmp	loc_6588549B
; ---------------------------------------------------------------------------

loc_658852FA:				; CODE XREF: sub_658850A1+1AEj
					; sub_658850A1+1E0j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_65885360
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_65885332
; ---------------------------------------------------------------------------

loc_6588532E:				; CODE XREF: sub_658850A1+2A1j
					; sub_658850A1+2ABj
		sub	[ebp+var_14], 1

loc_65885332:				; CODE XREF: sub_658850A1+28Bj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jbe	short loc_6588534E
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_6588532E
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_6588532E

loc_6588534E:				; CODE XREF: sub_658850A1+297j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jbe	short loc_65885360
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_65885360:				; CODE XREF: sub_658850A1+165j
					; sub_658850A1+261j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_65885388
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_65885388
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_65885388
		add	[ebp+var_C], 2

loc_65885388:				; CODE XREF: sub_658850A1+2C7j
					; sub_658850A1+2D4j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_65885409
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_658853DA
		mov	[esp+38h+var_34], 114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aOptionShouldNo ; "option should not begin with one dash"
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_set_error
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_process_done
		jmp	short loc_65885404
; ---------------------------------------------------------------------------

loc_658853DA:				; CODE XREF: sub_658850A1+2FCj
		mov	[esp+38h+var_34], 114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aOptionShouldNo ; "option should not begin with one dash"
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_set_error

loc_65885404:				; CODE XREF: sub_658850A1+337j
		jmp	loc_6588549B
; ---------------------------------------------------------------------------

loc_65885409:				; CODE XREF: sub_658850A1+2EFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0ED4h]
		test	eax, eax
		jz	short loc_65885474
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885453
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0ED4h]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_process_done
		jmp	short loc_65885472
; ---------------------------------------------------------------------------

loc_65885453:				; CODE XREF: sub_658850A1+380j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0ED4h]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx

loc_65885472:				; CODE XREF: sub_658850A1+3B0j
		jmp	short loc_6588549B
; ---------------------------------------------------------------------------

loc_65885474:				; CODE XREF: sub_658850A1+373j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885496
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_process_done
		jmp	short loc_6588549B
; ---------------------------------------------------------------------------

loc_65885496:				; CODE XREF: sub_658850A1+3DEj
		mov	eax, 0

loc_6588549B:				; CODE XREF: sub_658850A1:loc_65885144j
					; sub_658850A1:loc_658851C5j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_658850A1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658854A1	proc near		; DATA XREF: .data:6588F074o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EC8h]
		test	eax, eax
		jz	short loc_658854CC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0EC8h]
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx

loc_658854CC:				; CODE XREF: sub_658854A1+11j
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_close_input_fd
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_close_output_fd
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+190h], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885511
		mov	[esp+18h+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_process_done
		jmp	short locret_65885516
; ---------------------------------------------------------------------------

loc_65885511:				; CODE XREF: sub_658854A1+59j
		mov	eax, 0

locret_65885516:			; CODE XREF: sub_658854A1+6Ej
		leave
		retn
sub_658854A1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65885518	proc near		; DATA XREF: .data:6588F084o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885566
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884F30
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_process_done
		jmp	short locret_65885590
; ---------------------------------------------------------------------------

loc_65885566:				; CODE XREF: sub_65885518+11j
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884F30
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error

locret_65885590:			; CODE XREF: sub_65885518+4Cj
		leave
		retn
sub_65885518	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65885592	proc near		; DATA XREF: .data:6588F094o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0ECCh]
		test	eax, eax
		jz	short loc_658855C7
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0ECCh]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax

loc_658855C7:				; CODE XREF: sub_65885592+18j
		cmp	[ebp+var_C], 0
		jnz	short loc_658855EE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_close_input_fd
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_close_output_fd
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65889A25

loc_658855EE:				; CODE XREF: sub_65885592+39j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_6588560F
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_process_done
		jmp	short locret_65885612
; ---------------------------------------------------------------------------

loc_6588560F:				; CODE XREF: sub_65885592+67j
		mov	eax, [ebp+var_C]

locret_65885612:			; CODE XREF: sub_65885592+7Bj
		leave
		retn
sub_65885592	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_65885614(int,	char *)
sub_65885614	proc near		; DATA XREF: .data:6588F0B4o

Str		= dword	ptr -438h
Control		= dword	ptr -434h
MaxCount	= dword	ptr -430h
var_42C		= byte ptr -42Ch
var_428		= dword	ptr -428h
var_40C		= dword	ptr -40Ch
var_402		= byte ptr -402h
var_19		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str2		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 434h
		mov	[esp+438h+Control], offset asc_65890C86	; " \t\n"
		mov	eax, [ebp+arg_4]
		mov	[esp+438h+Str],	eax ; Str
		call	strcspn
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_658857CA
		mov	[ebp+var_C], 0
		jmp	loc_658857B3
; ---------------------------------------------------------------------------

loc_6588564A:				; CODE XREF: sub_65885614+1ABj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	[ebp+var_40C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_40C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax+8]
		mov	[ebp+Str2], eax
		cmp	[ebp+Str2], 0
		jz	loc_6588575A
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	edx, [ebp+var_14]
		mov	[esp+438h+MaxCount], edx ; MaxCount
		mov	edx, [ebp+Str2]
		mov	[esp+438h+Control], edx	; Str2
		mov	[esp+438h+Str],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_6588575A
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+Str2]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_6588570F
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+Str2]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_6588570F
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+Str2]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_6588575A

loc_6588570F:				; CODE XREF: sub_65885614+DBj
					; sub_65885614+EAj
		mov	[esp+438h+Control], offset asc_65890C8A	; "\n"
		mov	eax, [ebp+Str2]
		mov	[esp+438h+Str],	eax ; Str
		call	strcspn
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_6588575A
		mov	edx, [ebp+var_14]
		mov	eax, offset a_S	; "# %.*s"
		mov	ecx, [ebp+Str2]
		mov	[esp+438h+var_428], ecx
		mov	dword ptr [esp+438h+var_42C], edx ; char
		mov	[esp+438h+MaxCount], eax ; char	*
		mov	[esp+438h+Control], 3EAh ; size_t
		lea	eax, [ebp+var_402]
		mov	[esp+438h+Str],	eax ; char *
		call	sub_6588E410
		jmp	short loc_65885796
; ---------------------------------------------------------------------------

loc_6588575A:				; CODE XREF: sub_65885614+95j
					; sub_65885614+CCj ...
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	edx, [eax]
		mov	eax, offset aS_0 ; "# %s"
		mov	dword ptr [esp+438h+var_42C], edx ; char
		mov	[esp+438h+MaxCount], eax ; char	*
		mov	[esp+438h+Control], 3EAh ; size_t
		lea	eax, [ebp+var_402]
		mov	[esp+438h+Str],	eax ; char *
		call	sub_6588E410

loc_65885796:				; CODE XREF: sub_65885614+144j
		mov	[ebp+var_19], 0
		lea	eax, [ebp+var_402]
		mov	[esp+438h+Control], eax	; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax ; int
		call	assuan_write_line
		add	[ebp+var_C], 1

loc_658857B3:				; CODE XREF: sub_65885614+31j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EBCh]
		cmp	eax, [ebp+var_C]
		ja	loc_6588564A
		jmp	loc_658859F4
; ---------------------------------------------------------------------------

loc_658857CA:				; CODE XREF: sub_65885614+24j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	[ebp+var_C], 0
		jmp	short loc_6588581F
; ---------------------------------------------------------------------------

loc_658857EF:				; CODE XREF: sub_65885614+226j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	[esp+438h+Control], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+438h+Str],	eax
		call	sub_65886382
		test	eax, eax
		jz	short loc_6588583E
		add	[ebp+var_C], 1

loc_6588581F:				; CODE XREF: sub_65885614+1D9j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_658857EF
		jmp	short loc_6588583F
; ---------------------------------------------------------------------------

loc_6588583E:				; CODE XREF: sub_65885614+205j
		nop

loc_6588583F:				; CODE XREF: sub_65885614+228j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[edx], al
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_658858E0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_658858B1
		mov	[esp+438h+Control], 0AFh
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	sub_65884F30
		mov	[esp+438h+MaxCount], 0
		mov	[esp+438h+Control], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	assuan_set_error
		mov	[esp+438h+Control], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	assuan_process_done
		jmp	short loc_658858DB
; ---------------------------------------------------------------------------

loc_658858B1:				; CODE XREF: sub_65885614+260j
		mov	[esp+438h+Control], 0AFh
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	sub_65884F30
		mov	[esp+438h+MaxCount], 0
		mov	[esp+438h+Control], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	assuan_set_error

loc_658858DB:				; CODE XREF: sub_65885614+29Bj
		jmp	loc_65885A1B
; ---------------------------------------------------------------------------

loc_658858E0:				; CODE XREF: sub_65885614+253j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax+8]
		mov	[ebp+Str2], eax
		cmp	[ebp+Str2], 0
		jnz	short loc_6588597A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_6588594B
		mov	[esp+438h+Control], 1Bh
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	sub_65884F30
		mov	[esp+438h+MaxCount], 0
		mov	[esp+438h+Control], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	assuan_set_error
		mov	[esp+438h+Control], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	assuan_process_done
		jmp	short loc_65885975
; ---------------------------------------------------------------------------

loc_6588594B:				; CODE XREF: sub_65885614+2FAj
		mov	[esp+438h+Control], 1Bh
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	sub_65884F30
		mov	[esp+438h+MaxCount], 0
		mov	[esp+438h+Control], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	assuan_set_error

loc_65885975:				; CODE XREF: sub_65885614+335j
		jmp	loc_65885A1B
; ---------------------------------------------------------------------------

loc_6588597A:				; CODE XREF: sub_65885614+2EDj
					; sub_65885614+3DEj
		mov	[esp+438h+Control], offset asc_65890C8A	; "\n"
		mov	eax, [ebp+Str2]
		mov	[esp+438h+Str],	eax ; Str
		call	strcspn
		mov	[ebp+var_14], eax
		mov	edx, [ebp+var_14]
		mov	eax, offset a_S	; "# %.*s"
		mov	ecx, [ebp+Str2]
		mov	[esp+438h+var_428], ecx
		mov	dword ptr [esp+438h+var_42C], edx ; char
		mov	[esp+438h+MaxCount], eax ; char	*
		mov	[esp+438h+Control], 3EAh ; size_t
		lea	eax, [ebp+var_402]
		mov	[esp+438h+Str],	eax ; char *
		call	sub_6588E410
		mov	eax, [ebp+var_14]
		add	[ebp+Str2], eax
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_658859D1
		add	[ebp+Str2], 1

loc_658859D1:				; CODE XREF: sub_65885614+3B7j
		mov	[ebp+var_19], 0
		lea	eax, [ebp+var_402]
		mov	[esp+438h+Control], eax	; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax ; int
		call	assuan_write_line
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_6588597A

loc_658859F4:				; CODE XREF: sub_65885614+1B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885A16
		mov	[esp+438h+Control], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Str],	eax
		call	assuan_process_done
		jmp	short loc_65885A1B
; ---------------------------------------------------------------------------

loc_65885A16:				; CODE XREF: sub_65885614+3EBj
		mov	eax, 0

loc_65885A1B:				; CODE XREF: sub_65885614:loc_658858DBj
					; sub_65885614:loc_65885975j ...
		add	esp, 434h
		pop	edi
		pop	ebp
		retn
sub_65885614	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65885A24	proc near		; DATA XREF: .data:6588F0A4o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885A72
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884F30
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_process_done
		jmp	short locret_65885A9C
; ---------------------------------------------------------------------------

loc_65885A72:				; CODE XREF: sub_65885A24+11j
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884F30
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error

locret_65885A9C:			; CODE XREF: sub_65885A24+4Cj
		leave
		retn
sub_65885A24	endp

; Exported entry   5. assuan_command_parse_fd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_command_parse_fd(int, char	*Str, int)
		public assuan_command_parse_fd
assuan_command_parse_fd	proc near	; CODE XREF: sub_65885CA8+1Ap
					; sub_65885D85+1Ap

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
EndPtr		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	[esp+38h+MaxCount], 2 ;	MaxCount
		mov	[esp+38h+Str2],	offset Str2 ; "FD"
		mov	eax, [ebp+Str]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jz	short loc_65885AE3
		mov	[esp+38h+MaxCount], 2 ;	MaxCount
		mov	[esp+38h+Str2],	offset aFd ; "fd"
		mov	eax, [ebp+Str]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_65885B17

loc_65885AE3:				; CODE XREF: assuan_command_parse_fd+24j
		mov	eax, [ebp+Str]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_65885B46
		mov	eax, [ebp+Str]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_65885B46
		mov	eax, [ebp+Str]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_65885B46
		mov	eax, [ebp+Str]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_65885B46

loc_65885B17:				; CODE XREF: assuan_command_parse_fd+43j
		mov	[esp+38h+Str2],	114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65884F30
		mov	[esp+38h+MaxCount], offset aFdNExpected	; "FD[=<n>] expected"
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_set_error
		jmp	loc_65885CA2
; ---------------------------------------------------------------------------

loc_65885B46:				; CODE XREF: assuan_command_parse_fd+50j
					; assuan_command_parse_fd+5Dj ...
		add	[ebp+Str], 2
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	loc_65885C90
		add	[ebp+Str], 1
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_65885B70
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_65885B9F

loc_65885B70:				; CODE XREF: assuan_command_parse_fd+C6j
		mov	[esp+38h+Str2],	114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65884F30
		mov	[esp+38h+MaxCount], offset aNumberRequired ; "number required"
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_set_error
		jmp	loc_65885CA2
; ---------------------------------------------------------------------------

loc_65885B9F:				; CODE XREF: assuan_command_parse_fd+D0j
		mov	eax, [ebp+Str]
		mov	[esp+38h+MaxCount], 0Ah	; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+38h+Str2],	edx ; EndPtr
		mov	[esp+38h+Str1],	eax ; Str
		call	strtoul
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+EndPtr]
		test	eax, eax
		jz	short loc_65885BD7
		mov	eax, [ebp+EndPtr]
		mov	edx, eax
		mov	eax, [ebp+Str]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_65885BF6
; ---------------------------------------------------------------------------

loc_65885BD7:				; CODE XREF: assuan_command_parse_fd+127j
		mov	eax, [ebp+Str]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1

loc_65885BF6:				; CODE XREF: assuan_command_parse_fd+137j
		mov	[esp+38h+MaxCount], eax	; Size
		mov	[esp+38h+Str2],	20h ; Val
		mov	eax, [ebp+Str]
		mov	[esp+38h+Str1],	eax ; Dst
		call	memset
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1ACh]
		cmp	edx, eax
		jnz	short loc_65885C4B
		mov	[esp+38h+Str2],	118h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65884F30
		mov	[esp+38h+MaxCount], offset aFdSameAsInboun ; "fd same as inbound fd"
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_set_error
		jmp	short loc_65885CA2
; ---------------------------------------------------------------------------

loc_65885C4B:				; CODE XREF: assuan_command_parse_fd+17Fj
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		cmp	edx, eax
		jnz	short loc_65885C89
		mov	[esp+38h+Str2],	118h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65884F30
		mov	[esp+38h+MaxCount], offset aFdSameAsOutbou ; "fd same as outbound fd"
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_set_error
		jmp	short loc_65885CA2
; ---------------------------------------------------------------------------

loc_65885C89:				; CODE XREF: assuan_command_parse_fd+1BDj
		mov	eax, 0
		jmp	short loc_65885CA2
; ---------------------------------------------------------------------------

loc_65885C90:				; CODE XREF: assuan_command_parse_fd+B4j
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_receivefd

loc_65885CA2:				; CODE XREF: assuan_command_parse_fd+A3j
					; assuan_command_parse_fd+FCj ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
assuan_command_parse_fd	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_65885CA8(int,	char *)
sub_65885CA8	proc near		; DATA XREF: .data:6588F0C4o

var_28		= dword	ptr -28h
Str		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	assuan_command_parse_fd
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65885CF9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885CF1
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_process_done
		jmp	short loc_65885CF4
; ---------------------------------------------------------------------------

loc_65885CF1:				; CODE XREF: sub_65885CA8+33j
		mov	eax, [ebp+var_C]

loc_65885CF4:				; CODE XREF: sub_65885CA8+47j
		jmp	locret_65885D83
; ---------------------------------------------------------------------------

loc_65885CF9:				; CODE XREF: sub_65885CA8+26j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0ED8h]
		test	eax, eax
		jz	short loc_65885D4D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EE8h]
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+0EE8h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0ED8h]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65885D5F
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+0EE8h], edx
		jmp	short loc_65885D5F
; ---------------------------------------------------------------------------

loc_65885D4D:				; CODE XREF: sub_65885CA8+5Cj
		cmp	[ebp+var_C], 0
		jnz	short loc_65885D5F
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+0EE8h], edx

loc_65885D5F:				; CODE XREF: sub_65885CA8+95j
					; sub_65885CA8+A3j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885D80
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_process_done
		jmp	short locret_65885D83
; ---------------------------------------------------------------------------

loc_65885D80:				; CODE XREF: sub_65885CA8+C2j
		mov	eax, [ebp+var_C]

locret_65885D83:			; CODE XREF: sub_65885CA8:loc_65885CF4j
					; sub_65885CA8+D6j
		leave
		retn
sub_65885CA8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_65885D85(int,	char *)
sub_65885D85	proc near		; DATA XREF: .data:6588F0D4o

var_28		= dword	ptr -28h
Str		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	assuan_command_parse_fd
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65885DD6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885DCE
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_process_done
		jmp	short loc_65885DD1
; ---------------------------------------------------------------------------

loc_65885DCE:				; CODE XREF: sub_65885D85+33j
		mov	eax, [ebp+var_C]

loc_65885DD1:				; CODE XREF: sub_65885D85+47j
		jmp	locret_65885E60
; ---------------------------------------------------------------------------

loc_65885DD6:				; CODE XREF: sub_65885D85+26j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EDCh]
		test	eax, eax
		jz	short loc_65885E2A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EECh]
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+0EECh], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0EDCh]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65885E3C
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+0EECh], edx
		jmp	short loc_65885E3C
; ---------------------------------------------------------------------------

loc_65885E2A:				; CODE XREF: sub_65885D85+5Cj
		cmp	[ebp+var_C], 0
		jnz	short loc_65885E3C
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+0EECh], edx

loc_65885E3C:				; CODE XREF: sub_65885D85+95j
					; sub_65885D85+A3j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65885E5D
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_process_done
		jmp	short locret_65885E60
; ---------------------------------------------------------------------------

loc_65885E5D:				; CODE XREF: sub_65885D85+C2j
		mov	eax, [ebp+var_C]

locret_65885E60:			; CODE XREF: sub_65885D85:loc_65885DD1j
					; sub_65885D85+D6j
		leave
		retn
sub_65885D85	endp

; Exported entry  36. assuan_register_command

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_register_command(int, char	*, int,	int)
		public assuan_register_command
assuan_register_command	proc near	; CODE XREF: sub_658862D9+48p

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0FFFFFFFFh
		cmp	[ebp+arg_4], 0
		jz	short loc_65885E86
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_65885E86
		mov	[ebp+arg_4], 0

loc_65885E86:				; CODE XREF: assuan_register_command+11j
					; assuan_register_command+1Bj
		cmp	[ebp+arg_4], 0
		jnz	short loc_65885EA4
		mov	[esp+28h+Str2],	105h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	sub_65884F30
		jmp	locret_6588611C
; ---------------------------------------------------------------------------

loc_65885EA4:				; CODE XREF: assuan_register_command+28j
		cmp	[ebp+arg_8], 0
		jnz	loc_65885F4A
		mov	[ebp+var_C], 0
		jmp	short loc_65885EBB
; ---------------------------------------------------------------------------

loc_65885EB7:				; CODE XREF: assuan_register_command+83j
		add	[ebp+var_C], 1

loc_65885EBB:				; CODE XREF: assuan_register_command+53j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_6588F040
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_65885EE7
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_65885EB7

loc_65885EE7:				; CODE XREF: assuan_register_command+6Dj
		cmp	[ebp+var_14], 0
		jnz	short loc_65885F26
		mov	[ebp+var_C], 0
		jmp	short loc_65885EFA
; ---------------------------------------------------------------------------

loc_65885EF6:				; CODE XREF: assuan_register_command+C2j
		add	[ebp+var_C], 1

loc_65885EFA:				; CODE XREF: assuan_register_command+92j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_6588F040
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_65885F26
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax
		call	sub_65886382
		test	eax, eax
		jnz	short loc_65885EF6

loc_65885F26:				; CODE XREF: assuan_register_command+89j
					; assuan_register_command+ACj
		cmp	[ebp+var_14], 0
		jz	short loc_65885F3D
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_6588F040
		mov	eax, [eax+4]
		mov	[ebp+arg_8], eax

loc_65885F3D:				; CODE XREF: assuan_register_command+C8j
		cmp	[ebp+arg_8], 0
		jnz	short loc_65885F4A
		mov	[ebp+arg_8], offset sub_65884F59

loc_65885F4A:				; CODE XREF: assuan_register_command+46j
					; assuan_register_command+DFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EB8h]
		test	eax, eax
		jnz	short loc_65885FC5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EC0h], 32h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EC0h]
		mov	[esp+28h+var_20], 0Ch
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	sub_658822A1
		mov	edx, [ebp+arg_0]
		mov	[edx+0EB8h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EB8h]
		test	eax, eax
		jnz	short loc_65885FB3
		call	gpg_err_code_from_syserror
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	sub_65884F30
		jmp	locret_6588611C
; ---------------------------------------------------------------------------

loc_65885FB3:				; CODE XREF: assuan_register_command+136j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EBCh], 0
		jmp	loc_6588604F
; ---------------------------------------------------------------------------

loc_65885FC5:				; CODE XREF: assuan_register_command+F3j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0EBCh]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EC0h]
		cmp	edx, eax
		jb	short loc_6588604F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0EC0h]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, [eax+78h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EB8h]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	sub_65882281
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_6588602E
		call	gpg_err_code_from_syserror
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	sub_65884F30
		jmp	locret_6588611C
; ---------------------------------------------------------------------------

loc_6588602E:				; CODE XREF: assuan_register_command+1B1j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+0EB8h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EC0h]
		lea	edx, [eax+32h]
		mov	eax, [ebp+arg_0]
		mov	[eax+0EC0h], edx

loc_6588604F:				; CODE XREF: assuan_register_command+15Ej
					; assuan_register_command+177j
		mov	[ebp+var_C], 0
		jmp	short loc_65886090
; ---------------------------------------------------------------------------

loc_65886058:				; CODE XREF: assuan_register_command+23Cj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax
		call	sub_65886382
		test	eax, eax
		jnz	short loc_6588608C
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_658860A0
; ---------------------------------------------------------------------------

loc_6588608C:				; CODE XREF: assuan_register_command+220j
		add	[ebp+var_C], 1

loc_65886090:				; CODE XREF: assuan_register_command+1F4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EBCh]
		cmp	edx, eax
		jb	short loc_65886058

loc_658860A0:				; CODE XREF: assuan_register_command+228j
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_658860BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EBCh]
		mov	[ebp+var_10], eax
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0EBCh], edx

loc_658860BE:				; CODE XREF: assuan_register_command+242j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, [ecx+eax]
		mov	eax, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, [ecx+eax]
		mov	eax, [ebp+arg_8]
		mov	[edx+4], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, [ecx+eax]
		mov	eax, [ebp+arg_C]
		mov	[edx+8], eax
		mov	eax, 0

locret_6588611C:			; CODE XREF: assuan_register_command+3Dj
					; assuan_register_command+14Cj	...
		leave
		retn
assuan_register_command	endp

; Exported entry  10. assuan_get_command_name

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_command_name
assuan_get_command_name	proc near

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_65886132
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EC4h]
		jmp	short loc_65886137
; ---------------------------------------------------------------------------

loc_65886132:				; CODE XREF: assuan_get_command_name+7j
		mov	eax, 0

loc_65886137:				; CODE XREF: assuan_get_command_name+12j
		pop	ebp
		retn
assuan_get_command_name	endp

; Exported entry  85. assuan_register_pre_cmd_notify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_register_pre_cmd_notify
assuan_register_pre_cmd_notify proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jnz	short loc_6588615A
		mov	[esp+8+var_4], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65884F30
		jmp	short locret_6588616B
; ---------------------------------------------------------------------------

loc_6588615A:				; CODE XREF: assuan_register_pre_cmd_notify+Aj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0EE0h], edx
		mov	eax, 0

locret_6588616B:			; CODE XREF: assuan_register_pre_cmd_notify+1Fj
		leave
		retn
assuan_register_pre_cmd_notify endp

; Exported entry  40. assuan_register_post_cmd_notify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_register_post_cmd_notify
assuan_register_post_cmd_notify	proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jnz	short loc_6588618E
		mov	[esp+8+var_4], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65884F30
		jmp	short locret_6588619F
; ---------------------------------------------------------------------------

loc_6588618E:				; CODE XREF: assuan_register_post_cmd_notify+Aj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0EE4h], edx
		mov	eax, 0

locret_6588619F:			; CODE XREF: assuan_register_post_cmd_notify+1Fj
		leave
		retn
assuan_register_post_cmd_notify	endp

; Exported entry  34. assuan_register_bye_notify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_register_bye_notify
assuan_register_bye_notify proc	near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jnz	short loc_658861C2
		mov	[esp+8+var_4], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65884F30
		jmp	short locret_658861D3
; ---------------------------------------------------------------------------

loc_658861C2:				; CODE XREF: assuan_register_bye_notify+Aj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0EC8h], edx
		mov	eax, 0

locret_658861D3:			; CODE XREF: assuan_register_bye_notify+1Fj
		leave
		retn
assuan_register_bye_notify endp

; Exported entry  41. assuan_register_reset_notify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_register_reset_notify
assuan_register_reset_notify proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jnz	short loc_658861F6
		mov	[esp+8+var_4], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65884F30
		jmp	short locret_65886207
; ---------------------------------------------------------------------------

loc_658861F6:				; CODE XREF: assuan_register_reset_notify+Aj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0ECCh], edx
		mov	eax, 0

locret_65886207:			; CODE XREF: assuan_register_reset_notify+1Fj
		leave
		retn
assuan_register_reset_notify endp

; Exported entry  35. assuan_register_cancel_notify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_register_cancel_notify
assuan_register_cancel_notify proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jnz	short loc_6588622A
		mov	[esp+8+var_4], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65884F30
		jmp	short locret_6588623B
; ---------------------------------------------------------------------------

loc_6588622A:				; CODE XREF: assuan_register_cancel_notify+Aj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0ED0h], edx
		mov	eax, 0

locret_6588623B:			; CODE XREF: assuan_register_cancel_notify+1Fj
		leave
		retn
assuan_register_cancel_notify endp

; Exported entry  38. assuan_register_option_handler

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_register_option_handler
assuan_register_option_handler proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jnz	short loc_6588625E
		mov	[esp+8+var_4], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65884F30
		jmp	short locret_6588626F
; ---------------------------------------------------------------------------

loc_6588625E:				; CODE XREF: assuan_register_option_handler+Aj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0ED4h], edx
		mov	eax, 0

locret_6588626F:			; CODE XREF: assuan_register_option_handler+1Fj
		leave
		retn
assuan_register_option_handler endp

; Exported entry  37. assuan_register_input_notify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_register_input_notify
assuan_register_input_notify proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jnz	short loc_65886292
		mov	[esp+8+var_4], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65884F30
		jmp	short locret_658862A3
; ---------------------------------------------------------------------------

loc_65886292:				; CODE XREF: assuan_register_input_notify+Aj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0ED8h], edx
		mov	eax, 0

locret_658862A3:			; CODE XREF: assuan_register_input_notify+1Fj
		leave
		retn
assuan_register_input_notify endp

; Exported entry  39. assuan_register_output_notify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_register_output_notify
assuan_register_output_notify proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jnz	short loc_658862C6
		mov	[esp+8+var_4], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_65884F30
		jmp	short locret_658862D7
; ---------------------------------------------------------------------------

loc_658862C6:				; CODE XREF: assuan_register_output_notify+Aj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0EDCh], edx
		mov	eax, 0

locret_658862D7:			; CODE XREF: assuan_register_output_notify+1Fj
		leave
		retn
assuan_register_output_notify endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658862D9	proc near		; CODE XREF: assuan_init_pipe_server+BCp
					; assuan_init_socket_server+6Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_65886338
; ---------------------------------------------------------------------------

loc_658862E8:				; CODE XREF: sub_658862D9+6Ej
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_6588F040
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_65886334
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_6588F040
		mov	eax, [eax]
		mov	[esp+28h+var_1C], 0 ; int
		mov	[esp+28h+var_20], 0 ; int
		mov	[esp+28h+var_24], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	assuan_register_command
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_65886334
		mov	eax, [ebp+var_10]
		jmp	short locret_6588634E
; ---------------------------------------------------------------------------

loc_65886334:				; CODE XREF: sub_658862D9+1Fj
					; sub_658862D9+54j
		add	[ebp+var_C], 1

loc_65886338:				; CODE XREF: sub_658862D9+Dj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_6588F040
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_658862E8
		mov	eax, 0

locret_6588634E:			; CODE XREF: sub_658862D9+59j
		leave
		retn
sub_658862D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65886350	proc near		; CODE XREF: sub_65886440+45p
					; sub_65886440+75p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65884F30
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_set_error
		leave
		retn
sub_65886350	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65886382	proc near		; CODE XREF: sub_65885614+1FEp
					; assuan_register_command+BBp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_658863D9
		mov	eax, 0
		jmp	loc_6588643E
; ---------------------------------------------------------------------------

loc_65886397:				; CODE XREF: sub_65886382+6Aj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_658863B9
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ah
		jg	short loc_658863B9
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		movsx	eax, al
		jmp	short loc_658863C2
; ---------------------------------------------------------------------------

loc_658863B9:				; CODE XREF: sub_65886382+1Dj
					; sub_65886382+27j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al

loc_658863C2:				; CODE XREF: sub_65886382+35j
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		movsx	edx, dl
		cmp	eax, edx
		jnz	short loc_658863F0
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_658863DA
; ---------------------------------------------------------------------------

loc_658863D9:				; CODE XREF: sub_65886382+9j
		nop

loc_658863DA:				; CODE XREF: sub_65886382+55j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_658863F1
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_65886397
		jmp	short loc_658863F1
; ---------------------------------------------------------------------------

loc_658863F0:				; CODE XREF: sub_65886382+4Bj
		nop

loc_658863F1:				; CODE XREF: sub_65886382+60j
					; sub_65886382+6Cj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_65886439
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_65886423
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ah
		jg	short loc_65886423
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		movsx	eax, al
		jmp	short loc_6588642C
; ---------------------------------------------------------------------------

loc_65886423:				; CODE XREF: sub_65886382+87j
					; sub_65886382+91j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al

loc_6588642C:				; CODE XREF: sub_65886382+9Fj
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		movsx	edx, dl
		sub	eax, edx
		jmp	short loc_6588643E
; ---------------------------------------------------------------------------

loc_65886439:				; CODE XREF: sub_65886382+7Dj
		mov	eax, 0

loc_6588643E:				; CODE XREF: sub_65886382+10j
					; sub_65886382+B5j
		pop	ebp
		retn
sub_65886382	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_65886440(int,	char *,	int)
sub_65886440	proc near		; CODE XREF: sub_65886A4D+F1p
					; sub_65886C23+EFp

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jnz	short loc_658864BF
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_658864BF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_6588649B
		mov	eax, [ebp+arg_8]
		lea	edx, [eax-2]
		mov	eax, [ebp+arg_4]
		add	eax, 2
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65886350
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_process_done
		jmp	short loc_658864BA
; ---------------------------------------------------------------------------

loc_6588649B:				; CODE XREF: sub_65886440+29j
		mov	eax, [ebp+arg_8]
		lea	edx, [eax-2]
		mov	eax, [ebp+arg_4]
		add	eax, 2
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65886350

loc_658864BA:				; CODE XREF: sub_65886440+59j
		jmp	loc_6588678C
; ---------------------------------------------------------------------------

loc_658864BF:				; CODE XREF: sub_65886440+Fj
					; sub_65886440+1Cj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_658864CB
; ---------------------------------------------------------------------------

loc_658864C7:				; CODE XREF: sub_65886440+A7j
		add	[ebp+var_C], 1

loc_658864CB:				; CODE XREF: sub_65886440+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_658864E9
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_658864E9
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_658864C7

loc_658864E9:				; CODE XREF: sub_65886440+93j
					; sub_65886440+9Dj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_65886568
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65886539
		mov	[esp+38h+Str2],	114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aLeadingWhiteSp ; "leading white-space"
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_set_error
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_process_done
		jmp	short loc_65886563
; ---------------------------------------------------------------------------

loc_65886539:				; CODE XREF: sub_65886440+BCj
		mov	[esp+38h+Str2],	114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65884F30
		mov	[esp+38h+var_30], offset aLeadingWhiteSp ; "leading white-space"
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_set_error

loc_65886563:				; CODE XREF: sub_65886440+F7j
		jmp	loc_6588678C
; ---------------------------------------------------------------------------

loc_65886568:				; CODE XREF: sub_65886440+AFj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_65886596
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		jmp	short loc_65886582
; ---------------------------------------------------------------------------

loc_6588657E:				; CODE XREF: sub_65886440+14Aj
					; sub_65886440+154j
		add	[ebp+var_C], 1

loc_65886582:				; CODE XREF: sub_65886440+13Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_6588657E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_6588657E

loc_65886596:				; CODE XREF: sub_65886440+130j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], 0
		jmp	short loc_658865C8
; ---------------------------------------------------------------------------

loc_658865AE:				; CODE XREF: sub_65886440+1A8j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_658865EC
		add	[ebp+var_14], 1

loc_658865C8:				; CODE XREF: sub_65886440+16Cj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_658865AE
		jmp	short loc_658865ED
; ---------------------------------------------------------------------------

loc_658865EC:				; CODE XREF: sub_65886440+182j
		nop

loc_658865ED:				; CODE XREF: sub_65886440+1AAj
		cmp	[ebp+var_10], 0
		jnz	short loc_6588663B
		mov	[ebp+var_14], 0
		jmp	short loc_65886616
; ---------------------------------------------------------------------------

loc_658865FC:				; CODE XREF: sub_65886440+1F6j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str1],	eax
		call	sub_65886382
		test	eax, eax
		jz	short loc_6588663A
		add	[ebp+var_14], 1

loc_65886616:				; CODE XREF: sub_65886440+1BAj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_658865FC
		jmp	short loc_6588663B
; ---------------------------------------------------------------------------

loc_6588663A:				; CODE XREF: sub_65886440+1D0j
		nop

loc_6588663B:				; CODE XREF: sub_65886440+1B1j
					; sub_65886440+1F8j
		cmp	[ebp+var_10], 0
		jnz	short loc_658866B8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65886689
		mov	[esp+38h+Str2],	113h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65884F30
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_set_error
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_process_done
		jmp	short loc_658866B3
; ---------------------------------------------------------------------------

loc_65886689:				; CODE XREF: sub_65886440+20Cj
		mov	[esp+38h+Str2],	113h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_65884F30
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_set_error

loc_658866B3:				; CODE XREF: sub_65886440+247j
		jmp	loc_6588678C
; ---------------------------------------------------------------------------

loc_658866B8:				; CODE XREF: sub_65886440+1FFj
		mov	eax, [ebp+var_18]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_18]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EE0h]
		test	eax, eax
		jz	short loc_6588672E
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EE0h]
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+0EB8h]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ebx
		mov	eax, [eax]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_6588672E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18Ch]
		test	eax, eax
		jz	short loc_65886729
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	assuan_process_done
		jmp	short loc_6588672C
; ---------------------------------------------------------------------------

loc_65886729:				; CODE XREF: sub_65886440+2D3j
		mov	eax, [ebp+var_1C]

loc_6588672C:				; CODE XREF: sub_65886440+2E7j
		jmp	short loc_6588678C
; ---------------------------------------------------------------------------

loc_6588672E:				; CODE XREF: sub_65886440+28Fj
					; sub_65886440+2C6j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+0EC4h], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0EB8h]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	edx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EC4h], 0
		mov	eax, [ebp+var_1C]

loc_6588678C:				; CODE XREF: sub_65886440:loc_658864BAj
					; sub_65886440:loc_65886563j ...
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_65886440	endp

; Exported entry  30. assuan_process_done

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_process_done
assuan_process_done proc near		; CODE XREF: sub_65884F59+47p
					; sub_65884FD3+21p ...

File		= dword	ptr -198h
var_194		= dword	ptr -194h
var_190		= dword	ptr -190h
var_18C		= byte ptr -18Ch
var_188		= dword	ptr -188h
var_184		= dword	ptr -184h
var_180		= dword	ptr -180h
var_17C		= dword	ptr -17Ch
var_16A		= byte ptr -16Ah
var_3E		= byte ptr -3Eh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 190h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+194h]
		test	eax, eax
		jnz	short loc_658867C2
		mov	[esp+198h+var_194], 101h
		mov	eax, [ebp+arg_0]
		mov	[esp+198h+File], eax
		call	sub_65884F30
		jmp	loc_65886A43
; ---------------------------------------------------------------------------

loc_658867C2:				; CODE XREF: assuan_process_done+16j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 20h
		test	al, al
		jz	short loc_658867E0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+190h], 1

loc_658867E0:				; CODE XREF: assuan_process_done+3Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+194h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+99Ch]
		test	eax, eax
		jz	short loc_65886839
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+99Ch]
		mov	[esp+198h+File], eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+99Ch], 0
		cmp	dword ptr [ebp+arg_4], 0
		jnz	short loc_65886873
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D90h]
		test	eax, eax
		jz	short loc_65886873
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D90h]
		mov	dword ptr [ebp+arg_4], eax
		jmp	short loc_65886873
; ---------------------------------------------------------------------------

loc_65886839:				; CODE XREF: assuan_process_done+66j
		mov	[esp+198h+var_190], 0
		mov	[esp+198h+var_194], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+198h+File], eax
		call	assuan_send_data
		cmp	dword ptr [ebp+arg_4], 0
		jnz	short loc_65886873
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D90h]
		test	eax, eax
		jz	short loc_65886873
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D90h]
		mov	dword ptr [ebp+arg_4], eax

loc_65886873:				; CODE XREF: assuan_process_done+8Aj
					; assuan_process_done+97j ...
		cmp	dword ptr [ebp+arg_4], 0
		jnz	short loc_658868E3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+190h]
		test	eax, eax
		jz	short loc_658868AF
		mov	[esp+198h+var_194], offset aOkClosingConne ; "OK closing connection"
		mov	eax, [ebp+arg_0]
		mov	[esp+198h+File], eax ; int
		call	assuan_write_line
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0EB4h]
		mov	eax, [ebp+arg_0]
		mov	[esp+198h+File], eax
		call	edx
		jmp	loc_658869D6
; ---------------------------------------------------------------------------

loc_658868AF:				; CODE XREF: assuan_process_done+F2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A8h]
		test	eax, eax
		jz	short loc_658868C7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A8h]
		jmp	short loc_658868CC
; ---------------------------------------------------------------------------

loc_658868C7:				; CODE XREF: assuan_process_done+128j
		mov	eax, offset aOk	; "OK"

loc_658868CC:				; CODE XREF: assuan_process_done+133j
		mov	[esp+198h+var_194], eax	; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+198h+File], eax ; int
		call	assuan_write_line
		mov	dword ptr [ebp+arg_4], eax
		jmp	loc_658869D6
; ---------------------------------------------------------------------------

loc_658868E3:				; CODE XREF: assuan_process_done+E5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+17Ch]
		cmp	eax, dword ptr [ebp+arg_4]
		jnz	short loc_658868FC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+180h]
		jmp	short loc_65886901
; ---------------------------------------------------------------------------

loc_658868FC:				; CODE XREF: assuan_process_done+15Dj
		mov	eax, 0

loc_65886901:				; CODE XREF: assuan_process_done+168j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 20h
		test	al, al
		jz	short loc_6588691C
		mov	[ebp+var_C], offset aClosingConnect ; "[closing	connection]"

loc_6588691C:				; CODE XREF: assuan_process_done+181j
		mov	[esp+198h+var_190], 32h
		lea	eax, [ebp+var_3E]
		mov	[esp+198h+var_194], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+198h+File], eax
		call	gpg_strerror_r
		cmp	[ebp+var_C], 0
		jz	short loc_65886941
		mov	esi, [ebp+var_C]
		jmp	short loc_65886946
; ---------------------------------------------------------------------------

loc_65886941:				; CODE XREF: assuan_process_done+1A8j
		mov	esi, offset byte_65890F9D

loc_65886946:				; CODE XREF: assuan_process_done+1ADj
		cmp	[ebp+var_C], 0
		jz	short loc_65886953
		mov	ebx, offset asc_65890F9E ; " - "
		jmp	short loc_65886958
; ---------------------------------------------------------------------------

loc_65886953:				; CODE XREF: assuan_process_done+1B8j
		mov	ebx, offset byte_65890F9D

loc_65886958:				; CODE XREF: assuan_process_done+1BFj
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+198h+File], eax
		call	gpg_strsource
		mov	edx, offset aErrD_50s_30sS_ ; "ERR %d %.50s <%.30s>%s%.100s"
		mov	[esp+198h+var_17C], esi
		mov	[esp+198h+var_180], ebx
		mov	[esp+198h+var_184], eax
		lea	eax, [ebp+var_3E]
		mov	[esp+198h+var_188], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+198h+var_18C], eax ; char
		mov	[esp+198h+var_190], edx	; char *
		mov	[esp+198h+var_194], 12Ch ; size_t
		lea	eax, [ebp+var_16A]
		mov	[esp+198h+File], eax ; char *
		call	sub_6588E410
		lea	eax, [ebp+var_16A]
		mov	[esp+198h+var_194], eax	; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+198h+File], eax ; int
		call	assuan_write_line
		mov	dword ptr [ebp+arg_4], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 20h
		test	al, al
		jz	short loc_658869D6
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0EB4h]
		mov	eax, [ebp+arg_0]
		mov	[esp+198h+File], eax
		call	edx

loc_658869D6:				; CODE XREF: assuan_process_done+118j
					; assuan_process_done+14Cj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EE4h]
		test	eax, eax
		jz	short loc_658869FB
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0EE4h]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+198h+var_194], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+198h+File], eax
		call	edx

loc_658869FB:				; CODE XREF: assuan_process_done+24Fj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+11Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+11Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A8h]
		test	eax, eax
		jz	short loc_65886A40
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A8h]
		mov	[esp+198h+var_194], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+198h+File], eax
		call	sub_65882313
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1A8h], 0

loc_65886A40:				; CODE XREF: assuan_process_done+287j
		mov	eax, dword ptr [ebp+arg_4]

loc_65886A43:				; CODE XREF: assuan_process_done+2Bj
		add	esp, 190h
		pop	ebx
		pop	esi
		pop	ebp
		retn
assuan_process_done endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65886A4D	proc near		; CODE XREF: assuan_process_next+28p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_6588412E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65883EFD
		test	eax, eax
		jz	short loc_65886A81
		mov	eax, 0
		jmp	locret_65886BAE
; ---------------------------------------------------------------------------

loc_65886A81:				; CODE XREF: sub_65886A4D+28j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_65884F23
		cmp	eax, 3FFFh
		jnz	short loc_65886AAA
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+190h], 1
		mov	eax, 0
		jmp	locret_65886BAE
; ---------------------------------------------------------------------------

loc_65886AAA:				; CODE XREF: sub_65886A4D+44j
		cmp	[ebp+var_C], 0
		jz	short loc_65886AB8
		mov	eax, [ebp+var_C]
		jmp	locret_65886BAE
; ---------------------------------------------------------------------------

loc_65886AB8:				; CODE XREF: sub_65886A4D+61j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+1B4h]
		cmp	al, 23h
		jz	short loc_65886AD3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		test	eax, eax
		jnz	short loc_65886ADD

loc_65886AD3:				; CODE XREF: sub_65886A4D+77j
		mov	eax, 0
		jmp	locret_65886BAE
; ---------------------------------------------------------------------------

loc_65886ADD:				; CODE XREF: sub_65886A4D+84j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+194h]
		test	eax, eax
		jnz	short loc_65886B55
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+194h], 1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D90h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D8Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18Ch], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		mov	edx, [ebp+arg_0]
		add	edx, 1B4h
		mov	[esp+38h+var_30], eax ;	int
		mov	[esp+38h+var_34], edx ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_65886440
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18Ch], 0
		jmp	short loc_65886BAB
; ---------------------------------------------------------------------------

loc_65886B55:				; CODE XREF: sub_65886A4D+9Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+188h]
		test	eax, eax
		jz	short loc_65886B72
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_6588790A
		mov	[ebp+var_C], eax
		jmp	short loc_65886BAB
; ---------------------------------------------------------------------------

loc_65886B72:				; CODE XREF: sub_65886A4D+113j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset aCtx_2	; "ctx"
		mov	[esp+38h+var_2C], offset aProcess_next ; "process_next"
		mov	[esp+38h+var_30], offset aSSPCallUnexpec ; "%s (%s=%p):	call: unexpected client	dat"...
		mov	[esp+38h+var_34], 4
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882E28
		mov	[ebp+var_C], 0

loc_65886BAB:				; CODE XREF: sub_65886A4D+106j
					; sub_65886A4D+123j
		mov	eax, [ebp+var_C]

locret_65886BAE:			; CODE XREF: sub_65886A4D+2Fj
					; sub_65886A4D+58j ...
		leave
		retn
sub_65886A4D	endp

; Exported entry  31. assuan_process_next

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_process_next
assuan_process_next proc near

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jz	short loc_65886BC5
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_65886BC5:				; CODE XREF: assuan_process_next+Aj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+190h], 0

loc_65886BD2:				; CODE XREF: assuan_process_next+50j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65886A4D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_65886C02
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+190h]
		test	eax, eax
		jnz	short loc_65886C02
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_pending_line
		test	eax, eax
		jnz	short loc_65886BD2

loc_65886C02:				; CODE XREF: assuan_process_next+34j
					; assuan_process_next+41j
		cmp	[ebp+arg_4], 0
		jz	short loc_65886C1E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+190h]
		test	eax, eax
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_65886C1E:				; CODE XREF: assuan_process_next+56j
		mov	eax, [ebp+var_C]
		leave
		retn
assuan_process_next endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65886C23	proc near		; CODE XREF: assuan_process+19p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+188h]
		test	eax, eax
		jz	short loc_65886C4E
		mov	[esp+28h+var_24], 108h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65884F30
		jmp	locret_65886D2C
; ---------------------------------------------------------------------------

loc_65886C4E:				; CODE XREF: sub_65886C23+11j
					; sub_65886C23+4Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_6588412E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65883EFD
		test	eax, eax
		jnz	short loc_65886C4E
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_65884F23
		cmp	eax, 3FFFh
		jnz	short loc_65886C9B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+190h], 1
		mov	eax, 0
		jmp	locret_65886D2C
; ---------------------------------------------------------------------------

loc_65886C9B:				; CODE XREF: sub_65886C23+5Fj
		cmp	[ebp+var_C], 0
		jz	short loc_65886CA9
		mov	eax, [ebp+var_C]
		jmp	locret_65886D2C
; ---------------------------------------------------------------------------

loc_65886CA9:				; CODE XREF: sub_65886C23+7Cj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+1B4h]
		cmp	al, 23h
		jz	short loc_65886CC4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		test	eax, eax
		jnz	short loc_65886CCB

loc_65886CC4:				; CODE XREF: sub_65886C23+92j
		mov	eax, 0
		jmp	short locret_65886D2C
; ---------------------------------------------------------------------------

loc_65886CCB:				; CODE XREF: sub_65886C23+9Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+194h], 1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D90h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D8Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		mov	edx, [ebp+arg_0]
		add	edx, 1B4h
		mov	[esp+28h+var_20], eax ;	int
		mov	[esp+28h+var_24], edx ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_65886440
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_process_done

locret_65886D2C:			; CODE XREF: sub_65886C23+26j
					; sub_65886C23+73j ...
		leave
		retn
sub_65886C23	endp

; Exported entry  29. assuan_process

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_process
assuan_process	proc near

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+190h], 0

loc_65886D41:				; CODE XREF: assuan_process+32j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65886C23
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_65886D62
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+190h]
		test	eax, eax
		jz	short loc_65886D41

loc_65886D62:				; CODE XREF: assuan_process+25j
		mov	eax, [ebp+var_C]
		leave
		retn
assuan_process	endp

; Exported entry   8. assuan_get_active_fds

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_active_fds
assuan_get_active_fds proc near

File		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_65886D8D
		cmp	[ebp+arg_C], 1
		jle	short loc_65886D8D
		cmp	[ebp+arg_4], 0
		js	short loc_65886D8D
		cmp	[ebp+arg_4], 1
		jle	short loc_65886D97

loc_65886D8D:				; CODE XREF: assuan_get_active_fds+12j
					; assuan_get_active_fds+18j ...
		mov	eax, 0FFFFFFFFh
		jmp	loc_65886E27
; ---------------------------------------------------------------------------

loc_65886D97:				; CODE XREF: assuan_get_active_fds+24j
		cmp	[ebp+arg_4], 0
		jnz	short loc_65886DC5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1ACh]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_65886E24
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_8]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+1ACh]
		mov	[eax], edx
		add	[ebp+var_C], 1
		jmp	short loc_65886E24
; ---------------------------------------------------------------------------

loc_65886DC5:				; CODE XREF: assuan_get_active_fds+34j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_65886DEB
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_8]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+998h]
		mov	[eax], edx
		add	[ebp+var_C], 1

loc_65886DEB:				; CODE XREF: assuan_get_active_fds+6Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+99Ch]
		test	eax, eax
		jz	short loc_65886E24
		mov	eax, [ebp+var_C]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+99Ch]
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[esp+28h+File],	eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebx], eax
		add	[ebp+var_C], 1

loc_65886E24:				; CODE XREF: assuan_get_active_fds+42j
					; assuan_get_active_fds+5Cj ...
		mov	eax, [ebp+var_C]

loc_65886E27:				; CODE XREF: assuan_get_active_fds+2Bj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
assuan_get_active_fds endp

; Exported entry  11. assuan_get_data_fp

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_data_fp
assuan_get_data_fp proc	near

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 28h
		call	gpg_err_set_errno
		mov	eax, 0
		leave
		retn
assuan_get_data_fp endp

; Exported entry  55. assuan_set_okay_line

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_set_okay_line(int,	char *)
		public assuan_set_okay_line
assuan_set_okay_line proc near

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 0
		jnz	short loc_65886E6B
		mov	[esp+38h+Source], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_65884F30
		jmp	loc_65886F35
; ---------------------------------------------------------------------------

loc_65886E6B:				; CODE XREF: assuan_set_okay_line+Bj
		cmp	[ebp+arg_4], 0
		jnz	short loc_65886E9B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A8h]
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_65882313
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1A8h], 0
		jmp	loc_65886F30
; ---------------------------------------------------------------------------

loc_65886E9B:				; CODE XREF: assuan_set_okay_line+29j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 4
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_65882268
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_65886EEB
		call	gpg_err_code_from_syserror
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_65884F30
		jmp	short loc_65886F35
; ---------------------------------------------------------------------------

loc_65886EEB:				; CODE XREF: assuan_set_okay_line+8Dj
		mov	edx, offset aOk_0 ; "OK	"
		mov	eax, [ebp+var_C]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		lea	edx, [eax+3]
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A8h]
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_65882313
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1A8h], edx

loc_65886F30:				; CODE XREF: assuan_set_okay_line+50j
		mov	eax, 0

loc_65886F35:				; CODE XREF: assuan_set_okay_line+20j
					; assuan_set_okay_line+A3j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
assuan_set_okay_line endp

; Exported entry  69. assuan_write_status

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_write_status(int, char *, char *)
		public assuan_write_status
assuan_write_status proc near

Dest		= dword	ptr -138h
Source		= dword	ptr -134h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 130h
		cmp	[ebp+arg_0], 0
		jz	short loc_65886F52
		cmp	[ebp+arg_4], 0
		jnz	short loc_65886F6A

loc_65886F52:				; CODE XREF: assuan_write_status+Fj
		mov	[esp+138h+Source], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Dest], eax
		call	sub_65884F30
		jmp	loc_65887142
; ---------------------------------------------------------------------------

loc_65886F6A:				; CODE XREF: assuan_write_status+15j
		cmp	[ebp+arg_8], 0
		jnz	short loc_65886F77
		mov	[ebp+arg_8], offset byte_65890F9D

loc_65886F77:				; CODE XREF: assuan_write_status+33j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFh
		ja	loc_6588707A
		mov	edx, offset aS_1 ; "S "
		lea	eax, [ebp+var_114]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Source], eax ; Source
		lea	eax, [ebp+var_114]
		mov	[esp+138h+Dest], eax ; Dest
		call	strcat
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_6588705D
		mov	ebx, offset asc_65891001 ; " "
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+var_114]
		add	edx, eax
		movzx	eax, word ptr [ebx]
		mov	[edx], ax
		mov	eax, [ebp+arg_8]
		mov	[esp+138h+Source], eax ; Source
		lea	eax, [ebp+var_114]
		mov	[esp+138h+Dest], eax ; Dest
		call	strcat

loc_6588705D:				; CODE XREF: assuan_write_status+D0j
		lea	eax, [ebp+var_114]
		mov	[esp+138h+Source], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Dest], eax ; int
		call	assuan_write_line
		mov	[ebp+var_C], eax
		jmp	loc_6588713F
; ---------------------------------------------------------------------------

loc_6588707A:				; CODE XREF: assuan_write_status+95j
		mov	eax, [ebp+var_10]
		mov	[esp+138h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Dest], eax
		call	sub_65882268
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_65887138
		mov	edx, offset aS_1 ; "S "
		mov	eax, [ebp+var_14]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Source], eax ; Source
		mov	eax, [ebp+var_14]
		mov	[esp+138h+Dest], eax ; Dest
		call	strcat
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_6588710F
		mov	ebx, offset asc_65891001 ; " "
		mov	eax, [ebp+var_14]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_14]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		mov	eax, [ebp+arg_8]
		mov	[esp+138h+Source], eax ; Source
		mov	eax, [ebp+var_14]
		mov	[esp+138h+Dest], eax ; Dest
		call	strcat

loc_6588710F:				; CODE XREF: assuan_write_status+18Dj
		mov	eax, [ebp+var_14]
		mov	[esp+138h+Source], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Dest], eax ; int
		call	assuan_write_line
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+138h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Dest], eax
		call	sub_65882313
		jmp	short loc_6588713F
; ---------------------------------------------------------------------------

loc_65887138:				; CODE XREF: assuan_write_status+158j
		mov	[ebp+var_C], 0

loc_6588713F:				; CODE XREF: assuan_write_status+13Aj
					; assuan_write_status+1FBj
		mov	eax, [ebp+var_C]

loc_65887142:				; CODE XREF: assuan_write_status+2Aj
		add	esp, 130h
		pop	ebx
		pop	edi
		pop	ebp
		retn
assuan_write_status endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588714C	proc near		; CODE XREF: sub_65887173+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_6588716C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_65887171
; ---------------------------------------------------------------------------

loc_6588716C:				; CODE XREF: sub_6588714C+7j
		mov	eax, 0

loc_65887171:				; CODE XREF: sub_6588714C+1Ej
		pop	ebp
		retn
sub_6588714C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65887173	proc near		; CODE XREF: assuan_inquire+72p
					; assuan_inquire+BDp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_65887186
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_6588718B
; ---------------------------------------------------------------------------

loc_65887186:				; CODE XREF: sub_65887173+Aj
		mov	eax, 0Fh

loc_6588718B:				; CODE XREF: sub_65887173+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_6588714C
		leave
		retn
sub_65887173	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588719C	proc near		; CODE XREF: assuan_inquire+173p
					; assuan_inquire_ext+104p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_8]
		add	eax, 1
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65882268
		mov	edx, [ebp+arg_4]
		mov	[edx+8], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_65887200
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+0Ch], 1

locret_65887200:			; CODE XREF: sub_6588719C+58j
		leave
		retn
sub_6588719C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_65887202(int,	int, void *, size_t)
sub_65887202	proc near		; CODE XREF: assuan_inquire+391p
					; assuan_inquire+45Ep ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	loc_658872F0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	loc_658872F0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_65887251
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+arg_C]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		cmp	edx, eax
		jbe	short loc_65887251
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+10h], 1
		jmp	locret_658872F1
; ---------------------------------------------------------------------------

loc_65887251:				; CODE XREF: sub_65887202+2Aj
					; sub_65887202+3Ej
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+arg_C]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_658872BA
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_C]
		lea	edx, [eax+400h]
		mov	eax, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[esp+28h+Size],	edx
		mov	[esp+28h+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_65882281
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_658872B1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+0Ch], 1
		jmp	short locret_658872F1
; ---------------------------------------------------------------------------

loc_658872B1:				; CODE XREF: sub_65887202+A1j
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx

loc_658872BA:				; CODE XREF: sub_65887202+61j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		add	eax, edx
		mov	edx, [ebp+arg_8]
		mov	ecx, [ebp+arg_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+arg_C]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		jmp	short locret_658872F1
; ---------------------------------------------------------------------------

loc_658872F0:				; CODE XREF: sub_65887202+Ej
					; sub_65887202+1Cj
		nop

locret_658872F1:			; CODE XREF: sub_65887202+4Aj
					; sub_65887202+ADj ...
		leave
		retn
sub_65887202	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658872F3	proc near		; CODE XREF: assuan_inquire+4BAp
					; sub_6588790A+2CBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_6588730D
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_65887333

loc_6588730D:				; CODE XREF: sub_658872F3+Ej
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882313
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+8], 0
		mov	eax, 0
		jmp	short locret_6588736D
; ---------------------------------------------------------------------------

loc_65887333:				; CODE XREF: sub_658872F3+18j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp+var_C]

locret_6588736D:			; CODE XREF: sub_658872F3+3Ej
		leave
		retn
sub_658872F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588736F	proc near		; CODE XREF: assuan_inquire+4FDp
					; sub_658878B2+33p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65882313
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+8], 0
		leave
		retn
sub_6588736F	endp

; Exported entry  23. assuan_inquire

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_inquire(int, char *, int, int, int)
		public assuan_inquire
assuan_inquire	proc near

Dest		= dword	ptr -438h
Source		= dword	ptr -434h
var_430		= dword	ptr -430h
var_42C		= dword	ptr -42Ch
var_41C		= dword	ptr -41Ch
var_415		= byte ptr -415h
var_414		= byte ptr -414h
var_34		= dword	ptr -34h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 430h
		cmp	[ebp+arg_8], 0
		jz	short loc_658873B0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_658873B0:				; CODE XREF: assuan_inquire+Fj
		cmp	[ebp+arg_C], 0
		jz	short loc_658873BF
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_658873BF:				; CODE XREF: assuan_inquire+1Ej
		cmp	[ebp+arg_0], 0
		jz	short loc_658873FA
		cmp	[ebp+arg_4], 0
		jz	short loc_658873FA
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_41C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_41C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ah
		cmp	eax, 3DFh
		jbe	short loc_65887412

loc_658873FA:				; CODE XREF: assuan_inquire+2Dj
					; assuan_inquire+33j
		mov	[esp+438h+Source], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_65887173
		jmp	loc_658878A8
; ---------------------------------------------------------------------------

loc_65887412:				; CODE XREF: assuan_inquire+62j
		cmp	[ebp+arg_8], 0
		jnz	short loc_6588742B
		cmp	[ebp+arg_C], 0
		jnz	short loc_6588742B
		cmp	[ebp+arg_10], 0
		jnz	short loc_6588742B
		mov	eax, 1
		jmp	short loc_65887430
; ---------------------------------------------------------------------------

loc_6588742B:				; CODE XREF: assuan_inquire+80j
					; assuan_inquire+86j ...
		mov	eax, 0

loc_65887430:				; CODE XREF: assuan_inquire+93j
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_6588745D
		cmp	[ebp+arg_8], 0
		jz	short loc_65887445
		cmp	[ebp+arg_C], 0
		jnz	short loc_6588745D

loc_65887445:				; CODE XREF: assuan_inquire+A7j
		mov	[esp+438h+Source], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_65887173
		jmp	loc_658878A8
; ---------------------------------------------------------------------------

loc_6588745D:				; CODE XREF: assuan_inquire+A1j
					; assuan_inquire+ADj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+184h]
		test	eax, eax
		jnz	short loc_65887482
		mov	[esp+438h+Source], 10Bh
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_65887173
		jmp	loc_658878A8
; ---------------------------------------------------------------------------

loc_65887482:				; CODE XREF: assuan_inquire+D2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+188h]
		test	eax, eax
		jz	short loc_658874A7
		mov	[esp+438h+Source], 108h
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_65887173
		jmp	loc_658878A8
; ---------------------------------------------------------------------------

loc_658874A7:				; CODE XREF: assuan_inquire+F7j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+188h], 1
		cmp	[ebp+var_1C], 0
		jz	short loc_658874E1
		lea	eax, [ebp+var_34]
		mov	edx, eax
		mov	ecx, 0
		mov	eax, 18h
		mov	ebx, eax
		and	ebx, 0FFFFFFFCh
		mov	eax, 0

loc_658874D3:				; CODE XREF: assuan_inquire+145j
		mov	[edx+eax], ecx
		add	eax, 4
		cmp	eax, ebx
		jb	short loc_658874D3
		add	edx, eax
		jmp	short loc_6588750E
; ---------------------------------------------------------------------------

loc_658874E1:				; CODE XREF: assuan_inquire+122j
		cmp	[ebp+arg_10], 0
		jz	short loc_658874EC
		mov	eax, [ebp+arg_10]
		jmp	short loc_658874F1
; ---------------------------------------------------------------------------

loc_658874EC:				; CODE XREF: assuan_inquire+14Fj
		mov	eax, 400h

loc_658874F1:				; CODE XREF: assuan_inquire+154j
		mov	edx, [ebp+arg_10]
		mov	[esp+438h+var_42C], edx
		mov	[esp+438h+var_430], eax
		lea	eax, [ebp+var_34]
		mov	[esp+438h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_6588719C

loc_6588750E:				; CODE XREF: assuan_inquire+149j
		lea	eax, [ebp+var_414]
		mov	dword ptr [eax], 55514E49h
		mov	dword ptr [eax+4], 20455249h
		mov	byte ptr [eax+8], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+438h+Source], eax ; Source
		lea	eax, [ebp+var_414]
		add	eax, 8
		mov	[esp+438h+Dest], eax ; Dest
		call	strcpy
		lea	eax, [ebp+var_414]
		mov	[esp+438h+Source], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax ; int
		call	assuan_write_line
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_6588787C

loc_6588755F:				; CODE XREF: assuan_inquire+1EBj
					; assuan_inquire+216j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_6588412E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+438h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_65883EFD
		test	eax, eax
		jnz	short loc_6588755F
		cmp	[ebp+var_C], 0
		jnz	loc_6588787F
		mov	eax, [ebp+arg_0]
		add	eax, 1B4h
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	short loc_6588755F
		cmp	[ebp+var_18], 0
		jz	short loc_6588755F
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jz	short loc_658875C8
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 65h
		jnz	short loc_6588761E

loc_658875C8:				; CODE XREF: assuan_inquire+226j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jz	short loc_658875E2
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 6Eh
		jnz	short loc_6588761E

loc_658875E2:				; CODE XREF: assuan_inquire+23Dj
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jz	short loc_658875FC
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 64h
		jnz	short loc_6588761E

loc_658875FC:				; CODE XREF: assuan_inquire+257j
		mov	eax, [ebp+var_10]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_65887817
		mov	eax, [ebp+var_10]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	loc_65887817

loc_6588761E:				; CODE XREF: assuan_inquire+230j
					; assuan_inquire+24Aj ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 43h
		jz	short loc_65887632
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 63h
		jnz	short loc_65887681

loc_65887632:				; CODE XREF: assuan_inquire+290j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 41h
		jz	short loc_6588764C
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 61h
		jnz	short loc_65887681

loc_6588764C:				; CODE XREF: assuan_inquire+2A7j
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jz	short loc_65887666
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 6Eh
		jnz	short loc_65887681

loc_65887666:				; CODE XREF: assuan_inquire+2C1j
		mov	[esp+438h+Source], 115h
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_65887173
		mov	[ebp+var_C], eax
		jmp	loc_65887880
; ---------------------------------------------------------------------------

loc_65887681:				; CODE XREF: assuan_inquire+29Aj
					; assuan_inquire+2B4j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jz	short loc_65887695
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 64h
		jnz	short loc_658876A8

loc_65887695:				; CODE XREF: assuan_inquire+2F3j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_658876A8
		cmp	[ebp+var_1C], 0
		jz	short loc_658876C3

loc_658876A8:				; CODE XREF: assuan_inquire+2FDj
					; assuan_inquire+30Aj
		mov	[esp+438h+Source], 112h
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_65887173
		mov	[ebp+var_C], eax
		jmp	loc_65887880
; ---------------------------------------------------------------------------

loc_658876C3:				; CODE XREF: assuan_inquire+310j
		cmp	[ebp+var_18], 2
		jle	loc_6588780E
		add	[ebp+var_10], 2
		sub	[ebp+var_18], 2
		mov	eax, [ebp+var_24]
		test	eax, eax
		jnz	loc_65887811
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	loc_658877FF
; ---------------------------------------------------------------------------

loc_658876EB:				; CODE XREF: assuan_inquire+36Bj
		sub	[ebp+var_18], 1
		add	[ebp+var_14], 1

loc_658876F3:				; CODE XREF: assuan_inquire+46Dj
		cmp	[ebp+var_18], 0
		jz	short loc_65887703
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_658876EB

loc_65887703:				; CODE XREF: assuan_inquire+361j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+438h+var_42C], eax	; size_t
		mov	eax, [ebp+var_10]
		mov	[esp+438h+var_430], eax	; void *
		lea	eax, [ebp+var_34]
		mov	[esp+438h+Source], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax ; int
		call	sub_65887202
		cmp	[ebp+var_18], 2
		jle	loc_658877F9
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_65887757
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_65887783
; ---------------------------------------------------------------------------

loc_65887757:				; CODE XREF: assuan_inquire+3ACj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_65887772
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_65887781
; ---------------------------------------------------------------------------

loc_65887772:				; CODE XREF: assuan_inquire+3C9j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_65887781:				; CODE XREF: assuan_inquire+3DAj
		mov	edx, eax

loc_65887783:				; CODE XREF: assuan_inquire+3BFj
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_6588779E
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_658877C5
; ---------------------------------------------------------------------------

loc_6588779E:				; CODE XREF: assuan_inquire+3F8j
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_658877B9
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_658877C5
; ---------------------------------------------------------------------------

loc_658877B9:				; CODE XREF: assuan_inquire+413j
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_658877C5:				; CODE XREF: assuan_inquire+406j
					; assuan_inquire+421j
		add	eax, edx
		mov	[ebp+var_415], al
		add	[ebp+var_14], 2
		sub	[ebp+var_18], 3
		mov	[esp+438h+var_42C], 1 ;	size_t
		lea	eax, [ebp+var_415]
		mov	[esp+438h+var_430], eax	; void *
		lea	eax, [ebp+var_34]
		mov	[esp+438h+Source], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax ; int
		call	sub_65887202

loc_658877F9:				; CODE XREF: assuan_inquire+39Aj
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_658877FF:				; CODE XREF: assuan_inquire+350j
		cmp	[ebp+var_18], 0
		jnz	loc_658876F3
		jmp	loc_6588755F
; ---------------------------------------------------------------------------

loc_6588780E:				; CODE XREF: assuan_inquire+331j
		nop
		jmp	short loc_65887812
; ---------------------------------------------------------------------------

loc_65887811:				; CODE XREF: assuan_inquire+344j
		nop

loc_65887812:				; CODE XREF: assuan_inquire+479j
		jmp	loc_6588755F
; ---------------------------------------------------------------------------

loc_65887817:				; CODE XREF: assuan_inquire+271j
					; assuan_inquire+282j
		cmp	[ebp+var_1C], 0
		jnz	short loc_65887880
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_6588783C
		mov	[esp+438h+Source], 111h
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_65887173
		mov	[ebp+var_C], eax
		jmp	short loc_65887880
; ---------------------------------------------------------------------------

loc_6588783C:				; CODE XREF: assuan_inquire+48Cj
		mov	eax, [ebp+arg_C]
		mov	[esp+438h+var_430], eax
		lea	eax, [ebp+var_34]
		mov	[esp+438h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_658872F3
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_65887880
		call	gpg_err_code_from_syserror
		mov	[esp+438h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_65887173
		mov	[ebp+var_C], eax
		jmp	short loc_65887880
; ---------------------------------------------------------------------------

loc_6588787C:				; CODE XREF: assuan_inquire+1C3j
		nop
		jmp	short loc_65887880
; ---------------------------------------------------------------------------

loc_6588787F:				; CODE XREF: assuan_inquire+1F1j
		nop

loc_65887880:				; CODE XREF: assuan_inquire+2E6j
					; assuan_inquire+328j ...
		cmp	[ebp+var_1C], 0
		jnz	short loc_65887898
		lea	eax, [ebp+var_34]
		mov	[esp+438h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_6588736F

loc_65887898:				; CODE XREF: assuan_inquire+4EEj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+188h], 0
		mov	eax, [ebp+var_C]

loc_658878A8:				; CODE XREF: assuan_inquire+77j
					; assuan_inquire+C2j ...
		add	esp, 430h
		pop	ebx
		pop	edi
		pop	ebp
		retn
assuan_inquire	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658878B2	proc near		; CODE XREF: sub_65883D60+104p

Memory		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+188h]
		test	eax, eax
		jz	short locret_65887908
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A0h]
		test	eax, eax
		jz	short loc_658878FB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A0h]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax
		call	sub_6588736F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A0h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

loc_658878FB:				; CODE XREF: sub_658878B2+1Ej
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+188h], 0

locret_65887908:			; CODE XREF: sub_658878B2+11j
		leave
		retn
sub_658878B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588790A	proc near		; CODE XREF: sub_65886A4D+11Bp

Memory		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_21		= byte ptr -21h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		add	eax, 1B4h
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5A0h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A0h]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 43h
		jz	short loc_65887947
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 63h
		jnz	short loc_65887996

loc_65887947:				; CODE XREF: sub_6588790A+31j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 41h
		jz	short loc_65887961
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 61h
		jnz	short loc_65887996

loc_65887961:				; CODE XREF: sub_6588790A+48j
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jz	short loc_6588797B
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 6Eh
		jnz	short loc_65887996

loc_6588797B:				; CODE XREF: sub_6588790A+62j
		mov	[esp+38h+var_34], 115h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Memory], eax
		call	sub_65887173
		mov	[ebp+var_C], eax
		jmp	loc_65887BAD
; ---------------------------------------------------------------------------

loc_65887996:				; CODE XREF: sub_6588790A+3Bj
					; sub_6588790A+55j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jz	short loc_658879AA
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 65h
		jnz	short loc_65887A04

loc_658879AA:				; CODE XREF: sub_6588790A+94j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jz	short loc_658879C4
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 6Eh
		jnz	short loc_65887A04

loc_658879C4:				; CODE XREF: sub_6588790A+ABj
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jz	short loc_658879DE
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 64h
		jnz	short loc_65887A04

loc_658879DE:				; CODE XREF: sub_6588790A+C5j
		mov	eax, [ebp+var_10]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_658879F8
		mov	eax, [ebp+var_10]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_65887A04

loc_658879F8:				; CODE XREF: sub_6588790A+DFj
		mov	[ebp+var_C], 0
		jmp	loc_65887BAD
; ---------------------------------------------------------------------------

loc_65887A04:				; CODE XREF: sub_6588790A+9Ej
					; sub_6588790A+B8j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jz	short loc_65887A18
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 64h
		jnz	short loc_65887A2B

loc_65887A18:				; CODE XREF: sub_6588790A+102j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_65887A2B
		cmp	[ebp+var_20], 0
		jnz	short loc_65887A46

loc_65887A2B:				; CODE XREF: sub_6588790A+10Cj
					; sub_6588790A+119j
		mov	[esp+38h+var_34], 112h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Memory], eax
		call	sub_65887173
		mov	[ebp+var_C], eax
		jmp	loc_65887BAD
; ---------------------------------------------------------------------------

loc_65887A46:				; CODE XREF: sub_6588790A+11Fj
		cmp	[ebp+var_14], 2
		jg	short loc_65887A56
		mov	eax, 0
		jmp	locret_65887C63
; ---------------------------------------------------------------------------

loc_65887A56:				; CODE XREF: sub_6588790A+140j
		add	[ebp+var_10], 2
		sub	[ebp+var_14], 2
		mov	eax, [ebp+var_10]
		mov	[ebp+var_18], eax
		jmp	loc_65887B77
; ---------------------------------------------------------------------------

loc_65887A69:				; CODE XREF: sub_6588790A+175j
		sub	[ebp+var_14], 1
		add	[ebp+var_18], 1

loc_65887A71:				; CODE XREF: sub_6588790A+271j
		cmp	[ebp+var_14], 0
		jz	short loc_65887A81
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_65887A69

loc_65887A81:				; CODE XREF: sub_6588790A+16Bj
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+38h+var_2C], eax ;	size_t
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax ;	void *
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_34], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Memory], eax ;	int
		call	sub_65887202
		cmp	[ebp+var_14], 2
		jle	loc_65887B71
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_65887AD5
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_65887B01
; ---------------------------------------------------------------------------

loc_65887AD5:				; CODE XREF: sub_6588790A+1B6j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_65887AF0
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_65887AFF
; ---------------------------------------------------------------------------

loc_65887AF0:				; CODE XREF: sub_6588790A+1D3j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_65887AFF:				; CODE XREF: sub_6588790A+1E4j
		mov	edx, eax

loc_65887B01:				; CODE XREF: sub_6588790A+1C9j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_65887B1C
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_65887B43
; ---------------------------------------------------------------------------

loc_65887B1C:				; CODE XREF: sub_6588790A+202j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_65887B37
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_65887B43
; ---------------------------------------------------------------------------

loc_65887B37:				; CODE XREF: sub_6588790A+21Dj
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_65887B43:				; CODE XREF: sub_6588790A+210j
					; sub_6588790A+22Bj
		add	eax, edx
		mov	[ebp+var_21], al
		add	[ebp+var_18], 2
		sub	[ebp+var_14], 3
		mov	[esp+38h+var_2C], 1 ; size_t
		lea	eax, [ebp+var_21]
		mov	[esp+38h+var_30], eax ;	void *
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_34], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Memory], eax ;	int
		call	sub_65887202

loc_65887B71:				; CODE XREF: sub_6588790A+1A4j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax

loc_65887B77:				; CODE XREF: sub_6588790A+15Aj
		cmp	[ebp+var_14], 0
		jnz	loc_65887A71
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_65887BA3
		mov	[esp+38h+var_34], 111h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Memory], eax
		call	sub_65887173
		mov	[ebp+var_C], eax
		jmp	short loc_65887BAD
; ---------------------------------------------------------------------------

loc_65887BA3:				; CODE XREF: sub_6588790A+27Fj
		mov	eax, 0
		jmp	locret_65887C63
; ---------------------------------------------------------------------------

loc_65887BAD:				; CODE XREF: sub_6588790A+87j
					; sub_6588790A+F5j ...
		mov	[ebp+var_28], 0
		mov	[ebp+var_1C], 0
		cmp	[ebp+var_20], 0
		jz	short loc_65887C24
		lea	eax, [ebp+var_28]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Memory], eax
		call	sub_658872F3
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_65887BFA
		call	gpg_err_code_from_syserror
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Memory], eax
		call	sub_65887173
		mov	[ebp+var_C], eax

loc_65887BFA:				; CODE XREF: sub_6588790A+2D7j
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Memory], eax
		call	sub_6588736F
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1A0h], 0

loc_65887C24:				; CODE XREF: sub_6588790A+2B5j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+188h], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+198h]
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+19Ch]
		mov	[esp+38h+var_2C], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+var_30], edx
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+Memory], eax
		call	ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]

locret_65887C63:			; CODE XREF: sub_6588790A+147j
					; sub_6588790A+29Ej
		leave
		retn
sub_6588790A	endp

; Exported entry  24. assuan_inquire_ext

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_inquire_ext(int, char *, int, int,	int)
		public assuan_inquire_ext
assuan_inquire_ext proc	near

Size		= dword	ptr -418h
Source		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_3FC		= dword	ptr -3FCh
var_3F0		= byte ptr -3F0h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 414h
		mov	[ebp+Memory], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_65887CB1
		cmp	[ebp+arg_4], 0
		jz	short loc_65887CB1
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_3FC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3FC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ah
		cmp	eax, 3DFh
		jbe	short loc_65887CC9

loc_65887CB1:				; CODE XREF: assuan_inquire_ext+15j
					; assuan_inquire_ext+1Bj
		mov	[esp+418h+Source], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+Size], eax
		call	sub_65887173
		jmp	loc_65887E13
; ---------------------------------------------------------------------------

loc_65887CC9:				; CODE XREF: assuan_inquire_ext+4Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+184h]
		test	eax, eax
		jnz	short loc_65887CEE
		mov	[esp+418h+Source], 10Bh
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+Size], eax
		call	sub_65887173
		jmp	loc_65887E13
; ---------------------------------------------------------------------------

loc_65887CEE:				; CODE XREF: assuan_inquire_ext+6Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+188h]
		test	eax, eax
		jz	short loc_65887D13
		mov	[esp+418h+Source], 108h
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+Size], eax
		call	sub_65887173
		jmp	loc_65887E13
; ---------------------------------------------------------------------------

loc_65887D13:				; CODE XREF: assuan_inquire_ext+94j
		mov	[esp+418h+Size], 18h ; Size
		call	malloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_65887D41
		call	gpg_err_code_from_syserror
		mov	[esp+418h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+Size], eax
		call	sub_65887173
		jmp	loc_65887E13
; ---------------------------------------------------------------------------

loc_65887D41:				; CODE XREF: assuan_inquire_ext+C1j
		cmp	[ebp+arg_8], 0
		jz	short loc_65887D4C
		mov	eax, [ebp+arg_8]
		jmp	short loc_65887D51
; ---------------------------------------------------------------------------

loc_65887D4C:				; CODE XREF: assuan_inquire_ext+E0j
		mov	eax, 400h

loc_65887D51:				; CODE XREF: assuan_inquire_ext+E5j
		mov	edx, [ebp+arg_8]
		mov	[esp+418h+var_40C], edx
		mov	[esp+418h+var_410], eax
		mov	eax, [ebp+Memory]
		mov	[esp+418h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+Size], eax
		call	sub_6588719C
		lea	eax, [ebp+var_3F0]
		mov	dword ptr [eax], 55514E49h
		mov	dword ptr [eax+4], 20455249h
		mov	byte ptr [eax+8], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+418h+Source], eax ; Source
		lea	eax, [ebp+var_3F0]
		add	eax, 8
		mov	[esp+418h+Size], eax ; Dest
		call	strcpy
		lea	eax, [ebp+var_3F0]
		mov	[esp+418h+Source], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+Size], eax ; int
		call	assuan_write_line
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_65887DDD
		mov	eax, [ebp+Memory]
		mov	[esp+418h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+Size], eax
		call	sub_6588736F
		mov	eax, [ebp+Memory]
		mov	[esp+418h+Size], eax ; Memory
		call	free
		mov	eax, [ebp+var_10]
		jmp	short loc_65887E13
; ---------------------------------------------------------------------------

loc_65887DDD:				; CODE XREF: assuan_inquire_ext+154j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+188h], 1
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+198h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_10]
		mov	[eax+19Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+Memory]
		mov	[eax+1A0h], edx
		mov	eax, 0

loc_65887E13:				; CODE XREF: assuan_inquire_ext+5Fj
					; assuan_inquire_ext+84j ...
		add	esp, 414h
		pop	edi
		pop	ebp
		retn
assuan_inquire_ext endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65887E1C	proc near		; CODE XREF: sub_65887E43+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_65887E3C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_65887E41
; ---------------------------------------------------------------------------

loc_65887E3C:				; CODE XREF: sub_65887E1C+7j
		mov	eax, 0

loc_65887E41:				; CODE XREF: sub_65887E1C+1Ej
		pop	ebp
		retn
sub_65887E1C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65887E43	proc near		; CODE XREF: assuan_set_hello_line+1Bp
					; assuan_set_hello_line+9Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_65887E56
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_65887E5B
; ---------------------------------------------------------------------------

loc_65887E56:				; CODE XREF: sub_65887E43+Aj
		mov	eax, 0Fh

loc_65887E5B:				; CODE XREF: sub_65887E43+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_65887E1C
		leave
		retn
sub_65887E43	endp

; Exported entry  50. assuan_set_hello_line

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_set_hello_line(int, char *Source)
		public assuan_set_hello_line
assuan_set_hello_line proc near

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Source		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 0
		jnz	short loc_65887E91
		mov	[esp+38h+Val], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65887E43
		jmp	loc_65887F86
; ---------------------------------------------------------------------------

loc_65887E91:				; CODE XREF: assuan_set_hello_line+Bj
		cmp	[ebp+Source], 0
		jnz	short loc_65887EC1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A4h]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65882313
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1A4h], 0
		jmp	loc_65887F81
; ---------------------------------------------------------------------------

loc_65887EC1:				; CODE XREF: assuan_set_hello_line+29j
		mov	eax, [ebp+Source]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 4
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65882268
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_65887F11
		call	gpg_err_code_from_syserror
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65887E43
		jmp	short loc_65887F86
; ---------------------------------------------------------------------------

loc_65887F11:				; CODE XREF: assuan_set_hello_line+8Dj
		mov	[esp+38h+Val], 0Ah ; Val
		mov	eax, [ebp+Source]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_65887F3C
		mov	eax, [ebp+Source]
		mov	[esp+38h+Val], eax ; Source
		mov	eax, [ebp+Dest]
		mov	[esp+38h+Str], eax ; Dest
		call	strcpy
		jmp	short loc_65887F5D
; ---------------------------------------------------------------------------

loc_65887F3C:				; CODE XREF: assuan_set_hello_line+BAj
		mov	edx, offset aOk_1 ; "OK	"
		mov	eax, [ebp+Dest]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+Dest]
		lea	edx, [eax+3]
		mov	eax, [ebp+Source]
		mov	[esp+38h+Val], eax ; Source
		mov	[esp+38h+Str], edx ; Dest
		call	strcpy

loc_65887F5D:				; CODE XREF: assuan_set_hello_line+CEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A4h]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_65882313
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+Dest]
		mov	[eax+1A4h], edx

loc_65887F81:				; CODE XREF: assuan_set_hello_line+50j
		mov	eax, 0

loc_65887F86:				; CODE XREF: assuan_set_hello_line+20j
					; assuan_set_hello_line+A3j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
assuan_set_hello_line endp

; Exported entry   1. assuan_accept

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_accept
assuan_accept	proc near

Str		= dword	ptr -88h
Val		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= byte ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_4A		= byte ptr -4Ah
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 84h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_65887FBB
		mov	[esp+88h+Val], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	sub_65887E43
		jmp	loc_658881A5
; ---------------------------------------------------------------------------

loc_65887FBB:				; CODE XREF: assuan_accept+15j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D94h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_65887FF1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D94h]
		test	eax, eax
		setz	dl
		lea	ecx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0D94h], ecx
		test	dl, dl
		jz	short loc_65887FF1
		mov	eax, 0FFFFFFFFh
		jmp	loc_658881A5
; ---------------------------------------------------------------------------

loc_65887FF1:				; CODE XREF: assuan_accept+3Bj
					; assuan_accept+59j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EB0h]
		test	eax, eax
		jz	short loc_65888031
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0EB4h]
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0EB0h]
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	edx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65888031
		mov	eax, [ebp+var_C]
		jmp	loc_658881A5
; ---------------------------------------------------------------------------

loc_65888031:				; CODE XREF: assuan_accept+70j
					; assuan_accept+9Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1A4h]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_6588810C
		mov	[esp+88h+Val], 0Ah ; Val
		mov	eax, [ebp+var_10]
		mov	[esp+88h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_6588810C

loc_65888067:				; CODE XREF: assuan_accept+139j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+88h+var_7C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+88h+var_80], eax
		mov	[esp+88h+Val], offset asc_65891024 ; "#	"
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	sub_658846B6
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_658880A2
		mov	eax, [ebp+var_C]
		jmp	loc_658881A5
; ---------------------------------------------------------------------------

loc_658880A2:				; CODE XREF: assuan_accept+10Cj
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[esp+88h+Val], 0Ah ; Val
		mov	eax, [ebp+var_10]
		mov	[esp+88h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_65888067
		mov	eax, [ebp+var_10]
		mov	[ebp+var_5C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	dword ptr [esp+88h+var_7C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+88h+var_80], eax
		mov	[esp+88h+Val], offset aOk_1 ; "OK "
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	sub_658846B6
		mov	[ebp+var_C], eax
		jmp	loc_65888195
; ---------------------------------------------------------------------------

loc_6588810C:				; CODE XREF: assuan_accept+B5j
					; assuan_accept+D5j
		cmp	[ebp+var_10], 0
		jz	short loc_65888129
		mov	eax, [ebp+var_10]
		mov	[esp+88h+Val], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax ; int
		call	assuan_write_line
		mov	[ebp+var_C], eax
		jmp	short loc_65888195
; ---------------------------------------------------------------------------

loc_65888129:				; CODE XREF: assuan_accept+184j
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	assuan_get_pid
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jz	short loc_6588817F
		mov	eax, offset aSProcessI ; "%s, process %i"
		mov	edx, [ebp+var_18]
		mov	[esp+88h+var_78], edx
		mov	dword ptr [esp+88h+var_7C], offset aOkPleasedToMee ; "OK Pleased to meet you"
		mov	[esp+88h+var_80], eax ;	char *
		mov	[esp+88h+Val], 32h ; size_t
		lea	eax, [ebp+var_4A]
		mov	[esp+88h+Str], eax ; char *
		call	sub_6588E410
		lea	eax, [ebp+var_4A]
		mov	[esp+88h+Val], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax ; int
		call	assuan_write_line
		mov	[ebp+var_C], eax
		jmp	short loc_65888195
; ---------------------------------------------------------------------------

loc_6588817F:				; CODE XREF: assuan_accept+1AFj
		mov	[esp+88h+Val], offset aOkPleasedToMee ;	"OK Pleased to meet you"
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax ; int
		call	assuan_write_line
		mov	[ebp+var_C], eax

loc_65888195:				; CODE XREF: assuan_accept+17Bj
					; assuan_accept+19Bj ...
		cmp	[ebp+var_C], 0
		jz	short loc_658881A0
		mov	eax, [ebp+var_C]
		jmp	short loc_658881A5
; ---------------------------------------------------------------------------

loc_658881A0:				; CODE XREF: assuan_accept+20Dj
		mov	eax, 0

loc_658881A5:				; CODE XREF: assuan_accept+2Aj
					; assuan_accept+60j ...
		add	esp, 84h
		pop	edi
		pop	ebp
		retn
assuan_accept	endp

; Exported entry  14. assuan_get_input_fd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_input_fd
assuan_get_input_fd proc near

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_658881C2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EE8h]
		jmp	short loc_658881C7
; ---------------------------------------------------------------------------

loc_658881C2:				; CODE XREF: assuan_get_input_fd+7j
		mov	eax, 0FFFFFFFFh

loc_658881C7:				; CODE XREF: assuan_get_input_fd+12j
		pop	ebp
		retn
assuan_get_input_fd endp

; Exported entry  17. assuan_get_output_fd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_output_fd
assuan_get_output_fd proc near

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_658881DD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EECh]
		jmp	short loc_658881E2
; ---------------------------------------------------------------------------

loc_658881DD:				; CODE XREF: assuan_get_output_fd+7j
		mov	eax, 0FFFFFFFFh

loc_658881E2:				; CODE XREF: assuan_get_output_fd+12j
		pop	ebp
		retn
assuan_get_output_fd endp

; Exported entry   3. assuan_close_input_fd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_close_input_fd
assuan_close_input_fd proc near		; CODE XREF: sub_658854A1+31p
					; sub_65885592+41p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_658881FE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EE8h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_65888213

loc_658881FE:				; CODE XREF: assuan_close_input_fd+Aj
		mov	[esp+18h+var_14], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65887E43
		jmp	short locret_6588823D
; ---------------------------------------------------------------------------

loc_65888213:				; CODE XREF: assuan_close_input_fd+18j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EE8h]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65882627
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EE8h], 0FFFFFFFFh
		mov	eax, 0

locret_6588823D:			; CODE XREF: assuan_close_input_fd+2Dj
		leave
		retn
assuan_close_input_fd endp

; Exported entry   4. assuan_close_output_fd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_close_output_fd
assuan_close_output_fd proc near	; CODE XREF: sub_658854A1+3Cp
					; sub_65885592+4Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_65888259
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EECh]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_6588826E

loc_65888259:				; CODE XREF: assuan_close_output_fd+Aj
		mov	[esp+18h+var_14], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65887E43
		jmp	short locret_65888298
; ---------------------------------------------------------------------------

loc_6588826E:				; CODE XREF: assuan_close_output_fd+18j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EECh]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65882627
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EECh], 0FFFFFFFFh
		mov	eax, 0

locret_65888298:			; CODE XREF: assuan_close_output_fd+2Dj
		leave
		retn
assuan_close_output_fd endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588829C	proc near		; CODE XREF: sub_658882C3+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_658882BC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_658882C1
; ---------------------------------------------------------------------------

loc_658882BC:				; CODE XREF: sub_6588829C+7j
		mov	eax, 0

loc_658882C1:				; CODE XREF: sub_6588829C+1Ej
		pop	ebp
		retn
sub_6588829C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658882C3	proc near		; CODE XREF: assuan_init_pipe_server+175p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_658882D6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_658882DB
; ---------------------------------------------------------------------------

loc_658882D6:				; CODE XREF: sub_658882C3+Aj
		mov	eax, 0Fh

loc_658882DB:				; CODE XREF: sub_658882C3+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_6588829C
		leave
		retn
sub_658882C3	endp

; Exported entry  21. assuan_init_pipe_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_init_pipe_server
assuan_init_pipe_server	proc near

VarName		= dword	ptr -58h
EndPtr		= dword	ptr -54h
Radix		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
Str		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	[ebp+var_1C], 2
		mov	[ebp+var_20], offset aAssuan_init_pi ; "assuan_init_pipe_server"
		mov	[ebp+var_24], offset aCtx_3 ; "ctx"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_28]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_24]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+Radix], offset	aSSPEnter ; "%s	(%s=%p): enter\n"
		mov	[esp+58h+EndPtr], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+VarName], eax
		call	sub_65882E28
		cmp	[ebp+arg_4], 0
		jz	short loc_658883A2
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	ecx, [eax]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_3C], ecx
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+var_28]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_24]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+Radix], offset	aSSPCheckFd00xX	; "%s (%s=%p): check: fd[0]=0x%x, fd[1]=0x"...
		mov	[esp+58h+EndPtr], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+VarName], eax
		call	sub_65882E28

loc_658883A2:				; CODE XREF: assuan_init_pipe_server+70j
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+VarName], eax
		call	sub_658862D9
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	loc_6588846B
		cmp	[ebp+var_2C], 0
		jnz	short loc_658883F6
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_28]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_24]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+Radix], offset	aSSPLeave_0 ; "%s (%s=%p): leave\n"
		mov	[esp+58h+EndPtr], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+VarName], eax
		call	sub_65882E28
		mov	eax, 0
		jmp	short loc_65888466
; ---------------------------------------------------------------------------

loc_658883F6:				; CODE XREF: assuan_init_pipe_server+D2j
		cmp	[ebp+arg_0], 0
		jz	short loc_6588840D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+58h+VarName], eax
		call	gpg_strsource
		mov	ebx, eax
		jmp	short loc_65888412
; ---------------------------------------------------------------------------

loc_6588840D:				; CODE XREF: assuan_init_pipe_server+10Ej
		mov	ebx, offset byte_658910BE

loc_65888412:				; CODE XREF: assuan_init_pipe_server+11Fj
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+VarName], eax
		call	gpg_strerror
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_3C], ebx
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+Radix], offset	aSSPErrorSS_0 ;	"%s (%s=%p): error: %s <%s>\n"
		mov	[esp+58h+EndPtr], edx
		mov	eax, [ebp+var_18]
		mov	[esp+58h+VarName], eax
		call	sub_65882E28
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+VarName], eax
		call	sub_658882C3

loc_65888466:				; CODE XREF: assuan_init_pipe_server+108j
		jmp	loc_658885A8
; ---------------------------------------------------------------------------

loc_6588846B:				; CODE XREF: assuan_init_pipe_server+C8j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+184h], 1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+164h], offset sub_65883E6B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+168h], offset sub_6588CB5C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+16Ch], offset sub_6588CB8A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+170h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+174h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D94h], 1
		mov	[esp+58h+VarName], offset VarName ; "_assuan_pipe_connect_pid"
		call	getenv
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_65888524
		mov	[esp+58h+Radix], 0Ah ; Radix
		mov	[esp+58h+EndPtr], 0 ; EndPtr
		mov	eax, [ebp+Str]
		mov	[esp+58h+VarName], eax ; Str
		call	strtoul
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_65888524
		cmp	[ebp+var_34], 0
		jz	short loc_65888524
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+arg_0]
		mov	[eax+0D98h], edx
		jmp	short loc_65888531
; ---------------------------------------------------------------------------

loc_65888524:				; CODE XREF: assuan_init_pipe_server+1FEj
					; assuan_init_pipe_server+222j	...
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D98h], 0FFFFFFFFh

loc_65888531:				; CODE XREF: assuan_init_pipe_server+236j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EB0h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EB4h], offset sub_65883D60
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1ACh], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+998h], edx
		cmp	[ebp+var_14], 0
		jz	short loc_65888574
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+VarName], eax
		call	sub_65889A87

loc_65888574:				; CODE XREF: assuan_init_pipe_server+27Bj
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_28]
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+var_24]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+Radix], offset	aSSPLeave_0 ; "%s (%s=%p): leave\n"
		mov	[esp+58h+EndPtr], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+VarName], eax
		call	sub_65882E28
		mov	eax, 0

loc_658885A8:				; CODE XREF: assuan_init_pipe_server:loc_65888466j
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
assuan_init_pipe_server	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658885B0	proc near		; CODE XREF: sub_658885D7+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_658885D0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_658885D5
; ---------------------------------------------------------------------------

loc_658885D0:				; CODE XREF: sub_658885B0+7j
		mov	eax, 0

loc_658885D5:				; CODE XREF: sub_658885B0+1Ej
		pop	ebp
		retn
sub_658885B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658885D7	proc near		; CODE XREF: sub_658886D1+8Bp
					; sub_658886D1+110p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_658885EA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_658885EF
; ---------------------------------------------------------------------------

loc_658885EA:				; CODE XREF: sub_658885D7+Aj
		mov	eax, 0Fh

loc_658885EF:				; CODE XREF: sub_658885D7+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_658885B0
		leave
		retn
sub_658885D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65888600	proc near		; CODE XREF: sub_658886D1+129p
					; DATA XREF: assuan_init_socket_server+21Eo

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0DB4h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset aCtx_4	; "ctx"
		mov	[esp+38h+var_2C], offset aAccept_connect ; "accept_connection_bottom"
		mov	[esp+38h+var_30], offset aSSPCall_1 ; "%s (%s=%p): call\n"
		mov	[esp+38h+var_34], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+15Ch], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1ACh], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1B0h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+5A0h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+990h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+994h], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+998h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D8Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D90h], 0
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+11Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+11Ch], dl
		mov	eax, 0
		leave
		retn
sub_65888600	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658886D1	proc near		; DATA XREF: assuan_init_socket_server:loc_65888A26o

s		= dword	ptr -0A8h
addr		= dword	ptr -0A4h
addrlen		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_80		= dword	ptr -80h
var_7C		= sockaddr ptr -7Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0A8h
		mov	[ebp+var_80], 70h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D9Ch]
		mov	[esp+0A8h+var_90], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+var_94], eax
		mov	[esp+0A8h+var_98], offset aCtx_4 ; "ctx"
		mov	[esp+0A8h+var_9C], offset aAccept_conne_0 ; "accept_connection"
		mov	[esp+0A8h+addrlen], offset aSSPCallListen_ ; "%s (%s=%p): call:	listen_fd=0x%x\n"
		mov	[esp+0A8h+addr], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+s], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0D9Ch]
		lea	edx, [ebp+var_80]
		mov	[esp+0A8h+addrlen], edx	; addrlen
		lea	edx, [ebp+var_7C]
		mov	[esp+0A8h+addr], edx ; addr
		mov	[esp+0A8h+s], eax ; s
		mov	eax, ds:accept
		call	eax ; accept
		sub	esp, 0Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_65888766
		call	gpg_err_code_from_syserror
		mov	[esp+0A8h+addr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+s], eax
		call	sub_658885D7
		jmp	locret_658887FF
; ---------------------------------------------------------------------------

loc_65888766:				; CODE XREF: sub_658886D1+7Aj
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+var_90], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+var_94], eax
		mov	[esp+0A8h+var_98], offset aCtx_4 ; "ctx"
		mov	[esp+0A8h+var_9C], offset aAccept_conne_0 ; "accept_connection"
		mov	[esp+0A8h+addrlen], offset aSSPCallFd0xX_0 ; "%s (%s=%p): call:	fd->0x%x\n"
		mov	[esp+0A8h+addr], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+s], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		add	eax, 0DA0h
		mov	[esp+0A8h+addrlen], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+addr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+s], eax
		call	sub_6588BA4D
		test	eax, eax
		jz	short loc_658887E8
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+addr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+s], eax
		call	sub_65882627
		mov	[esp+0A8h+addr], 102h
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+s], eax
		call	sub_658885D7
		jmp	short locret_658887FF
; ---------------------------------------------------------------------------

loc_658887E8:				; CODE XREF: sub_658886D1+EEj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+0DB4h], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+s], eax
		call	sub_65888600

locret_658887FF:			; CODE XREF: sub_658886D1+90j
					; sub_658886D1+115j
		leave
		retn
sub_658886D1	endp

; Exported entry  22. assuan_init_socket_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_init_socket_server
assuan_init_socket_server proc near

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 2
		mov	[ebp+var_14], offset aAssuan_init_so ; "assuan_init_socket_server"
		mov	[ebp+var_18], offset aCtx_4 ; "ctx"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_2C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_30], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset aSSPEnterFd0xXF ; "%s (%s=%p):	enter: fd=0x%x,	flags=0x%x\"...
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_658862D9
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_6588892F
		cmp	[ebp+var_20], 0
		jnz	short loc_658888BA
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset aSSPLeave_1 ; "%s (%s=%p): leave\n"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, 0
		jmp	short loc_6588892A
; ---------------------------------------------------------------------------

loc_658888BA:				; CODE XREF: assuan_init_socket_server+81j
		cmp	[ebp+arg_0], 0
		jz	short loc_658888D1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax
		call	gpg_strsource
		mov	ebx, eax
		jmp	short loc_658888D6
; ---------------------------------------------------------------------------

loc_658888D1:				; CODE XREF: assuan_init_socket_server+BDj
		mov	ebx, offset byte_658911CB

loc_658888D6:				; CODE XREF: assuan_init_socket_server+CEj
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_2C], ebx
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], offset aSSPErrorSS_1 ; "%s (%s=%p): error: %s	<%s>\n"
		mov	[esp+48h+var_44], edx
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_658885D7

loc_6588892A:				; CODE XREF: assuan_init_socket_server+B7j
		jmp	loc_65888B21
; ---------------------------------------------------------------------------

loc_6588892F:				; CODE XREF: assuan_init_socket_server+77j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+164h], offset sub_65883E6B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+168h], offset sub_6588CB5C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+16Ch], offset sub_6588CB8A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+170h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+174h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+184h], 1
		mov	eax, [ebp+arg_8]
		and	eax, 2
		test	eax, eax
		jz	short loc_65888996
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D94h], 1
		jmp	short loc_658889A3
; ---------------------------------------------------------------------------

loc_65888996:				; CODE XREF: assuan_init_socket_server+184j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D94h], 0FFFFFFFFh

loc_658889A3:				; CODE XREF: assuan_init_socket_server+193j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EE8h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EECh], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1ACh], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+998h], 0FFFFFFFFh
		mov	eax, [ebp+arg_8]
		and	eax, 2
		test	eax, eax
		jz	short loc_658889FC
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D9Ch], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0DB4h], edx
		jmp	short loc_65888A15
; ---------------------------------------------------------------------------

loc_658889FC:				; CODE XREF: assuan_init_socket_server+1DEj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0D9Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0DB4h], 0FFFFFFFFh

loc_65888A15:				; CODE XREF: assuan_init_socket_server+1F9j
		mov	eax, [ebp+arg_8]
		and	eax, 2
		test	eax, eax
		jz	short loc_65888A26
		mov	eax, offset sub_65888600
		jmp	short loc_65888A2B
; ---------------------------------------------------------------------------

loc_65888A26:				; CODE XREF: assuan_init_socket_server+21Cj
		mov	eax, offset sub_658886D1

loc_65888A2B:				; CODE XREF: assuan_init_socket_server+223j
		mov	edx, [ebp+arg_0]
		mov	[edx+0EB0h], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EB4h], offset sub_65883D60
		mov	eax, [ebp+arg_8]
		and	eax, 1
		test	al, al
		jz	short loc_65888A56
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65889A87

loc_65888A56:				; CODE XREF: assuan_init_socket_server+248j
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_658862D9
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_65888A75
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_65881959

loc_65888A75:				; CODE XREF: assuan_init_socket_server+267j
		cmp	[ebp+var_20], 0
		jnz	short loc_65888AB1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset aSSPLeave_1 ; "%s (%s=%p): leave\n"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, 0
		jmp	short loc_65888B21
; ---------------------------------------------------------------------------

loc_65888AB1:				; CODE XREF: assuan_init_socket_server+278j
		cmp	[ebp+arg_0], 0
		jz	short loc_65888AC8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax
		call	gpg_strsource
		mov	ebx, eax
		jmp	short loc_65888ACD
; ---------------------------------------------------------------------------

loc_65888AC8:				; CODE XREF: assuan_init_socket_server+2B4j
		mov	ebx, offset byte_658911CB

loc_65888ACD:				; CODE XREF: assuan_init_socket_server+2C5j
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_2C], ebx
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], offset aSSPErrorSS_1 ; "%s (%s=%p): error: %s	<%s>\n"
		mov	[esp+48h+var_44], edx
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_65882E28
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_658885D7

loc_65888B21:				; CODE XREF: assuan_init_socket_server:loc_6588892Aj
					; assuan_init_socket_server+2AEj
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
assuan_init_socket_server endp

; Exported entry  78. assuan_set_sock_nonce

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_sock_nonce
assuan_set_sock_nonce proc near

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_65888B68
		cmp	[ebp+arg_4], 0
		jz	short loc_65888B68
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	ecx, [edx]
		mov	[eax+0DA0h], ecx
		mov	ecx, [edx+4]
		mov	[eax+0DA4h], ecx
		mov	ecx, [edx+8]
		mov	[eax+0DA8h], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0DACh], ecx
		mov	edx, [edx+10h]
		mov	[eax+0DB0h], edx

loc_65888B68:				; CODE XREF: assuan_set_sock_nonce+7j
					; assuan_set_sock_nonce+Dj
		pop	ebp
		retn
assuan_set_sock_nonce endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65888B6C	proc near		; CODE XREF: sub_65888B93+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_65888B8C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_65888B91
; ---------------------------------------------------------------------------

loc_65888B8C:				; CODE XREF: sub_65888B6C+7j
		mov	eax, 0

loc_65888B91:				; CODE XREF: sub_65888B6C+1Ej
		pop	ebp
		retn
sub_65888B6C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65888B93	proc near		; CODE XREF: sub_65888BC1+C7p
					; sub_65888CC3+43p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_65888BA6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_65888BAB
; ---------------------------------------------------------------------------

loc_65888BA6:				; CODE XREF: sub_65888B93+Aj
		mov	eax, 0Fh

loc_65888BAB:				; CODE XREF: sub_65888B93+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_65888B6C
		leave
		retn
sub_65888B93	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65888BBC	proc near		; CODE XREF: sub_65888CC3+5Ep
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_65888BBC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65888BC1	proc near		; CODE XREF: sub_65888CC3+280p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+var_2C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65883A11
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65888C34
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset aCtx_5	; "ctx"
		mov	[esp+38h+var_2C], offset aInitial_handsh ; "initial_handshake"
		mov	[esp+38h+var_30], offset aSSPCallCanTCon ; "%s (%s=%p):	call: can't connect server:"...
		mov	[esp+38h+var_34], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882E28
		jmp	short loc_65888C90
; ---------------------------------------------------------------------------

loc_65888C34:				; CODE XREF: sub_65888BC1+2Ej
		mov	eax, [ebp+var_10]
		cmp	eax, 1
		jz	short loc_65888C90
		mov	eax, [ebp+arg_0]
		add	eax, 1B4h
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset aCtx_5	; "ctx"
		mov	[esp+38h+var_2C], offset aInitial_handsh ; "initial_handshake"
		mov	[esp+38h+var_30], offset aSSPCallCanTC_0 ; "%s (%s=%p):	call: can't connect server:"...
		mov	[esp+38h+var_34], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882E28
		mov	[esp+38h+var_34], 103h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65888B93
		mov	[ebp+var_C], eax

loc_65888C90:				; CODE XREF: sub_65888BC1+71j
					; sub_65888BC1+79j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_65888BC1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65888C95	proc near		; DATA XREF: sub_65888CC3+123o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short locret_65888CC1
		mov	eax, [ebp+var_C]
		mov	ecx, [eax]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	ecx

locret_65888CC1:			; CODE XREF: sub_65888C95+13j
		leave
		retn
sub_65888C95	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65888CC3	proc near		; CODE XREF: assuan_pipe_connect+A2p

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_30], eax
		call	_getpid
		mov	[ebp+var_2C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_65888CF8
		cmp	[ebp+arg_4], 0
		jz	short loc_65888CF8
		cmp	[ebp+arg_8], 0
		jz	short loc_65888CF8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_65888D10

loc_65888CF8:				; CODE XREF: sub_65888CC3+1Ej
					; sub_65888CC3+24j ...
		mov	[esp+68h+var_64], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65888B93
		jmp	locret_65888F5F
; ---------------------------------------------------------------------------

loc_65888D10:				; CODE XREF: sub_65888CC3+33j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 4
		test	al, al
		jnz	short loc_65888D26
		call	sub_65888BBC

loc_65888D26:				; CODE XREF: sub_65888CC3+5Cj
		mov	[esp+68h+var_60], 1
		lea	eax, [ebp+var_1C]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_658824B3
		test	eax, eax
		jns	short loc_65888D5D
		call	gpg_err_code_from_syserror
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65888B93
		jmp	locret_65888F5F
; ---------------------------------------------------------------------------

loc_65888D5D:				; CODE XREF: sub_65888CC3+7Fj
		mov	[esp+68h+var_60], 0
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_658824B3
		test	eax, eax
		jns	short loc_65888DB8
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65882627
		mov	eax, [ebp+var_18]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65882680
		call	gpg_err_code_from_syserror
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65888B93
		jmp	locret_65888F5F
; ---------------------------------------------------------------------------

loc_65888DB8:				; CODE XREF: sub_65888CC3+B6j
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_18]
		and	eax, 80h
		test	eax, eax
		jz	short loc_65888DD2
		or	[ebp+var_C], 80h

loc_65888DD2:				; CODE XREF: sub_65888CC3+106j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_24]
		mov	ecx, [ebp+var_C]
		mov	[esp+68h+var_44], ecx
		lea	ecx, [ebp+var_34]
		mov	[esp+68h+var_48], ecx
		mov	[esp+68h+var_4C], offset sub_65888C95
		mov	ecx, [ebp+arg_C]
		mov	[esp+68h+var_50], ecx
		mov	[esp+68h+var_54], edx
		mov	[esp+68h+var_58], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+var_5C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+var_60], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65882791
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_65888E8D
		call	gpg_err_code_from_syserror
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65882627
		mov	eax, [ebp+var_18]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65882680
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65882680
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65882627
		mov	eax, [ebp+var_14]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65888B93
		jmp	locret_65888F5F
; ---------------------------------------------------------------------------

loc_65888E8D:				; CODE XREF: sub_65888CC3+161j
		mov	eax, [ebp+var_18]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65882680
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65882680
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+164h], offset sub_65883540
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+168h], offset sub_6588CB5C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+16Ch], offset sub_6588CB8A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+170h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+174h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EB4h], offset sub_65883440
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D94h], 1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EB0h], 0
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	[eax+1ACh], edx
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+arg_0]
		mov	[eax+998h], edx
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_0]
		mov	[eax+0D98h], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65888BC1
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_65888F5C
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_65881959

loc_65888F5C:				; CODE XREF: sub_65888CC3+28Cj
		mov	eax, [ebp+var_14]

locret_65888F5F:			; CODE XREF: sub_65888CC3+48j
					; sub_65888CC3+95j ...
		leave
		retn
sub_65888CC3	endp

; Exported entry  28. assuan_pipe_connect

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_pipe_connect
assuan_pipe_connect proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jz	short loc_65888F72
		mov	eax, [ebp+arg_4]
		jmp	short loc_65888F77
; ---------------------------------------------------------------------------

loc_65888F72:				; CODE XREF: assuan_pipe_connect+Aj
		mov	eax, offset aNull_0 ; "(null)"

loc_65888F77:				; CODE XREF: assuan_pipe_connect+Fj
		mov	edx, [ebp+arg_18]
		mov	[esp+28h+var_C], edx
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_18], offset aCtx_5	; "ctx"
		mov	[esp+28h+var_1C], offset aAssuan_pipe_co ; "assuan_pipe_connect"
		mov	[esp+28h+var_20], offset aSSPCallNameSFl ; "%s (%s=%p):	call: name=%s, flags=0x%x\n"
		mov	[esp+28h+var_24], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882E28
		mov	eax, [ebp+arg_18]
		and	eax, 1
		test	al, al
		jz	short loc_65888FD3
		mov	[esp+28h+var_24], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65888B93
		jmp	short locret_65889008
; ---------------------------------------------------------------------------

loc_65888FD3:				; CODE XREF: assuan_pipe_connect+5Bj
		mov	eax, [ebp+arg_18]
		mov	[esp+28h+var_10], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+28h+var_14], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65888CC3

locret_65889008:			; CODE XREF: assuan_pipe_connect+70j
		leave
		retn
assuan_pipe_connect endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588900C	proc near		; CODE XREF: sub_65889055+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_6588902C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_65889031
; ---------------------------------------------------------------------------

loc_6588902C:				; CODE XREF: sub_6588900C+7j
		mov	eax, 0

loc_65889031:				; CODE XREF: sub_6588900C+1Ej
		pop	ebp
		retn
sub_6588900C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65889033	proc near		; CODE XREF: assuan_socket_connect_fd+1Fp

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jns	short loc_65889046
		mov	eax, 0FFFFFFFFh
		jmp	short locret_65889053
; ---------------------------------------------------------------------------

loc_65889046:				; CODE XREF: sub_65889033+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

locret_65889053:			; CODE XREF: sub_65889033+11j
		leave
		retn
sub_65889033	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65889055	proc near		; CODE XREF: sub_65889107+183p
					; assuan_socket_connect+9Fp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_65889068
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_6588906D
; ---------------------------------------------------------------------------

loc_65889068:				; CODE XREF: sub_65889055+Aj
		mov	eax, 0Fh

loc_6588906D:				; CODE XREF: sub_65889055+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_6588900C
		leave
		retn
sub_65889055	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588907E	proc near		; CODE XREF: assuan_socket_connect+308p
					; assuan_socket_connect+38Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		jmp	short loc_658890C0
; ---------------------------------------------------------------------------

loc_6588908D:				; CODE XREF: sub_6588907E+5Ej
		mov	edx, [ebp+var_4]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	eax, edx
		sub	eax, 30h
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0FFFFh
		jbe	short loc_658890BC
		mov	eax, 0
		jmp	short locret_65889105
; ---------------------------------------------------------------------------

loc_658890BC:				; CODE XREF: sub_6588907E+35j
		add	[ebp+arg_0], 1

loc_658890C0:				; CODE XREF: sub_6588907E+Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_658890DE
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_658890DE
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_6588908D

loc_658890DE:				; CODE XREF: sub_6588907E+4Aj
					; sub_6588907E+54j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_658890EE
		cmp	[ebp+var_4], 0
		jnz	short loc_658890F5

loc_658890EE:				; CODE XREF: sub_6588907E+68j
		mov	eax, 0
		jmp	short locret_65889105
; ---------------------------------------------------------------------------

loc_658890F5:				; CODE XREF: sub_6588907E+6Ej
		mov	eax, [ebp+var_4]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], dx
		mov	eax, 1

locret_65889105:			; CODE XREF: sub_6588907E+3Cj
					; sub_6588907E+75j
		leave
		retn
sub_6588907E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65889107	proc near		; CODE XREF: assuan_socket_connect_fd+48p
					; assuan_socket_connect+5AAp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+164h], offset sub_65883540
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+168h], offset sub_6588CB5C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+16Ch], offset sub_6588CB8A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+170h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+174h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EB4h], offset sub_65883440
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+1ACh], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+998h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0D94h], 0FFFFFFFFh
		mov	eax, [ebp+arg_8]
		and	eax, 1
		test	al, al
		jz	short loc_65889195
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65889A87

loc_65889195:				; CODE XREF: sub_65889107+81j
		mov	[esp+38h+var_2C], 0
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65883A11
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_65889205
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset aCtx_6	; "ctx"
		mov	[esp+38h+var_2C], offset aAssuan_socket_ ; "assuan_socket_connect"
		mov	[esp+38h+var_30], offset aSSPCallCanTC_1 ; "%s (%s=%p):	call: can't connect to serv"...
		mov	[esp+38h+var_34], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882E28
		jmp	loc_65889292
; ---------------------------------------------------------------------------

loc_65889205:				; CODE XREF: sub_65889107+B6j
		mov	eax, [ebp+var_14]
		cmp	eax, 1
		jz	loc_65889292
		mov	eax, [ebp+arg_0]
		add	eax, 1B4h
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_6588327E
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_6588927C
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset aCtx_6	; "ctx"
		mov	[esp+38h+var_2C], offset aAssuan_socket_ ; "assuan_socket_connect"
		mov	[esp+38h+var_30], offset aSSPCallCanTC_2 ; "%s (%s=%p):	call: can't connect to serv"...
		mov	[esp+38h+var_34], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882E28
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65882313

loc_6588927C:				; CODE XREF: sub_65889107+128j
		mov	[esp+38h+var_34], 103h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_65889055
		mov	[ebp+var_C], eax

loc_65889292:				; CODE XREF: sub_65889107+F9j
					; sub_65889107+104j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_65889107	endp

; Exported entry  86. assuan_socket_connect_fd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_socket_connect_fd
assuan_socket_connect_fd proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_658892A9
		cmp	[ebp+arg_4], 0
		jns	short loc_658892B0

loc_658892A9:				; CODE XREF: assuan_socket_connect_fd+Aj
		mov	eax, 2Dh
		jmp	short locret_658892FB
; ---------------------------------------------------------------------------

loc_658892B0:				; CODE XREF: assuan_socket_connect_fd+10j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_65889033
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_658892CB
		mov	eax, 2Dh
		jmp	short locret_658892FB
; ---------------------------------------------------------------------------

loc_658892CB:				; CODE XREF: assuan_socket_connect_fd+2Bj
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65889107
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_658892F8
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65881959

loc_658892F8:				; CODE XREF: assuan_socket_connect_fd+54j
		mov	eax, [ebp+var_10]

locret_658892FB:			; CODE XREF: assuan_socket_connect_fd+17j
					; assuan_socket_connect_fd+32j
		leave
		retn
assuan_socket_connect_fd endp

; Exported entry  66. assuan_socket_connect

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_socket_connect(int, char *, int, int)
		public assuan_socket_connect
assuan_socket_connect proc near

Dest		= dword	ptr -0F8h
Source		= dword	ptr -0F4h
Count		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_CC		= dword	ptr -0CCh
var_BE		= word ptr -0BEh
var_BC		= word ptr -0BCh
var_BA		= word ptr -0BAh
var_B8		= dword	ptr -0B8h
var_AC		= word ptr -0ACh
var_3F		= byte ptr -3Fh
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
Str		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ECh
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_BE], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_2C], 1
		mov	[ebp+var_30], 1
		cmp	[ebp+arg_4], 0
		jz	short loc_65889340
		mov	eax, [ebp+arg_4]
		jmp	short loc_65889345
; ---------------------------------------------------------------------------

loc_65889340:				; CODE XREF: assuan_socket_connect+3Cj
		mov	eax, offset aNull_1 ; "(null)"

loc_65889345:				; CODE XREF: assuan_socket_connect+41j
		mov	edx, [ebp+arg_C]
		mov	[esp+0F8h+var_DC], edx
		mov	[esp+0F8h+var_E0], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+var_E4], eax
		mov	[esp+0F8h+var_E8], offset aCtx_6 ; "ctx"
		mov	[esp+0F8h+var_EC], offset aAssuan_socket_ ; "assuan_socket_connect"
		mov	[esp+0F8h+Count], offset aSSPCallNameS_0 ; "%s (%s=%p):	call: name=%s, flags=0x%x\n"
		mov	[esp+0F8h+Source], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65882E28
		cmp	[ebp+arg_0], 0
		jz	short loc_6588938E
		cmp	[ebp+arg_4], 0
		jnz	short loc_658893A6

loc_6588938E:				; CODE XREF: assuan_socket_connect+89j
		mov	[esp+0F8h+Source], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		jmp	loc_658898C3
; ---------------------------------------------------------------------------

loc_658893A6:				; CODE XREF: assuan_socket_connect+8Fj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aFile ; "file://"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_658893E4
		mov	eax, [ebp+arg_4]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_658893E4
		add	[ebp+arg_4], 7
		jmp	loc_6588947A
; ---------------------------------------------------------------------------

loc_658893E4:				; CODE XREF: assuan_socket_connect+CFj
					; assuan_socket_connect+DCj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aAssuan ; "assuan://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_6588942D
		mov	eax, [ebp+arg_4]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_6588942D
		add	[ebp+arg_4], 9
		mov	[ebp+var_2C], 2
		mov	[ebp+var_30], 2
		jmp	short loc_6588947A
; ---------------------------------------------------------------------------

loc_6588942D:				; CODE XREF: assuan_socket_connect+10Dj
					; assuan_socket_connect+11Aj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_6588944E
		mov	eax, [ebp+var_28]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_6588944E
		add	[ebp+var_28], 2

loc_6588944E:				; CODE XREF: assuan_socket_connect+13Ej
					; assuan_socket_connect+14Bj
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_6588947A
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_6588947A
		mov	[esp+0F8h+Source], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		jmp	loc_658898C3
; ---------------------------------------------------------------------------

loc_6588947A:				; CODE XREF: assuan_socket_connect+E2j
					; assuan_socket_connect+12Ej ...
		cmp	[ebp+var_2C], 1
		jnz	loc_6588954D
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_CC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_CC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		cmp	eax, 65h
		jbe	short loc_658894C9
		mov	[esp+0F8h+Source], 105h
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		jmp	loc_658898C3
; ---------------------------------------------------------------------------

loc_658894C9:				; CODE XREF: assuan_socket_connect+1B2j
		lea	eax, [ebp+var_AC]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 1Ch
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+var_AC], 1
		mov	[esp+0F8h+Count], 65h ;	Count
		mov	eax, [ebp+arg_4]
		mov	[esp+0F8h+Source], eax ; Source
		lea	eax, [ebp+var_AC]
		add	eax, 8
		mov	[esp+0F8h+Dest], eax ; Dest
		call	strncpy
		mov	[ebp+var_3F], 0
		lea	eax, [ebp+var_AC]
		add	eax, 8
		mov	[ebp+var_CC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_CC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 8
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_AC]
		mov	[ebp+var_20], eax
		jmp	loc_65889768
; ---------------------------------------------------------------------------

loc_6588954D:				; CODE XREF: assuan_socket_connect+181j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_CC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_CC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+0F8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65882268
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_658895A6
		call	gpg_err_code_from_syserror
		mov	[esp+0F8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		jmp	loc_658898C3
; ---------------------------------------------------------------------------

loc_658895A6:				; CODE XREF: assuan_socket_connect+28Ej
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jnz	loc_6588964A
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0F8h+Source], eax ; Source
		mov	eax, [ebp+Str]
		mov	[esp+0F8h+Dest], eax ; Dest
		call	strcpy
		mov	[esp+0F8h+Source], 5Dh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0F8h+Dest], eax ; Str
		call	strchr
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_6588960E
		mov	eax, [ebp+var_38]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_6588960E
		mov	eax, [ebp+var_38]
		lea	edx, [eax+2]
		lea	eax, [ebp+var_BE]
		mov	[esp+0F8h+Source], eax
		mov	[esp+0F8h+Dest], edx
		call	sub_6588907E
		test	eax, eax
		jnz	short loc_65889629

loc_6588960E:				; CODE XREF: assuan_socket_connect+2E6j
					; assuan_socket_connect+2F3j
		mov	[esp+0F8h+Source], 2Eh
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		mov	[ebp+var_1C], eax
		jmp	loc_6588970B
; ---------------------------------------------------------------------------

loc_65889629:				; CODE XREF: assuan_socket_connect+30Fj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0
		mov	[esp+0F8h+Source], 8005h
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		mov	[ebp+var_1C], eax
		jmp	loc_6588970B
; ---------------------------------------------------------------------------

loc_6588964A:				; CODE XREF: assuan_socket_connect+2B1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0F8h+Source], eax ; Source
		mov	eax, [ebp+Str]
		mov	[esp+0F8h+Dest], eax ; Dest
		call	strcpy
		mov	[esp+0F8h+Source], 3Ah ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0F8h+Dest], eax ; Str
		call	strchr
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_65889694
		mov	eax, [ebp+var_38]
		lea	edx, [eax+1]
		lea	eax, [ebp+var_BE]
		mov	[esp+0F8h+Source], eax
		mov	[esp+0F8h+Dest], edx
		call	sub_6588907E
		test	eax, eax
		jnz	short loc_658896AC

loc_65889694:				; CODE XREF: assuan_socket_connect+379j
		mov	[esp+0F8h+Source], 2Eh
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		mov	[ebp+var_1C], eax
		jmp	short loc_6588970B
; ---------------------------------------------------------------------------

loc_658896AC:				; CODE XREF: assuan_socket_connect+395j
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_BC]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_BC], ax
		movzx	eax, [ebp+var_BE]
		movzx	eax, ax
		mov	[esp+0F8h+Dest], eax ; hostshort
		mov	eax, ds:htons
		call	eax ; htons
		sub	esp, 4
		mov	[ebp+var_BA], ax
		lea	eax, [ebp+var_BC]
		mov	[ebp+var_20], eax
		mov	[ebp+var_24], 10h

loc_6588970B:				; CODE XREF: assuan_socket_connect+327j
					; assuan_socket_connect+348j ...
		cmp	[ebp+var_1C], 0
		jnz	short loc_65889748
		mov	eax, [ebp+Str]
		mov	[esp+0F8h+Dest], eax ; cp
		mov	eax, ds:inet_addr
		call	eax ; inet_addr
		sub	esp, 4
		mov	[ebp+var_B8], eax
		mov	eax, [ebp+var_B8]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_65889748
		mov	[esp+0F8h+Source], 2Eh
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		mov	[ebp+var_1C], eax

loc_65889748:				; CODE XREF: assuan_socket_connect+412j
					; assuan_socket_connect+433j
		mov	eax, [ebp+Str]
		mov	[esp+0F8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65882313
		cmp	[ebp+var_1C], 0
		jz	short loc_65889768
		mov	eax, [ebp+var_1C]
		jmp	loc_658898C3
; ---------------------------------------------------------------------------

loc_65889768:				; CODE XREF: assuan_socket_connect+24Bj
					; assuan_socket_connect+461j
		mov	[esp+0F8h+var_EC], 0
		mov	[esp+0F8h+Count], 1
		mov	eax, [ebp+var_30]
		mov	[esp+0F8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_6588A6FC
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0FFFFFFFFh
		jnz	short loc_658897F9
		call	gpg_err_code_from_syserror
		mov	[esp+0F8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		mov	[ebp+var_1C], eax
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+0F8h+Dest], eax ; int
		call	strerror
		mov	[esp+0F8h+var_E0], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+var_E4], eax
		mov	[esp+0F8h+var_E8], offset aCtx_6 ; "ctx"
		mov	[esp+0F8h+var_EC], offset aAssuan_socket_ ; "assuan_socket_connect"
		mov	[esp+0F8h+Count], offset aSSPCallCanTCre ; "%s (%s=%p):	call: can't create socket: "...
		mov	[esp+0F8h+Source], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65882E28
		mov	eax, [ebp+var_1C]
		jmp	loc_658898C3
; ---------------------------------------------------------------------------

loc_658897F9:				; CODE XREF: assuan_socket_connect+494j
		mov	eax, [ebp+var_24]
		mov	[esp+0F8h+var_EC], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0F8h+Count], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+0F8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_6588B232
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_65889893
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+0F8h+Dest], eax ; int
		call	strerror
		mov	[esp+0F8h+var_DC], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0F8h+var_E0], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+var_E4], eax
		mov	[esp+0F8h+var_E8], offset aCtx_6 ; "ctx"
		mov	[esp+0F8h+var_EC], offset aAssuan_socket_ ; "assuan_socket_connect"
		mov	[esp+0F8h+Count], offset aSSPCallCanTC_3 ; "%s (%s=%p):	call: can't connect to `%s'"...
		mov	[esp+0F8h+Source], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65882E28
		mov	eax, [ebp+var_3C]
		mov	[esp+0F8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65882627
		mov	[esp+0F8h+Source], 103h
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889055
		jmp	short loc_658898C3
; ---------------------------------------------------------------------------

loc_65889893:				; CODE XREF: assuan_socket_connect+51Fj
		mov	eax, [ebp+arg_C]
		mov	[esp+0F8h+Count], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+0F8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65889107
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_658898C0
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_65881959

loc_658898C0:				; CODE XREF: assuan_socket_connect+5B6j
		mov	eax, [ebp+var_1C]

loc_658898C3:				; CODE XREF: assuan_socket_connect+A4j
					; assuan_socket_connect+178j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
assuan_socket_connect endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658898CC	proc near		; CODE XREF: sub_658898F3+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_658898EC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_658898F1
; ---------------------------------------------------------------------------

loc_658898EC:				; CODE XREF: sub_658898CC+7j
		mov	eax, 0

loc_658898F1:				; CODE XREF: sub_658898CC+1Ej
		pop	ebp
		retn
sub_658898CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658898F3	proc near		; CODE XREF: sub_658899EF+14p
					; sub_65889A0A+14p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		cmp	[ebp+arg_0], 0
		jz	short loc_65889906
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_6588990B
; ---------------------------------------------------------------------------

loc_65889906:				; CODE XREF: sub_658898F3+Aj
		mov	eax, 0Fh

loc_6588990B:				; CODE XREF: sub_658898F3+11j
		mov	edx, [ebp+arg_4]
		mov	[esp+8+var_4], edx
		mov	[esp+8+var_8], eax
		call	sub_658898CC
		leave
		retn
sub_658898F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_6588991C(int,	char *,	int)
sub_6588991C	proc near		; DATA XREF: sub_65889A87+6o

s		= dword	ptr -38h
buf		= dword	ptr -34h
len		= dword	ptr -30h
flags		= dword	ptr -2Ch
from		= dword	ptr -28h
fromlen		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1ACh]
		mov	[esp+38h+fromlen], 0 ; fromlen
		mov	[esp+38h+from],	0 ; from
		mov	[esp+38h+flags], 0 ; flags
		mov	[esp+38h+len], edx ; len
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+buf], edx ; buf
		mov	[esp+38h+s], eax ; s
		mov	eax, ds:recvfrom
		call	eax ; recvfrom
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_6588997E
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+38h+s], eax
		call	sub_6588A3F2
		mov	[esp+38h+s], eax
		call	gpg_err_set_errno

loc_6588997E:				; CODE XREF: sub_6588991C+49j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_6588991C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_65889983(int,	char *,	int)
sub_65889983	proc near		; DATA XREF: sub_65889A87+13o

s		= dword	ptr -38h
buf		= dword	ptr -34h
len		= dword	ptr -30h
flags		= dword	ptr -2Ch
to		= dword	ptr -28h
tolen		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		lea	ecx, [eax+0E28h]
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		mov	[esp+38h+tolen], 10h ; tolen
		mov	[esp+38h+to], ecx ; to
		mov	[esp+38h+flags], 0 ; flags
		mov	[esp+38h+len], edx ; len
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+buf], edx ; buf
		mov	[esp+38h+s], eax ; s
		mov	eax, ds:sendto
		call	eax ; sendto
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_658899EA
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+38h+s], eax
		call	sub_6588A3F2
		mov	[esp+38h+s], eax
		call	gpg_err_set_errno

loc_658899EA:				; CODE XREF: sub_65889983+4Ej
		mov	eax, [ebp+var_C]
		leave
		retn
sub_65889983	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_658899EF	proc near		; DATA XREF: sub_65889A87+20o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[esp+8+var_4], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_658898F3
		leave
		retn
sub_658899EF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65889A0A	proc near		; DATA XREF: sub_65889A87+2Do

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[esp+8+var_4], 45h
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_8], eax
		call	sub_658898F3
		leave
		retn
sub_65889A0A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65889A25	proc near		; CODE XREF: sub_65885592+57p
					; sub_65889A74+Cp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_65889A57
; ---------------------------------------------------------------------------

loc_65889A34:				; CODE XREF: sub_65889A25+3Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		add	edx, 3A4h
		mov	eax, [eax+edx*4+8]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882627
		add	[ebp+var_C], 1

loc_65889A57:				; CODE XREF: sub_65889A25+Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0EACh]
		cmp	eax, [ebp+var_C]
		jg	short loc_65889A34
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EACh], 0
		leave
		retn
sub_65889A25	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65889A74	proc near		; CODE XREF: sub_65883440+F9p
					; sub_65883D60+F9p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65889A25
		leave
		retn
sub_65889A74	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65889A87	proc near		; CODE XREF: assuan_init_pipe_server+283p
					; assuan_init_socket_server+250p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+168h], offset sub_6588991C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+16Ch], offset sub_65889983
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+170h], offset sub_658899EF
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+174h], offset sub_65889A0A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0EACh], 0
		pop	ebp
		retn
sub_65889A87	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65889AD0	proc near		; CODE XREF: assuan_set_log_cb+16p
					; assuan_set_assuan_log_stream+Ep

VarName		= dword	ptr -28h
Str		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+VarName], offset aAssuan_full_lo ; "ASSUAN_FULL_LOGGING"
		call	getenv
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	ds:dword_65892070, eax
		mov	[esp+28h+VarName], offset aAssuan_debug	; "ASSUAN_DEBUG"
		call	getenv
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_65889B16
		mov	eax, [ebp+Str]
		mov	[esp+28h+VarName], eax ; Str
		call	atoi
		mov	ds:dword_65892074, eax
		jmp	short loc_65889B20
; ---------------------------------------------------------------------------

loc_65889B16:				; CODE XREF: sub_65889AD0+32j
		mov	ds:dword_65892074, 80h

loc_65889B20:				; CODE XREF: sub_65889AD0+44j
		call	sub_658833E4
		leave
		retn
sub_65889AD0	endp

; Exported entry  46. assuan_set_assuan_log_stream

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_assuan_log_stream
assuan_set_assuan_log_stream proc near	; CODE XREF: assuan_set_log_stream+45p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	ds:dword_65892078, eax
		call	sub_65889AD0
		leave
		retn
assuan_set_assuan_log_stream endp

; Exported entry  53. assuan_set_log_stream

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_set_log_stream
assuan_set_log_stream proc near

File		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_65889B86
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+178h]
		test	eax, eax
		jz	short loc_65889B66
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+178h]
		mov	[esp+18h+File],	eax ; File
		call	fflush

loc_65889B66:				; CODE XREF: assuan_set_log_stream+17j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+178h], edx
		mov	eax, ds:dword_65892078
		test	eax, eax
		jnz	short locret_65889B86
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+File],	eax
		call	assuan_set_assuan_log_stream

locret_65889B86:			; CODE XREF: assuan_set_log_stream+Aj
					; assuan_set_log_stream+3Dj
		leave
		retn
assuan_set_log_stream endp

; Exported entry  45. assuan_set_assuan_log_prefix

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_set_assuan_log_prefix(char	*)
		public assuan_set_assuan_log_prefix
assuan_set_assuan_log_prefix proc near

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_65889BB8
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset Dest ; Dest
		call	strncpy
		mov	ds:byte_6589206F, 0
		jmp	short locret_65889BBF
; ---------------------------------------------------------------------------

loc_65889BB8:				; CODE XREF: assuan_set_assuan_log_prefix+Aj
		mov	ds:Dest, 0

locret_65889BBF:			; CODE XREF: assuan_set_assuan_log_prefix+2Ej
		leave
		retn
assuan_set_assuan_log_prefix endp

; Exported entry   9. assuan_get_assuan_log_prefix

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_get_assuan_log_prefix
assuan_get_assuan_log_prefix proc near	; CODE XREF: sub_65889BCB:loc_65889C56p
		push	ebp
		mov	ebp, esp
		mov	eax, offset Dest
		pop	ebp
		retn
assuan_get_assuan_log_prefix endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_65889BCB(int,	int, int, char *Str)
sub_65889BCB	proc near		; DATA XREF: .data:off_6588F010o

File		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
Str		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		cmp	[ebp+Str], 0
		jnz	short loc_65889C01
		mov	edx, ds:dword_65892074
		mov	eax, [ebp+arg_8]
		sub	eax, 1
		mov	ebx, edx
		mov	ecx, eax
		sar	ebx, cl
		mov	eax, ebx
		and	eax, 1
		jmp	loc_65889CF7
; ---------------------------------------------------------------------------

loc_65889C01:				; CODE XREF: sub_65889BCB+18j
		mov	edx, ds:dword_65892074
		mov	eax, [ebp+arg_8]
		sub	eax, 1
		mov	ebx, edx
		mov	ecx, eax
		sar	ebx, cl
		mov	eax, ebx
		and	eax, 1
		test	eax, eax
		jnz	short loc_65889C26
		mov	eax, 0
		jmp	loc_65889CF7
; ---------------------------------------------------------------------------

loc_65889C26:				; CODE XREF: sub_65889BCB+4Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+178h]
		test	eax, eax
		jz	short loc_65889C3E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+178h]
		jmp	short loc_65889C43
; ---------------------------------------------------------------------------

loc_65889C3E:				; CODE XREF: sub_65889BCB+66j
		mov	eax, ds:dword_65892078

loc_65889C43:				; CODE XREF: sub_65889BCB+71j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_65889C56
		mov	eax, 0
		jmp	loc_65889CF7
; ---------------------------------------------------------------------------

loc_65889C56:				; CODE XREF: sub_65889BCB+7Fj
		call	assuan_get_assuan_log_prefix
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_65889C8E
		call	_getpid
		mov	edx, eax
		mov	eax, offset aSU	; "%s[%u]: "
		mov	[esp+38h+var_2C], edx
		mov	edx, [ebp+var_14]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; File
		call	fprintf

loc_65889C8E:				; CODE XREF: sub_65889BCB+9Bj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Format], eax ;	File
		mov	eax, [ebp+Str]
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	[ebp+Str], 0
		jz	short loc_65889CE7
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_65889CE7
		mov	eax, [ebp+Str]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_65889CE7
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; File
		call	fflush

loc_65889CE7:				; CODE XREF: sub_65889BCB+D9j
					; sub_65889BCB+E3j ...
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_err_set_errno
		mov	eax, 0

loc_65889CF7:				; CODE XREF: sub_65889BCB+31j
					; sub_65889BCB+56j ...
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_65889BCB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_65889CFE	proc near		; CODE XREF: sub_6588412E+1D3p
					; sub_6588412E+2A9p ...

C		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= byte ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_4C		= dword	ptr -4Ch
Memory		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		cmp	[ebp+arg_0], 0
		jz	loc_6588A28A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+110h]
		test	eax, eax
		jz	loc_6588A28A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 10h
		test	al, al
		jnz	loc_6588A28A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+110h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+114h]
		mov	dword ptr [esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 8
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+C], eax
		call	edx
		test	eax, eax
		jz	loc_6588A28A
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_34], eax
		cmp	[ebp+arg_C], 0
		jnz	short loc_65889D9F
		cmp	[ebp+arg_14], 0
		jz	short loc_65889D9F
		mov	eax, [ebp+arg_14]
		mov	[ebp+arg_C], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+arg_10], eax
		mov	[ebp+arg_14], 0
		mov	[ebp+arg_18], 0

loc_65889D9F:				; CODE XREF: sub_65889CFE+7Fj
					; sub_65889CFE+85j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+11Ch]
		and	eax, 2
		test	al, al
		jz	short loc_65889DC3
		cmp	[ebp+arg_8], 0
		jnz	short loc_65889DC3
		cmp	[ebp+arg_C], 0
		jz	short loc_65889DC3
		mov	[ebp+arg_8], offset aConfidentialDa ; "[Confidential data not shown]"

loc_65889DC3:				; CODE XREF: sub_65889CFE+B0j
					; sub_65889CFE+B6j ...
		cmp	[ebp+arg_8], 0
		jz	short loc_65889E0F
		cmp	[ebp+arg_4], 0
		jz	short loc_65889DD6
		mov	eax, offset asc_65891404 ; "->"
		jmp	short loc_65889DDB
; ---------------------------------------------------------------------------

loc_65889DD6:				; CODE XREF: sub_65889CFE+CFj
		mov	eax, offset asc_65891407 ; "<-"

loc_65889DDB:				; CODE XREF: sub_65889CFE+D6j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+1ACh]
		mov	edx, offset aChan_PSS ;	"chan_%p %s [%s]\n"
		mov	ebx, [ebp+arg_8]
		mov	[esp+78h+var_68], ebx
		mov	dword ptr [esp+78h+var_6C], eax
		mov	[esp+78h+var_70], ecx
		mov	[esp+78h+var_74], edx
		lea	eax, [ebp+Memory]
		mov	[esp+78h+C], eax
		call	gpgrt_asprintf
		mov	[ebp+var_1C], eax
		jmp	loc_6588A208
; ---------------------------------------------------------------------------

loc_65889E0F:				; CODE XREF: sub_65889CFE+C9j
		cmp	[ebp+arg_C], 0
		jz	loc_6588A1FA
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_20], eax
		jmp	short loc_65889E7B
; ---------------------------------------------------------------------------

loc_65889E27:				; CODE XREF: sub_65889CFE+181j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_65889E69
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+78h+C], eax ; C
		mov	eax, ds:iscntrl
		call	eax ; iscntrl
		test	eax, eax
		jnz	short loc_65889E69
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+78h+C], eax ; C
		mov	eax, ds:isprint
		call	eax ; isprint
		test	eax, eax
		jz	short loc_65889E69
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_65889E73

loc_65889E69:				; CODE XREF: sub_65889CFE+131j
					; sub_65889CFE+148j ...
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_65889E83

loc_65889E73:				; CODE XREF: sub_65889CFE+169j
		sub	[ebp+var_24], 1
		add	[ebp+var_20], 1

loc_65889E7B:				; CODE XREF: sub_65889CFE+127j
		cmp	[ebp+var_24], 0
		jnz	short loc_65889E27
		jmp	short loc_65889E84
; ---------------------------------------------------------------------------

loc_65889E83:				; CODE XREF: sub_65889CFE+173j
		nop

loc_65889E84:				; CODE XREF: sub_65889CFE+183j
		cmp	[ebp+var_24], 0
		jnz	short loc_65889EFB
		cmp	[ebp+arg_14], 0
		jz	short loc_65889EFB
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		jmp	short loc_65889EF2
; ---------------------------------------------------------------------------

loc_65889E9E:				; CODE XREF: sub_65889CFE+1F8j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_65889EE0
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+78h+C], eax ; C
		mov	eax, ds:iscntrl
		call	eax ; iscntrl
		test	eax, eax
		jnz	short loc_65889EE0
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+78h+C], eax ; C
		mov	eax, ds:isprint
		call	eax ; isprint
		test	eax, eax
		jz	short loc_65889EE0
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_65889EEA

loc_65889EE0:				; CODE XREF: sub_65889CFE+1A8j
					; sub_65889CFE+1BFj ...
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_65889EFA

loc_65889EEA:				; CODE XREF: sub_65889CFE+1E0j
		sub	[ebp+var_24], 1
		add	[ebp+var_20], 1

loc_65889EF2:				; CODE XREF: sub_65889CFE+19Ej
		cmp	[ebp+var_24], 0
		jnz	short loc_65889E9E
		jmp	short loc_65889EFB
; ---------------------------------------------------------------------------

loc_65889EFA:				; CODE XREF: sub_65889CFE+1EAj
		nop

loc_65889EFB:				; CODE XREF: sub_65889CFE+18Aj
					; sub_65889CFE+190j ...
		cmp	[ebp+arg_14], 0
		jnz	short loc_65889F08
		mov	[ebp+arg_18], 0

loc_65889F08:				; CODE XREF: sub_65889CFE+201j
		cmp	[ebp+var_24], 0
		jnz	short loc_65889F86
		cmp	[ebp+arg_10], 0
		jz	short loc_65889F86
		mov	eax, [ebp+arg_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jz	short loc_65889F86
		cmp	[ebp+arg_14], 0
		jz	short loc_65889F29
		mov	edx, [ebp+arg_14]
		jmp	short loc_65889F2E
; ---------------------------------------------------------------------------

loc_65889F29:				; CODE XREF: sub_65889CFE+224j
		mov	edx, offset byte_6589141B

loc_65889F2E:				; CODE XREF: sub_65889CFE+229j
		mov	edi, [ebp+arg_18]
		mov	esi, [ebp+arg_10]
		cmp	[ebp+arg_4], 0
		jz	short loc_65889F41
		mov	eax, offset asc_65891404 ; "->"
		jmp	short loc_65889F46
; ---------------------------------------------------------------------------

loc_65889F41:				; CODE XREF: sub_65889CFE+23Aj
		mov	eax, offset asc_65891407 ; "<-"

loc_65889F46:				; CODE XREF: sub_65889CFE+241j
		mov	ecx, [ebp+arg_0]
		mov	ebx, [ecx+1ACh]
		mov	ecx, offset aChan_PS_S_S ; "chan_%p %s %.*s%.*s\n"
		mov	[esp+78h+var_5C], edx
		mov	[esp+78h+var_60], edi
		mov	edx, [ebp+arg_C]
		mov	[esp+78h+var_64], edx
		mov	[esp+78h+var_68], esi
		mov	dword ptr [esp+78h+var_6C], eax
		mov	[esp+78h+var_70], ebx
		mov	[esp+78h+var_74], ecx
		lea	eax, [ebp+Memory]
		mov	[esp+78h+C], eax
		call	gpgrt_asprintf
		mov	[ebp+var_1C], eax
		jmp	loc_6588A208
; ---------------------------------------------------------------------------

loc_65889F86:				; CODE XREF: sub_65889CFE+20Ej
					; sub_65889CFE+214j ...
		mov	eax, ds:dword_65892070
		test	eax, eax
		jz	short loc_65889F96
		mov	eax, 7D4h
		jmp	short loc_65889F9B
; ---------------------------------------------------------------------------

loc_65889F96:				; CODE XREF: sub_65889CFE+28Fj
		mov	eax, 10h

loc_65889F9B:				; CODE XREF: sub_65889CFE+296j
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_18]
		mov	edx, [ebp+arg_10]
		add	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		cmp	eax, [ebp+var_38]
		jbe	short loc_65889FB7
		mov	eax, [ebp+var_38]
		mov	[ebp+var_30], eax

loc_65889FB7:				; CODE XREF: sub_65889CFE+2B1j
		mov	edx, [ebp+var_30]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		add	eax, 72h
		mov	[esp+78h+C], eax ; Size
		call	malloc
		mov	[ebp+Memory], eax
		mov	eax, [ebp+Memory]
		test	eax, eax
		jnz	short loc_65889FE1
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	loc_6588A208
; ---------------------------------------------------------------------------

loc_65889FE1:				; CODE XREF: sub_65889CFE+2D5j
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+Memory]
		mov	[ebp+var_2C], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_65889FFB
		mov	eax, offset asc_65891404 ; "->"
		jmp	short loc_6588A000
; ---------------------------------------------------------------------------

loc_65889FFB:				; CODE XREF: sub_65889CFE+2F4j
		mov	eax, offset asc_65891407 ; "<-"

loc_6588A000:				; CODE XREF: sub_65889CFE+2FBj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+1ACh]
		mov	edx, offset aChan_PS ; "chan_%p	%s ["
		mov	[esp+78h+var_68], eax
		mov	dword ptr [esp+78h+var_6C], ecx	; char
		mov	[esp+78h+var_70], edx ;	char *
		mov	[esp+78h+var_74], 32h ;	size_t
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+C], eax ; char	*
		call	sub_6588E410
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_2C], eax
		mov	[ebp+var_24], 0
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_20], eax
		mov	[ebp+var_28], 0
		jmp	short loc_6588A0DF
; ---------------------------------------------------------------------------

loc_6588A065:				; CODE XREF: sub_65889CFE+3EFj
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	20h
		add	[ebp+var_2C], 1
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		cmp	al, 9
		ja	short loc_6588A08A
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_6588A096
; ---------------------------------------------------------------------------

loc_6588A08A:				; CODE XREF: sub_65889CFE+37Cj
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_6588A096:				; CODE XREF: sub_65889CFE+38Aj
		mov	edx, [ebp+var_2C]
		mov	[edx], al
		add	[ebp+var_2C], 1
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_6588A0BE
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_6588A0CA
; ---------------------------------------------------------------------------

loc_6588A0BE:				; CODE XREF: sub_65889CFE+3B0j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_6588A0CA:				; CODE XREF: sub_65889CFE+3BEj
		mov	edx, [ebp+var_2C]
		mov	[edx], al
		add	[ebp+var_2C], 1
		add	[ebp+var_20], 1
		add	[ebp+var_28], 1
		add	[ebp+var_24], 1

loc_6588A0DF:				; CODE XREF: sub_65889CFE+365j
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+arg_10]
		jnb	short loc_6588A0F3
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_30]
		jb	loc_6588A065

loc_6588A0F3:				; CODE XREF: sub_65889CFE+3E7j
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	[ebp+var_28], 0
		jmp	short loc_6588A17C
; ---------------------------------------------------------------------------

loc_6588A102:				; CODE XREF: sub_65889CFE+48Cj
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	20h
		add	[ebp+var_2C], 1
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		cmp	al, 9
		ja	short loc_6588A127
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_6588A133
; ---------------------------------------------------------------------------

loc_6588A127:				; CODE XREF: sub_65889CFE+419j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_6588A133:				; CODE XREF: sub_65889CFE+427j
		mov	edx, [ebp+var_2C]
		mov	[edx], al
		add	[ebp+var_2C], 1
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_6588A15B
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_6588A167
; ---------------------------------------------------------------------------

loc_6588A15B:				; CODE XREF: sub_65889CFE+44Dj
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_6588A167:				; CODE XREF: sub_65889CFE+45Bj
		mov	edx, [ebp+var_2C]
		mov	[edx], al
		add	[ebp+var_2C], 1
		add	[ebp+var_20], 1
		add	[ebp+var_28], 1
		add	[ebp+var_24], 1

loc_6588A17C:				; CODE XREF: sub_65889CFE+402j
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+arg_18]
		jnb	short loc_6588A190
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_30]
		jb	loc_6588A102

loc_6588A190:				; CODE XREF: sub_65889CFE+484j
		mov	eax, [ebp+arg_18]
		mov	edx, [ebp+arg_10]
		add	eax, edx
		cmp	eax, [ebp+var_30]
		jbe	short loc_6588A1EC
		mov	eax, [ebp+arg_18]
		mov	edx, [ebp+arg_10]
		add	eax, edx
		mov	edx, eax
		sub	edx, [ebp+var_30]
		mov	eax, offset a___UByteSSkipp ; "	...(%u byte(s) skipped)"
		mov	dword ptr [esp+78h+var_6C], edx	; char
		mov	[esp+78h+var_70], eax ;	char *
		mov	[esp+78h+var_74], 3Ch ;	size_t
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+C], eax ; char	*
		call	sub_6588E410
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_2C], eax

loc_6588A1EC:				; CODE XREF: sub_65889CFE+49Dj
		mov	edx, offset asc_65891457 ; " ]\n"
		mov	eax, [ebp+var_2C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_6588A208
; ---------------------------------------------------------------------------

loc_6588A1FA:				; CODE XREF: sub_65889CFE+115j
		mov	[ebp+var_1C], 0
		mov	[ebp+Memory], 0

loc_6588A208:				; CODE XREF: sub_65889CFE+10Cj
					; sub_65889CFE+283j ...
		cmp	[ebp+var_1C], 0
		jns	short loc_6588A23E
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+110h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+114h]
		mov	dword ptr [esp+78h+var_6C], offset aLibassuanFaile ; "[libassuan failed	to format the log mes"...
		mov	[esp+78h+var_70], 8
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+C], eax
		call	edx
		jmp	short loc_6588A27D
; ---------------------------------------------------------------------------

loc_6588A23E:				; CODE XREF: sub_65889CFE+50Ej
		mov	eax, [ebp+Memory]
		test	eax, eax
		jz	short loc_6588A27D
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+110h]
		mov	edx, [ebp+Memory]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+114h]
		mov	dword ptr [esp+78h+var_6C], edx
		mov	[esp+78h+var_70], 8
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+C], eax
		call	ecx
		mov	eax, [ebp+Memory]
		mov	[esp+78h+C], eax ; Memory
		call	free

loc_6588A27D:				; CODE XREF: sub_65889CFE+53Ej
					; sub_65889CFE+545j
		mov	eax, [ebp+var_34]
		mov	[esp+78h+C], eax
		call	gpg_err_set_errno
		jmp	short loc_6588A28B
; ---------------------------------------------------------------------------

loc_6588A28A:				; CODE XREF: sub_65889CFE+Dj
					; sub_65889CFE+1Ej ...
		nop

loc_6588A28B:				; CODE XREF: sub_65889CFE+58Aj
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_65889CFE	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588A294	proc near		; CODE XREF: sub_6588A888+36p
					; sub_6588B571+17Ap ...

lpCriticalSection= dword ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[esp+28h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:EnterCriticalSection
		call	eax ; EnterCriticalSection
		sub	esp, 4
		mov	[ebp+var_10], 0
		jmp	short loc_6588A2D7
; ---------------------------------------------------------------------------

loc_6588A2BB:				; CODE XREF: sub_6588A294+49j
		mov	eax, [ebp+var_10]
		mov	eax, ds:dword_658920A0[eax*4]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_6588A2D3
		mov	[ebp+var_C], 1
		jmp	short loc_6588A2DF
; ---------------------------------------------------------------------------

loc_6588A2D3:				; CODE XREF: sub_6588A294+34j
		add	[ebp+var_10], 1

loc_6588A2D7:				; CODE XREF: sub_6588A294+25j
		mov	eax, [ebp+var_10]
		cmp	eax, 0Fh
		jbe	short loc_6588A2BB

loc_6588A2DF:				; CODE XREF: sub_6588A294+3Dj
		mov	[esp+28h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:LeaveCriticalSection
		call	eax ; LeaveCriticalSection
		sub	esp, 4
		mov	eax, [ebp+var_C]
		leave
		retn
sub_6588A294	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588A2F5	proc near		; CODE XREF: sub_6588A73D+4Cp

lpCriticalSection= dword ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[esp+28h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:EnterCriticalSection
		call	eax ; EnterCriticalSection
		sub	esp, 4
		mov	[ebp+var_14], 0
		jmp	short loc_6588A34B
; ---------------------------------------------------------------------------

loc_6588A323:				; CODE XREF: sub_6588A2F5+5Cj
		mov	eax, [ebp+var_14]
		mov	eax, ds:dword_658920A0[eax*4]
		cmp	eax, [ebp+arg_0]
		jz	short loc_6588A37D
		mov	eax, [ebp+var_14]
		mov	eax, ds:dword_658920A0[eax*4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_6588A347
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_6588A347:				; CODE XREF: sub_6588A2F5+4Aj
		add	[ebp+var_14], 1

loc_6588A34B:				; CODE XREF: sub_6588A2F5+2Cj
		mov	eax, [ebp+var_14]
		cmp	eax, 0Fh
		jbe	short loc_6588A323
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_6588A36E
		mov	[esp+28h+lpCriticalSection], 18h
		call	gpg_err_set_errno
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_6588A37E
; ---------------------------------------------------------------------------

loc_6588A36E:				; CODE XREF: sub_6588A2F5+62j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	ds:dword_658920A0[eax*4], edx
		jmp	short loc_6588A37E
; ---------------------------------------------------------------------------

loc_6588A37D:				; CODE XREF: sub_6588A2F5+3Bj
		nop

loc_6588A37E:				; CODE XREF: sub_6588A2F5+77j
					; sub_6588A2F5+86j
		mov	[esp+28h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:LeaveCriticalSection
		call	eax ; LeaveCriticalSection
		sub	esp, 4
		mov	eax, [ebp+var_C]
		leave
		retn
sub_6588A2F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588A394	proc near		; CODE XREF: sub_6588A73D+3Cp
					; assuan_sock_close+12p

lpCriticalSection= dword ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:EnterCriticalSection
		call	eax ; EnterCriticalSection
		sub	esp, 4
		mov	[ebp+var_C], 0
		jmp	short loc_6588A3D7
; ---------------------------------------------------------------------------

loc_6588A3B4:				; CODE XREF: sub_6588A394+49j
		mov	eax, [ebp+var_C]
		mov	eax, ds:dword_658920A0[eax*4]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_6588A3D3
		mov	eax, [ebp+var_C]
		mov	ds:dword_658920A0[eax*4], 0FFFFFFFFh
		jmp	short loc_6588A3DF
; ---------------------------------------------------------------------------

loc_6588A3D3:				; CODE XREF: sub_6588A394+2Dj
		add	[ebp+var_C], 1

loc_6588A3D7:				; CODE XREF: sub_6588A394+1Ej
		mov	eax, [ebp+var_C]
		cmp	eax, 0Fh
		jbe	short loc_6588A3B4

loc_6588A3DF:				; CODE XREF: sub_6588A394+3Dj
		mov	[esp+28h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:LeaveCriticalSection
		call	eax ; LeaveCriticalSection
		sub	esp, 4
		leave
		retn
sub_6588A394	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588A3F2	proc near		; CODE XREF: sub_6588991C+55p
					; sub_65889983+5Ap ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 2736h
		jz	short loc_6588A424
		cmp	eax, 2736h
		jg	short loc_6588A414
		cmp	eax, 6Dh
		jz	short loc_6588A432
		cmp	eax, 2733h
		jz	short loc_6588A42B
		jmp	short loc_6588A447
; ---------------------------------------------------------------------------

loc_6588A414:				; CODE XREF: sub_6588A3F2+12j
		cmp	eax, 274Dh
		jz	short loc_6588A440
		cmp	eax, 276Dh
		jz	short loc_6588A439
		jmp	short loc_6588A447
; ---------------------------------------------------------------------------

loc_6588A424:				; CODE XREF: sub_6588A3F2+Bj
		mov	eax, 16h
		jmp	short loc_6588A44C
; ---------------------------------------------------------------------------

loc_6588A42B:				; CODE XREF: sub_6588A3F2+1Ej
		mov	eax, 0Bh
		jmp	short loc_6588A44C
; ---------------------------------------------------------------------------

loc_6588A432:				; CODE XREF: sub_6588A3F2+17j
		mov	eax, 20h
		jmp	short loc_6588A44C
; ---------------------------------------------------------------------------

loc_6588A439:				; CODE XREF: sub_6588A3F2+2Ej
		mov	eax, 28h
		jmp	short loc_6588A44C
; ---------------------------------------------------------------------------

loc_6588A440:				; CODE XREF: sub_6588A3F2+27j
		mov	eax, 6Bh
		jmp	short loc_6588A44C
; ---------------------------------------------------------------------------

loc_6588A447:				; CODE XREF: sub_6588A3F2+20j
					; sub_6588A3F2+30j
		mov	eax, 5

loc_6588A44C:				; CODE XREF: sub_6588A3F2+37j
					; sub_6588A3F2+3Ej ...
		pop	ebp
		retn
sub_6588A3F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_6588A44E(BYTE	*pbBuffer, DWORD dwLen)
sub_6588A44E	proc near		; CODE XREF: sub_6588B571+3Dp

phProv		= dword	ptr -38h
szContainer	= dword	ptr -34h
szProvider	= dword	ptr -30h
dwProvType	= dword	ptr -2Ch
dwFlags		= dword	ptr -28h
hProv		= dword	ptr -10h
var_C		= dword	ptr -0Ch
pbBuffer	= dword	ptr  8
dwLen		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	[esp+38h+dwFlags], 0F0000040h ;	dwFlags
		mov	[esp+38h+dwProvType], 1	; dwProvType
		mov	[esp+38h+szProvider], 0	; szProvider
		mov	[esp+38h+szContainer], 0 ; szContainer
		lea	eax, [ebp+hProv]
		mov	[esp+38h+phProv], eax ;	phProv
		mov	eax, ds:CryptAcquireContextA
		call	eax ; CryptAcquireContextA
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_6588A49D
		mov	[esp+38h+phProv], 13h
		call	gpg_err_set_errno
		jmp	short loc_6588A4EC
; ---------------------------------------------------------------------------

loc_6588A49D:				; CODE XREF: sub_6588A44E+3Fj
		mov	eax, [ebp+hProv]
		mov	edx, [ebp+pbBuffer]
		mov	[esp+38h+szProvider], edx ; pbBuffer
		mov	edx, [ebp+dwLen]
		mov	[esp+38h+szContainer], edx ; dwLen
		mov	[esp+38h+phProv], eax ;	hProv
		mov	eax, ds:CryptGenRandom
		call	eax ; CryptGenRandom
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_6588A4CD
		mov	[esp+38h+phProv], 13h
		call	gpg_err_set_errno
		jmp	short loc_6588A4D4
; ---------------------------------------------------------------------------

loc_6588A4CD:				; CODE XREF: sub_6588A44E+6Fj
		mov	[ebp+var_C], 0

loc_6588A4D4:				; CODE XREF: sub_6588A44E+7Dj
		mov	eax, [ebp+hProv]
		mov	[esp+38h+szContainer], 0 ; dwFlags
		mov	[esp+38h+phProv], eax ;	hProv
		mov	eax, ds:CryptReleaseContext
		call	eax ; CryptReleaseContext
		sub	esp, 8

loc_6588A4EC:				; CODE XREF: sub_6588A44E+4Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_6588A44E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_6588A4F1(char	*, int,	int, int)
sub_6588A4F1	proc near		; CODE XREF: sub_6588B232+46p
					; sub_6588B9D5+4Ep

Filename	= dword	ptr -88h
Mode		= dword	ptr -84h
Count		= dword	ptr -80h
File		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_60		= byte ptr -60h
var_50		= dword	ptr -50h
DstBuf		= byte ptr -4Ah
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		add	esp, 0FFFFFF80h
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, offset Mode ; "rb"
		mov	[esp+88h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_6588A529
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588A6F5
; ---------------------------------------------------------------------------

loc_6588A529:				; CODE XREF: sub_6588A4F1+2Cj
		lea	eax, [ebp+DstBuf]
		mov	edx, [ebp+var_14]
		mov	[esp+88h+File],	edx ; File
		mov	[esp+88h+Count], 31h ; Count
		mov	[esp+88h+Mode],	1 ; ElementSize
		mov	[esp+88h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_14]
		mov	[esp+88h+Filename], eax	; File
		call	fclose
		cmp	[ebp+var_10], 0
		jnz	short loc_6588A575
		mov	[esp+88h+Filename], 2
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588A6F5
; ---------------------------------------------------------------------------

loc_6588A575:				; CODE XREF: sub_6588A4F1+6Cj
		lea	eax, [ebp+DstBuf]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+DstBuf]
		mov	edx, eax
		mov	eax, offset aSocket ; "!<socket	>"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_6588A64E
		mov	eax, offset aUS08x08x08x08x ; "%u s %08x-%08x-%08x-%08x"
		lea	edx, [ebp+DstBuf]
		lea	ecx, [edx+0Ah]
		lea	edx, [ebp+var_60]
		add	edx, 0Ch
		mov	[esp+88h+var_70], edx
		lea	edx, [ebp+var_60]
		add	edx, 8
		mov	[esp+88h+var_74], edx
		lea	edx, [ebp+var_60]
		add	edx, 4
		mov	[esp+88h+var_78], edx
		lea	edx, [ebp+var_60]
		mov	[esp+88h+File],	edx
		lea	edx, [ebp+var_50]
		mov	[esp+88h+Count], edx
		mov	[esp+88h+Mode],	eax ; Format
		mov	[esp+88h+Filename], ecx	; Src
		call	sscanf
		cmp	eax, 5
		jnz	short loc_6588A603
		mov	eax, [ebp+var_50]
		test	eax, eax
		jz	short loc_6588A603
		mov	eax, [ebp+var_50]
		cmp	eax, 0FFFFh
		jbe	short loc_6588A619

loc_6588A603:				; CODE XREF: sub_6588A4F1+FFj
					; sub_6588A4F1+106j
		mov	[esp+88h+Filename], 16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588A6F5
; ---------------------------------------------------------------------------

loc_6588A619:				; CODE XREF: sub_6588A4F1+110j
		mov	eax, [ebp+var_50]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], dx
		mov	eax, [ebp+arg_8]
		lea	edx, [ebp+var_60]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 1
		jmp	loc_6588A6F0
; ---------------------------------------------------------------------------

loc_6588A64E:				; CODE XREF: sub_6588A4F1+B3j
		lea	eax, [ebp+DstBuf]
		mov	[esp+88h+Filename], eax	; Str
		call	atoi
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jle	short loc_6588A66B
		cmp	[ebp+var_18], 0FFFFh
		jle	short loc_6588A67E

loc_6588A66B:				; CODE XREF: sub_6588A4F1+16Fj
		mov	[esp+88h+Filename], 16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588A6F5
; ---------------------------------------------------------------------------

loc_6588A67E:				; CODE XREF: sub_6588A4F1+178j
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], dx
		lea	eax, [ebp+DstBuf]
		mov	[ebp+var_C], eax
		jmp	short loc_6588A699
; ---------------------------------------------------------------------------

loc_6588A691:				; CODE XREF: sub_6588A4F1+1B6j
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_6588A699:				; CODE XREF: sub_6588A4F1+19Ej
		cmp	[ebp+var_10], 0
		jz	short loc_6588A6A9
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_6588A691

loc_6588A6A9:				; CODE XREF: sub_6588A4F1+1ACj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_6588A6B9
		cmp	[ebp+var_10], 11h
		jz	short loc_6588A6CC

loc_6588A6B9:				; CODE XREF: sub_6588A4F1+1C0j
		mov	[esp+88h+Filename], 16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588A6F5
; ---------------------------------------------------------------------------

loc_6588A6CC:				; CODE XREF: sub_6588A4F1+1C6j
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx

loc_6588A6F0:				; CODE XREF: sub_6588A4F1+158j
		mov	eax, 0

loc_6588A6F5:				; CODE XREF: sub_6588A4F1+33j
					; sub_6588A4F1+7Fj ...
		sub	esp, 0FFFFFF80h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_6588A4F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588A6FC	proc near		; CODE XREF: assuan_socket_connect+488p
					; sub_6588B454+8Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 1
		jz	short loc_6588A70E
		cmp	[ebp+arg_4], 1
		jnz	short loc_6588A715

loc_6588A70E:				; CODE XREF: sub_6588A6FC+Aj
		mov	[ebp+arg_4], 2

loc_6588A715:				; CODE XREF: sub_6588A6FC+10j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882BEA
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_6588A6FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588A73D	proc near		; CODE XREF: assuan_sock_set_flag+23p

var_18		= dword	ptr -18h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aCygwin ; "cygwin"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_6588A7A0
		cmp	[ebp+arg_C], 0
		jnz	short loc_6588A783
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	sub_6588A394
		jmp	loc_6588A87C
; ---------------------------------------------------------------------------

loc_6588A783:				; CODE XREF: sub_6588A73D+34j
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	sub_6588A2F5
		test	eax, eax
		jz	loc_6588A87C
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588A881
; ---------------------------------------------------------------------------

loc_6588A7A0:				; CODE XREF: sub_6588A73D+2Ej
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aTorMode ; "tor-mode"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_6588A7F0
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aSocks ; "socks"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_6588A868

loc_6588A7F0:				; CODE XREF: sub_6588A73D+89j
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_6588A841
		movzx	eax, ds:word_65892084
		test	ax, ax
		jz	short loc_6588A81B
		cmp	[ebp+arg_C], 0
		jnz	short loc_6588A81B
		mov	[esp+18h+var_18], 1
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588A881
; ---------------------------------------------------------------------------

loc_6588A81B:				; CODE XREF: sub_6588A73D+C3j
					; sub_6588A73D+C9j
		cmp	[ebp+arg_C], 0
		jz	short loc_6588A87B
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 73h
		jnz	short loc_6588A836
		mov	ds:word_65892084, 438h
		jmp	short loc_6588A87B
; ---------------------------------------------------------------------------

loc_6588A836:				; CODE XREF: sub_6588A73D+ECj
		mov	ds:word_65892084, 235Ah
		jmp	short loc_6588A87B
; ---------------------------------------------------------------------------

loc_6588A841:				; CODE XREF: sub_6588A73D+B7j
		movzx	eax, ds:word_65892084
		test	ax, ax
		jz	short loc_6588A853
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_6588A866

loc_6588A853:				; CODE XREF: sub_6588A73D+10Ej
		mov	[esp+18h+var_18], 16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588A881
; ---------------------------------------------------------------------------

loc_6588A866:				; CODE XREF: sub_6588A73D+114j
		jmp	short loc_6588A87B
; ---------------------------------------------------------------------------

loc_6588A868:				; CODE XREF: sub_6588A73D+B1j
		mov	[esp+18h+var_18], 16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588A881
; ---------------------------------------------------------------------------

loc_6588A87B:				; CODE XREF: sub_6588A73D+E2j
					; sub_6588A73D+F7j ...
		nop

loc_6588A87C:				; CODE XREF: sub_6588A73D+41j
					; sub_6588A73D+53j
		mov	eax, 0

loc_6588A881:				; CODE XREF: sub_6588A73D+5Ej
					; sub_6588A73D+DCj ...
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_6588A73D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588A888	proc near		; CODE XREF: assuan_sock_get_flag+23p

var_18		= dword	ptr -18h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aCygwin ; "cygwin"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_6588A8CD
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	sub_6588A294
		mov	edx, [ebp+arg_C]
		mov	[edx], eax
		jmp	loc_6588A960
; ---------------------------------------------------------------------------

loc_6588A8CD:				; CODE XREF: sub_6588A888+2Ej
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aTorMode ; "tor-mode"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_6588A90D
		movzx	eax, ds:word_65892084
		cmp	ax, 235Ah
		setz	al
		movzx	edx, al
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		jmp	short loc_6588A960
; ---------------------------------------------------------------------------

loc_6588A90D:				; CODE XREF: sub_6588A888+6Bj
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aSocks ; "socks"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_6588A94D
		movzx	eax, ds:word_65892084
		cmp	ax, 438h
		setz	al
		movzx	edx, al
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		jmp	short loc_6588A960
; ---------------------------------------------------------------------------

loc_6588A94D:				; CODE XREF: sub_6588A888+ABj
		mov	[esp+18h+var_18], 16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588A965
; ---------------------------------------------------------------------------

loc_6588A960:				; CODE XREF: sub_6588A888+40j
					; sub_6588A888+83j ...
		mov	eax, 0

loc_6588A965:				; CODE XREF: sub_6588A888+D6j
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_6588A888	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588A96C	proc near		; CODE XREF: sub_6588AA7E+1FAp
					; sub_6588AA7E+3D8p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	loc_6588AA0F
; ---------------------------------------------------------------------------

loc_6588A97D:				; CODE XREF: sub_6588A96C+A7j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_658826D9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_6588A9B4
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_6588AA0F

loc_6588A9B4:				; CODE XREF: sub_6588A96C+38j
		cmp	[ebp+var_10], 0
		jns	short loc_6588A9DD
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 0Bh
		jnz	short loc_6588A9DD
		mov	[esp+28h+var_24], 186A0h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_6588245A
		jmp	short loc_6588AA0F
; ---------------------------------------------------------------------------

loc_6588A9DD:				; CODE XREF: sub_6588A96C+4Cj
					; sub_6588A96C+5Aj
		cmp	[ebp+var_10], 0
		jns	short loc_6588A9EA
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588AA1E
; ---------------------------------------------------------------------------

loc_6588A9EA:				; CODE XREF: sub_6588A96C+75j
		cmp	[ebp+var_10], 0
		jnz	short loc_6588AA03
		mov	[esp+28h+var_28], 5
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588AA1E
; ---------------------------------------------------------------------------

loc_6588AA03:				; CODE XREF: sub_6588A96C+82j
		mov	eax, [ebp+var_10]
		add	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		sub	[ebp+arg_C], eax

loc_6588AA0F:				; CODE XREF: sub_6588A96C+Cj
					; sub_6588A96C+46j ...
		cmp	[ebp+arg_C], 0
		jnz	loc_6588A97D
		mov	eax, 0

locret_6588AA1E:			; CODE XREF: sub_6588A96C+7Cj
					; sub_6588A96C+95j
		leave
		retn
sub_6588A96C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588AA20	proc near		; CODE XREF: sub_6588AA7E+1C5p
					; sub_6588AA7E+37Ep ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_65882707
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_6588AA6C
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_C]
		jz	short loc_6588AA6C
		mov	[esp+28h+var_28], 5
		call	gpg_err_set_errno
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_6588AA79
; ---------------------------------------------------------------------------

loc_6588AA6C:				; CODE XREF: sub_6588AA20+2Dj
					; sub_6588AA20+35j
		cmp	[ebp+var_C], 0
		js	short loc_6588AA79
		mov	[ebp+var_C], 0

loc_6588AA79:				; CODE XREF: sub_6588AA20+4Aj
					; sub_6588AA20+50j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_6588AA20	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_6588AA7E(int,	int, int, char *Str, void *, int, int)
sub_6588AA7E	proc near		; CODE XREF: sub_6588B232+1F9p
					; sub_6588B454+E6p

hostshort	= word ptr -288h
Val		= dword	ptr -284h
Size		= dword	ptr -280h
var_27C		= dword	ptr -27Ch
var_274		= dword	ptr -274h
var_270		= word ptr -270h
var_26C		= word ptr -26Ch
var_262		= byte ptr -262h
var_261		= byte ptr -261h
var_260		= byte ptr -260h
var_25F		= byte ptr -25Fh
var_4C		= word ptr -4Ch
var_4A		= word ptr -4Ah
var_48		= dword	ptr -48h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
Src		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
Str		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 284h
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_26C], dx
		mov	[ebp+var_270], ax
		lea	eax, [ebp+var_4C]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		cmp	[ebp+arg_10], 0
		jz	short loc_6588AADC
		cmp	[ebp+arg_18], 0
		jz	short loc_6588AADC
		mov	dword ptr [esp+288h+hostshort],	16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AADC:				; CODE XREF: sub_6588AA7E+40j
					; sub_6588AA7E+46j
		cmp	[ebp+arg_10], 0
		jz	short loc_6588AB09
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_274], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_274]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		jmp	short loc_6588AB0E
; ---------------------------------------------------------------------------

loc_6588AB09:				; CODE XREF: sub_6588AA7E+62j
		mov	eax, 0

loc_6588AB0E:				; CODE XREF: sub_6588AA7E+89j
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFh
		jbe	short loc_6588AB30
		mov	dword ptr [esp+288h+hostshort],	26h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AB30:				; CODE XREF: sub_6588AA7E+9Aj
		mov	[ebp+var_4C], 2
		movzx	eax, [ebp+var_26C]
		mov	dword ptr [esp+288h+hostshort],	eax ; hostshort
		mov	eax, ds:htons
		call	eax ; htons
		sub	esp, 4
		mov	[ebp+var_4A], ax
		mov	dword ptr [esp+288h+hostshort],	7F000001h ; hostlong
		mov	eax, ds:htonl
		call	eax ; htonl
		sub	esp, 4
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_4C]
		mov	[ebp+var_24], eax
		mov	[ebp+var_28], 10h
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_4]
		mov	[esp+288h+var_27C], edx
		mov	edx, [ebp+var_24]
		mov	[esp+288h+Size], edx
		mov	[esp+288h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+288h+hostshort],	eax
		call	sub_65882D08
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588ABE9
		cmp	[ebp+var_26C], 235Ah
		jnz	short loc_6588ABE9
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 6Bh
		jnz	short loc_6588ABE9
		mov	dword ptr [esp+288h+hostshort],	23BEh ;	hostshort
		mov	eax, ds:htons
		call	eax ; htons
		sub	esp, 4
		mov	[ebp+var_4A], ax
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_4]
		mov	[esp+288h+var_27C], edx
		mov	edx, [ebp+var_24]
		mov	[esp+288h+Size], edx
		mov	[esp+288h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+288h+hostshort],	eax
		call	sub_65882D08
		mov	[ebp+var_C], eax

loc_6588ABE9:				; CODE XREF: sub_6588AA7E+118j
					; sub_6588AA7E+123j ...
		cmp	[ebp+var_C], 0
		jz	short loc_6588ABF7
		mov	eax, [ebp+var_C]
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588ABF7:				; CODE XREF: sub_6588AA7E+16Fj
		mov	[ebp+var_262], 5
		mov	[ebp+var_261], 1
		cmp	[ebp+Str], 0
		jz	short loc_6588AC14
		mov	[ebp+var_14], 2
		jmp	short loc_6588AC1B
; ---------------------------------------------------------------------------

loc_6588AC14:				; CODE XREF: sub_6588AA7E+18Bj
		mov	[ebp+var_14], 0

loc_6588AC1B:				; CODE XREF: sub_6588AA7E+194j
		mov	eax, [ebp+var_14]
		mov	[ebp+var_260], al
		mov	[esp+288h+var_27C], 3
		lea	eax, [ebp+var_262]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+288h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+288h+hostshort],	eax
		call	sub_6588AA20
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588AC59
		mov	eax, [ebp+var_C]
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AC59:				; CODE XREF: sub_6588AA7E+1D1j
		mov	[esp+288h+var_27C], 2
		lea	eax, [ebp+var_262]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+288h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+288h+hostshort],	eax
		call	sub_6588A96C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588AC8E
		mov	eax, [ebp+var_C]
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AC8E:				; CODE XREF: sub_6588AA7E+206j
		movzx	eax, [ebp+var_262]
		cmp	al, 5
		jnz	short loc_6588ACA8
		movzx	eax, [ebp+var_261]
		movzx	eax, al
		cmp	eax, [ebp+var_14]
		jz	short loc_6588ACBE

loc_6588ACA8:				; CODE XREF: sub_6588AA7E+219j
		mov	dword ptr [esp+288h+hostshort],	81h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588ACBE:				; CODE XREF: sub_6588AA7E+228j
		cmp	[ebp+Str], 0
		jz	loc_6588AEAE
		mov	[esp+288h+Val],	3Ah ; Val
		mov	eax, [ebp+Str]
		mov	dword ptr [esp+288h+hostshort],	eax ; Str
		call	strchr
		mov	[ebp+Src], eax
		cmp	[ebp+Src], 0
		jnz	short loc_6588ACFA
		mov	dword ptr [esp+288h+hostshort],	16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588ACFA:				; CODE XREF: sub_6588AA7E+264j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+Str]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_30], eax
		add	[ebp+Src], 1
		mov	eax, [ebp+Src]
		mov	[ebp+var_274], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_274]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_34], eax
		cmp	[ebp+var_30], 0
		jz	short loc_6588AD53
		cmp	[ebp+var_30], 0FFh
		jg	short loc_6588AD53
		cmp	[ebp+var_34], 0
		jz	short loc_6588AD53
		cmp	[ebp+var_34], 0FFh
		jle	short loc_6588AD69

loc_6588AD53:				; CODE XREF: sub_6588AA7E+2BBj
					; sub_6588AA7E+2C4j ...
		mov	dword ptr [esp+288h+hostshort],	16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AD69:				; CODE XREF: sub_6588AA7E+2D3j
		mov	[ebp+var_262], 1
		mov	eax, [ebp+var_30]
		mov	[ebp+var_261], al
		mov	[ebp+var_10], 2
		mov	ecx, [ebp+var_30]
		mov	edx, [ebp+Str]
		lea	eax, [ebp+var_262]
		add	eax, [ebp+var_10]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Val],	edx ; Src
		mov	dword ptr [esp+288h+hostshort],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_30]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_34]
		mov	edx, eax
		lea	eax, [ebp+var_262]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	ecx, [ebp+var_34]
		mov	edx, [ebp+Src]
		lea	eax, [ebp+var_262]
		add	eax, [ebp+var_10]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Val],	edx ; Src
		mov	dword ptr [esp+288h+hostshort],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_34]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+288h+var_27C], eax
		lea	eax, [ebp+var_262]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+288h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+288h+hostshort],	eax
		call	sub_6588AA20
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_262]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], eax
		jmp	short loc_6588AE23
; ---------------------------------------------------------------------------

loc_6588AE15:				; CODE XREF: sub_6588AA7E+3A9j
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		add	[ebp+var_18], 1
		sub	[ebp+var_1C], 1

loc_6588AE23:				; CODE XREF: sub_6588AA7E+395j
		cmp	[ebp+var_1C], 0
		jnz	short loc_6588AE15
		cmp	[ebp+var_C], 0
		jz	short loc_6588AE37
		mov	eax, [ebp+var_C]
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AE37:				; CODE XREF: sub_6588AA7E+3AFj
		mov	[esp+288h+var_27C], 2
		lea	eax, [ebp+var_262]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+288h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+288h+hostshort],	eax
		call	sub_6588A96C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588AE6C
		mov	eax, [ebp+var_C]
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AE6C:				; CODE XREF: sub_6588AA7E+3E4j
		movzx	eax, [ebp+var_262]
		cmp	al, 1
		jz	short loc_6588AE8D
		mov	dword ptr [esp+288h+hostshort],	86h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AE8D:				; CODE XREF: sub_6588AA7E+3F7j
		movzx	eax, [ebp+var_261]
		test	al, al
		jz	short loc_6588AEAE
		mov	dword ptr [esp+288h+hostshort],	0Dh
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AEAE:				; CODE XREF: sub_6588AA7E+244j
					; sub_6588AA7E+418j
		cmp	[ebp+arg_10], 0
		jz	short loc_6588AED2
		mov	eax, [ebp+arg_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_6588AED2
		cmp	[ebp+var_270], 0
		jnz	short loc_6588AED2
		mov	eax, 0
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588AED2:				; CODE XREF: sub_6588AA7E+434j
					; sub_6588AA7E+43Ej ...
		mov	[ebp+var_262], 5
		mov	[ebp+var_261], 1
		mov	[ebp+var_260], 0
		cmp	[ebp+arg_10], 0
		jz	loc_6588AF71
		mov	[ebp+var_25F], 3
		mov	[ebp+var_10], 4
		mov	eax, [ebp+var_20]
		mov	edx, eax
		lea	eax, [ebp+var_262]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	edx, [ebp+arg_10]
		lea	eax, [ebp+var_262]
		add	eax, [ebp+var_10]
		mov	ecx, [ebp+var_20]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Val],	edx ; Src
		mov	dword ptr [esp+288h+hostshort],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_20]
		add	[ebp+var_10], eax
		movzx	eax, [ebp+var_270]
		shr	ax, 8
		mov	edx, eax
		lea	eax, [ebp+var_262]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		movzx	eax, [ebp+var_270]
		mov	edx, eax
		lea	eax, [ebp+var_262]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_6588B009
; ---------------------------------------------------------------------------

loc_6588AF71:				; CODE XREF: sub_6588AA7E+46Dj
		mov	eax, [ebp+arg_18]
		movzx	eax, word ptr [eax]
		cmp	ax, 17h
		jnz	short loc_6588AFCD
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_38], eax
		mov	[ebp+var_25F], 4
		mov	eax, [ebp+var_38]
		add	eax, 8
		lea	edx, [ebp+var_262]
		add	edx, 4
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		mov	ecx, [eax+8]
		mov	[edx+8], ecx
		mov	eax, [eax+0Ch]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_38]
		add	eax, 2
		lea	edx, [ebp+var_262]
		add	edx, 14h
		movzx	eax, word ptr [eax]
		mov	[edx], ax
		mov	[ebp+var_10], 16h
		jmp	short loc_6588B009
; ---------------------------------------------------------------------------

loc_6588AFCD:				; CODE XREF: sub_6588AA7E+4FDj
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_3C], eax
		mov	[ebp+var_25F], 1
		mov	eax, [ebp+var_3C]
		add	eax, 4
		lea	edx, [ebp+var_262]
		add	edx, 4
		mov	eax, [eax]
		mov	[edx], eax
		mov	eax, [ebp+var_3C]
		add	eax, 2
		lea	edx, [ebp+var_262]
		add	edx, 8
		movzx	eax, word ptr [eax]
		mov	[edx], ax
		mov	[ebp+var_10], 0Ah

loc_6588B009:				; CODE XREF: sub_6588AA7E+4EEj
					; sub_6588AA7E+54Dj
		mov	eax, [ebp+var_10]
		mov	[esp+288h+var_27C], eax
		lea	eax, [ebp+var_262]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+288h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+288h+hostshort],	eax
		call	sub_6588AA20
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588B03D
		mov	eax, [ebp+var_C]
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588B03D:				; CODE XREF: sub_6588AA7E+5B5j
		mov	[esp+288h+var_27C], 0Ah
		lea	eax, [ebp+var_262]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+288h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+288h+hostshort],	eax
		call	sub_6588A96C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588B072
		mov	eax, [ebp+var_C]
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588B072:				; CODE XREF: sub_6588AA7E+5EAj
		movzx	eax, [ebp+var_262]
		cmp	al, 5
		jnz	short loc_6588B088
		movzx	eax, [ebp+var_260]
		test	al, al
		jz	short loc_6588B09E

loc_6588B088:				; CODE XREF: sub_6588AA7E+5FDj
		mov	dword ptr [esp+288h+hostshort],	86h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588B09E:				; CODE XREF: sub_6588AA7E+608j
		movzx	eax, [ebp+var_261]
		test	al, al
		jz	loc_6588B13A
		movzx	eax, [ebp+var_261]
		movzx	eax, al
		cmp	eax, 8		; switch 9 cases
		ja	short loc_6588B127 ; jumptable 6588B0C3	default	case
		mov	eax, ds:off_658914CC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_6588B0C5:				; CODE XREF: sub_6588AA7E+645j
					; DATA XREF: .rdata:off_658914CCo
		mov	dword ptr [esp+288h+hostshort],	74h ; jumptable	6588B0C3 case 1
		call	gpg_err_set_errno
		jmp	short loc_6588B133
; ---------------------------------------------------------------------------

loc_6588B0D3:				; CODE XREF: sub_6588AA7E+645j
					; DATA XREF: .rdata:off_658914CCo
		mov	dword ptr [esp+288h+hostshort],	0Dh ; jumptable	6588B0C3 case 2
		call	gpg_err_set_errno
		jmp	short loc_6588B133
; ---------------------------------------------------------------------------

loc_6588B0E1:				; CODE XREF: sub_6588AA7E+645j
					; DATA XREF: .rdata:off_658914CCo
		mov	dword ptr [esp+288h+hostshort],	76h ; jumptable	6588B0C3 case 3
		call	gpg_err_set_errno
		jmp	short loc_6588B133
; ---------------------------------------------------------------------------

loc_6588B0EF:				; CODE XREF: sub_6588AA7E+645j
					; DATA XREF: .rdata:off_658914CCo
		mov	dword ptr [esp+288h+hostshort],	6Eh ; jumptable	6588B0C3 case 4
		call	gpg_err_set_errno
		jmp	short loc_6588B133
; ---------------------------------------------------------------------------

loc_6588B0FD:				; CODE XREF: sub_6588AA7E+645j
					; DATA XREF: .rdata:off_658914CCo
		mov	dword ptr [esp+288h+hostshort],	6Bh ; jumptable	6588B0C3 case 5
		call	gpg_err_set_errno
		jmp	short loc_6588B133
; ---------------------------------------------------------------------------

loc_6588B10B:				; CODE XREF: sub_6588AA7E+645j
					; DATA XREF: .rdata:off_658914CCo
		mov	dword ptr [esp+288h+hostshort],	8Ah ; jumptable	6588B0C3 case 6
		call	gpg_err_set_errno
		jmp	short loc_6588B133
; ---------------------------------------------------------------------------

loc_6588B119:				; CODE XREF: sub_6588AA7E+645j
					; DATA XREF: .rdata:off_658914CCo
		mov	dword ptr [esp+288h+hostshort],	87h ; jumptable	6588B0C3 case 8
		call	gpg_err_set_errno
		jmp	short loc_6588B133
; ---------------------------------------------------------------------------

loc_6588B127:				; CODE XREF: sub_6588AA7E+63Cj
					; sub_6588AA7E+645j
					; DATA XREF: ...
		mov	dword ptr [esp+288h+hostshort],	81h ; jumptable	6588B0C3 default case
		call	gpg_err_set_errno

loc_6588B133:				; CODE XREF: sub_6588AA7E+653j
					; sub_6588AA7E+661j ...
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588B13A:				; CODE XREF: sub_6588AA7E+629j
		movzx	eax, [ebp+var_25F]
		cmp	al, 4
		jnz	short loc_6588B17A
		mov	[esp+288h+var_27C], 0Ch
		lea	eax, [ebp+var_262]
		add	eax, 0Ah
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+288h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+288h+hostshort],	eax
		call	sub_6588A96C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588B17A
		mov	eax, [ebp+var_C]
		jmp	short loc_6588B17F
; ---------------------------------------------------------------------------

loc_6588B17A:				; CODE XREF: sub_6588AA7E+6C5j
					; sub_6588AA7E+6F5j
		mov	eax, 0

loc_6588B17F:				; CODE XREF: sub_6588AA7E+59j
					; sub_6588AA7E+ADj ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_6588AA7E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588B184	proc near		; CODE XREF: sub_6588B232+1AFp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		movzx	eax, ds:word_65892084
		test	ax, ax
		jnz	short loc_6588B1A0
		mov	eax, 0
		jmp	locret_6588B230
; ---------------------------------------------------------------------------

loc_6588B1A0:				; CODE XREF: sub_6588B184+10j
		mov	eax, [ebp+arg_0]
		movzx	eax, word ptr [eax]
		cmp	ax, 17h
		jnz	short loc_6588B1FE
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		add	eax, 0Fh
		movzx	eax, byte ptr [eax]
		cmp	al, 1
		jz	short loc_6588B1CF
		mov	eax, 1
		jmp	short locret_6588B230
; ---------------------------------------------------------------------------

loc_6588B1CF:				; CODE XREF: sub_6588B184+42j
		mov	[ebp+var_8], 0
		jmp	short loc_6588B1F1
; ---------------------------------------------------------------------------

loc_6588B1D8:				; CODE XREF: sub_6588B184+71j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_6588B1E9
		mov	eax, 1
		jmp	short locret_6588B230
; ---------------------------------------------------------------------------

loc_6588B1E9:				; CODE XREF: sub_6588B184+5Cj
		add	[ebp+var_8], 1
		add	[ebp+var_4], 1

loc_6588B1F1:				; CODE XREF: sub_6588B184+52j
		cmp	[ebp+var_8], 0Eh
		jle	short loc_6588B1D8
		mov	eax, 0
		jmp	short locret_6588B230
; ---------------------------------------------------------------------------

loc_6588B1FE:				; CODE XREF: sub_6588B184+26j
		mov	eax, [ebp+arg_0]
		movzx	eax, word ptr [eax]
		cmp	ax, 2
		jnz	short loc_6588B22B
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jnz	short loc_6588B224
		mov	eax, 0
		jmp	short locret_6588B230
; ---------------------------------------------------------------------------

loc_6588B224:				; CODE XREF: sub_6588B184+97j
		mov	eax, 1
		jmp	short locret_6588B230
; ---------------------------------------------------------------------------

loc_6588B22B:				; CODE XREF: sub_6588B184+84j
		mov	eax, 0

locret_6588B230:			; CODE XREF: sub_6588B184+17j
					; sub_6588B184+49j ...
		leave
		retn
sub_6588B184	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588B232	proc near		; CODE XREF: assuan_socket_connect+517p
					; assuan_sock_connect+23p

hostshort	= word ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
Str		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_38		= dword	ptr -38h
var_32		= dword	ptr -32h
var_22		= dword	ptr -22h
var_1E		= word ptr -1Eh
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	eax, [ebp+arg_8]
		movzx	eax, word ptr [eax]
		cmp	ax, 1
		jz	short loc_6588B254
		mov	eax, [ebp+arg_8]
		movzx	eax, word ptr [eax]
		cmp	ax, 1
		jnz	loc_6588B3DB

loc_6588B254:				; CODE XREF: sub_6588B232+10j
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		lea	edx, [eax+8]
		lea	eax, [ebp+var_38]
		mov	[esp+78h+Str], eax ; int
		lea	eax, [ebp+var_32]
		mov	[esp+78h+var_70], eax ;	int
		lea	eax, [ebp+var_22]
		mov	[esp+78h+var_74], eax ;	int
		mov	dword ptr [esp+78h+hostshort], edx ; char *
		call	sub_6588A4F1
		test	eax, eax
		jz	short loc_6588B28B
		mov	eax, 0FFFFFFFFh
		jmp	locret_6588B452
; ---------------------------------------------------------------------------

loc_6588B28B:				; CODE XREF: sub_6588B232+4Dj
		mov	word ptr [ebp+var_22+2], 2
		movzx	eax, word ptr [ebp+var_22]
		movzx	eax, ax
		mov	dword ptr [esp+78h+hostshort], eax ; hostshort
		mov	eax, ds:htons
		call	eax ; htons
		sub	esp, 4
		mov	[ebp+var_1E], ax
		mov	dword ptr [esp+78h+hostshort], 7F000001h ; hostlong
		mov	eax, ds:htonl
		call	eax ; htonl
		sub	esp, 4
		mov	[ebp+var_1C], eax
		movzx	edx, word ptr [ebp+var_22+2]
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		movzx	edx, [ebp+var_1E]
		mov	eax, [ebp+var_10]
		mov	[eax+2], dx
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+Str], 10h
		lea	edx, [ebp+var_22+2]
		mov	[esp+78h+var_70], edx
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+78h+hostshort], eax
		call	sub_65882D08
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_6588B3D6
		mov	[esp+78h+Str], 10h
		lea	eax, [ebp+var_32]
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+78h+hostshort], eax
		call	sub_6588AA20
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_6588B3D6
		mov	eax, [ebp+var_38]
		test	eax, eax
		jz	loc_6588B3D6
		mov	[esp+78h+Str], 10h
		lea	eax, [ebp+var_48]
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+78h+hostshort], eax
		call	sub_6588A96C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_6588B3D6
		call	_getpid
		mov	[ebp+var_4C], eax
		lea	eax, [ebp+var_4C]
		mov	eax, [eax]
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_48]
		add	eax, 4
		mov	dword ptr [eax], 0
		mov	[esp+78h+Str], 8
		lea	eax, [ebp+var_48]
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+78h+hostshort], eax
		call	sub_6588AA20
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_6588B3D6
		mov	[esp+78h+Str], 8
		lea	eax, [ebp+var_48]
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+78h+hostshort], eax
		call	sub_6588A96C
		mov	[ebp+var_C], eax

loc_6588B3D6:				; CODE XREF: sub_6588B232+D1j
					; sub_6588B232+FFj ...
		mov	eax, [ebp+var_C]
		jmp	short locret_6588B452
; ---------------------------------------------------------------------------

loc_6588B3DB:				; CODE XREF: sub_6588B232+1Cj
		mov	eax, [ebp+arg_8]
		mov	dword ptr [esp+78h+hostshort], eax
		call	sub_6588B184
		test	eax, eax
		jz	short loc_6588B432
		movzx	eax, ds:word_65892084
		movzx	eax, ax
		mov	edx, [ebp+arg_C]
		mov	[esp+78h+var_5C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+78h+var_60], edx ;	int
		mov	[esp+78h+var_64], 0 ; int
		mov	[esp+78h+var_68], 0 ; void *
		mov	[esp+78h+Str], 0 ; Str
		mov	[esp+78h+var_70], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_74], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+78h+hostshort], eax ; int
		call	sub_6588AA7E
		jmp	short locret_6588B452
; ---------------------------------------------------------------------------

loc_6588B432:				; CODE XREF: sub_6588B232+1B6j
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_C]
		mov	[esp+78h+Str], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+78h+var_70], edx
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+78h+hostshort], eax
		call	sub_65882D08

locret_6588B452:			; CODE XREF: sub_6588B232+54j
					; sub_6588B232+1A7j ...
		leave
		retn
sub_6588B232	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_6588B454(int,	void *,	int, int, char *, int)
sub_6588B454	proc near		; CODE XREF: assuan_sock_connect_byname+39p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= word ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_A		= word ptr -0Ah
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], ax
		mov	eax, [ebp+arg_14]
		and	eax, 2
		test	eax, eax
		jz	short loc_6588B473
		mov	[ebp+var_A], 235Ah
		jmp	short loc_6588B49B
; ---------------------------------------------------------------------------

loc_6588B473:				; CODE XREF: sub_6588B454+15j
		mov	eax, [ebp+arg_14]
		and	eax, 1
		test	al, al
		jz	short loc_6588B485
		mov	[ebp+var_A], 438h
		jmp	short loc_6588B49B
; ---------------------------------------------------------------------------

loc_6588B485:				; CODE XREF: sub_6588B454+27j
		mov	[esp+48h+var_48], 81h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	locret_6588B56F
; ---------------------------------------------------------------------------

loc_6588B49B:				; CODE XREF: sub_6588B454+1Dj
					; sub_6588B454+2Fj
		cmp	[ebp+arg_4], 0
		jz	short loc_6588B4C1
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_6588B4C1
		mov	[esp+48h+var_48], 16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	locret_6588B56F
; ---------------------------------------------------------------------------

loc_6588B4C1:				; CODE XREF: sub_6588B454+4Bj
					; sub_6588B454+55j
		mov	[esp+48h+Str], 0
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+var_44], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_6588A6FC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_6588B4F2
		mov	eax, [ebp+var_10]
		jmp	short locret_6588B56F
; ---------------------------------------------------------------------------

loc_6588B4F2:				; CODE XREF: sub_6588B454+97j
		movzx	ecx, [ebp+var_1C]
		cmp	[ebp+arg_4], 0
		jz	short loc_6588B501
		mov	eax, [ebp+arg_4]
		jmp	short loc_6588B506
; ---------------------------------------------------------------------------

loc_6588B501:				; CODE XREF: sub_6588B454+A6j
		mov	eax, offset dword_658914F0

loc_6588B506:				; CODE XREF: sub_6588B454+ABj
		movzx	edx, [ebp+var_A]
		mov	[esp+48h+var_2C], 0
		mov	[esp+48h+var_30], 0 ; int
		mov	[esp+48h+var_34], ecx ;	int
		mov	[esp+48h+var_38], eax ;	void *
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+Str], eax ; Str
		mov	[esp+48h+var_40], edx ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_44], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_6588AA7E
		test	eax, eax
		jz	short loc_6588B56C
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	assuan_sock_close
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588B56F
; ---------------------------------------------------------------------------

loc_6588B56C:				; CODE XREF: sub_6588B454+EDj
		mov	eax, [ebp+var_10]

locret_6588B56F:			; CODE XREF: sub_6588B454+42j
					; sub_6588B454+68j ...
		leave
		retn
sub_6588B454	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_6588B571(int,	SOCKET s, struct sockaddr *, int)
sub_6588B571	proc near		; CODE XREF: assuan_sock_bind+23p

hostlong	= dword	ptr -0C8h
dwDesiredAccess	= dword	ptr -0C4h
dwShareMode	= dword	ptr -0C0h
lpSecurityAttributes= dword ptr	-0BCh
dwCreationDisposition= dword ptr -0B8h
dwFlagsAndAttributes= dword ptr	-0B4h
hTemplateFile	= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
Buffer		= byte ptr -96h
NumberOfBytesWritten= dword ptr	-54h
pbBuffer	= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
namelen		= dword	ptr -40h
name		= sockaddr ptr -3Ch
var_2C		= dword	ptr -2Ch
hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
s		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0BCh
		mov	eax, [ebp+arg_8]
		movzx	eax, word ptr [eax]
		cmp	ax, 1
		jz	short loc_6588B599
		mov	eax, [ebp+arg_8]
		movzx	eax, word ptr [eax]
		cmp	ax, 1
		jnz	loc_6588B8A0

loc_6588B599:				; CODE XREF: sub_6588B571+16j
		mov	[ebp+namelen], 10h
		mov	[esp+0C8h+dwDesiredAccess], 10h	; dwLen
		lea	eax, [ebp+pbBuffer]
		mov	[esp+0C8h+hostlong], eax ; pbBuffer
		call	sub_6588A44E
		test	eax, eax
		jz	short loc_6588B5C1
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B8E1
; ---------------------------------------------------------------------------

loc_6588B5C1:				; CODE XREF: sub_6588B571+44j
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_24], eax
		mov	word ptr [ebp+name.sa_data], 0
		mov	[ebp+name.sa_family], 2
		mov	[esp+0C8h+hostlong], 7F000001h ; hostlong
		mov	eax, ds:htonl
		call	eax ; htonl
		sub	esp, 4
		mov	dword ptr [ebp+name.sa_data+2],	eax
		mov	eax, [ebp+var_24]
		add	eax, 8
		mov	[esp+0C8h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+0C8h+dwFlagsAndAttributes], 80h ; dwFlagsAndAttributes
		mov	[esp+0C8h+dwCreationDisposition], 1 ; dwCreationDisposition
		mov	[esp+0C8h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+0C8h+dwShareMode],	1 ; dwShareMode
		mov	[esp+0C8h+dwDesiredAccess], 40000000h ;	dwDesiredAccess
		mov	[esp+0C8h+hostlong], eax ; lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jnz	short loc_6588B655
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		cmp	eax, 50h
		jnz	short loc_6588B64B
		mov	[esp+0C8h+hostlong], 2740h
		call	gpg_err_set_errno

loc_6588B64B:				; CODE XREF: sub_6588B571+CCj
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B8E1
; ---------------------------------------------------------------------------

loc_6588B655:				; CODE XREF: sub_6588B571+C0j
		mov	edx, [ebp+namelen]
		mov	eax, [ebp+s]
		mov	[esp+0C8h+dwShareMode],	edx ; namelen
		lea	edx, [ebp+name]
		mov	[esp+0C8h+dwDesiredAccess], edx	; name
		mov	[esp+0C8h+hostlong], eax ; s
		mov	eax, ds:bind
		call	eax ; bind
		sub	esp, 0Ch
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_6588B69D
		mov	eax, [ebp+s]
		lea	edx, [ebp+namelen]
		mov	[esp+0C8h+dwShareMode],	edx ; namelen
		lea	edx, [ebp+name]
		mov	[esp+0C8h+dwDesiredAccess], edx	; name
		mov	[esp+0C8h+hostlong], eax ; s
		mov	eax, ds:getsockname
		call	eax ; getsockname
		sub	esp, 0Ch
		mov	[ebp+var_1C], eax

loc_6588B69D:				; CODE XREF: sub_6588B571+109j
		cmp	[ebp+var_1C], 0
		jz	short loc_6588B6E5
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+hObject]
		mov	[esp+0C8h+hostlong], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_24]
		add	eax, 8
		mov	[esp+0C8h+hostlong], eax ; lpFileName
		mov	eax, ds:DeleteFileA
		call	eax ; DeleteFileA
		sub	esp, 4
		mov	eax, [ebp+var_2C]
		mov	[esp+0C8h+hostlong], eax
		call	gpg_err_set_errno
		mov	eax, [ebp+var_1C]
		jmp	loc_6588B8E1
; ---------------------------------------------------------------------------

loc_6588B6E5:				; CODE XREF: sub_6588B571+130j
		mov	eax, [ebp+s]
		mov	[esp+0C8h+hostlong], eax
		call	sub_6588A294
		test	eax, eax
		jz	loc_6588B78D
		mov	edi, [ebp+var_44]
		mov	[ebp+var_9C], edi
		mov	edi, [ebp+var_48]
		mov	esi, [ebp+var_4C]
		mov	ebx, dword ptr [ebp+pbBuffer]
		movzx	eax, word ptr [ebp+name.sa_data]
		movzx	eax, ax
		mov	[esp+0C8h+hostlong], eax ; netshort
		mov	eax, ds:ntohs
		call	eax ; ntohs
		sub	esp, 4
		movzx	edx, ax
		mov	eax, offset aSocketDS08x08x ; "!<socket	>%d s %08x-%08x-%08x-%08x"
		mov	ecx, [ebp+var_9C]
		mov	[esp+0C8h+var_AC], ecx
		mov	[esp+0C8h+hTemplateFile], edi
		mov	[esp+0C8h+dwFlagsAndAttributes], esi
		mov	[esp+0C8h+dwCreationDisposition], ebx
		mov	[esp+0C8h+lpSecurityAttributes], edx ; char
		mov	[esp+0C8h+dwShareMode],	eax ; char *
		mov	[esp+0C8h+dwDesiredAccess], 42h	; size_t
		lea	eax, [ebp+Buffer]
		mov	[esp+0C8h+hostlong], eax ; char	*
		call	sub_6588E410
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_A0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_A0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+namelen], eax
		jmp	loc_6588B81F
; ---------------------------------------------------------------------------

loc_6588B78D:				; CODE XREF: sub_6588B571+181j
		movzx	eax, word ptr [ebp+name.sa_data]
		movzx	eax, ax
		mov	[esp+0C8h+hostlong], eax ; netshort
		mov	eax, ds:ntohs
		call	eax ; ntohs
		sub	esp, 4
		movzx	edx, ax
		mov	eax, offset aD	; "%d\n"
		mov	[esp+0C8h+lpSecurityAttributes], edx ; char
		mov	[esp+0C8h+dwShareMode],	eax ; char *
		mov	[esp+0C8h+dwDesiredAccess], 32h	; size_t
		lea	eax, [ebp+Buffer]
		mov	[esp+0C8h+hostlong], eax ; char	*
		call	sub_6588E410
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_A0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_A0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+namelen], eax
		mov	eax, [ebp+namelen]
		lea	edx, [ebp+Buffer]
		add	edx, eax
		lea	eax, [ebp+pbBuffer]
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		mov	ecx, [eax+8]
		mov	[edx+8], ecx
		mov	eax, [eax+0Ch]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+namelen]
		add	eax, 10h
		mov	[ebp+namelen], eax

loc_6588B81F:				; CODE XREF: sub_6588B571+217j
		mov	eax, [ebp+namelen]
		mov	[esp+0C8h+dwCreationDisposition], 0 ; lpOverlapped
		lea	edx, [ebp+NumberOfBytesWritten]
		mov	[esp+0C8h+lpSecurityAttributes], edx ; lpNumberOfBytesWritten
		mov	[esp+0C8h+dwShareMode],	eax ; nNumberOfBytesToWrite
		lea	eax, [ebp+Buffer]
		mov	[esp+0C8h+dwDesiredAccess], eax	; lpBuffer
		mov	eax, [ebp+hObject]
		mov	[esp+0C8h+hostlong], eax ; hFile
		mov	eax, ds:WriteFile
		call	eax ; WriteFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_6588B889
		mov	eax, [ebp+hObject]
		mov	[esp+0C8h+hostlong], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_24]
		add	eax, 8
		mov	[esp+0C8h+hostlong], eax ; lpFileName
		mov	eax, ds:DeleteFileA
		call	eax ; DeleteFileA
		sub	esp, 4
		mov	[esp+0C8h+hostlong], 5
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588B8E1
; ---------------------------------------------------------------------------

loc_6588B889:				; CODE XREF: sub_6588B571+2E0j
		mov	eax, [ebp+hObject]
		mov	[esp+0C8h+hostlong], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short loc_6588B8E1
; ---------------------------------------------------------------------------

loc_6588B8A0:				; CODE XREF: sub_6588B571+22j
		mov	eax, [ebp+s]
		mov	edx, [ebp+arg_C]
		mov	[esp+0C8h+dwShareMode],	edx ; namelen
		mov	edx, [ebp+arg_8]
		mov	[esp+0C8h+dwDesiredAccess], edx	; name
		mov	[esp+0C8h+hostlong], eax ; s
		mov	eax, ds:bind
		call	eax ; bind
		sub	esp, 0Ch
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jns	short loc_6588B8DE
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+0C8h+hostlong], eax
		call	sub_6588A3F2
		mov	[esp+0C8h+hostlong], eax
		call	gpg_err_set_errno

loc_6588B8DE:				; CODE XREF: sub_6588B571+354j
		mov	eax, [ebp+var_20]

loc_6588B8E1:				; CODE XREF: sub_6588B571+4Bj
					; sub_6588B571+DFj ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_6588B571	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_6588B8E9(char	*, int,	int)
sub_6588B8E9	proc near		; CODE XREF: assuan_sock_set_sockaddr_un+1Ap

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
Count		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_6588B906
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_6588B906:				; CODE XREF: sub_6588B8E9+12j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		cmp	eax, 65h
		jbe	short loc_6588B943
		mov	[esp+38h+Dest],	26h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588B9CE
; ---------------------------------------------------------------------------

loc_6588B943:				; CODE XREF: sub_6588B8E9+42j
		mov	eax, [ebp+var_C]
		mov	edx, eax
		mov	ebx, 70h
		mov	eax, 0
		mov	ecx, edx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_6588B963
		mov	[edx], al
		add	edx, 1
		sub	ebx, 1

loc_6588B963:				; CODE XREF: sub_6588B8E9+70j
		mov	ecx, edx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_6588B975
		mov	[edx], ax
		add	edx, 2
		sub	ebx, 2

loc_6588B975:				; CODE XREF: sub_6588B8E9+81j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, edx
		rep stosd
		mov	edx, edi
		mov	ecx, ebx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_6588B98F
		mov	[edx], ax
		add	edx, 2

loc_6588B98F:				; CODE XREF: sub_6588B8E9+9Ej
		mov	ecx, ebx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_6588B99D
		mov	[edx], al
		add	edx, 1

loc_6588B99D:				; CODE XREF: sub_6588B8E9+ADj
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	1
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	[esp+38h+Count], 65h ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strncpy
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax+6Dh], 0
		mov	eax, 0

loc_6588B9CE:				; CODE XREF: sub_6588B8E9+55j
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_6588B8E9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588B9D5	proc near		; CODE XREF: assuan_sock_get_nonce+23p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_E		= dword	ptr -0Eh
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		movzx	eax, word ptr [eax]
		cmp	ax, 1
		jz	short loc_6588B9F3
		mov	eax, [ebp+arg_4]
		movzx	eax, word ptr [eax]
		cmp	ax, 1
		jnz	short loc_6588BA33

loc_6588B9F3:				; CODE XREF: sub_6588B9D5+10j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 10h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_E+2], eax
		mov	eax, [ebp+arg_C]
		lea	ecx, [eax+4]
		mov	eax, [ebp+var_E+2]
		lea	edx, [eax+8]
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_1C], eax ;	int
		mov	[esp+28h+var_20], ecx ;	int
		lea	eax, [ebp+var_E]
		mov	[esp+28h+var_24], eax ;	int
		mov	[esp+28h+var_28], edx ;	char *
		call	sub_6588A4F1
		test	eax, eax
		jz	short loc_6588BA45
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588BA4B
; ---------------------------------------------------------------------------

loc_6588BA33:				; CODE XREF: sub_6588B9D5+1Cj
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 2Ah
		mov	eax, [ebp+arg_C]
		mov	byte ptr [eax+4], 2Ah
		jmp	short loc_6588BA46
; ---------------------------------------------------------------------------

loc_6588BA45:				; CODE XREF: sub_6588B9D5+55j
		nop

loc_6588BA46:				; CODE XREF: sub_6588B9D5+6Ej
		mov	eax, 0

locret_6588BA4B:			; CODE XREF: sub_6588B9D5+5Cj
		leave
		retn
sub_6588B9D5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588BA4D	proc near		; CODE XREF: sub_658886D1+E7p
					; assuan_sock_check_nonce+1Cp

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		cmp	eax, 2Ah
		jnz	short loc_6588BA72
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax+4]
		cmp	al, 2Ah
		jnz	short loc_6588BA72
		mov	eax, 0
		jmp	locret_6588BBA4
; ---------------------------------------------------------------------------

loc_6588BA72:				; CODE XREF: sub_6588BA4D+Ej
					; sub_6588BA4D+19j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		cmp	eax, 10h
		jz	short loc_6588BA92
		mov	[esp+38h+Buf1],	16h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	locret_6588BBA4
; ---------------------------------------------------------------------------

loc_6588BA92:				; CODE XREF: sub_6588BA4D+2Dj
		mov	[esp+38h+var_2C], 10h
		lea	eax, [ebp+var_18]
		mov	[esp+38h+Size],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Buf1],	eax
		call	sub_6588A96C
		test	eax, eax
		jz	short loc_6588BAC1
		mov	eax, 0FFFFFFFFh
		jmp	locret_6588BBA4
; ---------------------------------------------------------------------------

loc_6588BAC1:				; CODE XREF: sub_6588BA4D+68j
		mov	eax, [ebp+arg_8]
		add	eax, 4
		mov	[esp+38h+Size],	10h ; Size
		mov	[esp+38h+Buf2],	eax ; Buf2
		lea	eax, [ebp+var_18]
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_6588BAF8
		mov	[esp+38h+Buf1],	0Dh
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	locret_6588BBA4
; ---------------------------------------------------------------------------

loc_6588BAF8:				; CODE XREF: sub_6588BA4D+93j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Buf1],	eax
		call	sub_6588A294
		test	eax, eax
		jz	loc_6588BB9F
		mov	[esp+38h+var_2C], 10h
		lea	eax, [ebp+var_18]
		mov	[esp+38h+Size],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Buf1],	eax
		call	sub_6588AA20
		test	eax, eax
		jz	short loc_6588BB37
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588BBA4
; ---------------------------------------------------------------------------

loc_6588BB37:				; CODE XREF: sub_6588BA4D+E1j
		mov	[esp+38h+var_2C], 8
		lea	eax, [ebp+var_18]
		mov	[esp+38h+Size],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Buf1],	eax
		call	sub_6588A96C
		test	eax, eax
		jz	short loc_6588BB63
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588BBA4
; ---------------------------------------------------------------------------

loc_6588BB63:				; CODE XREF: sub_6588BA4D+10Dj
		call	_getpid
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	[esp+38h+var_2C], 8
		lea	eax, [ebp+var_18]
		mov	[esp+38h+Size],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Buf1],	eax
		call	sub_6588AA20
		test	eax, eax
		jz	short loc_6588BB9F
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588BBA4
; ---------------------------------------------------------------------------

loc_6588BB9F:				; CODE XREF: sub_6588BA4D+B8j
					; sub_6588BA4D+149j
		mov	eax, 0

locret_6588BBA4:			; CODE XREF: sub_6588BA4D+20j
					; sub_6588BA4D+40j ...
		leave
		retn
sub_6588BA4D	endp

; Exported entry  64. assuan_sock_init

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sock_init
assuan_sock_init proc near

lpCriticalSection= dword ptr -1B8h
lpWSAData	= dword	ptr -1B4h
WSAData		= WSAData ptr -19Ch
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 1B8h
		mov	eax, ds:dword_65892080
		test	eax, eax
		jz	short loc_6588BBBF
		mov	eax, 0
		jmp	short locret_6588BC03
; ---------------------------------------------------------------------------

loc_6588BBBF:				; CODE XREF: assuan_sock_init+10j
		mov	[esp+1B8h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:InitializeCriticalSection
		call	eax ; InitializeCriticalSection
		sub	esp, 4
		mov	[esp+1B8h+lpCriticalSection], offset dword_65892080
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_6588BC00
		lea	eax, [ebp+WSAData]
		mov	[esp+1B8h+lpWSAData], eax ; lpWSAData
		mov	[esp+1B8h+lpCriticalSection], 202h ; wVersionRequested
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8

loc_6588BC00:				; CODE XREF: assuan_sock_init+3Dj
		mov	eax, [ebp+var_C]

locret_6588BC03:			; CODE XREF: assuan_sock_init+17j
		leave
		retn
assuan_sock_init endp

; Exported entry  62. assuan_sock_deinit

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sock_deinit
assuan_sock_deinit proc	near

lpCriticalSection= dword ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_65892080
		test	eax, eax
		jz	short loc_6588BC45
		mov	eax, ds:WSACleanup
		call	eax ; WSACleanup
		mov	eax, ds:dword_65892080
		mov	[esp+18h+lpCriticalSection], eax
		call	assuan_release
		mov	ds:dword_65892080, 0
		mov	[esp+18h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:DeleteCriticalSection
		call	eax ; DeleteCriticalSection
		sub	esp, 4
		jmp	short locret_6588BC46
; ---------------------------------------------------------------------------

loc_6588BC45:				; CODE XREF: assuan_sock_deinit+Dj
		nop

locret_6588BC46:			; CODE XREF: assuan_sock_deinit+3Ej
		leave
		retn
assuan_sock_deinit endp

; Exported entry  60. assuan_sock_close

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sock_close
assuan_sock_close proc near		; CODE XREF: sub_6588B454+101p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	short loc_6588BC5F
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_6588A394

loc_6588BC5F:				; CODE XREF: assuan_sock_close+Aj
		mov	eax, ds:dword_65892080
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_65882627
		leave
		retn
assuan_sock_close endp

; Exported entry  65. assuan_sock_new

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sock_new
assuan_sock_new	proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_65892080
		mov	edx, [ebp+arg_8]
		mov	[esp+18h+var_C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_6588A6FC
		leave
		retn
assuan_sock_new	endp

; Exported entry  94. assuan_sock_set_flag

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sock_set_flag
assuan_sock_set_flag proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_65892080
		mov	edx, [ebp+arg_8]
		mov	[esp+18h+var_C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_6588A73D
		leave
		retn
assuan_sock_set_flag endp

; Exported entry  95. assuan_sock_get_flag

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sock_get_flag
assuan_sock_get_flag proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_65892080
		mov	edx, [ebp+arg_8]
		mov	[esp+18h+var_C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_6588A888
		leave
		retn
assuan_sock_get_flag endp

; Exported entry  61. assuan_sock_connect

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sock_connect
assuan_sock_connect proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_65892080
		mov	edx, [ebp+arg_8]
		mov	[esp+18h+var_C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_6588B232
		leave
		retn
assuan_sock_connect endp

; Exported entry  96. assuan_sock_connect_byname

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_sock_connect_byname(void *, int, int, char	*, int)
		public assuan_sock_connect_byname
assuan_sock_connect_byname proc	near

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= word ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], ax
		movzx	edx, [ebp+var_C]
		mov	eax, ds:dword_65892080
		mov	ecx, [ebp+arg_10]
		mov	[esp+38h+var_24], ecx ;	int
		mov	ecx, [ebp+arg_C]
		mov	[esp+38h+var_28], ecx ;	char *
		mov	ecx, [ebp+arg_8]
		mov	[esp+38h+var_2C], ecx ;	int
		mov	[esp+38h+var_30], edx ;	int
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_34], edx ;	void *
		mov	[esp+38h+var_38], eax ;	int
		call	sub_6588B454
		leave
		retn
assuan_sock_connect_byname endp

; Exported entry  58. assuan_sock_bind

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_sock_bind(SOCKET, struct sockaddr *, int)
		public assuan_sock_bind
assuan_sock_bind proc near

var_18		= dword	ptr -18h
s		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_65892080
		mov	edx, [ebp+arg_8]
		mov	[esp+18h+var_C], edx ; int
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx ;	struct sockaddr	*
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+s], edx ; s
		mov	[esp+18h+var_18], eax ;	int
		call	sub_6588B571
		leave
		retn
assuan_sock_bind endp

; Exported entry  93. assuan_sock_set_sockaddr_un

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_sock_set_sockaddr_un(char *, int, int)
		public assuan_sock_set_sockaddr_un
assuan_sock_set_sockaddr_un proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_6588B8E9
		leave
		retn
assuan_sock_set_sockaddr_un endp

; Exported entry  63. assuan_sock_get_nonce

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sock_get_nonce
assuan_sock_get_nonce proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_65892080
		mov	edx, [ebp+arg_8]
		mov	[esp+18h+var_C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_6588B9D5
		leave
		retn
assuan_sock_get_nonce endp

; Exported entry  59. assuan_sock_check_nonce

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_sock_check_nonce
assuan_sock_check_nonce	proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_65892080
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_6588BA4D
		leave
		retn
assuan_sock_check_nonce	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588BDF8	proc near		; CODE XREF: __assuan_spawn+BCp

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jns	short loc_6588BE0B
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588BE18
; ---------------------------------------------------------------------------

loc_6588BE0B:				; CODE XREF: sub_6588BDF8+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

locret_6588BE18:			; CODE XREF: sub_6588BDF8+11j
		leave
		retn
sub_6588BDF8	endp

; Exported entry  75. assuan_fdopen

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public assuan_fdopen
assuan_fdopen	proc near

hSourceProcessHandle= dword ptr	-38h
hSourceHandle	= dword	ptr -34h
hTargetProcessHandle= dword ptr	-30h
lpTargetHandle	= dword	ptr -2Ch
dwDesiredAccess	= dword	ptr -28h
bInheritHandle	= dword	ptr -24h
dwOptions	= dword	ptr -20h
TargetHandle	= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+hSourceProcessHandle],	eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp+var_C], eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+38h+dwOptions], 2 ; dwOptions
		mov	[esp+38h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+38h+dwDesiredAccess], 0 ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+38h+lpTargetHandle], edx ;	lpTargetHandle
		mov	[esp+38h+hTargetProcessHandle],	ebx ; hTargetProcessHandle
		mov	edx, [ebp+var_C]
		mov	[esp+38h+hSourceHandle], edx ; hSourceHandle
		mov	[esp+38h+hSourceProcessHandle],	eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_6588BE8F
		mov	[esp+38h+hSourceProcessHandle],	5
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588BE92
; ---------------------------------------------------------------------------

loc_6588BE8F:				; CODE XREF: assuan_fdopen+60j
		mov	eax, [ebp+TargetHandle]

loc_6588BE92:				; CODE XREF: assuan_fdopen+73j
		mov	ebx, [ebp+var_4]
		leave
		retn
assuan_fdopen	endp

; Exported entry  74. __assuan_usleep

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public __assuan_usleep
__assuan_usleep	proc near		; DATA XREF: .data:off_6588F104o

dwMilliseconds	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jz	short loc_6588BEC7
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	edx, 10624DD3h
		mov	eax, [ebp+var_C]
		mul	edx
		mov	eax, edx
		shr	eax, 6
		mov	[esp+28h+dwMilliseconds], eax ;	dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		jmp	short locret_6588BEC8
; ---------------------------------------------------------------------------

loc_6588BEC7:				; CODE XREF: __assuan_usleep+Aj
		nop

locret_6588BEC8:			; CODE XREF: __assuan_usleep+2Ej
		leave
		retn
__assuan_usleep	endp

; Exported entry  81. _assuan_w32ce_prepare_pipe

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _assuan_w32ce_prepare_pipe
_assuan_w32ce_prepare_pipe proc	near
		push	ebp
		mov	ebp, esp
		mov	eax, 0FFFFFFFFh
		pop	ebp
		retn
_assuan_w32ce_prepare_pipe endp

; Exported entry  82. _assuan_w32ce_finish_pipe

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _assuan_w32ce_finish_pipe
_assuan_w32ce_finish_pipe proc near
		push	ebp
		mov	ebp, esp
		mov	eax, 0FFFFFFFFh
		pop	ebp
		retn
_assuan_w32ce_finish_pipe endp

; Exported entry  79. _assuan_w32ce_create_pipe

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl assuan_w32ce_create_pipe(PHANDLE,	PHANDLE, LPSECURITY_ATTRIBUTES,	DWORD)
		public _assuan_w32ce_create_pipe
_assuan_w32ce_create_pipe proc near

hReadPipe	= dword	ptr -18h
hWritePipe	= dword	ptr -14h
lpPipeAttributes= dword	ptr -10h
nSize		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+nSize], eax ; nSize
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+lpPipeAttributes], eax	; lpPipeAttributes
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+hWritePipe], eax ; hWritePipe
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hReadPipe], eax ; hReadPipe
		mov	eax, ds:CreatePipe
		call	eax ; CreatePipe
		sub	esp, 10h
		leave
		retn
_assuan_w32ce_create_pipe endp

; Exported entry  71. __assuan_pipe

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public __assuan_pipe
__assuan_pipe	proc near		; DATA XREF: .data:off_6588F108o

hReadPipe	= dword	ptr -48h
hWritePipe	= dword	ptr -44h
lpPipeAttributes= dword	ptr -40h
nSize		= dword	ptr -3Ch
dwDesiredAccess	= dword	ptr -38h
bInheritHandle	= dword	ptr -34h
dwOptions	= dword	ptr -30h
PipeAttributes	= _SECURITY_ATTRIBUTES ptr -20h
TargetHandle	= dword	ptr -14h
hObject		= dword	ptr -10h
hSourceHandle	= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 40h
		lea	eax, [ebp+PipeAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+PipeAttributes.nLength], 0Ch
		mov	[ebp+PipeAttributes.bInheritHandle], 0
		mov	[esp+48h+nSize], 0 ; nSize
		lea	eax, [ebp+PipeAttributes]
		mov	[esp+48h+lpPipeAttributes], eax	; lpPipeAttributes
		lea	eax, [ebp+hObject]
		mov	[esp+48h+hWritePipe], eax ; hWritePipe
		lea	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hReadPipe
		mov	eax, ds:CreatePipe
		call	eax ; CreatePipe
		sub	esp, 10h
		test	eax, eax
		jnz	short loc_6588BFC1
		mov	[esp+48h+hWritePipe], 0FFFFFFFFh ; DWORD
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+hReadPipe], eax ; int
		call	sub_65883F36
		mov	[esp+48h+dwOptions], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+bInheritHandle], eax
		mov	[esp+48h+dwDesiredAccess], offset aCtx_7 ; "ctx"
		mov	[esp+48h+nSize], offset	a__assuan_pipe ; "__assuan_pipe"
		mov	[esp+48h+lpPipeAttributes], offset aSSPCallCreatep ; "%s (%s=%p): call:	CreatePipe failed: %s"...
		mov	[esp+48h+hWritePipe], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+hReadPipe], eax
		call	sub_65882E28
		mov	[esp+48h+hReadPipe], 5
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588C0DF
; ---------------------------------------------------------------------------

loc_6588BFC1:				; CODE XREF: __assuan_pipe+55j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	esi, eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_6588BFD5
		mov	ebx, [ebp+hSourceHandle]
		jmp	short loc_6588BFD8
; ---------------------------------------------------------------------------

loc_6588BFD5:				; CODE XREF: __assuan_pipe+C3j
		mov	ebx, [ebp+hObject]

loc_6588BFD8:				; CODE XREF: __assuan_pipe+C8j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+48h+dwOptions], 2 ; dwOptions
		mov	[esp+48h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+48h+dwDesiredAccess], 0 ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+48h+nSize], edx ; lpTargetHandle
		mov	[esp+48h+lpPipeAttributes], esi	; hTargetProcessHandle
		mov	[esp+48h+hWritePipe], ebx ; hSourceHandle
		mov	[esp+48h+hReadPipe], eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_6588C093
		mov	[esp+48h+hWritePipe], 0FFFFFFFFh ; DWORD
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+hReadPipe], eax ; int
		call	sub_65883F36
		mov	[esp+48h+dwOptions], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+bInheritHandle], eax
		mov	[esp+48h+dwDesiredAccess], offset aCtx_7 ; "ctx"
		mov	[esp+48h+nSize], offset	a__assuan_pipe ; "__assuan_pipe"
		mov	[esp+48h+lpPipeAttributes], offset aSSPCallDuplica ; "%s (%s=%p): call:	DuplicateHandle	faile"...
		mov	[esp+48h+hWritePipe], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+hReadPipe], eax
		call	sub_65882E28
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	[esp+48h+hReadPipe], 5
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588C0DF
; ---------------------------------------------------------------------------

loc_6588C093:				; CODE XREF: __assuan_pipe+10Aj
		cmp	[ebp+arg_8], 0
		jnz	short loc_6588C0B1
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+TargetHandle]
		mov	[ebp+hSourceHandle], eax
		jmp	short loc_6588C0C7
; ---------------------------------------------------------------------------

loc_6588C0B1:				; CODE XREF: __assuan_pipe+18Cj
		mov	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+TargetHandle]
		mov	[ebp+hObject], eax

loc_6588C0C7:				; CODE XREF: __assuan_pipe+1A4j
		mov	edx, [ebp+hSourceHandle]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	eax, [ebp+hObject]
		mov	[edx], eax
		mov	eax, 0

loc_6588C0DF:				; CODE XREF: __assuan_pipe+B1j
					; __assuan_pipe+186j
		lea	esp, [ebp-8]
		pop	ebx
		pop	esi
		pop	ebp
		retn
__assuan_pipe	endp

; Exported entry  70. __assuan_close

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _assuan_close(int, SOCKET)
		public __assuan_close
__assuan_close	proc near		; DATA XREF: .data:off_6588F10Co

s		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588C11C
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+28h+s], eax
		call	sub_6588A3F2
		mov	[esp+28h+s], eax
		call	gpg_err_set_errno

loc_6588C11C:				; CODE XREF: __assuan_close+1Dj
		cmp	[ebp+var_C], 0
		jz	short loc_6588C155
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		cmp	eax, 2736h
		jnz	short loc_6588C155
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+s], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588C155
		mov	[esp+28h+s], 5
		call	gpg_err_set_errno

loc_6588C155:				; CODE XREF: __assuan_close+3Aj
					; __assuan_close+48j ...
		mov	eax, [ebp+var_C]
		leave
		retn
__assuan_close	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_6588C15A(HANDLE hNamedPipe)
sub_6588C15A	proc near		; CODE XREF: __assuan_read+16p
					; __assuan_write+16p

hFile		= dword	ptr -38h
lpFlags		= dword	ptr -34h
lpOutBufferSize	= dword	ptr -30h
lpInBufferSize	= dword	ptr -2Ch
lpMaxInstances	= dword	ptr -28h
MaxInstances	= dword	ptr -18h
InBufferSize	= dword	ptr -14h
OutBufferSize	= dword	ptr -10h
Flags		= dword	ptr -0Ch
hNamedPipe	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+hNamedPipe]
		mov	[esp+38h+hFile], eax ; hFile
		mov	eax, ds:GetFileType
		call	eax ; GetFileType
		sub	esp, 4
		cmp	eax, 3
		jnz	short loc_6588C1AC
		lea	eax, [ebp+MaxInstances]
		mov	[esp+38h+lpMaxInstances], eax ;	lpMaxInstances
		lea	eax, [ebp+InBufferSize]
		mov	[esp+38h+lpInBufferSize], eax ;	lpInBufferSize
		lea	eax, [ebp+OutBufferSize]
		mov	[esp+38h+lpOutBufferSize], eax ; lpOutBufferSize
		lea	eax, [ebp+Flags]
		mov	[esp+38h+lpFlags], eax ; lpFlags
		mov	eax, [ebp+hNamedPipe]
		mov	[esp+38h+hFile], eax ; hNamedPipe
		mov	eax, ds:GetNamedPipeInfo
		call	eax ; GetNamedPipeInfo
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_6588C1AC
		mov	eax, 1
		jmp	short locret_6588C1B1
; ---------------------------------------------------------------------------

loc_6588C1AC:				; CODE XREF: sub_6588C15A+19j
					; sub_6588C15A+49j
		mov	eax, 0

locret_6588C1B1:			; CODE XREF: sub_6588C15A+50j
		leave
		retn
sub_6588C15A	endp

; Exported entry  87. __assuan_read

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _assuan_read(int,	SOCKET,	char *,	DWORD nNumberOfBytesToRead)
		public __assuan_read
__assuan_read	proc near		; DATA XREF: .data:off_6588F110o

s		= dword	ptr -148h
buf		= dword	ptr -144h
len		= dword	ptr -140h
flags		= dword	ptr -13Ch
timeout		= dword	ptr -138h
readfds		= fd_set ptr -120h
NumberOfBytesRead= dword ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
nNumberOfBytesToRead= dword ptr	 14h

		push	ebp
		mov	ebp, esp
		sub	esp, 148h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+s], eax ; hNamedPipe
		call	sub_6588C15A
		test	eax, eax
		jz	loc_6588C2DA
		mov	[ebp+var_14], 3

loc_6588C1DD:				; CODE XREF: __assuan_read+122j
		mov	[ebp+var_10], 0
		mov	edx, [ebp+nNumberOfBytesToRead]
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+flags], 0 ; flags
		mov	[esp+148h+len],	edx ; len
		mov	edx, [ebp+arg_8]
		mov	[esp+148h+buf],	edx ; buf
		mov	[esp+148h+s], eax ; s
		mov	eax, ds:recv
		call	eax ; recv
		sub	esp, 10h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_6588C21D
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[ebp+var_10], eax

loc_6588C21D:				; CODE XREF: __assuan_read+5Ej
		cmp	[ebp+var_10], 2733h
		jnz	loc_6588C32B
		cmp	[ebp+var_14], 0
		setnz	al
		sub	[ebp+var_14], 1
		test	al, al
		jz	loc_6588C32B
		mov	[ebp+readfds.fd_count],	0
		mov	[ebp+var_18], 0
		jmp	short loc_6588C265
; ---------------------------------------------------------------------------

loc_6588C250:				; CODE XREF: __assuan_read+BBj
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+eax*4+readfds.fd_array]
		mov	eax, [ebp+arg_4]
		cmp	edx, eax
		jz	short loc_6588C270
		add	[ebp+var_18], 1

loc_6588C265:				; CODE XREF: __assuan_read+9Bj
		mov	eax, [ebp+readfds.fd_count]
		cmp	eax, [ebp+var_18]
		ja	short loc_6588C250

loc_6588C270:				; CODE XREF: __assuan_read+ACj
		mov	eax, [ebp+readfds.fd_count]
		cmp	eax, [ebp+var_18]
		jnz	short loc_6588C2A2
		mov	eax, [ebp+readfds.fd_count]
		cmp	eax, 3Fh
		ja	short loc_6588C2A2
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	[ebp+eax*4+readfds.fd_array], edx
		mov	eax, [ebp+readfds.fd_count]
		add	eax, 1
		mov	[ebp+readfds.fd_count],	eax

loc_6588C2A2:				; CODE XREF: __assuan_read+C6j
					; __assuan_read+D1j
		mov	[esp+148h+timeout], 0 ;	timeout
		mov	[esp+148h+flags], 0 ; exceptfds
		mov	[esp+148h+len],	0 ; writefds
		lea	eax, [ebp+readfds]
		mov	[esp+148h+buf],	eax ; readfds
		mov	[esp+148h+s], 0	; nfds
		mov	eax, ds:select
		call	eax ; select
		sub	esp, 14h
		jmp	loc_6588C1DD
; ---------------------------------------------------------------------------

loc_6588C2DA:				; CODE XREF: __assuan_read+1Dj
		mov	[ebp+NumberOfBytesRead], 0
		mov	[esp+148h+timeout], 0 ;	lpOverlapped
		lea	eax, [ebp+NumberOfBytesRead]
		mov	[esp+148h+flags], eax ;	lpNumberOfBytesRead
		mov	eax, [ebp+nNumberOfBytesToRead]
		mov	[esp+148h+len],	eax ; nNumberOfBytesToRead
		mov	eax, [ebp+arg_8]
		mov	[esp+148h+buf],	eax ; lpBuffer
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+s], eax ; hFile
		mov	eax, ds:ReadFile
		call	eax ; ReadFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_6588C325
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_10], eax
		jmp	short loc_6588C32B
; ---------------------------------------------------------------------------

loc_6588C325:				; CODE XREF: __assuan_read+15Dj
		mov	eax, [ebp+NumberOfBytesRead]
		mov	[ebp+var_C], eax

loc_6588C32B:				; CODE XREF: __assuan_read+71j
					; __assuan_read+84j ...
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_6588C390
		mov	eax, [ebp+var_10]
		cmp	eax, 2733h
		jz	short loc_6588C367
		cmp	eax, 2733h
		jg	short loc_6588C349
		cmp	eax, 6Dh
		jz	short loc_6588C375
		jmp	short loc_6588C383
; ---------------------------------------------------------------------------

loc_6588C349:				; CODE XREF: __assuan_read+18Dj
		cmp	eax, 2736h
		jz	short loc_6588C359
		cmp	eax, 2746h
		jz	short loc_6588C375
		jmp	short loc_6588C383
; ---------------------------------------------------------------------------

loc_6588C359:				; CODE XREF: __assuan_read+19Bj
		mov	[esp+148h+s], 9
		call	gpg_err_set_errno
		jmp	short loc_6588C390
; ---------------------------------------------------------------------------

loc_6588C367:				; CODE XREF: __assuan_read+186j
		mov	[esp+148h+s], 0Bh
		call	gpg_err_set_errno
		jmp	short loc_6588C390
; ---------------------------------------------------------------------------

loc_6588C375:				; CODE XREF: __assuan_read+192j
					; __assuan_read+1A2j
		mov	[esp+148h+s], 20h
		call	gpg_err_set_errno
		jmp	short loc_6588C390
; ---------------------------------------------------------------------------

loc_6588C383:				; CODE XREF: __assuan_read+194j
					; __assuan_read+1A4j
		mov	[esp+148h+s], 5
		call	gpg_err_set_errno
		nop

loc_6588C390:				; CODE XREF: __assuan_read+17Cj
					; __assuan_read+1B2j ...
		mov	eax, [ebp+var_C]
		leave
		retn
__assuan_read	endp

; Exported entry  88. __assuan_write

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _assuan_write(int, SOCKET, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite)
		public __assuan_write
__assuan_write	proc near		; DATA XREF: .data:off_6588F114o

s		= dword	ptr -148h
buf		= dword	ptr -144h
len		= dword	ptr -140h
flags		= dword	ptr -13Ch
timeout		= dword	ptr -138h
writefds	= fd_set ptr -120h
NumberOfBytesWritten= dword ptr	-1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
lpBuffer	= dword	ptr  10h
nNumberOfBytesToWrite= dword ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 148h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+s], eax ; hNamedPipe
		call	sub_6588C15A
		test	eax, eax
		jz	loc_6588C4BC
		mov	[ebp+var_14], 3

loc_6588C3BF:				; CODE XREF: __assuan_write+122j
		mov	[ebp+var_10], 0
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+flags], 0 ; flags
		mov	[esp+148h+len],	edx ; len
		mov	edx, [ebp+lpBuffer]
		mov	[esp+148h+buf],	edx ; buf
		mov	[esp+148h+s], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_6588C3FF
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[ebp+var_10], eax

loc_6588C3FF:				; CODE XREF: __assuan_write+5Ej
		cmp	[ebp+var_10], 2733h
		jnz	loc_6588C506
		cmp	[ebp+var_14], 0
		setnz	al
		sub	[ebp+var_14], 1
		test	al, al
		jz	loc_6588C506
		mov	[ebp+writefds.fd_count], 0
		mov	[ebp+var_18], 0
		jmp	short loc_6588C447
; ---------------------------------------------------------------------------

loc_6588C432:				; CODE XREF: __assuan_write+BBj
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+eax*4+writefds.fd_array]
		mov	eax, [ebp+arg_4]
		cmp	edx, eax
		jz	short loc_6588C452
		add	[ebp+var_18], 1

loc_6588C447:				; CODE XREF: __assuan_write+9Bj
		mov	eax, [ebp+writefds.fd_count]
		cmp	eax, [ebp+var_18]
		ja	short loc_6588C432

loc_6588C452:				; CODE XREF: __assuan_write+ACj
		mov	eax, [ebp+writefds.fd_count]
		cmp	eax, [ebp+var_18]
		jnz	short loc_6588C484
		mov	eax, [ebp+writefds.fd_count]
		cmp	eax, 3Fh
		ja	short loc_6588C484
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	[ebp+eax*4+writefds.fd_array], edx
		mov	eax, [ebp+writefds.fd_count]
		add	eax, 1
		mov	[ebp+writefds.fd_count], eax

loc_6588C484:				; CODE XREF: __assuan_write+C6j
					; __assuan_write+D1j
		mov	[esp+148h+timeout], 0 ;	timeout
		mov	[esp+148h+flags], 0 ; exceptfds
		lea	eax, [ebp+writefds]
		mov	[esp+148h+len],	eax ; writefds
		mov	[esp+148h+buf],	0 ; readfds
		mov	[esp+148h+s], 0	; nfds
		mov	eax, ds:select
		call	eax ; select
		sub	esp, 14h
		jmp	loc_6588C3BF
; ---------------------------------------------------------------------------

loc_6588C4BC:				; CODE XREF: __assuan_write+1Dj
		mov	[esp+148h+timeout], 0 ;	lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		mov	[esp+148h+flags], eax ;	lpNumberOfBytesWritten
		mov	eax, [ebp+nNumberOfBytesToWrite]
		mov	[esp+148h+len],	eax ; nNumberOfBytesToWrite
		mov	eax, [ebp+lpBuffer]
		mov	[esp+148h+buf],	eax ; lpBuffer
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+s], eax ; hFile
		mov	eax, ds:WriteFile
		call	eax ; WriteFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_6588C500
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_10], eax
		jmp	short loc_6588C506
; ---------------------------------------------------------------------------

loc_6588C500:				; CODE XREF: __assuan_write+156j
		mov	eax, [ebp+NumberOfBytesWritten]
		mov	[ebp+var_C], eax

loc_6588C506:				; CODE XREF: __assuan_write+71j
					; __assuan_write+84j ...
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_6588C569
		mov	eax, [ebp+var_10]
		cmp	eax, 0E8h
		jz	short loc_6588C54E
		cmp	eax, 0E8h
		jg	short loc_6588C524
		cmp	eax, 6Dh
		jz	short loc_6588C54E
		jmp	short loc_6588C55C
; ---------------------------------------------------------------------------

loc_6588C524:				; CODE XREF: __assuan_write+186j
		cmp	eax, 2733h
		jz	short loc_6588C540
		cmp	eax, 2736h
		jnz	short loc_6588C55C
		mov	[esp+148h+s], 9
		call	gpg_err_set_errno
		jmp	short loc_6588C569
; ---------------------------------------------------------------------------

loc_6588C540:				; CODE XREF: __assuan_write+194j
		mov	[esp+148h+s], 0Bh
		call	gpg_err_set_errno
		jmp	short loc_6588C569
; ---------------------------------------------------------------------------

loc_6588C54E:				; CODE XREF: __assuan_write+17Fj
					; __assuan_write+18Bj
		mov	[esp+148h+s], 20h
		call	gpg_err_set_errno
		jmp	short loc_6588C569
; ---------------------------------------------------------------------------

loc_6588C55C:				; CODE XREF: __assuan_write+18Dj
					; __assuan_write+19Bj
		mov	[esp+148h+s], 5
		call	gpg_err_set_errno
		nop

loc_6588C569:				; CODE XREF: __assuan_write+175j
					; __assuan_write+1A9j ...
		mov	eax, [ebp+var_C]
		leave
		retn
__assuan_write	endp

; Exported entry  89. __assuan_recvmsg

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public __assuan_recvmsg
__assuan_recvmsg proc near		; DATA XREF: .data:off_6588F118o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 28h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		leave
		retn
__assuan_recvmsg endp

; Exported entry  90. __assuan_sendmsg

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public __assuan_sendmsg
__assuan_sendmsg proc near		; DATA XREF: .data:off_6588F11Co

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 28h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		leave
		retn
__assuan_sendmsg endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588C5A0	proc near		; CODE XREF: __assuan_spawn+42p

Str		= dword	ptr -48h
Control		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_6588C60C
; ---------------------------------------------------------------------------

loc_6588C5C0:				; CODE XREF: sub_6588C5A0+7Ej
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_6588C5FE
; ---------------------------------------------------------------------------

loc_6588C5EC:				; CODE XREF: sub_6588C5A0+66j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_6588C5FA
		add	[ebp+var_10], 1

loc_6588C5FA:				; CODE XREF: sub_6588C5A0+54j
		add	[ebp+var_14], 1

loc_6588C5FE:				; CODE XREF: sub_6588C5A0+4Aj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_6588C5EC
		add	[ebp+var_C], 1

loc_6588C60C:				; CODE XREF: sub_6588C5A0+1Ej
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_6588C5C0
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Control], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	sub_65882268
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_6588C64F
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588C758
; ---------------------------------------------------------------------------

loc_6588C64F:				; CODE XREF: sub_6588C5A0+A3j
		mov	[ebp+var_C], 0
		jmp	loc_6588C738
; ---------------------------------------------------------------------------

loc_6588C65B:				; CODE XREF: sub_6588C5A0+1A5j
		cmp	[ebp+var_C], 0
		jz	short loc_6588C66D
		mov	eax, [ebp+var_18]
		mov	word ptr [eax],	20h
		add	[ebp+var_18], 1

loc_6588C66D:				; CODE XREF: sub_6588C5A0+BFj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_6588C694
		mov	eax, [ebp+var_18]
		mov	word ptr [eax],	2222h
		mov	byte ptr [eax+2], 0
		add	[ebp+var_18], 2
		jmp	loc_6588C734
; ---------------------------------------------------------------------------

loc_6588C694:				; CODE XREF: sub_6588C5A0+DDj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+48h+Control], offset Control ; " \t\n\v"
		mov	[esp+48h+Str], eax ; Str
		call	strpbrk
		test	eax, eax
		jz	short loc_6588C717
		mov	eax, [ebp+var_18]
		mov	word ptr [eax],	22h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		jmp	short loc_6588C6FB
; ---------------------------------------------------------------------------

loc_6588C6CF:				; CODE XREF: sub_6588C5A0+163j
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_6588C6F7
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1

loc_6588C6F7:				; CODE XREF: sub_6588C5A0+146j
		add	[ebp+var_14], 1

loc_6588C6FB:				; CODE XREF: sub_6588C5A0+12Dj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_6588C6CF
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	22h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		jmp	short loc_6588C734
; ---------------------------------------------------------------------------

loc_6588C717:				; CODE XREF: sub_6588C5A0+111j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+48h+Control], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax
		call	sub_6588CC1C
		mov	[ebp+var_18], eax

loc_6588C734:				; CODE XREF: sub_6588C5A0+EFj
					; sub_6588C5A0+175j
		add	[ebp+var_C], 1

loc_6588C738:				; CODE XREF: sub_6588C5A0+B6j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_6588C65B
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, 0

loc_6588C758:				; CODE XREF: sub_6588C5A0+AAj
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_6588C5A0	endp

; Exported entry  73. __assuan_spawn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _assuan_spawn(int, int, LPCSTR lpApplicationName,	int, int, int, int, int, int, int)
		public __assuan_spawn
__assuan_spawn	proc near		; DATA XREF: .data:off_6588F120o

File		= dword	ptr -0A8h
dwDesiredAccess	= dword	ptr -0A4h
dwShareMode	= dword	ptr -0A0h
lpSecurityAttributes= dword ptr	-9Ch
dwCreationDisposition= dword ptr -98h
dwFlagsAndAttributes= dword ptr	-94h
hTemplateFile	= dword	ptr -90h
lpCurrentDirectory= dword ptr -8Ch
lpStartupInfo	= dword	ptr -88h
lpProcessInformation= dword ptr	-84h
lpCommandLine	= dword	ptr -78h
StartupInfo	= _STARTUPINFOA	ptr -74h
ProcessInformation= _PROCESS_INFORMATION ptr -30h
ProcessAttributes= _SECURITY_ATTRIBUTES	ptr -20h
var_14		= dword	ptr -14h
hObject		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpApplicationName= dword ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0A0h
		mov	[ebp+ProcessInformation.hProcess], 0
		mov	[ebp+ProcessInformation.hThread], 0
		mov	[ebp+ProcessInformation.dwProcessId], 0
		mov	[ebp+ProcessInformation.dwThreadId], 0
		mov	[ebp+hObject], 0FFFFFFFFh
		lea	eax, [ebp+lpCommandLine]
		mov	[esp+0A8h+dwShareMode],	eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0A8h+dwDesiredAccess], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+File], eax
		call	sub_6588C5A0
		test	eax, eax
		jz	short loc_6588C7B3
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588CA8A
; ---------------------------------------------------------------------------

loc_6588C7B3:				; CODE XREF: __assuan_spawn+49j
		lea	eax, [ebp+ProcessAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+ProcessAttributes.nLength], 0Ch
		mov	[ebp+ProcessAttributes.bInheritHandle],	0
		lea	eax, [ebp+StartupInfo]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+StartupInfo.cb], 44h
		mov	[ebp+StartupInfo.dwFlags], 100h
		mov	eax, [ebp+arg_10]
		mov	[ebp+StartupInfo.hStdInput], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+StartupInfo.hStdOutput], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+0A8h+File], eax ; File
		call	_fileno
		mov	[esp+0A8h+File], eax
		call	sub_6588BDF8
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_6588C848
		jmp	short loc_6588C834
; ---------------------------------------------------------------------------

loc_6588C830:				; CODE XREF: __assuan_spawn+E8j
		add	[ebp+var_C], 4

loc_6588C834:				; CODE XREF: __assuan_spawn+D0j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_6588C848
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+var_14]
		jnz	short loc_6588C830

loc_6588C848:				; CODE XREF: __assuan_spawn+CEj
					; __assuan_spawn+DEj
		cmp	[ebp+var_C], 0
		jz	short loc_6588C85C
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	loc_6588C91F

loc_6588C85C:				; CODE XREF: __assuan_spawn+EEj
		mov	[esp+0A8h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+0A8h+dwFlagsAndAttributes], 0 ; dwFlagsAndAttributes
		mov	[esp+0A8h+dwCreationDisposition], 3 ; dwCreationDisposition
		mov	[esp+0A8h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+0A8h+dwShareMode],	3 ; dwShareMode
		mov	[esp+0A8h+dwDesiredAccess], 40000000h ;	dwDesiredAccess
		mov	[esp+0A8h+File], offset	FileName ; lpFileName
		mov	eax, ds:CreateFileW
		call	eax ; CreateFileW
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jnz	short loc_6588C917
		mov	[esp+0A8h+dwDesiredAccess], 0FFFFFFFFh ; DWORD
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+File], eax ; int
		call	sub_65883F36
		mov	[esp+0A8h+hTemplateFile], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+dwFlagsAndAttributes], eax
		mov	[esp+0A8h+dwCreationDisposition], offset aCtx_7	; "ctx"
		mov	[esp+0A8h+lpSecurityAttributes], offset	a__assuan_spawn	; "__assuan_spawn"
		mov	[esp+0A8h+dwShareMode],	offset aSSPCallCanTOpe ; "%s (%s=%p): call: can't open `nul': %s\"...
		mov	[esp+0A8h+dwDesiredAccess], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+File], eax
		call	sub_65882E28
		mov	eax, [ebp+lpCommandLine]
		mov	[esp+0A8h+dwDesiredAccess], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+File], eax
		call	sub_65882313
		mov	[esp+0A8h+File], 5
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588CA8A
; ---------------------------------------------------------------------------

loc_6588C917:				; CODE XREF: __assuan_spawn+146j
		mov	eax, [ebp+hObject]
		mov	[ebp+StartupInfo.hStdError], eax
		jmp	short loc_6588C925
; ---------------------------------------------------------------------------

loc_6588C91F:				; CODE XREF: __assuan_spawn+F8j
		mov	eax, [ebp+var_14]
		mov	[ebp+StartupInfo.hStdError], eax

loc_6588C925:				; CODE XREF: __assuan_spawn+1BFj
		mov	eax, [ebp+arg_24]
		and	eax, 80h
		test	eax, eax
		jz	short loc_6588C938
		mov	ebx, 4000008h
		jmp	short loc_6588C93D
; ---------------------------------------------------------------------------

loc_6588C938:				; CODE XREF: __assuan_spawn+1D1j
		mov	ebx, 4000000h

loc_6588C93D:				; CODE XREF: __assuan_spawn+1D8j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+0A8h+File], eax ; hProcess
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, ebx
		mov	ecx, eax
		or	ecx, 4
		mov	eax, [ebp+lpCommandLine]
		lea	edx, [ebp+ProcessInformation]
		mov	[esp+0A8h+lpProcessInformation], edx ; lpProcessInformation
		lea	edx, [ebp+StartupInfo]
		mov	[esp+0A8h+lpStartupInfo], edx ;	lpStartupInfo
		mov	[esp+0A8h+lpCurrentDirectory], 0 ; lpCurrentDirectory
		mov	[esp+0A8h+hTemplateFile], 0 ; lpEnvironment
		mov	[esp+0A8h+dwFlagsAndAttributes], ecx ; dwCreationFlags
		mov	[esp+0A8h+dwCreationDisposition], 1 ; bInheritHandles
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0A8h+lpSecurityAttributes], edx ; lpThreadAttributes
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0A8h+dwShareMode],	edx ; lpProcessAttributes
		mov	[esp+0A8h+dwDesiredAccess], eax	; lpCommandLine
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+File], eax ; lpApplicationName
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	loc_6588CA33
		mov	[esp+0A8h+dwDesiredAccess], 0FFFFFFFFh ; DWORD
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+File], eax ; int
		call	sub_65883F36
		mov	[esp+0A8h+hTemplateFile], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+dwFlagsAndAttributes], eax
		mov	[esp+0A8h+dwCreationDisposition], offset aCtx_7	; "ctx"
		mov	[esp+0A8h+lpSecurityAttributes], offset	aPipe_connect_w	; "pipe_connect_w32"
		mov	[esp+0A8h+dwShareMode],	offset aSSPCallCreat_0 ; "%s (%s=%p): call: CreateProcess failed:"...
		mov	[esp+0A8h+dwDesiredAccess], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+File], eax
		call	sub_65882E28
		mov	eax, [ebp+lpCommandLine]
		mov	[esp+0A8h+dwDesiredAccess], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+File], eax
		call	sub_65882313
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_6588CA20
		mov	eax, [ebp+hObject]
		mov	[esp+0A8h+File], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_6588CA20:				; CODE XREF: __assuan_spawn+2B0j
		mov	[esp+0A8h+File], 5
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588CA8A
; ---------------------------------------------------------------------------

loc_6588CA33:				; CODE XREF: __assuan_spawn+24Bj
		mov	eax, [ebp+lpCommandLine]
		mov	[esp+0A8h+dwDesiredAccess], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+File], eax
		call	sub_65882313
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_6588CA5B
		mov	eax, [ebp+hObject]
		mov	[esp+0A8h+File], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_6588CA5B:				; CODE XREF: __assuan_spawn+2EBj
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0A8h+File], eax ; hThread
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0A8h+File], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hProcess]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

loc_6588CA8A:				; CODE XREF: __assuan_spawn+50j
					; __assuan_spawn+1B4j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
__assuan_spawn	endp

; Exported entry  91. __assuan_waitpid

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _assuan_waitpid(int, HANDLE)
		public __assuan_waitpid
__assuan_waitpid proc near		; DATA XREF: .data:off_6588F124o

hObject		= dword	ptr -18h
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		leave
		retn
__assuan_waitpid endp

; Exported entry  72. __assuan_socketpair

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public __assuan_socketpair
__assuan_socketpair proc near		; DATA XREF: .data:off_6588F128o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 28h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		leave
		retn
__assuan_socketpair endp

; Exported entry  83. __assuan_socket

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public __assuan_socket
__assuan_socket	proc near		; DATA XREF: .data:off_6588F12Co

var_28		= dword	ptr -28h
type		= dword	ptr -24h
protocol	= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+protocol], eax	; protocol
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+type],	eax ; type
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax ;	af
		mov	eax, ds:socket
		call	eax ; socket
		sub	esp, 0Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_6588CB0B
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+28h+var_28], eax
		call	sub_6588A3F2
		mov	[esp+28h+var_28], eax
		call	gpg_err_set_errno

loc_6588CB0B:				; CODE XREF: __assuan_socket+2Bj
		mov	eax, [ebp+var_C]
		leave
		retn
__assuan_socket	endp

; Exported entry  84. __assuan_connect

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _assuan_connect(int, SOCKET, struct sockaddr *, int)
		public __assuan_connect
__assuan_connect proc near		; DATA XREF: .data:off_6588F130o

s		= dword	ptr -28h
name		= dword	ptr -24h
namelen		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_C]
		mov	[esp+28h+namelen], edx ; namelen
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+name],	edx ; name
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:connect
		call	eax ; connect
		sub	esp, 0Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_6588CB54
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+28h+s], eax
		call	sub_6588A3F2
		mov	[esp+28h+s], eax
		call	gpg_err_set_errno

loc_6588CB54:				; CODE XREF: __assuan_connect+2Bj
		mov	eax, [ebp+var_C]
		leave
		retn
__assuan_connect endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588CB5C	proc near		; DATA XREF: assuan_init_pipe_server+1ADo
					; assuan_init_socket_server+13Eo ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1ACh]
		mov	edx, [ebp+arg_8]
		mov	[esp+18h+var_C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_658826D9
		leave
		retn
sub_6588CB5C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588CB8A	proc near		; DATA XREF: assuan_init_pipe_server+1BAo
					; assuan_init_socket_server+14Bo ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+998h]
		mov	edx, [ebp+arg_8]
		mov	[esp+18h+var_C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_65882707
		leave
		retn
sub_6588CB8A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	putc
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588CBD4	proc near		; CODE XREF: sub_65884049+C0p
					; sub_6588412E+365p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_6588CC12
		mov	eax, [ebp+arg_8]
		sub	eax, 1
		add	[ebp+var_4], eax
		jmp	short loc_6588CC0C
; ---------------------------------------------------------------------------

loc_6588CBF1:				; CODE XREF: sub_6588CBD4+3Cj
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_4]
		jnz	short loc_6588CC04
		mov	eax, [ebp+var_4]
		jmp	short locret_6588CC17
; ---------------------------------------------------------------------------

loc_6588CC04:				; CODE XREF: sub_6588CBD4+29j
		sub	[ebp+var_4], 1
		sub	[ebp+arg_8], 1

loc_6588CC0C:				; CODE XREF: sub_6588CBD4+1Bj
		cmp	[ebp+arg_8], 0
		jnz	short loc_6588CBF1

loc_6588CC12:				; CODE XREF: sub_6588CBD4+10j
		mov	eax, 0

locret_6588CC17:			; CODE XREF: sub_6588CBD4+2Ej
		leave
		retn
sub_6588CBD4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588CC1C	proc near		; CODE XREF: sub_6588C5A0+18Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		mov	esi, [ebp+arg_0]
		mov	ebx, [ebp+arg_4]

loc_6588CC27:				; CODE XREF: sub_6588CC1C+20j
		movzx	eax, byte ptr [ebx]
		mov	[esi], al
		add	esi, 1
		movzx	eax, byte ptr [ebx]
		test	al, al
		setnz	al
		add	ebx, 1
		test	al, al
		jnz	short loc_6588CC27
		lea	eax, [esi-1]
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_6588CC1C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_6588CC48(char	*, void	*Src, int, int)
sub_6588CC48	proc near		; CODE XREF: .text:6588CF25p

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
MaxCount	= dword	ptr -40h
var_2C		= dword	ptr -2Ch
Dst		= dword	ptr -28h
var_24		= dword	ptr -24h
Size		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+Size], eax
		cmp	[ebp+Src], 0
		jz	short loc_6588CC9D
		mov	eax, [ebp+Src]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		jmp	short loc_6588CCA2
; ---------------------------------------------------------------------------

loc_6588CC9D:				; CODE XREF: sub_6588CC48+2Fj
		mov	eax, 0

loc_6588CCA2:				; CODE XREF: sub_6588CC48+53j
		mov	[ebp+var_24], eax
		mov	eax, ds:_environ
		mov	esi, [eax]
		mov	ebx, 0
		test	esi, esi
		jz	short loc_6588CCEB
		jmp	short loc_6588CCE5
; ---------------------------------------------------------------------------

loc_6588CCB7:				; CODE XREF: sub_6588CC48+A1j
		mov	eax, [esi]
		mov	edx, [ebp+Size]
		mov	[esp+48h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+Str2],	edx ; Str2
		mov	[esp+48h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_6588CCDF
		mov	eax, [esi]
		add	eax, [ebp+Size]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_6588CCEB

loc_6588CCDF:				; CODE XREF: sub_6588CC48+89j
		add	ebx, 1
		add	esi, 4

loc_6588CCE5:				; CODE XREF: sub_6588CC48+6Dj
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_6588CCB7

loc_6588CCEB:				; CODE XREF: sub_6588CC48+6Bj
					; sub_6588CC48+95j
		test	esi, esi
		jz	short loc_6588CCF9
		mov	eax, [esi]
		test	eax, eax
		jnz	loc_6588CE3C

loc_6588CCF9:				; CODE XREF: sub_6588CC48+A5j
		lea	eax, [ebx+2]
		lea	edx, ds:0[eax*4]
		mov	eax, ds:Memory
		mov	[esp+48h+Str2],	edx ; NewSize
		mov	[esp+48h+Str1],	eax ; Memory
		call	realloc
		mov	[ebp+Dst], eax
		cmp	[ebp+Dst], 0
		jnz	short loc_6588CD27
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588CEC0
; ---------------------------------------------------------------------------

loc_6588CD27:				; CODE XREF: sub_6588CC48+D3j
		cmp	[ebp+arg_8], 0
		jz	short loc_6588CD41
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+Dst]
		mov	edx, [ebp+arg_8]
		mov	[eax], edx
		jmp	loc_6588CDE7
; ---------------------------------------------------------------------------

loc_6588CD41:				; CODE XREF: sub_6588CC48+E3j
		lea	eax, ds:0[ebx*4]
		mov	esi, eax
		add	esi, [ebp+Dst]
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 1
		mov	[esp+48h+Str1],	eax ; Size
		call	malloc
		mov	[esi], eax
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+Dst]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_6588CD89
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588CEC0
; ---------------------------------------------------------------------------

loc_6588CD89:				; CODE XREF: sub_6588CC48+128j
		mov	edx, [ebp+arg_0]
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+Dst]
		mov	eax, [eax]
		mov	ecx, [ebp+Size]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+Dst]
		mov	eax, [eax]
		add	eax, [ebp+Size]
		mov	byte ptr [eax],	3Dh
		mov	edx, [ebp+Src]
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+Dst]
		mov	eax, [eax]
		mov	ecx, [ebp+Size]
		add	ecx, 1
		add	eax, ecx
		mov	ecx, [ebp+var_24]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy

loc_6588CDE7:				; CODE XREF: sub_6588CC48+F4j
		mov	eax, ds:_environ
		mov	edx, [eax]
		mov	eax, ds:Memory
		cmp	edx, eax
		jz	short loc_6588CE1A
		lea	ecx, ds:0[ebx*4]
		mov	eax, ds:_environ
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy

loc_6588CE1A:				; CODE XREF: sub_6588CC48+1ADj
		lea	eax, [ebx+1]
		shl	eax, 2
		add	eax, [ebp+Dst]
		mov	dword ptr [eax], 0
		mov	eax, ds:_environ
		mov	edx, [ebp+Dst]
		mov	[eax], edx
		mov	eax, [eax]
		mov	ds:Memory, eax
		jmp	short loc_6588CEBB
; ---------------------------------------------------------------------------

loc_6588CE3C:				; CODE XREF: sub_6588CC48+ABj
		cmp	[ebp+arg_C], 0
		jz	short loc_6588CEBB
		cmp	[ebp+arg_8], 0
		jz	short loc_6588CE50
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], eax
		jmp	short loc_6588CEB6
; ---------------------------------------------------------------------------

loc_6588CE50:				; CODE XREF: sub_6588CC48+1FEj
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 1
		mov	[esp+48h+Str1],	eax ; Size
		call	malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_6588CE73
		mov	eax, 0FFFFFFFFh
		jmp	short loc_6588CEC0
; ---------------------------------------------------------------------------

loc_6588CE73:				; CODE XREF: sub_6588CC48+222j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+Size]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+Size]
		mov	edx, [ebp+var_1C]
		add	eax, edx
		mov	byte ptr [eax],	3Dh
		mov	edx, [ebp+Src]
		mov	eax, [ebp+Size]
		add	eax, 1
		add	eax, [ebp+var_1C]
		mov	ecx, [ebp+var_24]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy

loc_6588CEB6:				; CODE XREF: sub_6588CC48+206j
		mov	eax, [ebp+var_1C]
		mov	[esi], eax

loc_6588CEBB:				; CODE XREF: sub_6588CC48+1F2j
					; sub_6588CC48+1F8j
		mov	eax, 0

loc_6588CEC0:				; CODE XREF: sub_6588CC48+DAj
					; sub_6588CC48+13Cj ...
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_6588CC48	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_6588CEF5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_6588CEF5
		mov	dword ptr [esp+4], 3Dh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_6588CF09

loc_6588CEF5:				; CODE XREF: .text:6588CED2j
					; .text:6588CEDCj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_6588CF2A
; ---------------------------------------------------------------------------

loc_6588CF09:				; CODE XREF: .text:6588CEF3j
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_6588CC48

locret_6588CF2A:			; CODE XREF: .text:6588CF07j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_6588CF5A
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_6588CF5A
		mov	dword ptr [esp+4], 3Dh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_6588CF71

loc_6588CF5A:				; CODE XREF: .text:6588CF37j
					; .text:6588CF41j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_6588D004
; ---------------------------------------------------------------------------

loc_6588CF71:				; CODE XREF: .text:6588CF58j
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp-14h], eax
		mov	eax, ds:_environ
		mov	eax, [eax]
		mov	[ebp-0Ch], eax
		jmp	short loc_6588CFF6
; ---------------------------------------------------------------------------

loc_6588CF9F:				; CODE XREF: .text:6588CFFDj
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	edx, [ebp-14h]
		mov	[esp+8], edx
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strncmp
		test	eax, eax
		jnz	short loc_6588CFF2
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		add	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_6588CFF2
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax

loc_6588CFD3:				; CODE XREF: .text:6588CFEEj
		mov	eax, [ebp-10h]
		mov	edx, [eax+4]
		mov	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		test	eax, eax
		setnz	al
		add	dword ptr [ebp-10h], 4
		test	al, al
		jnz	short loc_6588CFD3
		jmp	short loc_6588CFF6
; ---------------------------------------------------------------------------

loc_6588CFF2:				; CODE XREF: .text:6588CFBCj
					; .text:6588CFCBj
		add	dword ptr [ebp-0Ch], 4

loc_6588CFF6:				; CODE XREF: .text:6588CF9Dj
					; .text:6588CFF0j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_6588CF9F
		mov	eax, 0

loc_6588D004:				; CODE XREF: .text:6588CF6Cj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:_environ
		mov	edx, [eax]
		mov	eax, ds:Memory
		cmp	edx, eax
		jnz	short loc_6588D044
		mov	eax, ds:_environ
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_6588D044
		mov	eax, ds:_environ
		mov	eax, [eax]
		mov	[esp], eax
		call	free
		mov	ds:Memory, 0

loc_6588D044:				; CODE XREF: .text:6588D01Ej
					; .text:6588D029j
		mov	eax, ds:_environ
		mov	dword ptr [eax], 0
		mov	eax, 0
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strsource]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_syserror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_set_errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpgrt_vasprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gpgrt_asprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror_r]
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_6588D090(_onexit_t)
sub_6588D090	proc near		; CODE XREF: sub_6588D150+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_658924AC
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_6588D350
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_6588D130
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_658924AC
		mov	[esp+2Ch+Func],	eax
		call	sub_6588D350
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_658924A8
		mov	[esp+2Ch+Func],	eax
		call	sub_6588D350
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_6588D360
		mov	ds:dword_658924AC, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_6588D360
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_658924A8, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588D130:				; CODE XREF: sub_6588D090+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_6588D090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_6588D150(_onexit_t)
sub_6588D150	proc near		; CODE XREF: sub_6588D940-27p
					; sub_6588E590+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_6588D090
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_6588D150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:6589501Co

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_6588D190
		cmp	eax, 3
		jz	short loc_6588D190
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_6588D190:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_6588DC60
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_65881040+12Ap
					; DATA XREF: .rdata:off_65891650o ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_6588D204
		cmp	dword_6588F14C,	2
		jz	short loc_6588D1E6
		mov	dword_6588F14C,	2

loc_6588D1E6:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_6588D2F3
		cmp	eax, 1
		jz	loc_6588D292

loc_6588D1F8:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_6588D204:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_658924C0, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_6588D323
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_658924BC, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_658924B8, eax
		jz	loc_6588D323
		mov	ecx, ds:dword_658924BC
		test	ecx, ecx
		jz	short loc_6588D2B3
		test	eax, eax
		jz	short loc_6588D2B3
		mov	dword_6588F14C,	1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_6588D292:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_6588DC60
		jmp	loc_6588D1F8
; ---------------------------------------------------------------------------

loc_6588D2B3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_658924B8, 0
		mov	ds:dword_658924BC, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_6588D2D3:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_6588F14C,	0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_6588D2F3:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_65895028
		cmp	ebx, offset dword_65895028
		jz	loc_6588D1F8

loc_6588D304:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_6588D30C
		call	eax

loc_6588D30C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_65895028
		jnz	short loc_6588D304
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_6588D323:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_658924B8, 0
		mov	ds:dword_658924BC, 0
		jmp	short loc_6588D2D3
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588D350	proc near		; CODE XREF: sub_65881040+14Bp
					; sub_65881040+15Ep ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_6588D350	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588D360	proc near		; CODE XREF: sub_65881000+15p
					; sub_6588D090+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_6588D360	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_6588D370(char	*Format, char ArgList)
sub_6588D370	proc near		; CODE XREF: sub_6588D3D0+1DDp
					; sub_6588D3D0+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_6588D370	endp

; ---------------------------------------------------------------------------
		jmp	short sub_6588D3D0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_6588D3D0(size_t Size)
sub_6588D3D0	proc near		; CODE XREF: .text:6588D3C1j
					; sub_6588D610+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_65892124
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_6588D5B2
		mov	eax, ds:dword_65892120
		xor	esi, esi

loc_6588D3F4:				; CODE XREF: sub_6588D3D0+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_6588D409
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_6588D4E0

loc_6588D409:				; CODE XREF: sub_6588D3D0+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_6588D3F4

loc_6588D413:				; CODE XREF: sub_6588D3D0+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_6588DE10
		test	eax, eax
		mov	edi, eax
		jz	loc_6588D5D9
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_65892120
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_6588DEF0
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_65892120
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_6588D5B9
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_6588D561

loc_6588D48F:				; CODE XREF: sub_6588D3D0+194j
					; sub_6588D3D0+1C6j
		add	ds:dword_65892124, 1

loc_6588D496:				; CODE XREF: sub_6588D3D0+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_6588D5E9
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_6588D4E8

loc_6588D4BF:				; CODE XREF: sub_6588D3D0+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_6588D4D3:				; CODE XREF: sub_6588D3D0+162j
					; sub_6588D3D0+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588D4E0:				; CODE XREF: sub_6588D3D0+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_6588D496
; ---------------------------------------------------------------------------

loc_6588D4E8:				; CODE XREF: sub_6588D3D0+EDj
		cmp	eax, 40h
		jz	short loc_6588D4BF
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_6588D4D3
		cmp	eax, 4
		jz	short loc_6588D4D3
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_6588D561:				; CODE XREF: sub_6588D3D0+B9j
		cmp	eax, 40h
		jz	loc_6588D48F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_65892120
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_6588D48F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_6588D370
; ---------------------------------------------------------------------------

loc_6588D5B2:				; CODE XREF: sub_6588D3D0+17j
		xor	esi, esi
		jmp	loc_6588D413
; ---------------------------------------------------------------------------

loc_6588D5B9:				; CODE XREF: sub_6588D3D0+ACj
		mov	eax, ds:dword_65892120
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_6588D370
; ---------------------------------------------------------------------------

loc_6588D5D9:				; CODE XREF: sub_6588D3D0+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_6588D370
; ---------------------------------------------------------------------------

loc_6588D5E9:				; CODE XREF: sub_6588D3D0+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_6588D370
sub_6588D3D0	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588D610	proc near		; CODE XREF: sub_65881260+32p
					; sub_65881260:loc_65881314p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_6589211C
		test	eax, eax
		jz	short loc_6588D630

loc_6588D622:				; CODE XREF: sub_6588D610+66j
					; sub_6588D610+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588D630:				; CODE XREF: sub_6588D610+10j
		mov	ds:dword_6589211C, 1
		call	sub_6588DE50
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_6588E0C0
		mov	ds:dword_65892124, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_65892120, eax
		mov	eax, offset dword_658917CC
		sub	eax, offset dword_658917CC
		cmp	eax, 7
		jle	short loc_6588D622
		cmp	eax, 0Bh
		mov	ebx, offset dword_658917CC
		jle	loc_6588D770
		mov	eax, ds:dword_658917CC
		test	eax, eax
		jnz	short loc_6588D6A0
		mov	eax, ds:dword_658917D0
		test	eax, eax
		jz	loc_6588D75C
		lea	esi, [esi+0]

loc_6588D6A0:				; CODE XREF: sub_6588D610+7Dj
					; sub_6588D610+164j ...
		cmp	ebx, offset dword_658917CC
		jnb	loc_6588D622
		mov	esi, 65880000h

loc_6588D6B1:				; CODE XREF: sub_6588D610+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_6588D3D0
		cmp	ebx, offset dword_658917CC
		jb	short loc_6588D6B1

loc_6588D6D5:				; CODE XREF: sub_6588D610+24Bj
		mov	ecx, ds:dword_65892124
		test	ecx, ecx
		jle	loc_6588D622
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_6588D702
; ---------------------------------------------------------------------------
		align 10h

loc_6588D6F0:				; CODE XREF: sub_6588D610+FDj
					; sub_6588D610+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_65892124
		jge	loc_6588D622

loc_6588D702:				; CODE XREF: sub_6588D610+DDj
		mov	eax, ds:dword_65892120
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_6588D6F0
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_6588D882
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_65892120
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_6588D6F0
; ---------------------------------------------------------------------------

loc_6588D75C:				; CODE XREF: sub_6588D610+86j
		mov	eax, ds:dword_658917D4
		test	eax, eax
		jnz	short loc_6588D785
		mov	ebx, offset dword_658917D8
		lea	esi, [esi+0]

loc_6588D770:				; CODE XREF: sub_6588D610+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_6588D6A0
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_6588D6A0

loc_6588D785:				; CODE XREF: sub_6588D610+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_6588D8A5
		add	ebx, 0Ch
		cmp	ebx, offset dword_658917CC
		jnb	loc_6588D622

loc_6588D7A0:				; CODE XREF: sub_6588D610+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 65880000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+65880000h]
		jz	short loc_6588D7FA
		cmp	edx, 20h
		jz	short loc_6588D830
		cmp	edx, 8
		jz	short loc_6588D7DA
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_6588D370
; ---------------------------------------------------------------------------

loc_6588D7DA:				; CODE XREF: sub_6588D610+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_6588D805
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 65880000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_6588D821
; ---------------------------------------------------------------------------

loc_6588D7FA:				; CODE XREF: sub_6588D610+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_6588D860

loc_6588D805:				; CODE XREF: sub_6588D610+1D3j
		sub	edi, ecx
		sub	edi, 65880000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_6588D873
		cmp	edx, 20h
		jz	short loc_6588D83F
		cmp	edx, 8
		jnz	short loc_6588D84C

loc_6588D821:				; CODE XREF: sub_6588D610+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_6588D3D0
		jmp	short loc_6588D84C
; ---------------------------------------------------------------------------

loc_6588D830:				; CODE XREF: sub_6588D610+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 65880000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_6588D83F:				; CODE XREF: sub_6588D610+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_6588D3D0

loc_6588D84C:				; CODE XREF: sub_6588D610+20Fj
					; sub_6588D610+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_658917CC
		jb	loc_6588D7A0
		jmp	loc_6588D6D5
; ---------------------------------------------------------------------------

loc_6588D860:				; CODE XREF: sub_6588D610+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 65880000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_6588D873:				; CODE XREF: sub_6588D610+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_6588D3D0
		jmp	short loc_6588D84C
; ---------------------------------------------------------------------------

loc_6588D882:				; CODE XREF: sub_6588D610+11Bj
		add	ebx, ds:dword_65892120
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_6588D370
; ---------------------------------------------------------------------------

loc_6588D8A5:				; CODE XREF: sub_6588D610+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_6588D370
sub_6588D610	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_6588D8C0()
sub_6588D8C0	proc near		; DATA XREF: sub_6588D940:loc_6588D912o
		sub	esp, 0Ch
		mov	eax, off_6588F148
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_6588D8E7
		xchg	ax, ax

loc_6588D8D0:				; CODE XREF: sub_6588D8C0+25j
		call	eax
		mov	eax, off_6588F148
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_6588F148, edx
		test	eax, eax
		jnz	short loc_6588D8D0

loc_6588D8E7:				; CODE XREF: sub_6588D8C0+Cj
		add	esp, 0Ch
		retn
sub_6588D8C0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_6588D940

loc_6588D8F0:				; CODE XREF: sub_6588D940+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_6588E5B0
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_6588D923

loc_6588D8FF:				; CODE XREF: sub_6588D940-9j
		test	ebx, ebx
		jz	short loc_6588D912

loc_6588D903:				; CODE XREF: sub_6588D940-30j
		call	ds:dword_6588E5B0[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_6588D903

loc_6588D912:				; CODE XREF: sub_6588D940-3Fj
		mov	[esp+1Ch+var_1C], offset sub_6588D8C0 ;	_onexit_t
		call	sub_6588D150
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_6588D923:				; CODE XREF: sub_6588D940-43j
		xor	ebx, ebx
		jmp	short loc_6588D929
; ---------------------------------------------------------------------------

loc_6588D927:				; CODE XREF: sub_6588D940-Bj
		mov	ebx, eax

loc_6588D929:				; CODE XREF: sub_6588D940-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_6588E5B0[eax*4]
		test	edx, edx
		jnz	short loc_6588D927
		jmp	short loc_6588D8FF
; END OF FUNCTION CHUNK	FOR sub_6588D940
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588D940	proc near		; CODE XREF: sub_65881260+195p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 6588D8F0 SIZE 00000049 BYTES

		mov	ecx, ds:dword_65892128
		test	ecx, ecx
		jz	short loc_6588D950
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588D950:				; CODE XREF: sub_6588D940+8j
		mov	ds:dword_65892128, 1
		jmp	short loc_6588D8F0
sub_6588D940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588D960	proc near		; CODE XREF: DllEntryPoint+34p

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_6588F150
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_6588D9B0
		not	eax
		mov	dword_6588F154,	eax

loc_6588D996:				; CODE XREF: sub_6588D960+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588D9B0:				; CODE XREF: sub_6588D960+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_6588DA22

loc_6588DA12:				; CODE XREF: sub_6588D960+CCj
		mov	dword_6588F150,	ebp
		mov	dword_6588F154,	eax
		jmp	loc_6588D996
; ---------------------------------------------------------------------------

loc_6588DA22:				; CODE XREF: sub_6588D960+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_6588DA12
sub_6588D960	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_65892204, edx
		mov	ds:dword_65892420, 0C0000409h
		mov	ds:dword_65892424, 1
		mov	ds:dword_658921F8, eax
		mov	ds:dword_6589242C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_658921EC, eax
		mov	eax, dword_6588F150
		mov	[ebp-10h], eax
		mov	eax, dword_6588F154
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_6589174C
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588DAC0	proc near		; CODE XREF: sub_6588DC60+79p
					; sub_6588DC60:loc_6588DCF2p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset stru_65892484 ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_6589249C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_6588DB15
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_6588DAF0:				; CODE XREF: sub_6588DAC0+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_6588DB0E
		test	esi, esi
		jz	short loc_6588DB0E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_6588DB0E:				; CODE XREF: sub_6588DAC0+40j
					; sub_6588DAC0+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_6588DAF0

loc_6588DB15:				; CODE XREF: sub_6588DAC0+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset stru_65892484 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_6588DAC0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_65892480
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_6588DB54

loc_6588DB46:				; CODE XREF: .text:6588DBBCj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_6588DB54:				; CODE XREF: .text:6588DB44j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_6588DBB7
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	stru_65892484
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_6589249C
		mov	ds:dword_6589249C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	stru_65892484
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_6588DBB7:				; CODE XREF: .text:6588DB6Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_6588DB46
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_65892480
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_6588DBD8
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_6588DBD8:				; CODE XREF: .text:6588DBCFj
		mov	dword ptr [esp], offset	stru_65892484
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_6589249C
		sub	esp, 4
		test	edx, edx
		jz	short loc_6588DC0F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_6588DC08
		jmp	short loc_6588DC46
; ---------------------------------------------------------------------------
		align 10h

loc_6588DC00:				; CODE XREF: .text:6588DC0Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_6588DC26
		mov	edx, eax

loc_6588DC08:				; CODE XREF: .text:6588DBF6j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_6588DC00

loc_6588DC0F:				; CODE XREF: .text:6588DBF0j
		mov	dword ptr [esp], offset	stru_65892484
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_6588DC1F:				; CODE XREF: .text:6588DC44j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_6588DC26:				; CODE XREF: .text:6588DC04j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_6588DC2C:				; CODE XREF: .text:6588DC50j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	stru_65892484
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_6588DC1F
; ---------------------------------------------------------------------------

loc_6588DC46:				; CODE XREF: .text:6588DBF8j
		mov	eax, [edx+8]
		mov	ds:dword_6589249C, eax
		mov	eax, edx
		jmp	short loc_6588DC2C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588DC60	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_6588DCB0
		jb	short loc_6588DC80
		cmp	eax, 3
		jz	short loc_6588DCD0

loc_6588DC73:				; CODE XREF: sub_6588DC60+31j
					; sub_6588DC60+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588DC80:				; CODE XREF: sub_6588DC60+Cj
		mov	eax, ds:dword_65892480
		test	eax, eax
		jnz	short loc_6588DCF2

loc_6588DC89:				; CODE XREF: sub_6588DC60+97j
		mov	eax, ds:dword_65892480
		cmp	eax, 1
		jnz	short loc_6588DC73
		mov	ds:dword_65892480, 0
		mov	[esp+1Ch+lpCriticalSection], offset stru_65892484 ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_6588DC73
; ---------------------------------------------------------------------------
		align 10h

loc_6588DCB0:				; CODE XREF: sub_6588DC60+Aj
		mov	eax, ds:dword_65892480
		test	eax, eax
		jz	short loc_6588DCE0

loc_6588DCB9:				; CODE XREF: sub_6588DC60+90j
		mov	ds:dword_65892480, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588DCD0:				; CODE XREF: sub_6588DC60+11j
		mov	eax, ds:dword_65892480
		test	eax, eax
		jz	short loc_6588DC73
		call	sub_6588DAC0
		jmp	short loc_6588DC73
; ---------------------------------------------------------------------------

loc_6588DCE0:				; CODE XREF: sub_6588DC60+57j
		mov	[esp+1Ch+lpCriticalSection], offset stru_65892484 ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_6588DCB9
; ---------------------------------------------------------------------------

loc_6588DCF2:				; CODE XREF: sub_6588DC60+27j
		call	sub_6588DAC0
		jmp	short loc_6588DC89
sub_6588DC60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588DD00	proc near		; CODE XREF: .text:6588DDA1p
					; sub_6588DE10+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_6588DD10

locret_6588DD0D:			; CODE XREF: sub_6588DD00+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588DD10:				; CODE XREF: sub_6588DD00+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_6588DD0D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_6588DD00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588DD30	proc near		; CODE XREF: sub_6588DE10+2Bp
					; .text:6588DF54p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_6588DD6E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_6588DD54:				; CODE XREF: sub_6588DD30+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_6588DD62
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_6588DD6E

loc_6588DD62:				; CODE XREF: sub_6588DD30+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_6588DD54
		xor	eax, eax

loc_6588DD6E:				; CODE XREF: sub_6588DD30+19j
					; sub_6588DD30+30j
		pop	ebx
		pop	esi
		retn
sub_6588DD30	endp

; ---------------------------------------------------------------------------
		jmp	short loc_6588DD80
; ---------------------------------------------------------------------------
		align 10h

loc_6588DD80:				; CODE XREF: .text:6588DD71j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_6588DDF3
		mov	dword ptr [esp], 65880000h
		call	sub_6588DD00
		test	eax, eax
		jz	short loc_6588DDF3
		mov	eax, ds:6588003Ch
		movzx	ebp, word ptr [eax+65880006h]
		movzx	edx, word ptr [eax+65880014h]
		add	eax, 65880000h
		test	ebp, ebp
		jz	short loc_6588DDF3
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_6588DDDB
; ---------------------------------------------------------------------------

loc_6588DDD1:				; CODE XREF: .text:6588DDF1j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_6588DE00

loc_6588DDDB:				; CODE XREF: .text:6588DDCFj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_6588DDD1

loc_6588DDF3:				; CODE XREF: .text:6588DD98j
					; .text:6588DDA8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588DE00:				; CODE XREF: .text:6588DDD9j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588DE10	proc near		; CODE XREF: sub_6588D3D0+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 65880000h
		call	sub_6588DD00
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_6588DE40
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 65880000h
		sub	eax, 65880000h
		mov	[esp+8+var_4], eax
		call	sub_6588DD30

loc_6588DE40:				; CODE XREF: sub_6588DE10+15j
		add	esp, 8
		retn
sub_6588DE10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588DE50	proc near		; CODE XREF: sub_6588D610+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 65880000h
		call	sub_6588DD00
		xor	edx, edx
		test	eax, eax
		jz	short loc_6588DE71
		mov	eax, ds:6588003Ch
		movzx	edx, word ptr [eax+65880006h]

loc_6588DE71:				; CODE XREF: sub_6588DE50+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_6588DE50	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 65880000h
		mov	ebx, [esp+10h]
		call	sub_6588DD00
		xor	edx, edx
		test	eax, eax
		jz	short loc_6588DED9
		mov	eax, ds:6588003Ch
		movzx	ecx, word ptr [eax+65880006h]
		movzx	esi, word ptr [eax+65880014h]
		add	eax, 65880000h
		test	ecx, ecx
		jz	short loc_6588DED9
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_6588DEC0:				; CODE XREF: .text:6588DED5j
		test	byte ptr [edx+27h], 20h
		jz	short loc_6588DECD
		test	ebx, ebx
		jz	short loc_6588DED9
		sub	ebx, 1

loc_6588DECD:				; CODE XREF: .text:6588DEC4j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_6588DEC0
		xor	edx, edx

loc_6588DED9:				; CODE XREF: .text:6588DE99j
					; .text:6588DEB5j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_6588DEF0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588DEF0	proc near		; CODE XREF: sub_6588D3D0+70p
					; .text:6588DEE1j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 65880000h
		call	sub_6588DD00
		xor	edx, edx
		test	eax, eax
		mov	eax, 65880000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_6588DEF0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_6588DF20
; ---------------------------------------------------------------------------
		align 10h

loc_6588DF20:				; CODE XREF: .text:6588DF11j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 65880000h
		call	sub_6588DD00
		test	eax, eax
		jnz	short loc_6588DF40

loc_6588DF36:				; CODE XREF: .text:6588DF5Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588DF40:				; CODE XREF: .text:6588DF34j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 65880000h
		sub	eax, 65880000h
		mov	[esp+4], eax
		call	sub_6588DD30
		test	eax, eax
		jz	short loc_6588DF36
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588DF70	proc near		; CODE XREF: .text:6588E01Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 65880000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_6588DD00
		test	eax, eax
		jz	short loc_6588DFE1
		mov	eax, ds:6588003Ch
		mov	esi, [eax+65880080h]
		test	esi, esi
		jz	short loc_6588DFE1
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 65880000h
		call	sub_6588DD30
		test	eax, eax
		jz	short loc_6588DFE1
		add	esi, 65880000h
		jnz	short loc_6588DFC6
		jmp	short loc_6588DFE1
; ---------------------------------------------------------------------------
		align 10h

loc_6588DFC0:				; CODE XREF: sub_6588DF70+66j
		sub	ebx, 1
		add	esi, 14h

loc_6588DFC6:				; CODE XREF: sub_6588DF70+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_6588DFD4
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_6588DFF0

loc_6588DFD4:				; CODE XREF: sub_6588DF70+5Bj
		test	ebx, ebx
		jg	short loc_6588DFC0
		mov	edi, [esi+0Ch]
		add	edi, 65880000h

loc_6588DFE1:				; CODE XREF: sub_6588DF70+1Aj
					; sub_6588DF70+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_6588DFF0:				; CODE XREF: sub_6588DF70+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_6588DF70	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_658924A4
		test	eax, eax
		jz	short loc_6588E012

loc_6588E00D:				; CODE XREF: .text:6588E097j
					; .text:6588E0B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_6588E012:				; CODE XREF: .text:6588E00Bj
		xor	eax, eax

loc_6588E014:				; CODE XREF: .text:6588E082j
		mov	[esp], eax
		lea	ebx, [eax+1]
		call	sub_6588DF70
		test	eax, eax
		jz	short loc_6588E0A0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_6588E030
		cmp	dl, 6Dh
		jnz	short loc_6588E080

loc_6588E030:				; CODE XREF: .text:6588E029j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_6588E03E
		cmp	dl, 73h
		jnz	short loc_6588E080

loc_6588E03E:				; CODE XREF: .text:6588E037j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_6588E04C
		cmp	dl, 76h
		jnz	short loc_6588E080

loc_6588E04C:				; CODE XREF: .text:6588E045j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_6588E05A
		cmp	dl, 63h
		jnz	short loc_6588E080

loc_6588E05A:				; CODE XREF: .text:6588E053j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_6588E068
		cmp	dl, 72h
		jnz	short loc_6588E080

loc_6588E068:				; CODE XREF: .text:6588E061j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_6588E084
		cmp	dl, 74h
		jz	short loc_6588E084
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_6588E084
		xchg	ax, ax

loc_6588E080:				; CODE XREF: .text:6588E02Ej
					; .text:6588E03Cj ...
		mov	eax, ebx
		jmp	short loc_6588E014
; ---------------------------------------------------------------------------

loc_6588E084:				; CODE XREF: .text:6588E06Fj
					; .text:6588E074j ...
		mov	[esp], eax
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_658924A4, eax
		jnz	loc_6588E00D
		lea	esi, [esi+0]

loc_6588E0A0:				; CODE XREF: .text:6588E021j
		mov	dword ptr [esp], offset	aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_658924A4, eax
		jmp	loc_6588E00D
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588E0C0	proc near		; CODE XREF: sub_6588D610+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_6588E0E2

loc_6588E0CD:				; CODE XREF: sub_6588E0C0+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_6588E0CD

loc_6588E0E2:				; CODE XREF: sub_6588E0C0+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_6588E0C0	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_6588E120
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588E120	proc near		; CODE XREF: sub_65881040+53p
					; sub_65881040+C8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_6588E120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588E140	proc near		; CODE XREF: sub_65881260+46p
					; sub_65881260+CCp ...
		mov	eax, 1
		retn	0Ch
sub_6588E140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_6588E150	proc near		; CODE XREF: sub_65881260+8Bp
					; sub_65881260+10Dp ...
		mov	eax, 1
		retn	0Ch
sub_6588E150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_6588E160	proc near		; CODE XREF: sub_6588E340+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_6588E1AC
		jmp	short loc_6588E1B4
; ---------------------------------------------------------------------------
		align 10h

loc_6588E1A0:				; CODE XREF: sub_6588E160+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_6588E1B4

loc_6588E1AC:				; CODE XREF: sub_6588E160+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_6588E1A0

loc_6588E1B4:				; CODE XREF: sub_6588E160+39j
					; sub_6588E160+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_6588E1DC
		jmp	short loc_6588E1E4
; ---------------------------------------------------------------------------
		align 10h

loc_6588E1D0:				; CODE XREF: sub_6588E160+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_6588E1E4

loc_6588E1DC:				; CODE XREF: sub_6588E160+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_6588E1D0

loc_6588E1E4:				; CODE XREF: sub_6588E160+6Aj
					; sub_6588E160+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_6588E2A0
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_6588E2CE

loc_6588E203:				; CODE XREF: sub_6588E160+168j
					; sub_6588E160+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_6588E2E0

loc_6588E233:				; CODE XREF: sub_6588E160+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_65892118
		test	eax, eax
		jz	loc_6588E319
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_6588E301
		cmp	eax, 5
		jnz	short loc_6588E2FC
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_6588E2A0:				; CODE XREF: sub_6588E160+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_6588E203

loc_6588E2CE:				; CODE XREF: sub_6588E160+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_6588E203
; ---------------------------------------------------------------------------
		align 10h

loc_6588E2E0:				; CODE XREF: sub_6588E160+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_6588E233
; ---------------------------------------------------------------------------

loc_6588E2FC:				; CODE XREF: sub_6588E160+133j
		call	abort
; ---------------------------------------------------------------------------

loc_6588E301:				; CODE XREF: sub_6588E160+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_6588E319:				; CODE XREF: sub_6588E160+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_2 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_6588E160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_6588E340(char	*, char	*, int)
sub_6588E340	proc near		; CODE XREF: sub_6588412E+E0p
					; sub_6588412E+26Ep

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_6588E3A6
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_6588E390:				; CODE XREF: sub_6588E340+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_6588E390
		add	edx, edx

loc_6588E3A6:				; CODE XREF: sub_6588E340+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_6588E3CD
		xor	edi, edi

loc_6588E3B7:				; CODE XREF: sub_6588E340+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_6588E3B7
		add	edx, edx

loc_6588E3CD:				; CODE XREF: sub_6588E340+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_6588E160
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_6588E340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_6588E410(char	*, size_t, char	*, char)
sub_6588E410	proc near		; CODE XREF: sub_6588412E+196p
					; sub_65885614+13Fp ...

DstBuf		= dword	ptr -1Ch
MaxCount	= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 1Ch
		lea	eax, [esp+1Ch+arg_C]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+Format], eax ;	Format
		mov	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+MaxCount], eax	; MaxCount
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+DstBuf], eax ;	DstBuf
		call	_vsnprintf
		add	esp, 1Ch
		retn
sub_6588E410	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcspn]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sscanf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _vsnprintf]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_6588E590	proc near		; DATA XREF: .text:6588E5B4o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_65881460
		mov	[esp+18h+var_18], offset sub_658814B0 ;	_onexit_t
		call	sub_6588D150
		leave
		retn
sub_6588E590	endp

; ---------------------------------------------------------------------------
		align 10h
dword_6588E5B0	dd 0FFFFFFFFh		; DATA XREF: sub_6588D940-4Cr
					; sub_6588D940:loc_6588D903r ...
		dd offset sub_6588E590
		dd 0
		dd 0FFFFFFFFh
dword_6588E5C0	dd 10h dup(0)		; DATA XREF: .data:off_6588F148o
		dd 280h	dup(?)
_text		ends

; Section 2. (virtual address 0000F000)
; Virtual size			: 0000015C (	348.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000DA00
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 6588F000h
dword_6588F000	dd 20h			; DATA XREF: assuan_set_gpg_err_source+6w
					; assuan_get_gpg_err_source+3r	...
off_6588F004	dd offset malloc	; DATA XREF: assuan_set_malloc_hooks+8w
					; assuan_get_malloc_hooks+3o ...
off_6588F008	dd offset realloc	; DATA XREF: assuan_set_malloc_hooks+11w
off_6588F00C	dd offset free		; DATA XREF: assuan_set_malloc_hooks+1Aw
off_6588F010	dd offset sub_65889BCB	; DATA XREF: assuan_set_log_cb+9w
					; assuan_get_log_cb+3r	...
a0123456789abcd	db '0123456789abcdef',0 ; DATA XREF: sub_65883230+2Ao
		align 20h
off_6588F040	dd offset aNop		; DATA XREF: assuan_register_command+5Fo
					; assuan_register_command+9Eo ...
					; "NOP"
		dd offset sub_65884FD3
		dd offset aNopNoOperation ; "NOP\n\nNo operation.  Returns OK withou"...
		dd 1
		dd offset aCancel	; "CANCEL"
		dd offset sub_65885002
		dd offset aCancelRunTheSe ; "CANCEL\n\nRun the server's cancel handl"...
		dd 1
		dd offset aOption	; "OPTION"
		dd offset sub_658850A1
		dd offset aOptionNameValu ; "OPTION <NAME> [ [=] <VALUE> ]\n\nSet op"...
		dd 1
		dd offset aBye_0	; "BYE"
		dd offset sub_658854A1
		dd offset aByeCloseTheCon ; "BYE\n\nClose the connection.  The serve"...
		dd 1
		dd offset aAuth		; "AUTH"
		dd offset sub_65885518
		dd offset aAuthReservedFo ; "AUTH\n\nReserved for future extensions."
		dd 1
		dd offset aReset	; "RESET"
		dd offset sub_65885592
		dd offset aResetResetTheC ; "RESET\n\nReset the	connection but not a"...
		dd 1
		dd offset aEnd_1	; "END"
		dd offset sub_65885A24
		dd offset aEndUsedByAClie ; "END\n\nUsed by a client to	mark the end"...
		dd 1
		dd offset aHelp		; "HELP"
		dd offset sub_65885614
		dd offset aHelpCommandLis ; "HELP [<COMMAND>]\n\nLists all commands "...
		dd 1
		dd offset aInput	; "INPUT"
		dd offset sub_65885CA8
		dd offset aInputFdNUsedBy ; "INPUT FD[=<N>]\n\nUsed by a client	to p"...
		align 10h
		dd offset aOutput	; "OUTPUT"
		dd offset sub_65885D85
		dd offset aOutputFdNUsedB ; "OUTPUT FD[=<N>]\n\nUsed by	a client to "...
		align 40h
dword_6588F100	dd 2			; DATA XREF: assuan_set_system_hooks+Do
					; assuan_new_ext+251r ...
off_6588F104	dd offset __assuan_usleep ; DATA XREF: assuan_new_ext+25Dr
off_6588F108	dd offset __assuan_pipe	; DATA XREF: assuan_new_ext+269r
off_6588F10C	dd offset __assuan_close ; DATA	XREF: assuan_new_ext+275r
off_6588F110	dd offset __assuan_read	; DATA XREF: assuan_new_ext+281r
off_6588F114	dd offset __assuan_write ; DATA	XREF: assuan_new_ext+28Dr
off_6588F118	dd offset __assuan_recvmsg ; DATA XREF:	assuan_new_ext+299r
off_6588F11C	dd offset __assuan_sendmsg ; DATA XREF:	assuan_new_ext+2A5r
off_6588F120	dd offset __assuan_spawn ; DATA	XREF: assuan_new_ext+2B1r
off_6588F124	dd offset __assuan_waitpid ; DATA XREF:	assuan_new_ext+2BDr
off_6588F128	dd offset __assuan_socketpair ;	DATA XREF: assuan_new_ext+2C9r
off_6588F12C	dd offset __assuan_socket ; DATA XREF: assuan_new_ext+2D5r
off_6588F130	dd offset __assuan_connect ; DATA XREF:	assuan_new_ext+2E1r
		align 10h
		dd 0FFFFFFFFh
dword_6588F144	dd 0FFFFFFFFh		; DATA XREF: sub_65881260+1Bw
					; sub_65881260+5Fw
off_6588F148	dd offset dword_6588E5C0 ; DATA	XREF: sub_6588D8C0+3r
					; sub_6588D8C0+12r ...
dword_6588F14C	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_6588F150	dd 0BB40E64Eh		; DATA XREF: sub_6588D960+3r
					; sub_6588D960:loc_6588DA12w ...
dword_6588F154	dd 44BF19B1h		; DATA XREF: sub_6588D960+31w
					; sub_6588D960+B8w ...
dword_6588F158	dd 0			; DATA XREF: sub_65881460+6r
					; sub_65881460+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00010000)
; Virtual size			: 000017CC (   6092.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 0000DC00
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 65890000h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_65881460+Fo
; CHAR ProcName[]
ProcName	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_65881460+28o
		align 4
aAssuan_new_ext	db 'assuan_new_ext',0   ; DATA XREF: assuan_new_ext+6Co
aR_ctx		db 'r_ctx',0            ; DATA XREF: assuan_new_ext+73o
		align 4
aSSPEnterErr_so	db '%s (%s=%p): enter: err_source = %i (%s), malloc_hooks = %p (%p, %'
					; DATA XREF: assuan_new_ext+E0o
		db 'p, %p), log_cb = %p, log_cb_data = %p',0Ah,0
aSSPLeave	db '%s (%s=%p): leave',0Ah,0 ; DATA XREF: assuan_new_ext+144o
byte_658900B7	db 0			; DATA XREF: assuan_new_ext:loc_6588171Eo
aSSPErrorSS	db '%s (%s=%p): error: %s <%s>',0Ah,0 ; DATA XREF: assuan_new_ext+1ABo
aSSPLeaveCtxP	db '%s (%s=%p): leave: ctx=%p',0Ah,0 ; DATA XREF: assuan_new_ext+355o
aCtx		db 'ctx',0              ; DATA XREF: assuan_release+17o
aAssuan_release	db 'assuan_release',0   ; DATA XREF: assuan_release+1Fo
aSSPCall	db '%s (%s=%p): call',0Ah,0 ; DATA XREF: assuan_release+27o
a2_4_2		db '2.4.2',0            ; DATA XREF: assuan_check_version+Do
		align 4
aCtx_0		db 'ctx',0              ; DATA XREF: assuan_set_pointer+14o
					; assuan_set_flag+1Bo ...
aAssuan_set_poi	db 'assuan_set_pointer',0 ; DATA XREF: assuan_set_pointer+1Co
		align 4
aSSPCallUser_po	db '%s (%s=%p): call: user_pointer=%p',0Ah,0
					; DATA XREF: assuan_set_pointer+24o
aAssuan_set_fla	db 'assuan_set_flag',0  ; DATA XREF: assuan_set_flag+23o
		align 4
aSSPCallFlagIVa	db '%s (%s=%p): call: flag=%i,value=%i',0Ah,0
					; DATA XREF: assuan_set_flag+2Bo
off_6589018C	dd offset locret_65881E66 ; DATA XREF: assuan_set_flag+60o
		dd offset loc_65881D87	; jump table for switch	statement
		dd offset loc_65881DAE
		dd offset loc_65881DD6
		dd offset loc_65881DFF
		dd offset loc_65881E28
		dd offset loc_65881E4F
aAssuan_get_fla	db 'assuan_get_flag',0  ; DATA XREF: assuan_get_flag+1Ao
aSSPEnterFlagI	db '%s (%s=%p): enter: flag=%i',0Ah,0 ; DATA XREF: assuan_get_flag+4Do
aSSPLeaveFlag_v	db '%s (%s=%p): leave: flag_value=%i',0Ah,0
					; DATA XREF: assuan_get_flag+137o
		align 4
off_658901F8	dd offset loc_65881F80	; DATA XREF: assuan_get_flag+84o
		dd offset loc_65881EF5	; jump table for switch	statement
		dd offset loc_65881F0A
		dd offset loc_65881F21
		dd offset loc_65881F39
		dd offset loc_65881F51
		dd offset loc_65881F69
aAssuan_set_sys	db 'assuan_set_system_hooks',0 ; DATA XREF: assuan_ctx_set_system_hooks+25o
aSSPCallSystem_	db '%s (%s=%p): call: system_hooks=%p (version %i)',0Ah,0
					; DATA XREF: assuan_ctx_set_system_hooks+2Do
aAssuan_set_io_	db 'assuan_set_io_monitor',0 ; DATA XREF: assuan_set_io_monitor+23o
		align 4
aSSPCallIo_moni	db '%s (%s=%p): call: io_monitor=%p,hook_data=%p',0Ah,0
					; DATA XREF: assuan_set_io_monitor+2Bo
aNone		db '(none)',0           ; DATA XREF: assuan_set_error:loc_658820E1o
aAssuan_set_err	db 'assuan_set_error',0 ; DATA XREF: assuan_set_error+52o
		align 4
aSSPCallErrISST	db '%s (%s=%p): call: err=%i (%s,%s),text=%s',0Ah,0
					; DATA XREF: assuan_set_error+5Ao
aAssuan_get_pid	db 'assuan_get_pid',0   ; DATA XREF: assuan_get_pid+2Fo
aSSPCallPidI	db '%s (%s=%p): call: pid=%i',0Ah,0 ; DATA XREF: assuan_get_pid+37o
aAssuan_get_pee	db 'assuan_get_peercred',0 ; DATA XREF: assuan_get_peercred+15o
aSSPCall_0	db '%s (%s=%p): call',0Ah,0 ; DATA XREF: assuan_get_peercred+1Do
		align 4
aCtx_1		db 'ctx',0              ; DATA XREF: sub_6588245A+14o
					; sub_658824B3+1Ao ...
a_assuan_usleep	db '_assuan_usleep',0   ; DATA XREF: sub_6588245A+1Co
aSSPCallUsecU	db '%s (%s=%p): call: usec=%u',0Ah,0 ; DATA XREF: sub_6588245A+24o
a_assuan_pipe	db '_assuan_pipe',0     ; DATA XREF: sub_658824B3+13o
aReading	db 'reading',0          ; DATA XREF: sub_658824B3+2Do
aWriting	db 'writing',0          ; DATA XREF: sub_658824B3:loc_658824E7o
		align 4
aSSPEnterInheri	db '%s (%s=%p): enter: inherit_idx=%i (Assuan uses it for %s)',0Ah,0
					; DATA XREF: sub_658824B3+5Co
aSSPLeaveResult	db '%s (%s=%p): leave: result=%i',0Ah,0 ; DATA XREF: sub_658824B3+C4o
					; sub_65882791+255o ...
aSSPErrorS	db '%s (%s=%p): error: %s',0Ah,0 ; DATA XREF: sub_658824B3+10Do
					; sub_65882791+298o ...
aSSPLeaveRead0x	db '%s (%s=%p): leave: read=0x%x, write=0x%x',0Ah,0
					; DATA XREF: sub_658824B3+156o
a_assuan_close	db '_assuan_close',0    ; DATA XREF: sub_65882627+1Co
aSSPCallFd0xX	db '%s (%s=%p): call: fd=0x%x',0Ah,0 ; DATA XREF: sub_65882627+24o
					; sub_65882680+24o
a_assuan_close_	db '_assuan_close_inheritable',0 ; DATA XREF: sub_65882680+1Co
a_assuan_spawn	db '_assuan_spawn',0    ; DATA XREF: sub_65882791+13o
aNull		db '(null)',0           ; DATA XREF: sub_65882791:loc_658827C3o
		align 4
aSSPEnterNameSF	db '%s (%s=%p): enter: name=%s,fd_in=0x%x,fd_out=0x%x,atfork=%p,atfor'
					; DATA XREF: sub_65882791+76o
		db 'kvalue=%p,flags=%i',0Ah,0
		align 10h
aSSPCheckArgv2i	db '%s (%s=%p): check: argv[%2i] = %s',0Ah,0 ; DATA XREF: sub_65882791+CAo
		align 4
aSSPCheckFd_chi	db '%s (%s=%p): check: fd_child_list[%2i] = 0x%x',0Ah,0
					; DATA XREF: sub_65882791+131o
		align 4
aSSPCheckPid0xX	db '%s (%s=%p): check: pid = 0x%x',0Ah,0 ; DATA XREF: sub_65882791+1D6o
		align 4
aSSPCheckPid0_0	db '%s (%s=%p): check: pid = 0x%x (%s)',0Ah,0 ; DATA XREF: sub_65882791+219o
a_assuan_socket	db '_assuan_socketpair',0 ; DATA XREF: .text:65882A8Do
		align 4
aSSPEnterNamesp	db '%s (%s=%p): enter: namespace=%i,style=%i,protocol=%i,filedes=%p',0Ah
					; DATA XREF: .text:65882AD5o
		db 0
		align 10h
aSSPCheckFilede	db '%s (%s=%p): check: filedes = { 0x%x, 0x%x }',0Ah,0
					; DATA XREF: .text:65882B4Fo
a_assuan_sock_0	db '_assuan_socket',0   ; DATA XREF: sub_65882BEA+13o
aSSPEnterName_0	db '%s (%s=%p): enter: namespace=%i,style=%i,protocol=%i',0Ah,0
					; DATA XREF: sub_65882BEA+54o
a_assuan_connec	db '_assuan_connect',0  ; DATA XREF: sub_65882D08+13o
		align 4
aSSPEnterSocket	db '%s (%s=%p): enter: socket=%i,addr=%p,length=%i',0Ah,0
					; DATA XREF: sub_65882D08+54o
aSS		db '%s%s',0             ; DATA XREF: .text:65882FE0o
aS		db '%s',0               ; DATA XREF: .text:6588304Do
off_6589067C	dd offset loc_6588332C	; DATA XREF: sub_6588327E+7Br
		dd offset loc_65883335	; jump table for switch	statement
		dd offset loc_6588330E
		dd offset loc_65883323
		dd offset loc_6588331A
		dd offset loc_65883302
		align 10h
aThisIsLibassua	db 0Ah			; DATA XREF: sub_658833E4+3o
		db 0Ah
		db 'This is Libassuan 2.4.2 - The GnuPG IPC Library',0Ah
		db 'Copyright 2001-2013 Free Software Foundation, Inc.',0Ah
		db 'Copyright 2001-2014 g10 Code GmbH',0Ah
		db 0Ah
		db '(e0516c5 <none>)',0Ah
		db 0Ah
		db 0Ah,0
		align 10h
; char aBye[]
aBye		db 'BYE',0              ; DATA XREF: sub_65883540+6o
; char aEnd[]
aEnd		db 'END',0              ; DATA XREF: assuan_transact+12Fo
; char a____Libassuan2[]
a____Libassuan2	db '../../libassuan-2.4.2/src/assuan-buffer.c',0
					; DATA XREF: sub_6588412E+D1o
					; sub_6588412E+25Fo
; char aAtticlenLinele[]
aAtticlenLinele	db 'atticlen < LINELENGTH',0 ; DATA XREF: sub_6588412E+D9o
; char aErrorS[]
aErrorS		db 'error: %s',0        ; DATA XREF: sub_6588412E+178o
; char aCtxInbound_eof[]
aCtxInbound_eof	db 'ctx->inbound.eof',0 ; DATA XREF: sub_6588412E+267o
aEof		db 'eof',0              ; DATA XREF: sub_6588412E+293o
aInvalidLine	db 'invalid line',0     ; DATA XREF: sub_6588412E+49Do
aSuppliedLineTo	db 'supplied line too long - truncated',0 ; DATA XREF: sub_658846B6+6Fo
asc_658907D7	db 0Ah,0		; DATA XREF: sub_658846B6+1ECo
		align 4
aSuppliedLineWi	db 'supplied line with LF - truncated',0 ; DATA XREF: assuan_write_line+97o
; char Format[]
Format		db '%%%02X',0           ; DATA XREF: sub_658849B7+97o
; char aCan[]
aCan		db 'CAN',0              ; DATA XREF: assuan_send_data+84o
aEnd_0		db 'END',0              ; DATA XREF: assuan_send_data:loc_65884DA2o
		align 10h
aServerDoesNotS	db 'server does not support sending and receiving of file descriptors'
					; DATA XREF: assuan_sendfd+62o
					; assuan_receivefd+41o
		db 0
		align 10h
aNoHandlerRegis	db 'no handler registered',0 ; DATA XREF: sub_65884F59+26o
					; sub_65884F59+61o
		align 10h
aNopNoOperation	db 'NOP',0Ah            ; DATA XREF: .data:6588F048o
		db 0Ah
		db 'No operation.  Returns OK without any action.',0
		align 10h
aCancelRunTheSe	db 'CANCEL',0Ah         ; DATA XREF: .data:6588F058o
		db 0Ah
		db 'Run the server',27h,'s cancel handler if one has been registered.',0
		align 20h
aOptionNameValu	db 'OPTION <NAME> [ [=] <VALUE> ]',0Ah ; DATA XREF: .data:6588F068o
		db 0Ah
		db 'Set option <NAME> to configure server operation.  Leading and',0Ah
		db 'trailing spaces around <NAME> and <VALUE> are allowed but should '
		db 'be',0Ah
		db 'ignored.  For compatibility reasons, <NAME> may be prefixed with '
		db 'two',0Ah
		db 'dashes.  The use of the equal sign is optional but suggested if',0Ah
		db '<VALUE> is given.',0
aArgumentRequir	db 'argument required',0 ; DATA XREF: sub_658850A1+51o
					; sub_658850A1+8Co
aNoOptionNameGi	db 'no option name given',0 ; DATA XREF: sub_658850A1+D2o
					; sub_658850A1+10Do
aOptionArgument	db 'option argument expected',0 ; DATA XREF: sub_658850A1+202o
					; sub_658850A1+23Do
aOptionShouldNo	db 'option should not begin with one dash',0 ; DATA XREF: sub_658850A1+311o
					; sub_658850A1+34Co
		align 10h
aByeCloseTheCon	db 'BYE',0Ah            ; DATA XREF: .data:6588F078o
		db 0Ah
		db 'Close the connection.  The server will reply with OK.',0
		align 10h
aAuthReservedFo	db 'AUTH',0Ah           ; DATA XREF: .data:6588F088o
		db 0Ah
		db 'Reserved for future extensions.',0
		align 20h
aResetResetTheC	db 'RESET',0Ah          ; DATA XREF: .data:6588F098o
		db 0Ah
		db 'Reset the connection but not any existing authentication.  The se'
		db 'rver',0Ah
		db 'should release all resources associated with the connection.',0
		align 20h
aHelpCommandLis	db 'HELP [<COMMAND>]',0Ah ; DATA XREF: .data:6588F0B8o
		db 0Ah
		db 'Lists all commands that the server understands as comment lines o'
		db 'n',0Ah
		db 'the status channel.  If <COMMAND> is given, list detailed help fo'
		db 'r',0Ah
		db 'that command.',0
; char asc_65890C86[4]
asc_65890C86	db ' ',9,0Ah,0          ; DATA XREF: sub_65885614+Ao
; char asc_65890C8A[2]
asc_65890C8A	db 0Ah,0		; DATA XREF: sub_65885614:loc_6588570Fo
					; sub_65885614:loc_6588597Ao
; char a_S[]
a_S		db '# %.*s',0           ; DATA XREF: sub_65885614+11Ao
					; sub_65885614+37Fo
; char aS_0[]
aS_0		db '# %s',0             ; DATA XREF: sub_65885614+15Fo
		align 10h
aEndUsedByAClie	db 'END',0Ah            ; DATA XREF: .data:6588F0A8o
		db 0Ah
		db 'Used by a client to mark the end of raw data.',0
; char Str2[3]
Str2		db 'FD',0               ; DATA XREF: assuan_command_parse_fd+Fo
; char aFd[3]
aFd		db 'fd',0               ; DATA XREF: assuan_command_parse_fd+2Eo
aFdNExpected	db 'FD[=<n>] expected',0 ; DATA XREF: assuan_command_parse_fd+8Co
aNumberRequired	db 'number required',0  ; DATA XREF: assuan_command_parse_fd+E5o
aFdSameAsInboun	db 'fd same as inbound fd',0 ; DATA XREF: assuan_command_parse_fd+194o
aFdSameAsOutbou	db 'fd same as outbound fd',0 ; DATA XREF: assuan_command_parse_fd+1D2o
		align 20h
aInputFdNUsedBy	db 'INPUT FD[=<N>]',0Ah ; DATA XREF: .data:6588F0C8o
		db 0Ah
		db 'Used by a client to pass an input file descriptor to the server.',0Ah
		db 'The server opens <N> as a local file descriptor.  Without <N>, th'
		db 'e',0Ah
		db 'server opens the file descriptor just sent by the client using',0Ah
		db 'assuan_sendfd.',0
		align 20h
aOutputFdNUsedB	db 'OUTPUT FD[=<N>]',0Ah ; DATA XREF: .data:6588F0D8o
		db 0Ah
		db 'Used by a client to pass an output file descriptor to the server.'
		db 0Ah
		db 'The server opens <N> as a local file descriptor.  Without <N>, th'
		db 'e',0Ah
		db 'server opens the file descriptor just sent by the client using',0Ah
		db 'assuan_sendfd.',0
aNop		db 'NOP',0              ; DATA XREF: .data:off_6588F040o
aCancel		db 'CANCEL',0           ; DATA XREF: .data:6588F050o
aOption		db 'OPTION',0           ; DATA XREF: .data:6588F060o
aBye_0		db 'BYE',0              ; DATA XREF: .data:6588F070o
aAuth		db 'AUTH',0             ; DATA XREF: .data:6588F080o
aReset		db 'RESET',0            ; DATA XREF: .data:6588F090o
aEnd_1		db 'END',0              ; DATA XREF: .data:6588F0A0o
aHelp		db 'HELP',0             ; DATA XREF: .data:6588F0B0o
aInput		db 'INPUT',0            ; DATA XREF: .data:6588F0C0o
aOutput		db 'OUTPUT',0           ; DATA XREF: .data:6588F0D0o
aLeadingWhiteSp	db 'leading white-space',0 ; DATA XREF: sub_65886440+D1o
					; sub_65886440+10Co
; char aOkClosingConne[]
aOkClosingConne	db 'OK closing connection',0 ; DATA XREF: assuan_process_done+F4o
aOk		db 'OK',0               ; DATA XREF: assuan_process_done:loc_658868C7o
aClosingConnect	db '[closing connection]',0 ; DATA XREF: assuan_process_done+183o
byte_65890F9D	db 0			; DATA XREF: assuan_process_done:loc_65886941o
					; assuan_process_done:loc_65886953o ...
asc_65890F9E	db ' - ',0              ; DATA XREF: assuan_process_done+1BAo
; char aErrD_50s_30sS_[]
aErrD_50s_30sS_	db 'ERR %d %.50s <%.30s>%s%.100s',0 ; DATA XREF: assuan_process_done+1D1o
aCtx_2		db 'ctx',0              ; DATA XREF: sub_65886A4D+12Co
aProcess_next	db 'process_next',0     ; DATA XREF: sub_65886A4D+134o
aSSPCallUnexpec	db '%s (%s=%p): call: unexpected client data',0Ah,0
					; DATA XREF: sub_65886A4D+13Co
aOk_0		db 'OK ',0              ; DATA XREF: assuan_set_okay_line:loc_65886EEBo
aS_1		db 'S ',0               ; DATA XREF: assuan_write_status+9Bo
					; assuan_write_status+15Eo
asc_65891001	db ' ',0                ; DATA XREF: assuan_write_status+D2o
					; assuan_write_status+18Fo
		align 20h
aOk_1		db 'OK ',0              ; DATA XREF: assuan_set_hello_line:loc_65887F3Co
					; assuan_accept+165o
asc_65891024	db '# ',0               ; DATA XREF: assuan_accept+F2o
; char aSProcessI[]
aSProcessI	db '%s, process %i',0   ; DATA XREF: assuan_accept+1B1o
; char aOkPleasedToMee[]
aOkPleasedToMee	db 'OK Pleased to meet you',0 ; DATA XREF: assuan_accept+1BDo
					; assuan_accept:loc_6588817Fo
		align 10h
aAssuan_init_pi	db 'assuan_init_pipe_server',0 ; DATA XREF: assuan_init_pipe_server+29o
aCtx_3		db 'ctx',0              ; DATA XREF: assuan_init_pipe_server+30o
aSSPEnter	db '%s (%s=%p): enter',0Ah,0 ; DATA XREF: assuan_init_pipe_server+55o
		align 10h
aSSPCheckFd00xX	db '%s (%s=%p): check: fd[0]=0x%x, fd[1]=0x%x',0Ah,0
					; DATA XREF: assuan_init_pipe_server+9Fo
aSSPLeave_0	db '%s (%s=%p): leave',0Ah,0 ; DATA XREF: assuan_init_pipe_server+ECo
					; assuan_init_pipe_server+2A0o
byte_658910BE	db 0			; DATA XREF: assuan_init_pipe_server:loc_6588840Do
aSSPErrorSS_0	db '%s (%s=%p): error: %s <%s>',0Ah,0
					; DATA XREF: assuan_init_pipe_server+151o
; char VarName[]
VarName		db '_assuan_pipe_connect_pid',0 ; DATA XREF: assuan_init_pipe_server+1EBo
aCtx_4		db 'ctx',0              ; DATA XREF: sub_65888600+19o
					; sub_658886D1+24o ...
aAccept_connect	db 'accept_connection_bottom',0 ; DATA XREF: sub_65888600+21o
aSSPCall_1	db '%s (%s=%p): call',0Ah,0 ; DATA XREF: sub_65888600+29o
aAccept_conne_0	db 'accept_connection',0 ; DATA XREF: sub_658886D1+2Co
					; sub_658886D1+ABo
		align 4
aSSPCallListen_	db '%s (%s=%p): call: listen_fd=0x%x',0Ah,0 ; DATA XREF: sub_658886D1+34o
aSSPCallFd0xX_0	db '%s (%s=%p): call: fd->0x%x',0Ah,0 ; DATA XREF: sub_658886D1+B3o
aAssuan_init_so	db 'assuan_init_socket_server',0 ; DATA XREF: assuan_init_socket_server+14o
aSSPEnterFd0xXF	db '%s (%s=%p): enter: fd=0x%x, flags=0x%x',0Ah,0
					; DATA XREF: assuan_init_socket_server+4Eo
aSSPLeave_1	db '%s (%s=%p): leave',0Ah,0 ; DATA XREF: assuan_init_socket_server+9Bo
					; assuan_init_socket_server+292o
byte_658911CB	db 0			; DATA XREF: assuan_init_socket_server:loc_658888D1o
					; assuan_init_socket_server:loc_65888AC8o
aSSPErrorSS_1	db '%s (%s=%p): error: %s <%s>',0Ah,0
					; DATA XREF: assuan_init_socket_server+100o
					; assuan_init_socket_server+2F7o
aCtx_5		db 'ctx',0              ; DATA XREF: sub_65888BC1+46o
					; sub_65888BC1+8Eo ...
aInitial_handsh	db 'initial_handshake',0 ; DATA XREF: sub_65888BC1+4Eo
					; sub_65888BC1+96o
		align 10h
aSSPCallCanTCon	db '%s (%s=%p): call: can',27h,'t connect server: %s',0Ah,0
					; DATA XREF: sub_65888BC1+56o
aSSPCallCanTC_0	db '%s (%s=%p): call: can',27h,'t connect server: `%s',27h,0Ah,0
					; DATA XREF: sub_65888BC1+9Eo
aNull_0		db '(null)',0           ; DATA XREF: assuan_pipe_connect:loc_65888F72o
aAssuan_pipe_co	db 'assuan_pipe_connect',0 ; DATA XREF: assuan_pipe_connect+30o
		align 4
aSSPCallNameSFl	db '%s (%s=%p): call: name=%s, flags=0x%x',0Ah,0
					; DATA XREF: assuan_pipe_connect+38o
		align 10h
aCtx_6		db 'ctx',0              ; DATA XREF: sub_65889107+CEo
					; sub_65889107+138o ...
aAssuan_socket_	db 'assuan_socket_connect',0 ; DATA XREF: sub_65889107+D6o
					; sub_65889107+140o ...
		align 4
aSSPCallCanTC_1	db '%s (%s=%p): call: can',27h,'t connect to server: %s',0Ah
					; DATA XREF: sub_65889107+DEo
		db 0Ah,0
aSSPCallCanTC_2	db '%s (%s=%p): call: can',27h,'t connect to server: %s',0Ah,0
					; DATA XREF: sub_65889107+148o
aNull_1		db '(null)',0           ; DATA XREF: assuan_socket_connect:loc_65889340o
		align 4
aSSPCallNameS_0	db '%s (%s=%p): call: name=%s, flags=0x%x',0Ah,0
					; DATA XREF: assuan_socket_connect+6Ao
aFile		db 'file://',0          ; DATA XREF: assuan_socket_connect+AEo
aAssuan		db 'assuan://',0        ; DATA XREF: assuan_socket_connect+ECo
		align 10h
aSSPCallCanTCre	db '%s (%s=%p): call: can',27h,'t create socket: %s',0Ah,0
					; DATA XREF: assuan_socket_connect+4D9o
		align 4
aSSPCallCanTC_3	db '%s (%s=%p): call: can',27h,'t connect to `%s',27h,': %s',0Ah
					; DATA XREF: assuan_socket_connect+554o
		db 0Ah,0
		align 4
; char aAssuan_full_lo[]
aAssuan_full_lo	db 'ASSUAN_FULL_LOGGING',0 ; DATA XREF: sub_65889AD0+6o
; char aAssuan_debug[]
aAssuan_debug	db 'ASSUAN_DEBUG',0     ; DATA XREF: sub_65889AD0+1Fo
; char aSU[]
aSU		db '%s[%u]: ',0         ; DATA XREF: sub_65889BCB+A4o
aConfidentialDa	db '[Confidential data not shown]',0 ; DATA XREF: sub_65889CFE+BEo
asc_65891404	db '->',0               ; DATA XREF: sub_65889CFE+D1o
					; sub_65889CFE+23Co ...
asc_65891407	db '<-',0               ; DATA XREF: sub_65889CFE:loc_65889DD6o
					; sub_65889CFE:loc_65889F41o ...
aChan_PSS	db 'chan_%p %s [%s]',0Ah,0 ; DATA XREF: sub_65889CFE+E6o
byte_6589141B	db 0			; DATA XREF: sub_65889CFE:loc_65889F29o
aChan_PS_S_S	db 'chan_%p %s %.*s%.*s',0Ah,0 ; DATA XREF: sub_65889CFE+251o
; char aChan_PS[]
aChan_PS	db 'chan_%p %s [',0     ; DATA XREF: sub_65889CFE+30Bo
; char a___UByteSSkipp[]
a___UByteSSkipp	db ' ...(%u byte(s) skipped)',0 ; DATA XREF: sub_65889CFE+4ACo
asc_65891457	db ' ]',0Ah,0           ; DATA XREF: sub_65889CFE:loc_6588A1ECo
		align 4
aLibassuanFaile	db '[libassuan failed to format the log message]',0
					; DATA XREF: sub_65889CFE+522o
		align 4
; char Mode[]
Mode		db 'rb',0               ; DATA XREF: sub_6588A4F1+11o
aSocket		db '!<socket >',0       ; DATA XREF: sub_6588A4F1+92o
; char aUS08x08x08x08x[]
aUS08x08x08x08x	db '%u s %08x-%08x-%08x-%08x',0 ; DATA XREF: sub_6588A4F1+B9o
aCygwin		db 'cygwin',0           ; DATA XREF: sub_6588A73D+Do
					; sub_6588A888+Do
aTorMode	db 'tor-mode',0         ; DATA XREF: sub_6588A73D+68o
					; sub_6588A888+4Ao
aSocks		db 'socks',0            ; DATA XREF: sub_6588A73D+90o
					; sub_6588A888+8Ao
		align 4
off_658914CC	dd offset loc_6588B127	; DATA XREF: sub_6588AA7E+63Er
		dd offset loc_6588B0C5	; jump table for switch	statement
		dd offset loc_6588B0D3
		dd offset loc_6588B0E1
		dd offset loc_6588B0EF
		dd offset loc_6588B0FD
		dd offset loc_6588B10B
		dd offset loc_6588B127
		dd offset loc_6588B119
dword_658914F0	dd 0			; DATA XREF: sub_6588B454:loc_6588B501o
; char aSocketDS08x08x[]
aSocketDS08x08x	db '!<socket >%d s %08x-%08x-%08x-%08x',0 ; DATA XREF: sub_6588B571+1B0o
; char aD[]
aD		db '%d',0Ah,0           ; DATA XREF: sub_6588B571+233o
		align 4
aCtx_7		db 'ctx',0              ; DATA XREF: __assuan_pipe+75o
					; __assuan_pipe+12Ao ...
a__assuan_pipe	db '__assuan_pipe',0    ; DATA XREF: __assuan_pipe+7Do
					; __assuan_pipe+132o
		align 10h
aSSPCallCreatep	db '%s (%s=%p): call: CreatePipe failed: %s',0Ah,0
					; DATA XREF: __assuan_pipe+85o
		align 4
aSSPCallDuplica	db '%s (%s=%p): call: DuplicateHandle failed: %s',0Ah,0
					; DATA XREF: __assuan_pipe+13Ao
; char Control[4]
Control		db ' ',9,0Ah,0Bh        ; DATA XREF: sub_6588C5A0+FFo
		dw 220Ch
		db 2 dup(0)
; const	WCHAR FileName
FileName	dw 6Eh			; DATA XREF: __assuan_spawn+12Eo
aUl:
		unicode	0, <ul>,0
a__assuan_spawn	db '__assuan_spawn',0   ; DATA XREF: __assuan_spawn+16Eo
		align 4
aSSPCallCanTOpe	db '%s (%s=%p): call: can',27h,'t open `nul',27h,': %s',0Ah,0
					; DATA XREF: __assuan_spawn+176o
aPipe_connect_w	db 'pipe_connect_w32',0 ; DATA XREF: __assuan_spawn+277o
		align 4
aSSPCallCreat_0	db '%s (%s=%p): call: CreateProcess failed: %s',0Ah,0
					; DATA XREF: __assuan_spawn+27Fo
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_65891650	dd offset TlsCallback_0	; DATA XREF: sub_65881040:loc_6588114Ar
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_6588D370+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_6588D3D0+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_6588D3D0+1F9o
					; sub_6588D3D0+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_6588D3D0+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_6588D610+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_6588D610+1B7o
		align 4
off_6589174C	dd offset dword_65892420 ; DATA	XREF: .text:6588DA88o
		dd offset dword_65892140
aMsvcrt_dll:				; DATA XREF: .text:loc_6588E0A0o
		unicode	0, <msvcrt.dll>,0
		align 4
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_6588E160+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_2[]
aS_2		db '%s',0Ah,0           ; DATA XREF: sub_6588E160+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_6588E160+10Fo
		align 4
dword_658917CC	dd 0			; DATA XREF: sub_6588D610+59o
					; sub_6588D610+5Eo ...
dword_658917D0	dd 0			; DATA XREF: sub_6588D610+7Fr
dword_658917D4	dd 0			; DATA XREF: sub_6588D610:loc_6588D75Cr
dword_658917D8	dd 0Ah dup(0)		; DATA XREF: sub_6588D610+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00012000)
; Virtual size			: 000004D4 (   1236.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 65892000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_65892000	dd ?			; DATA XREF: sub_65881040+Dr
					; sub_65881040+22w ...
dword_65892004	dd ?			; DATA XREF: assuan_set_log_cb+11w
					; assuan_get_log_cb+Er	...
		align 20h
; char Dest
Dest		db ?			; DATA XREF: assuan_set_assuan_log_prefix+1Bo
					; assuan_set_assuan_log_prefix:loc_65889BB8w ...
		align 4
		dd 12h dup(?)
		db 3 dup(?)
byte_6589206F	db ?			; DATA XREF: assuan_set_assuan_log_prefix+27w
dword_65892070	dd ?			; DATA XREF: sub_65889AD0+1Aw
					; sub_65889CFE:loc_65889F86r
dword_65892074	dd ?			; DATA XREF: sub_65889AD0+3Fw
					; sub_65889AD0:loc_65889B16w ...
dword_65892078	dd ?			; DATA XREF: assuan_set_assuan_log_stream+9w
					; assuan_set_log_stream+36r ...
		align 10h
; int dword_65892080
dword_65892080	dd ?			; DATA XREF: assuan_sock_init+9r
					; assuan_sock_init+2Ao	...
word_65892084	dw ?			; DATA XREF: sub_6588A73D+B9r
					; sub_6588A73D+EEw ...
		align 20h
dword_658920A0	dd ?			; DATA XREF: sub_6588A294+2Ar
					; sub_6588A2F5+31r ...
		dd 0Fh dup(?)
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_6588A294+Do
					; sub_6588A294:loc_6588A2DFo ...
		align 10h
; void *Memory
Memory		dd ?			; DATA XREF: sub_6588CC48+BBr
					; sub_6588CC48+1A6r ...
		align 10h
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_65892118	dd ?			; DATA XREF: DllEntryPoint+7w
					; sub_6588E160+FAr
dword_6589211C	dd ?			; DATA XREF: sub_6588D610+9r
					; sub_6588D610:loc_6588D630w
dword_65892120	dd ?			; DATA XREF: sub_6588D3D0+1Dr
					; sub_6588D3D0+58r ...
dword_65892124	dd ?			; DATA XREF: sub_6588D3D0+Br
					; sub_6588D3D0:loc_6588D48Fw ...
dword_65892128	dd ?			; DATA XREF: sub_6588D940r
					; sub_6588D940:loc_6588D950w
		align 20h
dword_65892140	dd 2Bh dup(?)		; DATA XREF: .rdata:65891750o
dword_658921EC	dd ?			; DATA XREF: .text:6588DA6Aw
		dd 2 dup(?)
dword_658921F8	dd ?			; DATA XREF: .text:6588DA56w
		dd 2 dup(?)
dword_65892204	dd ?			; DATA XREF: .text:6588DA3Cw
		dd 86h dup(?)
dword_65892420	dd ?			; DATA XREF: .text:6588DA42w
					; .rdata:off_6589174Co
dword_65892424	dd ?			; DATA XREF: .text:6588DA4Cw
		dd ?
dword_6589242C	dd ?			; DATA XREF: .text:6588DA5Bw
		align 80h
dword_65892480	dd ?			; DATA XREF: .text:6588DB33r
					; .text:6588DBC4r ...
; struct _RTL_CRITICAL_SECTION stru_65892484
stru_65892484	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_6588DAC0+7o
					; sub_6588DAC0:loc_6588DB15o ...
dword_6589249C	dd ?			; DATA XREF: sub_6588DAC0+14r
					; .text:6588DB88r ...
		dd ?
dword_658924A4	dd ?			; DATA XREF: .text:6588E004r
					; .text:6588E092w ...
dword_658924A8	dd ?			; DATA XREF: sub_65881000+21w
					; sub_65881040+156r ...
dword_658924AC	dd ?			; DATA XREF: sub_65881000+1Cw
					; sub_65881040:loc_65881183r ...
dword_658924B0	dd ?			; DATA XREF: sub_65881040+4Co
					; sub_65881040+C1o ...
dword_658924B4	dd ?			; DATA XREF: sub_65881040+5Fr
					; sub_65881040:loc_65881116r ...
dword_658924B8	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_6588D2B3w ...
dword_658924BC	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_658924C0	dd ?			; DATA XREF: TlsCallback_0:loc_6588D204w
		align 1000h
_bss		ends

;
; Imports from libgpg-error-0.dll
;
; Section 6. (virtual address 00014000)
; Virtual size			: 00000D30 (   3376.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 00010000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_gpg_err_code_from_syserror:dword
					; DATA XREF: gpg_err_code_from_syserrorr
		extrn __imp_gpg_err_set_errno:dword ; DATA XREF: gpg_err_set_errnor
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr
		extrn __imp_gpg_strerror_r:dword ; DATA	XREF: gpg_strerror_rr
		extrn __imp_gpg_strsource:dword	; DATA XREF: gpg_strsourcer
		extrn __imp_gpgrt_asprintf:dword ; DATA	XREF: gpgrt_asprintfr
		extrn __imp_gpgrt_vasprintf:dword ; DATA XREF: gpgrt_vasprintfr

;
; Imports from ADVAPI32.dll
;
; BOOL __stdcall CryptAcquireContextA(HCRYPTPROV *phProv, LPCSTR szContainer, LPCSTR szProvider, DWORD dwProvType, DWORD dwFlags)
		extrn CryptAcquireContextA:dword ; CODE	XREF: sub_6588A44E+38p
					; DATA XREF: sub_6588A44E+33r
; BOOL __stdcall CryptGenRandom(HCRYPTPROV hProv, DWORD	dwLen, BYTE *pbBuffer)
		extrn CryptGenRandom:dword ; CODE XREF:	sub_6588A44E+68p
					; DATA XREF: sub_6588A44E+63r
; BOOL __stdcall CryptReleaseContext(HCRYPTPROV	hProv, DWORD dwFlags)
		extrn CryptReleaseContext:dword	; CODE XREF: sub_6588A44E+99p
					; DATA XREF: sub_6588A44E+94r

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_6588B571+149p
					; sub_6588B571+2EDp ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_6588B571+B4p
					; DATA XREF: sub_6588B571+AFr
; HANDLE __stdcall CreateFileW(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD	dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile)
		extrn CreateFileW:dword	; CODE XREF: __assuan_spawn+13Ap
					; DATA XREF: __assuan_spawn+135r
; BOOL __stdcall CreatePipe(PHANDLE hReadPipe, PHANDLE hWritePipe, LPSECURITY_ATTRIBUTES lpPipeAttributes, DWORD nSize)
		extrn CreatePipe:dword	; CODE XREF: _assuan_w32ce_create_pipe+26p
					; __assuan_pipe+4Ep
					; DATA XREF: ...
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	__assuan_spawn+244p
					; DATA XREF: __assuan_spawn+23Fr
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: assuan_sock_deinit+39p
					; sub_6588DC60+44p
					; DATA XREF: ...
; BOOL __stdcall DeleteFileA(LPCSTR lpFileName)
		extrn DeleteFileA:dword	; CODE XREF: sub_6588B571+15Cp
					; sub_6588B571+300p
					; DATA XREF: ...
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: assuan_fdopen+59p
					; __assuan_pipe+103p
					; DATA XREF: ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_6588A294+19p
					; sub_6588A2F5+20p ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_65883F36+53p
					; DATA XREF: sub_65883F36+4Er
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: assuan_fdopen+1Cp
					; assuan_fdopen+25p ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_6588D960+6Cp
					; DATA XREF: sub_6588D960+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_6588D960+74p
					; DATA XREF: sub_6588D960+74r
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: sub_6588C15A+11p
					; DATA XREF: sub_6588C15A+Cr
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_65883F36+11p
					; sub_6588B571+C7p ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_6588E160+C2p
					; DATA XREF: sub_6588E160+C2r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_65881460+16p
					; .text:6588E087p
					; DATA XREF: ...
; BOOL __stdcall GetNamedPipeInfo(HANDLE hNamedPipe, LPDWORD lpFlags, LPDWORD lpOutBufferSize, LPDWORD lpInBufferSize, LPDWORD lpMaxInstances)
		extrn GetNamedPipeInfo:dword ; CODE XREF: sub_6588C15A+42p
					; DATA XREF: sub_6588C15A+3Dr
; DWORD	__stdcall GetPriorityClass(HANDLE hProcess)
		extrn GetPriorityClass:dword ; CODE XREF: __assuan_spawn+1EEp
					; DATA XREF: __assuan_spawn+1E9r
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_65881460+33p
					; TlsCallback_0+7Cp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_6588D960+57p
					; DATA XREF: sub_6588D960+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_6588D960+7Cp
					; DATA XREF: sub_6588D960+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: assuan_sock_init+25p
					; sub_6588DC60+87p
					; DATA XREF: ...
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_6588A294+57p
					; sub_6588A2F5+95p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: TlsCallback_0+55p
					; DATA XREF: TlsCallback_0+55r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: .text:6588E0A7p
					; DATA XREF: .text:6588E0A7r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_6588D960+8Bp
					; DATA XREF: sub_6588D960+8Br
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: __assuan_read+156p
					; DATA XREF: __assuan_read+151r
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword ; CODE	XREF: __assuan_spawn+308p
					; DATA XREF: __assuan_spawn+303r
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: .text:6588DA7Fp
					; DATA XREF: .text:6588DA7Fr
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_65881040+37p
					; sub_65881040+B0p ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:6588DAA9p
					; DATA XREF: .text:6588DAA9r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_6588DAC0+35p
					; DATA XREF: sub_6588DAC0+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:6588DA8Fp
					; DATA XREF: .text:6588DA8Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_6588D3D0+142p
					; sub_6588D3D0+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_6588D3D0+A1p
					; sub_6588D3D0+D9p ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_6588B571+2D9p
					; __assuan_write+14Fp
					; DATA XREF: ...

;
; Imports from msvcrt.dll
;
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
; char **environ
		extrn _environ:dword	; DATA XREF: sub_6588CC48+5Dr
					; sub_6588CC48:loc_6588CDE7r ...
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_658824B3+E5p
					; sub_65882BEA+DAp ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
		extrn _get_osfhandle:dword ; CODE XREF:	assuan_get_active_fds+B5p
					; sub_65889033+1Ep ...
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: __assuan_spawn+A9r
					; sub_6588D370+4r ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_6588D090+A3p
					; DATA XREF: sub_6588D090+A3r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
; int __cdecl _vsnprintf(char *DstBuf, size_t MaxCount,	const char *Format, va_list ArgList)
		extrn __imp__vsnprintf:dword ; DATA XREF: _vsnprintfr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl iscntrl(int C)
		extrn iscntrl:dword	; CODE XREF: sub_65889CFE+144p
					; sub_65889CFE+1BBp
					; DATA XREF: ...
; int __cdecl isprint(int C)
		extrn isprint:dword	; CODE XREF: .text:6588317Cp
					; sub_6588327E+D2p ...
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn __imp_memchr:dword ; DATA	XREF: memchrr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; int sscanf(const char	*Src, const char *Format, ...)
		extrn __imp_sscanf:dword ; DATA	XREF: sscanfr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; size_t __cdecl strcspn(const char *Str, const	char *Control)
		extrn __imp_strcspn:dword ; DATA XREF: strcspnr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_6588E160+122p
					; DATA XREF: sub_6588E160+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSACleanup()
		extrn WSACleanup:dword	; CODE XREF: assuan_sock_deinit+14p
					; DATA XREF: assuan_sock_deinit+Fr
; int __stdcall	WSAGetLastError()
		extrn WSAGetLastError:dword ; CODE XREF: sub_6588991C+50p
					; sub_65889983+55p ...
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: assuan_sock_init+55p
					; DATA XREF: assuan_sock_init+50r
; SOCKET __stdcall accept(SOCKET s, struct sockaddr *addr, int *addrlen)
		extrn accept:dword	; CODE XREF: sub_658886D1+6Ep
					; DATA XREF: sub_658886D1+69r
; int __stdcall	bind(SOCKET s, const struct sockaddr *name, int	namelen)
		extrn bind:dword	; CODE XREF: sub_6588B571+FDp
					; sub_6588B571+348p
					; DATA XREF: ...
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; CODE XREF: __assuan_close+11p
					; DATA XREF: __assuan_close+Cr
; int __stdcall	connect(SOCKET s, const	struct sockaddr	*name, int namelen)
		extrn connect:dword	; CODE XREF: __assuan_connect+1Fp
					; DATA XREF: __assuan_connect+1Ar
; int __stdcall	getsockname(SOCKET s, struct sockaddr *name, int *namelen)
		extrn getsockname:dword	; CODE XREF: sub_6588B571+124p
					; DATA XREF: sub_6588B571+11Fr
; u_long __stdcall htonl(u_long	hostlong)
		extrn htonl:dword	; CODE XREF: sub_6588AA7E+DCp
					; sub_6588B232+83p ...
; u_short __stdcall htons(u_short hostshort)
		extrn htons:dword	; CODE XREF: assuan_socket_connect+3F2p
					; sub_6588AA7E+C7p ...
; unsigned __int32 __stdcall inet_addr(const char *cp)
		extrn inet_addr:dword	; CODE XREF: assuan_socket_connect+41Fp
					; DATA XREF: assuan_socket_connect+41Ar
; u_short __stdcall ntohs(u_short netshort)
		extrn ntohs:dword	; CODE XREF: sub_6588B571+1A8p
					; sub_6588B571+22Bp
					; DATA XREF: ...
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn recv:dword	; CODE XREF: __assuan_read+52p
					; DATA XREF: __assuan_read+4Dr
; int __stdcall	recvfrom(SOCKET	s, char	*buf, int len, int flags, struct sockaddr *from, int *fromlen)
		extrn recvfrom:dword	; CODE XREF: sub_6588991C+3Dp
					; DATA XREF: sub_6588991C+38r
; int __stdcall	select(int nfds, fd_set	*readfds, fd_set *writefds, fd_set *exceptfds, const struct timeval *timeout)
		extrn select:dword	; CODE XREF: __assuan_read+11Dp
					; __assuan_write+11Dp
					; DATA XREF: ...
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn send:dword	; CODE XREF: __assuan_write+52p
					; DATA XREF: __assuan_write+4Dr
; int __stdcall	sendto(SOCKET s, const char *buf, int len, int flags, const struct sockaddr *to, int tolen)
		extrn sendto:dword	; CODE XREF: sub_65889983+42p
					; DATA XREF: sub_65889983+3Dr
; SOCKET __stdcall socket(int af, int type, int	protocol)
		extrn socket:dword	; CODE XREF: __assuan_socket+1Fp
					; DATA XREF: __assuan_socket+1Ar


; Section 7. (virtual address 00015000)
; Virtual size			: 0000002C (	 44.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00010E00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 65895000h
dword_65895000	dd 0			; DATA XREF: sub_65881040+1FDo
dword_65895004	dd 0			; DATA XREF: sub_65881040:loc_65881235o
dword_65895008	dd 0			; DATA XREF: sub_65881040+1C9o
		dd offset sub_65881000
dword_65895010	dd 2 dup(0)		; DATA XREF: sub_65881040:loc_65881201o
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 8
dword_65895028	dd 76h dup(0)		; DATA XREF: TlsCallback_0:loc_6588D2F3o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 8. (virtual address 00016000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00011000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 65896000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end DllEntryPoint
