;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	10305A4E90B41F922E5C4991F314EFCD
; Input	CRC32 :	44401691

; File Name   :	C:\compspace\compare\gpg\dlls\full\gpg2keys_finger.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 0000E214 (  57876.)
; Section size in file		: 0000E400 (  58368.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00416004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_414404
		mov	[esp+2Ch+var_1C], offset dword_414018
		mov	[esp+2Ch+var_24], offset dword_41400C
		mov	[esp+2Ch+var_28], offset dword_414008
		mov	ds:dword_414018, eax
		mov	eax, ds:dword_414408
		mov	[esp+2Ch+var_2C], offset dword_414004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_41401C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00416010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_414414, 1
		mov	ds:dword_414410, 1
		mov	ds:dword_41440C, 1
		mov	ds:dword_414420, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_414014, eax
		mov	eax, ds:dword_414424
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_40CAB0
		mov	edx, ds:dword_414428
		mov	ds:dword_4147E0, eax
		mov	ds:dword_4147E4, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_40CDF0
		cmp	dword_41001C, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_40CD90
		call	sub_40CD80
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_40DB60
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_414424
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_4147E8
		call	sub_40DBE0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_4147EC
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_4147EC
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_414000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_4147EC
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_4147E8

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_412F34
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_40D0A0
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_41442C, eax
		call	sub_40D650
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_40D710
		mov	eax, ds:dword_414424
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_4147C4, eax
		mov	eax, 0Ah
		mov	ds:dword_4147CC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_4147C8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_414004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_414008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_414008, eax
		call	sub_40D7A0
		mov	eax, ds:__initenv
		mov	edx, ds:dword_41400C
		mov	[eax], edx
		mov	eax, ds:dword_41400C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_414008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_414004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_401CDA
		mov	esi, ds:dword_414014
		test	esi, esi
		mov	ds:dword_414010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_414000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_414010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_4147EC
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_4147EC
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_416008
		mov	[esp+88h+dwMilliseconds], offset dword_416000
		call	_initterm
		mov	ds:dword_4147EC, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_4147EC, 1
		mov	[esp+88h+lpProcName], offset dword_416018
		mov	[esp+88h+dwMilliseconds], offset dword_41600C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_414424, 1
		call	sub_40D7C0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_414424, 0
		call	sub_40D7C0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_40F1E0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_410044
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_410044
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_40F1E0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4015C8(char *cp, int)
sub_4015C8	proc near		; CODE XREF: sub_401860+C5p

hostshort	= word ptr -48h
Format		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= word ptr -2Ch
var_24		= dword	ptr -24h
name		= sockaddr ptr -20h
var_10		= dword	ptr -10h
s		= dword	ptr -0Ch
cp		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], ax
		mov	[ebp+s], 0FFFFFFFFh
		call	sub_40237C
		lea	eax, [ebp+name]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	[ebp+name.sa_family], 2
		movzx	eax, [ebp+var_2C]
		mov	dword ptr [esp+48h+hostshort], eax ; hostshort
		mov	eax, ds:htons
		call	eax ; htons
		sub	esp, 4
		mov	word ptr [ebp+name.sa_data], ax
		mov	eax, [ebp+cp]
		mov	dword ptr [esp+48h+hostshort], eax ; cp
		mov	eax, ds:inet_addr
		call	eax ; inet_addr
		sub	esp, 4
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_401642
		lea	eax, [ebp+var_24]
		mov	eax, [eax]
		mov	dword ptr [ebp+name.sa_data+2],	eax
		jmp	loc_401726
; ---------------------------------------------------------------------------

loc_401642:				; CODE XREF: sub_4015C8+6Bj
		mov	eax, [ebp+cp]
		mov	dword ptr [esp+48h+hostshort], eax ; name
		mov	eax, ds:gethostbyname
		call	eax ; gethostbyname
		sub	esp, 4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_4016F3
		mov	eax, [ebp+var_10]
		movzx	eax, word ptr [eax+8]
		cmp	ax, 2
		jz	short loc_401693
		mov	edx, offset Format ; "gpgkeys: unknown address family for `%s"...
		mov	eax, ds:File
		mov	ecx, [ebp+cp]
		mov	[esp+48h+Size],	ecx
		mov	[esp+48h+Format], edx ;	Format
		mov	dword ptr [esp+48h+hostshort], eax ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	locret_4017DF
; ---------------------------------------------------------------------------

loc_401693:				; CODE XREF: sub_4015C8+A2j
		mov	eax, [ebp+var_10]
		movzx	eax, word ptr [eax+0Ah]
		cmp	ax, 4
		jz	short loc_4016C7
		mov	edx, offset aGpgkeysIllegal ; "gpgkeys:	illegal	address	length for `%s"...
		mov	eax, ds:File
		mov	ecx, [ebp+cp]
		mov	[esp+48h+Size],	ecx
		mov	[esp+48h+Format], edx ;	Format
		mov	dword ptr [esp+48h+hostshort], eax ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	locret_4017DF
; ---------------------------------------------------------------------------

loc_4016C7:				; CODE XREF: sub_4015C8+D6j
		mov	eax, [ebp+var_10]
		movzx	eax, word ptr [eax+0Ah]
		movsx	ecx, ax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	edx, eax
		lea	eax, [ebp+name]
		add	eax, 4
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Format], edx ;	Src
		mov	dword ptr [esp+48h+hostshort], eax ; Dst
		call	memcpy
		jmp	short loc_401726
; ---------------------------------------------------------------------------

loc_4016F3:				; CODE XREF: sub_4015C8+91j
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	ecx, offset aGpgkeysHostSNo ; "gpgkeys:	host `%s' not found: ec=%d\n"
		mov	edx, ds:File
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+cp]
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+Format], ecx ;	Format
		mov	dword ptr [esp+48h+hostshort], edx ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	locret_4017DF
; ---------------------------------------------------------------------------

loc_401726:				; CODE XREF: sub_4015C8+75j
					; sub_4015C8+129j
		mov	[esp+48h+Size],	0 ; protocol
		mov	[esp+48h+Format], 1 ; type
		mov	dword ptr [esp+48h+hostshort], 2 ; af
		mov	eax, ds:socket
		call	eax ; socket
		sub	esp, 0Ch
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jnz	short loc_401779
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	ecx, offset aGpgkeysErrorCr ; "gpgkeys:	error creating socket: ec=%d\n"
		mov	edx, ds:File
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+Format], ecx ;	Format
		mov	dword ptr [esp+48h+hostshort], edx ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4017DF
; ---------------------------------------------------------------------------

loc_401779:				; CODE XREF: sub_4015C8+186j
		mov	eax, [ebp+s]
		mov	[esp+48h+Size],	10h ; namelen
		lea	edx, [ebp+name]
		mov	[esp+48h+Format], edx ;	name
		mov	dword ptr [esp+48h+hostshort], eax ; s
		mov	eax, ds:connect
		call	eax ; connect
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_4017DC
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	ecx, offset aGpgkeysErrorCo ; "gpgkeys:	error connecting `%s': ec=%d\n"
		mov	edx, ds:File
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+cp]
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+Format], ecx ;	Format
		mov	dword ptr [esp+48h+hostshort], edx ; File
		call	fprintf
		mov	eax, [ebp+s]
		mov	dword ptr [esp+48h+hostshort], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4017DF
; ---------------------------------------------------------------------------

loc_4017DC:				; CODE XREF: sub_4015C8+1D2j
		mov	eax, [ebp+s]

locret_4017DF:				; CODE XREF: sub_4015C8+C6j
					; sub_4015C8+FAj ...
		leave
		retn
sub_4015C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4017E1(SOCKET, char *, int)
sub_4017E1	proc near		; CODE XREF: sub_401860+118p
					; sub_401860+137p

s		= dword	ptr -28h
buf		= dword	ptr -24h
len		= dword	ptr -20h
flags		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_401853
; ---------------------------------------------------------------------------

loc_4017EF:				; CODE XREF: sub_4017E1+76j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+flags], 0 ; flags
		mov	edx, [ebp+var_C]
		mov	[esp+28h+len], edx ; len
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+buf], edx ; buf
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_401847
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	ecx, offset aGpgkeysWriteFa ; "gpgkeys:	write failed: ec=%d\n"
		mov	edx, ds:File
		mov	[esp+28h+len], eax
		mov	[esp+28h+buf], ecx ; Format
		mov	[esp+28h+s], edx ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40185E
; ---------------------------------------------------------------------------

loc_401847:				; CODE XREF: sub_4017E1+3Bj
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		add	[ebp+arg_4], eax

loc_401853:				; CODE XREF: sub_4017E1+Cj
		cmp	[ebp+var_C], 0
		jg	short loc_4017EF
		mov	eax, 0

locret_40185E:				; CODE XREF: sub_4017E1+64j
		leave
		retn
sub_4017E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401860(char *, int)
sub_401860	proc near		; CODE XREF: sub_4019DF+71p

Src		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
s		= dword	ptr -14h
cp		= dword	ptr -10h
Str		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Src], eax ; Src
		call	_strdup
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_4018B5
		mov	edx, ds:File
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory\n"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 17h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Src], eax ; Str
		call	fwrite
		mov	eax, 5
		jmp	loc_4019DA
; ---------------------------------------------------------------------------

loc_4018B5:				; CODE XREF: sub_401860+22j
		mov	[esp+38h+Size],	40h ; Val
		mov	eax, [ebp+Str]
		mov	[esp+38h+Src], eax ; Str
		call	strchr
		mov	[ebp+cp], eax
		cmp	[ebp+cp], 0
		jnz	short loc_40190D
		mov	edx, ds:File
		mov	eax, offset aGpgkeysNoNameI ; "gpgkeys:	no name	included in request\n"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 25h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Src], eax ; Str
		call	fwrite
		mov	eax, [ebp+Str]
		mov	[esp+38h+Src], eax ; Memory
		call	free
		mov	eax, 4
		jmp	loc_4019DA
; ---------------------------------------------------------------------------

loc_40190D:				; CODE XREF: sub_401860+6Fj
		mov	eax, [ebp+cp]
		mov	byte ptr [eax],	0
		add	[ebp+cp], 1
		mov	[esp+38h+Size],	4Fh ; int
		mov	eax, [ebp+cp]
		mov	[esp+38h+Src], eax ; cp
		call	sub_4015C8
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jnz	short loc_401948
		mov	eax, [ebp+Str]
		mov	[esp+38h+Src], eax ; Memory
		call	free
		mov	eax, 9
		jmp	loc_4019DA
; ---------------------------------------------------------------------------

loc_401948:				; CODE XREF: sub_401860+D1j
		mov	eax, [ebp+Str]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+38h+Count], eax ; int
		mov	eax, [ebp+Str]
		mov	[esp+38h+Size],	eax ; char *
		mov	eax, [ebp+s]
		mov	[esp+38h+Src], eax ; SOCKET
		call	sub_4017E1
		test	eax, eax
		jnz	short loc_4019A0
		mov	[esp+38h+Count], 2 ; int
		mov	[esp+38h+Size],	offset asc_411172 ; "\r\n"
		mov	eax, [ebp+s]
		mov	[esp+38h+Src], eax ; SOCKET
		call	sub_4017E1
		test	eax, eax
		jz	short loc_4019C2

loc_4019A0:				; CODE XREF: sub_401860+11Fj
		mov	eax, [ebp+Str]
		mov	[esp+38h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+s]
		mov	[esp+38h+Src], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4
		mov	eax, 4
		jmp	short loc_4019DA
; ---------------------------------------------------------------------------

loc_4019C2:				; CODE XREF: sub_401860+13Ej
		mov	eax, [ebp+Str]
		mov	[esp+38h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+s]
		mov	[eax], edx
		mov	eax, 0

loc_4019DA:				; CODE XREF: sub_401860+50j
					; sub_401860+A8j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_401860	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4019DF	proc near		; CODE XREF: sub_401CDA+5A2p

File		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
s		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 30h
		mov	[ebp+var_C], 0
		mov	[ebp+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset a0x	; "0x"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401A21
		add	[ebp+arg_0], 2

loc_401A21:				; CODE XREF: sub_4019DF+3Cj
		mov	edx, offset aKey0xSBegin ; "KEY	0x%s BEGIN\n"
		mov	eax, ds:dword_414024
		mov	ecx, [ebp+arg_0]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf
		mov	eax, ds:dword_41402C
		mov	eax, [eax+18h]
		lea	edx, [ebp+s]
		mov	[esp+38h+Format], edx ;	int
		mov	[esp+38h+File],	eax ; char *
		call	sub_401860
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_401A9C
		mov	edx, offset aKey0xSFailedD ; "KEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_414024
		mov	ecx, [ebp+var_10]
		mov	[esp+38h+var_2C], ecx
		mov	ecx, [ebp+arg_0]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf
		mov	eax, [ebp+s]
		mov	[esp+38h+File],	eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4
		mov	eax, 0
		jmp	loc_401C3B
; ---------------------------------------------------------------------------

loc_401A9C:				; CODE XREF: sub_4019DF+7Dj
		mov	eax, [ebp+s]
		mov	[esp+38h+Format], offset aR ; "r"
		mov	[esp+38h+File],	eax ; int
		call	sub_4054F1
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_401B8B
		mov	edx, offset aKey0xSFailedD ; "KEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_414024
		mov	[esp+38h+var_2C], 1
		mov	ecx, [ebp+arg_0]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf
		mov	eax, [ebp+s]
		mov	[esp+38h+File],	eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4
		mov	eax, 0
		jmp	loc_401C3B
; ---------------------------------------------------------------------------

loc_401AFB:				; CODE XREF: sub_4019DF+1CFj
		mov	[ebp+var_1C], 400h
		cmp	[ebp+var_C], 0
		jz	short loc_401B46
		mov	edx, [ebp+var_24]
		mov	eax, ds:dword_414024
		mov	[esp+38h+Format], edx ;	int
		mov	[esp+38h+File],	eax ; FILE *
		call	sub_402C0A
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	eax, offset aEndPgpPublicKe ; "-----END	PGP PUBLIC KEY BLOCK-----"
		mov	ecx, 22h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401B8C
		jmp	short loc_401BB4
; ---------------------------------------------------------------------------

loc_401B46:				; CODE XREF: sub_4019DF+127j
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	eax, offset aBeginPgpPublic ; "-----BEGIN PGP PUBLIC KEY BLOCK-----"
		mov	ecx, 24h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401B8C
		mov	edx, [ebp+var_24]
		mov	eax, ds:dword_414024
		mov	[esp+38h+Format], edx ;	int
		mov	[esp+38h+File],	eax ; FILE *
		call	sub_402C0A
		mov	[ebp+var_C], 1
		jmp	short loc_401B8C
; ---------------------------------------------------------------------------

loc_401B8B:				; CODE XREF: sub_4019DF+D7j
		nop

loc_401B8C:				; CODE XREF: sub_4019DF+163j
					; sub_4019DF+18Dj ...
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_20]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Format], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+File],	eax
		call	sub_407613
		test	eax, eax
		jnz	loc_401AFB

loc_401BB4:				; CODE XREF: sub_4019DF+165j
		cmp	[ebp+var_C], 0
		jz	short loc_401BD9
		mov	edx, offset aKey0xSEnd ; "KEY 0x%s END\n"
		mov	eax, ds:dword_414024
		mov	ecx, [ebp+arg_0]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf
		jmp	short loc_401C20
; ---------------------------------------------------------------------------

loc_401BD9:				; CODE XREF: sub_4019DF+1D9j
		mov	eax, ds:dword_41402C
		mov	ecx, [eax+18h]
		mov	edx, offset aGpgkeysNoKeyDa ; "gpgkeys:	no key data found for finger:%"...
		mov	eax, ds:File
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailedD ; "KEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_414024
		mov	[esp+38h+var_2C], 6
		mov	ecx, [ebp+arg_0]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf

loc_401C20:				; CODE XREF: sub_4019DF+1F8j
		mov	eax, [ebp+var_24]
		mov	[esp+38h+File],	eax ; void *
		call	sub_403669
		mov	eax, [ebp+var_14]
		mov	[esp+38h+File],	eax ; void *
		call	sub_404DAD
		mov	eax, 0

loc_401C3B:				; CODE XREF: sub_4019DF+B8j
					; sub_4019DF+117j
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4019DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401C42(FILE *)
sub_401C42	proc near		; CODE XREF: sub_401CDA+E3p
					; sub_401CDA+10Bp

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, offset aHHelpHelp ; "-h, --help\thelp\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 10h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aVMachineReadab ; "-V\t\tmachine readable version\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 1Dh ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aVersionHumanRe ; "--version\thuman	readable version\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 21h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aOOutputToThisF ; "-o\t\toutput to this file\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 18h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		leave
		retn
sub_401C42	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401CDA	proc near		; CODE XREF: sub_401180+265p

Str		= dword	ptr -44Ch
Size		= dword	ptr -448h
Count		= dword	ptr -444h
File		= dword	ptr -440h
var_430		= dword	ptr -430h
Buf		= byte ptr -424h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
Memory		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 440h
		call	sub_40D7A0
		mov	[esp+44Ch+var_10], 1
		mov	[esp+44Ch+Memory], 0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	ds:File, eax
		cmp	[ebp+arg_0], 1
		jle	short loc_401D77
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, offset aVersion ; "--version"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401D77
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aGpgkeys_finger ; "gpgkeys_finger (GnuPG) 2.0.30\n"
		mov	[esp+44Ch+File], edx ; File
		mov	[esp+44Ch+Count], 1Eh ;	Count
		mov	[esp+44Ch+Size], 1 ; Size
		mov	[esp+44Ch+Str],	eax ; Str
		call	fwrite
		mov	eax, 0
		jmp	loc_4022E5
; ---------------------------------------------------------------------------

loc_401D77:				; CODE XREF: sub_401CDA+3Bj
					; sub_401CDA+68j
		cmp	[ebp+arg_0], 1
		jle	loc_401E8D
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, offset aHelp ; "--help"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_401E8D
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+44Ch+Str],	eax ; FILE *
		call	sub_401C42
		mov	eax, 0
		jmp	loc_4022E5
; ---------------------------------------------------------------------------

loc_401DCC:				; CODE XREF: sub_401CDA+1DCj
		mov	eax, [esp+44Ch+var_18]
		cmp	eax, 56h
		jz	short loc_401DF4
		cmp	eax, 6Fh
		jz	short loc_401E28
		mov	eax, ds:File
		mov	[esp+44Ch+Str],	eax ; FILE *
		call	sub_401C42
		mov	eax, 0
		jmp	loc_4022E5
; ---------------------------------------------------------------------------

loc_401DF4:				; CODE XREF: sub_401CDA+FCj
		mov	eax, offset aDS	; "%d\n%s\n"
		mov	edx, ds:_iob
		add	edx, 20h
		mov	[esp+44Ch+File], offset	a2_0_30	; "2.0.30"
		mov	[esp+44Ch+Count], 1
		mov	[esp+44Ch+Size], eax ; Format
		mov	[esp+44Ch+Str],	edx ; File
		call	fprintf
		mov	eax, 0
		jmp	loc_4022E5
; ---------------------------------------------------------------------------

loc_401E28:				; CODE XREF: sub_401CDA+101j
		mov	edx, offset Mode ; "w"
		mov	eax, ds:Filename
		mov	[esp+44Ch+Size], edx ; Mode
		mov	[esp+44Ch+Str],	eax ; Filename
		call	fopen
		mov	ds:dword_414024, eax
		mov	eax, ds:dword_414024
		test	eax, eax
		jnz	short loc_401E8C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+44Ch+Str],	eax ; int
		call	strerror
		mov	ebx, ds:Filename
		mov	ecx, offset aGpgkeysCannotO ; "gpgkeys:	Cannot open output file	`%s': "...
		mov	edx, ds:File
		mov	[esp+44Ch+File], eax
		mov	[esp+44Ch+Count], ebx
		mov	[esp+44Ch+Size], ecx ; Format
		mov	[esp+44Ch+Str],	edx ; File
		call	fprintf
		mov	eax, 1
		jmp	loc_4022E5
; ---------------------------------------------------------------------------

loc_401E8C:				; CODE XREF: sub_401CDA+170j
		nop

loc_401E8D:				; CODE XREF: sub_401CDA+A1j
					; sub_401CDA+D2j
		mov	[esp+44Ch+Count], offset aHvo ;	"hVo:"
		mov	eax, [ebp+arg_4]
		mov	[esp+44Ch+Size], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+44Ch+Str],	eax
		call	sub_40E660
		mov	[esp+44Ch+var_18], eax
		cmp	[esp+44Ch+var_18], 0FFFFFFFFh
		jnz	loc_401DCC
		mov	eax, dword_410024
		cmp	[ebp+arg_0], eax
		jle	short loc_401F3A
		mov	edx, offset aR	; "r"
		mov	eax, dword_410024
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+44Ch+Size], edx ; Mode
		mov	[esp+44Ch+Str],	eax ; Filename
		call	fopen
		mov	ds:dword_414020, eax
		mov	eax, ds:dword_414020
		test	eax, eax
		jnz	short loc_401F3A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+44Ch+Str],	eax ; int
		call	strerror
		mov	edx, dword_410024
		shl	edx, 2
		add	edx, [ebp+arg_4]
		mov	ebx, [edx]
		mov	ecx, offset aGpgkeysCanno_0 ; "gpgkeys:	Cannot open input file `%s': %"...
		mov	edx, ds:File
		mov	[esp+44Ch+File], eax
		mov	[esp+44Ch+Count], ebx
		mov	[esp+44Ch+Size], ecx ; Format
		mov	[esp+44Ch+Str],	edx ; File
		call	fprintf
		mov	eax, 1
		jmp	loc_4022E5
; ---------------------------------------------------------------------------

loc_401F3A:				; CODE XREF: sub_401CDA+1EAj
					; sub_401CDA+216j
		mov	eax, ds:dword_414020
		test	eax, eax
		jnz	short loc_401F4D
		mov	eax, ds:_iob
		mov	ds:dword_414020, eax

loc_401F4D:				; CODE XREF: sub_401CDA+267j
		mov	eax, ds:dword_414024
		test	eax, eax
		jnz	short loc_401F63
		mov	eax, ds:_iob
		add	eax, 20h
		mov	ds:dword_414024, eax

loc_401F63:				; CODE XREF: sub_401CDA+27Aj
		call	sub_4023B0
		mov	ds:dword_41402C, eax
		mov	eax, ds:dword_41402C
		test	eax, eax
		jnz	short loc_401FCC
		mov	eax, 5
		jmp	loc_4022E5
; ---------------------------------------------------------------------------

loc_401F80:				; CODE XREF: sub_401CDA+312j
		movzx	eax, [esp+44Ch+Buf]
		cmp	al, 0Ah
		jz	short loc_401FF0
		mov	eax, ds:dword_41402C
		mov	[esp+44Ch+Size], eax ; int
		lea	eax, [esp+44Ch+Buf]
		mov	[esp+44Ch+Str],	eax ; char *
		call	sub_4024BD
		mov	[esp+44Ch+var_1C], eax
		cmp	[esp+44Ch+var_1C], 0
		jle	short loc_401FC2
		mov	eax, [esp+44Ch+var_1C]
		mov	[esp+44Ch+var_10], eax
		jmp	loc_402288
; ---------------------------------------------------------------------------

loc_401FC2:				; CODE XREF: sub_401CDA+2D3j
		cmp	[esp+44Ch+var_1C], 0
		jmp	short loc_401FCD
; ---------------------------------------------------------------------------

loc_401FCC:				; CODE XREF: sub_401CDA+29Aj
		nop

loc_401FCD:				; CODE XREF: sub_401CDA+2F0j
		mov	eax, ds:dword_414020
		mov	[esp+44Ch+Count], eax ;	File
		mov	[esp+44Ch+Size], 408h ;	MaxCount
		lea	eax, [esp+44Ch+Buf]
		mov	[esp+44Ch+Str],	eax ; Buf
		call	fgets
		test	eax, eax
		jnz	short loc_401F80
		jmp	short loc_401FF1
; ---------------------------------------------------------------------------

loc_401FF0:				; CODE XREF: sub_401CDA+2ADj
		nop

loc_401FF1:				; CODE XREF: sub_401CDA+314j
		mov	eax, ds:dword_41402C
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_402034
		mov	edx, ds:File
		mov	eax, offset aGpgkeysFingerR ; "gpgkeys:	finger://relay/user syntax is "...
		mov	[esp+44Ch+File], edx ; File
		mov	[esp+44Ch+Count], 50h ;	Count
		mov	[esp+44Ch+Size], 1 ; Size
		mov	[esp+44Ch+Str],	eax ; Str
		call	fwrite
		mov	[esp+44Ch+var_10], 2
		jmp	loc_402288
; ---------------------------------------------------------------------------

loc_402034:				; CODE XREF: sub_401CDA+321j
		mov	eax, ds:dword_41402C
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_40207B
		call	sub_402372
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40207B
		mov	edx, ds:File
		mov	eax, offset aGpgkeysUnableT ; "gpgkeys:	unable to register timeout han"...
		mov	[esp+44Ch+File], edx ; File
		mov	[esp+44Ch+Count], 2Ch ;	Count
		mov	[esp+44Ch+Size], 1 ; Size
		mov	[esp+44Ch+Str],	eax ; Str
		call	fwrite
		mov	eax, 1
		jmp	loc_4022E5
; ---------------------------------------------------------------------------

loc_40207B:				; CODE XREF: sub_401CDA+364j
					; sub_401CDA+36Ej
		mov	eax, ds:dword_41402C
		mov	eax, [eax]
		cmp	eax, 1
		jnz	loc_40216C
		jmp	short loc_40208E
; ---------------------------------------------------------------------------

loc_40208D:				; CODE XREF: sub_401CDA+3FBj
					; sub_401CDA+480j
		nop

loc_40208E:				; CODE XREF: sub_401CDA+3B1j
		mov	eax, ds:dword_414020
		mov	[esp+44Ch+Count], eax ;	File
		mov	[esp+44Ch+Size], 408h ;	MaxCount
		lea	eax, [esp+44Ch+Buf]
		mov	[esp+44Ch+Str],	eax ; Buf
		call	fgets
		test	eax, eax
		jz	loc_40215F
		movzx	eax, [esp+44Ch+Buf]
		cmp	al, 0Ah
		jz	loc_402160
		movzx	eax, [esp+44Ch+Buf]
		test	al, al
		jz	loc_402160
		cmp	[esp+44Ch+Memory], 0
		jnz	short loc_40208D
		lea	eax, [esp+44Ch+Buf]
		mov	[esp+44Ch+Str],	eax ; Src
		call	_strdup
		mov	[esp+44Ch+Memory], eax
		cmp	[esp+44Ch+Memory], 0
		jnz	short loc_40212B
		mov	edx, ds:File
		mov	eax, offset aGpgkeysOutOf_0 ; "gpgkeys:	out of memory while building k"...
		mov	[esp+44Ch+File], edx ; File
		mov	[esp+44Ch+Count], 2Fh ;	Count
		mov	[esp+44Ch+Size], 1 ; Size
		mov	[esp+44Ch+Str],	eax ; Str
		call	fwrite
		mov	[esp+44Ch+var_10], 5
		jmp	loc_402288
; ---------------------------------------------------------------------------

loc_40212B:				; CODE XREF: sub_401CDA+418j
		lea	eax, [esp+44Ch+Buf]
		mov	[esp+44Ch+var_430], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+44Ch+var_430]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [esp+44Ch+Memory]
		mov	byte ptr [eax],	0
		jmp	loc_40208D
; ---------------------------------------------------------------------------

loc_40215F:				; CODE XREF: sub_401CDA+3D3j
		nop

loc_402160:				; CODE XREF: sub_401CDA+3E0j
					; sub_401CDA+3EDj
		cmp	[esp+44Ch+Memory], 0
		jz	short loc_4021A4
		jmp	short loc_402198
; ---------------------------------------------------------------------------

loc_40216C:				; CODE XREF: sub_401CDA+3ABj
		mov	edx, ds:File
		mov	eax, offset aGpgkeysThisKey ; "gpgkeys:	this keyserver type only suppo"...
		mov	[esp+44Ch+File], edx ; File
		mov	[esp+44Ch+Count], 39h ;	Count
		mov	[esp+44Ch+Size], 1 ; Size
		mov	[esp+44Ch+Str],	eax ; Str
		call	fwrite
		jmp	loc_402288
; ---------------------------------------------------------------------------

loc_402198:				; CODE XREF: sub_401CDA+490j
		mov	eax, ds:dword_41402C
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	short loc_4021D0

loc_4021A4:				; CODE XREF: sub_401CDA+48Ej
		mov	edx, ds:File
		mov	eax, offset aGpgkeysInvalid ; "gpgkeys:	invalid	keyserver instructions"...
		mov	[esp+44Ch+File], edx ; File
		mov	[esp+44Ch+Count], 28h ;	Count
		mov	[esp+44Ch+Size], 1 ; Size
		mov	[esp+44Ch+Str],	eax ; Str
		call	fwrite
		jmp	loc_402288
; ---------------------------------------------------------------------------

loc_4021D0:				; CODE XREF: sub_401CDA+4C8j
		mov	edx, offset aVersionD ;	"VERSION %d\n"
		mov	eax, ds:dword_414024
		mov	[esp+44Ch+Count], 1
		mov	[esp+44Ch+Size], edx ; Format
		mov	[esp+44Ch+Str],	eax ; File
		call	fprintf
		mov	edx, offset aProgramS ;	"PROGRAM %s\n\n"
		mov	eax, ds:dword_414024
		mov	[esp+44Ch+Count], offset a2_0_30 ; "2.0.30"
		mov	[esp+44Ch+Size], edx ; Format
		mov	[esp+44Ch+Str],	eax ; File
		call	fprintf
		mov	eax, ds:dword_41402C
		mov	eax, [eax+20h]
		cmp	eax, 1
		jbe	short loc_402262
		mov	eax, ds:dword_41402C
		mov	ecx, [eax+18h]
		mov	edx, offset aUserS ; "User:\t\t%s\n"
		mov	eax, ds:File
		mov	[esp+44Ch+Count], ecx
		mov	[esp+44Ch+Size], edx ; Format
		mov	[esp+44Ch+Str],	eax ; File
		call	fprintf
		mov	edx, ds:File
		mov	eax, offset aCommandGet	; "Command:\tGET\n"
		mov	[esp+44Ch+File], edx ; File
		mov	[esp+44Ch+Count], 0Dh ;	Count
		mov	[esp+44Ch+Size], 1 ; Size
		mov	[esp+44Ch+Str],	eax ; Str
		call	fwrite

loc_402262:				; CODE XREF: sub_401CDA+53Dj
		mov	eax, ds:dword_41402C
		mov	eax, [eax+28h]
		mov	[esp+44Ch+Str],	eax
		call	sub_402368
		mov	eax, [esp+44Ch+Memory]
		mov	[esp+44Ch+Str],	eax
		call	sub_4019DF
		mov	[esp+44Ch+var_10], eax

loc_402288:				; CODE XREF: sub_401CDA+2E3j
					; sub_401CDA+355j ...
		mov	eax, [esp+44Ch+Memory]
		mov	[esp+44Ch+Str],	eax ; Memory
		call	free
		mov	edx, ds:dword_414020
		mov	eax, ds:_iob
		cmp	edx, eax
		jz	short loc_4022B3
		mov	eax, ds:dword_414020
		mov	[esp+44Ch+Str],	eax ; File
		call	fclose

loc_4022B3:				; CODE XREF: sub_401CDA+5CAj
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:dword_414024
		cmp	edx, eax
		jz	short loc_4022D1
		mov	eax, ds:dword_414024
		mov	[esp+44Ch+Str],	eax ; File
		call	fclose

loc_4022D1:				; CODE XREF: sub_401CDA+5E8j
		mov	eax, ds:dword_41402C
		mov	[esp+44Ch+Str],	eax ; void *
		call	sub_402442
		mov	eax, [esp+44Ch+var_10]

loc_4022E5:				; CODE XREF: sub_401CDA+98j
					; sub_401CDA+EDj ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401CDA	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402368	proc near		; CODE XREF: sub_401CDA+593p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_402368	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402372	proc near		; CODE XREF: sub_401CDA+366p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_402372	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40237C	proc near		; CODE XREF: sub_4015C8+14p

wVersionRequested= word	ptr -18h
lpWSAData	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_414040
		test	eax, eax
		jnz	short locret_4023AE
		mov	[esp+18h+lpWSAData], offset stru_414060	; lpWSAData
		mov	dword ptr [esp+18h+wVersionRequested], 202h ; wVersionRequested
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		mov	ds:dword_414040, 1

locret_4023AE:				; CODE XREF: sub_40237C+Dj
		leave
		retn
sub_40237C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4023B0	proc near		; CODE XREF: sub_401CDA:loc_401F63p

NumOfElements	= dword	ptr -28h
SizeOfElements	= dword	ptr -24h
Memory		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+SizeOfElements], 30h ;	SizeOfElements
		mov	[esp+28h+NumOfElements], 1 ; NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jz	short loc_40243D
		mov	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 2
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 4
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 8
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		mov	dword ptr [eax+28h], 78h
		mov	[esp+28h+NumOfElements], offset	Src ; "/"
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+Memory]
		mov	[eax+14h], edx
		mov	eax, [ebp+Memory]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_40243D
		mov	eax, [ebp+Memory]
		mov	[esp+28h+NumOfElements], eax ; Memory
		call	free
		mov	[ebp+Memory], 0

loc_40243D:				; CODE XREF: sub_4023B0+21j
					; sub_4023B0+79j
		mov	eax, [ebp+Memory]
		leave
		retn
sub_4023B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402442(void *)
sub_402442	proc near		; CODE XREF: sub_401CDA+5FFp

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_4024BB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_4024BB:				; CODE XREF: sub_402442+Aj
		leave
		retn
sub_402442	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4024BD(char *, int)
sub_4024BD	proc near		; CODE XREF: sub_401CDA+2BFp

Src		= dword	ptr -0A28h
Format		= dword	ptr -0A24h
MaxCount	= dword	ptr -0A20h
var_A11		= byte ptr -0A11h
var_911		= byte ptr -911h
var_910		= byte ptr -910h
var_510		= byte ptr -510h
var_50F		= byte ptr -50Fh
var_10F		= byte ptr -10Fh
var_10E		= byte ptr -10Eh
var_8E		= byte ptr -8Eh
var_8D		= byte ptr -8Dh
var_79		= byte ptr -79h
var_78		= byte ptr -78h
var_6E		= byte ptr -6Eh
var_6D		= byte ptr -6Dh
var_1D		= byte ptr -1Dh
Str1		= byte ptr -1Ch
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0A28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jnz	short loc_4024DA
		mov	eax, 0
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_4024DA:				; CODE XREF: sub_4024BD+11j
		mov	edx, offset aCommand7s ; "COMMAND %7s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+Str1]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_40259A
		mov	[ebp+var_15], 0
		mov	[esp+0A28h+Format], offset Str2	; "get"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402526
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1
		jmp	short loc_402590
; ---------------------------------------------------------------------------

loc_402526:				; CODE XREF: sub_4024BD+5Cj
		mov	[esp+0A28h+Format], offset aGetname ; "getname"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_40254A
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 2
		jmp	short loc_402590
; ---------------------------------------------------------------------------

loc_40254A:				; CODE XREF: sub_4024BD+80j
		mov	[esp+0A28h+Format], offset aSend ; "send"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_40256E
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 3
		jmp	short loc_402590
; ---------------------------------------------------------------------------

loc_40256E:				; CODE XREF: sub_4024BD+A4j
		mov	[esp+0A28h+Format], offset aSearch ; "search"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402590
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 4

loc_402590:				; CODE XREF: sub_4024BD+67j
					; sub_4024BD+8Bj ...
		mov	eax, 0
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_40259A:				; CODE XREF: sub_4024BD+3Bj
		mov	edx, offset aHost80s ; "HOST %80s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_6D]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_4025FD
		mov	[ebp+var_1D], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_6D]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_4025F3
		mov	eax, 5
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_4025F3:				; CODE XREF: sub_4024BD+12Aj
		mov	eax, 0
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_4025FD:				; CODE XREF: sub_4024BD+FBj
		mov	edx, offset aPort10s ; "PORT %10s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_78]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_402660
		mov	[ebp+var_6E], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_78]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_402656
		mov	eax, 5
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_402656:				; CODE XREF: sub_4024BD+18Dj
		mov	eax, 0
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_402660:				; CODE XREF: sub_4024BD+15Ej
		mov	edx, offset aScheme20s ; "SCHEME %20s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_8D]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_4026C9
		mov	[ebp+var_79], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_8D]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_4026BF
		mov	eax, 5
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_4026BF:				; CODE XREF: sub_4024BD+1F6j
		mov	eax, 0
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_4026C9:				; CODE XREF: sub_4024BD+1C4j
		mov	edx, offset aAuth128s ;	"AUTH %128s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_10E]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_402735
		mov	[ebp+var_8E], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_10E]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40272B
		mov	eax, 5
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_40272B:				; CODE XREF: sub_4024BD+262j
		mov	eax, 0
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_402735:				; CODE XREF: sub_4024BD+22Dj
		mov	edx, offset aPath1024s ; "PATH %1024s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_50F]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_4027A1
		mov	[ebp+var_10F], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_50F]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_402797
		mov	eax, 5
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_402797:				; CODE XREF: sub_4024BD+2CEj
		mov	eax, 0
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_4027A1:				; CODE XREF: sub_4024BD+299j
		mov	edx, offset aOpaque1024s ; "OPAQUE %1024s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_910]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_40280D
		mov	[ebp+var_510], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+18h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_910]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	short loc_402803
		mov	eax, 5
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_402803:				; CODE XREF: sub_4024BD+33Aj
		mov	eax, 0
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_40280D:				; CODE XREF: sub_4024BD+305j
		mov	edx, offset aVersionD_0	; "VERSION %d\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_14]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_402849
		mov	eax, [ebp+var_14]
		cmp	eax, 1
		jz	short loc_40283F
		mov	eax, 3
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_40283F:				; CODE XREF: sub_4024BD+376j
		mov	eax, 0
		jmp	locret_402BC6
; ---------------------------------------------------------------------------

loc_402849:				; CODE XREF: sub_4024BD+36Ej
		mov	edx, offset aOption256 ; "OPTION %256[^\n]\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_A11]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_402BC1
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_A11]
		mov	[ebp+var_10], eax
		mov	[ebp+var_911], 0
		mov	[esp+0A28h+MaxCount], 3	; MaxCount
		mov	[esp+0A28h+Format], offset Str ; "no-"
		lea	eax, [ebp+var_A11]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_4028BE
		mov	[ebp+var_C], 1
		lea	eax, [ebp+var_A11]
		add	eax, 3
		mov	[ebp+var_10], eax

loc_4028BE:				; CODE XREF: sub_4024BD+3ECj
		mov	[esp+0A28h+MaxCount], 7	; MaxCount
		mov	[esp+0A28h+Format], offset aVerbose ; "verbose"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402930
		cmp	[ebp+var_C], 0
		jz	short loc_4028F4
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+20h], 0
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_4028F4:				; CODE XREF: sub_4024BD+426j
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_40291C
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+20h], edx
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_40291C:				; CODE XREF: sub_4024BD+442j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_4]
		mov	[eax+20h], edx
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402930:				; CODE XREF: sub_4024BD+420j
		mov	[esp+0A28h+Format], offset aIncludeDisable ; "include-disabled"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402973
		cmp	[ebp+var_C], 0
		jz	short loc_402961
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+1Ch], dl
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402961:				; CODE XREF: sub_4024BD+490j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 1
		mov	[eax+1Ch], dl
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402973:				; CODE XREF: sub_4024BD+48Aj
		mov	[esp+0A28h+Format], offset aIncludeRevoked ; "include-revoked"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_4029B6
		cmp	[ebp+var_C], 0
		jz	short loc_4029A4
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+1Ch], dl
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_4029A4:				; CODE XREF: sub_4024BD+4D3j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 2
		mov	[eax+1Ch], dl
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_4029B6:				; CODE XREF: sub_4024BD+4CDj
		mov	[esp+0A28h+Format], offset aIncludeSubkeys ; "include-subkeys"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_4029F9
		cmp	[ebp+var_C], 0
		jz	short loc_4029E7
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFBh
		mov	[eax+1Ch], dl
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_4029E7:				; CODE XREF: sub_4024BD+516j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 4
		mov	[eax+1Ch], dl
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_4029F9:				; CODE XREF: sub_4024BD+510j
		mov	[esp+0A28h+Format], offset aCheckCert ;	"check-cert"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402A3C
		cmp	[ebp+var_C], 0
		jz	short loc_402A2A
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFF7h
		mov	[eax+1Ch], dl
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402A2A:				; CODE XREF: sub_4024BD+559j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 8
		mov	[eax+1Ch], dl
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402A3C:				; CODE XREF: sub_4024BD+553j
		mov	[esp+0A28h+MaxCount], 5	; MaxCount
		mov	[esp+0A28h+Format], offset aDebug ; "debug"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402ABA
		cmp	[ebp+var_C], 0
		jz	short loc_402A72
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+24h], 0
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402A72:				; CODE XREF: sub_4024BD+5A4j
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_402A9A
		mov	eax, [ebp+var_10]
		add	eax, 6
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+24h], edx
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402A9A:				; CODE XREF: sub_4024BD+5C0j
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_402BC1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+24h], 1
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402ABA:				; CODE XREF: sub_4024BD+59Ej
		mov	[esp+0A28h+MaxCount], 7	; MaxCount
		mov	[esp+0A28h+Format], offset aTimeout ; "timeout"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402B38
		cmp	[ebp+var_C], 0
		jz	short loc_402AF0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+28h], 0
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402AF0:				; CODE XREF: sub_4024BD+622j
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_402B18
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+28h], edx
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402B18:				; CODE XREF: sub_4024BD+63Ej
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_402BC1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+28h], 78h
		jmp	loc_402BC1
; ---------------------------------------------------------------------------

loc_402B38:				; CODE XREF: sub_4024BD+61Cj
		mov	[esp+0A28h+MaxCount], 0Ch ; MaxCount
		mov	[esp+0A28h+Format], offset aCaCertFile ; "ca-cert-file"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402BC1
		cmp	[ebp+var_C], 0
		jz	short loc_402B79
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+2Ch], 0
		jmp	short loc_402BC1
; ---------------------------------------------------------------------------

loc_402B79:				; CODE XREF: sub_4024BD+6A0j
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_402BC1
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_10]
		add	eax, 0Dh
		mov	[esp+0A28h+Format], 0
		mov	[esp+0A28h+Src], eax
		call	sub_408317
		mov	edx, [ebp+arg_4]
		mov	[edx+2Ch], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	short loc_402BC1
		mov	eax, 5
		jmp	short locret_402BC6
; ---------------------------------------------------------------------------

loc_402BC1:				; CODE XREF: sub_4024BD+3ADj
					; sub_4024BD+432j ...
		mov	eax, 0FFFFFFFFh

locret_402BC6:				; CODE XREF: sub_4024BD+18j
					; sub_4024BD+D8j ...
		leave
		retn
sub_4024BD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 4 ; switch 5	cases
		ja	short loc_402C03 ; jumptable 00402BDE default case
		mov	eax, [ebp+8]
		shl	eax, 2
		add	eax, offset off_411590
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_402BE0:				; CODE XREF: .text:00402BDEj
					; DATA XREF: .rdata:off_411590o
		mov	eax, offset aUnknown ; jumptable 00402BDE case 0
		jmp	short loc_402C08
; ---------------------------------------------------------------------------

loc_402BE7:				; CODE XREF: .text:00402BDEj
					; DATA XREF: .rdata:off_411590o
		mov	eax, offset aGet_0 ; jumptable 00402BDE	case 1
		jmp	short loc_402C08
; ---------------------------------------------------------------------------

loc_402BEE:				; CODE XREF: .text:00402BDEj
					; DATA XREF: .rdata:off_411590o
		mov	eax, offset aGetname_0 ; jumptable 00402BDE case 2
		jmp	short loc_402C08
; ---------------------------------------------------------------------------

loc_402BF5:				; CODE XREF: .text:00402BDEj
					; DATA XREF: .rdata:off_411590o
		mov	eax, offset aSend_0 ; jumptable	00402BDE case 3
		jmp	short loc_402C08
; ---------------------------------------------------------------------------

loc_402BFC:				; CODE XREF: .text:00402BDEj
					; DATA XREF: .rdata:off_411590o
		mov	eax, offset aSearch_0 ;	jumptable 00402BDE case	4
		jmp	short loc_402C08
; ---------------------------------------------------------------------------

loc_402C03:				; CODE XREF: .text:00402BCFj
		mov	eax, offset a?	; jumptable 00402BDE default case

loc_402C08:				; CODE XREF: .text:00402BE5j
					; .text:00402BECj ...
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402C0A(FILE *, int)
sub_402C0A	proc near		; CODE XREF: sub_4019DF+138p
					; sub_4019DF+19Ep

var_18		= dword	ptr -18h
File		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_402C38
; ---------------------------------------------------------------------------

loc_402C12:				; CODE XREF: sub_402C0A+36j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_402C34
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+var_18], eax ;	Ch
		call	fputc

loc_402C34:				; CODE XREF: sub_402C0A+10j
		add	[ebp+arg_4], 1

loc_402C38:				; CODE XREF: sub_402C0A+6j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402C12
		leave
		retn
sub_402C0A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 2Ah	; switch 23 cases
		cmp	eax, 16h
		ja	loc_402D82	; jumptable 00402C69 default case
		mov	eax, ds:off_4115BC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_402C6B:				; CODE XREF: .text:00402C69j
					; DATA XREF: .rdata:off_4115BCo
		mov	eax, [ebp+8]	; jumptable 00402C69 case 42
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_402D87
; ---------------------------------------------------------------------------

loc_402C82:				; CODE XREF: .text:00402C69j
					; DATA XREF: .rdata:off_4115BCo
		mov	eax, [ebp+8]	; jumptable 00402C69 case 61
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 1
		jmp	loc_402D87
; ---------------------------------------------------------------------------

loc_402C99:				; CODE XREF: .text:00402C69j
					; DATA XREF: .rdata:off_4115BCo
		mov	eax, [ebp+8]	; jumptable 00402C69 case 60
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 2
		jmp	loc_402D87
; ---------------------------------------------------------------------------

loc_402CB0:				; CODE XREF: .text:00402C69j
					; DATA XREF: .rdata:off_4115BCo
		mov	eax, [ebp+8]	; jumptable 00402C69 case 64
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 3
		jmp	loc_402D87
; ---------------------------------------------------------------------------

loc_402CC7:				; CODE XREF: .text:00402C69j
					; DATA XREF: .rdata:off_4115BCo
		mov	eax, [ebp+8]	; jumptable 00402C69 case 48
		mov	eax, [eax]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 78h
		jnz	loc_402D82	; jumptable 00402C69 default case
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Ah
		jnz	short loc_402D2E
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	dword ptr [esp+4], offset aAbcdefabcdef12 ; "abcdefABCDEF1234567890x"
		mov	[esp], eax
		call	strspn
		cmp	eax, 0Ah
		jnz	short loc_402D2E
		mov	eax, [ebp+8]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 5
		jmp	short loc_402D87
; ---------------------------------------------------------------------------

loc_402D2E:				; CODE XREF: .text:00402CFEj
					; .text:00402D18j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 12h
		jnz	short loc_402D82 ; jumptable 00402C69 default case
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	dword ptr [esp+4], offset aAbcdefabcdef12 ; "abcdefABCDEF1234567890x"
		mov	[esp], eax
		call	strspn
		cmp	eax, 12h
		jnz	short loc_402D82 ; jumptable 00402C69 default case
		mov	eax, [ebp+8]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 4
		jmp	short loc_402D87
; ---------------------------------------------------------------------------

loc_402D82:				; CODE XREF: .text:00402C5Cj
					; .text:00402C69j ...
		mov	eax, 0		; jumptable 00402C69 default case

loc_402D87:				; CODE XREF: .text:00402C7Dj
					; .text:00402C94j ...
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, 1
		jz	short loc_402DB0
		cmp	eax, 1
		jb	short loc_402DA9
		cmp	eax, 7
		jz	short loc_402DB7
		cmp	eax, 13h
		jz	short loc_402DBE
		jmp	short loc_402DC5
; ---------------------------------------------------------------------------

loc_402DA9:				; CODE XREF: .text:00402D9Bj
		mov	eax, 0
		jmp	short loc_402DCA
; ---------------------------------------------------------------------------

loc_402DB0:				; CODE XREF: .text:00402D96j
		mov	eax, 7Fh
		jmp	short loc_402DCA
; ---------------------------------------------------------------------------

loc_402DB7:				; CODE XREF: .text:00402DA0j
		mov	eax, 9
		jmp	short loc_402DCA
; ---------------------------------------------------------------------------

loc_402DBE:				; CODE XREF: .text:00402DA5j
		mov	eax, 6
		jmp	short loc_402DCA
; ---------------------------------------------------------------------------

loc_402DC5:				; CODE XREF: .text:00402DA7j
		mov	eax, 1

loc_402DCA:				; CODE XREF: .text:00402DAEj
					; .text:00402DB5j ...
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402DCC	proc near		; CODE XREF: .text:0040300Dp

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	loc_402F53
; ---------------------------------------------------------------------------

loc_402DE4:				; CODE XREF: sub_402DCC+57j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	ecx, [ebp+arg_0]
		add	edx, ecx
		movzx	ecx, byte ptr [edx]
		mov	edx, [ebp+var_10]
		mov	[edx+eax+8], cl
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		add	[ebp+var_C], 1
		jmp	short loc_402E12
; ---------------------------------------------------------------------------

loc_402E11:				; CODE XREF: sub_402DCC+18Dj
		nop

loc_402E12:				; CODE XREF: sub_402DCC+43j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, 2
		jg	short loc_402E25
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	short loc_402DE4

loc_402E25:				; CODE XREF: sub_402DCC+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, 3
		jnz	loc_402F53
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_411618[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		mov	ecx, eax
		and	ecx, 30h
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+9]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_411618[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+9]
		movzx	eax, al
		shl	eax, 2
		mov	ecx, eax
		and	ecx, 3Ch
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+0Ah]
		shr	al, 6
		movzx	eax, al
		and	eax, 3
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_411618[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+0Ah]
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_411618[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		lea	edx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, 45h
		jle	short loc_402F49
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 0Ah ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0

loc_402F49:				; CODE XREF: sub_402DCC+15Bj
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0

loc_402F53:				; CODE XREF: sub_402DCC+13j
					; sub_402DCC+62j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_402E11
		leave
		retn
sub_402DCC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+14h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 1
		test	al, al
		jnz	short loc_402FE8
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jnz	short loc_402F95
		mov	eax, 0
		jmp	locret_40313B
; ---------------------------------------------------------------------------

loc_402F95:				; CODE XREF: .text:00402F89j
		mov	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_402FD3
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		or	edx, 8
		mov	[eax], dl
		mov	eax, [ebp-10h]
		mov	edx, [eax+18h]
		mov	eax, offset aBeginPgpPubl_0 ; "-----BEGIN PGP PUBLIC KEY BLOCK-----\n\"...
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 26h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		jmp	short loc_402FDD
; ---------------------------------------------------------------------------

loc_402FD3:				; CODE XREF: .text:00402F9Dj
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+14h], offset aBeginPgpPubl_1 ; "-----BEGIN PGP PUBLIC KEY BLOCK-----"

loc_402FDD:				; CODE XREF: .text:00402FD1j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		or	edx, 1
		mov	[eax], dl

loc_402FE8:				; CODE XREF: .text:00402F7Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 8
		test	al, al
		jz	short loc_403017
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		mov	edx, [ebp+14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_402DCC
		jmp	loc_403134
; ---------------------------------------------------------------------------

loc_403017:				; CODE XREF: .text:00402FF3j
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_403117
; ---------------------------------------------------------------------------

loc_403023:				; CODE XREF: .text:0040312Ej
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-14h]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-10h]
		mov	ecx, [eax+14h]
		mov	eax, [ebp-10h]
		mov	eax, [eax+0Ch]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	loc_4030CD
		mov	eax, [ebp-10h]
		mov	eax, [eax+0Ch]
		lea	edx, [eax+1]
		mov	eax, [ebp-10h]
		mov	[eax+0Ch], edx
		mov	eax, [ebp-10h]
		mov	edx, [eax+14h]
		mov	eax, [ebp-10h]
		mov	eax, [eax+0Ch]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4030D7
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jz	short loc_403085
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl
		jmp	short loc_4030D7
; ---------------------------------------------------------------------------

loc_403085:				; CODE XREF: .text:00403076j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		or	edx, 2
		mov	[eax], dl
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+14h], offset aEndPgpPublic_0 ; "-----END	PGP PUBLIC KEY BLOCK-----"
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp-10h]
		mov	edx, [eax+18h]
		mov	eax, offset aBeginPgpPubl_1 ; "-----BEGIN PGP PUBLIC KEY BLOCK-----"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 24h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		jmp	short loc_403113
; ---------------------------------------------------------------------------

loc_4030CD:				; CODE XREF: .text:00403041j
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+0Ch], 0

loc_4030D7:				; CODE XREF: .text:00403069j
					; .text:00403083j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jz	short loc_403113
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-14h]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_403113
		mov	eax, [ebp-10h]
		mov	edx, [eax+18h]
		mov	eax, [ebp-0Ch]
		mov	ecx, [ebp-14h]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc

loc_403113:				; CODE XREF: .text:004030CBj
					; .text:004030E2j ...
		add	dword ptr [ebp-0Ch], 1

loc_403117:				; CODE XREF: .text:0040301Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 4
		test	al, al
		jnz	short loc_403134
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		cmp	eax, [ebp-0Ch]
		ja	loc_403023

loc_403134:				; CODE XREF: .text:00403012j
					; .text:00403122j
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]

locret_40313B:				; CODE XREF: .text:00402F90j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		and	eax, 8
		test	al, al
		jz	locret_4032DE
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	eax, 2
		jnz	loc_403219
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_411618[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		mov	ecx, eax
		and	ecx, 30h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+9]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_411618[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+9]
		movzx	eax, al
		shl	eax, 2
		and	eax, 3Ch
		movzx	eax, ds:byte_411618[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	eax, [eax+18h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3Dh
		call	fputc
		jmp	loc_4032AC
; ---------------------------------------------------------------------------

loc_403219:				; CODE XREF: .text:0040315Dj
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	eax, 1
		jnz	loc_4032AC
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_411618[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		and	eax, 30h
		movzx	eax, ds:byte_411618[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	eax, [eax+18h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3Dh
		call	fputc
		mov	eax, [ebp+8]
		mov	eax, [eax+18h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3Dh
		call	fputc

loc_4032AC:				; CODE XREF: .text:00403214j
					; .text:00403222j
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, offset aEndPgpPublic_1 ; "\n-----END PGP PUBLIC KEY BLOCK-----"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 23h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl

locret_4032DE:				; CODE XREF: .text:0040314Ej
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40330E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40330E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_403365
; ---------------------------------------------------------------------------

loc_40330E:				; CODE XREF: .text:004032EEj
					; .text:004032F8j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_403336
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_403336
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_403365
; ---------------------------------------------------------------------------

loc_403336:				; CODE XREF: .text:00403316j
					; .text:00403320j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40335E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_40335E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_403365
; ---------------------------------------------------------------------------

loc_40335E:				; CODE XREF: .text:0040333Ej
					; .text:00403348j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4033E2
; ---------------------------------------------------------------------------

loc_403365:				; CODE XREF: .text:0040330Cj
					; .text:00403334j ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40338E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40338E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_4033DF
; ---------------------------------------------------------------------------

loc_40338E:				; CODE XREF: .text:00403371j
					; .text:0040337Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4033B3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4033B3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_4033DF
; ---------------------------------------------------------------------------

loc_4033B3:				; CODE XREF: .text:00403396j
					; .text:004033A0j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4033D8
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4033D8
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_4033DF
; ---------------------------------------------------------------------------

loc_4033D8:				; CODE XREF: .text:004033BBj
					; .text:004033C5j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4033E2
; ---------------------------------------------------------------------------

loc_4033DF:				; CODE XREF: .text:0040338Cj
					; .text:004033B1j ...
		mov	eax, [ebp-4]

locret_4033E2:				; CODE XREF: .text:00403363j
					; .text:004033DDj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4033E4	proc near		; CODE XREF: .text:00403431p
					; .text:00403444p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_4033F7
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_4033F7
		and	[ebp+arg_0], 0FFFFFFDFh

loc_4033F7:				; CODE XREF: sub_4033E4+7j
					; sub_4033E4+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_4033E4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_403457
		mov	eax, 0
		jmp	loc_4034B0
; ---------------------------------------------------------------------------

loc_403415:				; CODE XREF: .text:0040346Aj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_40344D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		call	sub_4033E4
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		call	sub_4033E4
		cmp	ebx, eax
		jnz	short loc_40346E

loc_40344D:				; CODE XREF: .text:00403423j
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_403458
; ---------------------------------------------------------------------------

loc_403457:				; CODE XREF: .text:00403409j
		nop

loc_403458:				; CODE XREF: .text:00403455j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40346F
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403415
		jmp	short loc_40346F
; ---------------------------------------------------------------------------

loc_40346E:				; CODE XREF: .text:0040344Bj
		nop

loc_40346F:				; CODE XREF: .text:00403460j
					; .text:0040346Cj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4034AB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		call	sub_4033E4
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		call	sub_4033E4
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_4034B0
; ---------------------------------------------------------------------------

loc_4034AB:				; CODE XREF: .text:0040347Dj
		mov	eax, 0

loc_4034B0:				; CODE XREF: .text:00403410j
					; .text:004034A9j
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4034B8	proc near		; CODE XREF: sub_40350C+1Ap
					; sub_40359F+21p ...

File		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+File],	eax ; int
		call	strerror
		mov	edx, offset aErrorAllocatin ; "error allocating	enough memory: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+Format], edx ;	Format
		mov	[esp+18h+File],	ecx ; File
		call	fprintf
		mov	[esp+18h+File],	2 ; Code
		call	exit
sub_4034B8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4034F9(size_t)
sub_4034F9	proc near		; CODE XREF: sub_407F82+29Ap
					; sub_408FF9+A5p ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_4034F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40350C(size_t)
sub_40350C	proc near		; CODE XREF: sub_404109+633p
					; sub_404109+822p ...

Size		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40352B
		call	sub_4034B8
; ---------------------------------------------------------------------------

loc_40352B:				; CODE XREF: sub_40350C+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40350C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403530(char *)
sub_403530	proc near		; CODE XREF: sub_407F82+1B9p
					; .text:00409382p

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jz	short loc_40357C
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+Dest]
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy

loc_40357C:				; CODE XREF: sub_403530+38j
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403530	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40359F(void *, size_t)
sub_40359F	proc near		; CODE XREF: sub_407613+128p

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4035C5
		call	sub_4034B8
; ---------------------------------------------------------------------------

loc_4035C5:				; CODE XREF: sub_40359F+1Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40359F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4035CA(size_t, size_t)
sub_4035CA	proc near		; CODE XREF: sub_40B956+188p
					; sub_40B956+2DEp

NumOfElements	= dword	ptr -18h
SizeOfElements	= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+SizeOfElements], eax ;	SizeOfElements
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+NumOfElements], eax ; NumOfElements
		call	calloc
		leave
		retn
sub_4035CA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4035E4(size_t, size_t)
sub_4035E4	proc near		; CODE XREF: sub_4039C6+121p
					; sub_404D30+15p ...

NumOfElements	= dword	ptr -28h
SizeOfElements	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+SizeOfElements], eax ;	SizeOfElements
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40360A
		call	sub_4034B8
; ---------------------------------------------------------------------------

loc_40360A:				; CODE XREF: sub_4035E4+1Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4035E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40360F(char *)
sub_40360F	proc near		; CODE XREF: .text:00404FB7p
					; sub_4051C5+12Ep ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_40364E
		call	sub_4034B8
; ---------------------------------------------------------------------------

loc_40364E:				; CODE XREF: sub_40360F+38j
		mov	eax, [ebp+Dest]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40360F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403669(void *)
sub_403669	proc near		; CODE XREF: sub_4019DF+247p
					; sub_403C54+2A2p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_403680
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_403680:				; CODE XREF: sub_403669+Aj
		leave
		retn
sub_403669	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403684	proc near		; CODE XREF: sub_4036AB+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4036A4
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4036A9
; ---------------------------------------------------------------------------

loc_4036A4:				; CODE XREF: sub_403684+7j
		mov	eax, 0

loc_4036A9:				; CODE XREF: sub_403684+1Ej
		pop	ebp
		retn
sub_403684	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4036AB	proc near		; CODE XREF: sub_4036C6+14p
					; sub_4036E1+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_403684
		leave
		retn
sub_4036AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4036C6	proc near		; CODE XREF: sub_403C54+C3p
					; sub_403C54+17Ep ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_4036AB
		leave
		retn
sub_4036C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4036E1	proc near		; CODE XREF: sub_404109+73Cp
					; sub_404109+78Bp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_4036AB
		leave
		retn
sub_4036E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4036F6(LPCSTR)
sub_4036F6	proc near		; CODE XREF: .text:0040713Fp

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4036F6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403714(HMODULE, LPCSTR)
sub_403714	proc near		; CODE XREF: .text:0040715Bp

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_403752
		cmp	[ebp+arg_4], 0
		jz	short loc_403752
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40374D
		mov	eax, 0
		jmp	short locret_403757
; ---------------------------------------------------------------------------

loc_40374D:				; CODE XREF: sub_403714+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_403757
; ---------------------------------------------------------------------------

loc_403752:				; CODE XREF: sub_403714+Aj
					; sub_403714+10j
		mov	eax, 0

locret_403757:				; CODE XREF: sub_403714+37j
					; sub_403714+3Cj
		leave
		retn
sub_403714	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403759(HANDLE)
sub_403759	proc near		; CODE XREF: .text:00407174p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_40377C
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_403781
; ---------------------------------------------------------------------------

loc_40377C:				; CODE XREF: sub_403759+Aj
		mov	eax, 0FFFFFFFFh

locret_403781:				; CODE XREF: sub_403759+21j
		leave
		retn
sub_403759	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403783	proc near		; CODE XREF: sub_4037F6+70p
					; sub_4039C6+93p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_4037C8
; ---------------------------------------------------------------------------

loc_403788:				; CODE XREF: sub_403783+57j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4037C0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4037AC
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4037C0

loc_4037AC:				; CODE XREF: sub_403783+1Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4037DC
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4037DC

loc_4037C0:				; CODE XREF: sub_403783+13j
					; sub_403783+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_4037C8:				; CODE XREF: sub_403783+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4037DC
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403788

loc_4037DC:				; CODE XREF: sub_403783+31j
					; sub_403783+3Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		pop	ebp
		retn
sub_403783	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4037F6	proc near		; CODE XREF: sub_4038DB+23p
					; sub_4038DB+6Ap ...

hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_403825
		mov	[esp+28h+var_20], 0E2h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hObject], offset aFname ; "fname"
		call	sub_40E8D0

loc_403825:				; CODE XREF: sub_4037F6+11j
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_403841
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aFd_cache_inval ; "fd_cache_invalidate (%s)\n"
		call	sub_409D4E

loc_403841:				; CODE XREF: sub_4037F6+36j
		mov	eax, ds:dword_414200
		mov	[ebp+var_C], eax
		jmp	short loc_4038BE
; ---------------------------------------------------------------------------

loc_40384B:				; CODE XREF: sub_4037F6+CCj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4038B6
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+hObject], edx
		call	sub_403783
		test	eax, eax
		jnz	short loc_4038B6
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_40388E
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aDidS	; "		   did (%s)\n"
		call	sub_409D4E

loc_40388E:				; CODE XREF: sub_4037F6+80j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		test	eax, eax
		jnz	short loc_4038AC
		mov	[ebp+var_10], 0FFFFFFFFh

loc_4038AC:				; CODE XREF: sub_4037F6+ADj
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh

loc_4038B6:				; CODE XREF: sub_4037F6+5Ej
					; sub_4037F6+77j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4038BE:				; CODE XREF: sub_4037F6+53j
		cmp	[ebp+var_C], 0
		jnz	short loc_40384B
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4037F6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4038C9	proc near		; CODE XREF: sub_405980+2A2p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4038C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4038DB(LPCSTR	lpFileName, char *)
sub_4038DB	proc near		; CODE XREF: sub_403B2B+122p
					; .text:004056C9p ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
dwDesiredAccess	= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Val], 2Bh ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_403928
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_4037F6
		test	eax, eax
		jz	short loc_403911
		mov	eax, 0FFFFFFFFh
		jmp	locret_4039C4
; ---------------------------------------------------------------------------

loc_403911:				; CODE XREF: sub_4038DB+2Aj
		mov	[ebp+dwDesiredAccess], 0C0000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 3
		jmp	short loc_403981
; ---------------------------------------------------------------------------

loc_403928:				; CODE XREF: sub_4038DB+1Bj
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_40396C
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_4037F6
		test	eax, eax
		jz	short loc_403955
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4039C4
; ---------------------------------------------------------------------------

loc_403955:				; CODE XREF: sub_4038DB+71j
		mov	[ebp+dwDesiredAccess], 40000000h
		mov	[ebp+var_10], 2
		mov	[ebp+var_14], 2
		jmp	short loc_403981
; ---------------------------------------------------------------------------

loc_40396C:				; CODE XREF: sub_4038DB+62j
		mov	[ebp+dwDesiredAccess], 80000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 1

loc_403981:				; CODE XREF: sub_4038DB+4Bj
					; sub_4038DB+8Fj
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	80h ; dwFlagsAndAttributes
		mov	eax, [ebp+var_10]
		mov	[esp+38h+dwCreationDisposition], eax ; dwCreationDisposition
		mov	[esp+38h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	eax, [ebp+var_14]
		mov	[esp+38h+dwShareMode], eax ; dwShareMode
		mov	eax, [ebp+dwDesiredAccess]
		mov	[esp+38h+Val], eax ; dwDesiredAccess
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax ; lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_4039C4:				; CODE XREF: sub_4038DB+31j
					; sub_4038DB+78j
		leave
		retn
sub_4038DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4039C6(char *, HANDLE)
sub_4039C6	proc near		; CODE XREF: sub_403C54+297p

hObject		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_4], 0
		jnz	short loc_4039EF
		mov	[esp+38h+var_30], 174h ; int
		mov	[esp+38h+Source], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+38h+hObject], offset aFp ;	"fp"
		call	sub_40E8D0

loc_4039EF:				; CODE XREF: sub_4039C6+Bj
		cmp	[ebp+arg_0], 0
		jz	short loc_4039FF
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403A34

loc_4039FF:				; CODE XREF: sub_4039C6+2Dj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	loc_403B22
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_close ; "fd_cache_close (%d) real\n"
		call	sub_409D4E
		jmp	loc_403B22
; ---------------------------------------------------------------------------

loc_403A34:				; CODE XREF: sub_4039C6+37j
		mov	eax, ds:dword_414200
		mov	[ebp+var_C], eax
		jmp	short loc_403A98
; ---------------------------------------------------------------------------

loc_403A3E:				; CODE XREF: sub_4039C6+D6j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_403A90
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax
		mov	[esp+38h+hObject], edx
		call	sub_403783
		test	eax, eax
		jnz	short loc_403A90
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	loc_403B25
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_0 ; "fd_cache_close (%s) used existing slot\"...
		call	sub_409D4E
		jmp	loc_403B25
; ---------------------------------------------------------------------------

loc_403A90:				; CODE XREF: sub_4039C6+81j
					; sub_4039C6+9Aj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_403A98:				; CODE XREF: sub_4039C6+76j
		cmp	[ebp+var_C], 0
		jnz	short loc_403A3E
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_403ABA
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_1 ; "fd_cache_close (%s) new slot created\n"
		call	sub_409D4E

loc_403ABA:				; CODE XREF: sub_4039C6+DFj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Source], eax ;	size_t
		mov	[esp+38h+hObject], 1 ; size_t
		call	sub_4035E4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+hObject], edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	edx, ds:dword_414200
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	ds:dword_414200, eax
		jmp	short loc_403B26
; ---------------------------------------------------------------------------

loc_403B22:				; CODE XREF: sub_4039C6+50j
					; sub_4039C6+69j
		nop
		jmp	short loc_403B26
; ---------------------------------------------------------------------------

loc_403B25:				; CODE XREF: sub_4039C6+ACj
					; sub_4039C6+C5j
		nop

loc_403B26:				; CODE XREF: sub_4039C6+15Aj
					; sub_4039C6+15Dj
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4039C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403B2B(LPCSTR	lpFileName, char *)
sub_403B2B	proc near		; CODE XREF: sub_4051C5+A0p

hFile		= dword	ptr -28h
lDistanceToMove	= dword	ptr -24h
lpDistanceToMoveHigh= dword ptr	-20h
dwMoveMethod	= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+lpFileName], 0
		jnz	short loc_403B53
		mov	[esp+28h+lpDistanceToMoveHigh],	19Dh ; int
		mov	[esp+28h+lDistanceToMove], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hFile], offset	aFname ; "fname"
		call	sub_40E8D0

loc_403B53:				; CODE XREF: sub_403B2B+Aj
		mov	eax, ds:dword_414200
		mov	[ebp+var_C], eax
		jmp	loc_403C1A
; ---------------------------------------------------------------------------

loc_403B60:				; CODE XREF: sub_403B2B+F3j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	loc_403C12
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax
		mov	[esp+28h+hFile], edx
		call	sub_403783
		test	eax, eax
		jnz	loc_403C12
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_403BBB
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_openS	; "fd_cache_open (%s) using cached fp\n"
		call	sub_409D4E

loc_403BBB:				; CODE XREF: sub_403B2B+7Bj
		mov	[esp+28h+dwMoveMethod],	0 ; dwMoveMethod
		mov	[esp+28h+lpDistanceToMoveHigh],	0 ; lpDistanceToMoveHigh
		mov	[esp+28h+lDistanceToMove], 0 ; lDistanceToMove
		mov	eax, [ebp+var_10]
		mov	[esp+28h+hFile], eax ; hFile
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_403C0D
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+lpDistanceToMoveHigh],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aRewindFileFail	; "rewind file failed on handle	%p: ec=%d\"...
		call	sub_409CB1
		mov	[ebp+var_10], 0FFFFFFFFh

loc_403C0D:				; CODE XREF: sub_403B2B+BBj
		mov	eax, [ebp+var_10]
		jmp	short locret_403C52
; ---------------------------------------------------------------------------

loc_403C12:				; CODE XREF: sub_403B2B+3Ej
					; sub_403B2B+5Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_403C1A:				; CODE XREF: sub_403B2B+30j
		cmp	[ebp+var_C], 0
		jnz	loc_403B60
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_403C40
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_ope_0	; "fd_cache_open (%s) not cached\n"
		call	sub_409D4E

loc_403C40:				; CODE XREF: sub_403B2B+100j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lDistanceToMove], eax ; char *
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+hFile], eax ; lpFileName
		call	sub_4038DB

locret_403C52:				; CODE XREF: sub_403B2B+E5j
		leave
		retn
sub_403B2B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403C54(int, int, int,	LPVOID,	int)
sub_403C54	proc near		; CODE XREF: sub_4051C5+175p
					; sub_4051C5+19Fp ...

hFile		= dword	ptr -58h
lpBuffer	= dword	ptr -54h
nNumberOfBytesToRead= dword ptr	-50h
lpNumberOfBytesRead= dword ptr -4Ch
lpOverlapped	= dword	ptr -48h
NumberOfBytesWritten= dword ptr	-30h
NumberOfBytesRead= dword ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
nNumberOfBytesToWrite= dword ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_403D6B
		cmp	[ebp+var_20], 0
		jnz	short loc_403CAA
		mov	[esp+58h+nNumberOfBytesToRead],	226h ; int
		mov	[esp+58h+lpBuffer], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+hFile], offset	aSize ;	"size"
		call	sub_40E8D0

loc_403CAA:				; CODE XREF: sub_403C54+38j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_403CC9
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_403EFB
; ---------------------------------------------------------------------------

loc_403CC9:				; CODE XREF: sub_403C54+5Ej
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesRead]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesRead
		mov	eax, [ebp+var_20]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToRead
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:ReadFile
		call	eax ; ReadFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_403D3E
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 6Dh
		jz	short loc_403D5E
		mov	eax, [ebp+var_24]
		mov	[esp+58h+hFile], eax
		call	sub_4036C6
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_24]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSReadErrorEcD ; "%s: read error: ec=%d\n"
		call	sub_409CB1
		jmp	short loc_403D5E
; ---------------------------------------------------------------------------

loc_403D3E:				; CODE XREF: sub_403C54+ABj
		mov	eax, [ebp+NumberOfBytesRead]
		test	eax, eax
		jnz	short loc_403D58
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_403D5E
; ---------------------------------------------------------------------------

loc_403D58:				; CODE XREF: sub_403C54+EFj
		mov	eax, [ebp+NumberOfBytesRead]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_403D5E:				; CODE XREF: sub_403C54+BBj
					; sub_403C54+E8j ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_403EFB
; ---------------------------------------------------------------------------

loc_403D6B:				; CODE XREF: sub_403C54+2Ej
		cmp	[ebp+arg_4], 4
		jnz	loc_403E27
		cmp	[ebp+var_20], 0
		jz	loc_403E1A
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_403D8B:				; CODE XREF: sub_403C54+1B5j
		cmp	[ebp+var_20], 0
		jz	short loc_403DF9
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesWritten
		mov	eax, [ebp+nNumberOfBytesToWrite]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToWrite
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:WriteFile
		call	eax ; WriteFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_403DF9
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+hFile], eax
		call	sub_4036C6
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_28]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSWriteErrorEcD	; "%s: write error: ec=%d\n"
		call	sub_409CB1
		jmp	short loc_403E0B
; ---------------------------------------------------------------------------

loc_403DF9:				; CODE XREF: sub_403C54+13Bj
					; sub_403C54+16Cj
		mov	eax, [ebp+NumberOfBytesWritten]
		add	[ebp+var_14], eax
		mov	eax, [ebp+NumberOfBytesWritten]
		sub	[ebp+nNumberOfBytesToWrite], eax
		cmp	[ebp+nNumberOfBytesToWrite], 0
		jnz	short loc_403D8B

loc_403E0B:				; CODE XREF: sub_403C54+1A3j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_403E1A:				; CODE XREF: sub_403C54+125j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_403EFB
; ---------------------------------------------------------------------------

loc_403E27:				; CODE XREF: sub_403C54+11Bj
		cmp	[ebp+arg_4], 1
		jnz	short loc_403E50
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	loc_403EFB
; ---------------------------------------------------------------------------

loc_403E50:				; CODE XREF: sub_403C54+1D7j
		cmp	[ebp+arg_4], 5
		jnz	short loc_403E64
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aFile_filterFd ; "file_filter(fd)"
		jmp	loc_403EFB
; ---------------------------------------------------------------------------

loc_403E64:				; CODE XREF: sub_403C54+200j
		cmp	[ebp+arg_4], 2
		jnz	loc_403EFB
		mov	[esp+58h+hFile], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_403EF0
		mov	[esp+58h+hFile], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_403EF0
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_403EC0
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSCloseHandleP ; "%s: close handle %p\n"
		call	sub_409D4E

loc_403EC0:				; CODE XREF: sub_403C54+24Dj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_403EF0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_403EDC
		mov	eax, [ebp+var_18]
		add	eax, 14h
		jmp	short loc_403EE1
; ---------------------------------------------------------------------------

loc_403EDC:				; CODE XREF: sub_403C54+27Ej
		mov	eax, 0

loc_403EE1:				; CODE XREF: sub_403C54+286j
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+lpBuffer], edx	; HANDLE
		mov	[esp+58h+hFile], eax ; char *
		call	sub_4039C6

loc_403EF0:				; CODE XREF: sub_403C54+22Ej
					; sub_403C54+244j ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hFile], eax ; void *
		call	sub_403669

loc_403EFB:				; CODE XREF: sub_403C54+70j
					; sub_403C54+112j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_403C54	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403F00(int, int, int,	char *,	int)
sub_403F00	proc near		; CODE XREF: sub_4054F1+B5p
					; sub_4054F1+DFp
					; DATA XREF: ...

s		= dword	ptr -48h
buf		= dword	ptr -44h
len		= dword	ptr -40h
flags		= dword	ptr -3Ch
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_403FF7
		cmp	[ebp+var_1C], 0
		jnz	short loc_403F4E
		mov	[esp+48h+len], 2CEh ; int
		mov	[esp+48h+buf], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+s], offset aSize ; "size"
		call	sub_40E8D0

loc_403F4E:				; CODE XREF: sub_403F00+30j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_403F6D
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_404104
; ---------------------------------------------------------------------------

loc_403F6D:				; CODE XREF: sub_403F00+56j
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+arg_C]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:recv
		call	eax ; recv
		sub	esp, 10h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_403FCB
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_24],	eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+s], eax
		call	sub_4036C6
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketReadErro ; "socket read error: ec=%d\n"
		call	sub_409CB1
		jmp	short loc_403FEA
; ---------------------------------------------------------------------------

loc_403FCB:				; CODE XREF: sub_403F00+9Cj
		cmp	[ebp+var_20], 0
		jnz	short loc_403FE4
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_403FEA
; ---------------------------------------------------------------------------

loc_403FE4:				; CODE XREF: sub_403F00+CFj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax

loc_403FEA:				; CODE XREF: sub_403F00+C9j
					; sub_403F00+E2j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	loc_404104
; ---------------------------------------------------------------------------

loc_403FF7:				; CODE XREF: sub_403F00+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_4040A0
		cmp	[ebp+var_1C], 0
		jz	loc_404096
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax

loc_404017:				; CODE XREF: sub_403F00+185j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+var_14]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0FFFFFFFFh
		jnz	short loc_404075
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_2C],	eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+s], eax
		call	sub_4036C6
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketWriteErr ; "socket write error: ec=%d\n"
		call	sub_409CB1
		jmp	short loc_404087
; ---------------------------------------------------------------------------

loc_404075:				; CODE XREF: sub_403F00+146j
		mov	eax, [ebp+var_28]
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_28]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404017

loc_404087:				; CODE XREF: sub_403F00+173j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax

loc_404096:				; CODE XREF: sub_403F00+105j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	short loc_404104
; ---------------------------------------------------------------------------

loc_4040A0:				; CODE XREF: sub_403F00+FBj
		cmp	[ebp+arg_4], 1
		jnz	short loc_4040C6
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	short loc_404104
; ---------------------------------------------------------------------------

loc_4040C6:				; CODE XREF: sub_403F00+1A4j
		cmp	[ebp+arg_4], 5
		jnz	short loc_4040D7
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aSock_filter ; "sock_filter"
		jmp	short loc_404104
; ---------------------------------------------------------------------------

loc_4040D7:				; CODE XREF: sub_403F00+1CAj
		cmp	[ebp+arg_4], 2
		jnz	short loc_404104
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_4040F9
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_4040F9:				; CODE XREF: sub_403F00+1E5j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+s], eax ; void	*
		call	sub_403669

loc_404104:				; CODE XREF: sub_403F00+68j
					; sub_403F00+F2j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_403F00	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404109	proc near		; DATA XREF: .text:004075C5o
					; .text:004075FEo

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_4046D5
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404164
		mov	[esp+48h+Size],	32Dh ; int
		mov	[esp+48h+Src], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aSize ; "size"
		call	sub_40E8D0

loc_404164:				; CODE XREF: sub_404109+3Dj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_4046AC
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4046AC
; ---------------------------------------------------------------------------

loc_40417E:				; CODE XREF: sub_404109+5ADj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_404692
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		cmp	eax, 2
		jnz	short loc_4041B7
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_4046BE
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4046BE
; ---------------------------------------------------------------------------

loc_4041B7:				; CODE XREF: sub_404109+8Cj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_4045DC
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_4041E4
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+18h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+18h], 0
		jmp	short loc_404262
; ---------------------------------------------------------------------------

loc_4041E4:				; CODE XREF: sub_404109+C4j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4041FE
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_40420B

loc_4041FE:				; CODE XREF: sub_404109+E3j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406A3A
		jmp	short loc_404241
; ---------------------------------------------------------------------------

loc_40420B:				; CODE XREF: sub_404109+F3j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_404241:				; CODE XREF: sub_404109+100j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_404262
		mov	[esp+48h+Dst], offset aBlock_filter1s ;	"block_filter: 1st length byte missing\n"
		call	sub_409CB1
		mov	[ebp+var_14], 59h
		jmp	loc_4046C8
; ---------------------------------------------------------------------------

loc_404262:				; CODE XREF: sub_404109+D9j
					; sub_404109+13Fj
		cmp	[ebp+var_10], 0BFh
		jg	short loc_4042AC
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_404692
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_4046C1
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4046C1
; ---------------------------------------------------------------------------

loc_4042AC:				; CODE XREF: sub_404109+160j
		cmp	[ebp+var_10], 0DFh
		jg	loc_404399
		mov	eax, [ebp+var_10]
		sub	eax, 0C0h
		shl	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4042E6
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4042F3

loc_4042E6:				; CODE XREF: sub_404109+1CBj
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406A3A
		jmp	short loc_404329
; ---------------------------------------------------------------------------

loc_4042F3:				; CODE XREF: sub_404109+1DBj
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_404329:				; CODE XREF: sub_404109+1E8j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_40434A
		mov	[esp+48h+Dst], offset aBlock_filter2n ;	"block_filter: 2nd length byte missing\n"
		call	sub_409CB1
		mov	[ebp+var_14], 59h
		jmp	loc_4046C8
; ---------------------------------------------------------------------------

loc_40434A:				; CODE XREF: sub_404109+227j
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	eax, edx
		lea	edx, [eax+0C0h]
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_404692
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_4046C4
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4046C4
; ---------------------------------------------------------------------------

loc_404399:				; CODE XREF: sub_404109+1AAj
		cmp	[ebp+var_10], 0FFh
		jnz	loc_4045BC
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4043C0
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4043D0

loc_4043C0:				; CODE XREF: sub_404109+2A5j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406A3A
		shl	eax, 18h
		jmp	short loc_404409
; ---------------------------------------------------------------------------

loc_4043D0:				; CODE XREF: sub_404109+2B5j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 18h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_404409:				; CODE XREF: sub_404109+2C5j
		mov	edx, [ebp+var_2C]
		mov	[edx+4], eax
		mov	eax, [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_40442F
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_40443F

loc_40442F:				; CODE XREF: sub_404109+314j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406A3A
		shl	eax, 10h
		jmp	short loc_404478
; ---------------------------------------------------------------------------

loc_40443F:				; CODE XREF: sub_404109+324j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_404478:				; CODE XREF: sub_404109+334j
		mov	edx, ebx
		or	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4044A2
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4044B2

loc_4044A2:				; CODE XREF: sub_404109+387j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406A3A
		shl	eax, 8
		jmp	short loc_4044EB
; ---------------------------------------------------------------------------

loc_4044B2:				; CODE XREF: sub_404109+397j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_4044EB:				; CODE XREF: sub_404109+3A7j
		mov	edx, ebx
		or	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_40450F
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_40451C

loc_40450F:				; CODE XREF: sub_404109+3F4j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406A3A
		jmp	short loc_404552
; ---------------------------------------------------------------------------

loc_40451C:				; CODE XREF: sub_404109+404j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_404552:				; CODE XREF: sub_404109+411j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_404573
		mov	[esp+48h+Dst], offset aBlock_filterIn ;	"block_filter: invalid 4 byte length\n"
		call	sub_409CB1
		mov	[ebp+var_14], 59h
		jmp	loc_4046C8
; ---------------------------------------------------------------------------

loc_404573:				; CODE XREF: sub_404109+450j
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		or	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_404692
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_4046C7
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4046C7
; ---------------------------------------------------------------------------

loc_4045BC:				; CODE XREF: sub_404109+297j
		mov	eax, [ebp+var_10]
		and	eax, 1Fh
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		jmp	loc_404692
; ---------------------------------------------------------------------------

loc_4045DC:				; CODE XREF: sub_404109+B6j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 386h
		mov	[esp+48h+Dst], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_409E40
; ---------------------------------------------------------------------------

loc_4045F8:				; CODE XREF: sub_404109+59Dj
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		cmovbe	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406AE3
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_34]
		jge	short loc_40466F
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_40463A
		mov	[ebp+var_10], 0

loc_40463A:				; CODE XREF: sub_404109+528j
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	edx, eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_C]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterPR ;	"block_filter %p: read error (size=%lu,a"...
		call	sub_409CB1
		mov	[ebp+var_14], 59h
		jmp	short loc_404692
; ---------------------------------------------------------------------------

loc_40466F:				; CODE XREF: sub_404109+522j
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		sub	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_1C], eax

loc_404692:				; CODE XREF: sub_404109+7Dj
					; sub_404109+17Dj ...
		cmp	[ebp+var_14], 0
		jnz	short loc_4046AC
		cmp	[ebp+var_C], 0
		jz	short loc_4046AC
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_4045F8

loc_4046AC:				; CODE XREF: sub_404109+63j
					; sub_404109+70j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_4046C8
		cmp	[ebp+var_C], 0
		jnz	loc_40417E
		jmp	short loc_4046C8
; ---------------------------------------------------------------------------

loc_4046BE:				; CODE XREF: sub_404109+9Cj
					; sub_404109+A9j
		nop
		jmp	short loc_4046C8
; ---------------------------------------------------------------------------

loc_4046C1:				; CODE XREF: sub_404109+191j
					; sub_404109+19Ej
		nop
		jmp	short loc_4046C8
; ---------------------------------------------------------------------------

loc_4046C4:				; CODE XREF: sub_404109+27Ej
					; sub_404109+28Bj
		nop
		jmp	short loc_4046C8
; ---------------------------------------------------------------------------

loc_4046C7:				; CODE XREF: sub_404109+4A1j
					; sub_404109+4AEj
		nop

loc_4046C8:				; CODE XREF: sub_404109+154j
					; sub_404109+23Cj ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		jmp	loc_404C3B
; ---------------------------------------------------------------------------

loc_4046D5:				; CODE XREF: sub_404109+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_40497E
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_404962
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, [ebp+var_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		cmp	eax, 200h
		jbe	short loc_404722
		mov	[esp+48h+Size],	3A7h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflenOp_min_ ;	"a->buflen <= OP_MIN_PARTIAL_CHUNK"
		call	sub_40E8D0

loc_404722:				; CODE XREF: sub_404109+5FBj
		cmp	[ebp+var_28], 1FFh
		ja	short loc_404785
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_404749
		mov	[esp+48h+Dst], 200h ; size_t
		call	sub_40350C
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+10h], edx

loc_404749:				; CODE XREF: sub_404109+62Aj
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, eax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+var_2C]
		mov	[eax+14h], edx
		jmp	loc_404C3B
; ---------------------------------------------------------------------------

loc_404785:				; CODE XREF: sub_404109+620j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax

loc_40478B:				; CODE XREF: sub_404109+7ACj
		mov	[ebp+var_20], 400h
		mov	[ebp+var_10], 0Ah
		jmp	short loc_4047A2
; ---------------------------------------------------------------------------

loc_40479B:				; CODE XREF: sub_404109+69Fj
		shl	[ebp+var_20], 1
		add	[ebp+var_10], 1

loc_4047A2:				; CODE XREF: sub_404109+690j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_28]
		jbe	short loc_40479B
		mov	eax, [ebp+var_20]
		shr	eax, 1
		mov	[ebp+var_20], eax
		sub	[ebp+var_10], 1
		cmp	[ebp+var_10], 1Fh
		jle	short loc_4047D8
		mov	[esp+48h+Size],	3BFh ; int
		mov	[esp+48h+Src], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aC0x1f ; "c <= 0x1f"
		call	sub_40E8D0

loc_4047D8:				; CODE XREF: sub_404109+6B1j
		or	[ebp+var_10], 0E0h
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406D61
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_40485D
		cmp	[ebp+var_24], 200h
		jz	short loc_404825
		mov	[esp+48h+Size],	3C4h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNOp_min_partia ;	"n == OP_MIN_PARTIAL_CHUNK"
		call	sub_40E8D0

loc_404825:				; CODE XREF: sub_404109+6FEj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406E06
		test	eax, eax
		jz	short loc_40484D
		call	sub_4036E1
		mov	[ebp+var_14], eax

loc_40484D:				; CODE XREF: sub_404109+73Aj
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax

loc_40485D:				; CODE XREF: sub_404109+6F5j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_20]
		jbe	short loc_404871
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax

loc_404871:				; CODE XREF: sub_404109+760j
		cmp	[ebp+var_24], 0
		jz	short loc_40489C
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406E06
		test	eax, eax
		jz	short loc_40489C
		call	sub_4036E1
		mov	[ebp+var_14], eax

loc_40489C:				; CODE XREF: sub_404109+76Cj
					; sub_404109+789j
		mov	eax, [ebp+var_24]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4048BB
		cmp	[ebp+var_28], 1FFh
		ja	loc_40478B

loc_4048BB:				; CODE XREF: sub_404109+7A3j
		cmp	[ebp+var_14], 0
		jnz	loc_404C3B
		cmp	[ebp+var_28], 0
		jz	loc_404C3B
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_4048F5
		mov	[esp+48h+Size],	3D5h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflen ; "!a->buflen"
		call	sub_40E8D0

loc_4048F5:				; CODE XREF: sub_404109+7CEj
		cmp	[ebp+var_28], 1FFh
		jbe	short loc_40491A
		mov	[esp+48h+Size],	3D6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNbytesOp_min_p ;	"nbytes	< OP_MIN_PARTIAL_CHUNK"
		call	sub_40E8D0

loc_40491A:				; CODE XREF: sub_404109+7F3j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_404938
		mov	[esp+48h+Dst], 200h ; size_t
		call	sub_40350C
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+10h], edx

loc_404938:				; CODE XREF: sub_404109+819j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+var_28]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		jmp	loc_404C3B
; ---------------------------------------------------------------------------

loc_404962:				; CODE XREF: sub_404109+5DEj
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 3DFh
		mov	[esp+48h+Dst], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_409E40
; ---------------------------------------------------------------------------

loc_40497E:				; CODE XREF: sub_404109+5D0j
		cmp	[ebp+arg_4], 1
		jnz	loc_404A0B
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_4049A4
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aInitBlock_filt ;	"init block_filter %p\n"
		call	sub_409D4E

loc_4049A4:				; CODE XREF: sub_404109+886j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4049BA
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+8], 0
		jmp	short loc_4049E8
; ---------------------------------------------------------------------------

loc_4049BA:				; CODE XREF: sub_404109+8A3j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_4049DC
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_2C]
		mov	[eax+8], edx
		jmp	short loc_4049E8
; ---------------------------------------------------------------------------

loc_4049DC:				; CODE XREF: sub_404109+8B9j
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_2C]
		mov	[eax+8], edx

loc_4049E8:				; CODE XREF: sub_404109+8AFj
					; sub_404109+8D1j
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_404C3B
; ---------------------------------------------------------------------------

loc_404A0B:				; CODE XREF: sub_404109+879j
		cmp	[ebp+arg_4], 5
		jnz	short loc_404A1F
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax], offset	aBlock_filter_0	; "block_filter"
		jmp	loc_404C3B
; ---------------------------------------------------------------------------

loc_404A1F:				; CODE XREF: sub_404109+906j
		cmp	[ebp+arg_4], 2
		jnz	loc_404C3B
		mov	eax, [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	loc_404BFE
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_404BE2
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0BFh
		ja	short loc_404A71
		mov	eax, [ebp+var_38]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406D61
		mov	[ebp+var_14], eax
		jmp	loc_404B64
; ---------------------------------------------------------------------------

loc_404A71:				; CODE XREF: sub_404109+94Cj
		cmp	[ebp+var_38], 20BFh
		ja	short loc_404ACA
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		shr	eax, 8
		add	eax, 0C0h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406D61
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_404B64
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406D61
		mov	[ebp+var_14], eax
		jmp	loc_404B64
; ---------------------------------------------------------------------------

loc_404ACA:				; CODE XREF: sub_404109+96Fj
		mov	[esp+48h+Src], 0FFh
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406D61
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_404B64
		mov	eax, [ebp+var_38]
		shr	eax, 18h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406D61
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_404B64
		mov	eax, [ebp+var_38]
		shr	eax, 10h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406D61
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_404B64
		mov	eax, [ebp+var_38]
		shr	eax, 8
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406D61
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_404B64
		mov	eax, [ebp+var_38]
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406D61
		mov	[ebp+var_14], eax

loc_404B64:				; CODE XREF: sub_404109+963j
					; sub_404109+997j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_404B8F
		cmp	[ebp+var_38], 0
		jz	short loc_404B8F
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_38]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_406E06
		mov	[ebp+var_14], eax

loc_404B8F:				; CODE XREF: sub_404109+A5Fj
					; sub_404109+A65j
		cmp	[ebp+var_14], 0
		jz	short loc_404BBE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dst], eax ; int
		call	strerror
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterWr ;	"block_filter: write error: %s\n"
		call	sub_409CB1
		call	sub_4036E1
		mov	[ebp+var_14], eax

loc_404BBE:				; CODE XREF: sub_404109+A8Aj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	[esp+48h+Dst], eax ; void *
		call	sub_403669
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_404C14
; ---------------------------------------------------------------------------

loc_404BE2:				; CODE XREF: sub_404109+936j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 423h
		mov	[esp+48h+Dst], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_409E40
; ---------------------------------------------------------------------------

loc_404BFE:				; CODE XREF: sub_404109+928j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_404C14
		mov	[esp+48h+Dst], offset aBlock_filterPe ;	"block_filter: pending bytes!\n"
		call	sub_409CB1

loc_404C14:				; CODE XREF: sub_404109+AD7j
					; sub_404109+AFDj
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_404C30
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aFreeBlock_filt ;	"free block_filter %p\n"
		call	sub_409D4E

loc_404C30:				; CODE XREF: sub_404109+B12j
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Dst], eax ; void *
		call	sub_403669

loc_404C3B:				; CODE XREF: sub_404109+5C7j
					; sub_404109+677j ...
		mov	eax, [ebp+var_14]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_404109	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404C44	proc near		; CODE XREF: .text:00404D24p
					; sub_405C5D+2CBp ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jnz	loc_404D06
		jmp	loc_404D10
; ---------------------------------------------------------------------------

loc_404C5F:				; CODE XREF: sub_404C44+C6j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], offset aNone ; "[none]"
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_404CA6
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_38], edx
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	[esp+48h+var_48], eax
		call	ecx

loc_404CA6:				; CODE XREF: sub_404C44+31j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edi, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	esi, eax
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+38h]
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_404CC8
		mov	eax, [ebp+var_20]
		jmp	short loc_404CCD
; ---------------------------------------------------------------------------

loc_404CC8:				; CODE XREF: sub_404C44+7Dj
		mov	eax, offset a?_0 ; "?"

loc_404CCD:				; CODE XREF: sub_404C44+82j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_30], edi
		mov	[esp+48h+var_34], esi
		mov	[esp+48h+var_38], ebx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufChainD_DS ; "iobuf chain: %d.%d `%s' filter_eof=%d s"...
		call	sub_409D4E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_404D06:				; CODE XREF: sub_404C44+10j
		cmp	[ebp+arg_0], 0
		jnz	loc_404C5F

loc_404D10:				; CODE XREF: sub_404C44+16j
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_404C44	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404C44
		mov	eax, 0
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404D30(int, size_t)
sub_404D30	proc near		; CODE XREF: .text:0040505Ap
					; .text:0040507Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 68h ;	size_t
		mov	[esp+28h+var_28], 1 ; size_t
		call	sub_4035E4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_40350C
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+28h], edx
		mov	eax, ds:dword_414210
		add	eax, 1
		mov	ds:dword_414210, eax
		mov	edx, ds:dword_414210
		mov	eax, [ebp+var_C]
		mov	[eax+54h], edx
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+58h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+60h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4Ch], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_404D30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404DAD(void *)
sub_404DAD	proc near		; CODE XREF: sub_4019DF+252p
					; .text:00405018p

File		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	loc_404F5C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_404F5C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax ; void *
		call	sub_403669
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_404E15
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_closeP ; "iobuf_close -> %p\n"
		call	sub_409D4E

loc_404E15:				; CODE XREF: sub_404DAD+50j
		mov	eax, 0
		jmp	loc_404F6F
; ---------------------------------------------------------------------------

loc_404E1F:				; CODE XREF: sub_404DAD+1B9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_404E61
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax
		call	sub_4068CC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404E61
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_flushFai ; "iobuf_flush failed on	close: %s\n"
		call	sub_409CB1

loc_404E61:				; CODE XREF: sub_404DAD+83j
					; sub_404DAD+97j
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_404EA5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_404E7C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_404E81
; ---------------------------------------------------------------------------

loc_404E7C:				; CODE XREF: sub_404DAD+C5j
		mov	eax, offset a?_0 ; "?"

loc_404E81:				; CODE XREF: sub_404DAD+CDj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+38h+var_2C], eax
		mov	[esp+38h+Size],	ecx
		mov	[esp+38h+Val], edx ; char
		mov	[esp+38h+File],	offset aIobufD_DCloseS ; "iobuf-%d.%d: close `%s'\n"
		call	sub_409D4E

loc_404EA5:				; CODE XREF: sub_404DAD+BBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_404F05
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_14]
		mov	[esp+38h+var_28], ecx
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Val], 2
		mov	[esp+38h+File],	eax
		call	ebx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404F05
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobufctrl_free ; "IOBUFCTRL_FREE failed	on close: %s\n"
		call	sub_409CB1

loc_404F05:				; CODE XREF: sub_404DAD+100j
					; sub_404DAD+13Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax ; void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		test	eax, eax
		jz	short loc_404F4B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+File],	eax ; Dst
		call	memset
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+File],	eax ; void *
		call	sub_403669

loc_404F4B:				; CODE XREF: sub_404DAD+16Ej
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax ; void *
		call	sub_403669
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax

loc_404F5C:				; CODE XREF: sub_404DAD+19j
					; sub_404DAD+27j
		cmp	[ebp+arg_0], 0
		jz	short loc_404F6C
		cmp	[ebp+var_C], 0
		jz	loc_404E1F

loc_404F6C:				; CODE XREF: sub_404DAD+1B3j
		mov	eax, [ebp+var_C]

loc_404F6F:				; CODE XREF: sub_404DAD+6Dj
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_404DAD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_404FBF
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_404FBF
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40749A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_404FBF
		mov	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404FBF
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40360F
		mov	[ebp-10h], eax

loc_404FBF:				; CODE XREF: .text:00404F87j
					; .text:00404F91j ...
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_40500C
; ---------------------------------------------------------------------------

loc_404FC7:				; CODE XREF: .text:00405010j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_405003
		mov	eax, [ebp-0Ch]
		mov	ebx, [eax+40h]
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+50h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+44h]
		lea	ecx, [ebp-1Ch]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 6
		mov	[esp], eax
		call	ebx

loc_405003:				; CODE XREF: .text:00404FCFj
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+50h]
		mov	[ebp-0Ch], eax

loc_40500C:				; CODE XREF: .text:00404FC5j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_404FC7
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404DAD
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40503C
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	remove
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_403669

loc_40503C:				; CODE XREF: .text:00405024j
		mov	eax, [ebp-18h]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 3
		call	sub_404D30
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	sub_404D30
		mov	[ebp-0Ch], eax
		mov	edx, [ebp+8]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp+0Ch]
		mov	[eax+30h], edx
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_414204, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4050BA(char *)
sub_4050BA	proc near		; CODE XREF: .text:00405162p
					; sub_4051C5+5Cp ...

Str		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_414204
		test	eax, eax
		jz	short loc_40512B
		cmp	[ebp+arg_0], 0
		jz	short loc_40512B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40512B
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 26h
		jnz	short loc_40512B
		add	[ebp+arg_0], 2
		mov	[ebp+var_C], 0
		jmp	short loc_4050F7
; ---------------------------------------------------------------------------

loc_4050F3:				; CODE XREF: sub_4050BA+55j
		add	[ebp+var_C], 1

loc_4050F7:				; CODE XREF: sub_4050BA+37j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_405111
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4050F3

loc_405111:				; CODE XREF: sub_4050BA+48j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40512B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	atoi
		jmp	short locret_405130
; ---------------------------------------------------------------------------

loc_40512B:				; CODE XREF: sub_4050BA+Dj
					; sub_4050BA+13j ...
		mov	eax, 0FFFFFFFFh

locret_405130:				; CODE XREF: sub_4050BA+6Fj
		leave
		retn
sub_4050BA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_405155
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40515C
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40515C

loc_405155:				; CODE XREF: .text:0040513Cj
		mov	eax, 1
		jmp	short locret_405170
; ---------------------------------------------------------------------------

loc_40515C:				; CODE XREF: .text:00405146j
					; .text:00405153j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4050BA
		cmp	eax, 0FFFFFFFFh
		setnz	al
		movzx	eax, al

locret_405170:				; CODE XREF: .text:0040515Aj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jnz	short loc_40518E
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4051C5
		mov	[ebp-0Ch], eax
		jmp	short loc_4051C0
; ---------------------------------------------------------------------------

loc_40518E:				; CODE XREF: .text:0040517Cj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_dup
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_4051AB
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4051C0
; ---------------------------------------------------------------------------

loc_4051AB:				; CODE XREF: .text:004051A0j
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4053AC
		mov	[ebp-0Ch], eax

loc_4051C0:				; CODE XREF: .text:0040518Cj
					; .text:004051A9j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4051C5(LPCSTR	lpFileName)
sub_4051C5	proc near		; CODE XREF: .text:00405184p

nStdHandle	= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_20], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+lpFileName], 0
		jz	short loc_4051F7
		mov	eax, [ebp+lpFileName]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40521B
		mov	eax, [ebp+lpFileName]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40521B

loc_4051F7:				; CODE XREF: sub_4051C5+19j
		mov	[esp+58h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	[ebp+lpFileName], offset aStdin	; "[stdin]"
		mov	[ebp+var_10], 1
		jmp	short loc_40527D
; ---------------------------------------------------------------------------

loc_40521B:				; CODE XREF: sub_4051C5+23j
					; sub_4051C5+30j
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; char *
		call	sub_4050BA
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0FFFFFFFFh
		jz	short loc_405257
		mov	[esp+58h+Source], 0
		mov	eax, [ebp+var_14]
		mov	[esp+58h+nStdHandle], eax
		call	sub_4077F2
		mov	[esp+58h+Source], offset aRb ; "rb"
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_4053AC
		jmp	loc_4053A7
; ---------------------------------------------------------------------------

loc_405257:				; CODE XREF: sub_4051C5+68j
		mov	[esp+58h+Source], offset aRb ; "rb"
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; lpFileName
		call	sub_403B2B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40527D
		mov	eax, 0
		jmp	loc_4053A7
; ---------------------------------------------------------------------------

loc_40527D:				; CODE XREF: sub_4051C5+54j
					; sub_4051C5+ACj
		mov	[esp+58h+Source], 2000h	; size_t
		mov	[esp+58h+nStdHandle], 1	; int
		call	sub_404D30
		mov	[ebp+var_18], eax
		mov	eax, [ebp+lpFileName]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp+58h+nStdHandle], eax ; size_t
		call	sub_40350C
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+14h]
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+Source], eax ;	Source
		mov	[esp+58h+nStdHandle], edx ; Dest
		call	strcpy
		cmp	[ebp+var_10], 0
		jnz	short loc_405300
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; char *
		call	sub_40360F
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4Ch], edx

loc_405300:				; CODE XREF: sub_4051C5+126j
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+40h], offset sub_403C54
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_18]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], edx ;	LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 5 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_403C54
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], 0 ; LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 1 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_403C54
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_4053A4
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	ecx, eax
		mov	eax, [ebp+var_18]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+54h]
		mov	[esp+58h+var_48], ecx
		mov	ecx, [ebp+lpFileName]
		mov	[esp+58h+var_4C], ecx
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+nStdHandle], offset aIobufD_DOpenSF ; "iobuf-%d.%d: open `%s' fd=%d\n"
		call	sub_409D4E

loc_4053A4:				; CODE XREF: sub_4051C5+1ABj
		mov	eax, [ebp+var_18]

loc_4053A7:				; CODE XREF: sub_4051C5+8Dj
					; sub_4051C5+B3j
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4051C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4053AC(int, char *)
sub_4053AC	proc near		; CODE XREF: .text:004051B8p
					; sub_4051C5+88p ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4053D6
		mov	eax, 2
		jmp	short loc_4053DB
; ---------------------------------------------------------------------------

loc_4053D6:				; CODE XREF: sub_4053AC+21j
		mov	eax, 1

loc_4053DB:				; CODE XREF: sub_4053AC+28j
		mov	[esp+38h+Val], 2000h ; size_t
		mov	[esp+38h+Str], eax ; int
		call	sub_404D30
		mov	[ebp+var_10], eax
		mov	[esp+38h+Str], 2Ch ; size_t
		call	sub_40350C
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aFdD ; "[fd	%d]"
		mov	edx, [ebp+var_14]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; Format
		mov	[esp+38h+Str], ecx ; Dest
		call	sprintf
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+40h], offset sub_403C54
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_10]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], edx ;	LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 5 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_403C54
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 0 ; LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 1 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_403C54
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_4054C9
		mov	eax, [ebp+var_14]
		lea	ecx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+54h]
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aIobufD_DFdopen ;	"iobuf-%d.%d: fdopen `%s'\n"
		call	sub_409D4E

loc_4054C9:				; CODE XREF: sub_4053AC+F1j
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+Val], 3
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_405980
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4053AC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4054F1(int, char *)
sub_4054F1	proc near		; CODE XREF: sub_4019DF+CBp

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_405515
		mov	eax, 2
		jmp	short loc_40551A
; ---------------------------------------------------------------------------

loc_405515:				; CODE XREF: sub_4054F1+1Bj
		mov	eax, 1

loc_40551A:				; CODE XREF: sub_4054F1+22j
		mov	[esp+38h+Val], 2000h ; size_t
		mov	[esp+38h+Str], eax ; int
		call	sub_404D30
		mov	[ebp+var_C], eax
		mov	[esp+38h+Str], 31h ; size_t
		call	sub_40350C
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aSockD ; "[sock %d]"
		mov	edx, [ebp+var_10]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; Format
		mov	[esp+38h+Str], ecx ; Dest
		call	sprintf
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+40h], offset sub_403F00
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_C]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], edx ;	char *
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 5 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax ; int
		call	sub_403F00
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 0 ; char *
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 1 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax ; int
		call	sub_403F00
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_405608
		mov	eax, [ebp+var_10]
		lea	ecx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+54h]
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aIobufD_DSockop ;	"iobuf-%d.%d: sockopen `%s'\n"
		call	sub_409D4E

loc_405608:				; CODE XREF: sub_4054F1+EBj
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+Val], 3
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_405980
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4054F1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40565B
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40567F
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40567F

loc_40565B:				; CODE XREF: .text:00405642j
		mov	dword ptr [esp], 0FFFFFFF5h
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp+8], offset aStdout ; "[stdout]"
		mov	dword ptr [ebp-10h], 1
		jmp	short loc_4056E1
; ---------------------------------------------------------------------------

loc_40567F:				; CODE XREF: .text:0040564Cj
					; .text:00405659j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4050BA
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0FFFFFFFFh
		jz	short loc_4056BB
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_4077F2
		mov	dword ptr [esp+4], offset aWb ;	"wb"
		mov	[esp], eax
		call	sub_4053AC
		jmp	loc_405814
; ---------------------------------------------------------------------------

loc_4056BB:				; CODE XREF: .text:00405691j
		mov	dword ptr [esp+4], offset aWb ;	"wb"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4038DB
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_4056E1
		mov	eax, 0
		jmp	loc_405814
; ---------------------------------------------------------------------------

loc_4056E1:				; CODE XREF: .text:0040567Dj
					; .text:004056D5j
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_404D30
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	sub_40350C
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-10h]
		mov	[eax+10h], edx
		mov	eax, [ebp-1Ch]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_405764
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40360F
		mov	edx, eax
		mov	eax, [ebp-18h]
		mov	[eax+4Ch], edx

loc_405764:				; CODE XREF: .text:0040574Fj
		mov	eax, [ebp-18h]
		mov	dword ptr [eax+40h], offset sub_403C54
		mov	eax, [ebp-18h]
		mov	edx, [ebp-1Ch]
		mov	[eax+44h], edx
		mov	eax, [ebp-18h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_403C54
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_403C54
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_405811
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_4057E8
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		jmp	short loc_4057ED
; ---------------------------------------------------------------------------

loc_4057E8:				; CODE XREF: .text:004057DEj
		mov	eax, offset a?_0 ; "?"

loc_4057ED:				; CODE XREF: .text:004057E6j
		mov	edx, [ebp-18h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-18h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DCreate	; "iobuf-%d.%d:	create `%s'\n"
		call	sub_409D4E

loc_405811:				; CODE XREF: .text:004057D4j
		mov	eax, [ebp-18h]

loc_405814:				; CODE XREF: .text:004056B6j
					; .text:004056DCj
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_405830
		mov	eax, 0
		jmp	loc_40597A
; ---------------------------------------------------------------------------

loc_405830:				; CODE XREF: .text:00405824j
		mov	dword ptr [esp+4], offset aRB ;	"r+b"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4038DB
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_405856
		mov	eax, 0
		jmp	loc_40597A
; ---------------------------------------------------------------------------

loc_405856:				; CODE XREF: .text:0040584Aj
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_404D30
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	sub_40350C
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-14h]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40360F
		mov	edx, eax
		mov	eax, [ebp-10h]
		mov	[eax+4Ch], edx
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+40h], offset sub_403C54
		mov	eax, [ebp-10h]
		mov	edx, [ebp-14h]
		mov	[eax+44h], edx
		mov	eax, [ebp-10h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_403C54
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_403C54
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_405977
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_40594E
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		jmp	short loc_405953
; ---------------------------------------------------------------------------

loc_40594E:				; CODE XREF: .text:00405944j
		mov	eax, offset a?_0 ; "?"

loc_405953:				; CODE XREF: .text:0040594Cj
		mov	edx, [ebp-10h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-10h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DOpenrw	; "iobuf-%d.%d:	openrw `%s'\n"
		call	sub_409D4E

loc_405977:				; CODE XREF: .text:0040593Aj
		mov	eax, [ebp-10h]

loc_40597A:				; CODE XREF: .text:0040582Bj
					; .text:00405851j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405980	proc near		; CODE XREF: sub_4053AC+13Bp
					; sub_4054F1+135p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		cmp	[ebp+arg_4], 1
		jnz	loc_405A7C
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	loc_405A71
		cmp	[ebp+arg_0], 0
		jz	short loc_4059B6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_4059B6
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_4059BB
; ---------------------------------------------------------------------------

loc_4059B6:				; CODE XREF: sub_405980+22j
					; sub_405980+2Cj
		mov	ecx, offset a?_0 ; "?"

loc_4059BB:				; CODE XREF: sub_405980+34j
		cmp	[ebp+arg_0], 0
		jz	short loc_4059C9
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_4059CE
; ---------------------------------------------------------------------------

loc_4059C9:				; CODE XREF: sub_405980+3Fj
		mov	edx, 0FFFFFFFFh

loc_4059CE:				; CODE XREF: sub_405980+47j
		cmp	[ebp+arg_0], 0
		jz	short loc_4059DC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_4059E1
; ---------------------------------------------------------------------------

loc_4059DC:				; CODE XREF: sub_405980+52j
		mov	eax, 0FFFFFFFFh

loc_4059E1:				; CODE XREF: sub_405980+5Aj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoctlS ; "iobuf-%d.%d: ioctl `%s' keep=%d\n"
		call	sub_409D4E
		jmp	short loc_405A71
; ---------------------------------------------------------------------------

loc_405A02:				; CODE XREF: sub_405980+F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_405A35
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_403C54
		jnz	short loc_405A35
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_405C2E
; ---------------------------------------------------------------------------

loc_405A35:				; CODE XREF: sub_405980+8Aj
					; sub_405980+97j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_405A68
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_403F00
		jnz	short loc_405A68
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_405C2E
; ---------------------------------------------------------------------------

loc_405A68:				; CODE XREF: sub_405980+BDj
					; sub_405980+CAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_405A71:				; CODE XREF: sub_405980+18j
					; sub_405980+80j
		cmp	[ebp+arg_0], 0
		jnz	short loc_405A02
		jmp	loc_405C29
; ---------------------------------------------------------------------------

loc_405A7C:				; CODE XREF: sub_405980+Bj
		cmp	[ebp+arg_4], 2
		jnz	short loc_405AEC
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_405AAB
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_405A96
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_405A9B
; ---------------------------------------------------------------------------

loc_405A96:				; CODE XREF: sub_405980+10Fj
		mov	eax, offset a?_0 ; "?"

loc_405A9B:				; CODE XREF: sub_405980+114j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSIn ; "iobuf-*.*: ioctl `%s' invalidate\n"
		call	sub_409D4E

loc_405AAB:				; CODE XREF: sub_405980+109j
		cmp	[ebp+arg_0], 0
		jnz	loc_405C29
		cmp	[ebp+arg_8], 0
		jnz	loc_405C29
		cmp	dword ptr [ebp+arg_C], 0
		jz	loc_405C29
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_4037F6
		test	eax, eax
		jz	short loc_405AE2
		mov	eax, 0FFFFFFFFh
		jmp	loc_405C2E
; ---------------------------------------------------------------------------

loc_405AE2:				; CODE XREF: sub_405980+156j
		mov	eax, 0
		jmp	loc_405C2E
; ---------------------------------------------------------------------------

loc_405AEC:				; CODE XREF: sub_405980+100j
		cmp	[ebp+arg_4], 3
		jnz	loc_405BDB
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	loc_405BD3
		cmp	[ebp+arg_0], 0
		jz	short loc_405B1B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_405B1B
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_405B20
; ---------------------------------------------------------------------------

loc_405B1B:				; CODE XREF: sub_405980+187j
					; sub_405980+191j
		mov	ecx, offset a?_0 ; "?"

loc_405B20:				; CODE XREF: sub_405980+199j
		cmp	[ebp+arg_0], 0
		jz	short loc_405B2E
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_405B33
; ---------------------------------------------------------------------------

loc_405B2E:				; CODE XREF: sub_405980+1A4j
		mov	edx, 0FFFFFFFFh

loc_405B33:				; CODE XREF: sub_405980+1ACj
		cmp	[ebp+arg_0], 0
		jz	short loc_405B41
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_405B46
; ---------------------------------------------------------------------------

loc_405B41:				; CODE XREF: sub_405980+1B7j
		mov	eax, 0FFFFFFFFh

loc_405B46:				; CODE XREF: sub_405980+1BFj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoct_0 ; "iobuf-%d.%d: ioctl `%s' no_cache=%d\n"
		call	sub_409D4E
		jmp	short loc_405BD3
; ---------------------------------------------------------------------------

loc_405B67:				; CODE XREF: sub_405980+257j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_405B9A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_403C54
		jnz	short loc_405B9A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	loc_405C2E
; ---------------------------------------------------------------------------

loc_405B9A:				; CODE XREF: sub_405980+1EFj
					; sub_405980+1FCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_405BCA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_403F00
		jnz	short loc_405BCA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	short loc_405C2E
; ---------------------------------------------------------------------------

loc_405BCA:				; CODE XREF: sub_405980+222j
					; sub_405980+22Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_405BD3:				; CODE XREF: sub_405980+17Dj
					; sub_405980+1E5j
		cmp	[ebp+arg_0], 0
		jnz	short loc_405B67
		jmp	short loc_405C29
; ---------------------------------------------------------------------------

loc_405BDB:				; CODE XREF: sub_405980+170j
		cmp	[ebp+arg_4], 4
		jnz	short loc_405C29
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_405C0A
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_405BF5
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_405BFA
; ---------------------------------------------------------------------------

loc_405BF5:				; CODE XREF: sub_405980+26Ej
		mov	eax, offset aNull ; "<null>"

loc_405BFA:				; CODE XREF: sub_405980+273j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSFs ; "iobuf-*.*: ioctl `%s' fsync\n"
		call	sub_409D4E

loc_405C0A:				; CODE XREF: sub_405980+268j
		cmp	[ebp+arg_0], 0
		jnz	short loc_405C29
		cmp	[ebp+arg_8], 0
		jnz	short loc_405C29
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_405C29
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_4038C9
		jmp	short loc_405C2E
; ---------------------------------------------------------------------------

loc_405C29:				; CODE XREF: sub_405980+F7j
					; sub_405980+12Fj ...
		mov	eax, 0FFFFFFFFh

loc_405C2E:				; CODE XREF: sub_405980+B0j
					; sub_405980+E3j ...
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_405980	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405C34	proc near		; CODE XREF: .text:0040760Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_405C5D
		leave
		retn
sub_405C34	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405C5D	proc near		; CODE XREF: sub_405C34+22p

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_405C9A
		mov	[esp+48h+var_40], offset aIobuf_push_fil ; "iobuf_push_filter2"
		mov	dword ptr [esp+48h+var_44], 653h
		mov	[esp+48h+var_48], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_409E40
; ---------------------------------------------------------------------------

loc_405C9A:				; CODE XREF: sub_405C5D+1Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_405CC0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_4068CC
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_405CC0
		mov	eax, [ebp+var_1C]
		jmp	loc_405F90
; ---------------------------------------------------------------------------

loc_405CC0:				; CODE XREF: sub_405C5D+45j
					; sub_405C5D+59j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	eax, 3Fh
		jle	short loc_405CE1
		mov	[esp+48h+var_48], offset aIOFilterTooDee ; "i/o	filter too deeply nested - corrupte"...
		call	sub_409CB1
		mov	eax, 59h
		jmp	loc_405F90
; ---------------------------------------------------------------------------

loc_405CE1:				; CODE XREF: sub_405C5D+6Cj
		mov	[esp+48h+var_48], 68h ;	size_t
		call	sub_40350C
		mov	[ebp+var_20], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_20]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_405D12
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_405D12:				; CODE XREF: sub_405C5D+A5j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_405D2A
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_405D2A:				; CODE XREF: sub_405C5D+BCj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_405D52
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_405D52:				; CODE XREF: sub_405C5D+E8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_405D60
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_405D60:				; CODE XREF: sub_405C5D+FAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_405D7A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_40360F
		jmp	short loc_405D7F
; ---------------------------------------------------------------------------

loc_405D7A:				; CODE XREF: sub_405C5D+10Bj
		mov	eax, 0

loc_405D7F:				; CODE XREF: sub_405C5D+11Bj
		mov	edx, [ebp+var_20]
		mov	[edx+4Ch], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+48h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_405DC0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 2

loc_405DC0:				; CODE XREF: sub_405C5D+158j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_405DF6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax ;	size_t
		call	sub_40350C
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+2Ch], 0
		jmp	short loc_405E20
; ---------------------------------------------------------------------------

loc_405DF6:				; CODE XREF: sub_405C5D+16Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax ;	size_t
		call	sub_40350C
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0

loc_405E20:				; CODE XREF: sub_405C5D+197j
		mov	eax, [ebp+var_20]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+var_20]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+arg_0]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+50h], edx
		mov	eax, [ebp+var_20]
		mov	edx, [eax+60h]
		mov	eax, [ebp+arg_0]
		mov	[eax+60h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+40h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+44h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+48h], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+58h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+58h], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_405F2D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_405EF9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_405EFE
; ---------------------------------------------------------------------------

loc_405EF9:				; CODE XREF: sub_405C5D+292j
		mov	eax, offset a?_0 ; "?"

loc_405EFE:				; CODE XREF: sub_405C5D+29Aj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufD_DPushS	; "iobuf-%d.%d:	push `%s'\n"
		call	sub_409D4E
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_404C44

loc_405F2D:				; CODE XREF: sub_405C5D+288j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_405F8D
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_405F8D
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aIobufctrl_init ; "IOBUFCTRL_INIT failed: %s\n"
		call	sub_409CB1

loc_405F8D:				; CODE XREF: sub_405C5D+2D8j
					; sub_405C5D+313j
		mov	eax, [ebp+var_1C]

loc_405F90:				; CODE XREF: sub_405C5D+5Ej
					; sub_405C5D+7Fj
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_405C5D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405F98	proc near		; CODE XREF: .text:00406F47p
					; .text:00406FD7p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_405FD5
		mov	[esp+48h+var_40], offset aPop_filter ; "pop_filter"
		mov	[esp+48h+var_44], 6AAh
		mov	[esp+48h+var_48], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_409E40
; ---------------------------------------------------------------------------

loc_405FD5:				; CODE XREF: sub_405F98+1Fj
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_406019
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_405FF0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_405FF5
; ---------------------------------------------------------------------------

loc_405FF0:				; CODE XREF: sub_405F98+4Ej
		mov	eax, offset a?_0 ; "?"

loc_405FF5:				; CODE XREF: sub_405F98+56j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	[esp+48h+var_44], edx ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopS ; "iobuf-%d.%d: pop `%s'\n"
		call	sub_409D4E

loc_406019:				; CODE XREF: sub_405F98+44j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	loc_4060F3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_406052
		mov	[esp+48h+var_40], 6B2h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+var_48], offset aB ; "b"
		call	sub_40E8D0

loc_406052:				; CODE XREF: sub_405F98+9Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_403669
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_406090
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_406090:				; CODE XREF: sub_405F98+E8j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_4060A8
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_4060A8:				; CODE XREF: sub_405F98+FFj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_4060D0
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_4060D0:				; CODE XREF: sub_405F98+12Bj
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_4060DE
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_4060DE:				; CODE XREF: sub_405F98+13Dj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_403669
		mov	eax, 0
		jmp	loc_406327
; ---------------------------------------------------------------------------

loc_4060F3:				; CODE XREF: sub_405F98+89j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		jmp	short loc_406120
; ---------------------------------------------------------------------------

loc_4060FB:				; CODE XREF: sub_405F98+18Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_406117
		cmp	[ebp+arg_8], 0
		jz	short loc_406126
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		cmp	eax, [ebp+arg_8]
		jz	short loc_406126

loc_406117:				; CODE XREF: sub_405F98+16Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax

loc_406120:				; CODE XREF: sub_405F98+161j
		cmp	[ebp+var_1C], 0
		jnz	short loc_4060FB

loc_406126:				; CODE XREF: sub_405F98+172j
					; sub_405F98+17Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_406138
		mov	[esp+48h+var_48], offset aPop_filterFilt ; "pop_filter(): filter function not found"...
		call	sub_409D21
; ---------------------------------------------------------------------------

loc_406138:				; CODE XREF: sub_405F98+192j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_406179
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_4068CC
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_406179
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobuf_flushF_0 ; "iobuf_flush	failed in pop_filter: %s\n"
		call	sub_409CB1
		mov	eax, [ebp+var_20]
		jmp	loc_406327
; ---------------------------------------------------------------------------

loc_406179:				; CODE XREF: sub_405F98+1A8j
					; sub_405F98+1BCj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_4061E1
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+50h]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 2
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4061E1
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_409CB1
		mov	eax, [ebp+var_20]
		jmp	loc_406327
; ---------------------------------------------------------------------------

loc_4061E1:				; CODE XREF: sub_405F98+1E9j
					; sub_405F98+224j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_40620D
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_40620D
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax+44h], 0

loc_40620D:				; CODE XREF: sub_405F98+251j
					; sub_405F98+25Bj
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	short loc_40622B
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_40622B
		mov	[esp+48h+var_48], offset aCanTRemoveTheL ; "can't remove the last filter from the c"...
		call	sub_409D21
; ---------------------------------------------------------------------------

loc_40622B:				; CODE XREF: sub_405F98+27Bj
					; sub_405F98+285j
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	loc_406302
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_403669
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_40627E
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_40627E:				; CODE XREF: sub_405F98+2D6j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_406296
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_406296:				; CODE XREF: sub_405F98+2EDj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_4062BE
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_4062BE:				; CODE XREF: sub_405F98+319j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_4062CC
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_4062CC:				; CODE XREF: sub_405F98+32Bj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_403669
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_406324
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopped ; "iobuf-%d.%d: popped	filter\n"
		call	sub_409D4E
		jmp	short loc_406324
; ---------------------------------------------------------------------------

loc_406302:				; CODE XREF: sub_405F98+299j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_406318
		mov	[esp+48h+var_48], offset aOhhJeeeTryingT ; "Ohh	jeee, trying to	remove a head filte"...
		call	sub_409D21
; ---------------------------------------------------------------------------

loc_406318:				; CODE XREF: sub_405F98+372j
		mov	[esp+48h+var_48], offset aOhhJeeeTryin_0 ; "Ohh	jeee, trying to	remove an intermedi"...
		call	sub_409D21
; ---------------------------------------------------------------------------

loc_406324:				; CODE XREF: sub_405F98+346j
					; sub_405F98+368j
		mov	eax, [ebp+var_20]

loc_406327:				; CODE XREF: sub_405F98+156j
					; sub_405F98+1DCj ...
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_405F98	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40632F	proc near		; CODE XREF: sub_406A3A+73p
					; sub_406AE3+136p ...

DstBuf		= dword	ptr -58h
ElementSize	= dword	ptr -54h
Count		= dword	ptr -50h
File		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jz	short loc_406364
		mov	[esp+58h+Count], 6FAh ;	int
		mov	[esp+58h+ElementSize], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+DstBuf], offset aAD_startAD_len ; "a->d.start == a->d.len"
		call	sub_40E8D0

loc_406364:				; CODE XREF: sub_40632F+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_406378
		mov	eax, 0FFFFFFFFh
		jmp	loc_4068C4
; ---------------------------------------------------------------------------

loc_406378:				; CODE XREF: sub_40632F+3Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	loc_4064C2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_406485
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_4063E1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_4063B8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_4063BD
; ---------------------------------------------------------------------------

loc_4063B8:				; CODE XREF: sub_40632F+7Fj
		mov	eax, offset a?_0 ; "?"

loc_4063BD:				; CODE XREF: sub_40632F+87j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+58h+File],	eax
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+ElementSize], edx ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopSIn ; "iobuf-%d.%d: pop `%s' in underflow\n"
		call	sub_409D4E

loc_4063E1:				; CODE XREF: sub_40632F+75j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_403669
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_40641F
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_40641F:				; CODE XREF: sub_40632F+E0j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_406437
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_406437:				; CODE XREF: sub_40632F+F7j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_40645F
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_40645F:				; CODE XREF: sub_40632F+123j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_40646D
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_40646D:				; CODE XREF: sub_40632F+135j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_404C44
		jmp	short loc_40648F
; ---------------------------------------------------------------------------

loc_406485:				; CODE XREF: sub_40632F+5Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0

loc_40648F:				; CODE XREF: sub_40632F+154j
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_4064B8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnderf ; "iobuf-%d.%d: underflow: eof	(due to	fil"...
		call	sub_409D4E

loc_4064B8:				; CODE XREF: sub_40632F+167j
		mov	eax, 0FFFFFFFFh
		jmp	loc_4068C4
; ---------------------------------------------------------------------------

loc_4064C2:				; CODE XREF: sub_40632F+51j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		test	eax, eax
		jz	short loc_4064FF
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_4064F5
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DError	; "iobuf-%d.%d:	error\n"
		call	sub_409D4E

loc_4064F5:				; CODE XREF: sub_40632F+1A4j
		mov	eax, 0FFFFFFFFh
		jmp	loc_4068C4
; ---------------------------------------------------------------------------

loc_4064FF:				; CODE XREF: sub_40632F+19Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_4065AD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], edx ; Count
		mov	[esp+58h+ElementSize], 1 ; ElementSize
		mov	[esp+58h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jbe	short loc_406569
		mov	eax, [ebp+var_20]
		mov	[esp+58h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_406569
		call	sub_4036E1
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+3Ch], edx

loc_406569:				; CODE XREF: sub_40632F+21Cj
					; sub_40632F+22Bj
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_4065A3
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_4065A8
; ---------------------------------------------------------------------------

loc_4065A3:				; CODE XREF: sub_40632F+252j
		mov	eax, 0FFFFFFFFh

loc_4065A8:				; CODE XREF: sub_40632F+272j
		jmp	loc_4068C4
; ---------------------------------------------------------------------------

loc_4065AD:				; CODE XREF: sub_40632F+1D8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	loc_406896
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[ebp+var_2C], eax
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_4065F4
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_0 ; "iobuf-%d.%d: underflow: req=%lu\n"
		call	sub_409D4E

loc_4065F4:				; CODE XREF: sub_40632F+29Cj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_2C]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 3
		mov	[esp+58h+DstBuf], eax
		call	esi
		mov	[ebp+var_24], eax
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_406662
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	ebx, [ebp+var_24]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_1 ; "iobuf-%d.%d: underflow: got=%lu rc=%d\n"
		call	sub_409D4E

loc_406662:				; CODE XREF: sub_40632F+303j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	loc_40681A
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	loc_40681A
		mov	[ebp+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_30]
		mov	[esp+58h+var_48], ecx
		mov	[esp+58h+File],	0
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 2
		mov	[esp+58h+DstBuf], eax
		call	ebx
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_4066D7
		mov	eax, [ebp+var_24]
		mov	[esp+58h+DstBuf], eax
		call	gpg_strerror
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_409CB1

loc_4066D7:				; CODE XREF: sub_40632F+38Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_406703
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_406703
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0

loc_406703:				; CODE XREF: sub_40632F+3B0j
					; sub_40632F+3BAj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+5Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 1
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	loc_40682B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_40682B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_28], eax
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_406776
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopInU ; "iobuf-%d.%d: pop in	underflow (!len)\n"
		call	sub_409D4E

loc_406776:				; CODE XREF: sub_40632F+425j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_403669
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_4067B4
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_4067B4:				; CODE XREF: sub_40632F+475j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_4067CC
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_4067CC:				; CODE XREF: sub_40632F+48Cj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_4067F4
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_4067F4:				; CODE XREF: sub_40632F+4B8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_406802
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_406802:				; CODE XREF: sub_40632F+4CAj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_404C44
		jmp	short loc_40682B
; ---------------------------------------------------------------------------

loc_40681A:				; CODE XREF: sub_40632F+33Bj
					; sub_40632F+345j
		cmp	[ebp+var_24], 0
		jz	short loc_40682C
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_24]
		mov	[eax+3Ch], edx
		jmp	short loc_40682C
; ---------------------------------------------------------------------------

loc_40682B:				; CODE XREF: sub_40632F+401j
					; sub_40632F+40Fj ...
		nop

loc_40682C:				; CODE XREF: sub_40632F+4EFj
					; sub_40632F+4FAj
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_406863
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_40685C
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_2 ; "iobuf-%d.%d: underflow: eof\n"
		call	sub_409D4E

loc_40685C:				; CODE XREF: sub_40632F+50Bj
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4068C4
; ---------------------------------------------------------------------------

loc_406863:				; CODE XREF: sub_40632F+502j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_4068C4
; ---------------------------------------------------------------------------

loc_406896:				; CODE XREF: sub_40632F+286j
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_4068BF
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_3 ; "iobuf-%d.%d: underflow: eof	(no filter)"...
		call	sub_409D4E

loc_4068BF:				; CODE XREF: sub_40632F+56Ej
		mov	eax, 0FFFFFFFFh

loc_4068C4:				; CODE XREF: sub_40632F+44j
					; sub_40632F+18Ej ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40632F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4068CC	proc near		; CODE XREF: sub_404DAD+8Bp
					; sub_405C5D+4Dp ...

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4068E8
		mov	eax, 0
		jmp	loc_406A33
; ---------------------------------------------------------------------------

loc_4068E8:				; CODE XREF: sub_4068CC+10j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	loc_406983
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		add	eax, 2000h
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_4147D0
		test	eax, eax
		jz	short loc_40692A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], eax ; char
		mov	[esp+38h+Dst], offset aIncreasingTemp ;	"increasing temp iobuf from %lu	to %lu\n"
		call	sub_409D4E

loc_40692A:				; CODE XREF: sub_4068CC+3Fj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_40350C
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+28h], edx
		mov	eax, 0
		jmp	loc_406A33
; ---------------------------------------------------------------------------

loc_406983:				; CODE XREF: sub_4068CC+24j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_406999
		mov	[esp+38h+Dst], offset aFlushOnNonOutp ;	"flush on non-output iobuf\n"
		call	sub_409D21
; ---------------------------------------------------------------------------

loc_406999:				; CODE XREF: sub_4068CC+BFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	short loc_4069AF
		mov	[esp+38h+Dst], offset aIobuf_flushNoF ;	"iobuf_flush: no filter\n"
		call	sub_409D21
; ---------------------------------------------------------------------------

loc_4069AF:				; CODE XREF: sub_4068CC+D5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_18]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], 4 ; char
		mov	[esp+38h+Dst], eax
		call	esi
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406A17
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jz	short loc_406A17
		mov	[esp+38h+Dst], offset aIobuf_flushDid ;	"iobuf_flush did not write all!\n"
		call	sub_409C87
		mov	[ebp+var_C], 3Fh
		jmp	short loc_406A26
; ---------------------------------------------------------------------------

loc_406A17:				; CODE XREF: sub_4068CC+127j
					; sub_4068CC+134j
		cmp	[ebp+var_C], 0
		jz	short loc_406A26
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+3Ch], edx

loc_406A26:				; CODE XREF: sub_4068CC+149j
					; sub_4068CC+14Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_C]

loc_406A33:				; CODE XREF: sub_4068CC+17j
					; sub_4068CC+B2j
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4068CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406A3A	proc near		; CODE XREF: sub_404109+FBp
					; sub_404109+1E3p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_406A75
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		cmp	ebx, edx
		jl	short loc_406A75
		cmp	ebx, edx
		jg	short loc_406A6E
		cmp	ecx, eax
		jb	short loc_406A75

loc_406A6E:				; CODE XREF: sub_406A3A+2Ej
		mov	eax, 0FFFFFFFFh
		jmp	short loc_406ADD
; ---------------------------------------------------------------------------

loc_406A75:				; CODE XREF: sub_406A3A+14j
					; sub_406A3A+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	short loc_406AA7
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		mov	[ebp+var_C], edx
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		jmp	short loc_406AC2
; ---------------------------------------------------------------------------

loc_406AA7:				; CODE XREF: sub_406A3A+49j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40632F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_406AC2
		mov	eax, 0FFFFFFFFh
		jmp	short loc_406ADD
; ---------------------------------------------------------------------------

loc_406AC2:				; CODE XREF: sub_406A3A+6Bj
					; sub_406A3A+7Fj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_C]

loc_406ADD:				; CODE XREF: sub_406A3A+39j
					; sub_406A3A+86j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_406A3A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406AE3	proc near		; CODE XREF: sub_404109+514p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_406B5D
		mov	[ebp+var_10], 0
		jmp	short loc_406B4A
; ---------------------------------------------------------------------------

loc_406B08:				; CODE XREF: sub_406AE3+6Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_406A3A
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_406B2C
		cmp	[ebp+var_10], 0
		jnz	short loc_406B54
		mov	eax, 0FFFFFFFFh
		jmp	loc_406C9C
; ---------------------------------------------------------------------------

loc_406B2C:				; CODE XREF: sub_406AE3+37j
		cmp	[ebp+var_C], 0
		jz	short loc_406B3C
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl

loc_406B3C:				; CODE XREF: sub_406AE3+4Dj
		cmp	[ebp+var_C], 0
		jz	short loc_406B46
		add	[ebp+var_C], 1

loc_406B46:				; CODE XREF: sub_406AE3+5Dj
		add	[ebp+var_10], 1

loc_406B4A:				; CODE XREF: sub_406AE3+23j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	short loc_406B08
		jmp	short loc_406B55
; ---------------------------------------------------------------------------

loc_406B54:				; CODE XREF: sub_406AE3+3Dj
		nop

loc_406B55:				; CODE XREF: sub_406AE3+6Fj
		mov	eax, [ebp+var_10]
		jmp	loc_406C9C
; ---------------------------------------------------------------------------

loc_406B5D:				; CODE XREF: sub_406AE3+1Aj
		mov	[ebp+var_10], 0

loc_406B64:				; CODE XREF: sub_406AE3+192j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	loc_406C0B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	loc_406C0B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_14]
		jnb	short loc_406BB9
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax

loc_406BB9:				; CODE XREF: sub_406AE3+C5j
		cmp	[ebp+var_C], 0
		jz	short loc_406BE5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_14]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy

loc_406BE5:				; CODE XREF: sub_406AE3+DAj
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		cmp	[ebp+var_C], 0
		jz	short loc_406C0B
		mov	eax, [ebp+var_14]
		add	[ebp+var_C], eax

loc_406C0B:				; CODE XREF: sub_406AE3+87j
					; sub_406AE3+9Bj ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_406C6F
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_40632F
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_406C57
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		cmp	[ebp+var_10], 0
		jz	short loc_406C50
		mov	eax, [ebp+var_10]
		jmp	short loc_406C55
; ---------------------------------------------------------------------------

loc_406C50:				; CODE XREF: sub_406AE3+166j
		mov	eax, 0FFFFFFFFh

loc_406C55:				; CODE XREF: sub_406AE3+16Bj
		jmp	short loc_406C9C
; ---------------------------------------------------------------------------

loc_406C57:				; CODE XREF: sub_406AE3+142j
		cmp	[ebp+var_C], 0
		jz	short loc_406C6B
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_406C6B:				; CODE XREF: sub_406AE3+178j
		add	[ebp+var_10], 1

loc_406C6F:				; CODE XREF: sub_406AE3+12Ej
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	loc_406B64
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_10]

loc_406C9C:				; CODE XREF: sub_406AE3+44j
					; sub_406AE3+75j ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_406AE3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_406CC3
		mov	eax, 0FFFFFFFFh
		jmp	locret_406D5F
; ---------------------------------------------------------------------------

loc_406CC3:				; CODE XREF: .text:00406CB7j
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_406D1B
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40632F
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_406CEA
		mov	eax, 0FFFFFFFFh
		jmp	short locret_406D5F
; ---------------------------------------------------------------------------

loc_406CEA:				; CODE XREF: .text:00406CE1j
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		cmp	eax, 1
		jz	short loc_406D11
		mov	dword ptr [esp+8], 7FCh
		mov	dword ptr [esp+4], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAD_start1 ; "a->d.start == 1"
		call	sub_40E8D0

loc_406D11:				; CODE XREF: .text:00406CF3j
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0

loc_406D1B:				; CODE XREF: .text:00406CD1j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_406D3F
; ---------------------------------------------------------------------------

loc_406D24:				; CODE XREF: .text:00406D5Aj
		mov	eax, [ebp+8]
		mov	edx, [eax+34h]
		mov	eax, [ebp-0Ch]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp+0Ch], 1

loc_406D3F:				; CODE XREF: .text:00406D22j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	short loc_406D5C
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp-0Ch]
		add	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_406D24

loc_406D5C:				; CODE XREF: .text:00406D45j
		mov	eax, [ebp-0Ch]

locret_406D5F:				; CODE XREF: .text:00406CBEj
					; .text:00406CE8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406D61	proc near		; CODE XREF: sub_404109+6E3p
					; sub_404109+95Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_406D8D
		mov	[esp+28h+var_20], offset aIobuf_writebyt ; "iobuf_writebyte"
		mov	[esp+28h+var_24], 80Eh
		mov	[esp+28h+var_28], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_409E40
; ---------------------------------------------------------------------------

loc_406D8D:				; CODE XREF: sub_406D61+Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnz	short loc_406DB6
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4068CC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406DB6
		mov	eax, [ebp+var_C]
		jmp	short locret_406E04
; ---------------------------------------------------------------------------

loc_406DB6:				; CODE XREF: sub_406D61+3Aj
					; sub_406D61+4Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jb	short loc_406DE2
		mov	[esp+28h+var_20], 814h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+var_28], offset aAD_lenAD_size	; "a->d.len < a->d.size"
		call	sub_40E8D0

loc_406DE2:				; CODE XREF: sub_406D61+63j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, 0

locret_406E04:				; CODE XREF: sub_406D61+53j
		leave
		retn
sub_406D61	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406E06	proc near		; CODE XREF: sub_404109+733p
					; sub_404109+782p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_406E38
		mov	[esp+28h+Size],	offset aIobuf_write ; "iobuf_write"
		mov	[esp+28h+Src], 821h
		mov	[esp+28h+Dst], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_409E40
; ---------------------------------------------------------------------------

loc_406E38:				; CODE XREF: sub_406E06+14j
					; sub_406E06+D1j
		cmp	[ebp+arg_8], 0
		jz	short loc_406EB4
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnb	short loc_406EB4
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_406E71
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax

loc_406E71:				; CODE XREF: sub_406E06+63j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		add	eax, ecx
		mov	ecx, [ebp+var_10]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx

loc_406EB4:				; CODE XREF: sub_406E06+36j
					; sub_406E06+46j
		cmp	[ebp+arg_8], 0
		jz	short loc_406ED3
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_4068CC
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_406ED3
		mov	eax, [ebp+var_14]
		jmp	short locret_406EE2
; ---------------------------------------------------------------------------

loc_406ED3:				; CODE XREF: sub_406E06+B2j
					; sub_406E06+C6j
		cmp	[ebp+arg_8], 0
		jnz	loc_406E38
		mov	eax, 0

locret_406EE2:				; CODE XREF: sub_406E06+CBj
		leave
		retn
sub_406E06	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_406F16
; ---------------------------------------------------------------------------

loc_406EEC:				; CODE XREF: .text:00406F1Ej
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406D61
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_406F12
		mov	eax, [ebp-0Ch]
		jmp	short locret_406F25
; ---------------------------------------------------------------------------

loc_406F12:				; CODE XREF: .text:00406F0Bj
		add	dword ptr [ebp+0Ch], 1

loc_406F16:				; CODE XREF: .text:00406EEAj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406EEC
		mov	eax, 0

locret_406F25:				; CODE XREF: .text:00406F10j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_406F4C
; ---------------------------------------------------------------------------

loc_406F2F:				; CODE XREF: .text:00406F54j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_405F98

loc_406F4C:				; CODE XREF: .text:00406F2Dj
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_406F2F
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+30h]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+34h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406E06
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jbe	short loc_406F94
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax

loc_406F94:				; CODE XREF: .text:00406F8Cj
		mov	eax, [ebp+8]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	ecx, [ebp-0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_406FDC
; ---------------------------------------------------------------------------

loc_406FBF:				; CODE XREF: .text:00406FE4j
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405F98

loc_406FDC:				; CODE XREF: .text:00406FBDj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_406FBF
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0Ch
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		or	eax, edx
		test	eax, eax
		jz	short loc_40701A
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		jmp	short loc_40702B
; ---------------------------------------------------------------------------

loc_40701A:				; CODE XREF: .text:00407005j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx

loc_40702B:				; CODE XREF: .text:00407018j
		mov	ecx, [ebp+8]
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		add	esp, 0Ch
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_407085
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_407085:				; CODE XREF: .text:0040707Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_407230
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	_fileno
		lea	edx, [ebp-50h]
		mov	[esp+4], edx
		mov	[esp], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_4070C7
		mov	eax, [ebp-38h]
		mov	edx, [ebp-34h]
		jmp	locret_407244
; ---------------------------------------------------------------------------

loc_4070C7:				; CODE XREF: .text:004070BAj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFstatFailedS ;	"fstat() failed: %s\n"
		call	sub_409CB1
		mov	eax, 0
		mov	edx, 0
		jmp	locret_407244
; ---------------------------------------------------------------------------

loc_4070F7:				; CODE XREF: .text:00407234j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	loc_407227
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_403C54
		jnz	loc_407227
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	eax, ds:dword_414208
		test	eax, eax
		jnz	short loc_407183
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], offset	aKernel32_dll ;	"kernel32.dll"
		call	sub_4036F6
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_407179
		mov	dword ptr [esp+4], offset aGetfilesizeex ; "GetFileSizeEx"
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_403714
		mov	ds:dword_41420C, eax
		mov	eax, ds:dword_41420C
		test	eax, eax
		jnz	short loc_407179
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_403759

loc_407179:				; CODE XREF: .text:0040714Bj
					; .text:0040716Cj
		mov	ds:dword_414208, 1

loc_407183:				; CODE XREF: .text:0040712Ej
		mov	eax, ds:dword_41420C
		test	eax, eax
		jz	short loc_4071D7
		mov	edx, ds:dword_41420C
		lea	eax, [ebp-58h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	edx ; dword_41420C
		sub	esp, 8
		test	eax, eax
		jz	short loc_407202
		mov	eax, [ebp-54h]
		test	eax, eax
		jnz	short loc_4071BC
		mov	eax, [ebp-58h]
		mov	edx, 0
		jmp	locret_407244
; ---------------------------------------------------------------------------

loc_4071BC:				; CODE XREF: .text:004071ADj
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4071CB
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 1

loc_4071CB:				; CODE XREF: .text:004071C0j
		mov	eax, 0
		mov	edx, 0
		jmp	short locret_407244
; ---------------------------------------------------------------------------

loc_4071D7:				; CODE XREF: .text:0040718Aj
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:GetFileSize
		call	eax ; GetFileSize
		sub	esp, 8
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jz	short loc_407202
		mov	eax, [ebp-1Ch]
		mov	edx, 0
		jmp	short locret_407244
; ---------------------------------------------------------------------------

loc_407202:				; CODE XREF: .text:004071A6j
					; .text:004071F6j
		mov	dword ptr [esp], 0
		call	sub_408B22
		mov	[esp+8], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aGetfilesizeFor	; "GetFileSize for handle %p failed: %s\n"
		call	sub_409CB1
		jmp	short loc_40723A
; ---------------------------------------------------------------------------

loc_407227:				; CODE XREF: .text:004070FFj
					; .text:00407110j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_407230:				; CODE XREF: .text:0040708Dj
		cmp	dword ptr [ebp+8], 0
		jnz	loc_4070F7

loc_40723A:				; CODE XREF: .text:00407225j
		mov	eax, 0
		mov	edx, 0

locret_407244:				; CODE XREF: .text:004070C2j
					; .text:004070F2j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40729C
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[esp], eax
		call	_fileno
		jmp	short locret_4072A7
; ---------------------------------------------------------------------------

loc_407266:				; CODE XREF: .text:004072A0j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_407293
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_403C54
		jnz	short loc_407293
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		jmp	short locret_4072A7
; ---------------------------------------------------------------------------

loc_407293:				; CODE XREF: .text:0040726Ej
					; .text:0040727Bj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_40729C:				; CODE XREF: .text:00407254j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_407266
		mov	eax, 0FFFFFFFFh

locret_4072A7:				; CODE XREF: .text:00407264j
					; .text:00407291j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_407381
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[ebp-10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40EA70
		test	eax, eax
		jz	short loc_407346
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCanTSeekS ; "can't seek: %s\n"
		call	sub_409CB1
		mov	eax, 0FFFFFFFFh
		jmp	locret_407498
; ---------------------------------------------------------------------------

loc_407346:				; CODE XREF: .text:00407319j
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	clearerr
		jmp	loc_4073F1
; ---------------------------------------------------------------------------

loc_407356:				; CODE XREF: .text:00407385j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_407378
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_403C54
		jnz	short loc_407378
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		jmp	short loc_407387
; ---------------------------------------------------------------------------

loc_407378:				; CODE XREF: .text:0040735Ej
					; .text:0040736Bj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_407381:				; CODE XREF: .text:004072E7j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_407356

loc_407387:				; CODE XREF: .text:00407376j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_407397
		mov	eax, 0FFFFFFFFh
		jmp	locret_407498
; ---------------------------------------------------------------------------

loc_407397:				; CODE XREF: .text:0040738Bj
		mov	edx, [ebp-20h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4073F1
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aSetfilepointer	; "SetFilePointer failed on handle %p: ec="...
		call	sub_409CB1
		mov	eax, 0FFFFFFFFh
		jmp	locret_407498
; ---------------------------------------------------------------------------

loc_4073F1:				; CODE XREF: .text:00407351j
					; .text:004073C3j
		mov	eax, [ebp+8]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		mov	ecx, [ebp+8]
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+3Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	short loc_407488
		mov	dword ptr [esp], offset	aPop_filterCall	; "pop_filter called in	iobuf_seek - pleas"...
		call	sub_409D4E
		jmp	short loc_407488
; ---------------------------------------------------------------------------

loc_407469:				; CODE XREF: .text:00407491j
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405F98
		jmp	short loc_407489
; ---------------------------------------------------------------------------

loc_407488:				; CODE XREF: .text:00407459j
					; .text:00407467j
		nop

loc_407489:				; CODE XREF: .text:00407486j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_407469
		mov	eax, 0

locret_407498:				; CODE XREF: .text:00407341j
					; .text:00407392j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40749A	proc near		; CODE XREF: .text:00404F99p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_4074F4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		jmp	short locret_4074FF
; ---------------------------------------------------------------------------

loc_4074B2:				; CODE XREF: sub_40749A+5Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_4074EB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_403C54
		jnz	short loc_4074EB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_4074E4
		mov	eax, [ebp+var_4]
		add	eax, 14h
		jmp	short loc_4074E9
; ---------------------------------------------------------------------------

loc_4074E4:				; CODE XREF: sub_40749A+40j
		mov	eax, 0

loc_4074E9:				; CODE XREF: sub_40749A+48j
		jmp	short locret_4074FF
; ---------------------------------------------------------------------------

loc_4074EB:				; CODE XREF: sub_40749A+20j
					; sub_40749A+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_4074F4:				; CODE XREF: sub_40749A+Ej
		cmp	[ebp+arg_0], 0
		jnz	short loc_4074B2
		mov	eax, 0

locret_4074FF:				; CODE XREF: sub_40749A+16j
					; sub_40749A:loc_4074E9j
		leave
		retn
sub_40749A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		jmp	short loc_40753A
; ---------------------------------------------------------------------------

loc_407509:				; CODE XREF: .text:0040753Ej
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_407531
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_403C54
		jnz	short loc_407531
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-4], eax
		mov	eax, [ebp-4]
		add	eax, 14h
		jmp	short locret_407545
; ---------------------------------------------------------------------------

loc_407531:				; CODE XREF: .text:00407511j
					; .text:0040751Ej
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_40753A:				; CODE XREF: .text:00407507j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_407509
		mov	eax, 0

locret_407545:				; CODE XREF: .text:0040752Fj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 20h
		mov	dword ptr [esp], 1
		call	sub_4035E4
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_407596
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_407596
		mov	dword ptr [esp+8], 98Ch
		mov	dword ptr [esp+4], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAUse1AUse2 ; "a->use == 1 || a->use ==	2"
		call	sub_40E8D0
		jmp	short loc_407597
; ---------------------------------------------------------------------------

loc_407596:				; CODE XREF: .text:0040756Cj
					; .text:00407576j
		nop

loc_407597:				; CODE XREF: .text:00407594j
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], edx
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_4075DA
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_4075BD
		mov	dword ptr [esp], offset	aPop_filterCa_0	; "pop_filter called in	set_partial_block_"...
		call	sub_409D4E

loc_4075BD:				; CODE XREF: .text:004075AFj
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset sub_404109
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405F98
		jmp	short locret_407611
; ---------------------------------------------------------------------------

loc_4075DA:				; CODE XREF: .text:004075A5j
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+4], 0
		mov	edx, [ebp+0Ch]
		mov	eax, [ebp-0Ch]
		mov	[eax+18h], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset sub_404109
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405C34

locret_407611:				; CODE XREF: .text:004075D8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407613	proc near		; CODE XREF: sub_4019DF+1C8p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_407663
		mov	[ebp+var_14], 100h
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax ;	size_t
		call	sub_40350C
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx

loc_407663:				; CODE XREF: sub_407613+29j
		sub	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], eax
		jmp	loc_40777A
; ---------------------------------------------------------------------------

loc_407672:				; CODE XREF: sub_407613+1CBj
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_14]
		jnz	loc_407762
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jbe	loc_407712

loc_40768A:				; CODE XREF: sub_407613+E1j
		cmp	[ebp+var_C], 0Ah
		jz	short loc_4076F6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4076AA
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4076B7

loc_4076AA:				; CODE XREF: sub_407613+85j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_406A3A
		jmp	short loc_4076ED
; ---------------------------------------------------------------------------

loc_4076B7:				; CODE XREF: sub_407613+95j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx

loc_4076ED:				; CODE XREF: sub_407613+A2j
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40768A

loc_4076F6:				; CODE XREF: sub_407613+7Bj
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0Ah
		add	[ebp+var_1C], 1
		add	[ebp+var_18], 1
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		jmp	loc_4077E7
; ---------------------------------------------------------------------------

loc_407712:				; CODE XREF: sub_407613+71j
		add	[ebp+var_14], 3
		cmp	[ebp+var_14], 3FFh
		ja	short loc_407726
		mov	eax, 100h
		jmp	short loc_40772B
; ---------------------------------------------------------------------------

loc_407726:				; CODE XREF: sub_407613+10Aj
		mov	eax, 400h

loc_40772B:				; CODE XREF: sub_407613+111j
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax ;	size_t
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_40359F
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		sub	[ebp+var_14], 3
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	[ebp+var_1C], eax

loc_407762:				; CODE XREF: sub_407613+65j
		mov	eax, [ebp+var_C]
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[eax], dl
		add	[ebp+var_1C], 1
		add	[ebp+var_18], 1
		cmp	[ebp+var_C], 0Ah
		jz	short loc_4077E6

loc_40777A:				; CODE XREF: sub_407613+5Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_407794
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4077A1

loc_407794:				; CODE XREF: sub_407613+16Fj
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_406A3A
		jmp	short loc_4077D7
; ---------------------------------------------------------------------------

loc_4077A1:				; CODE XREF: sub_407613+17Fj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx

loc_4077D7:				; CODE XREF: sub_407613+18Cj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	loc_407672
		jmp	short loc_4077E7
; ---------------------------------------------------------------------------

loc_4077E6:				; CODE XREF: sub_407613+165j
		nop

loc_4077E7:				; CODE XREF: sub_407613+FAj
					; sub_407613+1D1j
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]
		leave
		retn
sub_407613	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4077F2	proc near		; CODE XREF: sub_4051C5+78p
					; .text:004056A1p

nStdHandle	= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_407814
		mov	[esp+28h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_407852
; ---------------------------------------------------------------------------

loc_407814:				; CODE XREF: sub_4077F2+Aj
		cmp	dword ptr [ebp+arg_0], 1
		jnz	short loc_407830
		mov	[esp+28h+nStdHandle], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_407852
; ---------------------------------------------------------------------------

loc_407830:				; CODE XREF: sub_4077F2+26j
		cmp	dword ptr [ebp+arg_0], 2
		jnz	short loc_40784C
		mov	[esp+28h+nStdHandle], 0FFFFFFF4h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_407852
; ---------------------------------------------------------------------------

loc_40784C:				; CODE XREF: sub_4077F2+42j
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_C], eax

loc_407852:				; CODE XREF: sub_4077F2+20j
					; sub_4077F2+3Cj ...
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_407876
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+nStdHandle], offset aGetstdhandleDF ; "GetStdHandle(%d) failed: ec=%d\n"
		call	sub_409D4E

loc_407876:				; CODE XREF: sub_4077F2+64j
		mov	eax, [ebp+var_C]
		mov	dword ptr [ebp+arg_0], eax
		mov	eax, dword ptr [ebp+arg_0]
		leave
		retn
sub_4077F2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_407900

loc_40788E:				; CODE XREF: .text:004078FCj
					; .text:loc_4078FEj
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4078A8
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4078BD

loc_4078A8:				; CODE XREF: .text:00407896j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406A3A
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4078FE
		jmp	loc_4079A0
; ---------------------------------------------------------------------------

loc_4078BD:				; CODE XREF: .text:004078A6j
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-14h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		jmp	short loc_40788E
; ---------------------------------------------------------------------------

loc_4078FE:				; CODE XREF: .text:004078B6j
		jmp	short loc_40788E
; ---------------------------------------------------------------------------

loc_407900:				; CODE XREF: .text:0040788Cj
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_407993
; ---------------------------------------------------------------------------

loc_40790B:				; CODE XREF: .text:00407997j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_407925
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_40793B

loc_407925:				; CODE XREF: .text:00407913j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406A3A
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40799F
		sub	dword ptr [ebp-0Ch], 1
		jmp	short loc_407993
; ---------------------------------------------------------------------------

loc_40793B:				; CODE XREF: .text:00407923j
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		cmp	eax, [ebp-0Ch]
		jbe	short loc_40795E
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax

loc_40795E:				; CODE XREF: .text:00407956j
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-10h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		mov	eax, [ebp-10h]
		sub	[ebp-0Ch], eax

loc_407993:				; CODE XREF: .text:00407906j
					; .text:00407939j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40790B
		jmp	short loc_4079A0
; ---------------------------------------------------------------------------

loc_40799F:				; CODE XREF: .text:00407933j
		nop

loc_4079A0:				; CODE XREF: .text:004078B8j
					; .text:0040799Dj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4079A8(char *)
sub_4079A8	proc near		; CODE XREF: sub_407F82+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4079EB
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_4079E1
; ---------------------------------------------------------------------------

loc_4079CD:				; CODE XREF: sub_4079A8+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4079DD
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_4079DD:				; CODE XREF: sub_4079A8+2Dj
		add	[ebp+var_C], 1

loc_4079E1:				; CODE XREF: sub_4079A8+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4079CD

loc_4079EB:				; CODE XREF: sub_4079A8+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_4079A8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_407AC1
; ---------------------------------------------------------------------------

loc_407A14:				; CODE XREF: .text:00407AC5j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_407AB9
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_407A66
; ---------------------------------------------------------------------------

loc_407A5A:				; CODE XREF: .text:00407A96j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_407A66:				; CODE XREF: .text:00407A58j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_407A98
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_407A5A

loc_407A98:				; CODE XREF: .text:00407A6Aj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407AA7
		mov	eax, [ebp-18h]
		jmp	short loc_407AD0
; ---------------------------------------------------------------------------

loc_407AA7:				; CODE XREF: .text:00407AA0j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_407AB9:				; CODE XREF: .text:00407A3Ej
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_407AC1:				; CODE XREF: .text:00407A0Fj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_407A14
		mov	eax, 0

loc_407AD0:				; CODE XREF: .text:00407AA5j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_407B9F
; ---------------------------------------------------------------------------

loc_407AFA:				; CODE XREF: .text:00407BA3j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408BB9
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408BB9
		cmp	ebx, eax
		jnz	short loc_407B97
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_407B48
; ---------------------------------------------------------------------------

loc_407B3C:				; CODE XREF: .text:00407B74j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_407B48:				; CODE XREF: .text:00407B3Aj
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_407B76
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408BB9
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408BB9
		cmp	ebx, eax
		jz	short loc_407B3C

loc_407B76:				; CODE XREF: .text:00407B4Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407B85
		mov	eax, [ebp-18h]
		jmp	short loc_407BAE
; ---------------------------------------------------------------------------

loc_407B85:				; CODE XREF: .text:00407B7Ej
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_407B97:				; CODE XREF: .text:00407B20j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_407B9F:				; CODE XREF: .text:00407AF5j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_407AFA
		mov	eax, 0

loc_407BAE:				; CODE XREF: .text:00407B83j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_407C13
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_407BD4
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40350C
		mov	[ebp+8], eax

loc_407BD4:				; CODE XREF: .text:00407BC4j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_407BFD
; ---------------------------------------------------------------------------

loc_407BE6:				; CODE XREF: .text:00407C0Bj
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_407BFD:				; CODE XREF: .text:00407BE4j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_407C0D
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407BE6

loc_407C0D:				; CODE XREF: .text:00407C01j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_407C13:				; CODE XREF: .text:00407BBEj
		mov	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_407C30
; ---------------------------------------------------------------------------

loc_407C2C:				; CODE XREF: .text:00407C4Fj
		add	dword ptr [ebp-10h], 1

loc_407C30:				; CODE XREF: .text:00407C2Aj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407C51
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_407C2C

loc_407C51:				; CODE XREF: .text:00407C38j
		mov	dword ptr [ebp-14h], 0
		jmp	short loc_407C8E
; ---------------------------------------------------------------------------

loc_407C5A:				; CODE XREF: .text:00407CA1j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_407C7F
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_407C86
		mov	eax, [ebp-0Ch]
		mov	[ebp-14h], eax
		jmp	short loc_407C86
; ---------------------------------------------------------------------------

loc_407C7F:				; CODE XREF: .text:00407C6Fj
		mov	dword ptr [ebp-14h], 0

loc_407C86:				; CODE XREF: .text:00407C75j
					; .text:00407C7Dj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1

loc_407C8E:				; CODE XREF: .text:00407C58j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407C5A
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_407CAF
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0

loc_407CAF:				; CODE XREF: .text:00407CA7j
		mov	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_407CF9
; ---------------------------------------------------------------------------

loc_407CC9:				; CODE XREF: .text:00407D01j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_407CEE
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_407CF5
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_407CF5
; ---------------------------------------------------------------------------

loc_407CEE:				; CODE XREF: .text:00407CDEj
		mov	dword ptr [ebp-10h], 0

loc_407CF5:				; CODE XREF: .text:00407CE4j
					; .text:00407CECj
		add	dword ptr [ebp-0Ch], 1

loc_407CF9:				; CODE XREF: .text:00407CC7j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407CC9
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_407D0F
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_407D0F:				; CODE XREF: .text:00407D07j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407D14(int, int, char	*)
sub_407D14	proc near		; CODE XREF: .text:00407DABp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_407D69
; ---------------------------------------------------------------------------

loc_407D30:				; CODE XREF: sub_407D14+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_407D5A
		cmp	[ebp+var_10], 0
		jnz	short loc_407D61
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_407D61
; ---------------------------------------------------------------------------

loc_407D5A:				; CODE XREF: sub_407D14+36j
		mov	[ebp+var_10], 0

loc_407D61:				; CODE XREF: sub_407D14+3Cj
					; sub_407D14+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_407D69:				; CODE XREF: sub_407D14+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_407D30
		cmp	[ebp+var_10], 0
		jz	short loc_407D8B
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_407D8E
; ---------------------------------------------------------------------------

loc_407D8B:				; CODE XREF: sub_407D14+61j
		mov	eax, [ebp+arg_4]

locret_407D8E:				; CODE XREF: sub_407D14+75j
		leave
		retn
sub_407D14	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_412180 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407D14
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407DB2(int, int, char	*)
sub_407DB2	proc near		; CODE XREF: .text:00407E43p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_407E07
; ---------------------------------------------------------------------------

loc_407DCE:				; CODE XREF: sub_407DB2+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_407DF8
		cmp	[ebp+var_10], 0
		jnz	short loc_407DFF
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_407DFF
; ---------------------------------------------------------------------------

loc_407DF8:				; CODE XREF: sub_407DB2+36j
		mov	[ebp+var_10], 0

loc_407DFF:				; CODE XREF: sub_407DB2+3Cj
					; sub_407DB2+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_407E07:				; CODE XREF: sub_407DB2+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_407DCE
		cmp	[ebp+var_10], 0
		jz	short loc_407E23
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_407E26
; ---------------------------------------------------------------------------

loc_407E23:				; CODE XREF: sub_407DB2+61j
		mov	eax, [ebp+arg_4]

locret_407E26:				; CODE XREF: sub_407DB2+6Fj
		leave
		retn
sub_407DB2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_412180 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407DB2
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407EB1
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407EB1
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407EB1
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40360F
		jmp	short locret_407EBF
; ---------------------------------------------------------------------------

loc_407EB1:				; CODE XREF: .text:00407E6Aj
					; .text:00407E86j ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_40360F

locret_407EBF:				; CODE XREF: .text:00407EAFj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407F29
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407F29
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407F29
		mov	dword ptr [esp], offset	a_ ; "."
		call	sub_40360F
		jmp	short locret_407F6E
; ---------------------------------------------------------------------------

loc_407F29:				; CODE XREF: .text:00407EE1j
					; .text:00407EFDj ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	sub_40350C
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_407F6E:				; CODE XREF: .text:00407F27j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407F70	proc near		; CODE XREF: sub_407F82+144p
					; sub_407F82+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_407F70	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407F82	proc near		; CODE XREF: .text:0040830Ap
					; sub_408317+23p

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_408049
; ---------------------------------------------------------------------------

loc_407FCF:				; CODE XREF: sub_407F82+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_408045
		cmp	[ebp+arg_0], 0
		jz	short loc_40802E
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_409E40
; ---------------------------------------------------------------------------

loc_40802E:				; CODE XREF: sub_407F82+8Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_4082DD
; ---------------------------------------------------------------------------

loc_408045:				; CODE XREF: sub_407F82+88j
		add	[ebp+var_C], 1

loc_408049:				; CODE XREF: sub_407F82+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_407FCF
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_408200
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_4080A3
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408119

loc_4080A3:				; CODE XREF: sub_407F82+112j
		mov	[esp+0C8h+VarName], offset VarName ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4080D4
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_407F70
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_4080D4:				; CODE XREF: sub_407F82+134j
		cmp	[ebp+var_20], 0
		jz	loc_4081FF
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4081FF
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_4081FF
; ---------------------------------------------------------------------------

loc_408119:				; CODE XREF: sub_407F82+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_408132
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_40360F
		mov	[ebp+Str], eax
		jmp	short loc_408153
; ---------------------------------------------------------------------------

loc_408132:				; CODE XREF: sub_407F82+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_403530
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_408153
		mov	eax, 0
		jmp	loc_4082DD
; ---------------------------------------------------------------------------

loc_408153:				; CODE XREF: sub_407F82+1AEj
					; sub_407F82+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_408175
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_408175:				; CODE XREF: sub_407F82+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_407F70
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_403669
		cmp	[ebp+var_20], 0
		jz	short loc_4081F6
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_408200
; ---------------------------------------------------------------------------

loc_4081F6:				; CODE XREF: sub_407F82+248j
		mov	[ebp+var_14], 1
		jmp	short loc_408200
; ---------------------------------------------------------------------------

loc_4081FF:				; CODE XREF: sub_407F82+156j
					; sub_407F82+164j ...
		nop

loc_408200:				; CODE XREF: sub_407F82+101j
					; sub_407F82+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_408216
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_40350C
		mov	[ebp+var_1C], eax
		jmp	short loc_40823F
; ---------------------------------------------------------------------------

loc_408216:				; CODE XREF: sub_407F82+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_4034F9
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40823F
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_403669
		mov	eax, 0
		jmp	loc_4082DD
; ---------------------------------------------------------------------------

loc_40823F:				; CODE XREF: sub_407F82+292j
					; sub_407F82+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_408270
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_408EC5
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_408EC5
		mov	[ebp+var_24], eax
		jmp	short loc_408285
; ---------------------------------------------------------------------------

loc_408270:				; CODE XREF: sub_407F82+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_408EC5
		mov	[ebp+var_24], eax

loc_408285:				; CODE XREF: sub_407F82+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_403669
		mov	[ebp+var_C], 0
		jmp	short loc_4082C4
; ---------------------------------------------------------------------------

loc_408299:				; CODE XREF: sub_407F82+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_408EC5
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_4082C4:				; CODE XREF: sub_407F82+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_408299
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_4079A8

loc_4082DD:				; CODE XREF: sub_407F82+BEj
					; sub_407F82+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_407F82	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 1
		call	sub_407F82
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408317	proc near		; CODE XREF: sub_4024BD+6E8p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 0
		call	sub_407F82
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408317	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_4083BC
; ---------------------------------------------------------------------------

loc_408350:				; CODE XREF: .text:004083CEj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4083B4
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_4083B4
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4083A0
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4083B4

loc_4083A0:				; CODE XREF: .text:00408394j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4083D0
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4083D0

loc_4083B4:				; CODE XREF: .text:0040835Ej
					; .text:0040838Aj ...
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1

loc_4083BC:				; CODE XREF: .text:0040834Ej
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4083D0
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408350

loc_4083D0:				; CODE XREF: .text:004083A8j
					; .text:004083B2j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4083E4
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4083F8

loc_4083E4:				; CODE XREF: .text:004083D8j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4083FF
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4083FF

loc_4083F8:				; CODE XREF: .text:004083E2j
		mov	eax, 0
		jmp	short loc_40842D
; ---------------------------------------------------------------------------

loc_4083FF:				; CODE XREF: .text:004083ECj
					; .text:004083F6j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_40842D:				; CODE XREF: .text:004083FDj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_408461
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_408461
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4084B8
; ---------------------------------------------------------------------------

loc_408461:				; CODE XREF: .text:00408441j
					; .text:0040844Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_408489
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_408489
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4084B8
; ---------------------------------------------------------------------------

loc_408489:				; CODE XREF: .text:00408469j
					; .text:00408473j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4084B1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4084B1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4084B8
; ---------------------------------------------------------------------------

loc_4084B1:				; CODE XREF: .text:00408491j
					; .text:0040849Bj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_408535
; ---------------------------------------------------------------------------

loc_4084B8:				; CODE XREF: .text:0040845Fj
					; .text:00408487j ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4084E1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4084E1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_408532
; ---------------------------------------------------------------------------

loc_4084E1:				; CODE XREF: .text:004084C4j
					; .text:004084CEj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_408506
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_408506
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_408532
; ---------------------------------------------------------------------------

loc_408506:				; CODE XREF: .text:004084E9j
					; .text:004084F3j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40852B
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_40852B
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_408532
; ---------------------------------------------------------------------------

loc_40852B:				; CODE XREF: .text:0040850Ej
					; .text:00408518j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_408535
; ---------------------------------------------------------------------------

loc_408532:				; CODE XREF: .text:004084DFj
					; .text:00408504j ...
		mov	eax, [ebp-4]

locret_408535:				; CODE XREF: .text:004084B6j
					; .text:00408530j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408537(FILE *, int, int, int,	int)
sub_408537	proc near		; CODE XREF: sub_4086F0+29p
					; .text:0040882Dp

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_4086E1
; ---------------------------------------------------------------------------

loc_40854F:				; CODE XREF: sub_408537+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_40859D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_40859D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_40859D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_40859D
		cmp	[ebp+arg_C], 0
		jnz	short loc_40858F
		cmp	[ebp+arg_10], 0
		jz	loc_4086B9

loc_40858F:				; CODE XREF: sub_408537+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4086B9

loc_40859D:				; CODE XREF: sub_408537+20j
					; sub_408537+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_4085DA
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4086D5
; ---------------------------------------------------------------------------

loc_4085DA:				; CODE XREF: sub_408537+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_408600
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4086D5
; ---------------------------------------------------------------------------

loc_408600:				; CODE XREF: sub_408537+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_408626
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4086D5
; ---------------------------------------------------------------------------

loc_408626:				; CODE XREF: sub_408537+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_40864C
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4086D5
; ---------------------------------------------------------------------------

loc_40864C:				; CODE XREF: sub_408537+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_40866F
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4086D5
; ---------------------------------------------------------------------------

loc_40866F:				; CODE XREF: sub_408537+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408692
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4086D5
; ---------------------------------------------------------------------------

loc_408692:				; CODE XREF: sub_408537+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_4086D5
; ---------------------------------------------------------------------------

loc_4086B9:				; CODE XREF: sub_408537+52j
					; sub_408537+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_4086D5:				; CODE XREF: sub_408537+9Ej
					; sub_408537+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_4086E1:				; CODE XREF: sub_408537+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_40854F
		mov	eax, [ebp+var_10]
		leave
		retn
sub_408537	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4086F0(FILE *, int, int, int)
sub_4086F0	proc near		; CODE XREF: sub_408720+B7p
					; .text:00408883p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_408537
		leave
		retn
sub_4086F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408720(FILE *, int, int, int)
sub_408720	proc near		; CODE XREF: .text:004088D9p

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_408749
; ---------------------------------------------------------------------------

loc_408736:				; CODE XREF: sub_408720+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_408753
		add	[ebp+var_C], 1

loc_408749:				; CODE XREF: sub_408720+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_408736
		jmp	short loc_408754
; ---------------------------------------------------------------------------

loc_408753:				; CODE XREF: sub_408720+23j
		nop

loc_408754:				; CODE XREF: sub_408720+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_4087BC
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_40ACA7
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; void *
		call	sub_403669
		mov	eax, [ebp+var_C]
		jmp	short loc_4087DC
; ---------------------------------------------------------------------------

loc_4087BC:				; CODE XREF: sub_408720+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_4086F0

loc_4087DC:				; CODE XREF: sub_408720+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_408720	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_408834
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408537
		jmp	short loc_408839
; ---------------------------------------------------------------------------

loc_408834:				; CODE XREF: .text:004087EDj
		mov	eax, 0

loc_408839:				; CODE XREF: .text:00408832j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40888A
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4086F0
		jmp	short loc_40888F
; ---------------------------------------------------------------------------

loc_40888A:				; CODE XREF: .text:0040884Aj
		mov	eax, 0

loc_40888F:				; CODE XREF: .text:00408888j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4088E0
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408720
		jmp	short loc_4088E5
; ---------------------------------------------------------------------------

loc_4088E0:				; CODE XREF: .text:004088A0j
		mov	eax, 0

loc_4088E5:				; CODE XREF: .text:004088DEj
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 1
		jmp	loc_408995
; ---------------------------------------------------------------------------

loc_40890F:				; CODE XREF: .text:00408999j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_408941
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_408941
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_408941
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_408989
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_408989

loc_408941:				; CODE XREF: .text:00408917j
					; .text:00408921j ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_40897D
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_40897D
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_40897D
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_40897D
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_40897D
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408983

loc_40897D:				; CODE XREF: .text:00408949j
					; .text:00408953j ...
		add	dword ptr [ebp-10h], 2
		jmp	short loc_40898D
; ---------------------------------------------------------------------------

loc_408983:				; CODE XREF: .text:0040897Bj
		add	dword ptr [ebp-10h], 5
		jmp	short loc_40898D
; ---------------------------------------------------------------------------

loc_408989:				; CODE XREF: .text:00408935j
					; .text:0040893Fj
		add	dword ptr [ebp-10h], 1

loc_40898D:				; CODE XREF: .text:00408981j
					; .text:00408987j
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_408995:				; CODE XREF: .text:0040890Aj
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_40890F
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-18h]
		mov	[ebp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40350C
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-14h], eax
		jmp	loc_408AD2
; ---------------------------------------------------------------------------

loc_4089C4:				; CODE XREF: .text:00408AD6j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4089FE
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_4089FE
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_4089FE
		cmp	dword ptr [ebp+10h], 0
		jz	loc_408AB9
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_408AB9

loc_4089FE:				; CODE XREF: .text:004089CCj
					; .text:004089D6j ...
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_408A21
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	6Eh
		add	dword ptr [ebp-14h], 1
		jmp	loc_408ACA
; ---------------------------------------------------------------------------

loc_408A21:				; CODE XREF: .text:00408A10j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_408A3A
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	72h
		add	dword ptr [ebp-14h], 1
		jmp	loc_408ACA
; ---------------------------------------------------------------------------

loc_408A3A:				; CODE XREF: .text:00408A29j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_408A50
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	66h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_408ACA
; ---------------------------------------------------------------------------

loc_408A50:				; CODE XREF: .text:00408A42j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_408A66
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	76h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_408ACA
; ---------------------------------------------------------------------------

loc_408A66:				; CODE XREF: .text:00408A58j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_408A7C
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	62h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_408ACA
; ---------------------------------------------------------------------------

loc_408A7C:				; CODE XREF: .text:00408A6Ej
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408A92
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	30h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_408ACA
; ---------------------------------------------------------------------------

loc_408A92:				; CODE XREF: .text:00408A84j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sprintf
		add	dword ptr [ebp-14h], 3
		jmp	short loc_408ACA
; ---------------------------------------------------------------------------

loc_408AB9:				; CODE XREF: .text:004089EAj
					; .text:004089F8j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1

loc_408ACA:				; CODE XREF: .text:00408A1Cj
					; .text:00408A35j ...
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_408AD2:				; CODE XREF: .text:004089BFj
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_4089C4
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_408B13
; ---------------------------------------------------------------------------

loc_408AF6:				; CODE XREF: .text:00408B1Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_408B0F
		add	dword ptr [ebp-4], 1

loc_408B0F:				; CODE XREF: .text:00408B09j
		add	dword ptr [ebp+8], 1

loc_408B13:				; CODE XREF: .text:00408AF4j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408AF6
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408B22(DWORD)
sub_408B22	proc near		; CODE XREF: .text:00407209p

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_408B38
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_408B38:				; CODE XREF: sub_408B22+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_408B22	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_408B95
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_408B95
		mov	eax, 1
		jmp	short loc_408B9A
; ---------------------------------------------------------------------------

loc_408B95:				; CODE XREF: .text:00408B86j
					; .text:00408B8Cj
		mov	eax, 0

loc_408B9A:				; CODE XREF: .text:00408B93j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_408BB2
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_408BB2
		mov	eax, 1
		jmp	short loc_408BB7
; ---------------------------------------------------------------------------

loc_408BB2:				; CODE XREF: .text:00408BA3j
					; .text:00408BA9j
		mov	eax, 0

loc_408BB7:				; CODE XREF: .text:00408BB0j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408BB9	proc near		; CODE XREF: .text:00407B06p
					; .text:00407B19p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_408BCC
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_408BCC
		and	[ebp+arg_0], 0FFFFFFDFh

loc_408BCC:				; CODE XREF: sub_408BB9+7j
					; sub_408BB9+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_408BB9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408BD1	proc near		; CODE XREF: .text:00408CD6p
					; .text:00408CEAp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_408BE4
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_408BE4
		or	[ebp+arg_0], 20h

loc_408BE4:				; CODE XREF: sub_408BD1+7j
					; sub_408BD1+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_408BD1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408BE9	proc near		; CODE XREF: .text:0040A0FAp
					; .text:0040A111p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_408C44
		mov	eax, 0
		jmp	loc_408C9D
; ---------------------------------------------------------------------------

loc_408C02:				; CODE XREF: sub_408BE9+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_408C3A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_408BB9
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_408BB9
		cmp	ebx, eax
		jnz	short loc_408C5B

loc_408C3A:				; CODE XREF: sub_408BE9+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_408C45
; ---------------------------------------------------------------------------

loc_408C44:				; CODE XREF: sub_408BE9+Dj
		nop

loc_408C45:				; CODE XREF: sub_408BE9+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408C5C
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408C02
		jmp	short loc_408C5C
; ---------------------------------------------------------------------------

loc_408C5B:				; CODE XREF: sub_408BE9+4Fj
		nop

loc_408C5C:				; CODE XREF: sub_408BE9+64j
					; sub_408BE9+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_408C98
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_408BB9
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_408BB9
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_408C9D
; ---------------------------------------------------------------------------

loc_408C98:				; CODE XREF: sub_408BE9+81j
		mov	eax, 0

loc_408C9D:				; CODE XREF: sub_408BE9+14j
					; sub_408BE9+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_408BE9	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_408CC3
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_408CCA

loc_408CC3:				; CODE XREF: .text:00408CBBj
		mov	eax, 0
		jmp	short locret_408D21
; ---------------------------------------------------------------------------

loc_408CCA:				; CODE XREF: .text:00408CC1j
					; .text:00408D11j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408BD1
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408BD1
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_408D13
		cmp	byte ptr [ebp-9], 0
		jz	short loc_408D13
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_408CCA

loc_408D13:				; CODE XREF: .text:00408CFAj
					; .text:00408D00j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_408D21:				; CODE XREF: .text:00408CC8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D23	proc near		; CODE XREF: .text:00408EA4p
					; .text:0040A0BDp

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_408DD3
		mov	eax, 0
		jmp	loc_408DE2
; ---------------------------------------------------------------------------

loc_408D4C:				; CODE XREF: sub_408D23+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_408DC7
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_408BB9
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_408BB9
		cmp	ebx, eax
		jz	short loc_408DC7
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_408DC0
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_408BB9
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_408BB9
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_408DC5
; ---------------------------------------------------------------------------

loc_408DC0:				; CODE XREF: sub_408D23+6Fj
		mov	eax, 0

loc_408DC5:				; CODE XREF: sub_408D23+9Bj
		jmp	short loc_408DE2
; ---------------------------------------------------------------------------

loc_408DC7:				; CODE XREF: sub_408D23+37j
					; sub_408D23+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_408DD3:				; CODE XREF: sub_408D23+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_408D4C
		mov	eax, 0

loc_408DE2:				; CODE XREF: sub_408D23+24j
					; sub_408D23:loc_408DC5j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_408D23	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_408E14
		mov	eax, 0
		jmp	short loc_408E5B
; ---------------------------------------------------------------------------

loc_408DFA:				; CODE XREF: .text:00408E27j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_408E2B
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_408E15
; ---------------------------------------------------------------------------

loc_408E14:				; CODE XREF: .text:00408DF1j
		nop

loc_408E15:				; CODE XREF: .text:00408E12j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408E2C
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408DFA
		jmp	short loc_408E2C
; ---------------------------------------------------------------------------

loc_408E2B:				; CODE XREF: .text:00408E08j
		nop

loc_408E2C:				; CODE XREF: .text:00408E1Dj
					; .text:00408E29j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_408E56
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_408E5B
; ---------------------------------------------------------------------------

loc_408E56:				; CODE XREF: .text:00408E3Aj
		mov	eax, 0

loc_408E5B:				; CODE XREF: .text:00408DF8j
					; .text:00408E54j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_408E6E
		mov	eax, [ebp+8]
		jmp	short locret_408EC3
; ---------------------------------------------------------------------------

loc_408E6E:				; CODE XREF: .text:00408E67j
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_408EBE
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_408EB6
; ---------------------------------------------------------------------------

loc_408E90:				; CODE XREF: .text:00408EBCj
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_408D23
		test	eax, eax
		jnz	short loc_408EB2
		mov	eax, [ebp-4]
		jmp	short locret_408EC3
; ---------------------------------------------------------------------------

loc_408EB2:				; CODE XREF: .text:00408EABj
		add	dword ptr [ebp-4], 1

loc_408EB6:				; CODE XREF: .text:00408E8Ej
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_408E90

loc_408EBE:				; CODE XREF: .text:00408E74j
		mov	eax, 0

locret_408EC3:				; CODE XREF: .text:00408E6Cj
					; .text:00408EB0j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408EC5	proc near		; CODE XREF: sub_407F82+2D8p
					; sub_407F82+2E4p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_408EDD
; ---------------------------------------------------------------------------

loc_408ECA:				; CODE XREF: sub_408EC5+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_408EDD:				; CODE XREF: sub_408EC5+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408ECA
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_408EC5	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_408F10
		mov	eax, 0
		jmp	locret_408FBB
; ---------------------------------------------------------------------------

loc_408F10:				; CODE XREF: .text:00408F04j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408F27
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408F80

loc_408F27:				; CODE XREF: .text:00408F18j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_408F3F
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_408F95
; ---------------------------------------------------------------------------

loc_408F3F:				; CODE XREF: .text:00408F34j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_408F52
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_408F95
; ---------------------------------------------------------------------------

loc_408F52:				; CODE XREF: .text:00408F48j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408F65
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_408F95
; ---------------------------------------------------------------------------

loc_408F65:				; CODE XREF: .text:00408F5Aj
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_408F95
; ---------------------------------------------------------------------------

loc_408F80:				; CODE XREF: .text:00408F25j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_408F95:				; CODE XREF: .text:00408F3Dj
					; .text:00408F50j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_408FAF
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_408FB8
; ---------------------------------------------------------------------------

loc_408FAF:				; CODE XREF: .text:00408F99j
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_408FB8:				; CODE XREF: .text:00408FADj
		mov	eax, [ebp-10h]

locret_408FBB:				; CODE XREF: .text:00408F0Bj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+10h]
		add	[ebp-4], eax
		jmp	short loc_408FEC
; ---------------------------------------------------------------------------

loc_408FD1:				; CODE XREF: .text:00408FF0j
		sub	dword ptr [ebp-4], 1
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+0Ch]
		jnz	short loc_408FE8
		mov	eax, [ebp-4]
		jmp	short locret_408FF7
; ---------------------------------------------------------------------------

loc_408FE8:				; CODE XREF: .text:00408FE1j
		sub	dword ptr [ebp+10h], 1

loc_408FEC:				; CODE XREF: .text:00408FCFj
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_408FD1
		mov	eax, 0

locret_408FF7:				; CODE XREF: .text:00408FE6j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408FF9(int, char *, int)
sub_408FF9	proc near		; CODE XREF: .text:00409229p
					; .text:0040924Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40900F
		mov	eax, 0
		jmp	locret_40920C
; ---------------------------------------------------------------------------

loc_40900F:				; CODE XREF: sub_408FF9+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_409065
; ---------------------------------------------------------------------------

loc_40901E:				; CODE XREF: sub_408FF9+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_40905D
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_40905D
		cmp	[ebp+arg_4], 0
		jz	short loc_409061
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_409061

loc_40905D:				; CODE XREF: sub_408FF9+30j
					; sub_408FF9+3Dj
		add	[ebp+var_10], 1

loc_409061:				; CODE XREF: sub_408FF9+43j
					; sub_408FF9+62j
		add	[ebp+var_C], 1

loc_409065:				; CODE XREF: sub_408FF9+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40901E
		cmp	[ebp+arg_8], 0
		jz	short loc_409090
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_40350C
		mov	[ebp+var_14], eax
		jmp	short loc_4090B6
; ---------------------------------------------------------------------------

loc_409090:				; CODE XREF: sub_408FF9+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_4034F9
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4090B6
		mov	eax, 0
		jmp	locret_40920C
; ---------------------------------------------------------------------------

loc_4090B6:				; CODE XREF: sub_408FF9+95j
					; sub_408FF9+B1j
		mov	[ebp+var_C], 0
		jmp	loc_4091F2
; ---------------------------------------------------------------------------

loc_4090C2:				; CODE XREF: sub_408FF9+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_4090F8
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_4091EE
; ---------------------------------------------------------------------------

loc_4090F8:				; CODE XREF: sub_408FF9+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_40912E
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_4091EE
; ---------------------------------------------------------------------------

loc_40912E:				; CODE XREF: sub_408FF9+107j
		cmp	[ebp+arg_4], 0
		jz	loc_4091DC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_4091DC
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40918F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_40919B
; ---------------------------------------------------------------------------

loc_40918F:				; CODE XREF: sub_408FF9+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_40919B:				; CODE XREF: sub_408FF9+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4091C8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_4091D4
; ---------------------------------------------------------------------------

loc_4091C8:				; CODE XREF: sub_408FF9+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_4091D4:				; CODE XREF: sub_408FF9+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_4091EE
; ---------------------------------------------------------------------------

loc_4091DC:				; CODE XREF: sub_408FF9+139j
					; sub_408FF9+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_4091EE:				; CODE XREF: sub_408FF9+FAj
					; sub_408FF9+130j ...
		add	[ebp+arg_0], 1

loc_4091F2:				; CODE XREF: sub_408FF9+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4090C2
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_40920C:				; CODE XREF: sub_408FF9+11j
					; sub_408FF9+B8j
		leave
		retn
sub_408FF9	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408FF9
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408FF9
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409252	proc near		; CODE XREF: .text:004093A1p
					; .text:004093E0p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4092EB
; ---------------------------------------------------------------------------

loc_40929E:				; CODE XREF: sub_409252+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_4092E7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_409366
; ---------------------------------------------------------------------------

loc_4092E7:				; CODE XREF: sub_409252+7Fj
		add	[ebp+var_C], 1

loc_4092EB:				; CODE XREF: sub_409252+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_40929E
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax ; size_t
		call	sub_4034F9
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_409363
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_409355
; ---------------------------------------------------------------------------

loc_409335:				; CODE XREF: sub_409252+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_408EC5
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_409355:				; CODE XREF: sub_409252+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_409335

loc_409363:				; CODE XREF: sub_409252+D2j
		mov	eax, [ebp+var_18]

loc_409366:				; CODE XREF: sub_409252+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_409252	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_40938C
		mov	dword ptr [esp], offset	word_4121BA
		call	sub_403530
		mov	[ebp-0Ch], eax
		jmp	short loc_4093A9
; ---------------------------------------------------------------------------

loc_40938C:				; CODE XREF: .text:00409379j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409252
		mov	[ebp-0Ch], eax

loc_4093A9:				; CODE XREF: .text:0040938Aj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4093CB
		mov	dword ptr [esp], offset	word_4121BA
		call	sub_40360F
		mov	[ebp-0Ch], eax
		jmp	short loc_4093E8
; ---------------------------------------------------------------------------

loc_4093CB:				; CODE XREF: .text:004093B8j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409252
		mov	[ebp-0Ch], eax

loc_4093E8:				; CODE XREF: .text:004093C9j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40945C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_409427
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 25h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		jmp	short loc_409450
; ---------------------------------------------------------------------------

loc_409427:				; CODE XREF: .text:004093FAj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 16h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite

loc_409450:				; CODE XREF: .text:00409425j
		mov	dword ptr [esp], 2
		call	exit
; ---------------------------------------------------------------------------

loc_40945C:				; CODE XREF: .text:004093ECj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_4143AC
		mov	[ebp-4], eax
		cmp	dword ptr [ebp+8], 0
		jz	short loc_409482
		mov	ds:dword_4143AC, 0

loc_409482:				; CODE XREF: .text:00409476j
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4143AC
		add	eax, 1
		mov	ds:dword_4143AC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409499(char *Filename, int FileHandle)
sub_409499	proc near		; CODE XREF: sub_4096F8+21p
					; .text:00409734p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_414320
		test	eax, eax
		jz	short loc_4094E3
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:dword_414320
		cmp	edx, eax
		jz	short loc_4094D9
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:dword_414320
		cmp	edx, eax
		jz	short loc_4094D9
		mov	eax, ds:dword_414320
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_4094D9:				; CODE XREF: sub_409499+20j
					; sub_409499+31j
		mov	ds:dword_414320, 0

loc_4094E3:				; CODE XREF: sub_409499+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_40952B
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_41220C ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40952B
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_40952B:				; CODE XREF: sub_409499+4Ej
					; sub_409499+76j
		cmp	[ebp+Filename],	0
		jz	short loc_409581
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40956D
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40956D
		mov	eax, 1
		jmp	short loc_409572
; ---------------------------------------------------------------------------

loc_40956D:				; CODE XREF: sub_409499+BEj
					; sub_409499+CBj
		mov	eax, 0

loc_409572:				; CODE XREF: sub_409499+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_409588
		add	[ebp+Filename],	9
		jmp	short loc_409588
; ---------------------------------------------------------------------------

loc_409581:				; CODE XREF: sub_409499+96j
		mov	[ebp+var_10], 0

loc_409588:				; CODE XREF: sub_409499+E0j
					; sub_409499+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_4095C4
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_40961F
; ---------------------------------------------------------------------------

loc_4095C4:				; CODE XREF: sub_409499+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_4095E3
		mov	eax, offset aA	; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_40961F
; ---------------------------------------------------------------------------

loc_4095E3:				; CODE XREF: sub_409499+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_4095F6
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_40961F
; ---------------------------------------------------------------------------

loc_4095F6:				; CODE XREF: sub_409499+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_409609
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_40961F
; ---------------------------------------------------------------------------

loc_409609:				; CODE XREF: sub_409499+161j
		mov	[esp+28h+Size],	offset aA ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_40961F:				; CODE XREF: sub_409499+129j
					; sub_409499+148j ...
		mov	dword_410000, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_4096B4
		cmp	[ebp+Filename],	0
		jz	short loc_409671
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_4096A7
; ---------------------------------------------------------------------------

loc_409671:				; CODE XREF: sub_409499+19Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_4096A7:				; CODE XREF: sub_409499+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_4096D7
; ---------------------------------------------------------------------------

loc_4096B4:				; CODE XREF: sub_409499+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_4096D7:				; CODE XREF: sub_409499+219j
		mov	eax, [ebp+var_C]
		mov	ds:dword_414320, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_4143A4, eax
		mov	ds:dword_4143A8, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_409499	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4096F8(char *)
sub_4096F8	proc near		; CODE XREF: sub_4098BA+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_409709
		mov	eax, [ebp+arg_0]
		jmp	short loc_40970E
; ---------------------------------------------------------------------------

loc_409709:				; CODE XREF: sub_4096F8+Aj
		mov	eax, offset asc_41220C ; "-"

loc_40970E:				; CODE XREF: sub_4096F8+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_409499
		leave
		retn
sub_4096F8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_409499
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_41439C, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_409776
		mov	dword ptr [esp+8], 4Fh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	byte_414340
		call	strncpy
		mov	ds:byte_41438F,	0

loc_409776:				; CODE XREF: .text:00409752j
		mov	eax, [ebp+0Ch]
		and	eax, 1
		mov	ds:dword_414394, eax
		mov	eax, [ebp+0Ch]
		and	eax, 2
		mov	ds:dword_414390, eax
		mov	eax, [ebp+0Ch]
		and	eax, 4
		mov	ds:dword_414398, eax
		mov	eax, [ebp+0Ch]
		and	eax, 100h
		mov	ds:dword_4143A0, eax
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_409818
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_414394
		test	eax, eax
		jz	short loc_4097D0
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_4097D0:				; CODE XREF: .text:004097BFj
		mov	eax, ds:dword_414390
		test	eax, eax
		jz	short loc_4097E8
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_4097E8:				; CODE XREF: .text:004097D7j
		mov	eax, ds:dword_414398
		test	eax, eax
		jz	short loc_409800
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_409800:				; CODE XREF: .text:004097EFj
		mov	eax, ds:dword_4143A0
		test	eax, eax
		jz	short loc_409818
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_409818:				; CODE XREF: .text:004097ADj
					; .text:00409807j
		mov	eax, offset byte_414340
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_414320
		test	eax, eax
		jz	short loc_409853
		mov	eax, ds:dword_414320
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_409853
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_409853
		mov	eax, 1
		jmp	short locret_409873
; ---------------------------------------------------------------------------

loc_409853:				; CODE XREF: .text:0040982Cj
					; .text:00409842j ...
		mov	eax, dword_410000
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40986E
		mov	eax, dword_410000
		cmp	eax, [ebp+8]
		jnz	short loc_40986E
		mov	eax, 1
		jmp	short locret_409873
; ---------------------------------------------------------------------------

loc_40986E:				; CODE XREF: .text:0040985Bj
					; .text:00409865j
		mov	eax, 0

locret_409873:				; CODE XREF: .text:00409851j
					; .text:0040986Cj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_414320
		test	eax, eax
		jnz	short loc_40988E
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_409893
; ---------------------------------------------------------------------------

loc_40988E:				; CODE XREF: .text:00409882j
		mov	eax, ds:dword_414320

loc_409893:				; CODE XREF: .text:0040988Cj
		mov	[esp], eax
		call	_fileno
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_414320
		test	eax, eax
		jnz	short loc_4098B3
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_4098B8
; ---------------------------------------------------------------------------

loc_4098B3:				; CODE XREF: .text:004098A7j
		mov	eax, ds:dword_414320

loc_4098B8:				; CODE XREF: .text:004098B1j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4098BA(int, char *Format, va_list ArgList)
sub_4098BA	proc near		; CODE XREF: sub_409C3D+22p
					; .text:00409C80p ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_414320
		test	eax, eax
		jnz	short loc_4098FD
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_4096F8
		mov	eax, ds:dword_414320
		test	eax, eax
		jnz	short loc_4098FD
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_40E8D0

loc_4098FD:				; CODE XREF: sub_4098BA+10j
					; sub_4098BA+25j
		mov	eax, ds:dword_4143A8
		test	eax, eax
		jz	short loc_409921
		cmp	[ebp+arg_0], 1
		jz	short loc_409921
		mov	eax, ds:dword_414320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_409921:				; CODE XREF: sub_4098BA+4Aj
					; sub_4098BA+50j
		mov	ds:dword_4143A8, 0
		cmp	[ebp+arg_0], 1
		jz	loc_409AB8
		mov	eax, ds:dword_414390
		test	eax, eax
		jz	loc_4099D1
		mov	eax, ds:dword_4143A4
		test	eax, eax
		jnz	loc_4099D1
		mov	[esp+58h+var_58], 0
		call	sub_40EFD0
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_40EFE0
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:dword_414320
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_4099D1:				; CODE XREF: sub_4098BA+82j
					; sub_4098BA+8Fj
		mov	eax, ds:dword_414394
		test	eax, eax
		jnz	short loc_4099E3
		mov	eax, ds:dword_4143A4
		test	eax, eax
		jz	short loc_4099FA

loc_4099E3:				; CODE XREF: sub_4098BA+11Ej
		mov	edx, ds:dword_414320
		mov	eax, offset byte_414340
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_4099FA:				; CODE XREF: sub_4098BA+127j
		mov	eax, ds:dword_414398
		test	eax, eax
		jnz	short loc_409A0C
		mov	eax, ds:dword_4143A4
		test	eax, eax
		jz	short loc_409A66

loc_409A0C:				; CODE XREF: sub_4098BA+147j
		mov	eax, ds:dword_41439C
		test	eax, eax
		jz	short loc_409A45
		mov	eax, ds:dword_41439C
		call	eax ; dword_41439C
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:dword_414320
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_409A66
; ---------------------------------------------------------------------------

loc_409A45:				; CODE XREF: sub_4098BA+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU	; "[%u]"
		mov	eax, ds:dword_414320
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_409A66:				; CODE XREF: sub_4098BA+150j
					; sub_4098BA+189j
		mov	eax, ds:dword_414390
		test	eax, eax
		jz	short loc_409A78
		mov	eax, ds:dword_4143A4
		test	eax, eax
		jz	short loc_409A8D

loc_409A78:				; CODE XREF: sub_4098BA+1B3j
		mov	eax, ds:dword_414320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_409A8D:				; CODE XREF: sub_4098BA+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_409AA3
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_409AA3
		add	[ebp+Format], 1
		jmp	short loc_409AB8
; ---------------------------------------------------------------------------

loc_409AA3:				; CODE XREF: sub_4098BA+1D7j
					; sub_4098BA+1E1j
		mov	eax, ds:dword_414320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_409AB8:				; CODE XREF: sub_4098BA+75j
					; sub_4098BA+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_409B4C	; jumptable 00409ACF default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_41233C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_409AD1:				; CODE XREF: sub_4098BA+215j
					; DATA XREF: .rdata:off_41233Co
		mov	edx, ds:dword_414320 ; jumptable 00409ACF case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_409B6C
; ---------------------------------------------------------------------------

loc_409AFA:				; CODE XREF: sub_4098BA+215j
					; DATA XREF: .rdata:off_41233Co
		mov	edx, ds:dword_414320 ; jumptable 00409ACF case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_409B6C
; ---------------------------------------------------------------------------

loc_409B23:				; CODE XREF: sub_4098BA+215j
					; DATA XREF: .rdata:off_41233Co
		mov	edx, ds:dword_414320 ; jumptable 00409ACF case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_409B6C
; ---------------------------------------------------------------------------

loc_409B4C:				; CODE XREF: sub_4098BA+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	00409ACF default case
		mov	eax, ds:dword_414320
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_409B6C
; ---------------------------------------------------------------------------

loc_409B6B:				; CODE XREF: sub_4098BA+215j
					; DATA XREF: .rdata:off_41233Co
		nop			; jumptable 00409ACF cases 0-4

loc_409B6C:				; CODE XREF: sub_4098BA+23Ej
					; sub_4098BA+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_409BDC
		mov	eax, ds:dword_414320
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_409BCF
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_409BCF
		mov	ds:dword_4143A8, 1
		jmp	short loc_409BDC
; ---------------------------------------------------------------------------

loc_409BCF:				; CODE XREF: sub_4098BA+2DBj
					; sub_4098BA+307j
		mov	eax, ds:dword_414320
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_409BDC:				; CODE XREF: sub_4098BA+2B6j
					; sub_4098BA+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_409C0C
		mov	eax, ds:dword_4143A8
		test	eax, eax
		jz	short loc_409C00
		mov	eax, ds:dword_414320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_409C00:				; CODE XREF: sub_4098BA+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_409C0C:				; CODE XREF: sub_4098BA+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_409C35
		mov	eax, ds:dword_4143A8
		test	eax, eax
		jz	short loc_409C30
		mov	eax, ds:dword_414320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_409C30:				; CODE XREF: sub_4098BA+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_409C35:				; CODE XREF: sub_4098BA+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4098BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409C3D(int, char *, char)
sub_409C3D	proc near		; CODE XREF: sub_409E40+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4098BA
		leave
		retn
sub_409C3D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4098BA
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409C87(char *, char)
sub_409C87	proc near		; CODE XREF: sub_4068CC+13Dp
					; sub_409E74+8Ep ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_4098BA
		leave
		retn
sub_409C87	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409CB1(char *, char)
sub_409CB1	proc near		; CODE XREF: sub_403B2B+D6p
					; sub_403C54+E3p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_4098BA
		mov	eax, ds:dword_4143AC
		cmp	eax, 752Fh
		jg	short locret_409CF2
		mov	eax, ds:dword_4143AC
		add	eax, 1
		mov	ds:dword_4143AC, eax

locret_409CF2:				; CODE XREF: sub_409CB1+32j
		leave
		retn
sub_409CB1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 5
		call	sub_4098BA
		call	abort

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_409D21(char *, char)
sub_409D21	proc near		; CODE XREF: sub_405F98+19Bp
					; sub_405F98+28Ep ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_4098BA
		call	abort
sub_409D21	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409D4E(char *, char)
sub_409D4E	proc near		; CODE XREF: sub_4037F6+46p
					; sub_4037F6+93p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_4098BA
		leave
		retn
sub_409D4E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409D78(char *, char)
sub_409D78	proc near		; CODE XREF: .text:00409DF1p
					; .text:00409E14p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4098BA
		leave
		retn
sub_409D78	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_409DD1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_409DD1
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_41235C
		call	sub_409D4E

loc_409DD1:				; CODE XREF: .text:00409DB2j
					; .text:00409DBCj
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_409E2C
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x ; "%02X"
		call	sub_409D78
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_409E1D
; ---------------------------------------------------------------------------

loc_409E00:				; CODE XREF: .text:00409E2Aj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_0 ; " %02X"
		call	sub_409D78
		add	dword ptr [ebp-0Ch], 1

loc_409E1D:				; CODE XREF: .text:00409DFEj
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_409E00

loc_409E2C:				; CODE XREF: .text:00409DD5j
		cmp	dword ptr [ebp+8], 0
		jz	short locret_409E3E
		mov	dword ptr [esp], offset	asc_41236B ; "\n"
		call	sub_409D78

locret_409E3E:				; CODE XREF: .text:00409E30j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_409E40	proc near		; CODE XREF: sub_404109+4EAp
					; sub_404109+870p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_409C3D
		call	abort
sub_409E40	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409E74	proc near		; CODE XREF: .text:0040A1EEp
					; .text:0040A237p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_409F09
		cmp	[ebp+arg_0], 0
		jz	short loc_409ECD
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_409ECD
		mov	eax, ds:dword_4143F0
		mov	[ebp+var_1C], eax
		mov	ds:dword_4143F0, 1
		jmp	short loc_409EDF
; ---------------------------------------------------------------------------

loc_409ECD:				; CODE XREF: sub_409E74+1Bj
					; sub_409E74+43j
		mov	eax, ds:dword_4143F4
		mov	[ebp+var_1C], eax
		mov	ds:dword_4143F4, 1

loc_409EDF:				; CODE XREF: sub_409E74+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_409F47
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_40C7E0
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_409C87
		jmp	short loc_409F47
; ---------------------------------------------------------------------------

loc_409F09:				; CODE XREF: sub_409E74+15j
		mov	eax, ds:dword_4143F8
		test	eax, eax
		jnz	short loc_409F3D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_40C7E0
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_409C87

loc_409F3D:				; CODE XREF: sub_409E74+9Cj
		mov	ds:dword_4143F8, 1

loc_409F47:				; CODE XREF: sub_409E74+6Fj
					; sub_409E74+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_409F6B
		mov	off_410004, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_4143C0, 0
		mov	ds:dword_4143C4, 0

loc_409F6B:				; CODE XREF: sub_409E74+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_409E74	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jnz	loc_40A07D
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_409F9E
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp-0Ch], eax

loc_409F9E:				; CODE XREF: .text:00409F92j
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp-0Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4143D0
		call	sprintf
		mov	dword ptr [ebp+8], offset dword_4143D0
		mov	dword ptr [ebp-10h], offset aCp936 ; "CP936"
		jmp	loc_40A06F
; ---------------------------------------------------------------------------

loc_409FCD:				; CODE XREF: .text:0040A077j
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4143D0
		call	strcmp
		test	eax, eax
		jz	short loc_409FFB
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_40A025
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A025

loc_409FFB:				; CODE XREF: .text:00409FE2j
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp-10h]
		mov	[ebp+8], eax
		jmp	short loc_40A07D
; ---------------------------------------------------------------------------

loc_40A025:				; CODE XREF: .text:00409FECj
					; .text:00409FF9j
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax

loc_40A06F:				; CODE XREF: .text:00409FC8j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_409FCD

loc_40A07D:				; CODE XREF: .text:00409F7Ej
					; .text:0040A023j
		mov	eax, [ebp+8]
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_40A0E2
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], offset aIso ; "iso"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408D23
		test	eax, eax
		jnz	short loc_40A0E2
		add	dword ptr [ebp+8], 3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_40A0DE
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_40A0E2

loc_40A0DE:				; CODE XREF: .text:0040A0D2j
		add	dword ptr [ebp+8], 1

loc_40A0E2:				; CODE XREF: .text:0040A0A5j
					; .text:0040A0C4j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40A148
		mov	dword ptr [esp+4], offset a88591 ; "8859-1"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408BE9
		test	eax, eax
		jz	short loc_40A148
		mov	dword ptr [esp+4], offset a646 ; "646"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408BE9
		test	eax, eax
		jz	short loc_40A148
		mov	dword ptr [esp+4], offset aAscii ; "ASCII"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408BE9
		test	eax, eax
		jz	short loc_40A148
		mov	dword ptr [esp+4], offset aAnsi_x3_41968 ; "ANSI_X3.4-1968"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408BE9
		test	eax, eax
		jnz	short loc_40A16B

loc_40A148:				; CODE XREF: .text:0040A0EAj
					; .text:0040A101j ...
		mov	off_410004, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_4143C0, 0
		mov	ds:dword_4143C4, 0
		jmp	loc_40A26A
; ---------------------------------------------------------------------------

loc_40A16B:				; CODE XREF: .text:0040A146j
		mov	dword ptr [esp+4], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408BE9
		test	eax, eax
		jz	short loc_40A199
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408BE9
		test	eax, eax
		jnz	short loc_40A1BC

loc_40A199:				; CODE XREF: .text:0040A180j
		mov	off_410004, offset aUtf8 ; "utf-8"
		mov	ds:dword_4143C0, 1
		mov	ds:dword_4143C4, 0
		jmp	loc_40A26A
; ---------------------------------------------------------------------------

loc_40A1BC:				; CODE XREF: .text:0040A197j
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	libiconv_open
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_40A1FA
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_409E74
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40A26F
; ---------------------------------------------------------------------------

loc_40A1FA:				; CODE XREF: .text:0040A1D6j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	libiconv_close
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	libiconv_open
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_40A243
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	sub_409E74
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40A26F
; ---------------------------------------------------------------------------

loc_40A243:				; CODE XREF: .text:0040A21Fj
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	libiconv_close
		mov	eax, [ebp-14h]
		mov	off_410004, eax
		mov	ds:dword_4143C0, 0
		mov	ds:dword_4143C4, 1

loc_40A26A:				; CODE XREF: .text:0040A166j
					; .text:0040A1B7j
		mov	eax, 0

loc_40A26F:				; CODE XREF: .text:0040A1F8j
					; .text:0040A241j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_410004
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4143C0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A289(char *)
sub_40A289	proc near		; CODE XREF: sub_40A289+129p

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_4143C0
		test	eax, eax
		jz	short loc_40A2BB
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_40360F
		mov	[ebp+var_20], eax
		jmp	loc_40A4CA
; ---------------------------------------------------------------------------

loc_40A2BB:				; CODE XREF: sub_40A289+1Dj
		mov	eax, ds:dword_4143C4
		test	eax, eax
		jnz	loc_40A371
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_40A2E6
; ---------------------------------------------------------------------------

loc_40A2D0:				; CODE XREF: sub_40A289+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40A2E2
		add	[ebp+var_28], 1

loc_40A2E2:				; CODE XREF: sub_40A289+53j
		add	[ebp+var_1C], 1

loc_40A2E6:				; CODE XREF: sub_40A289+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A2D0
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_40350C
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_40A35C
; ---------------------------------------------------------------------------

loc_40A30F:				; CODE XREF: sub_40A289+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40A349
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_40A358
; ---------------------------------------------------------------------------

loc_40A349:				; CODE XREF: sub_40A289+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_40A358:				; CODE XREF: sub_40A289+BEj
		add	[ebp+var_1C], 1

loc_40A35C:				; CODE XREF: sub_40A289+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A30F
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_40A4CA
; ---------------------------------------------------------------------------

loc_40A371:				; CODE XREF: sub_40A289+39j
		mov	eax, off_410004
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_40A3BC
		mov	eax, off_410004
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_409E74
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_40A289
		jmp	loc_40A4CD
; ---------------------------------------------------------------------------

loc_40A3BC:				; CODE XREF: sub_40A289+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_40A3DA
; ---------------------------------------------------------------------------

loc_40A3C4:				; CODE XREF: sub_40A289+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40A3D6
		add	[ebp+var_28], 5

loc_40A3D6:				; CODE XREF: sub_40A289+147j
		add	[ebp+var_1C], 1

loc_40A3DA:				; CODE XREF: sub_40A289+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A3C4
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_40350C
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40A4B9
		mov	eax, ds:dword_4143CC
		test	eax, eax
		jnz	short loc_40A49B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_410004
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_40C7E0
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_409C87

loc_40A49B:				; CODE XREF: sub_40A289+1D3j
		mov	ds:dword_4143CC, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_40A4BF
; ---------------------------------------------------------------------------

loc_40A4B9:				; CODE XREF: sub_40A289+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_40A4BF:				; CODE XREF: sub_40A289+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_40A4CA:				; CODE XREF: sub_40A289+2Dj
					; sub_40A289+E3j
		mov	eax, [ebp+var_20]

loc_40A4CD:				; CODE XREF: sub_40A289+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40A289	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A4D5	proc near		; CODE XREF: sub_40A4D5+797p
					; sub_40ACA7+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_40A4F9:				; CODE XREF: sub_40A4D5+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_40AA9B
; ---------------------------------------------------------------------------

loc_40A51E:				; CODE XREF: sub_40A4D5+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_40A57D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40A576
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_40A542
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_40A576

loc_40A542:				; CODE XREF: sub_40A4D5+61j
		cmp	[ebp+var_24], 0
		jz	short loc_40A56D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_40A56D:				; CODE XREF: sub_40A4D5+71j
		add	[ebp+var_1C], 4
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A576:				; CODE XREF: sub_40A4D5+57j
					; sub_40A4D5+6Bj
		mov	[ebp+var_30], 0

loc_40A57D:				; CODE XREF: sub_40A4D5+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_40A8B0
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_40A708
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_40A6E8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_40A5D9
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_40A5D9
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_40A5D9
		cmp	[ebp+arg_8], 0
		jz	loc_40A6E8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_40A6E8

loc_40A5D9:				; CODE XREF: sub_40A4D5+D2j
					; sub_40A4D5+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_40A5ED
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_40A5ED:				; CODE XREF: sub_40A4D5+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_40A69E	; jumptable 0040A606 default case
		mov	eax, ds:off_412584[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40A608:				; CODE XREF: sub_40A4D5+131j
					; DATA XREF: .rdata:off_412584o
		add	[ebp+var_1C], 1	; jumptable 0040A606 case 10
		cmp	[ebp+var_24], 0
		jz	loc_40A6CF
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_40A6CF
; ---------------------------------------------------------------------------

loc_40A625:				; CODE XREF: sub_40A4D5+131j
					; DATA XREF: .rdata:off_412584o
		add	[ebp+var_1C], 1	; jumptable 0040A606 case 13
		cmp	[ebp+var_24], 0
		jz	loc_40A6D2
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_40A6D2
; ---------------------------------------------------------------------------

loc_40A642:				; CODE XREF: sub_40A4D5+131j
					; DATA XREF: .rdata:off_412584o
		add	[ebp+var_1C], 1	; jumptable 0040A606 case 12
		cmp	[ebp+var_24], 0
		jz	loc_40A6D5
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_40A6D5
; ---------------------------------------------------------------------------

loc_40A65C:				; CODE XREF: sub_40A4D5+131j
					; DATA XREF: .rdata:off_412584o
		add	[ebp+var_1C], 1	; jumptable 0040A606 case 11
		cmp	[ebp+var_24], 0
		jz	short loc_40A6D8
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_40A6D8
; ---------------------------------------------------------------------------

loc_40A672:				; CODE XREF: sub_40A4D5+131j
					; DATA XREF: .rdata:off_412584o
		add	[ebp+var_1C], 1	; jumptable 0040A606 case 8
		cmp	[ebp+var_24], 0
		jz	short loc_40A6DB
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_40A6DB
; ---------------------------------------------------------------------------

loc_40A688:				; CODE XREF: sub_40A4D5+131j
					; DATA XREF: .rdata:off_412584o
		add	[ebp+var_1C], 1	; jumptable 0040A606 case 0
		cmp	[ebp+var_24], 0
		jz	short loc_40A6DE
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_40A6DE
; ---------------------------------------------------------------------------

loc_40A69E:				; CODE XREF: sub_40A4D5+124j
					; sub_40A4D5+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 0040A606 default case
		cmp	[ebp+var_24], 0
		jz	short loc_40A6E1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_40A6E1
; ---------------------------------------------------------------------------

loc_40A6CF:				; CODE XREF: sub_40A4D5+13Bj
					; sub_40A4D5+14Bj
		nop
		jmp	short loc_40A6E2
; ---------------------------------------------------------------------------

loc_40A6D2:				; CODE XREF: sub_40A4D5+158j
					; sub_40A4D5+168j
		nop
		jmp	short loc_40A6E2
; ---------------------------------------------------------------------------

loc_40A6D5:				; CODE XREF: sub_40A4D5+175j
					; sub_40A4D5+185j
		nop
		jmp	short loc_40A6E2
; ---------------------------------------------------------------------------

loc_40A6D8:				; CODE XREF: sub_40A4D5+18Fj
					; sub_40A4D5+19Bj
		nop
		jmp	short loc_40A6E2
; ---------------------------------------------------------------------------

loc_40A6DB:				; CODE XREF: sub_40A4D5+1A5j
					; sub_40A4D5+1B1j
		nop
		jmp	short loc_40A6E2
; ---------------------------------------------------------------------------

loc_40A6DE:				; CODE XREF: sub_40A4D5+1BBj
					; sub_40A4D5+1C7j
		nop
		jmp	short loc_40A6E2
; ---------------------------------------------------------------------------

loc_40A6E1:				; CODE XREF: sub_40A4D5+1D1j
					; sub_40A4D5+1F8j
		nop

loc_40A6E2:				; CODE XREF: sub_40A4D5+1FBj
					; sub_40A4D5+1FEj ...
		nop
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A6E8:				; CODE XREF: sub_40A4D5+C4j
					; sub_40A4D5+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_40A6FF
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_40A6FF:				; CODE XREF: sub_40A4D5+217j
		add	[ebp+var_1C], 1
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A708:				; CODE XREF: sub_40A4D5+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_40A751
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A751:				; CODE XREF: sub_40A4D5+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_40A79A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A79A:				; CODE XREF: sub_40A4D5+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_40A7E3
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A7E3:				; CODE XREF: sub_40A4D5+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_40A82C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A82C:				; CODE XREF: sub_40A4D5+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_40A875
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A875:				; CODE XREF: sub_40A4D5+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_40A8A0
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_40A8A0:				; CODE XREF: sub_40A4D5+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A8B0:				; CODE XREF: sub_40A4D5+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40A8C8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_40A956

loc_40A8C8:				; CODE XREF: sub_40A4D5+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_40A930
		mov	[ebp+var_10], 0
		jmp	short loc_40A903
; ---------------------------------------------------------------------------

loc_40A8D7:				; CODE XREF: sub_40A4D5+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_40A903:				; CODE XREF: sub_40A4D5+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40A8D7
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_40A930:				; CODE XREF: sub_40A4D5+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A956:				; CODE XREF: sub_40A4D5+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_40AA93
		mov	eax, ds:dword_4143C0
		test	eax, eax
		jz	short loc_40A9D3
		cmp	[ebp+var_24], 0
		jz	short loc_40A9C1
		mov	[ebp+var_10], 0
		jmp	short loc_40A9B9
; ---------------------------------------------------------------------------

loc_40A9A1:				; CODE XREF: sub_40A4D5+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_40A9B9:				; CODE XREF: sub_40A4D5+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40A9A1

loc_40A9C1:				; CODE XREF: sub_40A4D5+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_40AA93
; ---------------------------------------------------------------------------

loc_40A9D3:				; CODE XREF: sub_40A4D5+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_40AA17
		cmp	[ebp+var_24], 0
		jz	short loc_40AA08
		mov	[ebp+var_10], 0
		jmp	short loc_40AA00
; ---------------------------------------------------------------------------

loc_40A9E8:				; CODE XREF: sub_40A4D5+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_40AA00:				; CODE XREF: sub_40A4D5+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40A9E8

loc_40AA08:				; CODE XREF: sub_40A4D5+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_40AA93
; ---------------------------------------------------------------------------

loc_40AA17:				; CODE XREF: sub_40A4D5+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_40AA40
		cmp	[ebp+var_28], 0FFh
		ja	short loc_40AA40
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_40AA93
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_40AA93
; ---------------------------------------------------------------------------

loc_40AA40:				; CODE XREF: sub_40A4D5+546j
					; sub_40A4D5+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_40AA83
		mov	[ebp+var_10], 0
		jmp	short loc_40AA7B
; ---------------------------------------------------------------------------

loc_40AA4F:				; CODE XREF: sub_40A4D5+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_40AA7B:				; CODE XREF: sub_40A4D5+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40AA4F

loc_40AA83:				; CODE XREF: sub_40A4D5+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_40AA93:				; CODE XREF: sub_40A4D5+9Cj
					; sub_40A4D5+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_40AA9B:				; CODE XREF: sub_40A4D5+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_40A51E
		cmp	[ebp+var_20], 0
		jnz	short loc_40AAC7
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_40350C
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_40A4F9
; ---------------------------------------------------------------------------

loc_40AAC7:				; CODE XREF: sub_40A4D5+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_40AC97
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_410004
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_40AB3B
		mov	eax, off_410004
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_409E74
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_403669
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_40ACA7
		jmp	loc_40ACA0
; ---------------------------------------------------------------------------

loc_40AB3B:				; CODE XREF: sub_40A4D5+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_40AB9F
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_409E40
; ---------------------------------------------------------------------------

loc_40AB9F:				; CODE XREF: sub_40A4D5+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_40350C
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_40AC76
		mov	eax, ds:dword_4143C8
		test	eax, eax
		jnz	short loc_40AC29
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_410004
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_40C7E0
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_409C87

loc_40AC29:				; CODE XREF: sub_40A4D5+715j
		mov	ds:dword_4143C8, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_403669
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_403669
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_40A4D5
		mov	[ebp+var_34], eax
		jmp	short loc_40AC87
; ---------------------------------------------------------------------------

loc_40AC76:				; CODE XREF: sub_40A4D5+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_403669

loc_40AC87:				; CODE XREF: sub_40A4D5+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_40ACA0
; ---------------------------------------------------------------------------

loc_40AC97:				; CODE XREF: sub_40A4D5+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_40ACA0:				; CODE XREF: sub_40A4D5+661j
					; sub_40A4D5+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40A4D5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ACA7	proc near		; CODE XREF: sub_408720+50p
					; sub_40A4D5+65Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4143C4
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40A4D5
		leave
		retn
sub_40ACA7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_open
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_close
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40AD30(char *)
sub_40AD30	proc near		; CODE XREF: .text:0040BF17p
					; .text:0040C854p

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40AD5D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40AD5D
		mov	eax, [ebp+var_C]
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AD5D:				; CODE XREF: sub_40AD30+19j
					; sub_40AD30+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40AD83
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40AD83
		mov	eax, [ebp+var_C]
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AD83:				; CODE XREF: sub_40AD30+3Fj
					; sub_40AD30+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40ADAA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40ADAA
		mov	eax, [ebp+var_C]
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40ADAA:				; CODE XREF: sub_40AD30+66j
					; sub_40AD30+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_40B870	; jumptable 0040ADEC default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_412B38
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40ADEE:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aAf_za ; jumptable 0040ADEC	case 54
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40ADF8:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSq_al ; jumptable 0040ADEC	case 28
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE02:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aAm_et ; jumptable 0040ADEC	case 94
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE0C:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		cmp	[ebp+var_1C], 10h ; jumptable 0040ADEC case 1
		ja	loc_40AEC5	; jumptable 0040AE23 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_412D20
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40AE25:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_sa ; jumptable 0040AE23	case 1
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE2F:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_iq ; jumptable 0040AE23	case 2
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE39:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_eg ; jumptable 0040AE23	case 3
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE43:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_ly ; jumptable 0040AE23	case 4
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE4D:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_dz ; jumptable 0040AE23	case 5
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE57:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_ma ; jumptable 0040AE23	case 6
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE61:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_tn ; jumptable 0040AE23	case 7
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE6B:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_om ; jumptable 0040AE23	case 8
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE75:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_ye ; jumptable 0040AE23	case 9
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE7F:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_sy ; jumptable 0040AE23	case 10
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE89:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_jo ; jumptable 0040AE23	case 11
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE93:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_lb ; jumptable 0040AE23	case 12
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AE9D:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_kw ; jumptable 0040AE23	case 13
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AEA7:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_ae ; jumptable 0040AE23	case 14
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AEB1:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_bh ; jumptable 0040AE23	case 15
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AEBB:				; CODE XREF: sub_40AD30+F3j
					; DATA XREF: .rdata:off_412D20o
		mov	eax, offset aAr_qa ; jumptable 0040AE23	case 16
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AEC5:				; CODE XREF: sub_40AD30+E0j
					; sub_40AD30+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 0040AE23 default case
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AECF:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aHy_am ; jumptable 0040ADEC	case 43
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AED9:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aAs_in ; jumptable 0040ADEC	case 77
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AEE3:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 44
		cmp	eax, 1
		jz	short loc_40AEF2
		cmp	eax, 2
		jz	short loc_40AEFC
		jmp	short loc_40AF06
; ---------------------------------------------------------------------------

loc_40AEF2:				; CODE XREF: sub_40AD30+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AEFC:				; CODE XREF: sub_40AD30+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF06:				; CODE XREF: sub_40AD30+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF10:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aEu	; jumptable 0040ADEC case 45
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF1A:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aBe_by ; jumptable 0040ADEC	case 35
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF24:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 69
		cmp	eax, 1
		jz	short loc_40AF33
		cmp	eax, 2
		jz	short loc_40AF3D
		jmp	short loc_40AF47
; ---------------------------------------------------------------------------

loc_40AF33:				; CODE XREF: sub_40AD30+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF3D:				; CODE XREF: sub_40AD30+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF47:				; CODE XREF: sub_40AD30+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF51:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aBg_bg ; jumptable 0040ADEC	case 2
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF5B:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aMy_mm ; jumptable 0040ADEC	case 85
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF65:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aKm_kh ; jumptable 0040ADEC	case 83
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF6F:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aCa_es ; jumptable 0040ADEC	case 3
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF79:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aChr_us ; jumptable	0040ADEC case 92
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AF83:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		cmp	[ebp+var_1C], 5	; jumptable 0040ADEC case 4
		ja	short loc_40AFCA ; jumptable 0040AF96 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_412D64
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40AF98:				; CODE XREF: sub_40AD30+266j
					; DATA XREF: .rdata:off_412D64o
		mov	eax, offset aZh_tw ; jumptable 0040AF96	case 1
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AFA2:				; CODE XREF: sub_40AD30+266j
					; DATA XREF: .rdata:off_412D64o
		mov	eax, offset aZh_cn ; jumptable 0040AF96	case 2
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AFAC:				; CODE XREF: sub_40AD30+266j
					; DATA XREF: .rdata:off_412D64o
		mov	eax, offset aZh_hk ; jumptable 0040AF96	case 3
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AFB6:				; CODE XREF: sub_40AD30+266j
					; DATA XREF: .rdata:off_412D64o
		mov	eax, offset aZh_sg ; jumptable 0040AF96	case 4
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AFC0:				; CODE XREF: sub_40AD30+266j
					; DATA XREF: .rdata:off_412D64o
		mov	eax, offset aZh_mo ; jumptable 0040AF96	case 5
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AFCA:				; CODE XREF: sub_40AD30+257j
					; sub_40AD30+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 0040AF96 default case
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AFD4:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 26
		cmp	eax, 2
		jz	short loc_40AFF0
		cmp	eax, 3
		jz	short loc_40AFFA
		cmp	eax, 1
		jnz	short loc_40B004
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AFF0:				; CODE XREF: sub_40AD30+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40AFFA:				; CODE XREF: sub_40AD30+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B004:				; CODE XREF: sub_40AD30+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B00E:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aCs_cz ; jumptable 0040ADEC	case 5
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B018:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aDa_dk ; jumptable 0040ADEC	case 6
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B022:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aDiv_mv ; jumptable	0040ADEC case 101
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B02C:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 19
		cmp	eax, 1
		jz	short loc_40B03B
		cmp	eax, 2
		jz	short loc_40B045
		jmp	short loc_40B04F
; ---------------------------------------------------------------------------

loc_40B03B:				; CODE XREF: sub_40AD30+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B045:				; CODE XREF: sub_40AD30+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B04F:				; CODE XREF: sub_40AD30+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B059:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aBin_ng ; jumptable	0040ADEC case 102
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B063:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		cmp	[ebp+var_1C], 12h ; jumptable 0040ADEC case 9
		ja	loc_40B130	; jumptable 0040B07A default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_412D7C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B07C:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_us ; jumptable 0040B07A	case 1
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B086:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_gb ; jumptable 0040B07A	case 2
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B090:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_au ; jumptable 0040B07A	case 3
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B09A:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_ca ; jumptable 0040B07A	case 4
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0A4:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_nz ; jumptable 0040B07A	case 5
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0AE:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_ie ; jumptable 0040B07A	case 6
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0B8:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_za ; jumptable 0040B07A	case 7
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0C2:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_jm ; jumptable 0040B07A	case 8
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0CC:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_gd ; jumptable 0040B07A	case 9
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0D6:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_bz ; jumptable 0040B07A	case 10
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0E0:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_tt ; jumptable 0040B07A	case 11
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0EA:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_zw ; jumptable 0040B07A	case 12
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0F4:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_ph ; jumptable 0040B07A	case 13
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B0FE:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_id ; jumptable 0040B07A	case 14
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B108:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_hk ; jumptable 0040B07A	case 15
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B112:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_in ; jumptable 0040B07A	case 16
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B11C:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_my ; jumptable 0040B07A	case 17
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B126:				; CODE XREF: sub_40AD30+34Aj
					; DATA XREF: .rdata:off_412D7Co
		mov	eax, offset aEn_sg ; jumptable 0040B07A	case 18
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B130:				; CODE XREF: sub_40AD30+337j
					; sub_40AD30+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn	; jumptable 0040B07A default case
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B13A:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aEt_ee ; jumptable 0040ADEC	case 37
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B144:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aFo_fo ; jumptable 0040ADEC	case 56
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B14E:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aFa_ir ; jumptable 0040ADEC	case 41
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B158:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aFi_fi ; jumptable 0040ADEC	case 11
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B162:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		cmp	[ebp+var_1C], 0Fh ; jumptable 0040ADEC case 12
		ja	loc_40B211	; jumptable 0040B179 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_412DC8
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B17B:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_fr ; jumptable 0040B179	case 1
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B185:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_be ; jumptable 0040B179	case 2
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B18F:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_ca ; jumptable 0040B179	case 3
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B199:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_ch ; jumptable 0040B179	case 4
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1A3:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_lu ; jumptable 0040B179	case 5
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1AD:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_mc ; jumptable 0040B179	case 6
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1B7:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr	; jumptable 0040B179 case 7
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1C1:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_re ; jumptable 0040B179	case 8
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1CB:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_cg ; jumptable 0040B179	case 9
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1D5:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_sn ; jumptable 0040B179	case 10
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1DF:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_cm ; jumptable 0040B179	case 11
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1E9:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_ci ; jumptable 0040B179	case 12
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1F3:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_ml ; jumptable 0040B179	case 13
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B1FD:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_ma ; jumptable 0040B179	case 14
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B207:				; CODE XREF: sub_40AD30+449j
					; DATA XREF: .rdata:off_412DC8o
		mov	eax, offset aFr_ht ; jumptable 0040B179	case 15
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B211:				; CODE XREF: sub_40AD30+436j
					; sub_40AD30+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 0040B179 default case
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B21B:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aFy_nl ; jumptable 0040ADEC	case 98
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B225:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aFul_ng ; jumptable	0040ADEC case 103
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B22F:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 60
		cmp	eax, 1
		jz	short loc_40B23E
		cmp	eax, 2
		jz	short loc_40B248
		jmp	short loc_40B252
; ---------------------------------------------------------------------------

loc_40B23E:				; CODE XREF: sub_40AD30+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B248:				; CODE XREF: sub_40AD30+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B252:				; CODE XREF: sub_40AD30+50Cj
		mov	eax, offset aC	; "C"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B25C:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aGl_es ; jumptable 0040ADEC	case 86
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B266:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aKa_ge ; jumptable 0040ADEC	case 55
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B270:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		cmp	[ebp+var_1C], 5	; jumptable 0040ADEC case 7
		ja	short loc_40B2B7 ; jumptable 0040B283 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_412E08
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B285:				; CODE XREF: sub_40AD30+553j
					; DATA XREF: .rdata:off_412E08o
		mov	eax, offset aDe_de ; jumptable 0040B283	case 1
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B28F:				; CODE XREF: sub_40AD30+553j
					; DATA XREF: .rdata:off_412E08o
		mov	eax, offset aDe_ch ; jumptable 0040B283	case 2
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B299:				; CODE XREF: sub_40AD30+553j
					; DATA XREF: .rdata:off_412E08o
		mov	eax, offset aDe_at ; jumptable 0040B283	case 3
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2A3:				; CODE XREF: sub_40AD30+553j
					; DATA XREF: .rdata:off_412E08o
		mov	eax, offset aDe_lu ; jumptable 0040B283	case 4
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2AD:				; CODE XREF: sub_40AD30+553j
					; DATA XREF: .rdata:off_412E08o
		mov	eax, offset aDe_li ; jumptable 0040B283	case 5
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2B7:				; CODE XREF: sub_40AD30+544j
					; sub_40AD30+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 0040B283 default case
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2C1:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aEl_gr ; jumptable 0040ADEC	case 8
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2CB:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aGn_py ; jumptable 0040ADEC	case 116
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2D5:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aGu_in ; jumptable 0040ADEC	case 71
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2DF:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aHa_ng ; jumptable 0040ADEC	case 104
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2E9:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aCpe_us ; jumptable	0040ADEC case 117
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2F3:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aHe_il ; jumptable 0040ADEC	case 13
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B2FD:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aHi_in ; jumptable 0040ADEC	case 57
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B307:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aHu_hu ; jumptable 0040ADEC	case 14
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B311:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aNic_ng ; jumptable	0040ADEC case 105
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B31B:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aIs_is ; jumptable 0040ADEC	case 15
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B325:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aIbo_ng ; jumptable	0040ADEC case 112
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B32F:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aId_id ; jumptable 0040ADEC	case 33
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B339:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aIu_ca ; jumptable 0040ADEC	case 93
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B343:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 16
		cmp	eax, 1
		jz	short loc_40B352
		cmp	eax, 2
		jz	short loc_40B35C
		jmp	short loc_40B366
; ---------------------------------------------------------------------------

loc_40B352:				; CODE XREF: sub_40AD30+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B35C:				; CODE XREF: sub_40AD30+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B366:				; CODE XREF: sub_40AD30+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B370:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aJa_jp ; jumptable 0040ADEC	case 17
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B37A:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aKn_in ; jumptable 0040ADEC	case 75
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B384:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aKau_ng ; jumptable	0040ADEC case 113
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B38E:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 96
		cmp	eax, 1
		jz	short loc_40B39D
		cmp	eax, 2
		jz	short loc_40B3A7
		jmp	short loc_40B3B1
; ---------------------------------------------------------------------------

loc_40B39D:				; CODE XREF: sub_40AD30+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B3A7:				; CODE XREF: sub_40AD30+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B3B1:				; CODE XREF: sub_40AD30+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B3BB:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aKk_kz ; jumptable 0040ADEC	case 63
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B3C5:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aKok_in ; jumptable	0040ADEC case 87
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B3CF:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aKo_kr ; jumptable 0040ADEC	case 18
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B3D9:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aKy_kg ; jumptable 0040ADEC	case 64
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B3E3:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aLo_la ; jumptable 0040ADEC	case 84
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B3ED:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aLa_va ; jumptable 0040ADEC	case 118
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B3F7:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aLv_lv ; jumptable 0040ADEC	case 38
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B401:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aLt_lt ; jumptable 0040ADEC	case 39
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B40B:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aMk_mk ; jumptable 0040ADEC	case 47
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B415:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 62
		cmp	eax, 1
		jz	short loc_40B424
		cmp	eax, 2
		jz	short loc_40B42E
		jmp	short loc_40B438
; ---------------------------------------------------------------------------

loc_40B424:				; CODE XREF: sub_40AD30+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B42E:				; CODE XREF: sub_40AD30+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B438:				; CODE XREF: sub_40AD30+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B442:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aMl_in ; jumptable 0040ADEC	case 76
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B44C:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aMt_mt ; jumptable 0040ADEC	case 58
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B456:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aMni_in ; jumptable	0040ADEC case 88
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B460:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aMr_in ; jumptable 0040ADEC	case 78
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B46A:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aMn	; jumptable 0040ADEC case 80
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B474:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 97
		cmp	eax, 1
		jz	short loc_40B483
		cmp	eax, 2
		jz	short loc_40B48D
		jmp	short loc_40B497
; ---------------------------------------------------------------------------

loc_40B483:				; CODE XREF: sub_40AD30+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B48D:				; CODE XREF: sub_40AD30+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B497:				; CODE XREF: sub_40AD30+751j
		mov	eax, offset aNe	; "ne"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B4A1:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 20
		cmp	eax, 1
		jz	short loc_40B4B0
		cmp	eax, 2
		jz	short loc_40B4BA
		jmp	short loc_40B4C4
; ---------------------------------------------------------------------------

loc_40B4B0:				; CODE XREF: sub_40AD30+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B4BA:				; CODE XREF: sub_40AD30+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B4C4:				; CODE XREF: sub_40AD30+77Ej
		mov	eax, offset aNo_0 ; "no"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B4CE:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aOr_in ; jumptable 0040ADEC	case 72
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B4D8:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aOm_et ; jumptable 0040ADEC	case 114
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B4E2:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aPap_an ; jumptable	0040ADEC case 121
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B4EC:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aPs	; jumptable 0040ADEC case 99
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B4F6:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aPl_pl ; jumptable 0040ADEC	case 21
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B500:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 22
		cmp	eax, 1
		jz	short loc_40B517
		cmp	eax, 2
		jnz	short loc_40B521
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B517:				; CODE XREF: sub_40AD30+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B521:				; CODE XREF: sub_40AD30+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B52B:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 70
		cmp	eax, 1
		jnz	short loc_40B53D
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B53D:				; CODE XREF: sub_40AD30+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B547:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aRm_ch ; jumptable 0040ADEC	case 23
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B551:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 24
		cmp	eax, 1
		jnz	short loc_40B563
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B563:				; CODE XREF: sub_40AD30+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B56D:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aRu	; jumptable 0040ADEC case 25
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B577:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSe_no ; jumptable 0040ADEC	case 59
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B581:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSa_in ; jumptable 0040ADEC	case 79
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B58B:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 89
		test	eax, eax
		jz	short loc_40B599
		cmp	eax, 1
		jz	short loc_40B5A3
		jmp	short loc_40B5AD
; ---------------------------------------------------------------------------

loc_40B599:				; CODE XREF: sub_40AD30+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B5A3:				; CODE XREF: sub_40AD30+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B5AD:				; CODE XREF: sub_40AD30+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B5B7:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSi_lk ; jumptable 0040ADEC	case 91
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B5C1:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSk_sk ; jumptable 0040ADEC	case 27
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B5CB:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSl_si ; jumptable 0040ADEC	case 36
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B5D5:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSo_so ; jumptable 0040ADEC	case 119
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B5DF:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aWen_de ; jumptable	0040ADEC case 46
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B5E9:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		cmp	[ebp+var_1C], 14h ; jumptable 0040ADEC case 10
		ja	loc_40B6CA	; jumptable 0040B600 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_412E20
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B602:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_es ; jumptable 0040B600	case 1
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B60C:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_mx ; jumptable 0040B600	case 2
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B616:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_es@modern ; jumptable 0040B600 case 3
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B620:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_gt ; jumptable 0040B600	case 4
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B62A:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_cr ; jumptable 0040B600	case 5
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B634:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_pa ; jumptable 0040B600	case 6
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B63E:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_do ; jumptable 0040B600	case 7
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B648:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_ve ; jumptable 0040B600	case 8
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B652:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_co ; jumptable 0040B600	case 9
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B65C:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_pe ; jumptable 0040B600	case 10
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B666:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_ar ; jumptable 0040B600	case 11
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B670:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_ec ; jumptable 0040B600	case 12
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B67A:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_cl ; jumptable 0040B600	case 13
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B684:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_uy ; jumptable 0040B600	case 14
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B68E:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_py ; jumptable 0040B600	case 15
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B698:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_bo ; jumptable 0040B600	case 16
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B6A2:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_sv ; jumptable 0040B600	case 17
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B6AC:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_hn ; jumptable 0040B600	case 18
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B6B6:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_ni ; jumptable 0040B600	case 19
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B6C0:				; CODE XREF: sub_40AD30+8D0j
					; DATA XREF: .rdata:off_412E20o
		mov	eax, offset aEs_pr ; jumptable 0040B600	case 20
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B6CA:				; CODE XREF: sub_40AD30+8BDj
					; sub_40AD30+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 0040B600 default case
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B6D4:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aBnt_tz ; jumptable	0040ADEC case 48
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B6DE:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSw_ke ; jumptable 0040ADEC	case 65
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B6E8:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 29
		cmp	eax, 1
		jz	short loc_40B6F7
		cmp	eax, 2
		jz	short loc_40B701
		jmp	short loc_40B70B
; ---------------------------------------------------------------------------

loc_40B6F7:				; CODE XREF: sub_40AD30+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B701:				; CODE XREF: sub_40AD30+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B70B:				; CODE XREF: sub_40AD30+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B715:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSyr_tr ; jumptable	0040ADEC case 90
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B71F:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTl_ph ; jumptable 0040ADEC	case 100
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B729:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTg_tj ; jumptable 0040ADEC	case 40
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B733:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 95
		cmp	eax, 1
		jz	short loc_40B742
		cmp	eax, 2
		jz	short loc_40B74C
		jmp	short loc_40B756
; ---------------------------------------------------------------------------

loc_40B742:				; CODE XREF: sub_40AD30+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B74C:				; CODE XREF: sub_40AD30+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B756:				; CODE XREF: sub_40AD30+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B760:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTa	; jumptable 0040ADEC case 73
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B76A:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTt_ru ; jumptable 0040ADEC	case 68
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B774:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTe_in ; jumptable 0040ADEC	case 74
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B77E:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTh_th ; jumptable 0040ADEC	case 30
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B788:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aBo_cn ; jumptable 0040ADEC	case 81
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B792:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 115
		test	eax, eax
		jz	short loc_40B7A0
		cmp	eax, 1
		jz	short loc_40B7AA
		jmp	short loc_40B7B4
; ---------------------------------------------------------------------------

loc_40B7A0:				; CODE XREF: sub_40AD30+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B7AA:				; CODE XREF: sub_40AD30+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B7B4:				; CODE XREF: sub_40AD30+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B7BE:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTs_za ; jumptable 0040ADEC	case 49
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B7C8:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTn_bw ; jumptable 0040ADEC	case 50
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B7D2:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTr_tr ; jumptable 0040ADEC	case 31
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B7DC:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aTk_tm ; jumptable 0040ADEC	case 66
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B7E6:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aUk_ua ; jumptable 0040ADEC	case 34
		jmp	locret_40B875
; ---------------------------------------------------------------------------

loc_40B7F0:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 32
		cmp	eax, 1
		jz	short loc_40B7FF
		cmp	eax, 2
		jz	short loc_40B806
		jmp	short loc_40B80D
; ---------------------------------------------------------------------------

loc_40B7FF:				; CODE XREF: sub_40AD30+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B806:				; CODE XREF: sub_40AD30+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B80D:				; CODE XREF: sub_40AD30+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B814:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, [ebp+var_1C] ; jumptable 0040ADEC case 67
		cmp	eax, 1
		jz	short loc_40B823
		cmp	eax, 2
		jz	short loc_40B82A
		jmp	short loc_40B831
; ---------------------------------------------------------------------------

loc_40B823:				; CODE XREF: sub_40AD30+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B82A:				; CODE XREF: sub_40AD30+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B831:				; CODE XREF: sub_40AD30+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B838:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aVen_za ; jumptable	0040ADEC case 51
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B83F:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aVi_vn ; jumptable 0040ADEC	case 42
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B846:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aCy_gb ; jumptable 0040ADEC	case 82
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B84D:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aXh_za ; jumptable 0040ADEC	case 52
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B854:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aSit_cn ; jumptable	0040ADEC case 120
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B85B:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aYi_il ; jumptable 0040ADEC	case 61
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B862:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aYo_ng ; jumptable 0040ADEC	case 106
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B869:				; CODE XREF: sub_40AD30+BCj
					; DATA XREF: .rdata:off_412B38o
		mov	eax, offset aZu_za ; jumptable 0040ADEC	case 53
		jmp	short locret_40B875
; ---------------------------------------------------------------------------

loc_40B870:				; CODE XREF: sub_40AD30+A9j
					; sub_40AD30+BCj
					; DATA XREF: ...
		mov	eax, offset aC	; jumptable 0040ADEC default case

locret_40B875:				; CODE XREF: sub_40AD30+28j
					; sub_40AD30+4Ej ...
		leave
		retn
sub_40AD30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B877	proc near		; CODE XREF: sub_40B956+1EAp
					; sub_40B956+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_40B877	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B8A6	proc near		; CODE XREF: sub_40C525+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_40B8EF
; ---------------------------------------------------------------------------

loc_40B8BB:				; CODE XREF: sub_40B8A6+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B8EF
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_40B8EF:				; CODE XREF: sub_40B8A6+13j
					; sub_40B8A6+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40B8BB
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40B8A6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B8FE(void *)
sub_40B8FE	proc near		; CODE XREF: .text:0040C13Dp

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_40B943
; ---------------------------------------------------------------------------

loc_40B92A:				; CODE XREF: sub_40B8FE+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403669
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_40B943:				; CODE XREF: sub_40B8FE+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_40B92A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403669
		leave
		retn
sub_40B8FE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B956(char *)
sub_40B956	proc near		; CODE XREF: .text:0040C10Ep

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset aRb_0 ; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_40B993
		mov	eax, 0
		jmp	loc_40BC8A
; ---------------------------------------------------------------------------

loc_40B993:				; CODE XREF: sub_40B956+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_40B9DC
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_40B9DC
		cmp	[ebp+var_20], 1Bh
		ja	short loc_40B9F1

loc_40B9DC:				; CODE XREF: sub_40B956+5Bj
					; sub_40B956+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_40BC8A
; ---------------------------------------------------------------------------

loc_40B9F1:				; CODE XREF: sub_40B956+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_40BA0A
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_4034F9
		jmp	short loc_40BA0F
; ---------------------------------------------------------------------------

loc_40BA0A:				; CODE XREF: sub_40B956+A3j
		mov	eax, 0

loc_40BA0F:				; CODE XREF: sub_40B956+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40BA2D
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_40BC8A
; ---------------------------------------------------------------------------

loc_40BA2D:				; CODE XREF: sub_40B956+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_40BA39:				; CODE XREF: sub_40B956+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_40BA85
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403669
		mov	eax, 0
		jmp	loc_40BC8A
; ---------------------------------------------------------------------------

loc_40BA85:				; CODE XREF: sub_40B956+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BA39
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_40BACF
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_40BACF
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403669
		mov	eax, 0
		jmp	loc_40BC8A
; ---------------------------------------------------------------------------

loc_40BACF:				; CODE XREF: sub_40B956+156j
					; sub_40B956+162j
		mov	[esp+68h+Mode],	28h ; size_t
		mov	[esp+68h+Filename], 1 ;	size_t
		call	sub_4035CA
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40BB01
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403669
		mov	eax, 0
		jmp	loc_40BC8A
; ---------------------------------------------------------------------------

loc_40BB01:				; CODE XREF: sub_40B956+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40BB47
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_40B877
		jmp	short loc_40BB4D
; ---------------------------------------------------------------------------

loc_40BB47:				; CODE XREF: sub_40B956+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_40BB4D:				; CODE XREF: sub_40B956+1EFj
		test	eax, eax
		jnz	loc_40BC4D
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40BB6F
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_40B877
		jmp	short loc_40BB75
; ---------------------------------------------------------------------------

loc_40BB6F:				; CODE XREF: sub_40B956+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_40BB75:				; CODE XREF: sub_40B956+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40BB95
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_40B877
		jmp	short loc_40BB9B
; ---------------------------------------------------------------------------

loc_40BB95:				; CODE XREF: sub_40B956+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_40BB9B:				; CODE XREF: sub_40B956+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40BBC0
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_40B877
		jmp	short loc_40BBC6
; ---------------------------------------------------------------------------

loc_40BBC0:				; CODE XREF: sub_40B956+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_40BBC6:				; CODE XREF: sub_40B956+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40BBEB
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_40B877
		jmp	short loc_40BBF1
; ---------------------------------------------------------------------------

loc_40BBEB:				; CODE XREF: sub_40B956+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_40BBF1:				; CODE XREF: sub_40B956+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40BC11
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_40B877
		jmp	short loc_40BC17
; ---------------------------------------------------------------------------

loc_40BC11:				; CODE XREF: sub_40B956+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_40BC17:				; CODE XREF: sub_40B956+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4 ; size_t
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_4035CA
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40BC87
		jmp	short loc_40BC6A
; ---------------------------------------------------------------------------

loc_40BC4D:				; CODE XREF: sub_40B956+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403669
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403669
		mov	eax, 0
		jmp	short loc_40BC8A
; ---------------------------------------------------------------------------

loc_40BC6A:				; CODE XREF: sub_40B956+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403669
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403669
		mov	eax, 0
		jmp	short loc_40BC8A
; ---------------------------------------------------------------------------

loc_40BC87:				; CODE XREF: sub_40B956+2F3j
		mov	eax, [ebp+var_18]

loc_40BC8A:				; CODE XREF: sub_40B956+38j
					; sub_40B956+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40B956	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BC91(LPCSTR, int, int)
sub_40BC91	proc near		; CODE XREF: sub_40BE88+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_40BCE1
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_40BCEB

loc_40BCE1:				; CODE XREF: sub_40BC91+44j
		mov	eax, 0
		jmp	locret_40BD91
; ---------------------------------------------------------------------------

loc_40BCEB:				; CODE XREF: sub_40BC91+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_40BD1B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_40BD91
; ---------------------------------------------------------------------------

loc_40BD1B:				; CODE XREF: sub_40BC91+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_4034F9
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40BD36
		mov	eax, 0
		jmp	short locret_40BD91
; ---------------------------------------------------------------------------

loc_40BD36:				; CODE XREF: sub_40BC91+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40BD86
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_403669
		mov	eax, 0
		jmp	short locret_40BD91
; ---------------------------------------------------------------------------

loc_40BD86:				; CODE XREF: sub_40BC91+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_40BD91:				; CODE XREF: sub_40BC91+55j
					; sub_40BC91+88j ...
		leave
		retn
sub_40BC91	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BD93(LPCWSTR, int, int)
sub_40BD93	proc near		; CODE XREF: sub_40BE88+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_40BDF3
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_40BDFD

loc_40BDF3:				; CODE XREF: sub_40BD93+54j
		mov	eax, 0
		jmp	locret_40BE86
; ---------------------------------------------------------------------------

loc_40BDFD:				; CODE XREF: sub_40BD93+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_4034F9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40BE1B
		mov	eax, 0
		jmp	short locret_40BE86
; ---------------------------------------------------------------------------

loc_40BE1B:				; CODE XREF: sub_40BD93+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40BE7B
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_403669
		mov	eax, 0
		jmp	short locret_40BE86
; ---------------------------------------------------------------------------

loc_40BE7B:				; CODE XREF: sub_40BD93+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_40BE86:				; CODE XREF: sub_40BD93+65j
					; sub_40BD93+86j ...
		leave
		retn
sub_40BD93	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BE88(LPCSTR, int, int)
sub_40BE88	proc near		; CODE XREF: sub_40C1BA+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_40BC91
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40BED9
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_40BD93
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403669
		jmp	short loc_40BEE0
; ---------------------------------------------------------------------------

loc_40BED9:				; CODE XREF: sub_40BE88+26j
		mov	[ebp+var_C], 0

loc_40BEE0:				; CODE XREF: sub_40BE88+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_40BEEB
		mov	eax, [ebp+var_14]
		jmp	short loc_40BEF0
; ---------------------------------------------------------------------------

loc_40BEEB:				; CODE XREF: sub_40BE88+5Cj
		mov	eax, 0

loc_40BEF0:				; CODE XREF: sub_40BE88+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40BE88	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_40AD30
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40BF8C
		mov	eax, [ebp-14h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp], eax
		call	sub_4034F9
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40BF8C
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strcpy
		mov	dword ptr [esp+4], 5Fh
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strchr
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_40BF8C
		mov	eax, [ebp-18h]
		mov	byte ptr [eax],	0

loc_40BF8C:				; CODE XREF: .text:0040BF23j
					; .text:0040BF56j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40BF9C
		mov	eax, 0
		jmp	loc_40C14D
; ---------------------------------------------------------------------------

loc_40BF9C:				; CODE XREF: .text:0040BF90j
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_4034F9
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_40C02C
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_403669
		mov	eax, 0
		jmp	loc_40C14D
; ---------------------------------------------------------------------------

loc_40C02C:				; CODE XREF: .text:0040C015j
		mov	eax, [ebp-20h]
		mov	[ebp-24h], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	eax, [ebp-24h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-24h], 1
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	edx, offset aLc_messages_0 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp-24h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	dword ptr [ebp-24h], 0Dh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp-24h]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_40B956
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_403669
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_403669
		mov	eax, ds:dword_4143FC
		test	eax, eax
		jz	short loc_40C142
		mov	eax, ds:dword_4143FC
		mov	[esp], eax
		call	sub_40B8FE

loc_40C142:				; CODE XREF: .text:0040C133j
		mov	eax, [ebp-10h]
		mov	ds:dword_4143FC, eax
		mov	eax, [ebp+0Ch]

loc_40C14D:				; CODE XREF: .text:0040BF97j
					; .text:0040C027j
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C154(char *, int, int)
sub_40C154	proc near		; CODE XREF: sub_40C1BA+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_40C1AF
; ---------------------------------------------------------------------------

loc_40C169:				; CODE XREF: sub_40C154+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_40C196
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_40C1B8
; ---------------------------------------------------------------------------

loc_40C196:				; CODE XREF: sub_40C154+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_40C1AF:				; CODE XREF: sub_40C154+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_40C169
		mov	eax, [ebp+arg_0]

locret_40C1B8:				; CODE XREF: sub_40C154+40j
		leave
		retn
sub_40C154	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C1BA	proc near		; CODE XREF: sub_40C525+158p
					; sub_40C525+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_414400
		test	eax, eax
		jz	short loc_40C246
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C1F4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40B877
		jmp	short loc_40C205
; ---------------------------------------------------------------------------

loc_40C1F4:				; CODE XREF: sub_40C1BA+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C205:				; CODE XREF: sub_40C1BA+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C22E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_40B877
		jmp	short loc_40C23E
; ---------------------------------------------------------------------------

loc_40C22E:				; CODE XREF: sub_40C1BA+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40C23E:				; CODE XREF: sub_40C1BA+72j
		mov	[ebp+var_14], eax
		jmp	loc_40C4F5
; ---------------------------------------------------------------------------

loc_40C246:				; CODE XREF: sub_40C1BA+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40C43B
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C288
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40B877
		jmp	short loc_40C299
; ---------------------------------------------------------------------------

loc_40C288:				; CODE XREF: sub_40C1BA+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C299:				; CODE XREF: sub_40C1BA+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C2C2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_40B877
		jmp	short loc_40C2D2
; ---------------------------------------------------------------------------

loc_40C2C2:				; CODE XREF: sub_40C1BA+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40C2D2:				; CODE XREF: sub_40C1BA+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_40BE88
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40C30A
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_40C42B
; ---------------------------------------------------------------------------

loc_40C30A:				; CODE XREF: sub_40C1BA+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_40C39C
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_40C39C
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C349
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40B877
		jmp	short loc_40C35A
; ---------------------------------------------------------------------------

loc_40C349:				; CODE XREF: sub_40C1BA+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C35A:				; CODE XREF: sub_40C1BA+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_40C42B
; ---------------------------------------------------------------------------

loc_40C39C:				; CODE XREF: sub_40C1BA+156j
					; sub_40C1BA+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_4034F9
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C41D
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_40C42B
; ---------------------------------------------------------------------------

loc_40C41D:				; CODE XREF: sub_40C1BA+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_40C42B:				; CODE XREF: sub_40C1BA+14Bj
					; sub_40C1BA+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_403669
		jmp	loc_40C4F5
; ---------------------------------------------------------------------------

loc_40C43B:				; CODE XREF: sub_40C1BA+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_40C4A1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_40C46E
; ---------------------------------------------------------------------------

loc_40C45B:				; CODE XREF: sub_40C1BA+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_40C476
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40C46E:				; CODE XREF: sub_40C1BA+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_40C45B
		jmp	short loc_40C477
; ---------------------------------------------------------------------------

loc_40C476:				; CODE XREF: sub_40C1BA+2AAj
		nop

loc_40C477:				; CODE XREF: sub_40C1BA+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_40C491
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_40C4F5
; ---------------------------------------------------------------------------

loc_40C491:				; CODE XREF: sub_40C1BA+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_40C4F5
; ---------------------------------------------------------------------------

loc_40C4A1:				; CODE XREF: sub_40C1BA+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C4CC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40B877
		jmp	short loc_40C4DD
; ---------------------------------------------------------------------------

loc_40C4CC:				; CODE XREF: sub_40C1BA+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C4DD:				; CODE XREF: sub_40C1BA+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_40C4F5:				; CODE XREF: sub_40C1BA+87j
					; sub_40C1BA+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_40C51C
		cmp	[ebp+var_14], 0
		jz	short loc_40C51C
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_40C154
		jmp	short loc_40C51F
; ---------------------------------------------------------------------------

loc_40C51C:				; CODE XREF: sub_40C1BA+33Fj
					; sub_40C1BA+345j
		mov	eax, [ebp+var_10]

loc_40C51F:				; CODE XREF: sub_40C1BA+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_40C1BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C525(char *, int, int)
sub_40C525	proc near		; CODE XREF: sub_40C7E0+1Cp
					; .text:0040C81Fp ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_4143FC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_40C7B7
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_40C6F0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_40C6F0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_40B8A6
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_40C6AF
; ---------------------------------------------------------------------------

loc_40C5BF:				; CODE XREF: sub_40C525+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_40C687
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C5F6
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_40B877
		jmp	short loc_40C606
; ---------------------------------------------------------------------------

loc_40C5F6:				; CODE XREF: sub_40C525+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40C606:				; CODE XREF: sub_40C525+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_40C687
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C635
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_40B877
		jmp	short loc_40C646
; ---------------------------------------------------------------------------

loc_40C635:				; CODE XREF: sub_40C525+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C646:				; CODE XREF: sub_40C525+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40C687
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_40C1BA
		jmp	loc_40C7D1
; ---------------------------------------------------------------------------

loc_40C687:				; CODE XREF: sub_40C525+A7j
					; sub_40C525+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_40C6A9
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_40C6AF
; ---------------------------------------------------------------------------

loc_40C6A9:				; CODE XREF: sub_40C525+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_40C6AF:				; CODE XREF: sub_40C525+95j
					; sub_40C525+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C6D3
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_40B877
		jmp	short loc_40C6E3
; ---------------------------------------------------------------------------

loc_40C6D3:				; CODE XREF: sub_40C525+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_40C6E3:				; CODE XREF: sub_40C525+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_40C5BF

loc_40C6F0:				; CODE XREF: sub_40C525+23j
					; sub_40C525+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_40C7A9
; ---------------------------------------------------------------------------

loc_40C705:				; CODE XREF: sub_40C525+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C73C
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_40B877
		jmp	short loc_40C74D
; ---------------------------------------------------------------------------

loc_40C73C:				; CODE XREF: sub_40C525+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C74D:				; CODE XREF: sub_40C525+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_40C76F
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_40C7A9
; ---------------------------------------------------------------------------

loc_40C76F:				; CODE XREF: sub_40C525+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_40C780
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_40C7A9
; ---------------------------------------------------------------------------

loc_40C780:				; CODE XREF: sub_40C525+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_40C1BA
		jmp	short loc_40C7D1
; ---------------------------------------------------------------------------

loc_40C7A9:				; CODE XREF: sub_40C525+1DBj
					; sub_40C525+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_40C705
		jmp	short loc_40C7B8
; ---------------------------------------------------------------------------

loc_40C7B7:				; CODE XREF: sub_40C525+14j
		nop

loc_40C7B8:				; CODE XREF: sub_40C525+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_40C7CE
		cmp	[ebp+arg_8], 1
		jnz	short loc_40C7C9
		mov	eax, [ebp+arg_0]
		jmp	short loc_40C7CC
; ---------------------------------------------------------------------------

loc_40C7C9:				; CODE XREF: sub_40C525+29Dj
		mov	eax, [ebp+arg_4]

loc_40C7CC:				; CODE XREF: sub_40C525+2A2j
		jmp	short loc_40C7D1
; ---------------------------------------------------------------------------

loc_40C7CE:				; CODE XREF: sub_40C525+297j
		mov	eax, [ebp+arg_0]

loc_40C7D1:				; CODE XREF: sub_40C525+15Dj
					; sub_40C525+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C525	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C7E0(char *)
sub_40C7E0	proc near		; CODE XREF: sub_409E74+78p
					; sub_409E74+B8p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_40C525
		leave
		retn
sub_40C7E0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40C525
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40C525
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_40AD30
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40C867
		mov	eax, [ebp-0Ch]
		jmp	short locret_40C86C
; ---------------------------------------------------------------------------

loc_40C867:				; CODE XREF: .text:0040C860j
		mov	eax, offset byte_412EF7

locret_40C86C:				; CODE XREF: .text:0040C865j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_414400, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_syserror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00416024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_40C8D0
		cmp	eax, 3
		jz	short loc_40C8D0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_40C8D0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_40DAC0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_412F34o ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_40C944
		cmp	dword_410018, 2
		jz	short loc_40C926
		mov	dword_410018, 2

loc_40C926:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_40CA33
		cmp	eax, 1
		jz	loc_40C9D2

loc_40C938:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40C944:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_4147DC, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_40CA63
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_4147D8, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_4147D4, eax
		jz	loc_40CA63
		mov	ecx, ds:dword_4147D8
		test	ecx, ecx
		jz	short loc_40C9F3
		test	eax, eax
		jz	short loc_40C9F3
		mov	dword_410018, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40C9D2:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_40DAC0
		jmp	loc_40C938
; ---------------------------------------------------------------------------

loc_40C9F3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_4147D4, 0
		mov	ds:dword_4147D8, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_40CA13:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_410018, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40CA33:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_416030
		cmp	ebx, offset dword_416030
		jz	loc_40C938

loc_40CA44:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_40CA4C
		call	eax

loc_40CA4C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_416030
		jnz	short loc_40CA44
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40CA63:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_4147D4, 0
		mov	ds:dword_4147D8, 0
		jmp	short loc_40CA13
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CA90	proc near		; DATA XREF: .CRT:00416014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_40CA90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CAA0	proc near		; CODE XREF: sub_40CAC0+10p
					; sub_40CAC0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_40CAA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CAB0	proc near		; CODE XREF: sub_401060+59p
					; sub_40CAC0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_40CAB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40CAC0(_onexit_t)
sub_40CAC0	proc near		; CODE XREF: sub_40CB80+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_4147E4
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_40CAA0
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_40CB60
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_4147E4
		mov	[esp+2Ch+Func],	eax
		call	sub_40CAA0
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_4147E0
		mov	[esp+2Ch+Func],	eax
		call	sub_40CAA0
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_40CAB0
		mov	ds:dword_4147E4, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_40CAB0
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_4147E0, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40CB60:				; CODE XREF: sub_40CAC0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_40CAC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40CB80(_onexit_t)
sub_40CB80	proc near		; CODE XREF: sub_40D7A0-27p
					; sub_40F1E0+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_40CAC0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_40CB80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_40CBF7
		cmp	eax, 0C000008Dh
		jb	short loc_40CC24

loc_40CBBB:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_40CBC0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_40CCF0
		test	eax, eax
		jz	short loc_40CC0C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_40CBEF:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40CBF7:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_40CC65
		cmp	eax, 0C0000096h
		jz	short loc_40CC32
		cmp	eax, 0C0000093h
		jz	short loc_40CBBB

loc_40CC0C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_41442C
		test	eax, eax
		jz	loc_40CCE3
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_40CC24:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_40CC70
		cmp	eax, 0C000001Dh
		jnz	short loc_40CC0C

loc_40CC32:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_40CCA7
		test	eax, eax
		jz	short loc_40CC0C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40CC65:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_40CBC0
; ---------------------------------------------------------------------------
		align 10h

loc_40CC70:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_40CCC5
		test	eax, eax
		jz	loc_40CC0C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40CCA7:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40CBEF
; ---------------------------------------------------------------------------

loc_40CCC5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40CBEF
; ---------------------------------------------------------------------------

loc_40CCE3:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_40CBEF
; ---------------------------------------------------------------------------
		align 10h

loc_40CCF0:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_40CBEF
		mov	[esp+2Ch+var_10], eax
		call	sub_40D710
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_40CBEF
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_414430
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_40CD71
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_414430
		jmp	short loc_40CD77
; ---------------------------------------------------------------------------

loc_40CD71:				; CODE XREF: .text:0040CD46j
		fstp	st
		fstp	st
		fstp	st

loc_40CD77:				; CODE XREF: .text:0040CD6Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CD80	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_414430, eax
		jmp	__setusermatherr
sub_40CD80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CD90	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_40CDAD
		mov	edx, ds:off_413054[ecx*4]

loc_40CDAD:				; CODE XREF: sub_40CD90+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_40CD90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CDF0	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_40CDF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_40CE00(char *Format, char ArgList)
sub_40CE00	proc near		; CODE XREF: sub_40CE60+1DDp
					; sub_40CE60+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_40CE00	endp

; ---------------------------------------------------------------------------
		jmp	short sub_40CE60
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_40CE60(size_t Size)
sub_40CE60	proc near		; CODE XREF: .text:0040CE51j
					; sub_40D0A0+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_41443C
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_40D042
		mov	eax, ds:dword_414438
		xor	esi, esi

loc_40CE84:				; CODE XREF: sub_40CE60+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_40CE99
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_40CF70

loc_40CE99:				; CODE XREF: sub_40CE60+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_40CE84

loc_40CEA3:				; CODE XREF: sub_40CE60+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_40D460
		test	eax, eax
		mov	edi, eax
		jz	loc_40D069
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_414438
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_40D540
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_414438
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_40D049
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_40CFF1

loc_40CF1F:				; CODE XREF: sub_40CE60+194j
					; sub_40CE60+1C6j
		add	ds:dword_41443C, 1

loc_40CF26:				; CODE XREF: sub_40CE60+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40D079
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_40CF78

loc_40CF4F:				; CODE XREF: sub_40CE60+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_40CF63:				; CODE XREF: sub_40CE60+162j
					; sub_40CE60+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40CF70:				; CODE XREF: sub_40CE60+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_40CF26
; ---------------------------------------------------------------------------

loc_40CF78:				; CODE XREF: sub_40CE60+EDj
		cmp	eax, 40h
		jz	short loc_40CF4F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_40CF63
		cmp	eax, 4
		jz	short loc_40CF63
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40CFF1:				; CODE XREF: sub_40CE60+B9j
		cmp	eax, 40h
		jz	loc_40CF1F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_414438
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_40CF1F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_40CE00
; ---------------------------------------------------------------------------

loc_40D042:				; CODE XREF: sub_40CE60+17j
		xor	esi, esi
		jmp	loc_40CEA3
; ---------------------------------------------------------------------------

loc_40D049:				; CODE XREF: sub_40CE60+ACj
		mov	eax, ds:dword_414438
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_40CE00
; ---------------------------------------------------------------------------

loc_40D069:				; CODE XREF: sub_40CE60+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_40CE00
; ---------------------------------------------------------------------------

loc_40D079:				; CODE XREF: sub_40CE60+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_40CE00
sub_40CE60	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D0A0	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_414434
		test	eax, eax
		jz	short loc_40D0C0

loc_40D0B2:				; CODE XREF: sub_40D0A0+66j
					; sub_40D0A0+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D0C0:				; CODE XREF: sub_40D0A0+10j
		mov	ds:dword_414434, 1
		call	sub_40D4A0
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_40DB60
		mov	ds:dword_41443C, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_414438, eax
		mov	eax, offset dword_413480
		sub	eax, offset dword_413480
		cmp	eax, 7
		jle	short loc_40D0B2
		cmp	eax, 0Bh
		mov	ebx, offset dword_413480
		jle	loc_40D200
		mov	eax, ds:dword_413480
		test	eax, eax
		jnz	short loc_40D130
		mov	eax, ds:dword_413484
		test	eax, eax
		jz	loc_40D1EC
		lea	esi, [esi+0]

loc_40D130:				; CODE XREF: sub_40D0A0+7Dj
					; sub_40D0A0+164j ...
		cmp	ebx, offset dword_413480
		jnb	loc_40D0B2
		mov	esi, 400000h

loc_40D141:				; CODE XREF: sub_40D0A0+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_40CE60
		cmp	ebx, offset dword_413480
		jb	short loc_40D141

loc_40D165:				; CODE XREF: sub_40D0A0+24Bj
		mov	ecx, ds:dword_41443C
		test	ecx, ecx
		jle	loc_40D0B2
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_40D192
; ---------------------------------------------------------------------------
		align 10h

loc_40D180:				; CODE XREF: sub_40D0A0+FDj
					; sub_40D0A0+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_41443C
		jge	loc_40D0B2

loc_40D192:				; CODE XREF: sub_40D0A0+DDj
		mov	eax, ds:dword_414438
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_40D180
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40D312
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_414438
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_40D180
; ---------------------------------------------------------------------------

loc_40D1EC:				; CODE XREF: sub_40D0A0+86j
		mov	eax, ds:dword_413488
		test	eax, eax
		jnz	short loc_40D215
		mov	ebx, offset dword_41348C
		lea	esi, [esi+0]

loc_40D200:				; CODE XREF: sub_40D0A0+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_40D130
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_40D130

loc_40D215:				; CODE XREF: sub_40D0A0+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_40D335
		add	ebx, 0Ch
		cmp	ebx, offset dword_413480
		jnb	loc_40D0B2

loc_40D230:				; CODE XREF: sub_40D0A0+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_40D28A
		cmp	edx, 20h
		jz	short loc_40D2C0
		cmp	edx, 8
		jz	short loc_40D26A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_40CE00
; ---------------------------------------------------------------------------

loc_40D26A:				; CODE XREF: sub_40D0A0+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_40D295
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_40D2B1
; ---------------------------------------------------------------------------

loc_40D28A:				; CODE XREF: sub_40D0A0+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_40D2F0

loc_40D295:				; CODE XREF: sub_40D0A0+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_40D303
		cmp	edx, 20h
		jz	short loc_40D2CF
		cmp	edx, 8
		jnz	short loc_40D2DC

loc_40D2B1:				; CODE XREF: sub_40D0A0+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_40CE60
		jmp	short loc_40D2DC
; ---------------------------------------------------------------------------

loc_40D2C0:				; CODE XREF: sub_40D0A0+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_40D2CF:				; CODE XREF: sub_40D0A0+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_40CE60

loc_40D2DC:				; CODE XREF: sub_40D0A0+20Fj
					; sub_40D0A0+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_413480
		jb	loc_40D230
		jmp	loc_40D165
; ---------------------------------------------------------------------------

loc_40D2F0:				; CODE XREF: sub_40D0A0+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_40D303:				; CODE XREF: sub_40D0A0+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_40CE60
		jmp	short loc_40D2DC
; ---------------------------------------------------------------------------

loc_40D312:				; CODE XREF: sub_40D0A0+11Bj
		add	ebx, ds:dword_414438
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_40CE00
; ---------------------------------------------------------------------------

loc_40D335:				; CODE XREF: sub_40D0A0+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_40CE00
sub_40D0A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D350	proc near		; CODE XREF: .text:0040D3F1p
					; sub_40D460+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_40D360

locret_40D35D:				; CODE XREF: sub_40D350+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D360:				; CODE XREF: sub_40D350+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_40D35D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_40D350	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D380	proc near		; CODE XREF: sub_40D460+2Bp
					; .text:0040D5A4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_40D3BE
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_40D3A4:				; CODE XREF: sub_40D380+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_40D3B2
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40D3BE

loc_40D3B2:				; CODE XREF: sub_40D380+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_40D3A4
		xor	eax, eax

loc_40D3BE:				; CODE XREF: sub_40D380+19j
					; sub_40D380+30j
		pop	ebx
		pop	esi
		retn
sub_40D380	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40D3D0
; ---------------------------------------------------------------------------
		align 10h

loc_40D3D0:				; CODE XREF: .text:0040D3C1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_40D443
		mov	dword ptr [esp], 400000h
		call	sub_40D350
		test	eax, eax
		jz	short loc_40D443
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_40D443
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_40D42B
; ---------------------------------------------------------------------------

loc_40D421:				; CODE XREF: .text:0040D441j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_40D450

loc_40D42B:				; CODE XREF: .text:0040D41Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_40D421

loc_40D443:				; CODE XREF: .text:0040D3E8j
					; .text:0040D3F8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D450:				; CODE XREF: .text:0040D429j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D460	proc near		; CODE XREF: sub_40CE60+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_40D350
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_40D490
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_40D380

loc_40D490:				; CODE XREF: sub_40D460+15j
		add	esp, 8
		retn
sub_40D460	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D4A0	proc near		; CODE XREF: sub_40D0A0+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_40D350
		xor	edx, edx
		test	eax, eax
		jz	short loc_40D4C1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_40D4C1:				; CODE XREF: sub_40D4A0+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_40D4A0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_40D350
		xor	edx, edx
		test	eax, eax
		jz	short loc_40D529
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_40D529
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_40D510:				; CODE XREF: .text:0040D525j
		test	byte ptr [edx+27h], 20h
		jz	short loc_40D51D
		test	ebx, ebx
		jz	short loc_40D529
		sub	ebx, 1

loc_40D51D:				; CODE XREF: .text:0040D514j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_40D510
		xor	edx, edx

loc_40D529:				; CODE XREF: .text:0040D4E9j
					; .text:0040D505j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40D540
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D540	proc near		; CODE XREF: sub_40CE60+70p
					; .text:0040D531j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_40D350
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_40D540	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40D570
; ---------------------------------------------------------------------------
		align 10h

loc_40D570:				; CODE XREF: .text:0040D561j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_40D350
		test	eax, eax
		jnz	short loc_40D590

loc_40D586:				; CODE XREF: .text:0040D5ABj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D590:				; CODE XREF: .text:0040D584j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_40D380
		test	eax, eax
		jz	short loc_40D586
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D5C0	proc near		; CODE XREF: sub_40D650+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_40D350
		test	eax, eax
		jz	short loc_40D631
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_40D631
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_40D380
		test	eax, eax
		jz	short loc_40D631
		add	esi, 400000h
		jnz	short loc_40D616
		jmp	short loc_40D631
; ---------------------------------------------------------------------------
		align 10h

loc_40D610:				; CODE XREF: sub_40D5C0+66j
		sub	ebx, 1
		add	esi, 14h

loc_40D616:				; CODE XREF: sub_40D5C0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_40D624
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_40D640

loc_40D624:				; CODE XREF: sub_40D5C0+5Bj
		test	ebx, ebx
		jg	short loc_40D610
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_40D631:				; CODE XREF: sub_40D5C0+1Aj
					; sub_40D5C0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D640:				; CODE XREF: sub_40D5C0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_40D5C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D650	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_414440
		test	eax, eax
		jz	short loc_40D662

loc_40D65D:				; CODE XREF: sub_40D650+97j
					; sub_40D650+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40D662:				; CODE XREF: sub_40D650+Bj
		xor	eax, eax

loc_40D664:				; CODE XREF: sub_40D650+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_40D5C0
		test	eax, eax
		jz	short loc_40D6F0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_40D680
		cmp	dl, 6Dh
		jnz	short loc_40D6D0

loc_40D680:				; CODE XREF: sub_40D650+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40D68E
		cmp	dl, 73h
		jnz	short loc_40D6D0

loc_40D68E:				; CODE XREF: sub_40D650+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40D69C
		cmp	dl, 76h
		jnz	short loc_40D6D0

loc_40D69C:				; CODE XREF: sub_40D650+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_40D6AA
		cmp	dl, 63h
		jnz	short loc_40D6D0

loc_40D6AA:				; CODE XREF: sub_40D650+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_40D6B8
		cmp	dl, 72h
		jnz	short loc_40D6D0

loc_40D6B8:				; CODE XREF: sub_40D650+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_40D6D4
		cmp	dl, 74h
		jz	short loc_40D6D4
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_40D6D4
		xchg	ax, ax

loc_40D6D0:				; CODE XREF: sub_40D650+2Ej
					; sub_40D650+3Cj ...
		mov	eax, ebx
		jmp	short loc_40D664
; ---------------------------------------------------------------------------

loc_40D6D4:				; CODE XREF: sub_40D650+6Fj
					; sub_40D650+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_414440, eax
		jnz	loc_40D65D
		lea	esi, [esi+0]

loc_40D6F0:				; CODE XREF: sub_40D650+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_414440, eax
		jmp	loc_40D65D
sub_40D650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D710	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_40D710	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40D720()
sub_40D720	proc near		; DATA XREF: sub_40D7A0:loc_40D772o
		sub	esp, 0Ch
		mov	eax, off_410014
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D747
		xchg	ax, ax

loc_40D730:				; CODE XREF: sub_40D720+25j
		call	eax
		mov	eax, off_410014
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_410014, edx
		test	eax, eax
		jnz	short loc_40D730

loc_40D747:				; CODE XREF: sub_40D720+Cj
		add	esp, 0Ch
		retn
sub_40D720	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_40D7A0

loc_40D750:				; CODE XREF: sub_40D7A0+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_40F200
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_40D783

loc_40D75F:				; CODE XREF: sub_40D7A0-9j
		test	ebx, ebx
		jz	short loc_40D772

loc_40D763:				; CODE XREF: sub_40D7A0-30j
		call	ds:dword_40F200[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_40D763

loc_40D772:				; CODE XREF: sub_40D7A0-3Fj
		mov	[esp+1Ch+var_1C], offset sub_40D720 ; _onexit_t
		call	sub_40CB80
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40D783:				; CODE XREF: sub_40D7A0-43j
		xor	ebx, ebx
		jmp	short loc_40D789
; ---------------------------------------------------------------------------

loc_40D787:				; CODE XREF: sub_40D7A0-Bj
		mov	ebx, eax

loc_40D789:				; CODE XREF: sub_40D7A0-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_40F200[eax*4]
		test	edx, edx
		jnz	short loc_40D787
		jmp	short loc_40D75F
; END OF FUNCTION CHUNK	FOR sub_40D7A0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D7A0	proc near		; CODE XREF: sub_401180+239p
					; sub_401CDA+Fp

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 0040D750 SIZE 00000049 BYTES

		mov	ecx, ds:dword_414444
		test	ecx, ecx
		jz	short loc_40D7B0
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D7B0:				; CODE XREF: sub_40D7A0+8j
		mov	ds:dword_414444, 1
		jmp	short loc_40D750
sub_40D7A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D7C0	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_41003C
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_40D810
		not	eax
		mov	dword_410040, eax

loc_40D7F6:				; CODE XREF: sub_40D7C0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D810:				; CODE XREF: sub_40D7C0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_40D882

loc_40D872:				; CODE XREF: sub_40D7C0+CCj
		mov	dword_41003C, ebp
		mov	dword_410040, eax
		jmp	loc_40D7F6
; ---------------------------------------------------------------------------

loc_40D882:				; CODE XREF: sub_40D7C0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_40D872
sub_40D7C0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_414524, edx
		mov	ds:dword_414740, 0C0000409h
		mov	ds:dword_414744, 1
		mov	ds:dword_414518, eax
		mov	ds:dword_41474C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_41450C, eax
		mov	eax, dword_41003C
		mov	[ebp-10h], eax
		mov	eax, dword_410040
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_41317C
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D920	proc near		; CODE XREF: sub_40DAC0+79p
					; sub_40DAC0:loc_40DB52p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_4147BC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_40D975
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_40D950:				; CODE XREF: sub_40D920+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_40D96E
		test	esi, esi
		jz	short loc_40D96E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_40D96E:				; CODE XREF: sub_40D920+40j
					; sub_40D920+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_40D950

loc_40D975:				; CODE XREF: sub_40D920+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40D920	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_4147A0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_40D9B4

loc_40D9A6:				; CODE XREF: .text:0040DA1Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40D9B4:				; CODE XREF: .text:0040D9A4j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_40DA17
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_4147BC
		mov	ds:dword_4147BC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40DA17:				; CODE XREF: .text:0040D9CCj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_40D9A6
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_4147A0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_40DA38
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40DA38:				; CODE XREF: .text:0040DA2Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_4147BC
		sub	esp, 4
		test	edx, edx
		jz	short loc_40DA6F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_40DA68
		jmp	short loc_40DAA6
; ---------------------------------------------------------------------------
		align 10h

loc_40DA60:				; CODE XREF: .text:0040DA6Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_40DA86
		mov	edx, eax

loc_40DA68:				; CODE XREF: .text:0040DA56j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_40DA60

loc_40DA6F:				; CODE XREF: .text:0040DA50j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_40DA7F:				; CODE XREF: .text:0040DAA4j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40DA86:				; CODE XREF: .text:0040DA64j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_40DA8C:				; CODE XREF: .text:0040DAB0j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_40DA7F
; ---------------------------------------------------------------------------

loc_40DAA6:				; CODE XREF: .text:0040DA58j
		mov	eax, [edx+8]
		mov	ds:dword_4147BC, eax
		mov	eax, edx
		jmp	short loc_40DA8C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DAC0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_40DB10
		jb	short loc_40DAE0
		cmp	eax, 3
		jz	short loc_40DB30

loc_40DAD3:				; CODE XREF: sub_40DAC0+31j
					; sub_40DAC0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40DAE0:				; CODE XREF: sub_40DAC0+Cj
		mov	eax, ds:dword_4147A0
		test	eax, eax
		jnz	short loc_40DB52

loc_40DAE9:				; CODE XREF: sub_40DAC0+97j
		mov	eax, ds:dword_4147A0
		cmp	eax, 1
		jnz	short loc_40DAD3
		mov	ds:dword_4147A0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_40DAD3
; ---------------------------------------------------------------------------
		align 10h

loc_40DB10:				; CODE XREF: sub_40DAC0+Aj
		mov	eax, ds:dword_4147A0
		test	eax, eax
		jz	short loc_40DB40

loc_40DB19:				; CODE XREF: sub_40DAC0+90j
		mov	ds:dword_4147A0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40DB30:				; CODE XREF: sub_40DAC0+11j
		mov	eax, ds:dword_4147A0
		test	eax, eax
		jz	short loc_40DAD3
		call	sub_40D920
		jmp	short loc_40DAD3
; ---------------------------------------------------------------------------

loc_40DB40:				; CODE XREF: sub_40DAC0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_40DB19
; ---------------------------------------------------------------------------

loc_40DB52:				; CODE XREF: sub_40DAC0+27j
		call	sub_40D920
		jmp	short loc_40DAE9
sub_40DAC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DB60	proc near		; CODE XREF: sub_401180+19p
					; sub_40D0A0+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_40DB82

loc_40DB6D:				; CODE XREF: sub_40DB60+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_40DB6D

loc_40DB82:				; CODE XREF: sub_40DB60+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_40DB60	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _dup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40DBE0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DBE0	proc near		; CODE XREF: sub_401180+A7p
					; .text:0040DBD1j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_40DBE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DC00	proc near		; CODE XREF: sub_40E080+EDp
					; sub_40E080+2EFp

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4

		push	ebp
		push	edi
		mov	edi, eax
		push	esi
		mov	esi, ecx
		push	ebx
		sub	esp, 14h
		mov	[esp+24h+var_20], edx
		sub	edx, eax
		mov	eax, esi
		sub	eax, [esp+24h+var_20]
		mov	[esp+24h+var_18], edx
		mov	ecx, [esp+24h+arg_0]
		mov	[esp+24h+var_1C], eax
		mov	eax, edx
		sar	edx, 1Fh
		idiv	[esp+24h+var_1C]
		mov	eax, [esp+24h+var_1C]
		test	edx, edx
		mov	ebx, edx
		jnz	short loc_40DC3C
		jmp	short loc_40DCAD
; ---------------------------------------------------------------------------

loc_40DC38:				; CODE XREF: sub_40DC00+45j
		mov	eax, ebx
		mov	ebx, edx

loc_40DC3C:				; CODE XREF: sub_40DC00+34j
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	edx, edx
		jnz	short loc_40DC38

loc_40DC47:				; CODE XREF: sub_40DC00+B1j
		mov	eax, esi
		sub	eax, edi
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	ebx, ebx
		mov	[esp+24h+var_24], eax
		jle	short loc_40DCA5
		mov	ebp, [esp+24h+var_20]
		add	ebx, ebp
		mov	[esp+24h+var_14], ebx

loc_40DC63:				; CODE XREF: sub_40DC00+A3j
		mov	eax, [esp+24h+var_24]
		test	eax, eax
		jle	short loc_40DC9C
		mov	edi, [ecx+ebp*4]
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_40DC75
; ---------------------------------------------------------------------------

loc_40DC73:				; CODE XREF: sub_40DC00+9Aj
		mov	edi, esi

loc_40DC75:				; CODE XREF: sub_40DC00+71j
		mov	esi, [esp+24h+var_1C]
		mov	ebx, eax
		sub	ebx, [esp+24h+var_18]
		add	esi, eax
		cmp	[esp+24h+var_20], eax
		mov	eax, ebx
		cmovg	eax, esi
		add	edx, 1
		lea	ebx, [ecx+eax*4]
		mov	esi, [ebx]
		cmp	edx, [esp+24h+var_24]
		mov	[ebx], edi
		mov	[ecx+ebp*4], esi
		jnz	short loc_40DC73

loc_40DC9C:				; CODE XREF: sub_40DC00+68j
		add	ebp, 1
		cmp	ebp, [esp+24h+var_14]
		jnz	short loc_40DC63

loc_40DCA5:				; CODE XREF: sub_40DC00+57j
		add	esp, 14h
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40DCAD:				; CODE XREF: sub_40DC00+36j
		mov	ebx, [esp+24h+var_1C]
		jmp	short loc_40DC47
sub_40DC00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40DCC0(char *, char)
sub_40DCC0	proc near		; CODE XREF: sub_40DD30+152p
					; sub_40DD30+1E8p ...

File		= dword	ptr -1Ch
Format		= dword	ptr -18h
ArgList		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:__argv
		mov	ebx, [esp+1Ch+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[esp+1Ch+Format], offset aS ; "%s: "
		mov	[esp+1Ch+ArgList], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fprintf
		test	ebx, ebx
		jz	short loc_40DD0D
		lea	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, ds:_iob
		mov	[esp+1Ch+Format], ebx ;	Format
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	vfprintf

loc_40DD0D:				; CODE XREF: sub_40DCC0+2Fj
		mov	eax, ds:_iob
		mov	[esp+1Ch+File],	0Ah ; Ch
		add	eax, 40h
		mov	[esp+1Ch+Format], eax ;	File
		call	fputc
		add	esp, 18h
		pop	ebx
		retn
sub_40DCC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DD30	proc near		; CODE XREF: sub_40E080+220p
					; sub_40E080+5BBp

Str		= dword	ptr -5Ch
Val		= dword	ptr -58h
MaxCount	= dword	ptr -54h
var_44		= dword	ptr -44h
Str1		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	[esp+5Ch+var_24], edx
		mov	edx, off_410038
		mov	[esp+5Ch+var_38], ecx
		mov	ecx, dword_410024
		mov	[esp+5Ch+Val], 3Dh ; Val
		mov	[esp+5Ch+var_20], eax
		mov	[esp+5Ch+Str], edx ; Str
		mov	[esp+5Ch+var_2C], ecx
		add	ecx, 1
		mov	[esp+5Ch+Str1],	edx
		mov	[esp+5Ch+var_28], ecx
		mov	dword_410024, ecx
		call	strchr
		test	eax, eax
		mov	[esp+5Ch+var_34], eax
		jz	loc_40DF50
		mov	ebp, eax
		add	eax, 1
		sub	ebp, [esp+5Ch+Str1]
		mov	[esp+5Ch+var_34], eax

loc_40DD8D:				; CODE XREF: sub_40DD30+22Ej
		mov	ecx, [esp+5Ch+var_38]
		mov	esi, [ecx]
		test	esi, esi
		jz	loc_40DF6E
		mov	ebx, ecx
		xor	edi, edi
		add	ebx, 10h
		mov	[esp+5Ch+var_44], ecx
		mov	[esp+5Ch+var_3C], 0FFFFFFFFh
		mov	[esp+5Ch+var_30], 0
		jmp	short loc_40DDE8
; ---------------------------------------------------------------------------

loc_40DDB8:				; CODE XREF: sub_40DD30+F2j
		mov	eax, [esp+5Ch+var_3C]
		mov	ecx, [esp+5Ch+var_44]
		shl	eax, 4
		add	eax, [esp+5Ch+var_38]
		mov	edx, [eax+4]
		cmp	[ecx+4], edx
		jz	short loc_40DE30

loc_40DDCF:				; CODE XREF: sub_40DD30+106j
		mov	[esp+5Ch+var_30], 1

loc_40DDD7:				; CODE XREF: sub_40DD30+CEj
					; sub_40DD30+EBj ...
		mov	[esp+5Ch+var_44], ebx
		add	ebx, 10h
		add	edi, 1
		mov	esi, [ebx-10h]
		test	esi, esi
		jz	short loc_40DE50

loc_40DDE8:				; CODE XREF: sub_40DD30+86j
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+MaxCount], ebp	; MaxCount
		mov	[esp+5Ch+Val], esi ; Str2
		mov	[esp+5Ch+Str], edx ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_40DDD7
		mov	[esp+5Ch+Str], esi ; Str
		call	strlen
		cmp	eax, ebp
		jz	loc_40DEA0
		cmp	ebp, 1
		jnz	short loc_40DE1D
		mov	esi, [esp+5Ch+arg_4]
		test	esi, esi
		jnz	short loc_40DDD7

loc_40DE1D:				; CODE XREF: sub_40DD30+E3j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	short loc_40DDB8
		mov	[esp+5Ch+var_3C], edi
		jmp	short loc_40DDD7
; ---------------------------------------------------------------------------
		align 10h

loc_40DE30:				; CODE XREF: sub_40DD30+9Dj
		mov	edx, [eax+8]
		cmp	[ecx+8], edx
		jnz	short loc_40DDCF
		mov	edx, [eax+0Ch]
		mov	eax, 1
		cmp	[ecx+0Ch], edx
		cmovz	eax, [esp+5Ch+var_30]
		mov	[esp+5Ch+var_30], eax
		jmp	short loc_40DDD7
; ---------------------------------------------------------------------------
		align 10h

loc_40DE50:				; CODE XREF: sub_40DD30+B6j
		mov	ebx, [esp+5Ch+var_30]
		test	ebx, ebx
		jz	loc_40DF63
		mov	ecx, dword_410028
		test	ecx, ecx
		jz	short loc_40DE87
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40DE87
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aAmbiguousOptio ;	"ambiguous option -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_40DCC0

loc_40DE87:				; CODE XREF: sub_40DD30+134j
					; sub_40DD30+13Dj ...
		mov	dword_410020, 0
		mov	eax, 3Fh

loc_40DE96:				; CODE XREF: sub_40DD30+1BDj
					; sub_40DD30+2EAj ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40DEA0:				; CODE XREF: sub_40DD30+DAj
		mov	[esp+5Ch+var_3C], edi

loc_40DEA4:				; CODE XREF: sub_40DD30+238j
		mov	ebx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+var_34]
		shl	ebx, 4
		add	ebx, [esp+5Ch+var_38]
		test	edx, edx
		setnz	dl
		mov	eax, [ebx+4]
		jnz	short loc_40DEEF

loc_40DEBD:				; CODE XREF: sub_40DD30+1C1j
		lea	ecx, [eax-1]
		cmp	ecx, 1
		jbe	loc_40DFAE

loc_40DEC9:				; CODE XREF: sub_40DD30+28Fj
					; sub_40DD30+29Dj ...
		mov	edx, [esp+5Ch+arg_0]
		test	edx, edx
		jz	short loc_40DEDB
		mov	ecx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+arg_0]
		mov	[edx], ecx

loc_40DEDB:				; CODE XREF: sub_40DD30+19Fj
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_40E017
		mov	edx, [ebx+0Ch]
		mov	[eax], edx
		xor	eax, eax
		jmp	short loc_40DE96
; ---------------------------------------------------------------------------

loc_40DEEF:				; CODE XREF: sub_40DD30+18Bj
		test	eax, eax
		jnz	short loc_40DEBD
		mov	eax, dword_410028
		test	eax, eax
		jz	short loc_40DF1D
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40DF1D
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aOptionDoesnTTa ;	"option	doesn't take an argument -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_40DCC0

loc_40DF1D:				; CODE XREF: sub_40DD30+1CAj
					; sub_40DD30+1D3j
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_40E01F
		mov	dword_410020, 0

loc_40DF32:				; CODE XREF: sub_40DD30+2E2j
					; sub_40DD30+2F7j
		mov	edx, [esp+5Ch+var_24]
		xor	eax, eax
		cmp	byte ptr [edx],	3Ah
		setnz	al
		add	esp, 4Ch
		pop	ebx
		lea	eax, [eax+eax*4+3Ah]
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40DF50:				; CODE XREF: sub_40DD30+4Aj
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], edx ; Str
		call	strlen
		mov	ebp, eax
		jmp	loc_40DD8D
; ---------------------------------------------------------------------------

loc_40DF63:				; CODE XREF: sub_40DD30+126j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	loc_40DEA4

loc_40DF6E:				; CODE XREF: sub_40DD30+65j
		mov	ebx, [esp+5Ch+arg_4]
		test	ebx, ebx
		jnz	loc_40E056
		mov	ecx, dword_410028
		test	ecx, ecx
		jz	loc_40DE87
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	loc_40DE87
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aUnknownOptionS ;	"unknown option	-- %s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_40DCC0
		jmp	loc_40DE87
; ---------------------------------------------------------------------------

loc_40DFAE:				; CODE XREF: sub_40DD30+193j
		test	dl, dl
		jz	short loc_40E02C
		mov	ecx, [esp+5Ch+var_34]
		cmp	eax, 1
		mov	ds:Filename, ecx
		jnz	loc_40DEC9

loc_40DFC5:				; CODE XREF: sub_40DD30+321j
		mov	ebp, ds:Filename
		test	ebp, ebp
		jnz	loc_40DEC9
		mov	edi, dword_410028
		test	edi, edi
		jz	short loc_40DFFA
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40DFFA
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aOptionRequires ;	"option	requires an argument --	%s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_40DCC0

loc_40DFFA:				; CODE XREF: sub_40DD30+2ABj
					; sub_40DD30+2B4j
		mov	esi, [ebx+8]
		test	esi, esi
		jz	short loc_40E06A
		mov	dword_410020, 0

loc_40E00B:				; CODE XREF: sub_40DD30+342j
		sub	dword_410024, 1
		jmp	loc_40DF32
; ---------------------------------------------------------------------------

loc_40E017:				; CODE XREF: sub_40DD30+1B0j
		mov	eax, [ebx+0Ch]
		jmp	loc_40DE96
; ---------------------------------------------------------------------------

loc_40E01F:				; CODE XREF: sub_40DD30+1F2j
		mov	eax, [ebx+0Ch]
		mov	dword_410020, eax
		jmp	loc_40DF32
; ---------------------------------------------------------------------------

loc_40E02C:				; CODE XREF: sub_40DD30+280j
		cmp	eax, 1
		jnz	loc_40DEC9
		mov	edx, [esp+5Ch+var_28]
		mov	ecx, [esp+5Ch+var_20]
		mov	eax, [ecx+edx*4]
		mov	ds:Filename, eax
		mov	eax, [esp+5Ch+var_2C]
		add	eax, 2
		mov	dword_410024, eax
		jmp	loc_40DFC5
; ---------------------------------------------------------------------------

loc_40E056:				; CODE XREF: sub_40DD30+244j
		mov	ecx, [esp+5Ch+var_2C]
		mov	eax, 0FFFFFFFFh
		mov	dword_410024, ecx
		jmp	loc_40DE96
; ---------------------------------------------------------------------------

loc_40E06A:				; CODE XREF: sub_40DD30+2CFj
		mov	eax, [ebx+0Ch]
		mov	dword_410020, eax
		jmp	short loc_40E00B
sub_40DD30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40E080	proc near		; CODE XREF: sub_40E660+24j
					; .text:0040E6B6j ...

Str		= dword	ptr -4Ch
Val		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		test	ecx, ecx
		mov	[esp+4Ch+var_24], eax
		mov	edi, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_28], edx
		mov	[esp+4Ch+var_20], ecx
		jz	loc_40E3B2
		mov	ecx, dword_410024
		test	ecx, ecx
		jz	loc_40E300

loc_40E0AD:				; CODE XREF: sub_40E080+294j
		cmp	dword_41002C, 0FFFFFFFFh
		jz	loc_40E2C0
		mov	edx, ds:dword_414800
		xor	eax, eax
		test	edx, edx
		jnz	loc_40E2C0
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		cmp	dl, 2Dh
		jz	loc_40E2EE

loc_40E0DA:				; CODE XREF: sub_40E080+268j
		mov	ebp, dword_41002C
		test	ebp, ebp
		jnz	loc_40E320
		cmp	dl, 2Bh
		jz	loc_40E4D7

loc_40E0F1:				; CODE XREF: sub_40E080+276j
					; sub_40E080+2A6j ...
		test	eax, eax
		mov	ds:Filename, 0
		jz	loc_40E19C
		mov	dword_410030, 0FFFFFFFFh
		mov	dword_410034, 0FFFFFFFFh
		jmp	short loc_40E198
; ---------------------------------------------------------------------------
		align 10h

loc_40E120:				; CODE XREF: sub_40E080+159j
					; sub_40E080+18Ej
		test	edi, 2
		mov	off_410038, offset byte_4131B5
		jnz	loc_40E3C1
		test	edi, 1
		jz	loc_40E3B2
		mov	ebx, dword_410034
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40E336
		mov	esi, dword_410030
		xor	eax, eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_40E18F
		mov	edx, [esp+4Ch+var_28]
		mov	eax, ebx
		mov	ecx, ebp
		sub	ebx, esi
		mov	[esp+4Ch+Str], edx
		mov	edx, esi
		call	sub_40DC00
		mov	edx, dword_410024
		mov	eax, ds:dword_414800
		mov	dword_410030, 0FFFFFFFFh
		add	ebx, edx
		mov	dword_410034, ebx

loc_40E18F:				; CODE XREF: sub_40E080+DCj
					; sub_40E080+2BEj
		add	edx, 1
		mov	dword_410024, edx

loc_40E198:				; CODE XREF: sub_40E080+97j
		test	eax, eax
		jnz	short loc_40E1AD

loc_40E19C:				; CODE XREF: sub_40E080+7Dj
		mov	ebx, off_410038
		movzx	ecx, byte ptr [ebx]
		test	cl, cl
		jnz	loc_40E237

loc_40E1AD:				; CODE XREF: sub_40E080+11Aj
		mov	ebp, dword_410024
		cmp	ebp, [esp+4Ch+var_24]
		mov	ds:dword_414800, 0
		mov	edx, ebp
		jge	loc_40E343
		mov	ecx, [esp+4Ch+var_28]
		mov	ebx, [ecx+ebp*4]
		cmp	byte ptr [ebx],	2Dh
		mov	off_410038, ebx
		jnz	loc_40E120
		movzx	ecx, byte ptr [ebx+1]
		test	cl, cl
		jnz	short loc_40E214
		mov	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], 2Dh ; Val
		mov	[esp+4Ch+var_2C], cl
		mov	[esp+4Ch+var_30], ebp
		mov	[esp+4Ch+Str], eax ; Str
		call	strchr
		mov	edx, [esp+4Ch+var_30]
		movzx	ecx, [esp+4Ch+var_2C]
		test	eax, eax
		jz	loc_40E120

loc_40E214:				; CODE XREF: sub_40E080+165j
		cmp	dword_410034, 0FFFFFFFFh
		mov	eax, ebx
		jz	short loc_40E22C
		cmp	dword_410030, 0FFFFFFFFh
		jz	loc_40E593

loc_40E22C:				; CODE XREF: sub_40E080+19Dj
					; sub_40E080+519j
		test	cl, cl
		jnz	loc_40E524
		movzx	ecx, byte ptr [ebx]

loc_40E237:				; CODE XREF: sub_40E080+127j
					; sub_40E080+4B0j ...
		mov	esi, [esp+4Ch+arg_0]
		test	esi, esi
		jz	loc_40E3F9
		mov	eax, dword_410024
		mov	edx, [esp+4Ch+var_28]
		cmp	ebx, [edx+eax*4]
		jz	loc_40E3F9
		cmp	cl, 2Dh
		jz	loc_40E583
		and	edi, 4
		jz	loc_40E3F9
		xor	eax, eax
		cmp	cl, 3Ah
		jz	short loc_40E289
		movsx	ecx, cl
		mov	[esp+4Ch+Val], ecx ; Val
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		setnz	al
		movzx	eax, al

loc_40E289:				; CODE XREF: sub_40E080+1ECj
					; sub_40E080+50Ej
		mov	[esp+4Ch+Val], eax
		mov	eax, [esp+4Ch+arg_4]
		mov	ecx, [esp+4Ch+arg_0]
		mov	edx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], eax
		mov	eax, [esp+4Ch+var_28]
		call	sub_40DD30
		cmp	eax, 0FFFFFFFFh
		mov	esi, eax
		jz	loc_40E3F0

loc_40E2B0:				; CODE XREF: sub_40E080+5C2j
		mov	off_410038, offset byte_4131B5
		jmp	loc_40E3B7
; ---------------------------------------------------------------------------
		align 10h

loc_40E2C0:				; CODE XREF: sub_40E080+34j
					; sub_40E080+44j
		mov	[esp+4Ch+Str], offset aPosixly_correc ;	"POSIXLY_CORRECT"
		call	getenv
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		test	eax, eax
		setnz	al
		movzx	eax, al
		cmp	dl, 2Dh
		mov	dword_41002C, eax
		mov	eax, ds:dword_414800
		jnz	loc_40E0DA

loc_40E2EE:				; CODE XREF: sub_40E080+54j
		or	edi, 2
		add	[esp+4Ch+var_20], 1
		jmp	loc_40E0F1
; ---------------------------------------------------------------------------
		align 10h

loc_40E300:				; CODE XREF: sub_40E080+27j
		mov	ds:dword_414800, 1
		mov	dword_410024, 1
		jmp	loc_40E0AD
; ---------------------------------------------------------------------------
		align 10h

loc_40E320:				; CODE XREF: sub_40E080+62j
		and	edi, 0FFFFFFFEh
		cmp	dl, 2Bh
		jnz	loc_40E0F1
		add	[esp+4Ch+var_20], 1
		jmp	loc_40E0F1
; ---------------------------------------------------------------------------

loc_40E336:				; CODE XREF: sub_40E080+CBj
		mov	dword_410034, ebp
		xor	eax, eax
		jmp	loc_40E18F
; ---------------------------------------------------------------------------

loc_40E343:				; CODE XREF: sub_40E080+143j
		mov	ebx, dword_410030
		mov	off_410038, offset byte_4131B5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40E3DF
		mov	edx, [esp+4Ch+var_28]
		mov	ecx, ebp
		mov	esi, dword_410034
		mov	[esp+4Ch+Str], edx

loc_40E36B:				; CODE XREF: sub_40E080+4EFj
		mov	eax, esi
		mov	edx, ebx
		call	sub_40DC00
		sub	esi, ebx
		add	dword_410024, esi

loc_40E37C:				; CODE XREF: sub_40E080+367j
					; sub_40E080+36Ej ...
		mov	esi, 0FFFFFFFFh
		mov	dword_410030, 0FFFFFFFFh
		mov	eax, esi
		mov	dword_410034, 0FFFFFFFFh
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40E39F:				; CODE XREF: sub_40E080+3A9j
		cmp	esi, 2Dh
		jnz	loc_40E4E4
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40E4F1

loc_40E3B2:				; CODE XREF: sub_40E080+19j
					; sub_40E080+BCj
		mov	esi, 0FFFFFFFFh

loc_40E3B7:				; CODE XREF: sub_40E080+23Aj
					; sub_40E080+3CDj ...
		add	esp, 3Ch
		mov	eax, esi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40E3C1:				; CODE XREF: sub_40E080+B0j
		add	ebp, 1
		mov	esi, 1
		mov	ds:Filename, ebx
		mov	eax, esi
		mov	dword_410024, ebp
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40E3DF:				; CODE XREF: sub_40E080+2D6j
		mov	eax, dword_410034
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40E37C
		mov	dword_410024, eax
		jmp	short loc_40E37C
; ---------------------------------------------------------------------------

loc_40E3F0:				; CODE XREF: sub_40E080+22Aj
		mov	ebx, off_410038
		movzx	ecx, byte ptr [ebx]

loc_40E3F9:				; CODE XREF: sub_40E080+1BDj
					; sub_40E080+1CFj ...
		movsx	esi, cl
		lea	edi, [ebx+1]
		cmp	esi, 3Ah
		mov	off_410038, edi
		jz	loc_40E4E4
		cmp	esi, 2Dh
		jz	loc_40E574

loc_40E417:				; CODE XREF: sub_40E080+4FEj
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], esi ; Val
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		jz	loc_40E39F
		cmp	esi, 57h
		movzx	edx, byte ptr [eax+1]
		jnz	short loc_40E440
		mov	ecx, [esp+4Ch+arg_0]
		test	ecx, ecx
		jnz	short loc_40E45F

loc_40E440:				; CODE XREF: sub_40E080+3B6j
					; sub_40E080+3E2j
		cmp	dl, 3Ah
		jz	loc_40E59E
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40E3B7

loc_40E453:				; CODE XREF: sub_40E080+53Ej
		add	dword_410024, 1
		jmp	loc_40E3B7
; ---------------------------------------------------------------------------

loc_40E45F:				; CODE XREF: sub_40E080+3BEj
		cmp	dl, 3Bh
		jnz	short loc_40E440
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40E620
		mov	eax, dword_410024
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_410024, eax
		jg	loc_40E614
		mov	ebp, dword_410028
		mov	off_410038, offset byte_4131B5
		test	ebp, ebp
		jz	short loc_40E4B6
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40E4B6
		mov	[esp+4Ch+Val], 57h ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_40DCC0

loc_40E4B6:				; CODE XREF: sub_40E080+417j
					; sub_40E080+420j
		mov	dword_410020, 57h

loc_40E4C0:				; CODE XREF: sub_40E080+58Fj
		mov	ecx, [esp+4Ch+var_20]
		xor	eax, eax
		cmp	byte ptr [ecx],	3Ah
		setnz	al
		mov	esi, eax
		lea	esi, [esi+esi*4+3Ah]
		jmp	loc_40E3B7
; ---------------------------------------------------------------------------

loc_40E4D7:				; CODE XREF: sub_40E080+6Bj
		and	edi, 0FFFFFFFEh
		add	[esp+4Ch+var_20], 1
		jmp	loc_40E0F1
; ---------------------------------------------------------------------------

loc_40E4E4:				; CODE XREF: sub_40E080+322j
					; sub_40E080+388j
		cmp	byte ptr [ebx+1], 0
		jnz	short loc_40E4F1
		add	dword_410024, 1

loc_40E4F1:				; CODE XREF: sub_40E080+32Cj
					; sub_40E080+468j ...
		mov	ebx, dword_410028
		test	ebx, ebx
		jz	short loc_40E514
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40E514
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aUnknownOptionC ;	"unknown option	-- %c"
		call	sub_40DCC0

loc_40E514:				; CODE XREF: sub_40E080+479j
					; sub_40E080+482j
		mov	dword_410020, esi
		mov	esi, 3Fh
		jmp	loc_40E3B7
; ---------------------------------------------------------------------------

loc_40E524:				; CODE XREF: sub_40E080+1AEj
		add	ebx, 1
		cmp	cl, 2Dh
		mov	off_410038, ebx
		jnz	loc_40E237
		cmp	byte ptr [eax+2], 0
		jnz	loc_40E237
		mov	ebx, dword_410030
		lea	ecx, [ebp+1]
		mov	dword_410024, ecx
		mov	off_410038, offset byte_4131B5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40E37C
		mov	edx, [esp+4Ch+var_28]
		mov	esi, dword_410034
		mov	[esp+4Ch+Str], edx
		jmp	loc_40E36B
; ---------------------------------------------------------------------------

loc_40E574:				; CODE XREF: sub_40E080+391j
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40E4F1
		jmp	loc_40E417
; ---------------------------------------------------------------------------

loc_40E583:				; CODE XREF: sub_40E080+1D8j
		add	ebx, 1
		xor	eax, eax
		mov	off_410038, ebx
		jmp	loc_40E289
; ---------------------------------------------------------------------------

loc_40E593:				; CODE XREF: sub_40E080+1A6j
		mov	dword_410030, ebp
		jmp	loc_40E22C
; ---------------------------------------------------------------------------

loc_40E59E:				; CODE XREF: sub_40E080+3C3j
		mov	ds:Filename, 0
		cmp	byte ptr [ebx+1], 0
		jz	short loc_40E5C3
		mov	ds:Filename, edi

loc_40E5B4:				; CODE XREF: sub_40E080+547j
					; sub_40E080+5D3j
		mov	off_410038, offset byte_4131B5
		jmp	loc_40E453
; ---------------------------------------------------------------------------

loc_40E5C3:				; CODE XREF: sub_40E080+52Cj
		cmp	byte ptr [eax+2], 3Ah
		jz	short loc_40E5B4
		mov	eax, dword_410024
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_410024, eax
		jg	short loc_40E647
		mov	edi, dword_410028
		mov	off_410038, offset byte_4131B5
		test	edi, edi
		jz	short loc_40E609
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40E609
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_40DCC0

loc_40E609:				; CODE XREF: sub_40E080+56Ej
					; sub_40E080+577j
		mov	dword_410020, esi
		jmp	loc_40E4C0
; ---------------------------------------------------------------------------

loc_40E614:				; CODE XREF: sub_40E080+3FFj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	off_410038, eax

loc_40E620:				; CODE XREF: sub_40E080+3E8j
		mov	ecx, [esp+4Ch+arg_4]
		mov	edx, [esp+4Ch+var_20]
		mov	eax, [esp+4Ch+var_28]
		mov	[esp+4Ch+Val], 0
		mov	[esp+4Ch+Str], ecx
		mov	ecx, [esp+4Ch+arg_0]
		call	sub_40DD30
		mov	esi, eax
		jmp	loc_40E2B0
; ---------------------------------------------------------------------------

loc_40E647:				; CODE XREF: sub_40E080+55Aj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	ds:Filename, eax
		jmp	loc_40E5B4
sub_40E080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40E660	proc near		; CODE XREF: sub_401CDA+1C8p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_8]
		mov	[esp+arg_4], 0
		mov	[esp+arg_8], 0
		mov	[esp+arg_0], 0
		jmp	sub_40E080
sub_40E660	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+18h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		mov	[esp+0Ch], ebx
		mov	ebx, [esp+14h]
		mov	dword ptr [esp+10h], 1
		mov	[esp+8], ebx
		pop	ebx
		jmp	sub_40E080
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+18h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		mov	[esp+0Ch], ebx
		mov	ebx, [esp+14h]
		mov	dword ptr [esp+10h], 5
		mov	[esp+8], ebx
		pop	ebx
		jmp	sub_40E080
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_40E6F0	proc near		; CODE XREF: sub_40E8D0+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_40E73C
		jmp	short loc_40E744
; ---------------------------------------------------------------------------
		align 10h

loc_40E730:				; CODE XREF: sub_40E6F0+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_40E744

loc_40E73C:				; CODE XREF: sub_40E6F0+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_40E730

loc_40E744:				; CODE XREF: sub_40E6F0+39j
					; sub_40E6F0+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_40E76C
		jmp	short loc_40E774
; ---------------------------------------------------------------------------
		align 10h

loc_40E760:				; CODE XREF: sub_40E6F0+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_40E774

loc_40E76C:				; CODE XREF: sub_40E6F0+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_40E760

loc_40E774:				; CODE XREF: sub_40E6F0+6Aj
					; sub_40E6F0+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_40E830
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_40E85E

loc_40E793:				; CODE XREF: sub_40E6F0+168j
					; sub_40E6F0+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40E870

loc_40E7C3:				; CODE XREF: sub_40E6F0+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_414424
		test	eax, eax
		jz	loc_40E8A9
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_40E891
		cmp	eax, 5
		jnz	short loc_40E88C
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40E830:				; CODE XREF: sub_40E6F0+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_40E793

loc_40E85E:				; CODE XREF: sub_40E6F0+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_40E793
; ---------------------------------------------------------------------------
		align 10h

loc_40E870:				; CODE XREF: sub_40E6F0+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_40E7C3
; ---------------------------------------------------------------------------

loc_40E88C:				; CODE XREF: sub_40E6F0+133j
		call	abort
; ---------------------------------------------------------------------------

loc_40E891:				; CODE XREF: sub_40E6F0+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_40E8A9:				; CODE XREF: sub_40E6F0+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_0 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_40E6F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40E8D0(char *, char *, int)
sub_40E8D0	proc near		; CODE XREF: sub_4037F6+2Ap
					; sub_4039C6+24p ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40E936
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_40E920:				; CODE XREF: sub_40E8D0+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_40E920
		add	edx, edx

loc_40E936:				; CODE XREF: sub_40E8D0+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40E95D
		xor	edi, edi

loc_40E947:				; CODE XREF: sub_40E8D0+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_40E947
		add	edx, edx

loc_40E95D:				; CODE XREF: sub_40E8D0+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_40E6F0
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_40E8D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40E9A0(FILE *)
sub_40E9A0	proc near		; CODE XREF: .text:0040EEABp

File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	[esp+2Ch+var_C], ebx
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_8], esi
		mov	[esp+2Ch+var_4], edi
		mov	eax, [ebx+0Ch]
		mov	edx, eax
		and	edx, 3
		cmp	edx, 2
		jz	short loc_40E9E0

loc_40E9C0:				; CODE XREF: sub_40E9A0+94j
					; sub_40E9A0+9Cj
		mov	edi, [ebx+8]
		xor	eax, eax

loc_40E9C5:				; CODE XREF: sub_40E9A0+A7j
					; sub_40E9A0+BCj
		mov	[ebx], edi
		mov	esi, [esp+2Ch+var_8]
		mov	dword ptr [ebx+4], 0
		mov	edi, [esp+2Ch+var_4]
		mov	ebx, [esp+2Ch+var_C]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40E9E0:				; CODE XREF: sub_40E9A0+1Ej
		test	eax, 108h
		mov	edi, [ebx+8]
		jz	short loc_40EA45
		mov	esi, [ebx]
		sub	esi, edi
		mov	eax, esi
		sar	eax, 1Fh
		mov	[esp+2Ch+var_10], eax
		cmp	[esp+2Ch+var_10], 0
		mov	[esp+2Ch+var_14], esi
		jl	short loc_40EA45
		jle	short loc_40EA40

loc_40EA04:				; CODE XREF: sub_40E9A0+A3j
		mov	[esp+2Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+2Ch+var_24], esi
		mov	[esp+2Ch+var_28], edi
		mov	[esp+2Ch+File],	eax
		call	_write
		mov	ecx, eax
		mov	edx, eax
		mov	eax, [esp+2Ch+var_10]
		sar	edx, 1Fh
		xor	esi, ecx
		xor	eax, edx
		or	eax, esi
		jnz	short loc_40EA50
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jz	short loc_40E9C0
		and	eax, 0FFFFFFFDh
		mov	[ebx+0Ch], eax
		jmp	short loc_40E9C0
; ---------------------------------------------------------------------------
		align 10h

loc_40EA40:				; CODE XREF: sub_40E9A0+62j
		cmp	esi, 0
		ja	short loc_40EA04

loc_40EA45:				; CODE XREF: sub_40E9A0+48j
					; sub_40E9A0+60j
		xor	eax, eax
		jmp	loc_40E9C5
; ---------------------------------------------------------------------------
		align 10h

loc_40EA50:				; CODE XREF: sub_40E9A0+8Dj
		or	dword ptr [ebx+0Ch], 20h
		mov	eax, 0FFFFFFFFh
		mov	edi, [ebx+8]
		jmp	loc_40E9C5
sub_40E9A0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_40EA70
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40EA70(FILE *, int, int, int)
sub_40EA70	proc near		; CODE XREF: .text:00407312p
					; .text:0040EA61j

File		= dword	ptr -3Ch
Pos		= dword	ptr -38h
var_24		= qword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 3Ch
		mov	eax, [esp+3Ch+arg_C]
		mov	[esp+3Ch+var_C], esi
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+var_8], edi
		mov	edi, [esp+3Ch+arg_8]
		mov	[esp+3Ch+var_4], ebp
		mov	ebp, [esp+3Ch+arg_0]
		cmp	eax, 1
		mov	[esp+3Ch+var_10], ebx
		jz	short loc_40EAD0
		cmp	eax, 2
		jz	short loc_40EAF5
		test	eax, eax
		jnz	short loc_40EB20
		mov	dword ptr [esp+3Ch+var_24], esi
		lea	ebx, [esp+3Ch+var_24]
		mov	dword ptr [esp+3Ch+var_24+4], edi

loc_40EAAD:				; CODE XREF: sub_40EA70+83j
					; sub_40EA70+ADj
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fsetpos

loc_40EAB9:				; CODE XREF: sub_40EA70+79j
					; sub_40EA70+C0j
		mov	ebx, [esp+3Ch+var_10]
		mov	esi, [esp+3Ch+var_C]
		mov	edi, [esp+3Ch+var_8]
		mov	ebp, [esp+3Ch+var_4]
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40EAD0:				; CODE XREF: sub_40EA70+26j
		lea	ebx, [esp+3Ch+var_24]
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fgetpos
		mov	edx, eax
		mov	eax, 0FFFFFFFFh
		test	edx, edx
		jnz	short loc_40EAB9
		add	dword ptr [esp+3Ch+var_24], esi
		adc	dword ptr [esp+3Ch+var_24+4], edi
		jmp	short loc_40EAAD
; ---------------------------------------------------------------------------

loc_40EAF5:				; CODE XREF: sub_40EA70+2Bj
		mov	[esp+3Ch+File],	ebp ; File
		lea	ebx, [esp+3Ch+var_24]
		call	fflush
		mov	[esp+3Ch+File],	ebp ; File
		call	_fileno_0
		mov	[esp+3Ch+File],	eax
		call	_filelengthi64
		add	eax, esi
		adc	edx, edi
		mov	dword ptr [esp+3Ch+var_24], eax
		mov	dword ptr [esp+3Ch+var_24+4], edx
		jmp	short loc_40EAAD
; ---------------------------------------------------------------------------
		align 10h

loc_40EB20:				; CODE XREF: sub_40EA70+2Fj
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40EAB9
sub_40EA70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40EB40(FILE *)
sub_40EB40	proc near		; CODE XREF: .text:0040EF14p

File		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 5Ch
		mov	[esp+5Ch+var_10], ebx
		mov	ebx, [esp+5Ch+arg_0]
		mov	[esp+5Ch+var_C], esi
		mov	[esp+5Ch+var_8], edi
		mov	[esp+5Ch+var_4], ebp
		call	_errno
		mov	dword ptr [eax], 0
		mov	[esp+5Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+5Ch+var_3C], eax
		mov	eax, [ebx+4]
		test	eax, eax
		js	loc_40ED00

loc_40EB79:				; CODE XREF: sub_40EB40+1C7j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_50], 1
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		test	edx, edx
		mov	esi, eax
		mov	edi, edx
		js	loc_40ED24
		mov	ecx, [ebx+0Ch]
		test	ecx, 108h
		jz	loc_40ECD4
		mov	eax, [ebx]
		mov	[esp+5Ch+var_34], eax
		mov	eax, [ebx+8]
		mov	edx, [esp+5Ch+var_34]
		sub	edx, eax
		test	cl, 3
		mov	[esp+5Ch+var_28], edx
		jnz	loc_40EC65
		test	cl, 80h
		jz	loc_40EE20
		mov	ebp, [esp+5Ch+var_28]

loc_40EBE1:				; CODE XREF: sub_40EB40+156j
					; sub_40EB40+160j ...
		mov	eax, edi
		or	eax, esi
		jz	loc_40ED10
		and	ecx, 1
		jz	loc_40ED16
		mov	eax, [ebx+4]
		xor	edx, edx
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], 0
		mov	[esp+5Ch+var_30], 0
		test	eax, eax
		jz	short loc_40EC58
		mov	ecx, [esp+5Ch+var_28]
		mov	edx, [esp+5Ch+var_3C]
		add	ecx, eax
		mov	eax, [esp+5Ch+var_3C]
		sar	edx, 5
		mov	[esp+5Ch+var_28], edx
		and	eax, 1Fh
		lea	eax, [eax+eax*4]
		shl	eax, 3
		mov	[esp+5Ch+var_34], eax
		mov	eax, ds:__pioinfo
		mov	eax, [eax+edx*4]
		mov	edx, [esp+5Ch+var_34]
		cmp	byte ptr [eax+edx+4], 0
		js	loc_40ED30

loc_40EC48:				; CODE XREF: sub_40EB40+255j
		mov	[esp+5Ch+var_34], ecx
		mov	edx, ebp
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0

loc_40EC58:				; CODE XREF: sub_40EB40+CDj
					; sub_40EB40+26Ej ...
		sub	esi, [esp+5Ch+var_34]
		sbb	edi, [esp+5Ch+var_30]
		jmp	loc_40ED1A
; ---------------------------------------------------------------------------

loc_40EC65:				; CODE XREF: sub_40EB40+8Ej
		mov	edx, [esp+5Ch+var_3C]
		mov	ebp, [esp+5Ch+var_3C]
		and	edx, 1Fh
		lea	edx, [edx+edx*4]
		shl	edx, 3
		mov	[esp+5Ch+var_24], edx
		mov	edx, ds:__pioinfo
		sar	ebp, 5
		mov	edx, [edx+ebp*4]
		add	[esp+5Ch+var_24], edx
		mov	edx, [esp+5Ch+var_24]
		mov	ebp, [esp+5Ch+var_28]
		cmp	byte ptr [edx+4], 0
		jns	loc_40EBE1
		cmp	[esp+5Ch+var_34], eax
		jbe	loc_40EBE1
		mov	[esp+5Ch+var_24], esi
		mov	esi, ecx
		mov	ecx, [esp+5Ch+var_34]
		mov	[esp+5Ch+var_20], edi

loc_40ECB4:				; CODE XREF: sub_40EB40+183j
		xor	edx, edx
		cmp	byte ptr [eax],	0Ah
		setz	dl
		add	eax, 1
		add	ebp, edx
		cmp	eax, ecx
		jnz	short loc_40ECB4
		mov	ecx, esi
		mov	edi, [esp+5Ch+var_20]
		mov	esi, [esp+5Ch+var_24]
		jmp	loc_40EBE1
; ---------------------------------------------------------------------------

loc_40ECD4:				; CODE XREF: sub_40EB40+72j
		mov	eax, [ebx+4]
		mov	ecx, esi
		mov	ebx, edi
		mov	edx, eax
		sar	edx, 1Fh
		sub	ecx, eax
		sbb	ebx, edx
		mov	eax, ecx
		mov	edx, ebx

loc_40ECE8:				; CODE XREF: sub_40EB40+1D4j
					; sub_40EB40+1E2j ...
		mov	ebx, [esp+5Ch+var_10]
		mov	esi, [esp+5Ch+var_C]
		mov	edi, [esp+5Ch+var_8]
		mov	ebp, [esp+5Ch+var_4]
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40ED00:				; CODE XREF: sub_40EB40+33j
		mov	dword ptr [ebx+4], 0
		jmp	loc_40EB79
; ---------------------------------------------------------------------------
		align 10h

loc_40ED10:				; CODE XREF: sub_40EB40+A5j
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_40ECE8
; ---------------------------------------------------------------------------

loc_40ED16:				; CODE XREF: sub_40EB40+AEj
		mov	edx, ebp
		xor	ecx, ecx

loc_40ED1A:				; CODE XREF: sub_40EB40+120j
		mov	eax, edx
		mov	edx, ecx
		add	eax, esi
		adc	edx, edi
		jmp	short loc_40ECE8
; ---------------------------------------------------------------------------

loc_40ED24:				; CODE XREF: sub_40EB40+63j
		mov	eax, 0FFFFFFFFh
		mov	edx, 0FFFFFFFFh
		jmp	short loc_40ECE8
; ---------------------------------------------------------------------------

loc_40ED30:				; CODE XREF: sub_40EB40+102j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 2
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		xor	edx, edi
		xor	eax, esi
		or	edx, eax
		jnz	short loc_40EDB3
		mov	edx, [ebx+8]
		lea	eax, [edx+ecx]
		cmp	edx, eax
		jnb	short loc_40ED91
		mov	[esp+5Ch+var_3C], esi
		mov	esi, eax
		mov	[esp+5Ch+var_38], edi

loc_40ED78:				; CODE XREF: sub_40EB40+247j
		xor	eax, eax
		cmp	byte ptr [edx],	0Ah
		setz	al
		add	edx, 1
		add	ecx, eax
		cmp	edx, esi
		jnz	short loc_40ED78
		mov	esi, [esp+5Ch+var_3C]
		mov	edi, [esp+5Ch+var_38]

loc_40ED91:				; CODE XREF: sub_40EB40+22Cj
		test	byte ptr [ebx+0Dh], 20h
		jz	loc_40EC48
		lea	eax, [ecx+1]
		mov	edx, ebp
		mov	[esp+5Ch+var_34], eax
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0
		jmp	loc_40EC58
; ---------------------------------------------------------------------------

loc_40EDB3:				; CODE XREF: sub_40EB40+222j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 0
		mov	[esp+5Ch+var_58], esi
		mov	[esp+5Ch+var_54], edi
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		cmp	ecx, 200h
		ja	short loc_40EDF1
		mov	eax, [ebx+0Ch]
		mov	edx, 200h
		and	eax, 408h
		cmp	eax, 8
		jz	short loc_40EDF4

loc_40EDF1:				; CODE XREF: sub_40EB40+29Dj
		mov	edx, [ebx+18h]

loc_40EDF4:				; CODE XREF: sub_40EB40+2AFj
		mov	eax, ds:__pioinfo
		mov	ecx, [esp+5Ch+var_28]
		mov	ebx, [esp+5Ch+var_34]
		mov	eax, [eax+ecx*4]
		test	byte ptr [eax+ebx+4], 4
		jnz	short loc_40EE3A
		mov	[esp+5Ch+var_34], edx
		xor	ecx, ecx
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_40EC58
; ---------------------------------------------------------------------------

loc_40EE20:				; CODE XREF: sub_40EB40+97j
		call	_errno
		mov	edx, 0FFFFFFFFh
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_40ECE8
; ---------------------------------------------------------------------------

loc_40EE3A:				; CODE XREF: sub_40EB40+2C9j
		lea	eax, [edx+1]
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], eax
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_40EC58
sub_40EB40	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 2Ch
		mov	[esp+1Ch], ebx
		mov	ebx, [esp+30h]
		mov	[esp+20h], esi
		mov	esi, [esp+3Ch]
		mov	[esp+24h], edi
		mov	edi, [esp+34h]
		mov	[esp+28h], ebp
		mov	ebp, [esp+38h]
		call	_errno
		cmp	esi, 2
		mov	dword ptr [eax], 0
		ja	loc_40EF25
		test	ebx, ebx
		jz	loc_40EF25
		and	dword ptr [ebx+0Ch], 0FFFFFFEFh
		cmp	esi, 1
		jz	short loc_40EF11

loc_40EEA8:				; CODE XREF: .text:0040EF20j
		mov	[esp], ebx
		call	sub_40E9A0
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jnz	short loc_40EF00
		and	eax, 409h
		cmp	eax, 9
		jz	short loc_40EF08

loc_40EEC1:				; CODE XREF: .text:0040EF06j
					; .text:0040EF0Fj
		mov	[esp], ebx
		call	_fileno_0
		mov	[esp+0Ch], esi
		mov	[esp+4], edi
		mov	[esp+8], ebp
		mov	[esp], eax
		call	_lseeki64
		and	eax, edx
		not	eax
		cmp	eax, 1
		sbb	eax, eax

loc_40EEE6:				; CODE XREF: .text:0040EF35j
		mov	ebx, [esp+1Ch]
		mov	esi, [esp+20h]
		mov	edi, [esp+24h]
		mov	ebp, [esp+28h]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40EF00:				; CODE XREF: .text:0040EEB5j
		and	eax, 0FFFFFFFCh
		mov	[ebx+0Ch], eax
		jmp	short loc_40EEC1
; ---------------------------------------------------------------------------

loc_40EF08:				; CODE XREF: .text:0040EEBFj
		mov	dword ptr [ebx+18h], 200h
		jmp	short loc_40EEC1
; ---------------------------------------------------------------------------

loc_40EF11:				; CODE XREF: .text:0040EEA6j
		mov	[esp], ebx
		call	sub_40EB40
		add	edi, eax
		adc	ebp, edx
		xor	si, si
		jmp	loc_40EEA8
; ---------------------------------------------------------------------------

loc_40EF25:				; CODE XREF: .text:0040EE91j
					; .text:0040EE99j
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40EEE6
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 4
		mov	esi, [esp+10h]
		call	__doserrno
		mov	[eax], esi
		jmp	short loc_40EF61
; ---------------------------------------------------------------------------

loc_40EF54:				; CODE XREF: .text:0040EF68j
		add	ebx, 1
		cmp	ds:dword_413304[ebx*8],	0FFFFFFFFh
		jz	short loc_40EF80

loc_40EF61:				; CODE XREF: .text:0040EF52j
		cmp	ds:dword_413300[ebx*8],	esi
		jnz	short loc_40EF54
		call	_errno
		mov	edx, ds:dword_413304[ebx*8]
		mov	[eax], edx
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40EF80:				; CODE XREF: .text:0040EF5Fj
		lea	eax, [esi-13h]
		cmp	eax, 11h
		jbe	short loc_40EFB5
		sub	esi, 0BCh
		cmp	esi, 0Eh
		jbe	short loc_40EFA4
		call	_errno
		mov	dword ptr [eax], 16h
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_40EFA4:				; CODE XREF: .text:0040EF91j
		call	_errno
		mov	dword ptr [eax], 8
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_40EFB5:				; CODE XREF: .text:0040EF86j
		call	_errno
		mov	dword ptr [eax], 0Dh
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40EFD0	proc near		; CODE XREF: sub_4098BA+9Cp
		jmp	sub_40EFF0
sub_40EFD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40EFE0	proc near		; CODE XREF: sub_4098BA+AAp
		jmp	sub_40F000
sub_40EFE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40EFF0	proc near		; CODE XREF: sub_40EFD0j
		mov	eax, ds:time
		jmp	eax
sub_40EFF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40F000	proc near		; CODE XREF: sub_40EFE0j
		mov	eax, ds:localtime
		jmp	eax
sub_40F000	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _errno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fgets]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sscanf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strspn]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION remove]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION clearerr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fileno_0]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _write]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fsetpos]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fgetpos]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _filelengthi64]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lseeki64]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __doserrno]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F1E0	proc near		; DATA XREF: .text:0040F204o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_40CB80
		leave
		retn
sub_40F1E0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_40F200	dd 0FFFFFFFFh		; DATA XREF: sub_40D7A0-4Cr
					; sub_40D7A0:loc_40D763r ...
		dd offset sub_40F1E0
		dd 0
		dd 0FFFFFFFFh
dword_40F210	dd 7Ch dup(0)		; DATA XREF: .data:off_410014o
		dd 300h	dup(?)
_text		ends

; Section 2. (virtual address 00010000)
; Virtual size			: 00000048 (	 72.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000E800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 410000h
dword_410000	dd 0FFFFFFFFh		; DATA XREF: sub_409499:loc_40961Fw
					; .text:loc_409853r ...
; char off_410004[]
off_410004	dd offset aIso88591	; DATA XREF: sub_409E74+D9w
					; .text:loc_40A148w ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_410014	dd offset dword_40F210	; DATA XREF: sub_40D720+3r
					; sub_40D720+12r ...
dword_410018	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_41001C	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_410020	dd 3Fh			; DATA XREF: sub_40DD30:loc_40DE87w
					; sub_40DD30+1F8w ...
dword_410024	dd 1			; DATA XREF: sub_401CDA+1E2r
					; sub_401CDA+1F1r ...
dword_410028	dd 1			; DATA XREF: sub_40DD30+12Cr
					; sub_40DD30+1C3r ...
dword_41002C	dd 0FFFFFFFFh		; DATA XREF: sub_40E080:loc_40E0ADr
					; sub_40E080:loc_40E0DAr ...
dword_410030	dd 0FFFFFFFFh		; DATA XREF: sub_40E080+83w
					; sub_40E080+D1r ...
dword_410034	dd 0FFFFFFFFh		; DATA XREF: sub_40E080+8Dw
					; sub_40E080+C2r ...
; char *off_410038
off_410038	dd offset byte_4131B5	; DATA XREF: sub_40DD30+Br
					; sub_40E080+A6w ...
dword_41003C	dd 0BB40E64Eh		; DATA XREF: sub_40D7C0+3r
					; sub_40D7C0:loc_40D872w ...
dword_410040	dd 44BF19B1h		; DATA XREF: sub_40D7C0+31w
					; sub_40D7C0+B8w ...
dword_410044	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00011000)
; Virtual size			: 00002480 (   9344.)
; Section size in file		: 00002600 (   9728.)
; Offset to raw	data for section: 0000EA00
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 411000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
; char Format[]
Format		db 'gpgkeys: unknown address family for `%s',27h,0Ah,0
					; DATA XREF: sub_4015C8+A4o
		align 10h
; char aGpgkeysIllegal[]
aGpgkeysIllegal	db 'gpgkeys: illegal address length for `%s',27h,0Ah,0
					; DATA XREF: sub_4015C8+D8o
		align 4
; char aGpgkeysHostSNo[]
aGpgkeysHostSNo	db 'gpgkeys: host `%s',27h,' not found: ec=%d',0Ah,0
					; DATA XREF: sub_4015C8+132o
		align 4
; char aGpgkeysErrorCr[]
aGpgkeysErrorCr	db 'gpgkeys: error creating socket: ec=%d',0Ah,0
					; DATA XREF: sub_4015C8+18Fo
		align 4
; char aGpgkeysErrorCo[]
aGpgkeysErrorCo	db 'gpgkeys: error connecting `%s',27h,': ec=%d',0Ah,0
					; DATA XREF: sub_4015C8+1DBo
; char aGpgkeysWriteFa[]
aGpgkeysWriteFa	db 'gpgkeys: write failed: ec=%d',0Ah,0 ; DATA XREF: sub_4017E1+44o
aGpgkeysOutOfMe	db 'gpgkeys: out of memory',0Ah,0 ; DATA XREF: sub_401860+2Ao
		align 4
aGpgkeysNoNameI	db 'gpgkeys: no name included in request',0Ah,0 ; DATA XREF: sub_401860+77o
; char asc_411172[]
asc_411172	db 0Dh,0Ah,0		; DATA XREF: sub_401860+129o
a0x		db '0x',0               ; DATA XREF: sub_4019DF+1Bo
; char aKey0xSBegin[]
aKey0xSBegin	db 'KEY 0x%s BEGIN',0Ah,0 ; DATA XREF: sub_4019DF:loc_401A21o
; char aKey0xSFailedD[]
aKey0xSFailedD	db 'KEY 0x%s FAILED %d',0Ah,0 ; DATA XREF: sub_4019DF+7Fo
					; sub_4019DF+DDo ...
; char aR[]
aR		db 'r',0                ; DATA XREF: sub_4019DF+C0o
					; sub_401CDA+1ECo
		align 10h
aEndPgpPublicKe	db '-----END PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: sub_4019DF+142o
		align 4
aBeginPgpPublic	db '-----BEGIN PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: sub_4019DF+16Co
; char aKey0xSEnd[]
aKey0xSEnd	db 'KEY 0x%s END',0Ah,0 ; DATA XREF: sub_4019DF+1DBo
		align 4
; char aGpgkeysNoKeyDa[]
aGpgkeysNoKeyDa	db 'gpgkeys: no key data found for finger:%s',0Ah,0
					; DATA XREF: sub_4019DF+202o
aHHelpHelp	db '-h, --help',9,'help',0Ah,0 ; DATA XREF: sub_401C42+6o
aVMachineReadab	db '-V',9,9,'machine readable version',0Ah,0 ; DATA XREF: sub_401C42+2Ao
		align 4
aVersionHumanRe	db '--version',9,'human readable version',0Ah,0 ; DATA XREF: sub_401C42+4Eo
aOOutputToThisF	db '-o',9,9,'output to this file',0Ah,0 ; DATA XREF: sub_401C42+72o
aVersion	db '--version',0        ; DATA XREF: sub_401CDA+47o
		align 4
aGpgkeys_finger	db 'gpgkeys_finger (GnuPG) 2.0.30',0Ah,0 ; DATA XREF: sub_401CDA+72o
aHelp		db '--help',0           ; DATA XREF: sub_401CDA+B1o
; char aDS[]
aDS		db '%d',0Ah             ; DATA XREF: sub_401CDA:loc_401DF4o
		db '%s',0Ah,0
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_401CDA+128o
					; sub_401CDA+51Eo
; char Mode[]
Mode		db 'w',0                ; DATA XREF: sub_401CDA:loc_401E28o
		align 4
; char aGpgkeysCannotO[]
aGpgkeysCannotO	db 'gpgkeys: Cannot open output file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_401CDA+189o
aHvo		db 'hVo:',0             ; DATA XREF: sub_401CDA:loc_401E8Do
; char aGpgkeysCanno_0[]
aGpgkeysCanno_0	db 'gpgkeys: Cannot open input file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_401CDA+237o
		align 10h
aGpgkeysFingerR	db 'gpgkeys: finger://relay/user syntax is not supported.  Use finger'
					; DATA XREF: sub_401CDA+329o
		db ':user instead.',0Ah,0
		align 4
aGpgkeysUnableT	db 'gpgkeys: unable to register timeout handler',0Ah,0
					; DATA XREF: sub_401CDA+376o
		align 4
aGpgkeysOutOf_0	db 'gpgkeys: out of memory while building key list',0Ah,0
					; DATA XREF: sub_401CDA+420o
aGpgkeysThisKey	db 'gpgkeys: this keyserver type only supports key retrieval',0Ah,0
					; DATA XREF: sub_401CDA+498o
		align 10h
aGpgkeysInvalid	db 'gpgkeys: invalid keyserver instructions',0Ah,0
					; DATA XREF: sub_401CDA+4D0o
; char aVersionD[]
aVersionD	db 'VERSION %d',0Ah,0   ; DATA XREF: sub_401CDA:loc_4021D0o
; char aProgramS[]
aProgramS	db 'PROGRAM %s',0Ah     ; DATA XREF: sub_401CDA+514o
		db 0Ah,0
; char aUserS[]
aUserS		db 'User:',9,9,'%s',0Ah,0 ; DATA XREF: sub_401CDA+547o
aCommandGet	db 'Command:',9,'GET',0Ah,0 ; DATA XREF: sub_401CDA+567o
		align 4
; char Src[]
Src		db '/',0                ; DATA XREF: sub_4023B0+5Do
; char aCommand7s[]
aCommand7s	db 'COMMAND %7s',0Ah,0  ; DATA XREF: sub_4024BD:loc_4024DAo
; char Str2[]
Str2		db 'get',0              ; DATA XREF: sub_4024BD+45o
; char aGetname[]
aGetname	db 'getname',0          ; DATA XREF: sub_4024BD:loc_402526o
; char aSend[]
aSend		db 'send',0             ; DATA XREF: sub_4024BD:loc_40254Ao
; char aSearch[]
aSearch		db 'search',0           ; DATA XREF: sub_4024BD:loc_40256Eo
; char aHost80s[]
aHost80s	db 'HOST %80s',0Ah,0    ; DATA XREF: sub_4024BD:loc_40259Ao
; char aPort10s[]
aPort10s	db 'PORT %10s',0Ah,0    ; DATA XREF: sub_4024BD:loc_4025FDo
; char aScheme20s[]
aScheme20s	db 'SCHEME %20s',0Ah,0  ; DATA XREF: sub_4024BD:loc_402660o
; char aAuth128s[]
aAuth128s	db 'AUTH %128s',0Ah,0   ; DATA XREF: sub_4024BD:loc_4026C9o
; char aPath1024s[]
aPath1024s	db 'PATH %1024s',0Ah,0  ; DATA XREF: sub_4024BD:loc_402735o
; char aOpaque1024s[]
aOpaque1024s	db 'OPAQUE %1024s',0Ah,0 ; DATA XREF: sub_4024BD:loc_4027A1o
; char aVersionD_0[]
aVersionD_0	db 'VERSION %d',0Ah,0   ; DATA XREF: sub_4024BD:loc_40280Do
; char aOption256[]
aOption256	db 'OPTION %256[^',0Ah  ; DATA XREF: sub_4024BD:loc_402849o
		db ']',0Ah,0
; char Str[]
Str		db 'no-',0              ; DATA XREF: sub_4024BD+3D2o
; char aVerbose[]
aVerbose	db 'verbose',0          ; DATA XREF: sub_4024BD+409o
; char aIncludeDisable[]
aIncludeDisable	db 'include-disabled',0 ; DATA XREF: sub_4024BD:loc_402930o
; char aIncludeRevoked[]
aIncludeRevoked	db 'include-revoked',0  ; DATA XREF: sub_4024BD:loc_402973o
; char aIncludeSubkeys[]
aIncludeSubkeys	db 'include-subkeys',0  ; DATA XREF: sub_4024BD:loc_4029B6o
; char aCheckCert[]
aCheckCert	db 'check-cert',0       ; DATA XREF: sub_4024BD:loc_4029F9o
; char aDebug[]
aDebug		db 'debug',0            ; DATA XREF: sub_4024BD+587o
; char aTimeout[]
aTimeout	db 'timeout',0          ; DATA XREF: sub_4024BD+605o
; char aCaCertFile[]
aCaCertFile	db 'ca-cert-file',0     ; DATA XREF: sub_4024BD+683o
aUnknown	db 'UNKNOWN',0          ; DATA XREF: .text:loc_402BE0o
aGet_0		db 'GET',0              ; DATA XREF: .text:loc_402BE7o
aGetname_0	db 'GETNAME',0          ; DATA XREF: .text:loc_402BEEo
aSend_0		db 'SEND',0             ; DATA XREF: .text:loc_402BF5o
aSearch_0	db 'SEARCH',0           ; DATA XREF: .text:loc_402BFCo
a?		db '?',0                ; DATA XREF: .text:loc_402C03o
off_411590	dd offset loc_402BE0	; DATA XREF: .text:00402BD7o
		dd offset loc_402BE7	; jump table for switch	statement
		dd offset loc_402BEE
		dd offset loc_402BF5
		dd offset loc_402BFC
aAbcdefabcdef12	db 'abcdefABCDEF1234567890x',0 ; DATA XREF: .text:00402D05o
					; .text:00402D59o
off_4115BC	dd offset loc_402C6B	; DATA XREF: .text:00402C62r
		dd offset loc_402D82	; jump table for switch	statement
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402CC7
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402C99
		dd offset loc_402C82
		dd offset loc_402D82
		dd offset loc_402D82
		dd offset loc_402CB0
byte_411618	db 41h			; DATA XREF: sub_402DCC+7Er
					; sub_402DCC+C1r ...
aBcdefghijklmno	db 'BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',0
		align 4
aBeginPgpPubl_0	db '-----BEGIN PGP PUBLIC KEY BLOCK-----',0Ah ; DATA XREF: .text:00402FB0o
		db 0Ah,0
		align 4
aBeginPgpPubl_1	db '-----BEGIN PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: .text:00402FD6o
					; .text:004030AAo
		align 4
aEndPgpPublic_0	db '-----END PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: .text:00403093o
		align 10h
aEndPgpPublic_1	db 0Ah			; DATA XREF: .text:004032B2o
		db '-----END PGP PUBLIC KEY BLOCK-----',0
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating enough memory: %s',0Ah,0 ; DATA XREF: sub_4034B8+17o
; char a____Gnupg22_0_[]
a____Gnupg22_0_	db '../../gnupg2-2.0.30/common/iobuf.c',0 ; DATA XREF: sub_4037F6+1Bo
					; sub_4039C6+15o ...
; char aFname[]
aFname		db 'fname',0            ; DATA XREF: sub_4037F6+23o
					; sub_403B2B+1Co
; char aFd_cache_inval[]
aFd_cache_inval	db 'fd_cache_invalidate (%s)',0Ah,0 ; DATA XREF: sub_4037F6+3Fo
; char aDidS[]
aDidS		db '                did (%s)',0Ah,0 ; DATA XREF: sub_4037F6+8Co
; char aFp[]
aFp		db 'fp',0               ; DATA XREF: sub_4039C6+1Do
; char aFd_cache_close[]
aFd_cache_close	db 'fd_cache_close (%d) real',0Ah,0 ; DATA XREF: sub_4039C6+5Do
		align 4
; char aFd_cache_clo_0[]
aFd_cache_clo_0	db 'fd_cache_close (%s) used existing slot',0Ah,0
					; DATA XREF: sub_4039C6+B9o
; char aFd_cache_clo_1[]
aFd_cache_clo_1	db 'fd_cache_close (%s) new slot created',0Ah,0 ; DATA XREF: sub_4039C6+E8o
		align 4
; char aFd_cache_openS[]
aFd_cache_openS	db 'fd_cache_open (%s) using cached fp',0Ah,0 ; DATA XREF: sub_403B2B+84o
; char aRewindFileFail[]
aRewindFileFail	db 'rewind file failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: sub_403B2B+CFo
; char aFd_cache_ope_0[]
aFd_cache_ope_0	db 'fd_cache_open (%s) not cached',0Ah,0 ; DATA XREF: sub_403B2B+109o
; char aSize[]
aSize		db 'size',0             ; DATA XREF: sub_403C54+4Ao
					; sub_403F00+42o ...
; char aSReadErrorEcD[]
aSReadErrorEcD	db '%s: read error: ec=%d',0Ah,0 ; DATA XREF: sub_403C54+DCo
; char aSWriteErrorEcD[]
aSWriteErrorEcD	db '%s: write error: ec=%d',0Ah,0 ; DATA XREF: sub_403C54+197o
aFile_filterFd	db 'file_filter(fd)',0  ; DATA XREF: sub_403C54+205o
; char aSCloseHandleP[]
aSCloseHandleP	db '%s: close handle %p',0Ah,0 ; DATA XREF: sub_403C54+260o
; char aSocketReadErro[]
aSocketReadErro	db 'socket read error: ec=%d',0Ah,0 ; DATA XREF: sub_403F00+BDo
; char aSocketWriteErr[]
aSocketWriteErr	db 'socket write error: ec=%d',0Ah,0 ; DATA XREF: sub_403F00+167o
aSock_filter	db 'sock_filter',0      ; DATA XREF: sub_403F00+1CFo
		align 4
; char aBlock_filter1s[]
aBlock_filter1s	db 'block_filter: 1st length byte missing',0Ah,0
					; DATA XREF: sub_404109+141o
		align 4
; char aBlock_filter2n[]
aBlock_filter2n	db 'block_filter: 2nd length byte missing',0Ah,0
					; DATA XREF: sub_404109+229o
		align 4
; char aBlock_filterIn[]
aBlock_filterIn	db 'block_filter: invalid 4 byte length',0Ah,0 ; DATA XREF: sub_404109+452o
		align 4
; char aBlock_filterPR[]
aBlock_filterPR	db 'block_filter %p: read error (size=%lu,a->size=%lu)',0Ah,0
					; DATA XREF: sub_404109+551o
; char aABuflenOp_min_[]
aABuflenOp_min_	db 'a->buflen <= OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_404109+60Do
; char aC0x1f[]
aC0x1f		db 'c <= 0x1f',0        ; DATA XREF: sub_404109+6C3o
; char aNOp_min_partia[]
aNOp_min_partia	db 'n == OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_404109+710o
; char aABuflen[]
aABuflen	db '!a->buflen',0       ; DATA XREF: sub_404109+7E0o
; char aNbytesOp_min_p[]
aNbytesOp_min_p	db 'nbytes < OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_404109+805o
; char aInitBlock_filt[]
aInitBlock_filt	db 'init block_filter %p',0Ah,0 ; DATA XREF: sub_404109+88Fo
aBlock_filter_0	db 'block_filter',0     ; DATA XREF: sub_404109+90Bo
		align 4
; char aBlock_filterWr[]
aBlock_filterWr	db 'block_filter: write error: %s',0Ah,0 ; DATA XREF: sub_404109+AA1o
; char aBlock_filterPe[]
aBlock_filterPe	db 'block_filter: pending bytes!',0Ah,0 ; DATA XREF: sub_404109+AFFo
; char aFreeBlock_filt[]
aFreeBlock_filt	db 'free block_filter %p',0Ah,0 ; DATA XREF: sub_404109+B1Bo
aNone		db '[none]',0           ; DATA XREF: sub_404C44+22o
a?_0		db '?',0                ; DATA XREF: sub_404C44:loc_404CC8o
					; sub_404DAD:loc_404E7Co ...
; char aIobufChainD_DS[]
aIobufChainD_DS	db 'iobuf chain: %d.%d `%s',27h,' filter_eof=%d start=%d len=%d',0Ah,0
					; DATA XREF: sub_404C44+ADo
; char aIobuf_closeP[]
aIobuf_closeP	db 'iobuf_close -> %p',0Ah,0 ; DATA XREF: sub_404DAD+5Co
		align 4
; char aIobuf_flushFai[]
aIobuf_flushFai	db 'iobuf_flush failed on close: %s',0Ah,0 ; DATA XREF: sub_404DAD+A8o
; char aIobufD_DCloseS[]
aIobufD_DCloseS	db 'iobuf-%d.%d: close `%s',27h,0Ah,0 ; DATA XREF: sub_404DAD+ECo
		align 10h
; char aIobufctrl_free[]
aIobufctrl_free	db 'IOBUFCTRL_FREE failed on close: %s',0Ah,0 ; DATA XREF: sub_404DAD+14Co
aStdin		db '[stdin]',0          ; DATA XREF: sub_4051C5+46o
; char aRb[]
aRb		db 'rb',0               ; DATA XREF: sub_4051C5+7Do
					; sub_4051C5:loc_405257o
; char aIobufD_DOpenSF[]
aIobufD_DOpenSF	db 'iobuf-%d.%d: open `%s',27h,' fd=%d',0Ah,0 ; DATA XREF: sub_4051C5+1D3o
; char aFdD[]
aFdD		db '[fd %d]',0          ; DATA XREF: sub_4053AC+63o
; char aIobufD_DFdopen[]
aIobufD_DFdopen	db 'iobuf-%d.%d: fdopen `%s',27h,0Ah,0 ; DATA XREF: sub_4053AC+111o
; char aSockD[]
aSockD		db '[sock %d]',0        ; DATA XREF: sub_4054F1+5Do
; char aIobufD_DSockop[]
aIobufD_DSockop	db 'iobuf-%d.%d: sockopen `%s',27h,0Ah,0 ; DATA XREF: sub_4054F1+10Bo
aStdout		db '[stdout]',0         ; DATA XREF: .text:0040566Fo
aWb		db 'wb',0               ; DATA XREF: .text:004056A6o
					; .text:loc_4056BBo
aIobufD_DCreate	db 'iobuf-%d.%d: create `%s',27h,0Ah,0 ; DATA XREF: .text:00405805o
aRB		db 'r+b',0              ; DATA XREF: .text:loc_405830o
aIobufD_DOpenrw	db 'iobuf-%d.%d: openrw `%s',27h,0Ah,0 ; DATA XREF: .text:0040596Bo
		align 4
; char aIobufD_DIoctlS[]
aIobufD_DIoctlS	db 'iobuf-%d.%d: ioctl `%s',27h,' keep=%d',0Ah,0 ; DATA XREF: sub_405980+74o
		align 10h
; char aIobuf_IoctlSIn[]
aIobuf_IoctlSIn	db 'iobuf-*.*: ioctl `%s',27h,' invalidate',0Ah,0
					; DATA XREF: sub_405980+11Fo
		align 4
; char aIobufD_DIoct_0[]
aIobufD_DIoct_0	db 'iobuf-%d.%d: ioctl `%s',27h,' no_cache=%d',0Ah,0
					; DATA XREF: sub_405980+1D9o
aNull		db '<null>',0           ; DATA XREF: sub_405980:loc_405BF5o
; char aIobuf_IoctlSFs[]
aIobuf_IoctlSFs	db 'iobuf-*.*: ioctl `%s',27h,' fsync',0Ah,0 ; DATA XREF: sub_405980+27Eo
		align 10h
; char aIOFilterTooDee[]
aIOFilterTooDee	db 'i/o filter too deeply nested - corrupted data?',0Ah,0
					; DATA XREF: sub_405C5D+6Eo
; char aIobufD_DPushS[]
aIobufD_DPushS	db 'iobuf-%d.%d: push `%s',27h,0Ah,0 ; DATA XREF: sub_405C5D+2B9o
; char aIobufctrl_init[]
aIobufctrl_init	db 'IOBUFCTRL_INIT failed: %s',0Ah,0 ; DATA XREF: sub_405C5D+324o
; char aIobufD_DPopS[]
aIobufD_DPopS	db 'iobuf-%d.%d: pop `%s',27h,0Ah,0 ; DATA XREF: sub_405F98+75o
; char aB[]
aB		db 'b',0                ; DATA XREF: sub_405F98+AEo
; char aPop_filterFilt[]
aPop_filterFilt	db 'pop_filter(): filter function not found',0Ah,0
					; DATA XREF: sub_405F98+194o
		align 4
; char aIobuf_flushF_0[]
aIobuf_flushF_0	db 'iobuf_flush failed in pop_filter: %s',0Ah,0 ; DATA XREF: sub_405F98+1CDo
; char aIobufctrl_fr_0[]
aIobufctrl_fr_0	db 'IOBUFCTRL_FREE failed: %s',0Ah,0 ; DATA XREF: sub_405F98+235o
					; sub_40632F+39Co
		align 4
; char aCanTRemoveTheL[]
aCanTRemoveTheL	db 'can',27h,'t remove the last filter from the chain',0Ah,0
					; DATA XREF: sub_405F98+287o
; char aIobufD_DPopped[]
aIobufD_DPopped	db 'iobuf-%d.%d: popped filter',0Ah,0 ; DATA XREF: sub_405F98+35Co
		align 4
; char aOhhJeeeTryingT[]
aOhhJeeeTryingT	db 'Ohh jeee, trying to remove a head filter',0Ah,0
					; DATA XREF: sub_405F98+374o
		align 4
; char aOhhJeeeTryin_0[]
aOhhJeeeTryin_0	db 'Ohh jeee, trying to remove an intermediate filter',0Ah,0
					; DATA XREF: sub_405F98:loc_406318o
; char aAD_startAD_len[]
aAD_startAD_len	db 'a->d.start == a->d.len',0 ; DATA XREF: sub_40632F+29o
		align 10h
; char aIobufD_DPopSIn[]
aIobufD_DPopSIn	db 'iobuf-%d.%d: pop `%s',27h,' in underflow',0Ah,0
					; DATA XREF: sub_40632F+A6o
; char aIobufD_DUnderf[]
aIobufD_DUnderf	db 'iobuf-%d.%d: underflow: eof (due to filter eof)',0Ah,0
					; DATA XREF: sub_40632F+17Do
; char aIobufD_DError[]
aIobufD_DError	db 'iobuf-%d.%d: error',0Ah,0 ; DATA XREF: sub_40632F+1BAo
		align 4
; char aIobufD_DUnde_0[]
aIobufD_DUnde_0	db 'iobuf-%d.%d: underflow: req=%lu',0Ah,0 ; DATA XREF: sub_40632F+2B9o
		align 10h
; char aIobufD_DUnde_1[]
aIobufD_DUnde_1	db 'iobuf-%d.%d: underflow: got=%lu rc=%d',0Ah,0
					; DATA XREF: sub_40632F+327o
		align 4
; char aIobufD_DPopInU[]
aIobufD_DPopInU	db 'iobuf-%d.%d: pop in underflow (!len)',0Ah,0 ; DATA XREF: sub_40632F+43Bo
; char aIobufD_DUnde_2[]
aIobufD_DUnde_2	db 'iobuf-%d.%d: underflow: eof',0Ah,0 ; DATA XREF: sub_40632F+521o
		align 4
; char aIobufD_DUnde_3[]
aIobufD_DUnde_3	db 'iobuf-%d.%d: underflow: eof (no filter)',0Ah,0
					; DATA XREF: sub_40632F+584o
		align 4
; char aIncreasingTemp[]
aIncreasingTemp	db 'increasing temp iobuf from %lu to %lu',0Ah,0 ; DATA XREF: sub_4068CC+52o
; char aFlushOnNonOutp[]
aFlushOnNonOutp	db 'flush on non-output iobuf',0Ah,0 ; DATA XREF: sub_4068CC+C1o
; char aIobuf_flushNoF[]
aIobuf_flushNoF	db 'iobuf_flush: no filter',0Ah,0 ; DATA XREF: sub_4068CC+D7o
		align 4
; char aIobuf_flushDid[]
aIobuf_flushDid	db 'iobuf_flush did not write all!',0Ah,0 ; DATA XREF: sub_4068CC+136o
aAD_start1	db 'a->d.start == 1',0  ; DATA XREF: .text:00406D05o
; char aAD_lenAD_size[]
aAD_lenAD_size	db 'a->d.len < a->d.size',0 ; DATA XREF: sub_406D61+75o
aFstatFailedS	db 'fstat() failed: %s',0Ah,0 ; DATA XREF: .text:004070DCo
aKernel32_dll	db 'kernel32.dll',0     ; DATA XREF: .text:00407138o
aGetfilesizeex	db 'GetFileSizeEx',0    ; DATA XREF: .text:0040714Do
aGetfilesizeFor	db 'GetFileSize for handle %p failed: %s',0Ah,0 ; DATA XREF: .text:00407219o
aCanTSeekS	db 'can',27h,'t seek: %s',0Ah,0 ; DATA XREF: .text:00407330o
		align 10h
aSetfilepointer	db 'SetFilePointer failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: .text:004073DBo
		align 4
aPop_filterCall	db 'pop_filter called in iobuf_seek - please report',0Ah,0
					; DATA XREF: .text:0040745Bo
aAUse1AUse2	db 'a->use == 1 || a->use == 2',0 ; DATA XREF: .text:00407588o
aPop_filterCa_0	db 'pop_filter called in set_partial_block_mode - please report',0Ah,0
					; DATA XREF: .text:004075B1o
		align 4
; char aGetstdhandleDF[]
aGetstdhandleDF	db 'GetStdHandle(%d) failed: ec=%d',0Ah,0 ; DATA XREF: sub_4077F2+78o
aIobuf_write	db 'iobuf_write',0      ; DATA XREF: sub_406E06+16o
aIobuf_writebyt	db 'iobuf_writebyte',0  ; DATA XREF: sub_406D61+10o
aPop_filter	db 'pop_filter',0       ; DATA XREF: sub_405F98+21o
aIobuf_push_fil	db 'iobuf_push_filter2',0 ; DATA XREF: sub_405C5D+21o
aBlock_filter	db 'block_filter',0     ; DATA XREF: sub_404109:loc_4045DCo
					; sub_404109:loc_404962o ...
		align 10h
asc_412180	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:00407D96o
					; .text:00407E2Eo
a_		db '.',0                ; DATA XREF: .text:00407F1Bo
		align 4
a____Gnupg22__0	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_407F82+A0o
; char VarName[]
VarName		db 'HOME',0             ; DATA XREF: sub_407F82:loc_4080A3o
; char aX02x[]
aX02x		db 'x%02x',0            ; DATA XREF: sub_408537+164o
					; .text:00408A9Bo
word_4121BA	dw 0			; DATA XREF: .text:0040937Bo
					; .text:004093BAo
aFatalTooManyAr	db 0Ah			; DATA XREF: .text:00409404o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: .text:0040942Fo
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_407F82+90o
		align 4
asc_41220C	db '-',0                ; DATA XREF: sub_409499+55o
					; sub_4096F8:loc_409709o
aSocket		db 'socket://',0        ; DATA XREF: sub_409499+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_409499+FDo
; char aA[]
aA		db 'a',0                ; DATA XREF: sub_409499+131o
					; sub_409499:loc_409609o
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_409499+1B1o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_409499+1E9o
		align 4
; char a____Gnupg22__1[]
a____Gnupg22__1	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_4098BA+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_4098BA+37o
		align 4
; char a04d02d02d02d02[]
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_4098BA+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_4098BA+16Bo
; char aU[]
aU		db '[%u]',0             ; DATA XREF: sub_4098BA+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_4098BA+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_4098BA+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_4098BA+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_4098BA:loc_409B4Co
		align 4
off_41233C	dd offset loc_409B6B	; DATA XREF: sub_4098BA+20Eo
		dd offset loc_409B6B	; jump table for switch	statement
		dd offset loc_409B6B
		dd offset loc_409B6B
		dd offset loc_409B6B
		dd offset loc_409AD1
		dd offset loc_409AFA
		dd offset loc_409B23
dword_41235C	dd 207325h		; DATA XREF: .text:00409DC5o
a02x		db '%02X',0             ; DATA XREF: .text:00409DEAo
a02x_0		db ' %02X',0            ; DATA XREF: .text:00409E0Do
asc_41236B	db 0Ah,0		; DATA XREF: .text:00409E32o
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_409E40+1Bo
		align 4
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_409E74+D9o
					; .text:loc_40A148o ...
aUtf8		db 'utf-8',0            ; DATA XREF: sub_409E74+22o
					; .text:0040A182o ...
		align 10h
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_409E74+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_409E74+B1o
aCpU		db 'CP%u',0             ; DATA XREF: .text:loc_409F9Eo
aCp936		db 'CP936',0            ; DATA XREF: .text:00409FC1o
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: .text:0040A0AFo
a88591		db '8859-1',0           ; DATA XREF: .text:0040A0ECo
a646		db '646',0              ; DATA XREF: .text:0040A103o
aAscii		db 'ASCII',0            ; DATA XREF: .text:0040A11Ao
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: .text:0040A131o
aUtf8_0		db 'utf8',0             ; DATA XREF: .text:loc_40A16Bo
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_40A289+1EEo
					; sub_40A4D5+730o
; char aX02x_0[]
aX02x_0		db '\x%02x',0           ; DATA XREF: sub_40A4D5+7Co
					; sub_40A4D5+3AFo ...
; char aX02x_1[]
aX02x_1		db 'x%02x',0            ; DATA XREF: sub_40A4D5+1DCo
		align 4
a____Gnupg22__2	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_40A4D5+6BEo
		align 4
off_412584	dd offset loc_40A688	; DATA XREF: sub_40A4D5+12Ar
		dd offset loc_40A69E	; jump table for switch	statement
		dd offset loc_40A69E
		dd offset loc_40A69E
		dd offset loc_40A69E
		dd offset loc_40A69E
		dd offset loc_40A69E
		dd offset loc_40A69E
		dd offset loc_40A672
		dd offset loc_40A69E
		dd offset loc_40A608
		dd offset loc_40A65C
		dd offset loc_40A642
		dd offset loc_40A625
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_40A4D5+6AEo
		align 10h
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: sub_40AD30+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_40AD30:loc_40AD83o
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_40AD30:loc_40ADEEo
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_40AD30:loc_40ADF8o
aAm_et		db 'am_ET',0            ; DATA XREF: sub_40AD30:loc_40AE02o
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_40AD30:loc_40AE25o
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_40AD30:loc_40AE2Fo
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_40AD30:loc_40AE39o
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_40AD30:loc_40AE43o
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_40AD30:loc_40AE4Do
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_40AD30:loc_40AE57o
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_40AD30:loc_40AE61o
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_40AD30:loc_40AE6Bo
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_40AD30:loc_40AE75o
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_40AD30:loc_40AE7Fo
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_40AD30:loc_40AE89o
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_40AD30:loc_40AE93o
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_40AD30:loc_40AE9Do
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_40AD30:loc_40AEA7o
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_40AD30:loc_40AEB1o
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_40AD30:loc_40AEBBo
aAr		db 'ar',0               ; DATA XREF: sub_40AD30:loc_40AEC5o
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_40AD30:loc_40AECFo
aAs_in		db 'as_IN',0            ; DATA XREF: sub_40AD30:loc_40AED9o
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_40AD30:loc_40AEF2o
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_40AD30:loc_40AEFCo
aAz		db 'az',0               ; DATA XREF: sub_40AD30:loc_40AF06o
aEu		db 'eu',0               ; DATA XREF: sub_40AD30:loc_40AF10o
aBe_by		db 'be_BY',0            ; DATA XREF: sub_40AD30:loc_40AF1Ao
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_40AD30:loc_40AF33o
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_40AD30:loc_40AF3Do
aBn		db 'bn',0               ; DATA XREF: sub_40AD30:loc_40AF47o
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_40AD30:loc_40AF51o
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_40AD30:loc_40AF5Bo
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_40AD30:loc_40AF65o
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_40AD30:loc_40AF6Fo
aChr_us		db 'chr_US',0           ; DATA XREF: sub_40AD30:loc_40AF79o
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_40AD30:loc_40AF98o
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_40AD30:loc_40AFA2o
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_40AD30:loc_40AFACo
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_40AD30:loc_40AFB6o
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_40AD30:loc_40AFC0o
aZh		db 'zh',0               ; DATA XREF: sub_40AD30:loc_40AFCAo
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_40AD30+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_40AD30:loc_40AFF0o
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_40AD30:loc_40AFFAo
aHr		db 'hr',0               ; DATA XREF: sub_40AD30:loc_40B004o
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_40AD30:loc_40B00Eo
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_40AD30:loc_40B018o
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_40AD30:loc_40B022o
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_40AD30:loc_40B03Bo
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_40AD30:loc_40B045o
aNl		db 'nl',0               ; DATA XREF: sub_40AD30:loc_40B04Fo
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_40AD30:loc_40B059o
aEn_us		db 'en_US',0            ; DATA XREF: sub_40AD30:loc_40B07Co
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_40AD30:loc_40B086o
aEn_au		db 'en_AU',0            ; DATA XREF: sub_40AD30:loc_40B090o
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_40AD30:loc_40B09Ao
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_40AD30:loc_40B0A4o
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_40AD30:loc_40B0AEo
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_40AD30:loc_40B0B8o
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_40AD30:loc_40B0C2o
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_40AD30:loc_40B0CCo
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_40AD30:loc_40B0D6o
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_40AD30:loc_40B0E0o
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_40AD30:loc_40B0EAo
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_40AD30:loc_40B0F4o
aEn_id		db 'en_ID',0            ; DATA XREF: sub_40AD30:loc_40B0FEo
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_40AD30:loc_40B108o
aEn_in		db 'en_IN',0            ; DATA XREF: sub_40AD30:loc_40B112o
aEn_my		db 'en_MY',0            ; DATA XREF: sub_40AD30:loc_40B11Co
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_40AD30:loc_40B126o
aEn		db 'en',0               ; DATA XREF: sub_40AD30:loc_40B130o
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_40AD30:loc_40B13Ao
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_40AD30:loc_40B144o
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_40AD30:loc_40B14Eo
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_40AD30:loc_40B158o
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_40AD30:loc_40B17Bo
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_40AD30:loc_40B185o
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_40AD30:loc_40B18Fo
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_40AD30:loc_40B199o
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_40AD30:loc_40B1A3o
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_40AD30:loc_40B1ADo
aFr		db 'fr',0               ; DATA XREF: sub_40AD30:loc_40B1B7o
					; sub_40AD30:loc_40B211o
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_40AD30:loc_40B1C1o
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_40AD30:loc_40B1CBo
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_40AD30:loc_40B1D5o
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_40AD30:loc_40B1DFo
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_40AD30:loc_40B1E9o
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_40AD30:loc_40B1F3o
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_40AD30:loc_40B1FDo
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_40AD30:loc_40B207o
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_40AD30:loc_40B21Bo
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_40AD30:loc_40B225o
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_40AD30:loc_40B23Eo
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_40AD30:loc_40B248o
aC		db 'C',0                ; DATA XREF: sub_40AD30:loc_40B252o
					; sub_40AD30:loc_40B870o
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_40AD30:loc_40B25Co
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_40AD30:loc_40B266o
aDe_de		db 'de_DE',0            ; DATA XREF: sub_40AD30:loc_40B285o
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_40AD30:loc_40B28Fo
aDe_at		db 'de_AT',0            ; DATA XREF: sub_40AD30:loc_40B299o
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_40AD30:loc_40B2A3o
aDe_li		db 'de_LI',0            ; DATA XREF: sub_40AD30:loc_40B2ADo
aDe		db 'de',0               ; DATA XREF: sub_40AD30:loc_40B2B7o
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_40AD30:loc_40B2C1o
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_40AD30:loc_40B2CBo
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_40AD30:loc_40B2D5o
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_40AD30:loc_40B2DFo
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_40AD30:loc_40B2E9o
aHe_il		db 'he_IL',0            ; DATA XREF: sub_40AD30:loc_40B2F3o
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_40AD30:loc_40B2FDo
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_40AD30:loc_40B307o
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_40AD30:loc_40B311o
aIs_is		db 'is_IS',0            ; DATA XREF: sub_40AD30:loc_40B31Bo
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_40AD30:loc_40B325o
aId_id		db 'id_ID',0            ; DATA XREF: sub_40AD30:loc_40B32Fo
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_40AD30:loc_40B339o
aIt_it		db 'it_IT',0            ; DATA XREF: sub_40AD30:loc_40B352o
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_40AD30:loc_40B35Co
aIt		db 'it',0               ; DATA XREF: sub_40AD30:loc_40B366o
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_40AD30:loc_40B370o
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_40AD30:loc_40B37Ao
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_40AD30:loc_40B384o
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_40AD30:loc_40B39Do
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_40AD30:loc_40B3A7o
aKs		db 'ks',0               ; DATA XREF: sub_40AD30:loc_40B3B1o
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_40AD30:loc_40B3BBo
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_40AD30:loc_40B3C5o
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_40AD30:loc_40B3CFo
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_40AD30:loc_40B3D9o
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_40AD30:loc_40B3E3o
aLa_va		db 'la_VA',0            ; DATA XREF: sub_40AD30:loc_40B3EDo
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_40AD30:loc_40B3F7o
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_40AD30:loc_40B401o
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_40AD30:loc_40B40Bo
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_40AD30:loc_40B424o
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_40AD30:loc_40B42Eo
aMs		db 'ms',0               ; DATA XREF: sub_40AD30:loc_40B438o
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_40AD30:loc_40B442o
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_40AD30:loc_40B44Co
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_40AD30:loc_40B456o
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_40AD30:loc_40B460o
aMn		db 'mn',0               ; DATA XREF: sub_40AD30:loc_40B46Ao
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_40AD30:loc_40B483o
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_40AD30:loc_40B48Do
aNe		db 'ne',0               ; DATA XREF: sub_40AD30:loc_40B497o
aNo_no		db 'no_NO',0            ; DATA XREF: sub_40AD30:loc_40B4B0o
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_40AD30:loc_40B4BAo
aNo_0		db 'no',0               ; DATA XREF: sub_40AD30:loc_40B4C4o
aOr_in		db 'or_IN',0            ; DATA XREF: sub_40AD30:loc_40B4CEo
aOm_et		db 'om_ET',0            ; DATA XREF: sub_40AD30:loc_40B4D8o
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_40AD30:loc_40B4E2o
aPs		db 'ps',0               ; DATA XREF: sub_40AD30:loc_40B4ECo
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_40AD30:loc_40B4F6o
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_40AD30+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_40AD30:loc_40B517o
aPt		db 'pt',0               ; DATA XREF: sub_40AD30:loc_40B521o
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_40AD30+803o
aPa		db 'pa',0               ; DATA XREF: sub_40AD30:loc_40B53Do
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_40AD30:loc_40B547o
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_40AD30+829o
aRo		db 'ro',0               ; DATA XREF: sub_40AD30:loc_40B563o
aRu		db 'ru',0               ; DATA XREF: sub_40AD30:loc_40B56Do
aSe_no		db 'se_NO',0            ; DATA XREF: sub_40AD30:loc_40B577o
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_40AD30:loc_40B581o
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_40AD30:loc_40B599o
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_40AD30:loc_40B5A3o
aSd		db 'sd',0               ; DATA XREF: sub_40AD30:loc_40B5ADo
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_40AD30:loc_40B5B7o
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_40AD30:loc_40B5C1o
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_40AD30:loc_40B5CBo
aSo_so		db 'so_SO',0            ; DATA XREF: sub_40AD30:loc_40B5D5o
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_40AD30:loc_40B5DFo
aEs_es		db 'es_ES',0            ; DATA XREF: sub_40AD30:loc_40B602o
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_40AD30:loc_40B60Co
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_40AD30:loc_40B616o
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_40AD30:loc_40B620o
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_40AD30:loc_40B62Ao
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_40AD30:loc_40B634o
aEs_do		db 'es_DO',0            ; DATA XREF: sub_40AD30:loc_40B63Eo
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_40AD30:loc_40B648o
aEs_co		db 'es_CO',0            ; DATA XREF: sub_40AD30:loc_40B652o
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_40AD30:loc_40B65Co
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_40AD30:loc_40B666o
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_40AD30:loc_40B670o
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_40AD30:loc_40B67Ao
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_40AD30:loc_40B684o
aEs_py		db 'es_PY',0            ; DATA XREF: sub_40AD30:loc_40B68Eo
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_40AD30:loc_40B698o
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_40AD30:loc_40B6A2o
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_40AD30:loc_40B6ACo
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_40AD30:loc_40B6B6o
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_40AD30:loc_40B6C0o
aEs		db 'es',0               ; DATA XREF: sub_40AD30:loc_40B6CAo
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_40AD30:loc_40B6D4o
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_40AD30:loc_40B6DEo
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_40AD30:loc_40B6F7o
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_40AD30:loc_40B701o
aSv		db 'sv',0               ; DATA XREF: sub_40AD30:loc_40B70Bo
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_40AD30:loc_40B715o
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_40AD30:loc_40B71Fo
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_40AD30:loc_40B729o
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_40AD30:loc_40B742o
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_40AD30:loc_40B74Co
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_40AD30:loc_40B756o
aTa		db 'ta',0               ; DATA XREF: sub_40AD30:loc_40B760o
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_40AD30:loc_40B76Ao
aTe_in		db 'te_IN',0            ; DATA XREF: sub_40AD30:loc_40B774o
aTh_th		db 'th_TH',0            ; DATA XREF: sub_40AD30:loc_40B77Eo
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_40AD30:loc_40B788o
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_40AD30:loc_40B7A0o
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_40AD30:loc_40B7AAo
aTi		db 'ti',0               ; DATA XREF: sub_40AD30:loc_40B7B4o
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_40AD30:loc_40B7BEo
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_40AD30:loc_40B7C8o
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_40AD30:loc_40B7D2o
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_40AD30:loc_40B7DCo
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_40AD30:loc_40B7E6o
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_40AD30:loc_40B7FFo
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_40AD30:loc_40B806o
aUr		db 'ur',0               ; DATA XREF: sub_40AD30:loc_40B80Do
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_40AD30:loc_40B823o
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_40AD30:loc_40B82Ao
aUz		db 'uz',0               ; DATA XREF: sub_40AD30:loc_40B831o
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_40AD30:loc_40B838o
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_40AD30:loc_40B83Fo
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_40AD30:loc_40B846o
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_40AD30:loc_40B84Do
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_40AD30:loc_40B854o
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_40AD30:loc_40B85Bo
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_40AD30:loc_40B862o
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_40AD30:loc_40B869o
		align 4
off_412B38	dd offset loc_40B870, offset loc_40AE0C, offset	loc_40AF51
					; DATA XREF: sub_40AD30+B5o
		dd offset loc_40AF6F, offset loc_40AF83, offset	loc_40B00E ; jump table	for switch statement
		dd offset loc_40B018, offset loc_40B270, offset	loc_40B2C1
		dd offset loc_40B063, offset loc_40B5E9, offset	loc_40B158
		dd offset loc_40B162, offset loc_40B2F3, offset	loc_40B307
		dd offset loc_40B31B, offset loc_40B343, offset	loc_40B370
		dd offset loc_40B3CF, offset loc_40B02C, offset	loc_40B4A1
		dd offset loc_40B4F6, offset loc_40B500, offset	loc_40B547
		dd offset loc_40B551, offset loc_40B56D, offset	loc_40AFD4
		dd offset loc_40B5C1, offset loc_40ADF8, offset	loc_40B6E8
		dd offset loc_40B77E, offset loc_40B7D2, offset	loc_40B7F0
		dd offset loc_40B32F, offset loc_40B7E6, offset	loc_40AF1A
		dd offset loc_40B5CB, offset loc_40B13A, offset	loc_40B3F7
		dd offset loc_40B401, offset loc_40B729, offset	loc_40B14E
		dd offset loc_40B83F, offset loc_40AECF, offset	loc_40AEE3
		dd offset loc_40AF10, offset loc_40B5DF, offset	loc_40B40B
		dd offset loc_40B6D4, offset loc_40B7BE, offset	loc_40B7C8
		dd offset loc_40B838, offset loc_40B84D, offset	loc_40B869
		dd offset loc_40ADEE, offset loc_40B266, offset	loc_40B144
		dd offset loc_40B2FD, offset loc_40B44C, offset	loc_40B577
		dd offset loc_40B22F, offset loc_40B85B, offset	loc_40B415
		dd offset loc_40B3BB, offset loc_40B3D9, offset	loc_40B6DE
		dd offset loc_40B7DC, offset loc_40B814, offset	loc_40B76A
		dd offset loc_40AF24, offset loc_40B52B, offset	loc_40B2D5
		dd offset loc_40B4CE, offset loc_40B760, offset	loc_40B774
		dd offset loc_40B37A, offset loc_40B442, offset	loc_40AED9
		dd offset loc_40B460, offset loc_40B581, offset	loc_40B46A
		dd offset loc_40B788, offset loc_40B846, offset	loc_40AF65
		dd offset loc_40B3E3, offset loc_40AF5B, offset	loc_40B25C
		dd offset loc_40B3C5, offset loc_40B456, offset	loc_40B58B
		dd offset loc_40B715, offset loc_40B5B7, offset	loc_40AF79
		dd offset loc_40B339, offset loc_40AE02, offset	loc_40B733
		dd offset loc_40B38E, offset loc_40B474, offset	loc_40B21B
		dd offset loc_40B4EC, offset loc_40B71F, offset	loc_40B022
		dd offset loc_40B059, offset loc_40B225, offset	loc_40B2DF
		dd offset loc_40B311, offset loc_40B862, offset	loc_40B870
		dd offset loc_40B870, offset loc_40B870, offset	loc_40B870
		dd offset loc_40B870, offset loc_40B325, offset	loc_40B384
		dd offset loc_40B4D8, offset loc_40B792, offset	loc_40B2CB
		dd offset loc_40B2E9, offset loc_40B3ED, offset	loc_40B5D5
		dd offset loc_40B854, offset loc_40B4E2
off_412D20	dd offset loc_40AEC5	; DATA XREF: sub_40AD30+ECo
		dd offset loc_40AE25	; jump table for switch	statement
		dd offset loc_40AE2F
		dd offset loc_40AE39
		dd offset loc_40AE43
		dd offset loc_40AE4D
		dd offset loc_40AE57
		dd offset loc_40AE61
		dd offset loc_40AE6B
		dd offset loc_40AE75
		dd offset loc_40AE7F
		dd offset loc_40AE89
		dd offset loc_40AE93
		dd offset loc_40AE9D
		dd offset loc_40AEA7
		dd offset loc_40AEB1
		dd offset loc_40AEBB
off_412D64	dd offset loc_40AFCA	; DATA XREF: sub_40AD30+25Fo
		dd offset loc_40AF98	; jump table for switch	statement
		dd offset loc_40AFA2
		dd offset loc_40AFAC
		dd offset loc_40AFB6
		dd offset loc_40AFC0
off_412D7C	dd offset loc_40B130	; DATA XREF: sub_40AD30+343o
		dd offset loc_40B07C	; jump table for switch	statement
		dd offset loc_40B086
		dd offset loc_40B090
		dd offset loc_40B09A
		dd offset loc_40B0A4
		dd offset loc_40B0AE
		dd offset loc_40B0B8
		dd offset loc_40B0C2
		dd offset loc_40B0CC
		dd offset loc_40B0D6
		dd offset loc_40B0E0
		dd offset loc_40B0EA
		dd offset loc_40B0F4
		dd offset loc_40B0FE
		dd offset loc_40B108
		dd offset loc_40B112
		dd offset loc_40B11C
		dd offset loc_40B126
off_412DC8	dd offset loc_40B211	; DATA XREF: sub_40AD30+442o
		dd offset loc_40B17B	; jump table for switch	statement
		dd offset loc_40B185
		dd offset loc_40B18F
		dd offset loc_40B199
		dd offset loc_40B1A3
		dd offset loc_40B1AD
		dd offset loc_40B1B7
		dd offset loc_40B1C1
		dd offset loc_40B1CB
		dd offset loc_40B1D5
		dd offset loc_40B1DF
		dd offset loc_40B1E9
		dd offset loc_40B1F3
		dd offset loc_40B1FD
		dd offset loc_40B207
off_412E08	dd offset loc_40B2B7	; DATA XREF: sub_40AD30+54Co
		dd offset loc_40B285	; jump table for switch	statement
		dd offset loc_40B28F
		dd offset loc_40B299
		dd offset loc_40B2A3
		dd offset loc_40B2AD
off_412E20	dd offset loc_40B6CA	; DATA XREF: sub_40AD30+8C9o
		dd offset loc_40B602	; jump table for switch	statement
		dd offset loc_40B60C
		dd offset loc_40B616
		dd offset loc_40B620
		dd offset loc_40B62A
		dd offset loc_40B634
		dd offset loc_40B63E
		dd offset loc_40B648
		dd offset loc_40B652
		dd offset loc_40B65C
		dd offset loc_40B666
		dd offset loc_40B670
		dd offset loc_40B67A
		dd offset loc_40B684
		dd offset loc_40B68E
		dd offset loc_40B698
		dd offset loc_40B6A2
		dd offset loc_40B6AC
		dd offset loc_40B6B6
		dd offset loc_40B6C0
; char aRb_0[3]
aRb_0		db 'rb',0               ; DATA XREF: sub_40B956+16o
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: .text:0040BF10o
					; .text:0040C84Do
aLc_messages_0	db '\LC_MESSAGES\',0    ; DATA XREF: .text:0040C0A4o
a_mo		db '.mo',0              ; DATA XREF: .text:0040C0FCo
		align 4
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_40C154+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_40C1BA+13Do
					; sub_40C1BA:loc_40C41Do
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_40C1BA:loc_40C491o
byte_412EF7	db 0			; DATA XREF: .text:loc_40C867o
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_412F34	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_40CD90+3o
		align 4
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_40CD90+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_413054o
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:00413058o
		align 10h
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0041305Co
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:00413060o
		align 4
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:00413064o
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:00413068o
		align 4
off_413054	dd offset aArgumentDomain ; DATA XREF: sub_40CD90+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_40CE00+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_40CE60+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_40CE60+1F9o
					; sub_40CE60+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_40CE60+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_40D0A0+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_40D0A0+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_40D650:loc_40D6F0o
		unicode	0, <msvcrt.dll>,0
		align 4
off_41317C	dd offset dword_414740	; DATA XREF: .text:0040D8E8o
		dd offset dword_414460
		align 20h
; char aS[]
aS		db '%s: ',0             ; DATA XREF: sub_40DCC0+11o
; char aPosixly_correc[]
aPosixly_correc	db 'POSIXLY_CORRECT',0  ; DATA XREF: sub_40E080:loc_40E2C0o
byte_4131B5	db 0			; DATA XREF: sub_40E080+A6o
					; sub_40E080:loc_40E2B0o ...
; char aUnknownOptionC[]
aUnknownOptionC	db 'unknown option -- %c',0 ; DATA XREF: sub_40E080+488o
		align 20h
; char aOptionRequir_0[]
aOptionRequir_0	db 'option requires an argument -- %c',0 ; DATA XREF: sub_40E080+42Ao
					; sub_40E080+57Do
; char aAmbiguousOptio[]
aAmbiguousOptio	db 'ambiguous option -- %.*s',0 ; DATA XREF: sub_40DD30+147o
		align 10h
; char aOptionDoesnTTa[]
aOptionDoesnTTa	db 'option doesn',27h,'t take an argument -- %.*s',0
					; DATA XREF: sub_40DD30+1DDo
		align 20h
; char aOptionRequires[]
aOptionRequires	db 'option requires an argument -- %s',0 ; DATA XREF: sub_40DD30+2BAo
; char aUnknownOptionS[]
aUnknownOptionS	db 'unknown option -- %s',0 ; DATA XREF: sub_40DD30+269o
		align 10h
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_40E6F0+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_0[]
aS_0		db '%s',0Ah,0           ; DATA XREF: sub_40E6F0+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_40E6F0+10Fo
		align 10h
dword_413300	dd 1			; DATA XREF: .text:loc_40EF61r
dword_413304	dd 16h			; DATA XREF: .text:0040EF57r
					; .text:0040EF6Fr
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch, 0
		dd 0FFFFFFFFh, 4 dup(0)
dword_413480	dd 0			; DATA XREF: sub_40D0A0+59o
					; sub_40D0A0+5Eo ...
dword_413484	dd 0			; DATA XREF: sub_40D0A0+7Fr
dword_413488	dd 0			; DATA XREF: sub_40D0A0:loc_40D1ECr
dword_41348C	dd 5Dh dup(0)		; DATA XREF: sub_40D0A0+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00014000)
; Virtual size			: 00000808 (   2056.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 414000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_414000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_414004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_414008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_41400C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_414010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_414014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_414018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_41401C	dd ?			; DATA XREF: sub_401010+3Aw
; FILE *dword_414020
dword_414020	dd ?			; DATA XREF: sub_401CDA+20Aw
					; sub_401CDA+20Fr ...
; FILE *dword_414024
dword_414024	dd ?			; DATA XREF: sub_4019DF+47r
					; sub_4019DF+84r ...
; FILE *File
File		dd ?			; DATA XREF: sub_4015C8+A9r
					; sub_4015C8+DDr ...
; void *dword_41402C
dword_41402C	dd ?			; DATA XREF: sub_4019DF+5Fr
					; sub_4019DF:loc_401BD9r ...
		align 20h
dword_414040	dd ?			; DATA XREF: sub_40237C+6r
					; sub_40237C+28w
		align 20h
; struct WSAData stru_414060
stru_414060	WSAData	<?>		; DATA XREF: sub_40237C+Fo
		align 20h
dword_414200	dd ?			; DATA XREF: sub_4037F6:loc_403841r
					; sub_4039C6:loc_403A34r ...
dword_414204	dd ?			; DATA XREF: .text:004050B3w
					; sub_4050BA+6r
dword_414208	dd ?			; DATA XREF: .text:00407127r
					; .text:loc_407179w
dword_41420C	dd ?			; DATA XREF: .text:00407160w
					; .text:00407165r ...
dword_414210	dd ?			; DATA XREF: sub_404D30+41r
					; sub_404D30+49w ...
		align 10h
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_408B22+29o
					; sub_408B22+56o
; FILE *dword_414320
dword_414320	dd ?			; DATA XREF: sub_409499+8r
					; sub_409499+19r ...
		align 20h
; char byte_414340[79]
byte_414340	db 4Fh dup(?)		; DATA XREF: .text:00409763o
					; .text:loc_409818o ...
byte_41438F	db ?			; DATA XREF: .text:0040976Fw
dword_414390	dd ?			; DATA XREF: .text:00409787w
					; .text:loc_4097D0r ...
dword_414394	dd ?			; DATA XREF: .text:0040977Cw
					; .text:004097B8r ...
dword_414398	dd ?			; DATA XREF: .text:00409792w
					; .text:loc_4097E8r ...
dword_41439C	dd ?			; DATA XREF: .text:00409741w
					; sub_4098BA:loc_409A0Cr ...
dword_4143A0	dd ?			; DATA XREF: .text:0040979Fw
					; .text:loc_409800r
dword_4143A4	dd ?			; DATA XREF: sub_409499+249w
					; sub_4098BA+88r ...
dword_4143A8	dd ?			; DATA XREF: sub_409499+24Ew
					; sub_4098BA:loc_4098FDr ...
dword_4143AC	dd ?			; DATA XREF: .text:0040946Ar
					; .text:00409478w ...
		align 20h
dword_4143C0	dd ?			; DATA XREF: sub_409E74+E3w
					; .text:0040A152w ...
dword_4143C4	dd ?			; DATA XREF: sub_409E74+EDw
					; .text:0040A15Cw ...
dword_4143C8	dd ?			; DATA XREF: sub_40A4D5+70Er
					; sub_40A4D5:loc_40AC29w
dword_4143CC	dd ?			; DATA XREF: sub_40A289+1CCr
					; sub_40A289:loc_40A49Bw
dword_4143D0	dd 8 dup(?)		; DATA XREF: .text:00409FAEo
					; .text:00409FBAo ...
dword_4143F0	dd ?			; DATA XREF: sub_409E74+45r
					; sub_409E74+4Dw
dword_4143F4	dd ?			; DATA XREF: sub_409E74:loc_409ECDr
					; sub_409E74+61w
dword_4143F8	dd ?			; DATA XREF: sub_409E74:loc_409F09r
					; sub_409E74:loc_409F3Dw
dword_4143FC	dd ?			; DATA XREF: .text:0040C12Cr
					; .text:0040C135r ...
dword_414400	dd ?			; DATA XREF: sub_40C1BA+7r
					; .text:0040C874w
dword_414404	dd ?			; DATA XREF: sub_401010+3r
dword_414408	dd ?			; DATA XREF: sub_401010+25r
dword_41440C	dd ?			; DATA XREF: sub_401060+22w
dword_414410	dd ?			; DATA XREF: sub_401060+18w
dword_414414	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_414420	dd ?			; DATA XREF: sub_401060+2Cw
dword_414424	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_414428	dd ?			; DATA XREF: sub_401060+5Er
dword_41442C	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_40CC0Cr
dword_414430	dd ?			; DATA XREF: .text:0040CD33r
					; sub_40CD80+4w
dword_414434	dd ?			; DATA XREF: sub_40D0A0+9r
					; sub_40D0A0:loc_40D0C0w
dword_414438	dd ?			; DATA XREF: sub_40CE60+1Dr
					; sub_40CE60+58r ...
dword_41443C	dd ?			; DATA XREF: sub_40CE60+Br
					; sub_40CE60:loc_40CF1Fw ...
dword_414440	dd ?			; DATA XREF: sub_40D650+4r
					; sub_40D650+92w ...
dword_414444	dd ?			; DATA XREF: sub_40D7A0r
					; sub_40D7A0:loc_40D7B0w
		align 20h
dword_414460	dd 2Bh dup(?)		; DATA XREF: .rdata:00413180o
dword_41450C	dd ?			; DATA XREF: .text:0040D8CAw
		dd 2 dup(?)
dword_414518	dd ?			; DATA XREF: .text:0040D8B6w
		dd 2 dup(?)
dword_414524	dd ?			; DATA XREF: .text:0040D89Cw
		dd 86h dup(?)
dword_414740	dd ?			; DATA XREF: .text:0040D8A2w
					; .rdata:off_41317Co
dword_414744	dd ?			; DATA XREF: .text:0040D8ACw
		dd ?
dword_41474C	dd ?			; DATA XREF: .text:0040D8BBw
		dd 14h dup(?)
dword_4147A0	dd ?			; DATA XREF: .text:0040D993r
					; .text:0040DA24r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_40D920+7o
					; sub_40D920:loc_40D975o ...
dword_4147BC	dd ?			; DATA XREF: sub_40D920+14r
					; .text:0040D9E8r ...
		dd ?
dword_4147C4	dd ?			; DATA XREF: sub_401180+1A8w
dword_4147C8	dd ?			; DATA XREF: sub_401180+1BFw
dword_4147CC	dd ?			; DATA XREF: sub_401180+1B2w
dword_4147D0	dd ?			; DATA XREF: sub_4037F6:loc_403825r
					; sub_4037F6+79r ...
dword_4147D4	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_40C9F3w ...
dword_4147D8	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_4147DC	dd ?			; DATA XREF: TlsCallback_0:loc_40C944w
dword_4147E0	dd ?			; DATA XREF: sub_401060+64w
					; sub_40CAC0+3Fr ...
dword_4147E4	dd ?			; DATA XREF: sub_401060+69w
					; sub_40CAC0+4r ...
dword_4147E8	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_4147EC	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 20h
dword_414800	dd ?			; DATA XREF: sub_40E080+3Ar
					; sub_40E080+F8r ...
; char *Filename
Filename	dd ?			; DATA XREF: sub_401CDA+153r
					; sub_401CDA+183r ...
		align 800h
_bss		ends

;
; Imports from libgpg-error-0.dll
;
; Section 5. (virtual address 00015000)
; Virtual size			: 00000E7C (   3708.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00011000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_gpg_err_code_from_errno:dword
					; DATA XREF: gpg_err_code_from_errnor
		extrn __imp_gpg_err_code_from_syserror:dword
					; DATA XREF: gpg_err_code_from_syserrorr
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr

;
; Imports from libiconv-2.dll
;
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_403759+17p
					; sub_4037F6+A6p ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_4038DB+DEp
					; DATA XREF: sub_4038DB+D9r
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_40DAC0+44p
					; DATA XREF: sub_40DAC0+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_40D920+Ep
					; .text:0040D9E2p ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_408B22+51p
					; DATA XREF: sub_408B22+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: .text:00409F99p
					; DATA XREF: .text:00409F94r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: .text:00409F89p
					; DATA XREF: .text:00409F84r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:0040D8F8p
					; DATA XREF: .text:0040D8F8r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_40D7C0+6Cp
					; DATA XREF: sub_40D7C0+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_40D7C0+74p
					; DATA XREF: sub_40D7C0+74r
; DWORD	__stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh)
		extrn GetFileSize:dword	; CODE XREF: .text:004071EAp
					; DATA XREF: .text:004071E5r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_403B2B+C2p
					; sub_403C54+B2p ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_40E6F0+C2p
					; DATA XREF: sub_40E6F0+C2r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_40D650+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: sub_403C54+226p
					; sub_403C54+23Cp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_40D7C0+57p
					; DATA XREF: sub_40D7C0+57r
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_40AD30+7Fp
					; DATA XREF: sub_40AD30:loc_40ADAAr
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_40D7C0+7Cp
					; DATA XREF: sub_40D7C0+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_40DAC0+87p
					; DATA XREF: sub_40DAC0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_40D920+5Cp
					; .text:0040DA00p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_4036F6+11p
					; TlsCallback_0+55p
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_40D650+A7p
					; DATA XREF: sub_40D650+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_40BC91+38p
					; sub_40BC91+D5p
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_40D7C0+8Bp
					; DATA XREF: sub_40D7C0+8Br
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: sub_403C54+A4p
					; DATA XREF: sub_403C54+9Fr
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	sub_403B2B+B3p
					; .text:004073BBp
					; DATA XREF: ...
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0040D8DFp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:0040D909p
					; DATA XREF: .text:0040D909r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_40D920+35p
					; DATA XREF: sub_40D920+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0040D8EFp
					; DATA XREF: .text:0040D8EFr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_40CE60+142p
					; sub_40CE60+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_40CE60+A1p
					; sub_40CE60+D9p ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_40BD93+48p
					; sub_40BD93+C8p
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_403C54+165p
					; DATA XREF: sub_403C54+160r

;
; Imports from msvcrt.dll
;
		extrn __imp__dup:dword	; DATA XREF: _dupr
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr

;
; Imports from msvcrt.dll
;
; char **_argv
		extrn __argv:dword	; DATA XREF: sub_40DCC0+4r
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
; unsigned __int32 *__cdecl __doserrno()
		extrn __imp___doserrno:dword ; DATA XREF: __doserrnor
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_40CA90r
		extrn __pioinfo:dword	; DATA XREF: sub_40EB40+F1r
					; sub_40EB40+13Ar ...
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl _errno()
		extrn __imp__errno:dword ; CODE	XREF: sub_401CDA+177p
					; sub_401CDA+21Dp ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
		extrn __imp__filelengthi64:dword ; DATA	XREF: _filelengthi64r
; int __cdecl _fileno_0(FILE *File)
		extrn __imp__fileno_0:dword ; DATA XREF: _fileno_0r
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: .text:004070B6p
					; sub_40B956+57p
					; DATA XREF: ...
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_401CDA+2Ar
					; sub_401CDA+6Ar ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__lseeki64:dword ; DATA XREF: _lseeki64r
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_40CAC0+A3p
					; DATA XREF: sub_40CAC0+A3r
; int __cdecl stricmp(const char *Str1,	const char *Str2)
		extrn _stricmp:dword	; CODE XREF: sub_4024BD+58p
					; sub_4024BD+7Cp ...
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: sub_4024BD+3E8p
					; sub_4024BD+41Cp ...
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
		extrn __imp__write:dword ; DATA	XREF: _writer
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl clearerr(FILE *File)
		extrn __imp_clearerr:dword ; DATA XREF:	clearerrr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; int __cdecl fgetpos(FILE *File, fpos_t *Pos)
		extrn __imp_fgetpos:dword ; DATA XREF: fgetposr
; char *__cdecl	fgets(char *Buf, int MaxCount, FILE *File)
		extrn __imp_fgets:dword	; DATA XREF: fgetsr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputc(int	Ch, FILE *File)
		extrn __imp_fputc:dword	; DATA XREF: fputcr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; int __cdecl fsetpos(FILE *File, const	fpos_t *Pos)
		extrn __imp_fsetpos:dword ; DATA XREF: fsetposr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: .text:00407C4Bp
					; .text:00407C6Bp ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_40F000r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl remove(const char	*Filename)
		extrn __imp_remove:dword ; DATA	XREF: remover
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; int sscanf(const char	*Src, const char *Format, ...)
		extrn __imp_sscanf:dword ; DATA	XREF: sscanfr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; size_t __cdecl strspn(const char *Str, const char *Control)
		extrn __imp_strspn:dword ; DATA	XREF: strspnr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_40EFF0r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:00407A25p
					; .text:00407A3Ap ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_40E6F0+122p
					; DATA XREF: sub_40E6F0+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAGetLastError()
		extrn WSAGetLastError:dword ; CODE XREF: sub_4015C8+130p
					; sub_4015C8+18Dp ...
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: sub_40237C+23p
					; DATA XREF: sub_40237C+1Er
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; CODE XREF: sub_4015C8+208p
					; sub_401860+156p ...
; int __stdcall	connect(SOCKET s, const	struct sockaddr	*name, int namelen)
		extrn connect:dword	; CODE XREF: sub_4015C8+1CBp
					; DATA XREF: sub_4015C8+1C6r
; struct hostent *__stdcall gethostbyname(const	char *name)
		extrn gethostbyname:dword ; CODE XREF: sub_4015C8+85p
					; DATA XREF: sub_4015C8+80r
; u_short __stdcall htons(u_short hostshort)
		extrn htons:dword	; CODE XREF: sub_4015C8+49p
					; DATA XREF: sub_4015C8+44r
; unsigned __int32 __stdcall inet_addr(const char *cp)
		extrn inet_addr:dword	; CODE XREF: sub_4015C8+5Dp
					; DATA XREF: sub_4015C8+58r
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn recv:dword	; CODE XREF: sub_403F00+90p
					; DATA XREF: sub_403F00+8Br
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn send:dword	; CODE XREF: sub_4017E1+2Fp
					; sub_403F00+13Ap
					; DATA XREF: ...
; SOCKET __stdcall socket(int af, int type, int	protocol)
		extrn socket:dword	; CODE XREF: sub_4015C8+17Ap
					; DATA XREF: sub_4015C8+175r


; Section 6. (virtual address 00016000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00012000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 416000h
dword_416000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_416008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_41600C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_40CA90
dword_416018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_416030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_40CA33o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00017000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00012200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 417000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
