;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	ECA8BDE16CDC01193289FC2257685FB8
; Input	CRC32 :	E6772580

; File Name   :	C:\compspace\compare\gpg\dlls\original\paperkey.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00006D64 (  28004.)
; Section size in file		: 00006E00 (  28160.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:0040D004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_40B040
		mov	[esp+2Ch+var_1C], offset dword_40B018
		mov	[esp+2Ch+var_24], offset dword_40B00C
		mov	[esp+2Ch+var_28], offset dword_40B008
		mov	ds:dword_40B018, eax
		mov	eax, ds:dword_40B044
		mov	[esp+2Ch+var_2C], offset dword_40B004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_40B01C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:0040D010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_40B050, 1
		mov	ds:dword_40B04C, 1
		mov	ds:dword_40B048, 1
		mov	ds:dword_40B05C, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_40B014, eax
		mov	eax, ds:dword_40B060
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_405CD0
		mov	edx, ds:dword_40B064
		mov	ds:dword_40B41C, eax
		mov	ds:dword_40B420, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_406010
		cmp	dword_40811C, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_405FB0
		call	sub_405FA0
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_406D80
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_40B060
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_40B424
		call	sub_406DE0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_40B428
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_40B428
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_40B000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_40B428
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_40B424

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_409F7C
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_4062C0
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_40B068, eax
		call	sub_406870
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_406930
		mov	eax, ds:dword_40B060
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_40B404, eax
		mov	eax, 0Ah
		mov	ds:dword_40B40C, 400000h
		cmovnz	eax, edx
		mov	ds:dword_40B408, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_40B004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_40B008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_40B008, eax
		call	sub_4069C0
		mov	eax, ds:__initenv
		mov	edx, ds:dword_40B00C
		mov	[eax], edx
		mov	eax, ds:dword_40B00C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_40B008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_40B004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_401600
		mov	esi, ds:dword_40B014
		test	esi, esi
		mov	ds:dword_40B010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_40B000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_40B010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_40B428
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_40B428
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_40D008
		mov	[esp+88h+dwMilliseconds], offset dword_40D000
		call	_initterm
		mov	ds:dword_40B428, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_40B428, 1
		mov	[esp+88h+lpProcName], offset dword_40D018
		mov	[esp+88h+dwMilliseconds], offset dword_40D00C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_40B060, 1
		call	sub_4069E0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_40B060, 0
		call	sub_4069E0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_407D30+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_408144
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_408144
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_407D30+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_401600:loc_40175Ep

Str		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+Str], offset Str ; "Usage: paperkey [OPTIONS]"
		call	puts
		mov	[esp+18h+Str], offset aHelpH ; "  --help (-h)"
		call	puts
		mov	[esp+18h+Str], offset aVersionV	; "  --version (-V)"
		call	puts
		mov	[esp+18h+Str], offset aVerboseVBeMore ;	"  --verbose (-v)  be more verbose"
		call	puts
		mov	[esp+18h+Str], offset aOutputOWriteOu ;	"  --output (-o)   write output	to this	"...
		call	puts
		mov	[esp+18h+Str], offset aInputTypeAutoB ;	"  --input-type	   auto, base16	or raw ("...
		call	puts
		mov	[esp+18h+Str], offset aOutputTypeBase ;	"  --output-type   base16 or raw (binary"...
		call	puts
		mov	[esp+18h+Str], offset aOutputWidthMax ;	"  --output-width  maximum width of base"...
		call	puts
		mov	[esp+18h+Str], offset aSecretKeyExtra ;	"  --secret-key	   extract secret data f"...
		call	puts
		mov	[esp+18h+Str], offset aPubringPublicK ;	"  --pubring	   public keyring to fin"...
		call	puts
		mov	[esp+18h+Str], offset aSecretsFileCon ;	"  --secrets	   file	containing secre"...
		call	puts
		mov	[esp+18h+Str], offset aIgnoreCrcError ;	"  --ignore-crc-error  don't reject corr"...
		call	puts
		mov	[esp+18h+Str], offset aFileFormatShow ;	"  --file-format   show	the paperkey fil"...
		call	puts
		mov	[esp+18h+Str], offset aCommentAddACom ;	"  --comment	   add a comment to the	"...
		call	puts
		leave
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401600	proc near		; CODE XREF: sub_401180+265p

File		= dword	ptr -4Ch
Format		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 40h
		call	sub_4069C0
		mov	[esp+4Ch+var_1C], 0
		mov	[esp+4Ch+var_20], 0
		mov	[esp+4Ch+var_24], 1
		mov	[esp+4Ch+var_28], 0
		mov	eax, ds:_iob
		mov	[esp+4Ch+File],	eax ; File
		mov	eax, ds:_fileno
		call	eax ; _fileno
		mov	[esp+4Ch+Format], 8000h
		mov	[esp+4Ch+File],	eax
		mov	eax, ds:_setmode
		call	eax ; _setmode
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_401692
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+4Ch+File],	eax ; int
		call	strerror
		mov	edx, offset Format ; "Unable to	set stdin mode to binary: %s\"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+4Ch+var_44], eax
		mov	[esp+4Ch+Format], edx ;	Format
		mov	[esp+4Ch+File],	ecx ; File
		call	fprintf
		mov	[esp+4Ch+File],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_401692:				; CODE XREF: sub_401600+55j
		mov	eax, ds:_iob
		mov	[esp+4Ch+var_18], eax
		mov	eax, [esp+4Ch+var_18]
		mov	[esp+4Ch+var_14], eax
		mov	[esp+4Ch+File],	3Fh
		call	_umask
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_4016B4:				; CODE XREF: sub_401600+526j
		mov	eax, [esp+4Ch+var_2C]
		cmp	eax, 105h
		jz	loc_4018BD
		cmp	eax, 105h
		jg	short loc_401710
		cmp	eax, 101h
		jz	loc_40176F
		cmp	eax, 101h
		jg	short loc_4016F5
		cmp	eax, 6Fh
		jz	loc_4017DA
		cmp	eax, 76h
		jz	loc_4017C8
		cmp	eax, 56h
		jz	short loc_40176F
		jmp	short loc_40175E
; ---------------------------------------------------------------------------

loc_4016F5:				; CODE XREF: sub_401600+DAj
		cmp	eax, 103h
		jz	loc_4017DA
		cmp	eax, 103h
		jg	loc_4017E8
		jmp	loc_4017C8
; ---------------------------------------------------------------------------

loc_401710:				; CODE XREF: sub_401600+C8j
		cmp	eax, 109h
		jz	loc_401A46
		cmp	eax, 109h
		jg	short loc_40173D
		cmp	eax, 107h
		jz	loc_401972
		cmp	eax, 107h
		jg	loc_4019DC
		jmp	loc_40195B
; ---------------------------------------------------------------------------

loc_40173D:				; CODE XREF: sub_401600+120j
		cmp	eax, 10Bh
		jz	loc_401ABC
		cmp	eax, 10Bh
		jl	loc_401AB0
		cmp	eax, 10Ch
		jz	loc_401AE0

loc_40175E:				; CODE XREF: sub_401600+F3j
		call	sub_401550
		mov	[esp+4Ch+File],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40176F:				; CODE XREF: sub_401600+CFj
					; sub_401600+F1j
		mov	eax, offset aSS	; "%s (%s)\n"
		mov	[esp+4Ch+var_44], offset aMingw32 ; "mingw32"
		mov	[esp+4Ch+Format], offset aPaperkey1_3 ;	"paperkey 1.3"
		mov	[esp+4Ch+File],	eax ; Format
		call	printf
		mov	[esp+4Ch+File],	offset aCopyrightC2007 ; "Copyright (C)	2007, 2008, 2009, 2012 Da"...
		call	puts
		mov	[esp+4Ch+File],	offset aThisIsFreeSoft ; "This is free software.  You may redistr"...
		call	puts
		mov	[esp+4Ch+File],	offset aTheGnuGeneralP ; "the GNU General Public License <http://"...
		call	puts
		mov	[esp+4Ch+File],	offset aThereIsNoWarra ; "There	is NO WARRANTY,	to the extent per"...
		call	puts
		mov	[esp+4Ch+File],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4017C8:				; CODE XREF: sub_401600+E8j
					; sub_401600+10Bj
		mov	eax, ds:dword_40B020
		add	eax, 1
		mov	ds:dword_40B020, eax
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_4017DA:				; CODE XREF: sub_401600+DFj
					; sub_401600+FAj
		mov	eax, ds:Filename
		mov	[esp+4Ch+var_20], eax
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_4017E8:				; CODE XREF: sub_401600+105j
		mov	eax, ds:Filename
		mov	edx, eax
		mov	eax, offset aAuto ; "auto"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40181F
		mov	[esp+4Ch+var_28], 0
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_40181F:				; CODE XREF: sub_401600+210j
		mov	eax, ds:Filename
		mov	edx, eax
		mov	eax, offset aBase16 ; "base16"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401856
		mov	[esp+4Ch+var_28], 1
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_401856:				; CODE XREF: sub_401600+247j
		mov	eax, ds:Filename
		mov	edx, eax
		mov	eax, offset aRaw ; "raw"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40188D
		mov	[esp+4Ch+var_28], 2
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_40188D:				; CODE XREF: sub_401600+27Ej
		mov	edx, ds:Filename
		mov	eax, offset aUnknownInputTy ; "Unknown input type \"%s\"\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+4Ch+var_44], edx
		mov	[esp+4Ch+Format], eax ;	Format
		mov	[esp+4Ch+File],	ecx ; File
		call	fprintf
		mov	[esp+4Ch+File],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4018BD:				; CODE XREF: sub_401600+BDj
		mov	eax, ds:Filename
		mov	edx, eax
		mov	eax, offset aBase16 ; "base16"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4018F4
		mov	[esp+4Ch+var_24], 1
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_4018F4:				; CODE XREF: sub_401600+2E5j
		mov	eax, ds:Filename
		mov	edx, eax
		mov	eax, offset aRaw ; "raw"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40192B
		mov	[esp+4Ch+var_24], 2
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_40192B:				; CODE XREF: sub_401600+31Cj
		mov	edx, ds:Filename
		mov	eax, offset aUnknownOutputT ; "Unknown output type \"%s\"\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+4Ch+var_44], edx
		mov	[esp+4Ch+Format], eax ;	Format
		mov	[esp+4Ch+File],	ecx ; File
		call	fprintf
		mov	[esp+4Ch+File],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40195B:				; CODE XREF: sub_401600+138j
		mov	eax, ds:Filename
		mov	[esp+4Ch+File],	eax ; Str
		call	atoi
		mov	dword_408000, eax
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_401972:				; CODE XREF: sub_401600+127j
		mov	edx, offset Mode ; "rb"
		mov	eax, ds:Filename
		mov	[esp+4Ch+Format], edx ;	Mode
		mov	[esp+4Ch+File],	eax ; Filename
		call	fopen
		mov	[esp+4Ch+var_14], eax
		cmp	[esp+4Ch+var_14], 0
		jnz	loc_401AEC
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+4Ch+File],	eax ; int
		call	strerror
		mov	ecx, ds:Filename
		mov	edx, offset aUnableToOpenSS ; "Unable to open %s: %s\n"
		mov	ebx, ds:_iob
		add	ebx, 40h
		mov	[esp+4Ch+var_40], eax
		mov	[esp+4Ch+var_44], ecx
		mov	[esp+4Ch+Format], edx ;	Format
		mov	[esp+4Ch+File],	ebx ; File
		call	fprintf
		mov	[esp+4Ch+File],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4019DC:				; CODE XREF: sub_401600+132j
		mov	edx, offset Mode ; "rb"
		mov	eax, ds:Filename
		mov	[esp+4Ch+Format], edx ;	Mode
		mov	[esp+4Ch+File],	eax ; Filename
		call	fopen
		mov	[esp+4Ch+var_1C], eax
		cmp	[esp+4Ch+var_1C], 0
		jnz	loc_401AEF
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+4Ch+File],	eax ; int
		call	strerror
		mov	ecx, ds:Filename
		mov	edx, offset aUnableToOpenPu ; "Unable to open pubring %s: %s\n"
		mov	ebx, ds:_iob
		add	ebx, 40h
		mov	[esp+4Ch+var_40], eax
		mov	[esp+4Ch+var_44], ecx
		mov	[esp+4Ch+Format], edx ;	Format
		mov	[esp+4Ch+File],	ebx ; File
		call	fprintf
		mov	[esp+4Ch+File],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_401A46:				; CODE XREF: sub_401600+115j
		mov	edx, offset Mode ; "rb"
		mov	eax, ds:Filename
		mov	[esp+4Ch+Format], edx ;	Mode
		mov	[esp+4Ch+File],	eax ; Filename
		call	fopen
		mov	[esp+4Ch+var_18], eax
		cmp	[esp+4Ch+var_18], 0
		jnz	loc_401AF2
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+4Ch+File],	eax ; int
		call	strerror
		mov	ecx, ds:Filename
		mov	edx, offset aUnableToOpenSS ; "Unable to open %s: %s\n"
		mov	ebx, ds:_iob
		add	ebx, 40h
		mov	[esp+4Ch+var_40], eax
		mov	[esp+4Ch+var_44], ecx
		mov	[esp+4Ch+Format], edx ;	Format
		mov	[esp+4Ch+File],	ebx ; File
		call	fprintf
		mov	[esp+4Ch+File],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_401AB0:				; CODE XREF: sub_401600+14Dj
		mov	ds:dword_40B024, 1
		jmp	short loc_401AF3
; ---------------------------------------------------------------------------

loc_401ABC:				; CODE XREF: sub_401600+142j
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+4Ch+Format], offset byte_40951B ; int
		mov	[esp+4Ch+File],	eax ; FILE *
		call	sub_40366C
		mov	[esp+4Ch+File],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_401AE0:				; CODE XREF: sub_401600+158j
		mov	eax, ds:Filename
		mov	ds:dword_40B028, eax
		jmp	short loc_401AF3
; ---------------------------------------------------------------------------

loc_401AEC:				; CODE XREF: sub_401600+391j
		nop
		jmp	short loc_401AF3
; ---------------------------------------------------------------------------

loc_401AEF:				; CODE XREF: sub_401600+3FBj
		nop
		jmp	short loc_401AF3
; ---------------------------------------------------------------------------

loc_401AF2:				; CODE XREF: sub_401600+465j
		nop

loc_401AF3:				; CODE XREF: sub_401600+AFj
					; sub_401600+1D5j ...
		mov	[esp+4Ch+var_3C], 0
		mov	[esp+4Ch+var_40], offset off_408020
		mov	[esp+4Ch+var_44], offset aHvvo ; "hVvo:"
		mov	eax, [ebp+arg_4]
		mov	[esp+4Ch+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+4Ch+File],	eax
		call	sub_407890
		mov	[esp+4Ch+var_2C], eax
		cmp	[esp+4Ch+var_2C], 0FFFFFFFFh
		jnz	loc_4016B4
		cmp	[esp+4Ch+var_1C], 0
		jz	short loc_401B5D
		mov	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+var_40], eax ;	char *
		mov	eax, [esp+4Ch+var_28]
		mov	[esp+4Ch+var_44], eax ;	int
		mov	eax, [esp+4Ch+var_18]
		mov	[esp+4Ch+Format], eax ;	FILE *
		mov	eax, [esp+4Ch+var_1C]
		mov	[esp+4Ch+File],	eax ; FILE *
		call	sub_403180
		mov	[esp+4Ch+var_10], eax
		jmp	short loc_401B7D
; ---------------------------------------------------------------------------

loc_401B5D:				; CODE XREF: sub_401600+531j
		mov	eax, [esp+4Ch+var_24]
		mov	[esp+4Ch+var_44], eax ;	int
		mov	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+Format], eax ;	char *
		mov	eax, [esp+4Ch+var_14]
		mov	[esp+4Ch+File],	eax ; FILE *
		call	sub_402C00
		mov	[esp+4Ch+var_10], eax

loc_401B7D:				; CODE XREF: sub_401600+55Bj
		mov	eax, [esp+4Ch+var_10]
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401600	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401B8C(void *, size_t)
sub_401B8C	proc near		; CODE XREF: sub_401BE0+30p
					; sub_401BE0+9Ap ...

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+arg_0], eax
		cmp	[ebp+arg_0], 0
		jnz	short loc_401BDB
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aUnableToAlloca ; "Unable to allocate memory\n"
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 1Ah ; Count
		mov	[esp+18h+NewSize], 1 ; Size
		mov	[esp+18h+Memory], eax ;	Str
		call	fwrite
		call	abort
; ---------------------------------------------------------------------------

loc_401BDB:				; CODE XREF: sub_401B8C+1Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_401B8C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401BE0(int, void *, size_t)
sub_401BE0	proc near		; CODE XREF: sub_40273A+42p
					; sub_40273A+346p ...

Dst		= dword	ptr -18h
Src		= dword	ptr -14h
Size		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_401C6B
		jmp	short loc_401C1B
; ---------------------------------------------------------------------------

loc_401BEE:				; CODE XREF: sub_401BE0+50j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	edx, [eax+64h]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+Src], edx ; size_t
		mov	[esp+18h+Dst], eax ; void *
		call	sub_401B8C
		mov	edx, [ebp+arg_0]
		mov	[edx+4], eax

loc_401C1B:				; CODE XREF: sub_401BE0+Cj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jb	short loc_401BEE
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+18h+Size],	ecx ; Size
		mov	[esp+18h+Src], edx ; Src
		mov	[esp+18h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		jmp	short loc_401CCF
; ---------------------------------------------------------------------------

loc_401C6B:				; CODE XREF: sub_401BE0+Aj
		mov	[esp+18h+Src], 10h ; size_t
		mov	[esp+18h+Dst], 0 ; void	*
		call	sub_401B8C
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+Src], eax ; size_t
		mov	[esp+18h+Dst], 0 ; void	*
		call	sub_401B8C
		mov	edx, [ebp+arg_0]
		mov	[edx+4], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+0Ch], edx
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+18h+Size],	ecx ; Size
		mov	[esp+18h+Src], edx ; Src
		mov	[esp+18h+Dst], eax ; Dst
		call	memcpy

loc_401CCF:				; CODE XREF: sub_401BE0+89j
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_401BE0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401CD4(void *)
sub_401CD4	proc near		; CODE XREF: sub_40273A+BCp
					; sub_40273A+1D7p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_401CF9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_401CF9:				; CODE XREF: sub_401CD4+Aj
		leave
		retn
sub_401CD4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401CFC(FILE *, int, int)
sub_401CFC	proc near		; CODE XREF: sub_402C00+20p
					; sub_402C00+308p ...

var_48		= dword	ptr -48h
File		= dword	ptr -44h
Count		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= byte ptr -30h
var_2C		= byte ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_2C], dl
		mov	[ebp+var_30], al
		mov	[ebp+var_C], 0
		jmp	loc_4020FF
; ---------------------------------------------------------------------------

loc_401D1B:				; CODE XREF: sub_401CFC+415j
		mov	eax, [ebp+var_1C]
		and	eax, 80h
		test	eax, eax
		jz	loc_401FFE
		mov	eax, [ebp+var_1C]
		and	eax, 3Fh
		mov	[ebp+var_D], al
		mov	eax, [ebp+var_1C]
		and	eax, 40h
		test	eax, eax
		jnz	short loc_401D42
		shr	[ebp+var_D], 2

loc_401D42:				; CODE XREF: sub_401CFC+40j
		movzx	eax, [ebp+var_D]
		cmp	al, [ebp+var_30]
		jnz	short loc_401D62
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+File],	eax ; File
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax ;	Ch
		call	ungetc
		jmp	loc_40211A
; ---------------------------------------------------------------------------

loc_401D62:				; CODE XREF: sub_401CFC+4Dj
		mov	eax, [ebp+var_1C]
		and	eax, 40h
		test	eax, eax
		jz	loc_401E99
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	loc_40211F
		cmp	[ebp+var_1C], 0FFh
		jnz	loc_401E1B
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_402122
		mov	eax, [ebp+var_20]
		shl	eax, 18h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_402125
		mov	eax, [ebp+var_20]
		shl	eax, 10h
		or	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_402128
		mov	eax, [ebp+var_20]
		shl	eax, 8
		or	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_40212B
		mov	eax, [ebp+var_20]
		or	[ebp+var_14], eax
		jmp	loc_401FC9
; ---------------------------------------------------------------------------

loc_401E1B:				; CODE XREF: sub_401CFC+93j
		cmp	[ebp+var_1C], 0DFh
		jle	short loc_401E52
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aInvalidPartial ; "Invalid partial packet encoding\n"
		mov	[esp+48h+var_3C], edx ;	File
		mov	[esp+48h+Count], 20h ; Count
		mov	[esp+48h+File],	1 ; Size
		mov	[esp+48h+var_48], eax ;	Str
		call	fwrite
		jmp	loc_402144
; ---------------------------------------------------------------------------

loc_401E52:				; CODE XREF: sub_401CFC+126j
		cmp	[ebp+var_1C], 0BFh
		jle	short loc_401E8E
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_40212E
		mov	eax, [ebp+var_1C]
		sub	eax, 0C0h
		shl	eax, 8
		add	eax, [ebp+var_20]
		add	eax, 0C0h
		mov	[ebp+var_14], eax
		jmp	loc_401FC9
; ---------------------------------------------------------------------------

loc_401E8E:				; CODE XREF: sub_401CFC+15Dj
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_14], eax
		jmp	loc_401FC9
; ---------------------------------------------------------------------------

loc_401E99:				; CODE XREF: sub_401CFC+6Ej
		mov	eax, [ebp+var_1C]
		and	eax, 3
		cmp	eax, 1
		jz	short loc_401ED4
		cmp	eax, 2
		jz	short loc_401F18
		test	eax, eax
		jnz	loc_401F9B
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	loc_402131
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_14], eax
		jmp	loc_401FC9
; ---------------------------------------------------------------------------

loc_401ED4:				; CODE XREF: sub_401CFC+1A6j
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	loc_402134
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_402137
		mov	eax, [ebp+var_1C]
		shl	eax, 8
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		or	[ebp+var_14], eax
		jmp	loc_401FC9
; ---------------------------------------------------------------------------

loc_401F18:				; CODE XREF: sub_401CFC+1ABj
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_40213A
		mov	eax, [ebp+var_20]
		shl	eax, 18h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_40213D
		mov	eax, [ebp+var_20]
		shl	eax, 10h
		or	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_402140
		mov	eax, [ebp+var_20]
		shl	eax, 8
		or	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	loc_402143
		mov	eax, [ebp+var_20]
		or	[ebp+var_14], eax
		jmp	short loc_401FC9
; ---------------------------------------------------------------------------

loc_401F9B:				; CODE XREF: sub_401CFC+1AFj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aErrorUnableToP ; "Error: unable to	parse old-style	length"...
		mov	[esp+48h+var_3C], edx ;	File
		mov	[esp+48h+Count], 28h ; Count
		mov	[esp+48h+File],	1 ; Size
		mov	[esp+48h+var_48], eax ;	Str
		call	fwrite
		jmp	loc_402144
; ---------------------------------------------------------------------------

loc_401FC9:				; CODE XREF: sub_401CFC+11Aj
					; sub_401CFC+18Dj ...
		mov	eax, ds:dword_40B020
		cmp	eax, 1
		jle	short loc_40202C
		movzx	edx, [ebp+var_D]
		mov	eax, offset aFoundPacketOfT ; "Found packet of type %d,	length %d\n"
		mov	ecx, ds:_iob
		lea	ebx, [ecx+40h]
		mov	ecx, [ebp+var_14]
		mov	[esp+48h+var_3C], ecx
		mov	[esp+48h+Count], edx
		mov	[esp+48h+File],	eax ; Format
		mov	[esp+48h+var_48], ebx ;	File
		call	fprintf
		jmp	short loc_40202C
; ---------------------------------------------------------------------------

loc_401FFE:				; CODE XREF: sub_401CFC+29j
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aErrorUnableT_0 ; "Error: unable to	parse OpenPGP packets "...
		mov	[esp+48h+var_3C], edx ;	File
		mov	[esp+48h+Count], 3Fh ; Count
		mov	[esp+48h+File],	1 ; Size
		mov	[esp+48h+var_48], eax ;	Str
		call	fwrite
		jmp	loc_402144
; ---------------------------------------------------------------------------

loc_40202C:				; CODE XREF: sub_401CFC+2D5j
					; sub_401CFC+300j
		cmp	[ebp+var_2C], 0
		jz	short loc_40203F
		movzx	eax, [ebp+var_D]
		cmp	al, [ebp+var_2C]
		jnz	loc_4020DF

loc_40203F:				; CODE XREF: sub_401CFC+334j
		mov	[esp+48h+File],	10h ; size_t
		mov	[esp+48h+var_48], 0 ; void *
		call	sub_401B8C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	edx, [ebp+var_D]
		mov	[eax], dl
		mov	eax, [ebp+var_14]
		mov	[esp+48h+File],	eax ; size_t
		mov	[esp+48h+var_48], 0 ; void *
		call	sub_401B8C
		mov	edx, [ebp+var_C]
		mov	[edx+4], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_3C], ecx ;	File
		mov	[esp+48h+Count], edx ; Count
		mov	[esp+48h+File],	1 ; ElementSize
		mov	[esp+48h+var_48], eax ;	DstBuf
		call	fread
		mov	edx, [ebp+var_C]
		mov	edx, [edx+8]
		cmp	eax, edx
		jnb	short loc_402119
		movzx	edx, [ebp+var_D]
		mov	eax, offset aShortReadOnPac ; "Short read on packet type %d\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+48h+Count], edx
		mov	[esp+48h+File],	eax ; Format
		mov	[esp+48h+var_48], ecx ;	File
		call	fprintf
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_4020DF:				; CODE XREF: sub_401CFC+33Dj
		mov	[ebp+var_18], 0
		jmp	short loc_4020F7
; ---------------------------------------------------------------------------

loc_4020E8:				; CODE XREF: sub_401CFC+401j
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		add	[ebp+var_18], 1

loc_4020F7:				; CODE XREF: sub_401CFC+3EAj
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_14]
		jb	short loc_4020E8

loc_4020FF:				; CODE XREF: sub_401CFC+1Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	File
		call	fgetc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	loc_401D1B
		jmp	short loc_40211A
; ---------------------------------------------------------------------------

loc_402119:				; CODE XREF: sub_401CFC+3BDj
		nop

loc_40211A:				; CODE XREF: sub_401CFC+61j
					; sub_401CFC+41Bj
		mov	eax, [ebp+var_C]
		jmp	short loc_402149
; ---------------------------------------------------------------------------

loc_40211F:				; CODE XREF: sub_401CFC+86j
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_402122:				; CODE XREF: sub_401CFC+ABj
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_402125:				; CODE XREF: sub_401CFC+CCj
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_402128:				; CODE XREF: sub_401CFC+EDj
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_40212B:				; CODE XREF: sub_401CFC+10Ej
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_40212E:				; CODE XREF: sub_401CFC+171j
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_402131:				; CODE XREF: sub_401CFC+1C7j
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_402134:				; CODE XREF: sub_401CFC+1EAj
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_402137:				; CODE XREF: sub_401CFC+202j
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_40213A:				; CODE XREF: sub_401CFC+22Ej
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_40213D:				; CODE XREF: sub_401CFC+24Fj
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_402140:				; CODE XREF: sub_401CFC+270j
		nop
		jmp	short loc_402144
; ---------------------------------------------------------------------------

loc_402143:				; CODE XREF: sub_401CFC+291j
		nop

loc_402144:				; CODE XREF: sub_401CFC+151j
					; sub_401CFC+2C8j ...
		mov	eax, 0

loc_402149:				; CODE XREF: sub_401CFC+421j
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_401CFC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40214F(int, size_t, int)
sub_40214F	proc near		; CODE XREF: sub_402C00+BEp
					; sub_402C00+217p ...

var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0C8h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3
		jnz	short loc_40216F
		mov	eax, 0FFFFFFFFh
		jmp	locret_4021F3
; ---------------------------------------------------------------------------

loc_40216F:				; CODE XREF: sub_40214F+14j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		movzx	eax, byte ptr [eax]
		cmp	al, 4
		jnz	short loc_4021EE
		lea	eax, [ebp+var_AC]
		mov	[esp+0C8h+var_C8], eax
		call	sub_403CBC
		mov	[ebp+var_B], 99h
		mov	eax, [ebp+arg_4]
		shr	eax, 8
		mov	[ebp+var_A], al
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_9], al
		lea	eax, [ebp+var_AC]
		mov	[esp+0C8h+var_C0], eax ; int
		mov	[esp+0C8h+var_C4], 3 ; size_t
		lea	eax, [ebp+var_B]
		mov	[esp+0C8h+var_C8], eax ; void *
		call	sub_404193
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_AC]
		mov	[esp+0C8h+var_C0], edx ; int
		mov	edx, [ebp+arg_4]
		mov	[esp+0C8h+var_C4], edx ; size_t
		mov	[esp+0C8h+var_C8], eax ; void *
		call	sub_404193
		mov	eax, [ebp+arg_8]
		mov	[esp+0C8h+var_C4], eax
		lea	eax, [ebp+var_AC]
		mov	[esp+0C8h+var_C8], eax
		call	sub_403E93

loc_4021EE:				; CODE XREF: sub_40214F+2Bj
		mov	eax, 0

locret_4021F3:				; CODE XREF: sub_40214F+1Bj
		leave
		retn
sub_40214F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4021F5	proc near		; CODE XREF: sub_402C00+67p
					; sub_402C00+1D0p

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40220F
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_40220F:				; CODE XREF: sub_4021F5+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3
		jnz	short loc_40224F
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aVersion3Pgp2_x ; "Version 3 (PGP 2.x style) keys are not "...
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 32h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_40224F:				; CODE XREF: sub_4021F5+25j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		movzx	eax, byte ptr [eax]
		cmp	al, 4
		jnz	short loc_402270
		mov	[ebp+var_C], 5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40227A
		jmp	short loc_402284
; ---------------------------------------------------------------------------

loc_402270:				; CODE XREF: sub_4021F5+65j
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_40227A:				; CODE XREF: sub_4021F5+77j
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_402284:				; CODE XREF: sub_4021F5+79j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		add	[ebp+var_C], 1
		cmp	eax, 13h	; switch 20 cases
		ja	loc_4026EF	; jumptable 004022A7 default case
		mov	eax, ds:off_409668[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4022A9:				; CODE XREF: sub_4021F5+B2j
					; DATA XREF: .rdata:off_409668o
		mov	eax, [ebp+arg_0] ; jumptable 004022A7 case 1
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_4022FF
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_4022FF:				; CODE XREF: sub_4021F5+FEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	loc_402728
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_402359:				; CODE XREF: sub_4021F5+B2j
					; DATA XREF: .rdata:off_409668o
		mov	eax, [ebp+arg_0] ; jumptable 004022A7 case 16
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_4023AF
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_4023AF:				; CODE XREF: sub_4021F5+1AEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_402405
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_402405:				; CODE XREF: sub_4021F5+204j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	loc_40272B
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_40245F:				; CODE XREF: sub_4021F5+B2j
					; DATA XREF: .rdata:off_409668o
		mov	eax, [ebp+arg_0] ; jumptable 004022A7 case 17
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_4024B5
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_4024B5:				; CODE XREF: sub_4021F5+2B4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_40250B
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_40250B:				; CODE XREF: sub_4021F5+30Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_402561
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_402561:				; CODE XREF: sub_4021F5+360j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	loc_40272E
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_4025BB:				; CODE XREF: sub_4021F5+B2j
					; DATA XREF: .rdata:off_409668o
		mov	eax, [ebp+arg_0] ; jumptable 004022A7 case 18
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_4025E8
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_4025E8:				; CODE XREF: sub_4021F5+3E7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_40263E
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_40263E:				; CODE XREF: sub_4021F5+43Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	loc_402731
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_40266F:				; CODE XREF: sub_4021F5+B2j
					; DATA XREF: .rdata:off_409668o
		mov	eax, [ebp+arg_0] ; jumptable 004022A7 case 19
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_40269C
		mov	eax, 0FFFFFFFFh
		jmp	locret_402738
; ---------------------------------------------------------------------------

loc_40269C:				; CODE XREF: sub_4021F5+49Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		add	eax, [ebp+var_C]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		ja	short loc_402734
		mov	eax, 0FFFFFFFFh
		jmp	short locret_402738
; ---------------------------------------------------------------------------

loc_4026EF:				; CODE XREF: sub_4021F5+A5j
					; sub_4021F5+B2j
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 004022A7 default case
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		sub	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aUnableToParseA ; "Unable to parse algorithm %u\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+Count], edx
		mov	[esp+28h+Size],	eax ; Format
		mov	[esp+28h+Str], ecx ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	short locret_402738
; ---------------------------------------------------------------------------

loc_402728:				; CODE XREF: sub_4021F5+154j
		nop
		jmp	short loc_402735
; ---------------------------------------------------------------------------

loc_40272B:				; CODE XREF: sub_4021F5+25Aj
		nop
		jmp	short loc_402735
; ---------------------------------------------------------------------------

loc_40272E:				; CODE XREF: sub_4021F5+3B6j
		nop
		jmp	short loc_402735
; ---------------------------------------------------------------------------

loc_402731:				; CODE XREF: sub_4021F5+46Aj
		nop
		jmp	short loc_402735
; ---------------------------------------------------------------------------

loc_402734:				; CODE XREF: sub_4021F5+4F1j
		nop

loc_402735:				; CODE XREF: sub_4021F5+534j
					; sub_4021F5+537j ...
		mov	eax, [ebp+var_C]

locret_402738:				; CODE XREF: sub_4021F5+15j
					; sub_4021F5+55j ...
		leave
		retn
sub_4021F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40273A(FILE *, int)
sub_40273A	proc near		; CODE XREF: sub_403180+9Fp

DstBuf		= dword	ptr -468h
ElementSize	= dword	ptr -464h
Count		= dword	ptr -460h
File		= dword	ptr -45Ch
var_458		= dword	ptr -458h
Str		= byte ptr -440h
var_40		= dword	ptr -40h
var_39		= byte ptr -39h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Src		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 464h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 2
		jnz	loc_402883
		jmp	short loc_402784
; ---------------------------------------------------------------------------

loc_402765:				; CODE XREF: sub_40273A+76j
		mov	eax, [ebp+var_24]
		mov	[esp+468h+Count], eax ;	size_t
		lea	eax, [ebp+Str]
		mov	[esp+468h+ElementSize],	eax ; void *
		mov	eax, [ebp+var_C]
		mov	[esp+468h+DstBuf], eax ; int
		call	sub_401BE0
		mov	[ebp+var_C], eax

loc_402784:				; CODE XREF: sub_40273A+29j
		lea	eax, [ebp+Str]
		mov	edx, [ebp+arg_0]
		mov	[esp+468h+File], edx ; File
		mov	[esp+468h+Count], 400h ; Count
		mov	[esp+468h+ElementSize],	1 ; ElementSize
		mov	[esp+468h+DstBuf], eax ; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_402765
		cmp	[ebp+var_24], 0
		jnz	short loc_402805
		mov	eax, [ebp+arg_0]
		mov	[esp+468h+DstBuf], eax ; File
		call	feof
		test	eax, eax
		jnz	short loc_402805
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aErrorUnableToR ; "Error: unable to	read secrets file\n"
		mov	[esp+468h+File], edx ; File
		mov	[esp+468h+Count], 23h ;	Count
		mov	[esp+468h+ElementSize],	1 ; Size
		mov	[esp+468h+DstBuf], eax ; Str
		call	fwrite
		mov	eax, [ebp+var_C]
		mov	[esp+468h+DstBuf], eax ; void *
		call	sub_401CD4
		mov	eax, 0
		jmp	loc_402BF4
; ---------------------------------------------------------------------------

loc_402805:				; CODE XREF: sub_40273A+7Cj
					; sub_40273A+8Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		cmp	eax, 2
		jbe	loc_402B17
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		sub	eax, 3
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		sub	eax, 2
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		or	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		sub	eax, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	[ebp+var_14], eax
		mov	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		lea	edx, [eax-3]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		jmp	loc_402B17
; ---------------------------------------------------------------------------

loc_402883:				; CODE XREF: sub_40273A+23j
		mov	[ebp+var_18], 1
		jmp	loc_402AF2
; ---------------------------------------------------------------------------

loc_40288F:				; CODE XREF: sub_40273A+3D7j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_30], 0B704CEh
		movzx	eax, [ebp+Str]
		cmp	al, 23h
		jz	loc_402AF1
		movzx	eax, [ebp+Str]
		cmp	al, 0Ah
		jz	loc_402AF1
		movzx	eax, [ebp+Str]
		cmp	al, 0Dh
		jz	loc_402AF1
		lea	eax, [ebp+Str]
		mov	[esp+468h+DstBuf], eax ; Str
		call	atoi
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_18]
		jz	short loc_402920
		mov	eax, offset aErrorMissingLi ; "Error: missing line number %u (saw %u)\"...
		mov	edx, ds:_iob
		lea	ecx, [edx+40h]
		mov	edx, [ebp+var_28]
		mov	[esp+468h+File], edx
		mov	edx, [ebp+var_18]
		mov	[esp+468h+Count], edx
		mov	[esp+468h+ElementSize],	eax ; Format
		mov	[esp+468h+DstBuf], ecx ; File
		call	fprintf
		mov	eax, [ebp+var_C]
		mov	[esp+468h+DstBuf], eax ; void *
		call	sub_401CD4
		mov	eax, 0
		jmp	loc_402BF4
; ---------------------------------------------------------------------------

loc_402920:				; CODE XREF: sub_40273A+1A7j
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_18], eax
		mov	[esp+468h+ElementSize],	3Ah ; Val
		lea	eax, [ebp+Str]
		mov	[esp+468h+DstBuf], eax ; Str
		call	strchr
		mov	[ebp+Src], eax
		cmp	[ebp+Src], 0
		jz	loc_402ABB
		mov	[esp+468h+ElementSize],	20h ; Val
		mov	eax, [ebp+Src]
		mov	[esp+468h+DstBuf], eax ; Str
		call	strchr
		mov	[ebp+Src], eax
		jmp	loc_402AAF
; ---------------------------------------------------------------------------

loc_402967:				; CODE XREF: sub_40273A+23Cj
		add	[ebp+Src], 1
		jmp	short loc_40296E
; ---------------------------------------------------------------------------

loc_40296D:				; CODE XREF: sub_40273A+379j
		nop

loc_40296E:				; CODE XREF: sub_40273A+231j
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402967
		mov	[esp+468h+ElementSize],	20h ; Val
		mov	eax, [ebp+Src]
		mov	[esp+468h+DstBuf], eax ; Str
		call	strchr
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	loc_402A46
		mov	edx, offset a06lx ; "%06lX"
		mov	eax, [ebp+Src]
		lea	ecx, [ebp+var_34]
		mov	[esp+468h+Count], ecx
		mov	[esp+468h+ElementSize],	edx ; Format
		mov	[esp+468h+DstBuf], eax ; Src
		call	sscanf
		test	eax, eax
		jz	loc_402AA9
		cmp	[ebp+var_1C], 0
		jz	short loc_402A37
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		xor	eax, edx
		and	eax, 0FFFFFFh
		test	eax, eax
		jz	loc_402AA9
		mov	eax, [ebp+var_30]
		mov	ebx, eax
		and	ebx, 0FFFFFFh
		mov	eax, [ebp+var_34]
		mov	edx, eax
		and	edx, 0FFFFFFh
		mov	eax, offset aCrcOnLineDDoes ; "CRC on line %d does not match (%06lX!=%"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+468h+var_458], ebx
		mov	[esp+468h+File], edx
		mov	edx, [ebp+var_28]
		mov	[esp+468h+Count], edx
		mov	[esp+468h+ElementSize],	eax ; Format
		mov	[esp+468h+DstBuf], ecx ; File
		call	fprintf
		mov	eax, ds:dword_40B024
		test	eax, eax
		jnz	loc_402AA9
		mov	eax, [ebp+var_C]
		mov	[esp+468h+DstBuf], eax ; void *
		call	sub_401CD4
		mov	eax, 0
		jmp	loc_402BF4
; ---------------------------------------------------------------------------

loc_402A37:				; CODE XREF: sub_40273A+285j
		mov	[ebp+var_10], 1
		mov	eax, [ebp+var_34]
		mov	[ebp+var_14], eax
		jmp	short loc_402AA9
; ---------------------------------------------------------------------------

loc_402A46:				; CODE XREF: sub_40273A+258j
		mov	edx, offset a02x ; "%02X"
		mov	eax, [ebp+Src]
		lea	ecx, [ebp+var_38]
		mov	[esp+468h+Count], ecx
		mov	[esp+468h+ElementSize],	edx ; Format
		mov	[esp+468h+DstBuf], eax ; Src
		call	sscanf
		test	eax, eax
		jz	short loc_402AA9
		mov	eax, [ebp+var_38]
		mov	[ebp+var_39], al
		mov	[esp+468h+Count], 1 ; size_t
		lea	eax, [ebp+var_39]
		mov	[esp+468h+ElementSize],	eax ; void *
		mov	eax, [ebp+var_C]
		mov	[esp+468h+DstBuf], eax ; int
		call	sub_401BE0
		mov	[ebp+var_C], eax
		mov	[esp+468h+Count], 1
		lea	eax, [ebp+var_39]
		mov	[esp+468h+ElementSize],	eax
		lea	eax, [ebp+var_30]
		mov	[esp+468h+DstBuf], eax
		call	sub_40344C
		mov	[ebp+var_1C], 1

loc_402AA9:				; CODE XREF: sub_40273A+27Bj
					; sub_40273A+296j ...
		mov	eax, [ebp+var_2C]
		mov	[ebp+Src], eax

loc_402AAF:				; CODE XREF: sub_40273A+228j
		cmp	[ebp+Src], 0
		jnz	loc_40296D
		jmp	short loc_402AF2
; ---------------------------------------------------------------------------

loc_402ABB:				; CODE XREF: sub_40273A+20Cj
		mov	eax, offset aNoColonFoundIn ; "No colon	':' found in line %u\n"
		mov	edx, ds:_iob
		lea	ecx, [edx+40h]
		mov	edx, [ebp+var_28]
		mov	[esp+468h+Count], edx
		mov	[esp+468h+ElementSize],	eax ; Format
		mov	[esp+468h+DstBuf], ecx ; File
		call	fprintf
		mov	eax, [ebp+var_C]
		mov	[esp+468h+DstBuf], eax ; void *
		call	sub_401CD4
		mov	eax, 0
		jmp	loc_402BF4
; ---------------------------------------------------------------------------

loc_402AF1:				; CODE XREF: sub_40273A+16Cj
					; sub_40273A+17Bj ...
		nop

loc_402AF2:				; CODE XREF: sub_40273A+150j
					; sub_40273A+37Fj
		mov	eax, [ebp+arg_0]
		mov	[esp+468h+Count], eax ;	File
		mov	[esp+468h+ElementSize],	400h ; MaxCount
		lea	eax, [ebp+Str]
		mov	[esp+468h+DstBuf], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_40288F

loc_402B17:				; CODE XREF: sub_40273A+D4j
					; sub_40273A+144j
		cmp	[ebp+var_10], 0
		jz	loc_402BAD
		mov	[ebp+var_40], 0B704CEh
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+468h+Count], edx
		mov	[esp+468h+ElementSize],	eax
		lea	eax, [ebp+var_40]
		mov	[esp+468h+DstBuf], eax
		call	sub_40344C
		mov	eax, [ebp+var_40]
		xor	eax, [ebp+var_14]
		and	eax, 0FFFFFFh
		test	eax, eax
		jz	loc_402BF1
		mov	eax, [ebp+var_40]
		mov	ebx, eax
		and	ebx, 0FFFFFFh
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		and	ecx, 0FFFFFFh
		mov	eax, offset aCrcOfSecretDoe ; "CRC of secret does not match (%06lX!=%0"...
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+468h+File], ebx
		mov	[esp+468h+Count], ecx
		mov	[esp+468h+ElementSize],	eax ; Format
		mov	[esp+468h+DstBuf], edx ; File
		call	fprintf
		mov	eax, ds:dword_40B024
		test	eax, eax
		jnz	short loc_402BF1
		mov	eax, [ebp+var_C]
		mov	[esp+468h+DstBuf], eax ; void *
		call	sub_401CD4
		mov	eax, 0
		jmp	short loc_402BF4
; ---------------------------------------------------------------------------

loc_402BAD:				; CODE XREF: sub_40273A+3E1j
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aCrcOfSecretIsM ; "CRC of secret is	missing\n"
		mov	[esp+468h+File], edx ; File
		mov	[esp+468h+Count], 19h ;	Count
		mov	[esp+468h+ElementSize],	1 ; Size
		mov	[esp+468h+DstBuf], eax ; Str
		call	fwrite
		mov	eax, ds:dword_40B024
		test	eax, eax
		jnz	short loc_402BF1
		mov	eax, [ebp+var_C]
		mov	[esp+468h+DstBuf], eax ; void *
		call	sub_401CD4
		mov	eax, 0
		jmp	short loc_402BF4
; ---------------------------------------------------------------------------

loc_402BF1:				; CODE XREF: sub_40273A+41Aj
					; sub_40273A+45Fj ...
		mov	eax, [ebp+var_C]

loc_402BF4:				; CODE XREF: sub_40273A+C6j
					; sub_40273A+1E1j ...
		add	esp, 464h
		pop	ebx
		pop	ebp
		retn
sub_40273A	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402C00(FILE *, char *, int)
sub_402C00	proc near		; CODE XREF: sub_401600+574p

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_25		= byte ptr -25h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_25], 0
		mov	[esp+38h+Count], 0 ; int
		mov	[esp+38h+Size],	5 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_401CFC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_402C61
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aUnableToFindSe ; "Unable to find secret key packet\n"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 21h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	eax, 1
		jmp	locret_402F3F
; ---------------------------------------------------------------------------

loc_402C61:				; CODE XREF: sub_402C00+2Cj
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_4021F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_402C7F
		mov	eax, 1
		jmp	locret_402F3F
; ---------------------------------------------------------------------------

loc_402C7F:				; CODE XREF: sub_402C00+73j
		mov	eax, ds:dword_40B020
		cmp	eax, 1
		jle	short loc_402CAA
		mov	eax, offset aSecretOffsetIs ; "Secret offset is	%d\n"
		mov	edx, ds:_iob
		lea	ecx, [edx+40h]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Count], edx
		mov	[esp+38h+Size],	eax ; Format
		mov	[esp+38h+Str], ecx ; File
		call	fprintf

loc_402CAA:				; CODE XREF: sub_402C00+87j
		mov	eax, [ebp+var_10]
		lea	edx, [ebp+var_24]
		mov	[esp+38h+Count], edx ; int
		mov	[esp+38h+Size],	eax ; size_t
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; int
		call	sub_40214F
		mov	eax, ds:dword_40B020
		test	eax, eax
		jz	short loc_402D2C
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aPrimaryKeyFing ; "Primary key fingerprint:	"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 19h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	[esp+38h+Count], 14h ; int
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Size],	eax ; int
		mov	[esp+38h+Str], edx ; FILE *
		call	sub_403629
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+38h+Size],	eax ; File
		mov	[esp+38h+Str], 0Ah ; Ch
		call	fputc

loc_402D2C:				; CODE XREF: sub_402C00+CAj
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Count], eax ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_40385A
		mov	[esp+38h+Size],	1 ; size_t
		lea	eax, [ebp+var_25]
		mov	[esp+38h+Str], eax ; void *
		call	sub_403A3E
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+38h+Size],	1 ; size_t
		mov	[esp+38h+Str], eax ; void *
		call	sub_403A3E
		mov	[esp+38h+Size],	14h ; size_t
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Str], eax ; void *
		call	sub_403A3E
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+38h+Str], eax
		call	sub_403B1B
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		sub	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		add	eax, ecx
		mov	[esp+38h+Size],	edx ; size_t
		mov	[esp+38h+Str], eax ; void *
		call	sub_403A3E
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; void *
		call	sub_401CD4
		jmp	loc_402EF2
; ---------------------------------------------------------------------------

loc_402DCA:				; CODE XREF: sub_402C00+314j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_4021F5
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_40B020
		cmp	eax, 1
		jle	short loc_402E03
		mov	eax, offset aSecretSubkeyOf ; "Secret subkey offset is %d\n"
		mov	edx, ds:_iob
		lea	ecx, [edx+40h]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Count], edx
		mov	[esp+38h+Size],	eax ; Format
		mov	[esp+38h+Str], ecx ; File
		call	fprintf

loc_402E03:				; CODE XREF: sub_402C00+1E0j
		mov	eax, [ebp+var_10]
		lea	edx, [ebp+var_24]
		mov	[esp+38h+Count], edx ; int
		mov	[esp+38h+Size],	eax ; size_t
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; int
		call	sub_40214F
		mov	eax, ds:dword_40B020
		test	eax, eax
		jz	short loc_402E85
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSubkeyFingerpr ; "Subkey fingerprint: "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 14h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	[esp+38h+Count], 14h ; int
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Size],	eax ; int
		mov	[esp+38h+Str], edx ; FILE *
		call	sub_403629
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+38h+Size],	eax ; File
		mov	[esp+38h+Str], 0Ah ; Ch
		call	fputc

loc_402E85:				; CODE XREF: sub_402C00+223j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+38h+Size],	1 ; size_t
		mov	[esp+38h+Str], eax ; void *
		call	sub_403A3E
		mov	[esp+38h+Size],	14h ; size_t
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Str], eax ; void *
		call	sub_403A3E
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+38h+Str], eax
		call	sub_403B1B
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		sub	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		add	eax, ecx
		mov	[esp+38h+Size],	edx ; size_t
		mov	[esp+38h+Str], eax ; void *
		call	sub_403A3E
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; void *
		call	sub_401CD4

loc_402EF2:				; CODE XREF: sub_402C00+1C5j
		mov	[esp+38h+Count], 5 ; int
		mov	[esp+38h+Size],	7 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_401CFC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_402DCA
		call	sub_403C9E
		mov	eax, ds:_iob
		cmp	[ebp+arg_0], eax
		jnz	short loc_402F3A
		nop

loc_402F2A:				; CODE XREF: sub_402C00+338j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; File
		call	fgetc
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_402F2A

loc_402F3A:				; CODE XREF: sub_402C00+327j
		mov	eax, 0

locret_402F3F:				; CODE XREF: sub_402C00+5Cj
					; sub_402C00+7Aj
		leave
		retn
sub_402C00	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402F44	proc near		; CODE XREF: sub_403180+BEp

File		= dword	ptr -28h
Format		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
Memory		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_403133
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_403133
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aCannotHandleSe ; "Cannot handle secrets file version %d\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+Count], edx
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		mov	eax, 0
		jmp	locret_403146
; ---------------------------------------------------------------------------

loc_402FAB:				; CODE XREF: sub_402F44+1F9j
		mov	eax, [ebp+var_10]
		lea	edx, [eax+17h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		ja	loc_403108
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 4
		jnz	loc_4030DD
		mov	[esp+28h+Format], 1Ch ;	size_t
		mov	[esp+28h+File],	0 ; void *
		call	sub_401B8C
		mov	[ebp+Memory], eax
		mov	eax, [ebp+Memory]
		mov	dword ptr [eax+18h], 0
		add	[ebp+var_10], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+Memory]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [edx+10h]
		mov	[eax+10h], edx
		add	[ebp+var_10], 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		mov	[ebp+var_18], eax
		add	[ebp+var_10], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	[ebp+var_18], eax
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_10]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		ja	short loc_4030A7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+var_10]
		mov	edx, [ebp+var_18]
		mov	[esp+28h+Count], edx ; size_t
		mov	[esp+28h+Format], eax ;	void *
		mov	[esp+28h+File],	0 ; int
		call	sub_401BE0
		mov	edx, [ebp+Memory]
		mov	[edx+14h], eax
		mov	eax, [ebp+var_18]
		add	[ebp+var_10], eax
		mov	eax, [ebp+Memory]
		mov	edx, [ebp+var_C]
		mov	[eax+18h], edx
		mov	eax, [ebp+Memory]
		mov	[ebp+var_C], eax
		jmp	loc_403134
; ---------------------------------------------------------------------------

loc_4030A7:				; CODE XREF: sub_402F44+121j
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aWarningShortDa ; "Warning:	Short data in secret image\n"
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 24h ; Count
		mov	[esp+28h+Format], 1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, [ebp+Memory]
		mov	[esp+28h+File],	eax ; Memory
		call	free
		jmp	short loc_403143
; ---------------------------------------------------------------------------

loc_4030DD:				; CODE XREF: sub_402F44+89j
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aWarningCorrupt ; "Warning:	Corrupt	data in	secret image\n"
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 26h ; Count
		mov	[esp+28h+Format], 1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		jmp	short loc_403143
; ---------------------------------------------------------------------------

loc_403108:				; CODE XREF: sub_402F44+75j
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aWarningShortHe ; "Warning:	Short header in	secret image\n"
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 26h ; Count
		mov	[esp+28h+Format], 1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		jmp	short loc_403143
; ---------------------------------------------------------------------------

loc_403133:				; CODE XREF: sub_402F44+1Cj
					; sub_402F44+2Dj
		nop

loc_403134:				; CODE XREF: sub_402F44+15Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_10]
		ja	loc_402FAB

loc_403143:				; CODE XREF: sub_402F44+197j
					; sub_402F44+1C2j ...
		mov	eax, [ebp+var_C]

locret_403146:				; CODE XREF: sub_402F44+62j
		leave
		retn
sub_402F44	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403148	proc near		; CODE XREF: sub_403180+25Dp

Memory		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_403178
; ---------------------------------------------------------------------------

loc_403150:				; CODE XREF: sub_403148+34j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+28h+Memory], eax ;	void *
		call	sub_401CD4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free

loc_403178:				; CODE XREF: sub_403148+6j
		cmp	[ebp+arg_0], 0
		jnz	short loc_403150
		leave
		retn
sub_403148	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403180(FILE *, FILE *, int, char *)
sub_403180	proc near		; CODE XREF: sub_401600+552p

File		= dword	ptr -48h
Size		= dword	ptr -44h
Count		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
Buf1		= byte ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
C		= dword	ptr -18h
Buf2		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_8], 0
		jnz	loc_403212
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+File],	eax ; File
		call	fgetc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_4031D7
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aUnableToCheckT ; "Unable to check type of secrets file\n"
		mov	[esp+48h+var_3C], edx ;	File
		mov	[esp+48h+Count], 25h ; Count
		mov	[esp+48h+Size],	1 ; Size
		mov	[esp+48h+File],	eax ; Str
		call	fwrite
		mov	eax, 1
		jmp	locret_403447
; ---------------------------------------------------------------------------

loc_4031D7:				; CODE XREF: sub_403180+22j
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_4031F9
		mov	eax, [ebp+C]
		mov	[esp+48h+File],	eax ; C
		mov	eax, ds:isprint
		call	eax ; isprint
		test	eax, eax
		jz	short loc_4031F9
		mov	[ebp+arg_8], 1
		jmp	short loc_403200
; ---------------------------------------------------------------------------

loc_4031F9:				; CODE XREF: sub_403180+5Dj
					; sub_403180+6Ej
		mov	[ebp+arg_8], 2

loc_403200:				; CODE XREF: sub_403180+77j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Size],	eax ; File
		mov	eax, [ebp+C]
		mov	[esp+48h+File],	eax ; Ch
		call	ungetc

loc_403212:				; CODE XREF: sub_403180+Aj
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Size],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+File],	eax ; FILE *
		call	sub_40273A
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_403419
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+File],	eax
		call	sub_402F44
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_4033E9
		mov	[esp+48h+Count], 0 ; int
		mov	[esp+48h+Size],	2 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+File],	eax ; char *
		call	sub_40385A
		jmp	loc_4033AC
; ---------------------------------------------------------------------------

loc_403270:				; CODE XREF: sub_403180+24Ej
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 6
		jz	short loc_403288
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Eh
		jnz	loc_403368

loc_403288:				; CODE XREF: sub_403180+F8j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 6
		jnz	short loc_40329C
		cmp	[ebp+var_C], 0
		jnz	loc_4033D6

loc_40329C:				; CODE XREF: sub_403180+110j
		mov	eax, [ebp+var_24]
		mov	eax, [eax+8]
		lea	edx, [ebp+Buf1]
		mov	[esp+48h+Count], edx ; int
		mov	[esp+48h+Size],	eax ; size_t
		mov	eax, [ebp+var_24]
		mov	[esp+48h+File],	eax ; int
		call	sub_40214F
		mov	eax, [ebp+var_20]
		mov	[ebp+Buf2], eax
		jmp	loc_40335C
; ---------------------------------------------------------------------------

loc_4032C3:				; CODE XREF: sub_403180+1E0j
		mov	eax, [ebp+Buf2]
		mov	[esp+48h+Count], 14h ; Size
		mov	[esp+48h+Size],	eax ; Buf2
		lea	eax, [ebp+Buf1]
		mov	[esp+48h+File],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_403353
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 6
		jnz	short loc_4032F8
		mov	[ebp+var_D], 5
		mov	[ebp+var_C], 1
		jmp	short loc_4032FC
; ---------------------------------------------------------------------------

loc_4032F8:				; CODE XREF: sub_403180+169j
		mov	[ebp+var_D], 7

loc_4032FC:				; CODE XREF: sub_403180+176j
		mov	eax, [ebp+var_24]
		mov	edx, [eax+8]
		mov	eax, [ebp+Buf2]
		mov	eax, [eax+14h]
		mov	eax, [eax+8]
		add	edx, eax
		movzx	eax, [ebp+var_D]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+File],	eax
		call	sub_403B6A
		mov	eax, [ebp+var_24]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_24]
		mov	eax, [eax+4]
		mov	[esp+48h+Size],	edx ; size_t
		mov	[esp+48h+File],	eax ; void *
		call	sub_403A3E
		mov	eax, [ebp+Buf2]
		mov	eax, [eax+14h]
		mov	edx, [eax+8]
		mov	eax, [ebp+Buf2]
		mov	eax, [eax+14h]
		mov	eax, [eax+4]
		mov	[esp+48h+Size],	edx ; size_t
		mov	[esp+48h+File],	eax ; void *
		call	sub_403A3E

loc_403353:				; CODE XREF: sub_403180+15Fj
		mov	eax, [ebp+Buf2]
		mov	eax, [eax+18h]
		mov	[ebp+Buf2], eax

loc_40335C:				; CODE XREF: sub_403180+13Ej
		cmp	[ebp+Buf2], 0
		jnz	loc_4032C3
		jmp	short loc_4033A1
; ---------------------------------------------------------------------------

loc_403368:				; CODE XREF: sub_403180+102j
		cmp	[ebp+var_C], 0
		jz	short loc_4033A1
		mov	eax, [ebp+var_24]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+File],	eax
		call	sub_403B6A
		mov	eax, [ebp+var_24]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_24]
		mov	eax, [eax+4]
		mov	[esp+48h+Size],	edx ; size_t
		mov	[esp+48h+File],	eax ; void *
		call	sub_403A3E

loc_4033A1:				; CODE XREF: sub_403180+1E6j
					; sub_403180+1ECj
		mov	eax, [ebp+var_24]
		mov	[esp+48h+File],	eax ; void *
		call	sub_401CD4

loc_4033AC:				; CODE XREF: sub_403180+EBj
		mov	[esp+48h+Count], 0 ; int
		mov	[esp+48h+Size],	0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+File],	eax ; FILE *
		call	sub_401CFC
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	loc_403270
		jmp	short loc_4033D7
; ---------------------------------------------------------------------------

loc_4033D6:				; CODE XREF: sub_403180+116j
		nop

loc_4033D7:				; CODE XREF: sub_403180+254j
		mov	eax, [ebp+var_20]
		mov	[esp+48h+File],	eax
		call	sub_403148
		mov	eax, 0
		jmp	short locret_403447
; ---------------------------------------------------------------------------

loc_4033E9:				; CODE XREF: sub_403180+CAj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aUnableToParseS ; "Unable to parse secret data\n"
		mov	[esp+48h+var_3C], edx ;	File
		mov	[esp+48h+Count], 1Ch ; Count
		mov	[esp+48h+Size],	1 ; Size
		mov	[esp+48h+File],	eax ; Str
		call	fwrite
		mov	eax, 1
		jmp	short locret_403447
; ---------------------------------------------------------------------------

loc_403419:				; CODE XREF: sub_403180+ABj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aUnableToReadSe ; "Unable to read secrets file\n"
		mov	[esp+48h+var_3C], edx ;	File
		mov	[esp+48h+Count], 1Ch ; Count
		mov	[esp+48h+Size],	1 ; Size
		mov	[esp+48h+File],	eax ; Str
		call	fwrite
		mov	eax, 1

locret_403447:				; CODE XREF: sub_403180+52j
					; sub_403180+267j ...
		leave
		retn
sub_403180	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40344C	proc near		; CODE XREF: sub_40273A+363p
					; sub_40273A+408p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		jmp	short loc_4034BC
; ---------------------------------------------------------------------------

loc_40345B:				; CODE XREF: sub_40344C+76j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+var_4]
		mov	ecx, [ebp+arg_4]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		xor	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[ebp+var_8], 0
		jmp	short loc_4034B2
; ---------------------------------------------------------------------------

loc_403481:				; CODE XREF: sub_40344C+6Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		lea	edx, [eax+eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 1000000h
		test	eax, eax
		jz	short loc_4034AE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		xor	edx, 864CFBh
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_4034AE:				; CODE XREF: sub_40344C+4Ej
		add	[ebp+var_8], 1

loc_4034B2:				; CODE XREF: sub_40344C+33j
		cmp	[ebp+var_8], 7
		jle	short loc_403481
		add	[ebp+var_4], 1

loc_4034BC:				; CODE XREF: sub_40344C+Dj
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+arg_8]
		jb	short loc_40345B
		leave
		retn
sub_40344C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4034C6	proc near		; CODE XREF: sub_403A3E+CCp

File		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	[ebp+arg_0], 0
		jz	loc_4035C9
		mov	[ebp+var_C], 0
		jmp	loc_4035BB
; ---------------------------------------------------------------------------

loc_4034E3:				; CODE XREF: sub_4034C6+FBj
		mov	eax, ds:dword_40B038
		mov	ecx, ds:dword_40B034
		mov	edx, 0
		div	ecx
		mov	eax, edx
		test	eax, eax
		jnz	short loc_403562
		mov	eax, ds:dword_40B03C
		test	eax, eax
		jz	short loc_403535
		mov	eax, dword_408104
		mov	ecx, eax
		and	ecx, 0FFFFFFh
		mov	edx, offset a06lx_0 ; "%06lX\n"
		mov	eax, ds:File
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	eax ; File
		call	fprintf
		mov	dword_408104, 0B704CEh

loc_403535:				; CODE XREF: sub_4034C6+3Cj
		mov	eax, ds:dword_40B03C
		add	eax, 1
		mov	ds:dword_40B03C, eax
		mov	ecx, ds:dword_40B03C
		mov	edx, offset a3u	; "%3u:	"
		mov	eax, ds:File
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	eax ; File
		call	fprintf

loc_403562:				; CODE XREF: sub_4034C6+33j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	ecx, al
		mov	edx, offset a02x_0 ; "%02X "
		mov	eax, ds:File
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	eax ; File
		call	fprintf
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+Format], eax
		mov	[esp+28h+File],	offset dword_408104
		call	sub_40344C
		add	[ebp+var_C], 1
		mov	eax, ds:dword_40B038
		add	eax, 1
		mov	ds:dword_40B038, eax

loc_4035BB:				; CODE XREF: sub_4034C6+18j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_4034E3
		jmp	short loc_403623
; ---------------------------------------------------------------------------

loc_4035C9:				; CODE XREF: sub_4034C6+Bj
		mov	eax, dword_408104
		mov	ecx, eax
		and	ecx, 0FFFFFFh
		mov	edx, offset a06lx_0 ; "%06lX\n"
		mov	eax, ds:File
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	eax ; File
		call	fprintf
		mov	eax, dword_408100
		mov	ebx, eax
		and	ebx, 0FFFFFFh
		mov	eax, ds:dword_40B03C
		lea	ecx, [eax+1]
		mov	edx, offset a3u06lx ; "%3u: %06lX\n"
		mov	eax, ds:File
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	eax ; File
		call	fprintf

loc_403623:				; CODE XREF: sub_4034C6+101j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_4034C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403629(FILE *, int, int)
sub_403629	proc near		; CODE XREF: sub_402C00+10Fp
					; sub_402C00+268p ...

File		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_403662
; ---------------------------------------------------------------------------

loc_403638:				; CODE XREF: sub_403629+3Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x_1 ; "%02X"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		call	fprintf
		add	[ebp+var_C], 1

loc_403662:				; CODE XREF: sub_403629+Dj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_403638
		leave
		retn
sub_403629	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40366C(FILE *, int)
sub_40366C	proc near		; CODE XREF: sub_401600+4CFp
					; sub_40385A+160p

File		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, offset aSfileFormat ; "%sFile format:\n"
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSa1OctetVersio ; "%sa) 1 octet:  Version of the paperkey "...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSb1OctetOpenpg ; "%sb) 1 octet:  OpenPGP key or subkey ve"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aScNOctetsKeyFi ; "%sc) n octets: Key fingerprint (20 octe"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSd2Octets16Bit ; "%sd) 2 octets: 16-bit big endian	length"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSeNOctetsSecre ; "%se) n octets: Secret data: a partial O"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSSpecifiedInRf ; "%s	      specified	in RFC 4880, s"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSOctetAndConti ; "%s	      octet and	continuing unt"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSrepeatFieldsB ; "%sRepeat	fields b through e as needed t"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aS	; "%s\n"
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aStoRecoverASec ; "%sTo recover a secret key without using"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSkeyFingerprin ; "%skey fingerprint to match an existing "...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aScorresponding ; "%scorresponding secret data from	the pa"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSdataToThePubl ; "%sdata to the public key	packet.	 Final"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSfrom6To514To7 ; "%sfrom 6	to 5 (14 to 7 for subkeys).  T"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSkeyOrSecretSu ; "%skey or	secret subkey packet.  Repeat "...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSpacketsInTheP ; "%spackets in the	public key.  All other"...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		mov	eax, offset aSmaySimplyBeCo ; "%smay simply be copied from the public "...
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		leave
		retn
sub_40366C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40385A(char *, int, int)
sub_40385A	proc near		; CODE XREF: sub_402C00+140p
					; sub_403180+E6p

Filename	= dword	ptr -38h
Mode		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_4038B3
		cmp	[ebp+arg_4], 2
		jnz	short loc_403887
		mov	eax, offset aWb	; "wb"
		mov	[esp+38h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Filename], eax	; Filename
		call	fopen
		mov	ds:File, eax
		jmp	short loc_4038A0
; ---------------------------------------------------------------------------

loc_403887:				; CODE XREF: sub_40385A+10j
		mov	eax, offset aW	; "w"
		mov	[esp+38h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Filename], eax	; Filename
		call	fopen
		mov	ds:File, eax

loc_4038A0:				; CODE XREF: sub_40385A+2Bj
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4038C0
		mov	eax, 0FFFFFFFFh
		jmp	locret_403A3C
; ---------------------------------------------------------------------------

loc_4038B3:				; CODE XREF: sub_40385A+Aj
		mov	eax, ds:_iob
		add	eax, 20h
		mov	ds:File, eax

loc_4038C0:				; CODE XREF: sub_40385A+4Dj
		mov	eax, [ebp+arg_4]
		mov	ds:dword_40B02C, eax
		mov	eax, [ebp+arg_4]
		cmp	eax, 1
		jbe	short loc_4038D8
		cmp	eax, 2
		jmp	loc_403A37
; ---------------------------------------------------------------------------

loc_4038D8:				; CODE XREF: sub_40385A+74j
		mov	[esp+38h+Filename], 0
		call	sub_4078F0
		mov	[ebp+var_C], eax
		mov	eax, dword_408000
		sub	eax, 0Bh
		mov	[ebp+var_1C], eax
		mov	edx, 0AAAAAAABh
		mov	eax, [ebp+var_1C]
		mul	edx
		mov	eax, edx
		shr	eax, 1
		mov	ds:dword_40B034, eax
		mov	edx, ds:File
		mov	eax, offset aSecretPortions ; "# Secret	portions of key	"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 19h ; Count
		mov	[esp+38h+Mode],	1 ; Size
		mov	[esp+38h+Filename], eax	; Str
		call	fwrite
		mov	eax, ds:File
		mov	[esp+38h+Count], 14h ; int
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Mode],	edx ; int
		mov	[esp+38h+Filename], eax	; FILE *
		call	sub_403629
		mov	eax, ds:File
		mov	[esp+38h+Mode],	eax ; File
		mov	[esp+38h+Filename], 0Ah	; Ch
		call	fputc
		lea	eax, [ebp+var_C]
		mov	[esp+38h+Filename], eax
		call	sub_407900
		mov	ecx, offset aBase16DataExtr ; "# Base16	data extracted %.24s\n"
		mov	edx, ds:File
		mov	[esp+38h+Count], eax
		mov	[esp+38h+Mode],	ecx ; Format
		mov	[esp+38h+Filename], edx	; File
		call	fprintf
		mov	edx, ds:File
		mov	eax, offset aCreatedWithPap ; "# Created with paperkey 1.3 by David Sh"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Ch ; Count
		mov	[esp+38h+Mode],	1 ; Size
		mov	[esp+38h+Filename], eax	; Str
		call	fwrite
		mov	eax, ds:File
		mov	[esp+38h+Mode],	offset asc_409E49 ; "# "
		mov	[esp+38h+Filename], eax	; FILE *
		call	sub_40366C
		mov	edx, ds:File
		mov	eax, offset aEachBase16Line ; "#\n# Each base16	line ends with a CRC-2"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 36h ; Count
		mov	[esp+38h+Mode],	1 ; Size
		mov	[esp+38h+Filename], eax	; Str
		call	fwrite
		mov	edx, ds:File
		mov	eax, offset aTheEntireBlock ; "# The entire block of data ends with a "...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 4Ch ; Count
		mov	[esp+38h+Mode],	1 ; Size
		mov	[esp+38h+Filename], eax	; Str
		call	fwrite
		mov	eax, ds:dword_40B028
		test	eax, eax
		jz	short loc_403A36
		mov	ecx, ds:dword_40B028
		mov	edx, offset aS_0 ; "# %s\n\n"
		mov	eax, ds:File
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Mode],	edx ; Format
		mov	[esp+38h+Filename], eax	; File
		call	fprintf

loc_403A36:				; CODE XREF: sub_40385A+1BAj
		nop

loc_403A37:				; CODE XREF: sub_40385A+79j
		mov	eax, 0

locret_403A3C:				; CODE XREF: sub_40385A+54j
		leave
		retn
sub_40385A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403A3E(void *, size_t)
sub_403A3E	proc near		; CODE XREF: sub_402C00+153p
					; sub_402C00+169p ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Count], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax
		mov	[esp+28h+Str], offset dword_408100
		call	sub_40344C
		mov	eax, ds:dword_40B02C
		cmp	eax, 1
		jbe	loc_403AFD
		cmp	eax, 2
		jnz	loc_403B16
		cmp	[ebp+arg_0], 0
		jnz	short loc_403AD4
		mov	eax, dword_408100
		and	eax, 0FFFFFFh
		shr	eax, 10h
		mov	[ebp+var_F], al
		mov	eax, dword_408100
		and	eax, 0FFFFFFh
		shr	eax, 8
		mov	[ebp+var_E], al
		mov	eax, dword_408100
		mov	[ebp+var_D], al
		mov	edx, ds:File
		lea	eax, [ebp+var_F]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 3 ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_C], eax
		jmp	short loc_403B16
; ---------------------------------------------------------------------------

loc_403AD4:				; CODE XREF: sub_403A3E+42j
		mov	edx, ds:File
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+Count], edx ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_C], eax
		jmp	short loc_403B16
; ---------------------------------------------------------------------------

loc_403AFD:				; CODE XREF: sub_403A3E+2Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_4034C6
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		nop

loc_403B16:				; CODE XREF: sub_403A3E+38j
					; sub_403A3E+94j ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_403A3E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403B1B	proc near		; CODE XREF: sub_402C00+193p
					; sub_402C00+2C0p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFh
		jbe	short loc_403B46
		mov	[esp+28h+var_20], 0D3h ; int
		mov	[esp+28h+var_24], offset a__Paperkey1_3O ; "../paperkey-1.3/output.c"
		mov	[esp+28h+var_28], offset aLength65535 ;	"length<=65535"
		call	sub_407AF0

loc_403B46:				; CODE XREF: sub_403B1B+Dj
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		mov	[ebp+var_A], al
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_9], al
		mov	[esp+28h+var_24], 2 ; size_t
		lea	eax, [ebp+var_A]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403A3E
		leave
		retn
sub_403B1B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403B6A	proc near		; CODE XREF: sub_403180+198p
					; sub_403180+204p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= byte ptr -1Ch
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], al
		cmp	[ebp+var_1C], 0Fh
		ja	loc_403C10
		cmp	[ebp+arg_4], 0FFFFh
		jbe	short loc_403BC3
		movzx	eax, [ebp+var_1C]
		shl	eax, 2
		or	eax, 0FFFFFF82h
		mov	[ebp+var_12], al
		mov	eax, [ebp+arg_4]
		shr	eax, 18h
		mov	[ebp+var_11], al
		mov	eax, [ebp+arg_4]
		shr	eax, 10h
		mov	[ebp+var_10], al
		mov	eax, [ebp+arg_4]
		shr	eax, 8
		mov	[ebp+var_F], al
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_E], al
		mov	[ebp+var_C], 5
		jmp	loc_403C8A
; ---------------------------------------------------------------------------

loc_403BC3:				; CODE XREF: sub_403B6A+1Dj
		cmp	[ebp+arg_4], 0FFh
		jbe	short loc_403BF4
		movzx	eax, [ebp+var_1C]
		shl	eax, 2
		or	eax, 0FFFFFF81h
		mov	[ebp+var_12], al
		mov	eax, [ebp+arg_4]
		shr	eax, 8
		mov	[ebp+var_11], al
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], al
		mov	[ebp+var_C], 3
		jmp	loc_403C8A
; ---------------------------------------------------------------------------

loc_403BF4:				; CODE XREF: sub_403B6A+60j
		movzx	eax, [ebp+var_1C]
		shl	eax, 2
		or	eax, 0FFFFFF80h
		mov	[ebp+var_12], al
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_11], al
		mov	[ebp+var_C], 2
		jmp	short loc_403C8A
; ---------------------------------------------------------------------------

loc_403C10:				; CODE XREF: sub_403B6A+10j
		movzx	eax, [ebp+var_1C]
		or	eax, 0FFFFFFC0h
		mov	[ebp+var_12], al
		cmp	[ebp+arg_4], 20BFh
		jbe	short loc_403C51
		mov	[ebp+var_11], 0FFh
		mov	eax, [ebp+arg_4]
		shr	eax, 18h
		mov	[ebp+var_10], al
		mov	eax, [ebp+arg_4]
		shr	eax, 10h
		mov	[ebp+var_F], al
		mov	eax, [ebp+arg_4]
		shr	eax, 8
		mov	[ebp+var_E], al
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_D], al
		mov	[ebp+var_C], 6
		jmp	short loc_403C8A
; ---------------------------------------------------------------------------

loc_403C51:				; CODE XREF: sub_403B6A+B7j
		cmp	[ebp+arg_4], 0BFh
		jbe	short loc_403C7D
		mov	eax, [ebp+arg_4]
		sub	eax, 0C0h
		shr	eax, 8
		sub	eax, 40h
		mov	[ebp+var_11], al
		mov	eax, [ebp+arg_4]
		add	eax, 40h
		mov	[ebp+var_10], al
		mov	[ebp+var_C], 3
		jmp	short loc_403C8A
; ---------------------------------------------------------------------------

loc_403C7D:				; CODE XREF: sub_403B6A+EEj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_11], al
		mov	[ebp+var_C], 2

loc_403C8A:				; CODE XREF: sub_403B6A+54j
					; sub_403B6A+85j ...
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_34], eax ;	size_t
		lea	eax, [ebp+var_12]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_403A3E
		leave
		retn
sub_403B6A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403C9E	proc near		; CODE XREF: sub_402C00+31Ap

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], 0 ; size_t
		mov	[esp+18h+var_18], 0 ; void *
		call	sub_403A3E
		leave
		retn
sub_403C9E	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403CBC	proc near		; CODE XREF: sub_40214F+36p
					; .text:00404058p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 67452301h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0EFCDAB89h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 98BADCFEh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 10325476h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0C3D2E1F0h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		pop	ebp
		retn
sub_403CBC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403D12	proc near		; CODE XREF: sub_403D21+48p
					; sub_403D21+90p ...

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		pop	ebp
		retn
sub_403D12	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403D21	proc near		; CODE XREF: sub_403E93+189p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		shr	eax, 18h
		or	eax, edx
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+var_4]
		mov	[esp+18h+var_18], eax
		call	sub_403D12
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		shr	eax, 18h
		or	edx, eax
		mov	eax, [ebp+var_4]
		add	eax, 4
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_403D12
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		shr	eax, 18h
		or	edx, eax
		mov	eax, [ebp+var_4]
		add	eax, 8
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_403D12
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		shr	eax, 18h
		or	edx, eax
		mov	eax, [ebp+var_4]
		add	eax, 0Ch
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_403D12
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		shr	eax, 18h
		or	edx, eax
		mov	eax, [ebp+var_4]
		add	eax, 10h
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_403D12
		mov	eax, [ebp+arg_4]
		leave
		retn
sub_403D21	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403E93	proc near		; CODE XREF: sub_40214F+9Ap
					; .text:00404132p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 37h
		ja	short loc_403EB0
		mov	eax, 10h
		jmp	short loc_403EB5
; ---------------------------------------------------------------------------

loc_403EB0:				; CODE XREF: sub_403E93+14j
		mov	eax, 20h

loc_403EB5:				; CODE XREF: sub_403E93+1Bj
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, [ebp+var_C]
		jnb	short loc_403EE3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx

loc_403EE3:				; CODE XREF: sub_403E93+3Fj
		mov	eax, [ebp+var_10]
		lea	edx, [eax-2]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		lea	ecx, ds:0[eax*8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		shr	eax, 1Dh
		or	eax, ecx
		mov	ecx, eax
		shl	ecx, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		lea	ebx, ds:0[eax*8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		shr	eax, 1Dh
		or	eax, ebx
		and	eax, 0FF00h
		shl	eax, 8
		or	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		lea	ebx, ds:0[eax*8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		shr	eax, 1Dh
		or	eax, ebx
		shr	eax, 8
		and	eax, 0FF00h
		or	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		lea	ebx, ds:0[eax*8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		shr	eax, 1Dh
		or	eax, ebx
		shr	eax, 18h
		or	ecx, eax
		mov	eax, [ebp+arg_0]
		add	edx, 8
		mov	[eax+edx*4], ecx
		mov	eax, [ebp+var_10]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	ecx, eax
		shl	ecx, 1Bh
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		shl	eax, 3
		and	eax, 0FF00h
		shl	eax, 8
		or	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		shl	eax, 3
		shr	eax, 8
		and	eax, 0FF00h
		or	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		shl	eax, 3
		shr	eax, 18h
		or	ecx, eax
		mov	eax, [ebp+arg_0]
		add	edx, 8
		mov	[eax+edx*4], ecx
		mov	eax, [ebp+var_10]
		add	eax, 3FFFFFFEh
		shl	eax, 2
		mov	ecx, eax
		sub	ecx, [ebp+var_C]
		mov	edx, offset aA	; ""
		mov	eax, [ebp+arg_0]
		add	eax, 20h
		add	eax, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		lea	ecx, ds:0[eax*4]
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+20h]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax
		mov	[esp+28h+Src], ecx
		mov	[esp+28h+Dst], edx
		call	sub_4043D6
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_403D21
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_403E93	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0C8h
		mov	dword ptr [esp], 8048h
		call	malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40404F
		mov	eax, 1
		jmp	locret_404147
; ---------------------------------------------------------------------------

loc_40404F:				; CODE XREF: .text:00404043j
		lea	eax, [ebp-0B4h]
		mov	[esp], eax
		call	sub_403CBC

loc_40405D:				; CODE XREF: .text:004040FAj
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_404067
; ---------------------------------------------------------------------------

loc_404066:				; CODE XREF: .text:004040D8j
		nop

loc_404067:				; CODE XREF: .text:00404064j
		mov	eax, 8000h
		mov	edx, eax
		sub	edx, [ebp-0Ch]
		mov	eax, [ebp-10h]
		add	eax, [ebp-0Ch]
		mov	ecx, [ebp+8]
		mov	[esp+0Ch], ecx
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fread
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		add	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 8000h
		jz	short loc_4040DC
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_4040CB
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	ferror
		test	eax, eax
		jz	short loc_4040FF
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	free
		mov	eax, 1
		jmp	short locret_404147
; ---------------------------------------------------------------------------

loc_4040CB:				; CODE XREF: .text:004040A8j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	feof
		test	eax, eax
		jz	short loc_404066
		jmp	short loc_404100
; ---------------------------------------------------------------------------

loc_4040DC:				; CODE XREF: .text:004040A2j
		nop
		lea	eax, [ebp-0B4h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 8000h
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4043D6
		jmp	loc_40405D
; ---------------------------------------------------------------------------

loc_4040FF:				; CODE XREF: .text:004040B7j
		nop

loc_404100:				; CODE XREF: .text:004040DAj
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_404122
		lea	eax, [ebp-0B4h]
		mov	[esp+8], eax
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_404193

loc_404122:				; CODE XREF: .text:00404104j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-0B4h]
		mov	[esp], eax
		call	sub_403E93
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	free
		mov	eax, 0

locret_404147:				; CODE XREF: .text:0040404Aj
					; .text:004040C9j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0B8h
		lea	eax, [ebp-0A8h]
		mov	[esp], eax
		call	sub_403CBC
		lea	eax, [ebp-0A8h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404193
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		lea	eax, [ebp-0A8h]
		mov	[esp], eax
		call	sub_403E93
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404193(void *, size_t, int)
sub_404193	proc near		; CODE XREF: sub_40214F+66p
					; sub_40214F+85p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_404271
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_10], eax
		mov	eax, 80h
		mov	edx, eax
		sub	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		cmp	edx, eax
		cmovbe	eax, edx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		add	eax, 20h
		add	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+var_14]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+1Ch]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+1Ch]
		cmp	eax, 40h
		jbe	short loc_404265
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+1Ch]
		mov	ecx, eax
		and	ecx, 0FFFFFFC0h
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+20h]
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Size],	eax
		mov	[esp+28h+Src], ecx
		mov	[esp+28h+Dst], edx
		call	sub_4043D6
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+1Ch]
		mov	edx, eax
		and	edx, 3Fh
		mov	eax, [ebp+arg_8]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+1Ch]
		mov	eax, [ebp+arg_8]
		add	eax, 20h
		mov	edx, [ebp+var_14]
		mov	ebx, [ebp+var_10]
		add	edx, ebx
		and	edx, 0FFFFFFC0h
		add	edx, eax
		mov	eax, [ebp+arg_8]
		add	eax, 20h
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy

loc_404265:				; CODE XREF: sub_404193+6Cj
		mov	eax, [ebp+var_14]
		add	[ebp+arg_0], eax
		mov	eax, [ebp+var_14]
		sub	[ebp+arg_4], eax

loc_404271:				; CODE XREF: sub_404193+Fj
		cmp	[ebp+arg_4], 3Fh
		jbe	loc_40434B
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		jz	loc_404320
		jmp	loc_404314
; ---------------------------------------------------------------------------

loc_40428E:				; CODE XREF: sub_404193+185j
		mov	eax, [ebp+arg_8]
		add	eax, 20h
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	ecx, [edx+24h]
		mov	[eax+24h], ecx
		mov	ecx, [edx+28h]
		mov	[eax+28h], ecx
		mov	ecx, [edx+2Ch]
		mov	[eax+2Ch], ecx
		mov	ecx, [edx+30h]
		mov	[eax+30h], ecx
		mov	ecx, [edx+34h]
		mov	[eax+34h], ecx
		mov	ecx, [edx+38h]
		mov	[eax+38h], ecx
		mov	edx, [edx+3Ch]
		mov	[eax+3Ch], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+Size],	edx
		mov	[esp+28h+Src], 40h
		mov	[esp+28h+Dst], eax
		call	sub_4043D6
		add	[ebp+arg_0], 40h
		sub	[ebp+arg_4], 40h

loc_404314:				; CODE XREF: sub_404193+F6j
		cmp	[ebp+arg_4], 40h
		ja	loc_40428E
		jmp	short loc_40434B
; ---------------------------------------------------------------------------

loc_404320:				; CODE XREF: sub_404193+F0j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 0FFFFFFC0h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Size],	eax
		mov	[esp+28h+Src], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_4043D6
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFFFC0h
		add	[ebp+arg_0], eax
		and	[ebp+arg_4], 3Fh

loc_40434B:				; CODE XREF: sub_404193+E2j
					; sub_404193+18Bj
		cmp	[ebp+arg_4], 0
		jz	short loc_4043D0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		add	eax, 20h
		add	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		add	[ebp+var_C], eax
		cmp	[ebp+var_C], 3Fh
		jbe	short loc_4043C7
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+20h]
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Size],	eax
		mov	[esp+28h+Src], 40h
		mov	[esp+28h+Dst], edx
		call	sub_4043D6
		sub	[ebp+var_C], 40h
		mov	eax, [ebp+arg_8]
		add	eax, 60h
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		add	eax, 20h
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy

loc_4043C7:				; CODE XREF: sub_404193+1F0j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx

loc_4043D0:				; CODE XREF: sub_404193+1BCj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_404193	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4043D6	proc near		; CODE XREF: sub_403E93+177p
					; .text:004040F5p ...

var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 70h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		shr	eax, 2
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		shl	eax, 2
		add	eax, [ebp+var_8]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+10h]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		mov	edx, eax
		add	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_8]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, [ebp+var_2C]
		setb	al
		movzx	eax, al
		add	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax+18h], edx
		jmp	loc_405AB8
; ---------------------------------------------------------------------------

loc_40445D:				; CODE XREF: sub_4043D6+16E8j
		mov	[ebp+var_20], 0
		jmp	short loc_4044A7
; ---------------------------------------------------------------------------

loc_404466:				; CODE XREF: sub_4043D6+D5j
		mov	eax, [ebp+var_8]
		mov	eax, [eax]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+var_8]
		mov	eax, [eax]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+var_8]
		mov	eax, [eax]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+var_8]
		mov	eax, [eax]
		shr	eax, 18h
		or	edx, eax
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*4+var_70], edx
		add	[ebp+var_8], 4
		add	[ebp+var_20], 1

loc_4044A7:				; CODE XREF: sub_4043D6+8Ej
		cmp	[ebp+var_20], 0Fh
		jle	short loc_404466
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		and	eax, [ebp+var_10]
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_70]
		add	eax, edx
		add	eax, [ebp+var_1C]
		add	eax, 5A827999h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		and	eax, [ebp+var_C]
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_6C]
		add	eax, edx
		add	eax, [ebp+var_18]
		add	eax, 5A827999h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		and	eax, [ebp+var_1C]
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_68]
		add	eax, edx
		add	eax, [ebp+var_14]
		add	eax, 5A827999h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		and	eax, [ebp+var_18]
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_64]
		add	eax, edx
		add	eax, [ebp+var_10]
		add	eax, 5A827999h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		and	eax, [ebp+var_14]
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_60]
		add	eax, edx
		add	eax, [ebp+var_C]
		add	eax, 5A827999h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		and	eax, [ebp+var_10]
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_5C]
		add	eax, edx
		add	eax, [ebp+var_1C]
		add	eax, 5A827999h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		and	eax, [ebp+var_C]
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_58]
		add	eax, edx
		add	eax, [ebp+var_18]
		add	eax, 5A827999h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		and	eax, [ebp+var_1C]
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_54]
		add	eax, edx
		add	eax, [ebp+var_14]
		add	eax, 5A827999h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		and	eax, [ebp+var_18]
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_50]
		add	eax, edx
		add	eax, [ebp+var_10]
		add	eax, 5A827999h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		and	eax, [ebp+var_14]
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		add	eax, [ebp+var_C]
		add	eax, 5A827999h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		and	eax, [ebp+var_10]
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_48]
		add	eax, edx
		add	eax, [ebp+var_1C]
		add	eax, 5A827999h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		and	eax, [ebp+var_C]
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_44]
		add	eax, edx
		add	eax, [ebp+var_18]
		add	eax, 5A827999h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		and	eax, [ebp+var_1C]
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_40]
		add	eax, edx
		add	eax, [ebp+var_14]
		add	eax, 5A827999h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		and	eax, [ebp+var_18]
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_3C]
		add	eax, edx
		add	eax, [ebp+var_10]
		add	eax, 5A827999h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		and	eax, [ebp+var_14]
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_38]
		add	eax, edx
		add	eax, [ebp+var_C]
		add	eax, 5A827999h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		and	eax, [ebp+var_10]
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_34]
		add	eax, edx
		add	eax, [ebp+var_1C]
		add	eax, 5A827999h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+var_68]
		xor	edx, eax
		mov	eax, [ebp+var_50]
		xor	edx, eax
		mov	eax, [ebp+var_3C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		and	eax, [ebp+var_C]
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_70], eax
		mov	eax, [ebp+var_70]
		add	eax, edx
		add	eax, [ebp+var_18]
		add	eax, 5A827999h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_64]
		xor	edx, eax
		mov	eax, [ebp+var_4C]
		xor	edx, eax
		mov	eax, [ebp+var_38]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		and	eax, [ebp+var_1C]
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_6C]
		add	eax, edx
		add	eax, [ebp+var_14]
		add	eax, 5A827999h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_60]
		xor	edx, eax
		mov	eax, [ebp+var_48]
		xor	edx, eax
		mov	eax, [ebp+var_34]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		and	eax, [ebp+var_18]
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_68]
		add	eax, edx
		add	eax, [ebp+var_10]
		add	eax, 5A827999h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_64]
		mov	eax, [ebp+var_5C]
		xor	edx, eax
		mov	eax, [ebp+var_44]
		xor	edx, eax
		mov	eax, [ebp+var_70]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		and	eax, [ebp+var_14]
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_64]
		add	eax, edx
		add	eax, [ebp+var_C]
		add	eax, 5A827999h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_60]
		mov	eax, [ebp+var_58]
		xor	edx, eax
		mov	eax, [ebp+var_40]
		xor	edx, eax
		mov	eax, [ebp+var_6C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_60], eax
		mov	eax, [ebp+var_60]
		add	eax, edx
		add	eax, [ebp+var_1C]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_5C]
		mov	eax, [ebp+var_54]
		xor	edx, eax
		mov	eax, [ebp+var_3C]
		xor	edx, eax
		mov	eax, [ebp+var_68]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_5C]
		add	eax, edx
		add	eax, [ebp+var_18]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+var_50]
		xor	edx, eax
		mov	eax, [ebp+var_38]
		xor	edx, eax
		mov	eax, [ebp+var_64]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_58], eax
		mov	eax, [ebp+var_58]
		add	eax, edx
		add	eax, [ebp+var_14]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_4C]
		xor	edx, eax
		mov	eax, [ebp+var_34]
		xor	edx, eax
		mov	eax, [ebp+var_60]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_54], eax
		mov	eax, [ebp+var_54]
		add	eax, edx
		add	eax, [ebp+var_10]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_50]
		mov	eax, [ebp+var_48]
		xor	edx, eax
		mov	eax, [ebp+var_70]
		xor	edx, eax
		mov	eax, [ebp+var_5C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		add	eax, edx
		add	eax, [ebp+var_C]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_44]
		xor	edx, eax
		mov	eax, [ebp+var_6C]
		xor	edx, eax
		mov	eax, [ebp+var_58]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_4C]
		add	eax, edx
		add	eax, [ebp+var_1C]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_48]
		mov	eax, [ebp+var_40]
		xor	edx, eax
		mov	eax, [ebp+var_68]
		xor	edx, eax
		mov	eax, [ebp+var_54]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		add	eax, edx
		add	eax, [ebp+var_18]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_3C]
		xor	edx, eax
		mov	eax, [ebp+var_64]
		xor	edx, eax
		mov	eax, [ebp+var_50]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		add	eax, edx
		add	eax, [ebp+var_14]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_38]
		xor	edx, eax
		mov	eax, [ebp+var_60]
		xor	edx, eax
		mov	eax, [ebp+var_4C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_40]
		add	eax, edx
		add	eax, [ebp+var_10]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_34]
		xor	edx, eax
		mov	eax, [ebp+var_5C]
		xor	edx, eax
		mov	eax, [ebp+var_48]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		add	eax, edx
		add	eax, [ebp+var_C]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_70]
		xor	edx, eax
		mov	eax, [ebp+var_58]
		xor	edx, eax
		mov	eax, [ebp+var_44]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_38]
		add	eax, edx
		add	eax, [ebp+var_1C]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_6C]
		xor	edx, eax
		mov	eax, [ebp+var_54]
		xor	edx, eax
		mov	eax, [ebp+var_40]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		add	eax, edx
		add	eax, [ebp+var_18]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+var_68]
		xor	edx, eax
		mov	eax, [ebp+var_50]
		xor	edx, eax
		mov	eax, [ebp+var_3C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_70], eax
		mov	eax, [ebp+var_70]
		add	eax, edx
		add	eax, [ebp+var_14]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_64]
		xor	edx, eax
		mov	eax, [ebp+var_4C]
		xor	edx, eax
		mov	eax, [ebp+var_38]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_6C]
		add	eax, edx
		add	eax, [ebp+var_10]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_60]
		xor	edx, eax
		mov	eax, [ebp+var_48]
		xor	edx, eax
		mov	eax, [ebp+var_34]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_68]
		add	eax, edx
		add	eax, [ebp+var_C]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_64]
		mov	eax, [ebp+var_5C]
		xor	edx, eax
		mov	eax, [ebp+var_44]
		xor	edx, eax
		mov	eax, [ebp+var_70]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_64]
		add	eax, edx
		add	eax, [ebp+var_1C]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_60]
		mov	eax, [ebp+var_58]
		xor	edx, eax
		mov	eax, [ebp+var_40]
		xor	edx, eax
		mov	eax, [ebp+var_6C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_60], eax
		mov	eax, [ebp+var_60]
		add	eax, edx
		add	eax, [ebp+var_18]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_5C]
		mov	eax, [ebp+var_54]
		xor	edx, eax
		mov	eax, [ebp+var_3C]
		xor	edx, eax
		mov	eax, [ebp+var_68]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_5C]
		add	eax, edx
		add	eax, [ebp+var_14]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+var_50]
		xor	edx, eax
		mov	eax, [ebp+var_38]
		xor	edx, eax
		mov	eax, [ebp+var_64]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_58], eax
		mov	eax, [ebp+var_58]
		add	eax, edx
		add	eax, [ebp+var_10]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_4C]
		xor	edx, eax
		mov	eax, [ebp+var_34]
		xor	edx, eax
		mov	eax, [ebp+var_60]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_54], eax
		mov	eax, [ebp+var_54]
		add	eax, edx
		add	eax, [ebp+var_C]
		add	eax, 6ED9EBA1h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_50]
		mov	eax, [ebp+var_48]
		xor	edx, eax
		mov	eax, [ebp+var_70]
		xor	edx, eax
		mov	eax, [ebp+var_5C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		or	eax, edx
		and	eax, [ebp+var_18]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		add	eax, edx
		add	eax, [ebp+var_1C]
		sub	eax, 70E44324h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_44]
		xor	edx, eax
		mov	eax, [ebp+var_6C]
		xor	edx, eax
		mov	eax, [ebp+var_58]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		and	eax, [ebp+var_14]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_4C]
		add	eax, edx
		add	eax, [ebp+var_18]
		sub	eax, 70E44324h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_48]
		mov	eax, [ebp+var_40]
		xor	edx, eax
		mov	eax, [ebp+var_68]
		xor	edx, eax
		mov	eax, [ebp+var_54]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		or	eax, edx
		and	eax, [ebp+var_10]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		add	eax, edx
		add	eax, [ebp+var_14]
		sub	eax, 70E44324h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_3C]
		xor	edx, eax
		mov	eax, [ebp+var_64]
		xor	edx, eax
		mov	eax, [ebp+var_50]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		or	eax, edx
		and	eax, [ebp+var_C]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		add	eax, edx
		add	eax, [ebp+var_10]
		sub	eax, 70E44324h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_38]
		xor	edx, eax
		mov	eax, [ebp+var_60]
		xor	edx, eax
		mov	eax, [ebp+var_4C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		or	eax, edx
		and	eax, [ebp+var_1C]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_40]
		add	eax, edx
		add	eax, [ebp+var_C]
		sub	eax, 70E44324h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_34]
		xor	edx, eax
		mov	eax, [ebp+var_5C]
		xor	edx, eax
		mov	eax, [ebp+var_48]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		or	eax, edx
		and	eax, [ebp+var_18]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		add	eax, edx
		add	eax, [ebp+var_1C]
		sub	eax, 70E44324h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_70]
		xor	edx, eax
		mov	eax, [ebp+var_58]
		xor	edx, eax
		mov	eax, [ebp+var_44]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		and	eax, [ebp+var_14]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_38]
		add	eax, edx
		add	eax, [ebp+var_18]
		sub	eax, 70E44324h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_6C]
		xor	edx, eax
		mov	eax, [ebp+var_54]
		xor	edx, eax
		mov	eax, [ebp+var_40]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		or	eax, edx
		and	eax, [ebp+var_10]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		add	eax, edx
		add	eax, [ebp+var_14]
		sub	eax, 70E44324h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+var_68]
		xor	edx, eax
		mov	eax, [ebp+var_50]
		xor	edx, eax
		mov	eax, [ebp+var_3C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		or	eax, edx
		and	eax, [ebp+var_C]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_70], eax
		mov	eax, [ebp+var_70]
		add	eax, edx
		add	eax, [ebp+var_10]
		sub	eax, 70E44324h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_64]
		xor	edx, eax
		mov	eax, [ebp+var_4C]
		xor	edx, eax
		mov	eax, [ebp+var_38]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		or	eax, edx
		and	eax, [ebp+var_1C]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_6C]
		add	eax, edx
		add	eax, [ebp+var_C]
		sub	eax, 70E44324h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_60]
		xor	edx, eax
		mov	eax, [ebp+var_48]
		xor	edx, eax
		mov	eax, [ebp+var_34]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		or	eax, edx
		and	eax, [ebp+var_18]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_68]
		add	eax, edx
		add	eax, [ebp+var_1C]
		sub	eax, 70E44324h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_64]
		mov	eax, [ebp+var_5C]
		xor	edx, eax
		mov	eax, [ebp+var_44]
		xor	edx, eax
		mov	eax, [ebp+var_70]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		and	eax, [ebp+var_14]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_64]
		add	eax, edx
		add	eax, [ebp+var_18]
		sub	eax, 70E44324h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_60]
		mov	eax, [ebp+var_58]
		xor	edx, eax
		mov	eax, [ebp+var_40]
		xor	edx, eax
		mov	eax, [ebp+var_6C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		or	eax, edx
		and	eax, [ebp+var_10]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_60], eax
		mov	eax, [ebp+var_60]
		add	eax, edx
		add	eax, [ebp+var_14]
		sub	eax, 70E44324h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_5C]
		mov	eax, [ebp+var_54]
		xor	edx, eax
		mov	eax, [ebp+var_3C]
		xor	edx, eax
		mov	eax, [ebp+var_68]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		or	eax, edx
		and	eax, [ebp+var_C]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_5C]
		add	eax, edx
		add	eax, [ebp+var_10]
		sub	eax, 70E44324h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+var_50]
		xor	edx, eax
		mov	eax, [ebp+var_38]
		xor	edx, eax
		mov	eax, [ebp+var_64]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		or	eax, edx
		and	eax, [ebp+var_1C]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_58], eax
		mov	eax, [ebp+var_58]
		add	eax, edx
		add	eax, [ebp+var_C]
		sub	eax, 70E44324h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_4C]
		xor	edx, eax
		mov	eax, [ebp+var_34]
		xor	edx, eax
		mov	eax, [ebp+var_60]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		or	eax, edx
		and	eax, [ebp+var_18]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_54], eax
		mov	eax, [ebp+var_54]
		add	eax, edx
		add	eax, [ebp+var_1C]
		sub	eax, 70E44324h
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_50]
		mov	eax, [ebp+var_48]
		xor	edx, eax
		mov	eax, [ebp+var_70]
		xor	edx, eax
		mov	eax, [ebp+var_5C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		and	eax, [ebp+var_14]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		add	eax, edx
		add	eax, [ebp+var_18]
		sub	eax, 70E44324h
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_44]
		xor	edx, eax
		mov	eax, [ebp+var_6C]
		xor	edx, eax
		mov	eax, [ebp+var_58]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		or	eax, edx
		and	eax, [ebp+var_10]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_4C]
		add	eax, edx
		add	eax, [ebp+var_14]
		sub	eax, 70E44324h
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_48]
		mov	eax, [ebp+var_40]
		xor	edx, eax
		mov	eax, [ebp+var_68]
		xor	edx, eax
		mov	eax, [ebp+var_54]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		or	eax, edx
		and	eax, [ebp+var_C]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		add	eax, edx
		add	eax, [ebp+var_10]
		sub	eax, 70E44324h
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_3C]
		xor	edx, eax
		mov	eax, [ebp+var_64]
		xor	edx, eax
		mov	eax, [ebp+var_50]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ebx, edx
		and	ebx, eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		or	eax, edx
		and	eax, [ebp+var_1C]
		or	eax, ebx
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		add	eax, edx
		add	eax, [ebp+var_C]
		sub	eax, 70E44324h
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_38]
		xor	edx, eax
		mov	eax, [ebp+var_60]
		xor	edx, eax
		mov	eax, [ebp+var_4C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_40]
		add	eax, edx
		add	eax, [ebp+var_1C]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_34]
		xor	edx, eax
		mov	eax, [ebp+var_5C]
		xor	edx, eax
		mov	eax, [ebp+var_48]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		add	eax, edx
		add	eax, [ebp+var_18]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_70]
		xor	edx, eax
		mov	eax, [ebp+var_58]
		xor	edx, eax
		mov	eax, [ebp+var_44]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_38]
		add	eax, edx
		add	eax, [ebp+var_14]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_6C]
		xor	edx, eax
		mov	eax, [ebp+var_54]
		xor	edx, eax
		mov	eax, [ebp+var_40]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		add	eax, edx
		add	eax, [ebp+var_10]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+var_68]
		xor	edx, eax
		mov	eax, [ebp+var_50]
		xor	edx, eax
		mov	eax, [ebp+var_3C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_70], eax
		mov	eax, [ebp+var_70]
		add	eax, edx
		add	eax, [ebp+var_C]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_64]
		xor	edx, eax
		mov	eax, [ebp+var_4C]
		xor	edx, eax
		mov	eax, [ebp+var_38]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_6C]
		add	eax, edx
		add	eax, [ebp+var_1C]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_60]
		xor	edx, eax
		mov	eax, [ebp+var_48]
		xor	edx, eax
		mov	eax, [ebp+var_34]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_68]
		add	eax, edx
		add	eax, [ebp+var_18]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_64]
		mov	eax, [ebp+var_5C]
		xor	edx, eax
		mov	eax, [ebp+var_44]
		xor	edx, eax
		mov	eax, [ebp+var_70]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_64]
		add	eax, edx
		add	eax, [ebp+var_14]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_60]
		mov	eax, [ebp+var_58]
		xor	edx, eax
		mov	eax, [ebp+var_40]
		xor	edx, eax
		mov	eax, [ebp+var_6C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_60], eax
		mov	eax, [ebp+var_60]
		add	eax, edx
		add	eax, [ebp+var_10]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_5C]
		mov	eax, [ebp+var_54]
		xor	edx, eax
		mov	eax, [ebp+var_3C]
		xor	edx, eax
		mov	eax, [ebp+var_68]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_5C]
		add	eax, edx
		add	eax, [ebp+var_C]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+var_50]
		xor	edx, eax
		mov	eax, [ebp+var_38]
		xor	edx, eax
		mov	eax, [ebp+var_64]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_58], eax
		mov	eax, [ebp+var_58]
		add	eax, edx
		add	eax, [ebp+var_1C]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_4C]
		xor	edx, eax
		mov	eax, [ebp+var_34]
		xor	edx, eax
		mov	eax, [ebp+var_60]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_54], eax
		mov	eax, [ebp+var_54]
		add	eax, edx
		add	eax, [ebp+var_18]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_50]
		mov	eax, [ebp+var_48]
		xor	edx, eax
		mov	eax, [ebp+var_70]
		xor	edx, eax
		mov	eax, [ebp+var_5C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		add	eax, edx
		add	eax, [ebp+var_14]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_44]
		xor	edx, eax
		mov	eax, [ebp+var_6C]
		xor	edx, eax
		mov	eax, [ebp+var_58]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_4C]
		add	eax, edx
		add	eax, [ebp+var_10]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_48]
		mov	eax, [ebp+var_40]
		xor	edx, eax
		mov	eax, [ebp+var_68]
		xor	edx, eax
		mov	eax, [ebp+var_54]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		add	eax, edx
		add	eax, [ebp+var_C]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_3C]
		xor	edx, eax
		mov	eax, [ebp+var_64]
		xor	edx, eax
		mov	eax, [ebp+var_50]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		xor	eax, edx
		xor	eax, [ebp+var_18]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		add	eax, edx
		add	eax, [ebp+var_1C]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_1C], eax
		rol	[ebp+var_10], 1Eh
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_38]
		xor	edx, eax
		mov	eax, [ebp+var_60]
		xor	edx, eax
		mov	eax, [ebp+var_4C]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		xor	eax, edx
		xor	eax, [ebp+var_14]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_40]
		add	eax, edx
		add	eax, [ebp+var_18]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_18], eax
		rol	[ebp+var_C], 1Eh
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_34]
		xor	edx, eax
		mov	eax, [ebp+var_5C]
		xor	edx, eax
		mov	eax, [ebp+var_48]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_18]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		xor	eax, edx
		xor	eax, [ebp+var_10]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		add	eax, edx
		add	eax, [ebp+var_14]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_14], eax
		rol	[ebp+var_1C], 1Eh
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_70]
		xor	edx, eax
		mov	eax, [ebp+var_58]
		xor	edx, eax
		mov	eax, [ebp+var_44]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		xor	eax, edx
		xor	eax, [ebp+var_C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_38]
		add	eax, edx
		add	eax, [ebp+var_10]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_10], eax
		rol	[ebp+var_18], 1Eh
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_6C]
		xor	edx, eax
		mov	eax, [ebp+var_54]
		xor	edx, eax
		mov	eax, [ebp+var_40]
		xor	eax, edx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		rol	ecx, 5
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		xor	eax, edx
		xor	eax, [ebp+var_1C]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_30]
		rol	eax, 1
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		add	eax, edx
		add	eax, [ebp+var_C]
		sub	eax, 359D3E2Ah
		mov	[ebp+var_C], eax
		rol	[ebp+var_14], 1Eh
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_18]
		mov	eax, [ebp+arg_8]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+10h]
		mov	[ebp+var_1C], eax

loc_405AB8:				; CODE XREF: sub_4043D6+82j
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_28]
		jb	loc_40445D
		add	esp, 70h
		pop	ebx
		pop	ebp
		retn
sub_4043D6	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:0040D024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_405AF0
		cmp	eax, 3
		jz	short loc_405AF0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_405AF0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_406CE0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_409F7Co ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_405B64
		cmp	dword_408118, 2
		jz	short loc_405B46
		mov	dword_408118, 2

loc_405B46:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_405C53
		cmp	eax, 1
		jz	loc_405BF2

loc_405B58:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_405B64:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_40B418, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_405C83
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_40B414, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_40B410, eax
		jz	loc_405C83
		mov	ecx, ds:dword_40B414
		test	ecx, ecx
		jz	short loc_405C13
		test	eax, eax
		jz	short loc_405C13
		mov	dword_408118, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_405BF2:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_406CE0
		jmp	loc_405B58
; ---------------------------------------------------------------------------

loc_405C13:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_40B410, 0
		mov	ds:dword_40B414, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_405C33:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_408118, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_405C53:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_40D030
		cmp	ebx, offset dword_40D030
		jz	loc_405B58

loc_405C64:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_405C6C
		call	eax

loc_405C6C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_40D030
		jnz	short loc_405C64
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_405C83:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_40B410, 0
		mov	ds:dword_40B414, 0
		jmp	short loc_405C33
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405CB0	proc near		; DATA XREF: .CRT:0040D014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_405CB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405CC0	proc near		; CODE XREF: sub_405CE0+10p
					; sub_405CE0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_405CC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405CD0	proc near		; CODE XREF: sub_401060+59p
					; sub_405CE0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_405CD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_405CE0(_onexit_t)
sub_405CE0	proc near		; CODE XREF: sub_405DA0+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_40B420
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_405CC0
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_405D80
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_40B420
		mov	[esp+2Ch+Func],	eax
		call	sub_405CC0
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_40B41C
		mov	[esp+2Ch+Func],	eax
		call	sub_405CC0
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_405CD0
		mov	ds:dword_40B420, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_405CD0
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_40B41C, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_405D80:				; CODE XREF: sub_405CE0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_405CE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_405DA0(_onexit_t)
sub_405DA0	proc near		; CODE XREF: sub_4069C0-27p
					; sub_407D30+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_405CE0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_405DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_405E17
		cmp	eax, 0C000008Dh
		jb	short loc_405E44

loc_405DDB:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_405DE0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_405F10
		test	eax, eax
		jz	short loc_405E2C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_405E0F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_405E17:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_405E85
		cmp	eax, 0C0000096h
		jz	short loc_405E52
		cmp	eax, 0C0000093h
		jz	short loc_405DDB

loc_405E2C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_40B068
		test	eax, eax
		jz	loc_405F03
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_405E44:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_405E90
		cmp	eax, 0C000001Dh
		jnz	short loc_405E2C

loc_405E52:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_405EC7
		test	eax, eax
		jz	short loc_405E2C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_405E85:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_405DE0
; ---------------------------------------------------------------------------
		align 10h

loc_405E90:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_405EE5
		test	eax, eax
		jz	loc_405E2C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_405EC7:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_405E0F
; ---------------------------------------------------------------------------

loc_405EE5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_405E0F
; ---------------------------------------------------------------------------

loc_405F03:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_405E0F
; ---------------------------------------------------------------------------
		align 10h

loc_405F10:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_405E0F
		mov	[esp+2Ch+var_10], eax
		call	sub_406930
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_405E0F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_40B06C
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_405F91
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_40B06C
		jmp	short loc_405F97
; ---------------------------------------------------------------------------

loc_405F91:				; CODE XREF: .text:00405F66j
		fstp	st
		fstp	st
		fstp	st

loc_405F97:				; CODE XREF: .text:00405F8Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405FA0	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_40B06C, eax
		jmp	__setusermatherr
sub_405FA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405FB0	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_405FCD
		mov	edx, ds:off_40A09C[ecx*4]

loc_405FCD:				; CODE XREF: sub_405FB0+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_405FB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406010	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_406010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_406020(char *Format, char ArgList)
sub_406020	proc near		; CODE XREF: sub_406080+1DDp
					; sub_406080+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_406020	endp

; ---------------------------------------------------------------------------
		jmp	short sub_406080
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_406080(size_t Size)
sub_406080	proc near		; CODE XREF: .text:00406071j
					; sub_4062C0+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_40B078
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_406262
		mov	eax, ds:dword_40B074
		xor	esi, esi

loc_4060A4:				; CODE XREF: sub_406080+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_4060B9
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_406190

loc_4060B9:				; CODE XREF: sub_406080+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_4060A4

loc_4060C3:				; CODE XREF: sub_406080+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_406680
		test	eax, eax
		mov	edi, eax
		jz	loc_406289
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_40B074
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_406760
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_40B074
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_406269
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_406211

loc_40613F:				; CODE XREF: sub_406080+194j
					; sub_406080+1C6j
		add	ds:dword_40B078, 1

loc_406146:				; CODE XREF: sub_406080+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_406299
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_406198

loc_40616F:				; CODE XREF: sub_406080+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_406183:				; CODE XREF: sub_406080+162j
					; sub_406080+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_406190:				; CODE XREF: sub_406080+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_406146
; ---------------------------------------------------------------------------

loc_406198:				; CODE XREF: sub_406080+EDj
		cmp	eax, 40h
		jz	short loc_40616F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_406183
		cmp	eax, 4
		jz	short loc_406183
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_406211:				; CODE XREF: sub_406080+B9j
		cmp	eax, 40h
		jz	loc_40613F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_40B074
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_40613F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_406020
; ---------------------------------------------------------------------------

loc_406262:				; CODE XREF: sub_406080+17j
		xor	esi, esi
		jmp	loc_4060C3
; ---------------------------------------------------------------------------

loc_406269:				; CODE XREF: sub_406080+ACj
		mov	eax, ds:dword_40B074
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_406020
; ---------------------------------------------------------------------------

loc_406289:				; CODE XREF: sub_406080+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_406020
; ---------------------------------------------------------------------------

loc_406299:				; CODE XREF: sub_406080+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_406020
sub_406080	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4062C0	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_40B070
		test	eax, eax
		jz	short loc_4062E0

loc_4062D2:				; CODE XREF: sub_4062C0+66j
					; sub_4062C0+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4062E0:				; CODE XREF: sub_4062C0+10j
		mov	ds:dword_40B070, 1
		call	sub_4066C0
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_406D80
		mov	ds:dword_40B078, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_40B074, eax
		mov	eax, offset dword_40A340
		sub	eax, offset dword_40A340
		cmp	eax, 7
		jle	short loc_4062D2
		cmp	eax, 0Bh
		mov	ebx, offset dword_40A340
		jle	loc_406420
		mov	eax, ds:dword_40A340
		test	eax, eax
		jnz	short loc_406350
		mov	eax, ds:dword_40A344
		test	eax, eax
		jz	loc_40640C
		lea	esi, [esi+0]

loc_406350:				; CODE XREF: sub_4062C0+7Dj
					; sub_4062C0+164j ...
		cmp	ebx, offset dword_40A340
		jnb	loc_4062D2
		mov	esi, 400000h

loc_406361:				; CODE XREF: sub_4062C0+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_406080
		cmp	ebx, offset dword_40A340
		jb	short loc_406361

loc_406385:				; CODE XREF: sub_4062C0+24Bj
		mov	ecx, ds:dword_40B078
		test	ecx, ecx
		jle	loc_4062D2
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_4063B2
; ---------------------------------------------------------------------------
		align 10h

loc_4063A0:				; CODE XREF: sub_4062C0+FDj
					; sub_4062C0+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_40B078
		jge	loc_4062D2

loc_4063B2:				; CODE XREF: sub_4062C0+DDj
		mov	eax, ds:dword_40B074
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_4063A0
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_406532
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_40B074
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_4063A0
; ---------------------------------------------------------------------------

loc_40640C:				; CODE XREF: sub_4062C0+86j
		mov	eax, ds:dword_40A348
		test	eax, eax
		jnz	short loc_406435
		mov	ebx, offset dword_40A34C
		lea	esi, [esi+0]

loc_406420:				; CODE XREF: sub_4062C0+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_406350
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_406350

loc_406435:				; CODE XREF: sub_4062C0+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_406555
		add	ebx, 0Ch
		cmp	ebx, offset dword_40A340
		jnb	loc_4062D2

loc_406450:				; CODE XREF: sub_4062C0+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_4064AA
		cmp	edx, 20h
		jz	short loc_4064E0
		cmp	edx, 8
		jz	short loc_40648A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_406020
; ---------------------------------------------------------------------------

loc_40648A:				; CODE XREF: sub_4062C0+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_4064B5
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_4064D1
; ---------------------------------------------------------------------------

loc_4064AA:				; CODE XREF: sub_4062C0+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_406510

loc_4064B5:				; CODE XREF: sub_4062C0+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_406523
		cmp	edx, 20h
		jz	short loc_4064EF
		cmp	edx, 8
		jnz	short loc_4064FC

loc_4064D1:				; CODE XREF: sub_4062C0+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_406080
		jmp	short loc_4064FC
; ---------------------------------------------------------------------------

loc_4064E0:				; CODE XREF: sub_4062C0+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_4064EF:				; CODE XREF: sub_4062C0+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_406080

loc_4064FC:				; CODE XREF: sub_4062C0+20Fj
					; sub_4062C0+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_40A340
		jb	loc_406450
		jmp	loc_406385
; ---------------------------------------------------------------------------

loc_406510:				; CODE XREF: sub_4062C0+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_406523:				; CODE XREF: sub_4062C0+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_406080
		jmp	short loc_4064FC
; ---------------------------------------------------------------------------

loc_406532:				; CODE XREF: sub_4062C0+11Bj
		add	ebx, ds:dword_40B074
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_406020
; ---------------------------------------------------------------------------

loc_406555:				; CODE XREF: sub_4062C0+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_406020
sub_4062C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406570	proc near		; CODE XREF: .text:00406611p
					; sub_406680+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_406580

locret_40657D:				; CODE XREF: sub_406570+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_406580:				; CODE XREF: sub_406570+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_40657D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_406570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4065A0	proc near		; CODE XREF: sub_406680+2Bp
					; .text:004067C4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_4065DE
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_4065C4:				; CODE XREF: sub_4065A0+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_4065D2
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_4065DE

loc_4065D2:				; CODE XREF: sub_4065A0+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_4065C4
		xor	eax, eax

loc_4065DE:				; CODE XREF: sub_4065A0+19j
					; sub_4065A0+30j
		pop	ebx
		pop	esi
		retn
sub_4065A0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_4065F0
; ---------------------------------------------------------------------------
		align 10h

loc_4065F0:				; CODE XREF: .text:004065E1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_406663
		mov	dword ptr [esp], 400000h
		call	sub_406570
		test	eax, eax
		jz	short loc_406663
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_406663
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_40664B
; ---------------------------------------------------------------------------

loc_406641:				; CODE XREF: .text:00406661j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_406670

loc_40664B:				; CODE XREF: .text:0040663Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_406641

loc_406663:				; CODE XREF: .text:00406608j
					; .text:00406618j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_406670:				; CODE XREF: .text:00406649j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406680	proc near		; CODE XREF: sub_406080+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_406570
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_4066B0
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_4065A0

loc_4066B0:				; CODE XREF: sub_406680+15j
		add	esp, 8
		retn
sub_406680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4066C0	proc near		; CODE XREF: sub_4062C0+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_406570
		xor	edx, edx
		test	eax, eax
		jz	short loc_4066E1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_4066E1:				; CODE XREF: sub_4066C0+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_4066C0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_406570
		xor	edx, edx
		test	eax, eax
		jz	short loc_406749
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_406749
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_406730:				; CODE XREF: .text:00406745j
		test	byte ptr [edx+27h], 20h
		jz	short loc_40673D
		test	ebx, ebx
		jz	short loc_406749
		sub	ebx, 1

loc_40673D:				; CODE XREF: .text:00406734j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_406730
		xor	edx, edx

loc_406749:				; CODE XREF: .text:00406709j
					; .text:00406725j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_406760
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406760	proc near		; CODE XREF: sub_406080+70p
					; .text:00406751j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_406570
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_406760	endp

; ---------------------------------------------------------------------------
		jmp	short loc_406790
; ---------------------------------------------------------------------------
		align 10h

loc_406790:				; CODE XREF: .text:00406781j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_406570
		test	eax, eax
		jnz	short loc_4067B0

loc_4067A6:				; CODE XREF: .text:004067CBj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4067B0:				; CODE XREF: .text:004067A4j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_4065A0
		test	eax, eax
		jz	short loc_4067A6
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4067E0	proc near		; CODE XREF: sub_406870+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_406570
		test	eax, eax
		jz	short loc_406851
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_406851
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_4065A0
		test	eax, eax
		jz	short loc_406851
		add	esi, 400000h
		jnz	short loc_406836
		jmp	short loc_406851
; ---------------------------------------------------------------------------
		align 10h

loc_406830:				; CODE XREF: sub_4067E0+66j
		sub	ebx, 1
		add	esi, 14h

loc_406836:				; CODE XREF: sub_4067E0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_406844
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_406860

loc_406844:				; CODE XREF: sub_4067E0+5Bj
		test	ebx, ebx
		jg	short loc_406830
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_406851:				; CODE XREF: sub_4067E0+1Aj
					; sub_4067E0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_406860:				; CODE XREF: sub_4067E0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_4067E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406870	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40B07C
		test	eax, eax
		jz	short loc_406882

loc_40687D:				; CODE XREF: sub_406870+97j
					; sub_406870+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_406882:				; CODE XREF: sub_406870+Bj
		xor	eax, eax

loc_406884:				; CODE XREF: sub_406870+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_4067E0
		test	eax, eax
		jz	short loc_406910
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_4068A0
		cmp	dl, 6Dh
		jnz	short loc_4068F0

loc_4068A0:				; CODE XREF: sub_406870+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_4068AE
		cmp	dl, 73h
		jnz	short loc_4068F0

loc_4068AE:				; CODE XREF: sub_406870+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_4068BC
		cmp	dl, 76h
		jnz	short loc_4068F0

loc_4068BC:				; CODE XREF: sub_406870+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_4068CA
		cmp	dl, 63h
		jnz	short loc_4068F0

loc_4068CA:				; CODE XREF: sub_406870+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_4068D8
		cmp	dl, 72h
		jnz	short loc_4068F0

loc_4068D8:				; CODE XREF: sub_406870+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_4068F4
		cmp	dl, 74h
		jz	short loc_4068F4
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_4068F4
		xchg	ax, ax

loc_4068F0:				; CODE XREF: sub_406870+2Ej
					; sub_406870+3Cj ...
		mov	eax, ebx
		jmp	short loc_406884
; ---------------------------------------------------------------------------

loc_4068F4:				; CODE XREF: sub_406870+6Fj
					; sub_406870+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_40B07C, eax
		jnz	loc_40687D
		lea	esi, [esi+0]

loc_406910:				; CODE XREF: sub_406870+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_40B07C, eax
		jmp	loc_40687D
sub_406870	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406930	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_406930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_406940()
sub_406940	proc near		; DATA XREF: sub_4069C0:loc_406992o
		sub	esp, 0Ch
		mov	eax, off_408114
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_406967
		xchg	ax, ax

loc_406950:				; CODE XREF: sub_406940+25j
		call	eax
		mov	eax, off_408114
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_408114, edx
		test	eax, eax
		jnz	short loc_406950

loc_406967:				; CODE XREF: sub_406940+Cj
		add	esp, 0Ch
		retn
sub_406940	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_4069C0

loc_406970:				; CODE XREF: sub_4069C0+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_407D50
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_4069A3

loc_40697F:				; CODE XREF: sub_4069C0-9j
		test	ebx, ebx
		jz	short loc_406992

loc_406983:				; CODE XREF: sub_4069C0-30j
		call	ds:dword_407D50[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_406983

loc_406992:				; CODE XREF: sub_4069C0-3Fj
		mov	[esp+1Ch+var_1C], offset sub_406940 ; _onexit_t
		call	sub_405DA0
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4069A3:				; CODE XREF: sub_4069C0-43j
		xor	ebx, ebx
		jmp	short loc_4069A9
; ---------------------------------------------------------------------------

loc_4069A7:				; CODE XREF: sub_4069C0-Bj
		mov	ebx, eax

loc_4069A9:				; CODE XREF: sub_4069C0-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_407D50[eax*4]
		test	edx, edx
		jnz	short loc_4069A7
		jmp	short loc_40697F
; END OF FUNCTION CHUNK	FOR sub_4069C0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4069C0	proc near		; CODE XREF: sub_401180+239p
					; sub_401600+Cp

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00406970 SIZE 00000049 BYTES

		mov	ecx, ds:dword_40B080
		test	ecx, ecx
		jz	short loc_4069D0
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_4069D0:				; CODE XREF: sub_4069C0+8j
		mov	ds:dword_40B080, 1
		jmp	short loc_406970
sub_4069C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4069E0	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_40813C
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_406A30
		not	eax
		mov	dword_408140, eax

loc_406A16:				; CODE XREF: sub_4069E0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_406A30:				; CODE XREF: sub_4069E0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_406AA2

loc_406A92:				; CODE XREF: sub_4069E0+CCj
		mov	dword_40813C, ebp
		mov	dword_408140, eax
		jmp	loc_406A16
; ---------------------------------------------------------------------------

loc_406AA2:				; CODE XREF: sub_4069E0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_406A92
sub_4069E0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_40B164, edx
		mov	ds:dword_40B380, 0C0000409h
		mov	ds:dword_40B384, 1
		mov	ds:dword_40B158, eax
		mov	ds:dword_40B38C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_40B14C, eax
		mov	eax, dword_40813C
		mov	[ebp-10h], eax
		mov	eax, dword_408140
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_40A1C4
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406B40	proc near		; CODE XREF: sub_406CE0+79p
					; sub_406CE0:loc_406D72p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_40B3FC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_406B95
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_406B70:				; CODE XREF: sub_406B40+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_406B8E
		test	esi, esi
		jz	short loc_406B8E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_406B8E:				; CODE XREF: sub_406B40+40j
					; sub_406B40+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_406B70

loc_406B95:				; CODE XREF: sub_406B40+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_406B40	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_40B3E0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_406BD4

loc_406BC6:				; CODE XREF: .text:00406C3Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_406BD4:				; CODE XREF: .text:00406BC4j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_406C37
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_40B3FC
		mov	ds:dword_40B3FC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_406C37:				; CODE XREF: .text:00406BECj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_406BC6
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40B3E0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_406C58
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_406C58:				; CODE XREF: .text:00406C4Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_40B3FC
		sub	esp, 4
		test	edx, edx
		jz	short loc_406C8F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_406C88
		jmp	short loc_406CC6
; ---------------------------------------------------------------------------
		align 10h

loc_406C80:				; CODE XREF: .text:00406C8Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_406CA6
		mov	edx, eax

loc_406C88:				; CODE XREF: .text:00406C76j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_406C80

loc_406C8F:				; CODE XREF: .text:00406C70j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_406C9F:				; CODE XREF: .text:00406CC4j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_406CA6:				; CODE XREF: .text:00406C84j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_406CAC:				; CODE XREF: .text:00406CD0j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_406C9F
; ---------------------------------------------------------------------------

loc_406CC6:				; CODE XREF: .text:00406C78j
		mov	eax, [edx+8]
		mov	ds:dword_40B3FC, eax
		mov	eax, edx
		jmp	short loc_406CAC
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406CE0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_406D30
		jb	short loc_406D00
		cmp	eax, 3
		jz	short loc_406D50

loc_406CF3:				; CODE XREF: sub_406CE0+31j
					; sub_406CE0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_406D00:				; CODE XREF: sub_406CE0+Cj
		mov	eax, ds:dword_40B3E0
		test	eax, eax
		jnz	short loc_406D72

loc_406D09:				; CODE XREF: sub_406CE0+97j
		mov	eax, ds:dword_40B3E0
		cmp	eax, 1
		jnz	short loc_406CF3
		mov	ds:dword_40B3E0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_406CF3
; ---------------------------------------------------------------------------
		align 10h

loc_406D30:				; CODE XREF: sub_406CE0+Aj
		mov	eax, ds:dword_40B3E0
		test	eax, eax
		jz	short loc_406D60

loc_406D39:				; CODE XREF: sub_406CE0+90j
		mov	ds:dword_40B3E0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_406D50:				; CODE XREF: sub_406CE0+11j
		mov	eax, ds:dword_40B3E0
		test	eax, eax
		jz	short loc_406CF3
		call	sub_406B40
		jmp	short loc_406CF3
; ---------------------------------------------------------------------------

loc_406D60:				; CODE XREF: sub_406CE0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_406D39
; ---------------------------------------------------------------------------

loc_406D72:				; CODE XREF: sub_406CE0+27j
		call	sub_406B40
		jmp	short loc_406D09
sub_406CE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406D80	proc near		; CODE XREF: sub_401180+19p
					; sub_4062C0+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_406DA2

loc_406D8D:				; CODE XREF: sub_406D80+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_406D8D

loc_406DA2:				; CODE XREF: sub_406D80+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_406D80	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _umask]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_406DE0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406DE0	proc near		; CODE XREF: sub_401180+A7p
					; .text:00406DD1j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_406DE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406E00	proc near		; CODE XREF: sub_407280+EDp
					; sub_407280+2EFp

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4

		push	ebp
		push	edi
		mov	edi, eax
		push	esi
		mov	esi, ecx
		push	ebx
		sub	esp, 14h
		mov	[esp+24h+var_20], edx
		sub	edx, eax
		mov	eax, esi
		sub	eax, [esp+24h+var_20]
		mov	[esp+24h+var_18], edx
		mov	ecx, [esp+24h+arg_0]
		mov	[esp+24h+var_1C], eax
		mov	eax, edx
		sar	edx, 1Fh
		idiv	[esp+24h+var_1C]
		mov	eax, [esp+24h+var_1C]
		test	edx, edx
		mov	ebx, edx
		jnz	short loc_406E3C
		jmp	short loc_406EAD
; ---------------------------------------------------------------------------

loc_406E38:				; CODE XREF: sub_406E00+45j
		mov	eax, ebx
		mov	ebx, edx

loc_406E3C:				; CODE XREF: sub_406E00+34j
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	edx, edx
		jnz	short loc_406E38

loc_406E47:				; CODE XREF: sub_406E00+B1j
		mov	eax, esi
		sub	eax, edi
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	ebx, ebx
		mov	[esp+24h+var_24], eax
		jle	short loc_406EA5
		mov	ebp, [esp+24h+var_20]
		add	ebx, ebp
		mov	[esp+24h+var_14], ebx

loc_406E63:				; CODE XREF: sub_406E00+A3j
		mov	eax, [esp+24h+var_24]
		test	eax, eax
		jle	short loc_406E9C
		mov	edi, [ecx+ebp*4]
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_406E75
; ---------------------------------------------------------------------------

loc_406E73:				; CODE XREF: sub_406E00+9Aj
		mov	edi, esi

loc_406E75:				; CODE XREF: sub_406E00+71j
		mov	esi, [esp+24h+var_1C]
		mov	ebx, eax
		sub	ebx, [esp+24h+var_18]
		add	esi, eax
		cmp	[esp+24h+var_20], eax
		mov	eax, ebx
		cmovg	eax, esi
		add	edx, 1
		lea	ebx, [ecx+eax*4]
		mov	esi, [ebx]
		cmp	edx, [esp+24h+var_24]
		mov	[ebx], edi
		mov	[ecx+ebp*4], esi
		jnz	short loc_406E73

loc_406E9C:				; CODE XREF: sub_406E00+68j
		add	ebp, 1
		cmp	ebp, [esp+24h+var_14]
		jnz	short loc_406E63

loc_406EA5:				; CODE XREF: sub_406E00+57j
		add	esp, 14h
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_406EAD:				; CODE XREF: sub_406E00+36j
		mov	ebx, [esp+24h+var_1C]
		jmp	short loc_406E47
sub_406E00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_406EC0(char *, char)
sub_406EC0	proc near		; CODE XREF: sub_406F30+152p
					; sub_406F30+1E8p ...

File		= dword	ptr -1Ch
Format		= dword	ptr -18h
ArgList		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:__argv
		mov	ebx, [esp+1Ch+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[esp+1Ch+Format], offset aS_1 ;	"%s: "
		mov	[esp+1Ch+ArgList], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fprintf
		test	ebx, ebx
		jz	short loc_406F0D
		lea	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, ds:_iob
		mov	[esp+1Ch+Format], ebx ;	Format
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	vfprintf

loc_406F0D:				; CODE XREF: sub_406EC0+2Fj
		mov	eax, ds:_iob
		mov	[esp+1Ch+File],	0Ah ; Ch
		add	eax, 40h
		mov	[esp+1Ch+Format], eax ;	File
		call	fputc
		add	esp, 18h
		pop	ebx
		retn
sub_406EC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406F30	proc near		; CODE XREF: sub_407280+220p
					; sub_407280+5BBp

Str		= dword	ptr -5Ch
Val		= dword	ptr -58h
MaxCount	= dword	ptr -54h
var_44		= dword	ptr -44h
Str1		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	[esp+5Ch+var_24], edx
		mov	edx, off_408138
		mov	[esp+5Ch+var_38], ecx
		mov	ecx, dword_408124
		mov	[esp+5Ch+Val], 3Dh ; Val
		mov	[esp+5Ch+var_20], eax
		mov	[esp+5Ch+Str], edx ; Str
		mov	[esp+5Ch+var_2C], ecx
		add	ecx, 1
		mov	[esp+5Ch+Str1],	edx
		mov	[esp+5Ch+var_28], ecx
		mov	dword_408124, ecx
		call	strchr
		test	eax, eax
		mov	[esp+5Ch+var_34], eax
		jz	loc_407150
		mov	ebp, eax
		add	eax, 1
		sub	ebp, [esp+5Ch+Str1]
		mov	[esp+5Ch+var_34], eax

loc_406F8D:				; CODE XREF: sub_406F30+22Ej
		mov	ecx, [esp+5Ch+var_38]
		mov	esi, [ecx]
		test	esi, esi
		jz	loc_40716E
		mov	ebx, ecx
		xor	edi, edi
		add	ebx, 10h
		mov	[esp+5Ch+var_44], ecx
		mov	[esp+5Ch+var_3C], 0FFFFFFFFh
		mov	[esp+5Ch+var_30], 0
		jmp	short loc_406FE8
; ---------------------------------------------------------------------------

loc_406FB8:				; CODE XREF: sub_406F30+F2j
		mov	eax, [esp+5Ch+var_3C]
		mov	ecx, [esp+5Ch+var_44]
		shl	eax, 4
		add	eax, [esp+5Ch+var_38]
		mov	edx, [eax+4]
		cmp	[ecx+4], edx
		jz	short loc_407030

loc_406FCF:				; CODE XREF: sub_406F30+106j
		mov	[esp+5Ch+var_30], 1

loc_406FD7:				; CODE XREF: sub_406F30+CEj
					; sub_406F30+EBj ...
		mov	[esp+5Ch+var_44], ebx
		add	ebx, 10h
		add	edi, 1
		mov	esi, [ebx-10h]
		test	esi, esi
		jz	short loc_407050

loc_406FE8:				; CODE XREF: sub_406F30+86j
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+MaxCount], ebp	; MaxCount
		mov	[esp+5Ch+Val], esi ; Str2
		mov	[esp+5Ch+Str], edx ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_406FD7
		mov	[esp+5Ch+Str], esi ; Str
		call	strlen
		cmp	eax, ebp
		jz	loc_4070A0
		cmp	ebp, 1
		jnz	short loc_40701D
		mov	esi, [esp+5Ch+arg_4]
		test	esi, esi
		jnz	short loc_406FD7

loc_40701D:				; CODE XREF: sub_406F30+E3j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	short loc_406FB8
		mov	[esp+5Ch+var_3C], edi
		jmp	short loc_406FD7
; ---------------------------------------------------------------------------
		align 10h

loc_407030:				; CODE XREF: sub_406F30+9Dj
		mov	edx, [eax+8]
		cmp	[ecx+8], edx
		jnz	short loc_406FCF
		mov	edx, [eax+0Ch]
		mov	eax, 1
		cmp	[ecx+0Ch], edx
		cmovz	eax, [esp+5Ch+var_30]
		mov	[esp+5Ch+var_30], eax
		jmp	short loc_406FD7
; ---------------------------------------------------------------------------
		align 10h

loc_407050:				; CODE XREF: sub_406F30+B6j
		mov	ebx, [esp+5Ch+var_30]
		test	ebx, ebx
		jz	loc_407163
		mov	ecx, dword_408128
		test	ecx, ecx
		jz	short loc_407087
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_407087
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aAmbiguousOptio ;	"ambiguous option -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_406EC0

loc_407087:				; CODE XREF: sub_406F30+134j
					; sub_406F30+13Dj ...
		mov	dword_408120, 0
		mov	eax, 3Fh

loc_407096:				; CODE XREF: sub_406F30+1BDj
					; sub_406F30+2EAj ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4070A0:				; CODE XREF: sub_406F30+DAj
		mov	[esp+5Ch+var_3C], edi

loc_4070A4:				; CODE XREF: sub_406F30+238j
		mov	ebx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+var_34]
		shl	ebx, 4
		add	ebx, [esp+5Ch+var_38]
		test	edx, edx
		setnz	dl
		mov	eax, [ebx+4]
		jnz	short loc_4070EF

loc_4070BD:				; CODE XREF: sub_406F30+1C1j
		lea	ecx, [eax-1]
		cmp	ecx, 1
		jbe	loc_4071AE

loc_4070C9:				; CODE XREF: sub_406F30+28Fj
					; sub_406F30+29Dj ...
		mov	edx, [esp+5Ch+arg_0]
		test	edx, edx
		jz	short loc_4070DB
		mov	ecx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+arg_0]
		mov	[edx], ecx

loc_4070DB:				; CODE XREF: sub_406F30+19Fj
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_407217
		mov	edx, [ebx+0Ch]
		mov	[eax], edx
		xor	eax, eax
		jmp	short loc_407096
; ---------------------------------------------------------------------------

loc_4070EF:				; CODE XREF: sub_406F30+18Bj
		test	eax, eax
		jnz	short loc_4070BD
		mov	eax, dword_408128
		test	eax, eax
		jz	short loc_40711D
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40711D
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aOptionDoesnTTa ;	"option	doesn't take an argument -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_406EC0

loc_40711D:				; CODE XREF: sub_406F30+1CAj
					; sub_406F30+1D3j
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_40721F
		mov	dword_408120, 0

loc_407132:				; CODE XREF: sub_406F30+2E2j
					; sub_406F30+2F7j
		mov	edx, [esp+5Ch+var_24]
		xor	eax, eax
		cmp	byte ptr [edx],	3Ah
		setnz	al
		add	esp, 4Ch
		pop	ebx
		lea	eax, [eax+eax*4+3Ah]
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_407150:				; CODE XREF: sub_406F30+4Aj
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], edx ; Str
		call	strlen
		mov	ebp, eax
		jmp	loc_406F8D
; ---------------------------------------------------------------------------

loc_407163:				; CODE XREF: sub_406F30+126j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	loc_4070A4

loc_40716E:				; CODE XREF: sub_406F30+65j
		mov	ebx, [esp+5Ch+arg_4]
		test	ebx, ebx
		jnz	loc_407256
		mov	ecx, dword_408128
		test	ecx, ecx
		jz	loc_407087
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	loc_407087
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aUnknownOptionS ;	"unknown option	-- %s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_406EC0
		jmp	loc_407087
; ---------------------------------------------------------------------------

loc_4071AE:				; CODE XREF: sub_406F30+193j
		test	dl, dl
		jz	short loc_40722C
		mov	ecx, [esp+5Ch+var_34]
		cmp	eax, 1
		mov	ds:Filename, ecx
		jnz	loc_4070C9

loc_4071C5:				; CODE XREF: sub_406F30+321j
		mov	ebp, ds:Filename
		test	ebp, ebp
		jnz	loc_4070C9
		mov	edi, dword_408128
		test	edi, edi
		jz	short loc_4071FA
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_4071FA
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aOptionRequires ;	"option	requires an argument --	%s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_406EC0

loc_4071FA:				; CODE XREF: sub_406F30+2ABj
					; sub_406F30+2B4j
		mov	esi, [ebx+8]
		test	esi, esi
		jz	short loc_40726A
		mov	dword_408120, 0

loc_40720B:				; CODE XREF: sub_406F30+342j
		sub	dword_408124, 1
		jmp	loc_407132
; ---------------------------------------------------------------------------

loc_407217:				; CODE XREF: sub_406F30+1B0j
		mov	eax, [ebx+0Ch]
		jmp	loc_407096
; ---------------------------------------------------------------------------

loc_40721F:				; CODE XREF: sub_406F30+1F2j
		mov	eax, [ebx+0Ch]
		mov	dword_408120, eax
		jmp	loc_407132
; ---------------------------------------------------------------------------

loc_40722C:				; CODE XREF: sub_406F30+280j
		cmp	eax, 1
		jnz	loc_4070C9
		mov	edx, [esp+5Ch+var_28]
		mov	ecx, [esp+5Ch+var_20]
		mov	eax, [ecx+edx*4]
		mov	ds:Filename, eax
		mov	eax, [esp+5Ch+var_2C]
		add	eax, 2
		mov	dword_408124, eax
		jmp	loc_4071C5
; ---------------------------------------------------------------------------

loc_407256:				; CODE XREF: sub_406F30+244j
		mov	ecx, [esp+5Ch+var_2C]
		mov	eax, 0FFFFFFFFh
		mov	dword_408124, ecx
		jmp	loc_407096
; ---------------------------------------------------------------------------

loc_40726A:				; CODE XREF: sub_406F30+2CFj
		mov	eax, [ebx+0Ch]
		mov	dword_408120, eax
		jmp	short loc_40720B
sub_406F30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407280	proc near		; CODE XREF: .text:00407884j
					; sub_407890+26j ...

Str		= dword	ptr -4Ch
Val		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		test	ecx, ecx
		mov	[esp+4Ch+var_24], eax
		mov	edi, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_28], edx
		mov	[esp+4Ch+var_20], ecx
		jz	loc_4075B2
		mov	ecx, dword_408124
		test	ecx, ecx
		jz	loc_407500

loc_4072AD:				; CODE XREF: sub_407280+294j
		cmp	dword_40812C, 0FFFFFFFFh
		jz	loc_4074C0
		mov	edx, ds:dword_40B43C
		xor	eax, eax
		test	edx, edx
		jnz	loc_4074C0
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		cmp	dl, 2Dh
		jz	loc_4074EE

loc_4072DA:				; CODE XREF: sub_407280+268j
		mov	ebp, dword_40812C
		test	ebp, ebp
		jnz	loc_407520
		cmp	dl, 2Bh
		jz	loc_4076D7

loc_4072F1:				; CODE XREF: sub_407280+276j
					; sub_407280+2A6j ...
		test	eax, eax
		mov	ds:Filename, 0
		jz	loc_40739C
		mov	dword_408130, 0FFFFFFFFh
		mov	dword_408134, 0FFFFFFFFh
		jmp	short loc_407398
; ---------------------------------------------------------------------------
		align 10h

loc_407320:				; CODE XREF: sub_407280+159j
					; sub_407280+18Ej
		test	edi, 2
		mov	off_408138, offset byte_40A1F5
		jnz	loc_4075C1
		test	edi, 1
		jz	loc_4075B2
		mov	ebx, dword_408134
		cmp	ebx, 0FFFFFFFFh
		jz	loc_407536
		mov	esi, dword_408130
		xor	eax, eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_40738F
		mov	edx, [esp+4Ch+var_28]
		mov	eax, ebx
		mov	ecx, ebp
		sub	ebx, esi
		mov	[esp+4Ch+Str], edx
		mov	edx, esi
		call	sub_406E00
		mov	edx, dword_408124
		mov	eax, ds:dword_40B43C
		mov	dword_408130, 0FFFFFFFFh
		add	ebx, edx
		mov	dword_408134, ebx

loc_40738F:				; CODE XREF: sub_407280+DCj
					; sub_407280+2BEj
		add	edx, 1
		mov	dword_408124, edx

loc_407398:				; CODE XREF: sub_407280+97j
		test	eax, eax
		jnz	short loc_4073AD

loc_40739C:				; CODE XREF: sub_407280+7Dj
		mov	ebx, off_408138
		movzx	ecx, byte ptr [ebx]
		test	cl, cl
		jnz	loc_407437

loc_4073AD:				; CODE XREF: sub_407280+11Aj
		mov	ebp, dword_408124
		cmp	ebp, [esp+4Ch+var_24]
		mov	ds:dword_40B43C, 0
		mov	edx, ebp
		jge	loc_407543
		mov	ecx, [esp+4Ch+var_28]
		mov	ebx, [ecx+ebp*4]
		cmp	byte ptr [ebx],	2Dh
		mov	off_408138, ebx
		jnz	loc_407320
		movzx	ecx, byte ptr [ebx+1]
		test	cl, cl
		jnz	short loc_407414
		mov	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], 2Dh ; Val
		mov	[esp+4Ch+var_2C], cl
		mov	[esp+4Ch+var_30], ebp
		mov	[esp+4Ch+Str], eax ; Str
		call	strchr
		mov	edx, [esp+4Ch+var_30]
		movzx	ecx, [esp+4Ch+var_2C]
		test	eax, eax
		jz	loc_407320

loc_407414:				; CODE XREF: sub_407280+165j
		cmp	dword_408134, 0FFFFFFFFh
		mov	eax, ebx
		jz	short loc_40742C
		cmp	dword_408130, 0FFFFFFFFh
		jz	loc_407793

loc_40742C:				; CODE XREF: sub_407280+19Dj
					; sub_407280+519j
		test	cl, cl
		jnz	loc_407724
		movzx	ecx, byte ptr [ebx]

loc_407437:				; CODE XREF: sub_407280+127j
					; sub_407280+4B0j ...
		mov	esi, [esp+4Ch+arg_0]
		test	esi, esi
		jz	loc_4075F9
		mov	eax, dword_408124
		mov	edx, [esp+4Ch+var_28]
		cmp	ebx, [edx+eax*4]
		jz	loc_4075F9
		cmp	cl, 2Dh
		jz	loc_407783
		and	edi, 4
		jz	loc_4075F9
		xor	eax, eax
		cmp	cl, 3Ah
		jz	short loc_407489
		movsx	ecx, cl
		mov	[esp+4Ch+Val], ecx ; Val
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		setnz	al
		movzx	eax, al

loc_407489:				; CODE XREF: sub_407280+1ECj
					; sub_407280+50Ej
		mov	[esp+4Ch+Val], eax
		mov	eax, [esp+4Ch+arg_4]
		mov	ecx, [esp+4Ch+arg_0]
		mov	edx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], eax
		mov	eax, [esp+4Ch+var_28]
		call	sub_406F30
		cmp	eax, 0FFFFFFFFh
		mov	esi, eax
		jz	loc_4075F0

loc_4074B0:				; CODE XREF: sub_407280+5C2j
		mov	off_408138, offset byte_40A1F5
		jmp	loc_4075B7
; ---------------------------------------------------------------------------
		align 10h

loc_4074C0:				; CODE XREF: sub_407280+34j
					; sub_407280+44j
		mov	[esp+4Ch+Str], offset VarName ;	"POSIXLY_CORRECT"
		call	getenv
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		test	eax, eax
		setnz	al
		movzx	eax, al
		cmp	dl, 2Dh
		mov	dword_40812C, eax
		mov	eax, ds:dword_40B43C
		jnz	loc_4072DA

loc_4074EE:				; CODE XREF: sub_407280+54j
		or	edi, 2
		add	[esp+4Ch+var_20], 1
		jmp	loc_4072F1
; ---------------------------------------------------------------------------
		align 10h

loc_407500:				; CODE XREF: sub_407280+27j
		mov	ds:dword_40B43C, 1
		mov	dword_408124, 1
		jmp	loc_4072AD
; ---------------------------------------------------------------------------
		align 10h

loc_407520:				; CODE XREF: sub_407280+62j
		and	edi, 0FFFFFFFEh
		cmp	dl, 2Bh
		jnz	loc_4072F1
		add	[esp+4Ch+var_20], 1
		jmp	loc_4072F1
; ---------------------------------------------------------------------------

loc_407536:				; CODE XREF: sub_407280+CBj
		mov	dword_408134, ebp
		xor	eax, eax
		jmp	loc_40738F
; ---------------------------------------------------------------------------

loc_407543:				; CODE XREF: sub_407280+143j
		mov	ebx, dword_408130
		mov	off_408138, offset byte_40A1F5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_4075DF
		mov	edx, [esp+4Ch+var_28]
		mov	ecx, ebp
		mov	esi, dword_408134
		mov	[esp+4Ch+Str], edx

loc_40756B:				; CODE XREF: sub_407280+4EFj
		mov	eax, esi
		mov	edx, ebx
		call	sub_406E00
		sub	esi, ebx
		add	dword_408124, esi

loc_40757C:				; CODE XREF: sub_407280+367j
					; sub_407280+36Ej ...
		mov	esi, 0FFFFFFFFh
		mov	dword_408130, 0FFFFFFFFh
		mov	eax, esi
		mov	dword_408134, 0FFFFFFFFh
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40759F:				; CODE XREF: sub_407280+3A9j
		cmp	esi, 2Dh
		jnz	loc_4076E4
		cmp	byte ptr [ebx+1], 0
		jnz	loc_4076F1

loc_4075B2:				; CODE XREF: sub_407280+19j
					; sub_407280+BCj
		mov	esi, 0FFFFFFFFh

loc_4075B7:				; CODE XREF: sub_407280+23Aj
					; sub_407280+3CDj ...
		add	esp, 3Ch
		mov	eax, esi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4075C1:				; CODE XREF: sub_407280+B0j
		add	ebp, 1
		mov	esi, 1
		mov	ds:Filename, ebx
		mov	eax, esi
		mov	dword_408124, ebp
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4075DF:				; CODE XREF: sub_407280+2D6j
		mov	eax, dword_408134
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40757C
		mov	dword_408124, eax
		jmp	short loc_40757C
; ---------------------------------------------------------------------------

loc_4075F0:				; CODE XREF: sub_407280+22Aj
		mov	ebx, off_408138
		movzx	ecx, byte ptr [ebx]

loc_4075F9:				; CODE XREF: sub_407280+1BDj
					; sub_407280+1CFj ...
		movsx	esi, cl
		lea	edi, [ebx+1]
		cmp	esi, 3Ah
		mov	off_408138, edi
		jz	loc_4076E4
		cmp	esi, 2Dh
		jz	loc_407774

loc_407617:				; CODE XREF: sub_407280+4FEj
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], esi ; Val
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		jz	loc_40759F
		cmp	esi, 57h
		movzx	edx, byte ptr [eax+1]
		jnz	short loc_407640
		mov	ecx, [esp+4Ch+arg_0]
		test	ecx, ecx
		jnz	short loc_40765F

loc_407640:				; CODE XREF: sub_407280+3B6j
					; sub_407280+3E2j
		cmp	dl, 3Ah
		jz	loc_40779E
		cmp	byte ptr [ebx+1], 0
		jnz	loc_4075B7

loc_407653:				; CODE XREF: sub_407280+53Ej
		add	dword_408124, 1
		jmp	loc_4075B7
; ---------------------------------------------------------------------------

loc_40765F:				; CODE XREF: sub_407280+3BEj
		cmp	dl, 3Bh
		jnz	short loc_407640
		cmp	byte ptr [ebx+1], 0
		jnz	loc_407820
		mov	eax, dword_408124
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_408124, eax
		jg	loc_407814
		mov	ebp, dword_408128
		mov	off_408138, offset byte_40A1F5
		test	ebp, ebp
		jz	short loc_4076B6
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_4076B6
		mov	[esp+4Ch+Val], 57h ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_406EC0

loc_4076B6:				; CODE XREF: sub_407280+417j
					; sub_407280+420j
		mov	dword_408120, 57h

loc_4076C0:				; CODE XREF: sub_407280+58Fj
		mov	ecx, [esp+4Ch+var_20]
		xor	eax, eax
		cmp	byte ptr [ecx],	3Ah
		setnz	al
		mov	esi, eax
		lea	esi, [esi+esi*4+3Ah]
		jmp	loc_4075B7
; ---------------------------------------------------------------------------

loc_4076D7:				; CODE XREF: sub_407280+6Bj
		and	edi, 0FFFFFFFEh
		add	[esp+4Ch+var_20], 1
		jmp	loc_4072F1
; ---------------------------------------------------------------------------

loc_4076E4:				; CODE XREF: sub_407280+322j
					; sub_407280+388j
		cmp	byte ptr [ebx+1], 0
		jnz	short loc_4076F1
		add	dword_408124, 1

loc_4076F1:				; CODE XREF: sub_407280+32Cj
					; sub_407280+468j ...
		mov	ebx, dword_408128
		test	ebx, ebx
		jz	short loc_407714
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_407714
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aUnknownOptionC ;	"unknown option	-- %c"
		call	sub_406EC0

loc_407714:				; CODE XREF: sub_407280+479j
					; sub_407280+482j
		mov	dword_408120, esi
		mov	esi, 3Fh
		jmp	loc_4075B7
; ---------------------------------------------------------------------------

loc_407724:				; CODE XREF: sub_407280+1AEj
		add	ebx, 1
		cmp	cl, 2Dh
		mov	off_408138, ebx
		jnz	loc_407437
		cmp	byte ptr [eax+2], 0
		jnz	loc_407437
		mov	ebx, dword_408130
		lea	ecx, [ebp+1]
		mov	dword_408124, ecx
		mov	off_408138, offset byte_40A1F5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40757C
		mov	edx, [esp+4Ch+var_28]
		mov	esi, dword_408134
		mov	[esp+4Ch+Str], edx
		jmp	loc_40756B
; ---------------------------------------------------------------------------

loc_407774:				; CODE XREF: sub_407280+391j
		cmp	byte ptr [ebx+1], 0
		jnz	loc_4076F1
		jmp	loc_407617
; ---------------------------------------------------------------------------

loc_407783:				; CODE XREF: sub_407280+1D8j
		add	ebx, 1
		xor	eax, eax
		mov	off_408138, ebx
		jmp	loc_407489
; ---------------------------------------------------------------------------

loc_407793:				; CODE XREF: sub_407280+1A6j
		mov	dword_408130, ebp
		jmp	loc_40742C
; ---------------------------------------------------------------------------

loc_40779E:				; CODE XREF: sub_407280+3C3j
		mov	ds:Filename, 0
		cmp	byte ptr [ebx+1], 0
		jz	short loc_4077C3
		mov	ds:Filename, edi

loc_4077B4:				; CODE XREF: sub_407280+547j
					; sub_407280+5D3j
		mov	off_408138, offset byte_40A1F5
		jmp	loc_407653
; ---------------------------------------------------------------------------

loc_4077C3:				; CODE XREF: sub_407280+52Cj
		cmp	byte ptr [eax+2], 3Ah
		jz	short loc_4077B4
		mov	eax, dword_408124
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_408124, eax
		jg	short loc_407847
		mov	edi, dword_408128
		mov	off_408138, offset byte_40A1F5
		test	edi, edi
		jz	short loc_407809
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_407809
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_406EC0

loc_407809:				; CODE XREF: sub_407280+56Ej
					; sub_407280+577j
		mov	dword_408120, esi
		jmp	loc_4076C0
; ---------------------------------------------------------------------------

loc_407814:				; CODE XREF: sub_407280+3FFj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	off_408138, eax

loc_407820:				; CODE XREF: sub_407280+3E8j
		mov	ecx, [esp+4Ch+arg_4]
		mov	edx, [esp+4Ch+var_20]
		mov	eax, [esp+4Ch+var_28]
		mov	[esp+4Ch+Val], 0
		mov	[esp+4Ch+Str], ecx
		mov	ecx, [esp+4Ch+arg_0]
		call	sub_406F30
		mov	esi, eax
		jmp	loc_4074B0
; ---------------------------------------------------------------------------

loc_407847:				; CODE XREF: sub_407280+55Aj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	ds:Filename, eax
		jmp	loc_4077B4
sub_407280	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+4]
		mov	edx, [esp+8]
		mov	ecx, [esp+0Ch]
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		jmp	sub_407280
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407890	proc near		; CODE XREF: sub_401600+518p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		mov	ebx, [esp+4+arg_10]
		mov	edx, [esp+4+arg_4]
		mov	eax, [esp+4+arg_0]
		mov	ecx, [esp+4+arg_8]
		mov	[esp+4+arg_4], ebx
		mov	ebx, [esp+4+arg_C]
		mov	[esp+4+arg_8], 1
		mov	[esp+4+arg_0], ebx
		pop	ebx
		jmp	sub_407280
sub_407890	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+18h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		mov	[esp+0Ch], ebx
		mov	ebx, [esp+14h]
		mov	dword ptr [esp+10h], 5
		mov	[esp+8], ebx
		pop	ebx
		jmp	sub_407280
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_4078F0	proc near		; CODE XREF: sub_40385A+85p
		jmp	sub_407BC0
sub_4078F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_407900	proc near		; CODE XREF: sub_40385A+109p
		jmp	sub_407BD0
sub_407900	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_407910	proc near		; CODE XREF: sub_407AF0+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_40795C
		jmp	short loc_407964
; ---------------------------------------------------------------------------
		align 10h

loc_407950:				; CODE XREF: sub_407910+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_407964

loc_40795C:				; CODE XREF: sub_407910+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_407950

loc_407964:				; CODE XREF: sub_407910+39j
					; sub_407910+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_40798C
		jmp	short loc_407994
; ---------------------------------------------------------------------------
		align 10h

loc_407980:				; CODE XREF: sub_407910+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_407994

loc_40798C:				; CODE XREF: sub_407910+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_407980

loc_407994:				; CODE XREF: sub_407910+6Aj
					; sub_407910+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_407A50
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_407A7E

loc_4079B3:				; CODE XREF: sub_407910+168j
					; sub_407910+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_407A90

loc_4079E3:				; CODE XREF: sub_407910+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_40B060
		test	eax, eax
		jz	loc_407AC9
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_407AB1
		cmp	eax, 5
		jnz	short loc_407AAC
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_407A50:				; CODE XREF: sub_407910+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_4079B3

loc_407A7E:				; CODE XREF: sub_407910+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_4079B3
; ---------------------------------------------------------------------------
		align 10h

loc_407A90:				; CODE XREF: sub_407910+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_4079E3
; ---------------------------------------------------------------------------

loc_407AAC:				; CODE XREF: sub_407910+133j
		call	abort
; ---------------------------------------------------------------------------

loc_407AB1:				; CODE XREF: sub_407910+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_407AC9:				; CODE XREF: sub_407910+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_2 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_407910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_407AF0(char *, char *, int)
sub_407AF0	proc near		; CODE XREF: sub_403B1B+26p

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_407B56
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_407B40:				; CODE XREF: sub_407AF0+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_407B40
		add	edx, edx

loc_407B56:				; CODE XREF: sub_407AF0+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_407B7D
		xor	edi, edi

loc_407B67:				; CODE XREF: sub_407AF0+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_407B67
		add	edx, edx

loc_407B7D:				; CODE XREF: sub_407AF0+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_407910
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_407AF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407BC0	proc near		; CODE XREF: sub_4078F0j
		mov	eax, ds:time
		jmp	eax
sub_407BC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407BD0	proc near		; CODE XREF: sub_407900j
		mov	eax, ds:ctime
		jmp	eax
sub_407BD0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ungetc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fgetc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION feof]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sscanf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fgets]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407D30	proc near		; DATA XREF: .text:00407D54o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_405DA0
		leave
		retn
sub_407D30	endp

; ---------------------------------------------------------------------------
		align 10h
dword_407D50	dd 0FFFFFFFFh		; DATA XREF: sub_4069C0-4Cr
					; sub_4069C0:loc_406983r ...
		dd offset sub_407D30
		dd 0
		dd 0FFFFFFFFh
dword_407D60	dd 28h dup(0)		; DATA XREF: .data:off_408114o
		dd 80h dup(?)
_text		ends

; Section 2. (virtual address 00008000)
; Virtual size			: 00000148 (	328.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00007200
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 408000h
dword_408000	dd 4Eh			; DATA XREF: sub_401600+368w
					; sub_40385A+8Dr
		align 20h
off_408020	dd offset aHelp		; DATA XREF: sub_401600+4FBo
					; "help"
		dd 2 dup(0)
		dd 100h, 409049h, 2 dup(0)
		dd 101h, 409051h, 2 dup(0)
		dd 102h, 409059h, 1, 0
		dd 103h, 409060h, 1, 0
		dd 104h, 40906Bh, 1, 0
		dd 105h, 409077h, 1, 0
		dd 106h, 409084h, 1, 0
		dd 107h, 40908Fh, 1, 0
		dd 108h, 409097h, 1, 0
		dd 109h, 40909Fh, 2 dup(0)
		dd 10Ah, 4090B0h, 2 dup(0)
		dd 10Bh, 4090BCh, 1, 0
		dd 10Ch, 4 dup(0)
dword_408100	dd 0B704CEh		; DATA XREF: sub_4034C6+12Ar
					; sub_403A3E+1Bo ...
dword_408104	dd 0B704CEh		; DATA XREF: sub_4034C6+3Er
					; sub_4034C6+65w ...
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_408114	dd offset dword_407D60	; DATA XREF: sub_406940+3r
					; sub_406940+12r ...
dword_408118	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_40811C	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_408120	dd 3Fh			; DATA XREF: sub_406F30:loc_407087w
					; sub_406F30+1F8w ...
dword_408124	dd 1			; DATA XREF: sub_406F30+15r
					; sub_406F30+39w ...
dword_408128	dd 1			; DATA XREF: sub_406F30+12Cr
					; sub_406F30+1C3r ...
dword_40812C	dd 0FFFFFFFFh		; DATA XREF: sub_407280:loc_4072ADr
					; sub_407280:loc_4072DAr ...
dword_408130	dd 0FFFFFFFFh		; DATA XREF: sub_407280+83w
					; sub_407280+D1r ...
dword_408134	dd 0FFFFFFFFh		; DATA XREF: sub_407280+8Dw
					; sub_407280+C2r ...
; char *off_408138
off_408138	dd offset byte_40A1F5	; DATA XREF: sub_406F30+Br
					; sub_407280+A6w ...
dword_40813C	dd 0BB40E64Eh		; DATA XREF: sub_4069E0+3r
					; sub_4069E0:loc_406A92w ...
dword_408140	dd 44BF19B1h		; DATA XREF: sub_4069E0+31w
					; sub_4069E0+B8w ...
dword_408144	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00009000)
; Virtual size			: 00001340 (   4928.)
; Section size in file		: 00001400 (   5120.)
; Offset to raw	data for section: 00007400
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 409000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
aHelp		db 'help',0             ; DATA XREF: .data:off_408020o
aVersion	db 'version',0
aVerbose	db 'verbose',0
aOutput		db 'output',0
aInputType	db 'input-type',0
aOutputType	db 'output-type',0
aOutputWidth	db 'output-width',0
aSecretKey	db 'secret-key',0
aPubring	db 'pubring',0
aSecrets	db 'secrets',0
aIgnoreCrcErr_0	db 'ignore-crc-error',0
aFileFormat	db 'file-format',0
aComment	db 'comment',0
; char Str[]
Str		db 'Usage: paperkey [OPTIONS]',0 ; DATA XREF: sub_401550+6o
; char aHelpH[]
aHelpH		db '  --help (-h)',0    ; DATA XREF: sub_401550+12o
; char aVersionV[]
aVersionV	db '  --version (-V)',0 ; DATA XREF: sub_401550+1Eo
		align 10h
; char aVerboseVBeMore[]
aVerboseVBeMore	db '  --verbose (-v)  be more verbose',0 ; DATA XREF: sub_401550+2Ao
		align 4
; char aOutputOWriteOu[]
aOutputOWriteOu	db '  --output (-o)   write output to this file',0
					; DATA XREF: sub_401550+36o
; char aInputTypeAutoB[]
aInputTypeAutoB	db '  --input-type    auto, base16 or raw (binary)',0
					; DATA XREF: sub_401550+42o
		align 10h
; char aOutputTypeBase[]
aOutputTypeBase	db '  --output-type   base16 or raw (binary)',0 ; DATA XREF: sub_401550+4Eo
		align 4
; char aOutputWidthMax[]
aOutputWidthMax	db '  --output-width  maximum width of base16 output',0
					; DATA XREF: sub_401550+5Ao
		align 10h
; char aSecretKeyExtra[]
aSecretKeyExtra	db '  --secret-key    extract secret data from this secret key',0
					; DATA XREF: sub_401550+66o
		align 4
; char aPubringPublicK[]
aPubringPublicK	db '  --pubring       public keyring to find non-secret data',0
					; DATA XREF: sub_401550+72o
		align 4
; char aSecretsFileCon[]
aSecretsFileCon	db '  --secrets       file containing secret data to join with the pu'
					; DATA XREF: sub_401550+7Eo
		db 'blic key',0
		align 4
; char aIgnoreCrcError[]
aIgnoreCrcError	db '  --ignore-crc-error  don',27h,'t reject corrupted input',0
					; DATA XREF: sub_401550+8Ao
		align 4
; char aFileFormatShow[]
aFileFormatShow	db '  --file-format   show the paperkey file format',0
					; DATA XREF: sub_401550+96o
; char aCommentAddACom[]
aCommentAddACom	db '  --comment       add a comment to the base16 output',0
					; DATA XREF: sub_401550+A2o
		align 10h
; char Format[]
Format		db 'Unable to set stdin mode to binary: %s',0Ah,0
					; DATA XREF: sub_401600+68o
; char aSS[]
aSS		db '%s (%s)',0Ah,0      ; DATA XREF: sub_401600:loc_40176Fo
aMingw32	db 'mingw32',0          ; DATA XREF: sub_401600+174o
aPaperkey1_3	db 'paperkey 1.3',0     ; DATA XREF: sub_401600+17Co
		align 4
; char aCopyrightC2007[]
aCopyrightC2007	db 'Copyright (C) 2007, 2008, 2009, 2012 David Shaw <dshaw@jabberwock'
					; DATA XREF: sub_401600+18Co
		db 'y.com>',0
; char aThisIsFreeSoft[]
aThisIsFreeSoft	db 'This is free software.  You may redistribute copies of it under t'
					; DATA XREF: sub_401600+198o
		db 'he terms of',0
		align 10h
; char aTheGnuGeneralP[]
aTheGnuGeneralP	db 'the GNU General Public License <http://www.gnu.org/licenses/gpl.h'
					; DATA XREF: sub_401600+1A4o
		db 'tml>.',0
		align 4
; char aThereIsNoWarra[]
aThereIsNoWarra	db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
					; DATA XREF: sub_401600+1B0o
aAuto		db 'auto',0             ; DATA XREF: sub_401600+1EFo
aBase16		db 'base16',0           ; DATA XREF: sub_401600+226o
					; sub_401600+2C4o
aRaw		db 'raw',0              ; DATA XREF: sub_401600+25Do
					; sub_401600+2FBo
; char aUnknownInputTy[]
aUnknownInputTy	db 'Unknown input type "%s"',0Ah,0 ; DATA XREF: sub_401600+293o
; char aUnknownOutputT[]
aUnknownOutputT	db 'Unknown output type "%s"',0Ah,0 ; DATA XREF: sub_401600+331o
; char Mode[]
Mode		db 'rb',0               ; DATA XREF: sub_401600:loc_401972o
					; sub_401600:loc_4019DCo ...
; char aUnableToOpenSS[]
aUnableToOpenSS	db 'Unable to open %s: %s',0Ah,0 ; DATA XREF: sub_401600+3AEo
					; sub_401600+482o
; char aUnableToOpenPu[]
aUnableToOpenPu	db 'Unable to open pubring %s: %s',0Ah,0 ; DATA XREF: sub_401600+418o
byte_40951B	db 0			; DATA XREF: sub_401600+4C4o
aHvvo		db 'hVvo:',0            ; DATA XREF: sub_401600+503o
		align 4
aUnableToAlloca	db 'Unable to allocate memory',0Ah,0 ; DATA XREF: sub_401B8C+29o
		align 10h
aInvalidPartial	db 'Invalid partial packet encoding',0Ah,0 ; DATA XREF: sub_401CFC+130o
		align 4
aErrorUnableToP	db 'Error: unable to parse old-style length',0Ah,0
					; DATA XREF: sub_401CFC+2A7o
		align 10h
; char aFoundPacketOfT[]
aFoundPacketOfT	db 'Found packet of type %d, length %d',0Ah,0 ; DATA XREF: sub_401CFC+2DBo
aErrorUnableT_0	db 'Error: unable to parse OpenPGP packets (is this armored data?)',0Ah,0
					; DATA XREF: sub_401CFC+30Ao
; char aShortReadOnPac[]
aShortReadOnPac	db 'Short read on packet type %d',0Ah,0 ; DATA XREF: sub_401CFC+3C3o
		align 4
aVersion3Pgp2_x	db 'Version 3 (PGP 2.x style) keys are not supported.',0Ah,0
					; DATA XREF: sub_4021F5+2Fo
; char aUnableToParseA[]
aUnableToParseA	db 'Unable to parse algorithm %u',0Ah,0 ; DATA XREF: sub_4021F5+50Eo
		align 4
off_409668	dd offset loc_4026EF	; DATA XREF: sub_4021F5+ABr
		dd offset loc_4022A9	; jump table for switch	statement
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_4026EF
		dd offset loc_402359
		dd offset loc_40245F
		dd offset loc_4025BB
		dd offset loc_40266F
aErrorUnableToR	db 'Error: unable to read secrets file',0Ah,0 ; DATA XREF: sub_40273A+95o
; char aErrorMissingLi[]
aErrorMissingLi	db 'Error: missing line number %u (saw %u)',0Ah,0
					; DATA XREF: sub_40273A+1A9o
; char a06lx[]
a06lx		db '%06lX',0            ; DATA XREF: sub_40273A+25Eo
		align 4
; char aCrcOnLineDDoes[]
aCrcOnLineDDoes	db 'CRC on line %d does not match (%06lX!=%06lX)',0Ah,0
					; DATA XREF: sub_40273A+2B2o
; char a02x[]
a02x		db '%02X',0             ; DATA XREF: sub_40273A:loc_402A46o
		align 10h
; char aNoColonFoundIn[]
aNoColonFoundIn	db 'No colon ',27h,':',27h,' found in line %u',0Ah,0
					; DATA XREF: sub_40273A:loc_402ABBo
		align 10h
; char aCrcOfSecretDoe[]
aCrcOfSecretDoe	db 'CRC of secret does not match (%06lX!=%06lX)',0Ah,0
					; DATA XREF: sub_40273A+436o
aCrcOfSecretIsM	db 'CRC of secret is missing',0Ah,0 ; DATA XREF: sub_40273A+47Bo
		align 4
aUnableToFindSe	db 'Unable to find secret key packet',0Ah,0 ; DATA XREF: sub_402C00+36o
; char aSecretOffsetIs[]
aSecretOffsetIs	db 'Secret offset is %d',0Ah,0 ; DATA XREF: sub_402C00+89o
aPrimaryKeyFing	db 'Primary key fingerprint: ',0 ; DATA XREF: sub_402C00+D4o
; char aSecretSubkeyOf[]
aSecretSubkeyOf	db 'Secret subkey offset is %d',0Ah,0 ; DATA XREF: sub_402C00+1E2o
aSubkeyFingerpr	db 'Subkey fingerprint: ',0 ; DATA XREF: sub_402C00+22Do
		align 4
; char aCannotHandleSe[]
aCannotHandleSe	db 'Cannot handle secrets file version %d',0Ah,0 ; DATA XREF: sub_402F44+3Fo
		align 4
aWarningShortDa	db 'Warning: Short data in secret image',0Ah,0 ; DATA XREF: sub_402F44+16Bo
		align 4
aWarningCorrupt	db 'Warning: Corrupt data in secret image',0Ah,0
					; DATA XREF: sub_402F44+1A1o
		align 4
aWarningShortHe	db 'Warning: Short header in secret image',0Ah,0
					; DATA XREF: sub_402F44+1CCo
		align 4
aUnableToCheckT	db 'Unable to check type of secrets file',0Ah,0 ; DATA XREF: sub_403180+2Co
aUnableToParseS	db 'Unable to parse secret data',0Ah,0 ; DATA XREF: sub_403180+271o
aUnableToReadSe	db 'Unable to read secrets file',0Ah,0 ; DATA XREF: sub_403180+2A1o
; char a06lx_0[]
a06lx_0		db '%06lX',0Ah,0        ; DATA XREF: sub_4034C6+4Bo
					; sub_4034C6+110o
; char a3u[]
a3u		db '%3u: ',0            ; DATA XREF: sub_4034C6+82o
; char a02x_0[]
a02x_0		db '%02X ',0            ; DATA XREF: sub_4034C6+AAo
; char a3u06lx[]
a3u06lx		db '%3u: %06lX',0Ah,0   ; DATA XREF: sub_4034C6+13Fo
; char a02x_1[]
a02x_1		db '%02X',0             ; DATA XREF: sub_403629+1Do
; char aSfileFormat[]
aSfileFormat	db '%sFile format:',0Ah,0 ; DATA XREF: sub_40366C+6o
; char aSa1OctetVersio[]
aSa1OctetVersio	db '%sa) 1 octet:  Version of the paperkey format (currently 0).',0Ah,0
					; DATA XREF: sub_40366C+21o
		align 10h
; char aSb1OctetOpenpg[]
aSb1OctetOpenpg	db '%sb) 1 octet:  OpenPGP key or subkey version (currently 4)',0Ah,0
					; DATA XREF: sub_40366C+3Co
; char aScNOctetsKeyFi[]
aScNOctetsKeyFi	db '%sc) n octets: Key fingerprint (20 octets for a version 4 key or '
					; DATA XREF: sub_40366C+57o
		db 'subkey)',0Ah,0
		align 4
; char aSd2Octets16Bit[]
aSd2Octets16Bit	db '%sd) 2 octets: 16-bit big endian length of the following secret d'
					; DATA XREF: sub_40366C+72o
		db 'ata',0Ah,0
		align 10h
; char aSeNOctetsSecre[]
aSeNOctetsSecre	db '%se) n octets: Secret data: a partial OpenPGP secret key or subke'
					; DATA XREF: sub_40366C+8Do
		db 'y packet as',0Ah,0
		align 10h
; char aSSpecifiedInRf[]
aSSpecifiedInRf	db '%s             specified in RFC 4880, starting with the string-to'
					; DATA XREF: sub_40366C+A8o
		db '-key usage',0Ah,0
		align 10h
; char aSOctetAndConti[]
aSOctetAndConti	db '%s             octet and continuing until the end of the packet.',0Ah
					; DATA XREF: sub_40366C+C3o
		db 0
		align 4
; char aSrepeatFieldsB[]
aSrepeatFieldsB	db '%sRepeat fields b through e as needed to cover all subkeys.',0Ah,0
					; DATA XREF: sub_40366C+DEo
; char aS[]
aS		db '%s',0Ah,0           ; DATA XREF: sub_40366C+F9o
		align 4
; char aStoRecoverASec[]
aStoRecoverASec	db '%sTo recover a secret key without using the paperkey program, use'
					; DATA XREF: sub_40366C+114o
		db ' the',0Ah,0
		align 10h
; char aSkeyFingerprin[]
aSkeyFingerprin	db '%skey fingerprint to match an existing public key packet with the'
					; DATA XREF: sub_40366C+12Fo
		db 0Ah,0
		align 4
; char aScorresponding[]
aScorresponding	db '%scorresponding secret data from the paper key.  Next, append thi'
					; DATA XREF: sub_40366C+14Ao
		db 's secret',0Ah,0
		align 10h
; char aSdataToThePubl[]
aSdataToThePubl	db '%sdata to the public key packet.  Finally, switch the public key '
					; DATA XREF: sub_40366C+165o
		db 'packet tag',0Ah,0
		align 10h
; char aSfrom6To514To7[]
aSfrom6To514To7	db '%sfrom 6 to 5 (14 to 7 for subkeys).  This will recreate the orig'
					; DATA XREF: sub_40366C+180o
		db 'inal secret',0Ah,0
		align 10h
; char aSkeyOrSecretSu[]
aSkeyOrSecretSu	db '%skey or secret subkey packet.  Repeat as needed for all public k'
					; DATA XREF: sub_40366C+19Bo
		db 'ey or subkey',0Ah,0
		align 10h
; char aSpacketsInTheP[]
aSpacketsInTheP	db '%spackets in the public key.  All other packets (user IDs, signat'
					; DATA XREF: sub_40366C+1B6o
		db 'ures, etc.)',0Ah,0
		align 10h
; char aSmaySimplyBeCo[]
aSmaySimplyBeCo	db '%smay simply be copied from the public key.',0Ah,0
					; DATA XREF: sub_40366C+1D1o
; char aWb[]
aWb		db 'wb',0               ; DATA XREF: sub_40385A+12o
; char aW[]
aW		db 'w',0                ; DATA XREF: sub_40385A:loc_403887o
aSecretPortions	db '# Secret portions of key ',0 ; DATA XREF: sub_40385A+B1o
; char aBase16DataExtr[]
aBase16DataExtr	db '# Base16 data extracted %.24s',0Ah,0 ; DATA XREF: sub_40385A+10Eo
		align 4
aCreatedWithPap	db '# Created with paperkey 1.3 by David Shaw',0Ah
					; DATA XREF: sub_40385A+12Fo
		db '#',0Ah,0
asc_409E49	db '# ',0               ; DATA XREF: sub_40385A+155o
aEachBase16Line	db '#',0Ah              ; DATA XREF: sub_40385A+16Bo
		db '# Each base16 line ends with a CRC-24 of that line.',0Ah,0
		align 4
aTheEntireBlock	db '# The entire block of data ends with a CRC-24 of the entire block'
					; DATA XREF: sub_40385A+192o
		db ' of data.',0Ah
		db 0Ah,0
; char aS_0[]
aS_0		db '# %s',0Ah           ; DATA XREF: sub_40385A+1C2o
		db 0Ah,0
; char a__Paperkey1_3O[]
a__Paperkey1_3O	db '../paperkey-1.3/output.c',0 ; DATA XREF: sub_403B1B+17o
; char aLength65535[]
aLength65535	db 'length<=65535',0    ; DATA XREF: sub_403B1B+1Fo
		align 10h
aA		db '',0                ; DATA XREF: sub_403E93+13Bo
		align 40h
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_409F7C	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_405FB0+3o
		align 10h
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_405FB0+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_40A09Co
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0040A0A0o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0040A0A4o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0040A0A8o
		align 10h
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0040A0ACo
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0040A0B0o
		align 4
off_40A09C	dd offset aArgumentDomain ; DATA XREF: sub_405FB0+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_406020+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_406080+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_406080+1F9o
					; sub_406080+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_406080+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_4062C0+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_4062C0+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_406870:loc_406910o
		unicode	0, <msvcrt.dll>,0
		align 4
off_40A1C4	dd offset dword_40B380	; DATA XREF: .text:00406B08o
		dd offset dword_40B0A0
		align 20h
; char aS_1[]
aS_1		db '%s: ',0             ; DATA XREF: sub_406EC0+11o
; char VarName[]
VarName		db 'POSIXLY_CORRECT',0  ; DATA XREF: sub_407280:loc_4074C0o
byte_40A1F5	db 0			; DATA XREF: sub_407280+A6o
					; sub_407280:loc_4074B0o ...
; char aUnknownOptionC[]
aUnknownOptionC	db 'unknown option -- %c',0 ; DATA XREF: sub_407280+488o
		align 20h
; char aOptionRequir_0[]
aOptionRequir_0	db 'option requires an argument -- %c',0 ; DATA XREF: sub_407280+42Ao
					; sub_407280+57Do
; char aAmbiguousOptio[]
aAmbiguousOptio	db 'ambiguous option -- %.*s',0 ; DATA XREF: sub_406F30+147o
		align 10h
; char aOptionDoesnTTa[]
aOptionDoesnTTa	db 'option doesn',27h,'t take an argument -- %.*s',0
					; DATA XREF: sub_406F30+1DDo
		align 20h
; char aOptionRequires[]
aOptionRequires	db 'option requires an argument -- %s',0 ; DATA XREF: sub_406F30+2BAo
; char aUnknownOptionS[]
aUnknownOptionS	db 'unknown option -- %s',0 ; DATA XREF: sub_406F30+269o
		align 10h
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_407910+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_2[]
aS_2		db '%s',0Ah,0           ; DATA XREF: sub_407910+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_407910+10Fo
		align 10h
dword_40A340	dd 0			; DATA XREF: sub_4062C0+59o
					; sub_4062C0+5Eo ...
dword_40A344	dd 0			; DATA XREF: sub_4062C0+7Fr
dword_40A348	dd 0			; DATA XREF: sub_4062C0:loc_40640Cr
dword_40A34C	dd 2Dh dup(0)		; DATA XREF: sub_4062C0+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 0000B000)
; Virtual size			: 00000444 (   1092.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 40B000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_40B000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_40B004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_40B008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_40B00C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_40B010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_40B014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_40B018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_40B01C	dd ?			; DATA XREF: sub_401010+3Aw
dword_40B020	dd ?			; DATA XREF: sub_401600:loc_4017C8r
					; sub_401600+1D0w ...
dword_40B024	dd ?			; DATA XREF: sub_401600:loc_401AB0w
					; sub_40273A+2DBr ...
dword_40B028	dd ?			; DATA XREF: sub_401600+4E5w
					; sub_40385A+1B3r ...
dword_40B02C	dd ?			; DATA XREF: sub_40385A+69w
					; sub_403A3E+27r
; FILE *File
File		dd ?			; DATA XREF: sub_4034C6+50r
					; sub_4034C6+87r ...
dword_40B034	dd ?			; DATA XREF: sub_4034C6+22r
					; sub_40385A+A6w
dword_40B038	dd ?			; DATA XREF: sub_4034C6:loc_4034E3r
					; sub_4034C6+E8r ...
dword_40B03C	dd ?			; DATA XREF: sub_4034C6+35r
					; sub_4034C6:loc_403535r ...
dword_40B040	dd ?			; DATA XREF: sub_401010+3r
dword_40B044	dd ?			; DATA XREF: sub_401010+25r
dword_40B048	dd ?			; DATA XREF: sub_401060+22w
dword_40B04C	dd ?			; DATA XREF: sub_401060+18w
dword_40B050	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_40B05C	dd ?			; DATA XREF: sub_401060+2Cw
dword_40B060	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_40B064	dd ?			; DATA XREF: sub_401060+5Er
dword_40B068	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_405E2Cr
dword_40B06C	dd ?			; DATA XREF: .text:00405F53r
					; sub_405FA0+4w
dword_40B070	dd ?			; DATA XREF: sub_4062C0+9r
					; sub_4062C0:loc_4062E0w
dword_40B074	dd ?			; DATA XREF: sub_406080+1Dr
					; sub_406080+58r ...
dword_40B078	dd ?			; DATA XREF: sub_406080+Br
					; sub_406080:loc_40613Fw ...
dword_40B07C	dd ?			; DATA XREF: sub_406870+4r
					; sub_406870+92w ...
dword_40B080	dd ?			; DATA XREF: sub_4069C0r
					; sub_4069C0:loc_4069D0w
		align 20h
dword_40B0A0	dd 2Bh dup(?)		; DATA XREF: .rdata:0040A1C8o
dword_40B14C	dd ?			; DATA XREF: .text:00406AEAw
		dd 2 dup(?)
dword_40B158	dd ?			; DATA XREF: .text:00406AD6w
		dd 2 dup(?)
dword_40B164	dd ?			; DATA XREF: .text:00406ABCw
		dd 86h dup(?)
dword_40B380	dd ?			; DATA XREF: .text:00406AC2w
					; .rdata:off_40A1C4o
dword_40B384	dd ?			; DATA XREF: .text:00406ACCw
		dd ?
dword_40B38C	dd ?			; DATA XREF: .text:00406ADBw
		dd 14h dup(?)
dword_40B3E0	dd ?			; DATA XREF: .text:00406BB3r
					; .text:00406C44r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_406B40+7o
					; sub_406B40:loc_406B95o ...
dword_40B3FC	dd ?			; DATA XREF: sub_406B40+14r
					; .text:00406C08r ...
		dd ?
dword_40B404	dd ?			; DATA XREF: sub_401180+1A8w
dword_40B408	dd ?			; DATA XREF: sub_401180+1BFw
dword_40B40C	dd ?			; DATA XREF: sub_401180+1B2w
dword_40B410	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_405C13w ...
dword_40B414	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_40B418	dd ?			; DATA XREF: TlsCallback_0:loc_405B64w
dword_40B41C	dd ?			; DATA XREF: sub_401060+64w
					; sub_405CE0+3Fr ...
dword_40B420	dd ?			; DATA XREF: sub_401060+69w
					; sub_405CE0+4r ...
dword_40B424	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_40B428	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		dd 4 dup(?)
dword_40B43C	dd ?			; DATA XREF: sub_407280+3Ar
					; sub_407280+F8r ...
; char *Filename
Filename	dd ?			; DATA XREF: sub_401600:loc_4017DAr
					; sub_401600:loc_4017E8r ...
		align 1000h
_bss		ends

;
; Imports from KERNEL32.dll
;
; Section 5. (virtual address 0000C000)
; Virtual size			: 000008D8 (   2264.)
; Section size in file		: 00000A00 (   2560.)
; Offset to raw	data for section: 00008800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_406CE0+44p
					; DATA XREF: sub_406CE0+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_406B40+Ep
					; .text:00406C02p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:00406B18p
					; DATA XREF: .text:00406B18r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_4069E0+6Cp
					; DATA XREF: sub_4069E0+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_4069E0+74p
					; DATA XREF: sub_4069E0+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_406080+1CCp
					; sub_406B40+3Cp
					; DATA XREF: ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_407910+C2p
					; DATA XREF: sub_407910+C2r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_406870+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_4069E0+57p
					; DATA XREF: sub_4069E0+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_4069E0+7Cp
					; DATA XREF: sub_4069E0+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_406CE0+87p
					; DATA XREF: sub_406CE0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_406B40+5Cp
					; .text:00406C20p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: TlsCallback_0+55p
					; DATA XREF: TlsCallback_0+55r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_406870+A7p
					; DATA XREF: sub_406870+A7r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_4069E0+8Bp
					; DATA XREF: sub_4069E0+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:00406AFFp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00406B29p
					; DATA XREF: .text:00406B29r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_406B40+35p
					; DATA XREF: sub_406B40+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:00406B0Fp
					; DATA XREF: .text:00406B0Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_406080+142p
					; sub_406080+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_406080+A1p
					; sub_406080+D9p ...

;
; Imports from msvcrt.dll
;
		extrn __imp__umask:dword ; DATA	XREF: _umaskr

;
; Imports from msvcrt.dll
;
; char **_argv
		extrn __argv:dword	; DATA XREF: sub_406EC0+4r
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_405CB0r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_401600+5Cp
					; sub_401600+39Cp ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
; int __cdecl fileno(FILE *File)
		extrn _fileno:dword	; CODE XREF: sub_401600+3Ep
					; DATA XREF: sub_401600+39r
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
; FILE *iob
		extrn _iob:dword	; DATA XREF: sub_401600+31r
					; sub_401600+6Dr ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_405CE0+A3p
					; DATA XREF: sub_405CE0+A3r
		extrn _setmode:dword	; CODE XREF: sub_401600+50p
					; DATA XREF: sub_401600+4Br
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; char *__cdecl	static ctime(const time_t *Time)
		extrn ctime:dword	; DATA XREF: sub_407BD0r
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl feof(FILE	*File)
		extrn __imp_feof:dword	; DATA XREF: feofr
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fgetc(FILE *File)
		extrn __imp_fgetc:dword	; DATA XREF: fgetcr
; char *__cdecl	fgets(char *Buf, int MaxCount, FILE *File)
		extrn __imp_fgets:dword	; DATA XREF: fgetsr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputc(int	Ch, FILE *File)
		extrn __imp_fputc:dword	; DATA XREF: fputcr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl isprint(int C)
		extrn isprint:dword	; CODE XREF: sub_403180+6Ap
					; DATA XREF: sub_403180+65r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; int sscanf(const char	*Src, const char *Format, ...)
		extrn __imp_sscanf:dword ; DATA	XREF: sscanfr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_407BC0r
; int __cdecl ungetc(int Ch, FILE *File)
		extrn __imp_ungetc:dword ; DATA	XREF: ungetcr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_407910+122p
					; DATA XREF: sub_407910+122r


; Section 6. (virtual address 0000D000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00009200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 40D000h
dword_40D000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_40D008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_40D00C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_405CB0
dword_40D018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_40D030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_405C53o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 0000E000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00009400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 40E000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
