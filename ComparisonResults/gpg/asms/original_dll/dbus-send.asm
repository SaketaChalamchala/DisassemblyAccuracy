;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	3EF09EFE5A8FE9F94F50F58776918F4D
; Input	CRC32 :	7F7587DC

; File Name   :	C:\compspace\compare\gpg\dlls\original\dbus-send.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00007C24 (  31780.)
; Section size in file		: 00007E00 (  32256.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:0040D004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_40B02C
		mov	[esp+2Ch+var_1C], offset dword_40B024
		mov	[esp+2Ch+var_24], offset dword_40B018
		mov	[esp+2Ch+var_28], offset dword_40B014
		mov	ds:dword_40B024, eax
		mov	eax, dword_409000
		mov	[esp+2Ch+var_2C], offset dword_40B010
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_40B01C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:0040D010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_40B034, 1
		mov	ds:dword_40B038, 1
		mov	ds:dword_40B03C, 1
		mov	ds:dword_40B040, 1
		jz	short loc_401102

loc_401096:				; CODE XREF: sub_401060+B7j
					; sub_401060+CBj ...
		xor	eax, eax

loc_401098:				; CODE XREF: sub_401060+EAj
					; sub_401060+126j
		mov	ecx, ds:dword_40B044
		mov	ds:dword_40B020, eax
		test	ecx, ecx
		jz	short loc_4010F4
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B3:				; CODE XREF: sub_401060+A0j
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_403220
		mov	edx, ds:dword_40B048
		mov	ds:dword_40BDAC, eax
		mov	ds:dword_40BDB0, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_403370
		mov	edx, ds:dword_40B000
		test	edx, edx
		jz	short loc_4010EE
		mov	eax, ds:dword_40B04C
		test	eax, eax
		jz	short loc_401150

loc_4010EE:				; CODE XREF: sub_401060+83j
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_4010F4:				; CODE XREF: sub_401060+45j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B3
; ---------------------------------------------------------------------------

loc_401102:				; CODE XREF: sub_401060+34j
		mov	eax, ds:40003Ch
		cmp	dword ptr [eax+400000h], 4550h
		lea	edx, [eax+400000h]
		jnz	loc_401096
		movzx	eax, word ptr [edx+18h]
		cmp	ax, 10Bh
		jz	short loc_401170
		cmp	ax, 20Bh
		jnz	loc_401096
		add	edx, 18h
		cmp	dword ptr [edx+6Ch], 0Eh
		jbe	loc_401096
		xor	eax, eax
		cmp	dword ptr [edx+0E0h], 0
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+8Cj
		mov	[esp+1Ch+var_1C], offset sub_403310
		call	ds:__setusermatherr
		xor	eax, eax
		mov	ds:dword_40B04C, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401170:				; CODE XREF: sub_401060+C5j
		cmp	dword ptr [edx+74h], 0Eh
		jbe	loc_401096
		xor	eax, eax
		cmp	dword ptr [edx+0E8h], 0
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_401190	proc near		; CODE XREF: start+15j	.text:00401515j

dwMilliseconds	= dword	ptr -0B8h
lpProcName	= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_9D		= byte ptr -9Dh
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
StartupInfo	= _STARTUPINFOA	ptr -5Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		push	ebx
		lea	edx, [ebp+StartupInfo]
		sub	esp, 0ACh
		mov	edi, edx
		rep stosd
		lea	eax, [esp+0B8h+var_9D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	ebx, ds:dword_40B044
		test	ebx, ebx
		jnz	loc_4014A2

loc_4011F9:				; CODE XREF: sub_401190+320j
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401224
; ---------------------------------------------------------------------------
		align 10h

loc_401210:				; CODE XREF: sub_401190+B1j
		cmp	eax, ebx
		jz	loc_401431
		mov	[esp+0B8h+dwMilliseconds], 3E8h	; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401224:				; CODE XREF: sub_401190+78j
		mov	[esp+0B8h+Size], 0
		mov	[esp+0B8h+lpProcName], ebx
		mov	[esp+0B8h+dwMilliseconds], offset dword_40BDB4
		call	sub_4040F0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401210
		mov	eax, ds:dword_40BDB8
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401444

loc_401253:				; CODE XREF: sub_401190+2AEj
		mov	eax, ds:dword_40BDB8
		test	eax, eax
		jz	loc_4014B5
		mov	ds:dword_40B004, 1

loc_40126A:				; CODE XREF: sub_401190+343j
		mov	eax, ds:dword_40BDB8
		cmp	eax, 1
		jz	loc_401460

loc_401278:				; CODE XREF: sub_401190+2C8j
		test	ebx, ebx
		jz	loc_401486

loc_401280:				; CODE XREF: sub_401190+2F0j
					; sub_401190+30Dj
		mov	eax, ds:off_40A704
		test	eax, eax
		jz	short loc_4012A5
		mov	[esp+0B8h+Size], 0
		mov	[esp+0B8h+lpProcName], 2
		mov	[esp+0B8h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_4012A5:				; CODE XREF: sub_401190+F7j
		call	sub_403530
		mov	[esp+0B8h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_40B008, eax
		call	sub_403AE0
		mov	[esp+0B8h+lpProcName], offset ProcName ; "_set_invalid_parameter_handler"
		mov	[esp+0B8h+dwMilliseconds], eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012E5
		mov	[esp+0B8h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012E5:				; CODE XREF: sub_401190+14Aj
		call	sub_403DB0
		mov	ecx, ds:dword_40B044
		test	ecx, ecx
		jz	short loc_401354
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_401310
; ---------------------------------------------------------------------------
		align 10h

loc_401300:				; CODE XREF: sub_401190+186j
		test	dl, dl
		setnz	dl
		test	cl, cl
		jz	short loc_40132D
		test	dl, dl
		jz	short loc_40132D

loc_40130D:				; CODE XREF: sub_401190+18Bj
					; sub_401190+190j
		add	eax, 1

loc_401310:				; CODE XREF: sub_401190+16Dj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401300
		cmp	dl, 22h
		jnz	short loc_40130D
		xor	ecx, 1
		jmp	short loc_40130D
; ---------------------------------------------------------------------------

loc_401322:				; CODE XREF: sub_401190+19Fj
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jg	short loc_401331

loc_40132D:				; CODE XREF: sub_401190+177j
					; sub_401190+17Bj
		test	dl, dl
		jnz	short loc_401322

loc_401331:				; CODE XREF: sub_401190+19Bj
		test	byte ptr [ebp+StartupInfo.dwFlags], 1
		mov	ds:dword_40BDA0, eax
		mov	eax, 0Ah
		mov	ds:dword_40BDA8, 400000h
		jnz	loc_401428

loc_40134F:				; CODE XREF: sub_401190+29Cj
		mov	ds:dword_40BDA4, eax

loc_401354:				; CODE XREF: sub_401190+162j
		mov	eax, ds:dword_40B010
		xor	ebx, ebx
		mov	[ebp+var_6C], eax
		lea	eax, ds:4[eax*4]
		mov	[esp+0B8h+dwMilliseconds], eax ; Size
		call	malloc
		mov	edx, [ebp+var_6C]
		mov	edi, ds:dword_40B014
		mov	[ebp+var_70], eax
		xor	eax, eax
		test	edx, edx
		jle	short loc_4013BD
		nop

loc_401380:				; CODE XREF: sub_401190+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+0B8h+dwMilliseconds], eax ; Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+0B8h+dwMilliseconds], esi ; Size
		call	malloc
		mov	edx, [ebp+var_70]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+0B8h+Size], esi ; Size
		mov	[esp+0B8h+dwMilliseconds], eax ; Dst
		mov	[esp+0B8h+lpProcName], edx ; Src
		call	memcpy
		cmp	[ebp+var_6C], ebx
		jg	short loc_401380
		mov	eax, [ebp+var_6C]
		shl	eax, 2

loc_4013BD:				; CODE XREF: sub_401190+1EDj
		mov	edx, [ebp+var_70]
		mov	ds:dword_40B014, edx
		mov	dword ptr [edx+eax], 0
		mov	eax, ds:__initenv
		mov	edx, ds:dword_40B018
		mov	[eax], edx
		mov	eax, ds:dword_40B018
		mov	[esp+0B8h+Size], eax
		mov	eax, ds:dword_40B014
		mov	[esp+0B8h+lpProcName], eax
		mov	eax, ds:dword_40B010
		mov	[esp+0B8h+dwMilliseconds], eax
		call	sub_4025E0
; ---------------------------------------------------------------------------
		mov	esi, ds:dword_40B020
		test	esi, esi
		mov	ds:dword_40B00C, eax
		jz	loc_4014D8
		mov	ebx, ds:dword_40B004
		test	ebx, ebx
		jnz	short loc_401420
		call	_cexit
		mov	eax, ds:dword_40B00C

loc_401420:				; CODE XREF: sub_401190+284j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_401428:				; CODE XREF: sub_401190+1B9j
		movzx	eax, [ebp+StartupInfo.wShowWindow]
		jmp	loc_40134F
; ---------------------------------------------------------------------------

loc_401431:				; CODE XREF: sub_401190+82j
		mov	eax, ds:dword_40BDB8
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401253

loc_401444:				; CODE XREF: sub_401190+BDj
		mov	[esp+0B8h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_40BDB8
		cmp	eax, 1
		jnz	loc_401278
		xchg	ax, ax

loc_401460:				; CODE XREF: sub_401190+E2j
		mov	[esp+0B8h+lpProcName], offset dword_40D008
		mov	[esp+0B8h+dwMilliseconds], offset dword_40D000
		call	_initterm
		test	ebx, ebx
		mov	ds:dword_40BDB8, 2
		jnz	loc_401280

loc_401486:				; CODE XREF: sub_401190+EAj
		mov	[esp+0B8h+lpProcName], 0
		mov	[esp+0B8h+dwMilliseconds], offset dword_40BDB4
		call	sub_404120
		sub	esp, 8
		jmp	loc_401280
; ---------------------------------------------------------------------------

loc_4014A2:				; CODE XREF: sub_401190+63j
		mov	[esp+0B8h+dwMilliseconds], edx ; lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		xchg	ax, ax
		jmp	loc_4011F9
; ---------------------------------------------------------------------------

loc_4014B5:				; CODE XREF: sub_401190+CAj
		mov	ds:dword_40BDB8, 1
		mov	[esp+0B8h+lpProcName], offset dword_40D018
		mov	[esp+0B8h+dwMilliseconds], offset dword_40D00C
		call	_initterm
		jmp	loc_40126A
; ---------------------------------------------------------------------------

loc_4014D8:				; CODE XREF: sub_401190+276j
		mov	[esp+0B8h+dwMilliseconds], eax ; Code
		call	exit
sub_401190	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_40B044, 0
		call	sub_403CE0
		add	esp, 0Ch
		jmp	sub_401190
start		endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_40B044, 1
		call	sub_403CE0
		add	esp, 0Ch
		jmp	sub_401190
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401190+11Ao

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, [esp+1Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_401577
		cmp	eax, 0C000008Dh
		jb	short loc_4015A3

loc_40153B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_401540:				; CODE XREF: TopLevelExceptionFilter+C6j
		mov	[esp+1Ch+var_18], 0
		mov	[esp+1Ch+var_1C], 8
		call	signal
		cmp	eax, 1
		jz	loc_401663
		test	eax, eax
		jz	short loc_40158C
		mov	[esp+1Ch+var_1C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_40156F:				; CODE XREF: TopLevelExceptionFilter+76j
					; TopLevelExceptionFilter+120j	...
		add	esp, 14h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_401577:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_4015E4
		cmp	eax, 0C0000096h
		jz	short loc_4015B1
		cmp	eax, 0C0000093h
		jz	short loc_40153B

loc_40158C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+8Fj ...
		mov	edx, ds:dword_40B008
		xor	eax, eax
		test	edx, edx
		jz	short loc_40156F
		mov	[esp+1Ch+ExceptionInfo], ebx
		add	esp, 14h
		pop	ebx
		pop	esi
		jmp	edx
; ---------------------------------------------------------------------------

loc_4015A3:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_4015F0
		cmp	eax, 0C000001Dh
		jnz	short loc_40158C

loc_4015B1:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+1Ch+var_18], 0
		mov	[esp+1Ch+var_1C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_401627
		test	eax, eax
		jz	short loc_40158C
		mov	[esp+1Ch+var_1C], 4
		call	eax
		add	esp, 14h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4015E4:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_401540
; ---------------------------------------------------------------------------
		align 10h

loc_4015F0:				; CODE XREF: TopLevelExceptionFilter+88j
		mov	[esp+1Ch+var_18], 0
		mov	[esp+1Ch+var_1C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_401645
		test	eax, eax
		jz	loc_40158C
		mov	[esp+1Ch+var_1C], 0Bh
		call	eax
		add	esp, 14h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_401627:				; CODE XREF: TopLevelExceptionFilter+A8j
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+var_1C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40156F
; ---------------------------------------------------------------------------

loc_401645:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+var_1C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40156F
; ---------------------------------------------------------------------------

loc_401663:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+var_1C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_40156F
		call	sub_403DB0
		mov	eax, 0FFFFFFFFh
		xchg	ax, ax
		jmp	loc_40156F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4016A0	proc near		; CODE XREF: sub_408BF0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_409038
		test	eax, eax
		jz	short locret_4016EB
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj_s.dll"
		call	ds:GetModuleHandleA
		mov	edx, eax
		sub	esp, 4
		test	edx, edx
		mov	eax, 0
		jz	short loc_4016DE
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	edx ; hModule
		call	ds:GetProcAddress
		sub	esp, 8

loc_4016DE:				; CODE XREF: sub_4016A0+28j
		test	eax, eax
		jz	short locret_4016EB
		mov	[esp+18h+lpModuleName],	offset dword_409038
		call	eax

locret_4016EB:				; CODE XREF: sub_4016A0+Dj
					; sub_4016A0+40j
		leave
		retn
sub_4016A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4016F0()
sub_4016F0	proc near		; DATA XREF: sub_408BF0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_4016F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401700	proc near		; CODE XREF: sub_401700+147p
					; sub_401700+265p ...

Format		= dword	ptr -0BCh
NewSize		= dword	ptr -0B8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
Memory		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_74		= byte ptr -74h
var_3C		= qword	ptr -3Ch
var_34		= byte ptr -34h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1E		= word ptr -1Eh

		push	ebp
		push	edi
		mov	edi, eax
		push	esi
		mov	eax, ecx
		push	ebx
		add	eax, 1
		sub	esp, 0ACh
		mov	ebx, 55555556h
		mov	esi, ds:dbus_message_iter_get_arg_type
		mov	[esp+0BCh+var_9C], eax
		mov	eax, ecx
		not	eax
		mov	[esp+0BCh+var_A4], ecx
		lea	ecx, [eax+eax*2+50h]
		mov	eax, ecx
		mov	[esp+0BCh+var_A0], edx
		imul	ebx
		sar	ecx, 1Fh
		sub	edx, ecx
		mov	[esp+0BCh+var_98], edx
		lea	esi, [esi+0]

loc_401740:				; CODE XREF: sub_401700+8Fj
					; sub_401700+E0j ...
		mov	[esp+0BCh+Format], edi
		call	esi
		test	eax, eax
		mov	ebp, eax
		jz	short loc_401791
		mov	edx, [esp+0BCh+var_A4]
		test	edx, edx
		jle	short loc_40176A
		mov	ebx, [esp+0BCh+var_A4]

loc_401757:				; CODE XREF: sub_401700+68j
		sub	ebx, 1
		mov	[esp+0BCh+Format], offset Format ; "   "
		call	printf
		test	ebx, ebx
		jg	short loc_401757

loc_40176A:				; CODE XREF: sub_401700+51j
		lea	eax, [ebp-61h]
		cmp	eax, 18h	; switch 25 cases
		jbe	short loc_4017A0

loc_401772:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		mov	[esp+0BCh+NewSize], ebp	; jumptable 004017A0 default case
		mov	[esp+0BCh+Format], offset aDbusMonitorToo ; " (dbus-monitor too	dumb to	decipher arg"...
		call	printf
		mov	ebp, ds:dbus_message_iter_next

loc_401788:				; CODE XREF: sub_401700+7ECj
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	short loc_401740

loc_401791:				; CODE XREF: sub_401700+49j
					; sub_401700+E6j ...
		add	esp, 0ACh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4017A0:				; CODE XREF: sub_401700+70j
		jmp	ds:off_40A174[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4017A7:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_1E] ; jumptable 004017A0 case 24
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		movzx	eax, byte ptr [esp+0BCh+var_1E]
		mov	[esp+0BCh+Format], offset aByteD ; "byte %d\n"
		mov	[esp+0BCh+NewSize], eax
		call	printf
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	short loc_401791
; ---------------------------------------------------------------------------

loc_4017E8:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_34] ; jumptable 004017A0 case 23
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		mov	[esp+0BCh+Format], offset Str ;	"int64 (omitted)"
		call	puts
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401820:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	ebx, [esp+0BCh+var_74] ; jumptable 004017A0 case 21
		mov	[esp+0BCh+NewSize], ebx
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_recurse
		mov	[esp+0BCh+Format], offset aVariant_0 ; "variant	"
		call	printf
		mov	ecx, [esp+0BCh+var_9C]
		mov	eax, ebx
		mov	edx, [esp+0BCh+var_A0]
		call	sub_401700
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		nop
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401865:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_28] ; jumptable 004017A0 case 20
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		mov	eax, [esp+0BCh+var_28]
		mov	[esp+0BCh+Format], offset aUint32U ; "uint32 %u\n"
		mov	[esp+0BCh+NewSize], eax
		call	printf
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_4018A8:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_34] ; jumptable 004017A0 case 19
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		mov	[esp+0BCh+Format], offset aUint64Omitted ; "uint64 (omitted)"
		call	puts
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_4018E0:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_24] ; jumptable 004017A0 case 18
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		mov	eax, [esp+0BCh+var_A0]
		test	eax, eax
		jz	loc_401D01

loc_401900:				; CODE XREF: sub_401700+333j
					; sub_401700+3E6j
		mov	eax, [esp+0BCh+var_24]
		mov	[esp+0BCh+Format], offset aS ; "%s"
		mov	[esp+0BCh+NewSize], eax
		call	printf
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_40192F:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	ebx, [esp+0BCh+var_74] ; jumptable 004017A0 case 17
		mov	[esp+0BCh+NewSize], ebx
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_recurse
		mov	[esp+0BCh+Format], offset aStruct ; "struct {"
		call	puts
		mov	ebp, ds:dbus_message_iter_next

loc_401952:				; CODE XREF: sub_401700+276j
		mov	[esp+0BCh+Format], ebx
		call	esi
		test	eax, eax
		jz	short loc_40198E

loc_40195B:				; CODE XREF: sub_401700+28Cj
		mov	ecx, [esp+0BCh+var_9C]
		mov	eax, ebx
		mov	edx, [esp+0BCh+var_A0]
		call	sub_401700
		mov	[esp+0BCh+Format], ebx
		call	ebp ; dbus_message_iter_next
		mov	[esp+0BCh+Format], ebx
		call	esi
		test	eax, eax
		jz	short loc_401952
		mov	[esp+0BCh+Format], 2Ch ; Ch
		nop
		call	putchar
		mov	[esp+0BCh+Format], ebx
		call	esi
		test	eax, eax
		jnz	short loc_40195B

loc_40198E:				; CODE XREF: sub_401700+259j
		mov	eax, [esp+0BCh+var_A4]
		test	eax, eax
		jle	short loc_4019B3
		mov	ebx, [esp+0BCh+var_A4]
		lea	esi, [esi+0]

loc_4019A0:				; CODE XREF: sub_401700+2B1j
		sub	ebx, 1
		mov	[esp+0BCh+Format], offset Format ; "   "
		call	printf
		test	ebx, ebx
		jg	short loc_4019A0

loc_4019B3:				; CODE XREF: sub_401700+294j
		mov	[esp+0BCh+Format], offset asc_40A13B ; "}"
		call	puts
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		lea	esi, [esi+0]
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_4019D5:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	edx, [esp+0BCh+var_1E] ; jumptable 004017A0 case 16
		mov	[esp+0BCh+NewSize], edx
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		movzx	eax, [esp+0BCh+var_1E]
		mov	[esp+0BCh+Format], offset aUint16U ; "uint16 %u\n"
		mov	[esp+0BCh+NewSize], eax
		call	printf
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401A19:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_24] ; jumptable 004017A0 case 14
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		mov	ebx, [esp+0BCh+var_A0]
		test	ebx, ebx
		jnz	loc_401900
		mov	[esp+0BCh+Format], offset aObjectPath ;	"object	path \""
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_401A45:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_1E] ; jumptable 004017A0 case 13
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		movsx	eax, [esp+0BCh+var_1E]
		mov	[esp+0BCh+Format], offset aInt16D ; "int16 %d\n"
		mov	[esp+0BCh+NewSize], eax
		call	printf
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401A89:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_28] ; jumptable 004017A0 case 8
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		mov	eax, [esp+0BCh+var_28]
		mov	[esp+0BCh+Format], offset aInt32D ; "int32 %d\n"
		mov	[esp+0BCh+NewSize], eax
		call	printf
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401ACC:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_24] ; jumptable 004017A0 case 6
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		mov	ebp, [esp+0BCh+var_A0]
		test	ebp, ebp
		jnz	loc_401900
		mov	[esp+0BCh+Format], offset aSignature ; "signature \""

loc_401AF3:				; CODE XREF: sub_401700+340j
					; sub_401700+608j
		call	printf
		mov	eax, [esp+0BCh+var_24]
		mov	[esp+0BCh+Format], offset aS ; "%s"
		mov	[esp+0BCh+NewSize], eax
		call	printf
		mov	[esp+0BCh+Format], offset asc_40A054 ; "\""
		call	puts
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		xchg	ax, ax
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401B35:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	ebx, [esp+0BCh+var_74] ; jumptable 004017A0 case 4
		mov	[esp+0BCh+NewSize], ebx
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_recurse
		mov	[esp+0BCh+Format], offset aDictEntry ; "dict entry("
		call	puts
		mov	ecx, [esp+0BCh+var_9C]
		mov	eax, ebx
		mov	edx, [esp+0BCh+var_A0]
		call	sub_401700
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], ebx
		call	ebp ; dbus_message_iter_next
		mov	edx, [esp+0BCh+var_A0]
		mov	eax, ebx
		mov	ecx, [esp+0BCh+var_9C]
		call	sub_401700
		mov	edx, [esp+0BCh+var_A4]
		test	edx, edx
		jle	short loc_401B9A
		mov	ebx, [esp+0BCh+var_A4]

loc_401B87:				; CODE XREF: sub_401700+498j
		sub	ebx, 1
		mov	[esp+0BCh+Format], offset Format ; "   "
		call	printf
		test	ebx, ebx
		jg	short loc_401B87

loc_401B9A:				; CODE XREF: sub_401700+481j
		mov	[esp+0BCh+Format], offset asc_40A130 ; ")"
		call	puts
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401BB8:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_3C] ; jumptable 004017A0 case 3
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		mov	[esp+0BCh+Format], offset aDoubleG ; "double %g\n"
		fld	[esp+0BCh+var_3C]
		fstp	qword ptr [esp+0BCh+NewSize]
		call	printf
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401BFB:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	eax, [esp+0BCh+var_28] ; jumptable 004017A0 case 1
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_get_basic
		mov	ecx, [esp+0BCh+var_28]
		mov	eax, offset aTrue_0 ; "true"
		test	ecx, ecx
		jz	loc_401CF7

loc_401C23:				; CODE XREF: sub_401700+5FCj
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], offset aBooleanS ; "boolean %s\n"
		call	printf
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401C4B:				; CODE XREF: sub_401700:loc_4017A0j
					; DATA XREF: .rdata:off_40A174o
		lea	ebx, [esp+0BCh+var_74] ; jumptable 004017A0 case 0
		mov	[esp+0BCh+NewSize], ebx
		mov	[esp+0BCh+Format], edi
		call	ds:dbus_message_iter_recurse
		mov	[esp+0BCh+Format], ebx
		call	esi
		cmp	eax, 79h
		mov	ebp, eax
		jz	loc_401D0D
		mov	[esp+0BCh+Format], offset aArray_0 ; "array ["
		call	puts
		test	ebp, ebp
		jz	loc_401F33
		mov	ebp, ds:dbus_message_iter_next

loc_401C86:				; CODE XREF: sub_401700+5F5j
		mov	ecx, [esp+0BCh+var_9C]
		mov	eax, ebx
		mov	edx, [esp+0BCh+var_A0]
		call	sub_401700
		mov	[esp+0BCh+Format], ebx
		call	ebp ; dbus_message_iter_next
		mov	[esp+0BCh+Format], ebx
		call	esi
		test	eax, eax
		jnz	short loc_401CE5

loc_401CA3:				; CODE XREF: sub_401700+839j
		mov	ecx, [esp+0BCh+var_A4]
		test	ecx, ecx
		jle	short loc_401CC3
		mov	ebx, [esp+0BCh+var_A4]
		nop

loc_401CB0:				; CODE XREF: sub_401700+5C1j
		sub	ebx, 1
		mov	[esp+0BCh+Format], offset Format ; "   "
		call	printf
		test	ebx, ebx
		jg	short loc_401CB0

loc_401CC3:				; CODE XREF: sub_401700+5A9j
		mov	[esp+0BCh+Format], offset asc_40A11A ; "]"
		call	puts
		mov	[esp+0BCh+Format], edi
		call	ebp ; dbus_message_iter_next
		test	eax, eax
		jnz	loc_401740
		lea	esi, [esi+0]
		jmp	loc_401791
; ---------------------------------------------------------------------------

loc_401CE5:				; CODE XREF: sub_401700+5A1j
		mov	[esp+0BCh+Format], 2Ch ; Ch
		lea	esi, [esi+0]
		call	putchar
		jmp	short loc_401C86
; ---------------------------------------------------------------------------

loc_401CF7:				; CODE XREF: sub_401700+51Dj
		mov	eax, offset aFalse_0 ; "false"
		jmp	loc_401C23
; ---------------------------------------------------------------------------

loc_401D01:				; CODE XREF: sub_401700+1FAj
		mov	[esp+0BCh+Format], offset aString_0 ; "string \""
		jmp	loc_401AF3
; ---------------------------------------------------------------------------

loc_401D0D:				; CODE XREF: sub_401700+566j
		mov	[esp+0BCh+Format], 65h ; Size
		call	malloc
		mov	ebp, ds:dbus_message_iter_next
		mov	[esp+0BCh+var_80], edi
		xor	edi, edi
		mov	[esp+0BCh+var_94], 1
		mov	[esp+0BCh+var_8C], 64h
		mov	[esp+0BCh+var_88], ebp
		mov	[esp+0BCh+var_84], 0
		mov	[esp+0BCh+Memory], eax
		mov	eax, 3
		mov	ebp, eax
		jmp	short loc_401D5A
; ---------------------------------------------------------------------------
		align 10h

loc_401D50:				; CODE XREF: sub_401700+6A0j
					; sub_401700+6B9j
		mov	[esp+0BCh+Format], ebx
		add	ebp, 2
		call	[esp+0BCh+var_88]

loc_401D5A:				; CODE XREF: sub_401700+64Cj
		mov	[esp+0BCh+Format], ebx
		call	esi
		test	eax, eax
		jz	short loc_401DBB
		lea	edx, [esp+0BCh+var_1E]
		mov	[esp+0BCh+NewSize], edx
		mov	[esp+0BCh+Format], ebx
		call	ds:dbus_message_iter_get_basic
		movzx	eax, byte ptr [esp+0BCh+var_1E]
		mov	edx, [esp+0BCh+Memory]
		mov	[edx+edi], al
		movzx	eax, byte ptr [esp+0BCh+var_1E]
		add	edi, 1
		sub	eax, 20h
		cmp	al, 5Fh
		sbb	eax, eax
		and	[esp+0BCh+var_94], eax
		cmp	edi, [esp+0BCh+var_8C]
		jnz	short loc_401D50
		lea	eax, [edi+edi]
		mov	[esp+0BCh+var_8C], eax
		mov	[esp+0BCh+NewSize], ebp	; NewSize
		mov	[esp+0BCh+Format], edx ; Memory
		call	realloc
		mov	[esp+0BCh+Memory], eax
		jmp	short loc_401D50
; ---------------------------------------------------------------------------

loc_401DBB:				; CODE XREF: sub_401700+661j
		mov	edx, [esp+0BCh+var_94]
		mov	[esp+0BCh+var_84], edi
		mov	ebp, [esp+0BCh+var_88]
		mov	edi, [esp+0BCh+var_80]
		test	edx, edx
		jnz	loc_401F15
		mov	[esp+0BCh+Format], offset aArrayOfBytes	; "array of bytes ["
		call	puts
		cmp	[esp+0BCh+var_9C], 0
		jle	short loc_401E00
		mov	ebx, [esp+0BCh+var_A4]

loc_401DEA:				; CODE XREF: sub_401700+6FEj
		sub	ebx, 1
		mov	[esp+0BCh+Format], offset Format ; "   "
		call	printf
		lea	eax, [ebx+1]
		test	eax, eax
		jg	short loc_401DEA

loc_401E00:				; CODE XREF: sub_401700+6E4j
		mov	edx, [esp+0BCh+var_98]
		cmp	edx, 7
		mov	[esp+0BCh+var_94], edx
		jbe	loc_401F06

loc_401E11:				; CODE XREF: sub_401700+810j
		cmp	[esp+0BCh+var_84], 0
		jz	loc_401EAA
		mov	[esp+0BCh+var_88], edi
		mov	edi, [esp+0BCh+var_84]
		xor	ebx, ebx
		mov	[esp+0BCh+var_84], ebp
		mov	ebp, [esp+0BCh+Memory]

loc_401E2E:				; CODE XREF: sub_401700+7A0j
		movzx	eax, byte ptr [ebp+ebx+0]
		add	ebx, 1
		mov	[esp+0BCh+Format], offset a02x ; "%02x"
		mov	[esp+0BCh+NewSize], eax
		call	printf
		cmp	edi, ebx
		jz	loc_401F02
		xor	edx, edx
		mov	eax, ebx
		div	[esp+0BCh+var_94]
		test	edx, edx
		jnz	loc_401EF1
		mov	[esp+0BCh+Format], 0Ah ; Ch
		call	putchar
		mov	eax, [esp+0BCh+var_9C]
		test	eax, eax
		jle	short loc_401E9E
		mov	edx, [esp+0BCh+var_A4]
		mov	[esp+0BCh+var_8C], ebp
		mov	ebp, edi
		mov	edi, ebx
		mov	ebx, edx

loc_401E80:				; CODE XREF: sub_401700+794j
		sub	ebx, 1
		mov	[esp+0BCh+Format], offset Format ; "   "
		call	printf
		lea	eax, [ebx+1]
		test	eax, eax
		jg	short loc_401E80
		mov	ebx, edi
		mov	edi, ebp
		mov	ebp, [esp+0BCh+var_8C]

loc_401E9E:				; CODE XREF: sub_401700+770j
					; sub_401700+800j ...
		cmp	ebx, edi
		jb	short loc_401E2E
		mov	edi, [esp+0BCh+var_88]
		mov	ebp, [esp+0BCh+var_84]

loc_401EAA:				; CODE XREF: sub_401700+716j
		mov	[esp+0BCh+Format], 0Ah ; Ch
		call	putchar
		cmp	[esp+0BCh+var_A4], 0
		jle	short loc_401ED4
		mov	ebx, [esp+0BCh+var_A4]

loc_401EC1:				; CODE XREF: sub_401700+7D2j
		sub	ebx, 1
		mov	[esp+0BCh+Format], offset Format ; "   "
		call	printf
		test	ebx, ebx
		jg	short loc_401EC1

loc_401ED4:				; CODE XREF: sub_401700+7BBj
		mov	[esp+0BCh+Format], offset asc_40A11A ; "]"
		call	puts

loc_401EE0:				; CODE XREF: sub_401700+831j
		mov	eax, [esp+0BCh+Memory]
		mov	[esp+0BCh+Format], eax ; Memory
		call	free
		jmp	loc_401788
; ---------------------------------------------------------------------------

loc_401EF1:				; CODE XREF: sub_401700+758j
		mov	[esp+0BCh+Format], 20h ; Ch
		call	putchar
		lea	esi, [esi+0]
		jmp	short loc_401E9E
; ---------------------------------------------------------------------------

loc_401F02:				; CODE XREF: sub_401700+748j
		mov	ebx, edi
		jmp	short loc_401E9E
; ---------------------------------------------------------------------------

loc_401F06:				; CODE XREF: sub_401700+70Bj
		mov	[esp+0BCh+var_94], 8
		xchg	ax, ax
		jmp	loc_401E11
; ---------------------------------------------------------------------------

loc_401F15:				; CODE XREF: sub_401700+6CDj
		mov	eax, [esp+0BCh+Memory]
		mov	edx, [esp+0BCh+var_84]
		mov	byte ptr [eax+edx], 0
		mov	[esp+0BCh+NewSize], eax
		mov	[esp+0BCh+Format], offset aArrayOfBytesS ; "array of bytes \"%s\"\n"
		call	printf
		jmp	short loc_401EE0
; ---------------------------------------------------------------------------

loc_401F33:				; CODE XREF: sub_401700+57Aj
		mov	ebp, ds:dbus_message_iter_next
		jmp	loc_401CA3
sub_401700	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401F40	proc near		; CODE XREF: sub_4025E0+9A4p

Format		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_60		= dword	ptr -60h
var_54		= byte ptr -54h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8Ch
		mov	[esp+8Ch+var_8], edi
		mov	edi, [esp+8Ch+arg_0]
		mov	[esp+8Ch+var_10], ebx
		mov	[esp+8Ch+var_C], esi
		mov	esi, [esp+8Ch+arg_4]
		mov	[esp+8Ch+var_4], ebp
		mov	[esp+8Ch+Format], edi
		call	ds:dbus_message_get_type
		mov	[esp+8Ch+Format], edi
		mov	ebx, eax
		call	ds:dbus_message_get_sender
		mov	[esp+8Ch+Format], edi
		mov	ebp, eax
		call	ds:dbus_message_get_destination
		test	esi, esi
		jnz	loc_402040
		test	eax, eax
		jz	loc_402100

loc_401F9C:				; CODE XREF: sub_401F40+1C5j
		test	ebp, ebp
		xchg	ax, ax
		jz	loc_402110

loc_401FA6:				; CODE XREF: sub_401F40+1D5j
		lea	ecx, [ebx-1]
		mov	edx, offset aUnknownMessage ; "(unknown	message	type)"
		cmp	ecx, 3
		ja	short loc_401FBA
		mov	edx, ds:off_40A2B0[ecx*4]

loc_401FBA:				; CODE XREF: sub_401F40+71j
		mov	[esp+8Ch+var_80], eax
		mov	[esp+8Ch+var_84], ebp
		mov	[esp+8Ch+var_88], edx
		mov	[esp+8Ch+Format], offset aSSenderSDestS	; "%s sender=%s	-> dest=%s"
		call	printf
		cmp	ebx, 2
		jz	loc_4020B0
		jg	loc_402090
		cmp	ebx, 1
		jnz	loc_40209E

loc_401FEA:				; CODE XREF: sub_401F40+158j
		mov	[esp+8Ch+Format], edi
		lea	esi, [esi+0]
		call	ds:dbus_message_get_member
		mov	[esp+8Ch+Format], edi
		mov	[esp+8Ch+var_60], eax
		call	ds:dbus_message_get_interface
		mov	[esp+8Ch+Format], edi
		mov	ebp, eax
		call	ds:dbus_message_get_path
		mov	[esp+8Ch+Format], edi
		mov	ebx, eax
		call	ds:dbus_message_get_serial
		mov	edx, [esp+8Ch+var_60]
		mov	[esp+8Ch+var_80], ebp
		mov	[esp+8Ch+var_84], ebx
		mov	[esp+8Ch+Format], offset aSerialUPathSIn ; " serial=%u path=%s;	interface=%s; membe"...
		mov	[esp+8Ch+var_7C], edx
		mov	[esp+8Ch+var_88], eax
		call	printf
		lea	esi, [esi+0]

loc_402040:				; CODE XREF: sub_401F40+4Ej
					; sub_401F40+16Aj ...
		lea	ebx, [esp+8Ch+var_54]
		mov	[esp+8Ch+var_88], ebx
		mov	[esp+8Ch+Format], edi
		call	ds:dbus_message_iter_init
		mov	edx, esi
		mov	eax, ebx
		mov	ecx, 1
		call	sub_401700
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+8Ch+Format], eax ;	File
		call	fflush
		mov	ebx, [esp+8Ch+var_10]
		mov	esi, [esp+8Ch+var_C]
		mov	edi, [esp+8Ch+var_8]
		mov	ebp, [esp+8Ch+var_4]
		add	esp, 8Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402090:				; CODE XREF: sub_401F40+9Bj
		cmp	ebx, 3
		jz	short loc_4020D0
		cmp	ebx, 4
		jz	loc_401FEA

loc_40209E:				; CODE XREF: sub_401F40+A4j
		mov	[esp+8Ch+Format], 0Ah ;	Ch
		call	putchar
		jmp	short loc_402040
; ---------------------------------------------------------------------------
		align 10h

loc_4020B0:				; CODE XREF: sub_401F40+95j
		mov	[esp+8Ch+Format], edi
		call	ds:dbus_message_get_reply_serial
		mov	[esp+8Ch+Format], offset aReply_serialU	; " reply_serial=%u\n"
		mov	[esp+8Ch+var_88], eax
		call	printf
		jmp	loc_402040
; ---------------------------------------------------------------------------
		align 10h

loc_4020D0:				; CODE XREF: sub_401F40+153j
		mov	[esp+8Ch+Format], edi
		call	ds:dbus_message_get_reply_serial
		mov	[esp+8Ch+Format], edi
		mov	ebx, eax
		call	ds:dbus_message_get_error_name
		mov	[esp+8Ch+var_84], ebx
		mov	[esp+8Ch+Format], offset aError_nameSRep ; " error_name=%s reply_serial=%u\n"
		mov	[esp+8Ch+var_88], eax
		call	printf
		jmp	loc_402040
; ---------------------------------------------------------------------------
		align 10h

loc_402100:				; CODE XREF: sub_401F40+56j
		mov	eax, offset aNullDestinatio ; "(null destination)"
		jmp	loc_401F9C
; ---------------------------------------------------------------------------
		align 10h

loc_402110:				; CODE XREF: sub_401F40+60j
		mov	ebp, offset aNullSender	; "(null sender)"
		jmp	loc_401FA6
sub_401F40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_402120	proc near		; CODE XREF: sub_4025E0+5CDp
					; sub_4025E0+91Ep ...

File		= dword	ptr -1Ch
Format		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebx
		mov	ebx, eax
		sub	esp, 18h
		mov	eax, ds:dword_40B028
		mov	[esp+1Ch+Format], offset aUsageSHelpSyst ; "Usage: %s [--help] [--system | --sessio"...
		mov	[esp+1Ch+var_14], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fprintf
		mov	[esp+1Ch+File],	ebx ; Code
		call	exit
sub_402120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402150	proc near		; CODE XREF: sub_4025E0+358p
					; sub_4025E0+390p

File		= dword	ptr -1Ch
Format		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 1Ch
		mov	ecx, 7
		mov	[esp+1Ch+var_8], esi
		mov	esi, eax
		mov	[esp+1Ch+var_4], edi
		mov	edi, offset aString ; "string"
		mov	[esp+1Ch+var_C], ebx
		repe cmpsb
		jz	loc_402297
		mov	ecx, 6
		mov	edi, offset aInt16 ; "int16"
		mov	esi, eax
		mov	edx, 6Eh
		repe cmpsb
		setnbe	bl
		setb	cl
		cmp	bl, cl
		jz	loc_402285
		mov	ecx, 7
		mov	edi, offset aUint16 ; "uint16"
		mov	esi, eax
		mov	dl, 71h
		repe cmpsb
		setnbe	bl
		setb	cl
		cmp	bl, cl
		jz	loc_402285
		mov	ecx, 6
		mov	edi, offset aInt32 ; "int32"
		mov	esi, eax
		mov	dl, 69h
		repe cmpsb
		setnbe	bl
		setb	cl
		cmp	bl, cl
		jz	loc_402285
		mov	ecx, 7
		mov	edi, offset aUint32 ; "uint32"
		mov	esi, eax
		mov	dl, 75h
		repe cmpsb
		setnbe	bl
		setb	cl
		cmp	bl, cl
		jz	loc_402285
		mov	ecx, 6
		mov	edi, offset aInt64 ; "int64"
		mov	esi, eax
		mov	dl, 78h
		repe cmpsb
		setnbe	bl
		setb	cl
		cmp	bl, cl
		jz	short loc_402285
		mov	ecx, 7
		mov	edi, offset aUint64 ; "uint64"
		mov	esi, eax
		mov	dl, 74h
		repe cmpsb
		setnbe	bl
		setb	cl
		cmp	bl, cl
		jz	short loc_402285
		mov	ecx, 7
		mov	edi, offset aDouble ; "double"
		mov	esi, eax
		mov	dl, 64h
		repe cmpsb
		setnbe	bl
		setb	cl
		cmp	bl, cl
		jz	short loc_402285
		mov	ecx, 5
		mov	edi, offset aByte ; "byte"
		mov	esi, eax
		mov	dl, 79h
		repe cmpsb
		setnbe	bl
		setb	cl
		cmp	bl, cl
		jz	short loc_402285
		mov	ecx, 8
		mov	edi, offset aBoolean ; "boolean"
		mov	esi, eax
		mov	dl, 62h
		repe cmpsb
		setnbe	bl
		setb	cl
		cmp	bl, cl
		jz	short loc_402285
		mov	edi, offset aObjpath ; "objpath"
		mov	ecx, 8
		mov	esi, eax
		repe cmpsb
		jnz	short loc_40229E
		mov	edx, 6Fh

loc_402285:				; CODE XREF: sub_402150+3Ej
					; sub_402150+5Cj ...
		mov	eax, edx
		mov	ebx, [esp+1Ch+var_C]
		mov	esi, [esp+1Ch+var_8]
		mov	edi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_402297:				; CODE XREF: sub_402150+1Dj
		mov	edx, 73h
		jmp	short loc_402285
; ---------------------------------------------------------------------------

loc_40229E:				; CODE XREF: sub_402150+12Ej
		mov	[esp+1Ch+var_10], eax
		mov	eax, ds:dword_40B028
		mov	[esp+1Ch+Format], offset aSUnknownTypeS	; "%s: Unknown type \"%s\"\n"
		mov	[esp+1Ch+var_14], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fprintf
		mov	[esp+1Ch+File],	1 ; Code
		call	exit
sub_402150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4022D0	proc near		; CODE XREF: sub_4025E0+2B1p
					; sub_4025E0+432p ...

File		= dword	ptr -5Ch
Format		= dword	ptr -58h
Radix		= dword	ptr -54h
var_50		= dword	ptr -50h
Str		= dword	ptr -40h
var_3C		= qword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 5Ch
		mov	[esp+5Ch+var_C], ebx
		mov	ebx, eax
		lea	eax, [edx-62h]
		cmp	eax, 17h	; switch 24 cases
		mov	[esp+5Ch+var_8], esi
		mov	[esp+5Ch+var_4], edi
		mov	[esp+5Ch+Str], ecx
		jbe	short loc_402321

loc_4022ED:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, ds:dword_40B028 ; jumptable 00402321 default case
		movsx	edx, dl
		mov	[esp+5Ch+var_50], edx
		mov	[esp+5Ch+Format], offset aSUnsupportedDa ; "%s:	Unsupported data type %c\n"
		mov	[esp+5Ch+Radix], eax

loc_402305:				; CODE XREF: sub_4022D0+302j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+5Ch+File],	eax ; File
		call	fprintf
		mov	[esp+5Ch+File],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_402321:				; CODE XREF: sub_4022D0+1Bj
		jmp	ds:off_40A440[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_402328:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, [esp+5Ch+Str] ; jumptable 00402321	case 0
		mov	edi, offset aTrue ; "true"
		mov	ecx, 5
		mov	esi, eax
		repe cmpsb
		jz	loc_4025B0
		mov	edi, offset aFalse ; "false"
		mov	ecx, 6
		mov	esi, eax
		repe cmpsb
		jnz	loc_4025BD
		mov	[esp+5Ch+var_20], 0

loc_40235C:				; CODE XREF: sub_4022D0+2E8j
		lea	eax, [esp+5Ch+var_20]
		mov	[esp+5Ch+Radix], eax
		mov	[esp+5Ch+Format], 62h
		mov	[esp+5Ch+File],	ebx
		call	ds:dbus_message_iter_append_basic

loc_402375:				; CODE XREF: sub_4022D0+E6j
					; sub_4022D0+121j ...
		mov	ebx, [esp+5Ch+var_C]
		mov	esi, [esp+5Ch+var_8]
		mov	edi, [esp+5Ch+var_4]
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_402385:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, [esp+5Ch+Str] ; jumptable 00402321	case 2
		mov	[esp+5Ch+Format], 0
		mov	[esp+5Ch+File],	eax
		call	sub_404130
		lea	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+Radix], eax
		mov	[esp+5Ch+Format], 64h
		mov	[esp+5Ch+File],	ebx
		fstp	[esp+5Ch+var_3C]
		call	ds:dbus_message_iter_append_basic
		jmp	short loc_402375
; ---------------------------------------------------------------------------

loc_4023B8:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, [esp+5Ch+Str] ; jumptable 00402321	case 7
		mov	[esp+5Ch+Radix], 0 ; Radix
		mov	[esp+5Ch+Format], 0 ; EndPtr
		mov	[esp+5Ch+File],	eax ; Str
		call	strtol
		mov	[esp+5Ch+Format], 69h
		mov	[esp+5Ch+File],	ebx
		mov	[esp+5Ch+var_1C], eax
		lea	eax, [esp+5Ch+var_1C]
		mov	[esp+5Ch+Radix], eax
		call	ds:dbus_message_iter_append_basic
		jmp	short loc_402375
; ---------------------------------------------------------------------------

loc_4023F3:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, [esp+5Ch+Str] ; jumptable 00402321	case 12
		mov	[esp+5Ch+Radix], 0 ; Radix
		mov	[esp+5Ch+Format], 0 ; EndPtr
		mov	[esp+5Ch+File],	eax ; Str
		call	strtol
		mov	[esp+5Ch+Format], 6Eh
		mov	[esp+5Ch+File],	ebx
		mov	[esp+5Ch+var_12], ax
		lea	eax, [esp+5Ch+var_12]
		mov	[esp+5Ch+Radix], eax
		call	ds:dbus_message_iter_append_basic
		jmp	loc_402375
; ---------------------------------------------------------------------------

loc_402432:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		lea	eax, [esp+5Ch+Str] ; jumptable 00402321	case 13
		mov	[esp+5Ch+Radix], eax
		mov	[esp+5Ch+Format], 6Fh
		mov	[esp+5Ch+File],	ebx
		call	ds:dbus_message_iter_append_basic
		jmp	loc_402375
; ---------------------------------------------------------------------------

loc_402450:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, [esp+5Ch+Str] ; jumptable 00402321	case 15
		mov	[esp+5Ch+Radix], 0 ; Radix
		mov	[esp+5Ch+Format], 0 ; EndPtr
		mov	[esp+5Ch+File],	eax ; Str
		call	strtoul
		mov	[esp+5Ch+Format], 71h
		mov	[esp+5Ch+File],	ebx
		mov	[esp+5Ch+var_10], ax
		lea	eax, [esp+5Ch+var_10]
		mov	[esp+5Ch+Radix], eax
		call	ds:dbus_message_iter_append_basic
		jmp	loc_402375
; ---------------------------------------------------------------------------
		align 10h

loc_402490:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		lea	eax, [esp+5Ch+Str] ; jumptable 00402321	case 17
		mov	[esp+5Ch+Radix], eax
		mov	[esp+5Ch+Format], 73h
		mov	[esp+5Ch+File],	ebx
		call	ds:dbus_message_iter_append_basic
		jmp	loc_402375
; ---------------------------------------------------------------------------
		align 10h

loc_4024B0:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, [esp+5Ch+Str] ; jumptable 00402321	case 18
		mov	[esp+5Ch+Radix], 0
		mov	[esp+5Ch+Format], 0
		mov	[esp+5Ch+File],	eax
		call	sub_404220
		mov	[esp+5Ch+Format], 74h
		mov	[esp+5Ch+File],	ebx
		mov	[esp+5Ch+var_2C], eax
		lea	eax, [esp+5Ch+var_2C]
		mov	[esp+5Ch+var_28], edx
		mov	[esp+5Ch+Radix], eax
		call	ds:dbus_message_iter_append_basic
		jmp	loc_402375
; ---------------------------------------------------------------------------

loc_4024F2:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, [esp+5Ch+Str] ; jumptable 00402321	case 19
		mov	[esp+5Ch+Radix], 0 ; Radix
		mov	[esp+5Ch+Format], 0 ; EndPtr
		mov	[esp+5Ch+File],	eax ; Str
		call	strtoul
		mov	[esp+5Ch+Format], 75h
		mov	[esp+5Ch+File],	ebx
		mov	[esp+5Ch+var_18], eax
		lea	eax, [esp+5Ch+var_18]
		mov	[esp+5Ch+Radix], eax
		call	ds:dbus_message_iter_append_basic
		jmp	loc_402375
; ---------------------------------------------------------------------------

loc_402530:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, [esp+5Ch+Str] ; jumptable 00402321	case 22
		mov	[esp+5Ch+Radix], 0
		mov	[esp+5Ch+Format], 0
		mov	[esp+5Ch+File],	eax
		call	sub_404530
		mov	[esp+5Ch+Format], 78h
		mov	[esp+5Ch+File],	ebx
		mov	[esp+5Ch+var_34], eax
		lea	eax, [esp+5Ch+var_34]
		mov	[esp+5Ch+var_30], edx
		mov	[esp+5Ch+Radix], eax
		call	ds:dbus_message_iter_append_basic
		jmp	loc_402375
; ---------------------------------------------------------------------------

loc_402572:				; CODE XREF: sub_4022D0:loc_402321j
					; DATA XREF: .rdata:off_40A440o
		mov	eax, [esp+5Ch+Str] ; jumptable 00402321	case 23
		mov	[esp+5Ch+Radix], 0 ; Radix
		mov	[esp+5Ch+Format], 0 ; EndPtr
		mov	[esp+5Ch+File],	eax ; Str
		call	strtoul
		mov	[esp+5Ch+Format], 79h
		mov	[esp+5Ch+File],	ebx
		mov	[esp+5Ch+var_D], al
		lea	eax, [esp+5Ch+var_D]
		mov	[esp+5Ch+Radix], eax
		call	ds:dbus_message_iter_append_basic
		jmp	loc_402375
; ---------------------------------------------------------------------------

loc_4025B0:				; CODE XREF: sub_4022D0+6Aj
		mov	[esp+5Ch+var_20], 1
		jmp	loc_40235C
; ---------------------------------------------------------------------------

loc_4025BD:				; CODE XREF: sub_4022D0+7Ej
		mov	[esp+5Ch+var_50], eax
		mov	eax, ds:dword_40B028
		mov	[esp+5Ch+Format], offset aSExpectedTrueO ; "%s:	Expected \"true\" or \"false\" inst"...
		mov	[esp+5Ch+Radix], eax
		jmp	loc_402305
sub_4022D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4025E0	proc near		; CODE XREF: sub_401190+264p

Str		= dword	ptr -120h
Val		= dword	ptr -11Ch
Count		= dword	ptr -118h
File		= dword	ptr -114h
var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= dword	ptr -104h
var_100		= dword	ptr -100h
var_FC		= dword	ptr -0FCh
var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
Memory		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
Src		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_C8		= byte ptr -0C8h
var_C7		= byte ptr -0C7h
var_C6		= byte ptr -0C6h
var_C5		= byte ptr -0C5h
var_C4		= byte ptr -0C4h
var_90		= byte ptr -90h
var_58		= byte ptr -58h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF0h
		push	edi
		push	esi
		push	ebx
		sub	esp, 114h
		call	sub_403E50
		mov	edx, [ebp+arg_4]
		cmp	[ebp+arg_0], 2
		mov	eax, [edx]
		mov	ds:dword_40B028, eax
		jle	loc_402BE7
		mov	[esp+120h+var_E0], 0
		mov	edx, 1
		mov	[esp+120h+var_F0], 0
		mov	[esp+120h+var_F4], 0
		mov	[esp+120h+var_EC], 4
		mov	[esp+120h+var_FC], 0
		mov	[esp+120h+Src],	0
		mov	[esp+120h+var_100], 0
		mov	[esp+120h+Memory], 0
		mov	[esp+120h+var_E4], 1
		mov	[esp+120h+var_108], 0FFFFFFFFh
		mov	[esp+120h+var_104], 0
		mov	[esp+120h+var_F8], 0
		jmp	short loc_402694
; ---------------------------------------------------------------------------
		align 10h

loc_402670:				; CODE XREF: sub_4025E0+C8j
		mov	[esp+120h+var_E0], 1
		mov	[esp+120h+Memory], 1

loc_402680:				; CODE XREF: sub_4025E0+509j
					; sub_4025E0+517j ...
		mov	ecx, [esp+120h+Src]
		add	edx, 1
		test	ecx, ecx
		jnz	short loc_4026D9

loc_40268B:				; CODE XREF: sub_4025E0+F7j
		cmp	[ebp+arg_0], edx
		jle	loc_402B92

loc_402694:				; CODE XREF: sub_4025E0+8Dj
		mov	eax, [ebp+arg_4]
		mov	edi, offset aSystem ; "--system"
		mov	ecx, 9
		mov	ebx, [eax+edx*4]
		mov	esi, ebx
		repe cmpsb
		jz	short loc_402670
		mov	ecx, 0Ah
		mov	esi, ebx
		mov	edi, offset aSession ; "--session"
		repe cmpsb
		jnz	loc_402AA5
		mov	ecx, [esp+120h+Src]
		add	edx, 1
		mov	[esp+120h+var_E0], 1
		mov	[esp+120h+Memory], 0
		test	ecx, ecx
		jz	short loc_40268B

loc_4026D9:				; CODE XREF: sub_4025E0+A9j
		mov	[esp+120h+var_E4], edx
		mov	edx, [esp+120h+var_F0]
		movzx	ebx, byte ptr [esp+120h+var_E0]
		test	edx, edx
		setnz	dl
		mov	esi, edx
		and	ebx, esi
		test	bl, bl
		jnz	loc_402BBA

loc_4026F7:				; CODE XREF: sub_4025E0+5D4j
		mov	edi, [esp+120h+var_F4]
		test	edi, edi
		jz	short loc_402719
		mov	edx, [esp+120h+var_F4]
		mov	[esp+120h+Str],	edx
		call	ds:dbus_message_type_from_string
		cmp	eax, 4
		mov	[esp+120h+var_EC], eax
		jnz	loc_402DA1

loc_402719:				; CODE XREF: sub_4025E0+11Dj
					; sub_4025E0+7C4j
		mov	eax, ds:dbus_error_init
		lea	edx, [esp+120h+var_20]
		mov	[esp+120h+Str],	edx
		mov	[esp+120h+var_D8], eax
		call	eax ; dbus_error_init
		mov	edx, esi
		test	dl, dl
		jz	loc_402E49
		mov	edx, [esp+120h+var_F0]
		lea	eax, [esp+120h+var_20]
		mov	[esp+120h+Val],	eax
		mov	[esp+120h+Str],	edx
		call	ds:dbus_connection_open
		mov	[esp+120h+var_F4], eax

loc_402754:				; CODE XREF: sub_4025E0+885j
		mov	esi, [esp+120h+var_F4]
		test	esi, esi
		jz	loc_402E6A
		cmp	[esp+120h+var_EC], 1
		jz	loc_402C5A
		cmp	[esp+120h+var_EC], 4
		jnz	loc_402DC0
		mov	eax, [esp+120h+Src]
		mov	[esp+120h+Val],	2Eh ; Ch
		mov	[esp+120h+Str],	eax ; Str
		call	strrchr
		test	eax, eax
		jz	loc_403069
		mov	byte ptr [eax],	0
		add	eax, 1
		mov	edx, [esp+120h+var_FC]
		mov	[esp+120h+Count], eax
		mov	eax, [esp+120h+Src]
		mov	[esp+120h+Str],	edx
		mov	[esp+120h+Val],	eax
		call	ds:dbus_message_new_signal
		mov	[esp+120h+var_EC], eax

loc_4027B5:				; CODE XREF: sub_4025E0+6D2j
		mov	ecx, [esp+120h+var_EC]
		test	ecx, ecx
		jz	loc_403093
		mov	edx, [esp+120h+var_100]
		test	edx, edx
		jz	short loc_4027E6
		mov	eax, [esp+120h+var_100]
		mov	edx, [esp+120h+var_EC]
		mov	[esp+120h+Val],	eax
		mov	[esp+120h+Str],	edx
		call	ds:dbus_message_set_destination
		test	eax, eax
		jz	loc_402FB6

loc_4027E6:				; CODE XREF: sub_4025E0+1E7j
		mov	edx, [esp+120h+var_EC]
		lea	eax, [esp+120h+var_58]
		mov	[esp+120h+Val],	eax
		mov	[esp+120h+Str],	edx
		call	ds:dbus_message_iter_init_append
		mov	eax, [esp+120h+var_E4]
		cmp	[ebp+arg_0], eax
		jle	loc_402F15
		mov	edx, [ebp+arg_4]
		lea	edx, [edx+eax*4]
		mov	[esp+120h+var_E0], edx
		jmp	loc_4028AD
; ---------------------------------------------------------------------------
		align 10h

loc_402820:				; CODE XREF: sub_4025E0+318j
		mov	ecx, 6
		mov	esi, edx
		mov	edi, offset aArray ; "array"
		repe cmpsb
		mov	esi, 61h
		setnbe	cl
		setb	al
		cmp	cl, al
		jz	loc_4028FE
		mov	ecx, 5
		mov	esi, edx
		mov	edi, offset aDict ; "dict"
		repe cmpsb
		mov	esi, 65h
		setnbe	al
		setb	cl
		cmp	al, cl
		jz	loc_4028FE
		xor	si, si
		mov	ebx, 73h
		cmp	byte ptr [edx],	0
		jnz	loc_402936

loc_402873:				; CODE XREF: sub_4025E0+350j
		cmp	esi, 65h
		jz	loc_402948

loc_40287C:				; CODE XREF: sub_4025E0+362j
		test	esi, esi
		jnz	loc_402CB7
		mov	ecx, [esp+120h+Src]
		mov	edx, ebx
		lea	eax, [esp+120h+var_58]
		call	sub_4022D0

loc_402896:				; CODE XREF: sub_4025E0+4C0j
		add	[esp+120h+var_E4], 1
		mov	eax, [esp+120h+var_E4]
		add	[esp+120h+var_E0], 4
		cmp	[ebp+arg_0], eax
		jle	loc_402F15

loc_4028AD:				; CODE XREF: sub_4025E0+235j
		mov	eax, [esp+120h+var_E0]
		mov	edx, [eax]
		mov	[esp+120h+Val],	3Ah ; Val
		mov	[esp+120h+Str],	edx ; Str
		mov	[esp+120h+var_10C], edx
		call	strchr
		mov	edx, [esp+120h+var_10C]
		test	eax, eax
		jz	loc_402E18
		mov	byte ptr [eax],	0
		add	eax, 1
		mov	ecx, 8
		mov	[esp+120h+Src],	eax
		mov	esi, edx
		mov	edi, offset aVariant ; "variant"
		repe cmpsb
		mov	esi, 76h
		setnbe	cl
		setb	al
		cmp	cl, al
		jnz	loc_402820

loc_4028FE:				; CODE XREF: sub_4025E0+25Bj
					; sub_4025E0+27Cj
		mov	eax, [esp+120h+Src]
		mov	[esp+120h+Val],	3Ah ; Val
		mov	[esp+120h+Str],	eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_402E14
		mov	byte ptr [eax],	0
		mov	edx, [esp+120h+Src]
		add	eax, 1
		mov	[esp+120h+Src],	eax
		mov	ebx, 73h
		cmp	byte ptr [edx],	0
		jz	loc_402873

loc_402936:				; CODE XREF: sub_4025E0+28Dj
		mov	eax, edx
		call	sub_402150
		cmp	esi, 65h
		mov	ebx, eax
		jnz	loc_40287C

loc_402948:				; CODE XREF: sub_4025E0+296j
		mov	eax, [esp+120h+Src]
		mov	[esp+120h+Val],	3Ah ; Val
		mov	[esp+120h+Str],	eax ; Str
		call	strchr
		test	eax, eax
		mov	edi, eax
		jz	loc_402E14
		mov	byte ptr [eax],	0
		mov	eax, [esp+120h+Src]
		add	edi, 1
		call	sub_402150
		lea	edx, [esp+120h+var_90]
		mov	[esp+120h+File], edx
		lea	edx, [esp+120h+var_58]
		mov	[esp+120h+Str],	edx
		mov	[esp+120h+var_C8], 7Bh
		mov	[esp+120h+var_C7], bl
		mov	[esp+120h+var_C5], 7Dh
		mov	[esp+120h+var_C6], al
		mov	esi, eax
		lea	eax, [esp+120h+var_C8]
		mov	[esp+120h+Count], eax
		mov	eax, ds:dbus_message_iter_open_container
		mov	[esp+120h+var_C4], 0
		mov	[esp+120h+Val],	61h
		mov	[esp+120h+var_D4], eax
		call	eax ; dbus_message_iter_open_container
		mov	[esp+120h+Str],	edi ; Src
		call	_strdup
		mov	[esp+120h+Val],	offset Delim ; ","
		mov	[esp+120h+Memory], eax
		mov	[esp+120h+Str],	eax ; Str
		call	strtok
		test	eax, eax
		mov	edi, eax
		jz	loc_40301F

loc_4029E4:				; CODE XREF: sub_4025E0+495j
		lea	edx, [esp+120h+var_90]
		lea	eax, [esp+120h+var_C8]
		mov	[esp+120h+Str],	edx
		mov	[esp+120h+File], eax
		mov	[esp+120h+Count], 0
		mov	[esp+120h+Val],	65h
		call	[esp+120h+var_D4]
		mov	ecx, edi
		mov	edx, ebx
		lea	eax, [esp+120h+var_C8]
		call	sub_4022D0
		mov	[esp+120h+Val],	offset Delim ; ","
		mov	[esp+120h+Str],	0 ; Str
		call	strtok
		test	eax, eax
		jz	loc_40310A
		mov	ecx, eax
		mov	edx, esi
		lea	eax, [esp+120h+var_C8]
		call	sub_4022D0
		lea	eax, [esp+120h+var_C8]
		mov	[esp+120h+Val],	eax
		mov	eax, ds:dbus_message_iter_close_container
		lea	edx, [esp+120h+var_90]
		mov	[esp+120h+Str],	edx
		mov	[esp+120h+Src],	eax
		call	eax ; dbus_message_iter_close_container
		mov	[esp+120h+Val],	offset Delim ; ","
		mov	[esp+120h+Str],	0 ; Str
		call	strtok
		test	eax, eax
		mov	edi, eax
		jnz	loc_4029E4

loc_402A7B:				; CODE XREF: sub_4025E0+A49j
		mov	edx, [esp+120h+Memory]
		mov	[esp+120h+Str],	edx ; Memory
		call	free

loc_402A87:				; CODE XREF: sub_4025E0+76Bj
					; sub_4025E0+7BCj
		lea	eax, [esp+120h+var_90]
		lea	edx, [esp+120h+var_58]
		mov	[esp+120h+Val],	eax
		mov	[esp+120h+Str],	edx
		call	[esp+120h+Src]
		jmp	loc_402896
; ---------------------------------------------------------------------------

loc_402AA5:				; CODE XREF: sub_4025E0+D8j
		mov	[esp+120h+Val],	offset SubStr ;	"--address"
		mov	[esp+120h+Str],	ebx ; Str
		mov	[esp+120h+var_10C], edx
		call	strstr
		mov	edx, [esp+120h+var_10C]
		cmp	eax, ebx
		jz	loc_402C10
		mov	edi, offset aPrintReply	; "--print-reply"
		mov	ecx, 0Dh
		mov	esi, ebx
		repe cmpsb
		jnz	short loc_402B00
		mov	[esp+120h+var_EC], 1
		mov	[esp+120h+var_F8], 1
		cmp	byte ptr [ebx+0Dh], 0
		jz	loc_402680
		mov	[esp+120h+var_104], 1
		jmp	loc_402680
; ---------------------------------------------------------------------------
		align 10h

loc_402B00:				; CODE XREF: sub_4025E0+4F3j
		mov	[esp+120h+Val],	offset aReplyTimeout ; "--reply-timeout="
		mov	[esp+120h+Str],	ebx ; Str
		mov	[esp+120h+var_10C], edx
		call	strstr
		mov	edx, [esp+120h+var_10C]
		cmp	eax, ebx
		jz	loc_402EBD
		mov	[esp+120h+Val],	offset aDest ; "--dest="
		mov	[esp+120h+Str],	ebx ; Str
		mov	[esp+120h+var_10C], edx
		call	strstr
		mov	edx, [esp+120h+var_10C]
		cmp	eax, ebx
		jz	loc_402DF4
		mov	[esp+120h+Val],	offset aType ; "--type="
		mov	[esp+120h+Str],	ebx ; Str
		mov	[esp+120h+var_10C], edx
		call	strstr
		mov	edx, [esp+120h+var_10C]
		cmp	eax, ebx
		jz	loc_402C3A
		mov	edi, offset aHelp ; "--help"
		mov	ecx, 7
		mov	esi, ebx
		repe cmpsb
		jz	loc_402D50
		cmp	byte ptr [ebx],	2Dh
		jz	loc_402EF5
		mov	esi, [esp+120h+var_FC]
		test	esi, esi
		jz	loc_402F0C
		mov	[esp+120h+Src],	ebx
		jmp	loc_402680
; ---------------------------------------------------------------------------

loc_402B92:				; CODE XREF: sub_4025E0+AEj
		mov	eax, [esp+120h+var_F0]
		movzx	ebx, byte ptr [esp+120h+var_E0]
		mov	[esp+120h+var_E4], edx
		test	eax, eax
		setnz	al
		mov	esi, eax
		mov	eax, 1
		and	ebx, esi
		call	sub_402120
; ---------------------------------------------------------------------------
		test	bl, bl
		jz	loc_4026F7

loc_402BBA:				; CODE XREF: sub_4025E0+111j
		mov	eax, ds:_iob
		mov	[esp+120h+Count], 3Bh ;	Count
		mov	[esp+120h+Val],	1 ; Size
		mov	[esp+120h+Str],	offset aAddressMayNotB ; "\"--address\"	may not	be used	with \"--"...
		add	eax, 40h
		mov	[esp+120h+File], eax ; File
		call	fwrite
		mov	eax, ds:dword_40B028

loc_402BE7:				; CODE XREF: sub_4025E0+22j
		mov	[esp+120h+Count], eax
		mov	[esp+120h+Val],	offset aUsageSHelpSyst ; "Usage: %s [--help] [--system | --sessio"...

loc_402BF3:				; CODE XREF: sub_4025E0+7DAj
					; sub_4025E0+A99j ...
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+120h+Str],	eax ; File
		call	fprintf
		mov	[esp+120h+Str],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------
		align 10h

loc_402C10:				; CODE XREF: sub_4025E0+4DFj
		mov	[esp+120h+Val],	3Dh ; Val
		mov	[esp+120h+Str],	eax ; Str
		call	strchr
		mov	edx, [esp+120h+var_10C]
		test	eax, eax
		mov	[esp+120h+var_F0], eax
		jz	loc_40302E
		add	[esp+120h+var_F0], 1
		jmp	loc_402680
; ---------------------------------------------------------------------------

loc_402C3A:				; CODE XREF: sub_4025E0+57Aj
		mov	[esp+120h+Val],	3Dh ; Val
		mov	[esp+120h+Str],	eax ; Str
		call	strchr
		mov	edx, [esp+120h+var_10C]
		add	eax, 1
		mov	[esp+120h+var_F4], eax
		jmp	loc_402680
; ---------------------------------------------------------------------------

loc_402C5A:				; CODE XREF: sub_4025E0+185j
		mov	eax, [esp+120h+Src]
		mov	[esp+120h+Val],	2Eh ; Ch
		mov	[esp+120h+Str],	eax ; Str
		call	strrchr
		test	eax, eax
		jz	loc_40307E
		mov	byte ptr [eax],	0
		add	eax, 1
		mov	edx, [esp+120h+var_FC]
		mov	[esp+120h+File], eax
		mov	eax, [esp+120h+Src]
		mov	[esp+120h+Str],	0
		mov	[esp+120h+Val],	edx
		mov	[esp+120h+Count], eax
		call	ds:dbus_message_new_method_call
		mov	[esp+120h+Val],	1
		mov	[esp+120h+var_EC], eax
		mov	[esp+120h+Str],	eax
		call	ds:dbus_message_set_auto_start
		jmp	loc_4027B5
; ---------------------------------------------------------------------------

loc_402CB7:				; CODE XREF: sub_4025E0+29Ej
		lea	eax, [esp+120h+var_90]
		mov	[esp+120h+File], eax
		lea	edx, [esp+120h+var_C8]
		lea	eax, [esp+120h+var_58]
		mov	[esp+120h+var_C8], bl
		mov	[esp+120h+var_C7], 0
		mov	[esp+120h+Count], edx
		mov	[esp+120h+Val],	esi
		mov	[esp+120h+Str],	eax
		call	ds:dbus_message_iter_open_container
		cmp	esi, 61h
		jnz	loc_402D80
		mov	edx, [esp+120h+Src]
		mov	[esp+120h+Str],	edx ; Src
		call	_strdup
		mov	[esp+120h+Val],	offset Delim ; ","
		mov	esi, eax
		mov	[esp+120h+Str],	eax ; Str
		call	strtok
		test	eax, eax
		jz	short loc_402D3A

loc_402D12:				; CODE XREF: sub_4025E0+758j
		mov	ecx, eax
		mov	edx, ebx
		lea	eax, [esp+120h+var_90]
		call	sub_4022D0
		mov	[esp+120h+Val],	offset Delim ; ","
		mov	[esp+120h+Str],	0 ; Str
		call	strtok
		test	eax, eax
		jnz	short loc_402D12

loc_402D3A:				; CODE XREF: sub_4025E0+730j
		mov	[esp+120h+Str],	esi ; Memory
		call	free
		mov	eax, ds:dbus_message_iter_close_container
		mov	[esp+120h+Src],	eax
		jmp	loc_402A87
; ---------------------------------------------------------------------------

loc_402D50:				; CODE XREF: sub_4025E0+58Ej
		mov	eax, ds:dword_40B028
		mov	[esp+120h+Val],	offset aUsageSHelpSyst ; "Usage: %s [--help] [--system | --sessio"...
		mov	[esp+120h+Count], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+120h+Str],	eax ; File
		call	fprintf
		mov	[esp+120h+Str],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------
		align 10h

loc_402D80:				; CODE XREF: sub_4025E0+70Aj
		mov	ecx, [esp+120h+Src]
		mov	edx, ebx
		lea	eax, [esp+120h+var_90]
		call	sub_4022D0
		mov	edx, ds:dbus_message_iter_close_container
		mov	[esp+120h+Src],	edx
		jmp	loc_402A87
; ---------------------------------------------------------------------------

loc_402DA1:				; CODE XREF: sub_4025E0+133j
		cmp	eax, 1
		jz	loc_402719
		mov	eax, [esp+120h+var_F4]
		mov	[esp+120h+Val],	offset aMessageTypeSIs ; "Message type \"%s\" is not supported\n"
		mov	[esp+120h+Count], eax
		jmp	loc_402BF3
; ---------------------------------------------------------------------------
		align 10h

loc_402DC0:				; CODE XREF: sub_4025E0+190j
		mov	eax, ds:_iob
		mov	[esp+120h+Count], 25h ;	Count
		mov	[esp+120h+Val],	1 ; Size
		mov	[esp+120h+Str],	offset aInternalErrorU ; "Internal error, unknown message type\n"
		add	eax, 40h
		mov	[esp+120h+File], eax ; File
		call	fwrite
		mov	[esp+120h+Str],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_402DF4:				; CODE XREF: sub_4025E0+55Aj
		mov	[esp+120h+Val],	3Dh ; Val
		mov	[esp+120h+Str],	eax ; Str
		call	strchr
		mov	edx, [esp+120h+var_10C]
		add	eax, 1
		mov	[esp+120h+var_100], eax
		jmp	loc_402680
; ---------------------------------------------------------------------------

loc_402E14:				; CODE XREF: sub_4025E0+334j
					; sub_4025E0+380j
		mov	edx, [esp+120h+Src]

loc_402E18:				; CODE XREF: sub_4025E0+2EDj
		mov	[esp+120h+File], edx
		mov	edx, [ebp+arg_4]
		mov	eax, [edx]
		mov	[esp+120h+Val],	offset aSDataItemSIsBa ; "%s: Data item	\"%s\" is badly	formed\n"
		mov	[esp+120h+Count], eax

loc_402E2D:				; CODE XREF: sub_4025E0+B25j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+120h+Str],	eax ; File
		call	fprintf
		mov	[esp+120h+Str],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_402E49:				; CODE XREF: sub_4025E0+152j
		mov	edx, [esp+120h+Memory]
		lea	eax, [esp+120h+var_20]
		mov	[esp+120h+Val],	eax
		mov	[esp+120h+Str],	edx
		call	ds:dbus_bus_get
		mov	[esp+120h+var_F4], eax
		jmp	loc_402754
; ---------------------------------------------------------------------------

loc_402E6A:				; CODE XREF: sub_4025E0+17Aj
		mov	ebx, [esp+120h+var_F0]
		mov	eax, [esp+120h+var_1C]
		test	ebx, ebx
		jz	loc_4030C7

loc_402E7D:				; CODE XREF: sub_4025E0+AF4j
					; sub_4025E0+B02j
		mov	[esp+120h+File], eax
		mov	eax, [esp+120h+var_F0]
		mov	[esp+120h+Val],	offset aFailedToOpenCo ; "Failed to open connection to \"%s\" mes"...
		mov	[esp+120h+Count], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+120h+Str],	eax ; File
		call	fprintf
		lea	edx, [esp+120h+var_20]
		mov	[esp+120h+Str],	edx
		call	ds:dbus_error_free
		mov	[esp+120h+Str],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_402EBD:				; CODE XREF: sub_4025E0+53Aj
		mov	[esp+120h+Val],	3Dh ; Val
		mov	[esp+120h+Str],	eax ; Str
		call	strchr
		mov	[esp+120h+Count], 0Ah ;	Radix
		mov	[esp+120h+Val],	0 ; EndPtr
		add	eax, 1
		mov	[esp+120h+Str],	eax ; Str
		call	strtol
		mov	edx, [esp+120h+var_10C]
		mov	[esp+120h+var_108], eax
		jmp	loc_402680
; ---------------------------------------------------------------------------

loc_402EF5:				; CODE XREF: sub_4025E0+597j
		mov	eax, 1
		mov	[esp+120h+var_10C], edx
		call	sub_402120
; ---------------------------------------------------------------------------
		mov	edx, [esp+120h+var_10C]
		jmp	loc_402680
; ---------------------------------------------------------------------------

loc_402F0C:				; CODE XREF: sub_4025E0+5A3j
		mov	[esp+120h+var_FC], ebx
		jmp	loc_402680
; ---------------------------------------------------------------------------

loc_402F15:				; CODE XREF: sub_4025E0+225j
					; sub_4025E0+2C7j
		mov	eax, [esp+120h+var_F8]
		test	eax, eax
		jz	loc_402FEA
		lea	edx, [esp+120h+var_20]
		mov	[esp+120h+Str],	edx
		call	[esp+120h+var_D8]
		mov	edx, [esp+120h+var_108]
		lea	eax, [esp+120h+var_20]
		mov	[esp+120h+File], eax
		mov	eax, [esp+120h+var_EC]
		mov	[esp+120h+Count], edx
		mov	edx, [esp+120h+var_F4]
		mov	[esp+120h+Val],	eax
		mov	[esp+120h+Str],	edx
		call	ds:dbus_connection_send_with_reply_and_block
		mov	ebx, eax
		lea	eax, [esp+120h+var_20]
		mov	[esp+120h+Str],	eax
		call	ds:dbus_error_is_set
		test	eax, eax
		jnz	loc_4030E7
		test	ebx, ebx
		jz	loc_403014
		mov	edx, [esp+120h+var_104]
		mov	[esp+120h+Str],	ebx
		mov	[esp+120h+Val],	edx
		call	sub_401F40
		mov	[esp+120h+Str],	ebx
		mov	ebx, ds:dbus_message_unref
		call	ebx ; dbus_message_unref

loc_402F94:				; CODE XREF: sub_4025E0+A3Aj
		mov	edx, [esp+120h+var_EC]
		mov	[esp+120h+Str],	edx
		call	ebx ; dbus_message_unref
		mov	eax, [esp+120h+var_F4]
		mov	[esp+120h+Str],	eax
		call	ds:dbus_connection_unref
		mov	[esp+120h+Str],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_402FB6:				; CODE XREF: sub_4025E0+200j
		mov	eax, ds:_iob
		mov	[esp+120h+Count], 12h ;	Count
		mov	[esp+120h+Val],	1 ; Size
		mov	[esp+120h+Str],	offset aNotEnoughMemor ; "Not enough memory\n"
		add	eax, 40h
		mov	[esp+120h+File], eax ; File
		call	fwrite
		mov	[esp+120h+Str],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_402FEA:				; CODE XREF: sub_4025E0+93Bj
		mov	eax, [esp+120h+var_EC]
		mov	edx, [esp+120h+var_F4]
		mov	[esp+120h+Count], 0
		mov	[esp+120h+Val],	eax
		mov	[esp+120h+Str],	edx
		call	ds:dbus_connection_send
		mov	eax, [esp+120h+var_F4]
		mov	[esp+120h+Str],	eax
		call	ds:dbus_connection_flush

loc_403014:				; CODE XREF: sub_4025E0+993j
		mov	ebx, ds:dbus_message_unref
		jmp	loc_402F94
; ---------------------------------------------------------------------------

loc_40301F:				; CODE XREF: sub_4025E0+3FEj
		mov	edx, ds:dbus_message_iter_close_container
		mov	[esp+120h+Src],	edx
		jmp	loc_402A7B
; ---------------------------------------------------------------------------

loc_40302E:				; CODE XREF: sub_4025E0+64Aj
		mov	eax, ds:_iob
		mov	[esp+120h+Count], 21h ;	Count
		mov	[esp+120h+Val],	1 ; Size
		mov	[esp+120h+Str],	offset aAddressRequire ; "\"--address=\" requires an ADDRESS\n"
		add	eax, 40h
		mov	[esp+120h+File], eax ; File
		call	fwrite
		mov	eax, 1
		call	sub_402120
; ---------------------------------------------------------------------------
		mov	edx, [esp+120h+var_10C]
		jmp	loc_402680
; ---------------------------------------------------------------------------

loc_403069:				; CODE XREF: sub_4025E0+1ACj
		mov	edx, [esp+120h+Src]
		mov	[esp+120h+Val],	offset aMustUseOrg_myd ; "Must use org.mydomain.Interface.Signal "...
		mov	[esp+120h+Count], edx
		jmp	loc_402BF3
; ---------------------------------------------------------------------------

loc_40307E:				; CODE XREF: sub_4025E0+690j
		mov	edx, [esp+120h+Src]
		mov	[esp+120h+Val],	offset aMustUseOrg_m_0 ; "Must use org.mydomain.Interface.Method "...
		mov	[esp+120h+Count], edx
		jmp	loc_402BF3
; ---------------------------------------------------------------------------

loc_403093:				; CODE XREF: sub_4025E0+1DBj
		mov	eax, ds:_iob
		mov	[esp+120h+Count], 20h ;	Count
		mov	[esp+120h+Val],	1 ; Size
		mov	[esp+120h+Str],	offset aCouldnTAllocat ; "Couldn't allocate D-Bus message\n"
		add	eax, 40h
		mov	[esp+120h+File], eax ; File
		call	fwrite
		mov	[esp+120h+Str],	1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4030C7:				; CODE XREF: sub_4025E0+897j
		cmp	[esp+120h+Memory], 1
		mov	[esp+120h+var_F0], offset aSystem_0 ; "system"
		jz	loc_402E7D
		mov	[esp+120h+var_F0], offset aSession_0 ; "session"
		jmp	loc_402E7D
; ---------------------------------------------------------------------------

loc_4030E7:				; CODE XREF: sub_4025E0+98Bj
		mov	eax, [esp+120h+var_1C]
		mov	[esp+120h+Val],	offset aErrorSS	; "Error %s: %s\n"
		mov	[esp+120h+File], eax
		mov	eax, [esp+120h+var_20]
		mov	[esp+120h+Count], eax
		jmp	loc_402E2D
; ---------------------------------------------------------------------------

loc_40310A:				; CODE XREF: sub_4025E0+44Dj
		mov	eax, ds:dword_40B028
		mov	[esp+120h+Val],	offset aSMalformedDict ; "%s: Malformed	dictionary\n"
		mov	[esp+120h+Count], eax
		jmp	loc_402BF3
sub_4025E0	endp

; ---------------------------------------------------------------------------
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:0040D024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_403150
		cmp	eax, 3
		jz	short loc_403150
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_403150:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_403EF0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401190+110p
					; DATA XREF: .rdata:off_40A704o ...

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		cmp	dword_409028, 2
		mov	eax, [esp+1Ch+arg_4]
		jz	short loc_40319B
		mov	dword_409028, 2

loc_40319B:				; CODE XREF: TlsCallback_0+Fj
		cmp	eax, 2
		jz	short loc_4031B1
		cmp	eax, 1
		jz	short loc_4031E0

loc_4031A5:				; CODE XREF: TlsCallback_0+3Cj
					; TlsCallback_0+7Cj
		mov	eax, 1
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4031B1:				; CODE XREF: TlsCallback_0+1Ej
		mov	ebx, offset dword_40D030
		cmp	ebx, offset dword_40D030
		jz	short loc_4031A5
		xchg	ax, ax

loc_4031C0:				; CODE XREF: TlsCallback_0+51j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_4031C8
		call	eax

loc_4031C8:				; CODE XREF: TlsCallback_0+44j
		add	ebx, 4
		cmp	ebx, offset dword_40D030
		jnz	short loc_4031C0
		mov	eax, 1
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_4031E0:				; CODE XREF: TlsCallback_0+23j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax
		call	sub_403EF0
		jmp	short loc_4031A5
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403200	proc near		; DATA XREF: .CRT:0040D014o
		sub	esp, 0Ch
		mov	eax, ds:__lconv_init
		add	esp, 0Ch
		jmp	eax
sub_403200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403210	proc near		; CODE XREF: sub_403230+10p
					; sub_403230+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_403210	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403220	proc near		; CODE XREF: sub_401060+5Ap
					; sub_403230+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_403220	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_403230(_onexit_t)
sub_403230	proc near		; CODE XREF: sub_4032F0+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_40BDB0
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_403210
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_10], eax
		jz	loc_4032D0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_40BDB0
		mov	[esp+2Ch+Func],	eax
		call	sub_403210
		mov	[esp+2Ch+var_10], eax
		mov	eax, ds:dword_40BDAC
		mov	[esp+2Ch+Func],	eax
		call	sub_403210
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_14], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_403220
		mov	ds:dword_40BDB0, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_403220
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_40BDAC, eax
		call	_unlock
		mov	eax, ebx
		add	esp, 28h
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4032D0:				; CODE XREF: sub_403230+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_403230	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4032F0(_onexit_t)
sub_4032F0	proc near		; CODE XREF: sub_403E50-2Fp
					; sub_406B70+81p ...

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_403230
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_4032F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403310	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_40332D
		mov	edx, ds:off_40A824[ecx*4]

loc_40332D:				; CODE XREF: sub_403310+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_403310	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403370	proc near		; CODE XREF: sub_401060+76p
		xor	eax, eax
		retn
sub_403370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_403380(char *Format, char ArgList)
sub_403380	proc near		; CODE XREF: sub_4033E0+131p
					; sub_4033E0+141p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_403380	endp

; ---------------------------------------------------------------------------
		jmp	short sub_4033E0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_4033E0(size_t Size)
sub_4033E0	proc near		; CODE XREF: .text:004033D1j
					; sub_403530+12Ap ...

lpAddress	= dword	ptr -5Ch
lpBuffer	= dword	ptr -58h
dwLength	= dword	ptr -54h
lpflOldProtect	= dword	ptr -50h
var_44		= dword	ptr -44h
Src		= dword	ptr -40h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-38h

		push	ebp
		push	edi
		mov	edi, ecx
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 4Ch
		test	ecx, ecx
		mov	[esp+5Ch+Src], edx
		jnz	short loc_403400
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403400:				; CODE XREF: sub_4033E0+11j
		mov	ecx, ds:dword_40B054
		xor	esi, esi
		test	ecx, ecx
		jle	short loc_403430
		mov	eax, ds:dword_40B050

loc_403411:				; CODE XREF: sub_4033E0+4Ej
		mov	edx, [eax+4]
		cmp	edx, ebx
		ja	short loc_403426
		mov	ebp, [eax+8]
		add	edx, [ebp+8]
		cmp	ebx, edx
		jb	loc_4034A9

loc_403426:				; CODE XREF: sub_4033E0+36j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jl	short loc_403411

loc_403430:				; CODE XREF: sub_4033E0+2Aj
		mov	[esp+5Ch+lpAddress], ebx
		call	sub_403830
		test	eax, eax
		mov	ebp, eax
		jz	loc_403516
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_40B050
		shl	edx, 2
		mov	[esp+5Ch+var_44], edx
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		call	sub_403950
		mov	edx, [esp+5Ch+var_44]
		add	eax, [ebp+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+5Ch+Buffer]
		mov	[esp+5Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_40B050
		mov	[esp+5Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+5Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+5Ch+var_44]
		jz	short loc_4034F6
		mov	eax, [esp+5Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	short loc_4034C5

loc_4034A2:				; CODE XREF: sub_4033E0+E8j
					; sub_4033E0+114j
		add	ds:dword_40B054, 1

loc_4034A9:				; CODE XREF: sub_4033E0+40j
		mov	eax, [esp+5Ch+Src]
		mov	[esp+5Ch+dwLength], edi	; Size
		mov	[esp+5Ch+lpAddress], ebx ; Dst
		mov	[esp+5Ch+lpBuffer], eax	; Src
		call	memcpy
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4034C5:				; CODE XREF: sub_4033E0+C0j
		cmp	eax, 40h
		jz	short loc_4034A2
		mov	eax, [esp+5Ch+Buffer.RegionSize]
		add	edx, ds:dword_40B050
		mov	[esp+5Ch+dwLength], 40h	; flNewProtect
		mov	[esp+5Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+5Ch+Buffer.BaseAddress]
		mov	[esp+5Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+5Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_4034A2
; ---------------------------------------------------------------------------

loc_4034F6:				; CODE XREF: sub_4033E0+B7j
		mov	eax, ds:dword_40B050
		mov	eax, [eax+edx+4]
		mov	[esp+5Ch+dwLength], eax
		mov	eax, [ebp+8]
		mov	[esp+5Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+5Ch+lpBuffer], eax	; ArgList
		call	sub_403380
; ---------------------------------------------------------------------------

loc_403516:				; CODE XREF: sub_4033E0+5Cj
		mov	[esp+5Ch+lpBuffer], ebx	; ArgList
		mov	[esp+5Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_403380
sub_4033E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403530	proc near		; CODE XREF: sub_401190:loc_4012A5p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, ds:dword_40B058
		test	ebx, ebx
		jz	short loc_403550

loc_403543:				; CODE XREF: sub_403530+64j
					; sub_403530+B4j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403550:				; CODE XREF: sub_403530+11j
		mov	ds:dword_40B058, 1
		call	sub_4038A0
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_404090
		mov	ds:dword_40B054, 0
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_40B050, eax
		mov	eax, offset dword_40AC3C
		sub	eax, offset dword_40AC3C
		cmp	eax, 7
		jle	short loc_403543
		cmp	eax, 0Bh
		mov	ebx, offset dword_40AC3C
		jle	short loc_4035C2
		mov	ecx, ds:dword_40AC3C
		test	ecx, ecx
		jnz	short loc_4035C2
		mov	edx, ds:dword_40AC40
		test	edx, edx
		jnz	short loc_4035C2
		mov	eax, ds:dword_40AC44
		test	eax, eax
		jnz	short loc_4035C2
		mov	ebx, offset dword_40AC48

loc_4035C2:				; CODE XREF: sub_403530+6Ej
					; sub_403530+78j ...
		mov	edi, [ebx]
		test	edi, edi
		jnz	short loc_403630
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	short loc_403630
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_403793
		add	ebx, 0Ch
		cmp	ebx, offset dword_40AC3C
		jnb	loc_403543
		mov	esi, 400000h

loc_4035EF:				; CODE XREF: sub_403530+217j
		mov	eax, [ebx+4]
		mov	ecx, [ebx]
		movzx	edx, byte ptr [ebx+8]
		add	eax, esi
		add	ecx, esi
		cmp	edx, 10h
		mov	edi, [ecx]
		jz	loc_4036ED
		cmp	edx, 20h
		jz	loc_40372A
		cmp	edx, 8
		jz	loc_40370C
		mov	[ebp+var_1C], 0
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		call	sub_403380
; ---------------------------------------------------------------------------

loc_403630:				; CODE XREF: sub_403530+96j
					; sub_403530+9Dj
		cmp	ebx, offset dword_40AC3C
		jnb	loc_403543
		mov	esi, 400000h
		lea	edi, [ebp+flOldProtect]

loc_403644:				; CODE XREF: sub_403530+135j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		mov	edx, edi
		call	sub_4033E0
		cmp	ebx, offset dword_40AC3C
		jb	short loc_403644

loc_403667:				; CODE XREF: sub_403530+21Dj
		mov	ecx, ds:dword_40B054
		test	ecx, ecx
		jle	loc_403543
		xor	ebx, ebx
		xor	esi, esi
		lea	edi, [ebp+flOldProtect]
		jmp	short loc_403692
; ---------------------------------------------------------------------------
		align 10h

loc_403680:				; CODE XREF: sub_403530+16Dj
					; sub_403530+1BBj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_40B054
		jge	loc_403543

loc_403692:				; CODE XREF: sub_403530+14Cj
		mov	eax, ds:dword_40B050
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_403680
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_403770
		mov	eax, ds:dword_40B050
		mov	[esp+58h+lpflOldProtect], edi ;	lpflOldProtect
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_403680
; ---------------------------------------------------------------------------

loc_4036ED:				; CODE XREF: sub_403530+D1j
		movzx	edx, word ptr [eax]
		test	dx, dx
		js	short loc_403761
		sub	edx, ecx
		lea	edi, [edx+edi]
		mov	[ebp+var_1C], edi

loc_4036FD:				; CODE XREF: sub_403530+23Ej
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_1C]
		call	sub_4033E0
		jmp	short loc_40373E
; ---------------------------------------------------------------------------

loc_40370C:				; CODE XREF: sub_403530+E3j
		movzx	edx, byte ptr [eax]
		test	dl, dl
		js	short loc_403752
		sub	edx, ecx
		lea	edi, [edx+edi]
		mov	[ebp+var_1C], edi

loc_40371B:				; CODE XREF: sub_403530+22Fj
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_1C]
		call	sub_4033E0
		jmp	short loc_40373E
; ---------------------------------------------------------------------------

loc_40372A:				; CODE XREF: sub_403530+DAj
		add	edi, [eax]
		lea	edx, [ebp+var_1C]
		sub	edi, ecx
		mov	ecx, 4		; Size
		mov	[ebp+var_1C], edi
		call	sub_4033E0

loc_40373E:				; CODE XREF: sub_403530+1DAj
					; sub_403530+1F8j
		add	ebx, 0Ch
		cmp	ebx, offset dword_40AC3C
		jb	loc_4035EF
		jmp	loc_403667
; ---------------------------------------------------------------------------

loc_403752:				; CODE XREF: sub_403530+1E1j
		or	edx, 0FFFFFF00h
		sub	edx, ecx
		add	edx, edi
		mov	[ebp+var_1C], edx
		jmp	short loc_40371B
; ---------------------------------------------------------------------------

loc_403761:				; CODE XREF: sub_403530+1C3j
		or	edx, 0FFFF0000h
		sub	edx, ecx
		add	edx, edi
		mov	[ebp+var_1C], edx
		jmp	short loc_4036FD
; ---------------------------------------------------------------------------

loc_403770:				; CODE XREF: sub_403530+18Fj
		add	ebx, ds:dword_40B050
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_403380
; ---------------------------------------------------------------------------

loc_403793:				; CODE XREF: sub_403530+A5j
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_403380
sub_403530	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+4]
		cmp	word ptr [eax],	5A4Dh
		jz	short loc_4037C0

loc_4037BB:				; CODE XREF: .text:004037C9j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4037C0:				; CODE XREF: .text:004037B9j
		add	eax, [eax+3Ch]
		cmp	dword ptr [eax], 4550h
		jnz	short loc_4037BB
		cmp	word ptr [eax+18h], 10Bh
		setz	al
		movzx	eax, al
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		mov	eax, [esp+0Ch]
		mov	ebx, [esp+10h]
		add	eax, [eax+3Ch]
		movzx	esi, word ptr [eax+6]
		movzx	edx, word ptr [eax+14h]
		test	esi, esi
		jz	short loc_40381C
		movzx	edx, dx
		lea	eax, [eax+edx+18h]
		xor	edx, edx
		jmp	short loc_403807
; ---------------------------------------------------------------------------

loc_403804:				; CODE XREF: .text:0040381Aj
		add	eax, 28h

loc_403807:				; CODE XREF: .text:00403802j
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_403815
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40381E

loc_403815:				; CODE XREF: .text:0040380Cj
		add	edx, 1
		cmp	edx, esi
		jb	short loc_403804

loc_40381C:				; CODE XREF: .text:004037F7j
		xor	eax, eax

loc_40381E:				; CODE XREF: .text:00403813j
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_403830
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403830	proc near		; CODE XREF: sub_4033E0+53p
					; .text:00403821j

arg_0		= dword	ptr  4

		cmp	word ptr ds:400000h, 5A4Dh
		push	esi
		push	ebx
		jz	short loc_403842

loc_40383D:				; CODE XREF: sub_403830+27j
					; sub_403830+2Fj ...
		xor	eax, eax

loc_40383F:				; CODE XREF: sub_403830+61j
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_403842:				; CODE XREF: sub_403830+Bj
		mov	eax, ds:40003Ch
		cmp	dword ptr [eax+400000h], 4550h
		lea	edx, [eax+400000h]
		jnz	short loc_40383D
		cmp	word ptr [edx+18h], 10Bh
		jnz	short loc_40383D
		mov	ebx, [esp+8+arg_0]
		movzx	esi, word ptr [edx+6]
		movzx	eax, word ptr [edx+14h]
		sub	ebx, 400000h
		test	esi, esi
		jz	short loc_40383D
		movzx	eax, ax
		lea	eax, [edx+eax+18h]
		xor	edx, edx
		jmp	short loc_403885
; ---------------------------------------------------------------------------

loc_403882:				; CODE XREF: sub_403830+68j
		add	eax, 28h

loc_403885:				; CODE XREF: sub_403830+50j
		mov	ecx, [eax+0Ch]
		cmp	ebx, ecx
		jb	short loc_403893
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40383F

loc_403893:				; CODE XREF: sub_403830+5Aj
		add	edx, 1
		cmp	edx, esi
		jb	short loc_403882
		jmp	short loc_40383D
sub_403830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4038A0	proc near		; CODE XREF: sub_403530+2Ap
		cmp	word ptr ds:400000h, 5A4Dh
		jz	short loc_4038B0

loc_4038AB:				; CODE XREF: sub_4038A0+25j
					; sub_4038A0+2Dj
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4038B0:				; CODE XREF: sub_4038A0+9j
		mov	eax, ds:40003Ch
		cmp	dword ptr [eax+400000h], 4550h
		lea	edx, [eax+400000h]
		jnz	short loc_4038AB
		cmp	word ptr [edx+18h], 10Bh
		jnz	short loc_4038AB
		movzx	eax, word ptr [edx+6]
		retn
sub_4038A0	endp

; ---------------------------------------------------------------------------
		align 10h
		cmp	word ptr ds:400000h, 5A4Dh
		push	ebx
		mov	edx, [esp+8]
		jz	short loc_4038F4

loc_4038F0:				; CODE XREF: .text:00403909j
					; .text:00403911j ...
		xor	eax, eax

loc_4038F2:				; CODE XREF: .text:0040393Bj
					; .text:00403949j
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4038F4:				; CODE XREF: .text:004038EEj
		mov	eax, ds:40003Ch
		cmp	dword ptr [eax+400000h], 4550h
		lea	ecx, [eax+400000h]
		jnz	short loc_4038F0
		cmp	word ptr [ecx+18h], 10Bh
		jnz	short loc_4038F0
		movzx	ebx, word ptr [ecx+6]
		movzx	eax, word ptr [ecx+14h]
		test	ebx, ebx
		jz	short loc_4038F0
		movzx	eax, ax
		lea	eax, [ecx+eax+18h]
		xor	ecx, ecx
		jmp	short loc_403933
; ---------------------------------------------------------------------------
		align 10h

loc_403930:				; CODE XREF: .text:00403945j
		add	eax, 28h

loc_403933:				; CODE XREF: .text:00403928j
		test	byte ptr [eax+27h], 20h
		jz	short loc_403940
		test	edx, edx
		jz	short loc_4038F2
		sub	edx, 1

loc_403940:				; CODE XREF: .text:00403937j
		add	ecx, 1
		cmp	ecx, ebx
		jb	short loc_403930
		xor	eax, eax
		jmp	short loc_4038F2
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403950	proc near		; CODE XREF: sub_4033E0+7Dp
		cmp	word ptr ds:400000h, 5A4Dh
		jz	short loc_403960

loc_40395B:				; CODE XREF: sub_403950+25j
		xor	eax, eax

locret_40395D:				; CODE XREF: sub_403950+32j
					; sub_403950+36j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_403960:				; CODE XREF: sub_403950+9j
		mov	eax, ds:40003Ch
		cmp	dword ptr [eax+400000h], 4550h
		lea	edx, [eax+400000h]
		jnz	short loc_40395B
		cmp	word ptr [edx+18h], 10Bh
		mov	eax, 400000h
		jz	short locret_40395D
		xor	eax, eax
		jmp	short locret_40395D
sub_403950	endp

; ---------------------------------------------------------------------------
		align 10h
		cmp	word ptr ds:400000h, 5A4Dh
		push	esi
		push	ebx
		jz	short loc_4039A2

loc_40399D:				; CODE XREF: .text:004039B7j
					; .text:004039BFj ...
		xor	eax, eax
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4039A2:				; CODE XREF: .text:0040399Bj
		mov	eax, ds:40003Ch
		cmp	dword ptr [eax+400000h], 4550h
		lea	edx, [eax+400000h]
		jnz	short loc_40399D
		cmp	word ptr [edx+18h], 10Bh
		jnz	short loc_40399D
		mov	ebx, [esp+0Ch]
		movzx	esi, word ptr [edx+6]
		movzx	eax, word ptr [edx+14h]
		sub	ebx, 400000h
		test	esi, esi
		jz	short loc_40399D
		movzx	eax, ax
		lea	eax, [edx+eax+18h]
		xor	edx, edx
		jmp	short loc_4039E5
; ---------------------------------------------------------------------------

loc_4039E2:				; CODE XREF: .text:004039F8j
		add	eax, 28h

loc_4039E5:				; CODE XREF: .text:004039E0j
		mov	ecx, [eax+0Ch]
		cmp	ebx, ecx
		jb	short loc_4039F3
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_403A00

loc_4039F3:				; CODE XREF: .text:004039EAj
		add	edx, 1
		cmp	esi, edx
		ja	short loc_4039E2
		jmp	short loc_40399D
; ---------------------------------------------------------------------------
		align 10h

loc_403A00:				; CODE XREF: .text:004039F1j
		test	eax, eax
		jz	short loc_40399D
		mov	eax, [eax+24h]
		pop	ebx
		pop	esi
		not	eax
		shr	eax, 1Fh
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403A10	proc near		; CODE XREF: sub_403AE0+58p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		cmp	word ptr ds:400000h, 5A4Dh
		mov	[esp+0Ch+var_C], ebx
		mov	eax, [esp+0Ch+arg_0]
		mov	[esp+0Ch+var_8], esi
		mov	[esp+0Ch+var_4], edi
		jz	short loc_403A40

loc_403A2D:				; CODE XREF: sub_403A10+46j
					; sub_403A10+4Ej ...
		xor	eax, eax

loc_403A2F:				; CODE XREF: sub_403A10+C8j
		mov	ebx, [esp+0Ch+var_C]
		mov	esi, [esp+0Ch+var_8]
		mov	edi, [esp+0Ch+var_4]
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403A40:				; CODE XREF: sub_403A10+1Bj
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_403A2D
		cmp	word ptr [ecx+18h], 10Bh
		jnz	short loc_403A2D
		mov	esi, [ecx+80h]
		test	esi, esi
		jz	short loc_403A2D
		movzx	edi, word ptr [ecx+6]
		movzx	edx, word ptr [ecx+14h]
		test	edi, edi
		jz	short loc_403A2D
		movzx	edx, dx
		lea	edx, [ecx+edx+18h]
		xor	ecx, ecx
		jmp	short loc_403A84
; ---------------------------------------------------------------------------

loc_403A81:				; CODE XREF: sub_403A10+87j
		add	edx, 28h

loc_403A84:				; CODE XREF: sub_403A10+6Fj
		mov	ebx, [edx+0Ch]
		cmp	esi, ebx
		jb	short loc_403A92
		add	ebx, [edx+8]
		cmp	esi, ebx
		jb	short loc_403A9B

loc_403A92:				; CODE XREF: sub_403A10+79j
		add	ecx, 1
		cmp	edi, ecx
		ja	short loc_403A81
		jmp	short loc_403A2D
; ---------------------------------------------------------------------------

loc_403A9B:				; CODE XREF: sub_403A10+80j
		test	edx, edx
		lea	esi, [esi+0]
		jz	short loc_403A2D
		add	esi, 400000h
		jmp	short loc_403ABA
; ---------------------------------------------------------------------------
		align 10h

loc_403AB0:				; CODE XREF: sub_403A10+AFj
					; sub_403A10+B6j
		test	eax, eax
		jle	short loc_403AD0
		sub	eax, 1
		add	esi, 14h

loc_403ABA:				; CODE XREF: sub_403A10+98j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jnz	short loc_403AB0
		mov	edx, [esi+0Ch]
		test	edx, edx
		jnz	short loc_403AB0
		jmp	loc_403A2D
; ---------------------------------------------------------------------------
		align 10h

loc_403AD0:				; CODE XREF: sub_403A10+A2j
		mov	eax, 400000h
		add	eax, [esi+0Ch]
		jmp	loc_403A2F
sub_403A10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403AE0	proc near		; CODE XREF: sub_401190+12Fp

lpModuleName	= dword	ptr -1Ch

		push	ebx
		xor	edx, edx
		sub	esp, 18h
		mov	eax, ds:dword_40B05C
		test	eax, eax
		jz	short loc_403B32

loc_403AEF:				; CODE XREF: sub_403AE0+9Fj
					; sub_403AE0+BAj
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403AF4:				; CODE XREF: sub_403AE0+83j
					; sub_403AE0+88j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_403B02
		cmp	dl, 63h
		jnz	short loc_403B30

loc_403B02:				; CODE XREF: sub_403AE0+1Bj
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_403B12
		cmp	dl, 72h
		xchg	ax, ax
		jnz	short loc_403B30

loc_403B12:				; CODE XREF: sub_403AE0+29j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_403B6E
		cmp	dl, 74h
		xchg	ax, ax
		jz	short loc_403B6E
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_403B6E
		lea	esi, [esi+0]

loc_403B30:				; CODE XREF: sub_403AE0+20j
					; sub_403AE0+30j ...
		mov	edx, ebx

loc_403B32:				; CODE XREF: sub_403AE0+Dj
					; sub_403AE0+8Cj
		lea	ebx, [edx+1]
		mov	[esp+1Ch+lpModuleName],	edx
		call	sub_403A10
		test	eax, eax
		jz	short loc_403B85
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_403B4E
		cmp	dl, 6Dh
		jnz	short loc_403B30

loc_403B4E:				; CODE XREF: sub_403AE0+67j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_403B5C
		cmp	dl, 73h
		jnz	short loc_403B30

loc_403B5C:				; CODE XREF: sub_403AE0+75j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_403AF4
		cmp	dl, 76h
		jz	short loc_403AF4
		mov	edx, ebx
		jmp	short loc_403B32
; ---------------------------------------------------------------------------

loc_403B6E:				; CODE XREF: sub_403AE0+39j
					; sub_403AE0+40j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		test	eax, eax
		push	ebx
		mov	ds:dword_40B05C, eax
		jnz	loc_403AEF

loc_403B85:				; CODE XREF: sub_403AE0+5Fj
		mov	[esp+1Ch+lpModuleName],	offset LibFileName ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_40B05C, eax
		jmp	loc_403AEF
sub_403AE0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 2Ch
		mov	[esp+20h], esi
		mov	esi, [esp+30h]
		mov	[esp+1Ch], ebx
		mov	[esp+24h], edi
		mov	[esp+28h], ebp
		mov	[esp], esi
		call	strlen
		cmp	eax, 8
		jbe	short loc_403BE0

loc_403BC4:				; CODE XREF: .text:00403BE9j
					; .text:00403C00j ...
		xor	ebx, ebx

loc_403BC6:				; CODE XREF: .text:00403C3Aj
		mov	eax, ebx
		mov	esi, [esp+20h]
		mov	ebx, [esp+1Ch]
		mov	edi, [esp+24h]
		mov	ebp, [esp+28h]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403BE0:				; CODE XREF: .text:00403BC2j
		cmp	word ptr ds:400000h, 5A4Dh
		jnz	short loc_403BC4
		mov	eax, ds:40003Ch
		cmp	dword ptr [eax+400000h], 4550h
		lea	edx, [eax+400000h]
		jnz	short loc_403BC4
		cmp	word ptr [edx+18h], 10Bh
		jnz	short loc_403BC4
		movzx	ebp, word ptr [edx+6]
		movzx	eax, word ptr [edx+14h]
		test	ebp, ebp
		jz	short loc_403BC4
		movzx	eax, ax
		xor	edi, edi
		lea	ebx, [edx+eax+18h]
		jmp	short loc_403C24
; ---------------------------------------------------------------------------

loc_403C21:				; CODE XREF: .text:00403C41j
		add	ebx, 28h

loc_403C24:				; CODE XREF: .text:00403C1Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], esi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jz	short loc_403BC6
		add	edi, 1
		cmp	edi, ebp
		jb	short loc_403C21
		jmp	loc_403BC4
; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_40B184, edx
		mov	ds:dword_40B060, 0C0000409h
		mov	ds:dword_40B064, 1
		mov	ds:dword_40B178, eax
		mov	ds:dword_40B06C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_40B16C, eax
		mov	eax, dword_409030
		mov	[ebp-10h], eax
		mov	eax, dword_409034
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_40A924
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403CE0	proc near		; CODE XREF: start+Dp .text:0040150Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
PerformanceCount= LARGE_INTEGER	ptr -2Ch
SystemTimeAsFileTime= _FILETIME	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_409030
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		jz	short loc_403D20
		not	eax
		mov	dword_409034, eax

loc_403D06:				; CODE XREF: sub_403CE0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403D20:				; CODE XREF: sub_403CE0+1Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_403DA2

loc_403D92:				; CODE XREF: sub_403CE0+CBj
		mov	dword_409030, ebp
		mov	dword_409034, eax
		jmp	loc_403D06
; ---------------------------------------------------------------------------

loc_403DA2:				; CODE XREF: sub_403CE0+B0j
		mov	eax, 44BF19B0h
		mov	bp, 0E64Fh
		jmp	short loc_403D92
sub_403CE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403DB0	proc near		; CODE XREF: sub_401190:loc_4012E5p
					; TopLevelExceptionFilter+164p
		fninit
		retn
sub_403DB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_403DC0()
sub_403DC0	proc near		; DATA XREF: sub_403E50:loc_403E1Ao
		sub	esp, 0Ch
		mov	eax, off_409010
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_403DE7
		xchg	ax, ax

loc_403DD0:				; CODE XREF: sub_403DC0+25j
		call	eax
		mov	eax, off_409010
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_409010, edx
		test	eax, eax
		jnz	short loc_403DD0

loc_403DE7:				; CODE XREF: sub_403DC0+Cj
		add	esp, 0Ch
		retn
sub_403DC0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_403E50

loc_403DF0:				; CODE XREF: sub_403E50+1Ej
		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, ds:dword_408C10
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_403E30

loc_403E00:				; CODE XREF: sub_403E50-Cj
		test	ebx, ebx
		jz	short loc_403E1A
		lea	esi, ds:408C10h[ebx*4]
		nop
		lea	esi, [esi+0]

loc_403E10:				; CODE XREF: sub_403E50-38j
		call	dword ptr [esi]
		sub	esi, 4
		sub	ebx, 1
		jnz	short loc_403E10

loc_403E1A:				; CODE XREF: sub_403E50-4Ej
		mov	[esp+1Ch+var_1C], offset sub_403DC0 ; _onexit_t
		call	sub_4032F0
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; END OF FUNCTION CHUNK	FOR sub_403E50
; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_403E50

loc_403E30:				; CODE XREF: sub_403E50-52j
		xor	ebx, ebx
		jmp	short loc_403E36
; ---------------------------------------------------------------------------

loc_403E34:				; CODE XREF: sub_403E50-Ej
		mov	ebx, eax

loc_403E36:				; CODE XREF: sub_403E50-1Ej
		lea	eax, [ebx+1]
		mov	edx, ds:dword_408C10[eax*4]
		test	edx, edx
		jnz	short loc_403E34
		jmp	short loc_403E00
; END OF FUNCTION CHUNK	FOR sub_403E50
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403E50	proc near		; CODE XREF: sub_4025E0+Fp

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00403DF0 SIZE 0000003C BYTES
; FUNCTION CHUNK AT 00403E30 SIZE 00000016 BYTES

		sub	esp, 0Ch
		mov	ecx, ds:dword_40B3A0
		test	ecx, ecx
		jz	short loc_403E61
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_403E61:				; CODE XREF: sub_403E50+Bj
		mov	ds:dword_40B3A0, 1
		add	esp, 0Ch
		jmp	short loc_403DF0
sub_403E50	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_403E70	proc near		; CODE XREF: sub_403EF0+13p
					; sub_403EF0:loc_403F11p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	eax, ds:dword_40B3A4
		test	eax, eax
		jnz	short loc_403E88
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_403E88:				; CODE XREF: sub_403E70+Ej
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_40B3C0
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_403ED5
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		xchg	ax, ax

loc_403EB0:				; CODE XREF: sub_403E70+63j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_403ECE
		test	esi, esi
		jz	short loc_403ECE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_403ECE:				; CODE XREF: sub_403E70+50j
					; sub_403E70+54j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_403EB0

loc_403ED5:				; CODE XREF: sub_403E70+30j
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_403E70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403EF0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+77p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_403F40
		jb	short loc_403F11
		cmp	eax, 3
		jnz	short loc_403F08
		call	sub_403E70

loc_403F08:				; CODE XREF: sub_403EF0+11j
					; sub_403EF0+2Ej ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_403F11:				; CODE XREF: sub_403EF0+Cj
		call	sub_403E70
		mov	eax, ds:dword_40B3A4
		cmp	eax, 1
		jnz	short loc_403F08
		mov	ds:dword_40B3A4, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_403F08
; ---------------------------------------------------------------------------
		align 10h

loc_403F40:				; CODE XREF: sub_403EF0+Aj
		mov	eax, ds:dword_40B3A4
		test	eax, eax
		jz	short loc_403F60

loc_403F49:				; CODE XREF: sub_403EF0+80j
		mov	ds:dword_40B3A4, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403F60:				; CODE XREF: sub_403EF0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_403F49
sub_403EF0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_403F80:				; CODE XREF: .text:004048A6j
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40B3A4
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_403F98
		xor	eax, eax
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403F98:				; CODE XREF: .text:00403F8Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_40B3C0
		sub	esp, 4
		test	eax, eax
		jz	short loc_403FCF
		mov	edx, [eax]
		cmp	edx, ebx
		jnz	short loc_403FC6
		jmp	short loc_404006
; ---------------------------------------------------------------------------
		align 10h

loc_403FC0:				; CODE XREF: .text:00403FCDj
		mov	edx, [eax]
		cmp	edx, ebx
		jz	short loc_403FE6

loc_403FC6:				; CODE XREF: .text:00403FB5j
		mov	ecx, eax
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_403FC0

loc_403FCF:				; CODE XREF: .text:00403FAFj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_403FDF:				; CODE XREF: .text:00404004j
		xor	eax, eax
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403FE6:				; CODE XREF: .text:00403FC4j
		mov	edx, [eax+8]
		mov	[ecx+8], edx

loc_403FEC:				; CODE XREF: .text:0040400Fj
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_403FDF
; ---------------------------------------------------------------------------

loc_404006:				; CODE XREF: .text:00403FB7j
		mov	edx, [eax+8]
		mov	ds:dword_40B3C0, edx
		jmp	short loc_403FEC
; ---------------------------------------------------------------------------
		jmp	short loc_404020
; ---------------------------------------------------------------------------
		align 10h

loc_404020:				; CODE XREF: .text:00404011j
					; .text:0040488Aj
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40B3A4
		test	eax, eax
		jnz	short loc_404032

loc_40402D:				; CODE XREF: .text:0040404Fj
					; .text:0040408Ej
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_404032:				; CODE XREF: .text:0040402Bj
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		mov	ebx, eax
		mov	eax, 0FFFFFFFFh
		test	ebx, ebx
		jz	short loc_40402D
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[ebx], eax
		mov	eax, [esp+24h]
		mov	[ebx+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_40B3C0
		mov	ds:dword_40B3C0, ebx
		mov	[ebx+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		xor	eax, eax
		sub	esp, 4
		jmp	short loc_40402D

; =============== S U B	R O U T	I N E =======================================


sub_404090	proc near		; CODE XREF: sub_403530+3Cp

arg_0		= byte ptr  4

		push	ecx
		lea	ecx, [esp+4+arg_0]
		cmp	eax, 1000h
		jb	short loc_4040B1

loc_40409C:				; CODE XREF: sub_404090+1Fj
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_40409C

loc_4040B1:				; CODE XREF: sub_404090+Aj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		mov	eax, esp
		mov	esp, ecx
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	eax
		retn
sub_404090	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_4040F0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4040F0	proc near		; CODE XREF: sub_401190+A7p
					; .text:004040E1j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_4040F0	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+8]
		mov	edx, [esp+4]
		lock xchg eax, [edx]
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404120	proc near		; CODE XREF: sub_401190+305p
					; sub_406B70+50p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_0]
		lock xchg eax, [edx]
		retn	8
sub_404120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404130	proc near		; CODE XREF: sub_4022D0+C4p

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= qword	ptr -24h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 4Ch
		lea	eax, [esp+4Ch+var_18]
		mov	[esp+4Ch+var_3C], eax
		lea	eax, [esp+4Ch+var_10]
		mov	[esp+4Ch+var_40], eax
		mov	eax, [esp+4Ch+arg_4]
		mov	[esp+4Ch+var_44], offset dword_409014
		mov	[esp+4Ch+var_48], eax
		mov	eax, [esp+4Ch+arg_0]
		mov	[esp+4Ch+var_4C], eax
		call	sub_404D30
		mov	edx, eax
		and	edx, 7
		cmp	edx, 6		; switch 7 cases
		ja	short loc_404186 ; jumptable 00404169 default case
		jmp	ds:off_40A92C[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_404170:				; CODE XREF: sub_404130+39j
					; DATA XREF: .rdata:off_40A92Co
		mov	edx, [esp+4Ch+var_14] ;	jumptable 00404169 case	5
		or	edx, 7FF00000h
		mov	dword ptr [esp+4Ch+var_24+4], edx
		mov	edx, [esp+4Ch+var_18]
		mov	dword ptr [esp+4Ch+var_24], edx

loc_404186:				; CODE XREF: sub_404130+37j
					; sub_404130+80j ...
		test	al, 8		; jumptable 00404169 default case
		jz	short loc_404192
		or	dword ptr [esp+4Ch+var_24+4], 80000000h

loc_404192:				; CODE XREF: sub_404130+58j
		fld	[esp+4Ch+var_24]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4041A0:				; CODE XREF: sub_404130+39j
					; DATA XREF: .rdata:off_40A92Co
		mov	dword ptr [esp+4Ch+var_24], 0 ;	jumptable 00404169 case	4
		mov	dword ptr [esp+4Ch+var_24+4], 0FFF80000h
		jmp	short loc_404186 ; jumptable 00404169 default case
; ---------------------------------------------------------------------------

loc_4041B2:				; CODE XREF: sub_404130+39j
					; DATA XREF: .rdata:off_40A92Co
		mov	dword ptr [esp+4Ch+var_24], 0 ;	jumptable 00404169 cases 0,6
		mov	dword ptr [esp+4Ch+var_24+4], 0
		jmp	short loc_404186 ; jumptable 00404169 default case
; ---------------------------------------------------------------------------

loc_4041C4:				; CODE XREF: sub_404130+39j
					; DATA XREF: .rdata:off_40A92Co
		mov	edx, [esp+4Ch+var_18] ;	jumptable 00404169 case	1
		mov	ecx, [esp+4Ch+var_10]
		mov	dword ptr [esp+4Ch+var_24], edx
		mov	edx, [esp+4Ch+var_14]
		add	ecx, 433h
		shl	ecx, 14h
		and	edx, 0FFEFFFFFh
		or	ecx, edx
		mov	dword ptr [esp+4Ch+var_24+4], ecx
		jmp	short loc_404186 ; jumptable 00404169 default case
; ---------------------------------------------------------------------------
		align 10h

loc_4041F0:				; CODE XREF: sub_404130+39j
					; DATA XREF: .rdata:off_40A92Co
		mov	edx, [esp+4Ch+var_18] ;	jumptable 00404169 case	2
		mov	dword ptr [esp+4Ch+var_24], edx
		mov	edx, [esp+4Ch+var_14]
		mov	dword ptr [esp+4Ch+var_24+4], edx
		jmp	short loc_404186 ; jumptable 00404169 default case
; ---------------------------------------------------------------------------

loc_404202:				; CODE XREF: sub_404130+39j
					; DATA XREF: .rdata:off_40A92Co
		mov	dword ptr [esp+4Ch+var_24], 0 ;	jumptable 00404169 case	3
		mov	dword ptr [esp+4Ch+var_24+4], 7FF00000h
		jmp	loc_404186	; jumptable 00404169 default case
sub_404130	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404220	proc near		; CODE XREF: sub_4022D0+1F7p

C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [esp+5Ch+arg_4]
		mov	ebx, [esp+5Ch+arg_0]
		test	eax, eax
		jz	short loc_404239
		mov	eax, [esp+5Ch+arg_4]
		mov	[eax], ebx

loc_404239:				; CODE XREF: sub_404220+11j
		cmp	[esp+5Ch+arg_8], 1
		jz	short loc_40424F
		mov	ebp, [esp+5Ch+arg_8]
		test	ebp, ebp
		js	short loc_40424F
		cmp	[esp+5Ch+arg_8], 24h
		jle	short loc_404273

loc_40424F:				; CODE XREF: sub_404220+1Ej
					; sub_404220+26j
		call	_errno
		xor	esi, esi
		xor	edi, edi
		mov	dword ptr [eax], 21h

loc_40425E:				; CODE XREF: sub_404220+250j
					; sub_404220+25Dj
		add	esp, 4Ch
		mov	eax, esi
		mov	edx, edi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_404270:				; CODE XREF: sub_404220+65j
		add	ebx, 1

loc_404273:				; CODE XREF: sub_404220+2Dj
		movzx	esi, byte ptr [ebx]
		mov	edx, esi
		movsx	eax, dl
		mov	[esp+5Ch+C], eax ; C
		call	isspace
		test	eax, eax
		jnz	short loc_404270
		mov	eax, esi
		mov	edx, ebx
		cmp	al, 2Dh
		setz	al
		movzx	eax, al
		test	eax, eax
		mov	[esp+5Ch+var_20], eax
		jnz	loc_404405
		mov	eax, esi
		cmp	al, 2Bh
		jz	loc_404405
		mov	edi, [esp+5Ch+arg_8]
		test	edi, edi
		jnz	loc_404418

loc_4042B5:				; CODE XREF: sub_404220+1F2j
		mov	edx, esi
		cmp	dl, 30h
		mov	[esp+5Ch+arg_8], 0Ah
		jz	loc_404500

loc_4042C8:				; CODE XREF: sub_404220+2B7j
					; sub_404220+2F2j
		lea	ebp, [ebx+1]

loc_4042CB:				; CODE XREF: sub_404220+209j
					; sub_404220+2D4j ...
		mov	edx, esi
		movsx	ebx, dl
		lea	esi, [ebx-30h]
		cmp	esi, 9
		jbe	short loc_404301
		mov	[esp+5Ch+C], ebx ; C
		call	isupper
		test	eax, eax
		jnz	loc_4044B1
		mov	[esp+5Ch+C], ebx ; C
		mov	esi, 0FFFFFFFFh
		call	islower
		mov	edx, 1
		test	eax, eax
		jz	short loc_404306
		lea	esi, [ebx-57h]

loc_404301:				; CODE XREF: sub_404220+B6j
		mov	edx, esi
		shr	edx, 1Fh

loc_404306:				; CODE XREF: sub_404220+DCj
		cmp	[esp+5Ch+arg_8], esi
		jle	loc_4044C3

loc_404310:				; CODE XREF: sub_404220+29Dj
		test	dl, dl
		jnz	loc_4044C3
		mov	eax, [esp+5Ch+arg_8]
		mov	edi, esi
		sar	edi, 1Fh
		mov	[esp+5Ch+var_24], 0
		mov	edx, eax
		sar	edx, 1Fh
		mov	[esp+5Ch+var_34], eax
		mov	[esp+5Ch+var_30], edx

loc_404336:				; CODE XREF: sub_404220+1E0j
		movsx	edx, byte ptr [ebp+0]
		lea	ebx, [edx-30h]
		cmp	ebx, 9
		jbe	short loc_40435D
		mov	[esp+5Ch+C], edx ; C
		mov	[esp+5Ch+var_38], edx
		call	isupper
		mov	edx, [esp+5Ch+var_38]
		test	eax, eax
		jz	loc_404440
		lea	ebx, [edx-37h]

loc_40435D:				; CODE XREF: sub_404220+120j
					; sub_404220+265j
		cmp	[esp+5Ch+arg_8], ebx
		mov	eax, ebx
		not	eax
		setnle	dl
		shr	eax, 1Fh
		test	eax, edx
		jz	loc_404454
		mov	eax, [esp+5Ch+var_34]
		mov	edx, [esp+5Ch+var_30]
		mov	[esp+5Ch+C], 0FFFFFFFFh
		mov	[esp+5Ch+var_58], 0FFFFFFFFh
		mov	[esp+5Ch+var_54], eax
		mov	[esp+5Ch+var_50], edx
		call	sub_408970
		add	eax, 1
		adc	edx, 0
		cmp	edi, edx
		ja	short loc_4043F2
		jb	short loc_4043A7
		cmp	esi, eax
		ja	short loc_4043F2

loc_4043A7:				; CODE XREF: sub_404220+181j
		mov	[esp+5Ch+var_44], ebx
		mov	edx, ebx
		mov	ecx, [esp+5Ch+var_34]
		mov	ebx, [esp+5Ch+var_30]
		sar	edx, 1Fh
		mov	eax, [esp+5Ch+var_34]
		mov	[esp+5Ch+var_40], edx
		imul	ecx, edi
		imul	ebx, esi
		mul	esi
		add	ecx, ebx
		add	edx, ecx
		mov	[esp+5Ch+var_2C], eax
		mov	eax, [esp+5Ch+var_2C]
		add	[esp+5Ch+var_44], eax
		mov	[esp+5Ch+var_28], edx
		mov	edx, [esp+5Ch+var_28]
		adc	[esp+5Ch+var_40], edx
		cmp	edi, [esp+5Ch+var_40]
		ja	short loc_4043F2
		jb	short loc_404430
		cmp	esi, [esp+5Ch+var_44]
		jbe	short loc_404430

loc_4043F2:				; CODE XREF: sub_404220+17Fj
					; sub_404220+185j ...
		mov	[esp+5Ch+var_24], 1

loc_4043FA:				; CODE XREF: sub_404220+218j
		add	ebp, 1
		lea	esi, [esi+0]
		jmp	loc_404336
; ---------------------------------------------------------------------------

loc_404405:				; CODE XREF: sub_404220+79j
					; sub_404220+83j
		mov	edi, [esp+5Ch+arg_8]
		add	ebx, 1
		movzx	esi, byte ptr [edx+1]
		test	edi, edi
		jz	loc_4042B5

loc_404418:				; CODE XREF: sub_404220+8Fj
		cmp	[esp+5Ch+arg_8], 10h
		jz	loc_4044D3
		movzx	esi, byte ptr [ebx]
		lea	ebp, [ebx+1]
		jmp	loc_4042CB
; ---------------------------------------------------------------------------
		align 10h

loc_404430:				; CODE XREF: sub_404220+1CAj
					; sub_404220+1D0j
		mov	esi, [esp+5Ch+var_44]
		mov	edi, [esp+5Ch+var_40]
		jmp	short loc_4043FA
; ---------------------------------------------------------------------------
		align 10h

loc_404440:				; CODE XREF: sub_404220+134j
		mov	[esp+5Ch+C], edx ; C
		mov	[esp+5Ch+var_38], edx
		call	islower
		mov	edx, [esp+5Ch+var_38]
		test	eax, eax
		jnz	short loc_404482

loc_404454:				; CODE XREF: sub_404220+14Dj
		mov	ecx, [esp+5Ch+arg_4]
		test	ecx, ecx
		jz	short loc_404462
		mov	edx, [esp+5Ch+arg_4]
		mov	[edx], ebp

loc_404462:				; CODE XREF: sub_404220+23Aj
		mov	edx, [esp+5Ch+var_24]
		test	edx, edx
		jnz	short loc_404490
		mov	eax, [esp+5Ch+var_20]
		test	eax, eax
		jz	loc_40425E
		neg	esi
		adc	edi, 0
		neg	edi
		jmp	loc_40425E
; ---------------------------------------------------------------------------

loc_404482:				; CODE XREF: sub_404220+232j
		lea	ebx, [edx-57h]
		jmp	loc_40435D
; ---------------------------------------------------------------------------
		align 10h

loc_404490:				; CODE XREF: sub_404220+248j
		call	_errno
		mov	esi, 0FFFFFFFFh
		mov	edi, 0FFFFFFFFh
		mov	edx, edi
		mov	dword ptr [eax], 22h
		add	esp, 4Ch
		mov	eax, esi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4044B1:				; CODE XREF: sub_404220+C2j
		lea	esi, [ebx-37h]
		mov	edx, esi
		shr	edx, 1Fh
		cmp	[esp+5Ch+arg_8], esi
		jg	loc_404310

loc_4044C3:				; CODE XREF: sub_404220+EAj
					; sub_404220+F2j
		xor	esi, esi
		xor	edi, edi
		add	esp, 4Ch
		mov	eax, esi
		mov	edx, edi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4044D3:				; CODE XREF: sub_404220+1FDj
		mov	eax, esi
		cmp	al, 30h
		jnz	loc_4042C8
		movzx	eax, byte ptr [ebx+1]
		lea	ebp, [ebx+1]
		cmp	al, 58h
		setz	dl
		cmp	al, 78h
		jz	short loc_404518
		test	dl, dl
		jnz	short loc_404518
		movzx	esi, byte ptr [ebx]
		jmp	loc_4042CB
; ---------------------------------------------------------------------------
		align 10h

loc_404500:				; CODE XREF: sub_404220+A2j
		movzx	eax, byte ptr [ebx+1]
		cmp	al, 78h
		jz	short loc_404518
		cmp	al, 58h
		mov	[esp+5Ch+arg_8], 8
		jnz	loc_4042C8

loc_404518:				; CODE XREF: sub_404220+2CBj
					; sub_404220+2CFj ...
		movzx	esi, byte ptr [ebx+2]
		lea	ebp, [ebx+3]
		mov	[esp+5Ch+arg_8], 10h
		jmp	loc_4042CB
sub_404220	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404530	proc near		; CODE XREF: sub_4022D0+277p

C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [esp+5Ch+arg_4]
		mov	ebx, [esp+5Ch+arg_0]
		test	eax, eax
		jz	short loc_404549
		mov	eax, [esp+5Ch+arg_4]
		mov	[eax], ebx

loc_404549:				; CODE XREF: sub_404530+11j
		cmp	[esp+5Ch+arg_8], 1
		jz	short loc_40455F
		mov	ebp, [esp+5Ch+arg_8]
		test	ebp, ebp
		js	short loc_40455F
		cmp	[esp+5Ch+arg_8], 24h
		jle	short loc_404579

loc_40455F:				; CODE XREF: sub_404530+1Ej
					; sub_404530+26j
		call	_errno
		xor	edx, edx
		mov	dword ptr [eax], 21h
		xor	eax, eax

loc_40456E:				; CODE XREF: sub_404530+282j
					; sub_404530+317j ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_404576:				; CODE XREF: sub_404530+5Bj
		add	ebx, 1

loc_404579:				; CODE XREF: sub_404530+2Dj
		movzx	esi, byte ptr [ebx]
		mov	edx, esi
		movsx	eax, dl
		mov	[esp+5Ch+C], eax ; C
		call	isspace
		test	eax, eax
		jnz	short loc_404576
		mov	eax, esi
		mov	edx, ebx
		cmp	al, 2Dh
		setz	al
		movzx	eax, al
		test	eax, eax
		mov	[esp+5Ch+var_20], eax
		jnz	loc_4046F7
		mov	eax, esi
		cmp	al, 2Bh
		jz	loc_4046F7
		mov	edi, [esp+5Ch+arg_8]
		test	edi, edi
		jnz	loc_40470A

loc_4045BB:				; CODE XREF: sub_404530+1D4j
		mov	edx, esi
		cmp	dl, 30h
		mov	[esp+5Ch+arg_8], 0Ah
		jz	loc_404806

loc_4045CE:				; CODE XREF: sub_404530+2B4j
					; sub_404530+2E8j
		lea	ebp, [ebx+1]

loc_4045D1:				; CODE XREF: sub_404530+1EBj
					; sub_404530+2D1j ...
		mov	edx, esi
		movsx	ebx, dl
		lea	esi, [ebx-30h]
		cmp	esi, 9
		jbe	short loc_404610
		mov	[esp+5Ch+C], ebx ; C
		call	isupper
		test	eax, eax
		jnz	loc_4047B7
		mov	[esp+5Ch+C], ebx ; C
		mov	esi, 0FFFFFFFFh
		call	islower
		mov	edx, eax
		mov	eax, 1
		test	edx, edx
		jz	short loc_404615
		lea	esi, [ebx-57h]
		lea	esi, [esi+0]

loc_404610:				; CODE XREF: sub_404530+ACj
		mov	eax, esi
		shr	eax, 1Fh

loc_404615:				; CODE XREF: sub_404530+D4j
		cmp	[esp+5Ch+arg_8], esi
		jle	loc_4047D0

loc_40461F:				; CODE XREF: sub_404530+293j
		test	al, al
		jnz	loc_4047D0
		mov	eax, [esp+5Ch+arg_8]
		mov	edi, esi
		sar	edi, 1Fh
		mov	[esp+5Ch+var_24], 0
		mov	edx, eax
		sar	edx, 1Fh
		mov	[esp+5Ch+var_2C], eax
		mov	[esp+5Ch+var_28], edx
		jmp	short loc_404658
; ---------------------------------------------------------------------------

loc_404647:				; CODE XREF: sub_404530+191j
		ja	short loc_40464D
		cmp	esi, eax
		jbe	short loc_4046C3

loc_40464D:				; CODE XREF: sub_404530:loc_404647j
		mov	[esp+5Ch+var_24], 1

loc_404655:				; CODE XREF: sub_404530+1C2j
		add	ebp, 1

loc_404658:				; CODE XREF: sub_404530+115j
		movsx	edx, byte ptr [ebp+0]
		lea	ebx, [edx-30h]
		cmp	ebx, 9
		jbe	short loc_40467F
		mov	[esp+5Ch+C], edx ; C
		mov	[esp+5Ch+var_30], edx
		call	isupper
		mov	edx, [esp+5Ch+var_30]
		test	eax, eax
		jz	loc_404720
		lea	ebx, [edx-37h]

loc_40467F:				; CODE XREF: sub_404530+132j
					; sub_404530+253j
		cmp	[esp+5Ch+arg_8], ebx
		mov	eax, ebx
		not	eax
		setnle	dl
		shr	eax, 1Fh
		test	eax, edx
		jz	loc_404734
		mov	eax, [esp+5Ch+var_2C]
		mov	edx, [esp+5Ch+var_28]
		mov	[esp+5Ch+C], 0FFFFFFFFh
		mov	[esp+5Ch+var_58], 7FFFFFFFh
		mov	[esp+5Ch+var_54], eax
		mov	[esp+5Ch+var_50], edx
		call	sub_408A90
		add	eax, 2
		adc	edx, 0
		cmp	edi, edx
		jnb	short loc_404647

loc_4046C3:				; CODE XREF: sub_404530+11Bj
		mov	ecx, [esp+5Ch+var_2C]
		mov	eax, [esp+5Ch+var_28]
		imul	ecx, edi
		mov	edi, ebx
		imul	eax, esi
		sar	edi, 1Fh
		add	ecx, eax
		mov	eax, [esp+5Ch+var_2C]
		mul	esi
		mov	esi, ebx
		add	edx, ecx
		mov	[esp+5Ch+var_44], eax
		mov	[esp+5Ch+var_40], edx
		add	esi, [esp+5Ch+var_44]
		adc	edi, [esp+5Ch+var_40]
		jmp	loc_404655
; ---------------------------------------------------------------------------

loc_4046F7:				; CODE XREF: sub_404530+6Fj
					; sub_404530+79j
		mov	edi, [esp+5Ch+arg_8]
		add	ebx, 1
		movzx	esi, byte ptr [edx+1]
		test	edi, edi
		jz	loc_4045BB

loc_40470A:				; CODE XREF: sub_404530+85j
		cmp	[esp+5Ch+arg_8], 10h
		jz	loc_4047E0
		movzx	esi, byte ptr [ebx]
		lea	ebp, [ebx+1]
		jmp	loc_4045D1
; ---------------------------------------------------------------------------

loc_404720:				; CODE XREF: sub_404530+146j
		mov	[esp+5Ch+C], edx ; C
		mov	[esp+5Ch+var_30], edx
		call	islower
		mov	edx, [esp+5Ch+var_30]
		test	eax, eax
		jnz	short loc_404780

loc_404734:				; CODE XREF: sub_404530+15Fj
		mov	ebx, [esp+5Ch+arg_4]
		test	ebx, ebx
		jz	short loc_404742
		mov	edx, [esp+5Ch+arg_4]
		mov	[edx], ebp

loc_404742:				; CODE XREF: sub_404530+20Aj
		mov	ecx, [esp+5Ch+var_20]
		test	ecx, ecx
		jnz	short loc_404788
		test	edi, edi
		js	loc_404832

loc_404752:				; CODE XREF: sub_404530+260j
					; sub_404530+265j
		mov	edx, [esp+5Ch+var_24]
		test	edx, edx
		jnz	loc_40484C
		mov	eax, [esp+5Ch+var_20]
		test	eax, eax
		jz	short loc_40476D
		neg	esi
		adc	edi, 0
		neg	edi

loc_40476D:				; CODE XREF: sub_404530+234j
		add	esp, 4Ch
		mov	eax, esi
		mov	edx, edi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_404780:				; CODE XREF: sub_404530+202j
		lea	ebx, [edx-57h]
		jmp	loc_40467F
; ---------------------------------------------------------------------------

loc_404788:				; CODE XREF: sub_404530+218j
		cmp	edi, 80000000h
		ja	short loc_404797
		jb	short loc_404752
		cmp	esi, 0
		jbe	short loc_404752

loc_404797:				; CODE XREF: sub_404530+25Ej
		mov	esi, esi
		lea	edi, [edi+0]
		call	_errno
		mov	dword ptr [eax], 22h

loc_4047AB:				; CODE XREF: sub_404530+334j
		xor	eax, eax
		mov	edx, 80000000h
		jmp	loc_40456E
; ---------------------------------------------------------------------------

loc_4047B7:				; CODE XREF: sub_404530+B8j
		lea	esi, [ebx-37h]
		mov	eax, esi
		shr	eax, 1Fh
		cmp	[esp+5Ch+arg_8], esi
		jg	loc_40461F
		lea	esi, [esi+0]

loc_4047D0:				; CODE XREF: sub_404530+E9j
					; sub_404530+F1j
		add	esp, 4Ch
		xor	eax, eax
		xor	edx, edx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4047E0:				; CODE XREF: sub_404530+1DFj
		mov	eax, esi
		cmp	al, 30h
		jnz	loc_4045CE
		movzx	eax, byte ptr [ebx+1]
		lea	ebp, [ebx+1]
		cmp	al, 58h
		setz	dl
		cmp	al, 78h
		jz	short loc_40481E
		test	dl, dl
		jnz	short loc_40481E
		movzx	esi, byte ptr [ebx]
		jmp	loc_4045D1
; ---------------------------------------------------------------------------

loc_404806:				; CODE XREF: sub_404530+98j
		movzx	eax, byte ptr [ebx+1]
		cmp	al, 78h
		jz	short loc_40481E
		cmp	al, 58h
		mov	[esp+5Ch+arg_8], 8
		jnz	loc_4045CE

loc_40481E:				; CODE XREF: sub_404530+2C8j
					; sub_404530+2CCj ...
		movzx	esi, byte ptr [ebx+2]
		lea	ebp, [ebx+3]
		mov	[esp+5Ch+arg_8], 10h
		jmp	loc_4045D1
; ---------------------------------------------------------------------------

loc_404832:				; CODE XREF: sub_404530+21Cj
		call	_errno
		mov	edx, 7FFFFFFFh
		mov	dword ptr [eax], 22h
		mov	eax, 0FFFFFFFFh
		jmp	loc_40456E
; ---------------------------------------------------------------------------

loc_40484C:				; CODE XREF: sub_404530+228j
		call	_errno
		mov	edx, 7FFFFFFFh
		mov	dword ptr [eax], 22h
		or	eax, 0FFFFFFFFh
		cmp	[esp+5Ch+var_20], 0
		jnz	loc_4047AB
		jmp	loc_40456E
sub_404530	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	eax, [esp+14h]
		mov	edx, [esp+10h]
		test	eax, eax
		jz	short loc_404890
		mov	[esp+14h], eax
		mov	[esp+10h], edx
		add	esp, 0Ch
		jmp	loc_404020
; ---------------------------------------------------------------------------
		align 10h

loc_404890:				; CODE XREF: .text:0040487Dj
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		add	esp, 0Ch
		jmp	loc_403F80
; ---------------------------------------------------------------------------
		align 10h
		mov	edx, [esp+4]
		mov	ecx, [edx+10h]
		lea	eax, [edx+14h]
		lea	ecx, [edx+ecx*4+14h]
		xchg	ax, ax

loc_4048C0:				; CODE XREF: .text:004048D1j
		mov	edx, [eax]
		test	edx, edx
		jnz	short loc_4048D5
		mov	dword ptr [eax], 0FFFFFFFFh
		add	eax, 4
		cmp	ecx, eax
		ja	short loc_4048C0
		rep retn
; ---------------------------------------------------------------------------

loc_4048D5:				; CODE XREF: .text:004048C4j
		sub	edx, 1
		mov	[eax], edx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4048E0	proc near		; CODE XREF: sub_404D30+1058p
					; sub_404D30+1992p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, [esp+1Ch+arg_4]
		mov	eax, [esp+1Ch+arg_0]
		lea	esi, [ebx+1Fh]
		sar	esi, 5
		cmp	esi, [eax+4]
		jg	short loc_404942

loc_4048F8:				; CODE XREF: sub_4048E0+72j
		mov	ecx, ebx
		and	ebx, 1Fh
		sar	ecx, 5
		cmp	ebx, 1
		sbb	ecx, 0FFFFFFFFh
		lea	edx, [eax+14h]
		lea	esi, [eax+ecx*4+14h]
		cmp	edx, esi
		mov	[eax+10h], ecx
		jnb	short loc_40492E
		mov	ecx, edx

loc_404916:				; CODE XREF: sub_4048E0+41j
		mov	dword ptr [ecx], 0FFFFFFFFh
		add	ecx, 4
		cmp	esi, ecx
		ja	short loc_404916
		not	edx
		add	edx, esi
		shr	edx, 2
		lea	edx, [eax+edx*4+18h]

loc_40492E:				; CODE XREF: sub_4048E0+32j
		test	ebx, ebx
		jz	short loc_40493C
		mov	ecx, 20h
		sub	ecx, ebx
		shr	dword ptr [edx-4], cl

loc_40493C:				; CODE XREF: sub_4048E0+50j
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_404942:				; CODE XREF: sub_4048E0+16j
		mov	[esp+1Ch+var_1C], eax
		call	sub_406C90
		mov	[esp+1Ch+var_1C], esi
		call	sub_406D00
		jmp	short loc_4048F8
sub_4048E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404960	proc near		; CODE XREF: sub_4049F0+223p
					; sub_4049F0+328p ...

Dst		= dword	ptr -1Ch
Src		= dword	ptr -18h
Size		= dword	ptr -14h
arg_0		= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, [esp+1Ch+arg_0]
		mov	esi, [ebx+10h]
		lea	eax, [ebx+14h]
		lea	ecx, [ebx+esi*4+14h]

loc_404973:				; CODE XREF: sub_404960+25j
		mov	edx, [eax]
		cmp	edx, 0FFFFFFFFh
		jnz	short loc_4049A4
		mov	dword ptr [eax], 0
		add	eax, 4
		cmp	ecx, eax
		ja	short loc_404973
		cmp	esi, [ebx+8]
		mov	eax, esi
		jge	short loc_4049B1

loc_40498E:				; CODE XREF: sub_404960+8Ej
		mov	dword ptr [ebx+eax*4+14h], 1
		add	eax, 1
		mov	[ebx+10h], eax
		mov	eax, ebx
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4049A4:				; CODE XREF: sub_404960+18j
		add	edx, 1
		mov	[eax], edx
		mov	eax, ebx
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4049B1:				; CODE XREF: sub_404960+2Cj
		mov	eax, [ebx+4]
		add	eax, 1
		mov	[esp+1Ch+Dst], eax
		call	sub_406D00
		mov	edx, [ebx+10h]
		lea	ecx, ds:8[edx*4]
		lea	edx, [ebx+0Ch]
		mov	esi, eax
		lea	eax, [eax+0Ch]
		mov	[esp+1Ch+Size],	ecx ; Size
		mov	[esp+1Ch+Src], edx ; Src
		mov	[esp+1Ch+Dst], eax ; Dst
		call	memcpy
		mov	[esp+1Ch+Dst], ebx
		mov	ebx, esi
		call	sub_406C90
		mov	eax, [esi+10h]
		jmp	short loc_40498E
sub_404960	endp


; =============== S U B	R O U T	I N E =======================================


sub_4049F0	proc near		; CODE XREF: sub_404D30+779p
					; sub_404D30+14C3p

var_4C		= qword	ptr -4Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 4Ch
		mov	[esp+4Ch+var_8], edi
		mov	edi, edx
		lea	edx, [esp+4Ch+var_20]
		mov	[esp+4Ch+var_40], edx ;	int
		lea	edx, [esp+4Ch+var_24]
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	esi, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+var_44], edx ;	int
		mov	[esp+4Ch+var_30], ecx
		fld	qword ptr [eax]
		fstp	[esp+4Ch+var_4C] ; double
		call	sub_406DD0
		mov	ebp, [edi]
		mov	edx, [esp+4Ch+var_24]
		mov	ebx, eax
		mov	eax, [esp+4Ch+var_20]
		sub	eax, ebp
		add	edx, eax
		test	eax, eax
		mov	[esp+4Ch+var_20], eax
		mov	[esp+4Ch+var_24], edx
		jle	loc_404BB2
		cmp	ebp, 35h
		jz	short loc_404A80
		cmp	esi, 1
		jz	short loc_404A96
		cmp	esi, 2
		mov	edx, 1
		jz	short loc_404A98
		mov	edx, eax
		sub	edx, 1
		jnz	loc_404BF3
		mov	edx, [esp+4Ch+arg_4]
		test	edx, edx
		jz	loc_404B20
		mov	edx, [ebx+14h]
		shr	edx, 1
		and	edx, 1
		jmp	short loc_404A98
; ---------------------------------------------------------------------------
		align 10h

loc_404A80:				; CODE XREF: sub_4049F0+5Aj
		mov	ecx, [esp+4Ch+arg_4]
		test	ecx, ecx
		jz	loc_404B20
		cmp	dword ptr [edi+0Ch], 1
		jnz	loc_404B20

loc_404A96:				; CODE XREF: sub_4049F0+5Fj
		xor	edx, edx

loc_404A98:				; CODE XREF: sub_4049F0+69j
					; sub_4049F0+8Aj ...
		mov	[esp+4Ch+var_3C], edx
		mov	dword ptr [esp+4Ch+var_4C+4], eax
		mov	dword ptr [esp+4Ch+var_4C], ebx
		call	sub_407650
		mov	dword ptr [esp+4Ch+var_4C], ebx
		cmp	eax, 1
		mov	[esp+4Ch+var_34], eax
		mov	eax, [esp+4Ch+var_20]
		sbb	esi, esi
		not	esi
		and	esi, 10h
		mov	dword ptr [esp+4Ch+var_4C+4], eax
		call	sub_4079C0
		mov	edx, [esp+4Ch+var_3C]
		test	edx, edx
		jnz	loc_404C10
		mov	edx, [esp+4Ch+var_24]

loc_404AD6:				; CODE XREF: sub_4049F0+1DAj
					; sub_4049F0+1FEj ...
		mov	eax, [edi+4]
		cmp	edx, eax
		jge	loc_404B80
		mov	ecx, eax
		sub	ecx, edx
		cmp	ebp, ecx
		mov	edx, ecx
		mov	[esp+4Ch+var_24], eax
		jl	short loc_404B24
		mov	ecx, [edi+10h]
		test	ecx, ecx
		jnz	short loc_404B24
		mov	eax, [esp+4Ch+var_34]
		lea	edi, [edx-1]
		test	eax, eax
		setz	al
		test	edi, edi
		jg	loc_404CD4

loc_404B0A:				; CODE XREF: sub_4049F0+305j
		test	al, al
		jz	loc_404C74
		mov	ecx, [esp+4Ch+arg_4]
		test	ecx, ecx
		jnz	loc_404C74
		xchg	ax, ax

loc_404B20:				; CODE XREF: sub_4049F0+7Cj
					; sub_4049F0+96j ...
		xor	esi, esi
		jmp	short loc_404B60
; ---------------------------------------------------------------------------

loc_404B24:				; CODE XREF: sub_4049F0+FDj
					; sub_4049F0+104j
		mov	eax, [esp+4Ch+arg_C]
		xor	esi, esi
		mov	dword ptr [ebx+10h], 0
		mov	dword ptr [eax], 50h
		mov	edx, [esp+4Ch+var_24]

loc_404B3B:				; CODE XREF: sub_4049F0+195j
					; sub_4049F0+1C0j ...
		mov	ecx, [esp+4Ch+var_30]
		mov	eax, [esp+4Ch+arg_0]
		mov	[ecx], edx
		mov	dword ptr [esp+4Ch+var_4C], eax
		mov	[esp+4Ch+var_44], ebx
		mov	dword ptr [esp+4Ch+var_4C+4], ebp
		call	sub_4075E0
		mov	eax, [esp+4Ch+arg_C]
		or	[eax], esi
		mov	esi, 1

loc_404B60:				; CODE XREF: sub_4049F0+132j
		mov	dword ptr [esp+4Ch+var_4C], ebx
		call	sub_406C90
		mov	eax, esi
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_404B80:				; CODE XREF: sub_4049F0+EBj
		mov	eax, [edi+8]
		cmp	edx, eax
		jle	short loc_404B3B
		mov	edx, [esp+4Ch+arg_C]
		add	eax, 1
		xor	esi, esi
		mov	[esp+4Ch+var_24], eax
		mov	dword ptr [edx], 0A3h
		call	_errno
		mov	dword ptr [eax], 22h
		mov	dword ptr [ebx+10h], 0
		mov	edx, [esp+4Ch+var_24]
		jmp	short loc_404B3B
; ---------------------------------------------------------------------------

loc_404BB2:				; CODE XREF: sub_4049F0+51j
		mov	esi, [esp+4Ch+arg_4]
		test	esi, esi
		jz	loc_404B20
		xor	esi, esi
		test	eax, eax
		mov	[esp+4Ch+var_34], 0
		jz	loc_404AD6
		neg	eax
		xor	esi, esi
		mov	dword ptr [esp+4Ch+var_4C], ebx
		mov	dword ptr [esp+4Ch+var_4C+4], eax
		call	sub_407090
		mov	edx, [esp+4Ch+var_24]
		mov	[esp+4Ch+var_34], 0
		mov	ebx, eax
		jmp	loc_404AD6
; ---------------------------------------------------------------------------

loc_404BF3:				; CODE XREF: sub_4049F0+70j
		mov	ecx, edx
		mov	esi, edx
		sar	ecx, 5
		and	esi, 1Fh
		mov	edx, [ebx+ecx*4+14h]
		mov	ecx, esi
		shr	edx, cl
		and	edx, 1
		jmp	loc_404A98
; ---------------------------------------------------------------------------
		align 10h

loc_404C10:				; CODE XREF: sub_4049F0+DCj
		mov	dword ptr [esp+4Ch+var_4C], ebx
		call	sub_404960
		mov	edx, ebp
		and	edx, 1Fh
		mov	ebx, eax
		jz	short loc_404C2A
		mov	eax, 20h
		sub	eax, edx
		mov	edx, eax

loc_404C2A:				; CODE XREF: sub_4049F0+22Fj
		mov	eax, [ebx+10h]
		bsr	eax, [ebx+eax*4+10h]
		xor	eax, 1Fh
		cmp	edx, eax
		jz	loc_404CC6
		mov	esi, [esp+4Ch+var_34]
		test	esi, esi
		jnz	short loc_404C4F
		mov	eax, [ebx+14h]
		and	eax, 1
		mov	[esp+4Ch+var_34], eax

loc_404C4F:				; CODE XREF: sub_4049F0+253j
		mov	dword ptr [esp+4Ch+var_4C+4], 1
		mov	esi, 20h
		mov	dword ptr [esp+4Ch+var_4C], ebx
		call	sub_4079C0
		mov	edx, [esp+4Ch+var_24]
		add	edx, 1
		mov	[esp+4Ch+var_24], edx
		jmp	loc_404AD6
; ---------------------------------------------------------------------------

loc_404C74:				; CODE XREF: sub_4049F0+11Cj
					; sub_4049F0+128j ...
		mov	eax, edi
		mov	ecx, edi
		sar	eax, 5
		and	ecx, 1Fh
		mov	[esp+4Ch+var_38], 1
		shl	[esp+4Ch+var_38], cl
		mov	ecx, [ebx+eax*4+14h]
		and	[esp+4Ch+var_38], ecx
		mov	dword ptr [esp+4Ch+var_4C+4], edx
		mov	dword ptr [esp+4Ch+var_4C], ebx
		call	sub_4079C0
		mov	edx, [esp+4Ch+var_38]
		mov	eax, [esp+4Ch+arg_C]
		test	edx, edx
		mov	dword ptr [eax], 2
		jnz	short loc_404D10
		mov	eax, [esp+4Ch+var_34]
		test	eax, eax
		jz	short loc_404D00
		mov	edx, [esp+4Ch+var_24]
		mov	esi, 50h
		jmp	loc_404B3B
; ---------------------------------------------------------------------------

loc_404CC6:				; CODE XREF: sub_4049F0+247j
		mov	edx, [esp+4Ch+var_24]
		mov	esi, 20h
		jmp	loc_404AD6
; ---------------------------------------------------------------------------

loc_404CD4:				; CODE XREF: sub_4049F0+114j
		test	al, al
		jz	short loc_404C74
		mov	[esp+4Ch+var_3C], edx
		mov	dword ptr [esp+4Ch+var_4C+4], edi
		mov	dword ptr [esp+4Ch+var_4C], ebx
		call	sub_407650
		mov	edx, [esp+4Ch+var_3C]
		test	eax, eax
		mov	[esp+4Ch+var_34], eax
		setz	al
		jmp	loc_404B0A
; ---------------------------------------------------------------------------
		align 10h

loc_404D00:				; CODE XREF: sub_4049F0+2C6j
		mov	edx, [esp+4Ch+var_24]
		jmp	loc_404B3B
; ---------------------------------------------------------------------------
		align 10h

loc_404D10:				; CODE XREF: sub_4049F0+2BEj
		mov	dword ptr [esp+4Ch+var_4C], ebx
		mov	esi, 60h
		call	sub_404960
		mov	edx, [esp+4Ch+var_24]
		mov	ebx, eax
		jmp	loc_404B3B
sub_4049F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404D30	proc near		; CODE XREF: sub_404130+2Ap

Str		= dword	ptr -10Ch
Size		= dword	ptr -104h
var_100		= dword	ptr -100h
var_FC		= dword	ptr -0FCh
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= qword	ptr -0B4h
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= qword	ptr -84h
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
Src		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= qword	ptr -5Ch
var_54		= word ptr -54h
var_52		= word ptr -52h
var_44		= qword	ptr -44h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0FCh
		call	localeconv
		mov	eax, [eax]
		mov	[esp+10Ch+Str],	eax ; Str
		mov	[esp+10Ch+var_BC], eax
		call	strlen
		mov	edx, [esp+10Ch+arg_0]
		mov	[esp+10Ch+var_28], 0
		mov	[esp+10Ch+var_38], 0
		mov	[esp+10Ch+var_34], edx
		mov	ecx, edx
		mov	dword ptr [esp+10Ch+var_B4], eax
		mov	eax, [esp+10Ch+arg_8]
		fldz
		fstp	[esp+10Ch+var_44]
		mov	eax, [eax]
		mov	[esp+10Ch+var_A4], eax

loc_404D8D:				; CODE XREF: sub_404D30+1CAj
		movzx	eax, byte ptr [ecx]
		cmp	al, 2Dh		; switch 46 cases
		jbe	loc_404E22

loc_404D98:				; CODE XREF: sub_404D30+F5j
					; DATA XREF: .rdata:off_40A96Co
		mov	[esp+10Ch+var_98], 0 ; jumptable 00404E25 default case

loc_404DA0:				; CODE XREF: sub_404D30+117j
		cmp	al, 30h
		mov	[esp+10Ch+var_C0], 0
		jz	loc_405050

loc_404DB0:				; CODE XREF: sub_404D30+351j
		mov	edx, [esp+10Ch+arg_8]
		movsx	esi, al
		cmp	esi, 2Fh
		mov	edx, [edx+10h]
		mov	[esp+10Ch+var_68], edx
		jle	loc_4062ED
		cmp	esi, 39h
		jg	loc_4062ED
		mov	[esp+10Ch+var_C4], ecx
		xor	ebp, ebp
		xor	ebx, ebx
		xor	edx, edx
		mov	eax, ecx
		jmp	short loc_404E0D
; ---------------------------------------------------------------------------

loc_404DE4:				; CODE XREF: sub_404D30+E0j
		lea	ebx, [ebx+ebx*4]
		lea	ebx, [esi+ebx*2-30h]

loc_404DEB:				; CODE XREF: sub_404D30+E5j
					; sub_404D30+F0j
		add	eax, 1
		add	edx, 1
		mov	[esp+10Ch+var_34], eax
		movsx	esi, byte ptr [eax]
		cmp	esi, 2Fh
		jle	loc_404F00
		cmp	esi, 39h
		jg	loc_404F00

loc_404E0D:				; CODE XREF: sub_404D30+B2j
		cmp	edx, 8
		jle	short loc_404DE4
		cmp	edx, 0Fh
		jg	short loc_404DEB
		lea	edi, [ebp+ebp*4+0]
		lea	ebp, [esi+edi*2-30h]
		nop
		jmp	short loc_404DEB
; ---------------------------------------------------------------------------

loc_404E22:				; CODE XREF: sub_404D30+62j
		movzx	edx, al
		jmp	ds:off_40A96C[edx*4] ; switch jump
; ---------------------------------------------------------------------------
		align 10h

loc_404E30:				; CODE XREF: sub_404D30+F5j
					; DATA XREF: .rdata:off_40A96Co
		mov	[esp+10Ch+var_98], 1 ; jumptable 00404E25 case 45

loc_404E38:				; CODE XREF: sub_404D30+1BAj
		add	ecx, 1
		mov	[esp+10Ch+var_34], ecx
		movzx	eax, byte ptr [ecx]
		test	al, al
		jnz	loc_404DA0

loc_404E4D:				; CODE XREF: sub_404D30+F5j
					; DATA XREF: .rdata:off_40A96Co
		mov	ecx, [esp+10Ch+arg_0] ;	jumptable 00404E25 case	0
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+var_28], 6
		mov	[esp+10Ch+var_98], 0
		mov	[esp+10Ch+var_34], ecx

loc_404E75:				; CODE XREF: sub_404D30+35Ej
					; sub_404D30+456j ...
		mov	ebp, [esp+10Ch+arg_4]
		test	ebp, ebp
		jz	short loc_404E90
		mov	edx, [esp+10Ch+var_34]
		mov	ecx, [esp+10Ch+arg_4]
		mov	[ecx], edx

loc_404E90:				; CODE XREF: sub_404D30+14Ej
		mov	edi, [esp+10Ch+var_98]
		test	edi, edi
		jnz	short loc_404ED8

loc_404E98:				; CODE XREF: sub_404D30+1B0j
		test	eax, eax
		jz	short loc_404EC6
		mov	esi, [esp+10Ch+var_A4]
		mov	edi, [esp+10Ch+arg_10]
		mov	[esp+10Ch+Size], eax
		mov	[esp+10Ch+Str+4], esi
		mov	[esp+10Ch+Str],	edi
		call	sub_4075E0
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+Str],	eax
		call	sub_406C90

loc_404EC6:				; CODE XREF: sub_404D30+16Aj
		mov	eax, [esp+10Ch+var_28]
		add	esp, 0FCh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_404ED8:				; CODE XREF: sub_404D30+166j
		or	[esp+10Ch+var_28], 8
		jmp	short loc_404E98
; ---------------------------------------------------------------------------

loc_404EE2:				; CODE XREF: sub_404D30+F5j
					; DATA XREF: .rdata:off_40A96Co
		mov	[esp+10Ch+var_98], 0 ; jumptable 00404E25 case 43
		jmp	loc_404E38
; ---------------------------------------------------------------------------
		align 10h

loc_404EF0:				; CODE XREF: sub_404D30+F5j
					; DATA XREF: .rdata:off_40A96Co
		add	ecx, 1		; jumptable 00404E25 cases 9-13,32
		mov	[esp+10Ch+var_34], ecx
		jmp	loc_404D8D
; ---------------------------------------------------------------------------
		align 10h

loc_404F00:				; CODE XREF: sub_404D30+CEj
					; sub_404D30+D7j
		mov	[esp+10Ch+var_C4], eax

loc_404F04:				; CODE XREF: sub_404D30+15C7j
		mov	eax, [esp+10Ch+var_BC]
		movsx	edi, byte ptr [eax]
		cmp	edi, esi
		jz	loc_4054C0
		mov	edi, esi
		xor	esi, esi
		mov	[esp+10Ch+var_B8], ecx
		mov	[esp+10Ch+var_BC], edx
		mov	[esp+10Ch+var_A8], 0
		mov	[esp+10Ch+var_A0], 0

loc_404F2F:				; CODE XREF: sub_404D30+82Cj
					; sub_404D30+127Ej ...
		cmp	edi, 45h
		jz	short loc_404F3D
		cmp	edi, 65h
		jnz	loc_405093

loc_404F3D:				; CODE XREF: sub_404D30+202j
		mov	edi, [esp+10Ch+var_BC]
		test	edi, edi
		jnz	short loc_404F4D
		test	esi, esi
		jz	loc_405FC8

loc_404F4D:				; CODE XREF: sub_404D30+213j
					; sub_404D30+129Ej
		mov	eax, [esp+10Ch+var_34]
		mov	[esp+10Ch+arg_0], eax
		mov	edi, [esp+10Ch+arg_0]
		add	eax, 1
		mov	[esp+10Ch+var_34], eax
		movzx	ecx, byte ptr [edi+1]
		cmp	cl, 2Bh
		jz	loc_406403
		cmp	cl, 2Dh
		movsx	edi, cl
		mov	[esp+10Ch+var_9C], 0
		jz	loc_406177

loc_404F8D:				; CODE XREF: sub_404D30+145Dj
		lea	eax, [edi-30h]
		cmp	eax, 9
		ja	loc_405FB3
		cmp	edi, 30h
		jnz	short loc_404FB7
		mov	eax, [esp+10Ch+var_34]

loc_404FA5:				; CODE XREF: sub_404D30+285j
		add	eax, 1
		mov	[esp+10Ch+var_34], eax
		movsx	edi, byte ptr [eax]
		cmp	edi, 30h
		jz	short loc_404FA5

loc_404FB7:				; CODE XREF: sub_404D30+26Cj
		lea	eax, [edi-31h]
		cmp	eax, 8
		ja	loc_405093
		mov	eax, [esp+10Ch+var_34]
		sub	edi, 30h
		mov	[esp+10Ch+var_C4], edi
		mov	[esp+10Ch+var_94], eax
		mov	ecx, [esp+10Ch+var_94]
		add	eax, 1
		mov	[esp+10Ch+var_34], eax
		movsx	edi, byte ptr [ecx+1]
		cmp	edi, 2Fh
		jle	short loc_40502A
		cmp	edi, 39h
		jg	short loc_40502A
		mov	eax, ecx
		mov	ecx, [esp+10Ch+var_C4]
		add	eax, 2
		mov	[esp+10Ch+var_90], edx
		jmp	short loc_405008
; ---------------------------------------------------------------------------

loc_405000:				; CODE XREF: sub_404D30+2EEj
		add	eax, 1
		cmp	edi, 39h
		jg	short loc_405020

loc_405008:				; CODE XREF: sub_404D30+2CEj
		lea	edx, [ecx+ecx*4]
		lea	ecx, [edi+edx*2-30h]
		mov	edx, eax
		mov	[esp+10Ch+var_34], eax
		movsx	edi, byte ptr [eax]
		cmp	edi, 2Fh
		jg	short loc_405000

loc_405020:				; CODE XREF: sub_404D30+2D6j
		mov	eax, edx
		mov	edx, [esp+10Ch+var_90]
		mov	[esp+10Ch+var_C4], ecx

loc_40502A:				; CODE XREF: sub_404D30+2BAj
					; sub_404D30+2BFj
		sub	eax, [esp+10Ch+var_94]
		cmp	eax, 8
		jg	short loc_40503F
		mov	ecx, [esp+10Ch+var_C4]
		cmp	ecx, 4E1Fh
		jle	short loc_405044

loc_40503F:				; CODE XREF: sub_404D30+301j
		mov	ecx, 4E1Fh

loc_405044:				; CODE XREF: sub_404D30+30Dj
		mov	eax, [esp+10Ch+var_9C]
		test	eax, eax
		jz	short loc_405095
		neg	ecx
		jmp	short loc_405095
; ---------------------------------------------------------------------------

loc_405050:				; CODE XREF: sub_404D30+7Aj
		movzx	eax, byte ptr [ecx+1]
		cmp	al, 58h
		jz	loc_406270
		cmp	al, 78h
		xchg	ax, ax
		jz	loc_406270

loc_405066:				; CODE XREF: sub_404D30+345j
		add	ecx, 1
		mov	[esp+10Ch+var_34], ecx
		movzx	eax, byte ptr [ecx]
		cmp	al, 30h
		jz	short loc_405066
		test	al, al
		mov	[esp+10Ch+var_C0], 1
		jnz	loc_404DB0

loc_405087:				; CODE XREF: sub_404D30+373j
					; sub_404D30+37Bj ...
		mov	eax, [esp+10Ch+var_38]
		jmp	loc_404E75
; ---------------------------------------------------------------------------

loc_405093:				; CODE XREF: sub_404D30+207j
					; sub_404D30+28Dj
		xor	ecx, ecx

loc_405095:				; CODE XREF: sub_404D30+31Aj
					; sub_404D30+31Ej ...
		mov	eax, [esp+10Ch+var_BC]
		test	eax, eax
		jnz	loc_4051D0
		test	esi, esi
		jnz	short loc_405087
		mov	ebx, [esp+10Ch+var_C0]
		test	ebx, ebx
		jnz	short loc_405087
		mov	ecx, [esp+10Ch+var_A0]
		test	ecx, ecx
		jnz	loc_4051A6
		cmp	edi, 4Eh
		jz	loc_40658D
		jg	loc_40657B
		cmp	edi, 49h
		nop
		lea	esi, [esi+0]
		jnz	loc_4051A6

loc_4050D6:				; CODE XREF: sub_404D30+184Ej
		lea	ebx, [esp+10Ch+var_34]
		mov	[esp+10Ch+Str+4], offset byte_40A960
		mov	[esp+10Ch+Str],	ebx
		call	sub_407590
		test	eax, eax
		jz	loc_4051A6
		sub	[esp+10Ch+var_34], 1
		mov	[esp+10Ch+Str+4], offset aInity	; "inity"
		mov	[esp+10Ch+Str],	ebx
		call	sub_407590
		test	eax, eax
		jnz	short loc_405119
		add	[esp+10Ch+var_34], 1

loc_405119:				; CODE XREF: sub_404D30+3DFj
		mov	edx, [esp+10Ch+arg_8]
		mov	[esp+10Ch+var_28], 3
		mov	[esp+10Ch+var_A0], 0
		mov	eax, [edx+8]

loc_405136:				; CODE XREF: sub_404D30+1536j
					; sub_404D30+18AFj ...
		mov	ebp, [esp+10Ch+arg_C]
		add	eax, 1
		mov	[ebp+0], eax

loc_405143:				; CODE XREF: sub_404D30+EADj
					; sub_404D30+F36j ...
		mov	ecx, [esp+10Ch+var_A0]
		test	ecx, ecx
		jz	loc_405087
		mov	eax, [esp+10Ch+var_38]

loc_405156:				; CODE XREF: sub_404D30+6D1j
		mov	edx, [esp+10Ch+var_68]
		test	edx, edx
		jnz	loc_406207
		mov	ecx, [esp+10Ch+var_28]
		xor	edx, edx
		and	ecx, 0FFFFFFF8h
		cmp	dword ptr [eax+10h], 0
		setnle	dl
		add	edx, edx
		or	edx, ecx
		test	dl, 30h
		mov	[esp+10Ch+var_28], edx
		jz	loc_404E75
		or	edx, 40h
		mov	[esp+10Ch+var_28], edx
		call	_errno
		mov	dword ptr [eax], 22h
		jmp	loc_405087
; ---------------------------------------------------------------------------

loc_4051A6:				; CODE XREF: sub_404D30+383j
					; sub_404D30+3A0j ...
		mov	eax, [esp+10Ch+arg_0]
		mov	[esp+10Ch+var_28], 6
		mov	[esp+10Ch+var_34], eax
		mov	eax, [esp+10Ch+var_38]
		jmp	loc_404E75
; ---------------------------------------------------------------------------
		align 10h

loc_4051D0:				; CODE XREF: sub_404D30+36Bj
		sub	ecx, [esp+10Ch+var_A8]
		mov	[esp+10Ch+var_28], 1
		mov	[esp+10Ch+var_C4], ecx
		mov	ecx, [esp+10Ch+arg_8]
		mov	eax, [ecx+0Ch]
		and	eax, 3
		cmp	eax, 2
		jz	loc_4062FC
		cmp	eax, 3
		jz	loc_4062DA
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[esp+10Ch+var_64], eax

loc_405211:				; CODE XREF: sub_404D30+15B8j
					; sub_404D30+15D9j
		test	edx, edx
		mov	[esp+10Ch+var_C0], edx
		jnz	short loc_405221
		mov	eax, [esp+10Ch+var_BC]
		mov	[esp+10Ch+var_C0], eax

loc_405221:				; CODE XREF: sub_404D30+4E7j
		mov	esi, [esp+10Ch+var_BC]
		cmp	esi, 10h
		jle	short loc_40522F
		mov	esi, 10h

loc_40522F:				; CODE XREF: sub_404D30+4F8j
		xor	edx, edx
		cmp	esi, 9
		mov	dword ptr [esp+10Ch+var_5C], ebx
		mov	dword ptr [esp+10Ch+var_5C+4], edx
		fild	[esp+10Ch+var_5C]
		fst	[esp+10Ch+var_44]
		jle	short loc_405280
		fmul	ds:dbl_40AAF8[esi*8]
		xor	edx, edx
		mov	dword ptr [esp+10Ch+var_5C], ebp
		mov	dword ptr [esp+10Ch+var_5C+4], edx
		fild	[esp+10Ch+var_5C]
		faddp	st(1), st
		fstp	[esp+10Ch+var_44]
		jmp	short loc_405282
; ---------------------------------------------------------------------------
		align 10h

loc_405280:				; CODE XREF: sub_404D30+520j
		fstp	st

loc_405282:				; CODE XREF: sub_404D30+549j
		cmp	[esp+10Ch+var_BC], 0Fh
		jg	short loc_405294
		cmp	[esp+10Ch+var_A4], 35h
		jle	loc_405406

loc_405294:				; CODE XREF: sub_404D30+557j
					; sub_404D30+1467j ...
		mov	eax, [esp+10Ch+var_C4]

loc_405298:				; CODE XREF: sub_404D30+788j
					; sub_404D30+14D2j
		mov	edx, [esp+10Ch+var_BC]
		sub	edx, esi
		lea	eax, [edx+eax]
		cmp	eax, 0
		jle	loc_40630E
		mov	edx, eax
		and	edx, 0Fh
		jz	short loc_4052C6
		fld	[esp+10Ch+var_44]
		fmul	ds:dbl_40AB40[edx*8]
		fstp	[esp+10Ch+var_44]

loc_4052C6:				; CODE XREF: sub_404D30+57Fj
		and	eax, 0FFFFFFF0h
		jnz	loc_406000

loc_4052CF:				; CODE XREF: sub_404D30:loc_40630Ej
					; sub_404D30+1607j
		fld	[esp+10Ch+var_44]
		xor	esi, esi

loc_4052D8:				; CODE XREF: sub_404D30+1399j
					; sub_404D30+1B42j
		lea	eax, [esp+10Ch+var_2C]
		mov	[esp+10Ch+var_100], eax	; int
		lea	eax, [esp+10Ch+var_30]
		mov	[esp+10Ch+Size], eax ; int
		fstp	qword ptr [esp+10Ch+Str] ; double
		call	sub_406DD0
		mov	edx, [esp+10Ch+var_30]
		mov	ecx, [esp+10Ch+var_2C]
		add	edx, esi
		mov	esi, ecx
		sub	esi, [esp+10Ch+var_A4]
		mov	[esp+10Ch+var_38], eax
		mov	[esp+10Ch+var_30], edx
		test	esi, esi
		jle	short loc_405347
		mov	[esp+10Ch+Str+4], esi
		mov	[esp+10Ch+Str],	eax
		call	sub_4079C0
		mov	edx, [esp+10Ch+var_30]
		mov	ebp, [esp+10Ch+var_A4]
		add	edx, esi
		mov	[esp+10Ch+var_2C], ebp
		mov	ecx, ebp
		mov	[esp+10Ch+var_30], edx

loc_405347:				; CODE XREF: sub_404D30+5ECj
		mov	edi, [esp+10Ch+arg_8]
		lea	esi, [ecx+edx]
		sub	esi, [esp+10Ch+var_A4]
		mov	eax, [edi+8]
		add	eax, 1
		cmp	esi, eax
		jg	loc_406230
		mov	ebp, [edi+4]
		mov	[esp+10Ch+var_60], esi
		mov	[esp+10Ch+var_A0], 0
		cmp	esi, ebp
		mov	[esp+10Ch+var_9C], ebp
		jge	loc_4055D7
		mov	edi, edx
		sub	edi, ebp
		cmp	edi, 0
		jle	loc_406145
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+Str+4], edi
		mov	[esp+10Ch+Str],	eax
		call	sub_407090
		add	[esp+10Ch+var_2C], edi
		mov	[esp+10Ch+var_38], eax

loc_4053AF:				; CODE XREF: sub_404D30:loc_406145j
					; sub_404D30+1442j ...
		mov	edx, [esp+10Ch+var_68]
		mov	edi, [esp+10Ch+var_9C]
		test	edx, edx
		mov	[esp+10Ch+var_30], edi
		jz	loc_4055C4
		add	esi, 1
		cmp	edi, esi
		jle	loc_4055C4

loc_4053D4:				; CODE XREF: sub_404D30+1B66j
		mov	eax, [esp+10Ch+var_38]
		mov	ecx, [esp+10Ch+var_9C]
		mov	edx, [esp+10Ch+arg_C]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	[esp+10Ch+var_28], 50h
		mov	[edx], ecx
		jmp	loc_405156
; ---------------------------------------------------------------------------

loc_405406:				; CODE XREF: sub_404D30+55Ej
		cmp	[esp+10Ch+var_C4], 0
		jz	loc_40644D
		jle	loc_406192
		cmp	[esp+10Ch+var_C4], 16h
		lea	esi, [esi+0]
		jg	loc_406481
		mov	eax, dword ptr [esp+10Ch+var_44]
		mov	edi, [esp+10Ch+var_C4]
		test	eax, eax
		mov	ecx, ds:dword_40AA40[edi*4]
		jz	loc_4066D3
		bsf	edx, eax
		mov	eax, 35h
		sub	eax, edx

loc_40544A:				; CODE XREF: sub_404D30+19B9j
		mov	ebp, [esp+10Ch+var_C4]
		lea	edx, [esp+10Ch+var_28]
		add	eax, ecx
		mov	[esp+10Ch+var_100], edx
		mov	ecx, [esp+10Ch+arg_10]
		cmp	eax, 35h
		mov	edx, [esp+10Ch+var_64]
		setle	al
		fld	[esp+10Ch+var_44]
		movzx	eax, al
		fmul	ds:dbl_40AB40[ebp*8]
		mov	[esp+10Ch+Str],	ecx
		mov	ecx, [esp+10Ch+arg_C]
		mov	[esp+10Ch+Size], edx
		mov	edx, [esp+10Ch+arg_8]
		lea	edi, [esp+10Ch+var_44]
		mov	[esp+10Ch+Str+4], eax
		mov	eax, edi
		fstp	[esp+10Ch+var_44]
		call	sub_4049F0
		test	eax, eax
		jnz	loc_405087
		xor	eax, eax
		jmp	loc_405298
; ---------------------------------------------------------------------------
		align 10h

loc_4054C0:				; CODE XREF: sub_404D30+1DDj
		movzx	eax, byte ptr [eax+1]
		mov	esi, 1
		test	al, al
		mov	byte ptr [esp+10Ch+var_A8], al
		jz	short loc_405520
		mov	esi, [esp+10Ch+var_C4]
		mov	[esp+10Ch+var_9C], 1
		cmp	al, [esi+1]
		jnz	loc_405F94
		mov	[esp+10Ch+var_A8], ecx
		mov	eax, [esp+10Ch+var_C4]
		mov	[esp+10Ch+var_A0], edi
		mov	ecx, [esp+10Ch+var_BC]
		mov	[esp+10Ch+var_B8], edx
		mov	esi, [esp+10Ch+var_9C]
		jmp	short loc_405509
; ---------------------------------------------------------------------------

loc_405500:				; CODE XREF: sub_404D30+7E2j
		cmp	dl, [eax+esi]
		jnz	loc_405F88

loc_405509:				; CODE XREF: sub_404D30+7CEj
		add	esi, 1
		movzx	edx, byte ptr [ecx+esi]
		test	dl, dl
		jnz	short loc_405500
		mov	ecx, [esp+10Ch+var_A8]
		mov	edx, [esp+10Ch+var_B8]
		mov	[esp+10Ch+var_C4], eax

loc_405520:				; CODE XREF: sub_404D30+79Fj
		mov	eax, [esp+10Ch+var_C4]
		add	eax, esi
		test	edx, edx
		mov	[esp+10Ch+var_34], eax
		movsx	edi, byte ptr [eax]
		jz	loc_4060F8
		mov	[esp+10Ch+var_B8], ecx
		xor	esi, esi
		mov	[esp+10Ch+var_BC], edx
		mov	[esp+10Ch+var_A8], 0

loc_40554A:				; CODE XREF: sub_404D30+1846j
		lea	ecx, [edi-30h]
		cmp	ecx, 9
		mov	[esp+10Ch+var_9C], ecx
		mov	[esp+10Ch+var_A0], 1
		ja	loc_404F2F
		mov	edi, [esp+10Ch+var_34]
		add	esi, 1
		mov	ecx, [esp+10Ch+var_BC]
		mov	[esp+10Ch+var_A0], edi

loc_405574:				; CODE XREF: sub_404D30+181Bj
		mov	eax, [esp+10Ch+var_9C]
		mov	[esp+10Ch+var_BC], ecx
		test	eax, eax
		jz	loc_406560
		add	[esp+10Ch+var_A8], esi
		cmp	esi, 1
		jz	loc_4067EF
		lea	edi, [ecx+1]
		mov	[esp+10Ch+var_BC], edi
		mov	eax, edi
		lea	edi, [ecx+esi]
		jmp	short loc_4055AF
; ---------------------------------------------------------------------------

loc_40559F:				; CODE XREF: sub_404D30+885j
		lea	ebx, [ebx+ebx*4]
		add	ebx, ebx

loc_4055A4:				; CODE XREF: sub_404D30+88Aj
					; sub_404D30+892j
		add	eax, 1
		cmp	eax, edi
		jz	loc_4067E7

loc_4055AF:				; CODE XREF: sub_404D30+86Dj
		lea	ecx, [eax-1]
		cmp	ecx, 8
		jle	short loc_40559F
		cmp	eax, 10h
		jg	short loc_4055A4
		lea	ebp, [ebp+ebp*4+0]
		add	ebp, ebp
		jmp	short loc_4055A4
; ---------------------------------------------------------------------------

loc_4055C4:				; CODE XREF: sub_404D30+693j
					; sub_404D30+69Ej
		mov	ebp, [esp+10Ch+var_9C]
		mov	[esp+10Ch+var_A0], 1
		mov	[esp+10Ch+var_60], ebp

loc_4055D7:				; CODE XREF: sub_404D30+64Bj
		mov	eax, dword ptr [esp+10Ch+var_B4]
		mov	edx, [esp+10Ch+var_BC]
		mov	ecx, [esp+10Ch+var_C0]
		mov	esi, [esp+10Ch+var_B8]
		mov	[esp+10Ch+var_FC], eax
		mov	[esp+10Ch+var_100], ebx
		mov	[esp+10Ch+Size], edx
		mov	[esp+10Ch+Str+4], ecx
		mov	[esp+10Ch+Str],	esi
		call	sub_407750
		mov	edi, [esp+10Ch+var_A4]
		mov	ebp, [esp+10Ch+var_C4]
		mov	[esp+10Ch+var_A8], 0
		add	edi, 1
		neg	ebp
		mov	[esp+10Ch+var_94], eax
		add	eax, 0Ch
		mov	[esp+10Ch+Src],	eax
		mov	eax, [esp+10Ch+var_64]
		mov	[esp+10Ch+var_74], edi
		mov	[esp+10Ch+var_90], ebp
		and	eax, 1
		mov	[esp+10Ch+var_6C], eax
		jmp	loc_40585C
; ---------------------------------------------------------------------------

loc_405643:				; CODE XREF: sub_404D30+D22j
		mov	edx, [esp+10Ch+var_64]
		test	edx, edx
		jz	loc_405A58
		mov	edx, [esp+10Ch+var_6C]
		xor	edx, ebp
		mov	[esp+10Ch+var_88], edx
		jz	loc_406615
		test	ebp, ebp
		jz	loc_405CE0
		mov	[esp+10Ch+var_28], 21h
		mov	[esp+10Ch+var_8C], 20h
		mov	[esp+10Ch+var_C0], 0

loc_40568E:				; CODE XREF: sub_404D30+D8Bj
					; sub_404D30+121Ej
		fld1
		fst	[esp+10Ch+var_B4]
		mov	[esp+10Ch+var_A8], 0
		fstp	[esp+10Ch+var_84]

loc_4056A3:				; CODE XREF: sub_404D30+10CFj
					; sub_404D30+11F6j
		mov	ebp, [esp+10Ch+var_A0]
		mov	eax, [esp+10Ch+var_30]
		mov	edx, [esp+10Ch+var_2C]
		test	ebp, ebp
		mov	[esp+10Ch+var_78], eax
		mov	[esp+10Ch+var_B8], edx
		jnz	short loc_4056CE
		cmp	[esp+10Ch+var_A4], edx
		jg	loc_405E40

loc_4056CE:				; CODE XREF: sub_404D30+992j
					; sub_404D30+1142j
		lea	eax, [esp+10Ch+var_20]
		fld	[esp+10Ch+var_B4]
		lea	ebp, [esp+10Ch+var_24]
		mov	[esp+10Ch+var_100], ebp	; int
		fstp	qword ptr [esp+10Ch+Str] ; double
		mov	[esp+10Ch+Size], eax ; int
		call	sub_406DD0
		mov	edx, eax
		mov	eax, [esp+10Ch+var_20]
		cmp	eax, 0
		jl	loc_405E77
		jz	short loc_405712
		mov	[esp+10Ch+Str],	edx
		mov	[esp+10Ch+Str+4], eax
		call	sub_407090
		mov	edx, eax

loc_405712:				; CODE XREF: sub_404D30+9D2j
					; sub_404D30+115Dj
		mov	ecx, [esp+10Ch+var_C0]
		mov	ebp, [esp+10Ch+var_38]
		test	ecx, ecx
		jz	loc_405AC0
		mov	[esp+10Ch+Str+4], edx
		mov	[esp+10Ch+var_CC], edx
		mov	[esp+10Ch+Str],	ebp
		call	sub_406EF0
		mov	edx, [esp+10Ch+var_A0]
		test	edx, edx
		mov	edx, [esp+10Ch+var_CC]
		mov	ecx, eax
		mov	[esp+10Ch+var_38], eax
		mov	eax, [ebp+10h]
		mov	[esp+10Ch+var_D0], eax
		jnz	short loc_4057A3
		sub	eax, 1
		cmp	eax, [ecx+10h]
		jge	short loc_405782
		mov	eax, [esp+10Ch+var_D0]
		add	eax, 3
		mov	[esp+10Ch+var_D0], eax
		bsr	eax, [ecx+eax*4+4]
		xor	eax, 1Fh
		mov	[esp+10Ch+var_C0], eax
		mov	eax, [esp+10Ch+var_D0]
		bsr	eax, [ebp+eax*4+4]
		xor	eax, 1Fh
		cmp	[esp+10Ch+var_C0], eax
		jle	short loc_4057A3

loc_405782:				; CODE XREF: sub_404D30+A27j
		mov	eax, [esp+10Ch+var_9C]
		cmp	[esp+10Ch+var_60], eax
		jnz	loc_405C87
		sub	[esp+10Ch+var_2C], 1
		mov	[esp+10Ch+var_A0], 1

loc_4057A3:				; CODE XREF: sub_404D30+A1Fj
					; sub_404D30+A50j ...
		mov	[esp+10Ch+Str],	edx
		call	sub_406C90
		mov	[esp+10Ch+Str],	ebp
		call	sub_406C90
		mov	ecx, [esp+10Ch+var_88]
		test	ecx, ecx
		jnz	loc_405B80
		mov	edx, [esp+10Ch+var_A8]
		test	edx, edx
		jz	short loc_405824
		mov	edx, [esp+10Ch+var_B8]
		mov	eax, [esp+10Ch+var_2C]
		add	edx, [esp+10Ch+var_78]
		add	eax, [esp+10Ch+var_30]
		cmp	edx, eax
		jnz	short loc_405824
		fld	[esp+10Ch+var_B4]
		fmul	ds:dbl_40AAB0
		fld	[esp+10Ch+var_84]
		fsub	ds:flt_40AAA4
		fld	st(1)
		fchs
		fucomp	st(1)
		fnstsw	ax
		sahf
		jbe	loc_405E04
		fstp	st
		fld	[esp+10Ch+var_84]
		fucompp
		fnstsw	ax
		sahf
		jbe	short loc_405824
		jmp	loc_405E29
; ---------------------------------------------------------------------------

loc_405822:				; CODE XREF: sub_404D30+10D9j
		fstp	st

loc_405824:				; CODE XREF: sub_404D30+A98j
					; sub_404D30+AB5j ...
		mov	eax, [esp+10Ch+var_A0]
		mov	[esp+10Ch+var_A8], 0
		test	eax, eax
		jz	loc_405CC6

loc_405838:				; CODE XREF: sub_404D30+FA9j
		mov	[esp+10Ch+Str],	esi
		call	sub_406C90
		mov	[esp+10Ch+Str],	edi
		call	sub_406C90
		mov	edx, [esp+10Ch+var_BC]
		mov	[esp+10Ch+Str],	edx
		call	sub_406C90
		mov	[esp+10Ch+Str],	ebx
		call	sub_406C90

loc_40585C:				; CODE XREF: sub_404D30+90Ej
		mov	edx, [esp+10Ch+var_94]
		mov	eax, [edx+4]
		mov	[esp+10Ch+Str],	eax
		call	sub_406D00
		mov	ecx, [esp+10Ch+var_94]
		mov	esi, [esp+10Ch+Src]
		mov	edx, [ecx+10h]
		mov	[esp+10Ch+Str+4], esi ;	Src
		mov	edi, eax
		lea	eax, [eax+0Ch]
		lea	edx, ds:8[edx*4]
		mov	[esp+10Ch+Size], edx ; Size
		mov	[esp+10Ch+Str],	eax ; Dst
		call	memcpy
		mov	eax, [esp+10Ch+var_38]
		mov	eax, [eax+4]
		mov	[esp+10Ch+Str],	eax
		call	sub_406D00
		mov	esi, eax
		mov	eax, [esp+10Ch+var_38]
		lea	edx, [esi+0Ch]
		mov	ecx, [eax+10h]
		add	eax, 0Ch
		mov	[esp+10Ch+Str],	edx ; Dst
		mov	[esp+10Ch+Str+4], eax ;	Src
		lea	ecx, ds:8[ecx*4]
		mov	[esp+10Ch+Size], ecx ; Size
		call	memcpy
		mov	eax, [esp+10Ch+var_A8]
		mov	ebp, [esp+10Ch+var_2C]
		mov	[esp+10Ch+Str],	1
		sub	ebp, eax
		mov	dword ptr [esp+10Ch+var_B4], ebp
		mov	ebp, [esp+10Ch+var_30]
		add	ebp, eax
		call	sub_4072F0
		mov	ebx, [esp+10Ch+var_C4]
		mov	edx, [esp+10Ch+var_C4]
		sar	ebx, 1Fh
		not	ebx
		mov	[esp+10Ch+var_BC], eax
		mov	eax, [esp+10Ch+var_90]
		sar	edx, 1Fh
		and	ebx, [esp+10Ch+var_C4]
		and	edx, eax
		test	ebp, ebp
		mov	ecx, ebx
		mov	eax, edx
		mov	[esp+10Ch+var_C0], edx
		js	loc_405C80
		add	eax, ebp

loc_405926:				; CODE XREF: sub_404D30+F52j
		mov	edx, [esp+10Ch+var_74]
		sub	edx, dword ptr [esp+10Ch+var_B4]
		add	ebp, dword ptr [esp+10Ch+var_B4]
		sub	ebp, [esp+10Ch+var_A4]
		cmp	[esp+10Ch+var_9C], ebp
		mov	[esp+10Ch+var_B8], edx
		jle	short loc_40594D
		sub	edx, [esp+10Ch+var_9C]
		add	edx, ebp
		mov	[esp+10Ch+var_B8], edx

loc_40594D:				; CODE XREF: sub_404D30+C11j
		mov	edx, [esp+10Ch+var_B8]
		mov	ebp, [esp+10Ch+var_B8]
		add	edx, eax
		add	ebp, ecx
		mov	ecx, edx
		cmp	edx, ebp
		jle	short loc_405961
		mov	ecx, ebp

loc_405961:				; CODE XREF: sub_404D30+C2Dj
		cmp	ecx, eax
		jle	short loc_405967
		mov	ecx, eax

loc_405967:				; CODE XREF: sub_404D30+C33j
		test	ecx, ecx
		mov	[esp+10Ch+var_B8], eax
		jle	short loc_405979
		sub	eax, ecx
		sub	edx, ecx
		sub	ebp, ecx
		mov	[esp+10Ch+var_B8], eax

loc_405979:				; CODE XREF: sub_404D30+C3Dj
		mov	eax, [esp+10Ch+var_C0]
		test	eax, eax
		jz	short loc_4059BF
		mov	ecx, [esp+10Ch+var_C0]
		mov	eax, [esp+10Ch+var_BC]
		mov	[esp+10Ch+var_CC], edx
		mov	[esp+10Ch+Str+4], ecx
		mov	[esp+10Ch+Str],	eax
		call	sub_407440
		mov	[esp+10Ch+Str+4], esi
		mov	[esp+10Ch+var_BC], eax
		mov	[esp+10Ch+Str],	eax
		call	sub_407190
		mov	[esp+10Ch+Str],	esi
		mov	[esp+10Ch+var_C8], eax
		call	sub_406C90
		mov	eax, [esp+10Ch+var_C8]
		mov	edx, [esp+10Ch+var_CC]
		mov	esi, eax

loc_4059BF:				; CODE XREF: sub_404D30+C4Fj
		sub	edx, [esp+10Ch+var_A8]
		cmp	edx, 0
		jle	loc_405B50
		mov	[esp+10Ch+Str],	esi
		mov	[esp+10Ch+Str+4], edx
		call	sub_407090
		mov	esi, eax

loc_4059DA:				; CODE XREF: sub_404D30:loc_405B50j
					; sub_404D30+E34j
		test	ebx, ebx
		jz	short loc_4059EC
		mov	[esp+10Ch+Str],	edi
		mov	[esp+10Ch+Str+4], ebx
		call	sub_407440
		mov	edi, eax

loc_4059EC:				; CODE XREF: sub_404D30+CACj
		test	ebp, ebp
		jle	short loc_4059FE
		mov	[esp+10Ch+Str],	edi
		mov	[esp+10Ch+Str+4], ebp
		call	sub_407090
		mov	edi, eax

loc_4059FE:				; CODE XREF: sub_404D30+CBEj
		mov	ebx, [esp+10Ch+var_B8]
		test	ebx, ebx
		jle	short loc_405A1E
		mov	edx, [esp+10Ch+var_B8]
		mov	ecx, [esp+10Ch+var_BC]
		mov	[esp+10Ch+Str+4], edx
		mov	[esp+10Ch+Str],	ecx
		call	sub_407090
		mov	[esp+10Ch+var_BC], eax

loc_405A1E:				; CODE XREF: sub_404D30+CD4j
		mov	[esp+10Ch+Str+4], edi
		mov	[esp+10Ch+Str],	esi
		call	sub_406EF0
		cmp	dword ptr [eax+10h], 1
		mov	ebx, eax
		jle	loc_405B70

loc_405A36:				; CODE XREF: sub_404D30+E45j
		mov	eax, [esp+10Ch+var_BC]
		mov	ebp, [ebx+0Ch]
		mov	dword ptr [ebx+0Ch], 0
		mov	[esp+10Ch+Str],	ebx
		mov	[esp+10Ch+Str+4], eax
		call	sub_4069D0
		test	eax, eax
		jle	loc_405643

loc_405A58:				; CODE XREF: sub_404D30+91Cj
		cmp	eax, 0
		jl	loc_40662C
		jz	loc_4066EE
		mov	edx, [esp+10Ch+var_BC]
		mov	[esp+10Ch+Str],	ebx
		mov	[esp+10Ch+Str+4], edx
		call	sub_4076C0
		fld	ds:flt_40AA9C
		fucomp	st(1)
		fnstsw	ax
		sahf
		jb	loc_405DA0
		fstp	st
		test	ebp, ebp
		jnz	loc_405F30
		mov	[esp+10Ch+var_88], 0

loc_405A9D:				; CODE XREF: sub_404D30+FC6j
					; sub_404D30+FEBj ...
		cmp	dword ptr [esp+10Ch+var_B4], 1
		jle	loc_40681F

loc_405AA8:				; CODE XREF: sub_404D30+1AF5j
		mov	[esp+10Ch+var_8C], 10h
		mov	[esp+10Ch+var_C0], 1
		jmp	loc_40568E
; ---------------------------------------------------------------------------

loc_405AC0:				; CODE XREF: sub_404D30+9EFj
		mov	[esp+10Ch+Str+4], edx
		mov	[esp+10Ch+var_CC], edx
		mov	[esp+10Ch+Str],	ebp
		call	sub_407830
		mov	edx, [esp+10Ch+var_CC]
		mov	ecx, [eax+10h]
		mov	[esp+10Ch+var_38], eax
		mov	[esp+10Ch+var_D0], ecx
		sub	ecx, 1
		cmp	ecx, [ebp+10h]
		jge	short loc_405B17
		mov	ecx, [esp+10Ch+var_D0]
		add	ecx, 3
		mov	[esp+10Ch+var_D0], ecx
		bsr	ecx, [eax+ecx*4+4]
		xor	ecx, 1Fh
		mov	[esp+10Ch+var_C0], ecx
		mov	ecx, [esp+10Ch+var_D0]
		bsr	ecx, [ebp+ecx*4+4]
		xor	ecx, 1Fh
		cmp	[esp+10Ch+var_C0], ecx
		jge	loc_4057A3

loc_405B17:				; CODE XREF: sub_404D30+DB8j
		mov	ecx, [esp+10Ch+var_A0]
		test	ecx, ecx
		jz	loc_405F53
		mov	eax, [esp+10Ch+var_2C]
		add	eax, 1
		cmp	[esp+10Ch+var_A4], eax
		mov	[esp+10Ch+var_2C], eax
		setz	al
		movzx	eax, al
		sub	eax, 1
		and	[esp+10Ch+var_A0], eax
		jmp	loc_4057A3
; ---------------------------------------------------------------------------
		align 10h

loc_405B50:				; CODE XREF: sub_404D30+C96j
		jz	loc_4059DA
		neg	edx
		mov	[esp+10Ch+Str+4], edx
		mov	[esp+10Ch+Str],	esi
		call	sub_4079C0
		jmp	loc_4059DA
; ---------------------------------------------------------------------------
		align 10h

loc_405B70:				; CODE XREF: sub_404D30+D00j
		mov	ecx, [eax+14h]
		test	ecx, ecx
		jnz	loc_405A36
		nop
		lea	esi, [esi+0]

loc_405B80:				; CODE XREF: sub_404D30+A8Cj
					; sub_404D30+1064j ...
		mov	ebp, [esp+10Ch+var_A0]
		test	ebp, ebp
		jz	loc_4060CE
		mov	eax, [esp+10Ch+var_30]

loc_405B93:				; CODE XREF: sub_404D30+13C3j
					; sub_404D30+17F5j
		mov	ecx, [esp+10Ch+arg_C]
		mov	[ecx], eax
		mov	[esp+10Ch+Str],	esi
		call	sub_406C90
		mov	[esp+10Ch+Str],	edi
		call	sub_406C90
		mov	esi, [esp+10Ch+var_BC]
		mov	[esp+10Ch+Str],	esi
		call	sub_406C90
		mov	edi, [esp+10Ch+var_94]
		mov	[esp+10Ch+Str],	edi
		call	sub_406C90
		mov	[esp+10Ch+Str],	ebx
		call	sub_406C90
		mov	ebp, [esp+10Ch+arg_8]
		mov	eax, [ebp+8]
		cmp	eax, [esp+10Ch+var_30]
		jge	loc_405143
		mov	eax, [ebp+0Ch]
		and	eax, 3
		cmp	eax, 2
		jz	loc_4067D6
		cmp	eax, 3
		jz	loc_4067C5
		cmp	eax, 1
		jz	loc_406238

loc_405C04:				; CODE XREF: sub_404D30+1AA1j
					; sub_404D30+1AB2j
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+Str],	eax
		call	sub_406C90
		mov	edx, [esp+10Ch+arg_8]
		mov	[esp+10Ch+var_28], 11h
		mov	ecx, [esp+10Ch+arg_C]
		mov	esi, [esp+10Ch+arg_10]
		mov	[esp+10Ch+var_38], 0
		mov	eax, [edx+8]
		mov	[ecx], eax
		mov	ecx, [edx]
		lea	eax, [ecx+1Fh]
		sar	eax, 5
		lea	eax, [esi+eax*4]
		cmp	esi, eax
		jnb	short loc_405C61
		mov	edx, esi

loc_405C54:				; CODE XREF: sub_404D30+F2Fj
		mov	dword ptr [edx], 0FFFFFFFFh
		add	edx, 4
		cmp	eax, edx
		ja	short loc_405C54

loc_405C61:				; CODE XREF: sub_404D30+F20j
		mov	edx, ecx
		and	edx, 1Fh
		jz	loc_405143
		mov	ecx, 20h
		sub	ecx, edx
		shr	dword ptr [eax-4], cl
		jmp	loc_405143
; ---------------------------------------------------------------------------
		align 10h

loc_405C80:				; CODE XREF: sub_404D30+BEEj
		sub	ecx, ebp
		jmp	loc_405926
; ---------------------------------------------------------------------------

loc_405C87:				; CODE XREF: sub_404D30+A5Dj
		mov	[esp+10Ch+Str],	ecx
		mov	[esp+10Ch+var_CC], edx
		mov	[esp+10Ch+Str+4], 1
		call	sub_407090
		mov	edx, [esp+10Ch+var_CC]
		sub	[esp+10Ch+var_30], 1
		sub	[esp+10Ch+var_60], 1
		mov	[esp+10Ch+Str],	edx
		mov	[esp+10Ch+var_38], eax
		call	sub_406C90
		mov	[esp+10Ch+Str],	ebp
		call	sub_406C90

loc_405CC6:				; CODE XREF: sub_404D30+B02j
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+Str],	eax
		call	sub_407AD0
		mov	[esp+10Ch+var_A8], eax
		jmp	loc_405838
; ---------------------------------------------------------------------------
		align 10h

loc_405CE0:				; CODE XREF: sub_404D30+93Aj
		mov	ecx, [esp+10Ch+var_9C]
		cmp	[esp+10Ch+var_60], ecx
		mov	[esp+10Ch+var_28], 11h
		jz	loc_405A9D
		cmp	[esp+10Ch+var_A4], 1Fh
		jle	loc_40680D
		mov	eax, [esp+10Ch+var_38]
		xor	ecx, ecx
		mov	edx, [esp+10Ch+var_A4]
		mov	ebp, [eax+14h]
		test	ebp, ebp
		jz	short loc_405D2C
		jmp	loc_405A9D
; ---------------------------------------------------------------------------

loc_405D20:				; CODE XREF: sub_404D30+1005j
		mov	ebp, [eax+ecx*4+14h]
		test	ebp, ebp
		jnz	loc_405A9D

loc_405D2C:				; CODE XREF: sub_404D30+FE9j
		sub	edx, 20h
		add	ecx, 1
		cmp	edx, 1Fh
		jg	short loc_405D20

loc_405D37:				; CODE XREF: sub_404D30+1AEAj
		cmp	edx, 1
		jle	short loc_405D65
		add	ecx, 4
		sub	edx, 1
		mov	ebp, [eax+ecx*4+4]
		mov	[esp+10Ch+var_B8], ecx
		bsf	ecx, ebp
		shr	ebp, cl
		mov	[esp+10Ch+var_C0], ecx
		mov	ecx, [esp+10Ch+var_B8]
		cmp	edx, [esp+10Ch+var_C0]
		mov	[eax+ecx*4+4], ebp
		jg	loc_405A9D

loc_405D65:				; CODE XREF: sub_404D30+100Aj
		mov	edx, [esp+10Ch+var_60]
		mov	ebp, [esp+10Ch+var_A4]
		mov	[esp+10Ch+Str],	eax
		sub	edx, 1
		mov	[esp+10Ch+var_30], edx
		mov	[esp+10Ch+var_2C], ebp
		mov	[esp+10Ch+Str+4], ebp
		call	sub_4048E0
		mov	[esp+10Ch+var_38], eax
		jmp	loc_405B80
; ---------------------------------------------------------------------------
		align 10h

loc_405DA0:				; CODE XREF: sub_404D30+D52j
		fld	ds:flt_40AAA4
		cmp	ebp, 1
		fmul	st(1), st
		fxch	st(1)
		sbb	ecx, ecx
		and	ecx, 10h
		add	ecx, 10h
		cmp	ebp, 1
		sbb	ebp, ebp
		and	ebp, 1
		fstp	[esp+10Ch+var_B4]
		fld	ds:dbl_40AAA8
		fld	[esp+10Ch+var_B4]
		fxch	st(1)
		fucomp	st(1)
		fnstsw	ax
		mov	[esp+10Ch+var_8C], ecx
		mov	[esp+10Ch+var_C0], ebp
		sahf
		ja	loc_405E92
		fstp	st(1)
		fstp	[esp+10Ch+var_84]
		mov	[esp+10Ch+var_A8], 0
		mov	[esp+10Ch+var_88], 0
		jmp	loc_4056A3
; ---------------------------------------------------------------------------

loc_405E04:				; CODE XREF: sub_404D30+AD7j
		fucomp	st(1)
		fnstsw	ax
		sahf
		jbe	loc_405822
		fsubr	ds:flt_40AAA0
		fld	[esp+10Ch+var_84]
		fxch	st(1)
		fucompp
		fnstsw	ax
		sahf
		jbe	loc_405824

loc_405E29:				; CODE XREF: sub_404D30+AEDj
		mov	eax, [esp+10Ch+var_8C]
		or	[esp+10Ch+var_28], eax
		jmp	loc_405B80
; ---------------------------------------------------------------------------
		align 10h

loc_405E40:				; CODE XREF: sub_404D30+998j
		mov	ebp, [esp+10Ch+var_A4]
		mov	eax, [esp+10Ch+var_38]
		sub	ebp, edx
		mov	[esp+10Ch+Str+4], ebp
		mov	[esp+10Ch+Str],	eax
		call	sub_407090
		mov	ecx, [esp+10Ch+var_A4]
		sub	[esp+10Ch+var_30], ebp
		mov	[esp+10Ch+var_2C], ecx
		mov	[esp+10Ch+var_38], eax
		jmp	loc_4056CE
; ---------------------------------------------------------------------------

loc_405E77:				; CODE XREF: sub_404D30+9CCj
		neg	eax
		mov	[esp+10Ch+Str],	edx
		mov	[esp+10Ch+var_CC], edx
		mov	[esp+10Ch+Str+4], eax
		call	sub_4079C0
		mov	edx, [esp+10Ch+var_CC]
		jmp	loc_405712
; ---------------------------------------------------------------------------

loc_405E92:				; CODE XREF: sub_404D30+10ADj
		fstp	st
		fnstcw	[esp+10Ch+var_52]
		fld	[esp+10Ch+var_B4]
		cmp	[esp+10Ch+var_64], 1
		movzx	eax, [esp+10Ch+var_52]
		mov	ah, 0Ch
		mov	[esp+10Ch+var_54], ax
		fldcw	[esp+10Ch+var_54]
		fistp	[esp+10Ch+var_A8]
		fldcw	[esp+10Ch+var_52]
		fild	[esp+10Ch+var_A8]
		fld	[esp+10Ch+var_B4]
		fsub	st, st(1)
		fst	[esp+10Ch+var_84]
		jz	loc_40643B
		cmp	[esp+10Ch+var_64], 2
		jz	loc_406410
		fucomp	st(2)
		fnstsw	ax
		fstp	st(1)
		sahf
		jb	short loc_405F17
		fstp	st

loc_405EFB:				; CODE XREF: sub_404D30+1706j
		add	[esp+10Ch+var_A8], 1
		mov	eax, 30h
		sub	eax, [esp+10Ch+var_8C]
		fild	[esp+10Ch+var_A8]
		mov	[esp+10Ch+var_8C], eax

loc_405F17:				; CODE XREF: sub_404D30+11C7j
					; sub_404D30+16EAj ...
		fstp	[esp+10Ch+var_B4]
		mov	[esp+10Ch+var_88], 0
		jmp	loc_4056A3
; ---------------------------------------------------------------------------
		align 10h

loc_405F30:				; CODE XREF: sub_404D30+D5Cj
		mov	[esp+10Ch+var_88], 0
		mov	[esp+10Ch+var_8C], 20h
		mov	[esp+10Ch+var_C0], 0
		jmp	loc_40568E
; ---------------------------------------------------------------------------

loc_405F53:				; CODE XREF: sub_404D30+DEDj
		mov	[esp+10Ch+var_CC], edx
		mov	[esp+10Ch+Str+4], 1
		mov	[esp+10Ch+Str],	eax
		call	sub_4079C0
		mov	edx, [esp+10Ch+var_CC]
		add	[esp+10Ch+var_30], 1
		add	[esp+10Ch+var_60], 1
		mov	[esp+10Ch+var_A8], 0
		jmp	loc_4057A3
; ---------------------------------------------------------------------------

loc_405F88:				; CODE XREF: sub_404D30+7D3j
		mov	ecx, [esp+10Ch+var_A8]
		mov	edi, [esp+10Ch+var_A0]
		mov	edx, [esp+10Ch+var_B8]

loc_405F94:				; CODE XREF: sub_404D30+7B0j
		mov	[esp+10Ch+var_B8], ecx
		xor	esi, esi
		mov	[esp+10Ch+var_BC], edx
		mov	[esp+10Ch+var_A8], 0
		mov	[esp+10Ch+var_A0], 0
		jmp	loc_404F2F
; ---------------------------------------------------------------------------

loc_405FB3:				; CODE XREF: sub_404D30+263j
		mov	eax, [esp+10Ch+arg_0]
		xor	ecx, ecx
		mov	[esp+10Ch+var_34], eax
		jmp	loc_405095
; ---------------------------------------------------------------------------

loc_405FC8:				; CODE XREF: sub_404D30+217j
		mov	ecx, [esp+10Ch+var_C0]
		test	ecx, ecx
		jnz	loc_404F4D
		mov	ebp, [esp+10Ch+arg_0]
		mov	[esp+10Ch+var_28], 6
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+var_34], ebp
		jmp	loc_404E75
; ---------------------------------------------------------------------------
		align 10h

loc_406000:				; CODE XREF: sub_404D30+599j
		sar	eax, 4
		xor	edi, edi
		cmp	eax, 0Fh
		jle	short loc_40605B
		fld	ds:dbl_40AAE0
		mov	ecx, eax

loc_406012:				; CODE XREF: sub_404D30+1324j
		mov	esi, dword ptr [esp+10Ch+var_44+4]
		sub	ecx, 10h
		mov	edx, esi
		and	esi, 800FFFFFh
		or	esi, 3FF00000h
		and	edx, 7FF00000h
		mov	dword ptr [esp+10Ch+var_44+4], esi
		shr	edx, 14h
		cmp	ecx, 0Fh
		fld	[esp+10Ch+var_44]
		lea	edi, [edi+edx-3FFh]
		fmul	st, st(1)
		fstp	[esp+10Ch+var_44]
		jg	short loc_406012
		fstp	st
		and	eax, 0Fh

loc_40605B:				; CODE XREF: sub_404D30+12D8j
		mov	ecx, dword ptr [esp+10Ch+var_44+4]
		mov	edx, ecx
		and	edx, 7FF00000h
		shr	edx, 14h
		lea	esi, [edi+edx-3FFh]
		mov	edx, ecx
		and	edx, 800FFFFFh
		or	edx, 3FF00000h
		test	eax, eax
		mov	dword ptr [esp+10Ch+var_44+4], edx
		jle	loc_40686B
		fld	[esp+10Ch+var_44]
		xor	edx, edx
		jmp	short loc_4060A5
; ---------------------------------------------------------------------------
		align 10h

loc_4060A0:				; CODE XREF: sub_404D30+138Aj
		fstp	st
		add	edx, 1

loc_4060A5:				; CODE XREF: sub_404D30+136Aj
		test	al, 1
		fld	st
		jz	short loc_4060B6
		fstp	st
		fmul	ds:dbl_40AAC0[edx*8]
		fld	st

loc_4060B6:				; CODE XREF: sub_404D30+1379j
		sar	eax, 1
		test	eax, eax
		jg	short loc_4060A0
		fxch	st(1)
		jmp	short loc_4060C2
; ---------------------------------------------------------------------------

loc_4060C0:				; CODE XREF: sub_404D30+16B8j
		fxch	st(1)

loc_4060C2:				; CODE XREF: sub_404D30+138Ej
		fstp	[esp+10Ch+var_44]
		jmp	loc_4052D8
; ---------------------------------------------------------------------------

loc_4060CE:				; CODE XREF: sub_404D30+E56j
					; sub_404D30+1961j ...
		mov	eax, [esp+10Ch+var_2C]

loc_4060D5:				; CODE XREF: sub_404D30+1C8Fj
		mov	ebp, [esp+10Ch+var_A4]
		sub	ebp, eax
		cmp	ebp, 0
		jnz	loc_4064ED
		mov	eax, [esp+10Ch+var_30]
		mov	[esp+10Ch+var_A0], 0
		jmp	loc_405B93
; ---------------------------------------------------------------------------

loc_4060F8:				; CODE XREF: sub_404D30+802j
		xor	esi, esi
		cmp	edi, 30h
		jnz	loc_4068C1

loc_406103:				; CODE XREF: sub_404D30+13E6j
		add	eax, 1
		add	esi, 1
		mov	[esp+10Ch+var_34], eax
		movsx	edi, byte ptr [eax]
		cmp	edi, 30h
		jz	short loc_406103

loc_406118:				; CODE XREF: sub_404D30+1B93j
		lea	eax, [edi-31h]
		cmp	eax, 8
		jbe	loc_40652A
		mov	[esp+10Ch+var_B8], ecx
		mov	[esp+10Ch+var_BC], 0
		mov	[esp+10Ch+var_A8], 0
		mov	[esp+10Ch+var_A0], 1
		jmp	loc_404F2F
; ---------------------------------------------------------------------------

loc_406145:				; CODE XREF: sub_404D30+658j
		jz	loc_4053AF
		lea	ecx, [edi+ecx]
		test	ecx, ecx
		mov	[esp+10Ch+var_2C], ecx
		jle	loc_406893
		mov	eax, [esp+10Ch+var_38]
		neg	edi
		mov	[esp+10Ch+Str+4], edi
		mov	[esp+10Ch+Str],	eax
		call	sub_4079C0
		jmp	loc_4053AF
; ---------------------------------------------------------------------------

loc_406177:				; CODE XREF: sub_404D30+257j
		mov	[esp+10Ch+var_9C], 1

loc_40617F:				; CODE XREF: sub_404D30+16DBj
		lea	ecx, [eax+1]
		mov	[esp+10Ch+var_34], ecx
		movsx	edi, byte ptr [eax+1]
		jmp	loc_404F8D
; ---------------------------------------------------------------------------

loc_406192:				; CODE XREF: sub_404D30+6E1j
		cmp	[esp+10Ch+var_C4], 0FFFFFFEAh
		jl	loc_405294
		imul	eax, [esp+10Ch+var_C4],	0F8h
		fld	[esp+10Ch+var_44]
		lea	edx, [esp+10Ch+var_28]
		mov	ecx, [esp+10Ch+var_64]
		mov	edi, [esp+10Ch+arg_10]
		fdiv	qword ptr [eax+40AB40h]
		mov	[esp+10Ch+var_100], edx
		lea	eax, [esp+10Ch+var_44]
		mov	[esp+10Ch+Size], ecx
		mov	[esp+10Ch+Str+4], 0
		mov	[esp+10Ch+Str],	edi
		fstp	[esp+10Ch+var_44]

loc_4061E5:				; CODE XREF: sub_404D30+174Cj
					; sub_404D30+17B8j
		mov	ecx, [esp+10Ch+arg_C]
		mov	edx, [esp+10Ch+arg_8]
		call	sub_4049F0
		test	eax, eax
		jnz	loc_405087
		xor	eax, eax
		jmp	loc_405298
; ---------------------------------------------------------------------------

loc_406207:				; CODE XREF: sub_404D30+42Fj
		mov	dword ptr [eax+10h], 0
		mov	[esp+10Ch+var_28], 50h
		call	_errno
		mov	dword ptr [eax], 22h
		mov	eax, [esp+10Ch+var_38]
		jmp	loc_404E75
; ---------------------------------------------------------------------------

loc_406230:				; CODE XREF: sub_404D30+62Dj
		mov	[esp+10Ch+var_A0], 0

loc_406238:				; CODE XREF: sub_404D30+ECEj
					; sub_404D30+1A9Bj ...
		mov	eax, [esp+10Ch+var_38]
		mov	dword ptr [eax+10h], 0
		mov	[esp+10Ch+var_28], 0A3h
		call	_errno
		mov	edi, [esp+10Ch+arg_8]
		mov	dword ptr [eax], 22h
		mov	eax, [edi+8]
		jmp	loc_405136
; ---------------------------------------------------------------------------
		align 10h

loc_406270:				; CODE XREF: sub_404D30+326j
					; sub_404D30+330j
		mov	esi, [esp+10Ch+var_98]
		lea	eax, [esp+10Ch+var_38]
		mov	edi, [esp+10Ch+arg_C]
		mov	ebp, [esp+10Ch+arg_8]
		mov	[esp+10Ch+var_100], eax
		lea	eax, [esp+10Ch+var_34]
		mov	[esp+10Ch+var_FC], esi
		mov	[esp+10Ch+Size], edi
		mov	[esp+10Ch+Str+4], ebp
		mov	[esp+10Ch+Str],	eax
		call	sub_407B10
		cmp	eax, 6
		mov	[esp+10Ch+var_28], eax
		jnz	loc_405087
		mov	eax, [esp+10Ch+arg_0]
		mov	[esp+10Ch+var_98], 0
		mov	[esp+10Ch+var_34], eax
		mov	eax, [esp+10Ch+var_38]
		jmp	loc_404E75
; ---------------------------------------------------------------------------

loc_4062DA:				; CODE XREF: sub_404D30+4CCj
		mov	edi, [esp+10Ch+var_98]
		add	edi, 1
		mov	[esp+10Ch+var_64], edi
		jmp	loc_405211
; ---------------------------------------------------------------------------

loc_4062ED:				; CODE XREF: sub_404D30+97j
					; sub_404D30+A0j
		mov	[esp+10Ch+var_C4], ecx
		xor	ebp, ebp
		xor	ebx, ebx
		xor	edx, edx
		jmp	loc_404F04
; ---------------------------------------------------------------------------

loc_4062FC:				; CODE XREF: sub_404D30+4C3j
		mov	esi, [esp+10Ch+var_98]
		sub	eax, esi
		mov	[esp+10Ch+var_64], eax
		jmp	loc_405211
; ---------------------------------------------------------------------------

loc_40630E:				; CODE XREF: sub_404D30+574j
		jz	loc_4052CF
		mov	edx, eax
		neg	edx
		mov	eax, edx
		and	eax, 0Fh
		jz	short loc_406334
		fld	[esp+10Ch+var_44]
		fdiv	ds:dbl_40AB40[eax*8]
		fstp	[esp+10Ch+var_44]

loc_406334:				; CODE XREF: sub_404D30+15EDj
		and	edx, 0FFFFFFF0h
		jz	loc_4052CF
		sar	edx, 4
		xor	esi, esi
		cmp	edx, 0Fh
		jle	short loc_4063A2
		fld	ds:dbl_40AB20
		mov	ecx, edx
		nop

loc_406350:				; CODE XREF: sub_404D30+1661j
		mov	edi, dword ptr [esp+10Ch+var_44+4]
		sub	ecx, 10h
		mov	eax, edi
		and	edi, 800FFFFFh
		or	edi, 3FF00000h
		and	eax, 7FF00000h
		mov	dword ptr [esp+10Ch+var_44+4], edi
		shr	eax, 14h
		cmp	ecx, 0Fh
		fld	[esp+10Ch+var_44]
		lea	esi, [esi+eax-3FFh]
		fmul	st, st(1)
		fstp	[esp+10Ch+var_44]
		jg	short loc_406350
		fstp	st
		sub	edx, 10h
		mov	eax, edx
		shr	eax, 4
		imul	eax, -10h
		add	edx, eax

loc_4063A2:				; CODE XREF: sub_404D30+1615j
		mov	ecx, dword ptr [esp+10Ch+var_44+4]
		mov	eax, ecx
		and	eax, 7FF00000h
		shr	eax, 14h
		lea	esi, [esi+eax-3FFh]
		mov	eax, ecx
		and	eax, 800FFFFFh
		or	eax, 3FF00000h
		test	edx, edx
		mov	dword ptr [esp+10Ch+var_44+4], eax
		jle	loc_40686B
		fld	[esp+10Ch+var_44]
		xor	eax, eax
		fld	st
		jmp	short loc_4063F1
; ---------------------------------------------------------------------------

loc_4063E2:				; CODE XREF: sub_404D30+16C4j
		fstp	st
		fld	st

loc_4063E6:				; CODE XREF: sub_404D30+16D1j
		sar	edx, 1
		jz	loc_4060C0
		add	eax, 1

loc_4063F1:				; CODE XREF: sub_404D30+16B0j
		test	dl, 1
		jz	short loc_4063E2
		fstp	st(1)
		fmul	ds:dbl_40AB00[eax*8]
		fld	st
		jmp	short loc_4063E6
; ---------------------------------------------------------------------------

loc_406403:				; CODE XREF: sub_404D30+243j
		mov	[esp+10Ch+var_9C], 0
		jmp	loc_40617F
; ---------------------------------------------------------------------------

loc_406410:				; CODE XREF: sub_404D30+11BAj
		fstp	st
		fstp	st(1)
		mov	eax, [esp+10Ch+var_C0]
		test	eax, eax
		jnz	loc_405F17

loc_406420:				; CODE XREF: sub_404D30+171Bj
		fldz
		fld	[esp+10Ch+var_84]
		fucompp
		fnstsw	ax
		sahf
		jbe	loc_405F17
		fstp	st
		jmp	loc_405EFB
; ---------------------------------------------------------------------------

loc_40643B:				; CODE XREF: sub_404D30+11ACj
		fstp	st
		fstp	st(1)
		mov	edx, [esp+10Ch+var_C0]
		test	edx, edx
		jz	loc_405F17
		jmp	short loc_406420
; ---------------------------------------------------------------------------

loc_40644D:				; CODE XREF: sub_404D30+6DBj
		lea	edx, [esp+10Ch+var_28]
		mov	ecx, [esp+10Ch+arg_10]
		mov	[esp+10Ch+var_100], edx
		mov	edx, [esp+10Ch+var_64]
		lea	eax, [esp+10Ch+var_44]
		mov	[esp+10Ch+Str+4], 1
		mov	[esp+10Ch+Str],	ecx
		mov	[esp+10Ch+Size], edx
		jmp	loc_4061E5
; ---------------------------------------------------------------------------

loc_406481:				; CODE XREF: sub_404D30+6F0j
		mov	eax, 0Fh
		sub	eax, [esp+10Ch+var_BC]
		lea	edx, [eax+16h]
		cmp	[esp+10Ch+var_C4], edx
		jg	loc_405294
		fld	[esp+10Ch+var_44]
		lea	edx, [esp+10Ch+var_28]
		fmul	ds:dbl_40AB40[eax*8]
		mov	edi, [esp+10Ch+var_C4]
		mov	[esp+10Ch+var_100], edx
		mov	ebp, [esp+10Ch+var_64]
		mov	edx, [esp+10Ch+arg_10]
		mov	[esp+10Ch+Str+4], 0
		sub	edi, eax
		fmul	ds:dbl_40AB40[edi*8]
		mov	[esp+10Ch+Size], ebp
		lea	eax, [esp+10Ch+var_44]
		mov	[esp+10Ch+Str],	edx
		fstp	[esp+10Ch+var_44]
		jmp	loc_4061E5
; ---------------------------------------------------------------------------

loc_4064ED:				; CODE XREF: sub_404D30+13AEj
		jle	loc_406877
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+Str+4], ebp
		mov	[esp+10Ch+Str],	eax
		call	sub_407090
		mov	[esp+10Ch+var_38], eax

loc_40650D:				; CODE XREF: sub_404D30+1B5Ej
		mov	eax, [esp+10Ch+var_30]
		mov	[esp+10Ch+var_A0], 0
		sub	eax, ebp
		mov	[esp+10Ch+var_30], eax
		jmp	loc_405B93
; ---------------------------------------------------------------------------

loc_40652A:				; CODE XREF: sub_404D30+13EEj
		mov	eax, [esp+10Ch+var_34]
		sub	edi, 30h
		xor	ecx, ecx
		mov	[esp+10Ch+var_A8], esi
		mov	esi, 1
		mov	[esp+10Ch+var_9C], edi
		mov	[esp+10Ch+var_B8], eax
		mov	[esp+10Ch+var_A0], eax
		jmp	loc_405574
; ---------------------------------------------------------------------------

loc_406550:				; CODE XREF: sub_404D30+1AC9j
		xor	esi, esi
		cmp	[esp+10Ch+var_BC], 10h
		jg	short loc_406560
		imul	ebp, 0Ah
		add	ebp, [esp+10Ch+var_9C]

loc_406560:				; CODE XREF: sub_404D30+84Ej
					; sub_404D30+1827j ...
		mov	eax, [esp+10Ch+var_A0]
		add	eax, 1
		mov	[esp+10Ch+var_34], eax
		mov	eax, [esp+10Ch+var_A0]
		movsx	edi, byte ptr [eax+1]
		jmp	loc_40554A
; ---------------------------------------------------------------------------

loc_40657B:				; CODE XREF: sub_404D30+392j
		cmp	edi, 69h
		jz	loc_4050D6
		cmp	edi, 6Eh
		jnz	loc_4051A6

loc_40658D:				; CODE XREF: sub_404D30+38Cj
		lea	ebx, [esp+10Ch+var_34]
		mov	[esp+10Ch+Str+4], offset aAn ; "an"
		mov	[esp+10Ch+Str],	ebx
		call	sub_407590
		test	eax, eax
		jz	loc_4051A6
		mov	ecx, [esp+10Ch+arg_8]
		mov	[esp+10Ch+var_28], 4
		mov	esi, [esp+10Ch+arg_C]
		mov	[esp+10Ch+var_A0], 0
		mov	eax, [ecx+8]
		lea	edx, [eax+1]
		mov	[esi], edx
		mov	edx, [esp+10Ch+var_34]
		cmp	byte ptr [edx],	28h
		jnz	loc_405136
		mov	edi, [esp+10Ch+arg_10]
		mov	ebp, ecx
		mov	[esp+10Ch+Str+4], ecx
		mov	[esp+10Ch+Str],	ebx
		mov	[esp+10Ch+Size], edi
		call	sub_408450
		mov	[esp+10Ch+var_A0], 0
		mov	[esp+10Ch+var_28], eax
		mov	eax, [ebp+8]
		jmp	loc_405136
; ---------------------------------------------------------------------------

loc_406615:				; CODE XREF: sub_404D30+932j
		cmp	ebp, 1
		sbb	eax, eax
		and	eax, 10h
		add	eax, 11h
		mov	[esp+10Ch+var_28], eax
		jmp	loc_405B80
; ---------------------------------------------------------------------------

loc_40662C:				; CODE XREF: sub_404D30+D2Bj
		cmp	ebp, 1
		sbb	eax, eax
		and	eax, 10h
		add	eax, 11h
		cmp	dword ptr [esp+10Ch+var_B4], 1
		mov	[esp+10Ch+var_28], eax
		jg	loc_405B80
		test	ebp, ebp
		jnz	loc_405B80
		mov	eax, [esp+10Ch+var_9C]
		cmp	[esp+10Ch+var_60], eax
		jz	loc_405B80
		cmp	[esp+10Ch+var_A0], 0
		jnz	loc_405B80
		mov	[esp+10Ch+Str],	ebx
		mov	[esp+10Ch+Str+4], 1
		call	sub_407090
		mov	edx, [esp+10Ch+var_BC]
		mov	[esp+10Ch+Str+4], edx
		mov	ebx, eax
		mov	[esp+10Ch+Str],	eax
		call	sub_4069D0
		test	eax, eax
		jle	loc_4060CE
		mov	[esp+10Ch+var_28], 11h

loc_4066A2:				; CODE XREF: sub_404D30+1BAEj
		mov	ebp, [esp+10Ch+var_A4]
		mov	eax, [esp+10Ch+var_38]
		sub	[esp+10Ch+var_30], ebp
		mov	[esp+10Ch+var_2C], ebp
		mov	[esp+10Ch+Str+4], ebp
		mov	[esp+10Ch+Str],	eax
		call	sub_4048E0
		mov	[esp+10Ch+var_38], eax
		jmp	loc_405B80
; ---------------------------------------------------------------------------

loc_4066D3:				; CODE XREF: sub_404D30+70Aj
		mov	eax, dword ptr [esp+10Ch+var_44+4]
		or	eax, 100000h
		bsf	edx, eax
		mov	eax, 15h
		sub	eax, edx
		jmp	loc_40544A
; ---------------------------------------------------------------------------

loc_4066EE:				; CODE XREF: sub_404D30+D31j
		test	ebp, ebp
		jz	loc_406854
		mov	edx, [esp+10Ch+var_A0]
		test	edx, edx
		jz	short loc_40674F
		mov	eax, [esp+10Ch+var_38]
		mov	ecx, [esp+10Ch+var_2C]
		lea	edx, [eax+14h]
		mov	[esp+10Ch+var_C4], edx
		mov	edx, ecx
		sar	edx, 5
		lea	edx, [eax+edx*4+14h]
		cmp	[esp+10Ch+var_C4], edx
		mov	[esp+10Ch+var_B8], edx
		jnb	loc_40696A
		cmp	dword ptr [eax+14h], 0FFFFFFFFh
		jnz	short loc_40674F
		lea	edx, [eax+18h]
		mov	[esp+10Ch+var_C0], ecx
		mov	ecx, edx
		mov	edx, [esp+10Ch+var_B8]
		jmp	short loc_406742
; ---------------------------------------------------------------------------

loc_40673F:				; CODE XREF: sub_404D30+1A1Dj
		add	ecx, 4

loc_406742:				; CODE XREF: sub_404D30+1A0Dj
		cmp	edx, ecx
		jbe	loc_406962
		cmp	dword ptr [ecx], 0FFFFFFFFh
		jz	short loc_40673F

loc_40674F:				; CODE XREF: sub_404D30+19CCj
					; sub_404D30+19FEj ...
		mov	[esp+10Ch+var_28], 11h

loc_40675A:				; CODE XREF: sub_404D30+1B36j
		mov	eax, [esp+10Ch+var_A0]
		test	eax, eax
		jnz	short loc_406770
		mov	eax, [esp+10Ch+var_A4]
		cmp	dword ptr [esp+10Ch+var_B4], eax
		jl	loc_4060CE

loc_406770:				; CODE XREF: sub_404D30+1A30j
		mov	edx, [esp+10Ch+var_38]
		test	byte ptr [edx+14h], 1
		jz	loc_405B80
		test	ebp, ebp
		jnz	loc_40691A
		cmp	dword ptr [esp+10Ch+var_B4], 1
		jz	loc_406832
		mov	eax, [edx+10h]
		lea	ecx, [edx+14h]
		lea	edx, [edx+eax*4+14h]

loc_40679E:				; CODE XREF: sub_404D30+1A83j
		mov	eax, [ecx]
		test	eax, eax
		jnz	loc_4069C4
		mov	dword ptr [ecx], 0FFFFFFFFh
		add	ecx, 4
		cmp	edx, ecx
		ja	short loc_40679E

loc_4067B5:				; CODE XREF: sub_404D30+1C99j
		mov	[esp+10Ch+var_28], 11h
		jmp	loc_405B80
; ---------------------------------------------------------------------------

loc_4067C5:				; CODE XREF: sub_404D30+EC5j
		mov	ebx, [esp+10Ch+var_98]
		test	ebx, ebx
		jnz	loc_406238
		jmp	loc_405C04
; ---------------------------------------------------------------------------

loc_4067D6:				; CODE XREF: sub_404D30+EBCj
		mov	esi, [esp+10Ch+var_98]
		test	esi, esi
		jz	loc_406238
		jmp	loc_405C04
; ---------------------------------------------------------------------------

loc_4067E7:				; CODE XREF: sub_404D30+879j
		mov	eax, [esp+10Ch+var_BC]
		lea	ecx, [eax+esi-2]

loc_4067EF:				; CODE XREF: sub_404D30+85Bj
		lea	esi, [ecx+1]
		cmp	ecx, 8
		mov	[esp+10Ch+var_BC], esi
		jg	loc_406550
		imul	ebx, 0Ah
		xor	esi, esi
		add	ebx, [esp+10Ch+var_9C]
		jmp	loc_406560
; ---------------------------------------------------------------------------

loc_40680D:				; CODE XREF: sub_404D30+FD1j
		mov	edx, [esp+10Ch+var_A4]
		xor	ecx, ecx
		mov	eax, [esp+10Ch+var_38]
		jmp	loc_405D37
; ---------------------------------------------------------------------------

loc_40681F:				; CODE XREF: sub_404D30+D72j
		mov	ecx, [esp+10Ch+var_A0]
		test	ecx, ecx
		jz	loc_405AA8
		mov	edx, [esp+10Ch+var_38]

loc_406832:				; CODE XREF: sub_404D30+1A5Ej
		mov	dword ptr [edx+10h], 0
		mov	edx, [esp+10Ch+var_9C]
		mov	[esp+10Ch+var_28], 50h
		mov	[esp+10Ch+var_30], edx
		jmp	loc_405B80
; ---------------------------------------------------------------------------

loc_406854:				; CODE XREF: sub_404D30+19C0j
		cmp	dword ptr [esp+10Ch+var_B4], 1
		jz	short loc_4068C8
		mov	[esp+10Ch+var_28], 21h
		jmp	loc_40675A
; ---------------------------------------------------------------------------

loc_40686B:				; CODE XREF: sub_404D30+135Bj
					; sub_404D30+169Fj
		fld	[esp+10Ch+var_44]
		jmp	loc_4052D8
; ---------------------------------------------------------------------------

loc_406877:				; CODE XREF: sub_404D30:loc_4064EDj
		mov	eax, ebp
		neg	eax
		mov	[esp+10Ch+Str+4], eax
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+Str],	eax
		call	sub_4079C0
		jmp	loc_40650D
; ---------------------------------------------------------------------------

loc_406893:				; CODE XREF: sub_404D30+1427j
		cmp	ecx, 0FFFFFFFFh
		jl	loc_4053D4
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+var_2C], 1
		mov	dword ptr [eax+14h], 1
		mov	dword ptr [eax+10h], 1
		jmp	loc_4053AF
; ---------------------------------------------------------------------------

loc_4068C1:				; CODE XREF: sub_404D30+13CDj
		mov	esi, edx
		jmp	loc_406118
; ---------------------------------------------------------------------------

loc_4068C8:				; CODE XREF: sub_404D30+1B29j
		mov	ecx, [esp+10Ch+var_60]
		cmp	[esp+10Ch+var_9C], ecx
		mov	[esp+10Ch+var_28], 1
		jnz	loc_4066A2
		mov	eax, [esp+10Ch+var_38]
		mov	[esp+10Ch+var_28], 21h
		cmp	dword ptr [eax+10h], 1
		jnz	loc_405B80
		cmp	dword ptr [eax+14h], 1
		jnz	loc_405B80
		mov	[esp+10Ch+var_68], 1
		jmp	loc_405B80
; ---------------------------------------------------------------------------

loc_40691A:				; CODE XREF: sub_404D30+1A53j
		mov	[esp+10Ch+Str],	edx
		call	sub_404960
		mov	ecx, [esp+10Ch+var_2C]
		mov	edx, eax
		mov	[esp+10Ch+var_38], eax
		mov	eax, [eax+10h]
		bsr	eax, [edx+eax*4+10h]
		mov	edx, ecx
		neg	edx
		and	edx, 1Fh
		xor	eax, 1Fh
		cmp	edx, eax
		jz	short loc_406952
		add	ecx, 1
		mov	[esp+10Ch+var_2C], ecx

loc_406952:				; CODE XREF: sub_404D30+1C16j
		mov	[esp+10Ch+var_28], 21h
		jmp	loc_405B80
; ---------------------------------------------------------------------------

loc_406962:				; CODE XREF: sub_404D30+1A14j
		mov	[esp+10Ch+var_C4], ecx
		mov	ecx, [esp+10Ch+var_C0]

loc_40696A:				; CODE XREF: sub_404D30+19F4j
		and	ecx, 1Fh
		jz	short loc_406983
		or	edx, 0FFFFFFFFh
		shl	edx, cl
		mov	ecx, [esp+10Ch+var_C4]
		or	edx, [ecx]
		cmp	edx, 0FFFFFFFFh
		jnz	loc_40674F

loc_406983:				; CODE XREF: sub_404D30+1C3Dj
		mov	edx, [esp+10Ch+var_A4]
		mov	ebp, [esp+10Ch+var_9C]
		mov	dword ptr [eax+10h], 1
		mov	dword ptr [eax+14h], 1
		mov	[esp+10Ch+var_2C], 1
		lea	eax, [edx+ebp-1]
		mov	[esp+10Ch+var_30], eax
		mov	eax, 1
		mov	[esp+10Ch+var_28], 21h
		jmp	loc_4060D5
; ---------------------------------------------------------------------------

loc_4069C4:				; CODE XREF: sub_404D30+1A72j
		sub	eax, 1
		mov	[ecx], eax
		jmp	loc_4067B5
sub_404D30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4069D0	proc near		; CODE XREF: sub_404D30+D1Bp
					; sub_404D30+195Ap

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		mov	[esp+0Ch+var_C], ebx
		mov	ecx, [esp+0Ch+arg_0]
		mov	ebx, [esp+0Ch+arg_4]
		mov	[esp+0Ch+var_8], esi
		mov	[esp+0Ch+var_4], edi
		mov	eax, [ecx+10h]
		mov	edx, [ebx+10h]
		sub	eax, edx
		jnz	short loc_406A12
		lea	edi, ds:10h[edx*4]
		lea	esi, [ecx+14h]
		lea	edx, [ecx+edi+4]
		lea	ecx, [ebx+edi+4]

loc_406A02:				; CODE XREF: sub_4069D0+40j
		sub	ecx, 4
		sub	edx, 4
		mov	ebx, [ecx]
		cmp	[edx], ebx
		jnz	short loc_406A21
		cmp	esi, edx
		jb	short loc_406A02

loc_406A12:				; CODE XREF: sub_4069D0+1Ej
		mov	ebx, [esp+0Ch+var_C]
		mov	esi, [esp+0Ch+var_8]
		mov	edi, [esp+0Ch+var_4]
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_406A21:				; CODE XREF: sub_4069D0+3Cj
		sbb	eax, eax
		mov	ebx, [esp+0Ch+var_C]
		or	eax, 1
		mov	esi, [esp+0Ch+var_8]
		mov	edi, [esp+0Ch+var_4]
		add	esp, 0Ch
		retn
sub_4069D0	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	edx, [esp+8]
		mov	eax, [esp+4]
		movzx	ecx, byte ptr [edx]
		test	cl, cl
		mov	[eax], cl
		jz	short locret_406A63
		add	edx, 1

loc_406A54:				; CODE XREF: .text:00406A61j
		movzx	ecx, byte ptr [edx]
		add	eax, 1
		add	edx, 1
		test	cl, cl
		mov	[eax], cl
		jnz	short loc_406A54

locret_406A63:				; CODE XREF: .text:00406A4Fj
		rep retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406A70	proc near		; CODE XREF: sub_4076C0+18p
					; sub_4076C0+30p

var_28		= dword	ptr -28h
var_1C		= qword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	ecx, 20h
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_C], esi
		mov	[esp+2Ch+var_8], edi
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, [esp+2Ch+arg_4]
		mov	[esp+2Ch+var_10], ebx
		mov	edx, [eax+10h]
		lea	edi, [eax+14h]
		lea	edx, [eax+edx*4+10h]
		mov	ebx, [edx]
		mov	esi, edx
		bsr	eax, ebx
		xor	eax, 1Fh
		sub	ecx, eax
		cmp	eax, 0Ah
		mov	[ebp+0], ecx
		jg	short loc_406B00
		mov	ecx, 0Bh
		mov	esi, ebx
		sub	ecx, eax
		shr	esi, cl
		or	esi, 3FF00000h
		mov	dword ptr [esp+2Ch+var_1C+4], esi
		xor	esi, esi
		cmp	edi, edx
		mov	dword ptr [esp+2Ch+var_1C], 0
		jnb	short loc_406AD6
		mov	esi, [edx-4]
		shr	esi, cl

loc_406AD6:				; CODE XREF: sub_406A70+5Fj
		lea	ecx, [eax+15h]
		shl	ebx, cl
		or	esi, ebx
		mov	dword ptr [esp+2Ch+var_1C], esi

loc_406AE1:				; CODE XREF: sub_406A70+DFj
					; sub_406A70+EFj
		fld	[esp+2Ch+var_1C]
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_406B00:				; CODE XREF: sub_406A70+3Cj
		xor	ebp, ebp
		cmp	edi, edx
		jb	short loc_406B61
		sub	eax, 0Bh
		jz	short loc_406B51

loc_406B0B:				; CODE XREF: sub_406A70+FCj
		mov	ecx, eax
		mov	edx, 20h
		shl	ebx, cl
		sub	edx, eax
		or	ebx, 3FF00000h
		mov	ecx, edx
		mov	[esp+2Ch+var_28], ebx
		mov	ebx, ebp
		shr	ebx, cl
		mov	ecx, [esp+2Ch+var_28]
		mov	dword ptr [esp+2Ch+var_1C], 0
		or	ecx, ebx
		xor	ebx, ebx
		cmp	esi, edi
		mov	dword ptr [esp+2Ch+var_1C+4], ecx
		jbe	short loc_406B45
		mov	ebx, [esi-4]
		mov	ecx, edx
		shr	ebx, cl

loc_406B45:				; CODE XREF: sub_406A70+CCj
		mov	ecx, eax
		shl	ebp, cl
		or	ebx, ebp
		mov	dword ptr [esp+2Ch+var_1C], ebx
		jmp	short loc_406AE1
; ---------------------------------------------------------------------------

loc_406B51:				; CODE XREF: sub_406A70+99j
					; sub_406A70+FAj
		or	ebx, 3FF00000h
		mov	dword ptr [esp+2Ch+var_1C+4], ebx
		mov	dword ptr [esp+2Ch+var_1C], ebp
		jmp	short loc_406AE1
; ---------------------------------------------------------------------------

loc_406B61:				; CODE XREF: sub_406A70+94j
		sub	esi, 4
		sub	eax, 0Bh
		mov	ebp, [edx-4]
		jz	short loc_406B51
		jmp	short loc_406B0B
sub_406A70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406B70	proc near		; CODE XREF: sub_406C90+14p
					; sub_406D00+Bp ...

dwMilliseconds	= dword	ptr -1Ch
var_18		= dword	ptr -18h

		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 14h
		mov	eax, ds:dword_40B3E0
		cmp	eax, 2
		jz	short loc_406C00
		test	eax, eax
		jz	short loc_406BB1

loc_406B85:				; CODE XREF: sub_406B70+BAj
		cmp	eax, 1
		jnz	short loc_406BA6
		mov	esi, ds:Sleep

loc_406B90:				; CODE XREF: sub_406B70+34j
		mov	[esp+1Ch+dwMilliseconds], 1 ; dwMilliseconds
		call	esi ; Sleep
		mov	eax, ds:dword_40B3E0
		sub	esp, 4
		cmp	eax, 1
		jz	short loc_406B90

loc_406BA6:				; CODE XREF: sub_406B70+18j
		cmp	eax, 2
		jz	short loc_406C00
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_406BB1:				; CODE XREF: sub_406B70+13j
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+dwMilliseconds], offset dword_40B3E0
		call	sub_404120
		sub	esp, 8
		test	eax, eax
		jnz	short loc_406C20
		mov	esi, ds:InitializeCriticalSection
		mov	[esp+1Ch+dwMilliseconds], offset stru_40B400 ; lpCriticalSection
		call	esi ; InitializeCriticalSection
		sub	esp, 4
		mov	[esp+1Ch+dwMilliseconds], offset stru_40B418 ; lpCriticalSection
		call	esi ; InitializeCriticalSection
		sub	esp, 4
		mov	[esp+1Ch+dwMilliseconds], offset sub_406C40 ; _onexit_t
		call	sub_4032F0
		mov	ds:dword_40B3E0, 2

loc_406C00:				; CODE XREF: sub_406B70+Fj
					; sub_406B70+39j ...
		lea	eax, [ebx+ebx*2]
		lea	eax, ds:40B400h[eax*8]
		mov	[esp+1Ch+dwMilliseconds], eax ;	lpCriticalSection
		call	ds:EnterCriticalSection
		sub	esp, 4
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_406C20:				; CODE XREF: sub_406B70+5Aj
		cmp	eax, 2
		jz	short loc_406C2F
		mov	eax, ds:dword_40B3E0
		jmp	loc_406B85
; ---------------------------------------------------------------------------

loc_406C2F:				; CODE XREF: sub_406B70+B3j
		mov	ds:dword_40B3E0, 2
		jmp	short loc_406C00
sub_406B70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_406C40()
sub_406C40	proc near		; DATA XREF: sub_406B70+7Ao

lpCriticalSection= dword ptr -1Ch
var_18		= dword	ptr -18h

		push	ebx
		sub	esp, 18h
		mov	[esp+1Ch+var_18], 3
		mov	[esp+1Ch+lpCriticalSection], offset dword_40B3E0
		call	sub_404120
		sub	esp, 8
		cmp	eax, 2
		jnz	short loc_406C7E
		mov	ebx, ds:DeleteCriticalSection
		mov	[esp+1Ch+lpCriticalSection], offset stru_40B400	; lpCriticalSection
		call	ebx ; DeleteCriticalSection
		sub	esp, 4
		mov	[esp+1Ch+lpCriticalSection], offset stru_40B418	; lpCriticalSection
		call	ebx ; DeleteCriticalSection
		sub	esp, 4

loc_406C7E:				; CODE XREF: sub_406C40+1Ej
		add	esp, 18h
		pop	ebx
		retn
sub_406C40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406C90	proc near		; CODE XREF: sub_4048E0+65p
					; sub_404960+86p ...

lpCriticalSection= dword ptr -1Ch
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 18h
		mov	ebx, [esp+1Ch+arg_0]
		test	ebx, ebx
		jz	short loc_406CC5
		cmp	dword ptr [ebx+4], 9
		jg	short loc_406CD0
		xor	eax, eax
		call	sub_406B70
		mov	eax, [ebx+4]
		cmp	ds:dword_40B3E0, 2
		mov	edx, ds:dword_40B440[eax*4]
		mov	[ebx], edx
		mov	ds:dword_40B440[eax*4],	ebx
		jz	short loc_406CE0

loc_406CC5:				; CODE XREF: sub_406C90+Aj
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_406CD0:				; CODE XREF: sub_406C90+10j
		add	esp, 18h
		pop	ebx
		jmp	free
; ---------------------------------------------------------------------------
		align 10h

loc_406CE0:				; CODE XREF: sub_406C90+33j
		mov	[esp+1Ch+lpCriticalSection], offset stru_40B400	; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 18h
		pop	ebx
		retn
sub_406C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406D00	proc near		; CODE XREF: sub_4048E0+6Dp
					; sub_404960+5Ap ...

lpCriticalSection= dword ptr -2Ch
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	esi
		xor	eax, eax
		push	ebx
		sub	esp, 24h
		mov	esi, [esp+2Ch+arg_0]
		call	sub_406B70
		cmp	esi, 9
		jg	short loc_406D50
		mov	eax, ds:dword_40B440[esi*4]
		test	eax, eax
		jz	short loc_406D95
		mov	edx, [eax]
		cmp	ds:dword_40B3E0, 2
		mov	ds:dword_40B440[esi*4],	edx
		jnz	short loc_406D81

loc_406D32:				; CODE XREF: sub_406D00+7Fj
		mov	[esp+2Ch+var_10], eax
		mov	[esp+2Ch+lpCriticalSection], offset stru_40B400	; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		mov	eax, [esp+2Ch+var_10]
		jmp	short loc_406D81
; ---------------------------------------------------------------------------
		align 10h

loc_406D50:				; CODE XREF: sub_406D00+13j
		mov	ebx, 1
		mov	ecx, esi
		shl	ebx, cl
		lea	edx, ds:1Bh[ebx*4]
		shr	edx, 3

loc_406D63:				; CODE XREF: sub_406D00+C1j
		shl	edx, 3
		mov	[esp+2Ch+lpCriticalSection], edx ; Size
		call	malloc
		test	eax, eax
		jz	short loc_406D8F

loc_406D72:				; CODE XREF: sub_406D00+CCj
		cmp	ds:dword_40B3E0, 2
		mov	[eax+4], esi
		mov	[eax+8], ebx
		jz	short loc_406D32

loc_406D81:				; CODE XREF: sub_406D00+30j
					; sub_406D00+4Aj
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+0Ch], 0

loc_406D8F:				; CODE XREF: sub_406D00+70j
		add	esp, 24h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_406D95:				; CODE XREF: sub_406D00+1Ej
		mov	eax, off_40902C
		mov	ecx, esi
		mov	ebx, 1
		shl	ebx, cl
		lea	edx, ds:1Bh[ebx*4]
		shr	edx, 3
		mov	ecx, eax
		sub	ecx, offset dword_40B480
		sar	ecx, 3
		lea	ecx, [edx+ecx]
		cmp	ecx, 120h
		ja	short loc_406D63
		lea	edx, [eax+edx*8]
		mov	off_40902C, edx
		jmp	short loc_406D72
sub_406D00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_406DD0(double, int, int)
sub_406DD0	proc near		; CODE XREF: sub_4049F0+32p
					; sub_404D30+5C1p ...

var_4C		= dword	ptr -4Ch
var_30		= dword	ptr -30h
var_24		= qword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= qword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 4Ch
		fld	[esp+4Ch+arg_0]
		mov	[esp+4Ch+var_4], ebp
		fstp	[esp+4Ch+var_24]
		mov	ebp, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		mov	[esp+4Ch+var_4C], 1
		call	sub_406D00
		test	eax, eax
		jz	loc_406E8C
		mov	esi, dword ptr [esp+4Ch+var_24+4]
		mov	edx, esi
		and	esi, 7FFFFFFFh
		mov	dword ptr [esp+4Ch+var_24+4], esi
		shr	esi, 14h
		and	edx, 0FFFFFh
		test	esi, esi
		jz	short loc_406E26
		or	edx, 100000h

loc_406E26:				; CODE XREF: sub_406DD0+4Ej
		mov	edi, dword ptr [esp+4Ch+var_24]
		test	edi, edi
		jz	short loc_406EA0
		bsf	ebx, edi
		mov	ecx, ebx
		shr	edi, cl
		test	ebx, ebx
		mov	[esp+4Ch+var_30], edi
		jz	loc_406EE0
		mov	dword ptr [esp+4Ch+var_24], 20h
		mov	edi, edx
		sub	dword ptr [esp+4Ch+var_24], ebx
		movzx	ecx, byte ptr [esp+4Ch+var_24]
		shl	edi, cl
		mov	ecx, [esp+4Ch+var_30]
		or	edi, ecx
		mov	ecx, ebx
		mov	[eax+14h], edi
		shr	edx, cl

loc_406E63:				; CODE XREF: sub_406DD0+117j
		cmp	edx, 1
		mov	[eax+18h], edx
		sbb	edx, edx
		add	edx, 2
		test	esi, esi
		mov	[eax+10h], edx
		jz	short loc_406EBB

loc_406E75:				; CODE XREF: sub_406DD0+E9j
		mov	ecx, [esp+4Ch+arg_C]
		lea	edx, [ebx+esi-433h]
		mov	[ebp+0], edx
		mov	edx, 35h
		sub	edx, ebx
		mov	[ecx], edx

loc_406E8C:				; CODE XREF: sub_406DD0+2Dj
					; sub_406DD0+107j
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_406EA0:				; CODE XREF: sub_406DD0+5Cj
		bsf	ecx, edx
		mov	dword ptr [eax+10h], 1
		shr	edx, cl
		test	esi, esi
		mov	[eax+14h], edx
		lea	ebx, [ecx+20h]
		mov	edx, 1
		jnz	short loc_406E75

loc_406EBB:				; CODE XREF: sub_406DD0+A3j
		bsr	ecx, [eax+edx*4+10h]
		mov	edi, [esp+4Ch+arg_C]
		shl	edx, 5
		sub	ebx, 432h
		mov	[ebp+0], ebx
		xor	ecx, 1Fh
		sub	edx, ecx
		mov	[edi], edx
		jmp	short loc_406E8C
; ---------------------------------------------------------------------------
		align 10h

loc_406EE0:				; CODE XREF: sub_406DD0+6Bj
		mov	edi, [esp+4Ch+var_30]
		mov	[eax+14h], edi
		jmp	loc_406E63
sub_406DD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406EF0	proc near		; CODE XREF: sub_404D30+A00p
					; sub_404D30+CF5p

var_5C		= dword	ptr -5Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebp, [esp+5Ch+arg_0]
		mov	esi, [esp+5Ch+arg_4]
		mov	ebx, [ebp+10h]
		mov	eax, [esi+10h]
		sub	ebx, eax
		cmp	ebx, 0
		jz	loc_407017
		jl	loc_407078
		xor	ebx, ebx

loc_406F18:				; CODE XREF: sub_406EF0:loc_407072j
					; sub_406EF0+193j
		mov	eax, [ebp+4]
		mov	[esp+5Ch+var_5C], eax
		call	sub_406D00
		test	eax, eax
		mov	[esp+5Ch+var_28], eax
		jz	loc_407066
		mov	edx, [ebp+10h]
		xor	ecx, ecx
		mov	[eax+0Ch], ebx
		lea	eax, [ebp+14h]
		xor	ebx, ebx
		mov	edi, eax
		lea	ebp, [ebp+edx*4+14h]
		mov	[esp+5Ch+var_20], edx
		mov	edx, [esi+10h]
		mov	[esp+5Ch+var_2C], ebp
		lea	ebp, [esi+14h]
		lea	edx, [esi+edx*4+14h]
		mov	esi, ebx
		mov	[esp+5Ch+var_24], edx
		mov	edx, [esp+5Ch+var_28]
		mov	ebx, ecx
		mov	[esp+5Ch+var_44], ebx
		mov	[esp+5Ch+var_40], esi
		add	edx, 14h
		mov	ecx, edx
		lea	esi, [esi+0]

loc_406F70:				; CODE XREF: sub_406EF0+B5j
		mov	eax, [ebp+0]
		xor	esi, esi
		xor	edx, edx
		mov	ebx, [edi]
		sub	ebx, eax
		sbb	esi, edx
		sub	ebx, [esp+5Ch+var_44]
		sbb	esi, [esp+5Ch+var_40]
		add	edi, 4
		add	ebp, 4
		mov	[ecx], ebx
		add	ecx, 4
		mov	eax, esi
		and	eax, 1
		cmp	[esp+5Ch+var_24], ebp
		mov	[esp+5Ch+var_44], eax
		mov	[esp+5Ch+var_40], 0
		ja	short loc_406F70
		cmp	edi, [esp+5Ch+var_2C]
		mov	esi, ecx
		mov	ebx, [esp+5Ch+var_40]
		mov	eax, edi
		mov	edx, esi
		mov	ecx, [esp+5Ch+var_44]
		jnb	short loc_406FDD
		mov	edi, ecx
		mov	ebp, ebx
		nop

loc_406FC0:				; CODE XREF: sub_406EF0+EBj
		mov	ebx, [eax]
		xor	esi, esi
		sub	ebx, edi
		sbb	esi, ebp
		add	eax, 4
		mov	edi, esi
		xor	ebp, ebp
		and	edi, 1
		mov	[edx], ebx
		add	edx, 4
		cmp	[esp+5Ch+var_2C], eax
		ja	short loc_406FC0

loc_406FDD:				; CODE XREF: sub_406EF0+C9j
		mov	ebx, [edx-4]
		lea	eax, [edx-4]
		test	ebx, ebx
		jnz	short loc_407000
		mov	edx, [esp+5Ch+var_20]
		nop
		lea	esi, [esi+0]

loc_406FF0:				; CODE XREF: sub_406EF0+10Aj
		sub	eax, 4
		sub	edx, 1
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_406FF0
		mov	[esp+5Ch+var_20], edx

loc_407000:				; CODE XREF: sub_406EF0+F5j
		mov	eax, [esp+5Ch+var_20]
		mov	edx, [esp+5Ch+var_28]
		mov	[edx+10h], eax
		mov	eax, [esp+5Ch+var_28]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_407017:				; CODE XREF: sub_406EF0+1Aj
		lea	edx, ds:10h[eax*4]
		lea	eax, [ebp+edx+4]
		lea	edi, [ebp+14h]
		lea	edx, [esi+edx+4]
		lea	esi, [esi+0]

loc_407030:				; CODE XREF: sub_406EF0+14Ej
		sub	edx, 4
		sub	eax, 4
		mov	ecx, [edx]
		cmp	[eax], ecx
		jnz	short loc_407072
		cmp	edi, eax
		jb	short loc_407030
		mov	[esp+5Ch+var_5C], 0
		call	sub_406D00
		test	eax, eax
		mov	[esp+5Ch+var_28], eax
		jz	short loc_407066
		mov	eax, [esp+5Ch+var_28]
		mov	dword ptr [eax+10h], 1
		mov	dword ptr [eax+14h], 0

loc_407066:				; CODE XREF: sub_406EF0+39j
					; sub_406EF0+162j
		mov	eax, [esp+5Ch+var_28]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_407072:				; CODE XREF: sub_406EF0+14Aj
		jnb	loc_406F18

loc_407078:				; CODE XREF: sub_406EF0+20j
		mov	eax, ebp
		mov	ebx, 1
		mov	ebp, esi
		mov	esi, eax
		jmp	loc_406F18
sub_406EF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407090	proc near		; CODE XREF: sub_4049F0+1EBp
					; sub_404D30+66Cp ...

var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebp, [esp+3Ch+arg_0]
		mov	edi, [esp+3Ch+arg_4]
		mov	eax, [ebp+10h]
		mov	esi, edi
		mov	edx, [ebp+4]
		sar	esi, 5
		lea	ebx, [esi+eax+1]
		mov	eax, [ebp+8]
		cmp	ebx, eax
		jle	short loc_4070BE

loc_4070B5:				; CODE XREF: sub_407090+2Cj
		add	eax, eax
		add	edx, 1
		cmp	ebx, eax
		jg	short loc_4070B5

loc_4070BE:				; CODE XREF: sub_407090+23j
		mov	[esp+3Ch+var_3C], edx
		call	sub_406D00
		test	eax, eax
		mov	[esp+3Ch+var_2C], eax
		jz	loc_40715E
		add	eax, 14h
		test	esi, esi
		jle	short loc_4070F6
		xor	edx, edx
		nop
		lea	esi, [esi+0]

loc_4070E0:				; CODE XREF: sub_407090+5Cj
		mov	dword ptr [eax+edx*4], 0
		add	edx, 1
		cmp	edx, esi
		jnz	short loc_4070E0
		mov	ecx, [esp+3Ch+var_2C]
		lea	eax, [ecx+edx*4+14h]

loc_4070F6:				; CODE XREF: sub_407090+47j
		mov	ecx, [ebp+10h]
		mov	esi, edi
		and	esi, 1Fh
		lea	edx, [ebp+14h]
		lea	ecx, [ebp+ecx*4+14h]
		mov	[esp+3Ch+var_28], ecx
		jz	short loc_407170
		mov	ecx, 20h
		xor	edi, edi
		sub	ecx, esi
		mov	[esp+3Ch+var_20], ebp
		mov	ebp, ecx
		mov	[esp+3Ch+var_24], ebx
		xchg	ax, ax

loc_407120:				; CODE XREF: sub_407090+AAj
		mov	ebx, [edx]
		mov	ecx, esi
		shl	ebx, cl
		mov	ecx, ebp
		or	ebx, edi
		mov	[eax], ebx
		mov	edi, [edx]
		add	eax, 4
		add	edx, 4
		shr	edi, cl
		cmp	[esp+3Ch+var_28], edx
		ja	short loc_407120
		mov	ebx, [esp+3Ch+var_24]
		cmp	edi, 1
		mov	ebp, [esp+3Ch+var_20]
		mov	[eax], edi
		sbb	ebx, 0FFFFFFFFh

loc_40714C:				; CODE XREF: sub_407090+F2j
		mov	eax, [esp+3Ch+var_2C]
		sub	ebx, 1
		mov	[eax+10h], ebx
		mov	[esp+3Ch+var_3C], ebp
		call	sub_406C90

loc_40715E:				; CODE XREF: sub_407090+3Cj
		mov	eax, [esp+3Ch+var_2C]
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_407170:				; CODE XREF: sub_407090+79j
		mov	esi, [esp+3Ch+var_28]

loc_407174:				; CODE XREF: sub_407090+F0j
		mov	ecx, [edx]
		add	edx, 4
		mov	[eax], ecx
		add	eax, 4
		cmp	esi, edx
		ja	short loc_407174
		jmp	short loc_40714C
sub_407090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407190	proc near		; CODE XREF: sub_404D30+C74p
					; sub_407440+7Fp ...

var_6C		= dword	ptr -6Ch
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	esi, [esp+6Ch+arg_0]
		mov	edi, [esp+6Ch+arg_4]
		mov	ebx, [esi+10h]
		mov	ebp, [edi+10h]
		cmp	ebx, ebp
		jl	loc_4072E0
		mov	eax, ebp
		mov	ebp, ebx
		mov	ebx, eax

loc_4071B3:				; CODE XREF: sub_407190+156j
		lea	eax, [ebp+ebx+0]
		cmp	eax, [esi+8]
		mov	[esp+6Ch+var_2C], eax
		setnle	al
		movzx	eax, al
		add	eax, [esi+4]
		mov	[esp+6Ch+var_6C], eax
		call	sub_406D00
		test	eax, eax
		mov	[esp+6Ch+var_28], eax
		jz	loc_4072CD
		mov	ecx, [esp+6Ch+var_2C]
		mov	edx, eax
		add	edx, 14h
		lea	ecx, [eax+ecx*4+14h]
		cmp	edx, ecx
		mov	[esp+6Ch+var_20], ecx
		jnb	short loc_4071FF
		mov	eax, edx

loc_4071F2:				; CODE XREF: sub_407190+6Dj
		mov	dword ptr [eax], 0
		add	eax, 4
		cmp	ecx, eax
		ja	short loc_4071F2

loc_4071FF:				; CODE XREF: sub_407190+5Ej
		lea	ecx, [edi+14h]
		lea	edi, [edi+ebx*4+14h]
		lea	eax, [esi+14h]
		cmp	ecx, edi
		lea	esi, [esi+ebp*4+14h]
		mov	[esp+6Ch+var_24], eax
		mov	[esp+6Ch+var_38], esi
		mov	[esp+6Ch+var_3C], ecx
		mov	[esp+6Ch+var_30], edi
		jnb	short loc_407290
		mov	[esp+6Ch+var_34], edx

loc_407225:				; CODE XREF: sub_407190+FDj
		mov	eax, [esp+6Ch+var_3C]
		mov	ebp, [eax]
		add	eax, 4
		mov	[esp+6Ch+var_3C], eax
		test	ebp, ebp
		jz	short loc_40727E
		mov	ecx, [esp+6Ch+var_34]
		xor	esi, esi
		xor	edi, edi
		mov	ebx, [esp+6Ch+var_24]

loc_407242:				; CODE XREF: sub_407190+EAj
		mov	eax, ebp
		mul	dword ptr [ebx]
		mov	[esp+6Ch+var_54], eax
		mov	eax, [ecx]
		mov	[esp+6Ch+var_50], edx
		xor	edx, edx
		add	[esp+6Ch+var_54], eax
		adc	[esp+6Ch+var_50], edx
		add	[esp+6Ch+var_54], esi
		adc	[esp+6Ch+var_50], edi
		add	ebx, 4
		mov	edi, [esp+6Ch+var_50]
		mov	edx, [esp+6Ch+var_54]
		mov	esi, edi
		xor	edi, edi
		mov	[ecx], edx
		add	ecx, 4
		cmp	[esp+6Ch+var_38], ebx
		ja	short loc_407242
		mov	[ecx], esi

loc_40727E:				; CODE XREF: sub_407190+A4j
		mov	ecx, [esp+6Ch+var_3C]
		cmp	[esp+6Ch+var_30], ecx
		jbe	short loc_407290
		add	[esp+6Ch+var_34], 4
		jmp	short loc_407225
; ---------------------------------------------------------------------------
		align 10h

loc_407290:				; CODE XREF: sub_407190+8Fj
					; sub_407190+F6j
		mov	ebp, [esp+6Ch+var_2C]
		test	ebp, ebp
		jle	short loc_4072C2
		mov	edx, [esp+6Ch+var_20]
		mov	eax, [esp+6Ch+var_20]
		mov	edi, [edx-4]
		sub	eax, 4
		test	edi, edi
		jnz	short loc_4072C2
		mov	edx, [esp+6Ch+var_2C]
		jmp	short loc_4072B9
; ---------------------------------------------------------------------------

loc_4072B0:				; CODE XREF: sub_407190+12Cj
		sub	eax, 4
		mov	esi, [eax]
		test	esi, esi
		jnz	short loc_4072BE

loc_4072B9:				; CODE XREF: sub_407190+11Ej
		sub	edx, 1
		jnz	short loc_4072B0

loc_4072BE:				; CODE XREF: sub_407190+127j
		mov	[esp+6Ch+var_2C], edx

loc_4072C2:				; CODE XREF: sub_407190+106j
					; sub_407190+118j
		mov	eax, [esp+6Ch+var_2C]
		mov	ecx, [esp+6Ch+var_28]
		mov	[ecx+10h], eax

loc_4072CD:				; CODE XREF: sub_407190+45j
		mov	eax, [esp+6Ch+var_28]
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4072E0:				; CODE XREF: sub_407190+17j
		mov	eax, esi
		mov	esi, edi
		mov	edi, eax
		jmp	loc_4071B3
sub_407190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4072F0	proc near		; CODE XREF: sub_404D30+BC1p
					; sub_407440+12Dp

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	[esp+1Ch+var_1C], 1
		call	sub_406D00
		test	eax, eax
		jz	short loc_407311
		mov	edx, [esp+1Ch+arg_0]
		mov	dword ptr [eax+10h], 1
		mov	[eax+14h], edx

loc_407311:				; CODE XREF: sub_4072F0+11j
		add	esp, 1Ch
		retn
sub_4072F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407320	proc near		; CODE XREF: sub_407440+C0p
					; sub_407750+89p ...

Dst		= dword	ptr -4Ch
Src		= dword	ptr -48h
Size		= dword	ptr -44h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, [esp+4Ch+arg_0]
		mov	ebx, [esp+4Ch+arg_8]
		mov	edi, [esp+4Ch+arg_0]
		mov	eax, [eax+10h]
		mov	esi, ebx
		add	edi, 14h
		sar	esi, 1Fh
		mov	[esp+4Ch+var_20], eax
		mov	eax, [esp+4Ch+arg_4]
		mov	edx, eax
		mov	[esp+4Ch+var_2C], eax
		sar	edx, 1Fh
		xor	eax, eax
		mov	[esp+4Ch+var_28], edx
		mov	[esp+4Ch+var_38], eax
		lea	esi, [esi+0]

loc_407360:				; CODE XREF: sub_407320+88j
		mov	edx, [esp+4Ch+var_38]
		mov	ebp, [esp+4Ch+var_28]
		mov	eax, [edi+edx*4]
		mov	[esp+4Ch+var_34], eax
		imul	ebp, eax
		mov	eax, [esp+4Ch+var_2C]
		mul	[esp+4Ch+var_34]
		add	edx, ebp
		mov	[esp+4Ch+var_34], eax
		mov	eax, [esp+4Ch+var_38]
		mov	[esp+4Ch+var_30], edx
		mov	edx, [esp+4Ch+var_34]
		mov	ecx, [esp+4Ch+var_30]
		add	edx, ebx
		adc	ecx, esi
		mov	esi, ecx
		mov	ebx, esi
		xor	esi, esi
		mov	[edi+eax*4], edx
		add	eax, 1
		cmp	[esp+4Ch+var_20], eax
		mov	[esp+4Ch+var_38], eax
		jg	short loc_407360
		mov	edx, esi
		or	edx, ebx
		jz	short loc_4073D5
		mov	eax, [esp+4Ch+arg_0]
		mov	edx, [esp+4Ch+var_20]
		cmp	edx, [eax+8]
		jge	short loc_4073E1

loc_4073BD:				; CODE XREF: sub_407320+10Dj
		mov	edx, [esp+4Ch+var_20]
		mov	eax, [esp+4Ch+arg_0]
		mov	[eax+edx*4+14h], ebx
		mov	eax, edx
		mov	edx, [esp+4Ch+arg_0]
		add	eax, 1
		mov	[edx+10h], eax

loc_4073D5:				; CODE XREF: sub_407320+8Ej
					; sub_407320+117j
		mov	eax, [esp+4Ch+arg_0]
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4073E1:				; CODE XREF: sub_407320+9Bj
		mov	eax, [eax+4]
		add	eax, 1
		mov	[esp+4Ch+Dst], eax
		call	sub_406D00
		test	eax, eax
		mov	edi, eax
		jz	short loc_40742F
		mov	edx, [esp+4Ch+arg_0]
		lea	ecx, [eax+0Ch]
		mov	eax, [edx+10h]
		mov	[esp+4Ch+Dst], ecx ; Dst
		lea	edx, ds:8[eax*4]
		mov	eax, [esp+4Ch+arg_0]
		mov	[esp+4Ch+Size],	edx ; Size
		add	eax, 0Ch
		mov	[esp+4Ch+Src], eax ; Src
		call	memcpy
		mov	eax, [esp+4Ch+arg_0]
		mov	[esp+4Ch+Dst], eax
		call	sub_406C90
		mov	[esp+4Ch+arg_0], edi
		jmp	short loc_4073BD
; ---------------------------------------------------------------------------

loc_40742F:				; CODE XREF: sub_407320+D3j
		mov	[esp+4Ch+arg_0], 0
		jmp	short loc_4073D5
sub_407320	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407440	proc near		; CODE XREF: sub_404D30+C64p
					; sub_404D30+CB5p

lpCriticalSection= dword ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [esp+3Ch+arg_4]
		mov	edi, [esp+3Ch+arg_0]
		mov	eax, ebx
		and	eax, 3
		jnz	loc_4074EA

loc_40745A:				; CODE XREF: sub_407440+C9j
		sar	ebx, 2
		test	ebx, ebx
		jz	short loc_4074E0
		mov	esi, ds:dword_40BD80
		test	esi, esi
		jz	loc_407511

loc_40746F:				; CODE XREF: sub_407440+ECj
					; sub_407440+100j
		mov	ebp, ds:LeaveCriticalSection
		jmp	short loc_407479
; ---------------------------------------------------------------------------

loc_407477:				; CODE XREF: sub_407440+46j
		mov	esi, eax

loc_407479:				; CODE XREF: sub_407440+35j
					; sub_407440+65j
		test	bl, 1
		jnz	short loc_4074B8

loc_40747E:				; CODE XREF: sub_407440+76j
		sar	ebx, 1
		jz	short loc_4074E0

loc_407482:				; CODE XREF: sub_407440+9Cj
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_407477
		mov	eax, 1
		call	sub_406B70
		mov	eax, [esi]
		test	eax, eax
		jz	loc_407549

loc_40749C:				; CODE XREF: sub_407440+121j
		cmp	ds:dword_40B3E0, 2
		mov	esi, eax
		jnz	short loc_407479
		mov	[esp+3Ch+lpCriticalSection], offset stru_40B418	; lpCriticalSection
		call	ebp ; LeaveCriticalSection
		sub	esp, 4
		test	bl, 1
		jz	short loc_40747E

loc_4074B8:				; CODE XREF: sub_407440+3Cj
		mov	[esp+3Ch+var_38], esi
		mov	[esp+3Ch+lpCriticalSection], edi
		call	sub_407190
		test	eax, eax
		jz	short loc_407545
		mov	[esp+3Ch+lpCriticalSection], edi
		mov	[esp+3Ch+var_20], eax
		call	sub_406C90
		mov	eax, [esp+3Ch+var_20]
		sar	ebx, 1
		mov	edi, eax
		jnz	short loc_407482
		xchg	ax, ax

loc_4074E0:				; CODE XREF: sub_407440+1Fj
					; sub_407440+40j ...
		add	esp, 2Ch
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4074EA:				; CODE XREF: sub_407440+14j
		mov	eax, ds:dword_40ABF4[eax*4]
		mov	[esp+3Ch+lpCriticalSection], edi
		mov	[esp+3Ch+var_34], 0
		mov	[esp+3Ch+var_38], eax
		call	sub_407320
		test	eax, eax
		mov	edi, eax
		jnz	loc_40745A
		jmp	short loc_4074E0
; ---------------------------------------------------------------------------

loc_407511:				; CODE XREF: sub_407440+29j
		mov	eax, 1
		call	sub_406B70
		mov	esi, ds:dword_40BD80
		test	esi, esi
		jz	short loc_407566

loc_407525:				; CODE XREF: sub_407440+143j
		cmp	ds:dword_40B3E0, 2
		jnz	loc_40746F
		mov	[esp+3Ch+lpCriticalSection], offset stru_40B418	; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	eax
		jmp	loc_40746F
; ---------------------------------------------------------------------------

loc_407545:				; CODE XREF: sub_407440+86j
					; sub_407440+119j ...
		xor	edi, edi
		jmp	short loc_4074E0
; ---------------------------------------------------------------------------

loc_407549:				; CODE XREF: sub_407440+56j
		mov	[esp+3Ch+var_38], esi
		mov	[esp+3Ch+lpCriticalSection], esi
		call	sub_407190
		test	eax, eax
		mov	[esi], eax
		jz	short loc_407545
		mov	dword ptr [eax], 0
		jmp	loc_40749C
; ---------------------------------------------------------------------------

loc_407566:				; CODE XREF: sub_407440+E3j
		mov	[esp+3Ch+lpCriticalSection], 271h
		call	sub_4072F0
		test	eax, eax
		mov	esi, eax
		mov	ds:dword_40BD80, eax
		jz	short loc_407545
		mov	dword ptr [eax], 0
		jmp	short loc_407525
sub_407440	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407590	proc near		; CODE XREF: sub_404D30+3B8p
					; sub_404D30+3D8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	ebx
		mov	esi, [esp+8+arg_0]
		mov	edx, [esp+8+arg_4]
		mov	ecx, [esi]
		lea	esi, [esi+0]

loc_4075A0:				; CODE XREF: sub_407590+2Fj
		movsx	ebx, byte ptr [edx]
		add	edx, 1
		test	ebx, ebx
		jz	short loc_4075C6
		add	ecx, 1
		movsx	eax, byte ptr [ecx]
		cmp	eax, 40h
		jle	short loc_4075BD
		cmp	eax, 5Ah
		jg	short loc_4075BD
		add	eax, 20h

loc_4075BD:				; CODE XREF: sub_407590+23j
					; sub_407590+28j
		cmp	eax, ebx
		jz	short loc_4075A0
		xor	eax, eax
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4075C6:				; CODE XREF: sub_407590+18j
		add	ecx, 1
		mov	eax, 1
		mov	[esi], ecx
		pop	ebx
		pop	esi
		retn
sub_407590	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4075E0	proc near		; CODE XREF: sub_4049F0+160p
					; sub_404D30+182p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		push	esi
		push	ebx
		mov	ecx, [esp+0Ch+arg_4]
		mov	edx, [esp+0Ch+arg_8]
		mov	eax, [esp+0Ch+arg_0]
		sub	ecx, 1
		sar	ecx, 5
		lea	ebx, [eax+ecx*4+4]
		mov	ecx, [edx+10h]
		lea	esi, [edx+14h]
		lea	ecx, [edx+ecx*4+10h]
		lea	edi, [ecx+4]
		cmp	esi, edi
		jnb	short loc_407639
		sub	ecx, edx
		xor	edx, edx
		lea	edi, [ecx-11h]
		shr	edi, 2
		add	edi, 1

loc_407617:				; CODE XREF: sub_4075E0+42j
		mov	ecx, [esi+edx*4]
		mov	[eax+edx*4], ecx
		add	edx, 1
		cmp	edx, edi
		jnz	short loc_407617
		lea	eax, [eax+edx*4]
		cmp	ebx, eax
		jbe	short loc_40763D
		nop
		lea	esi, [esi+0]

loc_407630:				; CODE XREF: sub_4075E0+5Bj
		mov	dword ptr [eax], 0
		add	eax, 4

loc_407639:				; CODE XREF: sub_4075E0+28j
		cmp	ebx, eax
		ja	short loc_407630

loc_40763D:				; CODE XREF: sub_4075E0+49j
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_4075E0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_407650
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407650	proc near		; CODE XREF: sub_4049F0+B3p
					; sub_4049F0+2F3p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	ebx
		mov	eax, [esp+8+arg_0]
		mov	ecx, [esp+8+arg_4]
		mov	edx, [eax+10h]
		mov	ebx, ecx
		sar	ebx, 5
		cmp	edx, ebx
		jl	short loc_407670
		jle	short loc_407695
		and	ecx, 1Fh
		mov	edx, ebx
		jnz	short loc_4076A5
		nop

loc_407670:				; CODE XREF: sub_407650+14j
					; sub_407650+47j ...
		lea	ecx, [eax+14h]
		lea	eax, [eax+edx*4+10h]
		lea	edx, [eax+4]
		cmp	ecx, edx
		jb	short loc_407687
		jmp	short loc_4076A0
; ---------------------------------------------------------------------------

loc_407680:				; CODE XREF: sub_407650+3Bj
		cmp	ecx, eax
		jnb	short loc_4076A0
		sub	eax, 4

loc_407687:				; CODE XREF: sub_407650+2Cj
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_407680

loc_40768D:				; CODE XREF: sub_407650+61j
		mov	eax, 1
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_407695:				; CODE XREF: sub_407650+16j
		mov	edx, ebx
		jmp	short loc_407670
; ---------------------------------------------------------------------------
		align 10h

loc_4076A0:				; CODE XREF: sub_407650+2Ej
					; sub_407650+32j
		xor	eax, eax
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4076A5:				; CODE XREF: sub_407650+1Dj
		mov	esi, [eax+ebx*4+14h]
		mov	ebx, esi
		shr	ebx, cl
		shl	ebx, cl
		cmp	ebx, esi
		jnz	short loc_40768D
		jmp	short loc_407670
sub_407650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4076C0	proc near		; CODE XREF: sub_404D30+D42p

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_3C		= qword	ptr -3Ch
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	ebx
		sub	esp, 44h
		mov	esi, [esp+4Ch+arg_0]
		lea	eax, [esp+4Ch+var_10]
		mov	ebx, [esp+4Ch+arg_4]
		mov	[esp+4Ch+var_48], eax
		mov	[esp+4Ch+var_4C], esi
		call	sub_406A70
		lea	eax, [esp+4Ch+var_14]
		mov	[esp+4Ch+var_48], eax
		mov	[esp+4Ch+var_4C], ebx
		fst	[esp+4Ch+var_2C]
		fstp	[esp+4Ch+var_3C]
		call	sub_406A70
		mov	eax, [esi+10h]
		sub	eax, [ebx+10h]
		mov	edx, [esp+4Ch+var_10]
		sub	edx, [esp+4Ch+var_14]
		shl	eax, 5
		lea	eax, [edx+eax]
		fst	[esp+4Ch+var_24]
		test	eax, eax
		fld	[esp+4Ch+var_3C]
		jle	short loc_407730
		fstp	st
		shl	eax, 14h
		add	dword ptr [esp+4Ch+var_2C+4], eax
		fld	[esp+4Ch+var_2C]
		add	esp, 44h
		fdivrp	st(1), st
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_407730:				; CODE XREF: sub_4076C0+53j
		fstp	st(1)
		shl	eax, 14h
		sub	dword ptr [esp+4Ch+var_24+4], eax
		fld	[esp+4Ch+var_24]
		add	esp, 44h
		fdivp	st(1), st
		pop	ebx
		pop	esi
		retn
sub_4076C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407750	proc near		; CODE XREF: sub_404D30+8CAp

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebp
		mov	edx, 38E38E39h
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [esp+3Ch+arg_8]
		mov	edi, [esp+3Ch+arg_0]
		mov	esi, [esp+3Ch+arg_4]
		lea	ecx, [ebx+8]
		mov	eax, ecx
		imul	edx
		mov	eax, 1
		sar	ecx, 1Fh
		sar	edx, 1
		sub	edx, ecx
		xor	ecx, ecx
		cmp	edx, 1
		jle	short loc_40778B

loc_407782:				; CODE XREF: sub_407750+39j
		add	eax, eax
		add	ecx, 1
		cmp	edx, eax
		jg	short loc_407782

loc_40778B:				; CODE XREF: sub_407750+30j
		mov	[esp+3Ch+var_3C], ecx
		mov	ebp, 9
		call	sub_406D00
		mov	edx, [esp+3Ch+arg_C]
		cmp	esi, 9
		mov	dword ptr [eax+10h], 1
		mov	ecx, [esp+3Ch+arg_10]
		mov	[eax+14h], edx
		lea	edx, [edi+ecx+9]
		jle	short loc_4077F0
		lea	edx, [edi+9]
		mov	[esp+3Ch+var_20], edx
		lea	esi, [esi+0]

loc_4077C0:				; CODE XREF: sub_407750+90j
		movsx	edx, byte ptr [edi+ebp]
		add	ebp, 1
		mov	[esp+3Ch+var_38], 0Ah
		mov	[esp+3Ch+var_3C], eax
		sub	edx, 30h
		mov	[esp+3Ch+var_34], edx
		call	sub_407320
		cmp	esi, ebp
		jg	short loc_4077C0
		mov	ecx, [esp+3Ch+var_20]
		mov	ebp, esi
		lea	edx, [ecx+esi-9]
		add	edx, [esp+3Ch+arg_10]

loc_4077F0:				; CODE XREF: sub_407750+61j
		cmp	ebx, ebp
		jle	short loc_40781D
		xor	esi, esi
		mov	edi, edx

loc_4077F8:				; CODE XREF: sub_407750+CBj
		movsx	edx, byte ptr [edi+esi]
		add	esi, 1
		mov	[esp+3Ch+var_38], 0Ah
		mov	[esp+3Ch+var_3C], eax
		sub	edx, 30h
		mov	[esp+3Ch+var_34], edx
		call	sub_407320
		lea	edx, [esi+ebp]
		cmp	ebx, edx
		jg	short loc_4077F8

loc_40781D:				; CODE XREF: sub_407750+A2j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_407750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407830	proc near		; CODE XREF: sub_404D30+D9Bp

Dst		= dword	ptr -4Ch
Src		= dword	ptr -48h
Size		= dword	ptr -44h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	edx, [esp+4Ch+arg_0]
		mov	esi, [esp+4Ch+arg_4]
		mov	eax, [edx+10h]
		cmp	eax, [esi+10h]
		jge	short loc_40784D
		mov	[esp+4Ch+arg_0], esi
		mov	esi, edx

loc_40784D:				; CODE XREF: sub_407830+15j
		mov	ecx, [esp+4Ch+arg_0]
		lea	ebx, [esi+14h]
		mov	eax, [ecx+4]
		mov	[esp+4Ch+Dst], eax
		call	sub_406D00
		mov	[esp+4Ch+var_28], eax
		mov	eax, [esp+4Ch+arg_0]
		mov	edx, [esp+4Ch+var_28]
		mov	ecx, [esp+4Ch+var_28]
		mov	eax, [eax+10h]
		mov	[edx+10h], eax
		mov	esi, [esi+10h]
		mov	[esp+4Ch+var_24], eax
		mov	edx, [esp+4Ch+arg_0]
		mov	eax, [esp+4Ch+var_28]
		lea	ecx, [ecx+esi*4+14h]
		mov	[esp+4Ch+var_2C], ecx
		xor	ecx, ecx
		add	edx, 14h
		add	eax, 14h
		mov	[esp+4Ch+var_20], esi
		mov	[esp+4Ch+var_30], ecx
		lea	esi, [esi+0]

loc_4078A0:				; CODE XREF: sub_407830+BFj
		mov	esi, [ebx]
		add	ebx, 4
		movzx	edi, word ptr [edx]
		mov	ecx, [edx]
		add	edx, 4
		mov	ebp, esi
		and	ebp, 0FFFFh
		lea	edi, [ebp+edi+0]
		add	edi, [esp+4Ch+var_30]
		shr	ecx, 10h
		shr	esi, 10h
		add	esi, ecx
		mov	ecx, edi
		and	ecx, 10000h
		shr	ecx, 10h
		add	esi, ecx
		mov	ecx, esi
		and	ecx, 10000h
		shr	ecx, 10h
		mov	[eax+2], si
		mov	[eax], di
		add	eax, 4
		cmp	[esp+4Ch+var_2C], eax
		mov	[esp+4Ch+var_30], ecx
		ja	short loc_4078A0
		mov	esi, [esp+4Ch+arg_0]
		mov	ebx, [esi+10h]
		mov	esi, [esp+4Ch+var_2C]
		sub	ebx, [esp+4Ch+var_20]
		lea	edi, [esi+ebx*4]
		cmp	eax, edi
		jnb	short loc_40793B

loc_407907:				; CODE XREF: sub_407830+109j
		mov	esi, [edx]
		add	edx, 4
		mov	ebx, esi
		and	ebx, 0FFFFh
		lea	ebx, [ecx+ebx]
		mov	ecx, ebx
		and	ecx, 10000h
		shr	ecx, 10h
		shr	esi, 10h
		lea	esi, [ecx+esi]
		mov	ecx, esi
		mov	[eax+2], si
		shr	ecx, 10h
		mov	[eax], bx
		add	eax, 4
		cmp	edi, eax
		ja	short loc_407907

loc_40793B:				; CODE XREF: sub_407830+D5j
		test	ecx, ecx
		jz	short loc_407964
		mov	eax, [esp+4Ch+var_28]
		mov	edx, [esp+4Ch+var_24]
		cmp	edx, [eax+8]
		jz	short loc_407970

loc_40794C:				; CODE XREF: sub_407830+189j
		mov	edx, [esp+4Ch+var_24]
		mov	ecx, [esp+4Ch+var_28]
		mov	eax, edx
		add	eax, 1
		mov	dword ptr [ecx+edx*4+14h], 1
		mov	[ecx+10h], eax

loc_407964:				; CODE XREF: sub_407830+10Dj
		mov	eax, [esp+4Ch+var_28]
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_407970:				; CODE XREF: sub_407830+11Aj
		mov	eax, [eax+4]
		add	eax, 1
		mov	[esp+4Ch+Dst], eax
		call	sub_406D00
		mov	esi, [esp+4Ch+var_28]
		mov	edx, [esi+10h]
		mov	ebx, eax
		lea	eax, [eax+0Ch]
		lea	ecx, ds:8[edx*4]
		mov	edx, esi
		add	edx, 0Ch
		mov	[esp+4Ch+Size],	ecx ; Size
		mov	[esp+4Ch+Src], edx ; Src
		mov	[esp+4Ch+Dst], eax ; Dst
		call	memcpy
		mov	[esp+4Ch+Dst], esi
		call	sub_406C90
		mov	eax, [ebx+10h]
		mov	[esp+4Ch+var_28], ebx
		mov	[esp+4Ch+var_24], eax
		jmp	short loc_40794C
sub_407830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4079C0	proc near		; CODE XREF: sub_4049F0+D1p
					; sub_4049F0+26Fp ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebp, [esp+20h+arg_0]
		mov	ecx, [esp+20h+arg_4]
		mov	edx, [ebp+10h]
		lea	edi, [ebp+14h]
		mov	ebx, ecx
		mov	eax, edi
		sar	ebx, 5
		cmp	ebx, edx
		jge	loc_407A71
		lea	edx, [ebp+edx*4+10h]
		add	ebx, 4
		mov	[esp+20h+var_20], edx
		add	edx, 4
		and	ecx, 1Fh
		mov	[esp+20h+var_18], edx
		lea	edx, [ebp+ebx*4+0]
		lea	esi, [edx+4]
		mov	[esp+20h+var_14], ecx
		jz	loc_407A90
		mov	ecx, [esp+20h+var_14]
		mov	ebx, [ebp+ebx*4+4]
		mov	[esp+20h+var_1C], 20h
		sub	[esp+20h+var_1C], ecx
		shr	ebx, cl
		lea	ecx, [edx+8]
		cmp	[esp+20h+var_18], ecx
		jbe	short loc_407A6B
		mov	eax, [esp+20h+var_20]
		mov	[esp+20h+var_18], ebp
		mov	ebp, [esp+20h+var_14]
		sub	eax, edx
		sub	eax, 5
		shr	eax, 2
		add	eax, 1
		mov	[esp+20h+var_20], eax
		xor	eax, eax

loc_407A43:				; CODE XREF: sub_4079C0+A1j
		mov	edx, [esi+eax*4+4]
		movzx	ecx, byte ptr [esp+20h+var_1C]
		shl	edx, cl
		mov	ecx, ebp
		or	edx, ebx
		mov	[edi+eax*4], edx
		mov	ebx, [esi+eax*4+4]
		add	eax, 1
		shr	ebx, cl
		cmp	eax, [esp+20h+var_20]
		jnz	short loc_407A43
		mov	ebp, [esp+20h+var_18]
		lea	eax, [ebp+eax*4+14h]

loc_407A6B:				; CODE XREF: sub_4079C0+66j
		test	ebx, ebx
		mov	[eax], ebx
		jnz	short loc_407AC0

loc_407A71:				; CODE XREF: sub_4079C0+1Ej
					; sub_4079C0+D4j ...
		sub	eax, edi
		sar	eax, 2
		test	eax, eax
		mov	[ebp+10h], eax
		jnz	short loc_407A84
		mov	dword ptr [ebp+14h], 0

loc_407A84:				; CODE XREF: sub_4079C0+BBj
		add	esp, 10h
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_407A90:				; CODE XREF: sub_4079C0+43j
		cmp	[esp+20h+var_18], esi
		jbe	short loc_407A71
		mov	eax, [esp+20h+var_20]
		not	edx
		lea	ecx, [edx+eax]
		xor	eax, eax
		shr	ecx, 2
		add	ecx, 1

loc_407AA6:				; CODE XREF: sub_4079C0+F1j
		mov	edx, [esi+eax*4]
		mov	[edi+eax*4], edx
		add	eax, 1
		cmp	eax, ecx
		jnz	short loc_407AA6
		lea	eax, [ebp+eax*4+14h]
		jmp	short loc_407A71
; ---------------------------------------------------------------------------
		align 10h

loc_407AC0:				; CODE XREF: sub_4079C0+AFj
		add	eax, 4
		jmp	short loc_407A71
sub_4079C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407AD0	proc near		; CODE XREF: sub_404D30+FA0p

arg_0		= dword	ptr  4

		push	ebx
		mov	ecx, [esp+4+arg_0]
		mov	eax, [ecx+10h]
		lea	edx, [ecx+14h]
		lea	ebx, [ecx+eax*4+14h]
		xor	eax, eax
		cmp	edx, ebx
		jnb	short loc_407B00
		cmp	dword ptr [ecx+14h], 0
		jz	short loc_407AF6
		jmp	short loc_407B02
; ---------------------------------------------------------------------------
		align 10h

loc_407AF0:				; CODE XREF: sub_407AD0+2Ej
		mov	ecx, [edx]
		test	ecx, ecx
		jnz	short loc_407B05

loc_407AF6:				; CODE XREF: sub_407AD0+19j
		add	edx, 4
		add	eax, 20h
		cmp	ebx, edx
		ja	short loc_407AF0

loc_407B00:				; CODE XREF: sub_407AD0+13j
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_407B02:				; CODE XREF: sub_407AD0+1Bj
		mov	ecx, [ecx+14h]

loc_407B05:				; CODE XREF: sub_407AD0+24j
		bsf	ecx, ecx
		pop	ebx
		add	eax, ecx
		retn
sub_407AD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_407B10	proc near		; CODE XREF: sub_404D30+1573p

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		call	localeconv
		cmp	ds:byte_40BE10,	0
		mov	edi, [eax]
		jz	loc_408076

loc_407B2B:				; CODE XREF: sub_407B10+56Bj
		mov	ecx, [esp+4Ch+arg_0]
		mov	eax, [esp+4Ch+arg_C]
		mov	edx, [ecx]
		mov	dword ptr [eax], 0
		xor	eax, eax
		movzx	ecx, byte ptr [edx+2]
		lea	ebx, [edx+2]
		cmp	cl, 30h
		jnz	short loc_407B60
		add	edx, 3
		lea	esi, [esi+0]

loc_407B50:				; CODE XREF: sub_407B10+4Ej
		movzx	ecx, byte ptr [edx]
		add	eax, 1
		mov	ebx, edx
		add	edx, 1
		cmp	cl, 30h
		jz	short loc_407B50

loc_407B60:				; CODE XREF: sub_407B10+37j
		movzx	ecx, cl
		cmp	ds:byte_40BDE0[ecx], 0
		jnz	loc_407C04
		movzx	ecx, byte ptr [edi]
		xor	ebp, ebp
		test	cl, cl
		jz	short loc_407BA8
		movzx	ebp, byte ptr [ebx]
		xor	esi, esi
		mov	edx, ebp
		cmp	cl, dl
		jnz	loc_408084
		mov	edx, esi
		mov	esi, eax
		jmp	short loc_407B99
; ---------------------------------------------------------------------------
		align 10h

loc_407B90:				; CODE XREF: sub_407B10+94j
		cmp	al, [ebx+edx]
		jnz	loc_408080

loc_407B99:				; CODE XREF: sub_407B10+7Cj
		add	edx, 1
		movzx	eax, byte ptr [edi+edx]
		mov	ebp, edx
		test	al, al
		jnz	short loc_407B90
		mov	eax, esi

loc_407BA8:				; CODE XREF: sub_407B10+67j
		lea	ebp, [ebx+ebp]
		mov	[esp+4Ch+var_34], ebp
		movzx	ebp, byte ptr [ebp+0]
		mov	edx, ebp
		movzx	esi, dl
		cmp	ds:byte_40BDE0[esi], 0
		jz	loc_408100
		mov	eax, ebp
		cmp	al, 30h
		jnz	loc_4081DF
		mov	esi, [esp+4Ch+var_34]

loc_407BD3:				; CODE XREF: sub_407B10+CCj
		add	esi, 1
		movzx	edx, byte ptr [esi]
		cmp	dl, 30h
		jz	short loc_407BD3
		movzx	eax, dl
		cmp	ds:byte_40BDE0[eax], 0
		jnz	loc_4081E5
		mov	ebx, esi
		mov	eax, 1
		mov	byte ptr [esp+4Ch+var_2C], 0
		mov	[esp+4Ch+var_28], 1
		jmp	short loc_407C2C
; ---------------------------------------------------------------------------

loc_407C04:				; CODE XREF: sub_407B10+5Aj
		movzx	ecx, byte ptr [edi]
		add	eax, 1
		mov	esi, ebx
		mov	byte ptr [esp+4Ch+var_2C], 1
		mov	[esp+4Ch+var_28], 0
		mov	[esp+4Ch+var_34], 0
		movzx	edx, byte ptr [ebx]
		jmp	short loc_407C2C
; ---------------------------------------------------------------------------

loc_407C26:				; CODE XREF: sub_407B10+126j
		add	esi, 1
		movzx	edx, byte ptr [esi]

loc_407C2C:				; CODE XREF: sub_407B10+F2j
					; sub_407B10+114j ...
		movzx	ebp, dl
		cmp	ss:byte_40BDE0[ebp], 0
		jnz	short loc_407C26
		cmp	dl, cl
		jz	loc_407D61

loc_407C40:				; CODE XREF: sub_407B10+256j
					; sub_407B10+2E8j ...
		mov	ebp, edx
		mov	edx, [esp+4Ch+var_34]
		mov	[esp+4Ch+var_2C], 0
		test	edx, edx
		jz	short loc_407C5F
		mov	ecx, [esp+4Ch+var_34]
		sub	ecx, esi
		shl	ecx, 2
		mov	[esp+4Ch+var_2C], ecx

loc_407C5F:				; CODE XREF: sub_407B10+140j
					; sub_407B10+28Aj ...
		mov	edx, ebp
		cmp	dl, 50h
		jz	loc_407E00
		cmp	dl, 70h
		jz	loc_407E00
		mov	edx, esi
		mov	[esp+4Ch+var_24], 0
		mov	[esp+4Ch+var_34], 0

loc_407C85:				; CODE XREF: sub_407B10+38Bj
					; sub_407B10+39Aj
		mov	ecx, [esp+4Ch+arg_0]
		test	eax, eax
		mov	[ecx], edx
		jnz	short loc_407C94
		lea	eax, [ebx-1]
		mov	[ecx], eax

loc_407C94:				; CODE XREF: sub_407B10+17Dj
		mov	eax, [esp+4Ch+var_28]
		xor	ebp, ebp
		test	eax, eax
		jnz	loc_407D57
		mov	ebp, [esp+4Ch+var_34]
		test	ebp, ebp
		jz	loc_407EB0
		mov	esi, [esp+4Ch+var_24]
		test	esi, esi
		jnz	loc_4080A0
		mov	edx, [esp+4Ch+arg_4]
		mov	eax, [edx+0Ch]
		cmp	eax, 2
		jz	loc_40832D
		cmp	eax, 3
		jz	loc_40831C
		cmp	eax, 1
		jz	loc_4080DF

loc_407CDC:				; CODE XREF: sub_407B10+818j
					; sub_407B10+829j
		mov	ecx, [esp+4Ch+arg_4]
		mov	edi, [ecx]
		mov	ebx, edi
		sar	ebx, 5
		and	edi, 1Fh
		jnz	loc_408292
		mov	esi, ebx

loc_407CF2:				; CODE XREF: sub_407B10+785j
		mov	eax, esi
		xor	edx, edx
		sar	eax, 1
		jz	short loc_407D07
		lea	esi, [esi+0]

loc_407D00:				; CODE XREF: sub_407B10+1F5j
		add	edx, 1
		sar	eax, 1
		jnz	short loc_407D00

loc_407D07:				; CODE XREF: sub_407B10+1E8j
		mov	[esp+4Ch+var_4C], edx
		call	sub_406D00
		mov	ebp, [esp+4Ch+arg_C]
		xor	ecx, ecx
		xor	edx, edx
		test	ebx, ebx
		mov	[ebp+0], eax
		mov	[eax+10h], esi
		jle	short loc_407D32

loc_407D21:				; CODE XREF: sub_407B10+21Ej
		mov	dword ptr [eax+ecx*4+14h], 0FFFFFFFFh
		add	ecx, 1
		cmp	ecx, ebx
		jnz	short loc_407D21
		mov	edx, ebx

loc_407D32:				; CODE XREF: sub_407B10+20Fj
		cmp	esi, ebx
		jle	short loc_407D45
		mov	ebx, 20h
		mov	ecx, ebx
		sub	ecx, edi
		sar	ebx, cl
		mov	[eax+edx*4+14h], ebx

loc_407D45:				; CODE XREF: sub_407B10+224j
		mov	edx, [esp+4Ch+arg_4]
		mov	ebp, 11h
		mov	ecx, [esp+4Ch+arg_8]
		mov	eax, [edx+4]
		mov	[ecx], eax

loc_407D57:				; CODE XREF: sub_407B10+18Cj
					; sub_407B10+740j
		add	esp, 3Ch
		mov	eax, ebp
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_407D61:				; CODE XREF: sub_407B10+12Aj
		cmp	byte ptr [esp+4Ch+var_2C], 0
		jz	loc_407C40
		movzx	ecx, byte ptr [edi+1]
		mov	byte ptr [esp+4Ch+var_34], cl
		mov	ecx, 1
		cmp	byte ptr [esp+4Ch+var_34], 0
		jz	short loc_407DC8
		movzx	ecx, byte ptr [esp+4Ch+var_34]
		mov	ebp, edx
		mov	[esp+4Ch+var_30], 1
		mov	[esp+4Ch+var_2C], 0
		cmp	cl, [esi+1]
		jnz	loc_407C5F
		mov	ecx, 1
		mov	[esp+4Ch+var_2C], eax
		jmp	short loc_407DB9
; ---------------------------------------------------------------------------
		align 10h

loc_407DB0:				; CODE XREF: sub_407B10+2B2j
		cmp	al, [esi+ecx]
		jnz	loc_408160

loc_407DB9:				; CODE XREF: sub_407B10+299j
		add	ecx, 1
		movzx	eax, byte ptr [edi+ecx]
		test	al, al
		jnz	short loc_407DB0
		mov	eax, [esp+4Ch+var_2C]

loc_407DC8:				; CODE XREF: sub_407B10+26Ej
		add	esi, ecx
		movzx	ecx, byte ptr [esi]
		mov	edx, esi
		cmp	ds:byte_40BDE0[ecx], 0
		jz	loc_40839A
		lea	esi, [esi+0]

loc_407DE0:				; CODE XREF: sub_407B10+2DDj
		add	edx, 1
		movzx	ecx, byte ptr [edx]
		cmp	ds:byte_40BDE0[ecx], 0
		jnz	short loc_407DE0
		mov	[esp+4Ch+var_34], esi
		mov	esi, edx
		movzx	edx, byte ptr [edx]
		jmp	loc_407C40
; ---------------------------------------------------------------------------
		align 10h

loc_407E00:				; CODE XREF: sub_407B10+154j
					; sub_407B10+15Dj
		movzx	edx, byte ptr [esi+1]
		lea	ebp, [esi+1]
		cmp	dl, 2Bh
		jz	loc_408155
		cmp	dl, 2Dh
		mov	[esp+4Ch+var_24], 0
		jz	loc_408141

loc_407E21:				; CODE XREF: sub_407B10+640j
		movzx	edx, dl
		movzx	ecx, ds:byte_40BDE0[edx]
		test	ecx, ecx
		jz	short loc_407EA0
		cmp	ecx, 19h
		jg	short loc_407EA0
		lea	edx, [ebp+1]
		movzx	ebp, byte ptr [ebp+1]
		sub	ecx, 10h
		movzx	ebp, ss:byte_40BDE0[ebp]
		test	ebp, ebp
		jz	loc_4083A6
		cmp	ebp, 19h
		jg	loc_4083A6
		mov	[esp+4Ch+var_34], 0
		jmp	short loc_407E65
; ---------------------------------------------------------------------------

loc_407E60:				; CODE XREF: sub_407B10+37Bj
		cmp	ebp, 19h
		jg	short loc_407E8D

loc_407E65:				; CODE XREF: sub_407B10+34Ej
		test	ecx, 0F8000000h
		jz	short loc_407E75
		mov	[esp+4Ch+var_34], 1

loc_407E75:				; CODE XREF: sub_407B10+35Bj
		add	edx, 1
		lea	ecx, [ecx+ecx*4]
		lea	ecx, [ebp+ecx*2-10h]
		movzx	ebp, byte ptr [edx]
		movzx	ebp, ss:byte_40BDE0[ebp]
		test	ebp, ebp
		jnz	short loc_407E60

loc_407E8D:				; CODE XREF: sub_407B10+353j
					; sub_407B10+89Ej
		mov	ebp, [esp+4Ch+var_24]
		test	ebp, ebp
		jz	short loc_407E97
		neg	ecx

loc_407E97:				; CODE XREF: sub_407B10+383j
		add	[esp+4Ch+var_2C], ecx
		jmp	loc_407C85
; ---------------------------------------------------------------------------

loc_407EA0:				; CODE XREF: sub_407B10+31Dj
					; sub_407B10+322j
		mov	edx, esi
		mov	[esp+4Ch+var_34], 0
		jmp	loc_407C85
; ---------------------------------------------------------------------------
		align 10h

loc_407EB0:				; CODE XREF: sub_407B10+198j
		lea	eax, [esi-1]
		xor	edx, edx
		sub	eax, ebx
		cmp	eax, 7
		jle	short loc_407ECA
		lea	esi, [esi+0]

loc_407EC0:				; CODE XREF: sub_407B10+3B8j
		sar	eax, 1
		add	edx, 1
		cmp	eax, 7
		jg	short loc_407EC0

loc_407ECA:				; CODE XREF: sub_407B10+3AAj
		mov	[esp+4Ch+var_4C], edx
		call	sub_406D00
		xor	edx, edx
		mov	[esp+4Ch+var_34], eax
		add	eax, 14h
		mov	[esp+4Ch+var_28], eax
		mov	[esp+4Ch+var_20], eax
		xor	eax, eax
		cmp	byte ptr [edi+1], 0
		jz	short loc_407EFC
		nop
		lea	esi, [esi+0]

loc_407EF0:				; CODE XREF: sub_407B10+3EAj
		add	edx, 1
		cmp	byte ptr [edi+edx+1], 0
		mov	eax, edx
		jnz	short loc_407EF0

loc_407EFC:				; CODE XREF: sub_407B10+3D9j
		cmp	ebx, esi
		jnb	loc_40833E
		mov	edx, [esp+4Ch+var_28]
		lea	ebp, [edi+eax]
		neg	eax
		xor	ecx, ecx
		mov	edi, ebx
		mov	[esp+4Ch+var_24], eax
		mov	[esp+4Ch+var_30], edx
		xor	edx, edx
		jmp	short loc_407F43
; ---------------------------------------------------------------------------
		align 10h

loc_407F20:				; CODE XREF: sub_407B10+43Cj
		cmp	ecx, 20h
		lea	ebx, [ecx+4]
		jz	loc_408058

loc_407F2C:				; CODE XREF: sub_407B10+561j
		movzx	eax, al
		movzx	eax, ds:byte_40BDE0[eax]
		and	eax, 0Fh
		shl	eax, cl
		or	edx, eax
		cmp	edi, esi
		jnb	short loc_407F58

loc_407F41:				; CODE XREF: sub_407B10+446j
		mov	ecx, ebx

loc_407F43:				; CODE XREF: sub_407B10+40Bj
		sub	esi, 1
		movzx	eax, byte ptr [esi]
		cmp	al, [ebp+0]
		jnz	short loc_407F20
		add	esi, [esp+4Ch+var_24]
		mov	ebx, ecx
		cmp	edi, esi
		jb	short loc_407F41

loc_407F58:				; CODE XREF: sub_407B10+42Fj
		bsr	eax, edx
		xor	eax, 1Fh

loc_407F5E:				; CODE XREF: sub_407B10+83Dj
		mov	ebp, [esp+4Ch+var_30]
		mov	ecx, [esp+4Ch+arg_4]
		mov	edi, ebp
		add	edi, 4
		mov	[ebp+0], edx
		mov	edx, [esp+4Ch+var_34]
		sub	edi, [esp+4Ch+var_28]
		sar	edi, 2
		mov	[edx+10h], edi
		mov	ebx, [ecx]
		shl	edi, 5
		sub	edi, eax
		cmp	edi, ebx
		jg	loc_408173
		jl	loc_408119

loc_407F91:				; CODE XREF: sub_407B10+62Cj
		xor	esi, esi

loc_407F93:				; CODE XREF: sub_407B10+6CAj
		mov	ebp, [esp+4Ch+arg_4]
		mov	eax, [esp+4Ch+var_2C]
		cmp	eax, [ebp+8]
		jg	loc_4080D3
		mov	ecx, [esp+4Ch+arg_4]
		mov	ebp, 1
		mov	edi, [ecx+4]
		cmp	[esp+4Ch+var_2C], edi
		jge	short loc_408011
		sub	edi, [esp+4Ch+var_2C]
		cmp	ebx, edi
		jle	loc_408263
		test	esi, esi
		lea	ebp, [edi-1]
		jz	loc_408352
		mov	esi, 1

loc_407FD2:				; CODE XREF: sub_407B10+844j
					; sub_407B10+85Cj
		mov	ecx, ebp
		mov	eax, 1
		and	ecx, 1Fh
		mov	edx, ebp
		shl	eax, cl
		mov	ecx, [esp+4Ch+var_20]
		sar	edx, 5
		test	[ecx+edx*4], eax
		jz	short loc_407FEF
		or	esi, 2

loc_407FEF:				; CODE XREF: sub_407B10+4DAj
		mov	ebp, [esp+4Ch+var_34]
		sub	ebx, edi
		mov	[esp+4Ch+var_48], edi
		mov	[esp+4Ch+var_4C], ebp
		mov	ebp, 2
		call	sub_4079C0
		mov	eax, [esp+4Ch+arg_4]
		mov	eax, [eax+4]
		mov	[esp+4Ch+var_2C], eax

loc_408011:				; CODE XREF: sub_407B10+4A4j
		test	esi, esi
		jz	short loc_40803A
		mov	edx, [esp+4Ch+arg_4]
		mov	eax, [edx+0Ch]
		cmp	eax, 2
		jz	loc_40829A
		cmp	eax, 3
		jz	loc_408391
		cmp	eax, 1
		jz	loc_408371

loc_408037:				; CODE XREF: sub_407B10+795j
					; sub_407B10+867j ...
		or	ebp, 10h

loc_40803A:				; CODE XREF: sub_407B10+503j
					; sub_407B10+807j ...
		mov	eax, [esp+4Ch+arg_C]
		mov	edx, [esp+4Ch+var_34]
		mov	ecx, [esp+4Ch+arg_8]
		mov	[eax], edx
		mov	eax, [esp+4Ch+var_2C]
		mov	[ecx], eax
		add	esp, 3Ch
		mov	eax, ebp
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_408058:				; CODE XREF: sub_407B10+416j
		mov	ecx, [esp+4Ch+var_30]
		mov	ebx, 4
		mov	[ecx], edx
		add	ecx, 4
		xor	edx, edx
		mov	[esp+4Ch+var_30], ecx
		xor	ecx, ecx
		movzx	eax, byte ptr [esi]
		jmp	loc_407F2C
; ---------------------------------------------------------------------------

loc_408076:				; CODE XREF: sub_407B10+15j
		call	sub_4087E0
		jmp	loc_407B2B
; ---------------------------------------------------------------------------

loc_408080:				; CODE XREF: sub_407B10+83j
		mov	eax, esi
		mov	ebp, ecx

loc_408084:				; CODE XREF: sub_407B10+72j
		mov	esi, ebx
		mov	[esp+4Ch+var_2C], 0
		mov	[esp+4Ch+var_28], 1
		jmp	loc_407C5F
; ---------------------------------------------------------------------------
		align 10h

loc_4080A0:				; CODE XREF: sub_407B10+1A4j
		mov	ebp, [esp+4Ch+arg_4]
		mov	eax, [ebp+0Ch]
		cmp	eax, 2
		jz	loc_408255
		cmp	eax, 3
		jz	loc_4081FE

loc_4080B9:				; CODE XREF: sub_407B10+6F4j
					; sub_407B10+74Bj ...
		call	_errno
		mov	ebp, 50h
		mov	dword ptr [eax], 22h
		add	esp, 3Ch
		mov	eax, ebp
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4080D3:				; CODE XREF: sub_407B10+48Ej
					; sub_407B10+7FCj
		mov	edx, [esp+4Ch+var_34]
		mov	[esp+4Ch+var_4C], edx
		call	sub_406C90

loc_4080DF:				; CODE XREF: sub_407B10+1C6j
					; sub_407B10+812j ...
		call	_errno
		mov	ebp, 0A3h
		mov	dword ptr [eax], 22h
		add	esp, 3Ch
		mov	eax, ebp
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_408100:				; CODE XREF: sub_407B10+AFj
		mov	esi, [esp+4Ch+var_34]
		mov	[esp+4Ch+var_2C], 0
		mov	[esp+4Ch+var_28], 1
		jmp	loc_407C5F
; ---------------------------------------------------------------------------

loc_408119:				; CODE XREF: sub_407B10+47Bj
		mov	ecx, [esp+4Ch+var_34]
		mov	esi, ebx
		sub	esi, edi
		mov	[esp+4Ch+var_48], esi
		mov	[esp+4Ch+var_4C], ecx
		call	sub_407090
		sub	[esp+4Ch+var_2C], esi
		mov	[esp+4Ch+var_34], eax
		add	eax, 14h
		mov	[esp+4Ch+var_20], eax
		jmp	loc_407F91
; ---------------------------------------------------------------------------

loc_408141:				; CODE XREF: sub_407B10+30Bj
		mov	[esp+4Ch+var_24], 1

loc_408149:				; CODE XREF: sub_407B10+64Dj
		add	ebp, 1
		movzx	edx, byte ptr [ebp+0]
		jmp	loc_407E21
; ---------------------------------------------------------------------------

loc_408155:				; CODE XREF: sub_407B10+2FAj
		mov	[esp+4Ch+var_24], 0
		jmp	short loc_408149
; ---------------------------------------------------------------------------
		align 10h

loc_408160:				; CODE XREF: sub_407B10+2A3j
		mov	eax, [esp+4Ch+var_2C]
		mov	ebp, edx
		mov	[esp+4Ch+var_2C], 0
		jmp	loc_407C5F
; ---------------------------------------------------------------------------

loc_408173:				; CODE XREF: sub_407B10+475j
		sub	edi, ebx
		xor	esi, esi
		mov	[esp+4Ch+var_48], edi
		mov	[esp+4Ch+var_4C], edx
		call	sub_407650
		test	eax, eax
		jz	short loc_4081C6
		lea	edx, [edi-1]
		mov	ebp, [esp+4Ch+var_34]
		mov	eax, 1
		mov	ecx, edx
		mov	si, 1
		and	ecx, 1Fh
		shl	eax, cl
		mov	ecx, edx
		sar	ecx, 5
		test	[ebp+ecx*4+14h], eax
		jz	short loc_4081C6
		test	edx, edx
		jle	short loc_4081C1
		mov	[esp+4Ch+var_48], edx
		mov	si, 3
		mov	[esp+4Ch+var_4C], ebp
		call	sub_407650
		test	eax, eax
		jnz	short loc_4081C6

loc_4081C1:				; CODE XREF: sub_407B10+69Bj
		mov	esi, 2

loc_4081C6:				; CODE XREF: sub_407B10+675j
					; sub_407B10+697j ...
		mov	edx, [esp+4Ch+var_34]
		mov	[esp+4Ch+var_48], edi
		mov	[esp+4Ch+var_4C], edx
		call	sub_4079C0
		add	[esp+4Ch+var_2C], edi
		jmp	loc_407F93
; ---------------------------------------------------------------------------

loc_4081DF:				; CODE XREF: sub_407B10+B9j
		mov	esi, [esp+4Ch+var_34]
		mov	edx, ebp

loc_4081E5:				; CODE XREF: sub_407B10+D8j
		mov	ebx, esi
		mov	eax, 1
		mov	byte ptr [esp+4Ch+var_2C], 0
		mov	[esp+4Ch+var_28], 0
		jmp	loc_407C2C
; ---------------------------------------------------------------------------

loc_4081FE:				; CODE XREF: sub_407B10+5A3j
		mov	ecx, [esp+4Ch+arg_10]
		test	ecx, ecx
		jz	loc_4080B9

loc_40820A:				; CODE XREF: sub_407B10+751j
		mov	[esp+4Ch+var_4C], 0
		call	sub_406D00
		mov	[esp+4Ch+var_34], eax
		mov	dword ptr [eax+10h], 1
		mov	dword ptr [eax+14h], 1

loc_408228:				; CODE XREF: sub_407B10+8C7j
		mov	eax, [esp+4Ch+var_34]
		mov	ebp, [esp+4Ch+arg_C]
		mov	edx, [esp+4Ch+arg_4]
		mov	ecx, [esp+4Ch+arg_8]
		mov	[ebp+0], eax
		mov	ebp, 62h
		mov	eax, [edx+4]
		mov	[ecx], eax
		call	_errno
		mov	dword ptr [eax], 22h
		jmp	loc_407D57
; ---------------------------------------------------------------------------

loc_408255:				; CODE XREF: sub_407B10+59Aj
		mov	ebx, [esp+4Ch+arg_10]
		test	ebx, ebx
		jnz	loc_4080B9
		jmp	short loc_40820A
; ---------------------------------------------------------------------------

loc_408263:				; CODE XREF: sub_407B10+4ACj
		mov	eax, [ecx+0Ch]
		cmp	eax, 2
		jz	loc_4083E9
		cmp	eax, 3
		jz	loc_4083DC
		cmp	eax, 1
		jz	loc_4083B3

loc_408281:				; CODE XREF: sub_407B10+8A5j
					; sub_407B10+8D1j ...
		mov	ebp, [esp+4Ch+var_34]
		mov	[esp+4Ch+var_4C], ebp
		call	sub_406C90
		jmp	loc_4080B9
; ---------------------------------------------------------------------------

loc_408292:				; CODE XREF: sub_407B10+1DAj
		lea	esi, [ebx+1]
		jmp	loc_407CF2
; ---------------------------------------------------------------------------

loc_40829A:				; CODE XREF: sub_407B10+50Fj
		mov	eax, 1
		sub	eax, [esp+4Ch+arg_10]

loc_4082A3:				; CODE XREF: sub_407B10+885j
		test	eax, eax
		jz	loc_408037

loc_4082AB:				; CODE XREF: sub_407B10+876j
		mov	eax, [esp+4Ch+var_34]
		mov	esi, [eax+10h]
		mov	[esp+4Ch+var_4C], eax
		call	sub_404960
		cmp	ebp, 2
		mov	[esp+4Ch+var_34], eax
		jz	loc_4083F7
		mov	ebp, [esp+4Ch+var_34]
		cmp	esi, [ebp+10h]
		jl	short loc_4082E8
		and	ebx, 1Fh
		jz	short loc_408312
		bsr	eax, [ebp+esi*4+10h]
		mov	edx, 20h
		sub	edx, ebx
		xor	eax, 1Fh
		cmp	edx, eax
		jle	short loc_408312

loc_4082E8:				; CODE XREF: sub_407B10+7BEj
		mov	eax, [esp+4Ch+var_34]
		mov	[esp+4Ch+var_48], 1
		mov	[esp+4Ch+var_4C], eax
		call	sub_4079C0
		mov	edx, [esp+4Ch+arg_4]
		add	[esp+4Ch+var_2C], 1
		mov	ecx, [esp+4Ch+var_2C]
		cmp	ecx, [edx+8]
		jg	loc_4080D3

loc_408312:				; CODE XREF: sub_407B10+7C3j
					; sub_407B10+7D6j ...
		mov	ebp, 21h
		jmp	loc_40803A
; ---------------------------------------------------------------------------

loc_40831C:				; CODE XREF: sub_407B10+1BDj
		mov	eax, [esp+4Ch+arg_10]
		test	eax, eax
		jnz	loc_4080DF
		jmp	loc_407CDC
; ---------------------------------------------------------------------------

loc_40832D:				; CODE XREF: sub_407B10+1B4j
		mov	edx, [esp+4Ch+arg_10]
		test	edx, edx
		jz	loc_4080DF
		jmp	loc_407CDC
; ---------------------------------------------------------------------------

loc_40833E:				; CODE XREF: sub_407B10+3EEj
		mov	ebp, [esp+4Ch+var_28]
		mov	eax, 20h
		xor	edx, edx
		mov	[esp+4Ch+var_30], ebp
		jmp	loc_407F5E
; ---------------------------------------------------------------------------

loc_408352:				; CODE XREF: sub_407B10+4B7j
		test	ebp, ebp
		jle	loc_407FD2
		mov	eax, [esp+4Ch+var_34]
		mov	[esp+4Ch+var_48], ebp
		mov	[esp+4Ch+var_4C], eax
		call	sub_407650
		mov	esi, eax
		jmp	loc_407FD2
; ---------------------------------------------------------------------------

loc_408371:				; CODE XREF: sub_407B10+521j
		test	esi, 2
		jz	loc_408037
		mov	ecx, [esp+4Ch+var_20]
		or	esi, [ecx]
		and	esi, 1
		jnz	loc_4082AB
		jmp	loc_408037
; ---------------------------------------------------------------------------

loc_408391:				; CODE XREF: sub_407B10+518j
		mov	eax, [esp+4Ch+arg_10]
		jmp	loc_4082A3
; ---------------------------------------------------------------------------

loc_40839A:				; CODE XREF: sub_407B10+2C6j
		mov	[esp+4Ch+var_34], esi
		movzx	edx, byte ptr [esi]
		jmp	loc_407C40
; ---------------------------------------------------------------------------

loc_4083A6:				; CODE XREF: sub_407B10+337j
					; sub_407B10+340j
		mov	[esp+4Ch+var_34], 0
		jmp	loc_407E8D
; ---------------------------------------------------------------------------

loc_4083B3:				; CODE XREF: sub_407B10+76Bj
		cmp	edi, ebx
		jnz	loc_408281
		cmp	ebx, 1
		xchg	ax, ax
		jg	short loc_40840E

loc_4083C2:				; CODE XREF: sub_407B10+8D7j
					; sub_407B10+8E0j ...
		mov	edx, [esp+4Ch+var_34]
		mov	ecx, [esp+4Ch+var_20]
		mov	dword ptr [edx+10h], 1
		mov	dword ptr [ecx], 1
		jmp	loc_408228
; ---------------------------------------------------------------------------

loc_4083DC:				; CODE XREF: sub_407B10+762j
		cmp	[esp+4Ch+arg_10], 0
		jz	loc_408281
		jmp	short loc_4083C2
; ---------------------------------------------------------------------------

loc_4083E9:				; CODE XREF: sub_407B10+759j
		cmp	[esp+4Ch+arg_10], 0
		xchg	ax, ax
		jz	short loc_4083C2
		jmp	loc_408281
; ---------------------------------------------------------------------------

loc_4083F7:				; CODE XREF: sub_407B10+7B1j
		mov	edx, [esp+4Ch+arg_4]
		mov	eax, [edx]
		sub	eax, 1
		cmp	eax, ebx
		jz	short loc_40842A

loc_408404:				; CODE XREF: sub_407B10+937j
		mov	ebp, 22h
		jmp	loc_40803A
; ---------------------------------------------------------------------------

loc_40840E:				; CODE XREF: sub_407B10+8B0j
		mov	eax, [esp+4Ch+var_34]
		sub	ebx, 1
		mov	[esp+4Ch+var_48], ebx
		mov	[esp+4Ch+var_4C], eax
		call	sub_407650
		test	eax, eax
		jnz	short loc_4083C2
		jmp	loc_408281
; ---------------------------------------------------------------------------

loc_40842A:				; CODE XREF: sub_407B10+8F2j
		mov	ecx, ebx
		mov	eax, 1
		and	ecx, 1Fh
		shl	eax, cl
		mov	ecx, [esp+4Ch+var_34]
		sar	ebx, 5
		test	[ecx+ebx*4+14h], eax
		jnz	loc_408312
		jmp	short loc_408404
sub_407B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408450	proc near		; CODE XREF: sub_404D30+18C9p

var_40		= dword	ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		cmp	ds:byte_40BE10,	0
		jz	loc_408780

loc_408464:				; CODE XREF: sub_408450+335j
		mov	eax, [esp+4Ch+arg_4]
		mov	ecx, [esp+4Ch+arg_8]
		mov	eax, [eax]
		mov	edx, eax
		sar	edx, 5
		and	eax, 1Fh
		lea	edx, [ecx+edx*4]
		mov	[esp+4Ch+var_20], eax
		jz	short loc_408482
		add	edx, 4

loc_408482:				; CODE XREF: sub_408450+2Dj
		mov	ebp, [esp+4Ch+arg_0]
		lea	esi, [edx-4]
		mov	[esp+4Ch+var_2C], esi
		mov	dword ptr [edx-4], 0
		mov	eax, [ebp+0]
		movzx	edx, byte ptr [eax+1]
		test	edx, edx
		jnz	short loc_4084AC
		jmp	short loc_4084B2
; ---------------------------------------------------------------------------

loc_4084A1:				; CODE XREF: sub_408450+60j
		add	eax, 1
		movzx	edx, byte ptr [eax+1]
		test	edx, edx
		jz	short loc_4084B2

loc_4084AC:				; CODE XREF: sub_408450+4Dj
		cmp	edx, 20h
		nop
		jbe	short loc_4084A1

loc_4084B2:				; CODE XREF: sub_408450+4Fj
					; sub_408450+5Aj
		cmp	byte ptr [eax+1], 30h
		jz	loc_4086E0

loc_4084BC:				; CODE XREF: sub_408450+29Fj
					; sub_408450+2B0j
		mov	ecx, eax

loc_4084BE:				; CODE XREF: sub_408450+2A9j
		mov	eax, [esp+4Ch+var_2C]
		xor	esi, esi
		xor	edi, edi
		mov	[esp+4Ch+var_34], 0
		mov	[esp+4Ch+var_38], eax
		mov	ebx, eax

loc_4084D4:				; CODE XREF: sub_408450+125j
					; sub_408450+209j ...
		movzx	edx, byte ptr [ecx+1]
		lea	eax, [ecx+1]
		test	edx, edx
		jz	loc_4085B9

loc_4084E3:				; CODE XREF: sub_408450+163j
		movzx	ebp, ds:byte_40BDE0[edx]
		test	ebp, ebp
		jnz	loc_408666
		cmp	edx, 20h
		ja	loc_4086A0
		cmp	edi, [esp+4Ch+var_34]
		jle	loc_408598
		cmp	esi, 7
		jg	short loc_40856A
		cmp	ebx, [esp+4Ch+var_38]
		xchg	ax, ax
		jnb	short loc_40856A
		mov	edx, 8
		mov	ecx, 20h
		sub	edx, esi
		mov	esi, [ebx]
		shl	edx, 2
		mov	[esp+4Ch+var_30], edx
		sub	ecx, edx
		mov	edx, ebx
		mov	[esp+4Ch+var_24], ebx
		mov	ebx, [esp+4Ch+var_30]
		mov	[esp+4Ch+var_40], edi
		mov	edi, ecx
		mov	[esp+4Ch+var_28], eax
		lea	esi, [esi+0]

loc_408540:				; CODE XREF: sub_408450+10Cj
		add	edx, 4
		mov	ecx, edi
		mov	eax, [edx]
		mov	ebp, eax
		shl	ebp, cl
		mov	ecx, ebx
		or	ebp, esi
		mov	esi, eax
		shr	esi, cl
		cmp	[esp+4Ch+var_38], edx
		mov	[edx-4], ebp
		mov	[edx], esi
		ja	short loc_408540
		mov	eax, [esp+4Ch+var_28]
		mov	ebx, [esp+4Ch+var_24]
		mov	edi, [esp+4Ch+var_40]

loc_40856A:				; CODE XREF: sub_408450+B8j
					; sub_408450+C0j
		cmp	ebx, [esp+4Ch+arg_8]
		mov	ecx, eax
		mov	esi, 8
		jbe	loc_4084D4
		sub	ebx, 4
		xor	si, si
		mov	dword ptr [ebx], 0
		mov	[esp+4Ch+var_34], edi
		mov	[esp+4Ch+var_38], ebx
		cmp	byte ptr [eax+1], 20h
		ja	short loc_40859E

loc_408595:				; CODE XREF: sub_408450+14Cj
		add	eax, 1

loc_408598:				; CODE XREF: sub_408450+AFj
		cmp	byte ptr [eax+1], 20h
		jbe	short loc_408595

loc_40859E:				; CODE XREF: sub_408450+143j
		cmp	byte ptr [eax+1], 30h
		jz	loc_408640

loc_4085A8:				; CODE XREF: sub_408450+1FFj
					; sub_408450+238j
		mov	ecx, eax

loc_4085AA:				; CODE XREF: sub_408450+211j
		movzx	edx, byte ptr [ecx+1]
		lea	eax, [ecx+1]
		test	edx, edx
		jnz	loc_4084E3

loc_4085B9:				; CODE XREF: sub_408450+8Dj
		test	edi, edi
		jz	loc_4086D3
		cmp	esi, 7
		jle	loc_408730

loc_4085CA:				; CODE XREF: sub_408450+2E4j
					; sub_408450+367j
		cmp	[esp+4Ch+arg_8], ebx
		xchg	ax, ax
		jnb	loc_408705

loc_4085D6:				; CODE XREF: sub_408450+32Bj
		mov	eax, [esp+4Ch+arg_8]
		mov	ecx, [esp+4Ch+var_2C]
		xchg	ax, ax

loc_4085E0:				; CODE XREF: sub_408450+19Cj
		mov	edx, [ebx]
		add	ebx, 4
		mov	[eax], edx
		add	eax, 4
		cmp	ecx, ebx
		jnb	short loc_4085E0
		mov	edx, ecx

loc_4085F0:				; CODE XREF: sub_408450+1ABj
		mov	dword ptr [eax], 0
		add	eax, 4
		cmp	edx, eax
		jnb	short loc_4085F0
		mov	eax, [edx]
		mov	[esp+4Ch+var_2C], edx

loc_408603:				; CODE XREF: sub_408450+2DBj
					; sub_408450+378j
		test	eax, eax
		jnz	short loc_408631
		mov	eax, [esp+4Ch+var_2C]
		cmp	[esp+4Ch+arg_8], eax
		jz	loc_40878A
		mov	edx, [esp+4Ch+arg_8]
		jmp	short loc_408628
; ---------------------------------------------------------------------------
		align 10h

loc_408620:				; CODE XREF: sub_408450+1DFj
		cmp	edx, eax
		jz	loc_40878A

loc_408628:				; CODE XREF: sub_408450+1C9j
		sub	eax, 4
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_408620

loc_408631:				; CODE XREF: sub_408450+1B5j
		add	esp, 3Ch
		mov	eax, 5
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_408640:				; CODE XREF: sub_408450+152j
		movzx	edx, byte ptr [eax+2]
		lea	ecx, [eax+2]
		cmp	dl, 58h
		jz	short loc_408655
		cmp	dl, 78h
		jnz	loc_4085A8

loc_408655:				; CODE XREF: sub_408450+1FAj
		cmp	byte ptr [eax+3], 20h
		ja	loc_4084D4
		mov	ecx, eax
		jmp	loc_4085AA
; ---------------------------------------------------------------------------

loc_408666:				; CODE XREF: sub_408450+9Cj
		add	esi, 1
		add	edi, 1
		cmp	esi, 8
		jg	short loc_408684
		mov	edx, [ebx]
		shl	edx, 4

loc_408676:				; CODE XREF: sub_408450+24Ej
		and	ebp, 0Fh
		mov	ecx, eax
		or	ebp, edx
		mov	[ebx], ebp
		jmp	loc_4084D4
; ---------------------------------------------------------------------------

loc_408684:				; CODE XREF: sub_408450+21Fj
		cmp	ebx, [esp+4Ch+arg_8]
		jbe	loc_4085A8
		sub	ebx, 4
		xor	edx, edx
		mov	dword ptr [ebx], 0
		mov	esi, 1
		jmp	short loc_408676
; ---------------------------------------------------------------------------

loc_4086A0:				; CODE XREF: sub_408450+A5j
		test	edi, edi
		mov	ebp, eax
		jnz	loc_4087A1

loc_4086AA:				; CODE XREF: sub_408450+354j
		cmp	edx, 29h
		jz	loc_4087CD
		movsx	edx, byte ptr [ebp+1]
		add	eax, 1
		test	edx, edx
		jz	short loc_4086D3
		xchg	ax, ax

loc_4086C0:				; CODE XREF: sub_408450+281j
		cmp	edx, 29h
		jz	loc_4087CD
		add	eax, 1
		movsx	edx, byte ptr [eax]
		test	edx, edx
		jnz	short loc_4086C0

loc_4086D3:				; CODE XREF: sub_408450+16Bj
					; sub_408450+26Cj
		mov	eax, 4

loc_4086D8:				; CODE XREF: sub_408450+38Bj
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4086E0:				; CODE XREF: sub_408450+66j
		movzx	edx, byte ptr [eax+2]
		lea	ecx, [eax+2]
		cmp	dl, 58h
		jz	short loc_4086F5
		cmp	dl, 78h
		jnz	loc_4084BC

loc_4086F5:				; CODE XREF: sub_408450+29Aj
		cmp	byte ptr [eax+3], 20h
		ja	loc_4084BE
		nop
		jmp	loc_4084BC
; ---------------------------------------------------------------------------

loc_408705:				; CODE XREF: sub_408450+180j
					; sub_408450+329j
		mov	ebx, [esp+4Ch+var_20]
		test	ebx, ebx
		jz	loc_4087C2
		mov	ebp, [esp+4Ch+var_2C]
		mov	ecx, 20h
		mov	eax, 0FFFFFFFFh
		sub	ecx, [esp+4Ch+var_20]
		shr	eax, cl
		and	eax, [ebp+0]
		mov	[ebp+0], eax
		jmp	loc_408603
; ---------------------------------------------------------------------------

loc_408730:				; CODE XREF: sub_408450+174j
					; sub_408450+36Dj
		cmp	ebx, [esp+4Ch+var_38]
		jnb	loc_4085CA
		mov	ebp, 8
		mov	edx, [ebx]
		mov	edi, 20h
		sub	ebp, esi
		mov	eax, ebx
		shl	ebp, 2
		sub	edi, ebp
		mov	[esp+4Ch+var_30], ebx

loc_408753:				; CODE XREF: sub_408450+31Fj
		add	eax, 4
		mov	ecx, edi
		mov	ebx, [eax]
		mov	esi, ebx
		shl	esi, cl
		mov	ecx, ebp
		or	esi, edx
		mov	edx, ebx
		shr	edx, cl
		cmp	eax, [esp+4Ch+var_38]
		mov	[eax-4], esi
		mov	[eax], edx
		jb	short loc_408753
		mov	ebx, [esp+4Ch+var_30]
		cmp	[esp+4Ch+arg_8], ebx
		jnb	short loc_408705
		jmp	loc_4085D6
; ---------------------------------------------------------------------------

loc_408780:				; CODE XREF: sub_408450+Ej
		call	sub_4087E0
		jmp	loc_408464
; ---------------------------------------------------------------------------

loc_40878A:				; CODE XREF: sub_408450+1BFj
					; sub_408450+1D2j
		mov	eax, [esp+4Ch+arg_8]
		mov	dword ptr [eax], 1
		add	esp, 3Ch
		mov	eax, 5
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4087A1:				; CODE XREF: sub_408450+254j
		cmp	edx, 29h
		jnz	loc_4086AA
		mov	ebp, [esp+4Ch+arg_0]
		add	ecx, 2
		cmp	esi, 7
		mov	[ebp+0], ecx
		jg	loc_4085CA
		jmp	loc_408730
; ---------------------------------------------------------------------------

loc_4087C2:				; CODE XREF: sub_408450+2BBj
		mov	esi, [esp+4Ch+var_2C]
		mov	eax, [esi]
		jmp	loc_408603
; ---------------------------------------------------------------------------

loc_4087CD:				; CODE XREF: sub_408450+25Dj
					; sub_408450+273j
		mov	edx, [esp+4Ch+arg_0]
		add	eax, 1
		mov	[edx], eax
		mov	eax, 4
		jmp	loc_4086D8
sub_408450	endp


; =============== S U B	R O U T	I N E =======================================


sub_4087E0	proc near		; CODE XREF: sub_407B10:loc_408076p
					; sub_408450:loc_408780p
		mov	ecx, 30h
		mov	edx, offset a0123456789	; "0123456789"
		mov	eax, 10h
		nop

loc_4087F0:				; CODE XREF: sub_4087E0+22j
		mov	ds:byte_40BDE0[ecx], al
		movzx	ecx, byte ptr [edx+1]
		add	eax, 1
		add	edx, 1
		test	ecx, ecx
		jnz	short loc_4087F0
		mov	cl, 61h
		mov	edx, offset aAbcdef ; "abcdef"
		mov	eax, 1Ah

loc_408810:				; CODE XREF: sub_4087E0+42j
		mov	ds:byte_40BDE0[ecx], al
		movzx	ecx, byte ptr [edx+1]
		add	eax, 1
		add	edx, 1
		test	ecx, ecx
		jnz	short loc_408810
		mov	cl, 41h
		mov	edx, offset aAbcdef_0 ;	"ABCDEF"
		mov	eax, 1Ah

loc_408830:				; CODE XREF: sub_4087E0+62j
		mov	ds:byte_40BDE0[ecx], al
		movzx	ecx, byte ptr [edx+1]
		add	eax, 1
		add	edx, 1
		test	ecx, ecx
		jnz	short loc_408830
		rep retn
sub_4087E0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtok]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION isspace]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION isupper]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION islower]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION localeconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408970	proc near		; CODE XREF: sub_404220+172p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	edx, [esp+2Ch+arg_C]
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, [esp+2Ch+arg_8]
		mov	[esp+2Ch+var_C], esi
		mov	esi, [esp+2Ch+arg_4]
		mov	[esp+2Ch+var_8], edi
		mov	edi, [esp+2Ch+arg_0]
		test	edx, edx
		mov	[esp+2Ch+var_4], ebp
		jnz	short loc_4089C0
		cmp	ebx, esi
		ja	short loc_408A00
		test	ebx, ebx
		jnz	short loc_4089AA
		mov	eax, 1
		xor	edx, edx
		div	ebx
		mov	ebx, eax

loc_4089AA:				; CODE XREF: sub_408970+2Dj
		mov	eax, esi
		xor	edx, edx
		div	ebx
		mov	esi, eax
		mov	eax, edi
		div	ebx
		mov	edi, eax
		jmp	short loc_4089E4
; ---------------------------------------------------------------------------
		align 10h

loc_4089C0:				; CODE XREF: sub_408970+25j
		cmp	edx, esi
		ja	short loc_4089E0
		bsr	ebp, edx
		xor	ebp, 1Fh
		jnz	short loc_408A10
		cmp	ebx, edi
		xchg	ax, ax
		jbe	loc_408A72
		cmp	edx, esi
		jb	loc_408A72
		xchg	ax, ax

loc_4089E0:				; CODE XREF: sub_408970+52j
		xor	esi, esi
		xor	edi, edi

loc_4089E4:				; CODE XREF: sub_408970+48j
					; sub_408970+9Aj ...
		mov	eax, edi
		mov	edx, esi
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_408A00:				; CODE XREF: sub_408970+29j
		mov	edx, esi
		mov	eax, edi
		xor	esi, esi
		div	ebx
		mov	edi, eax
		jmp	short loc_4089E4
; ---------------------------------------------------------------------------
		align 10h

loc_408A10:				; CODE XREF: sub_408970+5Aj
		mov	ecx, ebp
		mov	eax, 20h
		sub	eax, ebp
		shl	edx, cl
		mov	ecx, eax
		mov	[esp+2Ch+var_20], edx
		mov	edx, ebx
		shr	edx, cl
		mov	ecx, [esp+2Ch+var_20]
		or	ecx, edx
		mov	edx, edi
		mov	[esp+2Ch+var_20], ecx
		mov	ecx, ebp
		shl	ebx, cl
		mov	ecx, eax
		mov	[esp+2Ch+var_24], ebx
		mov	ebx, esi
		shr	ebx, cl
		mov	ecx, ebp
		shl	esi, cl
		mov	ecx, eax
		shr	edx, cl
		or	esi, edx
		mov	edx, ebx
		mov	eax, esi
		div	[esp+2Ch+var_20]
		mov	ebx, edx
		mov	esi, eax
		mul	[esp+2Ch+var_24]
		cmp	ebx, edx
		jb	short loc_408A80
		mov	ecx, ebp
		shl	edi, cl
		cmp	edi, eax
		jnb	short loc_408A69
		cmp	ebx, edx
		jz	short loc_408A80

loc_408A69:				; CODE XREF: sub_408970+F3j
		mov	edi, esi
		xor	esi, esi
		jmp	loc_4089E4
; ---------------------------------------------------------------------------

loc_408A72:				; CODE XREF: sub_408970+60j
					; sub_408970+68j
		xor	esi, esi
		mov	edi, 1
		jmp	loc_4089E4
; ---------------------------------------------------------------------------
		align 10h

loc_408A80:				; CODE XREF: sub_408970+EBj
					; sub_408970+F7j
		lea	edi, [esi-1]
		xor	esi, esi
		jmp	loc_4089E4
sub_408970	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408A90	proc near		; CODE XREF: sub_404530+184p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	ecx, [esp+2Ch+arg_4]
		mov	[esp+2Ch+var_C], esi
		xor	esi, esi
		mov	edx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_8], edi
		mov	edi, [esp+2Ch+arg_8]
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, [esp+2Ch+arg_C]
		test	ecx, ecx
		mov	[esp+2Ch+var_10], ebx
		js	loc_408B50
		test	ebp, ebp
		js	loc_408B64

loc_408AC5:				; CODE XREF: sub_408A90+CEj
					; sub_408A90+DDj
		mov	eax, ebp
		mov	ebx, edi
		test	eax, eax
		mov	ebp, edx
		mov	edi, ecx
		jnz	short loc_408AE1
		cmp	ebx, ecx
		jbe	short loc_408B10
		mov	eax, ebp
		mov	edx, ecx
		xor	edi, edi
		div	ebx
		mov	ebp, eax
		jmp	short loc_408AE9
; ---------------------------------------------------------------------------

loc_408AE1:				; CODE XREF: sub_408A90+3Fj
		cmp	eax, ecx
		jbe	short loc_408B30

loc_408AE5:				; CODE XREF: sub_408A90+B2j
		xor	edi, edi
		xor	ebp, ebp

loc_408AE9:				; CODE XREF: sub_408A90+4Fj
					; sub_408A90+9Dj ...
		test	esi, esi
		mov	eax, ebp
		mov	edx, edi
		jz	short loc_408AF8
		neg	eax
		adc	edx, 0
		neg	edx

loc_408AF8:				; CODE XREF: sub_408A90+5Fj
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_408B10:				; CODE XREF: sub_408A90+43j
		test	ebx, ebx
		jnz	short loc_408B1F
		mov	eax, 1
		xor	edx, edx
		div	ebx
		mov	ebx, eax

loc_408B1F:				; CODE XREF: sub_408A90+82j
		mov	eax, edi
		xor	edx, edx
		div	ebx
		mov	edi, eax
		mov	eax, ebp
		div	ebx
		mov	ebp, eax
		jmp	short loc_408AE9
; ---------------------------------------------------------------------------
		align 10h

loc_408B30:				; CODE XREF: sub_408A90+53j
		bsr	edx, eax
		xor	edx, 1Fh
		mov	[esp+2Ch+var_28], edx
		jnz	short loc_408B72
		cmp	ebx, ebp
		jbe	short loc_408B44
		cmp	eax, ecx
		jnb	short loc_408AE5

loc_408B44:				; CODE XREF: sub_408A90+AEj
		xor	edi, edi
		mov	ebp, 1
		jmp	short loc_408AE9
; ---------------------------------------------------------------------------
		align 10h

loc_408B50:				; CODE XREF: sub_408A90+27j
		neg	edx
		mov	esi, 0FFFFFFFFh
		adc	ecx, 0
		neg	ecx
		test	ebp, ebp
		jns	loc_408AC5

loc_408B64:				; CODE XREF: sub_408A90+2Fj
		neg	edi
		not	esi
		adc	ebp, 0
		neg	ebp
		jmp	loc_408AC5
; ---------------------------------------------------------------------------

loc_408B72:				; CODE XREF: sub_408A90+AAj
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	edx, 20h
		sub	edx, [esp+2Ch+var_28]
		shl	eax, cl
		mov	ecx, edx
		mov	[esp+2Ch+var_24], eax
		mov	eax, ebx
		shr	eax, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, [esp+2Ch+var_24]
		shl	ebx, cl
		mov	ecx, edx
		mov	[esp+2Ch+var_20], ebx
		mov	ebx, edi
		shr	ebx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	[esp+2Ch+var_24], eax
		mov	eax, ebp
		shl	edi, cl
		mov	ecx, edx
		shr	eax, cl
		mov	edx, ebx
		or	edi, eax
		mov	eax, edi
		div	[esp+2Ch+var_24]
		mov	ebx, edx
		mov	edi, eax
		mul	[esp+2Ch+var_20]
		cmp	ebx, edx
		jb	short loc_408BE0
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		shl	ebp, cl
		cmp	ebp, eax
		jnb	short loc_408BD7
		cmp	ebx, edx
		jz	short loc_408BE0

loc_408BD7:				; CODE XREF: sub_408A90+141j
		mov	ebp, edi
		xor	edi, edi
		jmp	loc_408AE9
; ---------------------------------------------------------------------------

loc_408BE0:				; CODE XREF: sub_408A90+136j
					; sub_408A90+145j
		lea	ebp, [edi-1]
		xor	edi, edi
		jmp	loc_408AE9
sub_408A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408BF0	proc near		; DATA XREF: .text:00408C14o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4016A0
		mov	[esp+18h+var_18], offset sub_4016F0 ; _onexit_t
		call	sub_4032F0
		leave
		retn
sub_408BF0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_408C10	dd 0FFFFFFFFh		; DATA XREF: sub_403E50-5Br
					; sub_403E50-17r
		dd offset sub_408BF0
		dd 0
		dd 0FFFFFFFFh
dword_408C20	dd 78h dup(0)		; DATA XREF: .data:off_409010o
		dd 80h dup(?)
_text		ends

; Section 2. (virtual address 00009000)
; Virtual size			: 0000003C (	 60.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00008200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 409000h
dword_409000	dd 0FFFFFFFFh		; DATA XREF: sub_401010+25r
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_409010	dd offset dword_408C20	; DATA XREF: sub_403DC0+3r
					; sub_403DC0+12r ...
dword_409014	dd 35h,	0FFFFFBCEh, 3CBh, 1, 0 ; DATA XREF: sub_404130+17o
dword_409028	dd 2			; DATA XREF: TlsCallback_0+4r
					; TlsCallback_0+11w
off_40902C	dd offset dword_40B480	; DATA XREF: sub_406D00:loc_406D95r
					; sub_406D00+C6w
dword_409030	dd 0BB40E64Eh		; DATA XREF: .text:00403C8Fr
					; sub_403CE0+3r ...
dword_409034	dd 44BF19B1h		; DATA XREF: .text:00403C97r
					; sub_403CE0+21w ...
dword_409038	dd 0			; DATA XREF: sub_4016A0+6r
					; sub_4016A0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0000A000)
; Virtual size			: 00000C3C (   3132.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 00008400
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 40A000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401190+134o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj_s.dll',0     ; DATA XREF: sub_4016A0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4016A0+2Ao
		align 4
; char Format[]
Format		db '   ',0              ; DATA XREF: sub_401700+5Ao
					; sub_401700+2A3o ...
aString_0	db 'string "',0         ; DATA XREF: sub_401700:loc_401D01o
; char aS[]
aS		db '%s',0               ; DATA XREF: sub_401700+207o
					; sub_401700+3FFo
; char asc_40A054[]
asc_40A054	db '"',0                ; DATA XREF: sub_401700+40Fo
; char aSignature[]
aSignature	db 'signature "',0      ; DATA XREF: sub_401700+3ECo
aObjectPath	db 'object path "',0    ; DATA XREF: sub_401700+339o
; char aInt16D[]
aInt16D		db 'int16 %d',0Ah,0     ; DATA XREF: sub_401700+361o
; char aUint16U[]
aUint16U	db 'uint16 %u',0Ah,0    ; DATA XREF: sub_401700+2F1o
; char aInt32D[]
aInt32D		db 'int32 %d',0Ah,0     ; DATA XREF: sub_401700+3A4o
; char aUint32U[]
aUint32U	db 'uint32 %u',0Ah,0    ; DATA XREF: sub_401700+180o
; char Str[]
Str		db 'int64 (omitted)',0  ; DATA XREF: sub_401700+FCo
; char aUint64Omitted[]
aUint64Omitted	db 'uint64 (omitted)',0 ; DATA XREF: sub_401700+1BCo
; char aDoubleG[]
aDoubleG	db 'double %g',0Ah,0    ; DATA XREF: sub_401700+4CCo
; char aByteD[]
aByteD		db 'byte %d',0Ah,0      ; DATA XREF: sub_401700+C3o
aFalse_0	db 'false',0            ; DATA XREF: sub_401700:loc_401CF7o
aTrue_0		db 'true',0             ; DATA XREF: sub_401700+516o
; char aBooleanS[]
aBooleanS	db 'boolean %s',0Ah,0   ; DATA XREF: sub_401700+527o
; char aVariant_0[]
aVariant_0	db 'variant ',0         ; DATA XREF: sub_401700+131o
; char aArrayOfBytesS[]
aArrayOfBytesS	db 'array of bytes "%s"',0Ah,0 ; DATA XREF: sub_401700+825o
; char aArrayOfBytes[]
aArrayOfBytes	db 'array of bytes [',0 ; DATA XREF: sub_401700+6D3o
; char a02x[]
a02x		db '%02x',0             ; DATA XREF: sub_401700+736o
; char asc_40A11A[]
asc_40A11A	db ']',0                ; DATA XREF: sub_401700:loc_401CC3o
					; sub_401700:loc_401ED4o
; char aArray_0[]
aArray_0	db 'array [',0          ; DATA XREF: sub_401700+56Co
; char aDictEntry[]
aDictEntry	db 'dict entry(',0      ; DATA XREF: sub_401700+446o
; char asc_40A130[]
asc_40A130	db ')',0                ; DATA XREF: sub_401700:loc_401B9Ao
; char aStruct[]
aStruct		db 'struct {',0         ; DATA XREF: sub_401700+240o
; char asc_40A13B[]
asc_40A13B	db '}',0                ; DATA XREF: sub_401700:loc_4019B3o
		align 10h
; char aDbusMonitorToo[]
aDbusMonitorToo	db ' (dbus-monitor too dumb to decipher arg type ',27h,'%c',27h,')',0Ah,0
					; DATA XREF: sub_401700+76o
off_40A174	dd offset loc_401C4B	; DATA XREF: sub_401700:loc_4017A0r
		dd offset loc_401BFB	; jump table for switch	statement
		dd offset loc_401772
		dd offset loc_401BB8
		dd offset loc_401B35
		dd offset loc_401772
		dd offset loc_401ACC
		dd offset loc_401772
		dd offset loc_401A89
		dd offset loc_401772
		dd offset loc_401772
		dd offset loc_401772
		dd offset loc_401772
		dd offset loc_401A45
		dd offset loc_401A19
		dd offset loc_401772
		dd offset loc_4019D5
		dd offset loc_40192F
		dd offset loc_4018E0
		dd offset loc_4018A8
		dd offset loc_401865
		dd offset loc_401820
		dd offset loc_401772
		dd offset loc_4017E8
		dd offset loc_4017A7
aNullDestinatio	db '(null destination)',0 ; DATA XREF: sub_401F40:loc_402100o
aNullSender	db '(null sender)',0    ; DATA XREF: sub_401F40:loc_402110o
aUnknownMessage	db '(unknown message type)',0 ; DATA XREF: sub_401F40+69o
; char aSSenderSDestS[]
aSSenderSDestS	db '%s sender=%s -> dest=%s',0 ; DATA XREF: sub_401F40+86o
; char aSerialUPathSIn[]
aSerialUPathSIn	db ' serial=%u path=%s; interface=%s; member=%s',0Ah,0
					; DATA XREF: sub_401F40+E5o
; char aReply_serialU[]
aReply_serialU	db ' reply_serial=%u',0Ah,0 ; DATA XREF: sub_401F40+179o
		align 4
; char aError_nameSRep[]
aError_nameSRep	db ' error_name=%s reply_serial=%u',0Ah,0 ; DATA XREF: sub_401F40+1A8o
aMethodCall	db 'method call',0      ; DATA XREF: .rdata:off_40A2B0o
aMethodReturn	db 'method return',0    ; DATA XREF: .rdata:0040A2B4o
aError		db 'error',0            ; DATA XREF: .rdata:0040A2B8o
aSignal		db 'signal',0           ; DATA XREF: .rdata:0040A2BCo
		align 10h
off_40A2B0	dd offset aMethodCall	; DATA XREF: sub_401F40+73r
					; "method call"
		dd offset aMethodReturn	; "method return"
		dd offset aError	; "error"
		dd offset aSignal	; "signal"
; char aUsageSHelpSyst[]
aUsageSHelpSyst	db 'Usage: %s [--help] [--system | --session | --address=ADDRESS] [--'
					; DATA XREF: sub_402120+Bo
					; sub_4025E0+60Bo ...
		db 'dest=NAME] [--type=TYPE] [--print-reply=(literal)] [--reply-timeo'
		db 'ut=MSEC] <destination object path> <message name> [contents ...]',0Ah
		db 0
aString		db 'string',0           ; DATA XREF: sub_402150+12o
aInt16		db 'int16',0            ; DATA XREF: sub_402150+28o
aUint16		db 'uint16',0           ; DATA XREF: sub_402150+49o
aInt32		db 'int32',0            ; DATA XREF: sub_402150+67o
aUint32		db 'uint32',0           ; DATA XREF: sub_402150+85o
aInt64		db 'int64',0            ; DATA XREF: sub_402150+A3o
aUint64		db 'uint64',0           ; DATA XREF: sub_402150+BDo
aDouble		db 'double',0           ; DATA XREF: sub_402150+D7o
aByte		db 'byte',0             ; DATA XREF: sub_402150+F1o
aBoolean	db 'boolean',0          ; DATA XREF: sub_402150+10Bo
aObjpath	db 'objpath',0          ; DATA XREF: sub_402150+120o
; char aSUnknownTypeS[]
aSUnknownTypeS	db '%s: Unknown type "%s"',0Ah,0 ; DATA XREF: sub_402150+157o
aTrue		db 'true',0             ; DATA XREF: sub_4022D0+5Co
aFalse		db 'false',0            ; DATA XREF: sub_4022D0+70o
aSExpectedTrueO	db '%s: Expected "true" or "false" instead of "%s"',0Ah,0
					; DATA XREF: sub_4022D0+2F6o
; char aSUnsupportedDa[]
aSUnsupportedDa	db '%s: Unsupported data type %c',0Ah,0 ; DATA XREF: sub_4022D0+29o
		align 10h
off_40A440	dd offset loc_402328	; DATA XREF: sub_4022D0:loc_402321r
		dd offset loc_4022ED	; jump table for switch	statement
		dd offset loc_402385
		dd offset loc_4022ED
		dd offset loc_4022ED
		dd offset loc_4022ED
		dd offset loc_4022ED
		dd offset loc_4023B8
		dd offset loc_4022ED
		dd offset loc_4022ED
		dd offset loc_4022ED
		dd offset loc_4022ED
		dd offset loc_4023F3
		dd offset loc_402432
		dd offset loc_4022ED
		dd offset loc_402450
		dd offset loc_4022ED
		dd offset loc_402490
		dd offset loc_4024B0
		dd offset loc_4024F2
		dd offset loc_4022ED
		dd offset loc_4022ED
		dd offset loc_402530
		dd offset loc_402572
aSystem		db '--system',0         ; DATA XREF: sub_4025E0+B7o
aSession	db '--session',0        ; DATA XREF: sub_4025E0+D1o
; char SubStr[]
SubStr		db '--address',0        ; DATA XREF: sub_4025E0:loc_402AA5o
		align 10h
aAddressRequire	db '"--address=" requires an ADDRESS',0Ah,0 ; DATA XREF: sub_4025E0+A63o
aPrintReply	db '--print-reply',0    ; DATA XREF: sub_4025E0+4E5o
; char aReplyTimeout[]
aReplyTimeout	db '--reply-timeout=',0 ; DATA XREF: sub_4025E0:loc_402B00o
; char aDest[]
aDest		db '--dest=',0          ; DATA XREF: sub_4025E0+540o
; char aType[]
aType		db '--type=',0          ; DATA XREF: sub_4025E0+560o
aHelp		db '--help',0           ; DATA XREF: sub_4025E0+580o
aAddressMayNotB	db '"--address" may not be used with "--system" or "--session"',0Ah,0
					; DATA XREF: sub_4025E0+5EFo
aMessageTypeSIs	db 'Message type "%s" is not supported',0Ah,0 ; DATA XREF: sub_4025E0+7CEo
aSession_0	db 'session',0          ; DATA XREF: sub_4025E0+AFAo
aSystem_0	db 'system',0           ; DATA XREF: sub_4025E0+AECo
		align 4
; char aFailedToOpenCo[]
aFailedToOpenCo	db 'Failed to open connection to "%s" message bus: %s',0Ah,0
					; DATA XREF: sub_4025E0+8A5o
		align 4
aMustUseOrg_m_0	db 'Must use org.mydomain.Interface.Method notation, no dot in "%s"',0Ah
					; DATA XREF: sub_4025E0+AA2o
		db 0
		align 10h
aMustUseOrg_myd	db 'Must use org.mydomain.Interface.Signal notation, no dot in "%s"',0Ah
					; DATA XREF: sub_4025E0+A8Do
		db 0
		align 4
aInternalErrorU	db 'Internal error, unknown message type',0Ah,0 ; DATA XREF: sub_4025E0+7F5o
		align 4
aCouldnTAllocat	db 'Couldn',27h,'t allocate D-Bus message',0Ah,0
					; DATA XREF: sub_4025E0+AC8o
aNotEnoughMemor	db 'Not enough memory',0Ah,0 ; DATA XREF: sub_4025E0+9EBo
; char aSDataItemSIsBa[]
aSDataItemSIsBa	db '%s: Data item "%s" is badly formed',0Ah,0 ; DATA XREF: sub_4025E0+841o
aVariant	db 'variant',0          ; DATA XREF: sub_4025E0+304o
aArray		db 'array',0            ; DATA XREF: sub_4025E0+247o
aDict		db 'dict',0             ; DATA XREF: sub_4025E0+268o
; char Delim[]
Delim		db ',',0                ; DATA XREF: sub_4025E0+3E6o
					; sub_4025E0+437o ...
aSMalformedDict	db '%s: Malformed dictionary',0Ah,0 ; DATA XREF: sub_4025E0+B2Fo
aErrorSS	db 'Error %s: %s',0Ah,0 ; DATA XREF: sub_4025E0+B0Eo
		align 4
off_40A704	dd offset TlsCallback_0	; DATA XREF: sub_401190:loc_401280r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_403310+3o
		align 4
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_403310+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_40A824o
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0040A828o
		align 10h
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0040A82Co
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0040A830o
		align 4
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0040A834o
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0040A838o
		align 4
off_40A824	dd offset aArgumentDomain ; DATA XREF: sub_403310+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_403380+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_4033E0+13Ao
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_4033E0+126o
					; sub_403530+253o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_403530+267o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_403530+F4o
		align 4
; const	WCHAR LibFileName
LibFileName:				; DATA XREF: sub_403AE0:loc_403B85o
		unicode	0, <msvcrt.dll>,0
		align 4
off_40A924	dd offset dword_40B060	; DATA XREF: .text:00403CA8o
		dd offset dword_40B0C0
off_40A92C	dd offset loc_4041B2	; DATA XREF: sub_404130+39r
		dd offset loc_4041C4	; jump table for switch	statement
		dd offset loc_4041F0
		dd offset loc_404202
		dd offset loc_4041A0
		dd offset loc_404170
		dd offset loc_4041B2
		align 20h
byte_40A960	db 6Eh,	66h, 0		; DATA XREF: sub_404D30+3ADo
aInity		db 'inity',0            ; DATA XREF: sub_404D30+3CDo
aAn		db 'an',0               ; DATA XREF: sub_404D30+1864o
off_40A96C	dd offset loc_404E4D	; DATA XREF: sub_404D30+F5r
		dd offset loc_404D98	; jump table for switch	statement
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404EF0
		dd offset loc_404EF0
		dd offset loc_404EF0
		dd offset loc_404EF0
		dd offset loc_404EF0
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404EF0
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404D98
		dd offset loc_404EE2
		dd offset loc_404D98
		dd offset loc_404E30
		align 20h
dword_40AA40	dd 0			; DATA XREF: sub_404D30+703r
		dd 3, 5, 7, 0Ah, 0Ch, 0Eh, 11h,	13h, 15h, 18h, 1Ah, 1Ch
		dd 1Fh,	21h, 23h, 26h, 28h, 2Ah, 2Dh, 2Fh, 31h,	34h
flt_40AA9C	dd 2.0			; DATA XREF: sub_404D30+D47r
flt_40AAA0	dd 1.0			; DATA XREF: sub_404D30+10DFr
flt_40AAA4	dd 0.5			; DATA XREF: sub_404D30+AC8r
					; sub_404D30:loc_405DA0r
dbl_40AAA8	dq 2.147483647e9	; DATA XREF: sub_404D30+1091r
dbl_40AAB0	dq 5.0e-16		; DATA XREF: sub_404D30+ABBr
		align 10h
dbl_40AAC0	dq 1.0e16		; DATA XREF: sub_404D30+137Dr
		dd 0B5056E17h, 4693B8B5h, 0E93FF9F5h, 4D384F03h, 0F9301D32h
		dd 5A827748h
dbl_40AAE0	dq 1.0e256		; DATA XREF: sub_404D30+12DAr
		dd 4 dup(0)
dbl_40AAF8	dq 0.0			; DATA XREF: sub_404D30+522r
dbl_40AB00	dq 1.0e-16		; DATA XREF: sub_404D30+16C8r
		dd 0D5A8A733h, 3949F623h, 44F4A73Dh, 32A50FFDh,	0CF8C979Dh
		dd 255BBA08h
dbl_40AB20	dq 1.0e-256		; DATA XREF: sub_404D30+1617r
		align 20h
dbl_40AB40	dq 1.0			; DATA XREF: sub_404D30+588r
					; sub_404D30+749r ...
		dd 0
		dd 40240000h, 0
		dd 40590000h, 0
		dd 408F4000h, 0
		dd 40C38800h, 0
		dd 40F86A00h, 0
aAd_a		db '.A',0
		align 4
		dd 416312D0h, 0
aDCa		db 'A',0
		align 4
aEA		db 'eA',0
		db 2 dup(0), 20h
		dd 4202A05Fh, 0E8000000h, 42374876h, 0A2000000h, 426D1A94h
		dd 0E5400000h, 42A2309Ch, 1E900000h, 42D6BCC4h,	26340000h
		dd 430C6BF5h, 37E08000h, 4341C379h, 85D8A000h, 43763457h
		dd 674EC800h, 43ABC16Dh, 60913D00h, 43E158E4h, 78B58C40h
		dd 4415AF1Dh, 0D6E2EF50h, 444B1AE4h, 64DD592h
dword_40ABF4	dd 4480F0CFh		; DATA XREF: sub_407440:loc_4074EAr
		dd 5, 19h, 7Dh,	7 dup(0)
aAbcdef_0	db 'ABCDEF',0           ; DATA XREF: sub_4087E0+46o
aAbcdef		db 'abcdef',0           ; DATA XREF: sub_4087E0+26o
a0123456789	db '0123456789',0       ; DATA XREF: sub_4087E0+5o
		align 4
dword_40AC3C	dd 0			; DATA XREF: sub_403530+57o
					; sub_403530+5Co ...
dword_40AC40	dd 0			; DATA XREF: sub_403530+7Ar
dword_40AC44	dd 0			; DATA XREF: sub_403530+84r
dword_40AC48	dd 6Eh dup(0)		; DATA XREF: sub_403530+8Do
		align 400h
_rdata		ends

; Section 4. (virtual address 0000B000)
; Virtual size			: 00000EE0 (   3808.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 40B000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_40B000	dd ?			; DATA XREF: sub_401060+7Br
dword_40B004	dd ?			; DATA XREF: sub_401190+D0w
					; sub_401190+27Cr
dword_40B008	dd ?			; DATA XREF: sub_401190+12Aw
					; TopLevelExceptionFilter:loc_40158Cr
dword_40B00C	dd ?			; DATA XREF: sub_401190+271w
					; sub_401190+28Br
dword_40B010	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401190:loc_401354r ...
dword_40B014	dd ?			; DATA XREF: sub_401010+18o
					; sub_401190+1E0r ...
dword_40B018	dd ?			; DATA XREF: sub_401010+10o
					; sub_401190+242r ...
dword_40B01C	dd ?			; DATA XREF: sub_401010+3Aw
dword_40B020	dd ?			; DATA XREF: sub_401060+3Ew
					; sub_401190+269r
dword_40B024	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_40B028	dd ?			; DATA XREF: sub_402120+6r
					; sub_402150+152r ...
dword_40B02C	dd ?			; DATA XREF: sub_401010+3r
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
dword_40B034	dd ?			; DATA XREF: sub_401060+Cw
dword_40B038	dd ?			; DATA XREF: sub_401060+16w
dword_40B03C	dd ?			; DATA XREF: sub_401060+20w
dword_40B040	dd ?			; DATA XREF: sub_401060+2Aw
dword_40B044	dd ?			; DATA XREF: sub_401060:loc_401098r
					; sub_401190+5Br ...
dword_40B048	dd ?			; DATA XREF: sub_401060+5Fr
dword_40B04C	dd ?			; DATA XREF: sub_401060+85r
					; sub_401060+FFw
dword_40B050	dd ?			; DATA XREF: sub_4033E0+2Cr
					; sub_4033E0+65r ...
dword_40B054	dd ?			; DATA XREF: sub_4033E0:loc_403400r
					; sub_4033E0:loc_4034A2w ...
dword_40B058	dd ?			; DATA XREF: sub_403530+9r
					; sub_403530:loc_403550w
dword_40B05C	dd ?			; DATA XREF: sub_403AE0+6r
					; sub_403AE0+9Aw ...
dword_40B060	dd ?			; DATA XREF: .text:00403C62w
					; .rdata:off_40A924o
dword_40B064	dd ?			; DATA XREF: .text:00403C6Cw
		dd ?
dword_40B06C	dd ?			; DATA XREF: .text:00403C7Bw
		dd 14h dup(?)
dword_40B0C0	dd 2Bh dup(?)		; DATA XREF: .rdata:0040A928o
dword_40B16C	dd ?			; DATA XREF: .text:00403C8Aw
		dd 2 dup(?)
dword_40B178	dd ?			; DATA XREF: .text:00403C76w
		dd 2 dup(?)
dword_40B184	dd ?			; DATA XREF: .text:00403C5Cw
		dd 86h dup(?)
dword_40B3A0	dd ?			; DATA XREF: sub_403E50+3r
					; sub_403E50:loc_403E61w
dword_40B3A4	dd ?			; DATA XREF: sub_403E70+7r
					; sub_403EF0+26r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_403E70:loc_403E88o
					; sub_403E70:loc_403ED5o ...
dword_40B3C0	dd ?			; DATA XREF: sub_403E70+25r
					; .text:00403FA5r ...
		align 20h
dword_40B3E0	dd ?			; DATA XREF: sub_406B70+7r
					; sub_406B70+29r ...
		align 20h
; struct _RTL_CRITICAL_SECTION stru_40B400
stru_40B400	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_406B70+62o
					; sub_406C40+26o ...
; struct _RTL_CRITICAL_SECTION stru_40B418
stru_40B418	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_406B70+6Eo
					; sub_406C40+32o ...
		align 20h
dword_40B440	dd ?			; DATA XREF: sub_406C90+23r
					; sub_406C90+2Cw ...
		align 40h
dword_40B480	dd 240h	dup(?)		; DATA XREF: sub_406D00+AFo
					; .data:off_40902Co
dword_40BD80	dd ?			; DATA XREF: sub_407440+21r
					; sub_407440+DBr ...
		align 20h
dword_40BDA0	dd ?			; DATA XREF: sub_401190+1A5w
dword_40BDA4	dd ?			; DATA XREF: sub_401190:loc_40134Fw
dword_40BDA8	dd ?			; DATA XREF: sub_401190+1AFw
dword_40BDAC	dd ?			; DATA XREF: sub_401060+65w
					; sub_403230+3Fr ...
dword_40BDB0	dd ?			; DATA XREF: sub_401060+6Aw
					; sub_403230+4r ...
dword_40BDB4	dd ?			; DATA XREF: sub_401190+A0o
					; sub_401190+2FEo
dword_40BDB8	dd ?			; DATA XREF: sub_401190+B3r
					; sub_401190:loc_401253r ...
		dd 9 dup(?)
byte_40BDE0	db ?			; DATA XREF: sub_407B10+53r
					; sub_407B10+A8r ...
		align 4
		dd 0Bh dup(?)
byte_40BE10	db ?			; DATA XREF: sub_407B10+Cr
					; sub_408450+7r
		align 200h
_bss		ends

;
; Imports from libdbus-1.dll
;
; Section 5. (virtual address 0000C000)
; Virtual size			: 00000D04 (   3332.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 00009200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn dbus_message_iter_get_arg_type:dword ; DATA XREF:	sub_401700+16r
		extrn dbus_message_iter_next:dword ; CODE XREF:	sub_401700+8Bp
					; sub_401700+DCp ...
		extrn dbus_message_iter_get_basic:dword	; CODE XREF: sub_401700+B5p
					; sub_401700+F6p ...
		extrn dbus_message_iter_recurse:dword ;	CODE XREF: sub_401700+12Bp
					; sub_401700+23Ap ...
		extrn dbus_message_get_type:dword ; CODE XREF: sub_401F40+30p
					; DATA XREF: sub_401F40+30r
		extrn dbus_message_get_sender:dword ; CODE XREF: sub_401F40+3Bp
					; DATA XREF: sub_401F40+3Br
		extrn dbus_message_get_destination:dword ; CODE	XREF: sub_401F40+46p
					; DATA XREF: sub_401F40+46r
		extrn dbus_message_get_member:dword ; CODE XREF: sub_401F40+B0p
					; DATA XREF: sub_401F40+B0r
		extrn dbus_message_get_interface:dword ; CODE XREF: sub_401F40+BDp
					; DATA XREF: sub_401F40+BDr
		extrn dbus_message_get_path:dword ; CODE XREF: sub_401F40+C8p
					; DATA XREF: sub_401F40+C8r
		extrn dbus_message_get_serial:dword ; CODE XREF: sub_401F40+D3p
					; DATA XREF: sub_401F40+D3r
		extrn dbus_message_iter_init:dword ; CODE XREF:	sub_401F40+10Bp
					; DATA XREF: sub_401F40+10Br
		extrn dbus_message_get_reply_serial:dword ; CODE XREF: sub_401F40+173p
					; sub_401F40+193p
					; DATA XREF: ...
		extrn dbus_message_get_error_name:dword	; CODE XREF: sub_401F40+19Ep
					; DATA XREF: sub_401F40+19Er
		extrn dbus_message_iter_append_basic:dword ; CODE XREF:	sub_4022D0+9Fp
					; sub_4022D0+E0p ...
		extrn dbus_message_type_from_string:dword ; CODE XREF: sub_4025E0+126p
					; DATA XREF: sub_4025E0+126r
		extrn dbus_error_init:dword ; CODE XREF: sub_4025E0+14Cp
					; DATA XREF: sub_4025E0:loc_402719r
		extrn dbus_connection_open:dword ; CODE	XREF: sub_4025E0+16Ap
					; DATA XREF: sub_4025E0+16Ar
		extrn dbus_message_new_signal:dword ; CODE XREF: sub_4025E0+1CBp
					; DATA XREF: sub_4025E0+1CBr
		extrn dbus_message_set_destination:dword ; CODE	XREF: sub_4025E0+1F8p
					; DATA XREF: sub_4025E0+1F8r
		extrn dbus_message_iter_init_append:dword ; CODE XREF: sub_4025E0+218p
					; DATA XREF: sub_4025E0+218r
		extrn dbus_message_iter_open_container:dword ; CODE XREF: sub_4025E0+3DCp
					; sub_4025E0+701p
					; DATA XREF: ...
		extrn dbus_message_iter_close_container:dword ;	CODE XREF: sub_4025E0+47Bp
					; DATA XREF: sub_4025E0+468r ...
		extrn dbus_message_new_method_call:dword ; CODE	XREF: sub_4025E0+6B7p
					; DATA XREF: sub_4025E0+6B7r
		extrn dbus_message_set_auto_start:dword	; CODE XREF: sub_4025E0+6CCp
					; DATA XREF: sub_4025E0+6CCr
		extrn dbus_bus_get:dword ; CODE	XREF: sub_4025E0+87Bp
					; DATA XREF: sub_4025E0+87Br
		extrn dbus_error_free:dword ; CODE XREF: sub_4025E0+8CBp
					; DATA XREF: sub_4025E0+8CBr
		extrn dbus_connection_send_with_reply_and_block:dword
					; CODE XREF: sub_4025E0+971p
					; DATA XREF: sub_4025E0+971r
		extrn dbus_error_is_set:dword ;	CODE XREF: sub_4025E0+983p
					; DATA XREF: sub_4025E0+983r
		extrn dbus_message_unref:dword ; CODE XREF: sub_4025E0+9B2p
					; sub_4025E0+9BBp
					; DATA XREF: ...
		extrn dbus_connection_unref:dword ; CODE XREF: sub_4025E0+9C4p
					; DATA XREF: sub_4025E0+9C4r
		extrn dbus_connection_send:dword ; CODE	XREF: sub_4025E0+A21p
					; DATA XREF: sub_4025E0+A21r
		extrn dbus_connection_flush:dword ; CODE XREF: sub_4025E0+A2Ep
					; DATA XREF: sub_4025E0+A2Er

;
; Imports from KERNEL32.dll
;
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_403EF0+41p
					; sub_406C40+2Dp ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_403E70+1Fp
					; .text:00403F9Fp ...
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:00403CB8p
					; DATA XREF: .text:00403CB8r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_403CE0+6Cp
					; DATA XREF: sub_403CE0+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_403CE0+74p
					; DATA XREF: sub_403CE0+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_403E70+4Cp
					; DATA XREF: sub_403E70+38r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4016A0+16p
					; sub_403AE0+91p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401190+13Fp
					; sub_4016A0+35p
					; DATA XREF: ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401190+315p
					; DATA XREF: sub_401190+315r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_403CE0+57p
					; DATA XREF: sub_403CE0+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_403CE0+7Cp
					; DATA XREF: sub_403CE0+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_403EF0+77p
					; sub_406B70+69p ...
; LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination,	LONG Exchange, LONG Comperand)
		extrn InterlockedCompareExchange:dword
; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
		extrn InterlockedExchange:dword
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_403E70+6Cp
					; .text:00403FD6p ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_403AE0+ACp
					; DATA XREF: sub_403AE0+ACr
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_403CE0+8Bp
					; DATA XREF: sub_403CE0+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401190+121p
					; .text:00403C9Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401190+8Fp
					; sub_406B70+27p
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00403CC9p
					; DATA XREF: .text:00403CC9r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_403E70+45p
					; DATA XREF: sub_403E70+32r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:00403CAFp
					; DATA XREF: .text:00403CAFr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_4033E0+10Bp
					; sub_403530+1B2p
					; DATA XREF: ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_4033E0+A8p
					; sub_403530+184p
					; DATA XREF: ...

;
; Imports from msvcrt.dll
;
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401190+23Dr
		extrn __lconv_init:dword ; DATA	XREF: sub_403200+3r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __setusermatherr:dword ; CODE XREF: sub_401060+F7p
					; DATA XREF: sub_401060+F7r
		extrn _acmdln:dword	; DATA XREF: sub_401190+164r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl _errno()
		extrn __imp__errno:dword ; DATA	XREF: _errnor
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Fr
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_401F40+11Fr
					; sub_402120+17r ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_403230+A3p
					; DATA XREF: sub_403230+A3r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl islower(int C)
		extrn __imp_islower:dword ; DATA XREF: islowerr
; int __cdecl isspace(int C)
		extrn __imp_isspace:dword ; DATA XREF: isspacer
; int __cdecl isupper(int C)
		extrn __imp_isupper:dword ; DATA XREF: isupperr
		extrn __imp_localeconv:dword ; DATA XREF: localeconvr
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; char *__cdecl	strtok(char *Str, const	char *Delim)
		extrn __imp_strtok:dword ; DATA	XREF: strtokr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr


; Section 6. (virtual address 0000D000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000A000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 40D000h
dword_40D000	dd 0			; DATA XREF: sub_401190+2D8o
		dd offset sub_401010
dword_40D008	dd 0			; DATA XREF: sub_401190:loc_401460o
dword_40D00C	dd 0			; DATA XREF: sub_401190+337o
		dd offset sub_401060
		dd offset sub_403200
dword_40D018	dd 2 dup(0)		; DATA XREF: sub_401190+32Fo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_40D030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_4031B1o
					; TlsCallback_0+36o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 0000E000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000A200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 40E000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
