;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	9604F79696EEB0638E8F48114B17CEF1
; Input	CRC32 :	B9354089

; File Name   :	C:\compspace\compare\gpg\dlls\original\dirmngr-client.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00009D14 (  40212.)
; Section size in file		: 00009E00 (  40448.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00410004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, dword ptr ds:byte_40E4C0+20h
		mov	[esp+2Ch+var_1C], offset dword_40E018
		mov	[esp+2Ch+var_24], offset dword_40E00C
		mov	[esp+2Ch+var_28], offset dword_40E008
		mov	ds:dword_40E018, eax
		mov	eax, dword ptr ds:byte_40E4C0+24h
		mov	[esp+2Ch+var_2C], offset dword_40E004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_40E01C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00410010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	dword ptr ds:byte_40E4C0+30h, 1
		mov	dword ptr ds:byte_40E4C0+2Ch, 1
		mov	dword ptr ds:byte_40E4C0+28h, 1
		mov	ds:dword_40E4FC, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_40E014, eax
		mov	eax, ds:dword_40E500
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_409710
		mov	edx, ds:dword_40E504
		mov	ds:dword_40E8BC, eax
		mov	ds:dword_40E8C0, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_409A50
		cmp	dword_40B1A8, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_4099F0
		call	sub_4099E0
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_40A7C0
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_40E500
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_40E8C4
		call	sub_40A840
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_40E8C8
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_40E8C8
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_40E000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_40E8C8
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_40E8C4

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_40D7C4
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_409D00
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_40E508, eax
		call	sub_40A2B0
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_40A370
		mov	eax, ds:dword_40E500
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_40E8A4, eax
		mov	eax, 0Ah
		mov	ds:dword_40E8AC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_40E8A8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_40E004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_40E008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_40E008, eax
		call	sub_40A400
		mov	eax, ds:__initenv
		mov	edx, ds:dword_40E00C
		mov	[eax], edx
		mov	eax, ds:dword_40E00C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_40E008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_40E004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_401650
		mov	esi, ds:dword_40E014
		test	esi, esi
		mov	ds:dword_40E010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_40E000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_40E010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_40E8C8
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_40E8C8
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_410008
		mov	[esp+88h+dwMilliseconds], offset dword_410000
		call	_initterm
		mov	ds:dword_40E8C8, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_40E8C8, 1
		mov	[esp+88h+lpProcName], offset dword_410018
		mov	[esp+88h+dwMilliseconds], offset dword_41000C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_40E500, 1
		call	sub_40A420
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_40E500, 0
		call	sub_40A420
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_40ACE0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_40B1B4
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_40B1B4
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_40ACE0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_401577+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_401570
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_401575
; ---------------------------------------------------------------------------

loc_401570:				; CODE XREF: sub_401550+7j
		mov	eax, 0

loc_401575:				; CODE XREF: sub_401550+1Ej
		pop	ebp
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401577	proc near		; CODE XREF: sub_40159F+14p
					; sub_4021B3+416p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_401550
		leave
		retn
sub_401577	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401592	proc near		; CODE XREF: sub_401650+44Fp
					; sub_401650+638p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_401592	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40159F	proc near		; CODE XREF: sub_4021B3+43p
					; sub_402612+63p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_401577
		leave
		retn
sub_40159F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015BA	proc near		; CODE XREF: sub_401E06+14Fp
					; sub_401E06+174p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jns	short loc_4015CD
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4015DA
; ---------------------------------------------------------------------------

loc_4015CD:				; CODE XREF: sub_4015BA+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

locret_4015DA:				; CODE XREF: sub_4015BA+11j
		leave
		retn
sub_4015BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015DC	proc near		; DATA XREF: sub_401650+4Do

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	[ebp+arg_0], 31h ; switch 50 cases
		ja	short loc_40163F ; jumptable 004015F5 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_40C3D4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4015F7:				; CODE XREF: sub_4015DC+19j
					; DATA XREF: .rdata:off_40C3D4o
		mov	[ebp+var_4], offset aDirmngrClientD ; jumptable	004015F5 case 11
		jmp	short loc_401646
; ---------------------------------------------------------------------------

loc_401600:				; CODE XREF: sub_4015DC+19j
					; DATA XREF: .rdata:off_40C3D4o
		mov	[ebp+var_4], offset a1_1_1 ; jumptable 004015F5	case 13
		jmp	short loc_401646
; ---------------------------------------------------------------------------

loc_401609:				; CODE XREF: sub_4015DC+19j
					; DATA XREF: .rdata:off_40C3D4o
		mov	[ebp+var_4], offset aCopyrightC2013 ; jumptable	004015F5 case 14
		jmp	short loc_401646
; ---------------------------------------------------------------------------

loc_401612:				; CODE XREF: sub_4015DC+19j
					; DATA XREF: .rdata:off_40C3D4o
		mov	[ebp+var_4], offset aMingw32 ; jumptable 004015F5 case 17
		jmp	short loc_401646
; ---------------------------------------------------------------------------

loc_40161B:				; CODE XREF: sub_4015DC+19j
					; DATA XREF: .rdata:off_40C3D4o
		mov	[ebp+var_4], offset aPleaseReportBu ; jumptable	004015F5 case 19
		jmp	short loc_401646
; ---------------------------------------------------------------------------

loc_401624:				; CODE XREF: sub_4015DC+19j
					; DATA XREF: .rdata:off_40C3D4o
		mov	[ebp+var_4], offset aBugDirmngr@gnu ; jumptable	004015F5 case 49
		jmp	short loc_401646
; ---------------------------------------------------------------------------

loc_40162D:				; CODE XREF: sub_4015DC+19j
					; DATA XREF: .rdata:off_40C3D4o
		mov	[ebp+var_4], offset aUsageDirmngrCl ; jumptable	004015F5 cases 1,40
		jmp	short loc_401646
; ---------------------------------------------------------------------------

loc_401636:				; CODE XREF: sub_4015DC+19j
					; DATA XREF: .rdata:off_40C3D4o
		mov	[ebp+var_4], offset aSyntaxDirmngrC ; jumptable	004015F5 case 41
		jmp	short loc_401646
; ---------------------------------------------------------------------------

loc_40163F:				; CODE XREF: sub_4015DC+Aj
					; sub_4015DC+19j
					; DATA XREF: ...
		mov	[ebp+var_4], 0	; jumptable 004015F5 default case

loc_401646:				; CODE XREF: sub_4015DC+22j
					; sub_4015DC+2Bj ...
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4015DC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40164B	proc near		; CODE XREF: sub_401650+A8p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_40164B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401650	proc near		; CODE XREF: sub_401180+265p

wVersionRequested= word	ptr -214h
lpWSAData	= dword	ptr -210h
WSAData		= WSAData ptr -204h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Code		= dword	ptr -4
var_s0		= dword	ptr  0
var_s4		= dword	ptr  4
arg_0		= byte ptr  0Ch

		lea	ecx, [esp-8+arg_0]
		and	esp, 0FFFFFFF0h
		push	dword ptr [ecx-4]
		push	ebp
		mov	ebp, esp
		push	ebx
		push	ecx
		sub	esp, 210h
		mov	ebx, ecx
		call	sub_40A400
		mov	[ebp+var_74], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	dword ptr [esp+214h+wVersionRequested],	offset sub_4015DC
		call	sub_406255
		mov	[esp+214h+lpWSAData], 1	; int
		mov	dword ptr [esp+214h+wVersionRequested],	offset aDirmngrClient ;	"dirmngr-client"
		call	sub_406586
		lea	eax, [ebp+WSAData]
		mov	[esp+214h+lpWSAData], eax ; lpWSAData
		mov	dword ptr [esp+214h+wVersionRequested],	202h ; wVersionRequested
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		mov	dword ptr [esp+214h+wVersionRequested],	0
		call	sub_4065E4
		mov	dword ptr [esp+214h+wVersionRequested],	eax
		call	assuan_set_assuan_log_prefix
		mov	[esp+4+Code], 0Ah
		call	assuan_set_gpg_err_source
		call	sub_40164B
		mov	[ebp+var_6C], ebx
		lea	eax, [ebx+4]
		mov	[ebp+var_68], eax
		mov	[ebp+var_64], 1
		jmp	loc_40186F
; ---------------------------------------------------------------------------

loc_401712:				; CODE XREF: sub_401650+234j
		mov	eax, [ebp+var_5C]
		cmp	eax, 1F6h
		jz	loc_4017F6
		cmp	eax, 1F6h
		jg	short loc_40176C
		cmp	eax, 75h
		jz	loc_401811
		cmp	eax, 75h
		jg	short loc_40174C
		cmp	eax, 6Ch
		jz	loc_40181D
		cmp	eax, 71h
		jz	loc_4017C9
		jmp	loc_401867
; ---------------------------------------------------------------------------

loc_40174C:				; CODE XREF: sub_401650+E3j
		cmp	eax, 1F4h
		jz	loc_4017DB
		cmp	eax, 1F4h
		jg	loc_4017ED
		cmp	eax, 76h
		jz	short loc_4017B7
		jmp	loc_401867
; ---------------------------------------------------------------------------

loc_40176C:				; CODE XREF: sub_401650+D5j
		cmp	eax, 1F9h
		jz	loc_401829
		cmp	eax, 1F9h
		jg	short loc_401791
		cmp	eax, 1F7h
		jz	short loc_4017FF
		cmp	eax, 1F8h
		jz	short loc_401808
		jmp	loc_401867
; ---------------------------------------------------------------------------

loc_401791:				; CODE XREF: sub_401650+12Cj
		cmp	eax, 1FBh
		jz	loc_401832
		cmp	eax, 1FBh
		jl	loc_40183E
		cmp	eax, 1FDh
		jz	loc_40185B
		jmp	loc_401867
; ---------------------------------------------------------------------------

loc_4017B7:				; CODE XREF: sub_401650+115j
		mov	eax, ds:dword_40E024
		add	eax, 1
		mov	ds:dword_40E024, eax
		jmp	loc_40186F
; ---------------------------------------------------------------------------

loc_4017C9:				; CODE XREF: sub_401650+F1j
		mov	eax, ds:dword_40E020
		add	eax, 1
		mov	ds:dword_40E020, eax
		jmp	loc_40186F
; ---------------------------------------------------------------------------

loc_4017DB:				; CODE XREF: sub_401650+101j
		mov	eax, ds:dword_40E044
		add	eax, 1
		mov	ds:dword_40E044, eax
		jmp	loc_40186F
; ---------------------------------------------------------------------------

loc_4017ED:				; CODE XREF: sub_401650+10Cj
		mov	[ebp+var_10], 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_4017F6:				; CODE XREF: sub_401650+CAj
		mov	[ebp+var_14], 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_4017FF:				; CODE XREF: sub_401650+133j
		mov	[ebp+var_18], 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_401808:				; CODE XREF: sub_401650+13Aj
		mov	[ebp+var_1C], 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_401811:				; CODE XREF: sub_401650+DAj
		mov	ds:dword_40E03C, 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_40181D:				; CODE XREF: sub_401650+E8j
		mov	ds:dword_40E040, 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_401829:				; CODE XREF: sub_401650+121j
		mov	[ebp+var_20], 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_401832:				; CODE XREF: sub_401650+146j
		mov	ds:dword_40E034, 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_40183E:				; CODE XREF: sub_401650+151j
		mov	ds:dword_40E034, 1
		mov	ds:dword_40E038, 1
		mov	[ebp+var_24], 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_40185B:				; CODE XREF: sub_401650+15Cj
		mov	ds:dword_40E030, 1
		jmp	short loc_40186F
; ---------------------------------------------------------------------------

loc_401867:				; CODE XREF: sub_401650+F7j
					; sub_401650+117j ...
		mov	[ebp+var_60], 2
		nop

loc_40186F:				; CODE XREF: sub_401650+BDj
					; sub_401650+174j ...
		mov	[esp+4+var_s0],	offset dword_40B000
		lea	eax, [ebp+var_6C]
		mov	[esp+4+Code], eax
		call	sub_405102
		test	eax, eax
		jnz	loc_401712
		mov	[esp+4+Code], 0
		call	sub_406264
		test	eax, eax
		jz	short loc_4018A6
		mov	[esp+4+Code], 2	; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4018A6:				; CODE XREF: sub_401650+248j
		mov	eax, ds:dword_40E034
		test	eax, eax
		jz	short loc_401904
		mov	[ebp+var_28], 0
		jmp	short loc_4018C7
; ---------------------------------------------------------------------------

loc_4018B8:				; CODE XREF: sub_401650+27Ej
		mov	eax, [ebp+var_28]
		add	eax, offset byte_40E060
		mov	byte ptr [eax],	0FFh
		add	[ebp+var_28], 1

loc_4018C7:				; CODE XREF: sub_401650+266j
		cmp	[ebp+var_28], 0FFh
		jle	short loc_4018B8
		mov	[ebp+var_2C], offset aAbcdefghijklmn ; "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm"...
		mov	[ebp+var_28], 0
		jmp	short loc_4018FA
; ---------------------------------------------------------------------------

loc_4018E0:				; CODE XREF: sub_401650+2B2j
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+var_28]
		mov	ds:byte_40E060[eax], dl
		add	[ebp+var_2C], 1
		add	[ebp+var_28], 1

loc_4018FA:				; CODE XREF: sub_401650+28Ej
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4018E0

loc_401904:				; CODE XREF: sub_401650+25Dj
		cmp	[ebp+var_10], 0
		jz	short loc_401916
		mov	[ebp+var_C], 0
		jmp	loc_401A16
; ---------------------------------------------------------------------------

loc_401916:				; CODE XREF: sub_401650+2B8j
		cmp	[ebp+var_1C], 0
		jnz	short loc_401922
		cmp	[ebp+var_20], 0
		jz	short loc_401940

loc_401922:				; CODE XREF: sub_401650+2CAj
		mov	eax, [ebx]
		test	eax, eax
		jnz	short loc_401934
		mov	[esp+4+Code], 1
		call	sub_4060FF

loc_401934:				; CODE XREF: sub_401650+2D6j
		mov	[ebp+var_C], 0
		jmp	loc_401A16
; ---------------------------------------------------------------------------

loc_401940:				; CODE XREF: sub_401650+2D0j
		cmp	[ebp+var_24], 0
		jz	short loc_401968
		mov	[ebp+var_C], 0
		mov	eax, [ebx]
		test	eax, eax
		jz	loc_401A16
		mov	[esp+4+Code], 1
		call	sub_4060FF
		jmp	loc_401A16
; ---------------------------------------------------------------------------

loc_401968:				; CODE XREF: sub_401650+2F4j
		mov	eax, [ebx]
		test	eax, eax
		jnz	short loc_4019B2
		lea	eax, [ebp+var_74]
		mov	[esp+4+var_s4],	eax ; int
		lea	eax, [ebp+var_70]
		mov	[esp+4+var_s0],	eax ; int
		mov	[esp+4+Code], 0	; char *
		call	sub_402612
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_401A16
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	gpg_strerror
		mov	[esp+4+var_s0],	eax ; char
		mov	[esp+4+Code], offset aErrorReadingCe ; "error reading certificate from stdin: %"...
		call	sub_406AF9
		jmp	short loc_401A16
; ---------------------------------------------------------------------------

loc_4019B2:				; CODE XREF: sub_401650+31Cj
		mov	eax, [ebx]
		cmp	eax, 1
		jnz	short loc_401A03
		mov	eax, [ebx+4]
		mov	eax, [eax]
		lea	edx, [ebp+var_74]
		mov	[esp+4+var_s4],	edx ; int
		lea	edx, [ebp+var_70]
		mov	[esp+4+var_s0],	edx ; int
		mov	[esp+4+Code], eax ; char *
		call	sub_402612
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401A16
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	gpg_strerror
		mov	edx, [ebx+4]
		mov	edx, [edx]
		mov	[esp+4+var_s4],	eax
		mov	[esp+4+var_s0],	edx ; char
		mov	[esp+4+Code], offset aErrorReading_0 ; "error reading certificate from `%s': %s"...
		call	sub_406AF9
		jmp	short loc_401A16
; ---------------------------------------------------------------------------

loc_401A03:				; CODE XREF: sub_401650+367j
		mov	[ebp+var_C], 0
		mov	[esp+4+Code], 1
		call	sub_4060FF

loc_401A16:				; CODE XREF: sub_401650+2C1j
					; sub_401650+2EBj ...
		mov	[esp+4+Code], 0
		call	sub_406264
		test	eax, eax
		jz	short loc_401A32
		mov	[esp+4+Code], 2	; Code
		call	exit
; ---------------------------------------------------------------------------

loc_401A32:				; CODE XREF: sub_401650+3D4j
		mov	eax, [ebp+var_74]
		cmp	eax, 4E20h
		jbe	short loc_401A54
		mov	[esp+4+Code], offset aCertificateToo ; "certificate too	large to make any sense"...
		call	sub_406AF9
		mov	[esp+4+Code], 2	; Code
		call	exit
; ---------------------------------------------------------------------------

loc_401A54:				; CODE XREF: sub_401650+3EAj
		mov	[esp+4+Code], 1
		call	sub_401E06
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jnz	short loc_401A75
		mov	[esp+4+Code], 2	; Code
		call	exit
; ---------------------------------------------------------------------------

loc_401A75:				; CODE XREF: sub_401650+417j
		cmp	[ebp+var_10], 0
		jnz	loc_401C25
		cmp	[ebp+var_24], 0
		jz	short loc_401ABB

loc_401A85:				; CODE XREF: sub_401650+447j
		mov	eax, [ebp+var_38]
		mov	[esp+4+Code], eax
		call	sub_402F4D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401A85
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	sub_401592
		cmp	eax, 3FFFh
		jnz	loc_401C25
		mov	[ebp+var_C], 0
		jmp	loc_401C25
; ---------------------------------------------------------------------------

loc_401ABB:				; CODE XREF: sub_401650+433j
		cmp	[ebp+var_1C], 0
		jz	short loc_401B29
		mov	[ebp+var_30], 0
		jmp	short loc_401B18
; ---------------------------------------------------------------------------

loc_401ACA:				; CODE XREF: sub_401650+4CCj
		mov	eax, [ebx+4]
		mov	eax, [eax]
		mov	[esp+4+var_s0],	eax
		mov	eax, [ebp+var_38]
		mov	[esp+4+Code], eax
		call	sub_402D4E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401B08
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	gpg_strerror
		mov	[esp+4+var_s0],	eax ; char
		mov	[esp+4+Code], offset aLookupFailedS ; "lookup failed: %s\n"
		call	sub_406AF9
		mov	eax, [ebp+var_C]
		mov	[ebp+var_30], eax

loc_401B08:				; CODE XREF: sub_401650+495j
		mov	eax, [ebx]
		sub	eax, 1
		mov	[ebx], eax
		mov	eax, [ebx+4]
		add	eax, 4
		mov	[ebx+4], eax

loc_401B18:				; CODE XREF: sub_401650+478j
		mov	eax, [ebx]
		test	eax, eax
		jnz	short loc_401ACA
		mov	eax, [ebp+var_30]
		mov	[ebp+var_C], eax
		jmp	loc_401C25
; ---------------------------------------------------------------------------

loc_401B29:				; CODE XREF: sub_401650+46Fj
		cmp	[ebp+var_20], 0
		jz	short loc_401BA0
		mov	[ebp+var_34], 0
		jmp	short loc_401B8F
; ---------------------------------------------------------------------------

loc_401B38:				; CODE XREF: sub_401650+543j
		mov	eax, [ebx+4]
		mov	eax, [eax]
		mov	[esp+4+var_s0],	eax ; char *
		mov	eax, [ebp+var_38]
		mov	[esp+4+Code], eax ; int
		call	sub_402B77
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401B7F
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	gpg_strerror
		mov	edx, [ebx+4]
		mov	edx, [edx]
		mov	[esp+4+var_s4],	eax
		mov	[esp+4+var_s0],	edx ; char
		mov	[esp+4+Code], offset aLoadingCrlSFai ; "loading	CRL `%s' failed: %s\n"
		call	sub_406AF9
		mov	eax, [ebp+var_C]
		mov	[ebp+var_34], eax

loc_401B7F:				; CODE XREF: sub_401650+503j
		mov	eax, [ebx]
		sub	eax, 1
		mov	[ebx], eax
		mov	eax, [ebx+4]
		add	eax, 4
		mov	[ebx+4], eax

loc_401B8F:				; CODE XREF: sub_401650+4E6j
		mov	eax, [ebx]
		test	eax, eax
		jnz	short loc_401B38
		mov	eax, [ebp+var_34]
		mov	[ebp+var_C], eax
		jmp	loc_401C25
; ---------------------------------------------------------------------------

loc_401BA0:				; CODE XREF: sub_401650+4DDj
		cmp	[ebp+var_14], 0
		jz	short loc_401BCF
		mov	edx, [ebp+var_74]
		mov	eax, [ebp+var_70]
		mov	[esp+4+var_s4],	edx
		mov	[esp+4+var_s0],	eax
		mov	eax, [ebp+var_38]
		mov	[esp+4+Code], eax
		call	sub_402A21
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_70]
		mov	[esp+4+Code], eax ; void *
		call	sub_404649
		jmp	short loc_401C25
; ---------------------------------------------------------------------------

loc_401BCF:				; CODE XREF: sub_401650+554j
		cmp	[ebp+var_18], 0
		jz	short loc_401BFE
		mov	edx, [ebp+var_74]
		mov	eax, [ebp+var_70]
		mov	[esp+4+var_s4],	edx
		mov	[esp+4+var_s0],	eax
		mov	eax, [ebp+var_38]
		mov	[esp+4+Code], eax
		call	sub_402ACC
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_70]
		mov	[esp+4+Code], eax ; void *
		call	sub_404649
		jmp	short loc_401C25
; ---------------------------------------------------------------------------

loc_401BFE:				; CODE XREF: sub_401650+583j
		mov	edx, [ebp+var_74]
		mov	eax, [ebp+var_70]
		mov	[esp+4+var_s4],	edx
		mov	[esp+4+var_s0],	eax ; char
		mov	eax, [ebp+var_38]
		mov	[esp+4+Code], eax
		call	sub_40294C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_70]
		mov	[esp+4+Code], eax ; void *
		call	sub_404649

loc_401C25:				; CODE XREF: sub_401650+429j
					; sub_401650+459j ...
		mov	eax, [ebp+var_38]
		mov	[esp+4+Code], eax
		call	assuan_release
		cmp	[ebp+var_10], 0
		jz	short loc_401C55
		mov	eax, ds:dword_40E020
		test	eax, eax
		jnz	short loc_401C4B
		mov	[esp+4+Code], offset aADirmngrDaemon ; "a dirmngr daemon is up and running\n"
		call	sub_406ACF

loc_401C4B:				; CODE XREF: sub_401650+5EDj
		mov	eax, 0
		jmp	loc_401D7C
; ---------------------------------------------------------------------------

loc_401C55:				; CODE XREF: sub_401650+5E4j
		cmp	[ebp+var_1C], 0
		jnz	short loc_401C67
		cmp	[ebp+var_20], 0
		jnz	short loc_401C67
		cmp	[ebp+var_24], 0
		jz	short loc_401C76

loc_401C67:				; CODE XREF: sub_401650+609j
					; sub_401650+60Fj
		cmp	[ebp+var_C], 0
		setnz	al
		movzx	eax, al
		jmp	loc_401D7C
; ---------------------------------------------------------------------------

loc_401C76:				; CODE XREF: sub_401650+615j
		cmp	[ebp+var_14], 0
		jz	short loc_401CE0
		cmp	[ebp+var_C], 0
		jz	short loc_401CAB
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	sub_401592
		cmp	eax, 9Dh
		jnz	short loc_401CAB
		mov	eax, ds:dword_40E020
		test	eax, eax
		jnz	short loc_401CD6
		mov	[esp+4+Code], offset aCertificateAlr ; "certificate already cached\n"
		call	sub_406ACF
		jmp	short loc_401CD6
; ---------------------------------------------------------------------------

loc_401CAB:				; CODE XREF: sub_401650+630j
					; sub_401650+642j
		cmp	[ebp+var_C], 0
		jz	short loc_401CD6
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	gpg_strerror
		mov	[esp+4+var_s0],	eax ; char
		mov	[esp+4+Code], offset aErrorCachingCe ; "error caching certificate: %s\n"
		call	sub_406AF9
		mov	eax, 1
		jmp	loc_401D7C
; ---------------------------------------------------------------------------

loc_401CD6:				; CODE XREF: sub_401650+64Bj
					; sub_401650+659j ...
		mov	eax, 0
		jmp	loc_401D7C
; ---------------------------------------------------------------------------

loc_401CE0:				; CODE XREF: sub_401650+62Aj
		cmp	[ebp+var_18], 0
		jz	short loc_401D0E
		cmp	[ebp+var_C], 0
		jz	short loc_401D0E
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	gpg_strerror
		mov	[esp+4+var_s0],	eax ; char
		mov	[esp+4+Code], offset aValidationOfCe ; "validation of certificate failed: %s\n"
		call	sub_406AF9
		mov	eax, 1
		jmp	short loc_401D7C
; ---------------------------------------------------------------------------

loc_401D0E:				; CODE XREF: sub_401650+694j
					; sub_401650+69Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_401D30
		mov	eax, ds:dword_40E020
		test	eax, eax
		jnz	short loc_401D29
		mov	[esp+4+Code], offset aCertificateIsV ; "certificate is valid\n"
		call	sub_406ACF

loc_401D29:				; CODE XREF: sub_401650+6CBj
		mov	eax, 0
		jmp	short loc_401D7C
; ---------------------------------------------------------------------------

loc_401D30:				; CODE XREF: sub_401650+6C2j
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	sub_401592
		cmp	eax, 5Eh
		jnz	short loc_401D5C
		mov	eax, ds:dword_40E020
		test	eax, eax
		jnz	short loc_401D55
		mov	[esp+4+Code], offset aCertificateHas ; "certificate has	been revoked\n"
		call	sub_406ACF

loc_401D55:				; CODE XREF: sub_401650+6F7j
		mov	eax, 1
		jmp	short loc_401D7C
; ---------------------------------------------------------------------------

loc_401D5C:				; CODE XREF: sub_401650+6EEj
		mov	eax, [ebp+var_C]
		mov	[esp+4+Code], eax
		call	gpg_strerror
		mov	[esp+4+var_s0],	eax ; char
		mov	[esp+4+Code], offset aCertificateChe ; "certificate check failed: %s\n"
		call	sub_406AF9
		mov	eax, 2

loc_401D7C:				; CODE XREF: sub_401650+600j
					; sub_401650+621j ...
		lea	esp, [ebp-8]
		pop	ecx
		pop	ebx
		pop	ebp
		lea	esp, [ecx-4]
		retn
sub_401650	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401D86	proc near		; DATA XREF: sub_40294C+65o
					; sub_402A21+37o ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_40E024
		cmp	eax, 2
		jle	short loc_401DA9
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aGotStatusS ; "got status: `%s'\n"
		call	sub_406ACF

loc_401DA9:				; CODE XREF: sub_401D86+Ej
		mov	eax, 0
		leave
		retn
sub_401D86	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401DB0	proc near		; DATA XREF: sub_402D4E+18Eo

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_401DFF
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4031B2
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_401DFF
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorWritingBa ; "error writing base64 encoding: %s\n"
		call	sub_406AF9

loc_401DFF:				; CODE XREF: sub_401DB0+10j
					; sub_401DB0+32j
		mov	eax, 0
		leave
		retn
sub_401DB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401E06	proc near		; CODE XREF: sub_401650+40Bp
					; sub_401E06+256p ...

VarName		= dword	ptr -68h
Val		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_18], 0
		mov	eax, ds:dword_40E02C
		test	eax, eax
		jnz	short loc_401E2A
		mov	[esp+68h+VarName], offset VarName ; "DIRMNGR_INFO"
		call	getenv
		jmp	short loc_401E2F
; ---------------------------------------------------------------------------

loc_401E2A:				; CODE XREF: sub_401E06+14j
		mov	eax, 0

loc_401E2F:				; CODE XREF: sub_401E06+22j
		mov	[ebp+Str], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_401E5F
		cmp	[ebp+Str], 0
		jz	short loc_401E48
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401E5F

loc_401E48:				; CODE XREF: sub_401E06+36j
		call	sub_4043EB
		mov	[esp+68h+VarName], eax ; char *
		call	sub_4045EF
		mov	[ebp+Str], eax
		mov	[ebp+var_18], 1

loc_401E5F:				; CODE XREF: sub_401E06+30j
					; sub_401E06+40j
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+VarName], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401E98
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	gpg_strerror
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+VarName], offset aFailedToAlloca ; "failed to allocate	assuan context:	%s\n"
		call	sub_406AF9
		mov	eax, 0
		jmp	locret_4021B1
; ---------------------------------------------------------------------------

loc_401E98:				; CODE XREF: sub_401E06+6Bj
		cmp	[ebp+Str], 0
		jz	short loc_401EAC
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_401FDA

loc_401EAC:				; CODE XREF: sub_401E06+96j
		cmp	[ebp+arg_0], 0
		jz	short loc_401EC8
		mov	[esp+68h+VarName], offset aApparentlyNoRu ; "apparently	no running dirmngr\n"
		call	sub_406AF9
		mov	eax, 0
		jmp	locret_4021B1
; ---------------------------------------------------------------------------

loc_401EC8:				; CODE XREF: sub_401E06+AAj
		mov	eax, ds:dword_40E024
		test	eax, eax
		jz	short loc_401EDD
		mov	[esp+68h+VarName], offset aNoRunningDirmn ; "no	running	dirmngr	- starting one\n"
		call	sub_406ACF

loc_401EDD:				; CODE XREF: sub_401E06+C9j
		mov	eax, ds:Str
		test	eax, eax
		jz	short loc_401EF2
		mov	eax, ds:Str
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401EFC

loc_401EF2:				; CODE XREF: sub_401E06+DEj
		mov	ds:Str,	offset a_Dirmngr ; "./dirmngr"

loc_401EFC:				; CODE XREF: sub_401E06+EAj
		mov	eax, ds:Str
		mov	[esp+68h+Val], 2Fh ; Ch
		mov	[esp+68h+VarName], eax ; Str
		call	strrchr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_401F24
		mov	eax, ds:Str
		mov	[ebp+var_1C], eax
		jmp	short loc_401F28
; ---------------------------------------------------------------------------

loc_401F24:				; CODE XREF: sub_401E06+112j
		add	[ebp+var_1C], 1

loc_401F28:				; CODE XREF: sub_401E06+11Cj
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_38], eax
		mov	[ebp+var_34], offset aServer ; "--server"
		mov	[ebp+var_30], 0
		mov	[ebp+var_20], 0
		call	sub_4066B3
		cmp	eax, 0FFFFFFFFh
		jz	short loc_401F67
		call	sub_4066B3
		mov	[esp+68h+VarName], eax
		call	sub_4015BA
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*4+var_44], edx
		add	[ebp+var_20], 1

loc_401F67:				; CODE XREF: sub_401E06+145j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+68h+VarName], eax ; File
		call	_fileno
		mov	[esp+68h+VarName], eax
		call	sub_4015BA
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*4+var_44], edx
		add	[ebp+var_20], 1
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*4+var_44], 0FFFFFFFFh
		mov	edx, ds:Str
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+var_50], 0
		mov	[esp+68h+var_54], 0
		mov	[esp+68h+var_58], 0
		lea	ecx, [ebp+var_44]
		mov	[esp+68h+var_5C], ecx
		lea	ecx, [ebp+var_38]
		mov	[esp+68h+var_60], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+VarName], eax
		call	assuan_pipe_connect
		mov	[ebp+var_C], eax
		jmp	loc_40217B
; ---------------------------------------------------------------------------

loc_401FDA:				; CODE XREF: sub_401E06+A0j
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; char *
		call	sub_4045EF
		mov	[ebp+Str], eax
		cmp	[ebp+var_18], 0
		jnz	loc_402109
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_402109
		mov	[esp+68h+Val], 3Ah ; char
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; Str
		call	strchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_402024
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+Str]
		jnz	short loc_402066

loc_402024:				; CODE XREF: sub_401E06+214j
		mov	[esp+68h+VarName], offset aMalformedDirmn ; "malformed DIRMNGR_INFO environment	vari"...
		call	sub_406AF9
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; void *
		call	sub_404649
		cmp	[ebp+arg_0], 0
		jz	short loc_40204B
		mov	eax, 0
		jmp	locret_4021B1
; ---------------------------------------------------------------------------

loc_40204B:				; CODE XREF: sub_401E06+239j
		mov	ds:dword_40E02C, 1
		mov	[esp+68h+VarName], 0
		call	sub_401E06
		jmp	locret_4021B1
; ---------------------------------------------------------------------------

loc_402066:				; CODE XREF: sub_401E06+21Cj
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	[esp+68h+VarName], eax ; Str
		call	atoi
		mov	[ebp+var_24], eax
		jmp	short loc_402084
; ---------------------------------------------------------------------------

loc_402080:				; CODE XREF: sub_401E06+290j
		add	[ebp+var_14], 1

loc_402084:				; CODE XREF: sub_401E06+278j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402098
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_402080

loc_402098:				; CODE XREF: sub_401E06+286j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4020B2
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+68h+VarName], eax ; Str
		call	atoi
		jmp	short loc_4020B7
; ---------------------------------------------------------------------------

loc_4020B2:				; CODE XREF: sub_401E06+29Aj
		mov	eax, 0

loc_4020B7:				; CODE XREF: sub_401E06+2AAj
		mov	dword ptr [ebp+var_28],	eax
		cmp	dword ptr [ebp+var_28],	1
		jz	short loc_402110
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+VarName], offset aDirmngrProtoco ; "dirmngr protocol version %d is not	supp"...
		call	sub_406AF9
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; void *
		call	sub_404649
		cmp	[ebp+arg_0], 0
		jz	short loc_4020EE
		mov	eax, 0
		jmp	locret_4021B1
; ---------------------------------------------------------------------------

loc_4020EE:				; CODE XREF: sub_401E06+2DCj
		mov	ds:dword_40E02C, 1
		mov	[esp+68h+VarName], 0
		call	sub_401E06
		jmp	locret_4021B1
; ---------------------------------------------------------------------------

loc_402109:				; CODE XREF: sub_401E06+1E6j
					; sub_401E06+1F4j
		mov	[ebp+var_24], 0FFFFFFFFh

loc_402110:				; CODE XREF: sub_401E06+2B8j
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+var_5C], 0
		mov	edx, [ebp+var_24]
		mov	[esp+68h+var_60], edx
		mov	edx, [ebp+Str]
		mov	[esp+68h+Val], edx ; char
		mov	[esp+68h+VarName], eax
		call	assuan_socket_connect
		mov	[ebp+var_C], eax
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; void *
		call	sub_404649
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	sub_401592
		cmp	eax, 103h
		jnz	short loc_40217B
		cmp	[ebp+arg_0], 0
		jnz	short loc_40217B
		mov	[esp+68h+VarName], offset aCanTConnectToT ; "can't connect to the dirmngr - trying f"...
		call	sub_406AF9
		mov	ds:dword_40E02C, 1
		mov	[esp+68h+VarName], 0
		call	sub_401E06
		jmp	short locret_4021B1
; ---------------------------------------------------------------------------

loc_40217B:				; CODE XREF: sub_401E06+1CFj
					; sub_401E06+349j ...
		cmp	[ebp+var_C], 0
		jz	short loc_4021AE
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+VarName], eax
		call	assuan_release
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	gpg_strerror
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+VarName], offset aCanTConnectT_0 ; "can't connect to the dirmngr: %s\n"
		call	sub_406AF9
		mov	eax, 0
		jmp	short locret_4021B1
; ---------------------------------------------------------------------------

loc_4021AE:				; CODE XREF: sub_401E06+379j
		mov	eax, [ebp+var_2C]

locret_4021B1:				; CODE XREF: sub_401E06+8Dj
					; sub_401E06+BDj ...
		leave
		retn
sub_401E06	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4021B3(char *, int, int)
sub_4021B3	proc near		; CODE XREF: sub_402612+23p
					; sub_402F4D+22p

Filename	= dword	ptr -48h
Mode		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2E		= byte ptr -2Eh
var_2D		= byte ptr -2Dh
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_24], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_4021DC
		mov	eax, offset Mode ; "r"
		mov	[esp+48h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Filename], eax	; Filename
		call	fopen
		jmp	short loc_4021E1
; ---------------------------------------------------------------------------

loc_4021DC:				; CODE XREF: sub_4021B3+11j
		mov	eax, ds:_iob

loc_4021E1:				; CODE XREF: sub_4021B3+27j
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_402200
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+Filename], eax
		call	sub_40159F
		jmp	locret_402610
; ---------------------------------------------------------------------------

loc_402200:				; CODE XREF: sub_4021B3+35j
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 2000h
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Filename], eax	; size_t
		call	sub_40452E
		mov	[ebp+var_18], eax
		mov	[ebp+var_20], 0
		jmp	loc_402576
; ---------------------------------------------------------------------------

loc_40222F:				; CODE XREF: sub_4021B3+3D5j
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_40E038
		test	eax, eax
		jz	loc_4023A8
		cmp	[ebp+var_C], 25h
		jnz	loc_40239E
		mov	eax, [ebp+File]
		mov	[esp+48h+Filename], eax	; File
		call	getc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_402590
		mov	eax, [ebp+var_C]
		mov	[ebp+var_2E], al
		mov	eax, [ebp+File]
		mov	[esp+48h+Filename], eax	; File
		call	getc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_402593
		mov	eax, [ebp+var_C]
		mov	[ebp+var_2D], al
		movzx	eax, [ebp+var_2E]
		cmp	al, 2Fh
		jle	short loc_402299
		movzx	eax, [ebp+var_2E]
		cmp	al, 39h
		jle	short loc_4022B9

loc_402299:				; CODE XREF: sub_4021B3+DCj
		movzx	eax, [ebp+var_2E]
		cmp	al, 40h
		jle	short loc_4022A9
		movzx	eax, [ebp+var_2E]
		cmp	al, 46h
		jle	short loc_4022B9

loc_4022A9:				; CODE XREF: sub_4021B3+ECj
		movzx	eax, [ebp+var_2E]
		cmp	al, 60h
		jle	short loc_4022E9
		movzx	eax, [ebp+var_2E]
		cmp	al, 66h
		jg	short loc_4022E9

loc_4022B9:				; CODE XREF: sub_4021B3+E4j
					; sub_4021B3+F4j
		movzx	eax, [ebp+var_2D]
		cmp	al, 2Fh
		jle	short loc_4022C9
		movzx	eax, [ebp+var_2D]
		cmp	al, 39h
		jle	short loc_40231F

loc_4022C9:				; CODE XREF: sub_4021B3+10Cj
		movzx	eax, [ebp+var_2D]
		cmp	al, 40h
		jle	short loc_4022D9
		movzx	eax, [ebp+var_2D]
		cmp	al, 46h
		jle	short loc_40231F

loc_4022D9:				; CODE XREF: sub_4021B3+11Cj
		movzx	eax, [ebp+var_2D]
		cmp	al, 60h
		jle	short loc_4022E9
		movzx	eax, [ebp+var_2D]
		cmp	al, 66h
		jle	short loc_40231F

loc_4022E9:				; CODE XREF: sub_4021B3+FCj
					; sub_4021B3+104j ...
		mov	[esp+48h+Filename], offset aInvalidPercent ; "invalid percent escape sequence\n"
		call	sub_406AF9
		mov	[ebp+var_24], 1

loc_4022FC:				; CODE XREF: sub_4021B3+165j
		mov	eax, [ebp+File]
		mov	[esp+48h+Filename], eax	; File
		call	getc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_402596
		cmp	[ebp+var_C], 0Ah
		jnz	short loc_4022FC
		jmp	loc_402596
; ---------------------------------------------------------------------------

loc_40231F:				; CODE XREF: sub_4021B3+114j
					; sub_4021B3+124j ...
		movzx	eax, [ebp+var_2E]
		cmp	al, 39h
		jg	short loc_402338
		movzx	eax, [ebp+var_2E]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40235E
; ---------------------------------------------------------------------------

loc_402338:				; CODE XREF: sub_4021B3+172j
		movzx	eax, [ebp+var_2E]
		cmp	al, 46h
		jg	short loc_40234F
		movzx	eax, [ebp+var_2E]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40235C
; ---------------------------------------------------------------------------

loc_40234F:				; CODE XREF: sub_4021B3+18Bj
		movzx	eax, [ebp+var_2E]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40235C:				; CODE XREF: sub_4021B3+19Aj
		mov	edx, eax

loc_40235E:				; CODE XREF: sub_4021B3+183j
		movzx	eax, [ebp+var_2D]
		cmp	al, 39h
		jg	short loc_402372
		movzx	eax, [ebp+var_2D]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_402390
; ---------------------------------------------------------------------------

loc_402372:				; CODE XREF: sub_4021B3+1B1j
		movzx	eax, [ebp+var_2D]
		cmp	al, 46h
		jg	short loc_402386
		movzx	eax, [ebp+var_2D]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_402390
; ---------------------------------------------------------------------------

loc_402386:				; CODE XREF: sub_4021B3+1C5j
		movzx	eax, [ebp+var_2D]
		movsx	eax, al
		sub	eax, 57h

loc_402390:				; CODE XREF: sub_4021B3+1BDj
					; sub_4021B3+1D1j
		add	eax, edx
		mov	[ebp+var_C], eax
		mov	[ebp+var_28], 1
		jmp	short loc_4023A8
; ---------------------------------------------------------------------------

loc_40239E:				; CODE XREF: sub_4021B3+94j
		cmp	[ebp+var_C], 0Ah
		jz	loc_402599

loc_4023A8:				; CODE XREF: sub_4021B3+8Aj
					; sub_4021B3+1E9j
		cmp	[ebp+var_24], 8	; switch 9 cases
		ja	loc_402550	; jumptable 004023BF default case
		mov	eax, [ebp+var_24]
		shl	eax, 2
		add	eax, offset off_40C834
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4023C1:				; CODE XREF: sub_4021B3+20Cj
					; DATA XREF: .rdata:off_40C834o
		cmp	[ebp+var_C], 0Ah ; jumptable 004023BF case 1
		jnz	loc_40256C
		mov	[ebp+var_24], 2
		mov	[ebp+var_10], 0
		jmp	loc_40256C
; ---------------------------------------------------------------------------

loc_4023DE:				; CODE XREF: sub_4021B3+20Cj
					; DATA XREF: .rdata:off_40C834o
		mov	[ebp+var_24], 2	; jumptable 004023BF case 0

loc_4023E5:				; CODE XREF: sub_4021B3+20Cj
					; DATA XREF: .rdata:off_40C834o
		mov	eax, [ebp+var_10] ; jumptable 004023BF case 2
		add	eax, offset aBegin ; "-----BEGIN "
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, [ebp+var_C]
		jz	short loc_402404
		mov	[ebp+var_24], 1
		jmp	loc_402576
; ---------------------------------------------------------------------------

loc_402404:				; CODE XREF: sub_4021B3+243j
		cmp	[ebp+var_10], 0Ah
		jnz	short loc_402416
		mov	[ebp+var_24], 3
		jmp	loc_402576
; ---------------------------------------------------------------------------

loc_402416:				; CODE XREF: sub_4021B3+255j
		add	[ebp+var_10], 1
		jmp	loc_402576
; ---------------------------------------------------------------------------

loc_40241F:				; CODE XREF: sub_4021B3+20Cj
					; DATA XREF: .rdata:off_40C834o
		cmp	[ebp+var_C], 0Ah ; jumptable 004023BF case 3
		jnz	loc_40256F
		mov	[ebp+var_24], 4
		jmp	loc_40256F
; ---------------------------------------------------------------------------

loc_402435:				; CODE XREF: sub_4021B3+20Cj
					; DATA XREF: .rdata:off_40C834o
		mov	eax, [ebp+var_20] ; jumptable 004023BF cases 4-7
		cmp	eax, [ebp+var_1C]
		jb	short loc_402459
		add	[ebp+var_1C], 2000h
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Mode],	eax ; size_t
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Filename], eax	; void *
		call	sub_40456C
		mov	[ebp+var_18], eax

loc_402459:				; CODE XREF: sub_4021B3+288j
		cmp	[ebp+var_C], 2Dh
		jnz	short loc_40246B
		mov	[ebp+var_24], 8
		jmp	loc_402572
; ---------------------------------------------------------------------------

loc_40246B:				; CODE XREF: sub_4021B3+2AAj
		mov	eax, [ebp+var_C]
		and	eax, 0FFh
		movzx	eax, ds:byte_40E060[eax]
		movzx	eax, al
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFh
		jz	loc_402572
		cmp	[ebp+var_24], 4
		jnz	short loc_4024A8
		mov	eax, [ebp+var_C]
		shl	eax, 2
		mov	[ebp+var_14], eax
		mov	[ebp+var_24], 5
		jmp	loc_402572
; ---------------------------------------------------------------------------

loc_4024A8:				; CODE XREF: sub_4021B3+2DEj
		cmp	[ebp+var_24], 5
		jnz	short loc_4024E5
		mov	eax, [ebp+var_C]
		sar	eax, 4
		and	eax, 3
		or	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+var_14]
		mov	[edx], al
		add	[ebp+var_20], 1
		mov	eax, [ebp+var_C]
		shl	eax, 4
		and	eax, 0FFh
		mov	[ebp+var_14], eax
		mov	[ebp+var_24], 6
		jmp	loc_402572
; ---------------------------------------------------------------------------

loc_4024E5:				; CODE XREF: sub_4021B3+2F9j
		cmp	[ebp+var_24], 6
		jnz	short loc_40251F
		mov	eax, [ebp+var_C]
		sar	eax, 2
		and	eax, 0Fh
		or	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+var_14]
		mov	[edx], al
		add	[ebp+var_20], 1
		mov	eax, [ebp+var_C]
		shl	eax, 6
		and	eax, 0FFh
		mov	[ebp+var_14], eax
		mov	[ebp+var_24], 7
		jmp	short loc_402572
; ---------------------------------------------------------------------------

loc_40251F:				; CODE XREF: sub_4021B3+336j
		mov	eax, [ebp+var_C]
		and	eax, 3Fh
		or	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+var_14]
		mov	[edx], al
		add	[ebp+var_20], 1
		mov	[ebp+var_24], 4
		jmp	short loc_402572
; ---------------------------------------------------------------------------

loc_402542:				; CODE XREF: sub_4021B3+20Cj
					; DATA XREF: .rdata:off_40C834o
		cmp	[ebp+var_C], 0Ah ; jumptable 004023BF case 8
		jnz	short loc_402575
		cmp	[ebp+var_28], 0
		jnz	short loc_402575
		jmp	short loc_40259A
; ---------------------------------------------------------------------------

loc_402550:				; CODE XREF: sub_4021B3+1F9j
		mov	[esp+48h+var_40], offset aRead_pem_certi ; jumptable 004023BF default case
		mov	[esp+48h+Mode],	2BEh
		mov	[esp+48h+Filename], offset a____Dirmngr1_1 ; "../../dirmngr-1.1.1/src/dirmngr-client."...
		call	sub_406C88
; ---------------------------------------------------------------------------

loc_40256C:				; CODE XREF: sub_4021B3+212j
					; sub_4021B3+226j
		nop
		jmp	short loc_402576
; ---------------------------------------------------------------------------

loc_40256F:				; CODE XREF: sub_4021B3+270j
					; sub_4021B3+27Dj
		nop
		jmp	short loc_402576
; ---------------------------------------------------------------------------

loc_402572:				; CODE XREF: sub_4021B3+2B3j
					; sub_4021B3+2D4j ...
		nop
		jmp	short loc_402576
; ---------------------------------------------------------------------------

loc_402575:				; CODE XREF: sub_4021B3+393j
					; sub_4021B3+399j
		nop

loc_402576:				; CODE XREF: sub_4021B3+77j
					; sub_4021B3+24Cj ...
		mov	eax, [ebp+File]
		mov	[esp+48h+Filename], eax	; File
		call	getc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	loc_40222F
		jmp	short loc_40259A
; ---------------------------------------------------------------------------

loc_402590:				; CODE XREF: sub_4021B3+ACj
		nop
		jmp	short loc_40259A
; ---------------------------------------------------------------------------

loc_402593:				; CODE XREF: sub_4021B3+CAj
		nop
		jmp	short loc_40259A
; ---------------------------------------------------------------------------

loc_402596:				; CODE XREF: sub_4021B3+15Bj
					; sub_4021B3+167j
		nop
		jmp	short loc_40259A
; ---------------------------------------------------------------------------

loc_402599:				; CODE XREF: sub_4021B3+1EFj
		nop

loc_40259A:				; CODE XREF: sub_4021B3+39Bj
					; sub_4021B3+3DBj ...
		cmp	[ebp+arg_0], 0
		jz	short loc_4025AB
		mov	eax, [ebp+File]
		mov	[esp+48h+Filename], eax	; File
		call	fclose

loc_4025AB:				; CODE XREF: sub_4021B3+3EBj
		cmp	[ebp+var_24], 0
		jnz	short loc_4025D0
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_4025D0
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Filename], eax	; void *
		call	sub_404649
		mov	[esp+48h+Filename], 3FFFh
		call	sub_401577
		jmp	short locret_402610
; ---------------------------------------------------------------------------

loc_4025D0:				; CODE XREF: sub_4021B3+3FCj
					; sub_4021B3+402j
		cmp	[ebp+var_24], 8
		jz	short loc_4025FB
		mov	[esp+48h+Filename], offset aNoCertificateO ; "no certificate or	invalid	encoded\n"
		call	sub_406AF9
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Filename], eax	; void *
		call	sub_404649
		mov	[esp+48h+Filename], 0Fh
		call	sub_401577
		jmp	short locret_402610
; ---------------------------------------------------------------------------

loc_4025FB:				; CODE XREF: sub_4021B3+421j
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, 0

locret_402610:				; CODE XREF: sub_4021B3+48j
					; sub_4021B3+41Bj ...
		leave
		retn
sub_4021B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402612(char *, int, int)
sub_402612	proc near		; CODE XREF: sub_401650+333p
					; sub_401650+37Fp

Filename	= dword	ptr -38h
Mode		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_40E034
		test	eax, eax
		jz	short loc_40263F
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Count], eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Mode],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Filename], eax	; char *
		call	sub_4021B3
		jmp	locret_402773
; ---------------------------------------------------------------------------

loc_40263F:				; CODE XREF: sub_402612+Dj
		cmp	[ebp+arg_0], 0
		jz	short loc_40265B
		mov	eax, offset aRb	; "rb"
		mov	[esp+38h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Filename], eax	; Filename
		call	fopen
		jmp	short loc_402660
; ---------------------------------------------------------------------------

loc_40265B:				; CODE XREF: sub_402612+31j
		mov	eax, ds:_iob

loc_402660:				; CODE XREF: sub_402612+47j
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40267F
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+Filename], eax
		call	sub_40159F
		jmp	locret_402773
; ---------------------------------------------------------------------------

loc_40267F:				; CODE XREF: sub_402612+55j
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_402693:				; CODE XREF: sub_402612+135j
		add	[ebp+var_10], 2000h
		cmp	[ebp+var_C], 0
		jnz	short loc_4026B0
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Filename], eax	; size_t
		call	sub_40452E
		mov	[ebp+var_C], eax
		jmp	short loc_4026C5
; ---------------------------------------------------------------------------

loc_4026B0:				; CODE XREF: sub_402612+8Cj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Mode],	eax ; size_t
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Filename], eax	; void *
		call	sub_40456C
		mov	[ebp+var_C], eax

loc_4026C5:				; CODE XREF: sub_402612+9Cj
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2000h ; Count
		mov	[esp+38h+Mode],	1 ; ElementSize
		mov	[esp+38h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 1FFFh
		ja	short loc_40273A
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Filename], eax	; File
		call	ferror
		test	eax, eax
		jz	short loc_40273A
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+Filename], eax
		call	sub_40159F
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Filename], eax	; void *
		call	sub_404649
		cmp	[ebp+arg_0], 0
		jz	short loc_402735
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Filename], eax	; File
		call	fclose

loc_402735:				; CODE XREF: sub_402612+116j
		mov	eax, [ebp+var_20]
		jmp	short locret_402773
; ---------------------------------------------------------------------------

loc_40273A:				; CODE XREF: sub_402612+E2j
					; sub_402612+F1j
		mov	eax, [ebp+var_1C]
		add	[ebp+var_14], eax
		cmp	[ebp+var_1C], 2000h
		jz	loc_402693
		cmp	[ebp+arg_0], 0
		jz	short loc_40275E
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Filename], eax	; File
		call	fclose

loc_40275E:				; CODE XREF: sub_402612+13Fj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0

locret_402773:				; CODE XREF: sub_402612+28j
					; sub_402612+68j ...
		leave
		retn
sub_402612	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402775	proc near		; DATA XREF: sub_40294C+74o
					; sub_402A21+46o ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aTargetcert	; "TARGETCERT"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4027EE
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4027C5
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4027EE

loc_4027C5:				; CODE XREF: sub_402775+41j
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_20], ecx
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_402942
; ---------------------------------------------------------------------------

loc_4027EE:				; CODE XREF: sub_402775+34j
					; sub_402775+4Ej
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aSendcert ;	"SENDCERT"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_402855
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402830
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402855

loc_402830:				; CODE XREF: sub_402775+ACj
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_402942
; ---------------------------------------------------------------------------

loc_402855:				; CODE XREF: sub_402775+9Fj
					; sub_402775+B9j
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aSendcert_ski ; "SENDCERT_SKI"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4028BC
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402897
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4028BC

loc_402897:				; CODE XREF: sub_402775+113j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_402942
; ---------------------------------------------------------------------------

loc_4028BC:				; CODE XREF: sub_402775+106j
					; sub_402775+120j
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aSendissuercert ; "SENDISSUERCERT"
		mov	ecx, 0Eh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_402920
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4028FE
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402920

loc_4028FE:				; CODE XREF: sub_402775+17Aj
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	short loc_402942
; ---------------------------------------------------------------------------

loc_402920:				; CODE XREF: sub_402775+16Dj
					; sub_402775+187j
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aUnsupportedInq ; "unsupported	inquiry	`%s'\n"
		call	sub_406ACF
		mov	[esp+28h+var_28], 119h
		call	sub_401577
		mov	[ebp+var_C], eax

loc_402942:				; CODE XREF: sub_402775+74j
					; sub_402775+DBj ...
		mov	eax, [ebp+var_C]
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_402775	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40294C	proc near		; CODE XREF: sub_401650+5C2p
					; sub_402F4D+8Fp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [ebp+var_18]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_40E044
		test	eax, eax
		jz	short loc_40298D
		mov	eax, ds:dword_40E030
		test	eax, eax
		jnz	short loc_4029A4

loc_40298D:				; CODE XREF: sub_40294C+36j
		mov	eax, ds:dword_40E044
		test	eax, eax
		jz	short loc_40299D
		mov	eax, offset aCheckocsp ; "CHECKOCSP"
		jmp	short loc_4029A2
; ---------------------------------------------------------------------------

loc_40299D:				; CODE XREF: sub_40294C+48j
		mov	eax, offset aCheckcrl ;	"CHECKCRL"

loc_4029A2:				; CODE XREF: sub_40294C+4Fj
		jmp	short loc_4029A9
; ---------------------------------------------------------------------------

loc_4029A4:				; CODE XREF: sub_40294C+3Fj
		mov	eax, offset aCheckocspForce ; "CHECKOCSP --force-default-responder"

loc_4029A9:				; CODE XREF: sub_40294C:loc_4029A2j
		mov	[esp+38h+var_1C], 0
		mov	[esp+38h+var_20], offset sub_401D86
		lea	edx, [ebp+var_18]
		mov	[esp+38h+var_24], edx
		mov	[esp+38h+var_28], offset sub_402775
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_40E024
		cmp	eax, 1
		jle	short loc_402A1C
		cmp	[ebp+var_C], 0
		jz	short loc_402A07
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		jmp	short loc_402A0C
; ---------------------------------------------------------------------------

loc_402A07:				; CODE XREF: sub_40294C+ACj
		mov	eax, offset aOkay ; "okay"

loc_402A0C:				; CODE XREF: sub_40294C+B9j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aResponseOfDirm ; "response of	dirmngr: %s\n"
		call	sub_406ACF

loc_402A1C:				; CODE XREF: sub_40294C+A6j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40294C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402A21	proc near		; CODE XREF: sub_401650+56Ap

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [ebp+var_18]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	[esp+38h+var_1C], 0
		mov	[esp+38h+var_20], offset sub_401D86
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset sub_402775
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	dword ptr [esp+38h+var_34], offset aCachecert ;	"CACHECERT"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_40E024
		cmp	eax, 1
		jle	short loc_402AC7
		cmp	[ebp+var_C], 0
		jz	short loc_402AB2
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		jmp	short loc_402AB7
; ---------------------------------------------------------------------------

loc_402AB2:				; CODE XREF: sub_402A21+82j
		mov	eax, offset aOkay ; "okay"

loc_402AB7:				; CODE XREF: sub_402A21+8Fj
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aResponseOfDirm ; "response of	dirmngr: %s\n"
		call	sub_406ACF

loc_402AC7:				; CODE XREF: sub_402A21+7Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_402A21	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402ACC	proc near		; CODE XREF: sub_401650+599p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [ebp+var_18]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	[esp+38h+var_1C], 0
		mov	[esp+38h+var_20], offset sub_401D86
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_24], eax
		mov	[esp+38h+var_28], offset sub_402775
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	dword ptr [esp+38h+var_34], offset aValidate ; "VALIDATE"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_40E024
		cmp	eax, 1
		jle	short loc_402B72
		cmp	[ebp+var_C], 0
		jz	short loc_402B5D
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		jmp	short loc_402B62
; ---------------------------------------------------------------------------

loc_402B5D:				; CODE XREF: sub_402ACC+82j
		mov	eax, offset aOkay ; "okay"

loc_402B62:				; CODE XREF: sub_402ACC+8Fj
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aResponseOfDirm ; "response of	dirmngr: %s\n"
		call	sub_406ACF

loc_402B72:				; CODE XREF: sub_402ACC+7Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_402ACC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402B77(int, char *)
sub_402B77	proc near		; CODE XREF: sub_401650+4F7p

Dest		= dword	ptr -58h
Format		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, ds:dword_40E03C
		test	eax, eax
		jz	short loc_402B97
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Dest],	eax ; char *
		call	sub_4045EF
		mov	[ebp+var_10], eax
		jmp	short loc_402BCC
; ---------------------------------------------------------------------------

loc_402B97:				; CODE XREF: sub_402B77+Ej
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Dest],	eax ; char *
		call	sub_4045EF
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_402BCC
		mov	[esp+58h+Dest],	offset aAbsoluteFileNa ; "absolute file	name expected\n"
		call	sub_406AF9
		mov	[esp+58h+Dest],	1
		call	sub_401577
		jmp	loc_402D48
; ---------------------------------------------------------------------------

loc_402BCC:				; CODE XREF: sub_402B77+1Ej
					; sub_402B77+36j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		add	eax, 0Fh
		mov	[esp+58h+Dest],	eax ; size_t
		call	sub_40452E
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax], 44414F4Ch
		mov	dword ptr [eax+4], 204C5243h
		mov	byte ptr [eax+8], 0
		mov	eax, [ebp+var_18]
		add	eax, 8
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_40E03C
		test	eax, eax
		jz	short loc_402C3C
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax], 72752D2Dh
		mov	word ptr [eax+4], 206Ch
		mov	byte ptr [eax+6], 0
		add	[ebp+var_14], 6

loc_402C3C:				; CODE XREF: sub_402B77+ACj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_402CA8
; ---------------------------------------------------------------------------

loc_402C44:				; CODE XREF: sub_402B77+139j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jle	short loc_402C58
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_402C7F

loc_402C58:				; CODE XREF: sub_402B77+D5j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, offset Format ; "%%%02X"
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Format], eax ;	Format
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_14], 3
		jmp	short loc_402CA4
; ---------------------------------------------------------------------------

loc_402C7F:				; CODE XREF: sub_402B77+DFj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_402C95
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	2Bh
		add	[ebp+var_14], 1
		jmp	short loc_402CA4
; ---------------------------------------------------------------------------

loc_402C95:				; CODE XREF: sub_402B77+110j
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1

loc_402CA4:				; CODE XREF: sub_402B77+106j
					; sub_402B77+11Cj
		add	[ebp+var_C], 1

loc_402CA8:				; CODE XREF: sub_402B77+CBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402C44
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	[esp+58h+var_3C], 0
		mov	[esp+58h+var_40], offset sub_401D86
		mov	[esp+58h+var_44], 0
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+var_50], 0
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dest],	eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_40E024
		cmp	eax, 1
		jle	short loc_402D2F
		cmp	[ebp+var_1C], 0
		jz	short loc_402D1A
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Dest],	eax
		call	gpg_strerror
		jmp	short loc_402D1F
; ---------------------------------------------------------------------------

loc_402D1A:				; CODE XREF: sub_402B77+194j
		mov	eax, offset aOkay ; "okay"

loc_402D1F:				; CODE XREF: sub_402B77+1A1j
		mov	[esp+58h+Format], eax ;	char
		mov	[esp+58h+Dest],	offset aResponseOfDirm ; "response of dirmngr: %s\n"
		call	sub_406ACF

loc_402D2F:				; CODE XREF: sub_402B77+18Ej
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Dest],	eax ; void *
		call	sub_404649
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Dest],	eax ; void *
		call	sub_404649
		mov	eax, [ebp+var_1C]

loc_402D48:				; CODE XREF: sub_402B77+50j
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_402B77	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402D4E	proc near		; CODE XREF: sub_401650+489p

Dest		= dword	ptr -68h
Format		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	eax, ds:dword_40E024
		test	eax, eax
		jz	short loc_402D71
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+Dest],	offset aLookingUpS ; "looking up `%s'\n"
		call	sub_406ACF

loc_402D71:				; CODE XREF: sub_402D4E+Ej
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+68h+var_60], 0 ; char *
		mov	[esp+68h+Format], eax ;	int
		lea	eax, [ebp+var_34]
		mov	[esp+68h+Dest],	eax ; int
		call	sub_4030DD
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_402DA1
		mov	eax, [ebp+var_14]
		jmp	loc_402F47
; ---------------------------------------------------------------------------

loc_402DA1:				; CODE XREF: sub_402D4E+49j
		mov	eax, dword ptr [ebp+arg_4]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		add	eax, 1Eh
		mov	[esp+68h+Dest],	eax ; size_t
		call	sub_40452E
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax], 4B4F4F4Ch
		mov	dword ptr [eax+4], 205055h
		mov	eax, [ebp+var_18]
		add	eax, 7
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_40E03C
		test	eax, eax
		jz	short loc_402E0D
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 72752D2Dh
		mov	word ptr [eax+4], 206Ch
		mov	byte ptr [eax+6], 0
		add	[ebp+var_10], 6

loc_402E0D:				; CODE XREF: sub_402D4E+A6j
		mov	eax, ds:dword_40E040
		test	eax, eax
		jz	short loc_402E37
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 61632D2Dh
		mov	dword ptr [eax+4], 2D656863h
		mov	dword ptr [eax+8], 796C6E6Fh
		mov	word ptr [eax+0Ch], 20h
		add	[ebp+var_10], 0Dh

loc_402E37:				; CODE XREF: sub_402D4E+C6j
		mov	eax, dword ptr [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_402EA5
; ---------------------------------------------------------------------------

loc_402E3F:				; CODE XREF: sub_402D4E+15Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_402E53
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_402E7A

loc_402E53:				; CODE XREF: sub_402D4E+F9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset Format ; "%%%02X"
		mov	[esp+68h+var_60], edx
		mov	[esp+68h+Format], eax ;	Format
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_10], 3
		jmp	short loc_402EA1
; ---------------------------------------------------------------------------

loc_402E7A:				; CODE XREF: sub_402D4E+103j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_402E90
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	2Bh
		add	[ebp+var_10], 1
		jmp	short loc_402EA1
; ---------------------------------------------------------------------------

loc_402E90:				; CODE XREF: sub_402D4E+134j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1

loc_402EA1:				; CODE XREF: sub_402D4E+12Aj
					; sub_402D4E+140j
		add	[ebp+var_C], 1

loc_402EA5:				; CODE XREF: sub_402D4E+EFj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402E3F
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[esp+68h+var_4C], 0
		mov	[esp+68h+var_50], offset sub_401D86
		mov	[esp+68h+var_54], 0
		mov	[esp+68h+var_58], 0
		lea	eax, [ebp+var_34]
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], offset sub_401DB0
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Dest],	eax
		call	assuan_transact
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_40E024
		cmp	eax, 1
		jle	short loc_402F2B
		cmp	[ebp+var_14], 0
		jz	short loc_402F16
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Dest],	eax
		call	gpg_strerror
		jmp	short loc_402F1B
; ---------------------------------------------------------------------------

loc_402F16:				; CODE XREF: sub_402D4E+1B9j
		mov	eax, offset aOkay ; "okay"

loc_402F1B:				; CODE XREF: sub_402D4E+1C6j
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+Dest],	offset aResponseOfDirm ; "response of dirmngr: %s\n"
		call	sub_406ACF

loc_402F2B:				; CODE XREF: sub_402D4E+1B3j
		lea	eax, [ebp+var_34]
		mov	[esp+68h+Dest],	eax
		call	sub_403440
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Dest],	eax ; void *
		call	sub_404649
		mov	eax, [ebp+var_14]

loc_402F47:				; CODE XREF: sub_402D4E+4Ej
		add	esp, 64h
		pop	edi
		pop	ebp
		retn
sub_402D4E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402F4D	proc near		; CODE XREF: sub_401650+43Bp

Str		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		lea	eax, [ebp+var_10]
		mov	dword ptr [esp+28h+var_24], eax	; int
		mov	[esp+28h+Str], 0 ; char	*
		call	sub_4021B3
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_401592
		cmp	eax, 3FFFh
		jnz	short loc_402F91
		mov	eax, [ebp+var_C]
		jmp	locret_40307B
; ---------------------------------------------------------------------------

loc_402F91:				; CODE XREF: sub_402F4D+3Aj
		cmp	[ebp+var_C], 0
		jz	short loc_402FC8
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Str], offset aErrorReadingCe ;	"error reading certificate from	stdin: %"...
		call	sub_406AF9
		mov	[esp+28h+Str], offset aError ; "ERROR"
		call	puts
		mov	eax, 0
		jmp	locret_40307B
; ---------------------------------------------------------------------------

loc_402FC8:				; CODE XREF: sub_402F4D+48j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], edx
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_40294C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; void *
		call	sub_404649
		cmp	[ebp+var_C], 0
		jnz	short loc_403018
		mov	eax, ds:dword_40E024
		test	eax, eax
		jz	short loc_40300A
		mov	[esp+28h+Str], offset aCertificateIsV ;	"certificate is	valid\n"
		call	sub_406ACF

loc_40300A:				; CODE XREF: sub_402F4D+AFj
		mov	[esp+28h+Str], offset aOk ; "OK"
		call	puts
		jmp	short loc_403066
; ---------------------------------------------------------------------------

loc_403018:				; CODE XREF: sub_402F4D+A6j
		mov	eax, ds:dword_40E020
		test	eax, eax
		jnz	short loc_40305A
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_401592
		cmp	eax, 5Eh
		jnz	short loc_40303F
		mov	[esp+28h+Str], offset aCertificateHas ;	"certificate has been revoked\n"
		call	sub_406ACF
		jmp	short loc_40305A
; ---------------------------------------------------------------------------

loc_40303F:				; CODE XREF: sub_402F4D+E2j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Str], offset aCertificateChe ;	"certificate check failed: %s\n"
		call	sub_406AF9

loc_40305A:				; CODE XREF: sub_402F4D+D2j
					; sub_402F4D+F0j
		mov	[esp+28h+Str], offset aError ; "ERROR"
		call	puts

loc_403066:				; CODE XREF: sub_402F4D+C9j
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		mov	eax, 0

locret_40307B:				; CODE XREF: sub_402F4D+3Fj
					; sub_402F4D+76j
		leave
		retn
sub_402F4D	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403080	proc near		; CODE XREF: sub_4030A7+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4030A0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4030A5
; ---------------------------------------------------------------------------

loc_4030A0:				; CODE XREF: sub_403080+7j
		mov	eax, 0

loc_4030A5:				; CODE XREF: sub_403080+1Ej
		pop	ebp
		retn
sub_403080	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4030A7	proc near		; CODE XREF: sub_4030C2+14p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_403080
		leave
		retn
sub_4030A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4030C2	proc near		; CODE XREF: sub_4030DD+C2p
					; sub_4031B2+287p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_4030A7
		leave
		retn
sub_4030C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4030DD(int, int, char	*)
sub_4030DD	proc near		; CODE XREF: sub_402D4E+3Dp

Src		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	edx, 1Ch
		mov	ecx, 0
		mov	ebx, eax
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_403103
		mov	[eax], cl
		add	eax, 1
		sub	edx, 1

loc_403103:				; CODE XREF: sub_4030DD+1Cj
		mov	ebx, eax
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_403115
		mov	[eax], cx
		add	eax, 2
		sub	edx, 2

loc_403115:				; CODE XREF: sub_4030DD+2Dj
		mov	esi, edx
		and	esi, 0FFFFFFFCh
		mov	ebx, 0

loc_40311F:				; CODE XREF: sub_4030DD+4Aj
		mov	[eax+ebx], ecx
		add	ebx, 4
		cmp	ebx, esi
		jb	short loc_40311F
		add	eax, ebx
		mov	ebx, edx
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_40313A
		mov	[eax], cx
		add	eax, 2

loc_40313A:				; CODE XREF: sub_4030DD+55j
		and	edx, 1
		test	edx, edx
		jz	short loc_403146
		mov	[eax], cl
		add	eax, 1

loc_403146:				; CODE XREF: sub_4030DD+62j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0Ch], edx
		cmp	[ebp+arg_8], 0
		jz	short loc_403170
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403170
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 10h
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		jmp	short loc_4031A6
; ---------------------------------------------------------------------------

loc_403170:				; CODE XREF: sub_4030DD+76j
					; sub_4030DD+80j
		cmp	[ebp+arg_8], 0
		jz	short loc_4031A6
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_4031A6
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+18h+Src], eax
		call	sub_4030C2
		jmp	short loc_4031AB
; ---------------------------------------------------------------------------

loc_4031A6:				; CODE XREF: sub_4030DD+91j
					; sub_4030DD+97j ...
		mov	eax, 0

loc_4031AB:				; CODE XREF: sub_4030DD+C7j
		add	esp, 10h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4030DD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4031B2	proc near		; CODE XREF: sub_401DB0+26p

File		= dword	ptr -38h
var_34		= dword	ptr -34h
Size		= dword	ptr -30h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
Dst		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_4031EA
		cmp	[ebp+arg_4], 0
		jz	short loc_4031E0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+File],	eax ; File
		call	fflush
		test	eax, eax
		jnz	loc_403426

loc_4031E0:				; CODE XREF: sub_4031B2+19j
		mov	eax, 0
		jmp	locret_40343E
; ---------------------------------------------------------------------------

loc_4031EA:				; CODE XREF: sub_4031B2+13j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 1
		test	eax, eax
		jnz	short loc_403267
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_403258
		mov	eax, offset aBegin_0 ; "-----BEGIN "
		mov	edx, [ebp+var_18]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40342D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_18]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40342D
		mov	eax, offset asc_40C96C ; "-----\n"
		mov	edx, [ebp+var_18]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40342D

loc_403258:				; CODE XREF: sub_4031B2+4Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_403267:				; CODE XREF: sub_4031B2+42j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 3
		jle	short loc_40329B
		mov	[esp+38h+Size],	62h ; int
		mov	[esp+38h+var_34], offset a____Dirmngr1_0 ; "../../dirmngr-1.1.1/src/b64enc.c"
		mov	[esp+38h+File],	offset aIdx4 ; "idx < 4"
		call	sub_40AA40

loc_40329B:				; CODE XREF: sub_4031B2+CBj
		mov	ecx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		add	eax, 14h
		mov	edx, eax
		lea	eax, [ebp+Dst]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+var_34], edx ;	Src
		mov	[esp+38h+File],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	loc_4033E7
; ---------------------------------------------------------------------------

loc_4032C4:				; CODE XREF: sub_4031B2+239j
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+Dst]
		add	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		cmp	[ebp+var_C], 2
		jle	loc_4033DF
		movzx	eax, [ebp+Dst]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, byte_40B140[eax]
		mov	[ebp+var_20], al
		movzx	eax, [ebp+Dst]
		movzx	eax, al
		shl	eax, 4
		mov	edx, eax
		and	edx, 30h
		movzx	eax, [ebp+var_1B]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_40B140[eax]
		mov	[ebp+var_1F], al
		movzx	eax, [ebp+var_1B]
		movzx	eax, al
		shl	eax, 2
		mov	edx, eax
		and	edx, 3Ch
		movzx	eax, [ebp+var_1A]
		shr	al, 6
		movzx	eax, al
		and	eax, 3
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_40B140[eax]
		mov	[ebp+var_1E], al
		movzx	eax, [ebp+var_1A]
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, byte_40B140[eax]
		mov	[ebp+var_1D], al
		mov	[ebp+var_C], 0
		jmp	short loc_403389
; ---------------------------------------------------------------------------

loc_40336A:				; CODE XREF: sub_4031B2+1DBj
		lea	eax, [ebp+var_20]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+var_18]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Ch
		call	putc
		add	[ebp+var_C], 1

loc_403389:				; CODE XREF: sub_4031B2+1B6j
		cmp	[ebp+var_C], 3
		jle	short loc_40336A
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+File],	eax ; File
		call	ferror
		test	eax, eax
		jnz	loc_403429
		add	[ebp+var_10], 1
		cmp	[ebp+var_10], 0Fh
		jle	short loc_4033DF
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_4033DF
		mov	eax, offset asc_40C99D ; "\n"
		mov	edx, [ebp+var_18]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40342C

loc_4033DF:				; CODE XREF: sub_4031B2+128j
					; sub_4031B2+1FFj ...
		add	[ebp+var_14], 1
		sub	[ebp+arg_8], 1

loc_4033E7:				; CODE XREF: sub_4031B2+10Dj
		cmp	[ebp+arg_8], 0
		jnz	loc_4032C4
		mov	ecx, [ebp+var_C]
		lea	edx, [ebp+Dst]
		mov	eax, [ebp+arg_0]
		add	eax, 14h
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+var_34], edx ;	Src
		mov	[esp+38h+File],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	short locret_40343E
; ---------------------------------------------------------------------------

loc_403426:				; CODE XREF: sub_4031B2+28j
		nop
		jmp	short loc_40342D
; ---------------------------------------------------------------------------

loc_403429:				; CODE XREF: sub_4031B2+1F1j
		nop
		jmp	short loc_40342D
; ---------------------------------------------------------------------------

loc_40342C:				; CODE XREF: sub_4031B2+22Bj
		nop

loc_40342D:				; CODE XREF: sub_4031B2+65j
					; sub_4031B2+83j ...
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+File],	eax
		call	sub_4030C2

locret_40343E:				; CODE XREF: sub_4031B2+33j
					; sub_4031B2+272j
		leave
		retn
sub_4031B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403440	proc near		; CODE XREF: sub_402D4E+1E3p

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
File		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 1
		test	eax, eax
		jz	loc_403668
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+File], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_10], 3
		jle	short loc_40349A
		mov	[esp+38h+Size],	96h ; int
		mov	[esp+38h+Src], offset a____Dirmngr1_0 ;	"../../dirmngr-1.1.1/src/b64enc.c"
		mov	[esp+38h+Dst], offset aIdx4 ; "idx < 4"
		call	sub_40AA40

loc_40349A:				; CODE XREF: sub_403440+3Cj
		mov	ecx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		add	eax, 14h
		mov	edx, eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		cmp	[ebp+var_10], 0
		jz	loc_4035C8
		movzx	eax, [ebp+var_1C]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, byte_40B140[eax]
		mov	[ebp+var_20], al
		cmp	[ebp+var_10], 1
		jnz	short loc_403500
		movzx	eax, [ebp+var_1C]
		movzx	eax, al
		shl	eax, 4
		and	eax, 30h
		movzx	eax, byte_40B140[eax]
		mov	[ebp+var_1F], al
		mov	[ebp+var_1E], 3Dh
		mov	[ebp+var_1D], 3Dh
		jmp	short loc_403546
; ---------------------------------------------------------------------------

loc_403500:				; CODE XREF: sub_403440+9Dj
		movzx	eax, [ebp+var_1C]
		movzx	eax, al
		shl	eax, 4
		mov	edx, eax
		and	edx, 30h
		movzx	eax, [ebp+var_1B]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_40B140[eax]
		mov	[ebp+var_1F], al
		movzx	eax, [ebp+var_1B]
		movzx	eax, al
		shl	eax, 2
		and	eax, 3Ch
		movzx	eax, byte_40B140[eax]
		mov	[ebp+var_1E], al
		mov	[ebp+var_1D], 3Dh

loc_403546:				; CODE XREF: sub_403440+BEj
		mov	[ebp+var_10], 0
		jmp	short loc_40356E
; ---------------------------------------------------------------------------

loc_40354F:				; CODE XREF: sub_403440+132j
		lea	eax, [ebp+var_20]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Ch
		call	putc
		add	[ebp+var_10], 1

loc_40356E:				; CODE XREF: sub_403440+10Dj
		cmp	[ebp+var_10], 3
		jle	short loc_40354F
		mov	[ebp+var_10], 0
		mov	eax, [ebp+File]
		mov	[esp+38h+Dst], eax ; File
		call	ferror
		test	eax, eax
		jnz	loc_40364B
		add	[ebp+var_14], 1
		cmp	[ebp+var_14], 0Fh
		jle	short loc_4035C8
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_4035C8
		mov	eax, offset asc_40C99D ; "\n"
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40364E

loc_4035C8:				; CODE XREF: sub_403440+7Cj
					; sub_403440+156j ...
		cmp	[ebp+var_14], 0
		jz	short loc_4035F3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_4035F3
		mov	eax, offset asc_40C99D ; "\n"
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	short loc_403651

loc_4035F3:				; CODE XREF: sub_403440+18Cj
					; sub_403440+198j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40366B
		mov	eax, offset aEnd ; "-----END "
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	short loc_403652
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	short loc_403652
		mov	eax, offset asc_40C96C ; "-----\n"
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40366B
		jmp	short loc_403652
; ---------------------------------------------------------------------------

loc_40364B:				; CODE XREF: sub_403440+148j
		nop
		jmp	short loc_403652
; ---------------------------------------------------------------------------

loc_40364E:				; CODE XREF: sub_403440+182j
		nop
		jmp	short loc_403652
; ---------------------------------------------------------------------------

loc_403651:				; CODE XREF: sub_403440+1B1j
		nop

loc_403652:				; CODE XREF: sub_403440+1D4j
					; sub_403440+1EEj ...
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_4030C2
		mov	[ebp+var_C], eax
		jmp	short loc_40366C
; ---------------------------------------------------------------------------

loc_403668:				; CODE XREF: sub_403440+17j
		nop
		jmp	short loc_40366C
; ---------------------------------------------------------------------------

loc_40366B:				; CODE XREF: sub_403440+1BBj
					; sub_403440+207j
		nop

loc_40366C:				; CODE XREF: sub_403440+226j
					; sub_403440+229j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40368E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+38h+Dst], eax ; Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0

loc_40368E:				; CODE XREF: sub_403440+234j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_403440	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4036A0(LPCSTR)
sub_4036A0	proc near		; CODE XREF: sub_403C16+42p

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4036A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4036BE(HMODULE, LPCSTR)
sub_4036BE	proc near		; CODE XREF: sub_403C16+5Ep

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_4036FC
		cmp	[ebp+arg_4], 0
		jz	short loc_4036FC
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4036F7
		mov	eax, 0
		jmp	short locret_403701
; ---------------------------------------------------------------------------

loc_4036F7:				; CODE XREF: sub_4036BE+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_403701
; ---------------------------------------------------------------------------

loc_4036FC:				; CODE XREF: sub_4036BE+Aj
					; sub_4036BE+10j
		mov	eax, 0

locret_403701:				; CODE XREF: sub_4036BE+37j
					; sub_4036BE+3Cj
		leave
		retn
sub_4036BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403703(HMODULE)
sub_403703	proc near		; CODE XREF: sub_403C16+77p

hLibModule	= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_403726
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hLibModule], eax ; hLibModule
		mov	eax, ds:FreeLibrary
		call	eax ; FreeLibrary
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_40372B
; ---------------------------------------------------------------------------

loc_403726:				; CODE XREF: sub_403703+Aj
		mov	eax, 0FFFFFFFFh

locret_40372B:				; CODE XREF: sub_403703+21j
		leave
		retn
sub_403703	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40372D(int, LPCSTR, LPCSTR lpValueName)
sub_40372D	proc near		; CODE XREF: .text:00403F0Cp

hKey		= dword	ptr -58h
lpSubKey	= dword	ptr -54h
ulOptions	= dword	ptr -50h
samDesired	= dword	ptr -4Ch
phkResult	= dword	ptr -48h
lpcbData	= dword	ptr -44h
var_2C		= dword	ptr -2Ch
Type		= dword	ptr -24h
cbData		= dword	ptr -20h
Size		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpDst		= dword	ptr -14h
lpData		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpValueName	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 50h
		mov	[ebp+lpData], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_40374E
		mov	[ebp+var_C], 80000001h
		jmp	loc_403887
; ---------------------------------------------------------------------------

loc_40374E:				; CODE XREF: sub_40372D+13j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_classes_r ; "HKEY_CLASSES_ROOT"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_403782
		mov	[ebp+var_C], 80000000h
		jmp	loc_403887
; ---------------------------------------------------------------------------

loc_403782:				; CODE XREF: sub_40372D+47j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4037B6
		mov	[ebp+var_C], 80000001h
		jmp	loc_403887
; ---------------------------------------------------------------------------

loc_4037B6:				; CODE XREF: sub_40372D+7Bj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4037EA
		mov	[ebp+var_C], 80000002h
		jmp	loc_403887
; ---------------------------------------------------------------------------

loc_4037EA:				; CODE XREF: sub_40372D+AFj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_users	; "HKEY_USERS"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40381B
		mov	[ebp+var_C], 80000003h
		jmp	short loc_403887
; ---------------------------------------------------------------------------

loc_40381B:				; CODE XREF: sub_40372D+E3j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		mov	ecx, 16h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40384C
		mov	[ebp+var_C], 80000004h
		jmp	short loc_403887
; ---------------------------------------------------------------------------

loc_40384C:				; CODE XREF: sub_40372D+114j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40387D
		mov	[ebp+var_C], 80000005h
		jmp	short loc_403887
; ---------------------------------------------------------------------------

loc_40387D:				; CODE XREF: sub_40372D+145j
		mov	eax, 0
		jmp	loc_403C0F
; ---------------------------------------------------------------------------

loc_403887:				; CODE XREF: sub_40372D+1Cj
					; sub_40372D+50j ...
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_403906
		cmp	[ebp+arg_0], 0
		jz	short loc_4038C9
		mov	eax, 0
		jmp	loc_403C0F
; ---------------------------------------------------------------------------

loc_4038C9:				; CODE XREF: sub_40372D+190j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_403906
		mov	eax, 0
		jmp	loc_403C0F
; ---------------------------------------------------------------------------

loc_403906:				; CODE XREF: sub_40372D+18Aj
					; sub_40372D+1CDj
		mov	[ebp+cbData], 1
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	loc_4039E0
		cmp	[ebp+arg_0], 0
		jnz	loc_403BEF
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_4039A2
		mov	eax, 0
		jmp	loc_403C0F
; ---------------------------------------------------------------------------

loc_4039A2:				; CODE XREF: sub_40372D+269j
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jnz	loc_403BF2

loc_4039E0:				; CODE XREF: sub_40372D+218j
		mov	eax, [ebp+cbData]
		add	eax, 1
		mov	[ebp+Size], eax
		mov	eax, [ebp+Size]
		mov	[esp+58h+hKey],	eax ; Size
		call	malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jz	loc_403BF5
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+Size]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	edx, [ebp+lpData]
		mov	[esp+58h+phkResult], edx ; lpData
		lea	edx, [ebp+Type]
		mov	[esp+58h+samDesired], edx ; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	short loc_403A50
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		mov	[ebp+lpData], 0
		jmp	loc_403BFC
; ---------------------------------------------------------------------------

loc_403A50:				; CODE XREF: sub_40372D+30Aj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpData]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Type]
		cmp	eax, 2
		jnz	loc_403BFC
		mov	[esp+58h+lpSubKey], 25h	; Val
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_403BFC
		mov	eax, [ebp+Size]
		add	eax, 3E8h
		mov	[ebp+Size], eax
		mov	eax, [ebp+Size]
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; Size
		call	malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_403BF8
		mov	eax, [ebp+Size]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	loc_403B6D
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+Size]
		cmp	edx, eax
		jbe	loc_403B6D
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		mov	eax, [ebp+cbData]
		mov	[ebp+Size], eax
		mov	eax, [ebp+Size]
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; Size
		call	malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_403BFB
		mov	eax, [ebp+Size]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_403B4E
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+Size]
		cmp	edx, eax
		jbe	short loc_403B4E
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		jmp	loc_403BFC
; ---------------------------------------------------------------------------

loc_403B4E:				; CODE XREF: sub_40372D+405j
					; sub_40372D+40Fj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	loc_403BFC
; ---------------------------------------------------------------------------

loc_403B6D:				; CODE XREF: sub_40372D+39Fj
					; sub_40372D+3ADj
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_403BE2
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		mov	eax, [ebp+lpDst]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; Size
		call	malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jnz	short loc_403BC3
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	short loc_403BFC
; ---------------------------------------------------------------------------

loc_403BC3:				; CODE XREF: sub_40372D+48Cj
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; Source
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		jmp	short loc_403BFC
; ---------------------------------------------------------------------------

loc_403BE2:				; CODE XREF: sub_40372D+445j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		jmp	short loc_403BFC
; ---------------------------------------------------------------------------

loc_403BEF:				; CODE XREF: sub_40372D+222j
		nop
		jmp	short loc_403BFC
; ---------------------------------------------------------------------------

loc_403BF2:				; CODE XREF: sub_40372D+2ADj
		nop
		jmp	short loc_403BFC
; ---------------------------------------------------------------------------

loc_403BF5:				; CODE XREF: sub_40372D+2CEj
		nop
		jmp	short loc_403BFC
; ---------------------------------------------------------------------------

loc_403BF8:				; CODE XREF: sub_40372D+373j
		nop
		jmp	short loc_403BFC
; ---------------------------------------------------------------------------

loc_403BFB:				; CODE XREF: sub_40372D+3D9j
		nop

loc_403BFC:				; CODE XREF: sub_40372D+31Ej
					; sub_40372D+332j ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		mov	eax, [ebp+lpData]

loc_403C0F:				; CODE XREF: sub_40372D+155j
					; sub_40372D+197j ...
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40372D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403C16	proc near		; CODE XREF: sub_403DAF+41p
					; sub_404039+41p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_40E298
		test	eax, eax
		jnz	loc_403CB1
		mov	ds:dword_40E298, 1
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_403C9D
; ---------------------------------------------------------------------------

loc_403C43:				; CODE XREF: sub_403C16+99j
		mov	eax, [ebp+var_10]
		mov	eax, off_40B180[eax*4]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax ;	LPCSTR
		call	sub_4036A0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_403C99
		mov	[esp+38h+var_34], offset aShgetfolderpat ; "SHGetFolderPathA"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_4036BE
		mov	ds:dword_40E29C, eax
		mov	eax, ds:dword_40E29C
		test	eax, eax
		jnz	short loc_403C99
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_403703
		mov	[ebp+var_C], 0

loc_403C99:				; CODE XREF: sub_403C16+4Ej
					; sub_403C16+6Fj
		add	[ebp+var_10], 1

loc_403C9D:				; CODE XREF: sub_403C16+2Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_403CB1
		mov	eax, [ebp+var_10]
		mov	eax, off_40B180[eax*4]
		test	eax, eax
		jnz	short loc_403C43

loc_403CB1:				; CODE XREF: sub_403C16+Dj
					; sub_403C16+8Bj
		mov	eax, ds:dword_40E29C
		test	eax, eax
		jz	short loc_403CE9
		mov	edx, ds:dword_40E29C
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx ; dword_40E29C
		sub	esp, 14h
		jmp	short locret_403CEE
; ---------------------------------------------------------------------------

loc_403CE9:				; CODE XREF: sub_403C16+A2j
		mov	eax, 0FFFFFFFFh

locret_403CEE:				; CODE XREF: sub_403C16+D1j
		leave
		retn
sub_403C16	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_40E294
		test	eax, eax
		jnz	loc_403D90
		call	sub_4041AC
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aDirmngr_ldap_e ; "\\dirmngr_ldap.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	malloc
		mov	ds:dword_40E294, eax
		mov	eax, ds:dword_40E294
		test	eax, eax
		jz	short loc_403D90
		mov	eax, ds:dword_40E294
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_407DEB
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_403D90:				; CODE XREF: .text:00403CFFj
					; .text:00403D6Bj
		mov	eax, ds:dword_40E294
		test	eax, eax
		jnz	short loc_403DA3
		mov	ds:dword_40E294, offset	aHomeIntevation	; "/home/intevation/gpg4win/src/playground"...

loc_403DA3:				; CODE XREF: .text:00403D97j
		mov	eax, ds:dword_40E294
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403DAF	proc near		; CODE XREF: .text:00403F4Dp

lpPathName	= dword	ptr -148h
lpSecurityAttributes= dword ptr	-144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_110		= byte ptr -110h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:lpPathName
		test	eax, eax
		jnz	loc_403EA7
		lea	eax, [ebp+var_110]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], 801Ah
		mov	[esp+148h+lpPathName], 0
		call	sub_403C16
		test	eax, eax
		js	loc_403E9D
		lea	eax, [ebp+var_110]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 7
		mov	[esp+148h+lpPathName], eax ; size_t
		call	sub_40452E
		mov	[ebp+var_C], eax
		mov	ebx, offset aGnupg ; "\\gnupg"
		lea	eax, [ebp+var_110]
		mov	[esp+148h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_C]
		mov	[esp+148h+lpPathName], eax
		call	sub_407DEB
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, word ptr [ebx+4]
		mov	[eax+4], dx
		movzx	edx, byte ptr [ebx+6]
		mov	[eax+6], dl
		mov	eax, [ebp+var_C]
		mov	ds:lpPathName, eax
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0
		mov	[esp+148h+lpPathName], eax
		call	_access
		test	eax, eax
		jz	short loc_403EA7
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+148h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		jmp	short loc_403EA7
; ---------------------------------------------------------------------------

loc_403E9D:				; CODE XREF: sub_403DAF+48j
		mov	ds:lpPathName, offset aCGnupg ;	"c:/gnupg"

loc_403EA7:				; CODE XREF: sub_403DAF+12j
					; sub_403DAF+D0j ...
		mov	eax, ds:lpPathName
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_403DAF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aGnupghome ; "GNUPGHOME"
		call	getenv
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_403EDC
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_403F5F

loc_403EDC:				; CODE XREF: .text:00403ECCj
		mov	eax, ds:dword_40E28C
		test	eax, eax
		jnz	short loc_403F57
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_403EF5
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403F44

loc_403EF5:				; CODE XREF: .text:00403EE9j
		mov	dword ptr [esp+8], offset aHomedir ; "HomeDir"
		mov	dword ptr [esp+4], offset aSoftwareGnuGnu ; "Software\\GNU\\GnuPG"
		mov	dword ptr [esp], 0
		call	sub_40372D
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_403F36
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403F36
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_404649
		mov	dword ptr [ebp-10h], 0

loc_403F36:				; CODE XREF: .text:00403F18j
					; .text:00403F22j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_403F44
		mov	eax, [ebp-10h]
		mov	ds:dword_40E28C, eax

loc_403F44:				; CODE XREF: .text:00403EF3j
					; .text:00403F3Aj
		mov	eax, ds:dword_40E28C
		test	eax, eax
		jnz	short loc_403F57
		call	sub_403DAF
		mov	ds:dword_40E28C, eax

loc_403F57:				; CODE XREF: .text:00403EE3j
					; .text:00403F4Bj
		mov	eax, ds:dword_40E28C
		mov	[ebp-0Ch], eax

loc_403F5F:				; CODE XREF: .text:00403ED6j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_403F6F
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403F76

loc_403F6F:				; CODE XREF: .text:00403F63j
		mov	dword ptr [ebp-0Ch], offset aCGnupg ; "c:/gnupg"

loc_403F76:				; CODE XREF: .text:00403F6Dj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F7B	proc near		; CODE XREF: sub_404039:loc_4040E8p
					; sub_4041AC+6p

hModule		= dword	ptr -28h
lpFilename	= dword	ptr -24h
nSize		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_40E174
		test	eax, eax
		jnz	loc_404020
		mov	[esp+28h+nSize], 104h ;	nSize
		mov	[esp+28h+lpFilename], offset Filename ;	lpFilename
		mov	[esp+28h+hModule], 0 ; hModule
		mov	eax, ds:GetModuleFileNameA
		call	eax ; GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_403FD6
		mov	[esp+28h+hModule], 0 ; DWORD
		call	sub_407A48
		mov	[esp+28h+lpFilename], eax ; char
		mov	[esp+28h+hModule], offset aGetmodulefilen ; "GetModuleFileName failed: %s\n"
		call	sub_406B96
		mov	ds:Filename, 0

loc_403FD6:				; CODE XREF: sub_403F7B+36j
		mov	ds:dword_40E174, 1
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset Filename ; Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404005
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		jmp	short loc_404020
; ---------------------------------------------------------------------------

loc_404005:				; CODE XREF: sub_403F7B+80j
		mov	[esp+28h+lpFilename], offset Filename ;	char
		mov	[esp+28h+hModule], offset aBadFilenameSRe ; "bad filename `%s' returned for this pro"...
		call	sub_406B96
		mov	ds:Filename, 0

loc_404020:				; CODE XREF: sub_403F7B+Dj
					; sub_403F7B+88j
		movzx	eax, ds:Filename
		test	al, al
		jz	short loc_404032
		mov	eax, offset Filename
		jmp	short locret_404037
; ---------------------------------------------------------------------------

loc_404032:				; CODE XREF: sub_403F7B+AEj
		mov	eax, offset aHomeIntevati_0 ; "/home/intevation/gpg4win/src/playground"...

locret_404037:				; CODE XREF: sub_403F7B+B5j
		leave
		retn
sub_403F7B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404039	proc near		; CODE XREF: .text:0040411Ep
					; .text:004041CEp

var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_110		= byte ptr -110h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_40E170
		test	eax, eax
		jnz	loc_4040FA
		lea	eax, [ebp+var_110]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+var_144], 23h
		mov	[esp+148h+var_148], 0
		call	sub_403C16
		test	eax, eax
		js	short loc_4040E8
		lea	eax, [ebp+var_110]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+148h+var_148], eax	; size_t
		call	sub_40452E
		mov	[ebp+var_C], eax
		mov	ebx, offset aGnu ; "\\GNU"
		lea	eax, [ebp+var_110]
		mov	[esp+148h+var_144], eax
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_148], eax
		call	sub_407DEB
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_C]
		mov	ds:dword_40E170, eax
		jmp	short loc_4040FA
; ---------------------------------------------------------------------------

loc_4040E8:				; CODE XREF: sub_404039+48j
		call	sub_403F7B
		mov	[esp+148h+var_148], eax	; char *
		call	sub_4045EF
		mov	ds:dword_40E170, eax

loc_4040FA:				; CODE XREF: sub_404039+12j
					; sub_404039+ADj
		mov	eax, ds:dword_40E170
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_404039	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_40E16C
		test	eax, eax
		jnz	loc_4041A0
		call	sub_404039
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aEtcDirmngr	; "\\etc\\dirmngr"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_40452E
		mov	ds:dword_40E16C, eax
		mov	eax, ds:dword_40E16C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_407DEB
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_4041A0:				; CODE XREF: .text:00404118j
		mov	eax, ds:dword_40E16C
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4041AC	proc near		; CODE XREF: .text:00403D05p
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_403F7B
		leave
		retn
sub_4041AC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_40E168
		test	eax, eax
		jnz	loc_404250
		call	sub_404039
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aLibDirmngr	; "\\lib\\dirmngr"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_40452E
		mov	ds:dword_40E168, eax
		mov	eax, ds:dword_40E168
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_407DEB
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_404250:				; CODE XREF: .text:004041C8j
		mov	eax, ds:dword_40E168
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 164h
		mov	eax, ds:dword_40E164
		test	eax, eax
		jnz	loc_4043E1
		mov	dword ptr [ebp-28h], offset aGnu_0 ; "GNU"
		mov	dword ptr [ebp-24h], offset aCache ; "cache"
		mov	dword ptr [ebp-20h], offset aDirmngr ; "dirmngr"
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-28h]
		mov	[ebp-10h], eax
		jmp	short loc_4042D4
; ---------------------------------------------------------------------------

loc_40429E:				; CODE XREF: .text:004042DBj
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	dword ptr [ebp-13Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-13Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp-0Ch]
		add	eax, edx
		add	eax, 1
		mov	[ebp-0Ch], eax
		add	dword ptr [ebp-10h], 4

loc_4042D4:				; CODE XREF: .text:0040429Cj
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40429E
		lea	eax, [ebp-12Ch]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 801Ch
		mov	dword ptr [esp], 0
		call	sub_403C16
		test	eax, eax
		js	loc_4043D7
		lea	eax, [ebp-12Ch]
		mov	dword ptr [ebp-13Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-13Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp-0Ch]
		add	eax, edx
		add	eax, 1
		mov	[esp], eax
		call	sub_40452E
		mov	[ebp-18h], eax
		lea	eax, [ebp-12Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_407DEB
		mov	[ebp-14h], eax
		lea	eax, [ebp-28h]
		mov	[ebp-10h], eax
		jmp	short loc_4043C4
; ---------------------------------------------------------------------------

loc_40436E:				; CODE XREF: .text:004043CBj
		mov	eax, [ebp-14h]
		mov	word ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_407DEB
		mov	[ebp-14h], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	_access
		test	eax, eax
		jz	short loc_4043C0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-18h]
		mov	[esp], eax
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8

loc_4043C0:				; CODE XREF: .text:004043A6j
		add	dword ptr [ebp-10h], 4

loc_4043C4:				; CODE XREF: .text:0040436Cj
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40436E
		mov	eax, [ebp-18h]
		mov	ds:dword_40E164, eax
		jmp	short loc_4043E1
; ---------------------------------------------------------------------------

loc_4043D7:				; CODE XREF: .text:0040430Dj
		mov	ds:dword_40E164, offset	aCTempCacheDirm	; "c:\\temp\\cache\\dirmngr"

loc_4043E1:				; CODE XREF: .text:0040426Dj
					; .text:004043D5j
		mov	eax, ds:dword_40E164
		mov	edi, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4043EB	proc near		; CODE XREF: sub_401E06:loc_401E48p

Dest		= dword	ptr -148h
Source		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_110		= byte ptr -110h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_40E160
		test	eax, eax
		jnz	loc_4044E5
		lea	eax, [ebp+var_110]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+Source], 24h
		mov	[esp+148h+Dest], 0
		call	sub_403C16
		test	eax, eax
		jns	short loc_404459
		mov	edx, offset aCWindows ;	"C:\\WINDOWS"
		lea	eax, [ebp+var_110]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	ecx, word ptr [edx+8]
		mov	[eax+8], cx
		movzx	edx, byte ptr [edx+0Ah]
		mov	[eax+0Ah], dl

loc_404459:				; CODE XREF: sub_4043EB+48j
		mov	[ebp+var_C], offset aS_dirmngr ; "\\S.dirmngr"
		lea	eax, [ebp+var_110]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_C]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+148h+Dest], eax ; size_t
		call	sub_40452E
		mov	ds:dword_40E160, eax
		mov	eax, ds:dword_40E160
		lea	edx, [ebp+var_110]
		mov	[esp+148h+Source], edx
		mov	[esp+148h+Dest], eax
		call	sub_407DEB
		mov	edx, [ebp+var_C]
		mov	[esp+148h+Source], edx ; Source
		mov	[esp+148h+Dest], eax ; Dest
		call	strcpy

loc_4044E5:				; CODE XREF: sub_4043EB+12j
		mov	eax, ds:dword_40E160
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4043EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4044F4	proc near		; CODE XREF: sub_40452E+1Ap
					; sub_40456C+21p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aErrorAllocatin ; "error allocating enough memory: %s\n"
		call	sub_406B3C
sub_4044F4	endp

; ---------------------------------------------------------------------------
		db  55h	; U
		db  89h	; 
		db 0E5h	; 
		db  83h	; 
		db 0ECh	; 
		db  18h
		db  8Bh	; 
		db  45h	; E
		db    8
		db  89h	; 
		db    4
		db  24h	; $
		db 0E8h	; 
		db  3Ch	; <
		db  66h	; f
		db    0
		db    0
		db 0C9h	; 
		db 0C3h	; 

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40452E(size_t)
sub_40452E	proc near		; CODE XREF: sub_4021B3+68p
					; sub_402612+94p ...

Size		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40454D
		call	sub_4044F4
; ---------------------------------------------------------------------------

loc_40454D:				; CODE XREF: sub_40452E+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40452E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40456C(void *, size_t)
sub_40456C	proc near		; CODE XREF: sub_4021B3+29Ep
					; sub_402612+ABp ...

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404592
		call	sub_4044F4
; ---------------------------------------------------------------------------

loc_404592:				; CODE XREF: sub_40456C+1Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40456C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	calloc
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	calloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4045D7
		call	sub_4044F4
; ---------------------------------------------------------------------------

loc_4045D7:				; CODE XREF: .text:004045D0j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_strdup
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4045EF(char *)
sub_4045EF	proc near		; CODE XREF: sub_401E06+4Ap
					; sub_401E06+1DAp ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_40462E
		call	sub_4044F4
; ---------------------------------------------------------------------------

loc_40462E:				; CODE XREF: sub_4045EF+38j
		mov	eax, [ebp+Dest]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4045EF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404649(void *)
sub_404649	proc near		; CODE XREF: sub_401650+578p
					; sub_401650+5A7p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_404660
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_404660:				; CODE XREF: sub_404649+Aj
		leave
		retn
sub_404649	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404664	proc near		; CODE XREF: .text:00404910p
					; sub_405102+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_4046E7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_4046E7
		mov	[esp+28h+Code],	offset aInvalidArgumen ; "Invalid argument for ArgParse\n"
		call	sub_406B69
; ---------------------------------------------------------------------------

loc_4046E7:				; CODE XREF: sub_404664+13j
					; sub_404664+75j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_404897
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_4047A6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_404713
		mov	dword ptr [ebp+var_C], offset aArgumentNotExp ;	"argument not expected\n"
		jmp	short loc_40477E
; ---------------------------------------------------------------------------

loc_404713:				; CODE XREF: sub_404664+A4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_404727
		mov	dword ptr [ebp+var_C], offset aReadError ; "read error\n"
		jmp	short loc_40477E
; ---------------------------------------------------------------------------

loc_404727:				; CODE XREF: sub_404664+B8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_40473B
		mov	dword ptr [ebp+var_C], offset aKeywordTooLong ;	"keyword too long\n"
		jmp	short loc_40477E
; ---------------------------------------------------------------------------

loc_40473B:				; CODE XREF: sub_404664+CCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_40474F
		mov	dword ptr [ebp+var_C], offset aMissingArgumen ;	"missing argument\n"
		jmp	short loc_40477E
; ---------------------------------------------------------------------------

loc_40474F:				; CODE XREF: sub_404664+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_404763
		mov	dword ptr [ebp+var_C], offset aInvalidCommand ;	"invalid command\n"
		jmp	short loc_40477E
; ---------------------------------------------------------------------------

loc_404763:				; CODE XREF: sub_404664+F4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_404777
		mov	dword ptr [ebp+var_C], offset aInvalidAliasDe ;	"invalid alias definition\n"
		jmp	short loc_40477E
; ---------------------------------------------------------------------------

loc_404777:				; CODE XREF: sub_404664+108j
		mov	dword ptr [ebp+var_C], offset aInvalidOption ; "invalid	option\n"

loc_40477E:				; CODE XREF: sub_404664+ADj
					; sub_404664+C1j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_406AF9
		jmp	loc_404876
; ---------------------------------------------------------------------------

loc_4047A6:				; CODE XREF: sub_404664+95j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_4047B8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_4047BD
; ---------------------------------------------------------------------------

loc_4047B8:				; CODE XREF: sub_404664+14Aj
		mov	eax, offset a??	; "[??]"

loc_4047BD:				; CODE XREF: sub_404664+152j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_4047E3
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "Missing argument for option \"%.50s\"\n"
		call	sub_406AF9
		jmp	loc_404876
; ---------------------------------------------------------------------------

loc_4047E3:				; CODE XREF: sub_404664+165j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_404803
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "Option \"%.50s\" does	not expect an arg"...
		call	sub_406AF9
		jmp	short loc_404876
; ---------------------------------------------------------------------------

loc_404803:				; CODE XREF: sub_404664+188j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_404823
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "Invalid command \"%.50s\"\n"
		call	sub_406AF9
		jmp	short loc_404876
; ---------------------------------------------------------------------------

loc_404823:				; CODE XREF: sub_404664+1A8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_404843
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "Option \"%.50s\" is ambiguous\n"
		call	sub_406AF9
		jmp	short loc_404876
; ---------------------------------------------------------------------------

loc_404843:				; CODE XREF: sub_404664+1C8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF7h
		jnz	short loc_404863
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "Command \"%.50s\" is ambiguous\n"
		call	sub_406AF9
		jmp	short loc_404876
; ---------------------------------------------------------------------------

loc_404863:				; CODE XREF: sub_404664+1E8j
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "Invalid option \"%.50s\"\n"
		call	sub_406AF9

loc_404876:				; CODE XREF: sub_404664+13Dj
					; sub_404664+17Aj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_40488D
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40488D:				; CODE XREF: sub_404664+21Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_404897:				; CODE XREF: sub_404664+8Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_404664	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4048AD	proc near		; CODE XREF: .text:00404B91p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_4048AD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0B4h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-2Ch], 0
		mov	dword ptr [ebp-20h], 0
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4048FC
		mov	eax, [ebp+18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_405102
		jmp	loc_404FA1
; ---------------------------------------------------------------------------

loc_4048FC:				; CODE XREF: .text:004048E3j
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_404664
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_404925
; ---------------------------------------------------------------------------

loc_404924:				; CODE XREF: .text:00404CFDj
					; .text:00404D3Aj ...
		nop

loc_404925:				; CODE XREF: .text:00404922j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	getc
		mov	[ebp-30h], eax
		cmp	dword ptr [ebp-30h], 0Ah
		jz	short loc_404943
		cmp	dword ptr [ebp-30h], 0FFFFFFFFh
		jnz	loc_404CF9

loc_404943:				; CODE XREF: .text:00404937j
		cmp	dword ptr [ebp-30h], 0FFFFFFFFh
		jz	short loc_404956
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_404956:				; CODE XREF: .text:00404947j
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_404F97
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_404A82
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_4049B5
; ---------------------------------------------------------------------------

loc_40497F:				; CODE XREF: .text:004049C2j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4049B1
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-94h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_4049C6

loc_4049B1:				; CODE XREF: .text:0040498Dj
		add	dword ptr [ebp-10h], 1

loc_4049B5:				; CODE XREF: .text:0040497Dj
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40497F
		jmp	short loc_4049C7
; ---------------------------------------------------------------------------

loc_4049C6:				; CODE XREF: .text:004049AFj
		nop

loc_4049C7:				; CODE XREF: .text:004049C4j
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		cmp	dword ptr [ebp-2Ch], 0
		jz	short loc_4049F4
		mov	eax, [ebp+14h]
		mov	eax, [eax+10h]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx

loc_4049F4:				; CODE XREF: .text:004049E2j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404A2F
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 100h
		test	eax, eax
		jz	short loc_404A1F
		mov	eax, 0FFFFFFF9h
		jmp	short loc_404A24
; ---------------------------------------------------------------------------

loc_404A1F:				; CODE XREF: .text:00404A16j
		mov	eax, 0FFFFFFFEh

loc_404A24:				; CODE XREF: .text:00404A1Dj
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404A2F:				; CODE XREF: .text:00404A01j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_404A51
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404A51:				; CODE XREF: .text:00404A40j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_404A73
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404A73:				; CODE XREF: .text:00404A62j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404A82:				; CODE XREF: .text:00404964j
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_404AF0
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_404A9D
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404A9D:				; CODE XREF: .text:00404A8Cj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_404ABF
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404ABF:				; CODE XREF: .text:00404AAEj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_404AE1
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404AE1:				; CODE XREF: .text:00404AD0j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404AF0:				; CODE XREF: .text:00404A86j
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_404CB3
		cmp	dword ptr [ebp-20h], 0
		jz	loc_404B9B
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_404B19
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_404CAE
; ---------------------------------------------------------------------------

loc_404B19:				; CODE XREF: .text:00404B08j
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0
		mov	dword ptr [esp+4], offset asc_40CD74 ; " \t"
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-24h], eax
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_404B53
		mov	eax, [ebp-24h]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-24h], 1
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	sub_406EE4

loc_404B53:				; CODE XREF: .text:00404B3Cj
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_404B63
		mov	eax, [ebp-24h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404B7D

loc_404B63:				; CODE XREF: .text:00404B57j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_404649
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_404F9A
; ---------------------------------------------------------------------------

loc_404B7D:				; CODE XREF: .text:00404B61j
		mov	eax, [ebp-24h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4048AD
		jmp	loc_404CAE
; ---------------------------------------------------------------------------

loc_404B9B:				; CODE XREF: .text:00404AFEj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_404BBD
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_404F9A
; ---------------------------------------------------------------------------

loc_404BBD:				; CODE XREF: .text:00404BACj
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_404BE2
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		lea	eax, [ebp-94h]
		mov	[esp], eax
		call	sub_4045EF
		mov	[ebp-18h], eax
		jmp	short loc_404BEB
; ---------------------------------------------------------------------------

loc_404BE2:				; CODE XREF: .text:00404BC1j
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0

loc_404BEB:				; CODE XREF: .text:00404BE0j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_406EE4
		mov	eax, [ebp-18h]
		mov	[ebp-28h], eax
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_404C74
		add	dword ptr [ebp-28h], 1
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404C74
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-9Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-9Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_404C74
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-9Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-9Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		mov	byte ptr [eax],	0

loc_404C74:				; CODE XREF: .text:00404C04j
					; .text:00404C12j ...
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		mov	edx, [ebp-28h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4058A0
		test	eax, eax
		jnz	loc_404F9A
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_404649
		jmp	loc_404F9A
; ---------------------------------------------------------------------------

loc_404CAE:				; CODE XREF: .text:00404B14j
					; .text:00404B96j
		jmp	loc_404F9A
; ---------------------------------------------------------------------------

loc_404CB3:				; CODE XREF: .text:00404AF4j
		cmp	dword ptr [ebp-30h], 0FFFFFFFFh
		jnz	short loc_404CE6
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	ferror
		test	eax, eax
		jz	short loc_404CD7
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404CD7:				; CODE XREF: .text:00404CC6j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0
		jmp	loc_404F9B
; ---------------------------------------------------------------------------

loc_404CE6:				; CODE XREF: .text:00404CB7j
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-10h], 0
		jmp	loc_404F92
; ---------------------------------------------------------------------------

loc_404CF9:				; CODE XREF: .text:0040493Dj
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_404924
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_404D1E
		mov	eax, [ebp-30h]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_404F92

loc_404D1E:				; CODE XREF: .text:00404D07j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_404D36
		cmp	dword ptr [ebp-30h], 23h
		jnz	short loc_404D36
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_404F92
; ---------------------------------------------------------------------------

loc_404D36:				; CODE XREF: .text:00404D22j
					; .text:00404D28j
		cmp	dword ptr [ebp-0Ch], 1
		jz	loc_404924
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_404E4E
		mov	eax, [ebp-30h]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_404E4E
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_404DAA
; ---------------------------------------------------------------------------

loc_404D74:				; CODE XREF: .text:00404DB7j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_404DA6
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-94h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_404DBB

loc_404DA6:				; CODE XREF: .text:00404D82j
		add	dword ptr [ebp-10h], 1

loc_404DAA:				; CODE XREF: .text:00404D72j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404D74
		jmp	short loc_404DBC
; ---------------------------------------------------------------------------

loc_404DBB:				; CODE XREF: .text:00404DA4j
		nop

loc_404DBC:				; CODE XREF: .text:00404DB9j
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404E42
		mov	dword ptr [esp+4], offset aAlias ; "alias"
		lea	eax, [ebp-94h]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_404E0F
		mov	dword ptr [ebp-20h], 1
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_404F92
; ---------------------------------------------------------------------------

loc_404E0F:				; CODE XREF: .text:00404DFAj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 100h
		test	eax, eax
		jz	short loc_404E2B
		mov	eax, 0FFFFFFF9h
		jmp	short loc_404E30
; ---------------------------------------------------------------------------

loc_404E2B:				; CODE XREF: .text:00404E22j
		mov	eax, 0FFFFFFFEh

loc_404E30:				; CODE XREF: .text:00404E29j
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_404F92
; ---------------------------------------------------------------------------

loc_404E42:				; CODE XREF: .text:00404DE0j
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_404F92
; ---------------------------------------------------------------------------

loc_404E4E:				; CODE XREF: .text:00404D44j
					; .text:00404D59j
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_404E90
		mov	eax, [ebp-30h]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_404924
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-30h]
		mov	edx, eax
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 4
		jmp	loc_404924
; ---------------------------------------------------------------------------

loc_404E90:				; CODE XREF: .text:00404E52j
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_404F54
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_404EEE
		mov	eax, [ebp-10h]
		mov	edx, [ebp-1Ch]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_404EC1
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-30h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_404924
; ---------------------------------------------------------------------------

loc_404EC1:				; CODE XREF: .text:00404EABj
		add	dword ptr [ebp-1Ch], 32h
		mov	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40456C
		mov	[ebp-18h], eax
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-30h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_404924
; ---------------------------------------------------------------------------

loc_404EEE:				; CODE XREF: .text:00404E9Ej
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		ja	short loc_404F0F
		mov	eax, [ebp-30h]
		mov	edx, eax
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_404924
; ---------------------------------------------------------------------------

loc_404F0F:				; CODE XREF: .text:00404EF4j
		mov	dword ptr [ebp-1Ch], 96h
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_40452E
		mov	[ebp-18h], eax
		mov	ecx, [ebp-10h]
		lea	edx, [ebp-94h]
		mov	eax, [ebp-18h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-30h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_404924
; ---------------------------------------------------------------------------

loc_404F54:				; CODE XREF: .text:00404E94j
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		jbe	short loc_404F72
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_404924
; ---------------------------------------------------------------------------

loc_404F72:				; CODE XREF: .text:00404F5Aj
		mov	eax, [ebp-30h]
		mov	edx, eax
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 2
		jmp	loc_404924
; ---------------------------------------------------------------------------

loc_404F92:				; CODE XREF: .text:00404CF4j
					; .text:00404D18j ...
		jmp	loc_404924
; ---------------------------------------------------------------------------

loc_404F97:				; CODE XREF: .text:0040495Aj
		nop
		jmp	short loc_404F9B
; ---------------------------------------------------------------------------

loc_404F9A:				; CODE XREF: .text:00404B78j
					; .text:00404BB8j ...
		nop

loc_404F9B:				; CODE XREF: .text:00404A2Aj
					; .text:00404A4Cj ...
		mov	eax, [ebp+14h]
		mov	eax, [eax+10h]

loc_404FA1:				; CODE XREF: .text:004048F7j
		add	esp, 0B4h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404FAA(int, int, char	*)
sub_404FAA	proc near		; CODE XREF: sub_405102+182p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404FC5
		mov	eax, 0FFFFFFFFh
		jmp	loc_4050FC
; ---------------------------------------------------------------------------

loc_404FC5:				; CODE XREF: sub_404FAA+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_405009
; ---------------------------------------------------------------------------

loc_404FCE:				; CODE XREF: sub_404FAA+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405005
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_405005
		mov	eax, [ebp+var_C]
		jmp	loc_4050FC
; ---------------------------------------------------------------------------

loc_405005:				; CODE XREF: sub_404FAA+32j
					; sub_404FAA+51j
		add	[ebp+var_C], 1

loc_405009:				; CODE XREF: sub_404FAA+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404FCE
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_4050E4
; ---------------------------------------------------------------------------

loc_405046:				; CODE XREF: sub_404FAA+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_4050E0
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_4050E0
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4050CC
; ---------------------------------------------------------------------------

loc_40508B:				; CODE XREF: sub_404FAA+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4050C8
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_4050C8
		mov	eax, 0FFFFFFFEh
		jmp	short loc_4050FC
; ---------------------------------------------------------------------------

loc_4050C8:				; CODE XREF: sub_404FAA+EFj
					; sub_404FAA+115j
		add	[ebp+var_10], 1

loc_4050CC:				; CODE XREF: sub_404FAA+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40508B
		mov	eax, [ebp+var_C]
		jmp	short loc_4050FC
; ---------------------------------------------------------------------------

loc_4050E0:				; CODE XREF: sub_404FAA+AAj
					; sub_404FAA+D4j
		add	[ebp+var_C], 1

loc_4050E4:				; CODE XREF: sub_404FAA+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_405046
		mov	eax, 0FFFFFFFFh

loc_4050FC:				; CODE XREF: sub_404FAA+16j
					; sub_404FAA+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_404FAA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405102	proc near		; CODE XREF: sub_401650+22Dp
					; .text:004048F2p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_404664
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405166
		cmp	[ebp+var_10], 0
		jz	short loc_405166
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_405166
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_405166:				; CODE XREF: sub_405102+43j
					; sub_405102+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_40517B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_40587A
; ---------------------------------------------------------------------------

loc_40517B:				; CODE XREF: sub_405102+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4051D1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_4051D1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_40587A
; ---------------------------------------------------------------------------

loc_4051D1:				; CODE XREF: sub_405102+92j
					; sub_405102+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4051EA
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_40587A
; ---------------------------------------------------------------------------

loc_4051EA:				; CODE XREF: sub_405102+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_405555
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_405555
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405248
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_405248
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_405166
; ---------------------------------------------------------------------------

loc_405248:				; CODE XREF: sub_405102+11Cj
					; sub_405102+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], 3Dh ; Val
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_40526D
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_40526D:				; CODE XREF: sub_405102+163j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_404FAA
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_405298
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_405298:				; CODE XREF: sub_405102+18Ej
		cmp	[ebp+var_20], 0
		jns	short loc_4052D2
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset Str1 ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_4052D2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_405A11
; ---------------------------------------------------------------------------
		jmp	loc_4053F6
; ---------------------------------------------------------------------------

loc_4052D2:				; CODE XREF: sub_405102+19Aj
					; sub_405102+1B4j
		cmp	[ebp+var_20], 0
		jns	short loc_405314
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aVersion ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_405314
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_4053F6
		call	sub_405F74
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_405314:				; CODE XREF: sub_405102+1D4j
					; sub_405102+1EEj
		cmp	[ebp+var_20], 0
		jns	short loc_405354
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_405354
		mov	[esp+38h+Str], 10h
		call	sub_4061CC
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_405354:				; CODE XREF: sub_405102+216j
					; sub_405102+230j
		cmp	[ebp+var_20], 0
		jns	loc_4053F6
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	short loc_4053F6
		mov	[ebp+var_20], 0
		jmp	short loc_4053B2
; ---------------------------------------------------------------------------

loc_405381:				; CODE XREF: sub_405102+2BDj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4053AE
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, offset aS	; "--%s\n"
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax ; Format
		call	printf

loc_4053AE:				; CODE XREF: sub_405102+28Dj
		add	[ebp+var_20], 1

loc_4053B2:				; CODE XREF: sub_405102+27Dj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_405381
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aDumpOptionsHel ; "--dump-options\n--help\n--version\n--wa"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Bh ; Count
		mov	[esp+38h+Val], 1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4053F6:				; CODE XREF: sub_405102+1CBj
					; sub_405102+1FBj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_405408
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_405437
; ---------------------------------------------------------------------------

loc_405408:				; CODE XREF: sub_405102+2F8j
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_405426
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_405437
; ---------------------------------------------------------------------------

loc_405426:				; CODE XREF: sub_405102+30Aj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_405437:				; CODE XREF: sub_405102+304j
					; sub_405102+322j
		cmp	[ebp+var_20], 0
		js	loc_405544
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_405525
		cmp	[ebp+var_28], 0
		jz	short loc_40547A
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405483
		mov	[ebp+var_1C], 0
		jmp	short loc_405483
; ---------------------------------------------------------------------------

loc_40547A:				; CODE XREF: sub_405102+35Aj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_405483:				; CODE XREF: sub_405102+36Dj
					; sub_405102+376j
		cmp	[ebp+var_1C], 0
		jnz	short loc_4054AB
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4054AB
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_405544
; ---------------------------------------------------------------------------

loc_4054AB:				; CODE XREF: sub_405102+385j
					; sub_405102+398j
		cmp	[ebp+var_1C], 0
		jnz	short loc_4054C0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_405543
; ---------------------------------------------------------------------------

loc_4054C0:				; CODE XREF: sub_405102+3ADj
		cmp	[ebp+var_28], 0
		jnz	short loc_4054EF
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4054EF
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4054EF
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_405544
; ---------------------------------------------------------------------------

loc_4054EF:				; CODE XREF: sub_405102+3C2j
					; sub_405102+3CCj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_4058A0
		cmp	[ebp+var_28], 0
		jnz	short loc_405543
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_405543
; ---------------------------------------------------------------------------

loc_405525:				; CODE XREF: sub_405102+350j
		cmp	[ebp+var_28], 0
		jz	short loc_405537
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_405544
; ---------------------------------------------------------------------------

loc_405537:				; CODE XREF: sub_405102+427j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_405544
; ---------------------------------------------------------------------------

loc_405543:				; CODE XREF: sub_405102+3B9j
					; sub_405102+413j ...
		nop

loc_405544:				; CODE XREF: sub_405102+339j
					; sub_405102+3A4j ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_40587A
; ---------------------------------------------------------------------------

loc_405555:				; CODE XREF: sub_405102+F0j
					; sub_405102+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40556C
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40557A

loc_40556C:				; CODE XREF: sub_405102+45Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_405832

loc_40557A:				; CODE XREF: sub_405102+468j
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_405605
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_405605
		mov	[ebp+var_20], 0
		jmp	short loc_4055F6
; ---------------------------------------------------------------------------

loc_4055B7:				; CODE XREF: sub_405102+501j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4055F2
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+38h+Val], edx ; Str2
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4055F2
		mov	[ebp+var_24], 1
		jmp	short loc_405605
; ---------------------------------------------------------------------------

loc_4055F2:				; CODE XREF: sub_405102+4C3j
					; sub_405102+4E5j
		add	[ebp+var_20], 1

loc_4055F6:				; CODE XREF: sub_405102+4B3j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4055B7

loc_405605:				; CODE XREF: sub_405102+48Ej
					; sub_405102+4AAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40564B
		mov	[ebp+var_20], 0
		jmp	short loc_405639
; ---------------------------------------------------------------------------

loc_40561D:				; CODE XREF: sub_405102+544j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_40564A
		add	[ebp+var_20], 1

loc_405639:				; CODE XREF: sub_405102+519j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40561D
		jmp	short loc_40564B
; ---------------------------------------------------------------------------

loc_40564A:				; CODE XREF: sub_405102+531j
		nop

loc_40564B:				; CODE XREF: sub_405102+510j
					; sub_405102+546j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_405683
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_40566E
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_405683

loc_40566E:				; CODE XREF: sub_405102+560j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_405A11
; ---------------------------------------------------------------------------

loc_405683:				; CODE XREF: sub_405102+556j
					; sub_405102+56Aj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4056E7
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 100h
		test	eax, eax
		jz	short loc_4056BF
		mov	eax, 0FFFFFFF9h
		jmp	short loc_4056C4
; ---------------------------------------------------------------------------

loc_4056BF:				; CODE XREF: sub_405102+5B4j
		mov	eax, 0FFFFFFFEh

loc_4056C4:				; CODE XREF: sub_405102+5BBj
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_405807
; ---------------------------------------------------------------------------

loc_4056E7:				; CODE XREF: sub_405102+59Fj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_4057EE
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405741
		cmp	[ebp+var_24], 0
		jnz	short loc_405741
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_4058A0
		jmp	loc_4057E5
; ---------------------------------------------------------------------------

loc_405741:				; CODE XREF: sub_405102+607j
					; sub_405102+60Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40576F
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_40576F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_4057E5
; ---------------------------------------------------------------------------

loc_40576F:				; CODE XREF: sub_405102+64Cj
					; sub_405102+65Fj
		cmp	[ebp+var_1C], 0
		jnz	short loc_405781
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_4057E5
; ---------------------------------------------------------------------------

loc_405781:				; CODE XREF: sub_405102+671j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4057B7
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4057B7
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4057B7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_4057E5
; ---------------------------------------------------------------------------

loc_4057B7:				; CODE XREF: sub_405102+687j
					; sub_405102+694j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_4058A0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_4057E5:				; CODE XREF: sub_405102+63Aj
					; sub_405102+66Bj ...
		mov	[ebp+var_18], offset asc_40CDD4	; "x"
		jmp	short loc_405807
; ---------------------------------------------------------------------------

loc_4057EE:				; CODE XREF: sub_405102+5F6j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_405807:				; CODE XREF: sub_405102+5E0j
					; sub_405102+6EAj
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40581A
		cmp	[ebp+var_24], 0
		jz	short loc_405879

loc_40581A:				; CODE XREF: sub_405102+710j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_405879
; ---------------------------------------------------------------------------

loc_405832:				; CODE XREF: sub_405102+472j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_40586A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_40587A
; ---------------------------------------------------------------------------

loc_40586A:				; CODE XREF: sub_405102+73Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_405166
; ---------------------------------------------------------------------------

loc_405879:				; CODE XREF: sub_405102+716j
					; sub_405102+72Ej
		nop

loc_40587A:				; CODE XREF: sub_405102+74j
					; sub_405102+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_405102	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4058A0(int, int, char	*)
sub_4058A0	proc near		; CODE XREF: .text:00404C91p
					; sub_405102+40Ap ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_4058B7
		mov	eax, 0
		jmp	short loc_4058BC
; ---------------------------------------------------------------------------

loc_4058B7:				; CODE XREF: sub_4058A0+Ej
		mov	eax, 0Ah

loc_4058BC:				; CODE XREF: sub_4058A0+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_405909
		cmp	eax, 4
		jz	short loc_405930
		cmp	eax, 1
		jnz	short loc_405957
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, 0
		jmp	short locret_405965
; ---------------------------------------------------------------------------

loc_405909:				; CODE XREF: sub_4058A0+36j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, 0
		jmp	short locret_405965
; ---------------------------------------------------------------------------

loc_405930:				; CODE XREF: sub_4058A0+3Bj
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, 0
		jmp	short locret_405965
; ---------------------------------------------------------------------------

loc_405957:				; CODE XREF: sub_4058A0+40j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_405965:				; CODE XREF: sub_4058A0+67j
					; sub_4058A0+8Ej ...
		leave
		retn
sub_4058A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405967	proc near		; CODE XREF: sub_405A11+8Ep

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_405A08
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_405A08
		call	sub_408720
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_4059F3
		add	[ebp+var_C], 1
		jmp	short loc_4059F3
; ---------------------------------------------------------------------------

loc_4059CE:				; CODE XREF: sub_405967+9Fj
		cmp	[ebp+var_14], 0
		jz	short loc_4059ED
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_4059ED
		add	[ebp+var_C], 1

loc_4059ED:				; CODE XREF: sub_405967+6Bj
					; sub_405967+80j
		add	[ebp+var_10], 1
		jmp	short loc_4059F4
; ---------------------------------------------------------------------------

loc_4059F3:				; CODE XREF: sub_405967+5Fj
					; sub_405967+65j
		nop

loc_4059F4:				; CODE XREF: sub_405967+8Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405A08
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4059CE

loc_405A08:				; CODE XREF: sub_405967+34j
					; sub_405967+41j ...
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_405967	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_405A11	proc near		; CODE XREF: sub_405102+1C6p
					; sub_405102+57Cp

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		call	sub_405F74
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Str], 29h
		call	sub_4061CC
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_405E71
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_405ABF
; ---------------------------------------------------------------------------

loc_405A60:				; CODE XREF: sub_405A11+BBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405ABB
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_405A93
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_405ABB

loc_405A93:				; CODE XREF: sub_405A11+6Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_405967
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_405ABB
		cmp	[ebp+var_14], 22h
		jg	short loc_405ABB
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_405ABB:				; CODE XREF: sub_405A11+5Dj
					; sub_405A11+80j ...
		add	[ebp+var_10], 1

loc_405ABF:				; CODE XREF: sub_405A11+4Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_405A60
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_405AEB
		mov	[esp+38h+Str], offset aOptions ; "Options:"
		call	puts

loc_405AEB:				; CODE XREF: sub_405A11+CCj
		mov	[ebp+var_10], 0
		jmp	loc_405E48
; ---------------------------------------------------------------------------

loc_405AF7:				; CODE XREF: sub_405A11+444j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405B27
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_405B27
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_405E43

loc_405B27:				; CODE XREF: sub_405A11+F9j
					; sub_405A11+103j
		cmp	[ebp+var_C], 0
		jz	short loc_405B92
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_405B92
		add	[ebp+var_C], 1
		jmp	short loc_405B77
; ---------------------------------------------------------------------------

loc_405B3D:				; CODE XREF: sub_405A11+16Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_405B62
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405B73
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_405B73
; ---------------------------------------------------------------------------

loc_405B62:				; CODE XREF: sub_405A11+134j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_405B73:				; CODE XREF: sub_405A11+141j
					; sub_405A11+14Fj
		add	[ebp+var_C], 1

loc_405B77:				; CODE XREF: sub_405A11+12Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405B3D
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_405E44
; ---------------------------------------------------------------------------

loc_405B92:				; CODE XREF: sub_405A11+11Aj
					; sub_405A11+124j
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_405C46
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset aC	; " -%c"
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Str], eax ; Format
		call	printf
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_405C6F
		cmp	[ebp+var_C], 0
		jz	loc_405C6F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_405C6F
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_405C22
; ---------------------------------------------------------------------------

loc_405C09:				; CODE XREF: sub_405A11+223j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_405C22:				; CODE XREF: sub_405A11+1F6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405C36
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_405C09

loc_405C36:				; CODE XREF: sub_405A11+219j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405C6F
		add	[ebp+var_C], 1
		jmp	short loc_405C6F
; ---------------------------------------------------------------------------

loc_405C46:				; CODE XREF: sub_405A11+198j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_40CDE4 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_405C6F:				; CODE XREF: sub_405A11+1C8j
					; sub_405A11+1D2j ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_405D72
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_405CA8
		mov	eax, 2Ch
		jmp	short loc_405CAD
; ---------------------------------------------------------------------------

loc_405CA8:				; CODE XREF: sub_405A11+28Ej
		mov	eax, 20h

loc_405CAD:				; CODE XREF: sub_405A11+295j
		mov	edx, offset aCS	; "%c --%s"
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str], edx ; Format
		call	printf
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405D33
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_405D33
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_405D10
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		jmp	short loc_405D10
; ---------------------------------------------------------------------------

loc_405CF5:				; CODE XREF: sub_405A11+312j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_405D11
; ---------------------------------------------------------------------------

loc_405D10:				; CODE XREF: sub_405A11+2D0j
					; sub_405A11+2E2j
		nop

loc_405D11:				; CODE XREF: sub_405A11+2FDj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405D25
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_405CF5

loc_405D25:				; CODE XREF: sub_405A11+308j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405D33
		add	[ebp+var_C], 1

loc_405D33:				; CODE XREF: sub_405A11+2B8j
					; sub_405A11+2C2j ...
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_40CDE4 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_14], 3
		jmp	short loc_405D72
; ---------------------------------------------------------------------------

loc_405D62:				; CODE XREF: sub_405A11+367j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_405D72:				; CODE XREF: sub_405A11+26Cj
					; sub_405A11+34Fj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_405D62
		cmp	[ebp+var_C], 0
		jz	loc_405E35
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_405E2A
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_405E2A
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_405DC3
; ---------------------------------------------------------------------------

loc_405DB3:				; CODE XREF: sub_405A11+3B8j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_405DC3:				; CODE XREF: sub_405A11+3A0j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_405DB3
		jmp	short loc_405E2A
; ---------------------------------------------------------------------------

loc_405DCD:				; CODE XREF: sub_405A11+422j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_405E13
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405E24
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_405E09
; ---------------------------------------------------------------------------

loc_405DF9:				; CODE XREF: sub_405A11+3FEj
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_405E09:				; CODE XREF: sub_405A11+3E6j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_405DF9
		jmp	short loc_405E24
; ---------------------------------------------------------------------------

loc_405E13:				; CODE XREF: sub_405A11+3C4j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_405E24:				; CODE XREF: sub_405A11+3D1j
					; sub_405A11+400j
		add	[ebp+var_C], 1
		jmp	short loc_405E2B
; ---------------------------------------------------------------------------

loc_405E2A:				; CODE XREF: sub_405A11+37Bj
					; sub_405A11+387j ...
		nop

loc_405E2B:				; CODE XREF: sub_405A11+417j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405DCD

loc_405E35:				; CODE XREF: sub_405A11+36Dj
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_405E44
; ---------------------------------------------------------------------------

loc_405E43:				; CODE XREF: sub_405A11+110j
		nop

loc_405E44:				; CODE XREF: sub_405A11+17Cj
					; sub_405A11+430j
		add	[ebp+var_10], 1

loc_405E48:				; CODE XREF: sub_405A11+E1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_405AF7
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_405E71
		mov	[esp+38h+Str], offset aASingleDashMay ;	"\n(A single dash may be used instead of"...
		call	puts

loc_405E71:				; CODE XREF: sub_405A11+3Aj
					; sub_405A11+452j
		mov	[esp+38h+Str], 13h
		call	sub_4061CC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_405F58
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Size],	offset SubStr ;	"@EMAIL@"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_405F41
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jz	short loc_405EF1
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	ecx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_405EF1:				; CODE XREF: sub_405A11+4ADj
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aBugDirmngr@g_0 ; "bug-dirmngr@gnupg.org"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 15h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_1C], 7
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405F58
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		jmp	short loc_405F58
; ---------------------------------------------------------------------------

loc_405F41:				; CODE XREF: sub_405A11+49Fj
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Size],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_405F58:				; CODE XREF: sub_405A11+473j
					; sub_405A11+515j ...
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Str], eax ; File
		call	fflush
		mov	[esp+38h+Str], 0 ; Code
		call	exit
sub_405A11	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405F74	proc near		; CODE XREF: sub_405102+201p
					; sub_405A11+7p

Str		= dword	ptr -28h
File		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	[esp+28h+Str], 0Bh
		call	sub_4061CC
		mov	[esp+28h+File],	ebx ; File
		mov	[esp+28h+Str], eax ; Str
		call	fputs
		mov	[esp+28h+Str], 0Ch
		call	sub_4061CC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_405FC4
		mov	eax, offset aS_0 ; " (%s)"
		mov	edx, [ebp+var_10]
		mov	[esp+28h+File],	edx
		mov	[esp+28h+Str], eax ; Format
		call	printf

loc_405FC4:				; CODE XREF: sub_405F74+3Aj
		mov	[esp+28h+Str], 0Dh
		call	sub_4061CC
		mov	edx, offset aS_1 ; " %s\n"
		mov	[esp+28h+File],	eax
		mov	[esp+28h+Str], edx ; Format
		call	printf
		mov	[ebp+var_C], 14h
		jmp	short loc_40600D
; ---------------------------------------------------------------------------

loc_405FEA:				; CODE XREF: sub_405F74+9Dj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_4061CC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406009
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_406009:				; CODE XREF: sub_405F74+88j
		add	[ebp+var_C], 1

loc_40600D:				; CODE XREF: sub_405F74+74j
		cmp	[ebp+var_C], 1Dh
		jle	short loc_405FEA
		mov	[esp+28h+Str], 0Eh
		call	sub_4061CC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406033
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_406033:				; CODE XREF: sub_405F74+B2j
		mov	[esp+28h+Str], 0Ah
		call	sub_4061CC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406053
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_406053:				; CODE XREF: sub_405F74+D2j
		mov	[esp+28h+Str], 0Fh
		call	sub_4061CC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40607F
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_40607F:				; CODE XREF: sub_405F74+F2j
		mov	[esp+28h+Str], 12h
		call	sub_4061CC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4060AB
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_4060AB:				; CODE XREF: sub_405F74+11Ej
		mov	[ebp+var_C], 1Eh
		jmp	short loc_4060E3
; ---------------------------------------------------------------------------

loc_4060B4:				; CODE XREF: sub_405F74+173j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_4061CC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4060DF
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_4060DF:				; CODE XREF: sub_405F74+152j
		add	[ebp+var_C], 1

loc_4060E3:				; CODE XREF: sub_405F74+13Ej
		cmp	[ebp+var_C], 27h
		jle	short loc_4060B4
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_405F74	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4060FF	proc near		; CODE XREF: sub_401650+2DFp
					; sub_401650+30Ep ...

File		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40616D
		mov	[esp+28h+File],	0Eh
		call	sub_4061CC
		mov	esi, eax
		mov	[esp+28h+File],	0Dh
		call	sub_4061CC
		mov	ebx, eax
		mov	[esp+28h+File],	0Bh
		call	sub_4061CC
		mov	edx, offset aSSS ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_18], esi
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	fflush
		jmp	short loc_4061C5
; ---------------------------------------------------------------------------

loc_40616D:				; CODE XREF: sub_4060FF+Cj
		cmp	[ebp+arg_0], 1
		jnz	short loc_40619F
		mov	eax, ds:_iob
		lea	ebx, [eax+40h]
		mov	[esp+28h+File],	28h
		call	sub_4061CC
		mov	[esp+28h+Format], ebx ;	File
		mov	[esp+28h+File],	eax ; Str
		call	fputs
		mov	[esp+28h+File],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40619F:				; CODE XREF: sub_4060FF+72j
		cmp	[ebp+arg_0], 2
		jnz	short loc_4061C5
		mov	[esp+28h+File],	29h
		call	sub_4061CC
		mov	[esp+28h+File],	eax ; Str
		call	puts
		mov	[esp+28h+File],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4061C5:				; CODE XREF: sub_4060FF+6Cj
					; sub_4060FF+A4j
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4060FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4061CC	proc near		; CODE XREF: sub_405102+239p
					; sub_405A11+1Fp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_40E2A0
		test	eax, eax
		jz	short loc_4061EB
		mov	edx, ds:dword_40E2A0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_40E2A0
		jmp	short loc_4061F0
; ---------------------------------------------------------------------------

loc_4061EB:				; CODE XREF: sub_4061CC+Dj
		mov	eax, 0

loc_4061F0:				; CODE XREF: sub_4061CC+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4061FE
		mov	eax, [ebp+var_C]
		jmp	short locret_406253
; ---------------------------------------------------------------------------

loc_4061FE:				; CODE XREF: sub_4061CC+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_406250 ; jumptable 00406210 default case
		mov	eax, ds:off_40D1BC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406212:				; CODE XREF: sub_4061CC+44j
					; DATA XREF: .rdata:off_40D1BCo
		mov	[ebp+var_C], offset aLicenseGplv3Gn ; jumptable	00406210 case 10
		jmp	short loc_406250 ; jumptable 00406210 default case
; ---------------------------------------------------------------------------

loc_40621B:				; CODE XREF: sub_4061CC+44j
					; DATA XREF: .rdata:off_40D1BCo
		mov	[ebp+var_C], offset aFoo ; jumptable 00406210 case 11
		jmp	short loc_406250 ; jumptable 00406210 default case
; ---------------------------------------------------------------------------

loc_406224:				; CODE XREF: sub_4061CC+44j
					; DATA XREF: .rdata:off_40D1BCo
		mov	[ebp+var_C], offset a0_0 ; jumptable 00406210 case 13
		jmp	short loc_406250 ; jumptable 00406210 default case
; ---------------------------------------------------------------------------

loc_40622D:				; CODE XREF: sub_4061CC+44j
					; DATA XREF: .rdata:off_40D1BCo
		mov	[ebp+var_C], offset aCopyrightC2010 ; jumptable	00406210 case 14
		jmp	short loc_406250 ; jumptable 00406210 default case
; ---------------------------------------------------------------------------

loc_406236:				; CODE XREF: sub_4061CC+44j
					; DATA XREF: .rdata:off_40D1BCo
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	00406210 case 15
		jmp	short loc_406250 ; jumptable 00406210 default case
; ---------------------------------------------------------------------------

loc_40623F:				; CODE XREF: sub_4061CC+44j
					; DATA XREF: .rdata:off_40D1BCo
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	00406210 case 16
		jmp	short loc_406250 ; jumptable 00406210 default case
; ---------------------------------------------------------------------------

loc_406248:				; CODE XREF: sub_4061CC+44j
					; DATA XREF: .rdata:off_40D1BCo
		mov	[ebp+var_C], offset dword_40D1B8 ; jumptable 00406210 cases 40,41
		nop

loc_406250:				; CODE XREF: sub_4061CC+3Bj
					; sub_4061CC+44j ...
		mov	eax, [ebp+var_C] ; jumptable 00406210 default case

locret_406253:				; CODE XREF: sub_4061CC+30j
		leave
		retn
sub_4061CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406255	proc near		; CODE XREF: sub_401650+54p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_40E2A0, eax
		pop	ebp
		retn
sub_406255	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406264	proc near		; CODE XREF: sub_401650+241p
					; sub_401650+3CDp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_40E34C
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_406282
		mov	ds:dword_40E34C, 0

loc_406282:				; CODE XREF: sub_406264+12j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_406264	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_40E34C
		add	eax, 1
		mov	ds:dword_40E34C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406299(char *Filename, int FileHandle)
sub_406299	proc near		; CODE XREF: sub_406536+21p
					; .text:00406572p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		cmp	[ebp+Filename],	0
		jz	short loc_4062E9
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset byte_40D23C
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4062E9
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_4062E9:				; CODE XREF: sub_406299+Cj
					; sub_406299+34j
		cmp	[ebp+Filename],	0
		jz	short loc_40633F
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40632B
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40632B
		mov	eax, 1
		jmp	short loc_406330
; ---------------------------------------------------------------------------

loc_40632B:				; CODE XREF: sub_406299+7Cj
					; sub_406299+89j
		mov	eax, 0

loc_406330:				; CODE XREF: sub_406299+90j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406346
		add	[ebp+Filename],	9
		jmp	short loc_406346
; ---------------------------------------------------------------------------

loc_40633F:				; CODE XREF: sub_406299+54j
		mov	[ebp+var_10], 0

loc_406346:				; CODE XREF: sub_406299+9Ej
					; sub_406299+A4j
		cmp	[ebp+var_10], 0
		jz	short loc_406382
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_4063DD
; ---------------------------------------------------------------------------

loc_406382:				; CODE XREF: sub_406299+B1j
		cmp	[ebp+Filename],	0
		jz	short loc_4063A1
		mov	eax, offset aA	; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_4063DD
; ---------------------------------------------------------------------------

loc_4063A1:				; CODE XREF: sub_406299+EDj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_4063B4
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_4063DD
; ---------------------------------------------------------------------------

loc_4063B4:				; CODE XREF: sub_406299+10Cj
		cmp	[ebp+FileHandle], 2
		jnz	short loc_4063C7
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_4063DD
; ---------------------------------------------------------------------------

loc_4063C7:				; CODE XREF: sub_406299+11Fj
		mov	[esp+28h+Size],	offset aA ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_4063DD:				; CODE XREF: sub_406299+E7j
					; sub_406299+106j ...
		mov	dword_40B18C, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jz	short loc_40642F
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_40642F
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_406425
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_406425
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_406425:				; CODE XREF: sub_406299+16Cj
					; sub_406299+17Dj
		mov	ds:File, 0

loc_40642F:				; CODE XREF: sub_406299+152j
					; sub_406299+15Bj
		cmp	[ebp+var_C], 0
		jnz	loc_4064BA
		cmp	[ebp+Filename],	0
		jz	short loc_406477
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_4064AD
; ---------------------------------------------------------------------------

loc_406477:				; CODE XREF: sub_406299+1A4j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_4064AD:				; CODE XREF: sub_406299+1DCj
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_4064DD
; ---------------------------------------------------------------------------

loc_4064BA:				; CODE XREF: sub_406299+19Aj
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_4064DD:				; CODE XREF: sub_406299+21Fj
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_406515
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_406515
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_406515
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_406515:				; CODE XREF: sub_406299+24Bj
					; sub_406299+25Cj ...
		mov	eax, [ebp+var_C]
		mov	ds:File, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_40E344, eax
		mov	ds:dword_40E348, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_406299	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406536(char *)
sub_406536	proc near		; CODE XREF: sub_4066F8+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_406547
		mov	eax, [ebp+arg_0]
		jmp	short loc_40654C
; ---------------------------------------------------------------------------

loc_406547:				; CODE XREF: sub_406536+Aj
		mov	eax, offset byte_40D23C

loc_40654C:				; CODE XREF: sub_406536+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_406299
		leave
		retn
sub_406536	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_406299
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_40E33C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406586(char *, int)
sub_406586	proc near		; CODE XREF: sub_401650+68p

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_4065B4
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset Dest ; Dest
		call	strncpy
		mov	ds:byte_40E32F,	0

loc_4065B4:				; CODE XREF: sub_406586+Aj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		mov	ds:dword_40E334, eax
		mov	eax, [ebp+arg_4]
		and	eax, 2
		mov	ds:dword_40E330, eax
		mov	eax, [ebp+arg_4]
		and	eax, 4
		mov	ds:dword_40E338, eax
		mov	eax, [ebp+arg_4]
		and	eax, 100h
		mov	ds:dword_40E340, eax
		leave
		retn
sub_406586	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4065E4	proc near		; CODE XREF: sub_401650+8Fp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_406656
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_40E334
		test	eax, eax
		jz	short loc_40660E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_40660E:				; CODE XREF: sub_4065E4+19j
		mov	eax, ds:dword_40E330
		test	eax, eax
		jz	short loc_406626
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_406626:				; CODE XREF: sub_4065E4+31j
		mov	eax, ds:dword_40E338
		test	eax, eax
		jz	short loc_40663E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_40663E:				; CODE XREF: sub_4065E4+49j
		mov	eax, ds:dword_40E340
		test	eax, eax
		jz	short loc_406656
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_406656:				; CODE XREF: sub_4065E4+7j
					; sub_4065E4+61j
		mov	eax, offset Dest
		pop	ebp
		retn
sub_4065E4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_406691
		mov	eax, ds:File
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_406691
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_406691
		mov	eax, 1
		jmp	short locret_4066B1
; ---------------------------------------------------------------------------

loc_406691:				; CODE XREF: .text:0040666Aj
					; .text:00406680j ...
		mov	eax, dword_40B18C
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4066AC
		mov	eax, dword_40B18C
		cmp	eax, [ebp+8]
		jnz	short loc_4066AC
		mov	eax, 1
		jmp	short locret_4066B1
; ---------------------------------------------------------------------------

loc_4066AC:				; CODE XREF: .text:00406699j
					; .text:004066A3j
		mov	eax, 0

locret_4066B1:				; CODE XREF: .text:0040668Fj
					; .text:004066AAj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4066B3	proc near		; CODE XREF: sub_401E06+13Dp
					; sub_401E06+147p

File		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4066CC
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_4066D1
; ---------------------------------------------------------------------------

loc_4066CC:				; CODE XREF: sub_4066B3+Dj
		mov	eax, ds:File

loc_4066D1:				; CODE XREF: sub_4066B3+17j
		mov	[esp+18h+File],	eax ; File
		call	_fileno
		leave
		retn
sub_4066B3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4066F1
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_4066F6
; ---------------------------------------------------------------------------

loc_4066F1:				; CODE XREF: .text:004066E5j
		mov	eax, ds:File

loc_4066F6:				; CODE XREF: .text:004066EFj
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4066F8(int, char *Format, va_list ArgList)
sub_4066F8	proc near		; CODE XREF: sub_406A85+22p
					; .text:00406AC8p ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_40673B
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_406536
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_40673B
		mov	[esp+58h+Count], 1BEh ;	int
		mov	[esp+58h+File],	offset a____Dirmngr1_2 ; "../../dirmngr-1.1.1/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_40AA40

loc_40673B:				; CODE XREF: sub_4066F8+10j
					; sub_4066F8+25j
		mov	eax, ds:dword_40E348
		test	eax, eax
		jz	short loc_40675F
		cmp	[ebp+arg_0], 1
		jz	short loc_40675F
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_40675F:				; CODE XREF: sub_4066F8+4Aj
					; sub_4066F8+50j
		mov	ds:dword_40E348, 0
		cmp	[ebp+arg_0], 1
		jz	loc_406902
		mov	eax, ds:dword_40E330
		test	eax, eax
		jz	loc_40680F
		mov	eax, ds:dword_40E344
		test	eax, eax
		jnz	loc_40680F
		mov	[esp+58h+var_58], 0
		call	sub_40AB10
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	sub_40AB20
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:File
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_40680F:				; CODE XREF: sub_4066F8+82j
					; sub_4066F8+8Fj
		mov	eax, ds:dword_40E334
		test	eax, eax
		jnz	short loc_406821
		mov	eax, ds:dword_40E344
		test	eax, eax
		jz	short loc_406838

loc_406821:				; CODE XREF: sub_4066F8+11Ej
		mov	edx, ds:File
		mov	eax, offset Dest
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_406838:				; CODE XREF: sub_4066F8+127j
		mov	eax, ds:dword_40E338
		test	eax, eax
		jnz	short loc_40684A
		mov	eax, ds:dword_40E344
		test	eax, eax
		jz	short loc_4068B0

loc_40684A:				; CODE XREF: sub_4066F8+147j
		call	_getpid
		mov	[ebp+var_20], eax
		mov	eax, ds:dword_40E33C
		test	eax, eax
		jz	short loc_406893
		mov	edx, ds:dword_40E33C
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_58], eax
		call	edx ; dword_40E33C
		test	eax, eax
		jz	short loc_406893
		mov	ecx, [ebp+var_28]
		mov	edx, offset aU_D ; "[%u.%d]"
		mov	eax, ds:File
		mov	[esp+58h+var_4C], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_4068B0
; ---------------------------------------------------------------------------

loc_406893:				; CODE XREF: sub_4066F8+161j
					; sub_4066F8+173j
		mov	edx, offset aU	; "[%u]"
		mov	eax, ds:File
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_4068B0:				; CODE XREF: sub_4066F8+150j
					; sub_4066F8+199j
		mov	eax, ds:dword_40E330
		test	eax, eax
		jz	short loc_4068C2
		mov	eax, ds:dword_40E344
		test	eax, eax
		jz	short loc_4068D7

loc_4068C2:				; CODE XREF: sub_4066F8+1BFj
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_4068D7:				; CODE XREF: sub_4066F8+1C8j
		cmp	[ebp+Format], 0
		jz	short loc_4068ED
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_4068ED
		add	[ebp+Format], 1
		jmp	short loc_406902
; ---------------------------------------------------------------------------

loc_4068ED:				; CODE XREF: sub_4066F8+1E3j
					; sub_4066F8+1EDj
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_406902:				; CODE XREF: sub_4066F8+75j
					; sub_4066F8+1F3j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_406996	; jumptable 00406919 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_40D36C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40691B:				; CODE XREF: sub_4066F8+221j
					; DATA XREF: .rdata:off_40D36Co
		mov	edx, ds:File	; jumptable 00406919 case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_4069B6
; ---------------------------------------------------------------------------

loc_406944:				; CODE XREF: sub_4066F8+221j
					; DATA XREF: .rdata:off_40D36Co
		mov	edx, ds:File	; jumptable 00406919 case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_4069B6
; ---------------------------------------------------------------------------

loc_40696D:				; CODE XREF: sub_4066F8+221j
					; DATA XREF: .rdata:off_40D36Co
		mov	edx, ds:File	; jumptable 00406919 case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_4069B6
; ---------------------------------------------------------------------------

loc_406996:				; CODE XREF: sub_4066F8+20Ej
		mov	edx, offset aUnknownLogLeve ; jumptable	00406919 default case
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_4069B6
; ---------------------------------------------------------------------------

loc_4069B5:				; CODE XREF: sub_4066F8+221j
					; DATA XREF: .rdata:off_40D36Co
		nop			; jumptable 00406919 cases 0-4

loc_4069B6:				; CODE XREF: sub_4066F8+24Aj
					; sub_4066F8+273j ...
		cmp	[ebp+Format], 0
		jz	short loc_406A17
		mov	eax, ds:File
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406A17
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_406A17
		mov	ds:dword_40E348, 1

loc_406A17:				; CODE XREF: sub_4066F8+2C2j
					; sub_4066F8+2E7j ...
		cmp	[ebp+arg_0], 5
		jnz	short loc_406A47
		mov	eax, ds:dword_40E348
		test	eax, eax
		jz	short loc_406A3B
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_406A3B:				; CODE XREF: sub_4066F8+32Cj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_406A47:				; CODE XREF: sub_4066F8+323j
		cmp	[ebp+arg_0], 6
		jnz	short loc_406A70
		mov	eax, ds:dword_40E348
		test	eax, eax
		jz	short loc_406A6B
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_406A6B:				; CODE XREF: sub_4066F8+35Cj
		call	abort
; ---------------------------------------------------------------------------

loc_406A70:				; CODE XREF: sub_4066F8+353j
		mov	eax, ds:File
		mov	[esp+58h+var_58], eax ;	File
		call	fflush
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4066F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406A85(int, char *, char)
sub_406A85	proc near		; CODE XREF: sub_406C88+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4066F8
		leave
		retn
sub_406A85	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4066F8
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406ACF(char *, char)
sub_406ACF	proc near		; CODE XREF: sub_401650+5F6p
					; sub_401650+654p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_4066F8
		leave
		retn
sub_406ACF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406AF9(char *, char)
sub_406AF9	proc near		; CODE XREF: sub_401650+35Bp
					; sub_401650+3ACp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_4066F8
		mov	eax, ds:dword_40E34C
		cmp	eax, 752Fh
		jg	short locret_406B3A
		mov	eax, ds:dword_40E34C
		add	eax, 1
		mov	ds:dword_40E34C, eax

locret_406B3A:				; CODE XREF: sub_406AF9+32j
		leave
		retn
sub_406AF9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_406B3C(char *, char)
sub_406B3C	proc near		; CODE XREF: sub_4044F4+22p

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 5 ; int
		call	sub_4066F8
		call	abort
sub_406B3C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_406B69(char *, char)
sub_406B69	proc near		; CODE XREF: sub_404664+7Ep

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_4066F8
		call	abort
sub_406B69	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406B96(char *, char)
sub_406B96	proc near		; CODE XREF: sub_403F7B+4Fp
					; sub_403F7B+99p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_4066F8
		leave
		retn
sub_406B96	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406BC0(char *, char)
sub_406BC0	proc near		; CODE XREF: .text:00406C39p
					; .text:00406C5Cp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4066F8
		leave
		retn
sub_406BC0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_406C19
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406C19
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40D38C
		call	sub_406B96

loc_406C19:				; CODE XREF: .text:00406BFAj
					; .text:00406C04j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_406C74
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_0 ; "%02X"
		call	sub_406BC0
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_406C65
; ---------------------------------------------------------------------------

loc_406C48:				; CODE XREF: .text:00406C72j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_1 ; " %02X"
		call	sub_406BC0
		add	dword ptr [ebp-0Ch], 1

loc_406C65:				; CODE XREF: .text:00406C46j
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_406C48

loc_406C74:				; CODE XREF: .text:00406C1Dj
		cmp	dword ptr [ebp+8], 0
		jz	short locret_406C86
		mov	dword ptr [esp], offset	asc_40D39B ; "\n"
		call	sub_406BC0

locret_406C86:				; CODE XREF: .text:00406C78j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_406C88	proc near		; CODE XREF: sub_4021B3+3B4p
					; sub_408986+6CCp

C		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+C], 6	; int
		call	sub_406A85
		call	abort
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	loc_406D8D
; ---------------------------------------------------------------------------

loc_406CE0:				; CODE XREF: sub_406C88+109j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0], eax	; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0], eax	; C
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_406D85
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		mov	[ebp+arg_4], eax
		sub	[ebp+var_14], 1
		add	[ebp+var_10], 1
		jmp	short loc_406D32
; ---------------------------------------------------------------------------

loc_406D26:				; CODE XREF: sub_406C88+DAj
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1
		sub	[ebp+var_14], 1

loc_406D32:				; CODE XREF: sub_406C88+9Cj
		cmp	[ebp+var_14], 0
		jz	short loc_406D64
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0], eax	; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0], eax	; C
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_406D26

loc_406D64:				; CODE XREF: sub_406C88+AEj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406D73
		mov	eax, [ebp+var_18]
		jmp	short loc_406D9C
; ---------------------------------------------------------------------------

loc_406D73:				; CODE XREF: sub_406C88+E4j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax

loc_406D85:				; CODE XREF: sub_406C88+82j
		add	[ebp+var_C], 1
		sub	[ebp+var_14], 1

loc_406D8D:				; CODE XREF: sub_406C88+53j
		cmp	[ebp+var_14], 0
		jnz	loc_406CE0
		mov	eax, 0

loc_406D9C:				; CODE XREF: sub_406C88+E9j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_406C88	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_406E6B
; ---------------------------------------------------------------------------

loc_406DC6:				; CODE XREF: .text:00406E6Fj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_407ADF
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_407ADF
		cmp	ebx, eax
		jnz	short loc_406E63
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_406E14
; ---------------------------------------------------------------------------

loc_406E08:				; CODE XREF: .text:00406E40j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_406E14:				; CODE XREF: .text:00406E06j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_406E42
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_407ADF
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_407ADF
		cmp	ebx, eax
		jz	short loc_406E08

loc_406E42:				; CODE XREF: .text:00406E18j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406E51
		mov	eax, [ebp-18h]
		jmp	short loc_406E7A
; ---------------------------------------------------------------------------

loc_406E51:				; CODE XREF: .text:00406E4Aj
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_406E63:				; CODE XREF: .text:00406DECj
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_406E6B:				; CODE XREF: .text:00406DC1j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_406DC6
		mov	eax, 0

loc_406E7A:				; CODE XREF: .text:00406E4Fj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_406EDF
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_406EA0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40452E
		mov	[ebp+8], eax

loc_406EA0:				; CODE XREF: .text:00406E90j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_406EC9
; ---------------------------------------------------------------------------

loc_406EB2:				; CODE XREF: .text:00406ED7j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_406EC9:				; CODE XREF: .text:00406EB0j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_406ED9
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406EB2

loc_406ED9:				; CODE XREF: .text:00406ECDj
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_406EDF:				; CODE XREF: .text:00406E8Aj
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406EE4	proc near		; CODE XREF: .text:00404B4Ep
					; .text:00404BF1p

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_406EFC
; ---------------------------------------------------------------------------

loc_406EF8:				; CODE XREF: sub_406EE4+37j
		add	[ebp+var_10], 1

loc_406EFC:				; CODE XREF: sub_406EE4+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406F1D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_406EF8

loc_406F1D:				; CODE XREF: sub_406EE4+20j
		mov	[ebp+var_14], 0
		jmp	short loc_406F5A
; ---------------------------------------------------------------------------

loc_406F26:				; CODE XREF: sub_406EE4+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_406F4B
		cmp	[ebp+var_14], 0
		jnz	short loc_406F52
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_406F52
; ---------------------------------------------------------------------------

loc_406F4B:				; CODE XREF: sub_406EE4+57j
		mov	[ebp+var_14], 0

loc_406F52:				; CODE XREF: sub_406EE4+5Dj
					; sub_406EE4+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_406F5A:				; CODE XREF: sub_406EE4+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406F26
		cmp	[ebp+var_14], 0
		jz	short loc_406F7B
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_406F7B:				; CODE XREF: sub_406EE4+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_406EE4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_406FC5
; ---------------------------------------------------------------------------

loc_406F95:				; CODE XREF: .text:00406FCDj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_406FBA
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_406FC1
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_406FC1
; ---------------------------------------------------------------------------

loc_406FBA:				; CODE XREF: .text:00406FAAj
		mov	dword ptr [ebp-10h], 0

loc_406FC1:				; CODE XREF: .text:00406FB0j
					; .text:00406FB8j
		add	dword ptr [ebp-0Ch], 1

loc_406FC5:				; CODE XREF: .text:00406F93j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406F95
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_406FDB
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_406FDB:				; CODE XREF: .text:00406FD3j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406FE0(int, int, char	*)
sub_406FE0	proc near		; CODE XREF: .text:00407077p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_407035
; ---------------------------------------------------------------------------

loc_406FFC:				; CODE XREF: sub_406FE0+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_407026
		cmp	[ebp+var_10], 0
		jnz	short loc_40702D
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_40702D
; ---------------------------------------------------------------------------

loc_407026:				; CODE XREF: sub_406FE0+36j
		mov	[ebp+var_10], 0

loc_40702D:				; CODE XREF: sub_406FE0+3Cj
					; sub_406FE0+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_407035:				; CODE XREF: sub_406FE0+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_406FFC
		cmp	[ebp+var_10], 0
		jz	short loc_407057
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_40705A
; ---------------------------------------------------------------------------

loc_407057:				; CODE XREF: sub_406FE0+61j
		mov	eax, [ebp+arg_4]

locret_40705A:				; CODE XREF: sub_406FE0+75j
		leave
		retn
sub_406FE0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_40D3BC ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406FE0
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40707E(int, int, char	*)
sub_40707E	proc near		; CODE XREF: .text:0040710Fp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4070D3
; ---------------------------------------------------------------------------

loc_40709A:				; CODE XREF: sub_40707E+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4070C4
		cmp	[ebp+var_10], 0
		jnz	short loc_4070CB
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_4070CB
; ---------------------------------------------------------------------------

loc_4070C4:				; CODE XREF: sub_40707E+36j
		mov	[ebp+var_10], 0

loc_4070CB:				; CODE XREF: sub_40707E+3Cj
					; sub_40707E+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_4070D3:				; CODE XREF: sub_40707E+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_40709A
		cmp	[ebp+var_10], 0
		jz	short loc_4070EF
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_4070F2
; ---------------------------------------------------------------------------

loc_4070EF:				; CODE XREF: sub_40707E+61j
		mov	eax, [ebp+arg_4]

locret_4070F2:				; CODE XREF: sub_40707E+6Fj
		leave
		retn
sub_40707E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_40D3BC ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40707E
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407145
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4045EF
		jmp	short locret_407153
; ---------------------------------------------------------------------------

loc_407145:				; CODE XREF: .text:00407136j
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_4045EF

locret_407153:				; CODE XREF: .text:00407143j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407185
		mov	dword ptr [esp], offset	a_ ; "."
		call	sub_4045EF
		jmp	short locret_4071CA
; ---------------------------------------------------------------------------

loc_407185:				; CODE XREF: .text:00407175j
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	sub_40452E
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_4071CA:				; CODE XREF: .text:00407183j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-20h]
		mov	[eax], edx
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp-0Ch], eax
		jmp	short loc_40722B
; ---------------------------------------------------------------------------

loc_407203:				; CODE XREF: .text:0040723Dj
		mov	eax, [ebp-18h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp-0Ch]
		add	eax, 1
		mov	[ebp-0Ch], eax

loc_40722B:				; CODE XREF: .text:00407201j
		mov	eax, [ebp-20h]
		lea	edx, [eax+4]
		mov	[ebp-20h], edx
		mov	eax, [eax]
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_407203
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	short loc_40729E
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40729E
		mov	dword ptr [esp], offset	aHome ;	"HOME"
		call	getenv
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40729E
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40729E
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-0Ch], eax

loc_40729E:				; CODE XREF: .text:0040724Ej
					; .text:0040725Bj ...
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_40452E
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_4072D8
		mov	eax, [ebp+8]
		lea	ebx, [eax+1]
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_407DEB
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_407DEB
		jmp	short loc_4072EA
; ---------------------------------------------------------------------------

loc_4072D8:				; CODE XREF: .text:004072B0j
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_407DEB

loc_4072EA:				; CODE XREF: .text:004072D6j
		mov	[ebp-14h], eax
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-20h]
		mov	[eax], edx
		jmp	short loc_407317
; ---------------------------------------------------------------------------

loc_4072F7:				; CODE XREF: .text:00407329j
		mov	eax, [ebp-14h]
		mov	word ptr [eax],	2Fh
		mov	eax, [ebp-14h]
		lea	edx, [eax+1]
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	[esp], edx
		call	sub_407DEB
		mov	[ebp-14h], eax

loc_407317:				; CODE XREF: .text:004072F5j
		mov	eax, [ebp-20h]
		lea	edx, [eax+4]
		mov	[ebp-20h], edx
		mov	eax, [eax]
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_4072F7
		mov	eax, [ebp-1Ch]
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strcmp
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40737D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40737D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4073D4
; ---------------------------------------------------------------------------

loc_40737D:				; CODE XREF: .text:0040735Dj
					; .text:00407367j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4073A5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4073A5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4073D4
; ---------------------------------------------------------------------------

loc_4073A5:				; CODE XREF: .text:00407385j
					; .text:0040738Fj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4073CD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4073CD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4073D4
; ---------------------------------------------------------------------------

loc_4073CD:				; CODE XREF: .text:004073ADj
					; .text:004073B7j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_407451
; ---------------------------------------------------------------------------

loc_4073D4:				; CODE XREF: .text:0040737Bj
					; .text:004073A3j ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4073FD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4073FD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_40744E
; ---------------------------------------------------------------------------

loc_4073FD:				; CODE XREF: .text:004073E0j
					; .text:004073EAj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_407422
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_407422
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_40744E
; ---------------------------------------------------------------------------

loc_407422:				; CODE XREF: .text:00407405j
					; .text:0040740Fj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_407447
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_407447
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_40744E
; ---------------------------------------------------------------------------

loc_407447:				; CODE XREF: .text:0040742Aj
					; .text:00407434j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_407451
; ---------------------------------------------------------------------------

loc_40744E:				; CODE XREF: .text:004073FBj
					; .text:00407420j ...
		mov	eax, [ebp-4]

locret_407451:				; CODE XREF: .text:004073D2j
					; .text:0040744Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407453(FILE *, int, int, int,	int)
sub_407453	proc near		; CODE XREF: sub_407616+29p
					; .text:00407753p

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_407607
; ---------------------------------------------------------------------------

loc_40746B:				; CODE XREF: sub_407453+1B8j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4074C3
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jbe	short loc_407489
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9Fh
		jbe	short loc_4074C3

loc_407489:				; CODE XREF: sub_407453+2Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_4074C3
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_4074C3
		cmp	[ebp+arg_C], 0
		jnz	short loc_4074B5
		cmp	[ebp+arg_10], 0
		jz	loc_4075DF

loc_4074B5:				; CODE XREF: sub_407453+56j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4075DF

loc_4074C3:				; CODE XREF: sub_407453+20j
					; sub_407453+34j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_407500
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4075FB
; ---------------------------------------------------------------------------

loc_407500:				; CODE XREF: sub_407453+8Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_407526
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4075FB
; ---------------------------------------------------------------------------

loc_407526:				; CODE XREF: sub_407453+B5j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_40754C
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4075FB
; ---------------------------------------------------------------------------

loc_40754C:				; CODE XREF: sub_407453+DBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_407572
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4075FB
; ---------------------------------------------------------------------------

loc_407572:				; CODE XREF: sub_407453+101j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_407595
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4075FB
; ---------------------------------------------------------------------------

loc_407595:				; CODE XREF: sub_407453+127j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4075B8
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4075FB
; ---------------------------------------------------------------------------

loc_4075B8:				; CODE XREF: sub_407453+14Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_4075FB
; ---------------------------------------------------------------------------

loc_4075DF:				; CODE XREF: sub_407453+5Cj
					; sub_407453+6Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_4075FB:				; CODE XREF: sub_407453+A8j
					; sub_407453+CEj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_407607:				; CODE XREF: sub_407453+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_40746B
		mov	eax, [ebp+var_10]
		leave
		retn
sub_407453	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407616(FILE *, int, int, int)
sub_407616	proc near		; CODE XREF: sub_407646+B7p
					; .text:004077A9p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_407453
		leave
		retn
sub_407616	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407646(FILE *, int, int, int)
sub_407646	proc near		; CODE XREF: .text:004077FFp

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40766F
; ---------------------------------------------------------------------------

loc_40765C:				; CODE XREF: sub_407646+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_407679
		add	[ebp+var_C], 1

loc_40766F:				; CODE XREF: sub_407646+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_40765C
		jmp	short loc_40767A
; ---------------------------------------------------------------------------

loc_407679:				; CODE XREF: sub_407646+23j
		nop

loc_40767A:				; CODE XREF: sub_407646+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_4076E2
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_40915C
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; void *
		call	sub_404649
		mov	eax, [ebp+var_C]
		jmp	short loc_407702
; ---------------------------------------------------------------------------

loc_4076E2:				; CODE XREF: sub_407646+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_407616

loc_407702:				; CODE XREF: sub_407646+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_407646	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40775A
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407453
		jmp	short loc_40775F
; ---------------------------------------------------------------------------

loc_40775A:				; CODE XREF: .text:00407713j
		mov	eax, 0

loc_40775F:				; CODE XREF: .text:00407758j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4077B0
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407616
		jmp	short loc_4077B5
; ---------------------------------------------------------------------------

loc_4077B0:				; CODE XREF: .text:00407770j
		mov	eax, 0

loc_4077B5:				; CODE XREF: .text:004077AEj
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_407806
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407646
		jmp	short loc_40780B
; ---------------------------------------------------------------------------

loc_407806:				; CODE XREF: .text:004077C6j
		mov	eax, 0

loc_40780B:				; CODE XREF: .text:00407804j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 1
		jmp	loc_4078BB
; ---------------------------------------------------------------------------

loc_407835:				; CODE XREF: .text:004078BFj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_407867
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_407867
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_407867
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_4078AF
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4078AF

loc_407867:				; CODE XREF: .text:0040783Dj
					; .text:00407847j ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4078A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_4078A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_4078A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_4078A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_4078A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4078A9

loc_4078A3:				; CODE XREF: .text:0040786Fj
					; .text:00407879j ...
		add	dword ptr [ebp-10h], 2
		jmp	short loc_4078B3
; ---------------------------------------------------------------------------

loc_4078A9:				; CODE XREF: .text:004078A1j
		add	dword ptr [ebp-10h], 5
		jmp	short loc_4078B3
; ---------------------------------------------------------------------------

loc_4078AF:				; CODE XREF: .text:0040785Bj
					; .text:00407865j
		add	dword ptr [ebp-10h], 1

loc_4078B3:				; CODE XREF: .text:004078A7j
					; .text:004078ADj
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_4078BB:				; CODE XREF: .text:00407830j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_407835
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-18h]
		mov	[ebp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40452E
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-14h], eax
		jmp	loc_4079F8
; ---------------------------------------------------------------------------

loc_4078EA:				; CODE XREF: .text:004079FCj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_407924
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_407924
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_407924
		cmp	dword ptr [ebp+10h], 0
		jz	loc_4079DF
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4079DF

loc_407924:				; CODE XREF: .text:004078F2j
					; .text:004078FCj ...
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_407947
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	6Eh
		add	dword ptr [ebp-14h], 1
		jmp	loc_4079F0
; ---------------------------------------------------------------------------

loc_407947:				; CODE XREF: .text:00407936j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_407960
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	72h
		add	dword ptr [ebp-14h], 1
		jmp	loc_4079F0
; ---------------------------------------------------------------------------

loc_407960:				; CODE XREF: .text:0040794Fj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_407976
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	66h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_4079F0
; ---------------------------------------------------------------------------

loc_407976:				; CODE XREF: .text:00407968j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_40798C
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	76h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_4079F0
; ---------------------------------------------------------------------------

loc_40798C:				; CODE XREF: .text:0040797Ej
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_4079A2
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	62h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_4079F0
; ---------------------------------------------------------------------------

loc_4079A2:				; CODE XREF: .text:00407994j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4079B8
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	30h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_4079F0
; ---------------------------------------------------------------------------

loc_4079B8:				; CODE XREF: .text:004079AAj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sprintf
		add	dword ptr [ebp-14h], 3
		jmp	short loc_4079F0
; ---------------------------------------------------------------------------

loc_4079DF:				; CODE XREF: .text:00407910j
					; .text:0040791Ej
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1

loc_4079F0:				; CODE XREF: .text:00407942j
					; .text:0040795Bj ...
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_4079F8:				; CODE XREF: .text:004078E5j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_4078EA
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_407A39
; ---------------------------------------------------------------------------

loc_407A1C:				; CODE XREF: .text:00407A41j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_407A35
		add	dword ptr [ebp-4], 1

loc_407A35:				; CODE XREF: .text:00407A2Fj
		add	dword ptr [ebp+8], 1

loc_407A39:				; CODE XREF: .text:00407A1Aj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407A1C
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407A48(DWORD)
sub_407A48	proc near		; CODE XREF: sub_403F7B+3Fp

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_407A5E
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_407A5E:				; CODE XREF: sub_407A48+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_407A48	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_407ABB
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_407ABB
		mov	eax, 1
		jmp	short loc_407AC0
; ---------------------------------------------------------------------------

loc_407ABB:				; CODE XREF: .text:00407AACj
					; .text:00407AB2j
		mov	eax, 0

loc_407AC0:				; CODE XREF: .text:00407AB9j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_407AD8
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_407AD8
		mov	eax, 1
		jmp	short loc_407ADD
; ---------------------------------------------------------------------------

loc_407AD8:				; CODE XREF: .text:00407AC9j
					; .text:00407ACFj
		mov	eax, 0

loc_407ADD:				; CODE XREF: .text:00407AD6j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407ADF	proc near		; CODE XREF: .text:00406DD2p
					; .text:00406DE5p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_407AF2
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_407AF2
		and	[ebp+arg_0], 0FFFFFFDFh

loc_407AF2:				; CODE XREF: sub_407ADF+7j
					; sub_407ADF+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_407ADF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407AF7	proc near		; CODE XREF: .text:00407BFCp
					; .text:00407C10p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_407B0A
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_407B0A
		or	[ebp+arg_0], 20h

loc_407B0A:				; CODE XREF: sub_407AF7+7j
					; sub_407AF7+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_407AF7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407B0F	proc near		; CODE XREF: .text:00408550p
					; .text:00408567p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_407B6A
		mov	eax, 0
		jmp	loc_407BC3
; ---------------------------------------------------------------------------

loc_407B28:				; CODE XREF: sub_407B0F+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_407B60
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_407ADF
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_407ADF
		cmp	ebx, eax
		jnz	short loc_407B81

loc_407B60:				; CODE XREF: sub_407B0F+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_407B6B
; ---------------------------------------------------------------------------

loc_407B6A:				; CODE XREF: sub_407B0F+Dj
		nop

loc_407B6B:				; CODE XREF: sub_407B0F+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407B82
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407B28
		jmp	short loc_407B82
; ---------------------------------------------------------------------------

loc_407B81:				; CODE XREF: sub_407B0F+4Fj
		nop

loc_407B82:				; CODE XREF: sub_407B0F+64j
					; sub_407B0F+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_407BBE
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_407ADF
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_407ADF
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_407BC3
; ---------------------------------------------------------------------------

loc_407BBE:				; CODE XREF: sub_407B0F+81j
		mov	eax, 0

loc_407BC3:				; CODE XREF: sub_407B0F+14j
					; sub_407B0F+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_407B0F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_407BE9
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_407BF0

loc_407BE9:				; CODE XREF: .text:00407BE1j
		mov	eax, 0
		jmp	short locret_407C47
; ---------------------------------------------------------------------------

loc_407BF0:				; CODE XREF: .text:00407BE7j
					; .text:00407C37j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_407AF7
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_407AF7
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_407C39
		cmp	byte ptr [ebp-9], 0
		jz	short loc_407C39
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_407BF0

loc_407C39:				; CODE XREF: .text:00407C20j
					; .text:00407C26j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_407C47:				; CODE XREF: .text:00407BEEj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407C49	proc near		; CODE XREF: .text:00407DCAp
					; .text:00408513p

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_407CF9
		mov	eax, 0
		jmp	loc_407D08
; ---------------------------------------------------------------------------

loc_407C72:				; CODE XREF: sub_407C49+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_407CED
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_407ADF
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_407ADF
		cmp	ebx, eax
		jz	short loc_407CED
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_407CE6
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_407ADF
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_407ADF
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_407CEB
; ---------------------------------------------------------------------------

loc_407CE6:				; CODE XREF: sub_407C49+6Fj
		mov	eax, 0

loc_407CEB:				; CODE XREF: sub_407C49+9Bj
		jmp	short loc_407D08
; ---------------------------------------------------------------------------

loc_407CED:				; CODE XREF: sub_407C49+37j
					; sub_407C49+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_407CF9:				; CODE XREF: sub_407C49+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_407C72
		mov	eax, 0

loc_407D08:				; CODE XREF: sub_407C49+24j
					; sub_407C49:loc_407CEBj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_407C49	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_407D3A
		mov	eax, 0
		jmp	short loc_407D81
; ---------------------------------------------------------------------------

loc_407D20:				; CODE XREF: .text:00407D4Dj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_407D51
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_407D3B
; ---------------------------------------------------------------------------

loc_407D3A:				; CODE XREF: .text:00407D17j
		nop

loc_407D3B:				; CODE XREF: .text:00407D38j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407D52
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407D20
		jmp	short loc_407D52
; ---------------------------------------------------------------------------

loc_407D51:				; CODE XREF: .text:00407D2Ej
		nop

loc_407D52:				; CODE XREF: .text:00407D43j
					; .text:00407D4Fj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_407D7C
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_407D81
; ---------------------------------------------------------------------------

loc_407D7C:				; CODE XREF: .text:00407D60j
		mov	eax, 0

loc_407D81:				; CODE XREF: .text:00407D1Ej
					; .text:00407D7Aj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_407D94
		mov	eax, [ebp+8]
		jmp	short locret_407DE9
; ---------------------------------------------------------------------------

loc_407D94:				; CODE XREF: .text:00407D8Dj
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_407DE4
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_407DDC
; ---------------------------------------------------------------------------

loc_407DB6:				; CODE XREF: .text:00407DE2j
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_407C49
		test	eax, eax
		jnz	short loc_407DD8
		mov	eax, [ebp-4]
		jmp	short locret_407DE9
; ---------------------------------------------------------------------------

loc_407DD8:				; CODE XREF: .text:00407DD1j
		add	dword ptr [ebp-4], 1

loc_407DDC:				; CODE XREF: .text:00407DB4j
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_407DB6

loc_407DE4:				; CODE XREF: .text:00407D9Aj
		mov	eax, 0

locret_407DE9:				; CODE XREF: .text:00407D92j
					; .text:00407DD6j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407DEB	proc near		; CODE XREF: .text:00403D7Cp
					; sub_403DAF+99p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_407E03
; ---------------------------------------------------------------------------

loc_407DF0:				; CODE XREF: sub_407DEB+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_407E03:				; CODE XREF: sub_407DEB+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407DF0
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_407DEB	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_407E36
		mov	eax, 0
		jmp	locret_407EE1
; ---------------------------------------------------------------------------

loc_407E36:				; CODE XREF: .text:00407E2Aj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407E4D
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407EA6

loc_407E4D:				; CODE XREF: .text:00407E3Ej
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_407E65
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_407EBB
; ---------------------------------------------------------------------------

loc_407E65:				; CODE XREF: .text:00407E5Aj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_407E78
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_407EBB
; ---------------------------------------------------------------------------

loc_407E78:				; CODE XREF: .text:00407E6Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407E8B
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_407EBB
; ---------------------------------------------------------------------------

loc_407E8B:				; CODE XREF: .text:00407E80j
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_407EBB
; ---------------------------------------------------------------------------

loc_407EA6:				; CODE XREF: .text:00407E4Bj
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_407EBB:				; CODE XREF: .text:00407E63j
					; .text:00407E76j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_407ED5
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_407EDE
; ---------------------------------------------------------------------------

loc_407ED5:				; CODE XREF: .text:00407EBFj
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_407EDE:				; CODE XREF: .text:00407ED3j
		mov	eax, [ebp-10h]

locret_407EE1:				; CODE XREF: .text:00407E31j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+10h]
		add	[ebp-4], eax
		jmp	short loc_407F12
; ---------------------------------------------------------------------------

loc_407EF7:				; CODE XREF: .text:00407F16j
		sub	dword ptr [ebp-4], 1
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+0Ch]
		jnz	short loc_407F0E
		mov	eax, [ebp-4]
		jmp	short locret_407F1D
; ---------------------------------------------------------------------------

loc_407F0E:				; CODE XREF: .text:00407F07j
		sub	dword ptr [ebp+10h], 1

loc_407F12:				; CODE XREF: .text:00407EF5j
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_407EF7
		mov	eax, 0

locret_407F1D:				; CODE XREF: .text:00407F0Cj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_407F35
		mov	eax, 0
		jmp	locret_408104
; ---------------------------------------------------------------------------

loc_407F35:				; CODE XREF: .text:00407F29j
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_407F8B
; ---------------------------------------------------------------------------

loc_407F44:				; CODE XREF: .text:00407F96j
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_407F83
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_407F83
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_407F87
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_407F87

loc_407F83:				; CODE XREF: .text:00407F4Fj
					; .text:00407F5Cj
		add	dword ptr [ebp-10h], 1

loc_407F87:				; CODE XREF: .text:00407F62j
					; .text:00407F81j
		add	dword ptr [ebp-0Ch], 1

loc_407F8B:				; CODE XREF: .text:00407F42j
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407F44
		mov	eax, [ebp-10h]
		add	eax, eax
		add	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_40452E
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_4080EA
; ---------------------------------------------------------------------------

loc_407FBA:				; CODE XREF: .text:004080F2j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_407FF0
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	25h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	33h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	61h
		add	dword ptr [ebp-0Ch], 1
		jmp	loc_4080E6
; ---------------------------------------------------------------------------

loc_407FF0:				; CODE XREF: .text:00407FC2j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_408026
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	25h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	32h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	35h
		add	dword ptr [ebp-0Ch], 1
		jmp	loc_4080E6
; ---------------------------------------------------------------------------

loc_408026:				; CODE XREF: .text:00407FF8j
		cmp	dword ptr [ebp+0Ch], 0
		jz	loc_4080D4
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	loc_4080D4
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	25h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		add	edx, [ebp-14h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_408087
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_408093
; ---------------------------------------------------------------------------

loc_408087:				; CODE XREF: .text:00408077j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_408093:				; CODE XREF: .text:00408085j
		mov	[edx], al
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		add	edx, [ebp-14h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4080C0
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_4080CC
; ---------------------------------------------------------------------------

loc_4080C0:				; CODE XREF: .text:004080B0j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_4080CC:				; CODE XREF: .text:004080BEj
		mov	[edx], al
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_4080E6
; ---------------------------------------------------------------------------

loc_4080D4:				; CODE XREF: .text:0040802Aj
					; .text:0040804Aj
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	edx, [ebp+8]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_4080E6:				; CODE XREF: .text:00407FEBj
					; .text:00408021j ...
		add	dword ptr [ebp+8], 1

loc_4080EA:				; CODE XREF: .text:00407FB5j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_407FBA
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_408104:				; CODE XREF: .text:00407F30j
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408108(LPCSTR)
sub_408108	proc near		; CODE XREF: sub_4081C2+2Cp

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408108	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408126(HMODULE, LPCSTR)
sub_408126	proc near		; CODE XREF: sub_4081C2+48p
					; sub_4081C2+69p ...

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_408164
		cmp	[ebp+arg_4], 0
		jz	short loc_408164
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40815F
		mov	eax, 0
		jmp	short locret_408169
; ---------------------------------------------------------------------------

loc_40815F:				; CODE XREF: sub_408126+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_408169
; ---------------------------------------------------------------------------

loc_408164:				; CODE XREF: sub_408126+Aj
					; sub_408126+10j
		mov	eax, 0

locret_408169:				; CODE XREF: sub_408126+37j
					; sub_408126+3Cj
		leave
		retn
sub_408126	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40816B	proc near		; CODE XREF: sub_4081C2:loc_408265p

Dest		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, offset aEcLu ; "ec=%lu"
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+Format], edx ;	Format
		mov	[esp+18h+Dest],	offset byte_40E4C0 ; Dest
		call	sprintf
		mov	eax, offset byte_40E4C0
		leave
		retn
sub_40816B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408198(HANDLE)
sub_408198	proc near		; CODE XREF: sub_4081C2+F6p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_4081BB
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_4081C0
; ---------------------------------------------------------------------------

loc_4081BB:				; CODE XREF: sub_408198+Aj
		mov	eax, 0FFFFFFFFh

locret_4081C0:				; CODE XREF: sub_408198+21j
		leave
		retn
sub_408198	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4081C2	proc near		; CODE XREF: .text:loc_408626p
					; .text:0040918Cp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_40E4AC
		test	eax, eax
		jnz	loc_4082BD
		mov	ds:dword_40E4AC, 1
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset aIconv_dll ; "iconv.dll"
		call	sub_408108
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408256
		mov	[esp+28h+var_24], offset aLibiconv_open	; "libiconv_open"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HMODULE
		call	sub_408126
		mov	ds:dword_40E46C, eax
		mov	eax, ds:dword_40E46C
		test	eax, eax
		jz	short loc_408235
		mov	[esp+28h+var_24], offset aLibiconv ; "libiconv"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HMODULE
		call	sub_408126
		mov	ds:dword_40E470, eax

loc_408235:				; CODE XREF: sub_4081C2+59j
		mov	eax, ds:dword_40E470
		test	eax, eax
		jz	short loc_408256
		mov	[esp+28h+var_24], offset aLibiconv_close ; "libiconv_close"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HMODULE
		call	sub_408126
		mov	ds:dword_40E474, eax

loc_408256:				; CODE XREF: sub_4081C2+38j
					; sub_4081C2+7Aj
		cmp	[ebp+var_C], 0
		jz	short loc_408265
		mov	eax, ds:dword_40E474
		test	eax, eax
		jnz	short loc_4082BD

loc_408265:				; CODE XREF: sub_4081C2+98j
		call	sub_40816B
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], offset aIconv_dll ; "iconv.dll"
		mov	[esp+28h+var_28], offset aErrorLoadingSS ; "error loading `%s': %s\n"
		call	sub_406ACF
		mov	[esp+28h+var_28], offset aPleaseSeeHttpW ; "please see http://www.gnupg.org/downloa"...
		call	sub_406ACF
		mov	ds:dword_40E46C, 0
		mov	ds:dword_40E470, 0
		mov	ds:dword_40E474, 0
		cmp	[ebp+var_C], 0
		jz	short loc_4082BD
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HANDLE
		call	sub_408198

loc_4082BD:				; CODE XREF: sub_4081C2+Dj
					; sub_4081C2+A1j ...
		mov	eax, ds:dword_40E46C
		test	eax, eax
		jz	short loc_4082CD
		mov	eax, 0
		jmp	short locret_4082D2
; ---------------------------------------------------------------------------

loc_4082CD:				; CODE XREF: sub_4081C2+102j
		mov	eax, 0FFFFFFFFh

locret_4082D2:				; CODE XREF: sub_4081C2+109j
		leave
		retn
sub_4081C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4082D4	proc near		; CODE XREF: .text:00408671p
					; .text:004086C9p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_408360
		cmp	[ebp+arg_0], 0
		jz	short loc_40832C
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40832C
		mov	eax, ds:dword_40E4A0
		mov	[ebp+var_C], eax
		mov	ds:dword_40E4A0, 1
		jmp	short loc_40833E
; ---------------------------------------------------------------------------

loc_40832C:				; CODE XREF: sub_4082D4+1Aj
					; sub_4082D4+42j
		mov	eax, ds:dword_40E4A4
		mov	[ebp+var_C], eax
		mov	ds:dword_40E4A4, 1

loc_40833E:				; CODE XREF: sub_4082D4+56j
		cmp	[ebp+var_C], 0
		jnz	short loc_408394
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_406ACF
		jmp	short loc_408394
; ---------------------------------------------------------------------------

loc_408360:				; CODE XREF: sub_4082D4+14j
		mov	eax, ds:dword_40E4A8
		test	eax, eax
		jnz	short loc_40838A
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_406ACF

loc_40838A:				; CODE XREF: sub_4082D4+93j
		mov	ds:dword_40E4A8, 1

loc_408394:				; CODE XREF: sub_4082D4+6Ej
					; sub_4082D4+8Aj
		cmp	[ebp+arg_8], 0
		jz	short loc_4083C2
		mov	off_40B190, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_40E464, 0
		mov	ds:dword_40E460, 0
		mov	ds:dword_40E468, 0

loc_4083C2:				; CODE XREF: sub_4082D4+C4j
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4082D4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jnz	loc_4084D3
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4083F4
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp-0Ch], eax

loc_4083F4:				; CODE XREF: .text:004083E8j
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp-0Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40E480
		call	sprintf
		mov	dword ptr [ebp+8], offset dword_40E480
		mov	dword ptr [ebp-10h], offset aCp936 ; "CP936"
		jmp	loc_4084C5
; ---------------------------------------------------------------------------

loc_408423:				; CODE XREF: .text:004084CDj
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40E480
		call	strcmp
		test	eax, eax
		jz	short loc_408451
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_40847B
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40847B

loc_408451:				; CODE XREF: .text:00408438j
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp-10h]
		mov	[ebp+8], eax
		jmp	short loc_4084D3
; ---------------------------------------------------------------------------

loc_40847B:				; CODE XREF: .text:00408442j
					; .text:0040844Fj
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax

loc_4084C5:				; CODE XREF: .text:0040841Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_408423

loc_4084D3:				; CODE XREF: .text:004083D4j
					; .text:00408479j
		mov	eax, [ebp+8]
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_408538
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], offset aIso ; "iso"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407C49
		test	eax, eax
		jnz	short loc_408538
		add	dword ptr [ebp+8], 3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_408534
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_408538

loc_408534:				; CODE XREF: .text:00408528j
		add	dword ptr [ebp+8], 1

loc_408538:				; CODE XREF: .text:004084FBj
					; .text:0040851Aj ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40859E
		mov	dword ptr [esp+4], offset a88591 ; "8859-1"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407B0F
		test	eax, eax
		jz	short loc_40859E
		mov	dword ptr [esp+4], offset a646 ; "646"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407B0F
		test	eax, eax
		jz	short loc_40859E
		mov	dword ptr [esp+4], offset aAscii ; "ASCII"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407B0F
		test	eax, eax
		jz	short loc_40859E
		mov	dword ptr [esp+4], offset aAnsi_x3_41968 ; "ANSI_X3.4-1968"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407B0F
		test	eax, eax
		jnz	short loc_4085CB

loc_40859E:				; CODE XREF: .text:00408540j
					; .text:00408557j ...
		mov	off_40B190, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_40E464, 0
		mov	ds:dword_40E460, 0
		mov	ds:dword_40E468, 0
		jmp	loc_40870C
; ---------------------------------------------------------------------------

loc_4085CB:				; CODE XREF: .text:0040859Cj
		mov	dword ptr [esp+4], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407B0F
		test	eax, eax
		jz	short loc_4085F9
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407B0F
		test	eax, eax
		jnz	short loc_408626

loc_4085F9:				; CODE XREF: .text:004085E0j
		mov	off_40B190, offset aUtf8 ; "utf-8"
		mov	ds:dword_40E464, 1
		mov	ds:dword_40E460, 0
		mov	ds:dword_40E468, 0
		jmp	loc_40870C
; ---------------------------------------------------------------------------

loc_408626:				; CODE XREF: .text:004085F7j
		call	sub_4081C2
		test	eax, eax
		jz	short loc_408639
		mov	eax, 0FFFFFFFFh
		jmp	loc_408711
; ---------------------------------------------------------------------------

loc_408639:				; CODE XREF: .text:0040862Dj
		mov	edx, ds:dword_40E46C
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	edx ; dword_40E46C
		sub	esp, 8
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_408680
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_4082D4
		mov	eax, 0FFFFFFFFh
		jmp	loc_408711
; ---------------------------------------------------------------------------

loc_408680:				; CODE XREF: .text:00408659j
		mov	edx, ds:dword_40E474
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	edx ; dword_40E474
		sub	esp, 4
		mov	edx, ds:dword_40E46C
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	edx ; dword_40E46C
		sub	esp, 8
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_4086D5
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	sub_4082D4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_408711
; ---------------------------------------------------------------------------

loc_4086D5:				; CODE XREF: .text:004086B1j
		mov	edx, ds:dword_40E474
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	edx ; dword_40E474
		sub	esp, 4
		mov	eax, [ebp-14h]
		mov	off_40B190, eax
		mov	ds:dword_40E464, 0
		mov	ds:dword_40E460, 0
		mov	ds:dword_40E468, 1

loc_40870C:				; CODE XREF: .text:004085C6j
					; .text:00408621j
		mov	eax, 0

loc_408711:				; CODE XREF: .text:00408634j
					; .text:0040867Bj ...
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_40B190
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408720	proc near		; CODE XREF: sub_405967+43p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_40E464
		pop	ebp
		retn
sub_408720	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40872A(char *)
sub_40872A	proc near		; CODE XREF: sub_40872A+13Ap

Dest		= dword	ptr -68h
Source		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	eax, ds:dword_40E464
		test	eax, eax
		jz	short loc_40875A
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Dest],	eax ; char *
		call	sub_4045EF
		mov	[ebp+var_10], eax
		jmp	loc_40897E
; ---------------------------------------------------------------------------

loc_40875A:				; CODE XREF: sub_40872A+1Bj
		mov	eax, ds:dword_40E460
		test	eax, eax
		jnz	loc_40881D
		mov	eax, ds:dword_40E468
		test	eax, eax
		jnz	loc_40881D
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_408792
; ---------------------------------------------------------------------------

loc_40877C:				; CODE XREF: sub_40872A+70j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40878E
		add	[ebp+var_18], 1

loc_40878E:				; CODE XREF: sub_40872A+5Ej
		add	[ebp+var_C], 1

loc_408792:				; CODE XREF: sub_40872A+50j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40877C
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[esp+68h+Dest],	eax ; size_t
		call	sub_40452E
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_408808
; ---------------------------------------------------------------------------

loc_4087BB:				; CODE XREF: sub_40872A+E6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4087F5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	short loc_408804
; ---------------------------------------------------------------------------

loc_4087F5:				; CODE XREF: sub_40872A+99j
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1

loc_408804:				; CODE XREF: sub_40872A+C9j
		add	[ebp+var_C], 1

loc_408808:				; CODE XREF: sub_40872A+8Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4087BB
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		jmp	loc_40897E
; ---------------------------------------------------------------------------

loc_40881D:				; CODE XREF: sub_40872A+37j
					; sub_40872A+44j
		mov	edx, ds:dword_40E46C
		mov	eax, off_40B190
		mov	[esp+68h+Source], eax
		mov	[esp+68h+Dest],	offset aUtf8 ; "utf-8"
		call	edx ; dword_40E46C
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_40886E
		mov	eax, off_40B190
		mov	[esp+68h+var_60], 1
		mov	[esp+68h+Source], eax
		mov	[esp+68h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_4082D4
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Dest],	eax ; char *
		call	sub_40872A
		jmp	loc_408981
; ---------------------------------------------------------------------------

loc_40886E:				; CODE XREF: sub_40872A+115j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_40888C
; ---------------------------------------------------------------------------

loc_408876:				; CODE XREF: sub_40872A+16Aj
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_408888
		add	[ebp+var_18], 5

loc_408888:				; CODE XREF: sub_40872A+158j
		add	[ebp+var_C], 1

loc_40888C:				; CODE XREF: sub_40872A+14Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408876
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[esp+68h+Dest],	eax ; size_t
		call	sub_40452E
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_30], eax
		mov	edx, ds:dword_40E470
		lea	eax, [ebp+var_30]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_60], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+Source], eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dest],	eax
		call	edx ; dword_40E470
		sub	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_408967
		mov	eax, ds:dword_40E47C
		test	eax, eax
		jnz	short loc_408949
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+68h+Dest],	eax ; int
		call	strerror
		mov	edx, off_40B190
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], offset aUtf8 ; "utf-8"
		mov	[esp+68h+Source], edx ;	char
		mov	[esp+68h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_406ACF

loc_408949:				; CODE XREF: sub_40872A+1EAj
		mov	ds:dword_40E47C, 1
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Source], eax ;	Source
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_40896D
; ---------------------------------------------------------------------------

loc_408967:				; CODE XREF: sub_40872A+1E1j
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_40896D:				; CODE XREF: sub_40872A+23Bj
		mov	edx, ds:dword_40E474
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dest],	eax
		call	edx ; dword_40E474
		sub	esp, 4

loc_40897E:				; CODE XREF: sub_40872A+2Bj
					; sub_40872A+EEj
		mov	eax, [ebp+var_10]

loc_408981:				; CODE XREF: sub_40872A+13Fj
		mov	edi, [ebp+var_4]
		leave
		retn
sub_40872A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408986	proc near		; CODE XREF: sub_408986+79Ap
					; sub_40915C+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 88h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_4089AB:				; CODE XREF: sub_408986+5EEj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_408F4D
; ---------------------------------------------------------------------------

loc_4089D0:				; CODE XREF: sub_408986+5CBj
		cmp	[ebp+var_30], 0
		jz	short loc_408A2F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_408A28
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_4089F4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_408A28

loc_4089F4:				; CODE XREF: sub_408986+62j
		cmp	[ebp+var_24], 0
		jz	short loc_408A1F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_408A1F:				; CODE XREF: sub_408986+72j
		add	[ebp+var_1C], 4
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408A28:				; CODE XREF: sub_408986+58j
					; sub_408986+6Cj
		mov	[ebp+var_30], 0

loc_408A2F:				; CODE XREF: sub_408986+4Ej
		cmp	[ebp+var_C], 0
		jnz	loc_408D62
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_408BBA
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_408B9A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_408A8B
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_408A8B
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_408A8B
		cmp	[ebp+arg_8], 0
		jz	loc_408B9A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_408B9A

loc_408A8B:				; CODE XREF: sub_408986+D3j
					; sub_408986+DDj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_408A9F
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_408A9F:				; CODE XREF: sub_408986+10Dj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_408B50	; jumptable 00408AB8 default case
		mov	eax, ds:off_40D660[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_408ABA:				; CODE XREF: sub_408986+132j
					; DATA XREF: .rdata:off_40D660o
		add	[ebp+var_1C], 1	; jumptable 00408AB8 case 10
		cmp	[ebp+var_24], 0
		jz	loc_408B81
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_408B81
; ---------------------------------------------------------------------------

loc_408AD7:				; CODE XREF: sub_408986+132j
					; DATA XREF: .rdata:off_40D660o
		add	[ebp+var_1C], 1	; jumptable 00408AB8 case 13
		cmp	[ebp+var_24], 0
		jz	loc_408B84
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_408B84
; ---------------------------------------------------------------------------

loc_408AF4:				; CODE XREF: sub_408986+132j
					; DATA XREF: .rdata:off_40D660o
		add	[ebp+var_1C], 1	; jumptable 00408AB8 case 12
		cmp	[ebp+var_24], 0
		jz	loc_408B87
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_408B87
; ---------------------------------------------------------------------------

loc_408B0E:				; CODE XREF: sub_408986+132j
					; DATA XREF: .rdata:off_40D660o
		add	[ebp+var_1C], 1	; jumptable 00408AB8 case 11
		cmp	[ebp+var_24], 0
		jz	short loc_408B8A
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_408B8A
; ---------------------------------------------------------------------------

loc_408B24:				; CODE XREF: sub_408986+132j
					; DATA XREF: .rdata:off_40D660o
		add	[ebp+var_1C], 1	; jumptable 00408AB8 case 8
		cmp	[ebp+var_24], 0
		jz	short loc_408B8D
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_408B8D
; ---------------------------------------------------------------------------

loc_408B3A:				; CODE XREF: sub_408986+132j
					; DATA XREF: .rdata:off_40D660o
		add	[ebp+var_1C], 1	; jumptable 00408AB8 case 0
		cmp	[ebp+var_24], 0
		jz	short loc_408B90
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_408B90
; ---------------------------------------------------------------------------

loc_408B50:				; CODE XREF: sub_408986+125j
					; sub_408986+132j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 00408AB8 default case
		cmp	[ebp+var_24], 0
		jz	short loc_408B93
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_408B93
; ---------------------------------------------------------------------------

loc_408B81:				; CODE XREF: sub_408986+13Cj
					; sub_408986+14Cj
		nop
		jmp	short loc_408B94
; ---------------------------------------------------------------------------

loc_408B84:				; CODE XREF: sub_408986+159j
					; sub_408986+169j
		nop
		jmp	short loc_408B94
; ---------------------------------------------------------------------------

loc_408B87:				; CODE XREF: sub_408986+176j
					; sub_408986+186j
		nop
		jmp	short loc_408B94
; ---------------------------------------------------------------------------

loc_408B8A:				; CODE XREF: sub_408986+190j
					; sub_408986+19Cj
		nop
		jmp	short loc_408B94
; ---------------------------------------------------------------------------

loc_408B8D:				; CODE XREF: sub_408986+1A6j
					; sub_408986+1B2j
		nop
		jmp	short loc_408B94
; ---------------------------------------------------------------------------

loc_408B90:				; CODE XREF: sub_408986+1BCj
					; sub_408986+1C8j
		nop
		jmp	short loc_408B94
; ---------------------------------------------------------------------------

loc_408B93:				; CODE XREF: sub_408986+1D2j
					; sub_408986+1F9j
		nop

loc_408B94:				; CODE XREF: sub_408986+1FCj
					; sub_408986+1FFj ...
		nop
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408B9A:				; CODE XREF: sub_408986+C5j
					; sub_408986+F1j ...
		cmp	[ebp+var_24], 0
		jz	short loc_408BB1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_408BB1:				; CODE XREF: sub_408986+218j
		add	[ebp+var_1C], 1
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408BBA:				; CODE XREF: sub_408986+BBj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_408C03
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408C03:				; CODE XREF: sub_408986+247j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_408C4C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408C4C:				; CODE XREF: sub_408986+290j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_408C95
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408C95:				; CODE XREF: sub_408986+2D9j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_408CDE
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408CDE:				; CODE XREF: sub_408986+322j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_408D27
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408D27:				; CODE XREF: sub_408986+36Bj
		cmp	[ebp+var_24], 0
		jz	short loc_408D52
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_408D52:				; CODE XREF: sub_408986+3A5j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408D62:				; CODE XREF: sub_408986+ADj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_408D7A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_408E08

loc_408D7A:				; CODE XREF: sub_408986+3E4j
		cmp	[ebp+var_24], 0
		jz	short loc_408DE2
		mov	[ebp+var_10], 0
		jmp	short loc_408DB5
; ---------------------------------------------------------------------------

loc_408D89:				; CODE XREF: sub_408986+435j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_408DB5:				; CODE XREF: sub_408986+401j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_408D89
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_408DE2:				; CODE XREF: sub_408986+3F8j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408E08:				; CODE XREF: sub_408986+3EEj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_408F45
		mov	eax, ds:dword_40E464
		test	eax, eax
		jz	short loc_408E85
		cmp	[ebp+var_24], 0
		jz	short loc_408E73
		mov	[ebp+var_10], 0
		jmp	short loc_408E6B
; ---------------------------------------------------------------------------

loc_408E53:				; CODE XREF: sub_408986+4EBj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_408E6B:				; CODE XREF: sub_408986+4CBj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_408E53

loc_408E73:				; CODE XREF: sub_408986+4C2j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_408F45
; ---------------------------------------------------------------------------

loc_408E85:				; CODE XREF: sub_408986+4BCj
		cmp	[ebp+arg_C], 0
		jz	short loc_408EC9
		cmp	[ebp+var_24], 0
		jz	short loc_408EBA
		mov	[ebp+var_10], 0
		jmp	short loc_408EB2
; ---------------------------------------------------------------------------

loc_408E9A:				; CODE XREF: sub_408986+532j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_408EB2:				; CODE XREF: sub_408986+512j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_408E9A

loc_408EBA:				; CODE XREF: sub_408986+509j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_408F45
; ---------------------------------------------------------------------------

loc_408EC9:				; CODE XREF: sub_408986+503j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_408EF2
		cmp	[ebp+var_28], 0FFh
		ja	short loc_408EF2
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_408F45
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_408F45
; ---------------------------------------------------------------------------

loc_408EF2:				; CODE XREF: sub_408986+547j
					; sub_408986+550j
		cmp	[ebp+var_24], 0
		jz	short loc_408F35
		mov	[ebp+var_10], 0
		jmp	short loc_408F2D
; ---------------------------------------------------------------------------

loc_408F01:				; CODE XREF: sub_408986+5ADj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_408F2D:				; CODE XREF: sub_408986+579j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_408F01

loc_408F35:				; CODE XREF: sub_408986+570j
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_408F45:				; CODE XREF: sub_408986+9Dj
					; sub_408986+20Fj ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_408F4D:				; CODE XREF: sub_408986+45j
		cmp	[ebp+var_2C], 0
		jnz	loc_4089D0
		cmp	[ebp+var_20], 0
		jnz	short loc_408F79
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_40452E
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_4089AB
; ---------------------------------------------------------------------------

loc_408F79:				; CODE XREF: sub_408986+5D5j
		cmp	[ebp+arg_C], 0
		jz	loc_409151
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	edx, ds:dword_40E46C
		mov	eax, off_40B190
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	edx ; dword_40E46C
		sub	esp, 8
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_408FF3
		mov	eax, off_40B190
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_4082D4
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404649
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_40915C
		jmp	locret_40915A
; ---------------------------------------------------------------------------

loc_408FF3:				; CODE XREF: sub_408986+625j
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_409057
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 28Ch
		mov	[esp+88h+Dest],	offset a____Dirmngr1_3 ; "../../dirmngr-1.1.1/jnlib/utf8conv.c"
		call	sub_406C88
; ---------------------------------------------------------------------------

loc_409057:				; CODE XREF: sub_408986+6B3j
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_40452E
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		mov	edx, ds:dword_40E470
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	edx ; dword_40E470
		sub	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jnz	loc_40912A
		mov	eax, ds:dword_40E478
		test	eax, eax
		jnz	short loc_4090DD
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	edx, off_40B190
		mov	[esp+88h+var_7C], eax
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_406ACF

loc_4090DD:				; CODE XREF: sub_408986+722j
		mov	ds:dword_40E478, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404649
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404649
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_408986
		mov	[ebp+var_34], eax
		jmp	short loc_40913B
; ---------------------------------------------------------------------------

loc_40912A:				; CODE XREF: sub_408986+715j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404649

loc_40913B:				; CODE XREF: sub_408986+7A2j
		mov	edx, ds:dword_40E474
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	edx ; dword_40E474
		sub	esp, 4
		mov	eax, [ebp+var_34]
		jmp	short locret_40915A
; ---------------------------------------------------------------------------

loc_409151:				; CODE XREF: sub_408986+5F7j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

locret_40915A:				; CODE XREF: sub_408986+668j
					; sub_408986+7C9j
		leave
		retn
sub_408986	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40915C	proc near		; CODE XREF: sub_407646+50p
					; sub_408986+663p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_40E468
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_408986
		leave
		retn
sub_40915C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4081C2
		test	eax, eax
		jz	short loc_40919C
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4091B4
; ---------------------------------------------------------------------------

loc_40919C:				; CODE XREF: .text:00409193j
		mov	edx, ds:dword_40E46C
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx ; dword_40E46C
		sub	esp, 8

locret_4091B4:				; CODE XREF: .text:0040919Aj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_4081C2
		test	eax, eax
		jz	short loc_4091CC
		mov	eax, 0
		jmp	short locret_4091F9
; ---------------------------------------------------------------------------

loc_4091CC:				; CODE XREF: .text:004091C3j
		mov	edx, ds:dword_40E470
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx ; dword_40E470
		sub	esp, 14h

locret_4091F9:				; CODE XREF: .text:004091CAj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4081C2
		test	eax, eax
		jz	short loc_409211
		mov	eax, 0
		jmp	short locret_409222
; ---------------------------------------------------------------------------

loc_409211:				; CODE XREF: .text:00409208j
		mov	edx, ds:dword_40E474
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx ; dword_40E474
		sub	esp, 4

locret_409222:				; CODE XREF: .text:0040920Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409224(int, char *Format, int)
sub_409224	proc near		; CODE XREF: sub_409463+1Ap

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Radix		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
EndPtr		= dword	ptr -14h
var_10		= dword	ptr -10h
Size		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+Format]
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+Format]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+Size], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		jmp	loc_409410
; ---------------------------------------------------------------------------

loc_409263:				; CODE XREF: sub_409224+1F4j
		mov	eax, [ebp+EndPtr]
		movzx	edx, byte ptr [eax]
		cmp	dl, 25h
		setz	dl
		add	eax, 1
		mov	[ebp+EndPtr], eax
		test	dl, dl
		jz	loc_409410
		jmp	short loc_409288
; ---------------------------------------------------------------------------

loc_40927F:				; CODE XREF: sub_409224+7Fj
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax

loc_409288:				; CODE XREF: sub_409224+59j
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Val], eax ; Val
		mov	[esp+38h+Str], offset a0 ; "-+ #0"
		call	strchr
		test	eax, eax
		jnz	short loc_40927F
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_4092D1
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	edx, eax
		sar	edx, 1Fh
		xor	eax, edx
		sub	eax, edx
		add	[ebp+Size], eax
		jmp	short loc_4092F3
; ---------------------------------------------------------------------------

loc_4092D1:				; CODE XREF: sub_409224+89j
		mov	eax, [ebp+EndPtr]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+38h+Val], edx ; EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+Size]
		add	eax, edx
		mov	[ebp+Size], eax

loc_4092F3:				; CODE XREF: sub_409224+ABj
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	short loc_409361
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_409332
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	edx, eax
		sar	edx, 1Fh
		xor	eax, edx
		sub	eax, edx
		add	[ebp+Size], eax
		jmp	short loc_409361
; ---------------------------------------------------------------------------

loc_409332:				; CODE XREF: sub_409224+EAj
		mov	eax, [ebp+EndPtr]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+38h+Val], edx ; EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+Size]
		add	eax, edx
		mov	[ebp+Size], eax
		jmp	short loc_409361
; ---------------------------------------------------------------------------

loc_409356:				; CODE XREF: sub_409224+159j
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		jmp	short loc_409362
; ---------------------------------------------------------------------------

loc_409361:				; CODE XREF: sub_409224+D7j
					; sub_409224+10Cj ...
		nop

loc_409362:				; CODE XREF: sub_409224+13Bj
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Val], eax ; Val
		mov	[esp+38h+Str], offset aHll ; "hlL"
		call	strchr
		test	eax, eax
		jnz	short loc_409356
		add	[ebp+Size], 1Eh
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 45h	; switch 52 cases
		cmp	eax, 33h
		ja	short loc_409407 ; jumptable 0040939B default case
		mov	eax, ds:off_40D6B8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40939D:				; CODE XREF: sub_409224+177j
					; DATA XREF: .rdata:off_40D6B8o
		mov	eax, [ebp+var_18] ; jumptable 0040939B cases 88,99,100,105,111,117,120
		add	eax, 4
		mov	[ebp+var_18], eax
		jmp	short loc_409407 ; jumptable 0040939B default case
; ---------------------------------------------------------------------------

loc_4093A8:				; CODE XREF: sub_409224+177j
					; DATA XREF: .rdata:off_40D6B8o
		mov	eax, [ebp+var_18] ; jumptable 0040939B cases 69,71,101-103
		add	eax, 8
		mov	[ebp+var_18], eax
		add	[ebp+Size], 133h
		jmp	short loc_409407 ; jumptable 0040939B default case
; ---------------------------------------------------------------------------

loc_4093BA:				; CODE XREF: sub_409224+177j
					; DATA XREF: .rdata:off_40D6B8o
		mov	eax, [ebp+var_18] ; jumptable 0040939B case 115
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4093F7
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+Size]
		add	eax, edx
		mov	[ebp+Size], eax
		jmp	short loc_409407 ; jumptable 0040939B default case
; ---------------------------------------------------------------------------

loc_4093F7:				; CODE XREF: sub_409224+1A8j
		add	[ebp+Size], 19h
		jmp	short loc_409407 ; jumptable 0040939B default case
; ---------------------------------------------------------------------------

loc_4093FD:				; CODE XREF: sub_409224+177j
					; DATA XREF: .rdata:off_40D6B8o
		mov	eax, [ebp+var_18] ; jumptable 0040939B cases 110,112
		add	eax, 4
		mov	[ebp+var_18], eax
		nop

loc_409407:				; CODE XREF: sub_409224+16Ej
					; sub_409224+177j ...
		mov	eax, [ebp+EndPtr] ; jumptable 0040939B default case
		add	eax, 1
		mov	[ebp+EndPtr], eax

loc_409410:				; CODE XREF: sub_409224+3Aj
					; sub_409224+53j
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_409263
		mov	eax, [ebp+Size]
		mov	[esp+38h+Str], eax ; Size
		call	malloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_409458
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+38h+Radix], edx ; Args
		mov	edx, [ebp+Format]
		mov	[esp+38h+Val], edx ; Format
		mov	[esp+38h+Str], eax ; Dest
		call	vsprintf
		jmp	short loc_40945D
; ---------------------------------------------------------------------------

loc_409458:				; CODE XREF: sub_409224+213j
		mov	eax, 0

loc_40945D:				; CODE XREF: sub_409224+232j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_409224	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409463(int, char *, int)
sub_409463	proc near		; CODE XREF: .text:004094A6p

var_18		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		lea	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_409224
		leave
		retn
sub_409463	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409463
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_assuan_log_prefix]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_gpg_err_source]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_pipe_connect]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_socket_connect]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_send_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_transact]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00410024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_409530
		cmp	eax, 3
		jz	short loc_409530
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_409530:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_40A720
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_40D7C4o ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_4095A4
		cmp	dword_40B1A4, 2
		jz	short loc_409586
		mov	dword_40B1A4, 2

loc_409586:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_409693
		cmp	eax, 1
		jz	loc_409632

loc_409598:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4095A4:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_40E8B8, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_4096C3
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_40E8B4, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_40E8B0, eax
		jz	loc_4096C3
		mov	ecx, ds:dword_40E8B4
		test	ecx, ecx
		jz	short loc_409653
		test	eax, eax
		jz	short loc_409653
		mov	dword_40B1A4, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_409632:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_40A720
		jmp	loc_409598
; ---------------------------------------------------------------------------

loc_409653:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_40E8B0, 0
		mov	ds:dword_40E8B4, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_409673:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_40B1A4, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_409693:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_410030
		cmp	ebx, offset dword_410030
		jz	loc_409598

loc_4096A4:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_4096AC
		call	eax

loc_4096AC:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_410030
		jnz	short loc_4096A4
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4096C3:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_40E8B0, 0
		mov	ds:dword_40E8B4, 0
		jmp	short loc_409673
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4096F0	proc near		; DATA XREF: .CRT:00410014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_4096F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409700	proc near		; CODE XREF: sub_409720+10p
					; sub_409720+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_409700	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409710	proc near		; CODE XREF: sub_401060+59p
					; sub_409720+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_409710	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_409720(_onexit_t)
sub_409720	proc near		; CODE XREF: sub_4097E0+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_40E8C0
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_409700
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_4097C0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_40E8C0
		mov	[esp+2Ch+Func],	eax
		call	sub_409700
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_40E8BC
		mov	[esp+2Ch+Func],	eax
		call	sub_409700
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_409710
		mov	ds:dword_40E8C0, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_409710
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_40E8BC, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4097C0:				; CODE XREF: sub_409720+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_409720	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4097E0(_onexit_t)
sub_4097E0	proc near		; CODE XREF: sub_40A400-27p
					; sub_40ACE0+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_409720
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_4097E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_409857
		cmp	eax, 0C000008Dh
		jb	short loc_409884

loc_40981B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_409820:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_409950
		test	eax, eax
		jz	short loc_40986C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_40984F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_409857:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_4098C5
		cmp	eax, 0C0000096h
		jz	short loc_409892
		cmp	eax, 0C0000093h
		jz	short loc_40981B

loc_40986C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_40E508
		test	eax, eax
		jz	loc_409943
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_409884:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_4098D0
		cmp	eax, 0C000001Dh
		jnz	short loc_40986C

loc_409892:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_409907
		test	eax, eax
		jz	short loc_40986C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4098C5:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_409820
; ---------------------------------------------------------------------------
		align 10h

loc_4098D0:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_409925
		test	eax, eax
		jz	loc_40986C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_409907:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40984F
; ---------------------------------------------------------------------------

loc_409925:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40984F
; ---------------------------------------------------------------------------

loc_409943:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_40984F
; ---------------------------------------------------------------------------
		align 10h

loc_409950:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_40984F
		mov	[esp+2Ch+var_10], eax
		call	sub_40A370
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_40984F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_40E50C
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_4099D1
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_40E50C
		jmp	short loc_4099D7
; ---------------------------------------------------------------------------

loc_4099D1:				; CODE XREF: .text:004099A6j
		fstp	st
		fstp	st
		fstp	st

loc_4099D7:				; CODE XREF: .text:004099CFj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4099E0	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_40E50C, eax
		jmp	__setusermatherr
sub_4099E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4099F0	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_409A0D
		mov	edx, ds:off_40D8E4[ecx*4]

loc_409A0D:				; CODE XREF: sub_4099F0+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_4099F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409A50	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_409A50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_409A60(char *Format, char ArgList)
sub_409A60	proc near		; CODE XREF: sub_409AC0+1DDp
					; sub_409AC0+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_409A60	endp

; ---------------------------------------------------------------------------
		jmp	short sub_409AC0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_409AC0(size_t Size)
sub_409AC0	proc near		; CODE XREF: .text:00409AB1j
					; sub_409D00+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_40E518
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_409CA2
		mov	eax, ds:dword_40E514
		xor	esi, esi

loc_409AE4:				; CODE XREF: sub_409AC0+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_409AF9
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_409BD0

loc_409AF9:				; CODE XREF: sub_409AC0+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_409AE4

loc_409B03:				; CODE XREF: sub_409AC0+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_40A0C0
		test	eax, eax
		mov	edi, eax
		jz	loc_409CC9
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_40E514
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_40A1A0
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_40E514
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_409CA9
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_409C51

loc_409B7F:				; CODE XREF: sub_409AC0+194j
					; sub_409AC0+1C6j
		add	ds:dword_40E518, 1

loc_409B86:				; CODE XREF: sub_409AC0+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_409CD9
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_409BD8

loc_409BAF:				; CODE XREF: sub_409AC0+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_409BC3:				; CODE XREF: sub_409AC0+162j
					; sub_409AC0+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409BD0:				; CODE XREF: sub_409AC0+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_409B86
; ---------------------------------------------------------------------------

loc_409BD8:				; CODE XREF: sub_409AC0+EDj
		cmp	eax, 40h
		jz	short loc_409BAF
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_409BC3
		cmp	eax, 4
		jz	short loc_409BC3
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_409C51:				; CODE XREF: sub_409AC0+B9j
		cmp	eax, 40h
		jz	loc_409B7F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_40E514
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_409B7F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_409A60
; ---------------------------------------------------------------------------

loc_409CA2:				; CODE XREF: sub_409AC0+17j
		xor	esi, esi
		jmp	loc_409B03
; ---------------------------------------------------------------------------

loc_409CA9:				; CODE XREF: sub_409AC0+ACj
		mov	eax, ds:dword_40E514
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_409A60
; ---------------------------------------------------------------------------

loc_409CC9:				; CODE XREF: sub_409AC0+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_409A60
; ---------------------------------------------------------------------------

loc_409CD9:				; CODE XREF: sub_409AC0+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_409A60
sub_409AC0	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409D00	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_40E510
		test	eax, eax
		jz	short loc_409D20

loc_409D12:				; CODE XREF: sub_409D00+66j
					; sub_409D00+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409D20:				; CODE XREF: sub_409D00+10j
		mov	ds:dword_40E510, 1
		call	sub_40A100
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_40A7C0
		mov	ds:dword_40E518, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_40E514, eax
		mov	eax, offset dword_40DA74
		sub	eax, offset dword_40DA74
		cmp	eax, 7
		jle	short loc_409D12
		cmp	eax, 0Bh
		mov	ebx, offset dword_40DA74
		jle	loc_409E60
		mov	eax, ds:dword_40DA74
		test	eax, eax
		jnz	short loc_409D90
		mov	eax, ds:dword_40DA78
		test	eax, eax
		jz	loc_409E4C
		lea	esi, [esi+0]

loc_409D90:				; CODE XREF: sub_409D00+7Dj
					; sub_409D00+164j ...
		cmp	ebx, offset dword_40DA74
		jnb	loc_409D12
		mov	esi, 400000h

loc_409DA1:				; CODE XREF: sub_409D00+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_409AC0
		cmp	ebx, offset dword_40DA74
		jb	short loc_409DA1

loc_409DC5:				; CODE XREF: sub_409D00+24Bj
		mov	ecx, ds:dword_40E518
		test	ecx, ecx
		jle	loc_409D12
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_409DF2
; ---------------------------------------------------------------------------
		align 10h

loc_409DE0:				; CODE XREF: sub_409D00+FDj
					; sub_409D00+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_40E518
		jge	loc_409D12

loc_409DF2:				; CODE XREF: sub_409D00+DDj
		mov	eax, ds:dword_40E514
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_409DE0
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_409F72
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_40E514
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_409DE0
; ---------------------------------------------------------------------------

loc_409E4C:				; CODE XREF: sub_409D00+86j
		mov	eax, ds:dword_40DA7C
		test	eax, eax
		jnz	short loc_409E75
		mov	ebx, offset dword_40DA80
		lea	esi, [esi+0]

loc_409E60:				; CODE XREF: sub_409D00+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_409D90
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_409D90

loc_409E75:				; CODE XREF: sub_409D00+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_409F95
		add	ebx, 0Ch
		cmp	ebx, offset dword_40DA74
		jnb	loc_409D12

loc_409E90:				; CODE XREF: sub_409D00+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_409EEA
		cmp	edx, 20h
		jz	short loc_409F20
		cmp	edx, 8
		jz	short loc_409ECA
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_409A60
; ---------------------------------------------------------------------------

loc_409ECA:				; CODE XREF: sub_409D00+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_409EF5
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_409F11
; ---------------------------------------------------------------------------

loc_409EEA:				; CODE XREF: sub_409D00+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_409F50

loc_409EF5:				; CODE XREF: sub_409D00+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_409F63
		cmp	edx, 20h
		jz	short loc_409F2F
		cmp	edx, 8
		jnz	short loc_409F3C

loc_409F11:				; CODE XREF: sub_409D00+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_409AC0
		jmp	short loc_409F3C
; ---------------------------------------------------------------------------

loc_409F20:				; CODE XREF: sub_409D00+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_409F2F:				; CODE XREF: sub_409D00+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_409AC0

loc_409F3C:				; CODE XREF: sub_409D00+20Fj
					; sub_409D00+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_40DA74
		jb	loc_409E90
		jmp	loc_409DC5
; ---------------------------------------------------------------------------

loc_409F50:				; CODE XREF: sub_409D00+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_409F63:				; CODE XREF: sub_409D00+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_409AC0
		jmp	short loc_409F3C
; ---------------------------------------------------------------------------

loc_409F72:				; CODE XREF: sub_409D00+11Bj
		add	ebx, ds:dword_40E514
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_409A60
; ---------------------------------------------------------------------------

loc_409F95:				; CODE XREF: sub_409D00+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_409A60
sub_409D00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409FB0	proc near		; CODE XREF: .text:0040A051p
					; sub_40A0C0+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_409FC0

locret_409FBD:				; CODE XREF: sub_409FB0+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_409FC0:				; CODE XREF: sub_409FB0+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_409FBD
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_409FB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409FE0	proc near		; CODE XREF: sub_40A0C0+2Bp
					; .text:0040A204p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_40A01E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_40A004:				; CODE XREF: sub_409FE0+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_40A012
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40A01E

loc_40A012:				; CODE XREF: sub_409FE0+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_40A004
		xor	eax, eax

loc_40A01E:				; CODE XREF: sub_409FE0+19j
					; sub_409FE0+30j
		pop	ebx
		pop	esi
		retn
sub_409FE0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40A030
; ---------------------------------------------------------------------------
		align 10h

loc_40A030:				; CODE XREF: .text:0040A021j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_40A0A3
		mov	dword ptr [esp], 400000h
		call	sub_409FB0
		test	eax, eax
		jz	short loc_40A0A3
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_40A0A3
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_40A08B
; ---------------------------------------------------------------------------

loc_40A081:				; CODE XREF: .text:0040A0A1j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_40A0B0

loc_40A08B:				; CODE XREF: .text:0040A07Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_40A081

loc_40A0A3:				; CODE XREF: .text:0040A048j
					; .text:0040A058j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A0B0:				; CODE XREF: .text:0040A089j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A0C0	proc near		; CODE XREF: sub_409AC0+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_409FB0
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_40A0F0
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_409FE0

loc_40A0F0:				; CODE XREF: sub_40A0C0+15j
		add	esp, 8
		retn
sub_40A0C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A100	proc near		; CODE XREF: sub_409D00+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_409FB0
		xor	edx, edx
		test	eax, eax
		jz	short loc_40A121
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_40A121:				; CODE XREF: sub_40A100+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_40A100	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_409FB0
		xor	edx, edx
		test	eax, eax
		jz	short loc_40A189
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_40A189
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_40A170:				; CODE XREF: .text:0040A185j
		test	byte ptr [edx+27h], 20h
		jz	short loc_40A17D
		test	ebx, ebx
		jz	short loc_40A189
		sub	ebx, 1

loc_40A17D:				; CODE XREF: .text:0040A174j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_40A170
		xor	edx, edx

loc_40A189:				; CODE XREF: .text:0040A149j
					; .text:0040A165j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40A1A0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A1A0	proc near		; CODE XREF: sub_409AC0+70p
					; .text:0040A191j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_409FB0
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_40A1A0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40A1D0
; ---------------------------------------------------------------------------
		align 10h

loc_40A1D0:				; CODE XREF: .text:0040A1C1j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_409FB0
		test	eax, eax
		jnz	short loc_40A1F0

loc_40A1E6:				; CODE XREF: .text:0040A20Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A1F0:				; CODE XREF: .text:0040A1E4j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_409FE0
		test	eax, eax
		jz	short loc_40A1E6
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A220	proc near		; CODE XREF: sub_40A2B0+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_409FB0
		test	eax, eax
		jz	short loc_40A291
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_40A291
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_409FE0
		test	eax, eax
		jz	short loc_40A291
		add	esi, 400000h
		jnz	short loc_40A276
		jmp	short loc_40A291
; ---------------------------------------------------------------------------
		align 10h

loc_40A270:				; CODE XREF: sub_40A220+66j
		sub	ebx, 1
		add	esi, 14h

loc_40A276:				; CODE XREF: sub_40A220+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_40A284
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_40A2A0

loc_40A284:				; CODE XREF: sub_40A220+5Bj
		test	ebx, ebx
		jg	short loc_40A270
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_40A291:				; CODE XREF: sub_40A220+1Aj
					; sub_40A220+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A2A0:				; CODE XREF: sub_40A220+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_40A220	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A2B0	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40E51C
		test	eax, eax
		jz	short loc_40A2C2

loc_40A2BD:				; CODE XREF: sub_40A2B0+97j
					; sub_40A2B0+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40A2C2:				; CODE XREF: sub_40A2B0+Bj
		xor	eax, eax

loc_40A2C4:				; CODE XREF: sub_40A2B0+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_40A220
		test	eax, eax
		jz	short loc_40A350
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_40A2E0
		cmp	dl, 6Dh
		jnz	short loc_40A330

loc_40A2E0:				; CODE XREF: sub_40A2B0+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40A2EE
		cmp	dl, 73h
		jnz	short loc_40A330

loc_40A2EE:				; CODE XREF: sub_40A2B0+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40A2FC
		cmp	dl, 76h
		jnz	short loc_40A330

loc_40A2FC:				; CODE XREF: sub_40A2B0+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_40A30A
		cmp	dl, 63h
		jnz	short loc_40A330

loc_40A30A:				; CODE XREF: sub_40A2B0+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_40A318
		cmp	dl, 72h
		jnz	short loc_40A330

loc_40A318:				; CODE XREF: sub_40A2B0+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_40A334
		cmp	dl, 74h
		jz	short loc_40A334
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_40A334
		xchg	ax, ax

loc_40A330:				; CODE XREF: sub_40A2B0+2Ej
					; sub_40A2B0+3Cj ...
		mov	eax, ebx
		jmp	short loc_40A2C4
; ---------------------------------------------------------------------------

loc_40A334:				; CODE XREF: sub_40A2B0+6Fj
					; sub_40A2B0+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_40E51C, eax
		jnz	loc_40A2BD
		lea	esi, [esi+0]

loc_40A350:				; CODE XREF: sub_40A2B0+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_40E51C, eax
		jmp	loc_40A2BD
sub_40A2B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A370	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_40A370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40A380()
sub_40A380	proc near		; DATA XREF: sub_40A400:loc_40A3D2o
		sub	esp, 0Ch
		mov	eax, off_40B1A0
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40A3A7
		xchg	ax, ax

loc_40A390:				; CODE XREF: sub_40A380+25j
		call	eax
		mov	eax, off_40B1A0
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_40B1A0, edx
		test	eax, eax
		jnz	short loc_40A390

loc_40A3A7:				; CODE XREF: sub_40A380+Cj
		add	esp, 0Ch
		retn
sub_40A380	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_40A400

loc_40A3B0:				; CODE XREF: sub_40A400+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_40AD00
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_40A3E3

loc_40A3BF:				; CODE XREF: sub_40A400-9j
		test	ebx, ebx
		jz	short loc_40A3D2

loc_40A3C3:				; CODE XREF: sub_40A400-30j
		call	ds:dword_40AD00[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_40A3C3

loc_40A3D2:				; CODE XREF: sub_40A400-3Fj
		mov	[esp+1Ch+var_1C], offset sub_40A380 ; _onexit_t
		call	sub_4097E0
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40A3E3:				; CODE XREF: sub_40A400-43j
		xor	ebx, ebx
		jmp	short loc_40A3E9
; ---------------------------------------------------------------------------

loc_40A3E7:				; CODE XREF: sub_40A400-Bj
		mov	ebx, eax

loc_40A3E9:				; CODE XREF: sub_40A400-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_40AD00[eax*4]
		test	edx, edx
		jnz	short loc_40A3E7
		jmp	short loc_40A3BF
; END OF FUNCTION CHUNK	FOR sub_40A400
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A400	proc near		; CODE XREF: sub_401180+239p
					; sub_401650+17p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 0040A3B0 SIZE 00000049 BYTES

		mov	ecx, ds:dword_40E520
		test	ecx, ecx
		jz	short loc_40A410
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A410:				; CODE XREF: sub_40A400+8j
		mov	ds:dword_40E520, 1
		jmp	short loc_40A3B0
sub_40A400	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A420	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_40B1AC
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_40A470
		not	eax
		mov	dword_40B1B0, eax

loc_40A456:				; CODE XREF: sub_40A420+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A470:				; CODE XREF: sub_40A420+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_40A4E2

loc_40A4D2:				; CODE XREF: sub_40A420+CCj
		mov	dword_40B1AC, ebp
		mov	dword_40B1B0, eax
		jmp	loc_40A456
; ---------------------------------------------------------------------------

loc_40A4E2:				; CODE XREF: sub_40A420+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_40A4D2
sub_40A420	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_40E604, edx
		mov	ds:dword_40E820, 0C0000409h
		mov	ds:dword_40E824, 1
		mov	ds:dword_40E5F8, eax
		mov	ds:dword_40E82C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_40E5EC, eax
		mov	eax, dword_40B1AC
		mov	[ebp-10h], eax
		mov	eax, dword_40B1B0
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_40DA0C
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A580	proc near		; CODE XREF: sub_40A720+79p
					; sub_40A720:loc_40A7B2p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_40E89C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_40A5D5
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_40A5B0:				; CODE XREF: sub_40A580+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_40A5CE
		test	esi, esi
		jz	short loc_40A5CE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_40A5CE:				; CODE XREF: sub_40A580+40j
					; sub_40A580+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_40A5B0

loc_40A5D5:				; CODE XREF: sub_40A580+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40A580	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_40E880
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_40A614

loc_40A606:				; CODE XREF: .text:0040A67Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40A614:				; CODE XREF: .text:0040A604j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_40A677
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_40E89C
		mov	ds:dword_40E89C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40A677:				; CODE XREF: .text:0040A62Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_40A606
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40E880
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_40A698
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40A698:				; CODE XREF: .text:0040A68Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_40E89C
		sub	esp, 4
		test	edx, edx
		jz	short loc_40A6CF
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_40A6C8
		jmp	short loc_40A706
; ---------------------------------------------------------------------------
		align 10h

loc_40A6C0:				; CODE XREF: .text:0040A6CDj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_40A6E6
		mov	edx, eax

loc_40A6C8:				; CODE XREF: .text:0040A6B6j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_40A6C0

loc_40A6CF:				; CODE XREF: .text:0040A6B0j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_40A6DF:				; CODE XREF: .text:0040A704j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40A6E6:				; CODE XREF: .text:0040A6C4j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_40A6EC:				; CODE XREF: .text:0040A710j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_40A6DF
; ---------------------------------------------------------------------------

loc_40A706:				; CODE XREF: .text:0040A6B8j
		mov	eax, [edx+8]
		mov	ds:dword_40E89C, eax
		mov	eax, edx
		jmp	short loc_40A6EC
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A720	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_40A770
		jb	short loc_40A740
		cmp	eax, 3
		jz	short loc_40A790

loc_40A733:				; CODE XREF: sub_40A720+31j
					; sub_40A720+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A740:				; CODE XREF: sub_40A720+Cj
		mov	eax, ds:dword_40E880
		test	eax, eax
		jnz	short loc_40A7B2

loc_40A749:				; CODE XREF: sub_40A720+97j
		mov	eax, ds:dword_40E880
		cmp	eax, 1
		jnz	short loc_40A733
		mov	ds:dword_40E880, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_40A733
; ---------------------------------------------------------------------------
		align 10h

loc_40A770:				; CODE XREF: sub_40A720+Aj
		mov	eax, ds:dword_40E880
		test	eax, eax
		jz	short loc_40A7A0

loc_40A779:				; CODE XREF: sub_40A720+90j
		mov	ds:dword_40E880, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A790:				; CODE XREF: sub_40A720+11j
		mov	eax, ds:dword_40E880
		test	eax, eax
		jz	short loc_40A733
		call	sub_40A580
		jmp	short loc_40A733
; ---------------------------------------------------------------------------

loc_40A7A0:				; CODE XREF: sub_40A720+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_40A779
; ---------------------------------------------------------------------------

loc_40A7B2:				; CODE XREF: sub_40A720+27j
		call	sub_40A580
		jmp	short loc_40A749
sub_40A720	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A7C0	proc near		; CODE XREF: sub_401180+19p
					; sub_409D00+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_40A7E2

loc_40A7CD:				; CODE XREF: sub_40A7C0+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_40A7CD

loc_40A7E2:				; CODE XREF: sub_40A7C0+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_40A7C0	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _access]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40A840
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A840	proc near		; CODE XREF: sub_401180+A7p
					; .text:0040A831j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_40A840	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_40A860	proc near		; CODE XREF: sub_40AA40+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_40A8AC
		jmp	short loc_40A8B4
; ---------------------------------------------------------------------------
		align 10h

loc_40A8A0:				; CODE XREF: sub_40A860+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_40A8B4

loc_40A8AC:				; CODE XREF: sub_40A860+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_40A8A0

loc_40A8B4:				; CODE XREF: sub_40A860+39j
					; sub_40A860+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_40A8DC
		jmp	short loc_40A8E4
; ---------------------------------------------------------------------------
		align 10h

loc_40A8D0:				; CODE XREF: sub_40A860+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_40A8E4

loc_40A8DC:				; CODE XREF: sub_40A860+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_40A8D0

loc_40A8E4:				; CODE XREF: sub_40A860+6Aj
					; sub_40A860+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_40A9A0
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_40A9CE

loc_40A903:				; CODE XREF: sub_40A860+168j
					; sub_40A860+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40A9E0

loc_40A933:				; CODE XREF: sub_40A860+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_40E500
		test	eax, eax
		jz	loc_40AA19
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_40AA01
		cmp	eax, 5
		jnz	short loc_40A9FC
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40A9A0:				; CODE XREF: sub_40A860+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_40A903

loc_40A9CE:				; CODE XREF: sub_40A860+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_40A903
; ---------------------------------------------------------------------------
		align 10h

loc_40A9E0:				; CODE XREF: sub_40A860+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_40A933
; ---------------------------------------------------------------------------

loc_40A9FC:				; CODE XREF: sub_40A860+133j
		call	abort
; ---------------------------------------------------------------------------

loc_40AA01:				; CODE XREF: sub_40A860+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_40AA19:				; CODE XREF: sub_40A860+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_2 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_40A860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40AA40(char *, char *, int)
sub_40AA40	proc near		; CODE XREF: sub_4031B2+E4p
					; sub_403440+55p ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40AAA6
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_40AA90:				; CODE XREF: sub_40AA40+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_40AA90
		add	edx, edx

loc_40AAA6:				; CODE XREF: sub_40AA40+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40AACD
		xor	edi, edi

loc_40AAB7:				; CODE XREF: sub_40AA40+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_40AAB7
		add	edx, edx

loc_40AACD:				; CODE XREF: sub_40AA40+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_40A860
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_40AA40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40AB10	proc near		; CODE XREF: sub_4066F8+9Cp
		jmp	sub_40AB30
sub_40AB10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40AB20	proc near		; CODE XREF: sub_4066F8+AAp
		jmp	sub_40AB40
sub_40AB20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AB30	proc near		; CODE XREF: sub_40AB10j
		mov	eax, ds:time
		jmp	eax
sub_40AB30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AB40	proc near		; CODE XREF: sub_40AB20j
		mov	eax, ds:localtime
		jmp	eax
sub_40AB40	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vsprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ACE0	proc near		; DATA XREF: .text:0040AD04o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_4097E0
		leave
		retn
sub_40ACE0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_40AD00	dd 0FFFFFFFFh		; DATA XREF: sub_40A400-4Cr
					; sub_40A400:loc_40A3C3r ...
		dd offset sub_40ACE0
		dd 0
		dd 0FFFFFFFFh
dword_40AD10	dd 3Ch dup(0)		; DATA XREF: .data:off_40B1A0o
		dd 80h dup(?)
_text		ends

; Section 2. (virtual address 0000B000)
; Virtual size			: 000001B8 (	440.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000A200
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 40B000h
dword_40B000	dd 76h,	40C044h, 0	; DATA XREF: sub_401650:loc_40186Fo
		dd offset aVerbose	; "verbose"
		dd 71h,	40C04Ch, 0
		dd offset aBeSomewhatMore ; "be	somewhat more quiet"
		dd 1F4h, 40C069h, 0
		dd offset aUseOcspInstead ; "use OCSP instead of CRLs"
		dd 1F5h, 40C087h, 0
		dd offset aCheckWhetherAD ; "check whether a dirmngr is	running"
		dd 1F6h, 40C0AFh, 0
		dd offset aAddACertificat ; "add a certificate to the cache"
		dd 1F7h, 40C0DBh, 0
		dd offset aValidateACerti ; "validate a	certificate"
		dd 1F8h, 40C0FBh, 0
		dd offset aLookupACertifi ; "lookup a certificate"
		dd 6Ch,	40C117h, 0
		dd offset aLookupOnlyLoca ; "lookup only locally stored	certificates"
		dd 75h,	40C148h, 0
		dd offset aExpectAnUrlFor ; "expect an URL for --lookup"
		dd 1F9h, 40C167h, 0
		dd offset aLoadACrlIntoTh ; "load a CRL	into the dirmngr"
		dd 1FAh, 40C18Ch, 0
		dd offset aSpecialModeFor ; "special mode for use by Squid"
		dd 1FBh, 40C1B5h, 0
		dd offset aCertificatesAr ; "certificates are expected in PEM format"
		dd 1FDh, 40C1E4h, 0
		dd offset aForceTheUseOfT ; "force the use of the default OCSP respo"...
		align 20h
aAbcdefghijklmn	db 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',0
					; DATA XREF: sub_401650+280o
		align 20h
byte_40B140	db 41h			; DATA XREF: sub_4031B2+13Br
					; sub_4031B2+166r ...
		db 42h,	43h, 44h
		dd 48474645h, 4C4B4A49h, 504F4E4Dh, 54535251h, 58575655h
		dd 62615A59h, 66656463h, 6A696867h, 6E6D6C6Bh, 7271706Fh
		dd 76757473h, 7A797877h, 33323130h, 37363534h, 2F2B3938h
; LPCSTR off_40B180
off_40B180	dd offset aShell32_dll	; DATA XREF: sub_403C16+30r
					; sub_403C16+90r
					; "shell32.dll"
		dd offset aShfolder_dll	; "shfolder.dll"
		dd 0
dword_40B18C	dd 0FFFFFFFFh		; DATA XREF: sub_406299:loc_4063DDw
					; .text:loc_406691r ...
; char off_40B190[]
off_40B190	dd offset aIso88591	; DATA XREF: sub_4082D4+C6w
					; .text:loc_40859Ew ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_40B1A0	dd offset dword_40AD10	; DATA XREF: sub_40A380+3r
					; sub_40A380+12r ...
dword_40B1A4	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_40B1A8	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_40B1AC	dd 0BB40E64Eh		; DATA XREF: sub_40A420+3r
					; sub_40A420:loc_40A4D2w ...
dword_40B1B0	dd 44BF19B1h		; DATA XREF: sub_40A420+31w
					; sub_40A420+B8w ...
dword_40B1B4	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0000C000)
; Virtual size			: 00001A74 (   6772.)
; Section size in file		: 00001C00 (   7168.)
; Offset to raw	data for section: 0000A400
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 40C000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
aVerbose	db 'verbose',0          ; DATA XREF: .data:0040B00Co
aQuiet		db 'quiet',0
aBeSomewhatMore	db 'be somewhat more quiet',0 ; DATA XREF: .data:0040B01Co
aOcsp		db 'ocsp',0
aUseOcspInstead	db 'use OCSP instead of CRLs',0 ; DATA XREF: .data:0040B02Co
aPing		db 'ping',0
aCheckWhetherAD	db 'check whether a dirmngr is running',0 ; DATA XREF: .data:0040B03Co
aCacheCert	db 'cache-cert',0
		align 4
aAddACertificat	db 'add a certificate to the cache',0 ; DATA XREF: .data:0040B04Co
aValidate_0	db 'validate',0
aValidateACerti	db 'validate a certificate',0 ; DATA XREF: .data:0040B05Co
aLookup		db 'lookup',0
aLookupACertifi	db 'lookup a certificate',0 ; DATA XREF: .data:0040B06Co
aLocal		db 'local',0
		align 10h
aLookupOnlyLoca	db 'lookup only locally stored certificates',0 ; DATA XREF: .data:0040B07Co
aUrl		db 'url',0
aExpectAnUrlFor	db 'expect an URL for --lookup',0 ; DATA XREF: .data:0040B08Co
aLoadCrl	db 'load-crl',0
aLoadACrlIntoTh	db 'load a CRL into the dirmngr',0 ; DATA XREF: .data:0040B09Co
aSquidMode	db 'squid-mode',0
aSpecialModeFor	db 'special mode for use by Squid',0 ; DATA XREF: .data:0040B0ACo
aPem		db 'pem',0
		align 4
aCertificatesAr	db 'certificates are expected in PEM format',0 ; DATA XREF: .data:0040B0BCo
aForceDefaultRe	db 'force-default-responder',0
aForceTheUseOfT	db 'force the use of the default OCSP responder',0
					; DATA XREF: .data:0040B0CCo
aDirmngrClientD	db 'dirmngr-client (dirmngr)',0 ; DATA XREF: sub_4015DC:loc_4015F7o
a1_1_1		db '1.1.1',0            ; DATA XREF: sub_4015DC:loc_401600o
		align 4
aCopyrightC2013	db 'Copyright (C) 2013 g10 Code GmbH',0 ; DATA XREF: sub_4015DC:loc_401609o
aMingw32	db 'MingW32',0          ; DATA XREF: sub_4015DC:loc_401612o
		align 4
aPleaseReportBu	db 'Please report bugs to <@EMAIL@>.',0Ah,0
					; DATA XREF: sub_4015DC:loc_40161Bo
aBugDirmngr@gnu	db 'bug-dirmngr@gnupg.org',0 ; DATA XREF: sub_4015DC:loc_401624o
aUsageDirmngrCl	db 'Usage: dirmngr-client [options] [certfile|pattern] (-h for help)',0Ah
					; DATA XREF: sub_4015DC:loc_40162Do
		db 0
		align 10h
aSyntaxDirmngrC	db 'Syntax: dirmngr-client [options] [certfile|pattern]',0Ah
					; DATA XREF: sub_4015DC:loc_401636o
		db 'Test an X.509 certificate against a CRL or do an OCSP check',0Ah
		db 'The process returns 0 if the certificate is valid, 1 if it is',0Ah
		db 'not valid and other error codes for general failures',0Ah,0
off_40C3D4	dd offset loc_40163F	; DATA XREF: sub_4015DC+12o
		dd offset loc_40162D	; jump table for switch	statement
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_4015F7
		dd offset loc_40163F
		dd offset loc_401600
		dd offset loc_401609
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_401612
		dd offset loc_40163F
		dd offset loc_40161B
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40162D
		dd offset loc_401636
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_40163F
		dd offset loc_401624
; char aDirmngrClient[]
aDirmngrClient	db 'dirmngr-client',0   ; DATA XREF: sub_401650+61o
		align 4
; char aErrorReadingCe[]
aErrorReadingCe	db 'error reading certificate from stdin: %s',0Ah,0
					; DATA XREF: sub_401650+354o
					; sub_402F4D+59o
		align 4
; char aErrorReading_0[]
aErrorReading_0	db 'error reading certificate from `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_401650+3A5o
		align 4
; char aCertificateToo[]
aCertificateToo	db 'certificate too large to make any sense',0Ah,0
					; DATA XREF: sub_401650+3ECo
; char aLookupFailedS[]
aLookupFailedS	db 'lookup failed: %s',0Ah,0 ; DATA XREF: sub_401650+4A6o
; char aLoadingCrlSFai[]
aLoadingCrlSFai	db 'loading CRL `%s',27h,' failed: %s',0Ah,0 ; DATA XREF: sub_401650+51Do
		align 10h
; char aADirmngrDaemon[]
aADirmngrDaemon	db 'a dirmngr daemon is up and running',0Ah,0 ; DATA XREF: sub_401650+5EFo
; char aCertificateAlr[]
aCertificateAlr	db 'certificate already cached',0Ah,0 ; DATA XREF: sub_401650+64Do
; char aErrorCachingCe[]
aErrorCachingCe	db 'error caching certificate: %s',0Ah,0 ; DATA XREF: sub_401650+670o
		align 10h
; char aValidationOfCe[]
aValidationOfCe	db 'validation of certificate failed: %s',0Ah,0 ; DATA XREF: sub_401650+6ABo
; char aCertificateIsV[]
aCertificateIsV	db 'certificate is valid',0Ah,0 ; DATA XREF: sub_401650+6CDo
					; sub_402F4D+B1o
; char aCertificateHas[]
aCertificateHas	db 'certificate has been revoked',0Ah,0 ; DATA XREF: sub_401650+6F9o
					; sub_402F4D+E4o
; char aCertificateChe[]
aCertificateChe	db 'certificate check failed: %s',0Ah,0 ; DATA XREF: sub_401650+71Bo
					; sub_402F4D+101o
; char aGotStatusS[]
aGotStatusS	db 'got status: `%s',27h,0Ah,0 ; DATA XREF: sub_401D86+17o
		align 4
; char aErrorWritingBa[]
aErrorWritingBa	db 'error writing base64 encoding: %s',0Ah,0 ; DATA XREF: sub_401DB0+43o
; char VarName[]
VarName		db 'DIRMNGR_INFO',0     ; DATA XREF: sub_401E06+16o
; char aFailedToAlloca[]
aFailedToAlloca	db 'failed to allocate assuan context: %s',0Ah,0 ; DATA XREF: sub_401E06+7Co
		align 4
; char aApparentlyNoRu[]
aApparentlyNoRu	db 'apparently no running dirmngr',0Ah,0 ; DATA XREF: sub_401E06+ACo
		align 4
; char aNoRunningDirmn[]
aNoRunningDirmn	db 'no running dirmngr - starting one',0Ah,0 ; DATA XREF: sub_401E06+CBo
a_Dirmngr	db './dirmngr',0        ; DATA XREF: sub_401E06:loc_401EF2o
aServer		db '--server',0         ; DATA XREF: sub_401E06+128o
		align 4
; char aMalformedDirmn[]
aMalformedDirmn	db 'malformed DIRMNGR_INFO environment variable',0Ah,0
					; DATA XREF: sub_401E06:loc_402024o
		align 4
; char aDirmngrProtoco[]
aDirmngrProtoco	db 'dirmngr protocol version %d is not supported',0Ah,0
					; DATA XREF: sub_401E06+2C1o
		align 4
; char aCanTConnectToT[]
aCanTConnectToT	db 'can',27h,'t connect to the dirmngr - trying fall back',0Ah,0
					; DATA XREF: sub_401E06+351o
		align 10h
; char aCanTConnectT_0[]
aCanTConnectT_0	db 'can',27h,'t connect to the dirmngr: %s',0Ah,0
					; DATA XREF: sub_401E06+395o
; char Mode[]
Mode		db 'r',0                ; DATA XREF: sub_4021B3+13o
; char aInvalidPercent[]
aInvalidPercent	db 'invalid percent escape sequence',0Ah,0
					; DATA XREF: sub_4021B3:loc_4022E9o
		align 4
a____Dirmngr1_1	db '../../dirmngr-1.1.1/src/dirmngr-client.c',0 ; DATA XREF: sub_4021B3+3ADo
		align 4
; char aNoCertificateO[]
aNoCertificateO	db 'no certificate or invalid encoded',0Ah,0 ; DATA XREF: sub_4021B3+423o
aBegin		db '-----BEGIN ',0      ; DATA XREF: sub_4021B3+235o
		align 4
off_40C834	dd offset loc_4023DE	; DATA XREF: sub_4021B3+205o
		dd offset loc_4023C1	; jump table for switch	statement
		dd offset loc_4023E5
		dd offset loc_40241F
		dd offset loc_402435
		dd offset loc_402435
		dd offset loc_402435
		dd offset loc_402435
		dd offset loc_402542
; char aRb[3]
aRb		db 'rb',0               ; DATA XREF: sub_402612+33o
aTargetcert	db 'TARGETCERT',0       ; DATA XREF: sub_402775+13o
aSendcert	db 'SENDCERT',0         ; DATA XREF: sub_402775+7Eo
aSendcert_ski	db 'SENDCERT_SKI',0     ; DATA XREF: sub_402775+E5o
aSendissuercert	db 'SENDISSUERCERT',0   ; DATA XREF: sub_402775+14Co
; char aUnsupportedInq[]
aUnsupportedInq	db 'unsupported inquiry `%s',27h,0Ah,0 ; DATA XREF: sub_402775+1B2o
aCheckocsp	db 'CHECKOCSP',0        ; DATA XREF: sub_40294C+4Ao
aCheckcrl	db 'CHECKCRL',0         ; DATA XREF: sub_40294C:loc_40299Do
aCheckocspForce	db 'CHECKOCSP --force-default-responder',0
					; DATA XREF: sub_40294C:loc_4029A4o
aOkay		db 'okay',0             ; DATA XREF: sub_40294C:loc_402A07o
					; sub_402A21:loc_402AB2o ...
; char aResponseOfDirm[]
aResponseOfDirm	db 'response of dirmngr: %s',0Ah,0 ; DATA XREF: sub_40294C+C4o
					; sub_402A21+9Ao ...
aCachecert	db 'CACHECERT',0        ; DATA XREF: sub_402A21+5Eo
aValidate	db 'VALIDATE',0         ; DATA XREF: sub_402ACC+5Eo
; char aAbsoluteFileNa[]
aAbsoluteFileNa	db 'absolute file name expected',0Ah,0 ; DATA XREF: sub_402B77+38o
; char Format[]
Format		db '%%%02X',0           ; DATA XREF: sub_402B77+EAo
					; sub_402D4E+10Eo
; char aLookingUpS[]
aLookingUpS	db 'looking up `%s',27h,0Ah,0 ; DATA XREF: sub_402D4E+17o
; char aError[]
aError		db 'ERROR',0            ; DATA XREF: sub_402F4D+65o
					; sub_402F4D:loc_40305Ao
; char aOk[]
aOk		db 'OK',0               ; DATA XREF: sub_402F4D:loc_40300Ao
aRead_pem_certi	db 'read_pem_certificate',0 ; DATA XREF: sub_4021B3:loc_402550o
; char aBegin_0[]
aBegin_0	db '-----BEGIN ',0      ; DATA XREF: sub_4031B2+4Eo
; char asc_40C96C[]
asc_40C96C	db '-----',0Ah,0        ; DATA XREF: sub_4031B2+89o
					; sub_403440+1F0o
		align 4
; char a____Dirmngr1_0[]
a____Dirmngr1_0	db '../../dirmngr-1.1.1/src/b64enc.c',0 ; DATA XREF: sub_4031B2+D5o
					; sub_403440+46o
; char aIdx4[]
aIdx4		db 'idx < 4',0          ; DATA XREF: sub_4031B2+DDo
					; sub_403440+4Eo
; char asc_40C99D[]
asc_40C99D	db 0Ah,0		; DATA XREF: sub_4031B2+214o
					; sub_403440+16Bo ...
; char aEnd[]
aEnd		db '-----END ',0        ; DATA XREF: sub_403440+1BDo
		align 4
aHkey_classes_r	db 'HKEY_CLASSES_ROOT',0 ; DATA XREF: sub_40372D+26o
aHkey_current_u	db 'HKEY_CURRENT_USER',0 ; DATA XREF: sub_40372D+5Ao
aHkey_local_mac	db 'HKEY_LOCAL_MACHINE',0 ; DATA XREF: sub_40372D+8Eo
aHkey_users	db 'HKEY_USERS',0       ; DATA XREF: sub_40372D+C2o
aHkey_performan	db 'HKEY_PERFORMANCE_DATA',0 ; DATA XREF: sub_40372D+F3o
aHkey_current_c	db 'HKEY_CURRENT_CONFIG',0 ; DATA XREF: sub_40372D+124o
; CHAR aShgetfolderpat[]
aShgetfolderpat	db 'SHGetFolderPathA',0 ; DATA XREF: sub_403C16+50o
aDirmngr_ldap_e	db '\dirmngr_ldap.exe',0 ; DATA XREF: .text:00403D0Do
		align 4
aHomeIntevation	db '/home/intevation/gpg4win/src/playground/install/pkgs/dirmngr-1.1.'
					; DATA XREF: .text:00403D99o
		db '1/libexec/dirmngr_ldap',0
aGnupg		db '\gnupg',0           ; DATA XREF: sub_403DAF+84o
aCGnupg		db 'c:/gnupg',0         ; DATA XREF: sub_403DAF:loc_403E9Do
					; .text:loc_403F6Fo
aGnupghome	db 'GNUPGHOME',0        ; DATA XREF: .text:00403EB9o
aHomedir	db 'HomeDir',0          ; DATA XREF: .text:loc_403EF5o
aSoftwareGnuGnu	db 'Software\GNU\GnuPG',0 ; DATA XREF: .text:00403EFDo
; char aGetmodulefilen[]
aGetmodulefilen	db 'GetModuleFileName failed: %s',0Ah,0 ; DATA XREF: sub_403F7B+48o
		align 4
; char aBadFilenameSRe[]
aBadFilenameSRe	db 'bad filename `%s',27h,' returned for this process',0Ah,0
					; DATA XREF: sub_403F7B+92o
		align 4
aHomeIntevati_0	db '/home/intevation/gpg4win/src/playground/install/pkgs/dirmngr-1.1.'
					; DATA XREF: sub_403F7B:loc_404032o
		db '1/libexec',0
aGnu		db '\GNU',0             ; DATA XREF: sub_404039+80o
aEtcDirmngr	db '\etc\dirmngr',0     ; DATA XREF: .text:00404126o
aLibDirmngr	db '\lib\dirmngr',0     ; DATA XREF: .text:004041D6o
aGnu_0		db 'GNU',0              ; DATA XREF: .text:00404273o
aCache		db 'cache',0            ; DATA XREF: .text:0040427Ao
aDirmngr	db 'dirmngr',0          ; DATA XREF: .text:00404281o
aCTempCacheDirm	db 'c:\temp\cache\dirmngr',0 ; DATA XREF: .text:loc_4043D7o
aCWindows	db 'C:\WINDOWS',0       ; DATA XREF: sub_4043EB+4Ao
aS_dirmngr	db '\S.dirmngr',0       ; DATA XREF: sub_4043EB:loc_404459o
aShell32_dll	db 'shell32.dll',0      ; DATA XREF: .data:off_40B180o
aShfolder_dll	db 'shfolder.dll',0     ; DATA XREF: .data:0040B184o
		align 4
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating enough memory: %s',0Ah,0 ; DATA XREF: sub_4044F4+1Bo
; char aInvalidArgumen[]
aInvalidArgumen	db 'Invalid argument for ArgParse',0Ah,0 ; DATA XREF: sub_404664+77o
aArgumentNotExp	db 'argument not expected',0Ah,0 ; DATA XREF: sub_404664+A6o
aReadError	db 'read error',0Ah,0   ; DATA XREF: sub_404664+BAo
aKeywordTooLong	db 'keyword too long',0Ah,0 ; DATA XREF: sub_404664+CEo
aMissingArgumen	db 'missing argument',0Ah,0 ; DATA XREF: sub_404664+E2o
aInvalidCommand	db 'invalid command',0Ah,0 ; DATA XREF: sub_404664+F6o
aInvalidAliasDe	db 'invalid alias definition',0Ah,0 ; DATA XREF: sub_404664+10Ao
aInvalidOption	db 'invalid option',0Ah,0 ; DATA XREF: sub_404664:loc_404777o
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_404664+131o
a??		db '[??]',0             ; DATA XREF: sub_404664:loc_4047B8o
		align 4
; char aMissingArgum_0[]
aMissingArgum_0	db 'Missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_404664+16Eo
		align 4
; char aOption_50sDoes[]
aOption_50sDoes	db 'Option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_404664+191o
; char aInvalidComma_0[]
aInvalidComma_0	db 'Invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_404664+1B1o
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'Option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_404664+1D1o
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'Command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_404664+1F1o
; char aInvalidOption_[]
aInvalidOption_	db 'Invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_404664+206o
asc_40CD74	db ' ',9,0              ; DATA XREF: .text:00404B22o
aAlias		db 'alias',0            ; DATA XREF: .text:00404DE2o
; char Str1[]
Str1		db 'help',0             ; DATA XREF: sub_405102+1A6o
; char aVersion[]
aVersion	db 'version',0          ; DATA XREF: sub_405102+1E0o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_405102+222o
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_405102+266o
; char aS[]
aS		db '--%s',0Ah,0         ; DATA XREF: sub_405102+29Bo
		align 4
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_405102+2C7o
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_40CDD4	db 'x',0                ; DATA XREF: sub_405102:loc_4057E5o
; char aOptions[]
aOptions	db 'Options:',0         ; DATA XREF: sub_405A11+CEo
; char aC[]
aC		db ' -%c',0             ; DATA XREF: sub_405A11+1A9o
asc_40CDE4	db '   ',0              ; DATA XREF: sub_405A11+23Do
					; sub_405A11+32Ao
; char aCS[]
aCS		db '%c --%s',0          ; DATA XREF: sub_405A11:loc_405CADo
; char aASingleDashMay[]
aASingleDashMay	db 0Ah			; DATA XREF: sub_405A11+454o
		db '(A single dash may be used instead of the double ones)',0
; char SubStr[]
SubStr		db '@EMAIL@',0          ; DATA XREF: sub_405A11+485o
aBugDirmngr@g_0	db 'bug-dirmngr@gnupg.org',0 ; DATA XREF: sub_405A11+4E8o
; char aS_0[]
aS_0		db ' (%s)',0            ; DATA XREF: sub_405F74+3Co
; char aS_1[]
aS_1		db ' %s',0Ah,0          ; DATA XREF: sub_405F74+5Co
; char aSSS[]
aSSS		db '%s %s; %s',0Ah,0    ; DATA XREF: sub_4060FF+36o
aLicenseGplv3Gn	db 'License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licens'
					; DATA XREF: sub_4061CC:loc_406212o
		db 'es/gpl.html>',0
aFoo		db 'foo',0              ; DATA XREF: sub_4061CC:loc_40621Bo
a0_0		db '0.0',0              ; DATA XREF: sub_4061CC:loc_406224o
		align 4
aCopyrightC2010	db 'Copyright (C) 2010 Free Software Foundation, Inc.',0
					; DATA XREF: sub_4061CC:loc_40622Do
		align 4
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_4061CC:loc_406236o
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 4
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_4061CC:loc_40623Fo
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 3 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_40D1B8	dd 0			; DATA XREF: sub_4061CC:loc_406248o
off_40D1BC	dd offset loc_406212	; DATA XREF: sub_4061CC+3Dr
		dd offset loc_40621B	; jump table for switch	statement
		dd offset loc_406250
		dd offset loc_406224
		dd offset loc_40622D
		dd offset loc_406236
		dd offset loc_40623F
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406250
		dd offset loc_406248
		dd offset loc_406248
byte_40D23C	db 2Dh,	0		; DATA XREF: sub_406299+13o
					; sub_406536:loc_406547o
aSocket		db 'socket://',0        ; DATA XREF: sub_406299+5Bo
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_406299+BBo
; char aA[]
aA		db 'a',0                ; DATA XREF: sub_406299+EFo
					; sub_406299:loc_4063C7o
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_406299+1B7o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_406299+1EFo
		align 4
; char a____Dirmngr1_2[]
a____Dirmngr1_2	db '../../dirmngr-1.1.1/jnlib/logging.c',0 ; DATA XREF: sub_4066F8+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_4066F8+37o
		align 4
; char a04d02d02d02d02[]
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_4066F8+E3o
; char aU_D[]
aU_D		db '[%u.%d]',0          ; DATA XREF: sub_4066F8+178o
; char aU[]
aU		db '[%u]',0             ; DATA XREF: sub_4066F8:loc_406893o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_4066F8+229o
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_4066F8+252o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_4066F8+27Bo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_4066F8:loc_406996o
		align 4
off_40D36C	dd offset loc_4069B5	; DATA XREF: sub_4066F8+21Ao
		dd offset loc_4069B5	; jump table for switch	statement
		dd offset loc_4069B5
		dd offset loc_4069B5
		dd offset loc_4069B5
		dd offset loc_40691B
		dd offset loc_406944
		dd offset loc_40696D
dword_40D38C	dd 207325h		; DATA XREF: .text:00406C0Do
a02x_0		db '%02X',0             ; DATA XREF: .text:00406C32o
a02x_1		db ' %02X',0            ; DATA XREF: .text:00406C55o
asc_40D39B	db 0Ah,0		; DATA XREF: .text:00406C7Ao
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_406C88+1Bo
		align 4
asc_40D3BC	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:00407062o
					; .text:004070FAo
a_		db '.',0                ; DATA XREF: .text:00407177o
aHome		db 'HOME',0             ; DATA XREF: .text:0040725Do
; char aX02x[]
aX02x		db 'x%02x',0            ; DATA XREF: sub_407453+16Eo
					; .text:004079C1o
		align 10h
; char aEcLu[]
aEcLu		db 'ec=%lu',0           ; DATA XREF: sub_40816B+Do
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_4082D4+C6o
					; .text:loc_40859Eo ...
; CHAR aIconv_dll[]
aIconv_dll	db 'iconv.dll',0        ; DATA XREF: sub_4081C2+25o
					; sub_4081C2+ACo
; CHAR aLibiconv_open[]
aLibiconv_open	db 'libiconv_open',0    ; DATA XREF: sub_4081C2+3Ao
; CHAR aLibiconv[]
aLibiconv	db 'libiconv',0         ; DATA XREF: sub_4081C2+5Bo
; CHAR aLibiconv_close[]
aLibiconv_close	db 'libiconv_close',0   ; DATA XREF: sub_4081C2+7Co
; char aErrorLoadingSS[]
aErrorLoadingSS	db 'error loading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4081C2+B4o
		align 4
; char aPleaseSeeHttpW[]
aPleaseSeeHttpW	db 'please see http://www.gnupg.org/download/iconv.html for more info'
					; DATA XREF: sub_4081C2+C0o
		db 'rmation',0Ah,0
aUtf8		db 'utf-8',0            ; DATA XREF: sub_4082D4+21o
					; .text:004085E2o ...
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_4082D4+7Eo
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_4082D4+AAo
aCpU		db 'CP%u',0             ; DATA XREF: .text:loc_4083F4o
aCp936		db 'CP936',0            ; DATA XREF: .text:00408417o
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: .text:00408505o
a88591		db '8859-1',0           ; DATA XREF: .text:00408542o
a646		db '646',0              ; DATA XREF: .text:00408559o
aAscii		db 'ASCII',0            ; DATA XREF: .text:00408570o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: .text:00408587o
aUtf8_0		db 'utf8',0             ; DATA XREF: .text:loc_4085CBo
		align 10h
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_40872A+213o
					; sub_408986+74Bo
; char aX02x_0[]
aX02x_0		db '\x%02x',0           ; DATA XREF: sub_408986+7Do
					; sub_408986+3B0o ...
; char aX02x_1[]
aX02x_1		db 'x%02x',0            ; DATA XREF: sub_408986+1DDo
		align 4
a____Dirmngr1_3	db '../../dirmngr-1.1.1/jnlib/utf8conv.c',0 ; DATA XREF: sub_408986+6C5o
		align 10h
off_40D660	dd offset loc_408B3A	; DATA XREF: sub_408986+12Br
		dd offset loc_408B50	; jump table for switch	statement
		dd offset loc_408B50
		dd offset loc_408B50
		dd offset loc_408B50
		dd offset loc_408B50
		dd offset loc_408B50
		dd offset loc_408B50
		dd offset loc_408B24
		dd offset loc_408B50
		dd offset loc_408ABA
		dd offset loc_408B0E
		dd offset loc_408AF4
		dd offset loc_408AD7
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_408986+6B5o
		align 4
; char a0[]
a0		db '-+ #0',0            ; DATA XREF: sub_409224+71o
; char aHll[]
aHll		db 'hlL',0              ; DATA XREF: sub_409224+14Bo
		align 4
off_40D6B8	dd offset loc_4093A8, offset loc_409407, offset	loc_4093A8
					; DATA XREF: sub_409224+170r
		dd offset loc_409407, offset loc_409407, offset	loc_409407 ; jump table	for switch statement
		dd offset loc_409407, offset loc_409407, offset	loc_409407
		dd offset loc_409407, offset loc_409407, offset	loc_409407
		dd offset loc_409407, offset loc_409407, offset	loc_409407
		dd offset loc_409407, offset loc_409407, offset	loc_409407
		dd offset loc_409407, offset loc_40939D, offset	loc_409407
		dd offset loc_409407, offset loc_409407, offset	loc_409407
		dd offset loc_409407, offset loc_409407, offset	loc_409407
		dd offset loc_409407, offset loc_409407, offset	loc_409407
		dd offset loc_40939D, offset loc_40939D, offset	loc_4093A8
		dd offset loc_4093A8, offset loc_4093A8, offset	loc_409407
		dd offset loc_40939D, offset loc_409407, offset	loc_409407
		dd offset loc_409407, offset loc_409407, offset	loc_4093FD
		dd offset loc_40939D, offset loc_4093FD, offset	loc_409407
		dd offset loc_409407, offset loc_4093BA, offset	loc_409407
		dd offset loc_40939D, offset loc_409407, offset	loc_409407
		dd offset loc_40939D
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_40D7C4	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_4099F0+3o
		align 4
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_4099F0+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_40D8E4o
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0040D8E8o
		align 10h
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0040D8ECo
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0040D8F0o
		align 4
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0040D8F4o
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0040D8F8o
		align 4
off_40D8E4	dd offset aArgumentDomain ; DATA XREF: sub_4099F0+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_409A60+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_409AC0+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_409AC0+1F9o
					; sub_409AC0+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_409AC0+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_409D00+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_409D00+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_40A2B0:loc_40A350o
		unicode	0, <msvcrt.dll>,0
		align 4
off_40DA0C	dd offset dword_40E820	; DATA XREF: .text:0040A548o
		dd offset dword_40E540
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_40A860+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_2[]
aS_2		db '%s',0Ah,0           ; DATA XREF: sub_40A860+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_40A860+10Fo
		align 4
dword_40DA74	dd 0			; DATA XREF: sub_409D00+59o
					; sub_409D00+5Eo ...
dword_40DA78	dd 0			; DATA XREF: sub_409D00+7Fr
dword_40DA7C	dd 0			; DATA XREF: sub_409D00:loc_409E4Cr
dword_40DA80	dd 60h dup(0)		; DATA XREF: sub_409D00+155o
		align 800h
_rdata		ends

; Section 4. (virtual address 0000E000)
; Virtual size			: 000008DC (   2268.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 40E000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_40E000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_40E004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_40E008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_40E00C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_40E010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_40E014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_40E018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_40E01C	dd ?			; DATA XREF: sub_401010+3Aw
dword_40E020	dd ?			; DATA XREF: sub_401650:loc_4017C9r
					; sub_401650+181w ...
dword_40E024	dd ?			; DATA XREF: sub_401650:loc_4017B7r
					; sub_401650+16Fw ...
; char *Str
Str		dd ?			; DATA XREF: sub_401E06:loc_401EDDr
					; sub_401E06+E0r ...
dword_40E02C	dd ?			; DATA XREF: sub_401E06+Dr
					; sub_401E06:loc_40204Bw ...
dword_40E030	dd ?			; DATA XREF: sub_401650:loc_40185Bw
					; sub_40294C+38r
dword_40E034	dd ?			; DATA XREF: sub_401650:loc_401832w
					; sub_401650:loc_40183Ew ...
dword_40E038	dd ?			; DATA XREF: sub_401650+1F8w
					; sub_4021B3+83r
dword_40E03C	dd ?			; DATA XREF: sub_401650:loc_401811w
					; sub_402B77+7r ...
dword_40E040	dd ?			; DATA XREF: sub_401650:loc_40181Dw
					; sub_402D4E:loc_402E0Dr
dword_40E044	dd ?			; DATA XREF: sub_401650:loc_4017DBr
					; sub_401650+193w ...
		align 20h
byte_40E060	db ?			; DATA XREF: sub_401650+26Bo
					; sub_401650+29Cw ...
		align 4
		dd 3Fh dup(?)
dword_40E160	dd ?			; DATA XREF: sub_4043EB+Br
					; sub_4043EB+CFw ...
dword_40E164	dd ?			; DATA XREF: .text:00404266r
					; .text:004043D0w ...
dword_40E168	dd ?			; DATA XREF: .text:004041C1r
					; .text:00404228w ...
dword_40E16C	dd ?			; DATA XREF: .text:00404111r
					; .text:00404178w ...
dword_40E170	dd ?			; DATA XREF: sub_404039+Br
					; sub_404039+A8w ...
dword_40E174	dd ?			; DATA XREF: sub_403F7B+6r
					; sub_403F7B:loc_403FD6w
		align 10h
; CHAR Filename
Filename	db ?			; DATA XREF: sub_403F7B+1Bo
					; sub_403F7B+54w ...
		align 4
		dd 42h dup(?)
dword_40E28C	dd ?			; DATA XREF: .text:loc_403EDCr
					; .text:00403F3Fw ...
; LPCSTR lpPathName
lpPathName	dd ?			; DATA XREF: sub_403DAF+Br
					; sub_403DAF+B4w ...
dword_40E294	dd ?			; DATA XREF: .text:00403CF8r
					; .text:00403D5Fw ...
dword_40E298	dd ?			; DATA XREF: sub_403C16+6r
					; sub_403C16+13w
dword_40E29C	dd ?			; DATA XREF: sub_403C16+63w
					; sub_403C16+68r ...
dword_40E2A0	dd ?			; DATA XREF: sub_4061CC+6r
					; sub_4061CC+Fr ...
		align 20h
; FILE *File
File		dd ?			; DATA XREF: sub_406299+154r
					; sub_406299+165r ...
		align 20h
; char Dest[79]
Dest		db 4Fh dup(?)		; DATA XREF: sub_406586+1Bo
					; sub_4065E4:loc_406656o ...
byte_40E32F	db ?			; DATA XREF: sub_406586+27w
dword_40E330	dd ?			; DATA XREF: sub_406586+3Fw
					; sub_4065E4:loc_40660Er ...
dword_40E334	dd ?			; DATA XREF: sub_406586+34w
					; sub_4065E4+12r ...
dword_40E338	dd ?			; DATA XREF: sub_406586+4Aw
					; sub_4065E4:loc_406626r ...
dword_40E33C	dd ?			; DATA XREF: .text:0040657Fw
					; sub_4066F8+15Ar ...
dword_40E340	dd ?			; DATA XREF: sub_406586+57w
					; sub_4065E4:loc_40663Er
dword_40E344	dd ?			; DATA XREF: sub_406299+287w
					; sub_4066F8+88r ...
dword_40E348	dd ?			; DATA XREF: sub_406299+28Cw
					; sub_4066F8:loc_40673Br ...
dword_40E34C	dd ?			; DATA XREF: sub_406264+6r
					; sub_406264+14w ...
		align 20h
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_407A48+29o
					; sub_407A48+56o
dword_40E460	dd ?			; DATA XREF: sub_4082D4+DAw
					; .text:004085B2w ...
dword_40E464	dd ?			; DATA XREF: sub_4082D4+D0w
					; .text:004085A8w ...
dword_40E468	dd ?			; DATA XREF: sub_4082D4+E4w
					; .text:004085BCw ...
dword_40E46C	dd ?			; DATA XREF: sub_4081C2+4Dw
					; sub_4081C2+52r ...
dword_40E470	dd ?			; DATA XREF: sub_4081C2+6Ew
					; sub_4081C2:loc_408235r ...
dword_40E474	dd ?			; DATA XREF: sub_4081C2+8Fw
					; sub_4081C2+9Ar ...
dword_40E478	dd ?			; DATA XREF: sub_408986+71Br
					; sub_408986:loc_4090DDw
dword_40E47C	dd ?			; DATA XREF: sub_40872A+1E3r
					; sub_40872A:loc_408949w
dword_40E480	dd 8 dup(?)		; DATA XREF: .text:00408404o
					; .text:00408410o ...
dword_40E4A0	dd ?			; DATA XREF: sub_4082D4+44r
					; sub_4082D4+4Cw
dword_40E4A4	dd ?			; DATA XREF: sub_4082D4:loc_40832Cr
					; sub_4082D4+60w
dword_40E4A8	dd ?			; DATA XREF: sub_4082D4:loc_408360r
					; sub_4082D4:loc_40838Aw
dword_40E4AC	dd ?			; DATA XREF: sub_4081C2+6r
					; sub_4081C2+13w
		align 20h
; char byte_40E4C0[52]
byte_40E4C0	db 34h dup(?)		; DATA XREF: sub_40816B+1Ao
					; sub_40816B+26o
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_40E4FC	dd ?			; DATA XREF: sub_401060+2Cw
dword_40E500	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_40E504	dd ?			; DATA XREF: sub_401060+5Er
dword_40E508	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_40986Cr
dword_40E50C	dd ?			; DATA XREF: .text:00409993r
					; sub_4099E0+4w
dword_40E510	dd ?			; DATA XREF: sub_409D00+9r
					; sub_409D00:loc_409D20w
dword_40E514	dd ?			; DATA XREF: sub_409AC0+1Dr
					; sub_409AC0+58r ...
dword_40E518	dd ?			; DATA XREF: sub_409AC0+Br
					; sub_409AC0:loc_409B7Fw ...
dword_40E51C	dd ?			; DATA XREF: sub_40A2B0+4r
					; sub_40A2B0+92w ...
dword_40E520	dd ?			; DATA XREF: sub_40A400r
					; sub_40A400:loc_40A410w
		align 20h
dword_40E540	dd 2Bh dup(?)		; DATA XREF: .rdata:0040DA10o
dword_40E5EC	dd ?			; DATA XREF: .text:0040A52Aw
		dd 2 dup(?)
dword_40E5F8	dd ?			; DATA XREF: .text:0040A516w
		dd 2 dup(?)
dword_40E604	dd ?			; DATA XREF: .text:0040A4FCw
		dd 86h dup(?)
dword_40E820	dd ?			; DATA XREF: .text:0040A502w
					; .rdata:off_40DA0Co
dword_40E824	dd ?			; DATA XREF: .text:0040A50Cw
		dd ?
dword_40E82C	dd ?			; DATA XREF: .text:0040A51Bw
		align 80h
dword_40E880	dd ?			; DATA XREF: .text:0040A5F3r
					; .text:0040A684r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_40A580+7o
					; sub_40A580:loc_40A5D5o ...
dword_40E89C	dd ?			; DATA XREF: sub_40A580+14r
					; .text:0040A648r ...
		dd ?
dword_40E8A4	dd ?			; DATA XREF: sub_401180+1A8w
dword_40E8A8	dd ?			; DATA XREF: sub_401180+1BFw
dword_40E8AC	dd ?			; DATA XREF: sub_401180+1B2w
dword_40E8B0	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_409653w ...
dword_40E8B4	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_40E8B8	dd ?			; DATA XREF: TlsCallback_0:loc_4095A4w
dword_40E8BC	dd ?			; DATA XREF: sub_401060+64w
					; sub_409720+3Fr ...
dword_40E8C0	dd ?			; DATA XREF: sub_401060+69w
					; sub_409720+4r ...
dword_40E8C4	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_40E8C8	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 800h
_bss		ends

;
; Imports from libassuan-0.dll
;
; Section 5. (virtual address 0000F000)
; Virtual size			: 00000D24 (   3364.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 0000C000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_assuan_new:dword ; DATA XREF: assuan_newr
		extrn __imp_assuan_pipe_connect:dword ;	DATA XREF: assuan_pipe_connectr
		extrn __imp_assuan_release:dword ; DATA	XREF: assuan_releaser
		extrn __imp_assuan_send_data:dword ; DATA XREF:	assuan_send_datar
		extrn __imp_assuan_set_assuan_log_prefix:dword
					; DATA XREF: assuan_set_assuan_log_prefixr
		extrn __imp_assuan_set_gpg_err_source:dword
					; DATA XREF: assuan_set_gpg_err_sourcer
		extrn __imp_assuan_socket_connect:dword	; DATA XREF: assuan_socket_connectr
		extrn __imp_assuan_transact:dword ; DATA XREF: assuan_transactr

;
; Imports from libgpg-error-0.dll
;
		extrn __imp_gpg_err_code_from_errno:dword
					; DATA XREF: gpg_err_code_from_errnor
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr

;
; Imports from ADVAPI32.dll
;
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_40372D+233p
					; sub_40372D+4DAp
					; DATA XREF: ...
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_40372D+183p
					; sub_40372D+1C6p ...
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_40372D+211p
					; sub_40372D+2A6p ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_408198+17p
					; DATA XREF: sub_408198+12r
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: sub_403DAF+E7p
					; .text:004043BBp
					; DATA XREF: ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_40A720+44p
					; DATA XREF: sub_40A720+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_40A580+Ep
					; .text:0040A642p ...
; DWORD	__stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR	lpDst, DWORD nSize)
		extrn ExpandEnvironmentStringsA:dword ;	CODE XREF: sub_40372D+392p
					; sub_40372D+3F8p
					; DATA XREF: ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_407A48+51p
					; DATA XREF: sub_407A48+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: sub_403703+17p
					; TlsCallback_0+10Ap
					; DATA XREF: ...
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: .text:004083EFp
					; DATA XREF: .text:004083EAr
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: .text:004083DFp
					; DATA XREF: .text:004083DAr
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:0040A558p
					; DATA XREF: .text:0040A558r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_40A420+6Cp
					; DATA XREF: sub_40A420+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_40A420+74p
					; DATA XREF: sub_40A420+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_407A48+11p
					; sub_40816B+Bp ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_403F7B+2Fp
					; sub_40A860+C2p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_40A2B0+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_40A420+57p
					; DATA XREF: sub_40A420+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_40A420+7Cp
					; DATA XREF: sub_40A420+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_40A720+87p
					; DATA XREF: sub_40A720+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_40A580+5Cp
					; .text:0040A660p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_4036A0+11p
					; sub_408108+11p ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_40A2B0+A7p
					; DATA XREF: sub_40A2B0+A7r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_40A420+8Bp
					; DATA XREF: sub_40A420+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0040A53Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:0040A569p
					; DATA XREF: .text:0040A569r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_40A580+35p
					; DATA XREF: sub_40A580+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0040A54Fp
					; DATA XREF: .text:0040A54Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_409AC0+142p
					; sub_409AC0+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_409AC0+A1p
					; sub_409AC0+D9p ...

;
; Imports from msvcrt.dll
;
		extrn __imp__access:dword ; DATA XREF: _accessr
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_4096F0r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_4021B3+3Cp
					; sub_402612+5Cp ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _get_osfhandle:dword ; CODE XREF:	sub_4015BA+1Ep
					; DATA XREF: sub_4015BA+19r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_401E06:loc_401F67r
					; sub_4021B3:loc_4021DCr ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_409720+A3p
					; DATA XREF: sub_409720+A3r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: .text:00404D14p
					; .text:00404D55p ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_40AB40r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_40AB30r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: sub_406C88+69p
					; sub_406C88+7Ep ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr
; int __cdecl vsprintf(char *Dest, const char *Format, va_list Args)
		extrn __imp_vsprintf:dword ; DATA XREF:	vsprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_40A860+122p
					; DATA XREF: sub_40A860+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: sub_401650+83p
					; DATA XREF: sub_401650+7Er


; Section 6. (virtual address 00010000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000CE00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 410000h
dword_410000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_410008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_41000C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_4096F0
dword_410018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_410030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_409693o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00011000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000D000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 411000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
