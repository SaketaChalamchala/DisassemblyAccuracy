;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	34C47770E51A33C5850F15C9219372AF
; Input	CRC32 :	9E175FE0

; File Name   :	C:\compspace\compare\gpg\dlls\original\libw32pth-0.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	63AC0000
; Section 1. (virtual address 00001000)
; Virtual size			: 000083D4 (  33748.)
; Section size in file		: 00008400 (  33792.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 63AC1000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_63AC1000	proc near		; DATA XREF: .CRT:63AD000Co

Size		= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	[esp+1Ch+Size],	80h ; Size
		call	malloc
		mov	ebx, eax
		mov	[esp+1Ch+Size],	eax
		call	sub_63AC8210
		test	ebx, ebx
		mov	ds:dword_63ACD7D4, eax
		mov	ds:dword_63ACD7D0, eax
		mov	eax, 1
		jz	short loc_63AC1035
		mov	dword ptr [ebx], 0
		xor	al, al

loc_63AC1035:				; CODE XREF: sub_63AC1000+2Bj
		add	esp, 18h
		pop	ebx
		retn
sub_63AC1000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC1040	proc near		; CODE XREF: sub_63AC1260+A0p
					; sub_63AC1260+124p ...

dwMilliseconds	= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	ebx
		sub	esp, 14h
		mov	edx, [esp+1Ch+arg_4]
		test	edx, edx
		jnz	short loc_63AC10C6
		mov	edx, ds:dword_63ACD000
		xor	eax, eax
		test	edx, edx
		jle	short loc_63AC10BE
		sub	edx, 1
		mov	ebx, ds:Sleep
		mov	ds:dword_63ACD000, edx
		jmp	short loc_63AC107C
; ---------------------------------------------------------------------------
		align 10h

loc_63AC1070:				; CODE XREF: sub_63AC1040+5Dj
		mov	[esp+1Ch+dwMilliseconds], 3E8h ; dwMilliseconds
		call	ebx ; Sleep
		sub	esp, 4

loc_63AC107C:				; CODE XREF: sub_63AC1040+28j
		mov	[esp+1Ch+var_14], 0
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+dwMilliseconds], offset dword_63ACD7D8
		call	sub_63AC8FD0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_63AC1070
		mov	eax, ds:dword_63ACD7DC
		cmp	eax, 2
		jz	loc_63AC1183
		mov	[esp+1Ch+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, 1

loc_63AC10BE:				; CODE XREF: sub_63AC1040+17j
					; sub_63AC1040+8Ej
		add	esp, 14h
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_63AC10C6:				; CODE XREF: sub_63AC1040+Bj
		cmp	edx, 1
		mov	eax, 1
		jnz	short loc_63AC10BE
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_63AC10F5
; ---------------------------------------------------------------------------

loc_63AC10E1:				; CODE XREF: sub_63AC1040+D2j
		cmp	eax, ebx
		jz	loc_63AC11F7
		mov	[esp+1Ch+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_63AC10F5:				; CODE XREF: sub_63AC1040+9Fj
		mov	[esp+1Ch+var_14], 0
		mov	[esp+1Ch+var_18], ebx
		mov	[esp+1Ch+dwMilliseconds], offset dword_63ACD7D8
		call	sub_63AC8FD0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_63AC10E1
		xor	ebx, ebx

loc_63AC1116:				; CODE XREF: sub_63AC1040+1BCj
		mov	eax, ds:dword_63ACD7DC
		cmp	eax, 1
		jz	loc_63AC1224
		mov	eax, ds:dword_63ACD7DC
		test	eax, eax
		jz	loc_63AC1201

loc_63AC1131:				; CODE XREF: sub_63AC1040+1DFj
					; sub_63AC1040+1F0j
		mov	eax, ds:dword_63ACD7DC
		cmp	eax, 1
		jz	loc_63AC1235

loc_63AC113F:				; CODE XREF: sub_63AC1040+213j
		test	ebx, ebx
		jnz	short loc_63AC114A
		lock xchg ebx, ds:dword_63ACD7D8

loc_63AC114A:				; CODE XREF: sub_63AC1040+101j
		mov	eax, ds:off_63ACC40C
		test	eax, eax
		jz	short loc_63AC116F
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], 2
		mov	[esp+1Ch+var_14], edx
		mov	edx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+dwMilliseconds], edx
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_63AC116F:				; CODE XREF: sub_63AC1040+111j
		add	ds:dword_63ACD000, 1
		add	esp, 14h
		mov	eax, 1
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_63AC1183:				; CODE XREF: sub_63AC1040+67j
		mov	eax, ds:dword_63ACD7D4
		mov	[esp+1Ch+dwMilliseconds], eax
		call	sub_63AC8200
		test	eax, eax
		mov	ebx, eax
		jz	short loc_63AC11D7
		mov	eax, ds:dword_63ACD7D0
		mov	[esp+1Ch+dwMilliseconds], eax
		call	sub_63AC8200
		mov	esi, eax

loc_63AC11A5:				; CODE XREF: sub_63AC1040+170j
		sub	esi, 4
		cmp	ebx, esi
		ja	short loc_63AC11BB

loc_63AC11AC:				; CODE XREF: sub_63AC1040+179j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_63AC11A5
		sub	esi, 4
		call	eax
		cmp	ebx, esi
		jbe	short loc_63AC11AC

loc_63AC11BB:				; CODE XREF: sub_63AC1040+16Aj
		mov	[esp+1Ch+dwMilliseconds], ebx ;	Memory
		call	free
		mov	ds:dword_63ACD7D0, 0
		mov	ds:dword_63ACD7D4, 0

loc_63AC11D7:				; CODE XREF: sub_63AC1040+154j
		mov	ds:dword_63ACD7DC, 0
		xor	eax, eax
		lock xchg eax, ds:dword_63ACD7D8
		add	esp, 14h
		mov	eax, 1
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_63AC11F7:				; CODE XREF: sub_63AC1040+A3j
		mov	ebx, 1
		jmp	loc_63AC1116
; ---------------------------------------------------------------------------

loc_63AC1201:				; CODE XREF: sub_63AC1040+EBj
		mov	[esp+1Ch+var_18], offset dword_63AD0010
		mov	[esp+1Ch+dwMilliseconds], offset dword_63AD0008
		mov	ds:dword_63ACD7DC, 1
		call	_initterm
		jmp	loc_63AC1131
; ---------------------------------------------------------------------------

loc_63AC1224:				; CODE XREF: sub_63AC1040+DEj
		mov	[esp+1Ch+dwMilliseconds], 1Fh
		call	_amsg_exit
		jmp	loc_63AC1131
; ---------------------------------------------------------------------------

loc_63AC1235:				; CODE XREF: sub_63AC1040+F9j
		mov	[esp+1Ch+var_18], offset dword_63AD0004
		mov	[esp+1Ch+dwMilliseconds], offset dword_63AD0000
		call	_initterm
		mov	ds:dword_63ACD7DC, 2
		jmp	loc_63AC113F
sub_63AC1040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC1260	proc near		; CODE XREF: DllEntryPoint+1Ep

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 2Ch
		test	edx, edx
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, eax
		mov	[esp+2Ch+var_C], esi
		mov	esi, edx
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, ecx
		mov	[esp+2Ch+var_8], edi
		mov	dword_63ACA034,	edx
		jnz	loc_63AC1314
		mov	eax, ds:dword_63ACD000
		xor	edi, edi
		test	eax, eax
		jz	short loc_63AC12B9
		call	sub_63AC84C0
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC8FF0
		sub	esp, 0Ch
		mov	edi, eax

loc_63AC12B0:				; CODE XREF: sub_63AC1260+D8j
					; sub_63AC1260+E1j ...
		cmp	esi, 3
		jz	short loc_63AC12E0
		test	esi, esi
		jz	short loc_63AC12E0

loc_63AC12B9:				; CODE XREF: sub_63AC1260+30j
					; sub_63AC1260+B2j ...
		mov	eax, edi
		mov	ebx, [esp+2Ch+var_10]
		mov	dword_63ACA034,	0FFFFFFFFh
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC12E0:				; CODE XREF: sub_63AC1260+53j
					; sub_63AC1260+57j
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC9000
		sub	esp, 0Ch
		mov	edi, eax
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC1040
		sub	esp, 0Ch
		test	eax, eax
		mov	eax, 0
		cmovz	edi, eax
		jmp	short loc_63AC12B9
; ---------------------------------------------------------------------------

loc_63AC1314:				; CODE XREF: sub_63AC1260+21j
		call	sub_63AC84C0
		lea	eax, [esi-1]
		cmp	eax, 1
		jbe	short loc_63AC1391

loc_63AC1321:				; CODE XREF: sub_63AC1260+19Aj
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC8FF0
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jnz	loc_63AC12B0
		cmp	esi, 1
		jnz	loc_63AC12B0
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC8FF0
		sub	esp, 0Ch
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC9000
		sub	esp, 0Ch
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC1040
		sub	esp, 0Ch
		jmp	loc_63AC12B0
; ---------------------------------------------------------------------------

loc_63AC1391:				; CODE XREF: sub_63AC1260+BFj
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC1040
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jz	loc_63AC12B9
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC9000
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jnz	short loc_63AC13F0
		cmp	esi, 1
		jnz	loc_63AC12B9
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC1040
		sub	esp, 0Ch
		jmp	loc_63AC12B9
; ---------------------------------------------------------------------------
		align 10h

loc_63AC13F0:				; CODE XREF: sub_63AC1260+165j
		cmp	esi, 1
		jnz	short loc_63AC13FF
		call	sub_63AC87F0
		jmp	loc_63AC1321
; ---------------------------------------------------------------------------

loc_63AC13FF:				; CODE XREF: sub_63AC1260+193j
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 2
		mov	[esp+2Ch+var_2C], ebx
		call	sub_63AC8FF0
		sub	esp, 0Ch
		mov	edi, eax
		jmp	loc_63AC12B0
sub_63AC1260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
		public DllEntryPoint
DllEntryPoint	proc near

var_10		= dword	ptr -10h
hinstDLL	= dword	ptr  4
fdwReason	= dword	ptr  8
lpReserved	= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	edx, [esp+1Ch+fdwReason]
		mov	ds:dword_63ACD434, 0
		cmp	edx, 1
		jz	short loc_63AC1450

loc_63AC1436:				; CODE XREF: DllEntryPoint+3Dj
		mov	ecx, [esp+1Ch+lpReserved]
		mov	eax, [esp+1Ch+hinstDLL]
		call	sub_63AC1260
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_63AC1450:				; CODE XREF: DllEntryPoint+14j
		mov	[esp+1Ch+var_10], edx
		call	sub_63AC8810
		mov	edx, [esp+1Ch+var_10]
		jmp	short loc_63AC1436
DllEntryPoint	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC1460	proc near		; CODE XREF: sub_63AC93A0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_63ACA048
		test	eax, eax
		jz	short locret_63AC14AB
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_63AC149E
		mov	[esp+18h+lpProcName], offset ProcName ;	"_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_63AC149E:				; CODE XREF: sub_63AC1460+26j
		test	edx, edx
		jz	short locret_63AC14AB
		mov	[esp+18h+lpModuleName],	offset dword_63ACA048
		call	edx

locret_63AC14AB:			; CODE XREF: sub_63AC1460+Dj
					; sub_63AC1460+40j
		leave
		retn
sub_63AC1460	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC14B0()
sub_63AC14B0	proc near		; DATA XREF: sub_63AC93A0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_63AC14B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC14C0	proc near		; CODE XREF: sub_63AC20AF+2B7p
					; sub_63AC20AF+30Dp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		leave
		retn
sub_63AC14C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC14D4(size_t)
sub_63AC14D4	proc near		; CODE XREF: pth_init+D5p
					; sub_63AC5144+69p

Size		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_63AC14D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC14ED(size_t, size_t)
sub_63AC14ED	proc near		; CODE XREF: pth_attr_new+23p
					; sub_63AC351B+51p ...

NumOfElements	= dword	ptr -28h
SizeOfElements	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+SizeOfElements], eax ;	SizeOfElements
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_63AC14ED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC150D(void	*)
sub_63AC150D	proc near		; CODE XREF: pth_init+16Ap
					; pth_attr_destroy+34p	...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_63AC1524
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_63AC1524:			; CODE XREF: sub_63AC150D+Aj
		leave
		retn
sub_63AC150D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC1526(LPSTR, DWORD)
sub_63AC1526	proc near		; CODE XREF: sub_63AC17A9+81p
					; sub_63AC17A9+10Dp ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 1
		jbe	short loc_63AC1574
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+nSize], edx ; nSize
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+lpBuffer], edx	; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch

loc_63AC1574:				; CODE XREF: sub_63AC1526+Aj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_63AC1526	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC1579(LPSTR, DWORD)
sub_63AC1579	proc near		; CODE XREF: sub_63AC392F+3ECp
					; sub_63AC4154+8F9p ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 1
		jbe	short loc_63AC15C7
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+nSize], edx ; nSize
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+lpBuffer], edx	; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch

loc_63AC15C7:				; CODE XREF: sub_63AC1579+Aj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_63AC1579	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC15CC	proc near		; CODE XREF: sub_63AC20AF+305p
					; sub_63AC25A1+2EDp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 271Eh
		jz	short loc_63AC1651
		cmp	eax, 271Eh
		jg	short loc_63AC1607
		cmp	eax, 2714h
		jz	short loc_63AC163C
		cmp	eax, 2714h
		jg	short loc_63AC15F7
		test	eax, eax
		jz	short loc_63AC1635
		jmp	loc_63AC167B
; ---------------------------------------------------------------------------

loc_63AC15F7:				; CODE XREF: sub_63AC15CC+20j
		cmp	eax, 2719h
		jz	short loc_63AC1643
		cmp	eax, 271Dh
		jz	short loc_63AC164A
		jmp	short loc_63AC167B
; ---------------------------------------------------------------------------

loc_63AC1607:				; CODE XREF: sub_63AC15CC+12j
		cmp	eax, 2733h
		jz	short loc_63AC1666
		cmp	eax, 2733h
		jg	short loc_63AC1625
		cmp	eax, 2726h
		jz	short loc_63AC1658
		cmp	eax, 2728h
		jz	short loc_63AC165F
		jmp	short loc_63AC167B
; ---------------------------------------------------------------------------

loc_63AC1625:				; CODE XREF: sub_63AC15CC+47j
		cmp	eax, 274Fh
		jz	short loc_63AC166D
		cmp	eax, 2752h
		jz	short loc_63AC1674
		jmp	short loc_63AC167B
; ---------------------------------------------------------------------------

loc_63AC1635:				; CODE XREF: sub_63AC15CC+24j
		mov	eax, 0
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC163C:				; CODE XREF: sub_63AC15CC+19j
		mov	eax, 4
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC1643:				; CODE XREF: sub_63AC15CC+30j
		mov	eax, 9
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC164A:				; CODE XREF: sub_63AC15CC+37j
		mov	eax, 0Dh
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC1651:				; CODE XREF: sub_63AC15CC+Bj
		mov	eax, 0Eh
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC1658:				; CODE XREF: sub_63AC15CC+4Ej
		mov	eax, 16h
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC165F:				; CODE XREF: sub_63AC15CC+55j
		mov	eax, 18h
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC1666:				; CODE XREF: sub_63AC15CC+40j
		mov	eax, 0Bh
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC166D:				; CODE XREF: sub_63AC15CC+5Ej
		mov	eax, 26h
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC1674:				; CODE XREF: sub_63AC15CC+65j
		mov	eax, 29h
		jmp	short loc_63AC1680
; ---------------------------------------------------------------------------

loc_63AC167B:				; CODE XREF: sub_63AC15CC+26j
					; sub_63AC15CC+39j ...
		mov	eax, 5

loc_63AC1680:				; CODE XREF: sub_63AC15CC+6Ej
					; sub_63AC15CC+75j ...
		pop	ebp
		retn
sub_63AC15CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC1682	proc near		; CODE XREF: sub_63AC20AF+2AFp
					; sub_63AC25A1+21Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 5
		jz	short loc_63AC16D6
		cmp	eax, 5
		ja	short loc_63AC16A2
		cmp	eax, 2
		jz	short loc_63AC16C8
		cmp	eax, 3
		jz	short loc_63AC16CF
		test	eax, eax
		jz	short loc_63AC16C1
		jmp	short loc_63AC16F2
; ---------------------------------------------------------------------------

loc_63AC16A2:				; CODE XREF: sub_63AC1682+Ej
		cmp	eax, 8
		jz	short loc_63AC16E4
		cmp	eax, 8
		ja	short loc_63AC16B3
		cmp	eax, 6
		jz	short loc_63AC16DD
		jmp	short loc_63AC16F2
; ---------------------------------------------------------------------------

loc_63AC16B3:				; CODE XREF: sub_63AC1682+28j
		cmp	eax, 9
		jz	short loc_63AC16DD
		cmp	eax, 0E8h
		jz	short loc_63AC16EB
		jmp	short loc_63AC16F2
; ---------------------------------------------------------------------------

loc_63AC16C1:				; CODE XREF: sub_63AC1682+1Cj
		mov	eax, 0
		jmp	short loc_63AC16F7
; ---------------------------------------------------------------------------

loc_63AC16C8:				; CODE XREF: sub_63AC1682+13j
		mov	eax, 2
		jmp	short loc_63AC16F7
; ---------------------------------------------------------------------------

loc_63AC16CF:				; CODE XREF: sub_63AC1682+18j
		mov	eax, 2
		jmp	short loc_63AC16F7
; ---------------------------------------------------------------------------

loc_63AC16D6:				; CODE XREF: sub_63AC1682+9j
		mov	eax, 1
		jmp	short loc_63AC16F7
; ---------------------------------------------------------------------------

loc_63AC16DD:				; CODE XREF: sub_63AC1682+2Dj
					; sub_63AC1682+34j
		mov	eax, 16h
		jmp	short loc_63AC16F7
; ---------------------------------------------------------------------------

loc_63AC16E4:				; CODE XREF: sub_63AC1682+23j
		mov	eax, 0Ch
		jmp	short loc_63AC16F7
; ---------------------------------------------------------------------------

loc_63AC16EB:				; CODE XREF: sub_63AC1682+3Bj
		mov	eax, 20h
		jmp	short loc_63AC16F7
; ---------------------------------------------------------------------------

loc_63AC16F2:				; CODE XREF: sub_63AC1682+1Ej
					; sub_63AC1682+2Fj ...
		mov	eax, 5

loc_63AC16F7:				; CODE XREF: sub_63AC1682+44j
					; sub_63AC1682+4Bj ...
		pop	ebp
		retn
sub_63AC1682	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC16F9(SOCKET)
sub_63AC16F9	proc near		; CODE XREF: sub_63AC4154+1ECp
					; sub_63AC4154+C48p

s		= dword	ptr -38h
level		= dword	ptr -34h
optname		= dword	ptr -30h
optval		= dword	ptr -2Ch
optlen		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+s], eax
		call	sub_63AC7ED5
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_63AC171F
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+s], eax
		call	sub_63AC7F06
		cmp	eax, 0FFFFFFFFh
		jz	short loc_63AC1728

loc_63AC171F:				; CODE XREF: sub_63AC16F9+14j
		mov	[ebp+var_C], 0
		jmp	short loc_63AC1769
; ---------------------------------------------------------------------------

loc_63AC1728:				; CODE XREF: sub_63AC16F9+24j
		mov	[ebp+var_14], 4
		mov	eax, [ebp+arg_0]
		lea	edx, [ebp+var_14]
		mov	[esp+38h+optlen], edx ;	optlen
		lea	edx, [ebp+var_10]
		mov	[esp+38h+optval], edx ;	optval
		mov	[esp+38h+optname], 1008h ; optname
		mov	[esp+38h+level], 0FFFFh	; level
		mov	[esp+38h+s], eax ; s
		mov	eax, ds:getsockopt
		call	eax ; getsockopt
		sub	esp, 14h
		cmp	eax, 0FFFFFFFFh
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax

loc_63AC1769:				; CODE XREF: sub_63AC16F9+2Dj
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	short loc_63AC17A4
		cmp	[ebp+var_C], 0
		jz	short loc_63AC1780
		mov	eax, offset aSocket ; "socket"
		jmp	short loc_63AC1785
; ---------------------------------------------------------------------------

loc_63AC1780:				; CODE XREF: sub_63AC16F9+7Ej
		mov	eax, offset aFile ; "file"

loc_63AC1785:				; CODE XREF: sub_63AC16F9+85j
		mov	[esp+38h+optval], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+optname], eax ; char
		mov	[esp+38h+level], offset	aFd_is_socketFd	; "fd_is_socket: fd %i is a %s.\n"
		mov	[esp+38h+s], 0	; int
		call	sub_63AC52BE

loc_63AC17A4:				; CODE XREF: sub_63AC16F9+78j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_63AC16F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC17A9	proc near		; CODE XREF: pth_init:loc_63AC1D66p
					; sub_63AC392F:loc_63AC39F2p

lpEventAttributes= dword ptr -148h
bManualReset	= dword	ptr -144h
bInitialState	= dword	ptr -140h
lpName		= dword	ptr -13Ch
dwDesiredAccess	= dword	ptr -138h
bInheritHandle	= dword	ptr -134h
dwOptions	= dword	ptr -130h
var_11C		= byte ptr -11Ch
TargetHandle	= dword	ptr -1Ch
EventAttributes	= _SECURITY_ATTRIBUTES ptr -18h
hSourceHandle	= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 144h
		lea	eax, [ebp+EventAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+EventAttributes.bInheritHandle], 1
		mov	[ebp+EventAttributes.lpSecurityDescriptor], 0
		mov	[ebp+EventAttributes.nLength], 0Ch
		mov	[esp+148h+lpName], 0 ; lpName
		mov	[esp+148h+bInitialState], 0 ; bInitialState
		mov	[esp+148h+bManualReset], 1 ; bManualReset
		lea	eax, [ebp+EventAttributes]
		mov	[esp+148h+lpEventAttributes], eax ; lpEventAttributes
		mov	eax, ds:CreateEventA
		call	eax ; CreateEventA
		sub	esp, 10h
		mov	[ebp+hSourceHandle], eax
		cmp	[ebp+hSourceHandle], 0
		jnz	short loc_63AC1851
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC1847
		mov	[esp+148h+bManualReset], 100h ;	DWORD
		lea	eax, [ebp+var_11C]
		mov	[esp+148h+lpEventAttributes], eax ; LPSTR
		call	sub_63AC1526
		mov	[esp+148h+bInitialState], eax ;	char
		mov	[esp+148h+bManualReset], offset	aCreateeventFai	; "CreateEvent failed: %s\n"
		mov	[esp+148h+lpEventAttributes], 0	; int
		call	sub_63AC52BE

loc_63AC1847:				; CODE XREF: sub_63AC17A9+6Ej
		mov	eax, 0
		jmp	loc_63AC1929
; ---------------------------------------------------------------------------

loc_63AC1851:				; CODE XREF: sub_63AC17A9+65j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+148h+dwOptions], 0	; dwOptions
		mov	[esp+148h+bInheritHandle], 0 ; bInheritHandle
		mov	[esp+148h+dwDesiredAccess], 100002h ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+148h+lpName], edx ; lpTargetHandle
		mov	[esp+148h+bInitialState], ebx ;	hTargetProcessHandle
		mov	edx, [ebp+hSourceHandle]
		mov	[esp+148h+bManualReset], edx ; hSourceHandle
		mov	[esp+148h+lpEventAttributes], eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_63AC18F1
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC18DA
		mov	[esp+148h+bManualReset], 100h ;	DWORD
		lea	eax, [ebp+var_11C]
		mov	[esp+148h+lpEventAttributes], eax ; LPSTR
		call	sub_63AC1526
		mov	[esp+148h+lpName], eax
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+148h+bInitialState], eax ;	char
		mov	[esp+148h+bManualReset], offset	aSettingSynchro	; "setting synchronize for event object	%p"...
		mov	[esp+148h+lpEventAttributes], 0	; int
		call	sub_63AC52BE

loc_63AC18DA:				; CODE XREF: sub_63AC17A9+FAj
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+148h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short loc_63AC1929
; ---------------------------------------------------------------------------

loc_63AC18F1:				; CODE XREF: sub_63AC17A9+F1j
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+148h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	short loc_63AC1926
		mov	eax, [ebp+TargetHandle]
		mov	[esp+148h+bInitialState], eax ;	char
		mov	[esp+148h+bManualReset], offset	aCreateeventPSu	; "CreateEvent(%p) succeeded\n"
		mov	[esp+148h+lpEventAttributes], 0	; int
		call	sub_63AC52BE

loc_63AC1926:				; CODE XREF: sub_63AC17A9+160j
		mov	eax, [ebp+TargetHandle]

loc_63AC1929:				; CODE XREF: sub_63AC17A9+A3j
					; sub_63AC17A9+146j
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_63AC17A9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC192E(HANDLE)
sub_63AC192E	proc near		; CODE XREF: sub_63AC4154+C29p

hEvent		= dword	ptr -118h
var_114		= dword	ptr -114h
var_110		= byte ptr -110h
var_10C		= dword	ptr -10Ch
var_108		= byte ptr -108h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 118h
		mov	eax, [ebp+arg_0]
		mov	[esp+118h+hEvent], eax ; hEvent
		mov	eax, ds:ResetEvent
		call	eax ; ResetEvent
		sub	esp, 4
		test	eax, eax
		jnz	short loc_63AC198B
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short locret_63AC19B0
		mov	[esp+118h+var_114], 100h ; DWORD
		lea	eax, [ebp+var_108]
		mov	[esp+118h+hEvent], eax ; LPSTR
		call	sub_63AC1526
		mov	[esp+118h+var_10C], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+118h+var_110], eax ; char
		mov	[esp+118h+var_114], offset aReseteventPFai ; "ResetEvent(%p) failed: %s\n"
		mov	[esp+118h+hEvent], 0 ; int
		call	sub_63AC52BE
		jmp	short locret_63AC19B0
; ---------------------------------------------------------------------------

loc_63AC198B:				; CODE XREF: sub_63AC192E+1Bj
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	short locret_63AC19B0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+118h+var_110], eax ; char
		mov	[esp+118h+var_114], offset aReseteventPSuc ; "ResetEvent(%p) succeeded\n"
		mov	[esp+118h+hEvent], 0 ; int
		call	sub_63AC52BE

locret_63AC19B0:			; CODE XREF: sub_63AC192E+24j
					; sub_63AC192E+5Bj ...
		leave
		retn
sub_63AC192E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC19B2	proc near		; CODE XREF: sub_63AC392F+B6p

lpTimerAttributes= dword ptr -28h
bManualReset	= dword	ptr -24h
lpTimerName	= dword	ptr -20h
TimerAttributes	= _SECURITY_ATTRIBUTES ptr -18h
var_C		= byte ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+TimerAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+TimerAttributes.bInheritHandle], 1
		mov	[ebp+TimerAttributes.lpSecurityDescriptor], 0
		mov	[ebp+TimerAttributes.nLength], 0Ch
		mov	[esp+28h+lpTimerName], 0 ; lpTimerName
		mov	[esp+28h+bManualReset],	1 ; bManualReset
		lea	eax, [ebp+TimerAttributes]
		mov	[esp+28h+lpTimerAttributes], eax ; lpTimerAttributes
		mov	eax, ds:CreateWaitableTimerA
		call	eax ; CreateWaitableTimerA
		sub	esp, 0Ch
		mov	dword ptr [ebp+var_C], eax
		cmp	dword ptr [ebp+var_C], 0
		jnz	short loc_63AC1A37
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC1A5C
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+lpTimerName], eax ; char
		mov	[esp+28h+bManualReset],	offset aCreatewaitable ; "CreateWaitableTimer failed: rc=%d\n"
		mov	[esp+28h+lpTimerAttributes], 0 ; int
		call	sub_63AC52BE
		jmp	short loc_63AC1A5C
; ---------------------------------------------------------------------------

loc_63AC1A37:				; CODE XREF: sub_63AC19B2+59j
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	short loc_63AC1A5C
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+28h+lpTimerName], eax ; char
		mov	[esp+28h+bManualReset],	offset aCreatewaitab_0 ; "CreateWaitableTimer(%p) succeeded\n"
		mov	[esp+28h+lpTimerAttributes], 0 ; int
		call	sub_63AC52BE

loc_63AC1A5C:				; CODE XREF: sub_63AC19B2+62j
					; sub_63AC19B2+83j ...
		mov	eax, dword ptr [ebp+var_C]
		leave
		retn
sub_63AC19B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC1A61(HANDLE, int)
sub_63AC1A61	proc near		; CODE XREF: sub_63AC4154+483p

hTimer		= dword	ptr -138h
lpDueTime	= dword	ptr -134h
lPeriod		= dword	ptr -130h
pfnCompletionRoutine= dword ptr	-12Ch
lpArgToCompletionRoutine= dword	ptr -128h
fResume		= dword	ptr -124h
var_110		= byte ptr -110h
DueTime		= LARGE_INTEGER	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 134h
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 2
		jle	short loc_63AC1A97
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+pfnCompletionRoutine], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+lPeriod], eax	; char
		mov	[esp+138h+lpDueTime], offset aSet_timerHdPMs ; "set_timer hd=%p	ms=%lu\n"
		mov	[esp+138h+hTimer], 3 ; int
		call	sub_63AC52BE

loc_63AC1A97:				; CODE XREF: sub_63AC1A61+12j
		mov	eax, [ebp+arg_4]
		mov	edx, 0
		imul	ebx, edx, 0FFFFD8F0h
		imul	ecx, eax, -1
		add	ebx, ecx
		mov	ecx, 0FFFFD8F0h
		mul	ecx
		lea	ecx, [ebx+edx]
		mov	edx, ecx
		mov	dword ptr [ebp+DueTime], eax
		mov	dword ptr [ebp+DueTime+4], edx
		mov	[esp+138h+fResume], 0 ;	fResume
		mov	[esp+138h+lpArgToCompletionRoutine], 0 ; lpArgToCompletionRoutine
		mov	[esp+138h+pfnCompletionRoutine], 0 ; pfnCompletionRoutine
		mov	[esp+138h+lPeriod], 0 ;	lPeriod
		lea	eax, [ebp+DueTime]
		mov	[esp+138h+lpDueTime], eax ; lpDueTime
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+hTimer], eax ; hTimer
		mov	eax, ds:SetWaitableTimer
		call	eax ; SetWaitableTimer
		sub	esp, 18h
		test	eax, eax
		jnz	short loc_63AC1B3D
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC1B36
		mov	[esp+138h+lpDueTime], 100h ; DWORD
		lea	eax, [ebp+var_110]
		mov	[esp+138h+hTimer], eax ; LPSTR
		call	sub_63AC1526
		mov	[esp+138h+pfnCompletionRoutine], eax
		mov	[esp+138h+lPeriod], offset aSet_timer ;	"set_timer"
		mov	[esp+138h+lpDueTime], offset aSSetwaitableti ; "%s: SetWaitableTimer failed: %s\n"
		mov	[esp+138h+hTimer], 0 ; int
		call	sub_63AC52BE

loc_63AC1B36:				; CODE XREF: sub_63AC1A61+9Dj
		mov	eax, 0FFFFFFFFh
		jmp	short loc_63AC1B42
; ---------------------------------------------------------------------------

loc_63AC1B3D:				; CODE XREF: sub_63AC1A61+94j
		mov	eax, 0

loc_63AC1B42:				; CODE XREF: sub_63AC1A61+DAj
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_63AC1A61	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC1B47(HANDLE)
sub_63AC1B47	proc near		; CODE XREF: sub_63AC3F69+3Ep
					; sub_63AC3F69+BFp

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		leave
		retn
sub_63AC1B47	endp

; Exported entry   1. pth_init

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_init
pth_init	proc near		; CODE XREF: pth_enter+Fp pth_ctrl+Fp	...

VarName		= dword	ptr -1C8h
Val		= dword	ptr -1C4h
Size		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_1AC		= dword	ptr -1ACh
WSAData		= WSAData ptr -1A8h
Dst		= dword	ptr -18h
var_14		= dword	ptr -14h
Str		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 1C4h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jz	short loc_63AC1B7C
		mov	eax, 1
		jmp	loc_63AC1DAA
; ---------------------------------------------------------------------------

loc_63AC1B7C:				; CODE XREF: pth_init+11j
		call	sub_63AC5207
		mov	[esp+1C8h+VarName], offset VarName ; "PTH_DEBUG"
		call	getenv
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	loc_63AC1CCE
		mov	eax, [ebp+Str]
		mov	[esp+1C8h+VarName], eax	; Str
		call	atoi
		mov	ds:dword_63ACD7CC, eax
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jz	loc_63AC1CCE
		mov	[esp+1C8h+Val],	3Bh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+1C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_63AC1CCE
		add	[ebp+var_14], 1
		mov	[esp+1C8h+Val],	3Bh ; Val
		mov	eax, [ebp+var_14]
		mov	[esp+1C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC1C22
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_14]
		mov	[ebp+var_C], eax

loc_63AC1C22:				; CODE XREF: pth_init+96j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[esp+1C8h+VarName], eax	; size_t
		call	sub_63AC14D4
		mov	[ebp+Dst], eax
		cmp	[ebp+Dst], 0
		jz	loc_63AC1CCE
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	edi, edx
		sub	edi, eax
		mov	eax, edi
		mov	ecx, eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+Dst]
		mov	[esp+1C8h+Size], ecx ; Size
		mov	[esp+1C8h+Val],	edx ; Src
		mov	[esp+1C8h+VarName], eax	; Dst
		call	memcpy
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp+Dst]
		mov	byte ptr [eax],	0
		mov	edx, offset Mode ; "a"
		mov	eax, [ebp+Dst]
		mov	[esp+1C8h+Val],	edx ; Mode
		mov	[esp+1C8h+VarName], eax	; Filename
		call	fopen
		mov	ds:File, eax
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_63AC1CC3
		mov	eax, ds:File
		mov	[esp+1C8h+var_1BC], 0 ;	Size
		mov	[esp+1C8h+Size], 40h ; Mode
		mov	[esp+1C8h+Val],	0 ; Buf
		mov	[esp+1C8h+VarName], eax	; File
		call	setvbuf

loc_63AC1CC3:				; CODE XREF: pth_init+13Dj
		mov	eax, [ebp+Dst]
		mov	[esp+1C8h+VarName], eax	; void *
		call	sub_63AC150D

loc_63AC1CCE:				; CODE XREF: pth_init+35j pth_init+52j ...
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_63AC1CE4
		mov	eax, ds:_iob
		add	eax, 40h
		mov	ds:File, eax

loc_63AC1CE4:				; CODE XREF: pth_init+176j
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jz	short loc_63AC1D0A
		mov	eax, ds:dword_63ACD7CC
		mov	[esp+1C8h+Size], eax ; char
		mov	[esp+1C8h+Val],	offset aPth_initCalled ; "pth_init called (level=%d)\n"
		mov	[esp+1C8h+VarName], 1 ;	int
		call	sub_63AC52BE

loc_63AC1D0A:				; CODE XREF: pth_init+18Cj
		lea	eax, [ebp+WSAData]
		mov	[esp+1C8h+Val],	eax ; lpWSAData
		mov	[esp+1C8h+VarName], 202h ; wVersionRequested
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		test	eax, eax
		jz	short loc_63AC1D30
		mov	eax, 0
		jmp	short loc_63AC1DAA
; ---------------------------------------------------------------------------

loc_63AC1D30:				; CODE XREF: pth_init+1C8j
		mov	ds:dword_63ACD008, 0
		mov	[esp+1C8h+VarName], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:InitializeCriticalSection
		call	eax ; InitializeCriticalSection
		sub	esp, 4
		mov	eax, ds:hObject
		test	eax, eax
		jz	short loc_63AC1D66
		mov	eax, ds:hObject
		mov	[esp+1C8h+VarName], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC1D66:				; CODE XREF: pth_init+1F3j
		call	sub_63AC17A9
		mov	ds:hObject, eax
		mov	eax, ds:hObject
		test	eax, eax
		jnz	short loc_63AC1D80
		mov	eax, 0
		jmp	short loc_63AC1DAA
; ---------------------------------------------------------------------------

loc_63AC1D80:				; CODE XREF: pth_init+218j
		mov	ds:dword_63ACD004, 1
		mov	ds:dword_63ACD02C, 1
		mov	[esp+1C8h+VarName], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:EnterCriticalSection
		call	eax ; EnterCriticalSection
		sub	esp, 4
		mov	eax, 1

loc_63AC1DAA:				; CODE XREF: pth_init+18j
					; pth_init+1CFj ...
		mov	edi, [ebp+var_4]
		leave
		retn
pth_init	endp

; Exported entry   2. pth_kill

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_kill
pth_kill	proc near		; CODE XREF: pth_exit+20p

hObject		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	ds:dword_63ACD008, 0
		mov	eax, ds:hObject
		test	eax, eax
		jz	short loc_63AC1DE4
		mov	eax, ds:hObject
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	ds:hObject, 0

loc_63AC1DE4:				; CODE XREF: pth_kill+17j
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jz	short loc_63AC1DFE
		mov	[esp+18h+hObject], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:DeleteCriticalSection
		call	eax ; DeleteCriticalSection
		sub	esp, 4

loc_63AC1DFE:				; CODE XREF: pth_kill+3Cj
		mov	eax, ds:WSACleanup
		call	eax ; WSACleanup
		mov	ds:dword_63ACD004, 0
		mov	eax, 1
		leave
		retn
pth_kill	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC1E16	proc near		; CODE XREF: pth_enter+5Fp
					; pth_read_ev+22p ...

lpCriticalSection= dword ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 2
		jle	short loc_63AC1E4E
		cmp	dword ptr [ebp+arg_0], 0
		jz	short loc_63AC1E31
		mov	eax, dword ptr [ebp+arg_0]
		jmp	short loc_63AC1E36
; ---------------------------------------------------------------------------

loc_63AC1E31:				; CODE XREF: sub_63AC1E16+14j
		mov	eax, offset byte_63ACB195

loc_63AC1E36:				; CODE XREF: sub_63AC1E16+19j
		mov	dword ptr [esp+18h+var_10], eax	; char
		mov	[esp+18h+var_14], offset aEnter_pthS ; "enter_pth (%s)\n"
		mov	[esp+18h+lpCriticalSection], 3 ; int
		call	sub_63AC52BE

loc_63AC1E4E:				; CODE XREF: sub_63AC1E16+Ej
		mov	[esp+18h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:LeaveCriticalSection
		call	eax ; LeaveCriticalSection
		sub	esp, 4
		leave
		retn
sub_63AC1E16	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC1E61	proc near		; CODE XREF: pth_leave+Dp
					; pth_read_ev+52p ...

lpCriticalSection= dword ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		mov	eax, ds:EnterCriticalSection
		call	eax ; EnterCriticalSection
		sub	esp, 4
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 2
		jle	short locret_63AC1EAA
		cmp	dword ptr [ebp+arg_0], 0
		jz	short loc_63AC1E8D
		mov	eax, dword ptr [ebp+arg_0]
		jmp	short loc_63AC1E92
; ---------------------------------------------------------------------------

loc_63AC1E8D:				; CODE XREF: sub_63AC1E61+25j
		mov	eax, offset byte_63ACB195

loc_63AC1E92:				; CODE XREF: sub_63AC1E61+2Aj
		mov	dword ptr [esp+18h+var_10], eax	; char
		mov	[esp+18h+var_14], offset aLeave_pthS ; "leave_pth (%s)\n"
		mov	[esp+18h+lpCriticalSection], 3 ; int
		call	sub_63AC52BE

locret_63AC1EAA:			; CODE XREF: sub_63AC1E61+1Fj
		leave
		retn
sub_63AC1E61	endp

; Exported entry  45. pth_enter

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_enter
pth_enter	proc near

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC1EC0
		call	pth_init

loc_63AC1EC0:				; CODE XREF: pth_enter+Dj
		mov	eax, ds:dword_63ACD028
		test	eax, eax
		jz	short loc_63AC1EF7
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aPth_enterCalle ; "pth_enter called	while already in pth\n"
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 26h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		call	abort
; ---------------------------------------------------------------------------

loc_63AC1EF7:				; CODE XREF: pth_enter+1Bj
		mov	eax, ds:dword_63ACD028
		add	eax, 1
		mov	ds:dword_63ACD028, eax
		mov	[esp+18h+Str], offset aPth_enter ; "pth_enter"
		call	sub_63AC1E16
		leave
		retn
pth_enter	endp

; Exported entry  46. pth_leave

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_leave
pth_leave	proc near

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+Str], offset aPth_leave ; "pth_leave"
		call	sub_63AC1E61
		mov	eax, ds:dword_63ACD028
		cmp	eax, 1
		jz	short loc_63AC1F5C
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aPth_leaveWasCa ; "pth_leave was called while not in pth\n"
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 26h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		call	abort
; ---------------------------------------------------------------------------

loc_63AC1F5C:				; CODE XREF: pth_leave+1Aj
		mov	eax, ds:dword_63ACD028
		sub	eax, 1
		mov	ds:dword_63ACD028, eax
		leave
		retn
pth_leave	endp

; Exported entry   3. pth_ctrl

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_ctrl
pth_ctrl	proc near

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC1F7F
		call	pth_init

loc_63AC1F7F:				; CODE XREF: pth_ctrl+Dj
		mov	eax, [ebp+arg_0]
		cmp	eax, 20h
		jz	short loc_63AC1FE6
		cmp	eax, 20h
		ja	short loc_63AC1FAC
		cmp	eax, 4
		jz	short loc_63AC1FD8
		cmp	eax, 4
		ja	short loc_63AC1FA0
		cmp	eax, 2
		jz	short loc_63AC1FD8
		jmp	loc_63AC202B
; ---------------------------------------------------------------------------

loc_63AC1FA0:				; CODE XREF: pth_ctrl+29j
		cmp	eax, 8
		jz	short loc_63AC1FD8
		cmp	eax, 10h
		jz	short loc_63AC1FDF
		jmp	short loc_63AC202B
; ---------------------------------------------------------------------------

loc_63AC1FAC:				; CODE XREF: pth_ctrl+1Fj
		cmp	eax, 100h
		jz	short loc_63AC2016
		cmp	eax, 100h
		ja	short loc_63AC1FC8
		cmp	eax, 40h
		jz	short loc_63AC2000
		cmp	eax, 80h
		jz	short loc_63AC200F
		jmp	short loc_63AC202B
; ---------------------------------------------------------------------------

loc_63AC1FC8:				; CODE XREF: pth_ctrl+4Dj
		cmp	eax, 200h
		jz	short loc_63AC201D
		cmp	eax, 3F0h
		jz	short loc_63AC2024
		jmp	short loc_63AC202B
; ---------------------------------------------------------------------------

loc_63AC1FD8:				; CODE XREF: pth_ctrl+24j pth_ctrl+2Ej ...
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC2030
; ---------------------------------------------------------------------------

loc_63AC1FDF:				; CODE XREF: pth_ctrl+3Dj
		mov	eax, 0
		jmp	short locret_63AC2030
; ---------------------------------------------------------------------------

loc_63AC1FE6:				; CODE XREF: pth_ctrl+1Aj
		mov	eax, ds:dword_63ACD02C
		test	eax, eax
		jz	short loc_63AC1FF9
		mov	eax, ds:dword_63ACD02C
		sub	eax, 1
		jmp	short loc_63AC1FFE
; ---------------------------------------------------------------------------

loc_63AC1FF9:				; CODE XREF: pth_ctrl+82j
		mov	eax, 0

loc_63AC1FFE:				; CODE XREF: pth_ctrl+8Cj
		jmp	short locret_63AC2030
; ---------------------------------------------------------------------------

loc_63AC2000:				; CODE XREF: pth_ctrl+52j
		mov	eax, ds:dword_63ACD02C
		test	eax, eax
		setnz	al
		movzx	eax, al
		jmp	short locret_63AC2030
; ---------------------------------------------------------------------------

loc_63AC200F:				; CODE XREF: pth_ctrl+59j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC2030
; ---------------------------------------------------------------------------

loc_63AC2016:				; CODE XREF: pth_ctrl+46j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC2030
; ---------------------------------------------------------------------------

loc_63AC201D:				; CODE XREF: pth_ctrl+62j
		mov	eax, 0
		jmp	short locret_63AC2030
; ---------------------------------------------------------------------------

loc_63AC2024:				; CODE XREF: pth_ctrl+69j
		mov	eax, ds:dword_63ACD02C
		jmp	short locret_63AC2030
; ---------------------------------------------------------------------------

loc_63AC202B:				; CODE XREF: pth_ctrl+30j pth_ctrl+3Fj ...
		mov	eax, 0FFFFFFFFh

locret_63AC2030:			; CODE XREF: pth_ctrl+72j pth_ctrl+79j ...
		leave
		retn
pth_ctrl	endp

; Exported entry  26. pth_timeout

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_timeout
pth_timeout	proc near		; CODE XREF: pth_select_ev+8Dp
					; pth_sleep+47p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_8]
		mov	edx, [ebp+var_4]
		leave
		retn
pth_timeout	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC204C(HANDLE hNamedPipe)
sub_63AC204C	proc near		; CODE XREF: sub_63AC20AF+BDp
					; sub_63AC25A1+BDp

hFile		= dword	ptr -38h
lpFlags		= dword	ptr -34h
lpOutBufferSize	= dword	ptr -30h
lpInBufferSize	= dword	ptr -2Ch
lpMaxInstances	= dword	ptr -28h
MaxInstances	= dword	ptr -18h
InBufferSize	= dword	ptr -14h
OutBufferSize	= dword	ptr -10h
Flags		= dword	ptr -0Ch
hNamedPipe	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+hNamedPipe]
		mov	[esp+38h+hFile], eax ; hFile
		mov	eax, ds:GetFileType
		call	eax ; GetFileType
		sub	esp, 4
		cmp	eax, 3
		jnz	short loc_63AC209E
		mov	eax, [ebp+hNamedPipe]
		lea	edx, [ebp+MaxInstances]
		mov	[esp+38h+lpMaxInstances], edx ;	lpMaxInstances
		lea	edx, [ebp+InBufferSize]
		mov	[esp+38h+lpInBufferSize], edx ;	lpInBufferSize
		lea	edx, [ebp+OutBufferSize]
		mov	[esp+38h+lpOutBufferSize], edx ; lpOutBufferSize
		lea	edx, [ebp+Flags]
		mov	[esp+38h+lpFlags], edx ; lpFlags
		mov	[esp+38h+hFile], eax ; hNamedPipe
		mov	eax, ds:GetNamedPipeInfo
		call	eax ; GetNamedPipeInfo
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_63AC209E
		mov	eax, 1
		jmp	short locret_63AC20A3
; ---------------------------------------------------------------------------

loc_63AC209E:				; CODE XREF: sub_63AC204C+19j
					; sub_63AC204C+49j
		mov	eax, 0

locret_63AC20A3:			; CODE XREF: sub_63AC204C+50j
		leave
		retn
sub_63AC204C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC20A5	proc near		; CODE XREF: sub_63AC20AF+24Dp
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_63AC20A5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC20AF(SOCKET, char	*, DWORD nNumberOfBytesToRead)
sub_63AC20AF	proc near		; CODE XREF: pth_read_ev+101p
					; pth_read+34p

s		= dword	ptr -148h
buf		= dword	ptr -144h
len		= dword	ptr -140h
flags		= dword	ptr -13Ch
lpOverlapped	= dword	ptr -138h
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_128		= byte ptr -128h
NumberOfBytesRead= dword ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
nNumberOfBytesToRead= dword ptr	 10h

		push	ebp
		mov	ebp, esp
		sub	esp, 148h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 2
		mov	dword ptr [ebp+var_18],	offset aDo_pth_read ; "do_pth_read"
		mov	[ebp+var_1C], offset aFd ; "fd"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXEnter ; "%s (%s=0x%x): enter\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+s], eax
		call	sub_63AC7ED5
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckHdP ;	"%s (%s=0x%x): check:	hd=%p\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		cmp	[ebp+var_24], 0FFFFFFFFh
		jz	short loc_63AC2166
		mov	eax, [ebp+nNumberOfBytesToRead]
		mov	[esp+148h+len],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+buf],	eax ; Dst
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC6267
		mov	[ebp+var_C], eax
		jmp	loc_63AC23C1
; ---------------------------------------------------------------------------

loc_63AC2166:				; CODE XREF: sub_63AC20AF+94j
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+s], eax ; hNamedPipe
		call	sub_63AC204C
		test	eax, eax
		jz	loc_63AC2202
		mov	eax, [ebp+nNumberOfBytesToRead]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckRecv ; "%s (%s=0x%x):	check:	 recv size=%d\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		mov	edx, [ebp+nNumberOfBytesToRead]
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+flags], 0 ; flags
		mov	[esp+148h+len],	edx ; len
		mov	edx, [ebp+arg_4]
		mov	[esp+148h+buf],	edx ; buf
		mov	[esp+148h+s], eax ; s
		mov	eax, ds:recv
		call	eax ; recv
		sub	esp, 10h
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckRe_0 ; "%s (%s=0x%x):	check:	 recv res=%d\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		jmp	short loc_63AC223F
; ---------------------------------------------------------------------------

loc_63AC2202:				; CODE XREF: sub_63AC20AF+C4j
		mov	eax, [ebp+nNumberOfBytesToRead]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckUseR ; "%s (%s=0x%x):	check:	 use readfile siz"...
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	[ebp+var_10], 1

loc_63AC223F:				; CODE XREF: sub_63AC20AF+151j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	loc_63AC2375
		cmp	[ebp+var_10], 0
		jz	loc_63AC2375
		mov	[ebp+NumberOfBytesRead], 0

loc_63AC225A:				; CODE XREF: sub_63AC20AF+254j
		mov	edx, [ebp+nNumberOfBytesToRead]
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+var_130], edx
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckRead ; "%s (%s=0x%x):	check:	 ReadFile on %p	s"...
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+lpOverlapped], 0 ; lpOverlapped
		lea	edx, [ebp+NumberOfBytesRead]
		mov	[esp+148h+flags], edx ;	lpNumberOfBytesRead
		mov	edx, [ebp+nNumberOfBytesToRead]
		mov	[esp+148h+len],	edx ; nNumberOfBytesToRead
		mov	edx, [ebp+arg_4]
		mov	[esp+148h+buf],	edx ; lpBuffer
		mov	[esp+148h+s], eax ; hFile
		mov	eax, ds:ReadFile
		call	eax ; ReadFile
		sub	esp, 14h
		mov	[ebp+var_C], eax
		mov	eax, [ebp+NumberOfBytesRead]
		mov	[esp+148h+var_130], eax
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckNDNr ; "%s (%s=0x%x):	check:		  n=%d nr"...
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC2309
		call	sub_63AC20A5
		test	eax, eax
		jnz	loc_63AC225A

loc_63AC2309:				; CODE XREF: sub_63AC20AF+24Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC236D
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC234D
		mov	[esp+148h+buf],	100h ; DWORD
		lea	eax, [ebp+var_128]
		mov	[esp+148h+s], eax ; LPSTR
		call	sub_63AC1526
		mov	[esp+148h+flags], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aPth_read0xXRea ; "pth_read(0x%x) ReadFile failed: %s\n"
		mov	[esp+148h+s], 0	; int
		call	sub_63AC52BE

loc_63AC234D:				; CODE XREF: sub_63AC20AF+267j
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+148h+s], eax
		call	sub_63AC1682
		mov	[esp+148h+s], eax
		call	sub_63AC14C0
		jmp	short loc_63AC23C1
; ---------------------------------------------------------------------------

loc_63AC236D:				; CODE XREF: sub_63AC20AF+25Ej
		mov	eax, [ebp+NumberOfBytesRead]
		mov	[ebp+var_C], eax
		jmp	short loc_63AC23C1
; ---------------------------------------------------------------------------

loc_63AC2375:				; CODE XREF: sub_63AC20AF+194j
					; sub_63AC20AF+19Ej
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_63AC23C1
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC23AA
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+148h+flags], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aPth_read0xXRec ; "pth_read(0x%x) recv failed: ec=%d\n"
		mov	[esp+148h+s], 0	; int
		call	sub_63AC52BE

loc_63AC23AA:				; CODE XREF: sub_63AC20AF+2D3j
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+148h+s], eax
		call	sub_63AC15CC
		mov	[esp+148h+s], eax
		call	sub_63AC14C0

loc_63AC23C1:				; CODE XREF: sub_63AC20AF+B2j
					; sub_63AC20AF+2BCj ...
		cmp	[ebp+var_C], 0
		js	short loc_63AC23F8
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXLeaveResu ; "%s (%s=0x%x):	leave: result=%i\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		jmp	short loc_63AC2435
; ---------------------------------------------------------------------------

loc_63AC23F8:				; CODE XREF: sub_63AC20AF+316j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+148h+s], eax ; int
		call	strerror
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXErrorS ; "%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE

loc_63AC2435:				; CODE XREF: sub_63AC20AF+347j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_63AC20AF	endp

; Exported entry   4. pth_read_ev

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_read_ev(SOCKET, char *, DWORD, int)
		public pth_read_ev
pth_read_ev	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
nNumberOfBytesToRead= dword ptr	-20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC2455
		call	pth_init

loc_63AC2455:				; CODE XREF: pth_read_ev+14j
		mov	[esp+28h+var_28], offset aPth_read_ev ;	"pth_read_ev"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+nNumberOfBytesToRead],	eax
		mov	[esp+28h+var_24], offset dword_63ACA00C
		mov	[esp+28h+var_28], 401002h
		call	sub_63AC3D62
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_63AC249B
		mov	[esp+28h+var_28], offset aPth_read_ev ;	"pth_read_ev"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC2552
; ---------------------------------------------------------------------------

loc_63AC249B:				; CODE XREF: pth_read_ev+49j
		cmp	[ebp+arg_C], 0
		jz	short loc_63AC24BB
		mov	[esp+28h+nNumberOfBytesToRead],	0
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_event_concat

loc_63AC24BB:				; CODE XREF: pth_read_ev+65j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_63AC4154
		cmp	[ebp+arg_C], 0
		jz	short loc_63AC2514
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_event_isolate
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		cmp	eax, 1
		jz	short loc_63AC2514
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_63AC3F69
		mov	[esp+28h+var_28], 4
		call	sub_63AC14C0
		mov	[esp+28h+var_28], offset aPth_read_ev ;	"pth_read_ev"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC2552
; ---------------------------------------------------------------------------

loc_63AC2514:				; CODE XREF: pth_read_ev+90j
					; pth_read_ev+A6j
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_63AC3F69
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToRead
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	SOCKET
		call	sub_63AC20AF
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_read_ev ;	"pth_read_ev"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]

locret_63AC2552:			; CODE XREF: pth_read_ev+5Cj
					; pth_read_ev+D8j
		leave
		retn
pth_read_ev	endp

; Exported entry   5. pth_read

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_read(SOCKET, char *, DWORD)
		public pth_read
pth_read	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
nNumberOfBytesToRead= dword ptr	-20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC2568
		call	pth_init

loc_63AC2568:				; CODE XREF: pth_read+Dj
		mov	[esp+28h+var_28], offset aPth_read ; "pth_read"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToRead
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	SOCKET
		call	sub_63AC20AF
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_read ; "pth_read"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_read	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC25A1(SOCKET, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite)
sub_63AC25A1	proc near		; CODE XREF: pth_write_ev+106p
					; pth_write+34p

s		= dword	ptr -148h
buf		= dword	ptr -144h
len		= dword	ptr -140h
flags		= dword	ptr -13Ch
lpOverlapped	= dword	ptr -138h
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_128		= byte ptr -128h
NumberOfBytesWritten= dword ptr	-28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
lpBuffer	= dword	ptr  0Ch
nNumberOfBytesToWrite= dword ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 148h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 2
		mov	dword ptr [ebp+var_18],	offset aDo_pth_write ; "do_pth_write"
		mov	[ebp+var_1C], offset aFd ; "fd"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXEnter ; "%s (%s=0x%x): enter\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+s], eax
		call	sub_63AC7F06
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckHdP ;	"%s (%s=0x%x): check:	hd=%p\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		cmp	[ebp+var_24], 0FFFFFFFFh
		jz	short loc_63AC2658
		mov	eax, [ebp+nNumberOfBytesToWrite]
		mov	[esp+148h+len],	eax ; size_t
		mov	eax, [ebp+lpBuffer]
		mov	[esp+148h+buf],	eax ; Src
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC7401
		mov	[ebp+var_C], eax
		jmp	loc_63AC289E
; ---------------------------------------------------------------------------

loc_63AC2658:				; CODE XREF: sub_63AC25A1+94j
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+s], eax ; hNamedPipe
		call	sub_63AC204C
		test	eax, eax
		jz	loc_63AC26F4
		mov	eax, [ebp+nNumberOfBytesToWrite]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckSend ; "%s (%s=0x%x):	check:	 send size=%d\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+flags], 0 ; flags
		mov	[esp+148h+len],	edx ; len
		mov	edx, [ebp+lpBuffer]
		mov	[esp+148h+buf],	edx ; buf
		mov	[esp+148h+s], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckSe_0 ; "%s (%s=0x%x):	check:	 send res=%d\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		jmp	short loc_63AC2731
; ---------------------------------------------------------------------------

loc_63AC26F4:				; CODE XREF: sub_63AC25A1+C4j
		mov	eax, [ebp+nNumberOfBytesToWrite]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckUseW ; "%s (%s=0x%x):	check:	 use writefile si"...
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	[ebp+var_10], 1

loc_63AC2731:				; CODE XREF: sub_63AC25A1+151j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	loc_63AC284F
		cmp	[ebp+var_10], 0
		jz	loc_63AC284F
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+var_130], edx
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckWrit ; "%s (%s=0x%x):	check:	 WriteFile on %p "...
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+lpOverlapped], 0 ; lpOverlapped
		lea	edx, [ebp+NumberOfBytesWritten]
		mov	[esp+148h+flags], edx ;	lpNumberOfBytesWritten
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[esp+148h+len],	edx ; nNumberOfBytesToWrite
		mov	edx, [ebp+lpBuffer]
		mov	[esp+148h+buf],	edx ; lpBuffer
		mov	[esp+148h+s], eax ; hFile
		mov	eax, ds:WriteFile
		call	eax ; WriteFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_63AC2811
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+148h+s], eax
		call	sub_63AC1682
		mov	[esp+148h+s], eax
		call	sub_63AC14C0
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	loc_63AC289D
		mov	[esp+148h+buf],	100h ; DWORD
		lea	eax, [ebp+var_128]
		mov	[esp+148h+s], eax ; LPSTR
		call	sub_63AC1526
		mov	[esp+148h+flags], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aPth_write0xXFa ; "pth_write(0x%x) failed in write: %s\n"
		mov	[esp+148h+s], 0	; int
		call	sub_63AC52BE
		jmp	loc_63AC289D
; ---------------------------------------------------------------------------

loc_63AC2811:				; CODE XREF: sub_63AC25A1+209j
		mov	eax, [ebp+NumberOfBytesWritten]
		mov	[esp+148h+var_130], eax
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXCheckNDNw ; "%s (%s=0x%x):	check:		  n=%d nw"...
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+NumberOfBytesWritten]
		mov	[ebp+var_C], eax
		jmp	short loc_63AC289D
; ---------------------------------------------------------------------------

loc_63AC284F:				; CODE XREF: sub_63AC25A1+194j
					; sub_63AC25A1+19Ej
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_63AC289E
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC2884
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+148h+flags], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aPth_write0xXSe ; "pth_write(0x%x) send failed: ec=%d\n"
		mov	[esp+148h+s], 0	; int
		call	sub_63AC52BE

loc_63AC2884:				; CODE XREF: sub_63AC25A1+2BBj
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+148h+s], eax
		call	sub_63AC15CC
		mov	[esp+148h+s], eax
		call	sub_63AC14C0
		jmp	short loc_63AC289E
; ---------------------------------------------------------------------------

loc_63AC289D:				; CODE XREF: sub_63AC25A1+230j
					; sub_63AC25A1+26Bj ...
		nop

loc_63AC289E:				; CODE XREF: sub_63AC25A1+B2j
					; sub_63AC25A1+2B2j ...
		cmp	[ebp+var_C], 0
		js	short loc_63AC28D5
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXLeaveResu ; "%s (%s=0x%x):	leave: result=%i\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE
		jmp	short loc_63AC2912
; ---------------------------------------------------------------------------

loc_63AC28D5:				; CODE XREF: sub_63AC25A1+301j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+148h+s], eax ; int
		call	strerror
		mov	[esp+148h+var_134], eax
		mov	eax, [ebp+var_20]
		mov	[esp+148h+lpOverlapped], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+148h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+148h+len],	eax ; char
		mov	[esp+148h+buf],	offset aSS0xXErrorS ; "%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_14]
		mov	[esp+148h+s], eax ; int
		call	sub_63AC52BE

loc_63AC2912:				; CODE XREF: sub_63AC25A1+332j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_63AC25A1	endp

; Exported entry   6. pth_write_ev

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_write_ev(SOCKET, LPCVOID, DWORD, int)
		public pth_write_ev
pth_write_ev	proc near

var_28		= dword	ptr -28h
lpBuffer	= dword	ptr -24h
nNumberOfBytesToWrite= dword ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC2932
		call	pth_init

loc_63AC2932:				; CODE XREF: pth_write_ev+14j
		mov	[esp+28h+var_28], offset aPth_write_ev ; "pth_write_ev"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+nNumberOfBytesToWrite], eax
		mov	[esp+28h+lpBuffer], offset dword_63ACA008
		mov	[esp+28h+var_28], 402002h
		call	sub_63AC3D62
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_63AC2978
		mov	[esp+28h+var_28], offset aPth_write_ev ; "pth_write_ev"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC2A34
; ---------------------------------------------------------------------------

loc_63AC2978:				; CODE XREF: pth_write_ev+49j
		cmp	[ebp+arg_C], 0
		jz	short loc_63AC2998
		mov	[esp+28h+nNumberOfBytesToWrite], 0
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+lpBuffer], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_event_concat

loc_63AC2998:				; CODE XREF: pth_write_ev+65j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_63AC4154
		cmp	[ebp+arg_C], 0
		jz	short loc_63AC29F6
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_event_isolate
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_event_status
		cmp	eax, 1
		jz	short loc_63AC29F6
		mov	[esp+28h+lpBuffer], 0 ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_63AC3F69
		mov	[esp+28h+var_28], 4
		call	sub_63AC14C0
		mov	[esp+28h+var_28], offset aPth_write_ev ; "pth_write_ev"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC2A34
; ---------------------------------------------------------------------------

loc_63AC29F6:				; CODE XREF: pth_write_ev+90j
					; pth_write_ev+ABj
		mov	[esp+28h+lpBuffer], 0 ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_63AC3F69
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+nNumberOfBytesToWrite], eax ; nNumberOfBytesToWrite
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	SOCKET
		call	sub_63AC25A1
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_write_ev ; "pth_write_ev"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]

locret_63AC2A34:			; CODE XREF: pth_write_ev+5Cj
					; pth_write_ev+DDj
		leave
		retn
pth_write_ev	endp

; Exported entry   7. pth_write

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_write(SOCKET,	LPCVOID, DWORD)
		public pth_write
pth_write	proc near

var_28		= dword	ptr -28h
lpBuffer	= dword	ptr -24h
nNumberOfBytesToWrite= dword ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC2A4A
		call	pth_init

loc_63AC2A4A:				; CODE XREF: pth_write+Dj
		mov	[esp+28h+var_28], offset aPth_write ; "pth_write"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+nNumberOfBytesToWrite], eax ; nNumberOfBytesToWrite
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	SOCKET
		call	sub_63AC25A1
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_write ; "pth_write"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_write	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC2A83	proc near		; CODE XREF: pth_select_ev+147p
					; pth_select_ev+15Ap ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_4], 0
		jnz	short loc_63AC2AAC
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_30], eax	; char
		mov	[esp+38h+var_34], offset aShow_event_rin ; "show_event_ring(%s):  No ring\n"
		mov	[esp+38h+var_38], 0 ; int
		call	sub_63AC52BE
		jmp	short locret_63AC2B01
; ---------------------------------------------------------------------------

loc_63AC2AAC:				; CODE XREF: sub_63AC2A83+Aj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax

loc_63AC2AB2:				; CODE XREF: sub_63AC2A83+7Cj
		mov	eax, [ebp+var_C]
		mov	ecx, [eax]
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+var_20], ecx
		mov	[esp+38h+var_24], edx
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_28], edx
		mov	[esp+38h+var_2C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_30], eax	; char
		mov	[esp+38h+var_34], offset aShow_event_r_0 ; "show_event_ring(%s): type=%d r=%p prev="...
		mov	[esp+38h+var_38], 0 ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_63AC2AB2

locret_63AC2B01:			; CODE XREF: sub_63AC2A83+27j
		leave
		retn
sub_63AC2A83	endp

; Exported entry  33. pth_select_ev

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_select_ev
pth_select_ev	proc near		; CODE XREF: pth_select+30p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC2B1E
		call	pth_init

loc_63AC2B1E:				; CODE XREF: pth_select_ev+14j
		mov	[esp+48h+var_48], offset aPth_select_ev	; "pth_select_ev"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_40], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_48], 4
		call	sub_63AC3D62
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_63AC2B78
		mov	[esp+48h+var_48], offset aPth_select_ev	; "pth_select_ev"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC2D4A
; ---------------------------------------------------------------------------

loc_63AC2B78:				; CODE XREF: pth_select_ev+5Dj
		cmp	[ebp+arg_10], 0
		jz	short loc_63AC2BD8
		mov	eax, [ebp+arg_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	pth_timeout
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_48], 10h
		call	sub_63AC3D62
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_63AC2BBE
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_63AC2D15
; ---------------------------------------------------------------------------

loc_63AC2BBE:				; CODE XREF: pth_select_ev+ADj
		mov	[esp+48h+var_40], 0
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	pth_event_concat

loc_63AC2BD8:				; CODE XREF: pth_select_ev+79j
		cmp	[ebp+arg_14], 0
		jz	short loc_63AC2BF8
		mov	[esp+48h+var_40], 0
		mov	eax, [ebp+arg_14]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	pth_event_concat

loc_63AC2BF8:				; CODE XREF: pth_select_ev+D9j
					; pth_select_ev+111j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_63AC4154
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	loc_63AC2D14
		cmp	[ebp+var_C], 0
		jz	short loc_63AC2BF8
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	pth_event_isolate
		cmp	[ebp+arg_10], 0
		jz	short loc_63AC2C32
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	pth_event_isolate

loc_63AC2C32:				; CODE XREF: pth_select_ev+122j
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	short loc_63AC2C75
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_48], offset aEv ; "ev	"
		call	sub_63AC2A83
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_48], offset aEv_time ; "ev_time "
		call	sub_63AC2A83
		mov	eax, [ebp+arg_14]
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_48], offset aEv_extra ; "ev_extra"
		call	sub_63AC2A83

loc_63AC2C75:				; CODE XREF: pth_select_ev+137j
		cmp	[ebp+var_18], 0
		jz	short loc_63AC2C8D
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		cmp	eax, 1
		jnz	short loc_63AC2C8D
		mov	eax, 1
		jmp	short loc_63AC2C92
; ---------------------------------------------------------------------------

loc_63AC2C8D:				; CODE XREF: pth_select_ev+176j
					; pth_select_ev+181j
		mov	eax, 0

loc_63AC2C92:				; CODE XREF: pth_select_ev+188j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_63AC2CA1
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax

loc_63AC2CA1:				; CODE XREF: pth_select_ev+196j
		cmp	[ebp+arg_10], 0
		jz	short loc_63AC2CF3
		cmp	[ebp+var_10], 0
		jz	short loc_63AC2CF3
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		cmp	eax, 1
		jnz	short loc_63AC2CF3
		mov	[ebp+var_14], 1
		cmp	[ebp+arg_4], 0
		jz	short loc_63AC2CCE
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_63AC2CCE:				; CODE XREF: pth_select_ev+1C0j
		cmp	[ebp+arg_8], 0
		jz	short loc_63AC2CDD
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_63AC2CDD:				; CODE XREF: pth_select_ev+1CFj
		cmp	[ebp+arg_C], 0
		jz	short loc_63AC2CEC
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_63AC2CEC:				; CODE XREF: pth_select_ev+1DEj
		mov	[ebp+var_C], 0

loc_63AC2CF3:				; CODE XREF: pth_select_ev+1A2j
					; pth_select_ev+1A8j ...
		cmp	[ebp+arg_14], 0
		jz	short loc_63AC2D15
		cmp	[ebp+var_14], 0
		jnz	short loc_63AC2D15
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	[esp+48h+var_48], 4
		call	sub_63AC14C0
		jmp	short loc_63AC2D15
; ---------------------------------------------------------------------------

loc_63AC2D14:				; CODE XREF: pth_select_ev+107j
		nop

loc_63AC2D15:				; CODE XREF: pth_select_ev+B6j
					; pth_select_ev+1F4j ...
		mov	[esp+48h+var_44], 0 ; int
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_63AC3F69
		mov	[esp+48h+var_44], 0 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_63AC3F69
		mov	[esp+48h+var_48], offset aPth_select_ev	; "pth_select_ev"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]

locret_63AC2D4A:			; CODE XREF: pth_select_ev+70j
		leave
		retn
pth_select_ev	endp

; Exported entry  11. pth_select

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_select
pth_select	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_14], 0
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	pth_select_ev
		leave
		retn
pth_select	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC2D83(SOCKET, int)
sub_63AC2D83	proc near		; CODE XREF: pth_accept_ev+2Ep
					; pth_accept_ev+10Ap ...

s		= dword	ptr -28h
cmd		= dword	ptr -24h
argp		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 1
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC2D9E
		call	pth_init

loc_63AC2D9E:				; CODE XREF: sub_63AC2D83+14j
		mov	eax, [ebp+arg_4]
		cmp	eax, 1
		jz	short loc_63AC2DDF
		cmp	eax, 2
		jnz	short loc_63AC2E17
		mov	[ebp+var_10], 1
		mov	eax, [ebp+arg_0]
		lea	edx, [ebp+var_10]
		mov	[esp+28h+argp],	edx ; argp
		mov	[esp+28h+cmd], 8004667Eh ; cmd
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:ioctlsocket
		call	eax ; ioctlsocket
		sub	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_63AC2E13
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_63AC2E13
; ---------------------------------------------------------------------------

loc_63AC2DDF:				; CODE XREF: sub_63AC2D83+21j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		lea	edx, [ebp+var_10]
		mov	[esp+28h+argp],	edx ; argp
		mov	[esp+28h+cmd], 8004667Eh ; cmd
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:ioctlsocket
		call	eax ; ioctlsocket
		sub	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_63AC2E16
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_63AC2E16
; ---------------------------------------------------------------------------

loc_63AC2E13:				; CODE XREF: sub_63AC2D83+51j
					; sub_63AC2D83+5Aj
		nop
		jmp	short loc_63AC2E17
; ---------------------------------------------------------------------------

loc_63AC2E16:				; CODE XREF: sub_63AC2D83+85j
					; sub_63AC2D83+8Ej
		nop

loc_63AC2E17:				; CODE XREF: sub_63AC2D83+26j
					; sub_63AC2D83+91j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_63AC2D83	endp

; Exported entry   9. pth_accept

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_accept(SOCKET, struct	sockaddr *, int	*)
		public pth_accept
pth_accept	proc near

s		= dword	ptr -28h
addr		= dword	ptr -24h
addrlen		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC2E30
		call	pth_init

loc_63AC2E30:				; CODE XREF: pth_accept+Dj
		mov	[esp+28h+s], offset aPth_accept	; "pth_accept"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+addrlen], edx ; addrlen
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+addr],	edx ; addr
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:accept
		call	eax ; accept
		sub	esp, 0Ch
		mov	[ebp+var_C], eax
		mov	[esp+28h+s], offset aPth_accept	; "pth_accept"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_accept	endp

; Exported entry   8. pth_accept_ev

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_accept_ev(SOCKET, struct sockaddr *, int *, int)
		public pth_accept_ev
pth_accept_ev	proc near

s		= dword	ptr -28h
addr		= dword	ptr -24h
addrlen		= dword	ptr -20h
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC2E82
		call	pth_init

loc_63AC2E82:				; CODE XREF: pth_accept_ev+Dj
		mov	[esp+28h+s], offset aPth_accept_ev ; "pth_accept_ev"
		call	sub_63AC1E16
		mov	[esp+28h+addr],	2 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+s], eax ; SOCKET
		call	sub_63AC2D83
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_63AC2EC0
		mov	[esp+28h+s], offset aPth_accept_ev ; "pth_accept_ev"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC3018
; ---------------------------------------------------------------------------

loc_63AC2EC0:				; CODE XREF: pth_accept_ev+3Aj
		mov	[ebp+var_C], 0
		jmp	loc_63AC2F93
; ---------------------------------------------------------------------------

loc_63AC2ECC:				; CODE XREF: pth_accept_ev+158j
					; pth_accept_ev+16Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC2F2B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+addrlen], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+addr],	eax
		mov	[esp+28h+s], 401002h
		call	sub_63AC3D62
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC2F0B
		mov	[esp+28h+s], offset aPth_accept_ev ; "pth_accept_ev"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC3018
; ---------------------------------------------------------------------------

loc_63AC2F0B:				; CODE XREF: pth_accept_ev+85j
		cmp	[ebp+arg_C], 0
		jz	short loc_63AC2F2B
		mov	[esp+28h+addrlen], 0
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+addr],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+s], eax
		call	pth_event_concat

loc_63AC2F2B:				; CODE XREF: pth_accept_ev+62j
					; pth_accept_ev+A1j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+s], eax
		call	sub_63AC4154
		cmp	[ebp+arg_C], 0
		jz	short loc_63AC2F93
		mov	eax, [ebp+var_C]
		mov	[esp+28h+s], eax
		call	pth_event_isolate
		cmp	[ebp+var_C], 0
		jz	short loc_63AC2F93
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		cmp	eax, 1
		jz	short loc_63AC2F93
		mov	[esp+28h+addr],	0 ; int
		mov	eax, [ebp+var_C]
		mov	[esp+28h+s], eax ; void	*
		call	sub_63AC3F69
		mov	eax, [ebp+var_10]
		mov	[esp+28h+addr],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+s], eax ; SOCKET
		call	sub_63AC2D83
		mov	[esp+28h+s], offset aPth_accept_ev ; "pth_accept_ev"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC3018
; ---------------------------------------------------------------------------

loc_63AC2F93:				; CODE XREF: pth_accept_ev+59j
					; pth_accept_ev+CCj ...
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+addrlen], edx ; addrlen
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+addr],	edx ; addr
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:accept
		call	eax ; accept
		sub	esp, 0Ch
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0FFFFFFFFh
		jnz	short loc_63AC2FDE
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		cmp	eax, 2734h
		jz	loc_63AC2ECC
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		cmp	eax, 2733h
		jz	loc_63AC2ECC

loc_63AC2FDE:				; CODE XREF: pth_accept_ev+14Aj
		cmp	[ebp+var_C], 0
		jz	short loc_63AC2FF7
		mov	[esp+28h+addr],	0 ; int
		mov	eax, [ebp+var_C]
		mov	[esp+28h+s], eax ; void	*
		call	sub_63AC3F69

loc_63AC2FF7:				; CODE XREF: pth_accept_ev+174j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+addr],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+s], eax ; SOCKET
		call	sub_63AC2D83
		mov	[esp+28h+s], offset aPth_accept_ev ; "pth_accept_ev"
		call	sub_63AC1E61
		mov	eax, [ebp+var_14]

locret_63AC3018:			; CODE XREF: pth_accept_ev+4Dj
					; pth_accept_ev+98j ...
		leave
		retn
pth_accept_ev	endp

; Exported entry  10. pth_connect

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_connect(SOCKET, struct sockaddr *, int)
		public pth_connect
pth_connect	proc near

s		= dword	ptr -28h
name		= dword	ptr -24h
namelen		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC302E
		call	pth_init

loc_63AC302E:				; CODE XREF: pth_connect+Dj
		mov	[esp+28h+s], offset aPth_connect ; "pth_connect"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+namelen], edx ; namelen
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+name],	edx ; name
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:connect
		call	eax ; connect
		sub	esp, 0Ch
		mov	[ebp+var_C], eax
		mov	[esp+28h+s], offset aPth_connect ; "pth_connect"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_connect	endp

; Exported entry  12. pth_mutex_release

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_mutex_release
pth_mutex_release proc near		; CODE XREF: pth_rwlock_release+Cp

hMutex		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= byte ptr -120h
var_11C		= dword	ptr -11Ch
var_10C		= byte ptr -10Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 128h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC3083
		call	pth_init

loc_63AC3083:				; CODE XREF: pth_mutex_release+10j
		mov	[esp+128h+hMutex], offset aPth_mutex_rele ; "pth_mutex_release"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+128h+hMutex], eax ; hMutex
		mov	eax, ds:ReleaseMutex
		call	eax ; ReleaseMutex
		sub	esp, 4
		test	eax, eax
		jnz	short loc_63AC30EE
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC30E5
		mov	[esp+128h+var_124], 100h ; DWORD
		lea	eax, [ebp+var_10C]
		mov	[esp+128h+hMutex], eax ; LPSTR
		call	sub_63AC1526
		mov	edx, [ebp+arg_0]
		mov	edx, [edx]
		mov	[esp+128h+var_11C], eax
		mov	dword ptr [esp+128h+var_120], edx ; char
		mov	[esp+128h+var_124], offset aPth_release_mu ; "pth_release_mutex	%p failed: %s\n"
		mov	[esp+128h+hMutex], 0 ; int
		call	sub_63AC52BE

loc_63AC30E5:				; CODE XREF: pth_mutex_release+40j
		mov	[ebp+var_C], 0
		jmp	short loc_63AC30F5
; ---------------------------------------------------------------------------

loc_63AC30EE:				; CODE XREF: pth_mutex_release+37j
		mov	[ebp+var_C], 1

loc_63AC30F5:				; CODE XREF: pth_mutex_release+80j
		mov	[esp+128h+hMutex], offset aPth_mutex_rele ; "pth_mutex_release"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_mutex_release endp

; Exported entry  13. pth_mutex_acquire

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_mutex_acquire
pth_mutex_acquire proc near		; CODE XREF: pth_rwlock_acquire+1Ap

hHandle		= dword	ptr -128h
dwMilliseconds	= dword	ptr -124h
var_120		= byte ptr -120h
var_11C		= dword	ptr -11Ch
var_110		= byte ptr -110h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 128h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC311D
		call	pth_init

loc_63AC311D:				; CODE XREF: pth_mutex_acquire+10j
		mov	[esp+128h+hHandle], offset aPth_mutex_acqu ; "pth_mutex_acquire"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+128h+dwMilliseconds], 0FFFFFFFFh ;	dwMilliseconds
		mov	[esp+128h+hHandle], eax	; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	dword ptr [ebp+var_10],	eax
		mov	eax, dword ptr [ebp+var_10]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_63AC3154
		test	eax, eax
		jz	short loc_63AC319D
		jmp	short loc_63AC31A6
; ---------------------------------------------------------------------------

loc_63AC3154:				; CODE XREF: pth_mutex_acquire+46j
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC3194
		mov	[esp+128h+dwMilliseconds], 100h	; DWORD
		lea	eax, [ebp+var_110]
		mov	[esp+128h+hHandle], eax	; LPSTR
		call	sub_63AC1526
		mov	edx, [ebp+arg_0]
		mov	edx, [edx]
		mov	[esp+128h+var_11C], eax
		mov	dword ptr [esp+128h+var_120], edx ; char
		mov	[esp+128h+dwMilliseconds], offset aPth_mutex_ac_0 ; "pth_mutex_acquire for %p failed: %s\n"
		mov	[esp+128h+hHandle], 0 ;	int
		call	sub_63AC52BE

loc_63AC3194:				; CODE XREF: pth_mutex_acquire+55j
		mov	[ebp+var_C], 0
		jmp	short loc_63AC31DB
; ---------------------------------------------------------------------------

loc_63AC319D:				; CODE XREF: pth_mutex_acquire+4Aj
		mov	[ebp+var_C], 1
		jmp	short loc_63AC31DB
; ---------------------------------------------------------------------------

loc_63AC31A6:				; CODE XREF: pth_mutex_acquire+4Cj
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC31D3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+128h+var_11C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	dword ptr [esp+128h+var_120], eax ; char
		mov	[esp+128h+dwMilliseconds], offset aWaitforsingleo ; "WaitForSingleObject returned unexpected"...
		mov	[esp+128h+hHandle], 0 ;	int
		call	sub_63AC52BE

loc_63AC31D3:				; CODE XREF: pth_mutex_acquire+A7j
		mov	[ebp+var_C], 0
		nop

loc_63AC31DB:				; CODE XREF: pth_mutex_acquire+95j
					; pth_mutex_acquire+9Ej
		mov	[esp+128h+hHandle], offset aPth_mutex_acqu ; "pth_mutex_acquire"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_mutex_acquire endp

; Exported entry  14. pth_mutex_init

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_mutex_init
pth_mutex_init	proc near		; CODE XREF: pth_rwlock_init+Cp

lpMutexAttributes= dword ptr -28h
bInitialOwner	= dword	ptr -24h
lpName		= dword	ptr -20h
MutexAttributes	= _SECURITY_ATTRIBUTES ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC3200
		call	pth_init

loc_63AC3200:				; CODE XREF: pth_mutex_init+Dj
		mov	[esp+28h+lpMutexAttributes], offset aPth_mutex_init ; "pth_mutex_init"
		call	sub_63AC1E16
		lea	eax, [ebp+MutexAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+MutexAttributes.bInheritHandle], 1
		mov	[ebp+MutexAttributes.lpSecurityDescriptor], 0
		mov	[ebp+MutexAttributes.nLength], 0Ch
		mov	[esp+28h+lpName], 0 ; lpName
		mov	[esp+28h+bInitialOwner], 0 ; bInitialOwner
		lea	eax, [ebp+MutexAttributes]
		mov	[esp+28h+lpMutexAttributes], eax ; lpMutexAttributes
		mov	eax, ds:CreateMutexA
		call	eax ; CreateMutexA
		sub	esp, 0Ch
		mov	edx, [ebp+arg_0]
		mov	[edx], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_63AC3279
		mov	[esp+28h+lpMutexAttributes], offset aPth_mutex_init ; "pth_mutex_init"
		call	sub_63AC1E61
		mov	eax, 0
		jmp	short locret_63AC328A
; ---------------------------------------------------------------------------

loc_63AC3279:				; CODE XREF: pth_mutex_init+78j
		mov	[esp+28h+lpMutexAttributes], offset aPth_mutex_init ; "pth_mutex_init"
		call	sub_63AC1E61
		mov	eax, 1

locret_63AC328A:			; CODE XREF: pth_mutex_init+8Bj
		leave
		retn
pth_mutex_init	endp

; Exported entry  41. pth_mutex_destroy

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_mutex_destroy
pth_mutex_destroy proc near

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC32A0
		call	pth_init

loc_63AC32A0:				; CODE XREF: pth_mutex_destroy+Dj
		mov	[esp+18h+hObject], offset aPth_mutex_dest ; "pth_mutex_destroy"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	[esp+18h+hObject], offset aPth_mutex_dest ; "pth_mutex_destroy"
		call	sub_63AC1E61
		mov	eax, 1
		leave
		retn
pth_mutex_destroy endp

; Exported entry  37. pth_rwlock_init

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_rwlock_init
pth_rwlock_init	proc near

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	pth_mutex_init
		leave
		retn
pth_rwlock_init	endp

; Exported entry  36. pth_rwlock_acquire

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_rwlock_acquire
pth_rwlock_acquire proc	near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	pth_mutex_acquire
		leave
		retn
pth_rwlock_acquire endp

; Exported entry  35. pth_rwlock_release

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_rwlock_release
pth_rwlock_release proc	near

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	pth_mutex_release
		leave
		retn
pth_rwlock_release endp

; Exported entry  15. pth_attr_new

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_attr_new
pth_attr_new	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC332C
		call	pth_init

loc_63AC332C:				; CODE XREF: pth_attr_new+Dj
		mov	[esp+28h+var_24], 0Ch ;	size_t
		mov	[esp+28h+var_28], 1 ; size_t
		call	sub_63AC14ED
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
pth_attr_new	endp

; Exported entry  16. pth_attr_destroy

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_attr_destroy(void *)
		public pth_attr_destroy
pth_attr_destroy proc near

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC335B
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC3391
; ---------------------------------------------------------------------------

loc_63AC335B:				; CODE XREF: pth_attr_destroy+Aj
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC3369
		call	pth_init

loc_63AC3369:				; CODE XREF: pth_attr_destroy+1Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_63AC3381
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+18h+var_18], eax ;	void *
		call	sub_63AC150D

loc_63AC3381:				; CODE XREF: pth_attr_destroy+29j
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	void *
		call	sub_63AC150D
		mov	eax, 1

locret_63AC3391:			; CODE XREF: pth_attr_destroy+11j
		leave
		retn
pth_attr_destroy endp

; Exported entry  17. pth_attr_set

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_attr_set
pth_attr_set	proc near

Src		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 1
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC33AE
		call	pth_init

loc_63AC33AE:				; CODE XREF: pth_attr_set+14j
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		cmp	eax, 2
		jz	short loc_63AC33D1
		cmp	eax, 4
		jz	short loc_63AC341F
		cmp	eax, 1
		jz	loc_63AC347D
		jmp	loc_63AC3506
; ---------------------------------------------------------------------------

loc_63AC33D1:				; CODE XREF: pth_attr_set+29j
		mov	eax, [ebp+var_18]
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	dword ptr [ebp+var_10],	eax
		cmp	dword ptr [ebp+var_10],	0
		jz	loc_63AC350F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	loc_63AC350F
		mov	[esp+28h+var_24], offset aPth_attr_setPt ; "pth_attr_set: PTH_ATTR_JOINABLE\n"
		mov	[esp+28h+Src], 0 ; int
		call	sub_63AC52BE
		jmp	loc_63AC350F
; ---------------------------------------------------------------------------

loc_63AC341F:				; CODE XREF: pth_attr_set+2Ej
		mov	eax, [ebp+var_18]
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	dword ptr [ebp+var_10],	eax
		cmp	dword ptr [ebp+var_10],	0
		jz	loc_63AC3512
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	edx, dword ptr [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	loc_63AC3512
		mov	eax, dword ptr [ebp+var_10]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset aPth_attr_set_0 ; "pth_attr_set: PTH_ATTR_STACK_SIZE %d\n"
		mov	[esp+28h+Src], 0 ; int
		call	sub_63AC52BE
		jmp	loc_63AC3512
; ---------------------------------------------------------------------------

loc_63AC347D:				; CODE XREF: pth_attr_set+33j
		mov	eax, [ebp+var_18]
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_63AC34A3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Src], eax ; void *
		call	sub_63AC150D

loc_63AC34A3:				; CODE XREF: pth_attr_set+100j
		cmp	[ebp+var_14], 0
		jz	short loc_63AC3515
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_63AC34CD
		mov	eax, 0
		jmp	short locret_63AC3519
; ---------------------------------------------------------------------------

loc_63AC34CD:				; CODE XREF: pth_attr_set+131j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	short loc_63AC3515
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset aPth_attr_set_1 ; "pth_attr_set: PTH_ATTR_NAME	%s\n"
		mov	[esp+28h+Src], 0 ; int
		call	sub_63AC52BE
		jmp	short loc_63AC3515
; ---------------------------------------------------------------------------

loc_63AC3506:				; CODE XREF: pth_attr_set+39j
		mov	[ebp+var_C], 0
		jmp	short loc_63AC3516
; ---------------------------------------------------------------------------

loc_63AC350F:				; CODE XREF: pth_attr_set+50j
					; pth_attr_set+6Dj ...
		nop
		jmp	short loc_63AC3516
; ---------------------------------------------------------------------------

loc_63AC3512:				; CODE XREF: pth_attr_set+9Ej
					; pth_attr_set+C4j ...
		nop
		jmp	short loc_63AC3516
; ---------------------------------------------------------------------------

loc_63AC3515:				; CODE XREF: pth_attr_set+114j
					; pth_attr_set+151j ...
		nop

loc_63AC3516:				; CODE XREF: pth_attr_set+17Aj
					; pth_attr_set+17Dj ...
		mov	eax, [ebp+var_C]

locret_63AC3519:			; CODE XREF: pth_attr_set+138j
		leave
		retn
pth_attr_set	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC351B	proc near		; CODE XREF: pth_spawn+41p

lpThreadAttributes= dword ptr -48h
dwStackSize	= dword	ptr -44h
lpStartAddress	= dword	ptr -40h
lpParameter	= dword	ptr -3Ch
dwCreationFlags	= dword	ptr -38h
lpThreadId	= dword	ptr -34h
ThreadId	= dword	ptr -20h
ThreadAttributes= _SECURITY_ATTRIBUTES ptr -1Ch
hThread		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC3531
		mov	eax, 0
		jmp	locret_63AC3653
; ---------------------------------------------------------------------------

loc_63AC3531:				; CODE XREF: sub_63AC351B+Aj
		lea	eax, [ebp+ThreadAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+ThreadAttributes.bInheritHandle], 1
		mov	[ebp+ThreadAttributes.lpSecurityDescriptor], 0
		mov	[ebp+ThreadAttributes.nLength],	0Ch
		mov	[esp+48h+dwStackSize], 10h ; size_t
		mov	[esp+48h+lpThreadAttributes], 1	; size_t
		call	sub_63AC14ED
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC3584
		mov	eax, 0
		jmp	locret_63AC3653
; ---------------------------------------------------------------------------

loc_63AC3584:				; CODE XREF: sub_63AC351B+5Dj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		and	edx, 2
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	short loc_63AC35C3
		mov	[esp+48h+dwStackSize], offset aDo_pth_spawnCr ;	"do_pth_spawn creating thread ...\n"
		mov	[esp+48h+lpThreadAttributes], 0	; int
		call	sub_63AC52BE

loc_63AC35C3:				; CODE XREF: sub_63AC351B+92j
		mov	edx, offset StartAddress
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	ecx, [ebp+ThreadId]
		mov	[esp+48h+lpThreadId], ecx ; lpThreadId
		mov	[esp+48h+dwCreationFlags], 4 ; dwCreationFlags
		mov	ecx, [ebp+var_C]
		mov	[esp+48h+lpParameter], ecx ; lpParameter
		mov	[esp+48h+lpStartAddress], edx ;	lpStartAddress
		mov	[esp+48h+dwStackSize], eax ; dwStackSize
		lea	eax, [ebp+ThreadAttributes]
		mov	[esp+48h+lpThreadAttributes], eax ; lpThreadAttributes
		mov	eax, ds:CreateThread
		call	eax ; CreateThread
		sub	esp, 18h
		mov	[ebp+hThread], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+hThread]
		mov	[eax+0Ch], edx
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	short loc_63AC362D
		mov	eax, [ebp+hThread]
		mov	[esp+48h+lpStartAddress], eax ;	char
		mov	[esp+48h+dwStackSize], offset aDo_pth_spawn_0 ;	"do_pth_spawn created thread %p\n"
		mov	[esp+48h+lpThreadAttributes], 0	; int
		call	sub_63AC52BE

loc_63AC362D:				; CODE XREF: sub_63AC351B+F5j
		cmp	[ebp+hThread], 0
		jnz	short loc_63AC3640
		mov	eax, [ebp+var_C]
		mov	[esp+48h+lpThreadAttributes], eax ; void *
		call	sub_63AC150D
		jmp	short loc_63AC3650
; ---------------------------------------------------------------------------

loc_63AC3640:				; CODE XREF: sub_63AC351B+116j
		mov	eax, [ebp+hThread]
		mov	[esp+48h+lpThreadAttributes], eax ; hThread
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4

loc_63AC3650:				; CODE XREF: sub_63AC351B+123j
		mov	eax, [ebp+hThread]

locret_63AC3653:			; CODE XREF: sub_63AC351B+11j
					; sub_63AC351B+64j
		leave
		retn
sub_63AC351B	endp

; Exported entry  18. pth_spawn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_spawn
pth_spawn	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC3668
		mov	eax, 0
		jmp	short locret_63AC36AD
; ---------------------------------------------------------------------------

loc_63AC3668:				; CODE XREF: pth_spawn+Aj
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC3676
		call	pth_init

loc_63AC3676:				; CODE XREF: pth_spawn+1Aj
		mov	[esp+28h+var_28], offset aPth_spawn ; "pth_spawn"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_63AC351B
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_spawn ; "pth_spawn"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]

locret_63AC36AD:			; CODE XREF: pth_spawn+11j
		leave
		retn
pth_spawn	endp

; Exported entry  19. pth_self

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_self
pth_self	proc near
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:GetCurrentThread
		call	eax ; GetCurrentThread
		leave
		retn
pth_self	endp

; Exported entry  43. pth_thread_id

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_thread_id
pth_thread_id	proc near
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:GetCurrentThreadId
		call	eax ; GetCurrentThreadId
		leave
		retn
pth_thread_id	endp

; Exported entry  20. pth_join

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_join
pth_join	proc near
		push	ebp
		mov	ebp, esp
		mov	eax, 1
		pop	ebp
		retn
pth_join	endp

; Exported entry  44. pth_cancel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_cancel(HANDLE	hThread)
		public pth_cancel
pth_cancel	proc near

hHandle		= dword	ptr -28h
dwMilliseconds	= dword	ptr -24h
var_C		= dword	ptr -0Ch
hThread		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+hThread], 0
		jnz	short loc_63AC36F1
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC376A
; ---------------------------------------------------------------------------

loc_63AC36F1:				; CODE XREF: pth_cancel+11j
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC36FF
		call	pth_init

loc_63AC36FF:				; CODE XREF: pth_cancel+21j
		mov	[esp+28h+hHandle], offset aPth_cancel ;	"pth_cancel"
		call	sub_63AC1E16
		mov	[esp+28h+dwMilliseconds], 3E8h ; dwMilliseconds
		mov	eax, [ebp+hThread]
		mov	[esp+28h+hHandle], eax ; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	[esp+28h+dwMilliseconds], 0 ; dwExitCode
		mov	eax, [ebp+hThread]
		mov	[esp+28h+hHandle], eax ; hThread
		mov	eax, ds:TerminateThread
		call	eax ; TerminateThread
		sub	esp, 8
		test	eax, eax
		jz	short loc_63AC3746
		mov	[ebp+var_C], 1

loc_63AC3746:				; CODE XREF: pth_cancel+66j
		mov	[esp+28h+hHandle], offset aPth_cancel ;	"pth_cancel"
		call	sub_63AC1E61
		cmp	[ebp+var_C], 0
		jz	short loc_63AC3765
		mov	eax, ds:dword_63ACD02C
		sub	eax, 1
		mov	ds:dword_63ACD02C, eax

loc_63AC3765:				; CODE XREF: pth_cancel+7Fj
		mov	eax, 1

locret_63AC376A:			; CODE XREF: pth_cancel+18j
		leave
		retn
pth_cancel	endp

; Exported entry  21. pth_abort

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_abort(HANDLE)
		public pth_abort
pth_abort	proc near

hThread		= dword	ptr -28h
dwExitCode	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC3786
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC37E7
; ---------------------------------------------------------------------------

loc_63AC3786:				; CODE XREF: pth_abort+11j
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC3794
		call	pth_init

loc_63AC3794:				; CODE XREF: pth_abort+21j
		mov	[esp+28h+hThread], offset aPth_abort ; "pth_abort"
		call	sub_63AC1E16
		mov	[esp+28h+dwExitCode], 0	; dwExitCode
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hThread], eax ; hThread
		mov	eax, ds:TerminateThread
		call	eax ; TerminateThread
		sub	esp, 8
		test	eax, eax
		jz	short loc_63AC37C3
		mov	[ebp+var_C], 1

loc_63AC37C3:				; CODE XREF: pth_abort+4Ej
		mov	[esp+28h+hThread], offset aPth_abort ; "pth_abort"
		call	sub_63AC1E61
		cmp	[ebp+var_C], 0
		jz	short loc_63AC37E2
		mov	eax, ds:dword_63ACD02C
		sub	eax, 1
		mov	ds:dword_63ACD02C, eax

loc_63AC37E2:				; CODE XREF: pth_abort+67j
		mov	eax, 1

locret_63AC37E7:			; CODE XREF: pth_abort+18j
		leave
		retn
pth_abort	endp

; Exported entry  22. pth_exit

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

		public pth_exit
pth_exit	proc near

Code		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC37FD
		call	pth_init

loc_63AC37FD:				; CODE XREF: pth_exit+Dj
		mov	[esp+18h+Code],	offset aPth_exit ; "pth_exit"
		call	sub_63AC1E16
		call	pth_kill
		mov	[esp+18h+Code],	offset aPth_exit ; "pth_exit"
		call	sub_63AC1E61
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Code],	eax ; Code
		call	exit
pth_exit	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC3825	proc near		; CODE XREF: pth_waitpid+34p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_63AC3825	endp

; Exported entry  23. pth_waitpid

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_waitpid
pth_waitpid	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC3843
		call	pth_init

loc_63AC3843:				; CODE XREF: pth_waitpid+Dj
		mov	[esp+28h+var_28], offset aPth_waitpid ;	"pth_waitpid"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_63AC3825
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_waitpid ;	"pth_waitpid"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_waitpid	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC387C	proc near		; CODE XREF: sub_63AC392F+337p
					; sub_63AC392F+361p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	[ebp+arg_8], 0
		jz	loc_63AC392A
		mov	[ebp+var_4], 0
		jmp	loc_63AC391A
; ---------------------------------------------------------------------------

loc_63AC3898:				; CODE XREF: sub_63AC387C+A8j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_4]
		mov	eax, [eax+edx*4+4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_8], 0
		jmp	short loc_63AC38DF
; ---------------------------------------------------------------------------

loc_63AC38AE:				; CODE XREF: sub_63AC387C+69j
		mov	eax, [ebp+var_8]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, [ebp+var_C]
		jnz	short loc_63AC38DB
		mov	eax, [ebp+var_8]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	edx, [ebp+var_8]
		shl	edx, 3
		add	edx, [ebp+arg_0]
		mov	edx, [edx+4]
		or	edx, [ebp+arg_C]
		mov	[eax+4], edx
		jmp	short loc_63AC38E7
; ---------------------------------------------------------------------------

loc_63AC38DB:				; CODE XREF: sub_63AC387C+40j
		add	[ebp+var_8], 1

loc_63AC38DF:				; CODE XREF: sub_63AC387C+30j
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+arg_4]
		jl	short loc_63AC38AE

loc_63AC38E7:				; CODE XREF: sub_63AC387C+5Dj
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+arg_4]
		jl	short loc_63AC3916
		cmp	[ebp+arg_4], 3Fh
		jg	short loc_63AC3916
		mov	eax, [ebp+arg_4]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		add	[ebp+arg_4], 1

loc_63AC3916:				; CODE XREF: sub_63AC387C+71j
					; sub_63AC387C+77j
		add	[ebp+var_4], 1

loc_63AC391A:				; CODE XREF: sub_63AC387C+17j
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		cmp	edx, eax
		jb	loc_63AC3898

loc_63AC392A:				; CODE XREF: sub_63AC387C+Aj
		mov	eax, [ebp+arg_4]
		leave
		retn
sub_63AC387C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC392F	proc near		; CODE XREF: sub_63AC3D62+1Bp
					; pth_event+35p

s		= dword	ptr -348h
hEventObject	= dword	ptr -344h
lNetworkEvents	= dword	ptr -340h
var_33C		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_320		= dword	ptr -320h
var_31C		= dword	ptr -31Ch
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_118		= byte ptr -118h
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 348h
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 300000h
		test	eax, eax
		jz	short loc_63AC3972
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC3968
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+348h+lNetworkEvents], eax ; char
		mov	[esp+348h+hEventObject], offset	aPth_eventSpecL	; "pth_event spec=%lx -	not supported\n"
		mov	[esp+348h+s], 0	; int
		call	sub_63AC52BE

loc_63AC3968:				; CODE XREF: sub_63AC392F+1Cj
		mov	eax, 0
		jmp	locret_63AC3D60
; ---------------------------------------------------------------------------

loc_63AC3972:				; CODE XREF: sub_63AC392F+13j
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	short loc_63AC3997
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+348h+lNetworkEvents], eax ; char
		mov	[esp+348h+hEventObject], offset	aPth_eventSpe_0	; "pth_event spec=%lx\n"
		mov	[esp+348h+s], 0	; int
		call	sub_63AC52BE

loc_63AC3997:				; CODE XREF: sub_63AC392F+4Bj
		mov	[esp+348h+hEventObject], 28h ; size_t
		mov	[esp+348h+s], 1	; size_t
		call	sub_63AC14ED
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_63AC39BE
		mov	eax, 0
		jmp	locret_63AC3D60
; ---------------------------------------------------------------------------

loc_63AC39BE:				; CODE XREF: sub_63AC392F+83j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 400h
		test	eax, eax
		jnz	short loc_63AC3A1C
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 10h
		test	eax, eax
		jz	short loc_63AC39F2
		call	sub_63AC19B2
		mov	edx, [ebp+var_10]
		mov	[edx+8], eax
		jmp	short loc_63AC39FD
; ---------------------------------------------------------------------------

loc_63AC39F2:				; CODE XREF: sub_63AC392F+B4j
		call	sub_63AC17A9
		mov	edx, [ebp+var_10]
		mov	[edx+8], eax

loc_63AC39FD:				; CODE XREF: sub_63AC392F+C1j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_63AC3A1C
		mov	eax, [ebp+var_10]
		mov	[esp+348h+s], eax ; void *
		call	sub_63AC150D
		mov	eax, 0
		jmp	locret_63AC3D60
; ---------------------------------------------------------------------------

loc_63AC3A1C:				; CODE XREF: sub_63AC392F+AAj
					; sub_63AC392F+D6j
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 400000h
		test	eax, eax
		jz	short loc_63AC3A45
		mov	eax, [ebp+var_10]
		mov	eax, [eax+20h]
		mov	edx, eax
		or	edx, 400000h
		mov	eax, [ebp+var_10]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	[ebp+arg_4], eax

loc_63AC3A45:				; CODE XREF: sub_63AC392F+F7j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+24h], 0
		cmp	dword ptr [ebp+arg_0], 0
		jz	loc_63AC3D5D
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 400h
		test	eax, eax
		jz	short loc_63AC3A85
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 400h
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+8], edx
		jmp	loc_63AC3D5D
; ---------------------------------------------------------------------------

loc_63AC3A85:				; CODE XREF: sub_63AC392F+134j
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 8
		test	eax, eax
		jz	short loc_63AC3AF0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 8
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	dword ptr [ebp+var_14],	0
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	loc_63AC3D5D
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+348h+lNetworkEvents], eax ; char
		mov	[esp+348h+hEventObject], offset	aPth_eventSigsR	; "pth_event: sigs rc=%d\n"
		mov	[esp+348h+s], 0	; int
		call	sub_63AC52BE
		jmp	loc_63AC3D5D
; ---------------------------------------------------------------------------

loc_63AC3AF0:				; CODE XREF: sub_63AC392F+15Ej
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 2
		test	eax, eax
		jz	short loc_63AC3B63
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 1000h
		test	eax, eax
		jz	short loc_63AC3B17
		mov	eax, [ebp+var_10]
		mov	eax, [eax+20h]
		mov	edx, eax
		or	dh, 10h
		mov	eax, [ebp+var_10]
		mov	[eax+20h], edx

loc_63AC3B17:				; CODE XREF: sub_63AC392F+1D5j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, 1
		jle	loc_63AC3D5D
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	[esp+348h+lNetworkEvents], eax ; char
		mov	[esp+348h+hEventObject], offset	aPth_eventFd0xX	; "pth_event: fd=0x%x\n"
		mov	[esp+348h+s], 0	; int
		call	sub_63AC52BE
		jmp	loc_63AC3D5D
; ---------------------------------------------------------------------------

loc_63AC3B63:				; CODE XREF: sub_63AC392F+1C9j
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 10h
		test	eax, eax
		jz	short loc_63AC3BAE
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+8]
		mov	[ebp+arg_4], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_120], eax
		mov	[ebp+var_11C], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 10h
		mov	edx, [ebp+var_120]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	edx, [ebp+var_11C]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		jmp	loc_63AC3D5D
; ---------------------------------------------------------------------------

loc_63AC3BAE:				; CODE XREF: sub_63AC392F+23Cj
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 40h
		test	eax, eax
		jz	short loc_63AC3BD8
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 40h
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		jmp	loc_63AC3D5D
; ---------------------------------------------------------------------------

loc_63AC3BD8:				; CODE XREF: sub_63AC392F+287j
		mov	eax, dword ptr [ebp+arg_0]
		and	eax, 4
		test	eax, eax
		jz	loc_63AC3D5D
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 4
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+1Ch], edx
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		mov	[esp+348h+var_33C], 9
		mov	[esp+348h+lNetworkEvents], eax
		mov	eax, [ebp+var_18]
		mov	[esp+348h+hEventObject], eax
		lea	eax, [ebp+var_320]
		mov	[esp+348h+s], eax
		call	sub_63AC387C
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[esp+348h+var_33C], 2
		mov	[esp+348h+lNetworkEvents], eax
		mov	eax, [ebp+var_18]
		mov	[esp+348h+hEventObject], eax
		lea	eax, [ebp+var_320]
		mov	[esp+348h+s], eax
		call	sub_63AC387C
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+1Ch]
		mov	[esp+348h+var_33C], 24h
		mov	[esp+348h+lNetworkEvents], eax
		mov	eax, [ebp+var_18]
		mov	[esp+348h+hEventObject], eax
		lea	eax, [ebp+var_320]
		mov	[esp+348h+s], eax
		call	sub_63AC387C
		mov	[ebp+var_18], eax
		mov	dword ptr [ebp+var_C], 0
		jmp	loc_63AC3D51
; ---------------------------------------------------------------------------

loc_63AC3CCE:				; CODE XREF: sub_63AC392F+428j
		mov	eax, dword ptr [ebp+var_C]
		mov	ecx, [ebp+eax*8+var_31C]
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [ebp+eax*8+var_320]
		mov	[esp+348h+lNetworkEvents], ecx ; lNetworkEvents
		mov	[esp+348h+hEventObject], edx ; hEventObject
		mov	[esp+348h+s], eax ; s
		mov	eax, ds:WSAEventSelect
		call	eax ; WSAEventSelect
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_63AC3D4D
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC3D4D
		mov	[esp+348h+hEventObject], 100h ;	DWORD
		lea	eax, [ebp+var_118]
		mov	[esp+348h+s], eax ; LPSTR
		call	sub_63AC1579
		mov	edx, dword ptr [ebp+var_C]
		mov	edx, [ebp+edx*8+var_320]
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+var_33C], edx
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+348h+lNetworkEvents], eax ; char
		mov	[esp+348h+hEventObject], offset	aPth_eventWsaev	; "pth_event: WSAEventSelect(%d[%d]) faile"...
		mov	[esp+348h+s], 0	; int
		call	sub_63AC52BE

loc_63AC3D4D:				; CODE XREF: sub_63AC392F+3D0j
					; sub_63AC392F+3D9j
		add	dword ptr [ebp+var_C], 1

loc_63AC3D51:				; CODE XREF: sub_63AC392F+39Aj
		mov	eax, dword ptr [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jl	loc_63AC3CCE

loc_63AC3D5D:				; CODE XREF: sub_63AC392F+124j
					; sub_63AC392F+151j ...
		mov	eax, [ebp+var_10]

locret_63AC3D60:			; CODE XREF: sub_63AC392F+3Ej
					; sub_63AC392F+8Aj ...
		leave
		retn
sub_63AC392F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC3D62	proc near		; CODE XREF: pth_read_ev+3Dp
					; pth_write_ev+3Dp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_63AC392F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_63AC3D62	endp

; Exported entry  32. pth_event

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_event
pth_event	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC3D9E
		call	pth_init

loc_63AC3D9E:				; CODE XREF: pth_event+Dj
		mov	[esp+28h+var_28], offset aPth_event ; "pth_event"
		call	sub_63AC1E16
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_63AC392F
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_event ; "pth_event"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_event	endp

; Exported entry  31. pth_event_concat

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_event_concat
pth_event_concat proc near		; CODE XREF: pth_read_ev+7Cp
					; pth_write_ev+7Cp ...

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC3DEB
		mov	eax, 0
		jmp	short locret_63AC3E59
; ---------------------------------------------------------------------------

loc_63AC3DEB:				; CODE XREF: pth_event_concat+Aj
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC3DF9
		call	pth_init

loc_63AC3DF9:				; CODE XREF: pth_event_concat+1Aj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_1C]
		mov	[eax], edx
		jmp	short loc_63AC3E31
; ---------------------------------------------------------------------------

loc_63AC3E11:				; CODE XREF: pth_event_concat+6Bj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_63AC3E31:				; CODE XREF: pth_event_concat+37j
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+4]
		mov	[ebp+var_1C], edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_63AC3E11
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]

locret_63AC3E59:			; CODE XREF: pth_event_concat+11j
		leave
		retn
pth_event_concat endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; DWORD	__stdcall StartAddress(LPVOID lpThreadParameter)
StartAddress	proc near		; DATA XREF: sub_63AC351B:loc_63AC35C3o

hObject		= dword	ptr -28h
var_C		= dword	ptr -0Ch
lpThreadParameter= dword ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+lpThreadParameter]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_63AC3EEB
		mov	[esp+28h+hObject], offset aLaunch_thread ; "launch_thread"
		call	sub_63AC1E61
		mov	eax, ds:dword_63ACD02C
		add	eax, 1
		mov	ds:dword_63ACD02C, eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+hObject], eax
		call	edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_63AC3EC7
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_63AC3EC7
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0Ch], 0

loc_63AC3EC7:				; CODE XREF: StartAddress+43j
					; StartAddress+4Dj
		mov	eax, ds:dword_63ACD02C
		sub	eax, 1
		mov	ds:dword_63ACD02C, eax
		mov	[esp+28h+hObject], offset aLaunch_thread ; "launch_thread"
		call	sub_63AC1E16
		mov	eax, [ebp+var_C]
		mov	[esp+28h+hObject], eax ; void *
		call	sub_63AC150D

loc_63AC3EEB:				; CODE XREF: StartAddress+10j
		mov	[esp+28h+hObject], 0 ; dwExitCode
		mov	eax, ds:ExitThread
		call	eax ; ExitThread
StartAddress	endp

; Exported entry  29. pth_event_status

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_event_status
pth_event_status proc near		; CODE XREF: pth_write_ev+A3p
					; pth_event_occurred+Cp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC3F0C
		mov	eax, 0
		jmp	short locret_63AC3F4B
; ---------------------------------------------------------------------------

loc_63AC3F0C:				; CODE XREF: pth_event_status+Aj
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC3F1A
		call	pth_init

loc_63AC3F1A:				; CODE XREF: pth_event_status+1Aj
		mov	[esp+28h+var_28], offset aPth_event_stat ; "pth_event_status"
		call	sub_63AC1E16
		cmp	[ebp+arg_0], 0
		jz	short loc_63AC3F34
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		jmp	short loc_63AC3F39
; ---------------------------------------------------------------------------

loc_63AC3F34:				; CODE XREF: pth_event_status+31j
		mov	eax, 0

loc_63AC3F39:				; CODE XREF: pth_event_status+39j
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_event_stat ; "pth_event_status"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]

locret_63AC3F4B:			; CODE XREF: pth_event_status+11j
		leave
		retn
pth_event_status endp

; Exported entry  30. pth_event_occurred

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_event_occurred
pth_event_occurred proc	near

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	pth_event_status
		cmp	eax, 1
		setz	al
		movzx	eax, al
		leave
		retn
pth_event_occurred endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC3F69(void	*, int)
sub_63AC3F69	proc near		; CODE XREF: pth_read_ev+B6p
					; pth_read_ev+E8p ...

hObject		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC3F7F
		mov	eax, 0
		jmp	locret_63AC4072
; ---------------------------------------------------------------------------

loc_63AC3F7F:				; CODE XREF: sub_63AC3F69+Aj
		cmp	[ebp+arg_4], 1
		jnz	short loc_63AC3FF3
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax

loc_63AC3F8B:				; CODE XREF: sub_63AC3F69+86j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		cmp	eax, 10h
		jnz	short loc_63AC3FAE
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+hObject], eax ; HANDLE
		call	sub_63AC1B47
		jmp	short loc_63AC3FCE
; ---------------------------------------------------------------------------

loc_63AC3FAE:				; CODE XREF: sub_63AC3F69+33j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		cmp	eax, 400h
		jz	short loc_63AC3FCE
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC3FCE:				; CODE XREF: sub_63AC3F69+43j
					; sub_63AC3F69+50j
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_C]
		mov	[esp+28h+hObject], eax ; void *
		call	sub_63AC150D
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_63AC3F8B
		jmp	short loc_63AC406D
; ---------------------------------------------------------------------------

loc_63AC3FF3:				; CODE XREF: sub_63AC3F69+1Aj
		cmp	[ebp+arg_4], 0
		jnz	short loc_63AC4066
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+4]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 10h
		jnz	short loc_63AC402F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+hObject], eax ; HANDLE
		call	sub_63AC1B47
		jmp	short loc_63AC404F
; ---------------------------------------------------------------------------

loc_63AC402F:				; CODE XREF: sub_63AC3F69+B4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 400h
		jz	short loc_63AC404F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC404F:				; CODE XREF: sub_63AC3F69+C4j
					; sub_63AC3F69+D1j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hObject], eax ; void *
		call	sub_63AC150D
		jmp	short loc_63AC406D
; ---------------------------------------------------------------------------

loc_63AC4066:				; CODE XREF: sub_63AC3F69+8Ej
		mov	eax, 0
		jmp	short locret_63AC4072
; ---------------------------------------------------------------------------

loc_63AC406D:				; CODE XREF: sub_63AC3F69+88j
					; sub_63AC3F69+FBj
		mov	eax, 1

locret_63AC4072:			; CODE XREF: sub_63AC3F69+11j
					; sub_63AC3F69+102j
		leave
		retn
sub_63AC3F69	endp

; Exported entry  28. pth_event_free

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_event_free(void *, int)
		public pth_event_free
pth_event_free	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC4088
		call	pth_init

loc_63AC4088:				; CODE XREF: pth_event_free+Dj
		mov	[esp+28h+var_28], offset aPth_event_free ; "pth_event_free"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_63AC3F69
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_event_free ; "pth_event_free"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_event_free	endp

; Exported entry  27. pth_event_isolate

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_event_isolate
pth_event_isolate proc near		; CODE XREF: pth_read_ev+98p
					; pth_write_ev+98p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC40CD
		mov	eax, 0
		jmp	short locret_63AC4120
; ---------------------------------------------------------------------------

loc_63AC40CD:				; CODE XREF: pth_event_isolate+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_63AC40E9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_63AC40E9
		mov	eax, 0
		jmp	short locret_63AC4120
; ---------------------------------------------------------------------------

loc_63AC40E9:				; CODE XREF: pth_event_isolate+1Bj
					; pth_event_isolate+26j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+4]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_4]

locret_63AC4120:			; CODE XREF: pth_event_isolate+11j
					; pth_event_isolate+2Dj
		leave
		retn
pth_event_isolate endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC4122	proc near		; CODE XREF: sub_63AC4154+93p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_8], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_63AC414F
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax

loc_63AC413B:				; CODE XREF: sub_63AC4122+2Bj
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_63AC413B

loc_63AC414F:				; CODE XREF: sub_63AC4122+11j
		mov	eax, [ebp+var_8]
		leave
		retn
sub_63AC4122	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC4154	proc near		; CODE XREF: pth_read_ev+87p
					; pth_write_ev+87p ...

s		= dword	ptr -4C8h
hEventObject	= dword	ptr -4C4h
lNetworkEvents	= dword	ptr -4C0h
dwMilliseconds	= dword	ptr -4BCh
var_4B8		= dword	ptr -4B8h
var_4B4		= dword	ptr -4B4h
var_4B0		= dword	ptr -4B0h
var_49C		= dword	ptr -49Ch
NetworkEvents	= _WSANETWORKEVENTS ptr	-29Ch
argp		= dword	ptr -270h
var_26C		= dword	ptr -26Ch
Handles		= dword	ptr -1ECh
var_16C		= byte ptr -16Ch
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
nCount		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4C4h
		mov	[ebp+var_34], 2
		mov	dword ptr [ebp+var_38],	offset aDo_pth_wait ; "do_pth_wait"
		mov	[ebp+var_3C], offset aEv_0 ; "ev"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXEnter ; "%s (%s=0x%x): enter\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC41E1
		mov	[esp+4C8h+var_4B4], 0
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXLeaveResu	; "%s (%s=0x%x): leave:	result=%i\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	loc_63AC4F07
; ---------------------------------------------------------------------------

loc_63AC41E1:				; CODE XREF: sub_63AC4154+51j
		mov	eax, [ebp+arg_0]
		mov	[esp+4C8h+s], eax
		call	sub_63AC4122
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 20h
		jbe	short loc_63AC423C
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+4C8h+s], eax ; int
		call	strerror
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXErrorS ; "%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	loc_63AC4F07
; ---------------------------------------------------------------------------

loc_63AC423C:				; CODE XREF: sub_63AC4154+9Fj
		mov	eax, [ebp+var_44]
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckCntL	; "%s (%s=0x%x): check:	cnt %lu\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax

loc_63AC4271:				; CODE XREF: sub_63AC4154+135j
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_63AC4271
		mov	[ebp+var_48], 0
		mov	eax, [ebp+var_48]
		mov	[ebp+nCount], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax

loc_63AC429E:				; CODE XREF: sub_63AC4154+5EFj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, 8
		jz	short loc_63AC42E3
		cmp	eax, 8
		jg	short loc_63AC42C1
		cmp	eax, 2
		jz	short loc_63AC4331
		cmp	eax, 4
		jz	loc_63AC464D
		jmp	loc_63AC4705
; ---------------------------------------------------------------------------

loc_63AC42C1:				; CODE XREF: sub_63AC4154+158j
		cmp	eax, 40h
		jz	loc_63AC46E6
		cmp	eax, 400h
		jz	loc_63AC469B
		cmp	eax, 10h
		jz	loc_63AC456F
		jmp	loc_63AC4705
; ---------------------------------------------------------------------------

loc_63AC42E3:				; CODE XREF: sub_63AC4154+153j
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckAddS	; "%s (%s=0x%x): check:	add signal event\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_18]
		mov	[ebp+eax*4+var_26C], edx
		mov	edx, ds:hObject
		mov	eax, [ebp+nCount]
		mov	[ebp+eax*4+Handles], edx
		add	[ebp+nCount], 1
		jmp	loc_63AC4735
; ---------------------------------------------------------------------------

loc_63AC4331:				; CODE XREF: sub_63AC4154+15Dj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+4C8h+s], eax ; SOCKET
		call	sub_63AC16F9
		mov	[ebp+var_50], eax
		cmp	[ebp+var_50], 0
		jz	loc_63AC4428
		mov	eax, ds:WSACreateEvent
		call	eax ; WSACreateEvent
		mov	[ebp+var_54], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		and	eax, 1000h
		test	eax, eax
		jz	short loc_63AC4374
		mov	[ebp+var_20], 9
		jmp	short loc_63AC437B
; ---------------------------------------------------------------------------

loc_63AC4374:				; CODE XREF: sub_63AC4154+215j
		mov	[ebp+var_20], 2

loc_63AC437B:				; CODE XREF: sub_63AC4154+21Ej
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		mov	[esp+4C8h+lNetworkEvents], edx ; lNetworkEvents
		mov	edx, [ebp+var_54]
		mov	[esp+4C8h+hEventObject], edx ; hEventObject
		mov	[esp+4C8h+s], eax ; s
		mov	eax, ds:WSAEventSelect
		call	eax ; WSAEventSelect
		sub	esp, 0Ch
		mov	[ebp+var_58], eax
		cmp	[ebp+var_58], 0
		jz	short loc_63AC43CF
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	loc_63AC472E
		mov	eax, [ebp+var_4C]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aCanTSetEventFo	; "can't set event for FD 0x%x (ignored)\n"
		mov	[esp+4C8h+s], 0	; int
		call	sub_63AC52BE
		jmp	loc_63AC472E
; ---------------------------------------------------------------------------

loc_63AC43CF:				; CODE XREF: sub_63AC4154+24Cj
		mov	eax, [ebp+var_54]
		mov	[esp+4C8h+var_4B0], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckSock	; "%s (%s=0x%x): check:	socket event for F"...
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_18]
		mov	[ebp+eax*4+var_26C], edx
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_54]
		mov	[ebp+eax*4+Handles], edx
		add	[ebp+nCount], 1
		jmp	loc_63AC472E
; ---------------------------------------------------------------------------

loc_63AC4428:				; CODE XREF: sub_63AC4154+1F8j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		and	eax, 1000h
		test	eax, eax
		jz	loc_63AC44D5
		mov	eax, [ebp+var_4C]
		mov	[esp+4C8h+s], eax
		call	sub_63AC7ED5
		mov	[ebp+var_5C], eax
		cmp	[ebp+var_5C], 0FFFFFFFFh
		jnz	short loc_63AC447C
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	loc_63AC472E
		mov	eax, [ebp+var_4C]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aNoReaderForFd0	; "no reader for FD 0x%x (ignored)\n"
		mov	[esp+4C8h+s], 0	; int
		call	sub_63AC52BE
		jmp	loc_63AC472E
; ---------------------------------------------------------------------------

loc_63AC447C:				; CODE XREF: sub_63AC4154+2F9j
		mov	eax, [ebp+var_5C]
		mov	[esp+4C8h+var_4B0], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckRe_1	; "%s (%s=0x%x): check:	reader for FD 0x%x"...
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_18]
		mov	[ebp+eax*4+var_26C], edx
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_5C]
		mov	[ebp+eax*4+Handles], edx
		add	[ebp+nCount], 1
		jmp	loc_63AC472E
; ---------------------------------------------------------------------------

loc_63AC44D5:				; CODE XREF: sub_63AC4154+2E1j
		mov	eax, [ebp+var_4C]
		mov	[esp+4C8h+s], eax
		call	sub_63AC7F06
		mov	[ebp+var_60], eax
		cmp	[ebp+var_60], 0FFFFFFFFh
		jnz	short loc_63AC4516
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	loc_63AC472E
		mov	eax, [ebp+var_4C]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aNoWriterForFd0	; "no writer for FD 0x%x (ignored)\n"
		mov	[esp+4C8h+s], 0	; int
		call	sub_63AC52BE
		jmp	loc_63AC472E
; ---------------------------------------------------------------------------

loc_63AC4516:				; CODE XREF: sub_63AC4154+393j
		mov	eax, [ebp+var_60]
		mov	[esp+4C8h+var_4B0], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckWr_0	; "%s (%s=0x%x): check:	writer for FD 0x%x"...
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_18]
		mov	[ebp+eax*4+var_26C], edx
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_60]
		mov	[ebp+eax*4+Handles], edx
		add	[ebp+nCount], 1
		jmp	loc_63AC472E
; ---------------------------------------------------------------------------

loc_63AC456F:				; CODE XREF: sub_63AC4154+184j
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckAddi	; "%s (%s=0x%x): check:	adding timer event"...
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		imul	ebx, eax, 3E8h
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		lea	ecx, [eax+1F4h]
		mov	edx, 10624DD3h
		mov	eax, ecx
		imul	edx
		sar	edx, 6
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		mov	[esp+4C8h+hEventObject], edx ; int
		mov	[esp+4C8h+s], eax ; HANDLE
		call	sub_63AC1A61
		test	eax, eax
		jz	short loc_63AC4627
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+4C8h+s], eax ; int
		call	strerror
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXErrorS ; "%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	loc_63AC4F07
; ---------------------------------------------------------------------------

loc_63AC4627:				; CODE XREF: sub_63AC4154+48Aj
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_18]
		mov	[ebp+eax*4+var_26C], edx
		mov	eax, [ebp+var_18]
		mov	edx, [eax+8]
		mov	eax, [ebp+nCount]
		mov	[ebp+eax*4+Handles], edx
		add	[ebp+nCount], 1
		jmp	loc_63AC4735
; ---------------------------------------------------------------------------

loc_63AC464D:				; CODE XREF: sub_63AC4154+162j
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckAd_0	; "%s (%s=0x%x): check:	adding select even"...
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_18]
		mov	[ebp+eax*4+var_26C], edx
		mov	eax, [ebp+var_18]
		mov	edx, [eax+8]
		mov	eax, [ebp+nCount]
		mov	[ebp+eax*4+Handles], edx
		add	[ebp+nCount], 1
		jmp	loc_63AC4735
; ---------------------------------------------------------------------------

loc_63AC469B:				; CODE XREF: sub_63AC4154+17Bj
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckAd_1	; "%s (%s=0x%x): check:	adding handle even"...
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+nCount]
		mov	edx, [ebp+var_18]
		mov	[ebp+eax*4+var_26C], edx
		mov	eax, [ebp+var_18]
		mov	edx, [eax+8]
		mov	eax, [ebp+nCount]
		mov	[ebp+eax*4+Handles], edx
		add	[ebp+nCount], 1
		jmp	short loc_63AC4735
; ---------------------------------------------------------------------------

loc_63AC46E6:				; CODE XREF: sub_63AC4154+170j
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC4731
		mov	[esp+4C8h+hEventObject], offset	aPth_waitIgnori	; "pth_wait: ignoring mutex event.\n"
		mov	[esp+4C8h+s], 0	; int
		call	sub_63AC52BE
		jmp	short loc_63AC4731
; ---------------------------------------------------------------------------

loc_63AC4705:				; CODE XREF: sub_63AC4154+168j
					; sub_63AC4154+18Aj
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC4734
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aPth_waitUnhand	; "pth_wait: unhandled event type 0x%x.\n"
		mov	[esp+4C8h+s], 0	; int
		call	sub_63AC52BE
		jmp	short loc_63AC4734
; ---------------------------------------------------------------------------

loc_63AC472E:				; CODE XREF: sub_63AC4154+255j
					; sub_63AC4154+276j ...
		nop
		jmp	short loc_63AC4735
; ---------------------------------------------------------------------------

loc_63AC4731:				; CODE XREF: sub_63AC4154+599j
					; sub_63AC4154+5AFj
		nop
		jmp	short loc_63AC4735
; ---------------------------------------------------------------------------

loc_63AC4734:				; CODE XREF: sub_63AC4154+5B8j
					; sub_63AC4154+5D8j
		nop

loc_63AC4735:				; CODE XREF: sub_63AC4154+1D8j
					; sub_63AC4154+4F4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_0]
		jnz	loc_63AC429E
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckDump	; "%s (%s=0x%x): check:	dump list\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+nCount]
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckWfmo	; "%s (%s=0x%x): check:	WFMO n=%d\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	dword ptr [ebp+var_14],	0
		jmp	short loc_63AC47EA
; ---------------------------------------------------------------------------

loc_63AC47A9:				; CODE XREF: sub_63AC4154+69Cj
		mov	eax, dword ptr [ebp+var_14]
		mov	eax, [ebp+eax*4+Handles]
		mov	[esp+4C8h+var_4B0], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckDP ;	"%s (%s=0x%x): check:	    %d=%p\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		add	dword ptr [ebp+var_14],	1

loc_63AC47EA:				; CODE XREF: sub_63AC4154+653j
		mov	eax, dword ptr [ebp+var_14]
		cmp	eax, [ebp+nCount]
		jl	short loc_63AC47A9
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckNowW	; "%s (%s=0x%x): check:	now wait\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+nCount]
		mov	[esp+4C8h+dwMilliseconds], 0FFFFFFFFh ;	dwMilliseconds
		mov	[esp+4C8h+lNetworkEvents], 0 ; bWaitAll
		lea	edx, [ebp+Handles]
		mov	[esp+4C8h+hEventObject], edx ; lpHandles
		mov	[esp+4C8h+s], eax ; nCount
		mov	eax, ds:WaitForMultipleObjects
		call	eax ; WaitForMultipleObjects
		sub	esp, 10h
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckWf_0	; "%s (%s=0x%x): check:	WFMO returned %ld\"...
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	[ebp+var_1C], 0
		mov	[ebp+var_10], 0
		jmp	loc_63AC4DF4
; ---------------------------------------------------------------------------

loc_63AC4889:				; CODE XREF: sub_63AC4154+CA6j
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+var_26C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+Handles]
		mov	[esp+4C8h+hEventObject], 0 ; dwMilliseconds
		mov	[esp+4C8h+s], eax ; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		test	eax, eax
		jnz	loc_63AC4D82
		mov	eax, [ebp+var_18]
		mov	[esp+4C8h+var_4B0], eax
		mov	eax, [ebp+var_10]
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXCheckSett	; "%s (%s=0x%x): check:	setting	%d ev=%p\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+24h], 1
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, 4
		jz	short loc_63AC4928
		cmp	eax, 8
		jnz	loc_63AC4D5A
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	edx, ds:dword_63ACD008
		mov	[eax], edx
		jmp	loc_63AC4D5A
; ---------------------------------------------------------------------------

loc_63AC4928:				; CODE XREF: sub_63AC4154+7B6j
		mov	[ebp+var_24], 0
		mov	[ebp+var_64], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	[esp+4C8h+dwMilliseconds], 0
		mov	[esp+4C8h+lNetworkEvents], eax
		mov	eax, [ebp+var_64]
		mov	[esp+4C8h+hEventObject], eax
		lea	eax, [ebp+var_49C]
		mov	[esp+4C8h+s], eax
		call	sub_63AC387C
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	[esp+4C8h+dwMilliseconds], 0
		mov	[esp+4C8h+lNetworkEvents], eax
		mov	eax, [ebp+var_64]
		mov	[esp+4C8h+hEventObject], eax
		lea	eax, [ebp+var_49C]
		mov	[esp+4C8h+s], eax
		call	sub_63AC387C
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		mov	[esp+4C8h+dwMilliseconds], 0
		mov	[esp+4C8h+lNetworkEvents], eax
		mov	eax, [ebp+var_64]
		mov	[esp+4C8h+hEventObject], eax
		lea	eax, [ebp+var_49C]
		mov	[esp+4C8h+s], eax
		call	sub_63AC387C
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_63AC49CA
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	dword ptr [eax], 0

loc_63AC49CA:				; CODE XREF: sub_63AC4154+868j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_63AC49E0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	dword ptr [eax], 0

loc_63AC49E0:				; CODE XREF: sub_63AC4154+87Ej
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_63AC49F6
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax], 0

loc_63AC49F6:				; CODE XREF: sub_63AC4154+894j
		mov	dword ptr [ebp+var_14],	0
		jmp	loc_63AC4D42
; ---------------------------------------------------------------------------

loc_63AC4A02:				; CODE XREF: sub_63AC4154+BF4j
		mov	eax, dword ptr [ebp+var_14]
		mov	eax, [ebp+eax*8+var_49C]
		lea	edx, [ebp+NetworkEvents]
		mov	[esp+4C8h+lNetworkEvents], edx ; lpNetworkEvents
		mov	[esp+4C8h+hEventObject], 0 ; hEventObject
		mov	[esp+4C8h+s], eax ; s
		mov	eax, ds:WSAEnumNetworkEvents
		call	eax ; WSAEnumNetworkEvents
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_63AC4A84
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	loc_63AC4D3D
		mov	[esp+4C8h+hEventObject], 100h ;	DWORD
		lea	eax, [ebp+var_16C]
		mov	[esp+4C8h+s], eax ; LPSTR
		call	sub_63AC1579
		mov	edx, dword ptr [ebp+var_14]
		mov	edx, [ebp+edx*8+var_49C]
		mov	[esp+4C8h+var_4B8], eax
		mov	[esp+4C8h+dwMilliseconds], edx
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aPth_waitWsaenu	; "pth_wait: WSAEnumNetworkEvents(%d[%d]) "...
		mov	[esp+4C8h+s], 0	; int
		call	sub_63AC52BE
		jmp	loc_63AC4D3D
; ---------------------------------------------------------------------------

loc_63AC4A84:				; CODE XREF: sub_63AC4154+8D9j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	loc_63AC4B18
		mov	eax, [ebp+NetworkEvents.lNetworkEvents]
		and	eax, 9
		test	eax, eax
		jz	short loc_63AC4B18
		mov	[ebp+var_28], 0
		jmp	short loc_63AC4AC7
; ---------------------------------------------------------------------------

loc_63AC4AA8:				; CODE XREF: sub_63AC4154+97Ej
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	edx, [ebp+var_28]
		mov	edx, [eax+edx*4+4]
		mov	eax, dword ptr [ebp+var_14]
		mov	eax, [ebp+eax*8+var_49C]
		cmp	edx, eax
		jz	short loc_63AC4AD4
		add	[ebp+var_28], 1

loc_63AC4AC7:				; CODE XREF: sub_63AC4154+952j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	eax, [eax]
		cmp	eax, [ebp+var_28]
		ja	short loc_63AC4AA8

loc_63AC4AD4:				; CODE XREF: sub_63AC4154+96Dj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	eax, [eax]
		cmp	eax, [ebp+var_28]
		jnz	short loc_63AC4B14
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	eax, [eax]
		cmp	eax, 3Fh
		ja	short loc_63AC4B14
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	edx, dword ptr [ebp+var_14]
		mov	edx, [ebp+edx*8+var_49C]
		mov	ecx, edx
		mov	edx, [ebp+var_28]
		mov	[eax+edx*4+4], ecx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	edx, [eax]
		add	edx, 1
		mov	[eax], edx

loc_63AC4B14:				; CODE XREF: sub_63AC4154+98Bj
					; sub_63AC4154+998j
		add	[ebp+var_24], 1

loc_63AC4B18:				; CODE XREF: sub_63AC4154+938j
					; sub_63AC4154+949j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_63AC4BAC
		mov	eax, [ebp+NetworkEvents.lNetworkEvents]
		and	eax, 2
		test	eax, eax
		jz	short loc_63AC4BAC
		mov	[ebp+var_2C], 0
		jmp	short loc_63AC4B5B
; ---------------------------------------------------------------------------

loc_63AC4B3C:				; CODE XREF: sub_63AC4154+A12j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_2C]
		mov	edx, [eax+edx*4+4]
		mov	eax, dword ptr [ebp+var_14]
		mov	eax, [ebp+eax*8+var_49C]
		cmp	edx, eax
		jz	short loc_63AC4B68
		add	[ebp+var_2C], 1

loc_63AC4B5B:				; CODE XREF: sub_63AC4154+9E6j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	eax, [eax]
		cmp	eax, [ebp+var_2C]
		ja	short loc_63AC4B3C

loc_63AC4B68:				; CODE XREF: sub_63AC4154+A01j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	eax, [eax]
		cmp	eax, [ebp+var_2C]
		jnz	short loc_63AC4BA8
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	eax, [eax]
		cmp	eax, 3Fh
		ja	short loc_63AC4BA8
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, dword ptr [ebp+var_14]
		mov	edx, [ebp+edx*8+var_49C]
		mov	ecx, edx
		mov	edx, [ebp+var_2C]
		mov	[eax+edx*4+4], ecx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [eax]
		add	edx, 1
		mov	[eax], edx

loc_63AC4BA8:				; CODE XREF: sub_63AC4154+A1Fj
					; sub_63AC4154+A2Cj
		add	[ebp+var_24], 1

loc_63AC4BAC:				; CODE XREF: sub_63AC4154+9CCj
					; sub_63AC4154+9DDj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_63AC4C40
		mov	eax, [ebp+NetworkEvents.lNetworkEvents]
		and	eax, 24h
		test	eax, eax
		jz	short loc_63AC4C40
		mov	[ebp+var_30], 0
		jmp	short loc_63AC4BEF
; ---------------------------------------------------------------------------

loc_63AC4BD0:				; CODE XREF: sub_63AC4154+AA6j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_30]
		mov	edx, [eax+edx*4+4]
		mov	eax, dword ptr [ebp+var_14]
		mov	eax, [ebp+eax*8+var_49C]
		cmp	edx, eax
		jz	short loc_63AC4BFC
		add	[ebp+var_30], 1

loc_63AC4BEF:				; CODE XREF: sub_63AC4154+A7Aj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, [ebp+var_30]
		ja	short loc_63AC4BD0

loc_63AC4BFC:				; CODE XREF: sub_63AC4154+A95j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, [ebp+var_30]
		jnz	short loc_63AC4C3C
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 3Fh
		ja	short loc_63AC4C3C
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		mov	edx, dword ptr [ebp+var_14]
		mov	edx, [ebp+edx*8+var_49C]
		mov	ecx, edx
		mov	edx, [ebp+var_30]
		mov	[eax+edx*4+4], ecx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		mov	edx, [eax]
		add	edx, 1
		mov	[eax], edx

loc_63AC4C3C:				; CODE XREF: sub_63AC4154+AB3j
					; sub_63AC4154+AC0j
		add	[ebp+var_24], 1

loc_63AC4C40:				; CODE XREF: sub_63AC4154+A60j
					; sub_63AC4154+A71j
		mov	eax, dword ptr [ebp+var_14]
		mov	eax, [ebp+eax*8+var_49C]
		mov	[esp+4C8h+lNetworkEvents], 0 ; lNetworkEvents
		mov	[esp+4C8h+hEventObject], 0 ; hEventObject
		mov	[esp+4C8h+s], eax ; s
		mov	eax, ds:WSAEventSelect
		call	eax ; WSAEventSelect
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_63AC4CB7
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC4CB7
		mov	[esp+4C8h+hEventObject], 100h ;	DWORD
		lea	eax, [ebp+var_16C]
		mov	[esp+4C8h+s], eax ; LPSTR
		call	sub_63AC1579
		mov	edx, dword ptr [ebp+var_14]
		mov	edx, [ebp+edx*8+var_49C]
		mov	[esp+4C8h+var_4B8], eax
		mov	[esp+4C8h+dwMilliseconds], edx
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aPth_waitWsaeve	; "pth_wait: WSAEventSelect(%d[%d]-clear) "...
		mov	[esp+4C8h+s], 0	; int
		call	sub_63AC52BE

loc_63AC4CB7:				; CODE XREF: sub_63AC4154+B15j
					; sub_63AC4154+B1Ej
		mov	[ebp+argp], 0
		mov	eax, dword ptr [ebp+var_14]
		mov	eax, [ebp+eax*8+var_49C]
		lea	edx, [ebp+argp]
		mov	[esp+4C8h+lNetworkEvents], edx ; argp
		mov	[esp+4C8h+hEventObject], 8004667Eh ; cmd
		mov	[esp+4C8h+s], eax ; s
		mov	eax, ds:ioctlsocket
		call	eax ; ioctlsocket
		sub	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_63AC4D3E
		mov	eax, ds:dword_63ACD7CC
		test	eax, eax
		jle	short loc_63AC4D3E
		mov	[esp+4C8h+hEventObject], 100h ;	DWORD
		lea	eax, [ebp+var_16C]
		mov	[esp+4C8h+s], eax ; LPSTR
		call	sub_63AC1579
		mov	edx, dword ptr [ebp+var_14]
		mov	edx, [ebp+edx*8+var_49C]
		mov	[esp+4C8h+var_4B8], eax
		mov	[esp+4C8h+dwMilliseconds], edx
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aPth_waitIoctls	; "pth_wait: ioctlsocket(%d[%d]) failed: %"...
		mov	[esp+4C8h+s], 0	; int
		call	sub_63AC52BE
		jmp	short loc_63AC4D3E
; ---------------------------------------------------------------------------

loc_63AC4D3D:				; CODE XREF: sub_63AC4154+8E2j
					; sub_63AC4154+92Bj
		nop

loc_63AC4D3E:				; CODE XREF: sub_63AC4154+B99j
					; sub_63AC4154+BA2j ...
		add	dword ptr [ebp+var_14],	1

loc_63AC4D42:				; CODE XREF: sub_63AC4154+8A9j
		mov	eax, dword ptr [ebp+var_14]
		cmp	eax, [ebp+var_64]
		jl	loc_63AC4A02
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		nop

loc_63AC4D5A:				; CODE XREF: sub_63AC4154+7BBj
					; sub_63AC4154+7CFj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, 10h
		jz	short loc_63AC4D82
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, 2
		jz	short loc_63AC4D82
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+Handles]
		mov	[esp+4C8h+s], eax ; HANDLE
		call	sub_63AC192E

loc_63AC4D82:				; CODE XREF: sub_63AC4154+763j
					; sub_63AC4154+C0Fj ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, 2
		jnz	short loc_63AC4DF0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_68]
		mov	[esp+4C8h+s], eax ; SOCKET
		call	sub_63AC16F9
		mov	[ebp+var_6C], eax
		cmp	[ebp+var_6C], 0
		jz	short loc_63AC4DEF
		mov	eax, [ebp+var_68]
		mov	[esp+4C8h+lNetworkEvents], 0 ; lNetworkEvents
		mov	[esp+4C8h+hEventObject], 0 ; hEventObject
		mov	[esp+4C8h+s], eax ; s
		mov	eax, ds:WSAEventSelect
		call	eax ; WSAEventSelect
		sub	esp, 0Ch
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+Handles]
		mov	[esp+4C8h+s], eax ; hEvent
		mov	eax, ds:WSACloseEvent
		call	eax ; WSACloseEvent
		sub	esp, 4
		mov	eax, [ebp+var_10]
		mov	[ebp+eax*4+Handles], 0

loc_63AC4DEF:				; CODE XREF: sub_63AC4154+C54j
		nop

loc_63AC4DF0:				; CODE XREF: sub_63AC4154+C37j
		add	[ebp+var_10], 1

loc_63AC4DF4:				; CODE XREF: sub_63AC4154+730j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+nCount]
		jl	loc_63AC4889
		cmp	[ebp+var_1C], 0
		jz	short loc_63AC4E85
		cmp	[ebp+var_1C], 0
		js	short loc_63AC4E40
		mov	eax, [ebp+var_1C]
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXLeaveResu	; "%s (%s=0x%x): leave:	result=%i\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_1C]
		jmp	short loc_63AC4E80
; ---------------------------------------------------------------------------

loc_63AC4E40:				; CODE XREF: sub_63AC4154+CB6j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+4C8h+s], eax ; int
		call	strerror
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXErrorS ; "%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_1C]

loc_63AC4E80:				; CODE XREF: sub_63AC4154+CEAj
		jmp	loc_63AC4F07
; ---------------------------------------------------------------------------

loc_63AC4E85:				; CODE XREF: sub_63AC4154+CB0j
		cmp	[ebp+var_44], 102h
		jnz	short loc_63AC4EC5
		mov	[esp+4C8h+var_4B4], 0
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXLeaveResu	; "%s (%s=0x%x): leave:	result=%i\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	short loc_63AC4F07
; ---------------------------------------------------------------------------

loc_63AC4EC5:				; CODE XREF: sub_63AC4154+D38j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+4C8h+s], eax ; int
		call	strerror
		mov	[esp+4C8h+var_4B4], eax
		mov	eax, [ebp+var_40]
		mov	[esp+4C8h+var_4B8], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+4C8h+dwMilliseconds], eax
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+4C8h+lNetworkEvents], eax ; char
		mov	[esp+4C8h+hEventObject], offset	aSS0xXErrorS ; "%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_34]
		mov	[esp+4C8h+s], eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh

loc_63AC4F07:				; CODE XREF: sub_63AC4154+88j
					; sub_63AC4154+E3j ...
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_63AC4154	endp

; Exported entry  24. pth_wait

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_wait
pth_wait	proc near

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC4F20
		call	pth_init

loc_63AC4F20:				; CODE XREF: pth_wait+Dj
		mov	[esp+28h+var_28], offset aPth_wait ; "pth_wait"
		call	sub_63AC1E16
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_63AC4154
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_28], offset aPth_wait ; "pth_wait"
		call	sub_63AC1E61
		mov	eax, [ebp+var_C]
		leave
		retn
pth_wait	endp

; Exported entry  25. pth_sleep

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_sleep
pth_sleep	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC4F5F
		call	pth_init

loc_63AC4F5F:				; CODE XREF: pth_sleep+Dj
		mov	[esp+28h+var_28], offset aPth_sleep ; "pth_sleep"
		call	sub_63AC1E16
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC4F84
		mov	[esp+28h+var_28], offset aPth_sleep ; "pth_sleep"
		call	sub_63AC1E61
		mov	eax, 0
		jmp	short locret_63AC4FFE
; ---------------------------------------------------------------------------

loc_63AC4F84:				; CODE XREF: pth_sleep+24j
		mov	[esp+28h+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	pth_timeout
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_24], offset dword_63ACA004
		mov	[esp+28h+var_28], 400010h
		call	sub_63AC3D62
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC4FCF
		mov	[esp+28h+var_28], offset aPth_sleep ; "pth_sleep"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC4FFE
; ---------------------------------------------------------------------------

loc_63AC4FCF:				; CODE XREF: pth_sleep+6Fj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_63AC4154
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_63AC3F69
		mov	[esp+28h+var_28], offset aPth_sleep ; "pth_sleep"
		call	sub_63AC1E61
		mov	eax, 0

locret_63AC4FFE:			; CODE XREF: pth_sleep+37j
					; pth_sleep+82j
		leave
		retn
pth_sleep	endp

; Exported entry  42. pth_usleep

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_usleep
pth_usleep	proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC5014
		call	pth_init

loc_63AC5014:				; CODE XREF: pth_usleep+Dj
		mov	[esp+28h+var_28], offset aPth_usleep ; "pth_usleep"
		call	sub_63AC1E16
		cmp	[ebp+arg_0], 0
		jnz	short loc_63AC5039
		mov	[esp+28h+var_28], offset aPth_usleep ; "pth_usleep"
		call	sub_63AC1E61
		mov	eax, 0
		jmp	short locret_63AC50B3
; ---------------------------------------------------------------------------

loc_63AC5039:				; CODE XREF: pth_usleep+24j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 0
		call	pth_timeout
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_24], offset dword_63ACA000
		mov	[esp+28h+var_28], 400010h
		call	sub_63AC3D62
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC5084
		mov	[esp+28h+var_28], offset aPth_usleep ; "pth_usleep"
		call	sub_63AC1E61
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC50B3
; ---------------------------------------------------------------------------

loc_63AC5084:				; CODE XREF: pth_usleep+6Fj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_63AC4154
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_63AC3F69
		mov	[esp+28h+var_28], offset aPth_usleep ; "pth_usleep"
		call	sub_63AC1E61
		mov	eax, 0

locret_63AC50B3:			; CODE XREF: pth_usleep+37j
					; pth_usleep+82j
		leave
		retn
pth_usleep	endp

; Exported entry  34. pth_sigmask

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_sigmask
pth_sigmask	proc near
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
pth_sigmask	endp

; Exported entry  38. pth_yield

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_yield
pth_yield	proc near

dwMilliseconds	= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_63ACD004
		test	eax, eax
		jnz	short loc_63AC50D3
		call	pth_init

loc_63AC50D3:				; CODE XREF: pth_yield+Dj
		mov	[esp+18h+dwMilliseconds], offset aPth_yield ; "pth_yield"
		call	sub_63AC1E16
		mov	[esp+18h+dwMilliseconds], 0 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		mov	[esp+18h+dwMilliseconds], offset aPth_yield ; "pth_yield"
		call	sub_63AC1E61
		mov	eax, 1
		leave
		retn
pth_yield	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC5104	proc near		; CODE XREF: sub_63AC52BE+123p
					; sub_63AC53FB+8Fp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		leave
		retn
sub_63AC5104	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_63AC5118	proc near		; CODE XREF: sub_63AC5144+8Fp

File		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, offset Format ; "sema.c: %s\n"
		mov	edx, ds:_iob
		lea	ecx, [edx+40h]
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_10], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	[esp+18h+File],	ecx ; File
		call	fprintf
		call	abort
sub_63AC5118	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC5144	proc near		; CODE XREF: sub_63AC5207+Dp
					; sub_63AC521B+16p ...

lpCriticalSection= dword ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_63ACD400
		test	eax, eax
		jnz	short loc_63AC516E
		mov	[esp+28h+lpCriticalSection], offset stru_63ACD404 ; lpCriticalSection
		mov	eax, ds:InitializeCriticalSection
		call	eax ; InitializeCriticalSection
		sub	esp, 4
		mov	ds:dword_63ACD400, 1

loc_63AC516E:				; CODE XREF: sub_63AC5144+Dj
		cmp	[ebp+arg_0], 0
		jz	loc_63AC5204
		mov	[esp+28h+lpCriticalSection], offset stru_63ACD404 ; lpCriticalSection
		mov	eax, ds:EnterCriticalSection
		call	eax ; EnterCriticalSection
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_63AC51A6
		mov	[esp+28h+lpCriticalSection], offset stru_63ACD404 ; lpCriticalSection
		mov	eax, ds:LeaveCriticalSection
		call	eax ; LeaveCriticalSection
		sub	esp, 4
		jmp	short locret_63AC5205
; ---------------------------------------------------------------------------

loc_63AC51A6:				; CODE XREF: sub_63AC5144+4Dj
		mov	[esp+28h+lpCriticalSection], 18h ; size_t
		call	sub_63AC14D4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC51D8
		mov	[esp+28h+lpCriticalSection], offset stru_63ACD404 ; lpCriticalSection
		mov	eax, ds:LeaveCriticalSection
		call	eax ; LeaveCriticalSection
		sub	esp, 4
		mov	[esp+28h+lpCriticalSection], offset aOutOfCoreWhile ; "out of core while creating critical sec"...
		call	sub_63AC5118
; ---------------------------------------------------------------------------

loc_63AC51D8:				; CODE XREF: sub_63AC5144+75j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+lpCriticalSection], eax ; lpCriticalSection
		mov	eax, ds:InitializeCriticalSection
		call	eax ; InitializeCriticalSection
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+4], edx
		mov	[esp+28h+lpCriticalSection], offset stru_63ACD404 ; lpCriticalSection
		mov	eax, ds:LeaveCriticalSection
		call	eax ; LeaveCriticalSection
		sub	esp, 4
		jmp	short locret_63AC5205
; ---------------------------------------------------------------------------

loc_63AC5204:				; CODE XREF: sub_63AC5144+2Ej
		nop

locret_63AC5205:			; CODE XREF: sub_63AC5144+60j
					; sub_63AC5144+BEj
		leave
		retn
sub_63AC5144	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC5207	proc near		; CODE XREF: pth_init:loc_63AC1B7Cp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_63AC5144
		leave
		retn
sub_63AC5207	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC521B	proc near		; CODE XREF: sub_63AC52BE+32p
					; sub_63AC5507+75p ...

lpCriticalSection= dword ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_63AC5236
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+lpCriticalSection], eax
		call	sub_63AC5144

loc_63AC5236:				; CODE XREF: sub_63AC521B+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+lpCriticalSection], eax ; lpCriticalSection
		mov	eax, ds:EnterCriticalSection
		call	eax ; EnterCriticalSection
		sub	esp, 4
		leave
		retn
sub_63AC521B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC524B	proc near		; CODE XREF: sub_63AC52BE+10Bp
					; sub_63AC5507+ECp ...

lpCriticalSection= dword ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_63AC5266
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+lpCriticalSection], eax
		call	sub_63AC5144

loc_63AC5266:				; CODE XREF: sub_63AC524B+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+lpCriticalSection], eax ; lpCriticalSection
		mov	eax, ds:LeaveCriticalSection
		call	eax ; LeaveCriticalSection
		sub	esp, 4
		leave
		retn
sub_63AC524B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC527B	proc near		; CODE XREF: sub_63AC5A83+37Fp
					; sub_63AC5EF1+171p ...

lpCriticalSection= dword ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_63AC52BC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short locret_63AC52BC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+lpCriticalSection], eax ; lpCriticalSection
		mov	eax, ds:DeleteCriticalSection
		call	eax ; DeleteCriticalSection
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+lpCriticalSection], eax ; void	*
		call	sub_63AC150D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0

locret_63AC52BC:			; CODE XREF: sub_63AC527B+Aj
					; sub_63AC527B+14j
		leave
		retn
sub_63AC527B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC52BE(int,	char *,	char)
sub_63AC52BE	proc near		; CODE XREF: sub_63AC16F9+A6p
					; sub_63AC17A9+99p ...

File		= dword	ptr -58h
Format		= dword	ptr -54h
ArgList		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_63ACD7CC
		cmp	eax, [ebp+arg_0]
		jl	loc_63AC53E8
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_20]
		mov	[eax], edx
		mov	[esp+58h+File],	offset off_63ACA010
		call	sub_63AC521B
		mov	eax, ds:GetCurrentThreadId
		call	eax ; GetCurrentThreadId
		mov	esi, eax
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	ebx, eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	ecx, eax
		mov	eax, ecx
		shr	eax, 5
		mov	[ebp+var_2C], eax
		mov	edx, 0A7C5AC5h
		mov	eax, [ebp+var_2C]
		mul	edx
		mov	eax, edx
		shr	eax, 7
		imul	eax, 186A0h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	ecx, offset a05luLu_LuW32pt ; "%05lu/%lu.%lu/w32pth: "
		mov	edx, ds:File
		mov	[esp+58h+var_48], esi
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+ArgList], eax
		mov	[esp+58h+Format], ecx ;	Format
		mov	[esp+58h+File],	edx ; File
		call	fprintf
		mov	edx, [ebp+var_20]
		mov	eax, ds:File
		mov	[esp+58h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_4]
		mov	[esp+58h+Format], edx ;	Format
		mov	[esp+58h+File],	eax ; File
		call	vfprintf
		cmp	[ebp+arg_4], 0
		jz	short loc_63AC53C2
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_63AC53C2
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_30], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_30]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_63AC53C2
		mov	eax, ds:File
		mov	[esp+58h+Format], eax ;	File
		mov	[esp+58h+File],	0Ah ; Ch
		call	putc

loc_63AC53C2:				; CODE XREF: sub_63AC52BE+B7j
					; sub_63AC52BE+C1j ...
		mov	[esp+58h+File],	offset off_63ACA010
		call	sub_63AC524B
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		call	fflush
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax
		call	sub_63AC5104
		jmp	short loc_63AC53E9
; ---------------------------------------------------------------------------

loc_63AC53E8:				; CODE XREF: sub_63AC52BE+1Dj
		nop

loc_63AC53E9:				; CODE XREF: sub_63AC52BE+128j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_63AC52BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC53F1	proc near		; CODE XREF: sub_63AC5A83:loc_63AC5EA8p
					; sub_63AC6C1D:loc_63AC7042p
		push	ebp
		mov	ebp, esp
		mov	eax, 2
		pop	ebp
		retn
sub_63AC53F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC53FB(HANDLE hObject)
sub_63AC53FB	proc near		; CODE XREF: sub_63AC5A83+2DAp
					; sub_63AC6C1D+2DAp

hSourceProcessHandle= dword ptr	-38h
hSourceHandle	= dword	ptr -34h
hTargetProcessHandle= dword ptr	-30h
lpTargetHandle	= dword	ptr -2Ch
dwDesiredAccess	= dword	ptr -28h
bInheritHandle	= dword	ptr -24h
dwOptions	= dword	ptr -20h
TargetHandle	= dword	ptr -0Ch
var_4		= dword	ptr -4
hObject		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+38h+dwOptions], 0 ; dwOptions
		mov	[esp+38h+bInheritHandle], 0 ; bInheritHandle
		mov	[esp+38h+dwDesiredAccess], 100002h ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+38h+lpTargetHandle], edx ;	lpTargetHandle
		mov	[esp+38h+hTargetProcessHandle],	ebx ; hTargetProcessHandle
		mov	edx, [ebp+hObject]
		mov	[esp+38h+hSourceHandle], edx ; hSourceHandle
		mov	[esp+38h+hSourceProcessHandle],	eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_63AC5496
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+38h+bInheritHandle], eax
		mov	eax, [ebp+hObject]
		mov	[esp+38h+dwDesiredAccess], eax
		mov	[esp+38h+lpTargetHandle], offset aHd ; "hd"
		mov	[esp+38h+hTargetProcessHandle],	offset aPthSet_synchro ; "pth:set_synchronize"
		mov	[esp+38h+hSourceHandle], offset	aSS0xXCallDupli	; "%s (%s=0x%x): call: DuplicateHandle fai"...
		mov	[esp+38h+hSourceProcessHandle],	2 ; int
		call	sub_63AC52BE
		mov	[esp+38h+hSourceProcessHandle],	5
		call	sub_63AC5104
		mov	eax, 0FFFFFFFFh
		jmp	short loc_63AC54A9
; ---------------------------------------------------------------------------

loc_63AC5496:				; CODE XREF: sub_63AC53FB+50j
		mov	eax, [ebp+hObject]
		mov	[esp+38h+hSourceProcessHandle],	eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+TargetHandle]

loc_63AC54A9:				; CODE XREF: sub_63AC53FB+99j
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_63AC53FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC54AE(HANDLE hNamedPipe)
sub_63AC54AE	proc near		; CODE XREF: sub_63AC5507+64p
					; sub_63AC67D6+64p

hFile		= dword	ptr -38h
lpFlags		= dword	ptr -34h
lpOutBufferSize	= dword	ptr -30h
lpInBufferSize	= dword	ptr -2Ch
lpMaxInstances	= dword	ptr -28h
MaxInstances	= dword	ptr -18h
InBufferSize	= dword	ptr -14h
OutBufferSize	= dword	ptr -10h
Flags		= dword	ptr -0Ch
hNamedPipe	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+hNamedPipe]
		mov	[esp+38h+hFile], eax ; hFile
		mov	eax, ds:GetFileType
		call	eax ; GetFileType
		sub	esp, 4
		cmp	eax, 3
		jnz	short loc_63AC5500
		lea	eax, [ebp+MaxInstances]
		mov	[esp+38h+lpMaxInstances], eax ;	lpMaxInstances
		lea	eax, [ebp+InBufferSize]
		mov	[esp+38h+lpInBufferSize], eax ;	lpInBufferSize
		lea	eax, [ebp+OutBufferSize]
		mov	[esp+38h+lpOutBufferSize], eax ; lpOutBufferSize
		lea	eax, [ebp+Flags]
		mov	[esp+38h+lpFlags], eax ; lpFlags
		mov	eax, [ebp+hNamedPipe]
		mov	[esp+38h+hFile], eax ; hNamedPipe
		mov	eax, ds:GetNamedPipeInfo
		call	eax ; GetNamedPipeInfo
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_63AC5500
		mov	eax, 1
		jmp	short locret_63AC5505
; ---------------------------------------------------------------------------

loc_63AC5500:				; CODE XREF: sub_63AC54AE+19j
					; sub_63AC54AE+49j
		mov	eax, 0

locret_63AC5505:			; CODE XREF: sub_63AC54AE+50j
		leave
		retn
sub_63AC54AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; DWORD	__stdcall sub_63AC5507(LPVOID lpThreadParameter)
sub_63AC5507	proc near		; DATA XREF: sub_63AC5A83+30Fo

hEvent		= dword	ptr -58h
dwMilliseconds	= dword	ptr -54h
len		= dword	ptr -50h
flags		= dword	ptr -4Ch
lpOverlapped	= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
NumberOfBytesRead= dword ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
nNumberOfBytesToRead= dword ptr	-0Ch
var_4		= dword	ptr -4
lpThreadParameter= dword ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	eax, [ebp+lpThreadParameter]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 2
		mov	dword ptr [ebp+var_18],	offset aPthReader ; "pth:reader"
		mov	[ebp+var_1C], offset aCtxFile_hd ; "ctx->file_hd"
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXEnterThre ; "%s (%s=0x%x): enter: thread=%p\n"
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+58h+hEvent], eax ;	hNamedPipe
		call	sub_63AC54AE
		mov	[ebp+var_24], eax

loc_63AC5573:				; CODE XREF: sub_63AC5507+4E6j
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[esp+58h+hEvent], eax
		call	sub_63AC521B
		mov	eax, [ebp+var_10]
		mov	eax, [eax+38h]
		add	eax, 1
		mov	edx, eax
		and	edx, 0FFFh
		mov	eax, [ebp+var_10]
		mov	eax, [eax+34h]
		cmp	edx, eax
		jnz	loc_63AC5671
		mov	eax, [ebp+var_10]
		mov	eax, [eax+2Ch]
		mov	[esp+58h+hEvent], eax ;	hEvent
		mov	eax, ds:ResetEvent
		call	eax ; ResetEvent
		sub	esp, 4
		test	eax, eax
		jnz	short loc_63AC55EA
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckRese ; "%s (%s=0x%x): check: ResetEvent failed:"...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE

loc_63AC55EA:				; CODE XREF: sub_63AC5507+AEj
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[esp+58h+hEvent], eax
		call	sub_63AC524B
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckWait ; "%s (%s=0x%x): check: waiting for space\"...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_10]
		mov	eax, [eax+2Ch]
		mov	[esp+58h+dwMilliseconds], 0FFFFFFFFh ; dwMilliseconds
		mov	[esp+58h+hEvent], eax ;	hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckGotS ; "%s (%s=0x%x): check: got space\n"
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[esp+58h+hEvent], eax
		call	sub_63AC521B

loc_63AC5671:				; CODE XREF: sub_63AC5507+93j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_63AC568E
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[esp+58h+hEvent], eax
		call	sub_63AC524B
		jmp	loc_63AC59F2
; ---------------------------------------------------------------------------

loc_63AC568E:				; CODE XREF: sub_63AC5507+172j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+38h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 0FFFh
		and	eax, 0FFFh
		mov	[ebp+nNumberOfBytesToRead], eax
		mov	edx, [ebp+nNumberOfBytesToRead]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+38h]
		mov	ecx, 1000h
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		cmp	edx, eax
		jbe	short loc_63AC56D9
		mov	eax, [ebp+var_10]
		mov	eax, [eax+38h]
		mov	edx, 1000h
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+nNumberOfBytesToRead], eax

loc_63AC56D9:				; CODE XREF: sub_63AC5507+1BCj
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[esp+58h+hEvent], eax
		call	sub_63AC524B
		cmp	[ebp+var_24], 0
		jz	short loc_63AC56F4
		mov	eax, offset aReceiving ; "receiving"
		jmp	short loc_63AC56F9
; ---------------------------------------------------------------------------

loc_63AC56F4:				; CODE XREF: sub_63AC5507+1E4j
		mov	eax, offset aReading ; "reading"

loc_63AC56F9:				; CODE XREF: sub_63AC5507+1EBj
		mov	edx, [ebp+nNumberOfBytesToRead]
		mov	[esp+58h+var_40], edx
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckSDBy ; "%s (%s=0x%x): check: %s %d bytes\n"
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		cmp	[ebp+var_24], 0
		jz	loc_63AC5812
		mov	eax, [ebp+var_10]
		lea	edx, [eax+3Ch]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+38h]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+58h+flags], 0 ; flags
		mov	edx, [ebp+nNumberOfBytesToRead]
		mov	[esp+58h+len], edx ; len
		mov	[esp+58h+dwMilliseconds], ecx ;	buf
		mov	[esp+58h+hEvent], eax ;	s
		mov	eax, ds:recv
		call	eax ; recv
		sub	esp, 10h
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jns	loc_63AC5807
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	edx, [ebp+var_10]
		mov	[edx+24h], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		cmp	eax, 6Dh
		jnz	short loc_63AC57C6
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 1
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckGotE ; "%s (%s=0x%x): check: got EOF (broken co"...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		jmp	loc_63AC59F2
; ---------------------------------------------------------------------------

loc_63AC57C6:				; CODE XREF: sub_63AC5507+286j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+20h], 1
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckRe_2 ; "%s (%s=0x%x): check: recv error: ec=%d\"...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		jmp	loc_63AC59F2
; ---------------------------------------------------------------------------

loc_63AC5807:				; CODE XREF: sub_63AC5507+26Aj
		mov	eax, [ebp+var_28]
		mov	[ebp+NumberOfBytesRead], eax
		jmp	loc_63AC58E7
; ---------------------------------------------------------------------------

loc_63AC5812:				; CODE XREF: sub_63AC5507+229j
		mov	edx, [ebp+nNumberOfBytesToRead]
		mov	eax, [ebp+var_10]
		lea	ecx, [eax+3Ch]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+38h]
		lea	ebx, [ecx+eax]
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesRead]
		mov	[esp+58h+flags], ecx ; lpNumberOfBytesRead
		mov	[esp+58h+len], edx ; nNumberOfBytesToRead
		mov	[esp+58h+dwMilliseconds], ebx ;	lpBuffer
		mov	[esp+58h+hEvent], eax ;	hFile
		mov	eax, ds:ReadFile
		call	eax ; ReadFile
		sub	esp, 14h
		test	eax, eax
		jnz	loc_63AC58E7
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+24h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		cmp	eax, 6Dh
		jnz	short loc_63AC58A6
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 1
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckGo_0 ; "%s (%s=0x%x): check: got EOF (broken pi"...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		jmp	loc_63AC59F2
; ---------------------------------------------------------------------------

loc_63AC58A6:				; CODE XREF: sub_63AC5507+366j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+20h], 1
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckRe_3 ; "%s (%s=0x%x): check: read error: ec=%d\"...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		jmp	loc_63AC59F2
; ---------------------------------------------------------------------------

loc_63AC58E7:				; CODE XREF: sub_63AC5507+306j
					; sub_63AC5507+348j
		mov	eax, [ebp+NumberOfBytesRead]
		test	eax, eax
		jnz	short loc_63AC5925
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 1
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckGo_1 ; "%s (%s=0x%x): check: got eof\n"
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		jmp	loc_63AC59F2
; ---------------------------------------------------------------------------

loc_63AC5925:				; CODE XREF: sub_63AC5507+3E5j
		mov	eax, [ebp+NumberOfBytesRead]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckGotU ; "%s (%s=0x%x): check: got %u	bytes\n"
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[esp+58h+hEvent], eax
		call	sub_63AC521B
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_63AC597C
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[esp+58h+hEvent], eax
		call	sub_63AC524B
		jmp	short loc_63AC59F2
; ---------------------------------------------------------------------------

loc_63AC597C:				; CODE XREF: sub_63AC5507+463j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+38h]
		mov	eax, [ebp+NumberOfBytesRead]
		add	eax, edx
		mov	edx, eax
		and	edx, 0FFFh
		mov	eax, [ebp+var_10]
		mov	[eax+38h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+28h]
		mov	[esp+58h+hEvent], eax ;	hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4
		test	eax, eax
		jnz	short loc_63AC59DF
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckSete ; "%s (%s=0x%x): check: SetEvent failed: e"...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE

loc_63AC59DF:				; CODE XREF: sub_63AC5507+4A3j
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[esp+58h+hEvent], eax
		call	sub_63AC524B
		jmp	loc_63AC5573
; ---------------------------------------------------------------------------

loc_63AC59F2:				; CODE XREF: sub_63AC5507+182j
					; sub_63AC5507+2BAj ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax+28h]
		mov	[esp+58h+hEvent], eax ;	hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4
		test	eax, eax
		jnz	short loc_63AC5A3C
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXCheckSete ; "%s (%s=0x%x): check: SetEvent failed: e"...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE

loc_63AC5A3C:				; CODE XREF: sub_63AC5507+500j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+30h]
		mov	[esp+58h+hEvent], eax ;	hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4
		mov	eax, [ebp+var_20]
		mov	[esp+58h+lpOverlapped],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+flags], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+len], eax ; char
		mov	[esp+58h+dwMilliseconds], offset aSS0xXLeave ; "%s (%s=0x%x): leave\n"
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, 0
		mov	ebx, [ebp+var_4]
		leave
		retn	4
sub_63AC5507	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC5A83	proc near		; CODE XREF: sub_63AC6074+D8p

lpEventAttributes= dword ptr -58h
bManualReset	= dword	ptr -54h
bInitialState	= dword	ptr -50h
lpName		= dword	ptr -4Ch
dwCreationFlags	= dword	ptr -48h
lpThreadId	= dword	ptr -44h
ThreadId	= dword	ptr -2Ch
EventAttributes	= _SECURITY_ATTRIBUTES ptr -28h
lpParameter	= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 2
		mov	dword ptr [ebp+var_10],	offset aPthCreate_read ; "pth:create_reader"
		mov	[ebp+var_14], offset aFd_0 ; "fd"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXEnter_0 ; "%s (%s=0x%x): enter\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		lea	eax, [ebp+EventAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+EventAttributes.nLength], 0Ch
		mov	[ebp+EventAttributes.bInheritHandle], 0
		mov	[esp+58h+bManualReset],	103Ch ;	size_t
		mov	[esp+58h+lpEventAttributes], 1 ; size_t
		call	sub_63AC14ED
		mov	[ebp+lpParameter], eax
		cmp	[ebp+lpParameter], 0
		jnz	loc_63AC5BAB
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_63AC5B5D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXLeaveRe_0 ; "%s (%s=0x%x):	leave: result=%i\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, ds:_errno
		call	eax ; _errno
		jmp	short loc_63AC5BA1
; ---------------------------------------------------------------------------

loc_63AC5B5D:				; CODE XREF: sub_63AC5A83+9Aj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	strerror
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXErrorS_0 ;	"%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, ds:_errno
		call	eax ; _errno

loc_63AC5BA1:				; CODE XREF: sub_63AC5A83+D8j
		mov	eax, 0
		jmp	locret_63AC5EEF
; ---------------------------------------------------------------------------

loc_63AC5BAB:				; CODE XREF: sub_63AC5A83+89j
		mov	eax, [ebp+lpParameter]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+lpParameter]
		mov	dword ptr [eax+8], 1
		mov	[esp+58h+lpName], 0 ; lpName
		mov	[esp+58h+bInitialState], 0 ; bInitialState
		mov	[esp+58h+bManualReset],	1 ; bManualReset
		lea	eax, [ebp+EventAttributes]
		mov	[esp+58h+lpEventAttributes], eax ; lpEventAttributes
		mov	eax, ds:CreateEventA
		call	eax ; CreateEventA
		sub	esp, 10h
		mov	edx, [ebp+lpParameter]
		mov	[edx+28h], eax
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_63AC5C23
		mov	[esp+58h+lpName], 0 ; lpName
		mov	[esp+58h+bInitialState], 1 ; bInitialState
		mov	[esp+58h+bManualReset],	0 ; bManualReset
		lea	eax, [ebp+EventAttributes]
		mov	[esp+58h+lpEventAttributes], eax ; lpEventAttributes
		mov	eax, ds:CreateEventA
		call	eax ; CreateEventA
		sub	esp, 10h
		mov	edx, [ebp+lpParameter]
		mov	[edx+2Ch], eax

loc_63AC5C23:				; CODE XREF: sub_63AC5A83+170j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_63AC5C5B
		mov	[esp+58h+lpName], 0 ; lpName
		mov	[esp+58h+bInitialState], 0 ; bInitialState
		mov	[esp+58h+bManualReset],	1 ; bManualReset
		lea	eax, [ebp+EventAttributes]
		mov	[esp+58h+lpEventAttributes], eax ; lpEventAttributes
		mov	eax, ds:CreateEventA
		call	eax ; CreateEventA
		sub	esp, 10h
		mov	edx, [ebp+lpParameter]
		mov	[edx+30h], eax

loc_63AC5C5B:				; CODE XREF: sub_63AC5A83+1A8j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_63AC5C7D
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_63AC5C7D
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+30h]
		test	eax, eax
		jnz	loc_63AC5D54

loc_63AC5C7D:				; CODE XREF: sub_63AC5A83+1E0j
					; sub_63AC5A83+1EAj
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXCheckCrea ; "%s (%s=0x%x):	check: CreateEvent failed"...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_63AC5CCD
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC5CCD:				; CODE XREF: sub_63AC5A83+235j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_63AC5CEA
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+2Ch]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC5CEA:				; CODE XREF: sub_63AC5A83+252j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+30h]
		test	eax, eax
		jz	short loc_63AC5D07
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+30h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC5D07:				; CODE XREF: sub_63AC5A83+26Fj
		mov	eax, [ebp+lpParameter]
		mov	[esp+58h+lpEventAttributes], eax ; void	*
		call	sub_63AC150D
		mov	[esp+58h+lpEventAttributes], 5 ; int
		call	strerror
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXErrorS_0 ;	"%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	locret_63AC5EEF
; ---------------------------------------------------------------------------

loc_63AC5D54:				; CODE XREF: sub_63AC5A83+1F4j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		call	sub_63AC53FB
		mov	edx, [ebp+lpParameter]
		mov	[edx+28h], eax
		mov	eax, [ebp+lpParameter]
		mov	dword ptr [eax+0Ch], offset aCtxMutex ;	"ctx->mutex"
		mov	eax, [ebp+lpParameter]
		mov	dword ptr [eax+10h], 0
		lea	eax, [ebp+ThreadId]
		mov	[esp+58h+lpThreadId], eax ; lpThreadId
		mov	[esp+58h+dwCreationFlags], 0 ; dwCreationFlags
		mov	eax, [ebp+lpParameter]
		mov	[esp+58h+lpName], eax ;	lpParameter
		mov	[esp+58h+bInitialState], offset	sub_63AC5507 ; lpStartAddress
		mov	[esp+58h+bManualReset],	0 ; dwStackSize
		lea	eax, [ebp+EventAttributes]
		mov	[esp+58h+lpEventAttributes], eax ; lpThreadAttributes
		mov	eax, ds:CreateThread
		call	eax ; CreateThread
		sub	esp, 18h
		mov	edx, [ebp+lpParameter]
		mov	[edx+4], eax
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_63AC5EA8
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXCheckCr_0 ; "%s (%s=0x%x):	check: CreateThread faile"...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+lpParameter]
		add	eax, 0Ch
		mov	[esp+58h+lpEventAttributes], eax
		call	sub_63AC527B
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_63AC5E24
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC5E24:				; CODE XREF: sub_63AC5A83+38Cj
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_63AC5E41
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+2Ch]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC5E41:				; CODE XREF: sub_63AC5A83+3A9j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+30h]
		test	eax, eax
		jz	short loc_63AC5E5E
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+30h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC5E5E:				; CODE XREF: sub_63AC5A83+3C6j
		mov	eax, [ebp+lpParameter]
		mov	[esp+58h+lpEventAttributes], eax ; void	*
		call	sub_63AC150D
		mov	[esp+58h+lpEventAttributes], 5 ; int
		call	strerror
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXErrorS_0 ;	"%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	short locret_63AC5EEF
; ---------------------------------------------------------------------------

loc_63AC5EA8:				; CODE XREF: sub_63AC5A83+33Dj
		call	sub_63AC53F1
		mov	edx, [ebp+lpParameter]
		mov	edx, [edx+4]
		mov	[esp+58h+bManualReset],	eax ; nPriority
		mov	[esp+58h+lpEventAttributes], edx ; hThread
		mov	eax, ds:SetThreadPriority
		call	eax ; SetThreadPriority
		sub	esp, 8
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXLeave ; "%s (%s=0x%x): leave\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+lpParameter]

locret_63AC5EEF:			; CODE XREF: sub_63AC5A83+123j
					; sub_63AC5A83+2CCj ...
		leave
		retn
sub_63AC5A83	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC5EF1(void	*)
sub_63AC5EF1	proc near		; CODE XREF: sub_63AC61AC+65p

hEvent		= dword	ptr -28h
dwMilliseconds	= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[esp+28h+hEvent], eax
		call	sub_63AC521B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_63AC5F31
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[esp+28h+hEvent], eax
		call	sub_63AC524B
		jmp	locret_63AC6072
; ---------------------------------------------------------------------------

loc_63AC5F31:				; CODE XREF: sub_63AC5EF1+2Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_63AC5F58
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	[esp+28h+hEvent], eax ;	hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4

loc_63AC5F58:				; CODE XREF: sub_63AC5EF1+52j
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[esp+28h+hEvent], eax
		call	sub_63AC524B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_14], edx
		mov	[esp+28h+var_18], eax
		mov	[esp+28h+var_1C], offset aCtxFile_hd ; "ctx->file_hd"
		mov	dword ptr [esp+28h+var_20], offset aPthDestroy_rea ; "pth:destroy_reader"
		mov	[esp+28h+dwMilliseconds], offset aSS0xXCallWaiti ; "%s (%s=0x%x): call:	waiting	for termina"...
		mov	[esp+28h+hEvent], 2 ; int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	[esp+28h+dwMilliseconds], 0FFFFFFFFh ; dwMilliseconds
		mov	[esp+28h+hEvent], eax ;	hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_14], edx
		mov	[esp+28h+var_18], eax
		mov	[esp+28h+var_1C], offset aCtxFile_hd ; "ctx->file_hd"
		mov	dword ptr [esp+28h+var_20], offset aPthDestroy_rea ; "pth:destroy_reader"
		mov	[esp+28h+dwMilliseconds], offset aSS0xXCallThrea ; "%s (%s=0x%x): call:	thread %p has termi"...
		mov	[esp+28h+hEvent], 2 ; int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		test	eax, eax
		jz	short loc_63AC600C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	[esp+28h+hEvent], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC600C:				; CODE XREF: sub_63AC5EF1+106j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_63AC6029
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+28h+hEvent], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC6029:				; CODE XREF: sub_63AC5EF1+123j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_63AC6046
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	[esp+28h+hEvent], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC6046:				; CODE XREF: sub_63AC5EF1+140j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+hEvent], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[esp+28h+hEvent], eax
		call	sub_63AC527B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hEvent], eax ;	void *
		call	sub_63AC150D

locret_63AC6072:			; CODE XREF: sub_63AC5EF1+3Bj
		leave
		retn
sub_63AC5EF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC6074	proc near		; CODE XREF: sub_63AC6267+65p
					; pth_pipe+25Fp ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[esp+28h+var_28], offset off_63ACA01C
		call	sub_63AC521B
		mov	[ebp+var_10], 0
		jmp	short loc_63AC60E1
; ---------------------------------------------------------------------------

loc_63AC6096:				; CODE XREF: sub_63AC6074+75j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_63AC60DD
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_63AC60DD
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax

loc_63AC60DD:				; CODE XREF: sub_63AC6074+37j
					; sub_63AC6074+50j
		add	[ebp+var_10], 1

loc_63AC60E1:				; CODE XREF: sub_63AC6074+20j
		mov	eax, dword_63ACA018
		cmp	[ebp+var_10], eax
		jl	short loc_63AC6096
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC60F7
		cmp	[ebp+arg_4], 0
		jnz	short loc_63AC610B

loc_63AC60F7:				; CODE XREF: sub_63AC6074+7Bj
		mov	[esp+28h+var_28], offset off_63ACA01C
		call	sub_63AC524B
		mov	eax, [ebp+var_C]
		jmp	locret_63AC61AA
; ---------------------------------------------------------------------------

loc_63AC610B:				; CODE XREF: sub_63AC6074+81j
		mov	[ebp+var_10], 0
		jmp	short loc_63AC612F
; ---------------------------------------------------------------------------

loc_63AC6114:				; CODE XREF: sub_63AC6074+C3j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_63AC613B
		add	[ebp+var_10], 1

loc_63AC612F:				; CODE XREF: sub_63AC6074+9Ej
		mov	eax, dword_63ACA018
		cmp	[ebp+var_10], eax
		jl	short loc_63AC6114
		jmp	short loc_63AC613C
; ---------------------------------------------------------------------------

loc_63AC613B:				; CODE XREF: sub_63AC6074+B5j
		nop

loc_63AC613C:				; CODE XREF: sub_63AC6074+C5j
		mov	eax, dword_63ACA018
		cmp	[ebp+var_10], eax
		jz	short loc_63AC619B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_63AC5A83
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, dword_63ACD040[eax]
		mov	eax, [ebp+arg_0]
		mov	[edx+4], eax
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, dword_63ACD040[eax]
		mov	eax, [ebp+var_C]
		mov	[edx+8], eax
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	dword ptr [eax], 1

loc_63AC619B:				; CODE XREF: sub_63AC6074+D0j
		mov	[esp+28h+var_28], offset off_63ACA01C
		call	sub_63AC524B
		mov	eax, [ebp+var_C]

locret_63AC61AA:			; CODE XREF: sub_63AC6074+92j
		leave
		retn
sub_63AC6074	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC61AC	proc near		; CODE XREF: pth_close+A8p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], offset off_63ACA01C
		call	sub_63AC521B
		mov	[ebp+var_C], 0
		jmp	loc_63AC624B
; ---------------------------------------------------------------------------

loc_63AC61CA:				; CODE XREF: sub_63AC61AC+A7j
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_63AC6247
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_63AC6247
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_63AC5EF1
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	dword ptr [eax+8], 0
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD040
		mov	dword ptr [eax], 0
		jmp	short loc_63AC6259
; ---------------------------------------------------------------------------

loc_63AC6247:				; CODE XREF: sub_63AC61AC+33j
					; sub_63AC61AC+4Cj
		add	[ebp+var_C], 1

loc_63AC624B:				; CODE XREF: sub_63AC61AC+19j
		mov	eax, dword_63ACA018
		cmp	[ebp+var_C], eax
		jl	loc_63AC61CA

loc_63AC6259:				; CODE XREF: sub_63AC61AC+99j
		mov	[esp+28h+var_28], offset off_63ACA01C
		call	sub_63AC524B
		leave
		retn
sub_63AC61AC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC6267(int,	void *Dst, int)
sub_63AC6267	proc near		; CODE XREF: sub_63AC20AF+AAp

hHandle		= dword	ptr -48h
dwMilliseconds	= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Dst		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_10], 2
		mov	dword ptr [ebp+var_14],	offset a_pth_io_read ; "_pth_io_read"
		mov	[ebp+var_18], offset aFd_0 ; "fd"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+Dst]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXEnterBuff ; "%s (%s=0x%x): enter: buffer=%p, count=%"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	[esp+48h+dwMilliseconds], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+hHandle], eax
		call	sub_63AC6074
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_63AC632D
		mov	[esp+48h+hHandle], 9
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hHandle], eax ; int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC67D4
; ---------------------------------------------------------------------------

loc_63AC632D:				; CODE XREF: sub_63AC6267+71j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_63AC6371
		mov	[esp+48h+var_34], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXLeaveRe_0 ; "%s (%s=0x%x): leave: result=%i\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	locret_63AC67D4
; ---------------------------------------------------------------------------

loc_63AC6371:				; CODE XREF: sub_63AC6267+CEj
		mov	eax, [ebp+var_20]
		add	eax, 0Ch
		mov	[esp+48h+hHandle], eax
		call	sub_63AC521B
		mov	eax, [ebp+var_20]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+38h]
		cmp	edx, eax
		jnz	loc_63AC643C
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	loc_63AC643C
		mov	eax, [ebp+var_20]
		add	eax, 0Ch
		mov	[esp+48h+hHandle], eax
		call	sub_63AC524B
		mov	eax, [ebp+var_20]
		mov	eax, [eax+4]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckWa_0 ; "%s (%s=0x%x): check: waiting for data f"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_20]
		mov	eax, [eax+28h]
		mov	[esp+48h+dwMilliseconds], 0FFFFFFFFh ; dwMilliseconds
		mov	[esp+48h+hHandle], eax ; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	eax, [ebp+var_20]
		mov	eax, [eax+4]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckData ; "%s (%s=0x%x): check: data from thread %"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_20]
		add	eax, 0Ch
		mov	[esp+48h+hHandle], eax
		call	sub_63AC521B

loc_63AC643C:				; CODE XREF: sub_63AC6267+126j
					; sub_63AC6267+134j
		mov	eax, [ebp+var_20]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+38h]
		cmp	edx, eax
		jz	short loc_63AC645A
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_63AC6547

loc_63AC645A:				; CODE XREF: sub_63AC6267+1E3j
		mov	eax, [ebp+var_20]
		add	eax, 0Ch
		mov	[esp+48h+hHandle], eax
		call	sub_63AC524B
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+1Ch], 1
		mov	eax, [ebp+var_20]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_63AC64B6
		mov	[esp+48h+var_34], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXLeaveRe_0 ; "%s (%s=0x%x): leave: result=%i\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	locret_63AC67D4
; ---------------------------------------------------------------------------

loc_63AC64B6:				; CODE XREF: sub_63AC6267+213j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_63AC64F2
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckEofB ; "%s (%s=0x%x): check: EOF but ctx->eof f"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	locret_63AC67D4
; ---------------------------------------------------------------------------

loc_63AC64F2:				; CODE XREF: sub_63AC6267+257j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+24h]
		mov	[esp+48h+hHandle], eax
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hHandle], eax ; int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC67D4
; ---------------------------------------------------------------------------

loc_63AC6547:				; CODE XREF: sub_63AC6267+1EDj
		mov	eax, [ebp+var_20]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+38h]
		cmp	edx, eax
		jnb	short loc_63AC656B
		mov	eax, [ebp+var_20]
		mov	edx, [eax+38h]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+34h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_63AC657C
; ---------------------------------------------------------------------------

loc_63AC656B:				; CODE XREF: sub_63AC6267+2EEj
		mov	eax, [ebp+var_20]
		mov	eax, [eax+34h]
		mov	edx, 1000h
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

loc_63AC657C:				; CODE XREF: sub_63AC6267+302j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_63AC658D
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax

loc_63AC658D:				; CODE XREF: sub_63AC6267+31Ej
		mov	ecx, [ebp+var_C]
		mov	eax, [ebp+var_20]
		add	eax, 3Ch
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+34h]
		add	edx, eax
		mov	eax, [ebp+Dst]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+dwMilliseconds], edx ;	Src
		mov	[esp+48h+hHandle], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_20]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_C]
		add	eax, edx
		mov	edx, eax
		and	edx, 0FFFh
		mov	eax, [ebp+var_20]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_20]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+38h]
		cmp	edx, eax
		jnz	loc_63AC669D
		mov	eax, [ebp+var_20]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	loc_63AC669D
		mov	eax, [ebp+var_20]
		mov	eax, [eax+28h]
		mov	[esp+48h+hHandle], eax ; hEvent
		mov	eax, ds:ResetEvent
		call	eax ; ResetEvent
		sub	esp, 4
		test	eax, eax
		jnz	loc_63AC669D
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckRese ; "%s (%s=0x%x): check: ResetEvent failed:"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_20]
		add	eax, 0Ch
		mov	[esp+48h+hHandle], eax
		call	sub_63AC524B
		mov	[esp+48h+hHandle], 5
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hHandle], eax ; int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC67D4
; ---------------------------------------------------------------------------

loc_63AC669D:				; CODE XREF: sub_63AC6267+373j
					; sub_63AC6267+381j ...
		mov	eax, [ebp+var_20]
		mov	eax, [eax+2Ch]
		mov	[esp+48h+hHandle], eax ; hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4
		test	eax, eax
		jnz	loc_63AC674C
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckSete ; "%s (%s=0x%x): check: SetEvent failed: e"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_20]
		add	eax, 0Ch
		mov	[esp+48h+hHandle], eax
		call	sub_63AC524B
		mov	[esp+48h+hHandle], 5
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hHandle], eax ; int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC67D4
; ---------------------------------------------------------------------------

loc_63AC674C:				; CODE XREF: sub_63AC6267+44Bj
		mov	eax, [ebp+var_20]
		add	eax, 0Ch
		mov	[esp+48h+hHandle], eax
		call	sub_63AC524B
		cmp	[ebp+var_C], 0
		js	short loc_63AC6794
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXLeaveRe_0 ; "%s (%s=0x%x): leave: result=%i\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_C]
		jmp	short locret_63AC67D4
; ---------------------------------------------------------------------------

loc_63AC6794:				; CODE XREF: sub_63AC6267+4F7j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hHandle], eax ; int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hHandle], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+var_C]

locret_63AC67D4:			; CODE XREF: sub_63AC6267+C1j
					; sub_63AC6267+105j ...
		leave
		retn
sub_63AC6267	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; DWORD	__stdcall sub_63AC67D6(LPVOID lpThreadParameter)
sub_63AC67D6	proc near		; DATA XREF: sub_63AC6C1D+30Fo

hEvent		= dword	ptr -48h
dwMilliseconds	= dword	ptr -44h
len		= dword	ptr -40h
flags		= dword	ptr -3Ch
lpOverlapped	= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
NumberOfBytesWritten= dword ptr	-28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
lpThreadParameter= dword ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+lpThreadParameter]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 2
		mov	dword ptr [ebp+var_14],	offset aPthWriter ; "pth:writer"
		mov	[ebp+var_18], offset aCtxFile_hd ; "ctx->file_hd"
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXEnterThre ; "%s (%s=0x%x): enter: thread=%p\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+48h+hEvent], eax ;	hNamedPipe
		call	sub_63AC54AE
		mov	[ebp+var_20], eax

loc_63AC6842:				; CODE XREF: sub_63AC67D6+3B1j
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC521B
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_63AC686D
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		jmp	loc_63AC6B8C
; ---------------------------------------------------------------------------

loc_63AC686D:				; CODE XREF: sub_63AC67D6+82j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	loc_63AC6996
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	[esp+48h+hEvent], eax ;	hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4
		test	eax, eax
		jnz	short loc_63AC68C5
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckSete ; "%s (%s=0x%x): check: SetEvent failed: e"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE

loc_63AC68C5:				; CODE XREF: sub_63AC67D6+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+20h]
		mov	[esp+48h+hEvent], eax ;	hEvent
		mov	eax, ds:ResetEvent
		call	eax ; ResetEvent
		sub	esp, 4
		test	eax, eax
		jnz	short loc_63AC690F
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckRese ; "%s (%s=0x%x): check: ResetEvent failed:"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE

loc_63AC690F:				; CODE XREF: sub_63AC67D6+104j
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckIdle ; "%s (%s=0x%x): check: idle\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_C]
		mov	eax, [eax+20h]
		mov	[esp+48h+dwMilliseconds], 0FFFFFFFFh ; dwMilliseconds
		mov	[esp+48h+hEvent], eax ;	hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckGotD ; "%s (%s=0x%x): check: got data to send\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC521B

loc_63AC6996:				; CODE XREF: sub_63AC67D6+9Fj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_63AC69B3
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		jmp	loc_63AC6B8C
; ---------------------------------------------------------------------------

loc_63AC69B3:				; CODE XREF: sub_63AC67D6+1C8j
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		mov	eax, [ebp+var_C]
		mov	edx, [eax+2Ch]
		cmp	[ebp+var_20], 0
		jz	short loc_63AC69D4
		mov	eax, offset aSending ; "sending"
		jmp	short loc_63AC69D9
; ---------------------------------------------------------------------------

loc_63AC69D4:				; CODE XREF: sub_63AC67D6+1F5j
		mov	eax, offset aWriting ; "writing"

loc_63AC69D9:				; CODE XREF: sub_63AC67D6+1FCj
		mov	[esp+48h+var_30], edx
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckSDBy ; "%s (%s=0x%x): check: %s %d bytes\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		cmp	[ebp+var_20], 0
		jz	loc_63AC6AA5
		mov	eax, [ebp+var_C]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		lea	ecx, [eax+30h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	[esp+48h+dwMilliseconds], ecx ;	buf
		mov	[esp+48h+hEvent], eax ;	s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jns	short loc_63AC6A9A
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	edx, [ebp+var_C]
		mov	[edx+1Ch], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+18h], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax+1Ch]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckSe_1 ; "%s (%s=0x%x): check: send error: ec=%d\"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		jmp	loc_63AC6B8C
; ---------------------------------------------------------------------------

loc_63AC6A9A:				; CODE XREF: sub_63AC67D6+274j
		mov	eax, [ebp+var_24]
		mov	[ebp+NumberOfBytesWritten], eax
		jmp	loc_63AC6B2B
; ---------------------------------------------------------------------------

loc_63AC6AA5:				; CODE XREF: sub_63AC67D6+237j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+var_C]
		lea	ebx, [eax+30h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+48h+lpOverlapped],	0 ; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesWritten]
		mov	[esp+48h+flags], ecx ; lpNumberOfBytesWritten
		mov	[esp+48h+len], edx ; nNumberOfBytesToWrite
		mov	[esp+48h+dwMilliseconds], ebx ;	lpBuffer
		mov	[esp+48h+hEvent], eax ;	hFile
		mov	eax, ds:WriteFile
		call	eax ; WriteFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_63AC6B2B
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+18h], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax+1Ch]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckWr_1 ; "%s (%s=0x%x): check: write error: ec=%d"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		jmp	short loc_63AC6B8C
; ---------------------------------------------------------------------------

loc_63AC6B2B:				; CODE XREF: sub_63AC67D6+2CAj
					; sub_63AC67D6+306j
		mov	eax, [ebp+NumberOfBytesWritten]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckWrot ; "%s (%s=0x%x): check: wrote %d bytes\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC521B
		mov	eax, [ebp+var_C]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+NumberOfBytesWritten]
		sub	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+2Ch], edx
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		jmp	loc_63AC6842
; ---------------------------------------------------------------------------

loc_63AC6B8C:				; CODE XREF: sub_63AC67D6+92j
					; sub_63AC67D6+1D8j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	[esp+48h+hEvent], eax ;	hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4
		test	eax, eax
		jnz	short loc_63AC6BD6
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckSete ; "%s (%s=0x%x): check: SetEvent failed: e"...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE

loc_63AC6BD6:				; CODE XREF: sub_63AC67D6+3CBj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+28h]
		mov	[esp+48h+hEvent], eax ;	hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+lpOverlapped],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+flags], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+48h+len], eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXLeave ; "%s (%s=0x%x): leave\n"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, 0
		mov	ebx, [ebp+var_4]
		leave
		retn	4
sub_63AC67D6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC6C1D	proc near		; CODE XREF: sub_63AC720E+D8p

lpEventAttributes= dword ptr -58h
bManualReset	= dword	ptr -54h
bInitialState	= dword	ptr -50h
lpName		= dword	ptr -4Ch
dwCreationFlags	= dword	ptr -48h
lpThreadId	= dword	ptr -44h
ThreadId	= dword	ptr -2Ch
EventAttributes	= _SECURITY_ATTRIBUTES ptr -28h
lpParameter	= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 2
		mov	dword ptr [ebp+var_10],	offset aPthCreate_writ ; "pth:create_writer"
		mov	[ebp+var_14], offset aFd_0 ; "fd"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXEnter_0 ; "%s (%s=0x%x): enter\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		lea	eax, [ebp+EventAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+EventAttributes.nLength], 0Ch
		mov	[ebp+EventAttributes.bInheritHandle], 0
		mov	[esp+58h+bManualReset],	1030h ;	size_t
		mov	[esp+58h+lpEventAttributes], 1 ; size_t
		call	sub_63AC14ED
		mov	[ebp+lpParameter], eax
		cmp	[ebp+lpParameter], 0
		jnz	loc_63AC6D45
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_63AC6CF7
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXLeaveRe_0 ; "%s (%s=0x%x):	leave: result=%i\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, ds:_errno
		call	eax ; _errno
		jmp	short loc_63AC6D3B
; ---------------------------------------------------------------------------

loc_63AC6CF7:				; CODE XREF: sub_63AC6C1D+9Aj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	strerror
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXErrorS_0 ;	"%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, ds:_errno
		call	eax ; _errno

loc_63AC6D3B:				; CODE XREF: sub_63AC6C1D+D8j
		mov	eax, 0
		jmp	locret_63AC7089
; ---------------------------------------------------------------------------

loc_63AC6D45:				; CODE XREF: sub_63AC6C1D+89j
		mov	eax, [ebp+lpParameter]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+lpParameter]
		mov	dword ptr [eax+8], 1
		mov	[esp+58h+lpName], 0 ; lpName
		mov	[esp+58h+bInitialState], 0 ; bInitialState
		mov	[esp+58h+bManualReset],	1 ; bManualReset
		lea	eax, [ebp+EventAttributes]
		mov	[esp+58h+lpEventAttributes], eax ; lpEventAttributes
		mov	eax, ds:CreateEventA
		call	eax ; CreateEventA
		sub	esp, 10h
		mov	edx, [ebp+lpParameter]
		mov	[edx+20h], eax
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_63AC6DBD
		mov	[esp+58h+lpName], 0 ; lpName
		mov	[esp+58h+bInitialState], 1 ; bInitialState
		mov	[esp+58h+bManualReset],	1 ; bManualReset
		lea	eax, [ebp+EventAttributes]
		mov	[esp+58h+lpEventAttributes], eax ; lpEventAttributes
		mov	eax, ds:CreateEventA
		call	eax ; CreateEventA
		sub	esp, 10h
		mov	edx, [ebp+lpParameter]
		mov	[edx+24h], eax

loc_63AC6DBD:				; CODE XREF: sub_63AC6C1D+170j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_63AC6DF5
		mov	[esp+58h+lpName], 0 ; lpName
		mov	[esp+58h+bInitialState], 0 ; bInitialState
		mov	[esp+58h+bManualReset],	1 ; bManualReset
		lea	eax, [ebp+EventAttributes]
		mov	[esp+58h+lpEventAttributes], eax ; lpEventAttributes
		mov	eax, ds:CreateEventA
		call	eax ; CreateEventA
		sub	esp, 10h
		mov	edx, [ebp+lpParameter]
		mov	[edx+28h], eax

loc_63AC6DF5:				; CODE XREF: sub_63AC6C1D+1A8j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_63AC6E17
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_63AC6E17
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		test	eax, eax
		jnz	loc_63AC6EEE

loc_63AC6E17:				; CODE XREF: sub_63AC6C1D+1E0j
					; sub_63AC6C1D+1EAj
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXCheckCrea ; "%s (%s=0x%x):	check: CreateEvent failed"...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_63AC6E67
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+20h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC6E67:				; CODE XREF: sub_63AC6C1D+235j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_63AC6E84
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+24h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC6E84:				; CODE XREF: sub_63AC6C1D+252j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_63AC6EA1
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC6EA1:				; CODE XREF: sub_63AC6C1D+26Fj
		mov	eax, [ebp+lpParameter]
		mov	[esp+58h+lpEventAttributes], eax ; void	*
		call	sub_63AC150D
		mov	[esp+58h+lpEventAttributes], 5 ; int
		call	strerror
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXErrorS_0 ;	"%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	locret_63AC7089
; ---------------------------------------------------------------------------

loc_63AC6EEE:				; CODE XREF: sub_63AC6C1D+1F4j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+24h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		call	sub_63AC53FB
		mov	edx, [ebp+lpParameter]
		mov	[edx+24h], eax
		mov	eax, [ebp+lpParameter]
		mov	dword ptr [eax+0Ch], offset aCtxMutex ;	"ctx->mutex"
		mov	eax, [ebp+lpParameter]
		mov	dword ptr [eax+10h], 0
		lea	eax, [ebp+ThreadId]
		mov	[esp+58h+lpThreadId], eax ; lpThreadId
		mov	[esp+58h+dwCreationFlags], 0 ; dwCreationFlags
		mov	eax, [ebp+lpParameter]
		mov	[esp+58h+lpName], eax ;	lpParameter
		mov	[esp+58h+bInitialState], offset	sub_63AC67D6 ; lpStartAddress
		mov	[esp+58h+bManualReset],	0 ; dwStackSize
		lea	eax, [ebp+EventAttributes]
		mov	[esp+58h+lpEventAttributes], eax ; lpThreadAttributes
		mov	eax, ds:CreateThread
		call	eax ; CreateThread
		sub	esp, 18h
		mov	edx, [ebp+lpParameter]
		mov	[edx+4], eax
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_63AC7042
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXCheckCr_0 ; "%s (%s=0x%x):	check: CreateThread faile"...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+lpParameter]
		add	eax, 0Ch
		mov	[esp+58h+lpEventAttributes], eax
		call	sub_63AC527B
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_63AC6FBE
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+20h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC6FBE:				; CODE XREF: sub_63AC6C1D+38Cj
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_63AC6FDB
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+24h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC6FDB:				; CODE XREF: sub_63AC6C1D+3A9j
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_63AC6FF8
		mov	eax, [ebp+lpParameter]
		mov	eax, [eax+28h]
		mov	[esp+58h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC6FF8:				; CODE XREF: sub_63AC6C1D+3C6j
		mov	eax, [ebp+lpParameter]
		mov	[esp+58h+lpEventAttributes], eax ; void	*
		call	sub_63AC150D
		mov	[esp+58h+lpEventAttributes], 5 ; int
		call	strerror
		mov	[esp+58h+lpThreadId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXErrorS_0 ;	"%s (%s=0x%x): error: %s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	short locret_63AC7089
; ---------------------------------------------------------------------------

loc_63AC7042:				; CODE XREF: sub_63AC6C1D+33Dj
		call	sub_63AC53F1
		mov	edx, [ebp+lpParameter]
		mov	edx, [edx+4]
		mov	[esp+58h+bManualReset],	eax ; nPriority
		mov	[esp+58h+lpEventAttributes], edx ; hThread
		mov	eax, ds:SetThreadPriority
		call	eax ; SetThreadPriority
		sub	esp, 8
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwCreationFlags], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpName], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+bInitialState], eax ; char
		mov	[esp+58h+bManualReset],	offset aSS0xXLeave ; "%s (%s=0x%x): leave\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpEventAttributes], eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+lpParameter]

locret_63AC7089:			; CODE XREF: sub_63AC6C1D+123j
					; sub_63AC6C1D+2CCj ...
		leave
		retn
sub_63AC6C1D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC708B(void	*)
sub_63AC708B	proc near		; CODE XREF: sub_63AC7346+65p

hEvent		= dword	ptr -28h
dwMilliseconds	= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[esp+28h+hEvent], eax
		call	sub_63AC521B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_63AC70CB
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[esp+28h+hEvent], eax
		call	sub_63AC524B
		jmp	locret_63AC720C
; ---------------------------------------------------------------------------

loc_63AC70CB:				; CODE XREF: sub_63AC708B+2Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_63AC70F2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	[esp+28h+hEvent], eax ;	hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4

loc_63AC70F2:				; CODE XREF: sub_63AC708B+52j
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[esp+28h+hEvent], eax
		call	sub_63AC524B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_14], edx
		mov	[esp+28h+var_18], eax
		mov	[esp+28h+var_1C], offset aCtxFile_hd ; "ctx->file_hd"
		mov	dword ptr [esp+28h+var_20], offset aPthDestroy_wri ; "pth:destroy_writer"
		mov	[esp+28h+dwMilliseconds], offset aSS0xXCallWaiti ; "%s (%s=0x%x): call:	waiting	for termina"...
		mov	[esp+28h+hEvent], 2 ; int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+28h+dwMilliseconds], 0FFFFFFFFh ; dwMilliseconds
		mov	[esp+28h+hEvent], eax ;	hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_14], edx
		mov	[esp+28h+var_18], eax
		mov	[esp+28h+var_1C], offset aCtxFile_hd ; "ctx->file_hd"
		mov	dword ptr [esp+28h+var_20], offset aPthDestroy_wri ; "pth:destroy_writer"
		mov	[esp+28h+dwMilliseconds], offset aSS0xXCallThrea ; "%s (%s=0x%x): call:	thread %p has termi"...
		mov	[esp+28h+hEvent], 2 ; int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_63AC71A6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+28h+hEvent], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC71A6:				; CODE XREF: sub_63AC708B+106j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_63AC71C3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	[esp+28h+hEvent], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC71C3:				; CODE XREF: sub_63AC708B+123j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_63AC71E0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+hEvent], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_63AC71E0:				; CODE XREF: sub_63AC708B+140j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+hEvent], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[esp+28h+hEvent], eax
		call	sub_63AC527B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hEvent], eax ;	void *
		call	sub_63AC150D

locret_63AC720C:			; CODE XREF: sub_63AC708B+3Bj
		leave
		retn
sub_63AC708B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC720E	proc near		; CODE XREF: sub_63AC7401+A5p
					; sub_63AC7F06+14p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[esp+28h+var_28], offset off_63ACA028
		call	sub_63AC521B
		mov	[ebp+var_10], 0
		jmp	short loc_63AC727B
; ---------------------------------------------------------------------------

loc_63AC7230:				; CODE XREF: sub_63AC720E+75j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_63AC7277
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_63AC7277
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax

loc_63AC7277:				; CODE XREF: sub_63AC720E+37j
					; sub_63AC720E+50j
		add	[ebp+var_10], 1

loc_63AC727B:				; CODE XREF: sub_63AC720E+20j
		mov	eax, dword_63ACA024
		cmp	[ebp+var_10], eax
		jl	short loc_63AC7230
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC7291
		cmp	[ebp+arg_4], 0
		jnz	short loc_63AC72A5

loc_63AC7291:				; CODE XREF: sub_63AC720E+7Bj
		mov	[esp+28h+var_28], offset off_63ACA028
		call	sub_63AC524B
		mov	eax, [ebp+var_C]
		jmp	locret_63AC7344
; ---------------------------------------------------------------------------

loc_63AC72A5:				; CODE XREF: sub_63AC720E+81j
		mov	[ebp+var_10], 0
		jmp	short loc_63AC72C9
; ---------------------------------------------------------------------------

loc_63AC72AE:				; CODE XREF: sub_63AC720E+C3j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_63AC72D5
		add	[ebp+var_10], 1

loc_63AC72C9:				; CODE XREF: sub_63AC720E+9Ej
		mov	eax, dword_63ACA024
		cmp	[ebp+var_10], eax
		jl	short loc_63AC72AE
		jmp	short loc_63AC72D6
; ---------------------------------------------------------------------------

loc_63AC72D5:				; CODE XREF: sub_63AC720E+B5j
		nop

loc_63AC72D6:				; CODE XREF: sub_63AC720E+C5j
		mov	eax, dword_63ACA024
		cmp	[ebp+var_10], eax
		jz	short loc_63AC7335
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_63AC6C1D
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, dword_63ACD220[eax]
		mov	eax, [ebp+arg_0]
		mov	[edx+4], eax
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, dword_63ACD220[eax]
		mov	eax, [ebp+var_C]
		mov	[edx+8], eax
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	dword ptr [eax], 1

loc_63AC7335:				; CODE XREF: sub_63AC720E+D0j
		mov	[esp+28h+var_28], offset off_63ACA028
		call	sub_63AC524B
		mov	eax, [ebp+var_C]

locret_63AC7344:			; CODE XREF: sub_63AC720E+92j
		leave
		retn
sub_63AC720E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC7346	proc near		; CODE XREF: pth_close+B3p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], offset off_63ACA028
		call	sub_63AC521B
		mov	[ebp+var_C], 0
		jmp	loc_63AC73E5
; ---------------------------------------------------------------------------

loc_63AC7364:				; CODE XREF: sub_63AC7346+A7j
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_63AC73E1
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_63AC73E1
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_63AC708B
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	dword ptr [eax+8], 0
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_63ACD220
		mov	dword ptr [eax], 0
		jmp	short loc_63AC73F3
; ---------------------------------------------------------------------------

loc_63AC73E1:				; CODE XREF: sub_63AC7346+33j
					; sub_63AC7346+4Cj
		add	[ebp+var_C], 1

loc_63AC73E5:				; CODE XREF: sub_63AC7346+19j
		mov	eax, dword_63ACA024
		cmp	[ebp+var_C], eax
		jl	loc_63AC7364

loc_63AC73F3:				; CODE XREF: sub_63AC7346+99j
		mov	[esp+28h+var_28], offset off_63ACA028
		call	sub_63AC524B
		leave
		retn
sub_63AC7346	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC7401(int,	void *Src, size_t)
sub_63AC7401	proc near		; CODE XREF: sub_63AC25A1+AAp

hEvent		= dword	ptr -48h
dwMilliseconds	= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_C], 2
		mov	dword ptr [ebp+var_10],	offset a_pth_io_write ;	"_pth_io_write"
		mov	[ebp+var_14], offset aFd_0 ; "fd"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+Src]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXEnterBuff ; "%s (%s=0x%x): enter: buffer=%p, count=%"...
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		cmp	[ebp+arg_8], 0
		jnz	short loc_63AC7498
		mov	[esp+48h+var_34], 0
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXLeaveRe_0 ; "%s (%s=0x%x): leave: result=%i\n"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, 0
		jmp	locret_63AC7937
; ---------------------------------------------------------------------------

loc_63AC7498:				; CODE XREF: sub_63AC7401+5Bj
		mov	[esp+48h+dwMilliseconds], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+hEvent], eax
		call	sub_63AC720E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_63AC74FB
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hEvent], eax ;	int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC7937
; ---------------------------------------------------------------------------

loc_63AC74FB:				; CODE XREF: sub_63AC7401+B1j
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC521B
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	loc_63AC766F
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	loc_63AC766F
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+24h]
		mov	[esp+48h+hEvent], eax ;	hEvent
		mov	eax, ds:ResetEvent
		call	eax ; ResetEvent
		sub	esp, 4
		test	eax, eax
		jnz	loc_63AC75D4
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckRese ; "%s (%s=0x%x): check: ResetEvent failed:"...
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		mov	[esp+48h+hEvent], 5
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hEvent], eax ;	int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC7937
; ---------------------------------------------------------------------------

loc_63AC75D4:				; CODE XREF: sub_63AC7401+139j
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckWa_1 ; "%s (%s=0x%x): check: waiting for empty "...
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+24h]
		mov	[esp+48h+dwMilliseconds], 0FFFFFFFFh ; dwMilliseconds
		mov	[esp+48h+hEvent], eax ;	hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckThre ; "%s (%s=0x%x): check: thread	%p buffer i"...
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC521B

loc_63AC766F:				; CODE XREF: sub_63AC7401+110j
					; sub_63AC7401+11Ej
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_63AC76F5
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+1Ch]
		cmp	eax, 0E8h
		jnz	short loc_63AC76A2
		mov	[esp+48h+hEvent], 20h
		call	sub_63AC5104
		jmp	short loc_63AC76AE
; ---------------------------------------------------------------------------

loc_63AC76A2:				; CODE XREF: sub_63AC7401+291j
		mov	[esp+48h+hEvent], 5
		call	sub_63AC5104

loc_63AC76AE:				; CODE XREF: sub_63AC7401+29Fj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hEvent], eax ;	int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC7937
; ---------------------------------------------------------------------------

loc_63AC76F5:				; CODE XREF: sub_63AC7401+276j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_63AC771B
		mov	[esp+48h+Size],	412h ; int
		mov	[esp+48h+dwMilliseconds], offset a__W32pth2_0_5W ; "../w32pth-2.0.5/w32-io.c"
		mov	[esp+48h+hEvent], offset aCtxNbytes ; "!ctx->nbytes"
		call	sub_63AC91F0

loc_63AC771B:				; CODE XREF: sub_63AC7401+2FCj
		cmp	[ebp+arg_8], 1000h
		jbe	short loc_63AC772B
		mov	[ebp+arg_8], 1000h

loc_63AC772B:				; CODE XREF: sub_63AC7401+321j
		mov	eax, [ebp+var_1C]
		add	eax, 30h
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+dwMilliseconds], edx ;	Src
		mov	[esp+48h+hEvent], eax ;	Dst
		call	memcpy
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_8]
		mov	[eax+2Ch], edx
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+24h]
		mov	[esp+48h+hEvent], eax ;	hEvent
		mov	eax, ds:ResetEvent
		call	eax ; ResetEvent
		sub	esp, 4
		test	eax, eax
		jnz	loc_63AC77FF
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckRese ; "%s (%s=0x%x): check: ResetEvent failed:"...
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		mov	[esp+48h+hEvent], 5
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hEvent], eax ;	int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC7937
; ---------------------------------------------------------------------------

loc_63AC77FF:				; CODE XREF: sub_63AC7401+364j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+20h]
		mov	[esp+48h+hEvent], eax ;	hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4
		test	eax, eax
		jnz	loc_63AC78AE
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXCheckSete ; "%s (%s=0x%x): check: SetEvent failed: e"...
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		mov	[esp+48h+hEvent], 5
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hEvent], eax ;	int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC7937
; ---------------------------------------------------------------------------

loc_63AC78AE:				; CODE XREF: sub_63AC7401+413j
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		mov	[esp+48h+hEvent], eax
		call	sub_63AC524B
		mov	eax, [ebp+arg_8]
		test	eax, eax
		js	short loc_63AC78F7
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXLeaveRe_0 ; "%s (%s=0x%x): leave: result=%i\n"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_8]
		jmp	short locret_63AC7937
; ---------------------------------------------------------------------------

loc_63AC78F7:				; CODE XREF: sub_63AC7401+4C0j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+hEvent], eax ;	int
		call	strerror
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+dwMilliseconds], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+hEvent], eax ;	int
		call	sub_63AC52BE
		mov	eax, [ebp+arg_8]

locret_63AC7937:			; CODE XREF: sub_63AC7401+92j
					; sub_63AC7401+F5j ...
		leave
		retn
sub_63AC7401	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_63AC7939(PHANDLE, PHANDLE, LPSECURITY_ATTRIBUTES, DWORD)
sub_63AC7939	proc near		; CODE XREF: pth_pipe+A9p

hReadPipe	= dword	ptr -18h
hWritePipe	= dword	ptr -14h
lpPipeAttributes= dword	ptr -10h
nSize		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+nSize], eax ; nSize
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+lpPipeAttributes], eax	; lpPipeAttributes
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+hWritePipe], eax ; hWritePipe
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hReadPipe], eax ; hReadPipe
		mov	eax, ds:CreatePipe
		call	eax ; CreatePipe
		sub	esp, 10h
		leave
		retn
sub_63AC7939	endp

; Exported entry  39. pth_pipe

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public pth_pipe
pth_pipe	proc near

hSourceProcessHandle= dword ptr	-58h
hSourceHandle	= dword	ptr -54h
hTargetProcessHandle= dword ptr	-50h
lpTargetHandle	= dword	ptr -4Ch
dwDesiredAccess	= dword	ptr -48h
bInheritHandle	= dword	ptr -44h
dwOptions	= dword	ptr -40h
var_34		= dword	ptr -34h
TargetHandle	= dword	ptr -30h
var_2C		= _SECURITY_ATTRIBUTES ptr -2Ch
var_20		= dword	ptr -20h
hObject		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 50h
		mov	[ebp+var_C], 2
		mov	dword ptr [ebp+var_10],	offset a_pth_pipe ; "_pth_pipe"
		mov	[ebp+var_14], offset aFiledes ;	"filedes"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_63AC7996
		mov	eax, offset aReading ; "reading"
		jmp	short loc_63AC799B
; ---------------------------------------------------------------------------

loc_63AC7996:				; CODE XREF: pth_pipe+27j
		mov	eax, offset aWriting ; "writing"

loc_63AC799B:				; CODE XREF: pth_pipe+2Ej
		mov	[esp+58h+dwOptions], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+bInheritHandle], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwDesiredAccess], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+hTargetProcessHandle],	eax ; char
		mov	[esp+58h+hSourceHandle], offset	aSS0xXEnterInhe	; "%s (%s=0x%x): enter:	inherit_idx=%i (us"...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	sub_63AC52BE
		lea	eax, [ebp+var_2C]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_2C.nLength], 0Ch
		mov	[ebp+var_2C.bInheritHandle], 0
		mov	[esp+58h+lpTargetHandle], 1000h	; DWORD
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+hTargetProcessHandle],	eax ; LPSECURITY_ATTRIBUTES
		lea	eax, [ebp+var_20]
		mov	[esp+58h+hSourceHandle], eax ; PHANDLE
		lea	eax, [ebp+hObject]
		mov	[esp+58h+hSourceProcessHandle],	eax ; PHANDLE
		call	sub_63AC7939
		test	eax, eax
		jnz	loc_63AC7AA2
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+bInheritHandle], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwDesiredAccess], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+hTargetProcessHandle],	eax ; char
		mov	[esp+58h+hSourceHandle], offset	aSS0xXCheckCr_1	; "%s (%s=0x%x): check:	CreatePipe failed:"...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	sub_63AC52BE
		mov	[esp+58h+hSourceProcessHandle],	5
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	strerror
		mov	[esp+58h+bInheritHandle], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwDesiredAccess], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+hTargetProcessHandle],	eax ; char
		mov	[esp+58h+hSourceHandle], offset	aSS0xXErrorS_0 ; "%s (%s=0x%x):	error: %s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	loc_63AC7D44
; ---------------------------------------------------------------------------

loc_63AC7AA2:				; CODE XREF: pth_pipe+B0j
		cmp	[ebp+arg_4], 0
		jnz	loc_63AC7BCF
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	esi, [ebp+hObject]
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+58h+dwOptions], 2 ; dwOptions
		mov	[esp+58h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+58h+dwDesiredAccess], 0 ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+58h+lpTargetHandle], edx ;	lpTargetHandle
		mov	[esp+58h+hTargetProcessHandle],	ebx ; hTargetProcessHandle
		mov	[esp+58h+hSourceHandle], esi ; hSourceHandle
		mov	[esp+58h+hSourceProcessHandle],	eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	loc_63AC7BA1
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+bInheritHandle], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwDesiredAccess], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+hTargetProcessHandle],	eax ; char
		mov	[esp+58h+hSourceHandle], offset	aSS0xXCheckDupl	; "%s (%s=0x%x): check:	DuplicateHandle	fa"...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+hObject]
		mov	[esp+58h+hSourceProcessHandle],	eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_20]
		mov	[esp+58h+hSourceProcessHandle],	eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	[esp+58h+hSourceProcessHandle],	5
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	strerror
		mov	[esp+58h+bInheritHandle], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwDesiredAccess], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+hTargetProcessHandle],	eax ; char
		mov	[esp+58h+hSourceHandle], offset	aSS0xXErrorS_0 ; "%s (%s=0x%x):	error: %s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	loc_63AC7D44
; ---------------------------------------------------------------------------

loc_63AC7BA1:				; CODE XREF: pth_pipe+18Fj
		mov	eax, [ebp+hObject]
		mov	[esp+58h+hSourceProcessHandle],	eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+TargetHandle]
		mov	[ebp+hObject], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+hSourceHandle], 1
		mov	[esp+58h+hSourceProcessHandle],	eax
		call	sub_63AC6074
		jmp	loc_63AC7CF4
; ---------------------------------------------------------------------------

loc_63AC7BCF:				; CODE XREF: pth_pipe+140j
		cmp	[ebp+arg_4], 1
		jnz	loc_63AC7CF4
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	esi, [ebp+var_20]
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+58h+dwOptions], 2 ; dwOptions
		mov	[esp+58h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+58h+dwDesiredAccess], 0 ; dwDesiredAccess
		lea	edx, [ebp+var_34]
		mov	[esp+58h+lpTargetHandle], edx ;	lpTargetHandle
		mov	[esp+58h+hTargetProcessHandle],	ebx ; hTargetProcessHandle
		mov	[esp+58h+hSourceHandle], esi ; hSourceHandle
		mov	[esp+58h+hSourceProcessHandle],	eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	loc_63AC7CCB
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+58h+bInheritHandle], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwDesiredAccess], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+hTargetProcessHandle],	eax ; char
		mov	[esp+58h+hSourceHandle], offset	aSS0xXCheckDupl	; "%s (%s=0x%x): check:	DuplicateHandle	fa"...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	sub_63AC52BE
		mov	eax, [ebp+hObject]
		mov	[esp+58h+hSourceProcessHandle],	eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_20]
		mov	[esp+58h+hSourceProcessHandle],	eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	[esp+58h+hSourceProcessHandle],	5
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	strerror
		mov	[esp+58h+bInheritHandle], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwDesiredAccess], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+hTargetProcessHandle],	eax ; char
		mov	[esp+58h+hSourceHandle], offset	aSS0xXErrorS_0 ; "%s (%s=0x%x):	error: %s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	short loc_63AC7D44
; ---------------------------------------------------------------------------

loc_63AC7CCB:				; CODE XREF: pth_pipe+2BCj
		mov	eax, [ebp+var_20]
		mov	[esp+58h+hSourceProcessHandle],	eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_34]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+hObject]
		mov	[esp+58h+hSourceHandle], 1
		mov	[esp+58h+hSourceProcessHandle],	eax
		call	sub_63AC6074

loc_63AC7CF4:				; CODE XREF: pth_pipe+264j
					; pth_pipe+26Dj
		mov	eax, [ebp+hObject]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+4]
		mov	eax, [ebp+var_20]
		mov	[edx], eax
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+hObject]
		mov	[esp+58h+dwOptions], edx
		mov	[esp+58h+bInheritHandle], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+dwDesiredAccess], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+58h+hTargetProcessHandle],	eax ; char
		mov	[esp+58h+hSourceHandle], offset	aSS0xXLeaveRead	; "%s (%s=0x%x): leave:	read=%p, write=%p\"...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hSourceProcessHandle],	eax ; int
		call	sub_63AC52BE
		mov	eax, 0

loc_63AC7D44:				; CODE XREF: pth_pipe+137j
					; pth_pipe+236j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	esi
		pop	ebp
		retn
pth_pipe	endp

; Exported entry  40. pth_close

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl pth_close(HANDLE)
		public pth_close
pth_close	proc near

hObject		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 2
		mov	dword ptr [ebp+var_10],	offset aPth_close ; "pth_close"
		mov	[ebp+var_14], offset aFd_0 ; "fd"
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_2C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	dword ptr [esp+38h+var_30], eax	; char
		mov	[esp+38h+var_34], offset aSS0xXEnter_0 ; "%s (%s=0x%x):	enter\n"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+hObject], eax ; int
		call	sub_63AC52BE
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_63AC7DED
		mov	[esp+38h+hObject], 9
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+hObject], eax ; int
		call	strerror
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_2C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	dword ptr [esp+38h+var_30], eax	; char
		mov	[esp+38h+var_34], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+hObject], eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	locret_63AC7ED3
; ---------------------------------------------------------------------------

loc_63AC7DED:				; CODE XREF: pth_close+4Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+hObject], eax
		call	sub_63AC61AC
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+hObject], eax
		call	sub_63AC7346
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		test	eax, eax
		jnz	loc_63AC7E9E
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_2C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	dword ptr [esp+38h+var_30], eax	; char
		mov	[esp+38h+var_34], offset aSS0xXCheckClos ; "%s (%s=0x%x): check: CloseHandle failed"...
		mov	eax, [ebp+var_C]
		mov	[esp+38h+hObject], eax ; int
		call	sub_63AC52BE
		mov	[esp+38h+hObject], 5
		call	sub_63AC5104
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+hObject], eax ; int
		call	strerror
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_2C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	dword ptr [esp+38h+var_30], eax	; char
		mov	[esp+38h+var_34], offset aSS0xXErrorS_0	; "%s (%s=0x%x): error:	%s\n"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+hObject], eax ; int
		call	sub_63AC52BE
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC7ED3
; ---------------------------------------------------------------------------

loc_63AC7E9E:				; CODE XREF: pth_close+CAj
		mov	[esp+38h+var_24], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_2C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	dword ptr [esp+38h+var_30], eax	; char
		mov	[esp+38h+var_34], offset aSS0xXLeaveRe_0 ; "%s (%s=0x%x): leave: result=%i\n"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+hObject], eax ; int
		call	sub_63AC52BE
		mov	eax, 0

locret_63AC7ED3:			; CODE XREF: pth_close+9Dj
					; pth_close+151j
		leave
		retn
pth_close	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC7ED5	proc near		; CODE XREF: sub_63AC16F9+Cp
					; sub_63AC20AF+59p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_63AC6074
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC7EFE
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC7F04
; ---------------------------------------------------------------------------

loc_63AC7EFE:				; CODE XREF: sub_63AC7ED5+20j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+28h]

locret_63AC7F04:			; CODE XREF: sub_63AC7ED5+27j
		leave
		retn
sub_63AC7ED5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC7F06	proc near		; CODE XREF: sub_63AC16F9+1Cp
					; sub_63AC25A1+59p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_63AC720E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_63AC7F2F
		mov	eax, 0FFFFFFFFh
		jmp	short locret_63AC7F35
; ---------------------------------------------------------------------------

loc_63AC7F2F:				; CODE XREF: sub_63AC7F06+20j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]

locret_63AC7F35:			; CODE XREF: sub_63AC7F06+27j
		leave
		retn
sub_63AC7F06	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_63AC7F40(_onexit_t)
sub_63AC7F40	proc near		; CODE XREF: sub_63AC8000+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_63ACD7D4
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_63AC8200
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_63AC7FE0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_63ACD7D4
		mov	[esp+2Ch+Func],	eax
		call	sub_63AC8200
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_63ACD7D0
		mov	[esp+2Ch+Func],	eax
		call	sub_63AC8200
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_63AC8210
		mov	ds:dword_63ACD7D4, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_63AC8210
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_63ACD7D0, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC7FE0:				; CODE XREF: sub_63AC7F40+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_63AC7F40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_63AC8000(_onexit_t)
sub_63AC8000	proc near		; CODE XREF: sub_63AC87F0-27p
					; sub_63AC93A0+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_63AC7F40
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_63AC8000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:63AD001Co

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_63AC8040
		cmp	eax, 3
		jz	short loc_63AC8040
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8040:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_63AC8B10
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_63AC1040+12Ap
					; DATA XREF: .rdata:off_63ACC40Co ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_63AC80B4
		cmp	dword_63ACA03C,	2
		jz	short loc_63AC8096
		mov	dword_63ACA03C,	2

loc_63AC8096:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_63AC81A3
		cmp	eax, 1
		jz	loc_63AC8142

loc_63AC80A8:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_63AC80B4:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_63ACD7E8, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_63AC81D3
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_63ACD7E4, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_63ACD7E0, eax
		jz	loc_63AC81D3
		mov	ecx, ds:dword_63ACD7E4
		test	ecx, ecx
		jz	short loc_63AC8163
		test	eax, eax
		jz	short loc_63AC8163
		mov	dword_63ACA03C,	1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_63AC8142:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_63AC8B10
		jmp	loc_63AC80A8
; ---------------------------------------------------------------------------

loc_63AC8163:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_63ACD7E0, 0
		mov	ds:dword_63ACD7E4, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_63AC8183:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_63ACA03C,	0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_63AC81A3:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_63AD0028
		cmp	ebx, offset dword_63AD0028
		jz	loc_63AC80A8

loc_63AC81B4:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_63AC81BC
		call	eax

loc_63AC81BC:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_63AD0028
		jnz	short loc_63AC81B4
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_63AC81D3:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_63ACD7E0, 0
		mov	ds:dword_63ACD7E4, 0
		jmp	short loc_63AC8183
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8200	proc near		; CODE XREF: sub_63AC1040+14Bp
					; sub_63AC1040+15Ep ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_63AC8200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8210	proc near		; CODE XREF: sub_63AC1000+15p
					; sub_63AC7F40+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_63AC8210	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_63AC8220(char	*Format, char ArgList)
sub_63AC8220	proc near		; CODE XREF: sub_63AC8280+1DDp
					; sub_63AC8280+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_63AC8220	endp

; ---------------------------------------------------------------------------
		jmp	short sub_63AC8280
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_63AC8280(size_t Size)
sub_63AC8280	proc near		; CODE XREF: .text:63AC8271j
					; sub_63AC84C0+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_63ACD440
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_63AC8462
		mov	eax, ds:dword_63ACD43C
		xor	esi, esi

loc_63AC82A4:				; CODE XREF: sub_63AC8280+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_63AC82B9
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_63AC8390

loc_63AC82B9:				; CODE XREF: sub_63AC8280+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_63AC82A4

loc_63AC82C3:				; CODE XREF: sub_63AC8280+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_63AC8CC0
		test	eax, eax
		mov	edi, eax
		jz	loc_63AC8489
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_63ACD43C
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_63AC8DA0
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_63ACD43C
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_63AC8469
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_63AC8411

loc_63AC833F:				; CODE XREF: sub_63AC8280+194j
					; sub_63AC8280+1C6j
		add	ds:dword_63ACD440, 1

loc_63AC8346:				; CODE XREF: sub_63AC8280+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_63AC8499
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_63AC8398

loc_63AC836F:				; CODE XREF: sub_63AC8280+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_63AC8383:				; CODE XREF: sub_63AC8280+162j
					; sub_63AC8280+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8390:				; CODE XREF: sub_63AC8280+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_63AC8346
; ---------------------------------------------------------------------------

loc_63AC8398:				; CODE XREF: sub_63AC8280+EDj
		cmp	eax, 40h
		jz	short loc_63AC836F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_63AC8383
		cmp	eax, 4
		jz	short loc_63AC8383
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_63AC8411:				; CODE XREF: sub_63AC8280+B9j
		cmp	eax, 40h
		jz	loc_63AC833F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_63ACD43C
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_63AC833F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_63AC8220
; ---------------------------------------------------------------------------

loc_63AC8462:				; CODE XREF: sub_63AC8280+17j
		xor	esi, esi
		jmp	loc_63AC82C3
; ---------------------------------------------------------------------------

loc_63AC8469:				; CODE XREF: sub_63AC8280+ACj
		mov	eax, ds:dword_63ACD43C
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_63AC8220
; ---------------------------------------------------------------------------

loc_63AC8489:				; CODE XREF: sub_63AC8280+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_63AC8220
; ---------------------------------------------------------------------------

loc_63AC8499:				; CODE XREF: sub_63AC8280+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_63AC8220
sub_63AC8280	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC84C0	proc near		; CODE XREF: sub_63AC1260+32p
					; sub_63AC1260:loc_63AC1314p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_63ACD438
		test	eax, eax
		jz	short loc_63AC84E0

loc_63AC84D2:				; CODE XREF: sub_63AC84C0+66j
					; sub_63AC84C0+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC84E0:				; CODE XREF: sub_63AC84C0+10j
		mov	ds:dword_63ACD438, 1
		call	sub_63AC8D00
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_63AC8F70
		mov	ds:dword_63ACD440, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_63ACD43C, eax
		mov	eax, offset dword_63ACC588
		sub	eax, offset dword_63ACC588
		cmp	eax, 7
		jle	short loc_63AC84D2
		cmp	eax, 0Bh
		mov	ebx, offset dword_63ACC588
		jle	loc_63AC8620
		mov	eax, ds:dword_63ACC588
		test	eax, eax
		jnz	short loc_63AC8550
		mov	eax, ds:dword_63ACC58C
		test	eax, eax
		jz	loc_63AC860C
		lea	esi, [esi+0]

loc_63AC8550:				; CODE XREF: sub_63AC84C0+7Dj
					; sub_63AC84C0+164j ...
		cmp	ebx, offset dword_63ACC588
		jnb	loc_63AC84D2
		mov	esi, 63AC0000h

loc_63AC8561:				; CODE XREF: sub_63AC84C0+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_63AC8280
		cmp	ebx, offset dword_63ACC588
		jb	short loc_63AC8561

loc_63AC8585:				; CODE XREF: sub_63AC84C0+24Bj
		mov	ecx, ds:dword_63ACD440
		test	ecx, ecx
		jle	loc_63AC84D2
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_63AC85B2
; ---------------------------------------------------------------------------
		align 10h

loc_63AC85A0:				; CODE XREF: sub_63AC84C0+FDj
					; sub_63AC84C0+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_63ACD440
		jge	loc_63AC84D2

loc_63AC85B2:				; CODE XREF: sub_63AC84C0+DDj
		mov	eax, ds:dword_63ACD43C
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_63AC85A0
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_63AC8732
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_63ACD43C
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_63AC85A0
; ---------------------------------------------------------------------------

loc_63AC860C:				; CODE XREF: sub_63AC84C0+86j
		mov	eax, ds:dword_63ACC590
		test	eax, eax
		jnz	short loc_63AC8635
		mov	ebx, offset dword_63ACC594
		lea	esi, [esi+0]

loc_63AC8620:				; CODE XREF: sub_63AC84C0+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_63AC8550
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_63AC8550

loc_63AC8635:				; CODE XREF: sub_63AC84C0+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_63AC8755
		add	ebx, 0Ch
		cmp	ebx, offset dword_63ACC588
		jnb	loc_63AC84D2

loc_63AC8650:				; CODE XREF: sub_63AC84C0+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 63AC0000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+63AC0000h]
		jz	short loc_63AC86AA
		cmp	edx, 20h
		jz	short loc_63AC86E0
		cmp	edx, 8
		jz	short loc_63AC868A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_63AC8220
; ---------------------------------------------------------------------------

loc_63AC868A:				; CODE XREF: sub_63AC84C0+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_63AC86B5
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 63AC0000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_63AC86D1
; ---------------------------------------------------------------------------

loc_63AC86AA:				; CODE XREF: sub_63AC84C0+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_63AC8710

loc_63AC86B5:				; CODE XREF: sub_63AC84C0+1D3j
		sub	edi, ecx
		sub	edi, 63AC0000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_63AC8723
		cmp	edx, 20h
		jz	short loc_63AC86EF
		cmp	edx, 8
		jnz	short loc_63AC86FC

loc_63AC86D1:				; CODE XREF: sub_63AC84C0+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_63AC8280
		jmp	short loc_63AC86FC
; ---------------------------------------------------------------------------

loc_63AC86E0:				; CODE XREF: sub_63AC84C0+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 63AC0000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_63AC86EF:				; CODE XREF: sub_63AC84C0+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_63AC8280

loc_63AC86FC:				; CODE XREF: sub_63AC84C0+20Fj
					; sub_63AC84C0+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_63ACC588
		jb	loc_63AC8650
		jmp	loc_63AC8585
; ---------------------------------------------------------------------------

loc_63AC8710:				; CODE XREF: sub_63AC84C0+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 63AC0000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_63AC8723:				; CODE XREF: sub_63AC84C0+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_63AC8280
		jmp	short loc_63AC86FC
; ---------------------------------------------------------------------------

loc_63AC8732:				; CODE XREF: sub_63AC84C0+11Bj
		add	ebx, ds:dword_63ACD43C
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_63AC8220
; ---------------------------------------------------------------------------

loc_63AC8755:				; CODE XREF: sub_63AC84C0+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_63AC8220
sub_63AC84C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_63AC8770()
sub_63AC8770	proc near		; DATA XREF: sub_63AC87F0:loc_63AC87C2o
		sub	esp, 0Ch
		mov	eax, off_63ACA038
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_63AC8797
		xchg	ax, ax

loc_63AC8780:				; CODE XREF: sub_63AC8770+25j
		call	eax
		mov	eax, off_63ACA038
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_63ACA038, edx
		test	eax, eax
		jnz	short loc_63AC8780

loc_63AC8797:				; CODE XREF: sub_63AC8770+Cj
		add	esp, 0Ch
		retn
sub_63AC8770	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_63AC87F0

loc_63AC87A0:				; CODE XREF: sub_63AC87F0+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_63AC93C0
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_63AC87D3

loc_63AC87AF:				; CODE XREF: sub_63AC87F0-9j
		test	ebx, ebx
		jz	short loc_63AC87C2

loc_63AC87B3:				; CODE XREF: sub_63AC87F0-30j
		call	ds:dword_63AC93C0[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_63AC87B3

loc_63AC87C2:				; CODE XREF: sub_63AC87F0-3Fj
		mov	[esp+1Ch+var_1C], offset sub_63AC8770 ;	_onexit_t
		call	sub_63AC8000
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_63AC87D3:				; CODE XREF: sub_63AC87F0-43j
		xor	ebx, ebx
		jmp	short loc_63AC87D9
; ---------------------------------------------------------------------------

loc_63AC87D7:				; CODE XREF: sub_63AC87F0-Bj
		mov	ebx, eax

loc_63AC87D9:				; CODE XREF: sub_63AC87F0-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_63AC93C0[eax*4]
		test	edx, edx
		jnz	short loc_63AC87D7
		jmp	short loc_63AC87AF
; END OF FUNCTION CHUNK	FOR sub_63AC87F0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC87F0	proc near		; CODE XREF: sub_63AC1260+195p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 63AC87A0 SIZE 00000049 BYTES

		mov	ecx, ds:dword_63ACD444
		test	ecx, ecx
		jz	short loc_63AC8800
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8800:				; CODE XREF: sub_63AC87F0+8j
		mov	ds:dword_63ACD444, 1
		jmp	short loc_63AC87A0
sub_63AC87F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8810	proc near		; CODE XREF: DllEntryPoint+34p

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_63ACA040
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_63AC8860
		not	eax
		mov	dword_63ACA044,	eax

loc_63AC8846:				; CODE XREF: sub_63AC8810+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8860:				; CODE XREF: sub_63AC8810+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_63AC88D2

loc_63AC88C2:				; CODE XREF: sub_63AC8810+CCj
		mov	dword_63ACA040,	ebp
		mov	dword_63ACA044,	eax
		jmp	loc_63AC8846
; ---------------------------------------------------------------------------

loc_63AC88D2:				; CODE XREF: sub_63AC8810+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_63AC88C2
sub_63AC8810	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_63ACD524, edx
		mov	ds:dword_63ACD740, 0C0000409h
		mov	ds:dword_63ACD744, 1
		mov	ds:dword_63ACD518, eax
		mov	ds:dword_63ACD74C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_63ACD50C, eax
		mov	eax, dword_63ACA040
		mov	[ebp-10h], eax
		mov	eax, dword_63ACA044
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_63ACC508
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8970	proc near		; CODE XREF: sub_63AC8B10+79p
					; sub_63AC8B10:loc_63AC8BA2p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset stru_63ACD7A4 ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_63ACD7BC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_63AC89C5
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_63AC89A0:				; CODE XREF: sub_63AC8970+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_63AC89BE
		test	esi, esi
		jz	short loc_63AC89BE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_63AC89BE:				; CODE XREF: sub_63AC8970+40j
					; sub_63AC8970+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_63AC89A0

loc_63AC89C5:				; CODE XREF: sub_63AC8970+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset stru_63ACD7A4 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_63AC8970	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_63ACD7A0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_63AC8A04

loc_63AC89F6:				; CODE XREF: .text:63AC8A6Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_63AC8A04:				; CODE XREF: .text:63AC89F4j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_63AC8A67
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	stru_63ACD7A4
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_63ACD7BC
		mov	ds:dword_63ACD7BC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	stru_63ACD7A4
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_63AC8A67:				; CODE XREF: .text:63AC8A1Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_63AC89F6
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_63ACD7A0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_63AC8A88
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_63AC8A88:				; CODE XREF: .text:63AC8A7Fj
		mov	dword ptr [esp], offset	stru_63ACD7A4
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_63ACD7BC
		sub	esp, 4
		test	edx, edx
		jz	short loc_63AC8ABF
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_63AC8AB8
		jmp	short loc_63AC8AF6
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8AB0:				; CODE XREF: .text:63AC8ABDj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_63AC8AD6
		mov	edx, eax

loc_63AC8AB8:				; CODE XREF: .text:63AC8AA6j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_63AC8AB0

loc_63AC8ABF:				; CODE XREF: .text:63AC8AA0j
		mov	dword ptr [esp], offset	stru_63ACD7A4
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_63AC8ACF:				; CODE XREF: .text:63AC8AF4j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_63AC8AD6:				; CODE XREF: .text:63AC8AB4j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_63AC8ADC:				; CODE XREF: .text:63AC8B00j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	stru_63ACD7A4
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_63AC8ACF
; ---------------------------------------------------------------------------

loc_63AC8AF6:				; CODE XREF: .text:63AC8AA8j
		mov	eax, [edx+8]
		mov	ds:dword_63ACD7BC, eax
		mov	eax, edx
		jmp	short loc_63AC8ADC
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8B10	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_63AC8B60
		jb	short loc_63AC8B30
		cmp	eax, 3
		jz	short loc_63AC8B80

loc_63AC8B23:				; CODE XREF: sub_63AC8B10+31j
					; sub_63AC8B10+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8B30:				; CODE XREF: sub_63AC8B10+Cj
		mov	eax, ds:dword_63ACD7A0
		test	eax, eax
		jnz	short loc_63AC8BA2

loc_63AC8B39:				; CODE XREF: sub_63AC8B10+97j
		mov	eax, ds:dword_63ACD7A0
		cmp	eax, 1
		jnz	short loc_63AC8B23
		mov	ds:dword_63ACD7A0, 0
		mov	[esp+1Ch+lpCriticalSection], offset stru_63ACD7A4 ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_63AC8B23
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8B60:				; CODE XREF: sub_63AC8B10+Aj
		mov	eax, ds:dword_63ACD7A0
		test	eax, eax
		jz	short loc_63AC8B90

loc_63AC8B69:				; CODE XREF: sub_63AC8B10+90j
		mov	ds:dword_63ACD7A0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8B80:				; CODE XREF: sub_63AC8B10+11j
		mov	eax, ds:dword_63ACD7A0
		test	eax, eax
		jz	short loc_63AC8B23
		call	sub_63AC8970
		jmp	short loc_63AC8B23
; ---------------------------------------------------------------------------

loc_63AC8B90:				; CODE XREF: sub_63AC8B10+57j
		mov	[esp+1Ch+lpCriticalSection], offset stru_63ACD7A4 ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_63AC8B69
; ---------------------------------------------------------------------------

loc_63AC8BA2:				; CODE XREF: sub_63AC8B10+27j
		call	sub_63AC8970
		jmp	short loc_63AC8B39
sub_63AC8B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8BB0	proc near		; CODE XREF: .text:63AC8C51p
					; sub_63AC8CC0+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_63AC8BC0

locret_63AC8BBD:			; CODE XREF: sub_63AC8BB0+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8BC0:				; CODE XREF: sub_63AC8BB0+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_63AC8BBD
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_63AC8BB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8BE0	proc near		; CODE XREF: sub_63AC8CC0+2Bp
					; .text:63AC8E04p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_63AC8C1E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_63AC8C04:				; CODE XREF: sub_63AC8BE0+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_63AC8C12
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_63AC8C1E

loc_63AC8C12:				; CODE XREF: sub_63AC8BE0+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_63AC8C04
		xor	eax, eax

loc_63AC8C1E:				; CODE XREF: sub_63AC8BE0+19j
					; sub_63AC8BE0+30j
		pop	ebx
		pop	esi
		retn
sub_63AC8BE0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_63AC8C30
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8C30:				; CODE XREF: .text:63AC8C21j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_63AC8CA3
		mov	dword ptr [esp], 63AC0000h
		call	sub_63AC8BB0
		test	eax, eax
		jz	short loc_63AC8CA3
		mov	eax, ds:63AC003Ch
		movzx	ebp, word ptr [eax+63AC0006h]
		movzx	edx, word ptr [eax+63AC0014h]
		add	eax, 63AC0000h
		test	ebp, ebp
		jz	short loc_63AC8CA3
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_63AC8C8B
; ---------------------------------------------------------------------------

loc_63AC8C81:				; CODE XREF: .text:63AC8CA1j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_63AC8CB0

loc_63AC8C8B:				; CODE XREF: .text:63AC8C7Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_63AC8C81

loc_63AC8CA3:				; CODE XREF: .text:63AC8C48j
					; .text:63AC8C58j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8CB0:				; CODE XREF: .text:63AC8C89j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8CC0	proc near		; CODE XREF: sub_63AC8280+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 63AC0000h
		call	sub_63AC8BB0
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_63AC8CF0
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 63AC0000h
		sub	eax, 63AC0000h
		mov	[esp+8+var_4], eax
		call	sub_63AC8BE0

loc_63AC8CF0:				; CODE XREF: sub_63AC8CC0+15j
		add	esp, 8
		retn
sub_63AC8CC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8D00	proc near		; CODE XREF: sub_63AC84C0+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 63AC0000h
		call	sub_63AC8BB0
		xor	edx, edx
		test	eax, eax
		jz	short loc_63AC8D21
		mov	eax, ds:63AC003Ch
		movzx	edx, word ptr [eax+63AC0006h]

loc_63AC8D21:				; CODE XREF: sub_63AC8D00+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_63AC8D00	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 63AC0000h
		mov	ebx, [esp+10h]
		call	sub_63AC8BB0
		xor	edx, edx
		test	eax, eax
		jz	short loc_63AC8D89
		mov	eax, ds:63AC003Ch
		movzx	ecx, word ptr [eax+63AC0006h]
		movzx	esi, word ptr [eax+63AC0014h]
		add	eax, 63AC0000h
		test	ecx, ecx
		jz	short loc_63AC8D89
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_63AC8D70:				; CODE XREF: .text:63AC8D85j
		test	byte ptr [edx+27h], 20h
		jz	short loc_63AC8D7D
		test	ebx, ebx
		jz	short loc_63AC8D89
		sub	ebx, 1

loc_63AC8D7D:				; CODE XREF: .text:63AC8D74j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_63AC8D70
		xor	edx, edx

loc_63AC8D89:				; CODE XREF: .text:63AC8D49j
					; .text:63AC8D65j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_63AC8DA0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8DA0	proc near		; CODE XREF: sub_63AC8280+70p
					; .text:63AC8D91j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 63AC0000h
		call	sub_63AC8BB0
		xor	edx, edx
		test	eax, eax
		mov	eax, 63AC0000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_63AC8DA0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_63AC8DD0
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8DD0:				; CODE XREF: .text:63AC8DC1j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 63AC0000h
		call	sub_63AC8BB0
		test	eax, eax
		jnz	short loc_63AC8DF0

loc_63AC8DE6:				; CODE XREF: .text:63AC8E0Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8DF0:				; CODE XREF: .text:63AC8DE4j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 63AC0000h
		sub	eax, 63AC0000h
		mov	[esp+4], eax
		call	sub_63AC8BE0
		test	eax, eax
		jz	short loc_63AC8DE6
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8E20	proc near		; CODE XREF: .text:63AC8ECAp

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 63AC0000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_63AC8BB0
		test	eax, eax
		jz	short loc_63AC8E91
		mov	eax, ds:63AC003Ch
		mov	esi, [eax+63AC0080h]
		test	esi, esi
		jz	short loc_63AC8E91
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 63AC0000h
		call	sub_63AC8BE0
		test	eax, eax
		jz	short loc_63AC8E91
		add	esi, 63AC0000h
		jnz	short loc_63AC8E76
		jmp	short loc_63AC8E91
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8E70:				; CODE XREF: sub_63AC8E20+66j
		sub	ebx, 1
		add	esi, 14h

loc_63AC8E76:				; CODE XREF: sub_63AC8E20+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_63AC8E84
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_63AC8EA0

loc_63AC8E84:				; CODE XREF: sub_63AC8E20+5Bj
		test	ebx, ebx
		jg	short loc_63AC8E70
		mov	edi, [esi+0Ch]
		add	edi, 63AC0000h

loc_63AC8E91:				; CODE XREF: sub_63AC8E20+1Aj
					; sub_63AC8E20+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_63AC8EA0:				; CODE XREF: sub_63AC8E20+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_63AC8E20	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_63ACD7C4
		test	eax, eax
		jz	short loc_63AC8EC2

loc_63AC8EBD:				; CODE XREF: .text:63AC8F47j
					; .text:63AC8F65j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_63AC8EC2:				; CODE XREF: .text:63AC8EBBj
		xor	eax, eax

loc_63AC8EC4:				; CODE XREF: .text:63AC8F32j
		mov	[esp], eax
		lea	ebx, [eax+1]
		call	sub_63AC8E20
		test	eax, eax
		jz	short loc_63AC8F50
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_63AC8EE0
		cmp	dl, 6Dh
		jnz	short loc_63AC8F30

loc_63AC8EE0:				; CODE XREF: .text:63AC8ED9j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_63AC8EEE
		cmp	dl, 73h
		jnz	short loc_63AC8F30

loc_63AC8EEE:				; CODE XREF: .text:63AC8EE7j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_63AC8EFC
		cmp	dl, 76h
		jnz	short loc_63AC8F30

loc_63AC8EFC:				; CODE XREF: .text:63AC8EF5j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_63AC8F0A
		cmp	dl, 63h
		jnz	short loc_63AC8F30

loc_63AC8F0A:				; CODE XREF: .text:63AC8F03j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_63AC8F18
		cmp	dl, 72h
		jnz	short loc_63AC8F30

loc_63AC8F18:				; CODE XREF: .text:63AC8F11j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_63AC8F34
		cmp	dl, 74h
		jz	short loc_63AC8F34
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_63AC8F34
		xchg	ax, ax

loc_63AC8F30:				; CODE XREF: .text:63AC8EDEj
					; .text:63AC8EECj ...
		mov	eax, ebx
		jmp	short loc_63AC8EC4
; ---------------------------------------------------------------------------

loc_63AC8F34:				; CODE XREF: .text:63AC8F1Fj
					; .text:63AC8F24j ...
		mov	[esp], eax
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_63ACD7C4, eax
		jnz	loc_63AC8EBD
		lea	esi, [esi+0]

loc_63AC8F50:				; CODE XREF: .text:63AC8ED1j
		mov	dword ptr [esp], offset	aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_63ACD7C4, eax
		jmp	loc_63AC8EBD
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8F70	proc near		; CODE XREF: sub_63AC84C0+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_63AC8F92

loc_63AC8F7D:				; CODE XREF: sub_63AC8F70+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_63AC8F7D

loc_63AC8F92:				; CODE XREF: sub_63AC8F70+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_63AC8F70	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_63AC8FD0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8FD0	proc near		; CODE XREF: sub_63AC1040+53p
					; sub_63AC1040+C8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_63AC8FD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC8FF0	proc near		; CODE XREF: sub_63AC1260+46p
					; sub_63AC1260+CCp ...
		mov	eax, 1
		retn	0Ch
sub_63AC8FF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_63AC9000	proc near		; CODE XREF: sub_63AC1260+8Bp
					; sub_63AC1260+10Dp ...
		mov	eax, 1
		retn	0Ch
sub_63AC9000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_63AC9010	proc near		; CODE XREF: sub_63AC91F0+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_63AC905C
		jmp	short loc_63AC9064
; ---------------------------------------------------------------------------
		align 10h

loc_63AC9050:				; CODE XREF: sub_63AC9010+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_63AC9064

loc_63AC905C:				; CODE XREF: sub_63AC9010+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_63AC9050

loc_63AC9064:				; CODE XREF: sub_63AC9010+39j
					; sub_63AC9010+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_63AC908C
		jmp	short loc_63AC9094
; ---------------------------------------------------------------------------
		align 10h

loc_63AC9080:				; CODE XREF: sub_63AC9010+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_63AC9094

loc_63AC908C:				; CODE XREF: sub_63AC9010+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_63AC9080

loc_63AC9094:				; CODE XREF: sub_63AC9010+6Aj
					; sub_63AC9010+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_63AC9150
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_63AC917E

loc_63AC90B3:				; CODE XREF: sub_63AC9010+168j
					; sub_63AC9010+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_63AC9190

loc_63AC90E3:				; CODE XREF: sub_63AC9010+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_63ACD434
		test	eax, eax
		jz	loc_63AC91C9
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_63AC91B1
		cmp	eax, 5
		jnz	short loc_63AC91AC
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_63AC9150:				; CODE XREF: sub_63AC9010+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_63AC90B3

loc_63AC917E:				; CODE XREF: sub_63AC9010+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_63AC90B3
; ---------------------------------------------------------------------------
		align 10h

loc_63AC9190:				; CODE XREF: sub_63AC9010+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_63AC90E3
; ---------------------------------------------------------------------------

loc_63AC91AC:				; CODE XREF: sub_63AC9010+133j
		call	abort
; ---------------------------------------------------------------------------

loc_63AC91B1:				; CODE XREF: sub_63AC9010+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_63AC91C9:				; CODE XREF: sub_63AC9010+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_63AC9010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_63AC91F0(char	*, char	*, int)
sub_63AC91F0	proc near		; CODE XREF: sub_63AC7401+315p

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_63AC9256
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_63AC9240:				; CODE XREF: sub_63AC91F0+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_63AC9240
		add	edx, edx

loc_63AC9256:				; CODE XREF: sub_63AC91F0+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_63AC927D
		xor	edi, edi

loc_63AC9267:				; CODE XREF: sub_63AC91F0+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_63AC9267
		add	edx, edx

loc_63AC927D:				; CODE XREF: sub_63AC91F0+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_63AC9010
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_63AC91F0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_63AC93A0	proc near		; DATA XREF: .text:63AC93C4o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_63AC1460
		mov	[esp+18h+var_18], offset sub_63AC14B0 ;	_onexit_t
		call	sub_63AC8000
		leave
		retn
sub_63AC93A0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_63AC93C0	dd 0FFFFFFFFh		; DATA XREF: sub_63AC87F0-4Cr
					; sub_63AC87F0:loc_63AC87B3r ...
		dd offset sub_63AC93A0
		dd 0
		dd 0FFFFFFFFh
dword_63AC93D0	dd 0Ch dup(0)		; DATA XREF: .data:off_63ACA038o
		dd 300h	dup(?)
_text		ends

; Section 2. (virtual address 0000A000)
; Virtual size			: 0000004C (	 76.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00008800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 63ACA000h
dword_63ACA000	dd 1			; DATA XREF: pth_usleep+54o
dword_63ACA004	dd 1			; DATA XREF: pth_sleep+54o
dword_63ACA008	dd 1			; DATA XREF: pth_write_ev+2Eo
dword_63ACA00C	dd 1			; DATA XREF: pth_read_ev+2Eo
off_63ACA010	dd offset aDebug_lock	; DATA XREF: sub_63AC52BE+2Bo
					; sub_63AC52BE:loc_63AC53C2o
					; "debug_lock"
		align 8
dword_63ACA018	dd 28h			; DATA XREF: sub_63AC6074:loc_63AC60E1r
					; sub_63AC6074:loc_63AC612Fr ...
off_63ACA01C	dd offset aReader_table_l ; DATA XREF: sub_63AC6074+Do
					; sub_63AC6074:loc_63AC60F7o ...
					; "reader_table_lock"
		dd 0
dword_63ACA024	dd 28h			; DATA XREF: sub_63AC720E:loc_63AC727Br
					; sub_63AC720E:loc_63AC72C9r ...
off_63ACA028	dd offset aWriter_table_l ; DATA XREF: sub_63AC720E+Do
					; sub_63AC720E:loc_63AC7291o ...
					; "writer_table_lock"
		align 10h
		dd 0FFFFFFFFh
dword_63ACA034	dd 0FFFFFFFFh		; DATA XREF: sub_63AC1260+1Bw
					; sub_63AC1260+5Fw
off_63ACA038	dd offset dword_63AC93D0 ; DATA	XREF: sub_63AC8770+3r
					; sub_63AC8770+12r ...
dword_63ACA03C	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_63ACA040	dd 0BB40E64Eh		; DATA XREF: sub_63AC8810+3r
					; sub_63AC8810:loc_63AC88C2w ...
dword_63ACA044	dd 44BF19B1h		; DATA XREF: sub_63AC8810+31w
					; sub_63AC8810+B8w ...
dword_63ACA048	dd 0			; DATA XREF: sub_63AC1460+6r
					; sub_63AC1460+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0000B000)
; Virtual size			: 00001588 (   5512.)
; Section size in file		: 00001600 (   5632.)
; Offset to raw	data for section: 00008A00
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 63ACB000h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_63AC1460+Fo
; CHAR ProcName[]
ProcName	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_63AC1460+28o
		align 4
aSocket		db 'socket',0           ; DATA XREF: sub_63AC16F9+80o
aFile		db 'file',0             ; DATA XREF: sub_63AC16F9:loc_63AC1780o
; char aFd_is_socketFd[]
aFd_is_socketFd	db 'fd_is_socket: fd %i is a %s.',0Ah,0 ; DATA XREF: sub_63AC16F9+97o
; char aCreateeventFai[]
aCreateeventFai	db 'CreateEvent failed: %s',0Ah,0 ; DATA XREF: sub_63AC17A9+8Ao
		align 4
; char aSettingSynchro[]
aSettingSynchro	db 'setting synchronize for event object %p failed: %s',0Ah,0
					; DATA XREF: sub_63AC17A9+11Do
; char aCreateeventPSu[]
aCreateeventPSu	db 'CreateEvent(%p) succeeded',0Ah,0 ; DATA XREF: sub_63AC17A9+169o
; char aReseteventPFai[]
aReseteventPFai	db 'ResetEvent(%p) failed: %s',0Ah,0 ; DATA XREF: sub_63AC192E+47o
; char aReseteventPSuc[]
aReseteventPSuc	db 'ResetEvent(%p) succeeded',0Ah,0 ; DATA XREF: sub_63AC192E+6Eo
; char aCreatewaitable[]
aCreatewaitable	db 'CreateWaitableTimer failed: rc=%d',0Ah,0 ; DATA XREF: sub_63AC19B2+6Fo
		align 10h
; char aCreatewaitab_0[]
aCreatewaitab_0	db 'CreateWaitableTimer(%p) succeeded',0Ah,0 ; DATA XREF: sub_63AC19B2+96o
; char aSet_timerHdPMs[]
aSet_timerHdPMs	db 'set_timer hd=%p ms=%lu',0Ah,0 ; DATA XREF: sub_63AC1A61+22o
		align 4
; char aSSetwaitableti[]
aSSetwaitableti	db '%s: SetWaitableTimer failed: %s',0Ah,0 ; DATA XREF: sub_63AC1A61+C1o
; char VarName[]
VarName		db 'PTH_DEBUG',0        ; DATA XREF: pth_init+22o
; char Mode[]
Mode		db 'a',0                ; DATA XREF: pth_init+11Do
; char aPth_initCalled[]
aPth_initCalled	db 'pth_init called (level=%d)',0Ah,0 ; DATA XREF: pth_init+197o
byte_63ACB195	db 0			; DATA XREF: sub_63AC1E16:loc_63AC1E31o
					; sub_63AC1E61:loc_63AC1E8Do
; char aEnter_pthS[]
aEnter_pthS	db 'enter_pth (%s)',0Ah,0 ; DATA XREF: sub_63AC1E16+24o
; char aLeave_pthS[]
aLeave_pthS	db 'leave_pth (%s)',0Ah,0 ; DATA XREF: sub_63AC1E61+35o
		align 4
aPth_enterCalle	db 'pth_enter called while already in pth',0Ah,0 ; DATA XREF: pth_enter+25o
		align 10h
aPth_leaveWasCa	db 'pth_leave was called while not in pth',0Ah,0 ; DATA XREF: pth_leave+24o
aDo_pth_read	db 'do_pth_read',0      ; DATA XREF: sub_63AC20AF+17o
aFd		db 'fd',0               ; DATA XREF: sub_63AC20AF+1Eo
					; sub_63AC25A1+1Eo
; char aSS0xXEnter[]
aSS0xXEnter	db '%s (%s=0x%x): enter',0Ah,0 ; DATA XREF: sub_63AC20AF+40o
					; sub_63AC25A1+40o ...
; char aSS0xXCheckHdP[]
aSS0xXCheckHdP	db '%s (%s=0x%x): check:   hd=%p',0Ah,0 ; DATA XREF: sub_63AC20AF+7Do
					; sub_63AC25A1+7Do
		align 4
; char aSS0xXCheckRecv[]
aSS0xXCheckRecv	db '%s (%s=0x%x): check:   recv size=%d',0Ah,0 ; DATA XREF: sub_63AC20AF+E6o
		align 4
; char aSS0xXCheckRe_0[]
aSS0xXCheckRe_0	db '%s (%s=0x%x): check:   recv res=%d',0Ah,0 ; DATA XREF: sub_63AC20AF+13Eo
; char aSS0xXCheckUseR[]
aSS0xXCheckUseR	db '%s (%s=0x%x): check:   use readfile size=%d',0Ah,0
					; DATA XREF: sub_63AC20AF+16Fo
		align 4
; char aSS0xXCheckRead[]
aSS0xXCheckRead	db '%s (%s=0x%x): check:   ReadFile on %p size=%d',0Ah,0
					; DATA XREF: sub_63AC20AF+1CEo
		align 4
; char aSS0xXCheckNDNr[]
aSS0xXCheckNDNr	db '%s (%s=0x%x): check:            n=%d nread=%d',0Ah,0
					; DATA XREF: sub_63AC20AF+234o
		align 4
; char aPth_read0xXRea[]
aPth_read0xXRea	db 'pth_read(0x%x) ReadFile failed: %s',0Ah,0 ; DATA XREF: sub_63AC20AF+28Ao
; char aPth_read0xXRec[]
aPth_read0xXRec	db 'pth_read(0x%x) recv failed: ec=%d',0Ah,0 ; DATA XREF: sub_63AC20AF+2E7o
		align 10h
; char aSS0xXLeaveResu[]
aSS0xXLeaveResu	db '%s (%s=0x%x): leave: result=%i',0Ah,0 ; DATA XREF: sub_63AC20AF+334o
					; sub_63AC25A1+31Fo ...
; char aSS0xXErrorS[]
aSS0xXErrorS	db '%s (%s=0x%x): error: %s',0Ah,0 ; DATA XREF: sub_63AC20AF+373o
					; sub_63AC25A1+35Eo ...
aDo_pth_write	db 'do_pth_write',0     ; DATA XREF: sub_63AC25A1+17o
		align 4
; char aSS0xXCheckSend[]
aSS0xXCheckSend	db '%s (%s=0x%x): check:   send size=%d',0Ah,0 ; DATA XREF: sub_63AC25A1+E6o
		align 10h
; char aSS0xXCheckSe_0[]
aSS0xXCheckSe_0	db '%s (%s=0x%x): check:   send res=%d',0Ah,0 ; DATA XREF: sub_63AC25A1+13Eo
; char aSS0xXCheckUseW[]
aSS0xXCheckUseW	db '%s (%s=0x%x): check:   use writefile size=%d',0Ah,0
					; DATA XREF: sub_63AC25A1+16Fo
		align 4
; char aSS0xXCheckWrit[]
aSS0xXCheckWrit	db '%s (%s=0x%x): check:   WriteFile on %p size=%d',0Ah,0
					; DATA XREF: sub_63AC25A1+1C7o
; char aPth_write0xXFa[]
aPth_write0xXFa	db 'pth_write(0x%x) failed in write: %s',0Ah,0
					; DATA XREF: sub_63AC25A1+257o
		align 4
; char aSS0xXCheckNDNw[]
aSS0xXCheckNDNw	db '%s (%s=0x%x): check:            n=%d nwritten=%d',0Ah,0
					; DATA XREF: sub_63AC25A1+293o
		align 10h
; char aPth_write0xXSe[]
aPth_write0xXSe	db 'pth_write(0x%x) send failed: ec=%d',0Ah,0 ; DATA XREF: sub_63AC25A1+2CFo
; char aShow_event_rin[]
aShow_event_rin	db 'show_event_ring(%s):  No ring',0Ah,0 ; DATA XREF: sub_63AC2A83+13o
		align 4
; char aShow_event_r_0[]
aShow_event_r_0	db 'show_event_ring(%s): type=%d r=%p prev=%p next=%p',0Ah,0
					; DATA XREF: sub_63AC2A83+5Ao
aEv		db 'ev      ',0         ; DATA XREF: pth_select_ev+140o
aEv_time	db 'ev_time ',0         ; DATA XREF: pth_select_ev+153o
aEv_extra	db 'ev_extra',0         ; DATA XREF: pth_select_ev+166o
		align 4
; char aPth_release_mu[]
aPth_release_mu	db 'pth_release_mutex %p failed: %s',0Ah,0
					; DATA XREF: pth_mutex_release+65o
		align 4
; char aPth_mutex_ac_0[]
aPth_mutex_ac_0	db 'pth_mutex_acquire for %p failed: %s',0Ah,0
					; DATA XREF: pth_mutex_acquire+7Ao
		align 10h
; char aWaitforsingleo[]
aWaitforsingleo	db 'WaitForSingleObject returned unexpected code %d for mutex %p',0Ah,0
					; DATA XREF: pth_mutex_acquire+B9o
		align 10h
; char aPth_attr_setPt[]
aPth_attr_setPt	db 'pth_attr_set: PTH_ATTR_JOINABLE',0Ah,0 ; DATA XREF: pth_attr_set+73o
		align 4
; char aPth_attr_set_0[]
aPth_attr_set_0	db 'pth_attr_set: PTH_ATTR_STACK_SIZE %d',0Ah,0
					; DATA XREF: pth_attr_set+D1o
		align 4
; char aPth_attr_set_1[]
aPth_attr_set_1	db 'pth_attr_set: PTH_ATTR_NAME %s',0Ah,0 ; DATA XREF: pth_attr_set+15Do
; char aDo_pth_spawnCr[]
aDo_pth_spawnCr	db 'do_pth_spawn creating thread ...',0Ah,0 ; DATA XREF: sub_63AC351B+94o
		align 10h
; char aDo_pth_spawn_0[]
aDo_pth_spawn_0	db 'do_pth_spawn created thread %p',0Ah,0 ; DATA XREF: sub_63AC351B+FEo
; char aPth_eventSpecL[]
aPth_eventSpecL	db 'pth_event spec=%lx - not supported',0Ah,0 ; DATA XREF: sub_63AC392F+25o
; char aPth_eventSpe_0[]
aPth_eventSpe_0	db 'pth_event spec=%lx',0Ah,0 ; DATA XREF: sub_63AC392F+54o
; char aPth_eventSigsR[]
aPth_eventSigsR	db 'pth_event: sigs rc=%d',0Ah,0 ; DATA XREF: sub_63AC392F+1A8o
; char aPth_eventFd0xX[]
aPth_eventFd0xX	db 'pth_event: fd=0x%x',0Ah,0 ; DATA XREF: sub_63AC392F+21Bo
		align 4
; char aPth_eventWsaev[]
aPth_eventWsaev	db 'pth_event: WSAEventSelect(%d[%d]) failed: %s',0Ah,0
					; DATA XREF: sub_63AC392F+40Ao
aDo_pth_wait	db 'do_pth_wait',0      ; DATA XREF: sub_63AC4154+11o
aEv_0		db 'ev',0               ; DATA XREF: sub_63AC4154+18o
; char aSS0xXCheckCntL[]
aSS0xXCheckCntL	db '%s (%s=0x%x): check: cnt %lu',0Ah,0 ; DATA XREF: sub_63AC4154+104o
		align 10h
; char aSS0xXCheckAddS[]
aSS0xXCheckAddS	db '%s (%s=0x%x): check: add signal event',0Ah,0
					; DATA XREF: sub_63AC4154+1A4o
		align 4
; char aCanTSetEventFo[]
aCanTSetEventFo	db 'can',27h,'t set event for FD 0x%x (ignored)',0Ah,0
					; DATA XREF: sub_63AC4154+262o
		align 10h
; char aSS0xXCheckSock[]
aSS0xXCheckSock	db '%s (%s=0x%x): check: socket event for FD 0x%x is %p',0Ah,0
					; DATA XREF: sub_63AC4154+29Eo
		align 4
; char aNoReaderForFd0[]
aNoReaderForFd0	db 'no reader for FD 0x%x (ignored)',0Ah,0 ; DATA XREF: sub_63AC4154+30Fo
		align 4
; char aSS0xXCheckRe_1[]
aSS0xXCheckRe_1	db '%s (%s=0x%x): check: reader for FD 0x%x is %p',0Ah,0
					; DATA XREF: sub_63AC4154+34Bo
		align 4
; char aNoWriterForFd0[]
aNoWriterForFd0	db 'no writer for FD 0x%x (ignored)',0Ah,0 ; DATA XREF: sub_63AC4154+3A9o
		align 10h
; char aSS0xXCheckWr_0[]
aSS0xXCheckWr_0	db '%s (%s=0x%x): check: writer for FD 0x%x is %p',0Ah,0
					; DATA XREF: sub_63AC4154+3E5o
		align 10h
; char aSS0xXCheckAddi[]
aSS0xXCheckAddi	db '%s (%s=0x%x): check: adding timer event',0Ah,0
					; DATA XREF: sub_63AC4154+430o
		align 4
; char aSS0xXCheckAd_0[]
aSS0xXCheckAd_0	db '%s (%s=0x%x): check: adding select event',0Ah,0
					; DATA XREF: sub_63AC4154+50Eo
		align 4
; char aSS0xXCheckAd_1[]
aSS0xXCheckAd_1	db '%s (%s=0x%x): check: adding handle event',0Ah,0
					; DATA XREF: sub_63AC4154+55Co
		align 4
; char aPth_waitIgnori[]
aPth_waitIgnori	db 'pth_wait: ignoring mutex event.',0Ah,0 ; DATA XREF: sub_63AC4154+59Bo
		align 4
; char aPth_waitUnhand[]
aPth_waitUnhand	db 'pth_wait: unhandled event type 0x%x.',0Ah,0
					; DATA XREF: sub_63AC4154+5C4o
		align 10h
; char aSS0xXCheckDump[]
aSS0xXCheckDump	db '%s (%s=0x%x): check: dump list',0Ah,0 ; DATA XREF: sub_63AC4154+60Ao
; char aSS0xXCheckWfmo[]
aSS0xXCheckWfmo	db '%s (%s=0x%x): check: WFMO n=%d',0Ah,0 ; DATA XREF: sub_63AC4154+639o
; char aSS0xXCheckDP[]
aSS0xXCheckDP	db '%s (%s=0x%x): check:       %d=%p',0Ah,0 ; DATA XREF: sub_63AC4154+67Fo
		align 4
; char aSS0xXCheckNowW[]
aSS0xXCheckNowW	db '%s (%s=0x%x): check: now wait',0Ah,0 ; DATA XREF: sub_63AC4154+6B3o
		align 4
; char aSS0xXCheckWf_0[]
aSS0xXCheckWf_0	db '%s (%s=0x%x): check: WFMO returned %ld',0Ah,0
					; DATA XREF: sub_63AC4154+70Fo
; char aSS0xXCheckSett[]
aSS0xXCheckSett	db '%s (%s=0x%x): check: setting %d ev=%p',0Ah,0
					; DATA XREF: sub_63AC4154+78Co
		align 4
; char aPth_waitWsaenu[]
aPth_waitWsaenu	db 'pth_wait: WSAEnumNetworkEvents(%d[%d]) failed: %s',0Ah,0
					; DATA XREF: sub_63AC4154+917o
		align 4
; char aPth_waitWsaeve[]
aPth_waitWsaeve	db 'pth_wait: WSAEventSelect(%d[%d]-clear) failed: %s',0Ah,0
					; DATA XREF: sub_63AC4154+B4Fo
		align 4
; char aPth_waitIoctls[]
aPth_waitIoctls	db 'pth_wait: ioctlsocket(%d[%d]) failed: %s',0Ah,0
					; DATA XREF: sub_63AC4154+BD3o
aPth_yield	db 'pth_yield',0        ; DATA XREF: pth_yield:loc_63AC50D3o
					; pth_yield+31o
aPth_usleep	db 'pth_usleep',0       ; DATA XREF: pth_usleep:loc_63AC5014o
					; pth_usleep+26o ...
aPth_sleep	db 'pth_sleep',0        ; DATA XREF: pth_sleep:loc_63AC4F5Fo
					; pth_sleep+26o ...
aPth_wait	db 'pth_wait',0         ; DATA XREF: pth_wait:loc_63AC4F20o
					; pth_wait+2Eo
aPth_event_free	db 'pth_event_free',0   ; DATA XREF: pth_event_free:loc_63AC4088o
					; pth_event_free+35o
aPth_event_stat	db 'pth_event_status',0 ; DATA XREF: pth_event_status:loc_63AC3F1Ao
					; pth_event_status+43o
aLaunch_thread	db 'launch_thread',0    ; DATA XREF: StartAddress+12o
					; StartAddress+79o
aPth_event	db 'pth_event',0        ; DATA XREF: pth_event:loc_63AC3D9Eo
					; pth_event+3Do
aPth_waitpid	db 'pth_waitpid',0      ; DATA XREF: pth_waitpid:loc_63AC3843o
					; pth_waitpid+3Co
aPth_exit	db 'pth_exit',0         ; DATA XREF: pth_exit:loc_63AC37FDo
					; pth_exit+25o
aPth_abort	db 'pth_abort',0        ; DATA XREF: pth_abort:loc_63AC3794o
					; pth_abort:loc_63AC37C3o
aPth_cancel	db 'pth_cancel',0       ; DATA XREF: pth_cancel:loc_63AC36FFo
					; pth_cancel:loc_63AC3746o
aPth_spawn	db 'pth_spawn',0        ; DATA XREF: pth_spawn:loc_63AC3676o
					; pth_spawn+49o
aPth_mutex_dest	db 'pth_mutex_destroy',0 ; DATA XREF: pth_mutex_destroy:loc_63AC32A0o
					; pth_mutex_destroy+32o
aPth_mutex_init	db 'pth_mutex_init',0   ; DATA XREF: pth_mutex_init:loc_63AC3200o
					; pth_mutex_init+7Ao ...
aPth_mutex_acqu	db 'pth_mutex_acquire',0 ; DATA XREF: pth_mutex_acquire:loc_63AC311Do
					; pth_mutex_acquire:loc_63AC31DBo
aPth_mutex_rele	db 'pth_mutex_release',0 ; DATA XREF: pth_mutex_release:loc_63AC3083o
					; pth_mutex_release:loc_63AC30F5o
aPth_connect	db 'pth_connect',0      ; DATA XREF: pth_connect:loc_63AC302Eo
					; pth_connect+41o
aPth_accept_ev	db 'pth_accept_ev',0    ; DATA XREF: pth_accept_ev:loc_63AC2E82o
					; pth_accept_ev+3Co ...
aPth_accept	db 'pth_accept',0       ; DATA XREF: pth_accept:loc_63AC2E30o
					; pth_accept+41o
aPth_select_ev	db 'pth_select_ev',0    ; DATA XREF: pth_select_ev:loc_63AC2B1Eo
					; pth_select_ev+5Fo ...
aPth_write	db 'pth_write',0        ; DATA XREF: pth_write:loc_63AC2A4Ao
					; pth_write+3Co
aPth_write_ev	db 'pth_write_ev',0     ; DATA XREF: pth_write_ev:loc_63AC2932o
					; pth_write_ev+4Bo ...
aPth_read	db 'pth_read',0         ; DATA XREF: pth_read:loc_63AC2568o
					; pth_read+3Co
aPth_read_ev	db 'pth_read_ev',0      ; DATA XREF: pth_read_ev:loc_63AC2455o
					; pth_read_ev+4Bo ...
aPth_leave	db 'pth_leave',0        ; DATA XREF: pth_leave+6o
aPth_enter	db 'pth_enter',0        ; DATA XREF: pth_enter+58o
aSet_timer	db 'set_timer',0        ; DATA XREF: sub_63AC1A61+B9o
; char Format[]
Format		db 'sema.c: %s',0Ah,0   ; DATA XREF: sub_63AC5118+6o
aOutOfCoreWhile	db 'out of core while creating critical section lock',0
					; DATA XREF: sub_63AC5144+88o
aDebug_lock	db 'debug_lock',0       ; DATA XREF: .data:off_63ACA010o
; char a05luLu_LuW32pt[]
a05luLu_LuW32pt	db '%05lu/%lu.%lu/w32pth: ',0 ; DATA XREF: sub_63AC52BE+75o
aReader_table_l	db 'reader_table_lock',0 ; DATA XREF: .data:off_63ACA01Co
aWriter_table_l	db 'writer_table_lock',0 ; DATA XREF: .data:off_63ACA028o
aHd		db 'hd',0               ; DATA XREF: sub_63AC53FB+64o
aPthSet_synchro	db 'pth:set_synchronize',0 ; DATA XREF: sub_63AC53FB+6Co
		align 4
; char aSS0xXCallDupli[]
aSS0xXCallDupli	db '%s (%s=0x%x): call: DuplicateHandle failed: ec=%d',0Ah,0
					; DATA XREF: sub_63AC53FB+74o
aPthReader	db 'pth:reader',0       ; DATA XREF: sub_63AC5507+14o
aCtxFile_hd	db 'ctx->file_hd',0     ; DATA XREF: sub_63AC5507+1Bo
					; sub_63AC5EF1+88o ...
		align 4
; char aSS0xXEnterThre[]
aSS0xXEnterThre	db '%s (%s=0x%x): enter: thread=%p',0Ah,0 ; DATA XREF: sub_63AC5507+49o
					; sub_63AC67D6+49o
; char aSS0xXCheckRese[]
aSS0xXCheckRese	db '%s (%s=0x%x): check: ResetEvent failed: ec=%d',0Ah,0
					; DATA XREF: sub_63AC5507+D0o
					; sub_63AC6267+3C2o ...
		align 4
; char aSS0xXCheckWait[]
aSS0xXCheckWait	db '%s (%s=0x%x): check: waiting for space',0Ah,0
					; DATA XREF: sub_63AC5507+106o
; char aSS0xXCheckGotS[]
aSS0xXCheckGotS	db '%s (%s=0x%x): check: got space',0Ah,0 ; DATA XREF: sub_63AC5507+149o
aReceiving	db 'receiving',0        ; DATA XREF: sub_63AC5507+1E6o
aReading	db 'reading',0          ; DATA XREF: sub_63AC5507:loc_63AC56F4o
					; pth_pipe+29o
		align 10h
; char aSS0xXCheckSDBy[]
aSS0xXCheckSDBy	db '%s (%s=0x%x): check: %s %d bytes',0Ah,0 ; DATA XREF: sub_63AC5507+212o
					; sub_63AC67D6+220o
		align 4
; char aSS0xXCheckGotE[]
aSS0xXCheckGotE	db '%s (%s=0x%x): check: got EOF (broken connection)',0Ah,0
					; DATA XREF: sub_63AC5507+2A7o
		align 4
; char aSS0xXCheckRe_2[]
aSS0xXCheckRe_2	db '%s (%s=0x%x): check: recv error: ec=%d',0Ah,0
					; DATA XREF: sub_63AC5507+2E8o
; char aSS0xXCheckGo_0[]
aSS0xXCheckGo_0	db '%s (%s=0x%x): check: got EOF (broken pipe)',0Ah,0
					; DATA XREF: sub_63AC5507+387o
; char aSS0xXCheckRe_3[]
aSS0xXCheckRe_3	db '%s (%s=0x%x): check: read error: ec=%d',0Ah,0
					; DATA XREF: sub_63AC5507+3C8o
; char aSS0xXCheckGo_1[]
aSS0xXCheckGo_1	db '%s (%s=0x%x): check: got eof',0Ah,0 ; DATA XREF: sub_63AC5507+406o
		align 4
; char aSS0xXCheckGotU[]
aSS0xXCheckGotU	db '%s (%s=0x%x): check: got %u bytes',0Ah,0 ; DATA XREF: sub_63AC5507+43Ao
		align 4
; char aSS0xXCheckSete[]
aSS0xXCheckSete	db '%s (%s=0x%x): check: SetEvent failed: ec=%d',0Ah,0
					; DATA XREF: sub_63AC5507+4C5o
					; sub_63AC5507+522o ...
; char aSS0xXLeave[]
aSS0xXLeave	db '%s (%s=0x%x): leave',0Ah,0 ; DATA XREF: sub_63AC5507+55Do
					; sub_63AC5A83+456o ...
aPthCreate_read	db 'pth:create_reader',0 ; DATA XREF: sub_63AC5A83+Do
aFd_0		db 'fd',0               ; DATA XREF: sub_63AC5A83+14o
					; sub_63AC6267+14o ...
; char aSS0xXEnter_0[]
aSS0xXEnter_0	db '%s (%s=0x%x): enter',0Ah,0 ; DATA XREF: sub_63AC5A83+36o
					; sub_63AC6C1D+36o ...
; char aSS0xXLeaveRe_0[]
aSS0xXLeaveRe_0	db '%s (%s=0x%x): leave: result=%i',0Ah,0 ; DATA XREF: sub_63AC5A83+BEo
					; sub_63AC6267+EDo ...
; char aSS0xXErrorS_0[]
aSS0xXErrorS_0	db '%s (%s=0x%x): error: %s',0Ah,0 ; DATA XREF: sub_63AC5A83+104o
					; sub_63AC5A83+2B4o ...
		align 10h
; char aSS0xXCheckCrea[]
aSS0xXCheckCrea	db '%s (%s=0x%x): check: CreateEvent failed: ec=%d',0Ah,0
					; DATA XREF: sub_63AC5A83+21Ao
					; sub_63AC6C1D+21Ao
aCtxMutex	db 'ctx->mutex',0       ; DATA XREF: sub_63AC5A83+2E8o
					; sub_63AC6C1D+2E8o
		align 4
; char aSS0xXCheckCr_0[]
aSS0xXCheckCr_0	db '%s (%s=0x%x): check: CreateThread failed: ec=%d',0Ah,0
					; DATA XREF: sub_63AC5A83+363o
					; sub_63AC6C1D+363o
aPthDestroy_rea	db 'pth:destroy_reader',0 ; DATA XREF: sub_63AC5EF1+90o
					; sub_63AC5EF1+E2o
; char aSS0xXCallWaiti[]
aSS0xXCallWaiti	db '%s (%s=0x%x): call: waiting for termination of thread %p',0Ah,0
					; DATA XREF: sub_63AC5EF1+98o
					; sub_63AC708B+98o
		align 4
; char aSS0xXCallThrea[]
aSS0xXCallThrea	db '%s (%s=0x%x): call: thread %p has terminated',0Ah,0
					; DATA XREF: sub_63AC5EF1+EAo
					; sub_63AC708B+EAo
a_pth_io_read	db '_pth_io_read',0     ; DATA XREF: sub_63AC6267+Do
		align 4
; char aSS0xXEnterBuff[]
aSS0xXEnterBuff	db '%s (%s=0x%x): enter: buffer=%p, count=%u',0Ah,0
					; DATA XREF: sub_63AC6267+44o
					; sub_63AC7401+44o
		align 4
; char aSS0xXCheckWa_0[]
aSS0xXCheckWa_0	db '%s (%s=0x%x): check: waiting for data from thread %p',0Ah,0
					; DATA XREF: sub_63AC6267+167o
		align 4
; char aSS0xXCheckData[]
aSS0xXCheckData	db '%s (%s=0x%x): check: data from thread %p available',0Ah,0
					; DATA XREF: sub_63AC6267+1B4o
; char aSS0xXCheckEofB[]
aSS0xXCheckEofB	db '%s (%s=0x%x): check: EOF but ctx->eof flag not set',0Ah,0
					; DATA XREF: sub_63AC6267+26Eo
aPthWriter	db 'pth:writer',0       ; DATA XREF: sub_63AC67D6+14o
; char aSS0xXCheckIdle[]
aSS0xXCheckIdle	db '%s (%s=0x%x): check: idle',0Ah,0 ; DATA XREF: sub_63AC67D6+15Co
		align 4
; char aSS0xXCheckGotD[]
aSS0xXCheckGotD	db '%s (%s=0x%x): check: got data to send',0Ah,0
					; DATA XREF: sub_63AC67D6+19Fo
aSending	db 'sending',0          ; DATA XREF: sub_63AC67D6+1F7o
aWriting	db 'writing',0          ; DATA XREF: sub_63AC67D6:loc_63AC69D4o
					; pth_pipe:loc_63AC7996o
		align 4
; char aSS0xXCheckSe_1[]
aSS0xXCheckSe_1	db '%s (%s=0x%x): check: send error: ec=%d',0Ah,0
					; DATA XREF: sub_63AC67D6+2ACo
; char aSS0xXCheckWr_1[]
aSS0xXCheckWr_1	db '%s (%s=0x%x): check: write error: ec=%d',0Ah,0
					; DATA XREF: sub_63AC67D6+340o
		align 4
; char aSS0xXCheckWrot[]
aSS0xXCheckWrot	db '%s (%s=0x%x): check: wrote %d bytes',0Ah,0
					; DATA XREF: sub_63AC67D6+371o
aPthCreate_writ	db 'pth:create_writer',0 ; DATA XREF: sub_63AC6C1D+Do
aPthDestroy_wri	db 'pth:destroy_writer',0 ; DATA XREF: sub_63AC708B+90o
					; sub_63AC708B+E2o
a_pth_io_write	db '_pth_io_write',0    ; DATA XREF: sub_63AC7401+Do
; char aSS0xXCheckWa_1[]
aSS0xXCheckWa_1	db '%s (%s=0x%x): check: waiting for empty buffer in thread %p',0Ah,0
					; DATA XREF: sub_63AC7401+200o
; char aSS0xXCheckThre[]
aSS0xXCheckThre	db '%s (%s=0x%x): check: thread %p buffer is empty',0Ah,0
					; DATA XREF: sub_63AC7401+24Do
; char a__W32pth2_0_5W[]
a__W32pth2_0_5W	db '../w32pth-2.0.5/w32-io.c',0 ; DATA XREF: sub_63AC7401+306o
; char aCtxNbytes[]
aCtxNbytes	db '!ctx->nbytes',0     ; DATA XREF: sub_63AC7401+30Eo
a_pth_pipe	db '_pth_pipe',0        ; DATA XREF: pth_pipe+Fo
aFiledes	db 'filedes',0          ; DATA XREF: pth_pipe+16o
; char aSS0xXEnterInhe[]
aSS0xXEnterInhe	db '%s (%s=0x%x): enter: inherit_idx=%i (used for %s)',0Ah,0
					; DATA XREF: pth_pipe+55o
		align 4
; char aSS0xXCheckCr_1[]
aSS0xXCheckCr_1	db '%s (%s=0x%x): check: CreatePipe failed: ec=%d',0Ah,0
					; DATA XREF: pth_pipe+D6o
		align 4
; char aSS0xXCheckDupl[]
aSS0xXCheckDupl	db '%s (%s=0x%x): check: DuplicateHandle failed: ec=%d',0Ah,0
					; DATA XREF: pth_pipe+1B5o
					; pth_pipe+2E2o
; char aSS0xXLeaveRead[]
aSS0xXLeaveRead	db '%s (%s=0x%x): leave: read=%p, write=%p',0Ah,0 ; DATA XREF: pth_pipe+3C6o
aPth_close	db 'pth_close',0        ; DATA XREF: pth_close+Do
		align 10h
; char aSS0xXCheckClos[]
aSS0xXCheckClos	db '%s (%s=0x%x): check: CloseHandle failed: ec=%d',0Ah,0
					; DATA XREF: pth_close+F0o
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_63ACC40C	dd offset TlsCallback_0	; DATA XREF: sub_63AC1040:loc_63AC114Ar
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_63AC8220+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_63AC8280+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_63AC8280+1F9o
					; sub_63AC8280+225o ...
		align 10h
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_63AC8280+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_63AC84C0+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_63AC84C0+1B7o
		align 4
off_63ACC508	dd offset dword_63ACD740 ; DATA	XREF: .text:63AC8938o
		dd offset dword_63ACD460
aMsvcrt_dll:				; DATA XREF: .text:loc_63AC8F50o
		unicode	0, <msvcrt.dll>,0
		align 4
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_63AC9010+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS[]
aS		db '%s',0Ah,0           ; DATA XREF: sub_63AC9010+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_63AC9010+10Fo
		align 4
dword_63ACC588	dd 0			; DATA XREF: sub_63AC84C0+59o
					; sub_63AC84C0+5Eo ...
dword_63ACC58C	dd 0			; DATA XREF: sub_63AC84C0+7Fr
dword_63ACC590	dd 0			; DATA XREF: sub_63AC84C0:loc_63AC860Cr
dword_63ACC594	dd 1Bh dup(0)		; DATA XREF: sub_63AC84C0+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 0000D000)
; Virtual size			: 000007FC (   2044.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 63ACD000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_63ACD000	dd ?			; DATA XREF: sub_63AC1040+Dr
					; sub_63AC1040+22w ...
dword_63ACD004	dd ?			; DATA XREF: pth_init+Ar
					; pth_init:loc_63AC1D80w ...
dword_63ACD008	dd ?			; DATA XREF: pth_init:loc_63AC1D30w
					; pth_kill+6w ...
; HANDLE hObject
hObject		dd ?			; DATA XREF: pth_init+1ECr
					; pth_init+1F5r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: pth_init+1DBo
					; pth_init+235o ...
dword_63ACD028	dd ?			; DATA XREF: pth_enter:loc_63AC1EC0r
					; pth_enter:loc_63AC1EF7r ...
dword_63ACD02C	dd ?			; DATA XREF: pth_init+22Bw
					; pth_ctrl:loc_63AC1FE6r ...
		align 20h
dword_63ACD040	dd 78h dup(?)		; DATA XREF: sub_63AC6074+2Eo
					; sub_63AC6074+45o ...
dword_63ACD220	dd 78h dup(?)		; DATA XREF: sub_63AC720E+2Eo
					; sub_63AC720E+45o ...
dword_63ACD400	dd ?			; DATA XREF: sub_63AC5144+6r
					; sub_63AC5144+20w
; struct _RTL_CRITICAL_SECTION stru_63ACD404
stru_63ACD404	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_63AC5144+Fo
					; sub_63AC5144+34o ...
		dd 4 dup(?)
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_63ACD434	dd ?			; DATA XREF: DllEntryPoint+7w
					; sub_63AC9010+FAr
dword_63ACD438	dd ?			; DATA XREF: sub_63AC84C0+9r
					; sub_63AC84C0:loc_63AC84E0w
dword_63ACD43C	dd ?			; DATA XREF: sub_63AC8280+1Dr
					; sub_63AC8280+58r ...
dword_63ACD440	dd ?			; DATA XREF: sub_63AC8280+Br
					; sub_63AC8280:loc_63AC833Fw ...
dword_63ACD444	dd ?			; DATA XREF: sub_63AC87F0r
					; sub_63AC87F0:loc_63AC8800w
		align 20h
dword_63ACD460	dd 2Bh dup(?)		; DATA XREF: .rdata:63ACC50Co
dword_63ACD50C	dd ?			; DATA XREF: .text:63AC891Aw
		dd 2 dup(?)
dword_63ACD518	dd ?			; DATA XREF: .text:63AC8906w
		dd 2 dup(?)
dword_63ACD524	dd ?			; DATA XREF: .text:63AC88ECw
		dd 86h dup(?)
dword_63ACD740	dd ?			; DATA XREF: .text:63AC88F2w
					; .rdata:off_63ACC508o
dword_63ACD744	dd ?			; DATA XREF: .text:63AC88FCw
		dd ?
dword_63ACD74C	dd ?			; DATA XREF: .text:63AC890Bw
		dd 14h dup(?)
dword_63ACD7A0	dd ?			; DATA XREF: .text:63AC89E3r
					; .text:63AC8A74r ...
; struct _RTL_CRITICAL_SECTION stru_63ACD7A4
stru_63ACD7A4	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_63AC8970+7o
					; sub_63AC8970:loc_63AC89C5o ...
dword_63ACD7BC	dd ?			; DATA XREF: sub_63AC8970+14r
					; .text:63AC8A38r ...
		dd ?
dword_63ACD7C4	dd ?			; DATA XREF: .text:63AC8EB4r
					; .text:63AC8F42w ...
; FILE *File
File		dd ?			; DATA XREF: pth_init+131w
					; pth_init+136r ...
; char dword_63ACD7CC[]
dword_63ACD7CC	dd ?			; DATA XREF: sub_63AC16F9:loc_63AC1769r
					; sub_63AC17A9+67r ...
dword_63ACD7D0	dd ?			; DATA XREF: sub_63AC1000+21w
					; sub_63AC1040+156r ...
dword_63ACD7D4	dd ?			; DATA XREF: sub_63AC1000+1Cw
					; sub_63AC1040:loc_63AC1183r ...
dword_63ACD7D8	dd ?			; DATA XREF: sub_63AC1040+4Co
					; sub_63AC1040+C1o ...
dword_63ACD7DC	dd ?			; DATA XREF: sub_63AC1040+5Fr
					; sub_63AC1040:loc_63AC1116r ...
dword_63ACD7E0	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_63AC8163w ...
dword_63ACD7E4	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_63ACD7E8	dd ?			; DATA XREF: TlsCallback_0:loc_63AC80B4w
		align 1000h
_bss		ends

;
; Imports from KERNEL32.dll
;
; Section 6. (virtual address 0000F000)
; Virtual size			: 00000AB0 (   2736.)
; Section size in file		: 00000C00 (   3072.)
; Offset to raw	data for section: 0000A600
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_63AC17A9+13Cp
					; sub_63AC17A9+153p ...
; HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState,	LPCSTR lpName)
		extrn CreateEventA:dword ; CODE	XREF: sub_63AC17A9+59p
					; sub_63AC5A83+15Dp ...
; HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName)
		extrn CreateMutexA:dword ; CODE	XREF: pth_mutex_init+67p
					; DATA XREF: pth_mutex_init+62r
; BOOL __stdcall CreatePipe(PHANDLE hReadPipe, PHANDLE hWritePipe, LPSECURITY_ATTRIBUTES lpPipeAttributes, DWORD nSize)
		extrn CreatePipe:dword	; CODE XREF: sub_63AC7939+26p
					; DATA XREF: sub_63AC7939+21r
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
		extrn CreateThread:dword ; CODE	XREF: sub_63AC351B+DCp
					; sub_63AC5A83+32Ap ...
; HANDLE __stdcall CreateWaitableTimerA(LPSECURITY_ATTRIBUTES lpTimerAttributes, BOOL bManualReset, LPCSTR lpTimerName)
		extrn CreateWaitableTimerA:dword ; CODE	XREF: sub_63AC19B2+4Dp
					; DATA XREF: sub_63AC19B2+48r
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: pth_kill+4Ap
					; sub_63AC527B+24p ...
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: sub_63AC17A9+EAp
					; sub_63AC53FB+49p ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: pth_init+241p
					; sub_63AC1E61+12p ...
; void __stdcall __noreturn ExitThread(DWORD dwExitCode)
		extrn ExitThread:dword	; CODE XREF: StartAddress+9Cp
					; DATA XREF: StartAddress+97r
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_63AC1526+49p
					; sub_63AC1579+49p
					; DATA XREF: ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_63AC17A9+ADp
					; sub_63AC17A9+B6p ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_63AC52BE+45p
					; sub_63AC8810+6Cp
					; DATA XREF: ...
; HANDLE __stdcall GetCurrentThread()
		extrn GetCurrentThread:dword ; CODE XREF: pth_self+Bp
					; DATA XREF: pth_self+6r
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: pth_thread_id+Bp
					; sub_63AC52BE+3Cp ...
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: sub_63AC204C+11p
					; sub_63AC54AE+11p
					; DATA XREF: ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_63AC1526+11p
					; sub_63AC19B2+69p ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_63AC9010+C2p
					; DATA XREF: sub_63AC9010+C2r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_63AC1460+16p
					; .text:63AC8F37p
					; DATA XREF: ...
; BOOL __stdcall GetNamedPipeInfo(HANDLE hNamedPipe, LPDWORD lpFlags, LPDWORD lpOutBufferSize, LPDWORD lpInBufferSize, LPDWORD lpMaxInstances)
		extrn GetNamedPipeInfo:dword ; CODE XREF: sub_63AC204C+42p
					; sub_63AC54AE+42p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_63AC1460+33p
					; TlsCallback_0+7Cp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_63AC8810+57p
					; DATA XREF: sub_63AC8810+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_63AC52BE+4Ep
					; sub_63AC8810+7Cp
					; DATA XREF: ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: pth_init+1E7p
					; sub_63AC5144+1Bp ...
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_63AC1E16+44p
					; sub_63AC5144+5Bp ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: TlsCallback_0+55p
					; DATA XREF: TlsCallback_0+55r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: .text:63AC8F57p
					; DATA XREF: .text:63AC8F57r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_63AC8810+8Bp
					; DATA XREF: sub_63AC8810+8Br
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: sub_63AC20AF+209p
					; sub_63AC5507+341p
					; DATA XREF: ...
; BOOL __stdcall ReleaseMutex(HANDLE hMutex)
		extrn ReleaseMutex:dword ; CODE	XREF: pth_mutex_release+30p
					; DATA XREF: pth_mutex_release+2Br
; BOOL __stdcall ResetEvent(HANDLE hEvent)
		extrn ResetEvent:dword	; CODE XREF: sub_63AC192E+14p
					; sub_63AC5507+A7p ...
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword ; CODE	XREF: sub_63AC351B+130p
					; DATA XREF: sub_63AC351B+12Br
; BOOL __stdcall SetEvent(HANDLE hEvent)
		extrn SetEvent:dword	; CODE XREF: sub_63AC5507+49Cp
					; sub_63AC5507+4F9p ...
; BOOL __stdcall SetThreadPriority(HANDLE hThread, int nPriority)
		extrn SetThreadPriority:dword ;	CODE XREF: sub_63AC5A83+43Cp
					; sub_63AC6C1D+43Cp
					; DATA XREF: ...
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: .text:63AC892Fp
					; DATA XREF: .text:63AC892Fr
; BOOL __stdcall SetWaitableTimer(HANDLE hTimer, const LARGE_INTEGER *lpDueTime, LONG lPeriod, PTIMERAPCROUTINE	pfnCompletionRoutine, LPVOID lpArgToCompletionRoutine, BOOL fResume)
		extrn SetWaitableTimer:dword ; CODE XREF: sub_63AC1A61+8Dp
					; DATA XREF: sub_63AC1A61+88r
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_63AC1040+37p
					; sub_63AC1040+B0p ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:63AC8959p
					; DATA XREF: .text:63AC8959r
; BOOL __stdcall TerminateThread(HANDLE	hThread, DWORD dwExitCode)
		extrn TerminateThread:dword ; CODE XREF: pth_cancel+5Fp
					; pth_abort+47p
					; DATA XREF: ...
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_63AC8970+35p
					; DATA XREF: sub_63AC8970+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:63AC893Fp
					; DATA XREF: .text:63AC893Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_63AC8280+142p
					; sub_63AC8280+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_63AC8280+A1p
					; sub_63AC8280+D9p ...
; DWORD	__stdcall WaitForMultipleObjects(DWORD nCount, const HANDLE *lpHandles,	BOOL bWaitAll, DWORD dwMilliseconds)
		extrn WaitForMultipleObjects:dword ; CODE XREF:	sub_63AC4154+6EBp
					; DATA XREF: sub_63AC4154+6E6r
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: pth_mutex_acquire+38p
					; pth_cancel+47p ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_63AC25A1+202p
					; sub_63AC67D6+2FFp
					; DATA XREF: ...

;
; Imports from msvcrt.dll
;
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_63AC14C0+Bp
					; sub_63AC20AF+34Ep ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: pth_init+178r
					; pth_enter+1Dr ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_63AC7F40+A3p
					; DATA XREF: sub_63AC7F40+A3r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
		extrn __imp_raise:dword	; DATA XREF: raiser
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_63AC9010+122p
					; DATA XREF: sub_63AC9010+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSACleanup()
		extrn WSACleanup:dword	; CODE XREF: pth_kill+54p
					; DATA XREF: pth_kill:loc_63AC1DFEr
; BOOL __stdcall WSACloseEvent(HANDLE hEvent)
		extrn WSACloseEvent:dword ; CODE XREF: sub_63AC4154+C88p
					; DATA XREF: sub_63AC4154+C83r
; HANDLE __stdcall WSACreateEvent()
		extrn WSACreateEvent:dword ; CODE XREF:	sub_63AC4154+203p
					; DATA XREF: sub_63AC4154+1FEr
; int __stdcall	WSAEnumNetworkEvents(SOCKET s, HANDLE hEventObject, LPWSANETWORKEVENTS lpNetworkEvents)
		extrn WSAEnumNetworkEvents:dword ; CODE	XREF: sub_63AC4154+8D2p
					; DATA XREF: sub_63AC4154+8CDr
; int __stdcall	WSAEventSelect(SOCKET s, HANDLE	hEventObject, __int32 lNetworkEvents)
		extrn WSAEventSelect:dword ; CODE XREF:	sub_63AC392F+3C9p
					; sub_63AC4154+240p ...
; int __stdcall	WSAGetLastError()
		extrn WSAGetLastError:dword ; CODE XREF: sub_63AC1579+11p
					; sub_63AC20AF+2DAp ...
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: pth_init+1C1p
					; DATA XREF: pth_init+1BCr
; SOCKET __stdcall accept(SOCKET s, struct sockaddr *addr, int *addrlen)
		extrn accept:dword	; CODE XREF: pth_accept+39p
					; pth_accept_ev+13Ep
					; DATA XREF: ...
; int __stdcall	connect(SOCKET s, const	struct sockaddr	*name, int namelen)
		extrn connect:dword	; CODE XREF: pth_connect+39p
					; DATA XREF: pth_connect+34r
; int __stdcall	getsockopt(SOCKET s, int level,	int optname, char *optval, int *optlen)
		extrn getsockopt:dword	; CODE XREF: sub_63AC16F9+5Fp
					; DATA XREF: sub_63AC16F9+5Ar
; int __stdcall	ioctlsocket(SOCKET s, __int32 cmd, u_long *argp)
		extrn ioctlsocket:dword	; CODE XREF: sub_63AC2D83+49p
					; sub_63AC2D83+7Dp ...
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn recv:dword	; CODE XREF: sub_63AC20AF+11Ap
					; sub_63AC5507+25Ep
					; DATA XREF: ...
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn send:dword	; CODE XREF: sub_63AC25A1+11Ap
					; sub_63AC67D6+268p
					; DATA XREF: ...


; Section 7. (virtual address 00010000)
; Virtual size			: 0000002C (	 44.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000B200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 63AD0000h
dword_63AD0000	dd 0			; DATA XREF: sub_63AC1040+1FDo
dword_63AD0004	dd 0			; DATA XREF: sub_63AC1040:loc_63AC1235o
dword_63AD0008	dd 0			; DATA XREF: sub_63AC1040+1C9o
		dd offset sub_63AC1000
dword_63AD0010	dd 2 dup(0)		; DATA XREF: sub_63AC1040:loc_63AC1201o
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 8
dword_63AD0028	dd 76h dup(0)		; DATA XREF: TlsCallback_0:loc_63AC81A3o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 8. (virtual address 00011000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000B400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 63AD1000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end DllEntryPoint
