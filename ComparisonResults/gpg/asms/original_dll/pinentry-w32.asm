;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	34595AD8F1C5C2902B9CB6193D464DFD
; Input	CRC32 :	93334E1F

; File Name   :	C:\compspace\compare\gpg\dlls\original\pinentry-w32.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 0000A654 (  42580.)
; Section size in file		: 0000A800 (  43008.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00411004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_40F1DC
		mov	[esp+2Ch+var_1C], offset dword_40F018
		mov	[esp+2Ch+var_24], offset dword_40F00C
		mov	[esp+2Ch+var_28], offset dword_40F008
		mov	ds:dword_40F018, eax
		mov	eax, ds:dword_40F1E0
		mov	[esp+2Ch+var_2C], offset dword_40F004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_40F01C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00411010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_40F1EC, 1
		mov	ds:dword_40F1E8, 1
		mov	ds:dword_40F1E4, 1
		mov	ds:dword_40F1F8, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_40F014, eax
		mov	eax, ds:dword_40F1FC
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_40A090
		mov	edx, ds:dword_40F200
		mov	ds:dword_40F660, eax
		mov	ds:dword_40F664, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_40A3D0
		cmp	dword_40C334, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_40A370
		call	sub_40A360
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: start+15j	.text:004014E5j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_40B140
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_40F1FC
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_40F668
		call	sub_40B1C0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_40F66C
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_40F66C
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_40F000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_40F66C
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_40F668

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_40E4C0
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_40A680
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_40F204, eax
		call	sub_40AC30
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_40ACF0
		mov	eax, ds:dword_40F1FC
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_40F584, eax
		mov	eax, 0Ah
		mov	ds:dword_40F58C, 400000h
		cmovnz	eax, edx
		mov	ds:dword_40F588, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_40F004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_40F008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_40F008, eax
		call	sub_40AD80
		mov	eax, ds:__initenv
		mov	edx, ds:dword_40F00C
		mov	[eax], edx
		mov	eax, ds:dword_40F00C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_40F008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_40F004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_40248D
		mov	esi, ds:dword_40F014
		test	esi, esi
		mov	ds:dword_40F010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_40F000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_40F010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_40F66C
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_40F66C
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_411008
		mov	[esp+88h+dwMilliseconds], offset dword_411000
		call	_initterm
		mov	ds:dword_40F66C, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_40F66C, 1
		mov	[esp+88h+lpProcName], offset dword_411018
		mov	[esp+88h+dwMilliseconds], offset dword_41100C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_40F1FC, 1
		call	sub_40ADA0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_40F1FC, 0
		call	sub_40ADA0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_40B620+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_40C340
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_40C340
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_40B620+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401550(DWORD)
sub_401550	proc near		; CODE XREF: sub_401982+2BBp
					; sub_401D11+6Bp ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_401566
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_401566:				; CODE XREF: sub_401550+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4015AD(LPCWSTR, int, int)
sub_4015AD	proc near		; CODE XREF: sub_40226D+73p

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40160D
		mov	eax, 0
		jmp	locret_4016B7
; ---------------------------------------------------------------------------

loc_40160D:				; CODE XREF: sub_4015AD+54j
		cmp	[ebp+arg_8], 0
		jz	short loc_401623
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax
		call	sub_409978
		jmp	short loc_401631
; ---------------------------------------------------------------------------

loc_401623:				; CODE XREF: sub_4015AD+64j
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax	; Size
		call	malloc

loc_401631:				; CODE XREF: sub_4015AD+74j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_401641
		mov	eax, 0
		jmp	short locret_4016B7
; ---------------------------------------------------------------------------

loc_401641:				; CODE XREF: sub_4015AD+8Bj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_4016B4
		cmp	[ebp+arg_8], 0
		jz	short loc_4016A2
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax
		call	sub_409B9D
		jmp	short loc_4016AD
; ---------------------------------------------------------------------------

loc_4016A2:				; CODE XREF: sub_4015AD+E6j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; Memory
		call	free

loc_4016AD:				; CODE XREF: sub_4015AD+F3j
		mov	eax, 0
		jmp	short locret_4016B7
; ---------------------------------------------------------------------------

loc_4016B4:				; CODE XREF: sub_4015AD+E0j
		mov	eax, [ebp+var_10]

locret_4016B7:				; CODE XREF: sub_4015AD+5Bj
					; sub_4015AD+92j ...
		leave
		retn
sub_4015AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4016B9(LPCSTR)
sub_4016B9	proc near		; CODE XREF: sub_401C7A+3Dp

CodePage	= dword	ptr -48h
dwFlags		= dword	ptr -44h
lpMultiByteStr	= dword	ptr -40h
cbMultiByte	= dword	ptr -3Ch
lpWideCharStr	= dword	ptr -38h
cchWideChar	= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+cchWideChar], 0 ; cchWideChar
		mov	[esp+48h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+48h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+48h+dwFlags], 0 ; dwFlags
		mov	[esp+48h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_40172C
		mov	eax, 0
		jmp	loc_4017B2
; ---------------------------------------------------------------------------

loc_40172C:				; CODE XREF: sub_4016B9+67j
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+48h+dwFlags], 2 ; SizeOfElements
		mov	[esp+48h+CodePage], eax	; NumOfElements
		call	calloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_401752
		mov	eax, 0
		jmp	short loc_4017B2
; ---------------------------------------------------------------------------

loc_401752:				; CODE XREF: sub_4016B9+90j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[esp+48h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+48h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+48h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+48h+dwFlags], 0 ; dwFlags
		mov	[esp+48h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_4017A2
		mov	eax, [ebp+var_14]
		mov	[esp+48h+CodePage], eax	; Memory
		call	free
		mov	eax, 0
		jmp	short loc_4017B2
; ---------------------------------------------------------------------------

loc_4017A2:				; CODE XREF: sub_4016B9+D5j
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_14]
		mov	word ptr [eax],	0
		mov	eax, [ebp+var_14]

loc_4017B2:				; CODE XREF: sub_4016B9+6Ej
					; sub_4016B9+97j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4016B9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4017B7	proc near		; CODE XREF: DialogFunc+286p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_4017B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4017BC(HWND, HWND hWndInsertAfter)
sub_4017BC	proc near		; CODE XREF: DialogFunc+243p

hWnd		= dword	ptr -78h
lpRect		= dword	ptr -74h
X		= dword	ptr -70h
Y		= dword	ptr -6Ch
var_68		= dword	ptr -68h
cy		= dword	ptr -64h
uFlags		= dword	ptr -60h
var_54		= tagRECT ptr -54h
Rect		= tagRECT ptr -44h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
hdc		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
hWndInsertAfter	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 74h
		mov	[ebp+var_14], 5
		mov	eax, ds:GetDesktopWindow
		call	eax ; GetDesktopWindow
		mov	[ebp+var_18], eax
		lea	eax, [ebp+Rect]
		mov	[esp+78h+lpRect], eax ;	lpRect
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+hWnd],	eax ; hWnd
		mov	eax, ds:GetWindowRect
		call	eax ; GetWindowRect
		sub	esp, 8
		mov	edx, [ebp+Rect.right]
		mov	eax, [ebp+Rect.left]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		mov	edx, [ebp+Rect.bottom]
		mov	eax, [ebp+Rect.top]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_54]
		mov	[esp+78h+lpRect], eax ;	lpRect
		mov	eax, [ebp+var_18]
		mov	[esp+78h+hWnd],	eax ; hWnd
		mov	eax, ds:GetWindowRect
		call	eax ; GetWindowRect
		sub	esp, 8
		mov	edx, [ebp+var_54.right]
		mov	eax, [ebp+var_54.left]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_24], eax
		mov	edx, [ebp+var_54.bottom]
		mov	eax, [ebp+var_54.top]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+hWnd],	eax ; hWnd
		mov	eax, ds:GetDC
		call	eax ; GetDC
		sub	esp, 4
		mov	[ebp+hdc], eax
		mov	[esp+78h+lpRect], 8 ; index
		mov	eax, [ebp+hdc]
		mov	[esp+78h+hWnd],	eax ; hdc
		mov	eax, ds:GetDeviceCaps
		call	eax ; GetDeviceCaps
		sub	esp, 8
		mov	[ebp+var_30], eax
		mov	[esp+78h+lpRect], 0Ah ;	index
		mov	eax, [ebp+hdc]
		mov	[esp+78h+hWnd],	eax ; hdc
		mov	eax, ds:GetDeviceCaps
		call	eax ; GetDeviceCaps
		sub	esp, 8
		mov	[ebp+var_34], eax
		mov	eax, [ebp+hdc]
		mov	[esp+78h+lpRect], eax ;	hDC
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+hWnd],	eax ; hWnd
		mov	eax, ds:ReleaseDC
		call	eax ; ReleaseDC
		sub	esp, 8
		mov	edx, [ebp+var_54.left]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+var_24]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		mov	ecx, eax
		shr	ecx, 1Fh
		add	eax, ecx
		sar	eax, 1
		add	eax, edx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_4018CA
		mov	[ebp+var_C], 0
		jmp	short loc_4018E6
; ---------------------------------------------------------------------------

loc_4018CA:				; CODE XREF: sub_4017BC+103j
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		add	eax, edx
		cmp	eax, [ebp+var_30]
		jle	short loc_4018E6
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax

loc_4018E6:				; CODE XREF: sub_4017BC+10Cj
					; sub_4017BC+119j
		mov	edx, [ebp+var_54.top]
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+var_28]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		mov	ecx, eax
		shr	ecx, 1Fh
		add	eax, ecx
		sar	eax, 1
		add	eax, edx
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_401912
		mov	[ebp+var_10], 0
		jmp	short loc_40192E
; ---------------------------------------------------------------------------

loc_401912:				; CODE XREF: sub_4017BC+14Bj
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_10]
		add	eax, edx
		cmp	eax, [ebp+var_34]
		jle	short loc_40192E
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_34]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_10], eax

loc_40192E:				; CODE XREF: sub_4017BC+154j
					; sub_4017BC+161j
		cmp	[ebp+hWndInsertAfter], 0FFFFFFFFh
		jz	short loc_40193A
		cmp	[ebp+hWndInsertAfter], 0FFFFFFFEh
		jnz	short loc_401941

loc_40193A:				; CODE XREF: sub_4017BC+176j
		mov	[ebp+var_14], 3

loc_401941:				; CODE XREF: sub_4017BC+17Cj
		mov	eax, [ebp+var_14]
		mov	[esp+78h+uFlags], eax ;	uFlags
		mov	[esp+78h+cy], 0	; cy
		mov	[esp+78h+var_68], 0 ; cx
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Y], eax ; Y
		mov	eax, [ebp+var_C]
		mov	[esp+78h+X], eax ; X
		mov	eax, [ebp+hWndInsertAfter]
		mov	[esp+78h+lpRect], eax ;	hWndInsertAfter
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+hWnd],	eax ; hWnd
		mov	eax, ds:SetWindowPos
		call	eax ; SetWindowPos
		sub	esp, 1Ch
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_4017BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401982(HWND)
sub_401982	proc near		; CODE XREF: DialogFunc+27Bp

hWnd		= dword	ptr -0A8h
index		= dword	ptr -0A4h
cbSize		= dword	ptr -0A0h
pInputs		= tagINPUT ptr -8Ch
Rect		= tagRECT ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
hdc		= dword	ptr -10h
cInputs		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 0A0h
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+hWnd], eax ; hWnd
		mov	eax, ds:GetDC
		call	eax ; GetDC
		sub	esp, 4
		mov	[ebp+hdc], eax
		mov	[esp+0A8h+index], 8 ; index
		mov	eax, [ebp+hdc]
		mov	[esp+0A8h+hWnd], eax ; hdc
		mov	eax, ds:GetDeviceCaps
		call	eax ; GetDeviceCaps
		sub	esp, 8
		mov	[ebp+var_14], eax
		mov	[esp+0A8h+index], 0Ah ;	index
		mov	eax, [ebp+hdc]
		mov	[esp+0A8h+hWnd], eax ; hdc
		mov	eax, ds:GetDeviceCaps
		call	eax ; GetDeviceCaps
		sub	esp, 8
		mov	[ebp+var_18], eax
		mov	eax, [ebp+hdc]
		mov	[esp+0A8h+index], eax ;	hDC
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+hWnd], eax ; hWnd
		mov	eax, ds:ReleaseDC
		call	eax ; ReleaseDC
		sub	esp, 8
		cmp	[ebp+var_14], 9
		jle	loc_401C62
		cmp	[ebp+var_18], 9
		jle	loc_401C62
		lea	eax, [ebp+Rect]
		mov	[esp+0A8h+index], eax ;	lpRect
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+hWnd], eax ; hWnd
		mov	eax, ds:GetWindowRect
		call	eax ; GetWindowRect
		sub	esp, 8
		mov	eax, [ebp+Rect.left]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+Rect.bottom]
		mov	[ebp+var_20], eax
		mov	eax, 0FFFFh
		mov	edx, eax
		sar	edx, 1Fh
		idiv	[ebp+var_14]
		imul	eax, [ebp+var_1C]
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		js	loc_401C65
		cmp	[ebp+var_24], 0FFFFh
		jg	loc_401C65
		mov	eax, 0FFFFh
		mov	edx, eax
		sar	edx, 1Fh
		idiv	[ebp+var_18]
		imul	eax, [ebp+var_20]
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		js	loc_401C68
		cmp	[ebp+var_28], 0FFFFh
		jg	loc_401C68
		mov	[ebp+cInputs], 0
		jmp	short loc_401AFC
; ---------------------------------------------------------------------------

loc_401A83:				; CODE XREF: sub_401982+17Ej
		mov	eax, [ebp+cInputs]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ebp+pInputs]
		add	eax, edx
		mov	edx, 1Ch
		mov	ecx, 0
		mov	ebx, eax
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_401AB5
		mov	[eax], cl
		add	eax, 1
		sub	edx, 1

loc_401AB5:				; CODE XREF: sub_401982+129j
		mov	ebx, eax
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_401AC7
		mov	[eax], cx
		add	eax, 2
		sub	edx, 2

loc_401AC7:				; CODE XREF: sub_401982+13Aj
		mov	esi, edx
		and	esi, 0FFFFFFFCh
		mov	ebx, 0

loc_401AD1:				; CODE XREF: sub_401982+157j
		mov	[eax+ebx], ecx
		add	ebx, 4
		cmp	ebx, esi
		jb	short loc_401AD1
		add	eax, ebx
		mov	ebx, edx
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_401AEC
		mov	[eax], cx
		add	eax, 2

loc_401AEC:				; CODE XREF: sub_401982+162j
		and	edx, 1
		test	edx, edx
		jz	short loc_401AF8
		mov	[eax], cl
		add	eax, 1

loc_401AF8:				; CODE XREF: sub_401982+16Fj
		add	[ebp+cInputs], 1

loc_401AFC:				; CODE XREF: sub_401982+FFj
		cmp	[ebp+cInputs], 2
		jle	short loc_401A83
		mov	[ebp+cInputs], 0
		mov	eax, [ebp+cInputs]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ebp+var_8]
		add	eax, edx
		sub	eax, 84h
		mov	dword ptr [eax], 0
		mov	eax, [ebp+cInputs]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ebp+var_8]
		add	eax, edx
		lea	edx, [eax-80h]
		mov	eax, [ebp+var_24]
		mov	[edx], eax
		mov	eax, [ebp+cInputs]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ebp+var_8]
		add	eax, edx
		lea	edx, [eax-7Ch]
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+cInputs]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ebp+var_8]
		add	eax, edx
		sub	eax, 74h
		mov	dword ptr [eax], 8001h
		add	[ebp+cInputs], 1
		mov	eax, [ebp+cInputs]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ebp+var_8]
		add	eax, edx
		sub	eax, 84h
		mov	dword ptr [eax], 0
		mov	eax, [ebp+cInputs]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ebp+var_8]
		add	eax, edx
		sub	eax, 74h
		mov	dword ptr [eax], 2
		add	[ebp+cInputs], 1
		mov	eax, [ebp+cInputs]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ebp+var_8]
		add	eax, edx
		sub	eax, 84h
		mov	dword ptr [eax], 0
		mov	eax, [ebp+cInputs]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ebp+var_8]
		add	eax, edx
		sub	eax, 74h
		mov	dword ptr [eax], 4
		add	[ebp+cInputs], 1
		mov	eax, [ebp+cInputs]
		mov	[esp+0A8h+cbSize], 1Ch ; cbSize
		lea	edx, [ebp+pInputs]
		mov	[esp+0A8h+index], edx ;	pInputs
		mov	[esp+0A8h+hWnd], eax ; cInputs
		mov	eax, ds:SendInput
		call	eax ; SendInput
		sub	esp, 0Ch
		mov	edx, [ebp+cInputs]
		cmp	eax, edx
		jz	short loc_401C69
		mov	eax, ds:_iob
		add	eax, 40h
		test	eax, eax
		jz	short loc_401C69
		mov	[esp+0A8h+hWnd], 0FFFFFFFFh ; DWORD
		call	sub_401550
		mov	edx, offset Format ; "SendInput	failed:	%s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0A8h+cbSize], eax
		mov	[esp+0A8h+index], edx ;	Format
		mov	[esp+0A8h+hWnd], ecx ; File
		call	fprintf
		jmp	short loc_401C69
; ---------------------------------------------------------------------------

loc_401C62:				; CODE XREF: sub_401982+6Fj
					; sub_401982+79j
		nop
		jmp	short loc_401C69
; ---------------------------------------------------------------------------

loc_401C65:				; CODE XREF: sub_401982+BAj
					; sub_401982+C7j
		nop
		jmp	short loc_401C69
; ---------------------------------------------------------------------------

loc_401C68:				; CODE XREF: sub_401982+E5j
					; sub_401982+F2j
		nop

loc_401C69:				; CODE XREF: sub_401982+2A6j
					; sub_401982+2B2j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_401982	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C70	proc near		; CODE XREF: DialogFunc+11Fp
					; DialogFunc+176p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		nop
		pop	ebp
		retn
sub_401C70	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401C7A(HWND, int, LPCSTR)
sub_401C7A	proc near		; CODE XREF: DialogFunc+7Bp
					; DialogFunc+9Ap ...

hDlg		= dword	ptr -28h
nIDDlgItem	= dword	ptr -24h
lpString	= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_401C90
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401CB1

loc_401C90:				; CODE XREF: sub_401C7A+Aj
		mov	[esp+28h+lpString], offset String ; lpString
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+nIDDlgItem], eax ; nIDDlgItem
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:SetDlgItemTextW
		call	eax ; SetDlgItemTextW
		sub	esp, 0Ch
		jmp	short locret_401D0F
; ---------------------------------------------------------------------------

loc_401CB1:				; CODE XREF: sub_401C7A+14j
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+hDlg],	eax ; LPCSTR
		call	sub_4016B9
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_401CE6
		mov	[esp+28h+lpString], offset aOutOfCore ;	"[out of core]"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+nIDDlgItem], eax ; nIDDlgItem
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:SetDlgItemTextW
		call	eax ; SetDlgItemTextW
		sub	esp, 0Ch
		jmp	short locret_401D0F
; ---------------------------------------------------------------------------

loc_401CE6:				; CODE XREF: sub_401C7A+49j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+lpString], eax	; lpString
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+nIDDlgItem], eax ; nIDDlgItem
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:SetDlgItemTextW
		call	eax ; SetDlgItemTextW
		sub	esp, 0Ch
		mov	eax, [ebp+var_C]
		mov	[esp+28h+hDlg],	eax ; Memory
		call	free

locret_401D0F:				; CODE XREF: sub_401C7A+35j
					; sub_401C7A+6Aj
		leave
		retn
sub_401C7A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401D11(HWND, int)
sub_401D11	proc near		; CODE XREF: DialogFunc+C8p

hDlg		= dword	ptr -58h
nIDDlgItem	= dword	ptr -54h
type		= dword	ptr -50h
lParam		= dword	ptr -4Ch
cy		= dword	ptr -48h
fuLoad		= dword	ptr -44h
Rect		= tagRECT ptr -34h
var_24		= dword	ptr -24h
hWnd		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+nIDDlgItem], eax ; nIDDlgItem
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+hDlg],	eax ; hDlg
		mov	eax, ds:GetDlgItem
		call	eax ; GetDlgItem
		sub	esp, 8
		mov	[ebp+hWnd], eax
		cmp	[ebp+hWnd], 0
		jz	loc_401E96
		mov	[ebp+Rect.left], 0
		mov	[ebp+Rect.top],	0
		mov	[ebp+Rect.right], 20h
		mov	[ebp+Rect.bottom], 20h
		lea	eax, [ebp+Rect]
		mov	[esp+58h+nIDDlgItem], eax ; lpRect
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+hDlg],	eax ; hDlg
		mov	eax, ds:MapDialogRect
		call	eax ; MapDialogRect
		sub	esp, 8
		test	eax, eax
		jnz	short loc_401DA4
		mov	[esp+58h+hDlg],	0FFFFFFFFh ; DWORD
		call	sub_401550
		mov	edx, offset aMapdialogrectF ; "MapDialogRect failed: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+type],	eax
		mov	[esp+58h+nIDDlgItem], edx ; Format
		mov	[esp+58h+hDlg],	ecx ; File
		call	fprintf
		jmp	loc_401E97
; ---------------------------------------------------------------------------

loc_401DA4:				; CODE XREF: sub_401D11+62j
		mov	eax, [ebp+Rect.right]
		cmp	eax, 30h
		jz	short loc_401DCD
		cmp	eax, 30h
		jg	short loc_401DB8
		cmp	eax, 20h
		jz	short loc_401DC4
		jmp	short loc_401DE8
; ---------------------------------------------------------------------------

loc_401DB8:				; CODE XREF: sub_401D11+9Ej
		cmp	eax, 40h
		jz	short loc_401DD6
		cmp	eax, 60h
		jz	short loc_401DDF
		jmp	short loc_401DE8
; ---------------------------------------------------------------------------

loc_401DC4:				; CODE XREF: sub_401D11+A3j
		mov	[ebp+var_1C], 0C1Dh
		jmp	short loc_401DF0
; ---------------------------------------------------------------------------

loc_401DCD:				; CODE XREF: sub_401D11+99j
		mov	[ebp+var_1C], 0C1Eh
		jmp	short loc_401DF0
; ---------------------------------------------------------------------------

loc_401DD6:				; CODE XREF: sub_401D11+AAj
		mov	[ebp+var_1C], 0C1Fh
		jmp	short loc_401DF0
; ---------------------------------------------------------------------------

loc_401DDF:				; CODE XREF: sub_401D11+AFj
		mov	[ebp+var_1C], 0C20h
		jmp	short loc_401DF0
; ---------------------------------------------------------------------------

loc_401DE8:				; CODE XREF: sub_401D11+A5j
					; sub_401D11+B1j
		mov	[ebp+var_1C], 0C21h
		nop

loc_401DF0:				; CODE XREF: sub_401D11+BAj
					; sub_401D11+C3j ...
		mov	edi, [ebp+Rect.bottom]
		mov	esi, [ebp+Rect.right]
		mov	eax, [ebp+var_1C]
		movzx	eax, ax
		mov	ebx, eax
		mov	[esp+58h+hDlg],	0 ; lpModuleName
		mov	eax, ds:GetModuleHandleA
		call	eax ; GetModuleHandleA
		sub	esp, 4
		mov	[esp+58h+fuLoad], 9020h	; fuLoad
		mov	[esp+58h+cy], edi ; cy
		mov	[esp+58h+lParam], esi ;	cx
		mov	[esp+58h+type],	0 ; type
		mov	[esp+58h+nIDDlgItem], ebx ; name
		mov	[esp+58h+hDlg],	eax ; hInst
		mov	eax, ds:LoadImageA
		call	eax ; LoadImageA
		sub	esp, 18h
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_401E6D
		mov	[esp+58h+hDlg],	0FFFFFFFFh ; DWORD
		call	sub_401550
		mov	edx, offset aLoadimageFaile ; "LoadImage failed: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+type],	eax
		mov	[esp+58h+nIDDlgItem], edx ; Format
		mov	[esp+58h+hDlg],	ecx ; File
		call	fprintf
		jmp	short loc_401E97
; ---------------------------------------------------------------------------

loc_401E6D:				; CODE XREF: sub_401D11+12Ej
		mov	eax, [ebp+var_24]
		mov	[esp+58h+lParam], eax ;	lParam
		mov	[esp+58h+type],	0 ; wParam
		mov	[esp+58h+nIDDlgItem], 172h ; Msg
		mov	eax, [ebp+hWnd]
		mov	[esp+58h+hDlg],	eax ; hWnd
		mov	eax, ds:SendMessageA
		call	eax ; SendMessageA
		sub	esp, 10h
		jmp	short loc_401E97
; ---------------------------------------------------------------------------

loc_401E96:				; CODE XREF: sub_401D11+27j
		nop

loc_401E97:				; CODE XREF: sub_401D11+8Ej
					; sub_401D11+15Aj ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401D11	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; INT_PTR __stdcall DialogFunc(HWND, UINT, WPARAM, LPARAM)
DialogFunc	proc near		; DATA XREF: sub_4023AD+5Bo

hDlg		= dword	ptr -28h
nIDDlgItem	= dword	ptr -24h
X		= dword	ptr -20h
Y		= dword	ptr -1Ch
var_18		= dword	ptr -18h
cy		= dword	ptr -14h
uFlags		= dword	ptr -10h
var_4		= dword	ptr -4
hWnd		= dword	ptr  8
arg_4		= dword	ptr  0Ch
hdc		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		cmp	eax, 110h
		jz	short loc_401EE2
		cmp	eax, 110h
		ja	short loc_401EC7
		cmp	eax, 100h
		jz	loc_4021AE
		jmp	loc_402261
; ---------------------------------------------------------------------------

loc_401EC7:				; CODE XREF: DialogFunc+16j
		cmp	eax, 111h
		jz	loc_40212F
		cmp	eax, 138h
		jz	loc_4021FB
		jmp	loc_402261
; ---------------------------------------------------------------------------

loc_401EE2:				; CODE XREF: DialogFunc+Fj
		mov	eax, [ebp+hWnd]
		mov	ds:dword_40F024, eax
		mov	eax, [ebp+arg_C]
		mov	ds:dword_40F03C, eax
		mov	eax, ds:dword_40F03C
		test	eax, eax
		jnz	short loc_401F00
		call	abort
; ---------------------------------------------------------------------------

loc_401F00:				; CODE XREF: DialogFunc+5Aj
		mov	eax, ds:dword_40F03C
		mov	eax, [eax+0Ch]
		mov	[esp+28h+X], eax ; LPCSTR
		mov	[esp+28h+nIDDlgItem], 3EAh ; int
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_401C7A
		mov	eax, ds:dword_40F03C
		mov	eax, [eax+4]
		mov	[esp+28h+X], eax ; LPCSTR
		mov	[esp+28h+nIDDlgItem], 3E8h ; int
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_401C7A
		mov	[esp+28h+X], offset byte_40D0A8	; LPCSTR
		mov	[esp+28h+nIDDlgItem], 124h ; int
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_401C7A
		mov	[esp+28h+nIDDlgItem], 3EBh ; int
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_401D11
		mov	eax, ds:dword_40F03C
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_401FC3
		mov	eax, ds:dword_40F03C
		mov	eax, [eax+10h]
		mov	[esp+28h+X], eax ; LPCSTR
		mov	[esp+28h+nIDDlgItem], 1	; int
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_401C7A
		mov	eax, ds:dword_40F03C
		mov	ebx, [eax+10h]
		mov	[esp+28h+nIDDlgItem], 1	; nIDDlgItem
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:GetDlgItem
		call	eax ; GetDlgItem
		sub	esp, 8
		mov	[esp+28h+nIDDlgItem], ebx
		mov	[esp+28h+hDlg],	eax
		call	sub_401C70

loc_401FC3:				; CODE XREF: DialogFunc+D7j
		mov	eax, ds:dword_40F03C
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_40201A
		mov	eax, ds:dword_40F03C
		mov	eax, [eax+18h]
		mov	[esp+28h+X], eax ; LPCSTR
		mov	[esp+28h+nIDDlgItem], 2	; int
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_401C7A
		mov	eax, ds:dword_40F03C
		mov	ebx, [eax+18h]
		mov	[esp+28h+nIDDlgItem], 2	; nIDDlgItem
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:GetDlgItem
		call	eax ; GetDlgItem
		sub	esp, 8
		mov	[esp+28h+nIDDlgItem], ebx
		mov	[esp+28h+hDlg],	eax
		call	sub_401C70

loc_40201A:				; CODE XREF: DialogFunc+12Ej
		mov	eax, ds:dword_40F03C
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_402045
		mov	eax, ds:dword_40F03C
		mov	eax, [eax+8]
		mov	[esp+28h+X], eax ; LPCSTR
		mov	[esp+28h+nIDDlgItem], 3E9h ; int
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_401C7A

loc_402045:				; CODE XREF: DialogFunc+185j
		mov	eax, ds:dword_40F028
		test	eax, eax
		jz	loc_4020D4
		mov	[esp+28h+nIDDlgItem], 124h ; nIDDlgItem
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:GetDlgItem
		call	eax ; GetDlgItem
		sub	esp, 8
		mov	[esp+28h+nIDDlgItem], 0	; bEnable
		mov	[esp+28h+hDlg],	eax ; hWnd
		mov	eax, ds:EnableWindow
		call	eax ; EnableWindow
		sub	esp, 8
		mov	[esp+28h+nIDDlgItem], 124h ; nIDDlgItem
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:GetDlgItem
		call	eax ; GetDlgItem
		sub	esp, 8
		mov	[esp+28h+uFlags], 87h ;	uFlags
		mov	[esp+28h+cy], 0	; cy
		mov	[esp+28h+var_18], 0 ; cx
		mov	[esp+28h+Y], 0	; Y
		mov	[esp+28h+X], 0	; X
		mov	[esp+28h+nIDDlgItem], 0	; hWndInsertAfter
		mov	[esp+28h+hDlg],	eax ; hWnd
		mov	eax, ds:SetWindowPos
		call	eax ; SetWindowPos
		sub	esp, 1Ch

loc_4020D4:				; CODE XREF: DialogFunc+1ADj
		mov	[esp+28h+nIDDlgItem], 0	; hWndInsertAfter
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_4017BC
		mov	[esp+28h+nIDDlgItem], 5	; nCmdShow
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hWnd
		mov	eax, ds:ShowWindow
		call	eax ; ShowWindow
		sub	esp, 8
		mov	[esp+28h+nIDDlgItem], 3EAh ; nIDDlgItem
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:GetDlgItem
		call	eax ; GetDlgItem
		sub	esp, 8
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_401982
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax
		call	sub_4017B7
		jmp	loc_402261
; ---------------------------------------------------------------------------

loc_40212F:				; CODE XREF: DialogFunc+2Dj
		mov	eax, [ebp+hdc]
		movzx	eax, ax
		cmp	eax, 1
		jz	short loc_402141
		cmp	eax, 2
		jz	short loc_402184
		jmp	short loc_4021A9
; ---------------------------------------------------------------------------

loc_402141:				; CODE XREF: DialogFunc+299j
		mov	eax, ds:dword_40F028
		test	eax, eax
		jz	short loc_402156
		mov	ds:dword_40F030, 1
		jmp	short loc_40216A
; ---------------------------------------------------------------------------

loc_402156:				; CODE XREF: DialogFunc+2A9j
		mov	eax, ds:dword_40F03C
		mov	[esp+28h+nIDDlgItem], eax ; int
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_40226D

loc_40216A:				; CODE XREF: DialogFunc+2B5j
		mov	[esp+28h+nIDDlgItem], 1	; nResult
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:EndDialog
		call	eax ; EndDialog
		sub	esp, 8
		jmp	short loc_4021A9
; ---------------------------------------------------------------------------

loc_402184:				; CODE XREF: DialogFunc+29Ej
		mov	eax, ds:dword_40F03C
		mov	dword ptr [eax+50h], 0FFFFFFFFh
		mov	[esp+28h+nIDDlgItem], 0	; nResult
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:EndDialog
		call	eax ; EndDialog
		sub	esp, 8
		nop

loc_4021A9:				; CODE XREF: DialogFunc+2A0j
					; DialogFunc+2E3j
		jmp	loc_402261
; ---------------------------------------------------------------------------

loc_4021AE:				; CODE XREF: DialogFunc+1Dj
		cmp	[ebp+hdc], 0Dh
		jnz	loc_40225D
		mov	eax, ds:dword_40F028
		test	eax, eax
		jz	short loc_4021CD
		mov	ds:dword_40F030, 1
		jmp	short loc_4021E1
; ---------------------------------------------------------------------------

loc_4021CD:				; CODE XREF: DialogFunc+320j
		mov	eax, ds:dword_40F03C
		mov	[esp+28h+nIDDlgItem], eax ; int
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; HWND
		call	sub_40226D

loc_4021E1:				; CODE XREF: DialogFunc+32Cj
		mov	[esp+28h+nIDDlgItem], 1	; nResult
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:EndDialog
		call	eax ; EndDialog
		sub	esp, 8
		jmp	short loc_40225D
; ---------------------------------------------------------------------------

loc_4021FB:				; CODE XREF: DialogFunc+38j
		mov	ebx, [ebp+arg_C]
		mov	[esp+28h+nIDDlgItem], 3E9h ; nIDDlgItem
		mov	eax, [ebp+hWnd]
		mov	[esp+28h+hDlg],	eax ; hDlg
		mov	eax, ds:GetDlgItem
		call	eax ; GetDlgItem
		sub	esp, 8
		cmp	ebx, eax
		jnz	short loc_402260
		mov	eax, [ebp+hdc]
		mov	[esp+28h+nIDDlgItem], 0FFh ; color
		mov	[esp+28h+hDlg],	eax ; hdc
		mov	eax, ds:SetTextColor
		call	eax ; SetTextColor
		sub	esp, 8
		mov	eax, [ebp+hdc]
		mov	[esp+28h+nIDDlgItem], 1	; mode
		mov	[esp+28h+hDlg],	eax ; hdc
		mov	eax, ds:SetBkMode
		call	eax ; SetBkMode
		sub	esp, 8
		mov	[esp+28h+hDlg],	5 ; i
		mov	eax, ds:GetStockObject
		call	eax ; GetStockObject
		sub	esp, 4
		jmp	short loc_402266
; ---------------------------------------------------------------------------

loc_40225D:				; CODE XREF: DialogFunc+313j
					; DialogFunc+35Aj
		nop
		jmp	short loc_402261
; ---------------------------------------------------------------------------

loc_402260:				; CODE XREF: DialogFunc+379j
		nop

loc_402261:				; CODE XREF: DialogFunc+23j
					; DialogFunc+3Ej ...
		mov	eax, 0

loc_402266:				; CODE XREF: DialogFunc+3BCj
		mov	ebx, [ebp+var_4]
		leave
		retn	10h
DialogFunc	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40226D(HWND, int)
sub_40226D	proc near		; CODE XREF: DialogFunc+2C6p
					; DialogFunc+33Dp

hDlg		= dword	ptr -38h
nIDDlgItem	= dword	ptr -34h
lpString	= dword	ptr -30h
cchMax		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
Source		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	[ebp+var_C], 0FFh
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+58h], 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[esp+38h+hDlg],	eax
		call	sub_409978
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_4023A7
		mov	eax, [ebp+var_C]
		mov	[esp+38h+cchMax], eax ;	cchMax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+lpString], eax	; lpString
		mov	[esp+38h+nIDDlgItem], 124h ; nIDDlgItem
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+hDlg],	eax ; hDlg
		mov	eax, ds:GetDlgItemTextW
		call	eax ; GetDlgItemTextW
		sub	esp, 10h
		mov	[ebp+var_14], eax
		mov	[esp+38h+lpString], 1 ;	int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+nIDDlgItem], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+hDlg],	eax ; LPCWSTR
		call	sub_4015AD
		mov	[ebp+Source], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+hDlg],	eax
		call	sub_409B9D
		cmp	[ebp+Source], 0
		jz	loc_4023A8
		mov	ds:dword_40F02C, 1
		mov	eax, [ebp+Source]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+nIDDlgItem], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+hDlg],	eax
		call	sub_402BD0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_402357
		mov	edx, [ebp+Source]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+1Ch]
		mov	[esp+38h+nIDDlgItem], edx ; Source
		mov	[esp+38h+hDlg],	eax ; Dest
		call	strcpy

loc_402357:				; CODE XREF: sub_40226D+D3j
		mov	eax, [ebp+Source]
		mov	[esp+38h+hDlg],	eax
		call	sub_409B9D
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+58h], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_40239A
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		jmp	short loc_40239F
; ---------------------------------------------------------------------------

loc_40239A:				; CODE XREF: sub_40226D+107j
		mov	eax, 0

loc_40239F:				; CODE XREF: sub_40226D+12Bj
		mov	edx, [ebp+arg_4]
		mov	[edx+50h], eax
		jmp	short loc_4023A8
; ---------------------------------------------------------------------------

loc_4023A7:				; CODE XREF: sub_40226D+2Fj
		nop

loc_4023A8:				; CODE XREF: sub_40226D+8Aj
					; sub_40226D+138j
		mov	edi, [ebp+var_4]
		leave
		retn
sub_40226D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4023AD(LPARAM)
sub_4023AD	proc near		; CODE XREF: sub_4040FA+1B8p
					; sub_404459+70p
					; DATA XREF: ...

lpModuleName	= dword	ptr -48h
lpTemplateName	= dword	ptr -44h
hWndParent	= dword	ptr -40h
lpDialogFunc	= dword	ptr -3Ch
dwInitParam	= dword	ptr -38h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	ds:dword_40F028, eax
		mov	ds:dword_40F030, 0
		mov	eax, ds:dword_40F030
		mov	ds:dword_40F02C, eax
		mov	ds:dword_40F024, 0
		mov	esi, [ebp+arg_0]
		mov	eax, ds:GetDesktopWindow
		call	eax ; GetDesktopWindow
		mov	ebx, eax
		mov	[esp+48h+lpModuleName],	0 ; lpModuleName
		mov	eax, ds:GetModuleHandleA
		call	eax ; GetModuleHandleA
		sub	esp, 4
		mov	[esp+48h+dwInitParam], esi ; dwInitParam
		mov	[esp+48h+lpDialogFunc],	offset DialogFunc ; lpDialogFunc
		mov	[esp+48h+hWndParent], ebx ; hWndParent
		mov	[esp+48h+lpTemplateName], 65h ;	lpTemplateName
		mov	[esp+48h+lpModuleName],	eax ; hInstance
		mov	eax, ds:DialogBoxParamA
		call	eax ; DialogBoxParamA
		sub	esp, 14h
		mov	eax, ds:dword_40F024
		test	eax, eax
		jnz	short loc_402439
		mov	eax, 0FFFFFFFFh
		jmp	short loc_402485
; ---------------------------------------------------------------------------

loc_402439:				; CODE XREF: sub_4023AD+83j
		mov	eax, ds:dword_40F028
		test	eax, eax
		jz	short loc_402449
		mov	eax, ds:dword_40F030
		jmp	short loc_402485
; ---------------------------------------------------------------------------

loc_402449:				; CODE XREF: sub_4023AD+93j
		mov	eax, ds:dword_40F02C
		test	eax, eax
		jz	short loc_402480
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_402480
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		jmp	short loc_402485
; ---------------------------------------------------------------------------

loc_402480:				; CODE XREF: sub_4023AD+A3j
					; sub_4023AD+ADj
		mov	eax, 0FFFFFFFFh

loc_402485:				; CODE XREF: sub_4023AD+8Aj
					; sub_4023AD+9Aj ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4023AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40248D	proc near		; CODE XREF: sub_401180+265p

lpLibFileName	= dword	ptr -24h
lpProcName	= dword	ptr -20h
var_10		= dword	ptr -10h
hModule		= dword	ptr -0Ch
arg_0		= byte ptr  0Ch

		lea	ecx, [esp-8+arg_0]
		and	esp, 0FFFFFFF0h
		push	dword ptr [ecx-4]
		push	ebp
		mov	ebp, esp
		push	ebx
		push	ecx
		sub	esp, 20h
		mov	ebx, ecx
		call	sub_40AD80
		mov	ds:dword_40F034, 0
		mov	ds:dword_40F038, 1
		mov	[esp+24h+lpLibFileName], offset	aPinentryW32 ; "pinentry-w32"
		call	sub_402DF2
		mov	eax, [ebx+4]
		mov	[esp+24h+lpProcName], eax
		mov	eax, [ebx]
		mov	[esp+24h+lpLibFileName], eax
		call	sub_40318A
		mov	[esp+24h+lpLibFileName], offset	LibFileName ; "user32.dll"
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+hModule], eax
		cmp	[ebp+hModule], 0
		jz	short loc_40252C
		mov	[esp+24h+lpProcName], offset aLocksetforegro ; "LockSetForegroundWindow"
		mov	eax, [ebp+hModule]
		mov	[esp+24h+lpLibFileName], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40251C
		mov	eax, [ebp+var_10]
		mov	ds:dword_40F020, eax
		jmp	short loc_40252C
; ---------------------------------------------------------------------------

loc_40251C:				; CODE XREF: sub_40248D+83j
		mov	eax, [ebp+hModule]
		mov	[esp+24h+lpLibFileName], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_40252C:				; CODE XREF: sub_40248D+62j
					; sub_40248D+8Dj
		mov	edx, ds:dword_40F038
		mov	eax, ds:dword_40F034
		mov	[esp+24h+lpProcName], edx
		mov	[esp+24h+lpLibFileName], eax
		call	sub_404803
		test	eax, eax
		jz	short loc_40254E
		mov	eax, 1
		jmp	short loc_402553
; ---------------------------------------------------------------------------

loc_40254E:				; CODE XREF: sub_40248D+B8j
		mov	eax, 0

loc_402553:				; CODE XREF: sub_40248D+BFj
		lea	esp, [ebp-8]
		pop	ecx
		pop	ebx
		pop	ebp
		lea	esp, [ecx-4]
		retn
sub_40248D	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402560	proc near		; CODE XREF: sub_40284A+Dp
					; sub_40318A+3Ap

Memory		= dword	ptr -68h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	eax, ds:dword_40F5E4
		mov	[ebp+var_C], eax
		mov	eax, ds:Memory
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_40F5D0
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_40F5D4
		mov	[ebp+var_18], eax
		mov	eax, ds:dword_40F5D8
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_40F640
		mov	[ebp+var_20], eax
		mov	eax, ds:dword_40F630
		mov	[ebp+var_24], eax
		mov	eax, ds:dword_40F634
		mov	[ebp+var_28], eax
		mov	eax, ds:dword_40F638
		mov	[ebp+var_2C], eax
		mov	eax, ds:dword_40F63C
		mov	[ebp+var_30], eax
		mov	eax, ds:dword_40F5EC
		mov	[ebp+var_34], eax
		mov	eax, ds:dword_40F5DC
		mov	[ebp+var_38], eax
		mov	eax, ds:dword_40F5C8
		mov	[ebp+var_3C], eax
		mov	eax, ds:dword_40F5E8
		mov	[ebp+var_40], eax
		mov	eax, ds:dword_40F61C
		mov	[ebp+var_44], eax
		mov	eax, ds:dword_40F620
		mov	[ebp+var_48], eax
		mov	eax, ds:dword_40F624
		mov	[ebp+var_4C], eax
		mov	eax, ds:dword_40F628
		mov	[ebp+var_50], eax
		mov	eax, ds:dword_40F62C
		mov	[ebp+var_54], eax
		mov	eax, ds:dword_40F5E0
		mov	[ebp+var_58], eax
		cmp	[ebp+arg_0], 0
		jz	loc_402694
		mov	eax, ds:Memory
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5D0
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5D4
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5D8
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F630
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F634
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F638
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F63C
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5EC
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5C8
		mov	[esp+68h+Memory], eax ;	Memory
		call	free

loc_402694:				; CODE XREF: sub_402560+ACj
		mov	eax, ds:dword_40F5A0
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5A4
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5A8
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5AC
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5B0
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5B4
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F5B8
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:Dst
		mov	[esp+68h+Memory], eax
		call	sub_409B9D
		mov	eax, ds:dword_40F608
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F60C
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F614
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F618
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	eax, ds:dword_40F648
		mov	[esp+68h+Memory], eax ;	Memory
		call	free
		mov	ebx, offset dword_40F5A0
		mov	eax, 0
		mov	edx, 2Dh
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		cmp	[ebp+arg_0], 0
		jz	short loc_4027A3
		mov	ds:dword_40F5E0, 3Ch
		mov	ds:dword_40F5E4, 1
		mov	ds:dword_40F61C, 1
		mov	ds:dword_40F620, 0
		mov	ds:dword_40F624, 1
		mov	ds:dword_40F628, 1
		mov	ds:dword_40F62C, 0
		jmp	loc_402843
; ---------------------------------------------------------------------------

loc_4027A3:				; CODE XREF: sub_402560+1F6j
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F5E4, eax
		mov	eax, [ebp+var_10]
		mov	ds:Memory, eax
		mov	eax, [ebp+var_14]
		mov	ds:dword_40F5D0, eax
		mov	eax, [ebp+var_18]
		mov	ds:dword_40F5D4, eax
		mov	eax, [ebp+var_1C]
		mov	ds:dword_40F5D8, eax
		mov	eax, [ebp+var_20]
		mov	ds:dword_40F640, eax
		mov	eax, [ebp+var_24]
		mov	ds:dword_40F630, eax
		mov	eax, [ebp+var_28]
		mov	ds:dword_40F634, eax
		mov	eax, [ebp+var_2C]
		mov	ds:dword_40F638, eax
		mov	eax, [ebp+var_30]
		mov	ds:dword_40F63C, eax
		mov	eax, [ebp+var_34]
		mov	ds:dword_40F5EC, eax
		mov	eax, [ebp+var_38]
		mov	ds:dword_40F5DC, eax
		mov	eax, [ebp+var_3C]
		mov	ds:dword_40F5C8, eax
		mov	eax, [ebp+var_40]
		mov	ds:dword_40F5E8, eax
		mov	eax, [ebp+var_44]
		mov	ds:dword_40F61C, eax
		mov	eax, [ebp+var_48]
		mov	ds:dword_40F620, eax
		mov	eax, [ebp+var_4C]
		mov	ds:dword_40F624, eax
		mov	eax, [ebp+var_50]
		mov	ds:dword_40F628, eax
		mov	eax, [ebp+var_54]
		mov	ds:dword_40F62C, eax
		mov	eax, [ebp+var_58]
		mov	ds:dword_40F5E0, eax

loc_402843:				; CODE XREF: sub_402560+23Ej
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_402560	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40284A	proc near		; DATA XREF: sub_404803+CDo

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_402560
		leave
		retn
sub_40284A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40285E	proc near		; CODE XREF: .text:004029E5p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4028F6
; ---------------------------------------------------------------------------

loc_402879:				; CODE XREF: sub_40285E+9Ej
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_402893
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_4028C5

loc_402893:				; CODE XREF: sub_40285E+26j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x ; "%%%02X"
		mov	dword ptr [esp+28h+var_1C], edx	; char
		mov	[esp+28h+var_20], eax ;	char *
		mov	[esp+28h+var_24], 4 ; size_t
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_40B1E0
		add	[ebp+var_10], 3
		jmp	short loc_4028F2
; ---------------------------------------------------------------------------

loc_4028C5:				; CODE XREF: sub_40285E+33j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_4028DE
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	2Bh
		add	[ebp+var_10], 1
		jmp	short loc_4028F2
; ---------------------------------------------------------------------------

loc_4028DE:				; CODE XREF: sub_40285E+72j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1

loc_4028F2:				; CODE XREF: sub_40285E+65j
					; sub_40285E+7Ej
		add	[ebp+var_C], 1

loc_4028F6:				; CODE XREF: sub_40285E+19j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	loc_402879
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40285E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+8]
		mov	eax, [eax+0B0h]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-2Dh], 55514E49h
		mov	dword ptr [ebp-29h], 20455249h
		mov	dword ptr [ebp-25h], 4C415551h
		mov	dword ptr [ebp-21h], 20595449h
		mov	byte ptr [ebp-1Dh], 0
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_402958
		mov	eax, 0
		jmp	loc_402BCA
; ---------------------------------------------------------------------------

loc_402958:				; CODE XREF: .text:0040294Cj
		cmp	dword ptr [ebp+10h], 12Ch
		jbe	short loc_402968
		mov	dword ptr [ebp+10h], 12Ch

loc_402968:				; CODE XREF: .text:0040295Fj
		mov	edx, [ebp+10h]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		add	eax, 11h
		mov	[esp], eax
		call	sub_409978
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40298F
		mov	eax, 0
		jmp	loc_402BCA
; ---------------------------------------------------------------------------

loc_40298F:				; CODE XREF: .text:00402983j
		mov	eax, [ebp-18h]
		lea	edx, [ebp-2Dh]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		movzx	edx, byte ptr [edx+10h]
		mov	[eax+10h], dl
		mov	eax, [ebp-18h]
		mov	dword ptr [ebp-3Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-3Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp-18h]
		mov	edx, [ebp+10h]
		mov	[esp+8], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40285E
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_4075F2
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_409B9D
		cmp	dword ptr [ebp-1Ch], 0
		jz	short loc_402A3B
		mov	eax, offset aAssuanWriteLin ; "ASSUAN WRITE LINE failed: rc=%d\n"
		mov	edx, ds:_iob
		lea	ecx, [edx+40h]
		mov	edx, [ebp-1Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	fprintf
		mov	eax, 0
		jmp	loc_402BCA
; ---------------------------------------------------------------------------

loc_402A3B:				; CODE XREF: .text:00402A0Ej
					; .text:00402A90j ...
		lea	eax, [ebp-38h]
		mov	[esp+8], eax
		lea	eax, [ebp-34h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40758D
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0
		jz	short loc_402A88
		mov	eax, offset aAssuanReadLine ; "ASSUAN READ LINE	failed:	rc=%d\n"
		mov	edx, ds:_iob
		lea	ecx, [edx+40h]
		mov	edx, [ebp-1Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	fprintf
		mov	eax, 0
		jmp	loc_402BCA
; ---------------------------------------------------------------------------

loc_402A88:				; CODE XREF: .text:00402A5Bj
		mov	eax, [ebp-34h]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	short loc_402A3B
		mov	eax, [ebp-38h]
		test	eax, eax
		jz	short loc_402A3B
		mov	eax, [ebp-34h]
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jnz	short loc_402ADF
		mov	eax, [ebp-34h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jnz	short loc_402ADF
		mov	eax, [ebp-34h]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jnz	short loc_402ADF
		mov	eax, [ebp-34h]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_402BAB
		mov	eax, [ebp-34h]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	loc_402BAB

loc_402ADF:				; CODE XREF: .text:00402AA1j
					; .text:00402AAEj ...
		mov	eax, [ebp-34h]
		movzx	eax, byte ptr [eax]
		cmp	al, 43h
		jnz	short loc_402B25
		mov	eax, [ebp-34h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 41h
		jnz	short loc_402B25
		mov	eax, [ebp-34h]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jnz	short loc_402B25
		mov	eax, [ebp-34h]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_402BAB
		mov	eax, [ebp-34h]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	loc_402BAB

loc_402B25:				; CODE XREF: .text:00402AE7j
					; .text:00402AF4j ...
		mov	eax, [ebp-34h]
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jnz	short loc_402B63
		mov	eax, [ebp-34h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 52h
		jnz	short loc_402B63
		mov	eax, [ebp-34h]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 52h
		jnz	short loc_402B63
		mov	eax, [ebp-34h]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402BAB
		mov	eax, [ebp-34h]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402BAB

loc_402B63:				; CODE XREF: .text:00402B2Dj
					; .text:00402B3Aj ...
		mov	eax, [ebp-34h]
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jnz	short loc_402BA5
		mov	eax, [ebp-34h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_402BA5
		mov	eax, [ebp-38h]
		cmp	eax, 2
		jbe	short loc_402BA5
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_402BA5
		mov	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-34h]
		add	eax, 2
		mov	[esp], eax
		call	atoi
		mov	[ebp-10h], eax
		jmp	loc_402A3B
; ---------------------------------------------------------------------------

loc_402BA5:				; CODE XREF: .text:00402B6Bj
					; .text:00402B78j ...
		nop
		jmp	loc_402A3B
; ---------------------------------------------------------------------------

loc_402BAB:				; CODE XREF: .text:00402AC8j
					; .text:00402AD9j ...
		cmp	dword ptr [ebp-10h], 0FFFFFF9Ch
		jge	short loc_402BBA
		mov	dword ptr [ebp-10h], 0FFFFFF9Ch
		jmp	short loc_402BC7
; ---------------------------------------------------------------------------

loc_402BBA:				; CODE XREF: .text:00402BAFj
		cmp	dword ptr [ebp-10h], 64h
		jle	short loc_402BC7
		mov	dword ptr [ebp-10h], 64h

loc_402BC7:				; CODE XREF: .text:00402BB8j
					; .text:00402BBEj
		mov	eax, [ebp-10h]

loc_402BCA:				; CODE XREF: .text:00402953j
					; .text:0040298Aj ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402BD0	proc near		; CODE XREF: sub_40226D+C6p
					; sub_402D2F+1Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_402C08
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_402C2E
		mov	[esp+28h+var_20], 1B1h ; int
		mov	[esp+28h+var_24], offset a____Pinentry0_ ; "../../pinentry-0.9.4/pinentry/pinentry."...
		mov	[esp+28h+var_28], offset aPinPin ; "pin->pin"
		call	sub_40B3F0
		jmp	short loc_402C2E
; ---------------------------------------------------------------------------

loc_402C08:				; CODE XREF: sub_402BD0+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_402C2E
		mov	[esp+28h+var_20], 1B3h ; int
		mov	[esp+28h+var_24], offset a____Pinentry0_ ; "../../pinentry-0.9.4/pinentry/pinentry."...
		mov	[esp+28h+var_28], offset aPinPin_0 ; "!pin->pin"
		call	sub_40B3F0

loc_402C2E:				; CODE XREF: sub_402BD0+18j
					; sub_402BD0+36j ...
		cmp	[ebp+arg_4], 7FFh
		jg	short loc_402C3E
		mov	[ebp+arg_4], 800h

loc_402C3E:				; CODE XREF: sub_402BD0+65j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		cmp	eax, [ebp+arg_4]
		jl	short loc_402C51
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		jmp	short locret_402CA8
; ---------------------------------------------------------------------------

loc_402C51:				; CODE XREF: sub_402BD0+77j
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+28h+var_24], edx ;	int
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_409B07
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_402C83
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+20h], edx
		jmp	short loc_402CA5
; ---------------------------------------------------------------------------

loc_402C83:				; CODE XREF: sub_402BD0+9Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+28h+var_28], eax
		call	sub_409B9D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0

loc_402CA5:				; CODE XREF: sub_402BD0+B1j
		mov	eax, [ebp+var_C]

locret_402CA8:				; CODE XREF: sub_402BD0+7Fj
		leave
		retn
sub_402BD0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402CAA	proc near		; CODE XREF: sub_402D2F+Cp
					; .text:00402D8Ap ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_402CE2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_402D2C
		mov	[esp+18h+var_10], 1CFh ; int
		mov	[esp+18h+var_14], offset a____Pinentry0_ ; "../../pinentry-0.9.4/pinentry/pinentry."...
		mov	[esp+18h+var_18], offset aPinPin_len0 ;	"pin->pin_len == 0"
		call	sub_40B3F0
		jmp	short loc_402D2C
; ---------------------------------------------------------------------------

loc_402CE2:				; CODE XREF: sub_402CAA+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jg	short loc_402D08
		mov	[esp+18h+var_10], 1D3h ; int
		mov	[esp+18h+var_14], offset a____Pinentry0_ ; "../../pinentry-0.9.4/pinentry/pinentry."...
		mov	[esp+18h+var_18], offset aPinPin_len0_0	; "pin->pin_len	> 0"
		call	sub_40B3F0

loc_402D08:				; CODE XREF: sub_402CAA+40j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+18h+var_18], eax
		call	sub_409B9D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		jmp	short locret_402D2D
; ---------------------------------------------------------------------------

loc_402D2C:				; CODE XREF: sub_402CAA+18j
					; sub_402CAA+36j
		nop

locret_402D2D:				; CODE XREF: sub_402CAA+80j
		leave
		retn
sub_402CAA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402D2F	proc near		; CODE XREF: sub_4040FA+1Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_402CAA
		mov	[esp+18h+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_402BD0
		leave
		retn
sub_402D2F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_402D91
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_402D84
		mov	dword ptr [esp+8], 1E7h
		mov	dword ptr [esp+4], offset a____Pinentry0_ ; "../../pinentry-0.9.4/pinentry/pinentry."...
		mov	dword ptr [esp], offset	aLen0 ;	"len ==	0"
		call	sub_40B3F0

loc_402D84:				; CODE XREF: .text:00402D66j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_402CAA
		jmp	short loc_402DEC
; ---------------------------------------------------------------------------

loc_402D91:				; CODE XREF: .text:00402D60j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_402DC2
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_402DC2
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+10h], eax

loc_402DC2:				; CODE XREF: .text:00402D95j
					; .text:00402D9Bj
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_402DDA
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		mov	[esp], eax
		call	sub_409B9D

loc_402DDA:				; CODE XREF: .text:00402DCAj
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+8]
		mov	edx, [ebp+10h]
		mov	[eax+20h], edx

loc_402DEC:				; CODE XREF: .text:00402D8Fj
		add	esp, 24h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402DF2(char *)
sub_402DF2	proc near		; CODE XREF: sub_40248D+34p

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 30h
		jbe	short loc_402E22
		call	abort
; ---------------------------------------------------------------------------

loc_402E22:				; CODE XREF: sub_402DF2+29j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Source], eax ;	Source
		mov	[esp+28h+Dest],	offset Dest ; Dest
		call	strcpy
		mov	[esp+28h+Dest],	1
		call	sub_409938
		mov	[esp+28h+Dest],	0
		call	sub_4098B8
		call	sub_409E83
		mov	[esp+28h+Dest],	offset sub_409CAE ; _onexit_t
		call	sub_40A160
		mov	[esp+28h+var_20], offset sub_409B9D
		mov	[esp+28h+Source], offset sub_409B07
		mov	[esp+28h+Dest],	offset sub_409978
		call	sub_407B50
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_402DF2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	dword ptr [esp], offset	aDisplay ; "DISPLAY"
		call	getenv
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_402F11
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402F11
		mov	eax, 1
		jmp	short loc_402F1C
; ---------------------------------------------------------------------------

loc_402EAE:				; CODE XREF: .text:00402F15j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, offset aDisplay_0 ; "--display"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_402F02
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, offset aDisplay_1 ; "--display="
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_402F09

loc_402F02:				; CODE XREF: .text:00402ED6j
		mov	eax, 1
		jmp	short loc_402F1C
; ---------------------------------------------------------------------------

loc_402F09:				; CODE XREF: .text:00402F00j
		sub	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 4

loc_402F11:				; CODE XREF: .text:00402E9Bj
					; .text:00402EA5j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_402EAE
		mov	eax, 0

loc_402F1C:				; CODE XREF: .text:00402EACj
					; .text:00402F07j
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402F23	proc near		; DATA XREF: sub_40318A+27o

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 2Ah ; switch 43 cases
		ja	loc_403009	; jumptable 00402F41 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_40D268
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_402F43:				; CODE XREF: sub_402F23+1Ej
					; DATA XREF: .rdata:off_40D268o
		mov	[ebp+var_C], offset Dest ; jumptable 00402F41 case 11
		jmp	loc_403011
; ---------------------------------------------------------------------------

loc_402F4F:				; CODE XREF: sub_402F23+1Ej
					; DATA XREF: .rdata:off_40D268o
		mov	[ebp+var_C], offset aPinentry ;	jumptable 00402F41 case	12
		jmp	loc_403011
; ---------------------------------------------------------------------------

loc_402F5B:				; CODE XREF: sub_402F23+1Ej
					; DATA XREF: .rdata:off_40D268o
		mov	[ebp+var_C], offset a0_9_4 ; jumptable 00402F41	case 13
		jmp	loc_403011
; ---------------------------------------------------------------------------

loc_402F67:				; CODE XREF: sub_402F23+1Ej
					; DATA XREF: .rdata:off_40D268o
		mov	[ebp+var_C], offset aCopyrightC2015 ; jumptable	00402F41 case 14
		jmp	loc_403011
; ---------------------------------------------------------------------------

loc_402F73:				; CODE XREF: sub_402F23+1Ej
					; DATA XREF: .rdata:off_40D268o
		mov	[ebp+var_C], offset aPleaseReportBu ; jumptable	00402F41 case 19
		jmp	loc_403011
; ---------------------------------------------------------------------------

loc_402F7F:				; CODE XREF: sub_402F23+1Ej
					; DATA XREF: .rdata:off_40D268o
		mov	eax, ds:dword_40F178 ; jumptable 00402F41 cases	1,40
		test	eax, eax
		jnz	short loc_402FED
		mov	eax, offset Dest
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 32h
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	ds:dword_40F178, eax
		mov	eax, ds:dword_40F178
		test	eax, eax
		jz	short loc_402FED
		mov	edx, offset aUsageSOptionsH ; "Usage: %s [options] (-h for help)"
		mov	eax, ds:dword_40F178
		mov	dword ptr [esp+38h+var_2C], offset Dest	; char
		mov	[esp+38h+var_30], edx ;	char *
		mov	edx, [ebp+var_10]
		mov	[esp+38h+var_34], edx ;	size_t
		mov	[esp+38h+Size],	eax ; char *
		call	sub_40B1E0

loc_402FED:				; CODE XREF: sub_402F23+63j
					; sub_402F23+A3j
		mov	eax, ds:dword_40F178
		mov	[ebp+var_C], eax
		jmp	short loc_403011
; ---------------------------------------------------------------------------

loc_402FF7:				; CODE XREF: sub_402F23+1Ej
					; DATA XREF: .rdata:off_40D268o
		mov	[ebp+var_C], offset aAskSecurelyFor ; jumptable	00402F41 case 41
		jmp	short loc_403011
; ---------------------------------------------------------------------------

loc_403000:				; CODE XREF: sub_402F23+1Ej
					; DATA XREF: .rdata:off_40D268o
		mov	[ebp+var_C], offset a1 ; jumptable 00402F41 case 42
		jmp	short loc_403011
; ---------------------------------------------------------------------------

loc_403009:				; CODE XREF: sub_402F23+Bj
					; sub_402F23+1Ej
					; DATA XREF: ...
		mov	[ebp+var_C], 0	; jumptable 00402F41 default case
		nop

loc_403011:				; CODE XREF: sub_402F23+27j
					; sub_402F23+33j ...
		mov	eax, [ebp+var_C]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_402F23	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40301A(char *Str1, int, int)
sub_40301A	proc near		; CODE XREF: sub_40318A+283p
					; sub_40318A+2A1p ...

Str		= dword	ptr -48h
Val		= dword	ptr -44h
MaxCount	= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Str1		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_14], 1
		cmp	[ebp+Str1], 0
		jnz	short loc_403038
		mov	eax, 0
		jmp	loc_403184
; ---------------------------------------------------------------------------

loc_403038:				; CODE XREF: sub_40301A+12j
		mov	[esp+48h+Val], 2Ch ; Val
		mov	eax, [ebp+Str1]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_403058
		add	[ebp+var_10], 1

loc_403058:				; CODE XREF: sub_40301A+38j
		cmp	[ebp+arg_8], 0
		jz	loc_40310E
		mov	[ebp+var_24], offset aBright ; "bright-"
		mov	[ebp+var_20], offset aBright_0 ; "bright"
		mov	[ebp+var_1C], offset aBold ; "bold-"
		mov	[ebp+var_18], offset aBold_0 ; "bold"
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_C], 0
		jmp	short loc_403106
; ---------------------------------------------------------------------------

loc_403090:				; CODE XREF: sub_40301A+F2j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_24]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_24]
		mov	[esp+48h+MaxCount], edx	; MaxCount
		mov	[esp+48h+Val], eax ; Str
		mov	eax, [ebp+Str1]
		mov	[esp+48h+Str], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_403102
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_24]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+Str1], eax

loc_403102:				; CODE XREF: sub_40301A+B7j
		add	[ebp+var_C], 1

loc_403106:				; CODE XREF: sub_40301A+74j
		mov	eax, [ebp+var_C]
		cmp	eax, 3
		jbe	short loc_403090

loc_40310E:				; CODE XREF: sub_40301A+42j
		mov	[ebp+var_C], 0
		jmp	short loc_403171
; ---------------------------------------------------------------------------

loc_403117:				; CODE XREF: sub_40301A+15Dj
		mov	eax, [ebp+var_C]
		mov	eax, Str[eax*8]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_C]
		mov	eax, Str[eax*8]
		mov	[esp+48h+MaxCount], edx	; MaxCount
		mov	[esp+48h+Val], eax ; Str
		mov	eax, [ebp+Str1]
		mov	[esp+48h+Str], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_40316D
		mov	eax, [ebp+var_C]
		mov	eax, dword_40C1E4[eax*8]
		mov	[ebp+var_14], eax

loc_40316D:				; CODE XREF: sub_40301A+144j
		add	[ebp+var_C], 1

loc_403171:				; CODE XREF: sub_40301A+FBj
		mov	eax, [ebp+var_C]
		cmp	eax, 9
		jbe	short loc_403117
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

loc_403184:				; CODE XREF: sub_40301A+19j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40301A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40318A	proc near		; CODE XREF: sub_40248D+45p

Src		= dword	ptr -58h
Format		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_2C		= dword	ptr -2Ch
Str1		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		lea	ebx, [ebp+var_44]
		mov	eax, 0
		mov	edx, 0Eh
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		lea	eax, [ebp+arg_0]
		mov	[ebp+var_44], eax
		lea	eax, [ebp+arg_4]
		mov	[ebp+var_40], eax
		mov	[esp+58h+Src], offset sub_402F23
		call	sub_407046
		mov	[esp+58h+Src], 1
		call	sub_402560
		jmp	loc_403473
; ---------------------------------------------------------------------------

loc_4031CE:				; CODE XREF: sub_40318A+2FEj
		mov	eax, [ebp+var_34]
		sub	eax, 43h	; switch 45 cases
		cmp	eax, 2Ch
		ja	loc_40345D	; jumptable 004031E4 default case
		mov	eax, ds:off_40D338[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4031E6:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	ds:dword_40F5DC, 1 ; jumptable 004031E4	case 100
		jmp	loc_403473
; ---------------------------------------------------------------------------

loc_4031F5:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	ds:dword_40F5E4, 0 ; jumptable 004031E4	case 103
		jmp	loc_403473
; ---------------------------------------------------------------------------

loc_403204:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	eax, [ebp+var_2C] ; jumptable 004031E4 case 68
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	ds:dword_40F5C8, eax
		mov	eax, ds:dword_40F5C8
		test	eax, eax
		jnz	loc_403466
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+Src], eax ; int
		call	strerror
		mov	edx, offset aSS	; "%s: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset Dest
		mov	[esp+58h+Format], edx ;	Format
		mov	[esp+58h+Src], ecx ; File
		call	fprintf
		mov	[esp+58h+Src], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403264:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	eax, [ebp+var_2C] ; jumptable 004031E4 case 84
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	ds:Memory, eax
		mov	eax, ds:Memory
		test	eax, eax
		jnz	loc_403469
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+Src], eax ; int
		call	strerror
		mov	edx, offset aSS	; "%s: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset Dest
		mov	[esp+58h+Format], edx ;	Format
		mov	[esp+58h+Src], ecx ; File
		call	fprintf
		mov	[esp+58h+Src], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4032C4:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	eax, [ebp+var_2C] ; jumptable 004031E4 case 78
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	ds:dword_40F5D0, eax
		mov	eax, ds:dword_40F5D0
		test	eax, eax
		jnz	loc_40346C
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+Src], eax ; int
		call	strerror
		mov	edx, offset aSS	; "%s: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset Dest
		mov	[esp+58h+Format], edx ;	Format
		mov	[esp+58h+Src], ecx ; File
		call	fprintf
		mov	[esp+58h+Src], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403324:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	eax, [ebp+var_2C] ; jumptable 004031E4 case 67
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	ds:dword_40F5D4, eax
		mov	eax, ds:dword_40F5D4
		test	eax, eax
		jnz	loc_40346F
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+Src], eax ; int
		call	strerror
		mov	edx, offset aSS	; "%s: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset Dest
		mov	[esp+58h+Format], edx ;	Format
		mov	[esp+58h+Src], ecx ; File
		call	fprintf
		mov	[esp+58h+Src], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403384:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	eax, [ebp+var_2C] ; jumptable 004031E4 case 77
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	ds:dword_40F5D8, eax
		mov	eax, ds:dword_40F5D8
		test	eax, eax
		jnz	loc_403472
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+Src], eax ; int
		call	strerror
		mov	edx, offset aSS	; "%s: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset Dest
		mov	[esp+58h+Format], edx ;	Format
		mov	[esp+58h+Src], ecx ; File
		call	fprintf
		mov	[esp+58h+Src], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4033E4:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	eax, [ebp+var_2C] ; jumptable 004031E4 case 87
		mov	ds:dword_40F5E8, eax
		jmp	loc_403473
; ---------------------------------------------------------------------------

loc_4033F1:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	eax, [ebp+var_2C] ; jumptable 004031E4 case 99
		mov	[ebp+Str1], eax
		mov	[esp+58h+var_50], offset dword_40F620 ;	int
		mov	[esp+58h+Format], offset dword_40F61C ;	int
		mov	eax, [ebp+Str1]
		mov	[esp+58h+Src], eax ; Str1
		call	sub_40301A
		mov	[ebp+Str1], eax
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Format], offset dword_40F624 ;	int
		mov	eax, [ebp+Str1]
		mov	[esp+58h+Src], eax ; Str1
		call	sub_40301A
		mov	[ebp+Str1], eax
		mov	[esp+58h+var_50], offset dword_40F62C ;	int
		mov	[esp+58h+Format], offset dword_40F628 ;	int
		mov	eax, [ebp+Str1]
		mov	[esp+58h+Src], eax ; Str1
		call	sub_40301A
		mov	[ebp+Str1], eax
		jmp	short loc_403473
; ---------------------------------------------------------------------------

loc_403453:				; CODE XREF: sub_40318A+5Aj
					; DATA XREF: .rdata:off_40D338o
		mov	eax, [ebp+var_2C] ; jumptable 004031E4 case 111
		mov	ds:dword_40F5E0, eax
		jmp	short loc_403473
; ---------------------------------------------------------------------------

loc_40345D:				; CODE XREF: sub_40318A+4Dj
					; sub_40318A+5Aj
					; DATA XREF: ...
		mov	[ebp+var_38], 1	; jumptable 004031E4 default case
		jmp	short loc_403473
; ---------------------------------------------------------------------------

loc_403466:				; CODE XREF: sub_40318A+91j
		nop
		jmp	short loc_403473
; ---------------------------------------------------------------------------

loc_403469:				; CODE XREF: sub_40318A+F1j
		nop
		jmp	short loc_403473
; ---------------------------------------------------------------------------

loc_40346C:				; CODE XREF: sub_40318A+151j
		nop
		jmp	short loc_403473
; ---------------------------------------------------------------------------

loc_40346F:				; CODE XREF: sub_40318A+1B1j
		nop
		jmp	short loc_403473
; ---------------------------------------------------------------------------

loc_403472:				; CODE XREF: sub_40318A+211j
		nop

loc_403473:				; CODE XREF: sub_40318A+3Fj
					; sub_40318A+66j ...
		mov	[esp+58h+Format], offset dword_40C120
		lea	eax, [ebp+var_44]
		mov	[esp+58h+Src], eax
		call	sub_405AE6
		test	eax, eax
		jnz	loc_4031CE
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40318A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403495(int, int, char	*Str)
sub_403495	proc near		; DATA XREF: sub_404803+BAo

File		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
Str		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNoGrab ; "no-grab"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4034DE
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4034DE
		mov	ds:dword_40F5E4, 0
		jmp	loc_4039E0
; ---------------------------------------------------------------------------

loc_4034DE:				; CODE XREF: sub_403495+2Ej
					; sub_403495+38j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aGrab ; "grab"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40351F
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40351F
		mov	ds:dword_40F5E4, 1
		jmp	loc_4039E0
; ---------------------------------------------------------------------------

loc_40351F:				; CODE XREF: sub_403495+6Fj
					; sub_403495+79j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDebugWait ; "debug-wait"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4035C1
		call	_getpid
		mov	edx, eax
		mov	eax, offset aSWaitingForDeb ; "%s: waiting for debugger	- my pid is %u"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+18h+var_C], edx
		mov	[esp+18h+var_10], offset Dest
		mov	[esp+18h+Format], eax ;	Format
		mov	[esp+18h+File],	ecx ; File
		call	fprintf
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40358B
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Str
		call	atoi
		jmp	short loc_403590
; ---------------------------------------------------------------------------

loc_40358B:				; CODE XREF: sub_403495+E7j
		mov	eax, 5

loc_403590:				; CODE XREF: sub_403495+F4j
		mov	[esp+18h+File],	eax ; Duration
		mov	eax, ds:_sleep
		call	eax ; _sleep
		mov	eax, offset aS___Okay ;	"%s: ... okay\n"
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+18h+var_10], offset Dest
		mov	[esp+18h+Format], eax ;	Format
		mov	[esp+18h+File],	edx ; File
		call	fprintf
		jmp	loc_4039E0
; ---------------------------------------------------------------------------

loc_4035C1:				; CODE XREF: sub_403495+B0j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDisplay_2 ; "display"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_403626
		mov	eax, ds:dword_40F5C8
		test	eax, eax
		jz	short loc_4035FF
		mov	eax, ds:dword_40F5C8
		mov	[esp+18h+File],	eax ; Memory
		call	free

loc_4035FF:				; CODE XREF: sub_403495+15Bj
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:dword_40F5C8, eax
		mov	eax, ds:dword_40F5C8
		test	eax, eax
		jnz	loc_4039E0
		mov	eax, 5008056h
		jmp	loc_4039E5
; ---------------------------------------------------------------------------

loc_403626:				; CODE XREF: sub_403495+152j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aTtyname ; "ttyname"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40368B
		mov	eax, ds:Memory
		test	eax, eax
		jz	short loc_403664
		mov	eax, ds:Memory
		mov	[esp+18h+File],	eax ; Memory
		call	free

loc_403664:				; CODE XREF: sub_403495+1C0j
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:Memory, eax
		mov	eax, ds:Memory
		test	eax, eax
		jnz	loc_4039E0
		mov	eax, 5008056h
		jmp	loc_4039E5
; ---------------------------------------------------------------------------

loc_40368B:				; CODE XREF: sub_403495+1B7j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aTtytype ; "ttytype"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4036F0
		mov	eax, ds:dword_40F5D0
		test	eax, eax
		jz	short loc_4036C9
		mov	eax, ds:dword_40F5D0
		mov	[esp+18h+File],	eax ; Memory
		call	free

loc_4036C9:				; CODE XREF: sub_403495+225j
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:dword_40F5D0, eax
		mov	eax, ds:dword_40F5D0
		test	eax, eax
		jnz	loc_4039E0
		mov	eax, 5008056h
		jmp	loc_4039E5
; ---------------------------------------------------------------------------

loc_4036F0:				; CODE XREF: sub_403495+21Cj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aLcCtype ; "lc-ctype"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_403755
		mov	eax, ds:dword_40F5D4
		test	eax, eax
		jz	short loc_40372E
		mov	eax, ds:dword_40F5D4
		mov	[esp+18h+File],	eax ; Memory
		call	free

loc_40372E:				; CODE XREF: sub_403495+28Aj
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:dword_40F5D4, eax
		mov	eax, ds:dword_40F5D4
		test	eax, eax
		jnz	loc_4039E0
		mov	eax, 5008056h
		jmp	loc_4039E5
; ---------------------------------------------------------------------------

loc_403755:				; CODE XREF: sub_403495+281j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aLcMessages	; "lc-messages"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4037BA
		mov	eax, ds:dword_40F5D8
		test	eax, eax
		jz	short loc_403793
		mov	eax, ds:dword_40F5D8
		mov	[esp+18h+File],	eax ; Memory
		call	free

loc_403793:				; CODE XREF: sub_403495+2EFj
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:dword_40F5D8, eax
		mov	eax, ds:dword_40F5D8
		test	eax, eax
		jnz	loc_4039E0
		mov	eax, 5008056h
		jmp	loc_4039E5
; ---------------------------------------------------------------------------

loc_4037BA:				; CODE XREF: sub_403495+2E6j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aParentWid ; "parent-wid"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4037F7
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Str
		call	atoi
		mov	ds:dword_40F5E8, eax
		jmp	loc_4039E0
; ---------------------------------------------------------------------------

loc_4037F7:				; CODE XREF: sub_403495+34Bj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aTouchFile ; "touch-file"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40385C
		mov	eax, ds:dword_40F5EC
		test	eax, eax
		jz	short loc_403835
		mov	eax, ds:dword_40F5EC
		mov	[esp+18h+File],	eax ; Memory
		call	free

loc_403835:				; CODE XREF: sub_403495+391j
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:dword_40F5EC, eax
		mov	eax, ds:dword_40F5EC
		test	eax, eax
		jnz	loc_4039E0
		mov	eax, 5008056h
		jmp	loc_4039E5
; ---------------------------------------------------------------------------

loc_40385C:				; CODE XREF: sub_403495+388j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDefaultOk ; "default-ok"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4038AB
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:dword_40F630, eax
		mov	eax, ds:dword_40F630
		test	eax, eax
		jnz	loc_4039E0
		mov	eax, 5008056h
		jmp	loc_4039E5
; ---------------------------------------------------------------------------

loc_4038AB:				; CODE XREF: sub_403495+3EDj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDefaultCancel ; "default-cancel"
		mov	ecx, 0Fh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4038FA
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:dword_40F634, eax
		mov	eax, ds:dword_40F634
		test	eax, eax
		jnz	loc_4039E0
		mov	eax, 5008056h
		jmp	loc_4039E5
; ---------------------------------------------------------------------------

loc_4038FA:				; CODE XREF: sub_403495+43Cj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDefaultPrompt ; "default-prompt"
		mov	ecx, 0Fh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_403949
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:dword_40F638, eax
		mov	eax, ds:dword_40F638
		test	eax, eax
		jnz	loc_4039E0
		mov	eax, 5008056h
		jmp	loc_4039E5
; ---------------------------------------------------------------------------

loc_403949:				; CODE XREF: sub_403495+48Bj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDefaultPwmngr ; "default-pwmngr"
		mov	ecx, 0Fh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_403991
		mov	eax, [ebp+Str]
		mov	[esp+18h+File],	eax ; Src
		call	_strdup
		mov	ds:dword_40F63C, eax
		mov	eax, ds:dword_40F63C
		test	eax, eax
		jnz	short loc_4039E0
		mov	eax, 5008056h
		jmp	short loc_4039E5
; ---------------------------------------------------------------------------

loc_403991:				; CODE XREF: sub_403495+4DAj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aAllowExternalP ; "allow-external-password-cache"
		mov	ecx, 1Eh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4039D9
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4039D9
		mov	ds:dword_40F640, 1
		mov	ds:dword_40F644, 0
		jmp	short loc_4039E0
; ---------------------------------------------------------------------------

loc_4039D9:				; CODE XREF: sub_403495+522j
					; sub_403495+52Cj
		mov	eax, 50000AEh
		jmp	short loc_4039E5
; ---------------------------------------------------------------------------

loc_4039E0:				; CODE XREF: sub_403495+44j
					; sub_403495+85j ...
		mov	eax, 0

loc_4039E5:				; CODE XREF: sub_403495+18Cj
					; sub_403495+1F1j ...
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_403495	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4039EC	proc near		; CODE XREF: sub_403AEF+4Ep
					; sub_403B6B+4Ep ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	loc_403AD9
; ---------------------------------------------------------------------------

loc_4039F4:				; CODE XREF: sub_4039EC+F5j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_403AC6
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_403AC6
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_403AC6
		add	[ebp+arg_4], 1
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_403A45
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_403A71
; ---------------------------------------------------------------------------

loc_403A45:				; CODE XREF: sub_4039EC+44j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_403A60
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_403A6F
; ---------------------------------------------------------------------------

loc_403A60:				; CODE XREF: sub_4039EC+61j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_403A6F:				; CODE XREF: sub_4039EC+72j
		mov	edx, eax

loc_403A71:				; CODE XREF: sub_4039EC+57j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_403A8C
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_403AB3
; ---------------------------------------------------------------------------

loc_403A8C:				; CODE XREF: sub_4039EC+90j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_403AA7
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_403AB3
; ---------------------------------------------------------------------------

loc_403AA7:				; CODE XREF: sub_4039EC+ABj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_403AB3:				; CODE XREF: sub_4039EC+9Ej
					; sub_4039EC+B9j
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 2
		jmp	short loc_403AD9
; ---------------------------------------------------------------------------

loc_403AC6:				; CODE XREF: sub_4039EC+10j
					; sub_4039EC+21j ...
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_403AD9:				; CODE XREF: sub_4039EC+3j
					; sub_4039EC+D8j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4039F4
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		pop	ebp
		retn
sub_4039EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403AEF	proc near		; DATA XREF: .data:0040C028o

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403B30
		mov	eax, 5008056h
		jmp	short loc_403B65
; ---------------------------------------------------------------------------

loc_403B30:				; CODE XREF: sub_403AEF+38j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F5A4
		test	eax, eax
		jz	short loc_403B58
		mov	eax, ds:dword_40F5A4
		mov	[esp+38h+Size],	eax ; Memory
		call	free

loc_403B58:				; CODE XREF: sub_403AEF+5Aj
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F5A4, eax
		mov	eax, 0

loc_403B65:				; CODE XREF: sub_403AEF+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403AEF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403B6B	proc near		; DATA XREF: .data:0040C034o

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403BAC
		mov	eax, 5008056h
		jmp	short loc_403BE1
; ---------------------------------------------------------------------------

loc_403BAC:				; CODE XREF: sub_403B6B+38j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F5AC
		test	eax, eax
		jz	short loc_403BD4
		mov	eax, ds:dword_40F5AC
		mov	[esp+38h+Size],	eax ; Memory
		call	free

loc_403BD4:				; CODE XREF: sub_403B6B+5Aj
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F5AC, eax
		mov	eax, 0

loc_403BE1:				; CODE XREF: sub_403B6B+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403B6B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403BE7(int, char *Src)
sub_403BE7	proc near		; DATA XREF: .data:0040C040o

Memory		= dword	ptr -18h
Src		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		mov	eax, ds:dword_40F648
		test	eax, eax
		jz	short loc_403C05
		mov	eax, ds:dword_40F648
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

loc_403C05:				; CODE XREF: sub_403BE7+Fj
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403C49
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, offset aClear ; "--clear"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_403C49
		mov	eax, [ebp+Src]
		mov	[esp+18h+Memory], eax ;	Src
		call	_strdup
		mov	ds:dword_40F648, eax
		jmp	short loc_403C53
; ---------------------------------------------------------------------------

loc_403C49:				; CODE XREF: sub_403BE7+26j
					; sub_403BE7+4Ej
		mov	ds:dword_40F648, 0

loc_403C53:				; CODE XREF: sub_403BE7+60j
		mov	eax, 0
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_403BE7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403C5F	proc near		; DATA XREF: .data:0040C04Co

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403CA0
		mov	eax, 5008056h
		jmp	short loc_403CCC
; ---------------------------------------------------------------------------

loc_403CA0:				; CODE XREF: sub_403C5F+38j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F608
		mov	[esp+38h+Size],	eax ; Memory
		call	free
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F608, eax
		mov	eax, 0

loc_403CCC:				; CODE XREF: sub_403C5F+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403C5F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403CD2	proc near		; DATA XREF: .data:0040C058o

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403D13
		mov	eax, 5008056h
		jmp	short loc_403D3F
; ---------------------------------------------------------------------------

loc_403D13:				; CODE XREF: sub_403CD2+38j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F60C
		mov	[esp+38h+Size],	eax ; Memory
		call	free
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F60C, eax
		mov	eax, 0

loc_403D3F:				; CODE XREF: sub_403CD2+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403CD2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403D45	proc near		; DATA XREF: .data:0040C064o

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403D86
		mov	eax, 5008056h
		jmp	short loc_403DBB
; ---------------------------------------------------------------------------

loc_403D86:				; CODE XREF: sub_403D45+38j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F5A8
		test	eax, eax
		jz	short loc_403DAE
		mov	eax, ds:dword_40F5A8
		mov	[esp+38h+Size],	eax ; Memory
		call	free

loc_403DAE:				; CODE XREF: sub_403D45+5Aj
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F5A8, eax
		mov	eax, 0

loc_403DBB:				; CODE XREF: sub_403D45+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403D45	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403DC1	proc near		; DATA XREF: .data:0040C070o

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403E02
		mov	eax, 5008056h
		jmp	short loc_403E37
; ---------------------------------------------------------------------------

loc_403E02:				; CODE XREF: sub_403DC1+38j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F5B0
		test	eax, eax
		jz	short loc_403E2A
		mov	eax, ds:dword_40F5B0
		mov	[esp+38h+Size],	eax ; Memory
		call	free

loc_403E2A:				; CODE XREF: sub_403DC1+5Aj
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F5B0, eax
		mov	eax, 0

loc_403E37:				; CODE XREF: sub_403DC1+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403DC1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403E3D	proc near		; DATA XREF: .data:0040C07Co

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403E7E
		mov	eax, 5008056h
		jmp	short loc_403EB3
; ---------------------------------------------------------------------------

loc_403E7E:				; CODE XREF: sub_403E3D+38j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F5B4
		test	eax, eax
		jz	short loc_403EA6
		mov	eax, ds:dword_40F5B4
		mov	[esp+38h+Size],	eax ; Memory
		call	free

loc_403EA6:				; CODE XREF: sub_403E3D+5Aj
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F5B4, eax
		mov	eax, 0

loc_403EB3:				; CODE XREF: sub_403E3D+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403E3D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403EB9	proc near		; DATA XREF: .data:0040C088o

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403EFA
		mov	eax, 5008056h
		jmp	short loc_403F2F
; ---------------------------------------------------------------------------

loc_403EFA:				; CODE XREF: sub_403EB9+38j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F5B8
		test	eax, eax
		jz	short loc_403F22
		mov	eax, ds:dword_40F5B8
		mov	[esp+38h+Size],	eax ; Memory
		call	free

loc_403F22:				; CODE XREF: sub_403EB9+5Aj
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F5B8, eax
		mov	eax, 0

loc_403F2F:				; CODE XREF: sub_403EB9+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403EB9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403F35(int, char *)
sub_403F35	proc near		; DATA XREF: .data:0040C0E8o

Str		= dword	ptr -18h
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_4], 0
		jz	short loc_403F5B
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403F5B
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Str], eax ; Str
		call	atoi
		mov	ds:dword_40F5E0, eax

loc_403F5B:				; CODE XREF: sub_403F35+Aj
					; sub_403F35+14j
		mov	eax, 0
		leave
		retn
sub_403F35	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F62	proc near		; DATA XREF: .data:0040C0DCo

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403FA3
		mov	eax, 5008056h
		jmp	short loc_403FD8
; ---------------------------------------------------------------------------

loc_403FA3:				; CODE XREF: sub_403F62+38j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F5A0
		test	eax, eax
		jz	short loc_403FCB
		mov	eax, ds:dword_40F5A0
		mov	[esp+38h+Size],	eax ; Memory
		call	free

loc_403FCB:				; CODE XREF: sub_403F62+5Aj
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F5A0, eax
		mov	eax, 0

loc_403FD8:				; CODE XREF: sub_403F62+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403F62	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403FDE	proc near		; DATA XREF: .data:0040C0B8o

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403FF6
		mov	[ebp+arg_4], offset aQuality ; "Quality:"

loc_403FF6:				; CODE XREF: sub_403FDE+Fj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404030
		mov	eax, 5008056h
		jmp	short loc_404065
; ---------------------------------------------------------------------------

loc_404030:				; CODE XREF: sub_403FDE+49j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		mov	eax, ds:dword_40F614
		test	eax, eax
		jz	short loc_404058
		mov	eax, ds:dword_40F614
		mov	[esp+38h+Size],	eax ; Memory
		call	free

loc_404058:				; CODE XREF: sub_403FDE+6Bj
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F614, eax
		mov	eax, 0

loc_404065:				; CODE XREF: sub_403FDE+50j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403FDE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40406B	proc near		; DATA XREF: .data:0040C0C4o

Size		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4040CA
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4040B6
		mov	eax, 5008056h
		jmp	short loc_4040F4
; ---------------------------------------------------------------------------

loc_4040B6:				; CODE XREF: sub_40406B+42j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Size],	eax
		call	sub_4039EC
		jmp	short loc_4040D1
; ---------------------------------------------------------------------------

loc_4040CA:				; CODE XREF: sub_40406B+Fj
		mov	[ebp+var_C], 0

loc_4040D1:				; CODE XREF: sub_40406B+5Dj
		mov	eax, ds:dword_40F618
		test	eax, eax
		jz	short loc_4040E7
		mov	eax, ds:dword_40F618
		mov	[esp+38h+Size],	eax ; Memory
		call	free

loc_4040E7:				; CODE XREF: sub_40406B+6Dj
		mov	eax, [ebp+var_C]
		mov	ds:dword_40F618, eax
		mov	eax, 0

loc_4040F4:				; CODE XREF: sub_40406B+49j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40406B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4040FA	proc near		; DATA XREF: .data:0040C094o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[esp+48h+Dst], offset dword_40F5A0
		call	sub_402D2F
		mov	eax, ds:Dst
		test	eax, eax
		jnz	short loc_40412E
		mov	eax, 5008056h
		jmp	loc_404453
; ---------------------------------------------------------------------------

loc_40412E:				; CODE XREF: sub_4040FA+28j
		mov	eax, ds:dword_40F608
		test	eax, eax
		jnz	loc_404238
		mov	eax, ds:dword_40F640
		test	eax, eax
		jz	loc_404238
		mov	eax, ds:dword_40F648
		test	eax, eax
		jz	loc_404238
		mov	eax, ds:dword_40F644
		test	eax, eax
		jnz	loc_404238
		mov	eax, ds:dword_40F5A8
		test	eax, eax
		jnz	loc_404238
		mov	ds:dword_40F644, 1
		mov	eax, ds:dword_40F648
		mov	[esp+48h+Dst], eax
		call	sub_407059
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_404238
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, ds:dword_40F5C0
		cmp	eax, [ebp+var_18]
		jge	short loc_4041CA
		mov	eax, ds:dword_40F5C0
		mov	[ebp+var_18], eax

loc_4041CA:				; CODE XREF: sub_4040FA+C6j
		mov	ecx, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		mov	eax, ds:Dst
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	edx, ds:Dst
		mov	eax, [ebp+var_18]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dst], eax
		call	sub_409B9D
		mov	ds:dword_40F5C4, 1
		mov	[esp+48h+Size],	offset byte_40D4E9 ; char *
		mov	[esp+48h+Src], offset aPassword_from_ ;	"PASSWORD_FROM_CACHE"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax ; int
		call	sub_408ECE
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 1
		jmp	loc_40437E
; ---------------------------------------------------------------------------

loc_404238:				; CODE XREF: sub_4040FA+3Bj
					; sub_4040FA+48j ...
		mov	ds:dword_40F5C4, 0
		mov	eax, ds:dword_40F5AC
		test	eax, eax
		jnz	short loc_40426C
		mov	eax, ds:dword_40F638
		test	eax, eax
		jz	short loc_40425B
		mov	eax, ds:dword_40F638
		jmp	short loc_404260
; ---------------------------------------------------------------------------

loc_40425B:				; CODE XREF: sub_4040FA+158j
		mov	eax, offset aPin ; "PIN:"

loc_404260:				; CODE XREF: sub_4040FA+15Fj
		mov	ds:dword_40F5AC, eax
		mov	[ebp+var_10], 1

loc_40426C:				; CODE XREF: sub_4040FA+14Fj
		mov	ds:dword_40F5F8, 0
		mov	ds:dword_40F5FC, 0
		mov	ds:dword_40F600, 0
		mov	ds:dword_40F610, 0
		mov	ds:dword_40F604, 0
		mov	eax, [ebp+arg_0]
		mov	ds:dword_40F650, eax
		mov	eax, off_40C000
		mov	[esp+48h+Dst], offset dword_40F5A0 ; LPARAM
		call	eax ; sub_4023AD
		mov	[ebp+var_C], eax
		mov	ds:dword_40F650, 0
		mov	eax, ds:dword_40F5A8
		test	eax, eax
		jz	short loc_4042E1
		mov	eax, ds:dword_40F5A8
		mov	[esp+48h+Dst], eax ; Memory
		call	free
		mov	ds:dword_40F5A8, 0

loc_4042E1:				; CODE XREF: sub_4040FA+1CEj
		mov	eax, ds:dword_40F608
		test	eax, eax
		jz	short loc_404301
		mov	eax, ds:dword_40F608
		mov	[esp+48h+Dst], eax ; Memory
		call	free
		mov	ds:dword_40F608, 0

loc_404301:				; CODE XREF: sub_4040FA+1EEj
		cmp	[ebp+var_10], 0
		jz	short loc_404311
		mov	ds:dword_40F5AC, 0

loc_404311:				; CODE XREF: sub_4040FA+20Bj
		mov	ds:dword_40F614, 0
		mov	eax, ds:dword_40F600
		test	eax, eax
		jz	short loc_40433F
		mov	[esp+48h+Size],	offset aClose ;	"close"
		mov	[esp+48h+Src], offset aButton_info ; "BUTTON_INFO"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax ; int
		call	sub_408ECE

loc_40433F:				; CODE XREF: sub_4040FA+228j
		cmp	[ebp+var_C], 0
		jns	short loc_40437E
		mov	[esp+48h+Dst], offset dword_40F5A0
		call	sub_402CAA
		mov	eax, ds:dword_40F5FC
		test	eax, eax
		jz	short loc_404364
		mov	eax, ds:dword_40F5FC
		jmp	loc_404453
; ---------------------------------------------------------------------------

loc_404364:				; CODE XREF: sub_4040FA+25Ej
		mov	eax, ds:dword_40F5F8
		test	eax, eax
		jz	short loc_404374
		mov	eax, 50000A6h
		jmp	short loc_404379
; ---------------------------------------------------------------------------

loc_404374:				; CODE XREF: sub_4040FA+271j
		mov	eax, 5000063h

loc_404379:				; CODE XREF: sub_4040FA+278j
		jmp	loc_404453
; ---------------------------------------------------------------------------

loc_40437E:				; CODE XREF: sub_4040FA+139j
					; sub_4040FA+249j
		cmp	[ebp+var_C], 0
		jz	loc_404444
		mov	eax, ds:dword_40F610
		test	eax, eax
		jz	short loc_4043AC
		mov	[esp+48h+Size],	offset byte_40D4E9 ; char *
		mov	[esp+48h+Src], offset aPin_repeated ; "PIN_REPEATED"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax ; int
		call	sub_408ECE

loc_4043AC:				; CODE XREF: sub_4040FA+295j
		mov	eax, ds:Dst
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, ds:Dst
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax
		call	sub_407AA6
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40440C
		mov	[esp+48h+Size],	0
		mov	[esp+48h+Src], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax
		call	sub_407AA6
		mov	[ebp+var_C], eax

loc_40440C:				; CODE XREF: sub_4040FA+2F2j
		mov	eax, ds:dword_40F640
		test	eax, eax
		jz	short loc_404444
		mov	eax, ds:dword_40F648
		test	eax, eax
		jz	short loc_404444
		cmp	[ebp+var_14], 0
		jnz	short loc_404444
		mov	eax, ds:dword_40F64C
		test	eax, eax
		jz	short loc_404444
		mov	edx, ds:Dst
		mov	eax, ds:dword_40F648
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	sub_407054

loc_404444:				; CODE XREF: sub_4040FA+288j
					; sub_4040FA+319j ...
		mov	[esp+48h+Dst], offset dword_40F5A0
		call	sub_402CAA
		mov	eax, [ebp+var_C]

loc_404453:				; CODE XREF: sub_4040FA+2Fj
					; sub_4040FA+265j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_4040FA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404459(int, char *)
sub_404459	proc near		; CODE XREF: sub_404566+14p
					; DATA XREF: .data:0040C0A0o

Str		= dword	ptr -28h
SubStr		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+SubStr], offset SubStr	; "--one-button"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strstr
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	ds:dword_40F604, eax
		mov	ds:dword_40F614, 0
		mov	ds:dword_40F600, 0
		mov	ds:dword_40F5F8, 0
		mov	ds:dword_40F5FC, 0
		mov	ds:dword_40F5F4, 0
		mov	[esp+28h+Str], offset dword_40F5A0
		call	sub_402CAA
		mov	eax, off_40C000
		mov	[esp+28h+Str], offset dword_40F5A0 ; LPARAM
		call	eax ; sub_4023AD
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_40F5A8
		test	eax, eax
		jz	short loc_4044EE
		mov	eax, ds:dword_40F5A8
		mov	[esp+28h+Str], eax ; Memory
		call	free
		mov	ds:dword_40F5A8, 0

loc_4044EE:				; CODE XREF: sub_404459+7Cj
		mov	eax, ds:dword_40F600
		test	eax, eax
		jz	short loc_404512
		mov	[esp+28h+var_20], offset aClose	; "close"
		mov	[esp+28h+SubStr], offset aButton_info ;	"BUTTON_INFO"
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; int
		call	sub_408ECE

loc_404512:				; CODE XREF: sub_404459+9Cj
		cmp	[ebp+var_C], 0
		jz	short loc_40451F
		mov	eax, 0
		jmp	short locret_404564
; ---------------------------------------------------------------------------

loc_40451F:				; CODE XREF: sub_404459+BDj
		mov	eax, ds:dword_40F5FC
		test	eax, eax
		jz	short loc_40452F
		mov	eax, ds:dword_40F5FC
		jmp	short locret_404564
; ---------------------------------------------------------------------------

loc_40452F:				; CODE XREF: sub_404459+CDj
		mov	eax, ds:dword_40F5F8
		test	eax, eax
		jz	short loc_40453F
		mov	eax, 50000A6h
		jmp	short locret_404564
; ---------------------------------------------------------------------------

loc_40453F:				; CODE XREF: sub_404459+DDj
		mov	eax, ds:dword_40F604
		test	eax, eax
		jz	short loc_40454F
		mov	eax, 0
		jmp	short locret_404564
; ---------------------------------------------------------------------------

loc_40454F:				; CODE XREF: sub_404459+EDj
		mov	eax, ds:dword_40F5F4
		test	eax, eax
		jz	short loc_40455F
		mov	eax, 5000063h
		jmp	short locret_404564
; ---------------------------------------------------------------------------

loc_40455F:				; CODE XREF: sub_404459+FDj
		mov	eax, 5000072h

locret_404564:				; CODE XREF: sub_404459+C4j
					; sub_404459+D4j ...
		leave
		retn
sub_404459	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404566	proc near		; DATA XREF: .data:0040C0ACo

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], offset SubStr	; "--one-button"
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_404459
		leave
		retn
sub_404566	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404581	proc near		; DATA XREF: .data:0040C0D0o

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_4C		= dword	ptr -4Ch
var_42		= byte ptr -42h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 60h
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aVersion ; "version"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4045F5
		mov	[ebp+var_10], offset a0_9_4 ; "0.9.4"
		mov	eax, [ebp+var_10]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_407AA6
		mov	[ebp+var_C], eax
		jmp	loc_404685
; ---------------------------------------------------------------------------

loc_4045F5:				; CODE XREF: sub_404581+2Ej
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aPid ; "pid"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40467E
		call	_getpid
		mov	edx, eax
		mov	eax, offset aLu	; "%lu"
		mov	dword ptr [esp+68h+var_5C], edx	; char
		mov	[esp+68h+var_60], eax ;	char *
		mov	[esp+68h+var_64], 32h ;	size_t
		lea	eax, [ebp+var_42]
		mov	[esp+68h+var_68], eax ;	char *
		call	sub_40B1E0
		lea	eax, [ebp+var_42]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+68h+var_60], eax
		lea	eax, [ebp+var_42]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_407AA6
		mov	[ebp+var_C], eax
		jmp	short loc_404685
; ---------------------------------------------------------------------------

loc_40467E:				; CODE XREF: sub_404581+9Aj
		mov	[ebp+var_C], 5000118h

loc_404685:				; CODE XREF: sub_404581+6Fj
					; sub_404581+FBj
		mov	eax, [ebp+var_C]
		add	esp, 60h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_404581	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40468F	proc near		; DATA XREF: .data:0040C0F4o

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	[ebp+arg_4], 0
		jnz	short loc_4046AC
		mov	eax, 5000105h
		jmp	loc_404734
; ---------------------------------------------------------------------------

loc_4046A6:				; CODE XREF: sub_40468F+26j
		add	[ebp+arg_4], 1
		jmp	short loc_4046AD
; ---------------------------------------------------------------------------

loc_4046AC:				; CODE XREF: sub_40468F+Bj
		nop

loc_4046AD:				; CODE XREF: sub_40468F+1Bj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4046A6
		jmp	short loc_4046E1
; ---------------------------------------------------------------------------

loc_4046B9:				; CODE XREF: sub_40468F+7Cj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0

loc_4046E1:				; CODE XREF: sub_40468F+28j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4046B9
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_407063
		test	eax, eax
		jz	short loc_404728
		cmp	eax, 1
		jnz	short loc_40472F
		mov	eax, 0
		jmp	short loc_404734
; ---------------------------------------------------------------------------

loc_404728:				; CODE XREF: sub_40468F+8Bj
		mov	eax, 5000105h
		jmp	short loc_404734
; ---------------------------------------------------------------------------

loc_40472F:				; CODE XREF: sub_40468F+90j
		mov	eax, 5000101h

loc_404734:				; CODE XREF: sub_40468F+12j
					; sub_40468F+97j ...
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_40468F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40473A	proc near		; CODE XREF: sub_404803+6Ep

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_4047DD
; ---------------------------------------------------------------------------

loc_404753:				; CODE XREF: sub_40473A+B8j
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_40C020
		mov	ebx, [eax+8]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_40C020
		mov	ecx, [eax]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_40C020
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4047A8
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_40C020
		mov	eax, [eax+4]
		jmp	short loc_4047B4
; ---------------------------------------------------------------------------

loc_4047A8:				; CODE XREF: sub_40473A+56j
		mov	eax, [ebp+var_10]
		add	eax, 100h
		add	[ebp+var_10], 1

loc_4047B4:				; CODE XREF: sub_40473A+6Cj
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40848F
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4047D9
		mov	eax, [ebp+var_14]
		jmp	short loc_4047FD
; ---------------------------------------------------------------------------

loc_4047D9:				; CODE XREF: sub_40473A+98j
		add	[ebp+var_C], 1

loc_4047DD:				; CODE XREF: sub_40473A+14j
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_40C020
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_404753
		mov	eax, 0

loc_4047FD:				; CODE XREF: sub_40473A+9Dj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_40473A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404803	proc near		; CODE XREF: sub_40248D+B1p
					; .text:004049A7p

File		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+Format], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+File],	eax
		call	sub_4091A3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40486B
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax
		call	sub_409268
		mov	edx, offset aSFailedToIniti ; "%s: failed to initialize	the server: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset Dest
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	locret_404990
; ---------------------------------------------------------------------------

loc_40486B:				; CODE XREF: sub_404803+2Bj
		mov	eax, [ebp+var_18]
		mov	[esp+28h+File],	eax
		call	sub_40473A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4048BA
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax
		call	sub_409268
		mov	edx, offset aSFailedToTheRe ; "%s: failed to the register commands wit"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset Dest
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	locret_404990
; ---------------------------------------------------------------------------

loc_4048BA:				; CODE XREF: sub_404803+7Aj
		mov	eax, [ebp+var_18]
		mov	[esp+28h+Format], offset sub_403495
		mov	[esp+28h+File],	eax
		call	sub_408724
		mov	eax, [ebp+var_18]
		mov	[esp+28h+Format], offset sub_40284A
		mov	[esp+28h+File],	eax
		call	sub_4086DE
		jmp	short loc_4048E3
; ---------------------------------------------------------------------------

loc_4048E2:				; CODE XREF: sub_404803+143j
					; sub_404803+177j
		nop

loc_4048E3:				; CODE XREF: sub_404803+DDj
		mov	eax, [ebp+var_18]
		mov	[esp+28h+File],	eax
		call	sub_409610
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_40497F
		cmp	[ebp+var_C], 0
		jz	short loc_404934
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax
		call	sub_409268
		mov	edx, offset aSAssuanAcceptP ; "%s: Assuan accept problem: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset Dest
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_404980
; ---------------------------------------------------------------------------

loc_404934:				; CODE XREF: sub_404803+FCj
		mov	eax, [ebp+var_18]
		mov	[esp+28h+File],	eax
		call	sub_408D25
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4048E2
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax
		call	sub_409268
		mov	edx, offset aSAssuanProcess ; "%s: Assuan processing failed: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset Dest
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		nop
		jmp	loc_4048E2
; ---------------------------------------------------------------------------

loc_40497F:				; CODE XREF: sub_404803+F2j
		nop

loc_404980:				; CODE XREF: sub_404803+12Fj
		mov	eax, [ebp+var_18]
		mov	[esp+28h+File],	eax ; void *
		call	sub_409230
		mov	eax, 0

locret_404990:				; CODE XREF: sub_404803+63j
					; sub_404803+B2j
		leave
		retn
sub_404803	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+4], 1
		mov	dword ptr [esp], 0
		call	sub_404803
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4049B0(char *, char)
sub_4049B0	proc near		; CODE XREF: sub_404C2A+16Dp
					; sub_404C2A+1AAp ...

File		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	[esp+28h+File],	0Bh
		call	sub_406FBD
		mov	edx, offset aS	; "%s: "
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+ArgList], eax
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		mov	eax, [ebp+var_C]
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+File],	edx ; File
		call	vfprintf
		leave
		retn
sub_4049B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_404A09(char *, char)
sub_404A09	proc near		; CODE XREF: sub_404C2A+88p

File		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	[esp+28h+File],	0Bh
		call	sub_406FBD
		mov	edx, offset aSOhhhhJeeee ; "%s:	Ohhhh jeeee: "
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+ArgList], eax
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		mov	eax, [ebp+var_C]
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+File],	edx ; File
		call	vfprintf
		call	abort
sub_404A09	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404A65	proc near		; CODE XREF: .text:00405402p
					; .text:004054BFp

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_404A7D
; ---------------------------------------------------------------------------

loc_404A79:				; CODE XREF: sub_404A65+37j
		add	[ebp+var_10], 1

loc_404A7D:				; CODE XREF: sub_404A65+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404A9E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_404A79

loc_404A9E:				; CODE XREF: sub_404A65+20j
		mov	[ebp+var_14], 0
		jmp	short loc_404ADB
; ---------------------------------------------------------------------------

loc_404AA7:				; CODE XREF: sub_404A65+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_404ACC
		cmp	[ebp+var_14], 0
		jnz	short loc_404AD3
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_404AD3
; ---------------------------------------------------------------------------

loc_404ACC:				; CODE XREF: sub_404A65+57j
		mov	[ebp+var_14], 0

loc_404AD3:				; CODE XREF: sub_404A65+5Dj
					; sub_404A65+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_404ADB:				; CODE XREF: sub_404A65+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404AA7
		cmp	[ebp+var_14], 0
		jz	short loc_404AFC
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_404AFC:				; CODE XREF: sub_404A65+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_404A65	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_40F184, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404B0E	proc near		; CODE XREF: sub_405AE6+26Ap
					; sub_405AE6+2FEp ...

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 0
		jz	loc_404BC9
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_14]
		mov	[eax], edx

loc_404B34:				; CODE XREF: sub_404B0E+B5j
		mov	eax, ds:dword_40F184
		test	eax, eax
		jz	short loc_404B63
		mov	ecx, ds:dword_40F184
		cmp	[ebp+arg_0], 0
		jz	short loc_404B50
		mov	eax, 2
		jmp	short loc_404B55
; ---------------------------------------------------------------------------

loc_404B50:				; CODE XREF: sub_404B0E+39j
		mov	eax, 1

loc_404B55:				; CODE XREF: sub_404B0E+40j
		mov	edx, [ebp+var_C]
		mov	[esp+38h+File],	edx
		mov	[esp+38h+Str], eax
		call	ecx ; dword_40F184
		jmp	short loc_404B8A
; ---------------------------------------------------------------------------

loc_404B63:				; CODE XREF: sub_404B0E+2Dj
		cmp	[ebp+arg_0], 0
		jz	short loc_404B73
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_404B7B
; ---------------------------------------------------------------------------

loc_404B73:				; CODE XREF: sub_404B0E+59j
		mov	eax, ds:_iob
		add	eax, 20h

loc_404B7B:				; CODE XREF: sub_404B0E+63j
		mov	[esp+38h+File],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_404B8A:				; CODE XREF: sub_404B0E+53j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_14]
		lea	edx, [eax+4]
		mov	[ebp+var_14], edx
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_404B34

loc_404BC9:				; CODE XREF: sub_404B0E+12j
		mov	eax, [ebp+var_10]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_404B0E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404BD2	proc near		; CODE XREF: sub_4064E1+6CEp
					; sub_406BC0+201p ...

File		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_40F184
		test	eax, eax
		jz	short loc_404C08
		mov	edx, ds:dword_40F184
		cmp	[ebp+arg_0], 0
		jz	short loc_404BF4
		mov	eax, 2
		jmp	short loc_404BF9
; ---------------------------------------------------------------------------

loc_404BF4:				; CODE XREF: sub_404BD2+19j
		mov	eax, 1

loc_404BF9:				; CODE XREF: sub_404BD2+20j
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+File],	eax
		call	edx ; dword_40F184
		jmp	short locret_404C28
; ---------------------------------------------------------------------------

loc_404C08:				; CODE XREF: sub_404BD2+Dj
		cmp	[ebp+arg_0], 0
		jz	short loc_404C18
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_404C20
; ---------------------------------------------------------------------------

loc_404C18:				; CODE XREF: sub_404BD2+3Aj
		mov	eax, ds:_iob
		add	eax, 20h

loc_404C20:				; CODE XREF: sub_404BD2+44j
		mov	[esp+18h+File],	eax ; File
		call	fflush

locret_404C28:				; CODE XREF: sub_404BD2+34j
		leave
		retn
sub_404BD2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404C2A	proc near		; CODE XREF: .text:0040515Ap
					; sub_405AE6+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_404CB7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_404CB7
		mov	[esp+28h+Code],	offset aInvalidArgumen ; "invalid argument for arg_parse\n"
		call	sub_404A09
; ---------------------------------------------------------------------------

loc_404CB7:				; CODE XREF: sub_404C2A+13j
					; sub_404C2A+7Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_404ED9
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_404DA1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_404CE6
		mov	dword ptr [ebp+var_C], offset aArgumentNotExp ;	"argument not expected"
		jmp	loc_404D79
; ---------------------------------------------------------------------------

loc_404CE6:				; CODE XREF: sub_404C2A+AEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_404CFA
		mov	dword ptr [ebp+var_C], offset aReadError ; "read error"
		jmp	short loc_404D79
; ---------------------------------------------------------------------------

loc_404CFA:				; CODE XREF: sub_404C2A+C5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_404D0E
		mov	dword ptr [ebp+var_C], offset aKeywordTooLong ;	"keyword too long"
		jmp	short loc_404D79
; ---------------------------------------------------------------------------

loc_404D0E:				; CODE XREF: sub_404C2A+D9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_404D22
		mov	dword ptr [ebp+var_C], offset aMissingArgumen ;	"missing argument"
		jmp	short loc_404D79
; ---------------------------------------------------------------------------

loc_404D22:				; CODE XREF: sub_404C2A+EDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_404D36
		mov	dword ptr [ebp+var_C], offset aInvalidArgum_0 ;	"invalid argument"
		jmp	short loc_404D79
; ---------------------------------------------------------------------------

loc_404D36:				; CODE XREF: sub_404C2A+101j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_404D4A
		mov	dword ptr [ebp+var_C], offset aInvalidCommand ;	"invalid command"
		jmp	short loc_404D79
; ---------------------------------------------------------------------------

loc_404D4A:				; CODE XREF: sub_404C2A+115j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_404D5E
		mov	dword ptr [ebp+var_C], offset aInvalidAliasDe ;	"invalid alias definition"
		jmp	short loc_404D79
; ---------------------------------------------------------------------------

loc_404D5E:				; CODE XREF: sub_404C2A+129j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_404D72
		mov	dword ptr [ebp+var_C], offset aOutOfCore_0 ; "out of core"
		jmp	short loc_404D79
; ---------------------------------------------------------------------------

loc_404D72:				; CODE XREF: sub_404C2A+13Dj
		mov	dword ptr [ebp+var_C], offset aInvalidOption ; "invalid	option"

loc_404D79:				; CODE XREF: sub_404C2A+B7j
					; sub_404C2A+CEj ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_4049B0
		jmp	loc_404EB8
; ---------------------------------------------------------------------------

loc_404DA1:				; CODE XREF: sub_404C2A+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_404DB3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_404DB8
; ---------------------------------------------------------------------------

loc_404DB3:				; CODE XREF: sub_404C2A+17Fj
		mov	eax, offset a??	; "[??]"

loc_404DB8:				; CODE XREF: sub_404C2A+187j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_404DDE
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "missing argument for option \"%.50s\"\n"
		call	sub_4049B0
		jmp	loc_404EB8
; ---------------------------------------------------------------------------

loc_404DDE:				; CODE XREF: sub_404C2A+19Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_404E01
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aInvalidArgum_1 ; "invalid argument for option \"%.50s\"\n"
		call	sub_4049B0
		jmp	loc_404EB8
; ---------------------------------------------------------------------------

loc_404E01:				; CODE XREF: sub_404C2A+1BDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_404E24
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "option \"%.50s\" does	not expect an arg"...
		call	sub_4049B0
		jmp	loc_404EB8
; ---------------------------------------------------------------------------

loc_404E24:				; CODE XREF: sub_404C2A+1E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_404E44
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "invalid command \"%.50s\"\n"
		call	sub_4049B0
		jmp	short loc_404EB8
; ---------------------------------------------------------------------------

loc_404E44:				; CODE XREF: sub_404C2A+203j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_404E64
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "option \"%.50s\" is ambiguous\n"
		call	sub_4049B0
		jmp	short loc_404EB8
; ---------------------------------------------------------------------------

loc_404E64:				; CODE XREF: sub_404C2A+223j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF7h
		jnz	short loc_404E84
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "command \"%.50s\" is ambiguous\n"
		call	sub_4049B0
		jmp	short loc_404EB8
; ---------------------------------------------------------------------------

loc_404E84:				; CODE XREF: sub_404C2A+243j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_404EA5
		mov	dword ptr [esp+28h+var_24], offset aOutOfCore_1	; "out of core\n"
		mov	[esp+28h+Code],	offset aS_0 ; "%s\n"
		call	sub_4049B0
		jmp	short loc_404EB8
; ---------------------------------------------------------------------------

loc_404EA5:				; CODE XREF: sub_404C2A+263j
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "invalid option \"%.50s\"\n"
		call	sub_4049B0

loc_404EB8:				; CODE XREF: sub_404C2A+172j
					; sub_404C2A+1AFj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_404ECF
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_404ECF:				; CODE XREF: sub_404C2A+297j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_404ED9:				; CODE XREF: sub_404C2A+95j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_404C2A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404EEF	proc near		; CODE XREF: .text:00405445p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_404EEF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404EF4(int, char *)
sub_404EF4	proc near		; CODE XREF: sub_404F3A+11Cp
					; .text:0040529Cp ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_404F2D
; ---------------------------------------------------------------------------

loc_404F05:				; CODE XREF: sub_404EF4+3Dj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404F25
		mov	eax, 1
		jmp	short locret_404F38
; ---------------------------------------------------------------------------

loc_404F25:				; CODE XREF: sub_404EF4+28j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_404F2D:				; CODE XREF: sub_404EF4+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_404F05
		mov	eax, 0

locret_404F38:				; CODE XREF: sub_404EF4+2Fj
		leave
		retn
sub_404EF4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404F3A(int, FILE *)
sub_404F3A	proc near		; CODE XREF: .text:00405746p

File		= dword	ptr -98h
Source		= dword	ptr -94h
var_80		= byte ptr -80h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		jmp	loc_4050B6
; ---------------------------------------------------------------------------

loc_404F5D:				; CODE XREF: sub_404F3A+180j
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+File],	eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jnz	short loc_404F7A
		mov	[ebp+var_14], 1
		jmp	short loc_404F8E
; ---------------------------------------------------------------------------

loc_404F7A:				; CODE XREF: sub_404F3A+35j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_404F8E
		mov	[ebp+C], 0Ah
		mov	[ebp+var_14], 1

loc_404F8E:				; CODE XREF: sub_404F3A+3Ej
					; sub_404F3A+44j ...
		mov	eax, [ebp+var_18]
		cmp	eax, 1
		jz	short loc_404FDB
		cmp	eax, 1
		jb	short loc_404FAE
		cmp	eax, 2
		jz	short loc_40501F
		cmp	eax, 3
		jz	loc_405040
		jmp	loc_4050B6
; ---------------------------------------------------------------------------

loc_404FAE:				; CODE XREF: sub_404F3A+5Fj
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_404FCB
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_4050B2

loc_404FCB:				; CODE XREF: sub_404F3A+7Aj
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 1
		jmp	short loc_404F8E
; ---------------------------------------------------------------------------

loc_404FDB:				; CODE XREF: sub_404F3A+5Aj
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_404FF5
		mov	[ebp+var_18], 3
		jmp	short loc_404F8E
; ---------------------------------------------------------------------------

loc_404FF5:				; CODE XREF: sub_404F3A+B0j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_405013
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_4050B6
; ---------------------------------------------------------------------------

loc_405013:				; CODE XREF: sub_404F3A+C1j
		mov	[ebp+var_18], 2
		jmp	loc_4050B6
; ---------------------------------------------------------------------------

loc_40501F:				; CODE XREF: sub_404F3A+64j
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_4050B5
		mov	[ebp+var_18], 0
		jmp	loc_404F8E
; ---------------------------------------------------------------------------

loc_405040:				; CODE XREF: sub_404F3A+69j
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_80]
		mov	[esp+98h+Source], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+File],	eax ; int
		call	sub_404EF4
		test	eax, eax
		jnz	short loc_4050A6
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+98h+File],	eax ; Size
		call	malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40507D
		mov	eax, 1
		jmp	short locret_4050C5
; ---------------------------------------------------------------------------

loc_40507D:				; CODE XREF: sub_404F3A+13Aj
		lea	eax, [ebp+var_80]
		mov	edx, [ebp+var_1C]
		add	edx, 4
		mov	[esp+98h+Source], eax ;	Source
		mov	[esp+98h+File],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax+34h], edx

loc_4050A6:				; CODE XREF: sub_404F3A+123j
		mov	[ebp+var_18], 0
		jmp	loc_404F8E
; ---------------------------------------------------------------------------

loc_4050B2:				; CODE XREF: sub_404F3A+8Bj
		nop
		jmp	short loc_4050B6
; ---------------------------------------------------------------------------

loc_4050B5:				; CODE XREF: sub_404F3A+F4j
		nop

loc_4050B6:				; CODE XREF: sub_404F3A+1Ej
					; sub_404F3A+6Fj ...
		cmp	[ebp+var_14], 0
		jz	loc_404F5D
		mov	eax, 0

locret_4050C5:				; CODE XREF: sub_404F3A+141j
		leave
		retn
sub_404F3A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4050C7	proc near		; CODE XREF: .text:0040558Dp

Memory		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_4050F1
; ---------------------------------------------------------------------------

loc_4050D8:				; CODE XREF: sub_4050C7+2Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_4050F1:				; CODE XREF: sub_4050C7+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_4050D8
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		leave
		retn
sub_4050C7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0C4h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-20h], 0
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_405146
		mov	eax, [ebp+18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_405AE6
		jmp	loc_405985
; ---------------------------------------------------------------------------

loc_405146:				; CODE XREF: .text:0040512Dj
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_404C2A
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_40516F
; ---------------------------------------------------------------------------

loc_40516E:				; CODE XREF: .text:004055D6j
					; .text:0040561Bj ...
		nop

loc_40516F:				; CODE XREF: .text:0040516Cj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	getc
		mov	[ebp-2Ch], eax
		cmp	dword ptr [ebp-2Ch], 0Ah
		jz	short loc_40518D
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	loc_4055D2

loc_40518D:				; CODE XREF: .text:00405181j
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jz	short loc_4051A0
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_4051A0:				; CODE XREF: .text:00405191j
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_40597B
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_405336
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_4051FF
; ---------------------------------------------------------------------------

loc_4051C9:				; CODE XREF: .text:0040520Cj
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4051FB
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-9Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_405210

loc_4051FB:				; CODE XREF: .text:004051D7j
		add	dword ptr [ebp-10h], 1

loc_4051FF:				; CODE XREF: .text:004051C7j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4051C9
		jmp	short loc_405211
; ---------------------------------------------------------------------------

loc_405210:				; CODE XREF: .text:004051F9j
		nop

loc_405211:				; CODE XREF: .text:0040520Ej
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_40524D
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_40524D:				; CODE XREF: .text:00405239j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4052E3
		mov	dword ptr [esp+4], offset aIgnoreInvalidO ; "ignore-invalid-option"
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_40528C
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_40528C:				; CODE XREF: .text:00405278j
		lea	eax, [ebp-9Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_404EF4
		test	eax, eax
		jz	short loc_4052B7
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_4052B7:				; CODE XREF: .text:004052A3j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_4052D3
		mov	eax, 0FFFFFFF9h
		jmp	short loc_4052D8
; ---------------------------------------------------------------------------

loc_4052D3:				; CODE XREF: .text:004052CAj
		mov	eax, 0FFFFFFFEh

loc_4052D8:				; CODE XREF: .text:004052D1j
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_4052E3:				; CODE XREF: .text:0040525Aj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_405305
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_405305:				; CODE XREF: .text:004052F4j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_405327
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_405327:				; CODE XREF: .text:00405316j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_405336:				; CODE XREF: .text:004051AEj
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_4053A4
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_405351
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_405351:				; CODE XREF: .text:00405340j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_405373
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_405373:				; CODE XREF: .text:00405362j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_405395
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_405395:				; CODE XREF: .text:00405384j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_4053A4:				; CODE XREF: .text:0040533Aj
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_405581
		cmp	dword ptr [ebp-20h], 0
		jz	loc_40544F
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_4053CD
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_40557C
; ---------------------------------------------------------------------------

loc_4053CD:				; CODE XREF: .text:004053BCj
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0
		mov	dword ptr [esp+4], offset asc_40DA6B ; " \t"
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-24h], eax
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_405407
		mov	eax, [ebp-24h]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-24h], 1
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	sub_404A65

loc_405407:				; CODE XREF: .text:004053F0j
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_405417
		mov	eax, [ebp-24h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405431

loc_405417:				; CODE XREF: .text:0040540Bj
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	free
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_40597E
; ---------------------------------------------------------------------------

loc_405431:				; CODE XREF: .text:00405415j
		mov	eax, [ebp-24h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_404EEF
		jmp	loc_40557C
; ---------------------------------------------------------------------------

loc_40544F:				; CODE XREF: .text:004053B2j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_405471
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_40597E
; ---------------------------------------------------------------------------

loc_405471:				; CODE XREF: .text:00405460j
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_4054A6
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	_strdup
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_4054AF
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_4054AF
; ---------------------------------------------------------------------------

loc_4054A6:				; CODE XREF: .text:00405475j
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0

loc_4054AF:				; CODE XREF: .text:00405498j
					; .text:004054A4j
		cmp	dword ptr [ebp-18h], 0
		jz	loc_40597E
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_404A65
		mov	eax, [ebp-18h]
		mov	[ebp-28h], eax
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_405542
		add	dword ptr [ebp-28h], 1
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405542
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-0ACh], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0ACh]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_405542
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-0ACh], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0ACh]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		mov	byte ptr [eax],	0

loc_405542:				; CODE XREF: .text:004054D2j
					; .text:004054E0j ...
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		mov	edx, [ebp-28h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4062CE
		test	eax, eax
		jnz	loc_40597E
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	free
		jmp	loc_40597E
; ---------------------------------------------------------------------------

loc_40557C:				; CODE XREF: .text:004053C8j
					; .text:0040544Aj
		jmp	loc_40597E
; ---------------------------------------------------------------------------

loc_405581:				; CODE XREF: .text:004053A8j
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	short loc_4055BF
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4050C7
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	ferror
		test	eax, eax
		jz	short loc_4055B0
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_4055B0:				; CODE XREF: .text:0040559Fj
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_4055BF:				; CODE XREF: .text:00405585j
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-10h], 0
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_4055D2:				; CODE XREF: .text:00405187j
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_40516E
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4055FF
		mov	eax, [ebp-2Ch]
		cmp	eax, 7Fh
		ja	short loc_4055FF
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_405976

loc_4055FF:				; CODE XREF: .text:004055E0j
					; .text:004055E8j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_405617
		cmp	dword ptr [ebp-2Ch], 23h
		jnz	short loc_405617
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_405617:				; CODE XREF: .text:00405603j
					; .text:00405609j
		cmp	dword ptr [ebp-0Ch], 1
		jz	loc_40516E
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_4057E1
		mov	eax, [ebp-2Ch]
		cmp	eax, 7Fh
		ja	loc_4057E1
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_4057E1
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_405697
; ---------------------------------------------------------------------------

loc_405661:				; CODE XREF: .text:004056A4j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405693
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-9Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_4056A8

loc_405693:				; CODE XREF: .text:0040566Fj
		add	dword ptr [ebp-10h], 1

loc_405697:				; CODE XREF: .text:0040565Fj
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_405661
		jmp	short loc_4056A9
; ---------------------------------------------------------------------------

loc_4056A8:				; CODE XREF: .text:00405691j
		nop

loc_4056A9:				; CODE XREF: .text:004056A6j
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_4056DF
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_4056DF:				; CODE XREF: .text:004056D1j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4057D5
		mov	dword ptr [esp+4], offset aAlias ; "alias"
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_40571F
		mov	dword ptr [ebp-20h], 1
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_40571F:				; CODE XREF: .text:0040570Aj
		mov	dword ptr [esp+4], offset aIgnoreInvalidO ; "ignore-invalid-option"
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_40577D
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_404F3A
		test	eax, eax
		jz	short loc_40575E
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_40575E:				; CODE XREF: .text:0040574Dj
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+10h]
		mov	[eax], edx
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_40577D:				; CODE XREF: .text:00405737j
		lea	eax, [ebp-9Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_404EF4
		test	eax, eax
		jz	short loc_4057A2
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_4057A2:				; CODE XREF: .text:00405794j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_4057BE
		mov	eax, 0FFFFFFF9h
		jmp	short loc_4057C3
; ---------------------------------------------------------------------------

loc_4057BE:				; CODE XREF: .text:004057B5j
		mov	eax, 0FFFFFFFEh

loc_4057C3:				; CODE XREF: .text:004057BCj
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_4057D5:				; CODE XREF: .text:004056ECj
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_405976
; ---------------------------------------------------------------------------

loc_4057E1:				; CODE XREF: .text:00405625j
					; .text:00405631j ...
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_40582B
		mov	eax, [ebp-2Ch]
		cmp	eax, 7Fh
		ja	short loc_405804
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_40516E

loc_405804:				; CODE XREF: .text:004057EDj
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 4
		jmp	loc_40516E
; ---------------------------------------------------------------------------

loc_40582B:				; CODE XREF: .text:004057E5j
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_405938
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_4058BA
		mov	eax, [ebp-10h]
		mov	edx, [ebp-1Ch]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_40585C
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-2Ch]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_40516E
; ---------------------------------------------------------------------------

loc_40585C:				; CODE XREF: .text:00405846j
		mov	eax, [ebp-1Ch]
		add	eax, 32h
		mov	[ebp-30h], eax
		mov	eax, [ebp-30h]
		mov	[esp+4], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	realloc
		mov	[ebp-34h], eax
		cmp	dword ptr [ebp-34h], 0
		jz	short loc_4058A0
		mov	eax, [ebp-30h]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-34h]
		mov	[ebp-18h], eax
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-2Ch]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_40516E
; ---------------------------------------------------------------------------

loc_4058A0:				; CODE XREF: .text:0040587Ej
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	free
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_40597F
; ---------------------------------------------------------------------------

loc_4058BA:				; CODE XREF: .text:00405839j
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		ja	short loc_4058DB
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_40516E
; ---------------------------------------------------------------------------

loc_4058DB:				; CODE XREF: .text:004058C0j
		mov	dword ptr [ebp-38h], 96h
		mov	eax, [ebp-38h]
		mov	[esp], eax
		call	malloc
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_40592C
		mov	eax, [ebp-38h]
		mov	[ebp-1Ch], eax
		mov	ecx, [ebp-10h]
		lea	edx, [ebp-9Ch]
		mov	eax, [ebp-18h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-2Ch]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_40516E
; ---------------------------------------------------------------------------

loc_40592C:				; CODE XREF: .text:004058F4j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_40597F
; ---------------------------------------------------------------------------

loc_405938:				; CODE XREF: .text:0040582Fj
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		jbe	short loc_405956
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_40516E
; ---------------------------------------------------------------------------

loc_405956:				; CODE XREF: .text:0040593Ej
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 2
		jmp	loc_40516E
; ---------------------------------------------------------------------------

loc_405976:				; CODE XREF: .text:00405248j
					; .text:00405287j ...
		jmp	loc_40516E
; ---------------------------------------------------------------------------

loc_40597B:				; CODE XREF: .text:004051A4j
		nop
		jmp	short loc_40597F
; ---------------------------------------------------------------------------

loc_40597E:				; CODE XREF: .text:0040542Cj
					; .text:0040546Cj ...
		nop

loc_40597F:				; CODE XREF: .text:004052DEj
					; .text:00405300j ...
		mov	eax, [ebp+14h]
		mov	eax, [eax+10h]

loc_405985:				; CODE XREF: .text:00405141j
		add	esp, 0C4h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40598E(int, int, char	*)
sub_40598E	proc near		; CODE XREF: sub_405AE6+193p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4059A9
		mov	eax, 0FFFFFFFFh
		jmp	loc_405AE0
; ---------------------------------------------------------------------------

loc_4059A9:				; CODE XREF: sub_40598E+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_4059ED
; ---------------------------------------------------------------------------

loc_4059B2:				; CODE XREF: sub_40598E+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4059E9
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4059E9
		mov	eax, [ebp+var_C]
		jmp	loc_405AE0
; ---------------------------------------------------------------------------

loc_4059E9:				; CODE XREF: sub_40598E+32j
					; sub_40598E+51j
		add	[ebp+var_C], 1

loc_4059ED:				; CODE XREF: sub_40598E+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4059B2
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_405AC8
; ---------------------------------------------------------------------------

loc_405A2A:				; CODE XREF: sub_40598E+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_405AC4
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_405AC4
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_405AB0
; ---------------------------------------------------------------------------

loc_405A6F:				; CODE XREF: sub_40598E+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405AAC
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_405AAC
		mov	eax, 0FFFFFFFEh
		jmp	short loc_405AE0
; ---------------------------------------------------------------------------

loc_405AAC:				; CODE XREF: sub_40598E+EFj
					; sub_40598E+115j
		add	[ebp+var_10], 1

loc_405AB0:				; CODE XREF: sub_40598E+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_405A6F
		mov	eax, [ebp+var_C]
		jmp	short loc_405AE0
; ---------------------------------------------------------------------------

loc_405AC4:				; CODE XREF: sub_40598E+AAj
					; sub_40598E+D4j
		add	[ebp+var_C], 1

loc_405AC8:				; CODE XREF: sub_40598E+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_405A2A
		mov	eax, 0FFFFFFFFh

loc_405AE0:				; CODE XREF: sub_40598E+16j
					; sub_40598E+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40598E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405AE6	proc near		; CODE XREF: sub_40318A+2F7p
					; .text:0040513Cp

Str		= dword	ptr -48h
Val		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	sub_404C2A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405B4A
		cmp	[ebp+var_10], 0
		jz	short loc_405B4A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_405B4A
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_405B4A:				; CODE XREF: sub_405AE6+43j
					; sub_405AE6+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_405B5F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_4062A8
; ---------------------------------------------------------------------------

loc_405B5F:				; CODE XREF: sub_405AE6+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_405BB5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_405BB5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_4062A8
; ---------------------------------------------------------------------------

loc_405BB5:				; CODE XREF: sub_405AE6+92j
					; sub_405AE6+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_405BCE
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_4062A8
; ---------------------------------------------------------------------------

loc_405BCE:				; CODE XREF: sub_405AE6+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_405F83
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_405F83
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405C3D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_405C3D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_405B4A
; ---------------------------------------------------------------------------

loc_405C3D:				; CODE XREF: sub_405AE6+11Cj
					; sub_405AE6+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+48h+Val], 3Dh ; Val
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_405C62
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_405C62:				; CODE XREF: sub_405AE6+174j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+48h+var_40], eax ;	char *
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax ; int
		call	sub_40598E
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_405C8D
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_405C8D:				; CODE XREF: sub_405AE6+19Fj
		cmp	[ebp+var_20], 0
		jns	short loc_405CC7
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+48h+Val], eax ; Str2
		mov	[esp+48h+Str], offset Str1 ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_405CC7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str], eax
		call	sub_4064E1
; ---------------------------------------------------------------------------
		jmp	loc_405E24
; ---------------------------------------------------------------------------

loc_405CC7:				; CODE XREF: sub_405AE6+1ABj
					; sub_405AE6+1C5j
		cmp	[ebp+var_20], 0
		jns	short loc_405D09
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+48h+Val], eax ; Str2
		mov	[esp+48h+Str], offset aVersion_0 ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_405D09
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_405E24
		call	sub_406BC0
		mov	[esp+48h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_405D09:				; CODE XREF: sub_405AE6+1E5j
					; sub_405AE6+1FFj
		cmp	[ebp+var_20], 0
		jns	short loc_405D61
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+48h+Val], eax ; Str2
		mov	[esp+48h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_405D61
		mov	[esp+48h+Str], 10h
		call	sub_406FBD
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], offset asc_40DA8A ; "\n"
		mov	[esp+48h+Val], eax
		mov	[esp+48h+Str], 0
		call	sub_404B0E
		mov	[esp+48h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_405D61:				; CODE XREF: sub_405AE6+227j
					; sub_405AE6+241j
		cmp	[ebp+var_20], 0
		jns	loc_405E24
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+48h+Val], eax ; Str2
		mov	[esp+48h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	loc_405E24
		mov	[ebp+var_20], 0
		jmp	short loc_405DED
; ---------------------------------------------------------------------------

loc_405D92:				; CODE XREF: sub_405AE6+314j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405DE9
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	short loc_405DE9
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], offset asc_40DA8A ; "\n"
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+Val], offset asc_40DA99 ; "--"
		mov	[esp+48h+Str], 0
		call	sub_404B0E

loc_405DE9:				; CODE XREF: sub_405AE6+2BAj
					; sub_405AE6+2CDj
		add	[ebp+var_20], 1

loc_405DED:				; CODE XREF: sub_405AE6+2AAj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_405D92
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+Val], offset aDumpOptionsHel ;	"--dump-options\n--help\n--version\n--wa"...
		mov	[esp+48h+Str], 0
		call	sub_404B0E
		mov	[esp+48h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_405E24:				; CODE XREF: sub_405AE6+1DCj
					; sub_405AE6+20Cj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_405E36
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_405E65
; ---------------------------------------------------------------------------

loc_405E36:				; CODE XREF: sub_405AE6+342j
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_405E54
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_405E65
; ---------------------------------------------------------------------------

loc_405E54:				; CODE XREF: sub_405AE6+354j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_405E65:				; CODE XREF: sub_405AE6+34Ej
					; sub_405AE6+36Cj
		cmp	[ebp+var_20], 0
		js	loc_405F72
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_405F53
		cmp	[ebp+var_28], 0
		jz	short loc_405EA8
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405EB1
		mov	[ebp+var_1C], 0
		jmp	short loc_405EB1
; ---------------------------------------------------------------------------

loc_405EA8:				; CODE XREF: sub_405AE6+3A4j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_405EB1:				; CODE XREF: sub_405AE6+3B7j
					; sub_405AE6+3C0j
		cmp	[ebp+var_1C], 0
		jnz	short loc_405ED9
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_405ED9
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_405F72
; ---------------------------------------------------------------------------

loc_405ED9:				; CODE XREF: sub_405AE6+3CFj
					; sub_405AE6+3E2j
		cmp	[ebp+var_1C], 0
		jnz	short loc_405EEE
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_405F71
; ---------------------------------------------------------------------------

loc_405EEE:				; CODE XREF: sub_405AE6+3F7j
		cmp	[ebp+var_28], 0
		jnz	short loc_405F1D
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_405F1D
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_405F1D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_405F72
; ---------------------------------------------------------------------------

loc_405F1D:				; CODE XREF: sub_405AE6+40Cj
					; sub_405AE6+416j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_40], edx ;	char *
		mov	[esp+48h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax ; int
		call	sub_4062CE
		cmp	[ebp+var_28], 0
		jnz	short loc_405F71
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_405F71
; ---------------------------------------------------------------------------

loc_405F53:				; CODE XREF: sub_405AE6+39Aj
		cmp	[ebp+var_28], 0
		jz	short loc_405F65
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_405F72
; ---------------------------------------------------------------------------

loc_405F65:				; CODE XREF: sub_405AE6+471j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_405F72
; ---------------------------------------------------------------------------

loc_405F71:				; CODE XREF: sub_405AE6+403j
					; sub_405AE6+45Dj ...
		nop

loc_405F72:				; CODE XREF: sub_405AE6+383j
					; sub_405AE6+3EEj ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_4062A8
; ---------------------------------------------------------------------------

loc_405F83:				; CODE XREF: sub_405AE6+F0j
					; sub_405AE6+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_405F9A
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405FA8

loc_405F9A:				; CODE XREF: sub_405AE6+4A5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_406260

loc_405FA8:				; CODE XREF: sub_405AE6+4B2j
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_406033
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_406033
		mov	[ebp+var_20], 0
		jmp	short loc_406024
; ---------------------------------------------------------------------------

loc_405FE5:				; CODE XREF: sub_405AE6+54Bj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_406020
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+48h+Val], edx ; Str2
		mov	[esp+48h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_406020
		mov	[ebp+var_24], 1
		jmp	short loc_406033
; ---------------------------------------------------------------------------

loc_406020:				; CODE XREF: sub_405AE6+50Dj
					; sub_405AE6+52Fj
		add	[ebp+var_20], 1

loc_406024:				; CODE XREF: sub_405AE6+4FDj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_405FE5

loc_406033:				; CODE XREF: sub_405AE6+4D8j
					; sub_405AE6+4F4j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_406079
		mov	[ebp+var_20], 0
		jmp	short loc_406067
; ---------------------------------------------------------------------------

loc_40604B:				; CODE XREF: sub_405AE6+58Ej
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_406078
		add	[ebp+var_20], 1

loc_406067:				; CODE XREF: sub_405AE6+563j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40604B
		jmp	short loc_406079
; ---------------------------------------------------------------------------

loc_406078:				; CODE XREF: sub_405AE6+57Bj
		nop

loc_406079:				; CODE XREF: sub_405AE6+55Aj
					; sub_405AE6+590j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4060B1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_40609C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_4060B1

loc_40609C:				; CODE XREF: sub_405AE6+5AAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str], eax
		call	sub_4064E1
; ---------------------------------------------------------------------------

loc_4060B1:				; CODE XREF: sub_405AE6+5A0j
					; sub_405AE6+5B4j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_406115
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_4060ED
		mov	eax, 0FFFFFFF9h
		jmp	short loc_4060F2
; ---------------------------------------------------------------------------

loc_4060ED:				; CODE XREF: sub_405AE6+5FEj
		mov	eax, 0FFFFFFFEh

loc_4060F2:				; CODE XREF: sub_405AE6+605j
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_406235
; ---------------------------------------------------------------------------

loc_406115:				; CODE XREF: sub_405AE6+5E9j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_40621C
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40616F
		cmp	[ebp+var_24], 0
		jnz	short loc_40616F
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_40], edx ;	char *
		mov	[esp+48h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax ; int
		call	sub_4062CE
		jmp	loc_406213
; ---------------------------------------------------------------------------

loc_40616F:				; CODE XREF: sub_405AE6+651j
					; sub_405AE6+657j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40619D
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_40619D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_406213
; ---------------------------------------------------------------------------

loc_40619D:				; CODE XREF: sub_405AE6+696j
					; sub_405AE6+6A9j
		cmp	[ebp+var_1C], 0
		jnz	short loc_4061AF
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_406213
; ---------------------------------------------------------------------------

loc_4061AF:				; CODE XREF: sub_405AE6+6BBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4061E5
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4061E5
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4061E5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_406213
; ---------------------------------------------------------------------------

loc_4061E5:				; CODE XREF: sub_405AE6+6D1j
					; sub_405AE6+6DEj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_40], edx ;	char *
		mov	[esp+48h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax ; int
		call	sub_4062CE
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_406213:				; CODE XREF: sub_405AE6+684j
					; sub_405AE6+6B5j ...
		mov	[ebp+var_18], offset asc_40DAC8	; "x"
		jmp	short loc_406235
; ---------------------------------------------------------------------------

loc_40621C:				; CODE XREF: sub_405AE6+640j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_406235:				; CODE XREF: sub_405AE6+62Aj
					; sub_405AE6+734j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406248
		cmp	[ebp+var_24], 0
		jz	short loc_4062A7

loc_406248:				; CODE XREF: sub_405AE6+75Aj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_4062A7
; ---------------------------------------------------------------------------

loc_406260:				; CODE XREF: sub_405AE6+4BCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_406298
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_4062A8
; ---------------------------------------------------------------------------

loc_406298:				; CODE XREF: sub_405AE6+785j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_405B4A
; ---------------------------------------------------------------------------

loc_4062A7:				; CODE XREF: sub_405AE6+760j
					; sub_405AE6+778j
		nop

loc_4062A8:				; CODE XREF: sub_405AE6+74j
					; sub_405AE6+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_405AE6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4062CE(int, int, char	*)
sub_4062CE	proc near		; CODE XREF: .text:0040555Fp
					; sub_405AE6+454p ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_4062E5
		mov	eax, 0
		jmp	short loc_4062EA
; ---------------------------------------------------------------------------

loc_4062E5:				; CODE XREF: sub_4062CE+Ej
		mov	eax, 0Ah

loc_4062EA:				; CODE XREF: sub_4062CE+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_406318
		cmp	eax, 4
		jz	loc_4063A5
		cmp	eax, 1
		jnz	loc_40644A

loc_406318:				; CODE XREF: sub_4062CE+36j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 80000000h
		jz	short loc_406354
		cmp	[ebp+var_10], 7FFFFFFFh
		jnz	short loc_406376

loc_406354:				; CODE XREF: sub_4062CE+7Bj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_406376
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	locret_406458
; ---------------------------------------------------------------------------

loc_406376:				; CODE XREF: sub_4062CE+84j
					; sub_4062CE+92j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	short loc_40638C
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx
		jmp	short loc_406395
; ---------------------------------------------------------------------------

loc_40638C:				; CODE XREF: sub_4062CE+B1j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx

loc_406395:				; CODE XREF: sub_4062CE+BCj
		mov	eax, 0
		jmp	locret_406458
; ---------------------------------------------------------------------------

loc_40639F:				; CODE XREF: sub_4062CE+F7j
		add	[ebp+arg_8], 1
		jmp	short loc_4063A6
; ---------------------------------------------------------------------------

loc_4063A5:				; CODE XREF: sub_4062CE+3Bj
		nop

loc_4063A6:				; CODE XREF: sub_4062CE+D5j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_4063C7
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Str], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_40639F

loc_4063C7:				; CODE XREF: sub_4062CE+E0j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4063EC
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_406458
; ---------------------------------------------------------------------------

loc_4063EC:				; CODE XREF: sub_4062CE+101j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_406443
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_406443
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_406458
; ---------------------------------------------------------------------------

loc_406443:				; CODE XREF: sub_4062CE+154j
					; sub_4062CE+162j
		mov	eax, 0
		jmp	short locret_406458
; ---------------------------------------------------------------------------

loc_40644A:				; CODE XREF: sub_4062CE+44j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_406458:				; CODE XREF: sub_4062CE+A3j
					; sub_4062CE+CCj ...
		leave
		retn
sub_4062CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40645A	proc near		; CODE XREF: sub_4064E1+152p

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_18], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_18]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4064D8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4064D8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_4064C3
		add	[ebp+var_8], 1
		jmp	short loc_4064C3
; ---------------------------------------------------------------------------

loc_4064B9:				; CODE XREF: sub_40645A+7Cj
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1
		jmp	short loc_4064C4
; ---------------------------------------------------------------------------

loc_4064C3:				; CODE XREF: sub_40645A+57j
					; sub_40645A+5Dj
		nop

loc_4064C4:				; CODE XREF: sub_40645A+67j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4064D8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4064B9

loc_4064D8:				; CODE XREF: sub_40645A+34j
					; sub_40645A+41j ...
		mov	eax, [ebp+var_8]
		add	esp, 14h
		pop	edi
		pop	ebp
		retn
sub_40645A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4064E1	proc near		; CODE XREF: sub_405AE6+1D7p
					; sub_405AE6+5C6p

Code		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		call	sub_406BC0
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DA8A ; "\n"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		mov	[esp+58h+Code],	2Ah
		call	sub_406FBD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_4065A5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 31h
		jnz	short loc_4065A5
		mov	[esp+58h+Code],	28h
		call	sub_406FBD
		mov	[ebp+var_C], eax
		mov	[esp+58h+var_50], 0
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+Code],	1
		call	sub_404B0E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4065A5
		mov	eax, [ebp+var_C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4065A5
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DA8A ; "\n"
		mov	[esp+58h+Code],	1
		call	sub_404B0E

loc_4065A5:				; CODE XREF: sub_4064E1+3Bj
					; sub_4064E1+49j ...
		mov	[esp+58h+Code],	29h
		call	sub_406FBD
		mov	[ebp+var_C], eax
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+var_50], offset asc_40DA8A ; "\n"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_406B5C
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_406653
; ---------------------------------------------------------------------------

loc_4065F4:				; CODE XREF: sub_4064E1+17Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40664F
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_406627
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_40664F

loc_406627:				; CODE XREF: sub_4064E1+131j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+58h+Code],	eax
		call	sub_40645A
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_40664F
		cmp	[ebp+var_14], 22h
		jg	short loc_40664F
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_40664F:				; CODE XREF: sub_4064E1+121j
					; sub_4064E1+144j ...
		add	[ebp+var_10], 1

loc_406653:				; CODE XREF: sub_4064E1+111j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4065F4
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_406697
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+var_50], offset asc_40DA8A ; "\n"
		mov	[esp+58h+var_54], offset aOptions ; "Options:"
		mov	[esp+58h+Code],	0
		call	sub_404B0E

loc_406697:				; CODE XREF: sub_4064E1+190j
		mov	[ebp+var_10], 0
		jmp	loc_406B23
; ---------------------------------------------------------------------------

loc_4066A3:				; CODE XREF: sub_4064E1+64Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4066D3
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_4066D3
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_406B1E

loc_4066D3:				; CODE XREF: sub_4064E1+1D5j
					; sub_4064E1+1DFj
		cmp	[ebp+var_C], 0
		jz	loc_40677D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	loc_40677D
		add	[ebp+var_C], 1
		jmp	short loc_406752
; ---------------------------------------------------------------------------

loc_4066F1:				; CODE XREF: sub_4064E1+279j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_406726
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40674E
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DA8A ; "\n"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		jmp	short loc_40674E
; ---------------------------------------------------------------------------

loc_406726:				; CODE XREF: sub_4064E1+218j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	[ebp+var_1A], al
		mov	[ebp+var_19], 0
		mov	[esp+58h+var_50], 0
		lea	eax, [ebp+var_1A]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+Code],	0
		call	sub_404B0E

loc_40674E:				; CODE XREF: sub_4064E1+225j
					; sub_4064E1+243j
		add	[ebp+var_C], 1

loc_406752:				; CODE XREF: sub_4064E1+20Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4066F1
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DA8A ; "\n"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		jmp	loc_406B1F
; ---------------------------------------------------------------------------

loc_40677D:				; CODE XREF: sub_4064E1+1F6j
					; sub_4064E1+204j
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_406875
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_1A], al
		mov	[ebp+var_19], 0
		mov	[esp+58h+var_4C], 0
		lea	eax, [ebp+var_1A]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], offset asc_40DAD3 ; "	-"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_406891
		cmp	[ebp+var_C], 0
		jz	loc_406891
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	loc_406891
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DAD6 ; "	"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_406851
; ---------------------------------------------------------------------------

loc_406821:				; CODE XREF: sub_4064E1+382j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	[ebp+var_1A], al
		mov	[ebp+var_19], 0
		mov	[esp+58h+var_50], 0
		lea	eax, [ebp+var_1A]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_406851:				; CODE XREF: sub_4064E1+33Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406865
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_406821

loc_406865:				; CODE XREF: sub_4064E1+378j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406891
		add	[ebp+var_C], 1
		jmp	short loc_406891
; ---------------------------------------------------------------------------

loc_406875:				; CODE XREF: sub_4064E1+2B3j
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DAD8 ; "	  "
		mov	[esp+58h+Code],	0
		call	sub_404B0E

loc_406891:				; CODE XREF: sub_4064E1+2FCj
					; sub_4064E1+306j ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_4069DF
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_4068BE
		mov	eax, 2Ch
		jmp	short loc_4068C3
; ---------------------------------------------------------------------------

loc_4068BE:				; CODE XREF: sub_4064E1+3D4j
		mov	eax, 20h

loc_4068C3:				; CODE XREF: sub_4064E1+3DBj
		mov	[ebp+var_1A], al
		mov	[ebp+var_19], 0
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset asc_40DADC ; "	--"
		lea	eax, [ebp+var_1A]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	loc_40699D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	loc_40699D
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_40697A
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DAD6 ; "	"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		add	[ebp+var_14], 1
		jmp	short loc_40697A
; ---------------------------------------------------------------------------

loc_406948:				; CODE XREF: sub_4064E1+4ACj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	[ebp+var_1A], al
		mov	[ebp+var_19], 0
		mov	[esp+58h+var_50], 0
		lea	eax, [ebp+var_1A]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_40697B
; ---------------------------------------------------------------------------

loc_40697A:				; CODE XREF: sub_4064E1+443j
					; sub_4064E1+465j
		nop

loc_40697B:				; CODE XREF: sub_4064E1+497j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40698F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_406948

loc_40698F:				; CODE XREF: sub_4064E1+4A2j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40699D
		add	[ebp+var_C], 1

loc_40699D:				; CODE XREF: sub_4064E1+423j
					; sub_4064E1+431j ...
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DAD8 ; "	  "
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		add	[ebp+var_14], 3
		jmp	short loc_4069DF
; ---------------------------------------------------------------------------

loc_4069BF:				; CODE XREF: sub_4064E1+504j
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DAD6 ; "	"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		add	[ebp+var_14], 1

loc_4069DF:				; CODE XREF: sub_4064E1+3BEj
					; sub_4064E1+4DCj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_4069BF
		cmp	[ebp+var_C], 0
		jz	loc_406B00
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_406AF1
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_406AF1
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DA8A ; "\n"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		mov	[ebp+var_14], 0
		jmp	short loc_406A50
; ---------------------------------------------------------------------------

loc_406A30:				; CODE XREF: sub_4064E1+575j
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DAD6 ; "	"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		add	[ebp+var_14], 1

loc_406A50:				; CODE XREF: sub_4064E1+54Dj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_406A30
		jmp	loc_406AF1
; ---------------------------------------------------------------------------

loc_406A5D:				; CODE XREF: sub_4064E1+619j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_406AC3
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406AEB
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DA8A ; "\n"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		mov	[ebp+var_14], 0
		jmp	short loc_406AB9
; ---------------------------------------------------------------------------

loc_406A99:				; CODE XREF: sub_4064E1+5DEj
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DAD6 ; "	"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		add	[ebp+var_14], 1

loc_406AB9:				; CODE XREF: sub_4064E1+5B6j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_406A99
		jmp	short loc_406AEB
; ---------------------------------------------------------------------------

loc_406AC3:				; CODE XREF: sub_4064E1+584j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	[ebp+var_1A], al
		mov	[ebp+var_19], 0
		mov	[esp+58h+var_50], 0
		lea	eax, [ebp+var_1A]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+Code],	0
		call	sub_404B0E

loc_406AEB:				; CODE XREF: sub_4064E1+591j
					; sub_4064E1+5E0j
		add	[ebp+var_C], 1
		jmp	short loc_406AF2
; ---------------------------------------------------------------------------

loc_406AF1:				; CODE XREF: sub_4064E1+518j
					; sub_4064E1+524j ...
		nop

loc_406AF2:				; CODE XREF: sub_4064E1+60Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_406A5D

loc_406B00:				; CODE XREF: sub_4064E1+50Aj
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DA8A ; "\n"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		jmp	short loc_406B1F
; ---------------------------------------------------------------------------

loc_406B1E:				; CODE XREF: sub_4064E1+1ECj
		nop

loc_406B1F:				; CODE XREF: sub_4064E1+297j
					; sub_4064E1+63Bj
		add	[ebp+var_10], 1

loc_406B23:				; CODE XREF: sub_4064E1+1BDj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4066A3
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_406B5C
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset aASingleDashMay ; "\n(A single	dash may be used instead of"...
		mov	[esp+58h+Code],	0
		call	sub_404B0E

loc_406B5C:				; CODE XREF: sub_4064E1+FEj
					; sub_4064E1+65Dj
		mov	[esp+58h+Code],	13h
		call	sub_406FBD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406BA8
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset asc_40DA8A ; "\n"
		mov	[esp+58h+Code],	0
		call	sub_404B0E
		mov	[esp+58h+var_50], 0
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+Code],	0
		call	sub_404B0E

loc_406BA8:				; CODE XREF: sub_4064E1+68Ej
		mov	[esp+58h+Code],	0
		call	sub_404BD2
		mov	[esp+58h+Code],	0 ; Code
		call	exit
sub_4064E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406BC0	proc near		; CODE XREF: sub_405AE6+212p
					; sub_4064E1+7p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+var_38], 0Bh
		call	sub_406FBD
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], 0
		call	sub_404B0E
		mov	[esp+38h+var_38], 0Ch
		call	sub_406FBD
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406C2A
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], offset asc_40DB19 ; ")"
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], offset asc_40DB1B ; "	("
		mov	[esp+38h+var_38], 0
		call	sub_404B0E

loc_406C2A:				; CODE XREF: sub_406BC0+3Dj
		mov	[esp+38h+var_38], 0Dh
		call	sub_406FBD
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], offset asc_40DA8A ; "\n"
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], offset asc_40DAD6 ; "	"
		mov	[esp+38h+var_38], 0
		call	sub_404B0E
		mov	[ebp+var_C], 14h
		jmp	short loc_406CA2
; ---------------------------------------------------------------------------

loc_406C67:				; CODE XREF: sub_406BC0+E6j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_406FBD
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406C9E
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], offset asc_40DA8A ; "\n"
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], 0
		call	sub_404B0E

loc_406C9E:				; CODE XREF: sub_406BC0+B9j
		add	[ebp+var_C], 1

loc_406CA2:				; CODE XREF: sub_406BC0+A5j
		cmp	[ebp+var_C], 1Dh
		jle	short loc_406C67
		mov	[esp+38h+var_38], 0Eh
		call	sub_406FBD
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406CE0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], offset asc_40DA8A ; "\n"
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], 0
		call	sub_404B0E

loc_406CE0:				; CODE XREF: sub_406BC0+FBj
		mov	[esp+38h+var_38], 0Ah
		call	sub_406FBD
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406D18
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], offset asc_40DA8A ; "\n"
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], 0
		call	sub_404B0E

loc_406D18:				; CODE XREF: sub_406BC0+133j
		mov	[esp+38h+var_38], 0Fh
		call	sub_406FBD
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406D48
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], 0
		call	sub_404B0E

loc_406D48:				; CODE XREF: sub_406BC0+16Bj
		mov	[esp+38h+var_38], 12h
		call	sub_406FBD
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406D78
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], 0
		call	sub_404B0E

loc_406D78:				; CODE XREF: sub_406BC0+19Bj
		mov	[ebp+var_C], 1Eh
		jmp	short loc_406DB4
; ---------------------------------------------------------------------------

loc_406D81:				; CODE XREF: sub_406BC0+1F8j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_406FBD
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406DB0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], 0
		call	sub_404B0E

loc_406DB0:				; CODE XREF: sub_406BC0+1D3j
		add	[ebp+var_C], 1

loc_406DB4:				; CODE XREF: sub_406BC0+1BFj
		cmp	[ebp+var_C], 27h
		jle	short loc_406D81
		mov	[esp+38h+var_38], 0
		call	sub_404BD2
		leave
		retn
sub_406BC0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_406E48
		mov	dword ptr [esp], 0Eh
		call	sub_406FBD
		mov	esi, eax
		mov	dword ptr [esp], 0Dh
		call	sub_406FBD
		mov	ebx, eax
		mov	dword ptr [esp], 0Bh
		call	sub_406FBD
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], offset asc_40DA8A ; "\n"
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], offset asc_40DB1E ; "; "
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], offset asc_40DAD6 ; " "
		mov	[esp+4], eax
		mov	dword ptr [esp], 1
		call	sub_404B0E
		mov	dword ptr [esp], 1
		call	sub_404BD2
		jmp	loc_406FB5
; ---------------------------------------------------------------------------

loc_406E48:				; CODE XREF: .text:00406DD5j
		cmp	dword ptr [ebp+8], 1
		jnz	loc_406ED7
		mov	dword ptr [esp], 28h
		call	sub_406FBD
		mov	[ebp-1Ch], eax
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 1
		call	sub_404B0E
		mov	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406ECB
		mov	eax, [ebp-1Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_406ECB
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset asc_40DA8A ; "\n"
		mov	dword ptr [esp], 1
		call	sub_404B0E

loc_406ECB:				; CODE XREF: .text:00406E84j
					; .text:00406EADj
		mov	dword ptr [esp], 2
		call	exit
; ---------------------------------------------------------------------------

loc_406ED7:				; CODE XREF: .text:00406E4Cj
		cmp	dword ptr [ebp+8], 2
		jnz	loc_406FB5
		mov	dword ptr [esp], 2Ah
		call	sub_406FBD
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0
		jz	loc_406F7D
		mov	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 31h
		jnz	short loc_406F7D
		mov	dword ptr [esp], 28h
		call	sub_406FBD
		mov	[ebp-1Ch], eax
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 1
		call	sub_404B0E
		mov	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406F7D
		mov	eax, [ebp-1Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_406F7D
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset asc_40DA8A ; "\n"
		mov	dword ptr [esp], 1
		call	sub_404B0E

loc_406F7D:				; CODE XREF: .text:00406EF4j
					; .text:00406F02j ...
		mov	dword ptr [esp], 29h
		call	sub_406FBD
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], offset asc_40DA8A ; "\n"
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_404B0E
		mov	dword ptr [esp], 0
		call	exit
; ---------------------------------------------------------------------------

loc_406FB5:				; CODE XREF: .text:00406E43j
					; .text:00406EDBj
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406FBD	proc near		; CODE XREF: sub_4049B0+15p
					; sub_404A09+15p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_40F180
		test	eax, eax
		jz	short loc_406FDC
		mov	edx, ds:dword_40F180
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_40F180
		jmp	short loc_406FE1
; ---------------------------------------------------------------------------

loc_406FDC:				; CODE XREF: sub_406FBD+Dj
		mov	eax, 0

loc_406FE1:				; CODE XREF: sub_406FBD+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406FEF
		mov	eax, [ebp+var_C]
		jmp	short locret_407044
; ---------------------------------------------------------------------------

loc_406FEF:				; CODE XREF: sub_406FBD+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_407041 ; jumptable 00407001 default case
		mov	eax, ds:off_40DE60[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407003:				; CODE XREF: sub_406FBD+44j
					; DATA XREF: .rdata:off_40DE60o
		mov	[ebp+var_C], offset aLicenseGplv2Gn ; jumptable	00407001 case 10
		jmp	short loc_407041 ; jumptable 00407001 default case
; ---------------------------------------------------------------------------

loc_40700C:				; CODE XREF: sub_406FBD+44j
					; DATA XREF: .rdata:off_40DE60o
		mov	[ebp+var_C], offset aFoo ; jumptable 00407001 case 11
		jmp	short loc_407041 ; jumptable 00407001 default case
; ---------------------------------------------------------------------------

loc_407015:				; CODE XREF: sub_406FBD+44j
					; DATA XREF: .rdata:off_40DE60o
		mov	[ebp+var_C], offset a0_0 ; jumptable 00407001 case 13
		jmp	short loc_407041 ; jumptable 00407001 default case
; ---------------------------------------------------------------------------

loc_40701E:				; CODE XREF: sub_406FBD+44j
					; DATA XREF: .rdata:off_40DE60o
		mov	[ebp+var_C], offset aCopyrightCYear ; jumptable	00407001 case 14
		jmp	short loc_407041 ; jumptable 00407001 default case
; ---------------------------------------------------------------------------

loc_407027:				; CODE XREF: sub_406FBD+44j
					; DATA XREF: .rdata:off_40DE60o
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	00407001 case 15
		jmp	short loc_407041 ; jumptable 00407001 default case
; ---------------------------------------------------------------------------

loc_407030:				; CODE XREF: sub_406FBD+44j
					; DATA XREF: .rdata:off_40DE60o
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	00407001 case 16
		jmp	short loc_407041 ; jumptable 00407001 default case
; ---------------------------------------------------------------------------

loc_407039:				; CODE XREF: sub_406FBD+44j
					; DATA XREF: .rdata:off_40DE60o
		mov	[ebp+var_C], offset dword_40DE5C ; jumptable 00407001 cases 40,41
		nop

loc_407041:				; CODE XREF: sub_406FBD+3Bj
					; sub_406FBD+44j ...
		mov	eax, [ebp+var_C] ; jumptable 00407001 default case

locret_407044:				; CODE XREF: sub_406FBD+30j
		leave
		retn
sub_406FBD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407046	proc near		; CODE XREF: sub_40318A+2Ep

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_40F180, eax
		pop	ebp
		retn
sub_407046	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407054	proc near		; CODE XREF: sub_4040FA+345p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_407054	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407059	proc near		; CODE XREF: sub_4040FA+87p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_407059	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407063	proc near		; CODE XREF: sub_40468F+84p
		push	ebp
		mov	ebp, esp
		mov	eax, 0FFFFFFFFh
		pop	ebp
		retn
sub_407063	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407070	proc near		; CODE XREF: sub_407198+161p
					; sub_407198+1CDp ...
		push	ebp
		mov	ebp, esp
		mov	eax, offset dword_40DEE0
		pop	ebp
		retn
sub_407070	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40707A	proc near		; CODE XREF: sub_4075F2+104p
					; sub_4075F2+13Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_4070C8
; ---------------------------------------------------------------------------

loc_407082:				; CODE XREF: sub_40707A+52j
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_write
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_4070B9
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_4070C7
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4070D3
; ---------------------------------------------------------------------------

loc_4070B9:				; CODE XREF: sub_40707A+28j
		mov	eax, [ebp+var_C]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+var_C]
		add	[ebp+arg_4], eax
		jmp	short loc_4070C8
; ---------------------------------------------------------------------------

loc_4070C7:				; CODE XREF: sub_40707A+36j
		nop

loc_4070C8:				; CODE XREF: sub_40707A+6j
					; sub_40707A+4Bj
		cmp	[ebp+arg_8], 0
		jnz	short loc_407082
		mov	eax, 0

locret_4070D3:				; CODE XREF: sub_40707A+3Dj
		leave
		retn
sub_40707A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4070D5	proc near		; CODE XREF: sub_407198+103p
					; sub_407198+136p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		jmp	loc_407184
; ---------------------------------------------------------------------------

loc_4070F8:				; CODE XREF: sub_4070D5+B3j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_read
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jns	short loc_40712F
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_407183
		mov	eax, 0FFFFFFFFh
		jmp	short locret_407196
; ---------------------------------------------------------------------------

loc_40712F:				; CODE XREF: sub_4070D5+43j
		cmp	[ebp+var_14], 0
		jnz	short loc_407140
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		jmp	short loc_407191
; ---------------------------------------------------------------------------

loc_407140:				; CODE XREF: sub_4070D5+5Ej
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_14]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		jmp	short loc_40716B
; ---------------------------------------------------------------------------

loc_407163:				; CODE XREF: sub_4070D5+A4j
		sub	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_40716B:				; CODE XREF: sub_4070D5+8Cj
		cmp	[ebp+var_14], 0
		jz	short loc_40717B
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_407163

loc_40717B:				; CODE XREF: sub_4070D5+9Aj
		cmp	[ebp+var_14], 0
		jnz	short loc_407190
		jmp	short loc_407184
; ---------------------------------------------------------------------------

loc_407183:				; CODE XREF: sub_4070D5+51j
		nop

loc_407184:				; CODE XREF: sub_4070D5+1Ej
					; sub_4070D5+ACj
		cmp	[ebp+var_C], 0
		jnz	loc_4070F8
		jmp	short loc_407191
; ---------------------------------------------------------------------------

loc_407190:				; CODE XREF: sub_4070D5+AAj
		nop

loc_407191:				; CODE XREF: sub_4070D5+69j
					; sub_4070D5+B9j
		mov	eax, 0

locret_407196:				; CODE XREF: sub_4070D5+58j
		leave
		retn
sub_4070D5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407198	proc near		; CODE XREF: sub_40758D+19p
					; sub_408AA6+25p

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
File		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		add	eax, 30h
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_4071BC
		mov	eax, 0FFFFFFFFh
		jmp	loc_407587
; ---------------------------------------------------------------------------

loc_4071BC:				; CODE XREF: sub_407198+18j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+80Ch]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_4072A5
		mov	ecx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		add	eax, 420h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+80Ch], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40720C
; ---------------------------------------------------------------------------

loc_407208:				; CODE XREF: sub_407198+87j
		add	[ebp+var_C], 1

loc_40720C:				; CODE XREF: sub_407198+6Ej
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_10]
		jge	short loc_407221
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_407208

loc_407221:				; CODE XREF: sub_407198+7Aj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_10]
		jge	short loc_407242
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_28], eax
		mov	[ebp+var_10], 0
		jmp	loc_4072D6
; ---------------------------------------------------------------------------

loc_407242:				; CODE XREF: sub_407198+8Fj
		cmp	[ebp+var_10], 3E9h
		jle	short loc_407267
		mov	[esp+48h+Size],	0ACh ; int
		mov	[esp+48h+Src], offset a____Pinentry_0 ;	"../../pinentry-0.9.4/assuan/assuan-buff"...
		mov	[esp+48h+Dst], offset aAtticlenLinele ;	"atticlen < LINELENGTH"
		call	sub_40B3F0

loc_407267:				; CODE XREF: sub_407198+B1j
		mov	eax, [ebp+arg_0]
		lea	ebx, [eax+2Ch]
		mov	eax, 3EAh
		sub	eax, [ebp+var_10]
		mov	ecx, eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		add	edx, [ebp+var_24]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_38], ebx
		lea	ebx, [ebp+var_28]
		mov	[esp+48h+File],	ebx
		mov	[esp+48h+Size],	ecx
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	sub_4070D5
		mov	[ebp+var_14], eax
		jmp	short loc_4072D6
; ---------------------------------------------------------------------------

loc_4072A5:				; CODE XREF: sub_407198+34j
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_38], edx
		lea	edx, [ebp+var_28]
		mov	[esp+48h+File],	edx
		mov	[esp+48h+Size],	3EAh
		mov	edx, [ebp+var_24]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	sub_4070D5
		mov	[ebp+var_14], eax

loc_4072D6:				; CODE XREF: sub_407198+A5j
					; sub_407198+10Bj
		cmp	[ebp+var_14], 0
		jz	short loc_40732E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_407324
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+48h+Dst], eax ; int
		call	strerror
		mov	ebx, eax
		call	sub_407070
		mov	ecx, offset aSPErrorS ;	"%s[%p]	<- [Error: %s]\n"
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+24h]
		mov	[esp+48h+var_38], ebx
		mov	ebx, [ebp+arg_0]
		mov	[esp+48h+File],	ebx
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+Src], ecx ; Format
		mov	[esp+48h+Dst], edx ; File
		call	fprintf

loc_407324:				; CODE XREF: sub_407198+14Cj
		mov	eax, 500010Eh
		jmp	loc_407587
; ---------------------------------------------------------------------------

loc_40732E:				; CODE XREF: sub_407198+142j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jnz	short loc_407396
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	short loc_40735B
		mov	[esp+48h+Size],	0BDh ; int
		mov	[esp+48h+Src], offset a____Pinentry_0 ;	"../../pinentry-0.9.4/assuan/assuan-buff"...
		mov	[esp+48h+Dst], offset aCtxInbound_eof ;	"ctx->inbound.eof"
		call	sub_40B3F0

loc_40735B:				; CODE XREF: sub_407198+1A5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40738C
		call	sub_407070
		mov	ecx, offset aSPEof ; "%s[%p] <-	[EOF]\n"
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+24h]
		mov	ebx, [ebp+arg_0]
		mov	[esp+48h+File],	ebx
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+Src], ecx ; Format
		mov	[esp+48h+Dst], edx ; File
		call	fprintf

loc_40738C:				; CODE XREF: sub_407198+1CBj
		mov	eax, 0FFFFFFFFh
		jmp	loc_407587
; ---------------------------------------------------------------------------

loc_407396:				; CODE XREF: sub_407198+19Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+810h], 0
		mov	eax, [ebp+var_28]
		add	eax, [ebp+var_10]
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 0
		jmp	loc_407521
; ---------------------------------------------------------------------------

loc_4073B8:				; CODE XREF: sub_407198+38Fj
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	loc_40751D
		mov	eax, [ebp+var_C]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_28]
		cmp	edx, eax
		jge	short loc_407442
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		add	eax, 420h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_24]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_28]
		sub	eax, [ebp+var_C]
		mov	[ebp+var_20], eax
		jmp	short loc_407427
; ---------------------------------------------------------------------------

loc_4073F9:				; CODE XREF: sub_407198+293j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_407410
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+810h], 1

loc_407410:				; CODE XREF: sub_407198+269j
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_1C]
		mov	[eax], dl
		add	[ebp+var_1C], 1
		add	[ebp+var_18], 1
		sub	[ebp+var_20], 1

loc_407427:				; CODE XREF: sub_407198+25Fj
		cmp	[ebp+var_20], 0
		jnz	short loc_4073F9
		mov	eax, [ebp+var_28]
		mov	edx, eax
		sub	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+80Ch], edx
		sub	[ebp+var_C], 1

loc_407442:				; CODE XREF: sub_407198+23Cj
		cmp	[ebp+var_C], 0
		jz	short loc_40745C
		mov	eax, [ebp+var_C]
		sub	eax, 1
		add	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_40745C
		sub	[ebp+var_C], 1

loc_40745C:				; CODE XREF: sub_407198+2AEj
					; sub_407198+2BEj
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+41Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_407516
		call	sub_407070
		mov	ecx, offset aSP	; "%s[%p] <- "
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+24h]
		mov	ebx, [ebp+arg_0]
		mov	[esp+48h+File],	ebx
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+Src], ecx ; Format
		mov	[esp+48h+Dst], edx ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4074D9
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+24h]
		mov	eax, offset aConfidentialDa ; "[Confidential data not shown]"
		mov	[esp+48h+File],	edx ; File
		mov	[esp+48h+Size],	1Dh ; Count
		mov	[esp+48h+Src], 1 ; Size
		mov	[esp+48h+Dst], eax ; Str
		call	fwrite
		jmp	short loc_407500
; ---------------------------------------------------------------------------

loc_4074D9:				; CODE XREF: sub_407198+316j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+41Ch]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		lea	ecx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+48h+Size],	edx ; size_t
		mov	[esp+48h+Src], ecx ; void *
		mov	[esp+48h+Dst], eax ; FILE *
		call	sub_407C9D

loc_407500:				; CODE XREF: sub_407198+33Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+48h+Src], eax ; File
		mov	[esp+48h+Dst], 0Ah ; Ch
		call	putc

loc_407516:				; CODE XREF: sub_407198+2E1j
		mov	eax, 0
		jmp	short loc_407587
; ---------------------------------------------------------------------------

loc_40751D:				; CODE XREF: sub_407198+22Bj
		add	[ebp+var_C], 1

loc_407521:				; CODE XREF: sub_407198+21Bj
		mov	eax, [ebp+var_28]
		cmp	[ebp+var_C], eax
		jl	loc_4073B8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40755E
		call	sub_407070
		mov	ecx, offset aSPInvalidLine ; "%s[%p] <-	[Invalid line]\n"
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+24h]
		mov	ebx, [ebp+arg_0]
		mov	[esp+48h+File],	ebx
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+Src], ecx ; Format
		mov	[esp+48h+Dst], edx ; File
		call	fprintf

loc_40755E:				; CODE XREF: sub_407198+39Dj
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+41Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_407582
		mov	eax, 5000106h
		jmp	short loc_407587
; ---------------------------------------------------------------------------

loc_407582:				; CODE XREF: sub_407198+3E1j
		mov	eax, 5000107h

loc_407587:				; CODE XREF: sub_407198+1Fj
					; sub_407198+191j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_407198	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40758D	proc near		; CODE XREF: .text:00402A4Fp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_4075A0
		mov	eax, 5000105h
		jmp	short locret_4075CC
; ---------------------------------------------------------------------------

loc_4075A0:				; CODE XREF: sub_40758D+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_407198
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+30h]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+41Ch]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_C]

locret_4075CC:				; CODE XREF: sub_40758D+11j
		leave
		retn
sub_40758D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4075EB
		mov	eax, [ebp+8]
		mov	eax, [eax+810h]
		test	eax, eax
		jz	short loc_4075EB
		mov	eax, 1
		jmp	short loc_4075F0
; ---------------------------------------------------------------------------

loc_4075EB:				; CODE XREF: .text:004075D5j
					; .text:004075E2j
		mov	eax, 0

loc_4075F0:				; CODE XREF: .text:004075E9j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4075F2(int, void *)
sub_4075F2	proc near		; CODE XREF: .text:004029F7p
					; sub_407AA6+6Ap ...

File		= dword	ptr -38h
Format		= dword	ptr -34h
Count		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40760A
		mov	eax, 5000105h
		jmp	loc_407745
; ---------------------------------------------------------------------------

loc_40760A:				; CODE XREF: sub_4075F2+Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_4076C0
		call	sub_407070
		mov	ecx, offset aSP_0 ; "%s[%p] -> "
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+24h]
		mov	ebx, [ebp+arg_0]
		mov	[esp+38h+var_2C], ebx
		mov	[esp+38h+Count], eax
		mov	[esp+38h+Format], ecx ;	Format
		mov	[esp+38h+File],	edx ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_407672
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+24h]
		mov	eax, offset aConfidentialDa ; "[Confidential data not shown]"
		mov	[esp+38h+var_2C], edx ;	File
		mov	[esp+38h+Count], 1Dh ; Count
		mov	[esp+38h+Format], 1 ; Size
		mov	[esp+38h+File],	eax ; Str
		call	fwrite
		jmp	short loc_4076AA
; ---------------------------------------------------------------------------

loc_407672:				; CODE XREF: sub_4075F2+55j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+Count], edx ; size_t
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+Format], edx ;	void *
		mov	[esp+38h+File],	eax ; FILE *
		call	sub_407C9D

loc_4076AA:				; CODE XREF: sub_4075F2+7Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+Format], eax ;	File
		mov	[esp+38h+File],	0Ah ; Ch
		call	putc

loc_4076C0:				; CODE XREF: sub_4075F2+20j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+814h]
		mov	[esp+38h+Count], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+Format], edx
		mov	[esp+38h+File],	eax
		call	sub_40707A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40770B
		mov	[ebp+var_C], 500010Fh

loc_40770B:				; CODE XREF: sub_4075F2+110j
		cmp	[ebp+var_C], 0
		jnz	short loc_407742
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+814h]
		mov	[esp+38h+Count], 1
		mov	[esp+38h+Format], offset asc_40DFAD ; "\n"
		mov	[esp+38h+File],	eax
		call	sub_40707A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_407742
		mov	[ebp+var_C], 500010Fh

loc_407742:				; CODE XREF: sub_4075F2+11Dj
					; sub_4075F2+147j
		mov	eax, [ebp+var_C]

loc_407745:				; CODE XREF: sub_4075F2+13j
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4075F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40774C	proc near		; CODE XREF: sub_407AA6+85p

Dest		= dword	ptr -28h
Format		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0C0Ch]
		test	eax, eax
		jz	short loc_407770
		mov	eax, 0
		jmp	loc_407952
; ---------------------------------------------------------------------------

loc_407770:				; CODE XREF: sub_40774C+18j
		mov	eax, [ebp+var_14]
		add	eax, 81Ch
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0C08h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_C], eax
		jmp	loc_407937
; ---------------------------------------------------------------------------

loc_407792:				; CODE XREF: sub_40774C+1EFj
		cmp	[ebp+var_10], 0
		jnz	loc_40781E
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	44h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	20h
		add	[ebp+var_C], 1
		add	[ebp+var_10], 2
		jmp	short loc_40781E
; ---------------------------------------------------------------------------

loc_4077B6:				; CODE XREF: sub_40774C+DFj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_4077D4
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_4077D4
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_407803

loc_4077D4:				; CODE XREF: sub_40774C+72j
					; sub_40774C+7Cj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x_0 ; "%%%02X"
		mov	[esp+28h+Count], edx
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_C], 3
		add	[ebp+var_10], 3
		add	[ebp+arg_4], 1
		jmp	short loc_40781A
; ---------------------------------------------------------------------------

loc_407803:				; CODE XREF: sub_40774C+86j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		add	[ebp+arg_4], 1
		add	[ebp+var_10], 1

loc_40781A:				; CODE XREF: sub_40774C+B5j
		sub	[ebp+arg_8], 1

loc_40781E:				; CODE XREF: sub_40774C+4Aj
					; sub_40774C+68j
		cmp	[ebp+arg_8], 0
		jz	short loc_40782D
		cmp	[ebp+var_10], 3E5h
		jbe	short loc_4077B6

loc_40782D:				; CODE XREF: sub_40774C+D6j
		cmp	[ebp+var_10], 3E5h
		jbe	loc_407937
		mov	eax, [ebp+var_14]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_4078DA
		call	sub_407070
		mov	ecx, offset aSP_0 ; "%s[%p] -> "
		mov	edx, [ebp+var_14]
		mov	edx, [edx+24h]
		mov	ebx, [ebp+var_14]
		mov	[esp+28h+File],	ebx
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Format], ecx ;	Format
		mov	[esp+28h+Dest],	edx ; File
		call	fprintf
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4078A2
		mov	eax, [ebp+var_14]
		mov	edx, [eax+24h]
		mov	eax, offset aConfidentialDa ; "[Confidential data not shown]"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 1Dh ; Count
		mov	[esp+28h+Format], 1 ; Size
		mov	[esp+28h+Dest],	eax ; Str
		call	fwrite
		jmp	short loc_4078C4
; ---------------------------------------------------------------------------

loc_4078A2:				; CODE XREF: sub_40774C+12Bj
		mov	eax, [ebp+var_14]
		lea	ecx, [eax+81Ch]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_10]
		mov	[esp+28h+Count], edx ; size_t
		mov	[esp+28h+Format], ecx ;	void *
		mov	[esp+28h+Dest],	eax ; FILE *
		call	sub_407C9D

loc_4078C4:				; CODE XREF: sub_40774C+154j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+24h]
		mov	[esp+28h+Format], eax ;	File
		mov	[esp+28h+Dest],	0Ah ; Ch
		call	putc

loc_4078DA:				; CODE XREF: sub_40774C+F6j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0Ah
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_14]
		lea	ecx, [eax+81Ch]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+814h]
		mov	edx, [ebp+var_10]
		mov	[esp+28h+Count], edx
		mov	[esp+28h+Format], ecx
		mov	[esp+28h+Dest],	eax
		call	sub_40707A
		test	eax, eax
		jz	short loc_407925
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0C0Ch], 500010Fh
		mov	eax, 0
		jmp	short loc_407952
; ---------------------------------------------------------------------------

loc_407925:				; CODE XREF: sub_40774C+1C3j
		mov	eax, [ebp+var_14]
		add	eax, 81Ch
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0

loc_407937:				; CODE XREF: sub_40774C+41j
					; sub_40774C+E8j
		cmp	[ebp+arg_8], 0
		jnz	loc_407792
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+0C08h], edx
		mov	eax, 0

loc_407952:				; CODE XREF: sub_40774C+1Fj
					; sub_40774C+1D7j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_40774C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407958	proc near		; CODE XREF: sub_407AA6+35p

File		= dword	ptr -28h
Format		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0C0Ch]
		test	eax, eax
		jz	short loc_40797C
		mov	eax, 0
		jmp	loc_407AA0
; ---------------------------------------------------------------------------

loc_40797C:				; CODE XREF: sub_407958+18j
		mov	eax, [ebp+var_C]
		add	eax, 81Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0C08h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		add	[ebp+var_10], eax
		cmp	[ebp+var_14], 0
		jz	loc_407A9B
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_407A43
		call	sub_407070
		mov	ecx, offset aSP_0 ; "%s[%p] -> "
		mov	edx, [ebp+var_C]
		mov	edx, [edx+24h]
		mov	ebx, [ebp+var_C]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Format], ecx ;	Format
		mov	[esp+28h+File],	edx ; File
		call	fprintf
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_407A0B
		mov	eax, [ebp+var_C]
		mov	edx, [eax+24h]
		mov	eax, offset aConfidentialDa ; "[Confidential data not shown]"
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 1Dh ; Count
		mov	[esp+28h+Format], 1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		jmp	short loc_407A2D
; ---------------------------------------------------------------------------

loc_407A0B:				; CODE XREF: sub_407958+88j
		mov	eax, [ebp+var_C]
		lea	ecx, [eax+81Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		mov	[esp+28h+Count], edx ; size_t
		mov	[esp+28h+Format], ecx ;	void *
		mov	[esp+28h+File],	eax ; FILE *
		call	sub_407C9D

loc_407A2D:				; CODE XREF: sub_407958+B1j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	[esp+28h+Format], eax ;	File
		mov	[esp+28h+File],	0Ah ; Ch
		call	putc

loc_407A43:				; CODE XREF: sub_407958+53j
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0Ah
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		lea	ecx, [eax+81Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+814h]
		mov	edx, [ebp+var_14]
		mov	[esp+28h+Count], edx
		mov	[esp+28h+Format], ecx
		mov	[esp+28h+File],	eax
		call	sub_40707A
		test	eax, eax
		jz	short loc_407A8E
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0C0Ch], 500010Fh
		mov	eax, 0
		jmp	short loc_407AA0
; ---------------------------------------------------------------------------

loc_407A8E:				; CODE XREF: sub_407958+120j
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0C08h], 0

loc_407A9B:				; CODE XREF: sub_407958+45j
		mov	eax, 0

loc_407AA0:				; CODE XREF: sub_407958+1Fj
					; sub_407958+134j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_407958	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407AA6	proc near		; CODE XREF: sub_4040FA+2E6p
					; sub_4040FA+30Ap ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_407ABC
		mov	eax, 5000105h
		jmp	locret_407B4D
; ---------------------------------------------------------------------------

loc_407ABC:				; CODE XREF: sub_407AA6+Aj
		cmp	[ebp+arg_4], 0
		jnz	short loc_407ACF
		cmp	[ebp+arg_8], 0
		jz	short loc_407ACF
		mov	eax, 5000105h
		jmp	short locret_407B4D
; ---------------------------------------------------------------------------

loc_407ACF:				; CODE XREF: sub_407AA6+1Aj
					; sub_407AA6+20j
		cmp	[ebp+arg_4], 0
		jnz	short loc_407B17
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_407958
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C0Ch]
		test	eax, eax
		jz	short loc_407AF8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C0Ch]
		jmp	short locret_407B4D
; ---------------------------------------------------------------------------

loc_407AF8:				; CODE XREF: sub_407AA6+45j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_407B48
		mov	[esp+18h+var_14], offset aEnd ;	"END"
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_4075F2
		jmp	short locret_407B4D
; ---------------------------------------------------------------------------

loc_407B17:				; CODE XREF: sub_407AA6+2Dj
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40774C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C0Ch]
		test	eax, eax
		jz	short loc_407B48
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C0Ch]
		jmp	short locret_407B4D
; ---------------------------------------------------------------------------

loc_407B48:				; CODE XREF: sub_407AA6+5Aj
					; sub_407AA6+95j
		mov	eax, 0

locret_407B4D:				; CODE XREF: sub_407AA6+11j
					; sub_407AA6+27j ...
		leave
		retn
sub_407AA6	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407B50	proc near		; CODE XREF: sub_402DF2+83p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	off_40C240, eax
		mov	eax, [ebp+arg_4]
		mov	off_40C244, eax
		mov	eax, [ebp+arg_8]
		mov	off_40C248, eax
		pop	ebp
		retn
sub_407B50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407B6D(size_t)
sub_407B6D	proc near		; CODE XREF: sub_407BA0+10p
					; .text:00408E76p ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	edx, off_40C240
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	edx ; malloc
		leave
		retn
sub_407B6D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407B83(void *, size_t)
sub_407B83	proc near		; CODE XREF: sub_40848F+16Cp

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	edx, off_40C244
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	edx ; realloc
		leave
		retn
sub_407B83	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407BA0	proc near		; CODE XREF: sub_40848F+FDp
					; sub_4090CD+1Ep

Dst		= dword	ptr -28h
Val		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		imul	eax, [ebp+arg_4]
		mov	[esp+28h+Dst], eax ; size_t
		call	sub_407B6D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_407BDE
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		imul	edx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Val], 0 ; Val
		mov	[esp+28h+Dst], eax ; Dst
		call	memset

loc_407BDE:				; CODE XREF: sub_407BA0+1Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407BA0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407BE3(void *)
sub_407BE3	proc near		; CODE XREF: sub_408AA6+263p
					; .text:00408E40p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_407BFD
		mov	edx, off_40C248
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	edx ; free

locret_407BFD:				; CODE XREF: sub_407BE3+Aj
		leave
		retn
sub_407BE3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407BFF	proc near		; CODE XREF: sub_407EF4+1Cp
					; .text:00407F5Bp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_4]
		pop	ebp
		retn
sub_407BFF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_407C2A
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[eax+20h], edx

loc_407C2A:				; CODE XREF: .text:00407C1Fj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_407C3D
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		jmp	short loc_407C42
; ---------------------------------------------------------------------------

loc_407C3D:				; CODE XREF: .text:00407C33j
		mov	eax, 0

loc_407C42:				; CODE XREF: .text:00407C3Bj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 0
		jz	short locret_407C71
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_407C68
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[esp], eax
		call	fflush

loc_407C68:				; CODE XREF: .text:00407C58j
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[eax+24h], edx

locret_407C71:				; CODE XREF: .text:00407C4Ej
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_407C86
		mov	eax, [ebp+8]
		mov	dword ptr [eax+0Ch], 1

loc_407C86:				; CODE XREF: .text:00407C7Aj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_407C9B
		mov	eax, [ebp+8]
		mov	dword ptr [eax+0Ch], 0

loc_407C9B:				; CODE XREF: .text:00407C8Fj
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407C9D(FILE *, void *, size_t)
sub_407C9D	proc near		; CODE XREF: sub_407198+363p
					; sub_4075F2+B3p ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_407CD7
; ---------------------------------------------------------------------------

loc_407CB1:				; CODE XREF: sub_407C9D+3Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_407CDD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jbe	short loc_407CCF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0A0h
		jbe	short loc_407CDD

loc_407CCF:				; CODE XREF: sub_407C9D+26j
		sub	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_407CD7:				; CODE XREF: sub_407C9D+12j
		cmp	[ebp+var_10], 0
		jnz	short loc_407CB1

loc_407CDD:				; CODE XREF: sub_407C9D+1Cj
					; sub_407C9D+30j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_407D16
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jz	short loc_407D16
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+Count], 1 ; Count
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Size],	eax ; Size
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short locret_407D89
; ---------------------------------------------------------------------------

loc_407D16:				; CODE XREF: sub_407C9D+4Aj
					; sub_407C9D+54j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; File
		mov	[esp+28h+Str], 5Bh ; Ch
		call	putc
		mov	[ebp+var_10], 0
		jmp	short loc_407D5B
; ---------------------------------------------------------------------------

loc_407D32:				; CODE XREF: sub_407C9D+C4j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x_1 ; " %02x"
		mov	[esp+28h+Count], edx
		mov	[esp+28h+Size],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; File
		call	fprintf
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_407D5B:				; CODE XREF: sub_407C9D+93j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	short loc_407D32
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; File
		mov	[esp+28h+Str], 20h ; Ch
		call	putc
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; File
		mov	[esp+28h+Str], 5Dh ; Ch
		call	putc

locret_407D89:				; CODE XREF: sub_407C9D+77j
		leave
		retn
sub_407C9D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp-10h], eax
		jmp	loc_407EE2
; ---------------------------------------------------------------------------

loc_407DA7:				; CODE XREF: .text:00407EEAj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_407DCD
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jbe	loc_407EC6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0A0h
		ja	loc_407EC6

loc_407DCD:				; CODE XREF: .text:00407DAFj
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 5Ch
		call	putc
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_407E02
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 6Eh
		call	putc
		jmp	loc_407EDE
; ---------------------------------------------------------------------------

loc_407E02:				; CODE XREF: .text:00407DE8j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_407E24
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 72h
		call	putc
		jmp	loc_407EDE
; ---------------------------------------------------------------------------

loc_407E24:				; CODE XREF: .text:00407E0Aj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_407E46
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 66h
		call	putc
		jmp	loc_407EDE
; ---------------------------------------------------------------------------

loc_407E46:				; CODE XREF: .text:00407E2Cj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_407E65
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 76h
		call	putc
		jmp	short loc_407EDE
; ---------------------------------------------------------------------------

loc_407E65:				; CODE XREF: .text:00407E4Ej
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_407E84
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 62h
		call	putc
		jmp	short loc_407EDE
; ---------------------------------------------------------------------------

loc_407E84:				; CODE XREF: .text:00407E6Dj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407EA3
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 30h
		call	putc
		jmp	short loc_407EDE
; ---------------------------------------------------------------------------

loc_407EA3:				; CODE XREF: .text:00407E8Cj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	fprintf
		jmp	short loc_407EDE
; ---------------------------------------------------------------------------

loc_407EC6:				; CODE XREF: .text:00407DB9j
					; .text:00407DC7j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	putc

loc_407EDE:				; CODE XREF: .text:00407DFDj
					; .text:00407E1Fj ...
		add	dword ptr [ebp-0Ch], 1

loc_407EE2:				; CODE XREF: .text:00407DA2j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_407DA7
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407EF4	proc near		; DATA XREF: sub_40848F+B8o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], offset aNoHandlerRegis ; "no handler registered"
		mov	[esp+18h+var_14], 5000050h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_407BFF
		leave
		retn
sub_407EF4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407F17	proc near		; DATA XREF: .data:0040C268o
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_407F17	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+0C40h]
		test	eax, eax
		jz	short loc_407F45
		mov	eax, [ebp+8]
		mov	edx, [eax+0C40h]
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx

loc_407F45:				; CODE XREF: .text:00407F32j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5000045h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407BFF
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_407F75
; ---------------------------------------------------------------------------

loc_407F71:				; CODE XREF: .text:00407F7Dj
					; .text:00407F87j
		add	dword ptr [ebp-0Ch], 1

loc_407F75:				; CODE XREF: .text:00407F6Fj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_407F71
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_407F71
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407FB3
		mov	dword ptr [esp+8], offset aArgumentRequir ; "argument required"
		mov	dword ptr [esp+4], 5000114h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407BFF
		jmp	loc_40819A
; ---------------------------------------------------------------------------

loc_407FB3:				; CODE XREF: .text:00407F91j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_407FDD
		mov	dword ptr [esp+8], offset aNoOptionNameGi ; "no	option name given"
		mov	dword ptr [esp+4], 5000114h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407BFF
		jmp	loc_40819A
; ---------------------------------------------------------------------------

loc_407FDD:				; CODE XREF: .text:00407FBBj
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_407FE9
; ---------------------------------------------------------------------------

loc_407FE5:				; CODE XREF: .text:0040800Fj
		add	dword ptr [ebp-10h], 1

loc_407FE9:				; CODE XREF: .text:00407FE3j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408011
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408011
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_408011
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_407FE5

loc_408011:				; CODE XREF: .text:00407FF1j
					; .text:00407FFBj ...
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_408118
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408033
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_408045

loc_408033:				; CODE XREF: .text:00408027j
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-10h], 1
		jmp	short loc_408045
; ---------------------------------------------------------------------------

loc_40803F:				; CODE XREF: .text:0040804Ej
					; .text:00408058j
		add	dword ptr [ebp-10h], 1
		jmp	short loc_408046
; ---------------------------------------------------------------------------

loc_408045:				; CODE XREF: .text:00408031j
					; .text:0040803Dj
		nop

loc_408046:				; CODE XREF: .text:00408043j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40803F
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_40803F
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_4080B2
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-10h], 1
		jmp	short loc_408074
; ---------------------------------------------------------------------------

loc_408070:				; CODE XREF: .text:0040807Cj
					; .text:00408086j
		add	dword ptr [ebp-10h], 1

loc_408074:				; CODE XREF: .text:0040806Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408070
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_408070
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4080B2
		mov	dword ptr [esp+8], offset aOptionArgument ; "option argument expected"
		mov	dword ptr [esp+4], 5000114h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407BFF
		jmp	loc_40819A
; ---------------------------------------------------------------------------

loc_4080B2:				; CODE XREF: .text:00408062j
					; .text:00408090j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408118
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-10h]
		mov	[ebp-14h], eax
		jmp	short loc_4080EA
; ---------------------------------------------------------------------------

loc_4080E6:				; CODE XREF: .text:004080FAj
					; .text:00408104j
		sub	dword ptr [ebp-14h], 1

loc_4080EA:				; CODE XREF: .text:004080E4j
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-10h]
		jbe	short loc_408106
		mov	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4080E6
		mov	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4080E6

loc_408106:				; CODE XREF: .text:004080F0j
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-10h]
		jbe	short loc_408118
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0

loc_408118:				; CODE XREF: .text:00408019j
					; .text:004080BAj ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_408140
		mov	eax, [ebp-0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_408140
		mov	eax, [ebp-0Ch]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408140
		add	dword ptr [ebp-0Ch], 2

loc_408140:				; CODE XREF: .text:00408120j
					; .text:0040812Dj ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_408167
		mov	dword ptr [esp+8], offset aOptionShouldNo ; "option should not begin with one dash"
		mov	dword ptr [esp+4], 5000114h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407BFF
		jmp	short loc_40819A
; ---------------------------------------------------------------------------

loc_408167:				; CODE XREF: .text:00408148j
		mov	eax, [ebp+8]
		mov	eax, [eax+0C44h]
		test	eax, eax
		jz	short loc_408195
		mov	eax, [ebp+8]
		mov	edx, [eax+0C44h]
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx
		jmp	short loc_40819A
; ---------------------------------------------------------------------------

loc_408195:				; CODE XREF: .text:00408172j
		mov	eax, 0

loc_40819A:				; CODE XREF: .text:00407FAEj
					; .text:00407FD8j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+0C38h]
		test	eax, eax
		jz	short loc_4081C4
		mov	eax, [ebp+8]
		mov	edx, [eax+0C38h]
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx

loc_4081C4:				; CODE XREF: .text:004081B1j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4096F9
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40973F
		mov	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5000045h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407BFF
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+0C3Ch]
		test	eax, eax
		jz	short loc_408228
		mov	eax, [ebp+8]
		mov	edx, [eax+0C3Ch]
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx

loc_408228:				; CODE XREF: .text:00408215j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4096F9
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40973F
		mov	eax, 0
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5000045h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407BFF
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408268(int, char *, int)
sub_408268	proc near		; CODE XREF: .text:004083DFp
					; .text:00408444p

Str		= dword	ptr -38h
EndPtr		= dword	ptr -34h
Radix		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 30h
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aFd	; "FD="
		mov	ecx, 3
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4082B8
		mov	[esp+38h+Radix], offset	aFdNExpected ; "FD=<n> expected"
		mov	[esp+38h+EndPtr], 5000114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_407BFF
		jmp	loc_4083BE
; ---------------------------------------------------------------------------

loc_4082B8:				; CODE XREF: sub_408268+2Ej
		add	[ebp+arg_4], 3
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4082D0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4082F0

loc_4082D0:				; CODE XREF: sub_408268+5Cj
		mov	[esp+38h+Radix], offset	aNumberRequired	; "number required"
		mov	[esp+38h+EndPtr], 5000114h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_407BFF
		jmp	loc_4083BE
; ---------------------------------------------------------------------------

loc_4082F0:				; CODE XREF: sub_408268+66j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	edx, [ebp+var_C]
		mov	[esp+38h+EndPtr], edx ;	EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		test	eax, eax
		jz	short loc_408328
		mov	eax, [ebp+var_C]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		jmp	short loc_408347
; ---------------------------------------------------------------------------

loc_408328:				; CODE XREF: sub_408268+AEj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1

loc_408347:				; CODE XREF: sub_408268+BEj
		mov	[esp+38h+Radix], eax ; Size
		mov	[esp+38h+EndPtr], 20h ;	Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Dst
		call	memset
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnz	short loc_40838A
		mov	[esp+38h+Radix], offset	aFdSameAsInboun	; "fd same as inbound fd"
		mov	[esp+38h+EndPtr], 5000118h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_407BFF
		jmp	short loc_4083BE
; ---------------------------------------------------------------------------

loc_40838A:				; CODE XREF: sub_408268+103j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+814h]
		cmp	edx, eax
		jnz	short loc_4083B9
		mov	[esp+38h+Radix], offset	aFdSameAsOutbou	; "fd same as outbound fd"
		mov	[esp+38h+EndPtr], 5000118h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_407BFF
		jmp	short loc_4083BE
; ---------------------------------------------------------------------------

loc_4083B9:				; CODE XREF: sub_408268+132j
		mov	eax, 0

loc_4083BE:				; CODE XREF: sub_408268+4Bj
					; sub_408268+83j ...
		add	esp, 30h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_408268	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408268
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4083F2
		mov	eax, [ebp-0Ch]
		jmp	short locret_408428
; ---------------------------------------------------------------------------

loc_4083F2:				; CODE XREF: .text:004083EBj
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax+0C50h], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+0C48h]
		test	eax, eax
		jz	short loc_408423
		mov	eax, [ebp+8]
		mov	edx, [eax+0C48h]
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx

loc_408423:				; CODE XREF: .text:00408409j
		mov	eax, 0

locret_408428:				; CODE XREF: .text:004083F0j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408268
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_408457
		mov	eax, [ebp-0Ch]
		jmp	short locret_40848D
; ---------------------------------------------------------------------------

loc_408457:				; CODE XREF: .text:00408450j
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax+0C54h], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+0C4Ch]
		test	eax, eax
		jz	short loc_408488
		mov	eax, [ebp+8]
		mov	edx, [eax+0C4Ch]
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx

loc_408488:				; CODE XREF: .text:0040846Ej
		mov	eax, 0

locret_40848D:				; CODE XREF: .text:00408455j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40848F	proc near		; CODE XREF: sub_40473A+8Cp
					; sub_40878D+49p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_4084AC
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4084AC
		mov	[ebp+arg_8], 0

loc_4084AC:				; CODE XREF: sub_40848F+Aj
					; sub_40848F+14j
		cmp	[ebp+arg_4], 0FFh
		jg	loc_408541
		cmp	[ebp+arg_8], 0
		jz	short loc_4084C9
		mov	eax, 5000105h
		jmp	locret_4086B9
; ---------------------------------------------------------------------------

loc_4084C9:				; CODE XREF: sub_40848F+2Ej
		mov	[ebp+var_C], 0
		jmp	short loc_408512
; ---------------------------------------------------------------------------

loc_4084D2:				; CODE XREF: sub_40848F+92j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_40C260
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_40850E
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_40C260
		mov	eax, [eax]
		mov	[ebp+arg_8], eax
		cmp	[ebp+arg_C], 0
		jnz	short loc_408525
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_40C260
		mov	eax, [eax+8]
		mov	[ebp+arg_C], eax
		jmp	short loc_408525
; ---------------------------------------------------------------------------

loc_40850E:				; CODE XREF: sub_40848F+54j
		add	[ebp+var_C], 1

loc_408512:				; CODE XREF: sub_40848F+41j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_40C260
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4084D2
		jmp	short loc_408526
; ---------------------------------------------------------------------------

loc_408525:				; CODE XREF: sub_40848F+6Aj
					; sub_40848F+7Dj
		nop

loc_408526:				; CODE XREF: sub_40848F+94j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_40C260
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_408541
		mov	eax, 5000105h
		jmp	locret_4086B9
; ---------------------------------------------------------------------------

loc_408541:				; CODE XREF: sub_40848F+24j
					; sub_40848F+A6j
		cmp	[ebp+arg_C], 0
		jnz	short loc_40854E
		mov	[ebp+arg_C], offset sub_407EF4

loc_40854E:				; CODE XREF: sub_40848F+B6j
		cmp	[ebp+arg_8], 0
		jnz	short loc_40855E
		mov	eax, 5000105h
		jmp	locret_4086B9
; ---------------------------------------------------------------------------

loc_40855E:				; CODE XREF: sub_40848F+C3j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C2Ch]
		test	eax, eax
		jnz	short loc_4085C0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0C34h], 32h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C34h]
		mov	[esp+28h+var_24], 0Ch
		mov	[esp+28h+var_28], eax
		call	sub_407BA0
		mov	edx, [ebp+arg_0]
		mov	[edx+0C2Ch], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C2Ch]
		test	eax, eax
		jnz	short loc_4085B1
		mov	eax, 5008056h
		jmp	locret_4086B9
; ---------------------------------------------------------------------------

loc_4085B1:				; CODE XREF: sub_40848F+116j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0C30h], 0
		jmp	short loc_408634
; ---------------------------------------------------------------------------

loc_4085C0:				; CODE XREF: sub_40848F+DAj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0C30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C34h]
		cmp	edx, eax
		jb	short loc_408634
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0C34h]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, [eax+78h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C2Ch]
		mov	[esp+28h+var_24], edx ;	size_t
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407B83
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_408613
		mov	eax, 5008056h
		jmp	locret_4086B9
; ---------------------------------------------------------------------------

loc_408613:				; CODE XREF: sub_40848F+178j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+0C2Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C34h]
		lea	edx, [eax+32h]
		mov	eax, [ebp+arg_0]
		mov	[eax+0C34h], edx

loc_408634:				; CODE XREF: sub_40848F+12Fj
					; sub_40848F+145j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0C2Ch]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0C30h]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, [ecx+eax]
		mov	eax, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0C2Ch]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0C30h]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, [ecx+eax]
		mov	eax, [ebp+arg_4]
		mov	[edx+4], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0C2Ch]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0C30h]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, [ecx+eax]
		mov	eax, [ebp+arg_C]
		mov	[edx+8], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C30h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0C30h], edx
		mov	eax, 0

locret_4086B9:				; CODE XREF: sub_40848F+35j
					; sub_40848F+ADj ...
		leave
		retn
sub_40848F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4086CB
		mov	eax, 5000105h
		jmp	short loc_4086DC
; ---------------------------------------------------------------------------

loc_4086CB:				; CODE XREF: .text:004086C2j
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[eax+0C38h], edx
		mov	eax, 0

loc_4086DC:				; CODE XREF: .text:004086C9j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4086DE	proc near		; CODE XREF: sub_404803+D8p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jnz	short loc_4086EE
		mov	eax, 5000105h
		jmp	short loc_4086FF
; ---------------------------------------------------------------------------

loc_4086EE:				; CODE XREF: sub_4086DE+7j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0C3Ch], edx
		mov	eax, 0

loc_4086FF:				; CODE XREF: sub_4086DE+Ej
		pop	ebp
		retn
sub_4086DE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_408711
		mov	eax, 5000105h
		jmp	short loc_408722
; ---------------------------------------------------------------------------

loc_408711:				; CODE XREF: .text:00408708j
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[eax+0C40h], edx
		mov	eax, 0

loc_408722:				; CODE XREF: .text:0040870Fj
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408724	proc near		; CODE XREF: sub_404803+C5p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jnz	short loc_408734
		mov	eax, 5000105h
		jmp	short loc_408745
; ---------------------------------------------------------------------------

loc_408734:				; CODE XREF: sub_408724+7j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0C44h], edx
		mov	eax, 0

loc_408745:				; CODE XREF: sub_408724+Ej
		pop	ebp
		retn
sub_408724	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_408757
		mov	eax, 5000105h
		jmp	short loc_408768
; ---------------------------------------------------------------------------

loc_408757:				; CODE XREF: .text:0040874Ej
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[eax+0C48h], edx
		mov	eax, 0

loc_408768:				; CODE XREF: .text:00408755j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_40877A
		mov	eax, 5000105h
		jmp	short loc_40878B
; ---------------------------------------------------------------------------

loc_40877A:				; CODE XREF: .text:00408771j
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[eax+0C4Ch], edx
		mov	eax, 0

loc_40878B:				; CODE XREF: .text:00408778j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40878D	proc near		; CODE XREF: sub_4090CD+AEp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_4087ED
; ---------------------------------------------------------------------------

loc_40879C:				; CODE XREF: sub_40878D+6Fj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_40C260
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4087E9
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_40C260
		mov	eax, [eax+4]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40848F
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4087E9
		mov	eax, [ebp+var_10]
		jmp	short locret_408803
; ---------------------------------------------------------------------------

loc_4087E9:				; CODE XREF: sub_40878D+1Fj
					; sub_40878D+55j
		add	[ebp+var_C], 1

loc_4087ED:				; CODE XREF: sub_40878D+Dj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, offset off_40C260
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40879C
		mov	eax, 0

locret_408803:				; CODE XREF: sub_40878D+5Aj
		leave
		retn
sub_40878D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408805	proc near		; CODE XREF: sub_4088E6+37p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], 5000045h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_407BFF
		leave
		retn
sub_408805	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408828	proc near		; CODE XREF: sub_4088E6+134p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_40887F
		mov	eax, 0
		jmp	loc_4088E4
; ---------------------------------------------------------------------------

loc_40883D:				; CODE XREF: sub_408828+6Aj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40885F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ah
		jg	short loc_40885F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		movsx	eax, al
		jmp	short loc_408868
; ---------------------------------------------------------------------------

loc_40885F:				; CODE XREF: sub_408828+1Dj
					; sub_408828+27j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al

loc_408868:				; CODE XREF: sub_408828+35j
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		movsx	edx, dl
		cmp	eax, edx
		jnz	short loc_408896
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_408880
; ---------------------------------------------------------------------------

loc_40887F:				; CODE XREF: sub_408828+9j
		nop

loc_408880:				; CODE XREF: sub_408828+55j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408897
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40883D
		jmp	short loc_408897
; ---------------------------------------------------------------------------

loc_408896:				; CODE XREF: sub_408828+4Bj
		nop

loc_408897:				; CODE XREF: sub_408828+60j
					; sub_408828+6Cj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4088DF
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4088C9
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ah
		jg	short loc_4088C9
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		movsx	eax, al
		jmp	short loc_4088D2
; ---------------------------------------------------------------------------

loc_4088C9:				; CODE XREF: sub_408828+87j
					; sub_408828+91j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al

loc_4088D2:				; CODE XREF: sub_408828+9Fj
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		movsx	edx, dl
		sub	eax, edx
		jmp	short loc_4088E4
; ---------------------------------------------------------------------------

loc_4088DF:				; CODE XREF: sub_408828+7Dj
		mov	eax, 0

loc_4088E4:				; CODE XREF: sub_408828+10j
					; sub_408828+B5j
		pop	ebp
		retn
sub_408828	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4088E6(int, char *, int)
sub_4088E6	proc near		; CODE XREF: sub_408AA6+94p

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jnz	short loc_408927
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_408927
		mov	eax, [ebp+arg_8]
		lea	edx, [eax-2]
		mov	eax, [ebp+arg_4]
		add	eax, 2
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	sub_408805
		jmp	locret_408AA4
; ---------------------------------------------------------------------------

loc_408927:				; CODE XREF: sub_4088E6+Ej
					; sub_4088E6+1Bj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_408933
; ---------------------------------------------------------------------------

loc_40892F:				; CODE XREF: sub_4088E6+69j
		add	[ebp+var_C], 1

loc_408933:				; CODE XREF: sub_4088E6+47j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408951
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408951
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40892F

loc_408951:				; CODE XREF: sub_4088E6+55j
					; sub_4088E6+5Fj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_408979
		mov	[esp+28h+var_20], offset aLeadingWhiteSp ; "leading white-space"
		mov	[esp+28h+Str2],	5000114h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	sub_407BFF
		jmp	locret_408AA4
; ---------------------------------------------------------------------------

loc_408979:				; CODE XREF: sub_4088E6+71j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4089A7
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		jmp	short loc_408993
; ---------------------------------------------------------------------------

loc_40898F:				; CODE XREF: sub_4088E6+B5j
					; sub_4088E6+BFj
		add	[ebp+var_C], 1

loc_408993:				; CODE XREF: sub_4088E6+A7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40898F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_40898F

loc_4089A7:				; CODE XREF: sub_4088E6+9Bj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4089D9
; ---------------------------------------------------------------------------

loc_4089BF:				; CODE XREF: sub_4088E6+113j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_4089FD
		add	[ebp+var_14], 1

loc_4089D9:				; CODE XREF: sub_4088E6+D7j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0C2Ch]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4089BF
		jmp	short loc_4089FE
; ---------------------------------------------------------------------------

loc_4089FD:				; CODE XREF: sub_4088E6+EDj
		nop

loc_4089FE:				; CODE XREF: sub_4088E6+115j
		cmp	[ebp+var_10], 0
		jnz	short loc_408A4C
		mov	[ebp+var_14], 0
		jmp	short loc_408A27
; ---------------------------------------------------------------------------

loc_408A0D:				; CODE XREF: sub_4088E6+161j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax
		call	sub_408828
		test	eax, eax
		jz	short loc_408A4B
		add	[ebp+var_14], 1

loc_408A27:				; CODE XREF: sub_4088E6+125j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0C2Ch]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_408A0D
		jmp	short loc_408A4C
; ---------------------------------------------------------------------------

loc_408A4B:				; CODE XREF: sub_4088E6+13Bj
		nop

loc_408A4C:				; CODE XREF: sub_4088E6+11Cj
					; sub_4088E6+163j
		cmp	[ebp+var_10], 0
		jnz	short loc_408A6F
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+Str2],	5000113h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	sub_407BFF
		jmp	short locret_408AA4
; ---------------------------------------------------------------------------

loc_408A6F:				; CODE XREF: sub_4088E6+16Aj
		mov	eax, [ebp+var_18]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_18]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0C2Ch]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	edx

locret_408AA4:				; CODE XREF: sub_4088E6+3Cj
					; sub_4088E6+8Ej ...
		leave
		retn
sub_4088E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408AA6	proc near		; CODE XREF: sub_408D25+Cp
					; .text:00408D5Dp

File		= dword	ptr -138h
Format		= dword	ptr -134h
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
Dest		= byte ptr -110h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 130h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_408AC5
		mov	eax, 5000108h
		jmp	loc_408D1B
; ---------------------------------------------------------------------------

loc_408AC5:				; CODE XREF: sub_408AA6+13j
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+File], eax
		call	sub_407198
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408AE1
		mov	eax, [ebp+var_C]
		jmp	loc_408D1B
; ---------------------------------------------------------------------------

loc_408AE1:				; CODE XREF: sub_408AA6+31j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+30h]
		cmp	al, 23h
		jz	short loc_408AF9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+41Ch]
		test	eax, eax
		jnz	short loc_408B03

loc_408AF9:				; CODE XREF: sub_408AA6+44j
		mov	eax, 0
		jmp	loc_408D1B
; ---------------------------------------------------------------------------

loc_408B03:				; CODE XREF: sub_408AA6+51j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0C0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0C08h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+41Ch]
		mov	edx, [ebp+arg_0]
		add	edx, 30h
		mov	[esp+138h+var_130], eax	; int
		mov	[esp+138h+Format], edx ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+File], eax ; int
		call	sub_4088E6
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+818h]
		test	eax, eax
		jz	short loc_408B8E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+818h]
		mov	[esp+138h+File], eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+818h], 0
		cmp	[ebp+var_C], 0
		jnz	short loc_408BC8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C0Ch]
		test	eax, eax
		jz	short loc_408BC8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C0Ch]
		mov	[ebp+var_C], eax
		jmp	short loc_408BC8
; ---------------------------------------------------------------------------

loc_408B8E:				; CODE XREF: sub_408AA6+A7j
		mov	[esp+138h+var_130], 0
		mov	[esp+138h+Format], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+File], eax
		call	sub_407AA6
		cmp	[ebp+var_C], 0
		jnz	short loc_408BC8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C0Ch]
		test	eax, eax
		jz	short loc_408BC8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C0Ch]
		mov	[ebp+var_C], eax

loc_408BC8:				; CODE XREF: sub_408AA6+CBj
					; sub_408AA6+D8j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_408BFC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_408BE0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		jmp	short loc_408BE5
; ---------------------------------------------------------------------------

loc_408BE0:				; CODE XREF: sub_408AA6+130j
		mov	eax, offset aOk	; "OK"

loc_408BE5:				; CODE XREF: sub_408AA6+138j
		mov	[esp+138h+Format], eax ; void *
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+File], eax ; int
		call	sub_4075F2
		mov	[ebp+var_C], eax
		jmp	loc_408CEC
; ---------------------------------------------------------------------------

loc_408BFC:				; CODE XREF: sub_408AA6+126j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_408C2B
		mov	[esp+138h+Format], offset aOkClosingConne ; "OK	closing	connection"
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+File], eax ; int
		call	sub_4075F2
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0C28h]
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+File], eax
		call	edx
		jmp	loc_408CEC
; ---------------------------------------------------------------------------

loc_408C2B:				; CODE XREF: sub_408AA6+15Aj
		cmp	[ebp+var_C], 63h
		jg	short loc_408C61
		mov	eax, [ebp+var_C]
		mov	[esp+138h+File], eax
		call	sub_409268
		mov	edx, offset aErrDServerFaul ; "ERR %d server fault (%.50s)"
		mov	[esp+138h+var_12C], eax
		mov	[esp+138h+var_130], 5000050h
		mov	[esp+138h+Format], edx ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+138h+File], eax ; Dest
		call	sprintf
		jmp	short loc_408CD4
; ---------------------------------------------------------------------------

loc_408C61:				; CODE XREF: sub_408AA6+189j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jnz	short loc_408C75
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		jmp	short loc_408C7A
; ---------------------------------------------------------------------------

loc_408C75:				; CODE XREF: sub_408AA6+1C5j
		mov	eax, 0

loc_408C7A:				; CODE XREF: sub_408AA6+1CDj
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_408C88
		mov	esi, [ebp+var_10]
		jmp	short loc_408C8D
; ---------------------------------------------------------------------------

loc_408C88:				; CODE XREF: sub_408AA6+1DBj
		mov	esi, offset byte_40E112

loc_408C8D:				; CODE XREF: sub_408AA6+1E0j
		cmp	[ebp+var_10], 0
		jz	short loc_408C9A
		mov	ebx, offset asc_40E113 ; " - "
		jmp	short loc_408C9F
; ---------------------------------------------------------------------------

loc_408C9A:				; CODE XREF: sub_408AA6+1EBj
		mov	ebx, offset byte_40E112

loc_408C9F:				; CODE XREF: sub_408AA6+1F2j
		mov	eax, [ebp+var_C]
		mov	[esp+138h+File], eax
		call	sub_409268
		mov	edx, offset aErrD_50sS_100s ; "ERR %d %.50s%s%.100s"
		mov	[esp+138h+var_124], esi
		mov	[esp+138h+var_128], ebx
		mov	[esp+138h+var_12C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+138h+var_130], eax
		mov	[esp+138h+Format], edx ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+138h+File], eax ; Dest
		call	sprintf

loc_408CD4:				; CODE XREF: sub_408AA6+1B9j
		lea	eax, [ebp+Dest]
		mov	[esp+138h+Format], eax ; void *
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+File], eax ; int
		call	sub_4075F2
		mov	[ebp+var_C], eax

loc_408CEC:				; CODE XREF: sub_408AA6+151j
					; sub_408AA6+180j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_408D18
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+138h+File], eax ; void *
		call	sub_407BE3
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0

loc_408D18:				; CODE XREF: sub_408AA6+258j
		mov	eax, [ebp+var_C]

loc_408D1B:				; CODE XREF: sub_408AA6+1Aj
					; sub_408AA6+36j ...
		add	esp, 130h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_408AA6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D25	proc near		; CODE XREF: sub_404803+137p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h

loc_408D2B:				; CODE XREF: sub_408D25+18j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408AA6
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408D2B
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_408D4C
		mov	[ebp+var_C], 0

loc_408D4C:				; CODE XREF: sub_408D25+1Ej
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408D25	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408AA6
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	dword ptr [ebp-0Ch], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_408D8A
		cmp	dword ptr [ebp+14h], 1
		jle	short loc_408D8A
		cmp	dword ptr [ebp+0Ch], 0
		js	short loc_408D8A
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_408D94

loc_408D8A:				; CODE XREF: .text:00408D76j
					; .text:00408D7Cj ...
		mov	eax, 0FFFFFFFFh
		jmp	loc_408E14
; ---------------------------------------------------------------------------

loc_408D94:				; CODE XREF: .text:00408D88j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_408DBC
		mov	eax, [ebp+8]
		mov	eax, [eax+28h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_408E11
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp+10h]
		mov	edx, [ebp+8]
		mov	edx, [edx+28h]
		mov	[eax], edx
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_408E11
; ---------------------------------------------------------------------------

loc_408DBC:				; CODE XREF: .text:00408D98j
		mov	eax, [ebp+8]
		mov	eax, [eax+814h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_408DE2
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp+10h]
		mov	edx, [ebp+8]
		mov	edx, [edx+814h]
		mov	[eax], edx
		add	dword ptr [ebp-0Ch], 1

loc_408DE2:				; CODE XREF: .text:00408DC8j
		mov	eax, [ebp+8]
		mov	eax, [eax+818h]
		test	eax, eax
		jz	short loc_408E11
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp+10h]
		mov	eax, [ebp+8]
		mov	eax, [eax+818h]
		mov	[esp], eax
		call	_fileno
		mov	[ebx], eax
		add	dword ptr [ebp-0Ch], 1

loc_408E11:				; CODE XREF: .text:00408DA3j
					; .text:00408DBAj ...
		mov	eax, [ebp-0Ch]

loc_408E14:				; CODE XREF: .text:00408D8Fj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_408E31
		mov	eax, 5000105h
		jmp	loc_408EC8
; ---------------------------------------------------------------------------

loc_408E31:				; CODE XREF: .text:00408E25j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_408E51
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		mov	[esp], eax
		call	sub_407BE3
		mov	eax, [ebp+8]
		mov	dword ptr [eax+1Ch], 0
		jmp	short loc_408EC3
; ---------------------------------------------------------------------------

loc_408E51:				; CODE XREF: .text:00408E35j
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 4
		mov	[esp], eax
		call	sub_407B6D
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_408E8B
		mov	eax, 5008056h
		jmp	short loc_408EC8
; ---------------------------------------------------------------------------

loc_408E8B:				; CODE XREF: .text:00408E82j
		mov	edx, offset aOk_0 ; "OK	"
		mov	eax, [ebp-0Ch]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		lea	edx, [eax+3]
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		mov	[esp], eax
		call	sub_407BE3
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax+1Ch], edx

loc_408EC3:				; CODE XREF: .text:00408E4Fj
		mov	eax, 0

loc_408EC8:				; CODE XREF: .text:00408E2Cj
					; .text:00408E89j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408ECE(int, char *, char *)
sub_408ECE	proc near		; CODE XREF: sub_4040FA+124p
					; sub_4040FA+240p ...

Dest		= dword	ptr -138h
Source		= dword	ptr -134h
var_11C		= dword	ptr -11Ch
var_110		= byte ptr -110h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 130h
		cmp	[ebp+arg_0], 0
		jz	loc_4090A7
		cmp	[ebp+arg_4], 0
		jz	loc_4090A7
		cmp	[ebp+arg_8], 0
		jnz	short loc_408EFA
		mov	[ebp+arg_8], offset byte_40E112

loc_408EFA:				; CODE XREF: sub_408ECE+23j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFh
		ja	loc_408FFA
		mov	edx, offset aS_1 ; "S "
		lea	eax, [ebp+var_110]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Source], eax ; Source
		lea	eax, [ebp+var_110]
		mov	[esp+138h+Dest], eax ; Dest
		call	strcat
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408FE0
		mov	ebx, offset asc_40E133 ; " "
		lea	eax, [ebp+var_110]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+var_110]
		add	edx, eax
		movzx	eax, word ptr [ebx]
		mov	[edx], ax
		mov	eax, [ebp+arg_8]
		mov	[esp+138h+Source], eax ; Source
		lea	eax, [ebp+var_110]
		mov	[esp+138h+Dest], eax ; Dest
		call	strcat

loc_408FE0:				; CODE XREF: sub_408ECE+C0j
		lea	eax, [ebp+var_110]
		mov	[esp+138h+Source], eax ; void *
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Dest], eax ; int
		call	sub_4075F2
		jmp	loc_4090A8
; ---------------------------------------------------------------------------

loc_408FFA:				; CODE XREF: sub_408ECE+85j
		mov	eax, [ebp+var_C]
		mov	[esp+138h+Dest], eax ; size_t
		call	sub_407B6D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_4090A8
		mov	edx, offset aS_1 ; "S "
		mov	eax, [ebp+var_10]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Source], eax ; Source
		mov	eax, [ebp+var_10]
		mov	[esp+138h+Dest], eax ; Dest
		call	strcat
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_409088
		mov	ebx, offset asc_40E133 ; " "
		mov	eax, [ebp+var_10]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		mov	eax, [ebp+arg_8]
		mov	[esp+138h+Source], eax ; Source
		mov	eax, [ebp+var_10]
		mov	[esp+138h+Dest], eax ; Dest
		call	strcat

loc_409088:				; CODE XREF: sub_408ECE+173j
		mov	eax, [ebp+var_10]
		mov	[esp+138h+Source], eax ; void *
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Dest], eax ; int
		call	sub_4075F2
		mov	eax, [ebp+var_10]
		mov	[esp+138h+Dest], eax ; void *
		call	sub_407BE3
		jmp	short loc_4090A8
; ---------------------------------------------------------------------------

loc_4090A7:				; CODE XREF: sub_408ECE+Fj
					; sub_408ECE+19j
		nop

loc_4090A8:				; CODE XREF: sub_408ECE+127j
					; sub_408ECE+13Ej ...
		add	esp, 130h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_408ECE	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4090B4	proc near		; DATA XREF: sub_4090CD+84o
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_4090B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4090B9	proc near		; DATA XREF: sub_4090CD+91o
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_4090B9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4090C3	proc near		; DATA XREF: sub_4090CD+9Eo
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_4090C3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4090CD	proc near		; CODE XREF: sub_4091A3+Cp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	[esp+28h+var_24], 0C58h
		mov	[esp+28h+var_28], 1
		call	sub_407BA0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_409103
		mov	eax, 5008056h
		jmp	locret_4091A1
; ---------------------------------------------------------------------------

loc_409103:				; CODE XREF: sub_4090CD+2Aj
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0C50h], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0C54h], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+28h], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+814h], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0C18h], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0C1Ch], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0C20h], offset sub_4090B4
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0C24h], offset sub_4090B9
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0C28h], offset sub_4090C3
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40878D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_409196
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407BE3
		jmp	short loc_40919E
; ---------------------------------------------------------------------------

loc_409196:				; CODE XREF: sub_4090CD+BAj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_40919E:				; CODE XREF: sub_4090CD+C7j
		mov	eax, [ebp+var_10]

locret_4091A1:				; CODE XREF: sub_4090CD+31j
		leave
		retn
sub_4090CD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4091A3	proc near		; CODE XREF: sub_404803+1Fp

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4090CD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4091F6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 1
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	[eax+814h], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0C10h], 1

loc_4091F6:				; CODE XREF: sub_4091A3+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4091A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4091FB(void *)
sub_4091FB	proc near		; CODE XREF: sub_409230+30p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_40922E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+var_18], eax ;	void *
		call	sub_407BE3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+18h+var_18], eax ;	void *
		call	sub_407BE3
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	void *
		call	sub_407BE3

locret_40922E:				; CODE XREF: sub_4091FB+Aj
		leave
		retn
sub_4091FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409230(void *)
sub_409230	proc near		; CODE XREF: sub_404803+183p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_409265
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0C20h]
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0C20h], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	void *
		call	sub_4091FB

locret_409265:				; CODE XREF: sub_409230+Aj
		leave
		retn
sub_409230	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409268	proc near		; CODE XREF: sub_404803+33p
					; sub_404803+82p ...

Dest		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		cmp	eax, 5000106h
		jz	loc_4094EB
		cmp	eax, 5000106h
		ja	loc_40933C
		cmp	eax, 5000072h
		jz	loc_40950F
		cmp	eax, 5000072h
		ja	short loc_4092E9
		cmp	eax, 5000042h
		jz	loc_409518
		cmp	eax, 5000042h
		ja	short loc_4092C3
		test	eax, eax
		jz	loc_4093EC
		cmp	eax, 500003Eh
		jz	loc_40941C
		jmp	loc_409533
; ---------------------------------------------------------------------------

loc_4092C3:				; CODE XREF: sub_409268+41j
		cmp	eax, 5000050h
		jz	loc_4094B8
		cmp	eax, 5000063h
		jz	loc_4094F4
		cmp	eax, 5000045h
		jz	loc_4094AC
		jmp	loc_409533
; ---------------------------------------------------------------------------

loc_4092E9:				; CODE XREF: sub_409268+2Fj
		cmp	eax, 5000102h
		jz	loc_4094A0
		cmp	eax, 5000102h
		ja	short loc_409321
		cmp	eax, 50000AEh
		jz	loc_4094FD
		cmp	eax, 5000101h
		jz	loc_4093F8
		cmp	eax, 50000A6h
		jz	loc_409506
		jmp	loc_409533
; ---------------------------------------------------------------------------

loc_409321:				; CODE XREF: sub_409268+91j
		cmp	eax, 5000104h
		jz	loc_409470
		cmp	eax, 5000104h
		ja	loc_409410
		jmp	loc_409494
; ---------------------------------------------------------------------------

loc_40933C:				; CODE XREF: sub_409268+19j
		cmp	eax, 500010Eh
		jz	loc_409428
		cmp	eax, 500010Eh
		ja	short loc_409396
		cmp	eax, 500010Ah
		jz	loc_409488
		cmp	eax, 500010Ah
		ja	short loc_40937B
		cmp	eax, 5000108h
		jz	loc_409464
		cmp	eax, 5000108h
		ja	loc_40947C
		jmp	loc_4094E2
; ---------------------------------------------------------------------------

loc_40937B:				; CODE XREF: sub_409268+F6j
		cmp	eax, 500010Ch
		jz	loc_409458
		cmp	eax, 500010Ch
		ja	loc_409440
		jmp	loc_40944C
; ---------------------------------------------------------------------------

loc_409396:				; CODE XREF: sub_409268+E4j
		cmp	eax, 5000118h
		jz	loc_4094D9
		cmp	eax, 5000118h
		ja	short loc_4093CA
		cmp	eax, 5000113h
		jz	loc_4094C4
		cmp	eax, 5000114h
		jz	loc_4094D0
		cmp	eax, 500010Fh
		jz	short loc_409434
		jmp	loc_409533
; ---------------------------------------------------------------------------

loc_4093CA:				; CODE XREF: sub_409268+13Ej
		cmp	eax, 5008056h
		jz	short loc_409404
		cmp	eax, 5008066h
		jz	loc_40952A
		cmp	eax, 5008051h
		jz	loc_409521
		jmp	loc_409533
; ---------------------------------------------------------------------------

loc_4093EC:				; CODE XREF: sub_409268+45j
		mov	[ebp+var_C], offset aNoError ; "no error"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_4093F8:				; CODE XREF: sub_409268+A3j
		mov	[ebp+var_C], offset aGeneralError ; "general error"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409404:				; CODE XREF: sub_409268+167j
		mov	[ebp+var_C], offset aOutOfCore_2 ; "out	of core"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409410:				; CODE XREF: sub_409268+C9j
		mov	[ebp+var_C], offset aInvalidValue ; "invalid value"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_40941C:				; CODE XREF: sub_409268+50j
		mov	[ebp+var_C], offset aTimeout ; "timeout"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409428:				; CODE XREF: sub_409268+D9j
		mov	[ebp+var_C], offset aReadError_0 ; "read error"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409434:				; CODE XREF: sub_409268+15Bj
		mov	[ebp+var_C], offset aWriteError	; "write error"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409440:				; CODE XREF: sub_409268+123j
		mov	[ebp+var_C], offset aProblemStartin ; "problem starting	server"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_40944C:				; CODE XREF: sub_409268+129j
		mov	[ebp+var_C], offset aNotAServer	; "not a server"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409458:				; CODE XREF: sub_409268+118j
		mov	[ebp+var_C], offset aNotAClient	; "not a client"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409464:				; CODE XREF: sub_409268+FDj
		mov	[ebp+var_C], offset aNestedCommands ; "nested commands"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409470:				; CODE XREF: sub_409268+BEj
		mov	[ebp+var_C], offset aInvalidRespons ; "invalid response"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_40947C:				; CODE XREF: sub_409268+108j
		mov	[ebp+var_C], offset aNoDataCallback ; "no data callback"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409488:				; CODE XREF: sub_409268+EBj
		mov	[ebp+var_C], offset aNoInquireCallb ; "no inquire callback"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_409494:				; CODE XREF: sub_409268+CFj
		mov	[ebp+var_C], offset aConnectFailed ; "connect failed"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_4094A0:				; CODE XREF: sub_409268+86j
		mov	[ebp+var_C], offset aAcceptFailed ; "accept failed"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_4094AC:				; CODE XREF: sub_409268+76j
		mov	[ebp+var_C], offset aNotImplemented ; "not implemented"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_4094B8:				; CODE XREF: sub_409268+60j
		mov	[ebp+var_C], offset aServerFault ; "server fault"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_4094C4:				; CODE XREF: sub_409268+145j
		mov	[ebp+var_C], offset aUnknownCommand ; "unknown command"
		jmp	loc_409557
; ---------------------------------------------------------------------------

loc_4094D0:				; CODE XREF: sub_409268+150j
		mov	[ebp+var_C], offset aSyntaxError ; "syntax error"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_4094D9:				; CODE XREF: sub_409268+133j
		mov	[ebp+var_C], offset aParameterConfl ; "parameter conflict"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_4094E2:				; CODE XREF: sub_409268+10Ej
		mov	[ebp+var_C], offset aLineTooLong ; "line too long"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_4094EB:				; CODE XREF: sub_409268+Ej
		mov	[ebp+var_C], offset aLineNotTermina ; "line not	terminated"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_4094F4:				; CODE XREF: sub_409268+6Bj
		mov	[ebp+var_C], offset aCanceled ;	"canceled"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_4094FD:				; CODE XREF: sub_409268+98j
		mov	[ebp+var_C], offset aInvalidOptio_0 ; "invalid option"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_409506:				; CODE XREF: sub_409268+AEj
		mov	[ebp+var_C], offset aLocaleProblem ; "locale problem"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_40950F:				; CODE XREF: sub_409268+24j
		mov	[ebp+var_C], offset aNotConfirmed ; "not confirmed"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_409518:				; CODE XREF: sub_409268+36j
		mov	[ebp+var_C], offset aTooShort ;	"too short"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_409521:				; CODE XREF: sub_409268+179j
		mov	[ebp+var_C], offset aEnoent ; "enoent"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_40952A:				; CODE XREF: sub_409268+16Ej
		mov	[ebp+var_C], offset aEnotty ; "enotty"
		jmp	short loc_409557
; ---------------------------------------------------------------------------

loc_409533:				; CODE XREF: sub_409268+56j
					; sub_409268+7Cj ...
		mov	eax, offset aEcD ; "ec=%d"
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+Dest],	offset byte_40F188 ; Dest
		call	sprintf
		mov	[ebp+var_C], offset byte_40F188
		nop

loc_409557:				; CODE XREF: sub_409268+18Bj
					; sub_409268+197j ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409268	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_409573
		mov	eax, 5000105h
		jmp	loc_40960A
; ---------------------------------------------------------------------------

loc_409573:				; CODE XREF: .text:00409567j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_409593
		mov	eax, [ebp+8]
		mov	eax, [eax+18h]
		mov	[esp], eax
		call	sub_407BE3
		mov	eax, [ebp+8]
		mov	dword ptr [eax+18h], 0
		jmp	short loc_409605
; ---------------------------------------------------------------------------

loc_409593:				; CODE XREF: .text:00409577j
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 4
		mov	[esp], eax
		call	sub_407B6D
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4095CD
		mov	eax, 5008056h
		jmp	short loc_40960A
; ---------------------------------------------------------------------------

loc_4095CD:				; CODE XREF: .text:004095C4j
		mov	edx, offset aOk_1 ; "OK	"
		mov	eax, [ebp-0Ch]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		lea	edx, [eax+3]
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		mov	eax, [ebp+8]
		mov	eax, [eax+18h]
		mov	[esp], eax
		call	sub_407BE3
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax+18h], edx

loc_409605:				; CODE XREF: .text:00409591j
		mov	eax, 0

loc_40960A:				; CODE XREF: .text:0040956Ej
					; .text:004095CBj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409610	proc near		; CODE XREF: sub_404803+E6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_409626
		mov	eax, 5000105h
		jmp	locret_4096C1
; ---------------------------------------------------------------------------

loc_409626:				; CODE XREF: sub_409610+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C10h]
		cmp	eax, 1
		jle	short loc_40963E
		mov	eax, 0FFFFFFFFh
		jmp	locret_4096C1
; ---------------------------------------------------------------------------

loc_40963E:				; CODE XREF: sub_409610+22j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0C28h]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0C24h]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40966E
		mov	eax, [ebp+var_C]
		jmp	short locret_4096C1
; ---------------------------------------------------------------------------

loc_40966E:				; CODE XREF: sub_409610+57j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_409680
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		jmp	short loc_409685
; ---------------------------------------------------------------------------

loc_409680:				; CODE XREF: sub_409610+66j
		mov	eax, offset aOkYourOrdersPl ; "OK Your orders please"

loc_409685:				; CODE XREF: sub_409610+6Ej
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4075F2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4096A2
		mov	eax, [ebp+var_C]
		jmp	short locret_4096C1
; ---------------------------------------------------------------------------

loc_4096A2:				; CODE XREF: sub_409610+8Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C10h]
		test	eax, eax
		jz	short loc_4096BC
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0C10h], 2

loc_4096BC:				; CODE XREF: sub_409610+9Dj
		mov	eax, 0

locret_4096C1:				; CODE XREF: sub_409610+11j
					; sub_409610+29j ...
		leave
		retn
sub_409610	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4096D7
		mov	eax, [ebp+8]
		mov	eax, [eax+0C50h]
		jmp	short loc_4096DC
; ---------------------------------------------------------------------------

loc_4096D7:				; CODE XREF: .text:004096CAj
		mov	eax, 0FFFFFFFFh

loc_4096DC:				; CODE XREF: .text:004096D5j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4096F2
		mov	eax, [ebp+8]
		mov	eax, [eax+0C54h]
		jmp	short loc_4096F7
; ---------------------------------------------------------------------------

loc_4096F2:				; CODE XREF: .text:004096E5j
		mov	eax, 0FFFFFFFFh

loc_4096F7:				; CODE XREF: .text:004096F0j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4096F9	proc near		; CODE XREF: .text:004081CAp
					; .text:0040822Ep

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_409713
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C50h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40971A

loc_409713:				; CODE XREF: sub_4096F9+Aj
		mov	eax, 5000105h
		jmp	short locret_40973D
; ---------------------------------------------------------------------------

loc_40971A:				; CODE XREF: sub_4096F9+18j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C50h]
		mov	[esp+18h+var_18], eax
		call	_close
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0C50h], 0FFFFFFFFh
		mov	eax, 0

locret_40973D:				; CODE XREF: sub_4096F9+1Fj
		leave
		retn
sub_4096F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40973F	proc near		; CODE XREF: .text:004081D5p
					; .text:00408239p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_409759
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C54h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_409760

loc_409759:				; CODE XREF: sub_40973F+Aj
		mov	eax, 5000105h
		jmp	short locret_409783
; ---------------------------------------------------------------------------

loc_409760:				; CODE XREF: sub_40973F+18j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0C54h]
		mov	[esp+18h+var_18], eax
		call	_close
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0C54h], 0FFFFFFFFh
		mov	eax, 0

locret_409783:				; CODE XREF: sub_40973F+1Fj
		leave
		retn
sub_40973F	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409788(char *, char)
sub_409788	proc near		; CODE XREF: sub_4097F0+16p
					; sub_40980D+Dp ...

File		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	vfprintf
		leave
		retn
sub_409788	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_4097B7(char *, char)
sub_4097B7	proc near		; CODE XREF: sub_409821+1Ep
					; sub_409821+5Ep

File		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	vfprintf
		mov	[esp+28h+File],	1 ; Code
		call	exit
sub_4097B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4097F0	proc near		; CODE XREF: sub_4098B8+46p
					; sub_409978+56p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_40F1D4
		test	eax, eax
		jnz	short locret_40980B
		mov	[esp+18h+var_18], offset aWarningUsingIn ; "Warning: using insecure memory!\n"
		call	sub_409788

locret_40980B:				; CODE XREF: sub_4097F0+Dj
		leave
		retn
sub_4097F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40980D	proc near		; CODE XREF: sub_409821+81p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aPleaseNoteThat ; "Please note	that you don't have secure "...
		call	sub_409788
		leave
		retn
sub_40980D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409821	proc near		; CODE XREF: sub_409938+2Bp

Size		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	ds:Size, eax
		mov	eax, ds:dword_40F1CC
		test	eax, eax
		jz	short loc_409844
		mov	[esp+28h+Size],	offset aSecureMemoryIs ; "secure memory	is disabled"
		call	sub_4097B7
; ---------------------------------------------------------------------------

loc_409844:				; CODE XREF: sub_409821+15j
		mov	[ebp+var_C], 1000h
		mov	eax, ds:dword_40F1A8
		test	eax, eax
		jnz	short loc_409890
		mov	eax, ds:Size
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	ds:dword_40F1A4, eax
		mov	eax, ds:dword_40F1A4
		test	eax, eax
		jnz	short loc_409886
		mov	eax, ds:Size
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Size],	offset aCanTAllocateMe ; "can't allocate memory pool of %u bytes\"...
		call	sub_4097B7
; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Ah
; ---------------------------------------------------------------------------

loc_409886:				; CODE XREF: sub_409821+4Cj
		mov	ds:dword_40F1A8, 1

loc_409890:				; CODE XREF: sub_409821+31j
		mov	edx, ds:Size
		mov	eax, ds:dword_40F1A4
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+Size],	eax
		call	sub_40980D
		mov	ds:dword_40F1B4, 0
		leave
		retn
sub_409821	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4098B3	proc near		; CODE XREF: sub_409978+106p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_4098B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4098B8	proc near		; CODE XREF: sub_402DF2+56p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_40F1D8
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		and	eax, 1
		mov	ds:dword_40F1D4, eax
		mov	eax, [ebp+arg_0]
		and	eax, 2
		mov	ds:dword_40F1D8, eax
		cmp	[ebp+var_C], 0
		jz	short locret_409903
		mov	eax, ds:dword_40F1D8
		test	eax, eax
		jnz	short locret_409903
		mov	eax, ds:dword_40F1D0
		test	eax, eax
		jz	short locret_409903
		mov	ds:dword_40F1D0, 0
		call	sub_4097F0

locret_409903:				; CODE XREF: sub_4098B8+28j
					; sub_4098B8+31j ...
		leave
		retn
sub_4098B8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_40F1D4
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp-4], eax
		mov	eax, ds:dword_40F1D8
		test	eax, eax
		jz	short loc_40992B
		mov	eax, 2
		jmp	short loc_409930
; ---------------------------------------------------------------------------

loc_40992B:				; CODE XREF: .text:00409922j
		mov	eax, 0

loc_409930:				; CODE XREF: .text:00409929j
		or	[ebp-4], eax
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409938	proc near		; CODE XREF: sub_402DF2+4Ap

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_409976
		cmp	[ebp+arg_0], 3FFFh
		ja	short loc_409954
		mov	[ebp+arg_0], 4000h

loc_409954:				; CODE XREF: sub_409938+13j
		mov	eax, ds:dword_40F1A8
		test	eax, eax
		jnz	short loc_40996A
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_409821
		jmp	short locret_409976
; ---------------------------------------------------------------------------

loc_40996A:				; CODE XREF: sub_409938+23j
		mov	[esp+18h+var_18], offset aOopsSecureMemo ; "Oops, secure memory	pool already initia"...
		call	sub_409788

locret_409976:				; CODE XREF: sub_409938+Aj
					; sub_409938+30j
		leave
		retn
sub_409938	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409978	proc near		; CODE XREF: sub_4015AD+6Fp
					; sub_40226D+23p ...

Code		= dword	ptr -28h
Val		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	eax, ds:dword_40F1A8
		test	eax, eax
		jnz	short loc_4099B2
		mov	[esp+28h+Code],	offset aOperationIsNot ; "operation is not possible without initi"...
		call	sub_409788
		mov	[esp+28h+Code],	offset aYouMayHaveUsed ; "(you may have	used the wrong program fo"...
		call	sub_409788
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4099B2:				; CODE XREF: sub_409978+14j
		mov	eax, ds:dword_40F1D0
		test	eax, eax
		jz	short loc_4099D3
		mov	eax, ds:dword_40F1D8
		test	eax, eax
		jnz	short loc_4099D3
		mov	ds:dword_40F1D0, 0
		call	sub_4097F0

loc_4099D3:				; CODE XREF: sub_409978+41j
					; sub_409978+4Aj
		add	[ebp+arg_0], 10h
		mov	eax, [ebp+arg_0]
		add	eax, 1Fh
		shr	eax, 5
		shl	eax, 5
		mov	[ebp+arg_0], eax

loc_4099E6:				; CODE XREF: sub_409978+10Bj
		mov	eax, ds:dword_40F1B8
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_409A31
; ---------------------------------------------------------------------------

loc_4099F7:				; CODE XREF: sub_409978+BDj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jb	short loc_409A22
		cmp	[ebp+var_10], 0
		jz	short loc_409A15
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	[eax+8], edx
		jmp	short loc_409A8F
; ---------------------------------------------------------------------------

loc_409A15:				; CODE XREF: sub_409978+8Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	ds:dword_40F1B8, eax
		jmp	short loc_409A8F
; ---------------------------------------------------------------------------

loc_409A22:				; CODE XREF: sub_409978+87j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax

loc_409A31:				; CODE XREF: sub_409978+7Dj
		cmp	[ebp+var_C], 0
		jnz	short loc_4099F7
		mov	eax, ds:dword_40F1B4
		mov	edx, eax
		add	edx, [ebp+arg_0]
		mov	eax, ds:Size
		cmp	edx, eax
		ja	short loc_409A71
		mov	edx, ds:dword_40F1A4
		mov	eax, ds:dword_40F1B4
		add	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_40F1B4
		add	eax, [ebp+arg_0]
		mov	ds:dword_40F1B4, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		jmp	short loc_409A8F
; ---------------------------------------------------------------------------

loc_409A71:				; CODE XREF: sub_409978+D0j
		cmp	[ebp+var_14], 0
		jnz	short loc_409A88
		mov	[ebp+var_14], 1
		call	sub_4098B3
		jmp	loc_4099E6
; ---------------------------------------------------------------------------

loc_409A88:				; CODE XREF: sub_409978+FDj
		mov	eax, 0
		jmp	short locret_409B05
; ---------------------------------------------------------------------------

loc_409A8F:				; CODE XREF: sub_409978+9Bj
					; sub_409978+A8j ...
		mov	eax, [ebp+var_C]
		mov	edx, [eax]
		mov	eax, ds:dword_40F1C0
		add	eax, edx
		mov	ds:dword_40F1C0, eax
		mov	eax, ds:dword_40F1C8
		add	eax, 1
		mov	ds:dword_40F1C8, eax
		mov	edx, ds:dword_40F1C0
		mov	eax, ds:dword_40F1BC
		cmp	edx, eax
		jbe	short loc_409AC6
		mov	eax, ds:dword_40F1C0
		mov	ds:dword_40F1BC, eax

loc_409AC6:				; CODE XREF: sub_409978+142j
		mov	edx, ds:dword_40F1C8
		mov	eax, ds:dword_40F1C4
		cmp	edx, eax
		jbe	short loc_409ADF
		mov	eax, ds:dword_40F1C8
		mov	ds:dword_40F1C4, eax

loc_409ADF:				; CODE XREF: sub_409978+15Bj
		mov	eax, [ebp+arg_0]
		lea	edx, [eax-8]
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Val], 0 ; Val
		mov	[esp+28h+Code],	eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		add	eax, 8

locret_409B05:				; CODE XREF: sub_409978+115j
		leave
		retn
sub_409978	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409B07(void *, int)
sub_409B07	proc near		; CODE XREF: sub_402BD0+91p
					; DATA XREF: sub_402DF2+74o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_409B20
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Dst], eax
		call	sub_409978
		jmp	short locret_409B9B
; ---------------------------------------------------------------------------

loc_409B20:				; CODE XREF: sub_409B07+Aj
		mov	eax, [ebp+arg_0]
		sub	eax, 8
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+var_10]
		jnb	short loc_409B3E
		mov	eax, [ebp+arg_0]
		jmp	short locret_409B9B
; ---------------------------------------------------------------------------

loc_409B3E:				; CODE XREF: sub_409B07+30j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Dst], eax
		call	sub_409978
		mov	[ebp+var_14], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_14]
		mov	ecx, [ebp+var_10]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	edx, ecx
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Src], 0 ; Val
		mov	[esp+28h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_409B9D
		mov	eax, [ebp+var_14]

locret_409B9B:				; CODE XREF: sub_409B07+17j
					; sub_409B07+35j
		leave
		retn
sub_409B07	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409B9D	proc near		; CODE XREF: sub_4015AD+EEp
					; sub_40226D+81p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		cmp	[ebp+arg_0], 0
		jz	loc_409C7E
		mov	eax, [ebp+arg_0]
		sub	eax, 8
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_8], eax
		jmp	short loc_409BDA
; ---------------------------------------------------------------------------

loc_409BCC:				; CODE XREF: sub_409B9D+41j
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	0FFh
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1

loc_409BDA:				; CODE XREF: sub_409B9D+2Dj
		cmp	[ebp+var_8], 0
		jnz	short loc_409BCC
		mov	eax, [ebp+var_24]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		jmp	short loc_409BFC
; ---------------------------------------------------------------------------

loc_409BEE:				; CODE XREF: sub_409B9D+63j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0AAh
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_409BFC:				; CODE XREF: sub_409B9D+4Fj
		cmp	[ebp+var_10], 0
		jnz	short loc_409BEE
		mov	eax, [ebp+var_24]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_18], eax
		jmp	short loc_409C1E
; ---------------------------------------------------------------------------

loc_409C10:				; CODE XREF: sub_409B9D+85j
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	55h
		add	[ebp+var_14], 1
		sub	[ebp+var_18], 1

loc_409C1E:				; CODE XREF: sub_409B9D+71j
		cmp	[ebp+var_18], 0
		jnz	short loc_409C10
		mov	eax, [ebp+var_24]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_20], eax
		jmp	short loc_409C40
; ---------------------------------------------------------------------------

loc_409C32:				; CODE XREF: sub_409B9D+A7j
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		add	[ebp+var_1C], 1
		sub	[ebp+var_20], 1

loc_409C40:				; CODE XREF: sub_409B9D+93j
		cmp	[ebp+var_20], 0
		jnz	short loc_409C32
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_28]
		mov	[eax], edx
		mov	edx, ds:dword_40F1B8
		mov	eax, [ebp+var_24]
		mov	[eax+8], edx
		mov	eax, [ebp+var_24]
		mov	ds:dword_40F1B8, eax
		mov	eax, ds:dword_40F1C8
		sub	eax, 1
		mov	ds:dword_40F1C8, eax
		mov	eax, ds:dword_40F1C0
		sub	eax, [ebp+var_28]
		mov	ds:dword_40F1C0, eax
		jmp	short locret_409C7F
; ---------------------------------------------------------------------------

loc_409C7E:				; CODE XREF: sub_409B9D+Aj
		nop

locret_409C7F:				; CODE XREF: sub_409B9D+DFj
		leave
		retn
sub_409B9D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_40F1A4
		cmp	[ebp+8], eax
		jb	short loc_409CA7
		mov	edx, ds:dword_40F1A4
		mov	eax, ds:Size
		add	eax, edx
		cmp	eax, [ebp+8]
		jbe	short loc_409CA7
		mov	eax, 1
		jmp	short loc_409CAC
; ---------------------------------------------------------------------------

loc_409CA7:				; CODE XREF: .text:00409C8Cj
					; .text:00409C9Ej
		mov	eax, 0

loc_409CAC:				; CODE XREF: .text:00409CA5j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409CAE()
sub_409CAE	proc near		; DATA XREF: sub_402DF2+60o

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ds:dword_40F1A8
		test	eax, eax
		jz	loc_409D8D
		mov	eax, ds:dword_40F1A4
		mov	[ebp+var_4], eax
		mov	eax, ds:Size
		mov	[ebp+var_8], eax
		jmp	short loc_409CE1
; ---------------------------------------------------------------------------

loc_409CD3:				; CODE XREF: sub_409CAE+37j
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	0FFh
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1

loc_409CE1:				; CODE XREF: sub_409CAE+23j
		cmp	[ebp+var_8], 0
		jnz	short loc_409CD3
		mov	eax, ds:dword_40F1A4
		mov	[ebp+var_C], eax
		mov	eax, ds:Size
		mov	[ebp+var_10], eax
		jmp	short loc_409D07
; ---------------------------------------------------------------------------

loc_409CF9:				; CODE XREF: sub_409CAE+5Dj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0AAh
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_409D07:				; CODE XREF: sub_409CAE+49j
		cmp	[ebp+var_10], 0
		jnz	short loc_409CF9
		mov	eax, ds:dword_40F1A4
		mov	[ebp+var_14], eax
		mov	eax, ds:Size
		mov	[ebp+var_18], eax
		jmp	short loc_409D2D
; ---------------------------------------------------------------------------

loc_409D1F:				; CODE XREF: sub_409CAE+83j
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	55h
		add	[ebp+var_14], 1
		sub	[ebp+var_18], 1

loc_409D2D:				; CODE XREF: sub_409CAE+6Fj
		cmp	[ebp+var_18], 0
		jnz	short loc_409D1F
		mov	eax, ds:dword_40F1A4
		mov	[ebp+var_1C], eax
		mov	eax, ds:Size
		mov	[ebp+var_20], eax
		jmp	short loc_409D53
; ---------------------------------------------------------------------------

loc_409D45:				; CODE XREF: sub_409CAE+A9j
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		add	[ebp+var_1C], 1
		sub	[ebp+var_20], 1

loc_409D53:				; CODE XREF: sub_409CAE+95j
		cmp	[ebp+var_20], 0
		jnz	short loc_409D45
		mov	ds:dword_40F1A4, 0
		mov	ds:dword_40F1A8, 0
		mov	ds:Size, 0
		mov	ds:dword_40F1B4, 0
		mov	ds:dword_40F1B8, 0
		jmp	short locret_409D8E
; ---------------------------------------------------------------------------

loc_409D8D:				; CODE XREF: sub_409CAE+Dj
		nop

locret_409D8E:				; CODE XREF: sub_409CAE+DDj
		leave
		retn
sub_409CAE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, ds:dword_40F1CC
		test	eax, eax
		jnz	short loc_409E03
		mov	edx, ds:Size
		mov	eax, ds:dword_40F1B4
		mov	[ebp-1Ch], eax
		mov	eax, ds:dword_40F1C4
		mov	[ebp-20h], eax
		mov	edi, ds:dword_40F1C8
		mov	esi, ds:dword_40F1BC
		mov	ebx, ds:dword_40F1C0
		mov	ecx, offset aSecmemUsageUUB ; "secmem usage: %u/%u bytes in %u/%u bloc"...
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch], edx
		mov	edx, [ebp-1Ch]
		mov	[esp+18h], edx
		mov	edx, [ebp-20h]
		mov	[esp+14h], edx
		mov	[esp+10h], edi
		mov	[esp+0Ch], esi
		mov	[esp+8], ebx
		mov	[esp+4], ecx
		mov	[esp], eax
		call	fprintf
		jmp	short loc_409E04
; ---------------------------------------------------------------------------

loc_409E03:				; CODE XREF: .text:00409DA0j
		nop

loc_409E04:				; CODE XREF: .text:00409E01j
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:Size
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 0
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		jmp	short loc_409E75
; ---------------------------------------------------------------------------

loc_409E33:				; CODE XREF: .text:00409E61j
					; .text:00409E79j
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_write
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0FFFFFFFFh
		jnz	short loc_409E63
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_409E33

loc_409E63:				; CODE XREF: .text:00409E53j
		cmp	dword ptr [ebp-14h], 0
		js	short loc_409E7D
		mov	eax, [ebp-14h]
		add	[ebp-0Ch], eax
		mov	eax, [ebp-14h]
		sub	[ebp-10h], eax

loc_409E75:				; CODE XREF: .text:00409E31j
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_409E33
		jmp	short loc_409E7E
; ---------------------------------------------------------------------------

loc_409E7D:				; CODE XREF: .text:00409E67j
		nop

loc_409E7E:				; CODE XREF: .text:00409E7Bj
		mov	eax, [ebp-14h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409E83	proc near		; CODE XREF: sub_402DF2+5Bp
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_409E83	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00411024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_409EB0
		cmp	eax, 3
		jz	short loc_409EB0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_409EB0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_40B0A0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_40E4C0o ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_409F24
		cmp	dword_40C330, 2
		jz	short loc_409F06
		mov	dword_40C330, 2

loc_409F06:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_40A013
		cmp	eax, 1
		jz	loc_409FB2

loc_409F18:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_409F24:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_40F65C, 1
		mov	[esp+1Ch+lpLibFileName], offset	aMingwm10_dll ;	"mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_40A043
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_40F658, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_40F654, eax
		jz	loc_40A043
		mov	ecx, ds:dword_40F658
		test	ecx, ecx
		jz	short loc_409FD3
		test	eax, eax
		jz	short loc_409FD3
		mov	dword_40C330, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_409FB2:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_40B0A0
		jmp	loc_409F18
; ---------------------------------------------------------------------------

loc_409FD3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_40F654, 0
		mov	ds:dword_40F658, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_409FF3:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_40C330, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40A013:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_411030
		cmp	ebx, offset dword_411030
		jz	loc_409F18

loc_40A024:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_40A02C
		call	eax

loc_40A02C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_411030
		jnz	short loc_40A024
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40A043:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_40F654, 0
		mov	ds:dword_40F658, 0
		jmp	short loc_409FF3
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A070	proc near		; DATA XREF: .CRT:00411014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_40A070	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A080	proc near		; CODE XREF: sub_40A0A0+10p
					; sub_40A0A0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_40A080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A090	proc near		; CODE XREF: sub_401060+59p
					; sub_40A0A0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_40A090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40A0A0(_onexit_t)
sub_40A0A0	proc near		; CODE XREF: sub_40A160+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_40F664
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_40A080
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_40A140
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_40F664
		mov	[esp+2Ch+Func],	eax
		call	sub_40A080
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_40F660
		mov	[esp+2Ch+Func],	eax
		call	sub_40A080
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_40A090
		mov	ds:dword_40F664, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_40A090
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_40F660, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A140:				; CODE XREF: sub_40A0A0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_40A0A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40A160(_onexit_t)
sub_40A160	proc near		; CODE XREF: sub_402DF2+67p
					; sub_40AD80-27p ...

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_40A0A0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_40A160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_40A1D7
		cmp	eax, 0C000008Dh
		jb	short loc_40A204

loc_40A19B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_40A1A0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_40A2D0
		test	eax, eax
		jz	short loc_40A1EC
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_40A1CF:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40A1D7:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_40A245
		cmp	eax, 0C0000096h
		jz	short loc_40A212
		cmp	eax, 0C0000093h
		jz	short loc_40A19B

loc_40A1EC:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_40F204
		test	eax, eax
		jz	loc_40A2C3
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_40A204:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_40A250
		cmp	eax, 0C000001Dh
		jnz	short loc_40A1EC

loc_40A212:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_40A287
		test	eax, eax
		jz	short loc_40A1EC
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40A245:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_40A1A0
; ---------------------------------------------------------------------------
		align 10h

loc_40A250:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_40A2A5
		test	eax, eax
		jz	loc_40A1EC
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40A287:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40A1CF
; ---------------------------------------------------------------------------

loc_40A2A5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40A1CF
; ---------------------------------------------------------------------------

loc_40A2C3:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_40A1CF
; ---------------------------------------------------------------------------
		align 10h

loc_40A2D0:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_40A1CF
		mov	[esp+2Ch+var_10], eax
		call	sub_40ACF0
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_40A1CF
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_40F208
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_40A351
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_40F208
		jmp	short loc_40A357
; ---------------------------------------------------------------------------

loc_40A351:				; CODE XREF: .text:0040A326j
		fstp	st
		fstp	st
		fstp	st

loc_40A357:				; CODE XREF: .text:0040A34Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A360	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_40F208, eax
		jmp	__setusermatherr
sub_40A360	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A370	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_40A38D
		mov	edx, ds:off_40E5E0[ecx*4]

loc_40A38D:				; CODE XREF: sub_40A370+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_40A370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A3D0	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_40A3D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_40A3E0(char *Format, char ArgList)
sub_40A3E0	proc near		; CODE XREF: sub_40A440+1DDp
					; sub_40A440+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_40A3E0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_40A440
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_40A440(size_t Size)
sub_40A440	proc near		; CODE XREF: .text:0040A431j
					; sub_40A680+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_40F214
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_40A622
		mov	eax, ds:dword_40F210
		xor	esi, esi

loc_40A464:				; CODE XREF: sub_40A440+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_40A479
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_40A550

loc_40A479:				; CODE XREF: sub_40A440+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_40A464

loc_40A483:				; CODE XREF: sub_40A440+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_40AA40
		test	eax, eax
		mov	edi, eax
		jz	loc_40A649
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_40F210
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_40AB20
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_40F210
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_40A629
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_40A5D1

loc_40A4FF:				; CODE XREF: sub_40A440+194j
					; sub_40A440+1C6j
		add	ds:dword_40F214, 1

loc_40A506:				; CODE XREF: sub_40A440+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40A659
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_40A558

loc_40A52F:				; CODE XREF: sub_40A440+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_40A543:				; CODE XREF: sub_40A440+162j
					; sub_40A440+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A550:				; CODE XREF: sub_40A440+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_40A506
; ---------------------------------------------------------------------------

loc_40A558:				; CODE XREF: sub_40A440+EDj
		cmp	eax, 40h
		jz	short loc_40A52F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_40A543
		cmp	eax, 4
		jz	short loc_40A543
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40A5D1:				; CODE XREF: sub_40A440+B9j
		cmp	eax, 40h
		jz	loc_40A4FF
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_40F210
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_40A4FF
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_40A3E0
; ---------------------------------------------------------------------------

loc_40A622:				; CODE XREF: sub_40A440+17j
		xor	esi, esi
		jmp	loc_40A483
; ---------------------------------------------------------------------------

loc_40A629:				; CODE XREF: sub_40A440+ACj
		mov	eax, ds:dword_40F210
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_40A3E0
; ---------------------------------------------------------------------------

loc_40A649:				; CODE XREF: sub_40A440+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_40A3E0
; ---------------------------------------------------------------------------

loc_40A659:				; CODE XREF: sub_40A440+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_40A3E0
sub_40A440	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A680	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_40F20C
		test	eax, eax
		jz	short loc_40A6A0

loc_40A692:				; CODE XREF: sub_40A680+66j
					; sub_40A680+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A6A0:				; CODE XREF: sub_40A680+10j
		mov	ds:dword_40F20C, 1
		call	sub_40AA80
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_40B140
		mov	ds:dword_40F214, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_40F210, eax
		mov	eax, offset dword_40E770
		sub	eax, offset dword_40E770
		cmp	eax, 7
		jle	short loc_40A692
		cmp	eax, 0Bh
		mov	ebx, offset dword_40E770
		jle	loc_40A7E0
		mov	eax, ds:dword_40E770
		test	eax, eax
		jnz	short loc_40A710
		mov	eax, ds:dword_40E774
		test	eax, eax
		jz	loc_40A7CC
		lea	esi, [esi+0]

loc_40A710:				; CODE XREF: sub_40A680+7Dj
					; sub_40A680+164j ...
		cmp	ebx, offset dword_40E770
		jnb	loc_40A692
		mov	esi, 400000h

loc_40A721:				; CODE XREF: sub_40A680+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_40A440
		cmp	ebx, offset dword_40E770
		jb	short loc_40A721

loc_40A745:				; CODE XREF: sub_40A680+24Bj
		mov	ecx, ds:dword_40F214
		test	ecx, ecx
		jle	loc_40A692
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_40A772
; ---------------------------------------------------------------------------
		align 10h

loc_40A760:				; CODE XREF: sub_40A680+FDj
					; sub_40A680+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_40F214
		jge	loc_40A692

loc_40A772:				; CODE XREF: sub_40A680+DDj
		mov	eax, ds:dword_40F210
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_40A760
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40A8F2
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_40F210
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_40A760
; ---------------------------------------------------------------------------

loc_40A7CC:				; CODE XREF: sub_40A680+86j
		mov	eax, ds:dword_40E778
		test	eax, eax
		jnz	short loc_40A7F5
		mov	ebx, offset dword_40E77C
		lea	esi, [esi+0]

loc_40A7E0:				; CODE XREF: sub_40A680+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_40A710
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_40A710

loc_40A7F5:				; CODE XREF: sub_40A680+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_40A915
		add	ebx, 0Ch
		cmp	ebx, offset dword_40E770
		jnb	loc_40A692

loc_40A810:				; CODE XREF: sub_40A680+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_40A86A
		cmp	edx, 20h
		jz	short loc_40A8A0
		cmp	edx, 8
		jz	short loc_40A84A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_40A3E0
; ---------------------------------------------------------------------------

loc_40A84A:				; CODE XREF: sub_40A680+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_40A875
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_40A891
; ---------------------------------------------------------------------------

loc_40A86A:				; CODE XREF: sub_40A680+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_40A8D0

loc_40A875:				; CODE XREF: sub_40A680+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_40A8E3
		cmp	edx, 20h
		jz	short loc_40A8AF
		cmp	edx, 8
		jnz	short loc_40A8BC

loc_40A891:				; CODE XREF: sub_40A680+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_40A440
		jmp	short loc_40A8BC
; ---------------------------------------------------------------------------

loc_40A8A0:				; CODE XREF: sub_40A680+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_40A8AF:				; CODE XREF: sub_40A680+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_40A440

loc_40A8BC:				; CODE XREF: sub_40A680+20Fj
					; sub_40A680+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_40E770
		jb	loc_40A810
		jmp	loc_40A745
; ---------------------------------------------------------------------------

loc_40A8D0:				; CODE XREF: sub_40A680+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_40A8E3:				; CODE XREF: sub_40A680+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_40A440
		jmp	short loc_40A8BC
; ---------------------------------------------------------------------------

loc_40A8F2:				; CODE XREF: sub_40A680+11Bj
		add	ebx, ds:dword_40F210
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_40A3E0
; ---------------------------------------------------------------------------

loc_40A915:				; CODE XREF: sub_40A680+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_40A3E0
sub_40A680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A930	proc near		; CODE XREF: .text:0040A9D1p
					; sub_40AA40+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_40A940

locret_40A93D:				; CODE XREF: sub_40A930+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_40A940:				; CODE XREF: sub_40A930+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_40A93D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_40A930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A960	proc near		; CODE XREF: sub_40AA40+2Bp
					; .text:0040AB84p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_40A99E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_40A984:				; CODE XREF: sub_40A960+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_40A992
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40A99E

loc_40A992:				; CODE XREF: sub_40A960+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_40A984
		xor	eax, eax

loc_40A99E:				; CODE XREF: sub_40A960+19j
					; sub_40A960+30j
		pop	ebx
		pop	esi
		retn
sub_40A960	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40A9B0
; ---------------------------------------------------------------------------
		align 10h

loc_40A9B0:				; CODE XREF: .text:0040A9A1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_40AA23
		mov	dword ptr [esp], 400000h
		call	sub_40A930
		test	eax, eax
		jz	short loc_40AA23
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_40AA23
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_40AA0B
; ---------------------------------------------------------------------------

loc_40AA01:				; CODE XREF: .text:0040AA21j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_40AA30

loc_40AA0B:				; CODE XREF: .text:0040A9FFj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_40AA01

loc_40AA23:				; CODE XREF: .text:0040A9C8j
					; .text:0040A9D8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40AA30:				; CODE XREF: .text:0040AA09j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AA40	proc near		; CODE XREF: sub_40A440+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_40A930
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_40AA70
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_40A960

loc_40AA70:				; CODE XREF: sub_40AA40+15j
		add	esp, 8
		retn
sub_40AA40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AA80	proc near		; CODE XREF: sub_40A680+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_40A930
		xor	edx, edx
		test	eax, eax
		jz	short loc_40AAA1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_40AAA1:				; CODE XREF: sub_40AA80+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_40AA80	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_40A930
		xor	edx, edx
		test	eax, eax
		jz	short loc_40AB09
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_40AB09
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_40AAF0:				; CODE XREF: .text:0040AB05j
		test	byte ptr [edx+27h], 20h
		jz	short loc_40AAFD
		test	ebx, ebx
		jz	short loc_40AB09
		sub	ebx, 1

loc_40AAFD:				; CODE XREF: .text:0040AAF4j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_40AAF0
		xor	edx, edx

loc_40AB09:				; CODE XREF: .text:0040AAC9j
					; .text:0040AAE5j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40AB20
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AB20	proc near		; CODE XREF: sub_40A440+70p
					; .text:0040AB11j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_40A930
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_40AB20	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40AB50
; ---------------------------------------------------------------------------
		align 10h

loc_40AB50:				; CODE XREF: .text:0040AB41j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_40A930
		test	eax, eax
		jnz	short loc_40AB70

loc_40AB66:				; CODE XREF: .text:0040AB8Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40AB70:				; CODE XREF: .text:0040AB64j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_40A960
		test	eax, eax
		jz	short loc_40AB66
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40ABA0	proc near		; CODE XREF: sub_40AC30+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_40A930
		test	eax, eax
		jz	short loc_40AC11
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_40AC11
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_40A960
		test	eax, eax
		jz	short loc_40AC11
		add	esi, 400000h
		jnz	short loc_40ABF6
		jmp	short loc_40AC11
; ---------------------------------------------------------------------------
		align 10h

loc_40ABF0:				; CODE XREF: sub_40ABA0+66j
		sub	ebx, 1
		add	esi, 14h

loc_40ABF6:				; CODE XREF: sub_40ABA0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_40AC04
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_40AC20

loc_40AC04:				; CODE XREF: sub_40ABA0+5Bj
		test	ebx, ebx
		jg	short loc_40ABF0
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_40AC11:				; CODE XREF: sub_40ABA0+1Aj
					; sub_40ABA0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40AC20:				; CODE XREF: sub_40ABA0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_40ABA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AC30	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40F218
		test	eax, eax
		jz	short loc_40AC42

loc_40AC3D:				; CODE XREF: sub_40AC30+97j
					; sub_40AC30+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40AC42:				; CODE XREF: sub_40AC30+Bj
		xor	eax, eax

loc_40AC44:				; CODE XREF: sub_40AC30+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_40ABA0
		test	eax, eax
		jz	short loc_40ACD0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_40AC60
		cmp	dl, 6Dh
		jnz	short loc_40ACB0

loc_40AC60:				; CODE XREF: sub_40AC30+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40AC6E
		cmp	dl, 73h
		jnz	short loc_40ACB0

loc_40AC6E:				; CODE XREF: sub_40AC30+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40AC7C
		cmp	dl, 76h
		jnz	short loc_40ACB0

loc_40AC7C:				; CODE XREF: sub_40AC30+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_40AC8A
		cmp	dl, 63h
		jnz	short loc_40ACB0

loc_40AC8A:				; CODE XREF: sub_40AC30+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_40AC98
		cmp	dl, 72h
		jnz	short loc_40ACB0

loc_40AC98:				; CODE XREF: sub_40AC30+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_40ACB4
		cmp	dl, 74h
		jz	short loc_40ACB4
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_40ACB4
		xchg	ax, ax

loc_40ACB0:				; CODE XREF: sub_40AC30+2Ej
					; sub_40AC30+3Cj ...
		mov	eax, ebx
		jmp	short loc_40AC44
; ---------------------------------------------------------------------------

loc_40ACB4:				; CODE XREF: sub_40AC30+6Fj
					; sub_40AC30+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_40F218, eax
		jnz	loc_40AC3D
		lea	esi, [esi+0]

loc_40ACD0:				; CODE XREF: sub_40AC30+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_40F218, eax
		jmp	loc_40AC3D
sub_40AC30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40ACF0	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_40ACF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40AD00()
sub_40AD00	proc near		; DATA XREF: sub_40AD80:loc_40AD52o
		sub	esp, 0Ch
		mov	eax, off_40C32C
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40AD27
		xchg	ax, ax

loc_40AD10:				; CODE XREF: sub_40AD00+25j
		call	eax
		mov	eax, off_40C32C
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_40C32C, edx
		test	eax, eax
		jnz	short loc_40AD10

loc_40AD27:				; CODE XREF: sub_40AD00+Cj
		add	esp, 0Ch
		retn
sub_40AD00	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_40AD80

loc_40AD30:				; CODE XREF: sub_40AD80+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_40B640
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_40AD63

loc_40AD3F:				; CODE XREF: sub_40AD80-9j
		test	ebx, ebx
		jz	short loc_40AD52

loc_40AD43:				; CODE XREF: sub_40AD80-30j
		call	ds:dword_40B640[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_40AD43

loc_40AD52:				; CODE XREF: sub_40AD80-3Fj
		mov	[esp+1Ch+var_1C], offset sub_40AD00 ; _onexit_t
		call	sub_40A160
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40AD63:				; CODE XREF: sub_40AD80-43j
		xor	ebx, ebx
		jmp	short loc_40AD69
; ---------------------------------------------------------------------------

loc_40AD67:				; CODE XREF: sub_40AD80-Bj
		mov	ebx, eax

loc_40AD69:				; CODE XREF: sub_40AD80-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_40B640[eax*4]
		test	edx, edx
		jnz	short loc_40AD67
		jmp	short loc_40AD3F
; END OF FUNCTION CHUNK	FOR sub_40AD80
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AD80	proc near		; CODE XREF: sub_401180+239p
					; sub_40248D+14p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 0040AD30 SIZE 00000049 BYTES

		mov	ecx, ds:dword_40F21C
		test	ecx, ecx
		jz	short loc_40AD90
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_40AD90:				; CODE XREF: sub_40AD80+8j
		mov	ds:dword_40F21C, 1
		jmp	short loc_40AD30
sub_40AD80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40ADA0	proc near		; CODE XREF: start+Dp .text:004014DDp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_40C338
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_40ADF0
		not	eax
		mov	dword_40C33C, eax

loc_40ADD6:				; CODE XREF: sub_40ADA0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40ADF0:				; CODE XREF: sub_40ADA0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_40AE62

loc_40AE52:				; CODE XREF: sub_40ADA0+CCj
		mov	dword_40C338, ebp
		mov	dword_40C33C, eax
		jmp	loc_40ADD6
; ---------------------------------------------------------------------------

loc_40AE62:				; CODE XREF: sub_40ADA0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_40AE52
sub_40ADA0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_40F2E4, edx
		mov	ds:dword_40F500, 0C0000409h
		mov	ds:dword_40F504, 1
		mov	ds:dword_40F2D8, eax
		mov	ds:dword_40F50C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_40F2CC, eax
		mov	eax, dword_40C338
		mov	[ebp-10h], eax
		mov	eax, dword_40C33C
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_40E708
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AF00	proc near		; CODE XREF: sub_40B0A0+79p
					; sub_40B0A0:loc_40B132p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_40F57C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_40AF55
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_40AF30:				; CODE XREF: sub_40AF00+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_40AF4E
		test	esi, esi
		jz	short loc_40AF4E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_40AF4E:				; CODE XREF: sub_40AF00+40j
					; sub_40AF00+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_40AF30

loc_40AF55:				; CODE XREF: sub_40AF00+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40AF00	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_40F560
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_40AF94

loc_40AF86:				; CODE XREF: .text:0040AFFCj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40AF94:				; CODE XREF: .text:0040AF84j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_40AFF7
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_40F57C
		mov	ds:dword_40F57C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40AFF7:				; CODE XREF: .text:0040AFACj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_40AF86
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40F560
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_40B018
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40B018:				; CODE XREF: .text:0040B00Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_40F57C
		sub	esp, 4
		test	edx, edx
		jz	short loc_40B04F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_40B048
		jmp	short loc_40B086
; ---------------------------------------------------------------------------
		align 10h

loc_40B040:				; CODE XREF: .text:0040B04Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_40B066
		mov	edx, eax

loc_40B048:				; CODE XREF: .text:0040B036j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_40B040

loc_40B04F:				; CODE XREF: .text:0040B030j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_40B05F:				; CODE XREF: .text:0040B084j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40B066:				; CODE XREF: .text:0040B044j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_40B06C:				; CODE XREF: .text:0040B090j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_40B05F
; ---------------------------------------------------------------------------

loc_40B086:				; CODE XREF: .text:0040B038j
		mov	eax, [edx+8]
		mov	ds:dword_40F57C, eax
		mov	eax, edx
		jmp	short loc_40B06C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40B0A0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_40B0F0
		jb	short loc_40B0C0
		cmp	eax, 3
		jz	short loc_40B110

loc_40B0B3:				; CODE XREF: sub_40B0A0+31j
					; sub_40B0A0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40B0C0:				; CODE XREF: sub_40B0A0+Cj
		mov	eax, ds:dword_40F560
		test	eax, eax
		jnz	short loc_40B132

loc_40B0C9:				; CODE XREF: sub_40B0A0+97j
		mov	eax, ds:dword_40F560
		cmp	eax, 1
		jnz	short loc_40B0B3
		mov	ds:dword_40F560, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_40B0B3
; ---------------------------------------------------------------------------
		align 10h

loc_40B0F0:				; CODE XREF: sub_40B0A0+Aj
		mov	eax, ds:dword_40F560
		test	eax, eax
		jz	short loc_40B120

loc_40B0F9:				; CODE XREF: sub_40B0A0+90j
		mov	ds:dword_40F560, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40B110:				; CODE XREF: sub_40B0A0+11j
		mov	eax, ds:dword_40F560
		test	eax, eax
		jz	short loc_40B0B3
		call	sub_40AF00
		jmp	short loc_40B0B3
; ---------------------------------------------------------------------------

loc_40B120:				; CODE XREF: sub_40B0A0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_40B0F9
; ---------------------------------------------------------------------------

loc_40B132:				; CODE XREF: sub_40B0A0+27j
		call	sub_40AF00
		jmp	short loc_40B0C9
sub_40B0A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40B140	proc near		; CODE XREF: sub_401180+19p
					; sub_40A680+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_40B162

loc_40B14D:				; CODE XREF: sub_40B140+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_40B14D

loc_40B162:				; CODE XREF: sub_40B140+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_40B140	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _close]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40B1C0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40B1C0	proc near		; CODE XREF: sub_401180+A7p
					; .text:0040B1B1j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_40B1C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40B1E0(char *, size_t, char *, char)
sub_40B1E0	proc near		; CODE XREF: sub_40285E+5Cp
					; sub_402F23+C5p ...

DstBuf		= dword	ptr -1Ch
MaxCount	= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 1Ch
		lea	eax, [esp+1Ch+arg_C]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+Format], eax ;	Format
		mov	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+MaxCount], eax	; MaxCount
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+DstBuf], eax ;	DstBuf
		call	_vsnprintf
		add	esp, 1Ch
		retn
sub_40B1E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_40B210	proc near		; CODE XREF: sub_40B3F0+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_40B25C
		jmp	short loc_40B264
; ---------------------------------------------------------------------------
		align 10h

loc_40B250:				; CODE XREF: sub_40B210+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_40B264

loc_40B25C:				; CODE XREF: sub_40B210+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_40B250

loc_40B264:				; CODE XREF: sub_40B210+39j
					; sub_40B210+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_40B28C
		jmp	short loc_40B294
; ---------------------------------------------------------------------------
		align 10h

loc_40B280:				; CODE XREF: sub_40B210+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_40B294

loc_40B28C:				; CODE XREF: sub_40B210+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_40B280

loc_40B294:				; CODE XREF: sub_40B210+6Aj
					; sub_40B210+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_40B350
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_40B37E

loc_40B2B3:				; CODE XREF: sub_40B210+168j
					; sub_40B210+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40B390

loc_40B2E3:				; CODE XREF: sub_40B210+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_40F1FC
		test	eax, eax
		jz	loc_40B3C9
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_40B3B1
		cmp	eax, 5
		jnz	short loc_40B3AC
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40B350:				; CODE XREF: sub_40B210+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_40B2B3

loc_40B37E:				; CODE XREF: sub_40B210+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_40B2B3
; ---------------------------------------------------------------------------
		align 10h

loc_40B390:				; CODE XREF: sub_40B210+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_40B2E3
; ---------------------------------------------------------------------------

loc_40B3AC:				; CODE XREF: sub_40B210+133j
		call	abort
; ---------------------------------------------------------------------------

loc_40B3B1:				; CODE XREF: sub_40B210+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_40B3C9:				; CODE XREF: sub_40B210+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_2 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_40B210	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40B3F0(char *, char *, int)
sub_40B3F0	proc near		; CODE XREF: sub_402BD0+31p
					; sub_402BD0+59p ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40B456
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_40B440:				; CODE XREF: sub_40B3F0+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_40B440
		add	edx, edx

loc_40B456:				; CODE XREF: sub_40B3F0+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40B47D
		xor	edi, edi

loc_40B467:				; CODE XREF: sub_40B3F0+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_40B467
		add	edx, edx

loc_40B47D:				; CODE XREF: sub_40B3F0+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_40B210
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_40B3F0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _vsnprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B620	proc near		; DATA XREF: .text:0040B644o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_40A160
		leave
		retn
sub_40B620	endp

; ---------------------------------------------------------------------------
		align 10h
dword_40B640	dd 0FFFFFFFFh		; DATA XREF: sub_40AD80-4Cr
					; sub_40AD80:loc_40AD43r ...
		dd offset sub_40B620
		dd 0
		dd 0FFFFFFFFh
dword_40B650	dd 6Ch dup(0)		; DATA XREF: .data:off_40C32Co
		dd 200h	dup(?)
_text		ends

; Section 2. (virtual address 0000C000)
; Virtual size			: 00000344 (	836.)
; Section size in file		: 00000400 (   1024.)
; Offset to raw	data for section: 0000AC00
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 40C000h
off_40C000	dd offset sub_4023AD	; DATA XREF: sub_4040FA+1ACr
					; sub_404459+64r
		align 20h
off_40C020	dd offset aSetdesc	; DATA XREF: sub_40473A+25o
					; sub_40473A+39o ...
					; "SETDESC"
		align 8
		dd offset sub_403AEF
		dd offset aSetprompt	; "SETPROMPT"
		dd 0
		dd offset sub_403B6B
		dd offset aSetkeyinfo	; "SETKEYINFO"
		align 10h
		dd offset sub_403BE7
		dd offset aSetrepeat	; "SETREPEAT"
		dd 0
		dd offset sub_403C5F
		dd offset aSetrepeaterror ; "SETREPEATERROR"
		align 8
		dd offset sub_403CD2
		dd offset aSeterror	; "SETERROR"
		dd 0
		dd offset sub_403D45
		dd offset aSetok	; "SETOK"
		align 10h
		dd offset sub_403DC1
		dd offset aSetnotok	; "SETNOTOK"
		dd 0
		dd offset sub_403E3D
		dd offset aSetcancel	; "SETCANCEL"
		align 8
		dd offset sub_403EB9
		dd offset aGetpin	; "GETPIN"
		dd 0
		dd offset sub_4040FA
		dd offset aConfirm	; "CONFIRM"
		align 10h
		dd offset sub_404459
		dd offset aMessage	; "MESSAGE"
		dd 0
		dd offset sub_404566
		dd offset aSetqualitybar ; "SETQUALITYBAR"
		align 8
		dd offset sub_403FDE
		dd offset aSetqualitybar_ ; "SETQUALITYBAR_TT"
		dd 0
		dd offset sub_40406B
		dd offset aGetinfo	; "GETINFO"
		align 10h
		dd offset sub_404581
		dd offset aSettitle	; "SETTITLE"
		dd 0
		dd offset sub_403F62
		dd offset aSettimeout	; "SETTIMEOUT"
		align 8
		dd offset sub_403F35
		dd offset aClearpassphras ; "CLEARPASSPHRASE"
		dd 0
		dd offset sub_40468F
		dd 0Ah dup(0)
dword_40C120	dd 64h,	40D6A0h, 0	; DATA XREF: sub_40318A:loc_403473o
		dd offset aTurnOnDebuggin ; "Turn on debugging output"
		dd 44h,	40D43Fh, 2, 40D6BFh, 54h, 40D447h, 2, 40D6DCh
		dd 4Eh,	40D44Fh, 2, 40D704h, 43h, 40D457h, 2, 40D724h
		dd 4Dh,	40D460h, 2, 40D748h, 6Fh, 40D76Eh, 1, 40D778h
		dd 67h,	40D7B0h, 0
		dd offset aGrabKeyboardOn ; "Grab keyboard only	while window is	focu"...
		dd 57h,	40D46Ch, 4, 40D7ECh, 63h, 40D80Fh, 2, 40D818h
		dd 8 dup(0)
; char *Str
Str		dd offset aNone		; DATA XREF: sub_40301A+100r
					; sub_40301A+126r
					; "none"
dword_40C1E4	dd 0			; DATA XREF: sub_40301A+149r
		dd offset aDefault	; "default"
		dd 1, 40D84Bh, 2, 40D851h, 3, 40D855h, 4, 40D85Bh, 5, 40D862h
		dd 6, 40D867h, 7, 40D86Fh, 8, 40D874h, 9, 4 dup(0)
off_40C240	dd offset malloc	; DATA XREF: sub_407B50+6w
					; sub_407B6D+6r
off_40C244	dd offset realloc	; DATA XREF: sub_407B50+Ew
					; sub_407B83+6r
off_40C248	dd offset free		; DATA XREF: sub_407B50+16w
					; sub_407BE3+Cr
		align 20h
off_40C260	dd offset aNop		; DATA XREF: sub_40848F+49o
					; sub_40848F+5Co ...
					; "NOP"
		align 8
		dd offset sub_407F17
		dd 1, 40E09Bh, 1, 407F21h, 1, 40E0A2h, 5, 407F62h, 1, 40E0A9h
		dd 2, 4081A0h, 1, 40E0ADh, 3, 4081E1h, 1, 40E0B2h, 4, 408204h
		dd 1, 40E0B8h, 7, 408245h, 1, 40E0BCh, 8, 4083C5h, 0
		dd offset aOutput	; "OUTPUT"
		dd 9, 40842Ah, 0
		dd offset aOption	; "OPTION"
		dd 5, 407F62h, 1, 8 dup(0)
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_40C32C	dd offset dword_40B650	; DATA XREF: sub_40AD00+3r
					; sub_40AD00+12r ...
dword_40C330	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_40C334	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_40C338	dd 0BB40E64Eh		; DATA XREF: sub_40ADA0+3r
					; sub_40ADA0:loc_40AE52w ...
dword_40C33C	dd 44BF19B1h		; DATA XREF: sub_40ADA0+31w
					; sub_40ADA0+B8w ...
dword_40C340	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0000D000)
; Virtual size			: 00001770 (   6000.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 0000B000
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 40D000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
; char Format[]
Format		db 'SendInput failed: %s',0Ah,0 ; DATA XREF: sub_401982+2C0o
; const	WCHAR String
String		dw 0			; DATA XREF: sub_401C7A:loc_401C90o
; const	WCHAR aOutOfCore
aOutOfCore:				; DATA XREF: sub_401C7A+4Bo
		unicode	0, <[out of core]>,0
; char aMapdialogrectF[]
aMapdialogrectF	db 'MapDialogRect failed: %s',0Ah,0 ; DATA XREF: sub_401D11+70o
; char aLoadimageFaile[]
aLoadimageFaile	db 'LoadImage failed: %s',0Ah,0 ; DATA XREF: sub_401D11+13Co
; const	CHAR byte_40D0A8
byte_40D0A8	db 0			; DATA XREF: DialogFunc+9Fo
; char aPinentryW32[]
aPinentryW32	db 'pinentry-w32',0     ; DATA XREF: sub_40248D+2Do
; CHAR LibFileName[]
LibFileName	db 'user32.dll',0       ; DATA XREF: sub_40248D+4Ao
; CHAR aLocksetforegro[]
aLocksetforegro	db 'LockSetForegroundWindow',0 ; DATA XREF: sub_40248D+64o
		align 4
; char a02x[]
a02x		db '%%%02X',0           ; DATA XREF: sub_40285E+41o
		align 4
aAssuanWriteLin	db 'ASSUAN WRITE LINE failed: rc=%d',0Ah,0 ; DATA XREF: .text:00402A10o
		align 4
aAssuanReadLine	db 'ASSUAN READ LINE failed: rc=%d',0Ah,0 ; DATA XREF: .text:00402A5Do
; char a____Pinentry0_[]
a____Pinentry0_	db '../../pinentry-0.9.4/pinentry/pinentry.c',0 ; DATA XREF: sub_402BD0+22o
					; sub_402BD0+4Ao ...
; char aPinPin[]
aPinPin		db 'pin->pin',0         ; DATA XREF: sub_402BD0+2Ao
; char aPinPin_0[]
aPinPin_0	db '!pin->pin',0        ; DATA XREF: sub_402BD0+52o
; char aPinPin_len0[]
aPinPin_len0	db 'pin->pin_len == 0',0 ; DATA XREF: sub_402CAA+2Ao
; char aPinPin_len0_0[]
aPinPin_len0_0	db 'pin->pin_len > 0',0 ; DATA XREF: sub_402CAA+52o
aLen0		db 'len == 0',0         ; DATA XREF: .text:00402D78o
aDisplay	db 'DISPLAY',0          ; DATA XREF: .text:00402E88o
aDisplay_0	db '--display',0        ; DATA XREF: .text:00402EB5o
aDisplay_1	db '--display=',0       ; DATA XREF: .text:00402EDFo
aPinentry	db 'pinentry',0         ; DATA XREF: sub_402F23:loc_402F4Fo
a0_9_4		db '0.9.4',0            ; DATA XREF: sub_402F23:loc_402F5Bo
					; sub_404581+30o
aCopyrightC2015	db 'Copyright (C) 2015 g10 Code GmbH',0 ; DATA XREF: sub_402F23:loc_402F67o
		align 10h
aPleaseReportBu	db 'Please report bugs to <http://bugs.gnupg.org>.',0Ah,0
					; DATA XREF: sub_402F23:loc_402F73o
; char aUsageSOptionsH[]
aUsageSOptionsH	db 'Usage: %s [options] (-h for help)',0 ; DATA XREF: sub_402F23+A5o
		align 4
aAskSecurelyFor	db 'Ask securely for a secret and print it to stdout.',0
					; DATA XREF: sub_402F23:loc_402FF7o
a1		db '1',0                ; DATA XREF: sub_402F23:loc_403000o
off_40D268	dd offset loc_403009	; DATA XREF: sub_402F23+17o
		dd offset loc_402F7F	; jump table for switch	statement
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_402F43
		dd offset loc_402F4F
		dd offset loc_402F5B
		dd offset loc_402F67
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_402F73
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_403009
		dd offset loc_402F7F
		dd offset loc_402FF7
		dd offset loc_403000
aBright		db 'bright-',0          ; DATA XREF: sub_40301A+48o
aBright_0	db 'bright',0           ; DATA XREF: sub_40301A+4Fo
aBold		db 'bold-',0            ; DATA XREF: sub_40301A+56o
aBold_0		db 'bold',0             ; DATA XREF: sub_40301A+5Do
; char aSS[]
aSS		db '%s: %s',0Ah,0       ; DATA XREF: sub_40318A+A8o
					; sub_40318A+108o ...
		align 4
off_40D338	dd offset loc_403324	; DATA XREF: sub_40318A+53r
		dd offset loc_403204	; jump table for switch	statement
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_403384
		dd offset loc_4032C4
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_403264
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_4033E4
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_4033F1
		dd offset loc_4031E6
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_4031F5
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_40345D
		dd offset loc_403453
aNoGrab		db 'no-grab',0          ; DATA XREF: sub_403495+Do
aGrab		db 'grab',0             ; DATA XREF: sub_403495+4Eo
aDebugWait	db 'debug-wait',0       ; DATA XREF: sub_403495+8Fo
; char aSWaitingForDeb[]
aSWaitingForDeb	db '%s: waiting for debugger - my pid is %u ...',0Ah,0
					; DATA XREF: sub_403495+B9o
; char aS___Okay[]
aS___Okay	db '%s: ... okay',0Ah,0 ; DATA XREF: sub_403495+105o
aDisplay_2	db 'display',0          ; DATA XREF: sub_403495+131o
aTtyname	db 'ttyname',0          ; DATA XREF: sub_403495+196o
aTtytype	db 'ttytype',0          ; DATA XREF: sub_403495+1FBo
aLcCtype	db 'lc-ctype',0         ; DATA XREF: sub_403495+260o
aLcMessages	db 'lc-messages',0      ; DATA XREF: sub_403495+2C5o
aParentWid	db 'parent-wid',0       ; DATA XREF: sub_403495+32Ao
aTouchFile	db 'touch-file',0       ; DATA XREF: sub_403495+367o
aDefaultOk	db 'default-ok',0       ; DATA XREF: sub_403495+3CCo
aDefaultCancel	db 'default-cancel',0   ; DATA XREF: sub_403495+41Bo
aDefaultPrompt	db 'default-prompt',0   ; DATA XREF: sub_403495+46Ao
aDefaultPwmngr	db 'default-pwmngr',0   ; DATA XREF: sub_403495+4B9o
aAllowExternalP	db 'allow-external-password-cache',0 ; DATA XREF: sub_403495+501o
aClear		db '--clear',0          ; DATA XREF: sub_403BE7+2Do
aQuality	db 'Quality:',0         ; DATA XREF: sub_403FDE+11o
; char byte_40D4E9
byte_40D4E9	db 0			; DATA XREF: sub_4040FA+10Eo
					; sub_4040FA+297o
; char aPassword_from_[]
aPassword_from_	db 'PASSWORD_FROM_CACHE',0 ; DATA XREF: sub_4040FA+116o
aPin		db 'PIN:',0             ; DATA XREF: sub_4040FA:loc_40425Bo
; char aClose[]
aClose		db 'close',0            ; DATA XREF: sub_4040FA+22Ao
					; sub_404459+9Eo
; char aButton_info[]
aButton_info	db 'BUTTON_INFO',0      ; DATA XREF: sub_4040FA+232o
					; sub_404459+A6o
; char aPin_repeated[]
aPin_repeated	db 'PIN_REPEATED',0     ; DATA XREF: sub_4040FA+29Fo
; char SubStr[]
SubStr		db '--one-button',0     ; DATA XREF: sub_404459+6o
					; sub_404566+6o
aVersion	db 'version',0          ; DATA XREF: sub_404581+Do
aPid		db 'pid',0              ; DATA XREF: sub_404581+79o
; char aLu[]
aLu		db '%lu',0              ; DATA XREF: sub_404581+A3o
		align 10h
; char aSFailedToIniti[]
aSFailedToIniti	db '%s: failed to initialize the server: %s',0Ah,0
					; DATA XREF: sub_404803+38o
		align 4
; char aSFailedToTheRe[]
aSFailedToTheRe	db '%s: failed to the register commands with Assuan: %s',0Ah,0
					; DATA XREF: sub_404803+87o
		align 4
; char aSAssuanAcceptP[]
aSAssuanAcceptP	db '%s: Assuan accept problem: %s',0Ah,0 ; DATA XREF: sub_404803+109o
		align 4
; char aSAssuanProcess[]
aSAssuanProcess	db '%s: Assuan processing failed: %s',0Ah,0 ; DATA XREF: sub_404803+150o
aSetdesc	db 'SETDESC',0          ; DATA XREF: .data:off_40C020o
aSetprompt	db 'SETPROMPT',0        ; DATA XREF: .data:0040C02Co
aSetkeyinfo	db 'SETKEYINFO',0       ; DATA XREF: .data:0040C038o
aSetrepeat	db 'SETREPEAT',0        ; DATA XREF: .data:0040C044o
aSetrepeaterror	db 'SETREPEATERROR',0   ; DATA XREF: .data:0040C050o
aSeterror	db 'SETERROR',0         ; DATA XREF: .data:0040C05Co
aSetok		db 'SETOK',0            ; DATA XREF: .data:0040C068o
aSetnotok	db 'SETNOTOK',0         ; DATA XREF: .data:0040C074o
aSetcancel	db 'SETCANCEL',0        ; DATA XREF: .data:0040C080o
aGetpin		db 'GETPIN',0           ; DATA XREF: .data:0040C08Co
aConfirm	db 'CONFIRM',0          ; DATA XREF: .data:0040C098o
aMessage	db 'MESSAGE',0          ; DATA XREF: .data:0040C0A4o
aSetqualitybar	db 'SETQUALITYBAR',0    ; DATA XREF: .data:0040C0B0o
aSetqualitybar_	db 'SETQUALITYBAR_TT',0 ; DATA XREF: .data:0040C0BCo
aGetinfo	db 'GETINFO',0          ; DATA XREF: .data:0040C0C8o
aSettitle	db 'SETTITLE',0         ; DATA XREF: .data:0040C0D4o
aSettimeout	db 'SETTIMEOUT',0       ; DATA XREF: .data:0040C0E0o
aClearpassphras	db 'CLEARPASSPHRASE',0  ; DATA XREF: .data:0040C0ECo
aDebug		db 'debug',0
aTurnOnDebuggin	db 'Turn on debugging output',0 ; DATA XREF: .data:0040C12Co
aDisplaySetTheX	db '|DISPLAY|Set the X display',0
		align 4
aFileSetTheTtyT	db '|FILE|Set the tty terminal node name',0
		align 4
aNameSetTheTtyT	db '|NAME|Set the tty terminal type',0
aStringSetTheTt	db '|STRING|Set the tty LC_CTYPE value',0
		align 4
aStringSetThe_0	db '|STRING|Set the tty LC_MESSAGES value',0
aTimeout_0	db 'timeout',0
		align 4
aSecsTimeoutWai	db '|SECS|Timeout waiting for input after this many seconds',0
aNoGlobalGrab	db 'no-global-grab',0
		align 10h
aGrabKeyboardOn	db 'Grab keyboard only while window is focused',0
					; DATA XREF: .data:0040C19Co
		align 4
aParentWindowId	db 'Parent window ID (for positioning)',0
aColors		db 'colors',0
		align 4
aStringSetCusto	db '|STRING|Set custom colors for ncurses',0
aNone		db 'none',0             ; DATA XREF: .data:Stro
aDefault	db 'default',0          ; DATA XREF: .data:0040C1E8o
aBlack		db 'black',0
aRed		db 'red',0
aGreen		db 'green',0
aYellow		db 'yellow',0
aBlue		db 'blue',0
aMagenta	db 'magenta',0
aCyan		db 'cyan',0
aWhite		db 'white',0
		align 4
; char aS[]
aS		db '%s: ',0             ; DATA XREF: sub_4049B0+1Ao
; char aSOhhhhJeeee[]
aSOhhhhJeeee	db '%s: Ohhhh jeeee: ',0 ; DATA XREF: sub_404A09+1Ao
		align 4
; char aInvalidArgumen[]
aInvalidArgumen	db 'invalid argument for arg_parse',0Ah,0 ; DATA XREF: sub_404C2A+81o
aArgumentNotExp	db 'argument not expected',0 ; DATA XREF: sub_404C2A+B0o
aReadError	db 'read error',0       ; DATA XREF: sub_404C2A+C7o
aKeywordTooLong	db 'keyword too long',0 ; DATA XREF: sub_404C2A+DBo
aMissingArgumen	db 'missing argument',0 ; DATA XREF: sub_404C2A+EFo
aInvalidArgum_0	db 'invalid argument',0 ; DATA XREF: sub_404C2A+103o
aInvalidCommand	db 'invalid command',0  ; DATA XREF: sub_404C2A+117o
aInvalidAliasDe	db 'invalid alias definition',0 ; DATA XREF: sub_404C2A+12Bo
aOutOfCore_0	db 'out of core',0      ; DATA XREF: sub_404C2A+13Fo
aInvalidOption	db 'invalid option',0   ; DATA XREF: sub_404C2A:loc_404D72o
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_404C2A+166o
a??		db '[??]',0             ; DATA XREF: sub_404C2A:loc_404DB3o
; char aMissingArgum_0[]
aMissingArgum_0	db 'missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_404C2A+1A3o
		align 4
; char aInvalidArgum_1[]
aInvalidArgum_1	db 'invalid argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_404C2A+1C6o
		align 4
; char aOption_50sDoes[]
aOption_50sDoes	db 'option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_404C2A+1E9o
; char aInvalidComma_0[]
aInvalidComma_0	db 'invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_404C2A+20Co
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_404C2A+22Co
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_404C2A+24Co
aOutOfCore_1	db 'out of core',0Ah,0  ; DATA XREF: sub_404C2A+265o
; char aS_0[]
aS_0		db '%s',0Ah,0           ; DATA XREF: sub_404C2A+26Do
; char aInvalidOption_[]
aInvalidOption_	db 'invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_404C2A+282o
aIgnoreInvalidO	db 'ignore-invalid-option',0 ; DATA XREF: .text:00405260o
					; .text:loc_40571Fo
asc_40DA6B	db ' ',9,0              ; DATA XREF: .text:004053D6o
aAlias		db 'alias',0            ; DATA XREF: .text:004056F2o
; char Str1[]
Str1		db 'help',0             ; DATA XREF: sub_405AE6+1B7o
; char aVersion_0[]
aVersion_0	db 'version',0          ; DATA XREF: sub_405AE6+1F1o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_405AE6+233o
asc_40DA8A	db 0Ah,0		; DATA XREF: sub_405AE6+257o
					; sub_405AE6+2E3o ...
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_405AE6+28Fo
asc_40DA99	db '--',0               ; DATA XREF: sub_405AE6+2EFo
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_405AE6+31Eo
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_40DAC8	db 'x',0                ; DATA XREF: sub_405AE6:loc_406213o
aOptions	db 'Options:',0         ; DATA XREF: sub_4064E1+1A2o
asc_40DAD3	db ' -',0               ; DATA XREF: sub_4064E1+2DAo
asc_40DAD6	db ' ',0                ; DATA XREF: sub_4064E1+322o
					; sub_4064E1+44Do ...
asc_40DAD8	db '   ',0              ; DATA XREF: sub_4064E1+39Co
					; sub_4064E1+4C4o
asc_40DADC	db ' --',0              ; DATA XREF: sub_4064E1+401o
aASingleDashMay	db 0Ah			; DATA XREF: sub_4064E1+667o
		db '(A single dash may be used instead of the double ones)',0Ah,0
asc_40DB19	db ')',0                ; DATA XREF: sub_406BC0+47o
asc_40DB1B	db ' (',0               ; DATA XREF: sub_406BC0+56o
asc_40DB1E	db '; ',0               ; DATA XREF: .text:00406E13o
		align 4
aLicenseGplv2Gn	db 'License GPLv2+: GNU GPL version 2 or later <http://gnu.org/licens'
					; DATA XREF: sub_406FBD:loc_407003o
		db 'es/>',0
aFoo		db 'foo',0              ; DATA XREF: sub_406FBD:loc_40700Co
a0_0		db '0.0',0              ; DATA XREF: sub_406FBD:loc_407015o
aCopyrightCYear	db 'Copyright (C) YEAR NAME',0 ; DATA XREF: sub_406FBD:loc_40701Eo
		align 4
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_406FBD:loc_407027o
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 4
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_406FBD:loc_407030o
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 2 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_40DE5C	dd 0			; DATA XREF: sub_406FBD:loc_407039o
off_40DE60	dd offset loc_407003	; DATA XREF: sub_406FBD+3Dr
		dd offset loc_40700C	; jump table for switch	statement
		dd offset loc_407041
		dd offset loc_407015
		dd offset loc_40701E
		dd offset loc_407027
		dd offset loc_407030
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407041
		dd offset loc_407039
		dd offset loc_407039
dword_40DEE0	dd 0			; DATA XREF: sub_407070+3o
; char a____Pinentry_0[]
a____Pinentry_0	db '../../pinentry-0.9.4/assuan/assuan-buffer.c',0
					; DATA XREF: sub_407198+BBo
					; sub_407198+1AFo
; char aAtticlenLinele[]
aAtticlenLinele	db 'atticlen < LINELENGTH',0 ; DATA XREF: sub_407198+C3o
; char aSPErrorS[]
aSPErrorS	db '%s[%p] <- [Error: %s]',0Ah,0 ; DATA XREF: sub_407198+166o
; char aCtxInbound_eof[]
aCtxInbound_eof	db 'ctx->inbound.eof',0 ; DATA XREF: sub_407198+1B7o
; char aSPEof[]
aSPEof		db '%s[%p] <- [EOF]',0Ah,0 ; DATA XREF: sub_407198+1D2o
; char aSP[]
aSP		db '%s[%p] <- ',0       ; DATA XREF: sub_407198+2ECo
aConfidentialDa	db '[Confidential data not shown]',0 ; DATA XREF: sub_407198+31Eo
					; sub_4075F2+5Do ...
; char aSPInvalidLine[]
aSPInvalidLine	db '%s[%p] <- [Invalid line]',0Ah,0 ; DATA XREF: sub_407198+3A4o
; char aSP_0[]
aSP_0		db '%s[%p] -> ',0       ; DATA XREF: sub_4075F2+2Bo
					; sub_40774C+101o ...
asc_40DFAD	db 0Ah,0		; DATA XREF: sub_4075F2+130o
; char a02x_0[]
a02x_0		db '%%%02X',0           ; DATA XREF: sub_40774C+91o
aEnd		db 'END',0              ; DATA XREF: sub_407AA6+5Co
		align 4
; char a02x_1[]
a02x_1		db ' %02x',0            ; DATA XREF: sub_407C9D+9Eo
aX02x		db 'x%02x',0            ; DATA XREF: .text:00407EACo
aNoHandlerRegis	db 'no handler registered',0 ; DATA XREF: sub_407EF4+6o
aArgumentRequir	db 'argument required',0 ; DATA XREF: .text:00407F93o
aNoOptionNameGi	db 'no option name given',0 ; DATA XREF: .text:00407FBDo
aOptionArgument	db 'option argument expected',0 ; DATA XREF: .text:00408092o
		align 10h
aOptionShouldNo	db 'option should not begin with one dash',0 ; DATA XREF: .text:0040814Ao
aFd		db 'FD=',0              ; DATA XREF: sub_408268+Do
aFdNExpected	db 'FD=<n> expected',0  ; DATA XREF: sub_408268+30o
aNumberRequired	db 'number required',0  ; DATA XREF: sub_408268:loc_4082D0o
aFdSameAsInboun	db 'fd same as inbound fd',0 ; DATA XREF: sub_408268+105o
aFdSameAsOutbou	db 'fd same as outbound fd',0 ; DATA XREF: sub_408268+134o
aNop		db 'NOP',0              ; DATA XREF: .data:off_40C260o
aCancel		db 'CANCEL',0
aOption		db 'OPTION',0           ; DATA XREF: .data:0040C2F0o
aBye		db 'BYE',0
aAuth		db 'AUTH',0
aReset		db 'RESET',0
aEnd_0		db 'END',0
aInput		db 'INPUT',0
aOutput		db 'OUTPUT',0           ; DATA XREF: .data:0040C2E0o
aLeadingWhiteSp	db 'leading white-space',0 ; DATA XREF: sub_4088E6+73o
aOk		db 'OK',0               ; DATA XREF: sub_408AA6:loc_408BE0o
aOkClosingConne	db 'OK closing connection',0 ; DATA XREF: sub_408AA6+15Co
; char aErrDServerFaul[]
aErrDServerFaul	db 'ERR %d server fault (%.50s)',0 ; DATA XREF: sub_408AA6+196o
byte_40E112	db 0			; DATA XREF: sub_408AA6:loc_408C88o
					; sub_408AA6:loc_408C9Ao ...
asc_40E113	db ' - ',0              ; DATA XREF: sub_408AA6+1EDo
; char aErrD_50sS_100s[]
aErrD_50sS_100s	db 'ERR %d %.50s%s%.100s',0 ; DATA XREF: sub_408AA6+204o
aOk_0		db 'OK ',0              ; DATA XREF: .text:loc_408E8Bo
aS_1		db 'S ',0               ; DATA XREF: sub_408ECE+8Bo
					; sub_408ECE+144o
asc_40E133	db ' ',0                ; DATA XREF: sub_408ECE+C2o
					; sub_408ECE+175o
		align 4
aNoError	db 'no error',0         ; DATA XREF: sub_409268:loc_4093ECo
aGeneralError	db 'general error',0    ; DATA XREF: sub_409268:loc_4093F8o
aOutOfCore_2	db 'out of core',0      ; DATA XREF: sub_409268:loc_409404o
aInvalidValue	db 'invalid value',0    ; DATA XREF: sub_409268:loc_409410o
aTimeout	db 'timeout',0          ; DATA XREF: sub_409268:loc_40941Co
aReadError_0	db 'read error',0       ; DATA XREF: sub_409268:loc_409428o
aWriteError	db 'write error',0      ; DATA XREF: sub_409268:loc_409434o
aProblemStartin	db 'problem starting server',0 ; DATA XREF: sub_409268:loc_409440o
aNotAServer	db 'not a server',0     ; DATA XREF: sub_409268:loc_40944Co
aNotAClient	db 'not a client',0     ; DATA XREF: sub_409268:loc_409458o
aNestedCommands	db 'nested commands',0  ; DATA XREF: sub_409268:loc_409464o
aInvalidRespons	db 'invalid response',0 ; DATA XREF: sub_409268:loc_409470o
aNoDataCallback	db 'no data callback',0 ; DATA XREF: sub_409268:loc_40947Co
aNoInquireCallb	db 'no inquire callback',0 ; DATA XREF: sub_409268:loc_409488o
aConnectFailed	db 'connect failed',0   ; DATA XREF: sub_409268:loc_409494o
aAcceptFailed	db 'accept failed',0    ; DATA XREF: sub_409268:loc_4094A0o
aNotImplemented	db 'not implemented',0  ; DATA XREF: sub_409268:loc_4094ACo
aServerFault	db 'server fault',0     ; DATA XREF: sub_409268:loc_4094B8o
aUnknownCommand	db 'unknown command',0  ; DATA XREF: sub_409268:loc_4094C4o
aSyntaxError	db 'syntax error',0     ; DATA XREF: sub_409268:loc_4094D0o
aParameterConfl	db 'parameter conflict',0 ; DATA XREF: sub_409268:loc_4094D9o
aLineTooLong	db 'line too long',0    ; DATA XREF: sub_409268:loc_4094E2o
aLineNotTermina	db 'line not terminated',0 ; DATA XREF: sub_409268:loc_4094EBo
aCanceled	db 'canceled',0         ; DATA XREF: sub_409268:loc_4094F4o
aInvalidOptio_0	db 'invalid option',0   ; DATA XREF: sub_409268:loc_4094FDo
aLocaleProblem	db 'locale problem',0   ; DATA XREF: sub_409268:loc_409506o
aNotConfirmed	db 'not confirmed',0    ; DATA XREF: sub_409268:loc_40950Fo
aTooShort	db 'too short',0        ; DATA XREF: sub_409268:loc_409518o
aEnoent		db 'enoent',0           ; DATA XREF: sub_409268:loc_409521o
aEnotty		db 'enotty',0           ; DATA XREF: sub_409268:loc_40952Ao
; char aEcD[]
aEcD		db 'ec=%d',0            ; DATA XREF: sub_409268:loc_409533o
		align 10h
aOk_1		db 'OK ',0              ; DATA XREF: .text:loc_4095CDo
aOkYourOrdersPl	db 'OK Your orders please',0 ; DATA XREF: sub_409610:loc_409680o
		align 4
; char aWarningUsingIn[]
aWarningUsingIn	db 'Warning: using insecure memory!',0Ah,0 ; DATA XREF: sub_4097F0+Fo
		align 10h
; char aPleaseNoteThat[]
aPleaseNoteThat	db 'Please note that you don',27h,'t have secure memory on this system',0Ah
					; DATA XREF: sub_40980D+6o
		db 0
; char aSecureMemoryIs[]
aSecureMemoryIs	db 'secure memory is disabled',0 ; DATA XREF: sub_409821+17o
; char aCanTAllocateMe[]
aCanTAllocateMe	db 'can',27h,'t allocate memory pool of %u bytes',0Ah,0
					; DATA XREF: sub_409821+57o
; char aOopsSecureMemo[]
aOopsSecureMemo	db 'Oops, secure memory pool already initialized',0Ah,0
					; DATA XREF: sub_409938:loc_40996Ao
		align 10h
; char aOperationIsNot[]
aOperationIsNot	db 'operation is not possible without initialized secure memory',0Ah,0
					; DATA XREF: sub_409978+16o
		align 10h
; char aYouMayHaveUsed[]
aYouMayHaveUsed	db '(you may have used the wrong program for this task)',0Ah,0
					; DATA XREF: sub_409978+22o
		align 4
aSecmemUsageUUB	db 'secmem usage: %u/%u bytes in %u/%u blocks of pool %lu/%lu',0Ah,0
					; DATA XREF: .text:00409DCAo
		align 4
; CHAR aMingwm10_dll[]
aMingwm10_dll	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_40E4C0	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_40A370+3o
		align 4
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_40A370+39o
		align 10h
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_40E5E0o
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0040E5E4o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0040E5E8o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0040E5ECo
		align 4
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0040E5F0o
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0040E5F4o
		align 10h
off_40E5E0	dd offset aArgumentDomain ; DATA XREF: sub_40A370+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_40A3E0+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_40A440+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_40A440+1F9o
					; sub_40A440+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_40A440+1D2o
		align 10h
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_40A680+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_40A680+1B7o
		align 10h
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_40AC30:loc_40ACD0o
		unicode	0, <msvcrt.dll>,0
		align 4
off_40E708	dd offset dword_40F500	; DATA XREF: .text:0040AEC8o
		dd offset dword_40F220
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_40B210+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_2[]
aS_2		db '%s',0Ah,0           ; DATA XREF: sub_40B210+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_40B210+10Fo
		align 10h
dword_40E770	dd 0			; DATA XREF: sub_40A680+59o
					; sub_40A680+5Eo ...
dword_40E774	dd 0			; DATA XREF: sub_40A680+7Fr
dword_40E778	dd 0			; DATA XREF: sub_40A680:loc_40A7CCr
dword_40E77C	dd 21h dup(0)		; DATA XREF: sub_40A680+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 0000F000)
; Virtual size			: 00000680 (   1664.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 40F000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_40F000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_40F004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_40F008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_40F00C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_40F010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_40F014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_40F018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_40F01C	dd ?			; DATA XREF: sub_401010+3Aw
dword_40F020	dd ?			; DATA XREF: sub_40248D+88w
dword_40F024	dd ?			; DATA XREF: DialogFunc+46w
					; sub_4023AD+30w ...
dword_40F028	dd ?			; DATA XREF: DialogFunc:loc_402045r
					; DialogFunc:loc_402141r ...
dword_40F02C	dd ?			; DATA XREF: sub_40226D+90w
					; sub_4023AD+2Bw ...
dword_40F030	dd ?			; DATA XREF: DialogFunc+2ABw
					; DialogFunc+322w ...
dword_40F034	dd ?			; DATA XREF: sub_40248D+19w
					; sub_40248D+A5r
dword_40F038	dd ?			; DATA XREF: sub_40248D+23w
					; sub_40248D:loc_40252Cr
; int dword_40F03C
dword_40F03C	dd ?			; DATA XREF: DialogFunc+4Ew
					; DialogFunc+53r ...
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_401550+29o
					; sub_401550+56o
; char Dest[56]
Dest		db 38h dup(?)		; DATA XREF: sub_402DF2+37o
					; sub_402F23:loc_402F43o ...
; char *dword_40F178
dword_40F178	dd ?			; DATA XREF: sub_402F23:loc_402F7Fr
					; sub_402F23+97w ...
		align 10h
dword_40F180	dd ?			; DATA XREF: sub_406FBD+6r
					; sub_406FBD+Fr ...
dword_40F184	dd ?			; DATA XREF: .text:00404B07w
					; sub_404B0E:loc_404B34r ...
; char byte_40F188[28]
byte_40F188	db 1Ch dup(?)		; DATA XREF: sub_409268+2DBo
					; sub_409268+2E7o
dword_40F1A4	dd ?			; DATA XREF: sub_409821+40w
					; sub_409821+45r ...
dword_40F1A8	dd ?			; DATA XREF: sub_409821+2Ar
					; sub_409821:loc_409886w ...
		align 10h
; size_t Size
Size		dd ?			; DATA XREF: sub_409821+9w
					; sub_409821+33r ...
dword_40F1B4	dd ?			; DATA XREF: sub_409821+86w
					; sub_409978+BFr ...
dword_40F1B8	dd ?			; DATA XREF: sub_409978:loc_4099E6r
					; sub_409978+A3w ...
dword_40F1BC	dd ?			; DATA XREF: sub_409978+13Br
					; sub_409978+149w ...
dword_40F1C0	dd ?			; DATA XREF: sub_409978+11Cr
					; sub_409978+123w ...
dword_40F1C4	dd ?			; DATA XREF: sub_409978+154r
					; sub_409978+162w ...
dword_40F1C8	dd ?			; DATA XREF: sub_409978+128r
					; sub_409978+130w ...
dword_40F1CC	dd ?			; DATA XREF: sub_409821+Er
					; .text:00409D99r
dword_40F1D0	dd ?			; DATA XREF: sub_4098B8+33r
					; sub_4098B8+3Cw ...
dword_40F1D4	dd ?			; DATA XREF: sub_4097F0+6r
					; sub_4098B8+14w ...
dword_40F1D8	dd ?			; DATA XREF: sub_4098B8+6r
					; sub_4098B8+1Fw ...
dword_40F1DC	dd ?			; DATA XREF: sub_401010+3r
dword_40F1E0	dd ?			; DATA XREF: sub_401010+25r
dword_40F1E4	dd ?			; DATA XREF: sub_401060+22w
dword_40F1E8	dd ?			; DATA XREF: sub_401060+18w
dword_40F1EC	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_40F1F8	dd ?			; DATA XREF: sub_401060+2Cw
dword_40F1FC	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_40F200	dd ?			; DATA XREF: sub_401060+5Er
dword_40F204	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_40A1ECr
dword_40F208	dd ?			; DATA XREF: .text:0040A313r
					; sub_40A360+4w
dword_40F20C	dd ?			; DATA XREF: sub_40A680+9r
					; sub_40A680:loc_40A6A0w
dword_40F210	dd ?			; DATA XREF: sub_40A440+1Dr
					; sub_40A440+58r ...
dword_40F214	dd ?			; DATA XREF: sub_40A440+Br
					; sub_40A440:loc_40A4FFw ...
dword_40F218	dd ?			; DATA XREF: sub_40AC30+4r
					; sub_40AC30+92w ...
dword_40F21C	dd ?			; DATA XREF: sub_40AD80r
					; sub_40AD80:loc_40AD90w
dword_40F220	dd 2Bh dup(?)		; DATA XREF: .rdata:0040E70Co
dword_40F2CC	dd ?			; DATA XREF: .text:0040AEAAw
		dd 2 dup(?)
dword_40F2D8	dd ?			; DATA XREF: .text:0040AE96w
		dd 2 dup(?)
dword_40F2E4	dd ?			; DATA XREF: .text:0040AE7Cw
		dd 86h dup(?)
dword_40F500	dd ?			; DATA XREF: .text:0040AE82w
					; .rdata:off_40E708o
dword_40F504	dd ?			; DATA XREF: .text:0040AE8Cw
		dd ?
dword_40F50C	dd ?			; DATA XREF: .text:0040AE9Bw
		dd 14h dup(?)
dword_40F560	dd ?			; DATA XREF: .text:0040AF73r
					; .text:0040B004r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_40AF00+7o
					; sub_40AF00:loc_40AF55o ...
dword_40F57C	dd ?			; DATA XREF: sub_40AF00+14r
					; .text:0040AFC8r ...
		dd ?
dword_40F584	dd ?			; DATA XREF: sub_401180+1A8w
dword_40F588	dd ?			; DATA XREF: sub_401180+1BFw
dword_40F58C	dd ?			; DATA XREF: sub_401180+1B2w
		align 20h
; void *dword_40F5A0
dword_40F5A0	dd ?			; DATA XREF: sub_402560:loc_402694r
					; sub_402560+1DDo ...
; void *dword_40F5A4
dword_40F5A4	dd ?			; DATA XREF: sub_402560+141r
					; sub_403AEF+53r ...
; void *dword_40F5A8
dword_40F5A8	dd ?			; DATA XREF: sub_402560+14Er
					; sub_403D45+53r ...
; void *dword_40F5AC
dword_40F5AC	dd ?			; DATA XREF: sub_402560+15Br
					; sub_403B6B+53r ...
; void *dword_40F5B0
dword_40F5B0	dd ?			; DATA XREF: sub_402560+168r
					; sub_403DC1+53r ...
; void *dword_40F5B4
dword_40F5B4	dd ?			; DATA XREF: sub_402560+175r
					; sub_403E3D+53r ...
; void *dword_40F5B8
dword_40F5B8	dd ?			; DATA XREF: sub_402560+182r
					; sub_403EB9+53r ...
; void *Dst
Dst		dd ?			; DATA XREF: sub_402560+18Fr
					; sub_4040FA+21r ...
dword_40F5C0	dd ?			; DATA XREF: sub_4040FA+BEr
					; sub_4040FA+C8r
dword_40F5C4	dd ?			; DATA XREF: sub_4040FA+104w
					; sub_4040FA:loc_404238w
; void *dword_40F5C8
dword_40F5C8	dd ?			; DATA XREF: sub_402560+68r
					; sub_402560+127r ...
; void *Memory
Memory		dd ?			; DATA XREF: sub_402560+10r
					; sub_402560+B2r ...
; void *dword_40F5D0
dword_40F5D0	dd ?			; DATA XREF: sub_402560+18r
					; sub_402560+BFr ...
; void *dword_40F5D4
dword_40F5D4	dd ?			; DATA XREF: sub_402560+20r
					; sub_402560+CCr ...
; void *dword_40F5D8
dword_40F5D8	dd ?			; DATA XREF: sub_402560+28r
					; sub_402560+D9r ...
dword_40F5DC	dd ?			; DATA XREF: sub_402560+60r
					; sub_402560+29Ew ...
dword_40F5E0	dd ?			; DATA XREF: sub_402560+A0r
					; sub_402560+1F8w ...
dword_40F5E4	dd ?			; DATA XREF: sub_402560+8r
					; sub_402560+202w ...
dword_40F5E8	dd ?			; DATA XREF: sub_402560+70r
					; sub_402560+2AEw ...
; void *dword_40F5EC
dword_40F5EC	dd ?			; DATA XREF: sub_402560+58r
					; sub_402560+11Ar ...
		dd ?
dword_40F5F4	dd ?			; DATA XREF: sub_404459+4Ew
					; sub_404459:loc_40454Fr
dword_40F5F8	dd ?			; DATA XREF: sub_4040FA:loc_40426Cw
					; sub_4040FA:loc_404364r ...
dword_40F5FC	dd ?			; DATA XREF: sub_4040FA+17Cw
					; sub_4040FA+257r ...
dword_40F600	dd ?			; DATA XREF: sub_4040FA+186w
					; sub_4040FA+221r ...
dword_40F604	dd ?			; DATA XREF: sub_4040FA+19Aw
					; sub_404459+21w ...
; void *dword_40F608
dword_40F608	dd ?			; DATA XREF: sub_402560+19Cr
					; sub_403C5F+53r ...
; void *dword_40F60C
dword_40F60C	dd ?			; DATA XREF: sub_402560+1A9r
					; sub_403CD2+53r ...
dword_40F610	dd ?			; DATA XREF: sub_4040FA+190w
					; sub_4040FA+28Er
; void *dword_40F614
dword_40F614	dd ?			; DATA XREF: sub_402560+1B6r
					; sub_403FDE+64r ...
; void *dword_40F618
dword_40F618	dd ?			; DATA XREF: sub_402560+1C3r
					; sub_40406B:loc_4040D1r ...
dword_40F61C	dd ?			; DATA XREF: sub_402560+78r
					; sub_402560+20Cw ...
dword_40F620	dd ?			; DATA XREF: sub_402560+80r
					; sub_402560+216w ...
dword_40F624	dd ?			; DATA XREF: sub_402560+88r
					; sub_402560+220w ...
dword_40F628	dd ?			; DATA XREF: sub_402560+90r
					; sub_402560+22Aw ...
dword_40F62C	dd ?			; DATA XREF: sub_402560+98r
					; sub_402560+234w ...
; void *dword_40F630
dword_40F630	dd ?			; DATA XREF: sub_402560+38r
					; sub_402560+E6r ...
; void *dword_40F634
dword_40F634	dd ?			; DATA XREF: sub_402560+40r
					; sub_402560+F3r ...
; void *dword_40F638
dword_40F638	dd ?			; DATA XREF: sub_402560+48r
					; sub_402560+100r ...
; void *dword_40F63C
dword_40F63C	dd ?			; DATA XREF: sub_402560+50r
					; sub_402560+10Dr ...
dword_40F640	dd ?			; DATA XREF: sub_402560+30r
					; sub_402560+26Ew ...
dword_40F644	dd ?			; DATA XREF: sub_403495+538w
					; sub_4040FA+5Br ...
; void *dword_40F648
dword_40F648	dd ?			; DATA XREF: sub_402560+1D0r
					; sub_403BE7+8r ...
dword_40F64C	dd ?			; DATA XREF: sub_4040FA+32Ar
dword_40F650	dd ?			; DATA XREF: sub_4040FA+1A7w
					; sub_4040FA+1BDw
dword_40F654	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_409FD3w ...
dword_40F658	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_40F65C	dd ?			; DATA XREF: TlsCallback_0:loc_409F24w
dword_40F660	dd ?			; DATA XREF: sub_401060+64w
					; sub_40A0A0+3Fr ...
dword_40F664	dd ?			; DATA XREF: sub_401060+69w
					; sub_40A0A0+4r ...
dword_40F668	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_40F66C	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 1000h
_bss		ends

;
; Imports from GDI32.dll
;
; Section 5. (virtual address 00010000)
; Virtual size			: 00000C18 (   3096.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 0000C800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
; int __stdcall	GetDeviceCaps(HDC hdc, int index)
		extrn GetDeviceCaps:dword ; CODE XREF: sub_4017BC+A8p
					; sub_4017BC+C3p ...
; HGDIOBJ __stdcall GetStockObject(int i)
		extrn GetStockObject:dword ; CODE XREF:	DialogFunc+3B7p
					; DATA XREF: DialogFunc+3B2r
; int __stdcall	SetBkMode(HDC hdc, int mode)
		extrn SetBkMode:dword	; CODE XREF: DialogFunc+3A6p
					; DATA XREF: DialogFunc+3A1r
; COLORREF __stdcall SetTextColor(HDC hdc, COLORREF color)
		extrn SetTextColor:dword ; CODE	XREF: DialogFunc+38Ep
					; DATA XREF: DialogFunc+389r

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_40248D+9Ap
					; DATA XREF: sub_40248D+95r
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_40B0A0+44p
					; DATA XREF: sub_40B0A0+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_40AF00+Ep
					; .text:0040AFC2p ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_401550+51p
					; DATA XREF: sub_401550+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:0040AED8p
					; DATA XREF: .text:0040AED8r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_40ADA0+6Cp
					; DATA XREF: sub_40ADA0+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_40ADA0+74p
					; DATA XREF: sub_40ADA0+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_401550+11p
					; sub_40A440+1CCp ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_40B210+C2p
					; DATA XREF: sub_40B210+C2r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_401D11+F9p ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_40ADA0+57p
					; DATA XREF: sub_40ADA0+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_40ADA0+7Cp
					; DATA XREF: sub_40ADA0+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_40B0A0+87p
					; DATA XREF: sub_40B0A0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_40AF00+5Cp
					; .text:0040AFE0p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_40248D+56p
					; TlsCallback_0+55p
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_40AC30+A7p
					; DATA XREF: sub_40AC30+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_4016B9+5Bp
					; sub_4016B9+C9p
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_40ADA0+8Bp
					; DATA XREF: sub_40ADA0+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0040AEBFp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:0040AEE9p
					; DATA XREF: .text:0040AEE9r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_40AF00+35p
					; DATA XREF: sub_40AF00+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0040AECFp
					; DATA XREF: .text:0040AECFr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_40A440+142p
					; sub_40A440+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_40A440+A1p
					; sub_40A440+D9p ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_4015AD+48p
					; sub_4015AD+D4p
					; DATA XREF: ...

;
; Imports from msvcrt.dll
;
		extrn __imp__close:dword ; DATA	XREF: _closer
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
		extrn __imp__read:dword	; DATA XREF: _readr
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr
		extrn __imp__write:dword ; DATA	XREF: _writer

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_40A070r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_40318A+9Cp
					; sub_40318A+FCp ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_401982+2A8r
					; sub_401982+2C5r ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_40A0A0+A3p
					; DATA XREF: sub_40A0A0+A3r
; void __cdecl sleep(unsigned __int32 Duration)
		extrn _sleep:dword	; CODE XREF: sub_403495+103p
					; DATA XREF: sub_403495+FEr
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: sub_40301A+B3p
					; sub_40301A+140p
					; DATA XREF: ...
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
; int __cdecl _vsnprintf(char *DstBuf, size_t MaxCount,	const char *Format, va_list ArgList)
		extrn __imp__vsnprintf:dword ; DATA XREF: _vsnprintfr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: sub_404A65+33p
					; sub_404A65+53p ...
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; INT_PTR __stdcall DialogBoxParamA(HINSTANCE hInstance, LPCSTR	lpTemplateName,	HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam)
		extrn DialogBoxParamA:dword ; CODE XREF: sub_4023AD+77p
					; DATA XREF: sub_4023AD+72r
; BOOL __stdcall EnableWindow(HWND hWnd, BOOL bEnable)
		extrn EnableWindow:dword ; CODE	XREF: DialogFunc+1DBp
					; DATA XREF: DialogFunc+1D6r
; BOOL __stdcall EndDialog(HWND	hDlg, INT_PTR nResult)
		extrn EndDialog:dword	; CODE XREF: DialogFunc+2DEp
					; DialogFunc+304p ...
; HDC __stdcall	GetDC(HWND hWnd)
		extrn GetDC:dword	; CODE XREF: sub_4017BC+8Dp
					; sub_401982+16p
					; DATA XREF: ...
; HWND __stdcall GetDesktopWindow()
		extrn GetDesktopWindow:dword ; CODE XREF: sub_4017BC+13p
					; sub_4023AD+42p
					; DATA XREF: ...
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
		extrn GetDlgItem:dword	; CODE XREF: sub_401D11+1Bp
					; DialogFunc+113p ...
; UINT __stdcall GetDlgItemTextW(HWND hDlg, int	nIDDlgItem, LPWSTR lpString, int cchMax)
		extrn GetDlgItemTextW:dword ; CODE XREF: sub_40226D+56p
					; DATA XREF: sub_40226D+51r
; BOOL __stdcall GetWindowRect(HWND hWnd, LPRECT lpRect)
		extrn GetWindowRect:dword ; CODE XREF: sub_4017BC+2Ap
					; sub_4017BC+5Fp ...
; HANDLE __stdcall LoadImageA(HINSTANCE	hInst, LPCSTR name, UINT type, int cx, int cy, UINT fuLoad)
		extrn LoadImageA:dword	; CODE XREF: sub_401D11+122p
					; DATA XREF: sub_401D11+11Dr
; BOOL __stdcall MapDialogRect(HWND hDlg, LPRECT lpRect)
		extrn MapDialogRect:dword ; CODE XREF: sub_401D11+5Bp
					; DATA XREF: sub_401D11+56r
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_40B210+122p
					; DATA XREF: sub_40B210+122r
; int __stdcall	ReleaseDC(HWND hWnd, HDC hDC)
		extrn ReleaseDC:dword	; CODE XREF: sub_4017BC+DDp
					; sub_401982+66p
					; DATA XREF: ...
; UINT __stdcall SendInput(UINT	cInputs, LPINPUT pInputs, int cbSize)
		extrn SendInput:dword	; CODE XREF: sub_401982+29Cp
					; DATA XREF: sub_401982+297r
; LRESULT __stdcall SendMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
		extrn SendMessageA:dword ; CODE	XREF: sub_401D11+17Ep
					; DATA XREF: sub_401D11+179r
; BOOL __stdcall SetDlgItemTextW(HWND hDlg, int	nIDDlgItem, LPCWSTR lpString)
		extrn SetDlgItemTextW:dword ; CODE XREF: sub_401C7A+30p
					; sub_401C7A+65p ...
; BOOL __stdcall SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags)
		extrn SetWindowPos:dword ; CODE	XREF: sub_4017BC+1BCp
					; DialogFunc+230p
					; DATA XREF: ...
; BOOL __stdcall ShowWindow(HWND hWnd, int nCmdShow)
		extrn ShowWindow:dword	; CODE XREF: DialogFunc+25Bp
					; DATA XREF: DialogFunc+256r


; Section 6. (virtual address 00011000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000D600
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 411000h
dword_411000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_411008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_41100C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_40A070
dword_411018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_411030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_40A013o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00012000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000D800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 412000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
