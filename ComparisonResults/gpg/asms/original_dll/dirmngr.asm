;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	FE753198C252C85AA559C583DBE0711F
; Input	CRC32 :	CE508986

; File Name   :	C:\compspace\compare\gpg\dlls\original\dirmngr.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00029434 ( 169012.)
; Section size in file		: 00029600 ( 169472.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:0043A004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, dword ptr ds:byte_435B80+20h
		mov	[esp+2Ch+var_1C], offset dword_435018
		mov	[esp+2Ch+var_24], offset dword_43500C
		mov	[esp+2Ch+var_28], offset dword_435008
		mov	ds:dword_435018, eax
		mov	eax, dword ptr ds:byte_435B80+24h
		mov	[esp+2Ch+var_2C], offset dword_435004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_43501C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:0043A010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	dword ptr ds:byte_435B80+30h, 1
		mov	dword ptr ds:byte_435B80+2Ch, 1
		mov	dword ptr ds:byte_435B80+28h, 1
		mov	ds:dword_435BBC, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_435014, eax
		mov	eax, ds:dword_435BC0
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_4283F0
		mov	edx, ds:dword_435BC4
		mov	ds:dword_436054, eax
		mov	ds:dword_436058, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_428730
		cmp	dword_42B5C4, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_4286D0
		call	sub_4286C0
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_4294A0
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_435BC0
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_43605C
		call	sub_429550
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_436060
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_436060
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_435000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_436060
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_43605C

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_433E5C
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_4289E0
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_435BC8, eax
		call	sub_428F90
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_429050
		mov	eax, ds:dword_435BC0
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_435F64, eax
		mov	eax, 0Ah
		mov	ds:dword_435F6C, 400000h
		cmovnz	eax, edx
		mov	ds:dword_435F68, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_435004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_435008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_435008, eax
		call	sub_4290E0
		mov	eax, ds:__initenv
		mov	edx, ds:dword_43500C
		mov	[eax], edx
		mov	eax, ds:dword_43500C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_435008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_435004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_4034A1
		mov	esi, ds:dword_435014
		test	esi, esi
		mov	ds:dword_435010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_435000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_435010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_436060
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_436060
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_43A008
		mov	[esp+88h+dwMilliseconds], offset dword_43A000
		call	_initterm
		mov	ds:dword_436060, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_436060, 1
		mov	[esp+88h+lpProcName], offset dword_43A018
		mov	[esp+88h+dwMilliseconds], offset dword_43A00C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_435BC0, 1
		call	sub_429100
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_435BC0, 0
		call	sub_429100
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_42A400+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_42B5D0
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_42B5D0
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_42A400+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_401577+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_401570
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_401575
; ---------------------------------------------------------------------------

loc_401570:				; CODE XREF: sub_401550+7j
		mov	eax, 0

loc_401575:				; CODE XREF: sub_401550+1Ej
		pop	ebp
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401577	proc near		; CODE XREF: sub_401592+14p
					; sub_4015AD+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_401550
		leave
		retn
sub_401577	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401592	proc near		; CODE XREF: sub_4020C2+D20p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_401577
		leave
		retn
sub_401592	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015AD	proc near		; CODE XREF: sub_4037E4+204p
					; sub_4037E4+28Dp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_401577
		leave
		retn
sub_4015AD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	pth_usleep
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+14h]
		mov	[esp+8], edx
		mov	edx, [ebp+10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	pth_read
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+14h]
		mov	[esp+8], edx
		mov	edx, [ebp+10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	pth_write
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], 28h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], 28h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_401670
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+18h]
		mov	[esp+8], edx
		mov	edx, [ebp+14h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	pth_waitpid
		jmp	short locret_401675
; ---------------------------------------------------------------------------

loc_401670:				; CODE XREF: .text:00401653j
		mov	eax, 0

locret_401675:				; CODE XREF: .text:0040166Ej
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401677	proc near		; DATA XREF: sub_4020C2:loc_4021DCo

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	[ebp+arg_0], 31h ; switch 50 cases
		ja	short loc_4016DA ; jumptable 00401690 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_42C850
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_401692:				; CODE XREF: sub_401677+19j
					; DATA XREF: .rdata:off_42C850o
		mov	[ebp+var_4], offset aDirmngr ; jumptable 00401690 case 11
		jmp	short loc_4016E1
; ---------------------------------------------------------------------------

loc_40169B:				; CODE XREF: sub_401677+19j
					; DATA XREF: .rdata:off_42C850o
		mov	[ebp+var_4], offset a1_1_1 ; jumptable 00401690	case 13
		jmp	short loc_4016E1
; ---------------------------------------------------------------------------

loc_4016A4:				; CODE XREF: sub_401677+19j
					; DATA XREF: .rdata:off_42C850o
		mov	[ebp+var_4], offset aCopyrightC2013 ; jumptable	00401690 case 14
		jmp	short loc_4016E1
; ---------------------------------------------------------------------------

loc_4016AD:				; CODE XREF: sub_401677+19j
					; DATA XREF: .rdata:off_42C850o
		mov	[ebp+var_4], offset aMingw32 ; jumptable 00401690 case 17
		jmp	short loc_4016E1
; ---------------------------------------------------------------------------

loc_4016B6:				; CODE XREF: sub_401677+19j
					; DATA XREF: .rdata:off_42C850o
		mov	[ebp+var_4], offset aPleaseReportBu ; jumptable	00401690 case 19
		jmp	short loc_4016E1
; ---------------------------------------------------------------------------

loc_4016BF:				; CODE XREF: sub_401677+19j
					; DATA XREF: .rdata:off_42C850o
		mov	[ebp+var_4], offset aBugDirmngr@gnu ; jumptable	00401690 case 49
		jmp	short loc_4016E1
; ---------------------------------------------------------------------------

loc_4016C8:				; CODE XREF: sub_401677+19j
					; DATA XREF: .rdata:off_42C850o
		mov	[ebp+var_4], offset aUsageDirmngrOp ; jumptable	00401690 cases 1,40
		jmp	short loc_4016E1
; ---------------------------------------------------------------------------

loc_4016D1:				; CODE XREF: sub_401677+19j
					; DATA XREF: .rdata:off_42C850o
		mov	[ebp+var_4], offset aSyntaxDirmngrO ; jumptable	00401690 case 41
		jmp	short loc_4016E1
; ---------------------------------------------------------------------------

loc_4016DA:				; CODE XREF: sub_401677+Aj
					; sub_401677+19j
					; DATA XREF: ...
		mov	[ebp+var_4], 0	; jumptable 00401690 default case

loc_4016E1:				; CODE XREF: sub_401677+22j
					; sub_401677+2Bj ...
		mov	eax, [ebp+var_4]
		leave
		retn
sub_401677	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4016E6(int, int, char	*, va_list)
sub_4016E6	proc near		; DATA XREF: sub_4020C2+192o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		cmp	eax, 1Eh
		jz	short loc_401735
		cmp	eax, 1Eh
		jg	short loc_401709
		cmp	eax, 0Ah
		jz	short loc_401723
		cmp	eax, 14h
		jz	short loc_40172C
		test	eax, eax
		jz	short loc_40171A
		jmp	short loc_401759
; ---------------------------------------------------------------------------

loc_401709:				; CODE XREF: sub_4016E6+11j
		cmp	eax, 32h
		jz	short loc_401747
		cmp	eax, 64h
		jz	short loc_401750
		cmp	eax, 28h
		jz	short loc_40173E
		jmp	short loc_401759
; ---------------------------------------------------------------------------

loc_40171A:				; CODE XREF: sub_4016E6+1Fj
		mov	[ebp+arg_4], 1
		jmp	short loc_401761
; ---------------------------------------------------------------------------

loc_401723:				; CODE XREF: sub_4016E6+16j
		mov	[ebp+arg_4], 2
		jmp	short loc_401761
; ---------------------------------------------------------------------------

loc_40172C:				; CODE XREF: sub_4016E6+1Bj
		mov	[ebp+arg_4], 3
		jmp	short loc_401761
; ---------------------------------------------------------------------------

loc_401735:				; CODE XREF: sub_4016E6+Cj
		mov	[ebp+arg_4], 4
		jmp	short loc_401761
; ---------------------------------------------------------------------------

loc_40173E:				; CODE XREF: sub_4016E6+30j
		mov	[ebp+arg_4], 5
		jmp	short loc_401761
; ---------------------------------------------------------------------------

loc_401747:				; CODE XREF: sub_4016E6+26j
		mov	[ebp+arg_4], 6
		jmp	short loc_401761
; ---------------------------------------------------------------------------

loc_401750:				; CODE XREF: sub_4016E6+2Bj
		mov	[ebp+arg_4], 7
		jmp	short loc_401761
; ---------------------------------------------------------------------------

loc_401759:				; CODE XREF: sub_4016E6+21j
					; sub_4016E6+32j
		mov	[ebp+arg_4], 4
		nop

loc_401761:				; CODE XREF: sub_4016E6+3Bj
					; sub_4016E6+44j ...
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_10], eax ;	va_list
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_423366
		leave
		retn
sub_4016E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40177C	proc near		; DATA XREF: sub_4020C2+20Ao

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		cmp	[ebp+arg_4], 0
		jz	short loc_4017C0
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset a1_3_14_3_2_26 ; "1.3.14.3.2.26"
		mov	ecx, 0Eh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4017C0
		mov	[esp+18h+var_18], 3Ch
		call	sub_401577
		jmp	short loc_401803
; ---------------------------------------------------------------------------

loc_4017C0:				; CODE XREF: sub_40177C+Cj
					; sub_40177C+34j
		cmp	[ebp+arg_10], 13h
		ja	short loc_4017D4
		mov	[esp+18h+var_18], 0C8h
		call	sub_401577
		jmp	short loc_401803
; ---------------------------------------------------------------------------

loc_4017D4:				; CODE XREF: sub_40177C+48j
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+18h+var_14], eax
		mov	[esp+18h+var_18], 2
		call	gcry_md_hash_buffer
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 14h
		mov	eax, 0

loc_401803:				; CODE XREF: sub_40177C+42j
					; sub_40177C+56j
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40177C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40180A	proc near		; CODE XREF: sub_4020C2:loc_402AA4p
					; .text:00403EB4p

Str		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:Str
		test	eax, eax
		jz	short loc_40183A
		mov	eax, ds:Str
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40183A
		mov	eax, ds:Str
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40183A
		mov	eax, 1
		jmp	short loc_40183F
; ---------------------------------------------------------------------------

loc_40183A:				; CODE XREF: sub_40180A+Fj
					; sub_40180A+1Bj ...
		mov	eax, 0

loc_40183F:				; CODE XREF: sub_40180A+2Ej
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401857
		mov	eax, ds:Str
		mov	[esp+28h+Str], eax ; Str
		call	atoi
		jmp	short loc_40185C
; ---------------------------------------------------------------------------

loc_401857:				; CODE XREF: sub_40180A+3Cj
		mov	eax, 0

loc_40185C:				; CODE XREF: sub_40180A+4Bj
		mov	[ebp+var_10], eax
		mov	eax, ds:Str
		test	eax, eax
		jz	loc_401A02
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aNone ; "none"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4018A2
		cmp	[ebp+var_C], 0
		jz	short loc_4018B1
		cmp	[ebp+var_10], 0
		jg	short loc_4018B1

loc_4018A2:				; CODE XREF: sub_40180A+8Aj
		mov	ds:dword_435FA0, 0
		jmp	loc_401A02
; ---------------------------------------------------------------------------

loc_4018B1:				; CODE XREF: sub_40180A+90j
					; sub_40180A+96j
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aBasic ; "basic"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4018E7
		cmp	[ebp+var_C], 0
		jz	short loc_4018F6
		cmp	[ebp+var_10], 2
		jg	short loc_4018F6

loc_4018E7:				; CODE XREF: sub_40180A+CFj
		mov	ds:dword_435FA0, 400h
		jmp	loc_401A02
; ---------------------------------------------------------------------------

loc_4018F6:				; CODE XREF: sub_40180A+D5j
					; sub_40180A+DBj
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aAdvanced ;	"advanced"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40192C
		cmp	[ebp+var_C], 0
		jz	short loc_40193B
		cmp	[ebp+var_10], 5
		jg	short loc_40193B

loc_40192C:				; CODE XREF: sub_40180A+114j
		mov	ds:dword_435FA0, 403h
		jmp	loc_401A02
; ---------------------------------------------------------------------------

loc_40193B:				; CODE XREF: sub_40180A+11Aj
					; sub_40180A+120j
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aExpert ; "expert"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_401971
		cmp	[ebp+var_C], 0
		jz	short loc_401980
		cmp	[ebp+var_10], 8
		jg	short loc_401980

loc_401971:				; CODE XREF: sub_40180A+159j
		mov	ds:dword_435FA0, 447h
		jmp	loc_401A02
; ---------------------------------------------------------------------------

loc_401980:				; CODE XREF: sub_40180A+15Fj
					; sub_40180A+165j
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aGuru ; "guru"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4019B0
		cmp	[ebp+var_C], 0
		jz	short loc_4019CF

loc_4019B0:				; CODE XREF: sub_40180A+19Ej
		mov	ds:dword_435FA0, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jz	short loc_401A02
		mov	eax, ds:dword_435FA0
		and	ah, 0FDh
		mov	ds:dword_435FA0, eax
		jmp	short loc_401A02
; ---------------------------------------------------------------------------

loc_4019CF:				; CODE XREF: sub_40180A+1A4j
		mov	eax, ds:Str
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Str], offset aInvalidDebugLe ;	"invalid debug-level `%s' given\n"
		call	sub_4233B1
		mov	dword ptr [esp+28h+var_24], offset aNoneBasicAdvan ; "none, basic, advanced, expert, guru"
		mov	[esp+28h+Str], offset aValidDebugLeve ;	"valid debug levels are: %s\n"
		call	sub_423387
		mov	ds:dword_435FA0, 0

loc_401A02:				; CODE XREF: sub_40180A+5Cj
					; sub_40180A+A2j ...
		mov	eax, ds:dword_435FA0
		test	eax, eax
		jz	short loc_401A33
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jnz	short loc_401A33
		mov	ds:dword_435FA4, 1
		mov	eax, ds:dword_435FA4
		mov	dword ptr [esp+28h+var_24], eax
		mov	[esp+28h+Str], 13h
		call	gcry_control

loc_401A33:				; CODE XREF: sub_40180A+1FFj
					; sub_40180A+208j
		mov	eax, ds:dword_435FA0
		test	eax, eax
		jz	short loc_401A4F
		mov	eax, ds:dword_435FA8
		test	eax, eax
		jz	short loc_401A4F
		mov	ds:dword_435FA8, 0

loc_401A4F:				; CODE XREF: sub_40180A+230j
					; sub_40180A+239j
		mov	eax, ds:dword_435FA0
		and	eax, 4
		test	eax, eax
		jz	short loc_401A6F
		mov	dword ptr [esp+28h+var_24], 1
		mov	[esp+28h+Str], 14h
		call	gcry_control

loc_401A6F:				; CODE XREF: sub_40180A+24Fj
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40180A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401A76	proc near		; CODE XREF: sub_4020C2+273p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401A76	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_401A7B(char *)
sub_401A7B	proc near		; CODE XREF: sub_4020C2+A93p
					; sub_4020C2+B31p ...

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aUsageDirmngr_0 ; "usage: dirmngr [options]	"
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 19h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+18h+Size],	eax ; File
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Str], eax ; Str
		call	fputs
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+18h+Size],	eax ; File
		mov	[esp+18h+Str], 0Ah ; Ch
		call	putc
		mov	[esp+18h+Str], 2
		call	sub_4035CB
sub_401A7B	endp

; ---------------------------------------------------------------------------
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401AE7	proc near		; CODE XREF: sub_4020C2:loc_402BB3p
					; sub_4020C2+E10p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_43504C
		test	eax, eax
		jnz	loc_401BB6
		mov	ds:dword_43504C, 1
		call	pth_attr_new
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 2
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	pth_attr_set
		mov	[esp+28h+var_20], 40000h
		mov	dword ptr [esp+28h+var_24], 4
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	pth_attr_set
		mov	[esp+28h+var_20], offset aLdapReaper ; "ldap-reaper"
		mov	dword ptr [esp+28h+var_24], 1
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	pth_attr_set
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], offset sub_411148
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	pth_spawn
		test	eax, eax
		jnz	short loc_401BA9
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorSpawningL ; "error spawning ldap	wrapper	reaper thre"...
		call	sub_4233B1
		mov	[esp+28h+var_28], 1
		call	sub_4035CB
; ---------------------------------------------------------------------------

loc_401BA9:				; CODE XREF: sub_401AE7+93j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	pth_attr_destroy
		jmp	short locret_401BB7
; ---------------------------------------------------------------------------

loc_401BB6:				; CODE XREF: sub_401AE7+Dj
		nop

locret_401BB7:				; CODE XREF: sub_401AE7+CDj
		leave
		retn
sub_401AE7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BB9	proc near		; CODE XREF: sub_4020C2+B0Cp
					; sub_4020C2+E62p
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_411599
		leave
		retn
sub_401BB9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BC6	proc near		; CODE XREF: sub_4020C2+316p
					; sub_4020C2+5A9p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	loc_401CDF
		mov	ds:dword_435FA8, 0
		mov	ds:dword_435FA4, 0
		mov	ds:dword_435FA0, 0
		mov	ds:dword_435FC4, 0
		mov	ds:dword_435FDC, 0
		mov	ds:dword_435FE0, 0
		mov	ds:dword_435FE4, 0
		mov	ds:dword_435FE8, 0
		mov	ds:dword_435FEC, 0
		mov	ds:dword_435FF0, 0
		mov	ds:dword_435FF4, 0
		mov	ds:dword_435FF8, 0
		mov	ds:dword_435FFC, 0
		mov	ds:dword_436004, 0
		mov	ds:dword_436018, 0
		mov	ds:dword_436020, 258h
		mov	ds:dword_436024, 76A700h
		mov	ds:dword_436028, 2A30h
		mov	ds:dword_436008, 0Ah
		jmp	short loc_401CB5
; ---------------------------------------------------------------------------

loc_401C96:				; CODE XREF: sub_401BC6+F6j
		mov	eax, ds:dword_43601C
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_43601C
		mov	[esp+28h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	ds:dword_43601C, eax

loc_401CB5:				; CODE XREF: sub_401BC6+CEj
		mov	eax, ds:dword_43601C
		test	eax, eax
		jnz	short loc_401C96
		mov	eax, ds:dword_436000
		mov	[esp+28h+Str1],	eax
		call	sub_423574
		mov	ds:dword_436000, 0
		mov	eax, 1
		jmp	locret_402043
; ---------------------------------------------------------------------------

loc_401CDF:				; CODE XREF: sub_401BC6+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 210h
		jz	loc_401F60
		cmp	eax, 210h
		jg	loc_401D99
		cmp	eax, 208h
		jz	loc_401E9E
		cmp	eax, 208h
		jg	short loc_401D51
		cmp	eax, 200h
		jz	loc_401E67
		cmp	eax, 200h
		jg	short loc_401D36
		cmp	eax, 71h
		jz	loc_401E46
		cmp	eax, 76h
		jz	loc_401E55
		jmp	loc_402036
; ---------------------------------------------------------------------------

loc_401D36:				; CODE XREF: sub_401BC6+157j
		cmp	eax, 201h
		jz	loc_401E7F
		cmp	eax, 203h
		jz	loc_401E8E
		jmp	loc_402036
; ---------------------------------------------------------------------------

loc_401D51:				; CODE XREF: sub_401BC6+145j
		cmp	eax, 20Ch
		jz	loc_401F9E
		cmp	eax, 20Ch
		jg	short loc_401D7E
		cmp	eax, 20Ah
		jz	loc_401F33
		cmp	eax, 20Bh
		jz	loc_401F42
		jmp	loc_402036
; ---------------------------------------------------------------------------

loc_401D7E:				; CODE XREF: sub_401BC6+19Bj
		cmp	eax, 20Eh
		jz	loc_401FAD
		cmp	eax, 20Eh
		jg	loc_401F51
		jmp	loc_401F8F
; ---------------------------------------------------------------------------

loc_401D99:				; CODE XREF: sub_401BC6+12Fj
		cmp	eax, 219h
		jz	loc_401FF7
		cmp	eax, 219h
		jg	short loc_401DF3
		cmp	eax, 216h
		jz	loc_401FC8
		cmp	eax, 216h
		jg	short loc_401DD8
		cmp	eax, 211h
		jz	loc_401F70
		cmp	eax, 212h
		jz	loc_401F80
		jmp	loc_402036
; ---------------------------------------------------------------------------

loc_401DD8:				; CODE XREF: sub_401BC6+1F5j
		cmp	eax, 217h
		jz	loc_401FD5
		cmp	eax, 218h
		jz	loc_401FEA
		jmp	loc_402036
; ---------------------------------------------------------------------------

loc_401DF3:				; CODE XREF: sub_401BC6+1E3j
		cmp	eax, 21Eh
		jz	loc_401FBC
		cmp	eax, 21Eh
		jg	short loc_401E20
		cmp	eax, 21Ah
		jz	loc_402004
		cmp	eax, 21Bh
		jz	loc_402011
		jmp	loc_402036
; ---------------------------------------------------------------------------

loc_401E20:				; CODE XREF: sub_401BC6+23Dj
		cmp	eax, 221h
		jz	loc_401F23
		cmp	eax, 222h
		jz	loc_40201E
		cmp	eax, 220h
		jz	loc_401F13
		jmp	loc_402036
; ---------------------------------------------------------------------------

loc_401E46:				; CODE XREF: sub_401BC6+15Cj
		mov	ds:dword_435FA8, 1
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401E55:				; CODE XREF: sub_401BC6+165j
		mov	eax, ds:dword_435FA4
		add	eax, 1
		mov	ds:dword_435FA4, eax
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401E67:				; CODE XREF: sub_401BC6+14Cj
		mov	edx, ds:dword_435FA0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		or	eax, edx
		mov	ds:dword_435FA0, eax
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401E7F:				; CODE XREF: sub_401BC6+175j
		mov	ds:dword_435FA0, 0FFFFFFFFh
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401E8E:				; CODE XREF: sub_401BC6+180j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:Str,	eax
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401E9E:				; CODE XREF: sub_401BC6+13Aj
		cmp	[ebp+arg_4], 0
		jnz	short loc_401EAE
		mov	eax, 0
		jmp	locret_402043
; ---------------------------------------------------------------------------

loc_401EAE:				; CODE XREF: sub_401BC6+2DCj
		mov	eax, ds:Str1
		test	eax, eax
		jz	short loc_401EE0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_401EE0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, ds:Str1
		mov	[esp+28h+Str2],	edx ; Str2
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_40203D

loc_401EE0:				; CODE XREF: sub_401BC6+2EFj
					; sub_401BC6+2F9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+28h+Str1],	eax ; char *
		call	sub_422DEE
		mov	eax, ds:Str1
		mov	[esp+28h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+28h+Str1],	eax
		call	gcry_strdup
		mov	ds:Str1, eax
		jmp	loc_40203D
; ---------------------------------------------------------------------------

loc_401F13:				; CODE XREF: sub_401BC6+275j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_435FC4, eax
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401F23:				; CODE XREF: sub_401BC6+25Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_435FC8, eax
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401F33:				; CODE XREF: sub_401BC6+1A2j
		mov	ds:dword_435FDC, 1
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401F42:				; CODE XREF: sub_401BC6+1ADj
		mov	ds:dword_435FE0, 1
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401F51:				; CODE XREF: sub_401BC6+1C8j
		mov	ds:dword_435FE4, 1
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401F60:				; CODE XREF: sub_401BC6+124j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_435FE8, eax
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401F70:				; CODE XREF: sub_401BC6+1FCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_435FEC, eax
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401F80:				; CODE XREF: sub_401BC6+207j
		mov	ds:dword_435FF0, 1
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401F8F:				; CODE XREF: sub_401BC6+1CEj
		mov	ds:dword_435FF4, 1
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401F9E:				; CODE XREF: sub_401BC6+190j
		mov	ds:dword_435FF8, 1
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401FAD:				; CODE XREF: sub_401BC6+1BDj
		mov	ds:dword_435FFC, 1
		jmp	loc_40203E
; ---------------------------------------------------------------------------

loc_401FBC:				; CODE XREF: sub_401BC6+232j
		mov	ds:dword_436004, 1
		jmp	short loc_40203E
; ---------------------------------------------------------------------------

loc_401FC8:				; CODE XREF: sub_401BC6+1EAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_436018, eax
		jmp	short loc_40203E
; ---------------------------------------------------------------------------

loc_401FD5:				; CODE XREF: sub_401BC6+217j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+28h+Str1],	eax ; char *
		call	sub_4037E4
		mov	ds:dword_43601C, eax
		jmp	short loc_40203E
; ---------------------------------------------------------------------------

loc_401FEA:				; CODE XREF: sub_401BC6+222j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_436020, eax
		jmp	short loc_40203E
; ---------------------------------------------------------------------------

loc_401FF7:				; CODE XREF: sub_401BC6+1D8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_436024, eax
		jmp	short loc_40203E
; ---------------------------------------------------------------------------

loc_402004:				; CODE XREF: sub_401BC6+244j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_436028, eax
		jmp	short loc_40203E
; ---------------------------------------------------------------------------

loc_402011:				; CODE XREF: sub_401BC6+24Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_436008, eax
		jmp	short loc_40203E
; ---------------------------------------------------------------------------

loc_40201E:				; CODE XREF: sub_401BC6+26Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+28h+Str2],	eax ; char *
		mov	[esp+28h+Str1],	offset dword_436000 ; int
		call	sub_42359D
		jmp	short loc_40203E
; ---------------------------------------------------------------------------

loc_402036:				; CODE XREF: sub_401BC6+16Bj
					; sub_401BC6+186j ...
		mov	eax, 0
		jmp	short locret_402043
; ---------------------------------------------------------------------------

loc_40203D:				; CODE XREF: sub_401BC6+314j
					; sub_401BC6+348j
		nop

loc_40203E:				; CODE XREF: sub_401BC6+28Aj
					; sub_401BC6+29Cj ...
		mov	eax, 1

locret_402043:				; CODE XREF: sub_401BC6+114j
					; sub_401BC6+2E3j ...
		leave
		retn
sub_401BC6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; DWORD	__stdcall HandlerProc(DWORD dwControl, DWORD dwEventType, LPVOID lpEventData, LPVOID lpContext)
HandlerProc	proc near		; DATA XREF: sub_4020C2+7Co

hServiceStatus	= dword	ptr -18h
lpServiceStatus	= dword	ptr -14h
dwControl	= dword	ptr  8
dwEventType	= dword	ptr  0Ch
lpEventData	= dword	ptr  10h
lpContext	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+dwControl]
		cmp	eax, 1
		jz	short loc_402088
		cmp	eax, 5
		jnz	short loc_4020B8
		mov	ds:ServiceStatus.dwCurrentState, 3
		mov	eax, ds:hServiceStatus
		mov	[esp+18h+lpServiceStatus], offset ServiceStatus	; lpServiceStatus
		mov	[esp+18h+hServiceStatus], eax ;	hServiceStatus
		mov	eax, ds:SetServiceStatus
		call	eax ; SetServiceStatus
		sub	esp, 8
		mov	ds:dword_435044, 3
		jmp	short loc_4020B9
; ---------------------------------------------------------------------------

loc_402088:				; CODE XREF: HandlerProc+Cj
		mov	ds:ServiceStatus.dwCurrentState, 3
		mov	eax, ds:hServiceStatus
		mov	[esp+18h+lpServiceStatus], offset ServiceStatus	; lpServiceStatus
		mov	[esp+18h+hServiceStatus], eax ;	hServiceStatus
		mov	eax, ds:SetServiceStatus
		call	eax ; SetServiceStatus
		sub	esp, 8
		mov	ds:dword_435044, 1
		jmp	short loc_4020B9
; ---------------------------------------------------------------------------

loc_4020B8:				; CODE XREF: HandlerProc+11j
		nop

loc_4020B9:				; CODE XREF: HandlerProc+41j
					; HandlerProc+71j
		mov	eax, 0
		leave
		retn	10h
HandlerProc	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4020C2	proc near		; CODE XREF: sub_4034A1+77p
					; DATA XREF: sub_4034A1+85o

lpServiceName	= dword	ptr -178h
lpHandlerProc	= dword	ptr -174h
lpContext	= dword	ptr -170h
var_16C		= dword	ptr -16Ch
var_168		= dword	ptr -168h
var_14C		= dword	ptr -14Ch
var_13C		= dword	ptr -13Ch
var_CC		= dword	ptr -0CCh
var_C8		= byte ptr -0C8h
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_90		= dword	ptr -90h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= byte ptr -64h
s		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
Duration	= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
Filename	= dword	ptr -24h
File		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 16Ch
		mov	[ebp+var_1C], 0
		mov	[ebp+File], 0
		mov	[ebp+Filename],	0
		mov	[ebp+var_28], 0
		mov	[ebp+var_2C], 1
		mov	[ebp+var_30], 0
		mov	[ebp+var_34], 0
		mov	[ebp+var_4C], 0
		mov	[ebp+var_50], 0
		mov	[ebp+var_38], 0
		mov	[ebp+var_3C], 0
		mov	[ebp+Duration],	0
		mov	[ebp+var_48], 0
		mov	eax, ds:dword_435FCC
		test	eax, eax
		jz	loc_4021DC
		mov	[esp+178h+lpContext], 0	; lpContext
		mov	[esp+178h+lpHandlerProc], offset HandlerProc ; lpHandlerProc
		mov	[esp+178h+lpServiceName], offset ServiceName ; "DirMngr"
		mov	eax, ds:RegisterServiceCtrlHandlerExA
		call	eax ; RegisterServiceCtrlHandlerExA
		sub	esp, 0Ch
		mov	ds:hServiceStatus, eax
		mov	eax, ds:hServiceStatus
		test	eax, eax
		jnz	short loc_40217C
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aFailedToRegist ; "failed to register service control hand"...
		call	sub_4233B1

loc_40217C:				; CODE XREF: sub_4020C2+A1j
		mov	ds:ServiceStatus.dwServiceType,	10h
		mov	ds:ServiceStatus.dwCurrentState, 2
		mov	ds:ServiceStatus.dwControlsAccepted, 5
		mov	ds:ServiceStatus.dwWin32ExitCode, 0
		mov	ds:ServiceStatus.dwServiceSpecificExitCode, 0
		mov	ds:ServiceStatus.dwCheckPoint, 0
		mov	ds:ServiceStatus.dwWaitHint, 2710h
		mov	eax, ds:hServiceStatus
		mov	[esp+178h+lpHandlerProc], offset ServiceStatus ; lpServiceStatus
		mov	[esp+178h+lpServiceName], eax ;	hServiceStatus
		mov	eax, ds:SetServiceStatus
		call	eax ; SetServiceStatus
		sub	esp, 8

loc_4021DC:				; CODE XREF: sub_4020C2+6Ej
		mov	[esp+178h+lpServiceName], offset sub_401677
		call	sub_4254AD
		mov	[esp+178h+lpHandlerProc], 5 ; int
		mov	[esp+178h+lpServiceName], offset aDirmngr ; "dirmngr"
		call	sub_422E3E
		mov	[esp+178h+lpHandlerProc], 0
		mov	[esp+178h+lpServiceName], 25h
		call	gcry_control
		mov	[esp+178h+lpServiceName], offset a1_4_0	; "1.4.0"
		call	gcry_check_version
		test	eax, eax
		jnz	short loc_40224C
		mov	[esp+178h+lpServiceName], 0
		call	gcry_check_version
		mov	[esp+178h+var_16C], eax
		mov	[esp+178h+lpContext], offset a1_4_0 ; "1.4.0"
		mov	[esp+178h+lpHandlerProc], offset aLibgcrypt ; "libgcrypt"
		mov	[esp+178h+lpServiceName], offset aSIsTooOldNeedS ; "%s is too old (need	%s, have %s)\n"
		call	sub_4233F4
; ---------------------------------------------------------------------------

loc_40224C:				; CODE XREF: sub_4020C2+15Cj
		mov	[esp+178h+lpHandlerProc], 0
		mov	[esp+178h+lpServiceName], offset sub_4016E6
		call	gcry_set_log_handler
		mov	[esp+178h+lpServiceName], 26h
		call	gcry_control
		mov	[esp+178h+lpServiceName], offset a1_0_2	; "1.0.2"
		call	ksba_check_version
		test	eax, eax
		jnz	short loc_4022A8
		mov	[esp+178h+lpServiceName], 0
		call	ksba_check_version
		mov	[esp+178h+var_16C], eax
		mov	[esp+178h+lpContext], offset a1_0_2 ; "1.0.2"
		mov	[esp+178h+lpHandlerProc], offset aLibksba ; "libksba"
		mov	[esp+178h+lpServiceName], offset aSIsTooOldNeedS ; "%s is too old (need	%s, have %s)\n"
		call	sub_4233F4
; ---------------------------------------------------------------------------

loc_4022A8:				; CODE XREF: sub_4020C2+1B8j
		mov	[esp+178h+lpContext], offset gcry_free
		mov	[esp+178h+lpHandlerProc], offset gcry_realloc
		mov	[esp+178h+lpServiceName], offset gcry_malloc
		call	ksba_set_malloc_hooks
		mov	[esp+178h+lpHandlerProc], 0
		mov	[esp+178h+lpServiceName], offset sub_40177C
		call	ksba_set_hash_buffer_function
		mov	[ebp+var_B8], offset gcry_malloc
		mov	[ebp+var_B4], offset gcry_realloc
		mov	[ebp+var_B0], offset gcry_free
		lea	eax, [ebp+var_B8]
		mov	[esp+178h+lpServiceName], eax
		call	assuan_set_malloc_hooks
		mov	[esp+178h+lpServiceName], 0
		call	sub_422E9C
		mov	[esp+178h+lpServiceName], eax
		call	assuan_set_assuan_log_prefix
		mov	[esp+178h+lpServiceName], 0Ah
		call	assuan_set_gpg_err_source
		mov	[esp+178h+lpServiceName], offset dword_42B360
		call	assuan_set_system_hooks
		call	assuan_sock_init
		call	sub_401A76
		mov	[esp+178h+lpServiceName], offset VarName ; "SHELL"
		call	getenv
		mov	[ebp+var_54], eax
		cmp	[ebp+var_54], 0
		jz	short loc_4023BF
		mov	eax, [ebp+var_54]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 2
		jbe	short loc_4023BF
		mov	eax, [ebp+var_54]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 3
		add	eax, [ebp+var_54]
		mov	[esp+178h+lpHandlerProc], offset Str2 ;	"csh"
		mov	[esp+178h+lpServiceName], eax ;	Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4023BF
		mov	[ebp+var_50], 1

loc_4023BF:				; CODE XREF: sub_4020C2+28Bj
					; sub_4020C2+2B5j ...
		call	sub_4224DB
		mov	ds:dword_435FB4, eax
		mov	[esp+178h+lpHandlerProc], 0
		mov	[esp+178h+lpServiceName], 0
		call	sub_401BC6
		mov	ds:dword_436014, 0
		mov	ds:dword_43600C, 64h
		call	sub_422A13
		mov	ds:Filename, eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_58], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_5C], eax
		lea	eax, [ebp+arg_0]
		mov	[ebp+var_A8], eax
		lea	eax, [ebp+arg_4]
		mov	[ebp+var_A4], eax
		mov	[ebp+var_A0], 41h
		jmp	loc_4024FE
; ---------------------------------------------------------------------------

loc_402428:				; CODE XREF: sub_4020C2+454j
		mov	eax, [ebp+var_98]
		cmp	eax, 200h
		jz	short loc_402442
		mov	eax, [ebp+var_98]
		cmp	eax, 201h
		jnz	short loc_40244B

loc_402442:				; CODE XREF: sub_4020C2+371j
		add	[ebp+var_28], 1
		jmp	loc_4024FE
; ---------------------------------------------------------------------------

loc_40244B:				; CODE XREF: sub_4020C2+37Ej
		mov	eax, [ebp+var_98]
		cmp	eax, 1FFh
		jnz	short loc_402464
		mov	[ebp+var_2C], 0
		jmp	loc_4024FE
; ---------------------------------------------------------------------------

loc_402464:				; CODE XREF: sub_4020C2+394j
		mov	eax, [ebp+var_98]
		cmp	eax, 205h
		jnz	short loc_40247D
		mov	[ebp+var_2C], 0
		jmp	loc_4024FE
; ---------------------------------------------------------------------------

loc_40247D:				; CODE XREF: sub_4020C2+3ADj
		mov	eax, [ebp+var_98]
		cmp	eax, 206h
		jnz	short loc_40249E
		mov	eax, [ebp+var_90]
		mov	ds:dword_435FB4, eax
		mov	[ebp+var_48], 1
		jmp	short loc_4024FE
; ---------------------------------------------------------------------------

loc_40249E:				; CODE XREF: sub_4020C2+3C6j
		mov	eax, [ebp+var_98]
		cmp	eax, 1F6h
		jnz	short loc_4024B7
		mov	ds:dword_435FD0, 1
		jmp	short loc_4024FE
; ---------------------------------------------------------------------------

loc_4024B7:				; CODE XREF: sub_4020C2+3E7j
		mov	eax, [ebp+var_98]
		cmp	eax, 1F7h
		jnz	short loc_4024DA
		mov	ds:dword_435FCC, 1
		mov	ds:dword_435FD0, 1
		jmp	short loc_4024FE
; ---------------------------------------------------------------------------

loc_4024DA:				; CODE XREF: sub_4020C2+400j
		mov	eax, [ebp+var_98]
		cmp	eax, 1FDh
		jz	short loc_4024F4
		mov	eax, [ebp+var_98]
		cmp	eax, 1FEh
		jnz	short loc_4024FE

loc_4024F4:				; CODE XREF: sub_4020C2+423j
		mov	ds:dword_435FD0, 1

loc_4024FE:				; CODE XREF: sub_4020C2+361j
					; sub_4020C2+384j ...
		mov	[esp+178h+lpHandlerProc], offset dword_42B000
		lea	eax, [ebp+var_A8]
		mov	[esp+178h+lpServiceName], eax
		call	sub_42435A
		test	eax, eax
		jnz	loc_402428
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_402549
		cmp	[ebp+var_48], 0
		jnz	short loc_402549
		call	sub_422731
		mov	ds:dword_435FB4, eax
		call	sub_4227E1
		mov	ds:dword_435FB8, eax
		call	sub_422884
		mov	ds:dword_435FBC, eax

loc_402549:				; CODE XREF: sub_4020C2+461j
					; sub_4020C2+467j
		cmp	[ebp+var_2C], 0
		jz	short loc_40256F
		mov	eax, ds:dword_435FB4
		mov	[esp+178h+lpContext], 0
		mov	[esp+178h+lpHandlerProc], offset aDirmngr_conf ; "dirmngr.conf"
		mov	[esp+178h+lpServiceName], eax
		call	sub_4259CC
		mov	[ebp+Filename],	eax

loc_40256F:				; CODE XREF: sub_4020C2+48Bj
		mov	eax, [ebp+var_58]
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+var_5C]
		mov	[ebp+arg_4], eax
		lea	ecx, [ebp+arg_0]
		mov	[ebp+var_A8], ecx
		lea	eax, [ebp+arg_4]
		mov	[ebp+var_A4], eax
		mov	[ebp+var_A0], 1

loc_402597:				; CODE XREF: sub_4020C2+7A9j
					; sub_4020C2+8D1j
		cmp	[ebp+Filename],	0
		jz	loc_402929
		mov	[ebp+var_AC], 0
		mov	edx, offset Mode ; "r"
		mov	eax, [ebp+Filename]
		mov	[esp+178h+lpHandlerProc], edx ;	Mode
		mov	[esp+178h+lpServiceName], eax ;	Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_40262F
		cmp	[ebp+var_2C], 0
		jz	short loc_4025E9
		cmp	[ebp+var_28], 0
		jz	short loc_40261D
		mov	eax, [ebp+Filename]
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aNoteNoDefaultO ; "NOTE: no default option file `%s'\n"
		call	sub_423387
		jmp	short loc_40261D
; ---------------------------------------------------------------------------

loc_4025E9:				; CODE XREF: sub_4020C2+50Aj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+178h+lpServiceName], eax ;	int
		call	strerror
		mov	[esp+178h+lpContext], eax
		mov	eax, [ebp+Filename]
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aOptionFileSS ; "option file `%s': %s\n"
		call	sub_4233B1
		mov	[esp+178h+lpServiceName], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40261D:				; CODE XREF: sub_4020C2+510j
					; sub_4020C2+525j
		mov	eax, [ebp+Filename]
		mov	[esp+178h+lpServiceName], eax
		call	gcry_free
		mov	[ebp+Filename],	0

loc_40262F:				; CODE XREF: sub_4020C2+504j
		cmp	[ebp+var_28], 0
		jz	short loc_40264E
		cmp	[ebp+Filename],	0
		jz	short loc_40264E
		mov	eax, [ebp+Filename]
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aReadingOptions ; "reading options from `%s'\n"
		call	sub_423387

loc_40264E:				; CODE XREF: sub_4020C2+571j
					; sub_4020C2+577j
		mov	[ebp+var_2C], 0
		jmp	loc_402929
; ---------------------------------------------------------------------------

loc_40265A:				; CODE XREF: sub_4020C2+8A4j
		mov	[esp+178h+lpHandlerProc], 0
		lea	eax, [ebp+var_A8]
		mov	[esp+178h+lpServiceName], eax
		call	sub_401BC6
		test	eax, eax
		jnz	loc_40292C
		mov	eax, [ebp+var_98]
		cmp	eax, 203h
		jz	loc_402827
		cmp	eax, 203h
		jg	loc_402715
		cmp	eax, 1FEh
		jg	short loc_4026E4
		cmp	eax, 1F5h
		jge	loc_4027C2
		cmp	eax, 73h
		jz	loc_4028B1
		cmp	eax, 73h
		jg	short loc_4026CB
		cmp	eax, 63h
		jz	loc_4028A5
		cmp	eax, 71h
		jz	loc_4027D0
		jmp	loc_40290F
; ---------------------------------------------------------------------------

loc_4026CB:				; CODE XREF: sub_4020C2+5F0j
		cmp	eax, 76h
		jz	loc_4027DF
		cmp	eax, 1F4h
		jz	loc_40287C
		jmp	loc_40290F
; ---------------------------------------------------------------------------

loc_4026E4:				; CODE XREF: sub_4020C2+5D7j
		cmp	eax, 200h
		jz	loc_402800
		cmp	eax, 200h
		jl	loc_402845
		cmp	eax, 201h
		jz	loc_402818
		cmp	eax, 202h
		jz	loc_402837
		jmp	loc_40290F
; ---------------------------------------------------------------------------

loc_402715:				; CODE XREF: sub_4020C2+5CCj
		cmp	eax, 209h
		jz	loc_4027F1
		cmp	eax, 209h
		jg	short loc_40276F
		cmp	eax, 206h
		jz	loc_40292F
		cmp	eax, 206h
		jg	short loc_402754
		cmp	eax, 204h
		jz	loc_402870
		cmp	eax, 205h
		jz	loc_402932
		jmp	loc_40290F
; ---------------------------------------------------------------------------

loc_402754:				; CODE XREF: sub_4020C2+675j
		cmp	eax, 207h
		jz	loc_40288B
		cmp	eax, 208h
		jz	loc_402897
		jmp	loc_40290F
; ---------------------------------------------------------------------------

loc_40276F:				; CODE XREF: sub_4020C2+663j
		cmp	eax, 215h
		jz	loc_4028C5
		cmp	eax, 215h
		jg	short loc_40279C
		cmp	eax, 213h
		jz	loc_4028BA
		cmp	eax, 214h
		jz	loc_4028D1
		jmp	loc_40290F
; ---------------------------------------------------------------------------

loc_40279C:				; CODE XREF: sub_4020C2+6BDj
		cmp	eax, 21Dh
		jz	loc_4028F6
		cmp	eax, 21Fh
		jz	loc_402902
		cmp	eax, 21Ch
		jz	loc_4028DE
		jmp	loc_40290F
; ---------------------------------------------------------------------------

loc_4027C2:				; CODE XREF: sub_4020C2+5DEj
		mov	eax, [ebp+var_98]
		mov	[ebp+var_1C], eax
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_4027D0:				; CODE XREF: sub_4020C2+5FEj
		mov	ds:dword_435FA8, 1
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_4027DF:				; CODE XREF: sub_4020C2+60Cj
		mov	eax, ds:dword_435FA4
		add	eax, 1
		mov	ds:dword_435FA4, eax
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_4027F1:				; CODE XREF: sub_4020C2+658j
		mov	ds:dword_435FB0, 1
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_402800:				; CODE XREF: sub_4020C2+627j
		mov	edx, ds:dword_435FA0
		mov	eax, [ebp+var_90]
		or	eax, edx
		mov	ds:dword_435FA0, eax
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_402818:				; CODE XREF: sub_4020C2+63Dj
		mov	ds:dword_435FA0, 0FFFFFFFFh
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_402827:				; CODE XREF: sub_4020C2+5C1j
		mov	eax, [ebp+var_90]
		mov	ds:Str,	eax
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_402837:				; CODE XREF: sub_4020C2+648j
		mov	eax, [ebp+var_90]
		mov	[ebp+Duration],	eax
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_402845:				; CODE XREF: sub_4020C2+632j
		cmp	[ebp+File], 0
		jnz	loc_402935
		mov	eax, [ebp+Filename]
		mov	[esp+178h+lpServiceName], eax
		call	gcry_free
		mov	eax, [ebp+var_90]
		mov	[esp+178h+lpServiceName], eax
		call	gcry_xstrdup
		mov	[ebp+Filename],	eax
		jmp	loc_402597
; ---------------------------------------------------------------------------

loc_402870:				; CODE XREF: sub_4020C2+67Cj
		mov	[ebp+var_34], 1
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_40287C:				; CODE XREF: sub_4020C2+617j
		mov	ds:dword_435FA4, 0
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_40288B:				; CODE XREF: sub_4020C2+697j
		mov	[ebp+var_4C], 1
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_402897:				; CODE XREF: sub_4020C2+6A2j
		mov	eax, [ebp+var_90]
		mov	[ebp+var_38], eax
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_4028A5:				; CODE XREF: sub_4020C2+5F5j
		mov	[ebp+var_50], 1
		jmp	loc_402936
; ---------------------------------------------------------------------------

loc_4028B1:				; CODE XREF: sub_4020C2+5E7j
		mov	[ebp+var_50], 0
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_4028BA:				; CODE XREF: sub_4020C2+6C4j
		mov	eax, [ebp+var_90]
		mov	[ebp+var_3C], eax
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_4028C5:				; CODE XREF: sub_4020C2+6B2j
		mov	ds:dword_436014, 1
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_4028D1:				; CODE XREF: sub_4020C2+6CFj
		mov	eax, [ebp+var_90]
		mov	ds:dword_43600C, eax
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_4028DE:				; CODE XREF: sub_4020C2+6F5j
		mov	eax, [ebp+var_90]
		mov	[esp+178h+lpHandlerProc], 0
		mov	[esp+178h+lpServiceName], eax
		call	sub_4159D4
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_4028F6:				; CODE XREF: sub_4020C2+6DFj
		mov	ds:dword_435FD8, 1
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_402902:				; CODE XREF: sub_4020C2+6EAj
		mov	eax, [ebp+var_90]
		mov	ds:Filename, eax
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_40290F:				; CODE XREF: sub_4020C2+604j
					; sub_4020C2+61Dj ...
		cmp	[ebp+File], 0
		jz	short loc_40291C
		mov	eax, 1
		jmp	short loc_402921
; ---------------------------------------------------------------------------

loc_40291C:				; CODE XREF: sub_4020C2+851j
		mov	eax, 2

loc_402921:				; CODE XREF: sub_4020C2+858j
		mov	[ebp+var_9C], eax
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_402929:				; CODE XREF: sub_4020C2+4D9j
					; sub_4020C2+593j
		nop
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_40292C:				; CODE XREF: sub_4020C2+5B0j
		nop
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_40292F:				; CODE XREF: sub_4020C2+66Aj
		nop
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_402932:				; CODE XREF: sub_4020C2+687j
		nop
		jmp	short loc_402936
; ---------------------------------------------------------------------------

loc_402935:				; CODE XREF: sub_4020C2+787j
		nop

loc_402936:				; CODE XREF: sub_4020C2+709j
					; sub_4020C2+718j ...
		mov	[esp+178h+var_168], offset dword_42B000	; int
		lea	eax, [ebp+var_A8]
		mov	[esp+178h+var_16C], eax	; int
		lea	eax, [ebp+var_AC]
		mov	[esp+178h+lpContext], eax ; int
		mov	eax, [ebp+Filename]
		mov	[esp+178h+lpHandlerProc], eax ;	int
		mov	eax, [ebp+File]
		mov	[esp+178h+lpServiceName], eax ;	FILE *
		call	sub_423B0A
		test	eax, eax
		jnz	loc_40265A
		cmp	[ebp+File], 0
		jz	short loc_402998
		mov	eax, [ebp+File]
		mov	[esp+178h+lpServiceName], eax ;	File
		call	fclose
		mov	[ebp+File], 0
		mov	eax, [ebp+Filename]
		mov	ds:dword_435FC0, eax
		mov	[ebp+Filename],	0
		jmp	loc_402597
; ---------------------------------------------------------------------------

loc_402998:				; CODE XREF: sub_4020C2+8AEj
		mov	eax, [ebp+Filename]
		mov	[esp+178h+lpServiceName], eax
		call	gcry_free
		mov	[ebp+Filename],	0
		mov	[esp+178h+lpServiceName], 0
		call	sub_422B1C
		test	eax, eax
		jz	short loc_4029C6
		mov	[esp+178h+lpServiceName], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4029C6:				; CODE XREF: sub_4020C2+8F6j
		cmp	[ebp+var_34], 0
		jz	short loc_4029D3
		mov	[ebp+var_30], 0

loc_4029D3:				; CODE XREF: sub_4020C2+908j
		mov	eax, ds:dword_435FB8
		test	eax, eax
		jnz	short loc_4029E6
		mov	eax, ds:dword_435FB4
		mov	ds:dword_435FB8, eax

loc_4029E6:				; CODE XREF: sub_4020C2+918j
		mov	eax, ds:dword_435FBC
		test	eax, eax
		jnz	short loc_4029F9
		mov	eax, ds:dword_435FB4
		mov	ds:dword_435FBC, eax

loc_4029F9:				; CODE XREF: sub_4020C2+92Bj
		cmp	[ebp+var_30], 0
		jz	short loc_402A77
		mov	[esp+178h+lpServiceName], 0Eh
		call	sub_425424
		mov	esi, eax
		mov	[esp+178h+lpServiceName], 0Dh
		call	sub_425424
		mov	ebx, eax
		mov	[esp+178h+lpServiceName], 0Bh
		call	sub_425424
		mov	edx, offset Format ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+178h+var_168], esi
		mov	[esp+178h+var_16C], ebx	; int
		mov	[esp+178h+lpContext], eax
		mov	[esp+178h+lpHandlerProc], edx ;	Format
		mov	[esp+178h+lpServiceName], ecx ;	File
		call	fprintf
		mov	[esp+178h+lpServiceName], 0Fh
		call	sub_425424
		mov	edx, offset aS	; "%s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+178h+lpContext], eax
		mov	[esp+178h+lpHandlerProc], edx ;	Format
		mov	[esp+178h+lpServiceName], ecx ;	File
		call	fprintf

loc_402A77:				; CODE XREF: sub_4020C2+93Bj
		call	sub_415A69
		test	eax, eax
		jz	short loc_402AA4
		lea	eax, [ebp+var_C8]
		mov	[esp+178h+lpServiceName], eax ;	char *
		call	sub_415940
		lea	eax, [ebp+var_C8]
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aWarningRunning ; "WARNING: running with faked	system time"...
		call	sub_423387

loc_402AA4:				; CODE XREF: sub_4020C2+9BCj
		call	sub_40180A
		cmp	[ebp+var_3C], 0
		jnz	short loc_402AFE
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_402ABF
		mov	eax, offset aLdapservers_co ; "ldapservers.conf"
		jmp	short loc_402AC4
; ---------------------------------------------------------------------------

loc_402ABF:				; CODE XREF: sub_4020C2+9F4j
		mov	eax, offset aDirmngr_ldapse ; "dirmngr_ldapservers.conf"

loc_402AC4:				; CODE XREF: sub_4020C2+9FBj
		mov	edx, ds:dword_435FB4
		mov	[esp+178h+lpContext], 0
		mov	[esp+178h+lpHandlerProc], eax
		mov	[esp+178h+lpServiceName], edx
		call	sub_4259CC
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+178h+lpServiceName], eax ;	char *
		call	sub_4035E6
		mov	ds:dword_436010, eax
		mov	eax, [ebp+var_3C]
		mov	[esp+178h+lpServiceName], eax
		call	gcry_free
		jmp	short loc_402B0E
; ---------------------------------------------------------------------------

loc_402AFE:				; CODE XREF: sub_4020C2+9EBj
		mov	eax, [ebp+var_3C]
		mov	[esp+178h+lpServiceName], eax ;	char *
		call	sub_4035E6
		mov	ds:dword_436010, eax

loc_402B0E:				; CODE XREF: sub_4020C2+A3Aj
		cmp	[ebp+var_1C], 0
		jnz	short loc_402B26
		mov	eax, ds:dword_435FCC
		test	eax, eax
		jz	short loc_402B26
		mov	[ebp+var_1C], 1F6h
		jmp	short loc_402B33
; ---------------------------------------------------------------------------

loc_402B26:				; CODE XREF: sub_4020C2+A50j
					; sub_4020C2+A59j
		cmp	[ebp+var_1C], 0
		jnz	short loc_402B33
		mov	[ebp+var_1C], 1F5h

loc_402B33:				; CODE XREF: sub_4020C2+A62j
					; sub_4020C2+A68j
		mov	[ebp+var_44], 0
		cmp	[ebp+var_1C], 1F5h
		jnz	loc_402BD8
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_402B5A
		mov	[esp+178h+lpServiceName], offset aServer ; "--server"
		call	sub_401A7B
; ---------------------------------------------------------------------------

loc_402B5A:				; CODE XREF: sub_4020C2+A8Aj
		cmp	[ebp+var_38], 0
		jz	short loc_402B7F
		mov	eax, [ebp+var_38]
		mov	[esp+178h+lpServiceName], eax ;	char *
		call	sub_422DEE
		mov	[esp+178h+lpHandlerProc], 6 ; int
		mov	[esp+178h+lpServiceName], 0 ; char *
		call	sub_422E3E

loc_402B7F:				; CODE XREF: sub_4020C2+A9Cj
		cmp	[ebp+Duration],	0
		jz	short loc_402BB3
		call	_getpid
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aWaitingForDebu ; "waiting for	debugger - my pid is %u	..."...
		call	sub_42344E
		mov	eax, [ebp+Duration]
		mov	[esp+178h+lpServiceName], eax ;	Duration
		mov	eax, ds:_sleep
		call	eax ; _sleep
		mov	[esp+178h+lpServiceName], offset a___Okay ; "... okay\n"
		call	sub_42344E

loc_402BB3:				; CODE XREF: sub_4020C2+AC1j
		call	sub_401AE7
		call	sub_40D0E6
		call	sub_408D4C
		mov	[esp+178h+lpServiceName], 0FFFFFFFFh
		call	sub_406596
		call	sub_401BB9
		jmp	loc_40348A
; ---------------------------------------------------------------------------

loc_402BD8:				; CODE XREF: sub_4020C2+A7Fj
		cmp	[ebp+var_1C], 1F6h
		jnz	loc_402F5F
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_402BF8
		mov	[esp+178h+lpServiceName], offset aDaemon ; "--daemon"
		call	sub_401A7B
; ---------------------------------------------------------------------------

loc_402BF8:				; CODE XREF: sub_4020C2+B28j
		cmp	[ebp+var_38], 0
		jz	short loc_402C2D
		mov	eax, [ebp+var_38]
		mov	[esp+178h+lpServiceName], eax ;	char *
		call	sub_422DEE
		mov	[esp+178h+lpHandlerProc], 7 ; char
		mov	[esp+178h+lpServiceName], 0 ; char *
		call	sub_422E3E
		mov	eax, [ebp+var_38]
		mov	[esp+178h+lpServiceName], eax
		call	gcry_xstrdup
		mov	ds:Str1, eax

loc_402C2D:				; CODE XREF: sub_4020C2+B3Aj
		mov	eax, ds:Filename
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		cmp	eax, 65h
		jbe	short loc_402C74
		mov	[esp+178h+lpServiceName], offset aNameOfSocketTo ; "name of socket too long\n"
		call	sub_4233B1
		mov	[esp+178h+lpServiceName], 1
		call	sub_4035CB
; ---------------------------------------------------------------------------

loc_402C74:				; CODE XREF: sub_4020C2+B98j
		mov	[esp+178h+lpContext], 0
		mov	[esp+178h+lpHandlerProc], 1
		mov	[esp+178h+lpServiceName], 1
		call	assuan_sock_new
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jnz	short loc_402CCB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+178h+lpServiceName], eax ;	int
		call	strerror
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aCanTCreateSock ; "can't create socket: %s\n"
		call	sub_4233B1
		call	sub_403566
		mov	[esp+178h+lpServiceName], 1
		call	sub_4035CB
; ---------------------------------------------------------------------------

loc_402CCB:				; CODE XREF: sub_4020C2+BD5j
		lea	eax, [ebp+var_13C]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 1Ch
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	word ptr [ebp+var_13C],	1
		mov	eax, ds:Filename
		mov	[esp+178h+lpHandlerProc], eax ;	Source
		lea	eax, [ebp+var_13C]
		add	eax, 8
		mov	[esp+178h+lpServiceName], eax ;	Dest
		call	strcpy
		lea	eax, [ebp+var_13C]
		add	eax, 8
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 9
		mov	dword ptr [ebp+var_64],	eax
		mov	eax, dword ptr [ebp+var_64]
		mov	[esp+178h+lpContext], eax
		lea	eax, [ebp+var_13C]
		mov	[esp+178h+lpHandlerProc], eax
		mov	eax, [ebp+s]
		mov	[esp+178h+lpServiceName], eax
		call	assuan_sock_bind
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0FFFFFFFFh
		jnz	short loc_402D98
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2740h
		jnz	short loc_402D98
		mov	eax, ds:Filename
		mov	[esp+178h+lpServiceName], eax ;	Filename
		call	remove
		mov	eax, dword ptr [ebp+var_64]
		mov	[esp+178h+lpContext], eax
		lea	eax, [ebp+var_13C]
		mov	[esp+178h+lpHandlerProc], eax
		mov	eax, [ebp+s]
		mov	[esp+178h+lpServiceName], eax
		call	assuan_sock_bind
		mov	[ebp+var_44], eax

loc_402D98:				; CODE XREF: sub_4020C2+C98j
					; sub_4020C2+CA8j
		cmp	[ebp+var_44], 0FFFFFFFFh
		jz	short loc_402DD0
		mov	[esp+178h+lpContext], offset dword_435024
		mov	eax, dword ptr [ebp+var_64]
		mov	[esp+178h+lpHandlerProc], eax ;	char
		lea	eax, [ebp+var_13C]
		mov	[esp+178h+lpServiceName], eax
		call	assuan_sock_get_nonce
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jz	short loc_402DD0
		mov	[esp+178h+lpServiceName], offset aErrorGettingNo ; "error getting nonce	for the	socket\n"
		call	sub_4233B1

loc_402DD0:				; CODE XREF: sub_4020C2+CDAj
					; sub_4020C2+D00j
		cmp	[ebp+var_44], 0FFFFFFFFh
		jnz	short loc_402E23
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+178h+lpServiceName], eax
		call	sub_401592
		mov	[esp+178h+lpServiceName], eax
		call	gpg_strerror
		mov	[esp+178h+lpContext], eax
		lea	eax, [ebp+var_13C]
		add	eax, 8
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aErrorBindingSo ; "error binding socket to `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+s]
		mov	[esp+178h+lpServiceName], eax
		call	assuan_sock_close
		mov	[esp+178h+lpServiceName], 1
		call	sub_4035CB
; ---------------------------------------------------------------------------

loc_402E23:				; CODE XREF: sub_4020C2+D12j
		mov	ds:dword_435038, 1
		mov	eax, [ebp+s]
		mov	[esp+178h+lpHandlerProc], 5 ; backlog
		mov	[esp+178h+lpServiceName], eax ;	s
		mov	eax, ds:listen
		call	eax ; listen
		sub	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_402E82
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+178h+lpServiceName], eax ;	int
		call	strerror
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aListenFailedS	; "listen() failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+s]
		mov	[esp+178h+lpServiceName], eax
		call	assuan_sock_close
		mov	[esp+178h+lpServiceName], 1
		call	sub_4035CB
; ---------------------------------------------------------------------------

loc_402E82:				; CODE XREF: sub_4020C2+D86j
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_402EA0
		mov	eax, ds:Filename
		mov	[esp+178h+lpHandlerProc], eax ;	char
		mov	[esp+178h+lpServiceName], offset aListeningOnSoc ; "listening on socket	`%s'\n"
		call	sub_423387

loc_402EA0:				; CODE XREF: sub_4020C2+DC7j
		mov	[esp+178h+lpServiceName], 0 ; File
		call	fflush
		call	_getpid
		mov	[ebp+var_68], eax
		mov	ecx, [ebp+var_68]
		mov	edx, ds:Filename
		mov	eax, offset aSetDirmngr_inf ; "set DIRMNGR_INFO=%s;%lu;1\n"
		mov	[esp+178h+lpContext], ecx
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		call	sub_401AE7
		call	sub_40D0E6
		call	sub_408D4C
		mov	eax, ds:dword_435FCC
		test	eax, eax
		jz	short loc_402F0E
		mov	ds:ServiceStatus.dwCurrentState, 4
		mov	eax, ds:hServiceStatus
		mov	[esp+178h+lpHandlerProc], offset ServiceStatus ; lpServiceStatus
		mov	[esp+178h+lpServiceName], eax ;	hServiceStatus
		mov	eax, ds:SetServiceStatus
		call	eax ; SetServiceStatus
		sub	esp, 8

loc_402F0E:				; CODE XREF: sub_4020C2+E26j
		mov	eax, [ebp+s]
		mov	[esp+178h+lpServiceName], eax
		call	sub_404046
		mov	eax, [ebp+s]
		mov	[esp+178h+lpServiceName], eax
		call	assuan_sock_close
		call	sub_401BB9
		mov	eax, ds:dword_435FCC
		test	eax, eax
		jz	loc_40348A
		mov	ds:ServiceStatus.dwCurrentState, 1
		mov	eax, ds:hServiceStatus
		mov	[esp+178h+lpHandlerProc], offset ServiceStatus ; lpServiceStatus
		mov	[esp+178h+lpServiceName], eax ;	hServiceStatus
		mov	eax, ds:SetServiceStatus
		call	eax ; SetServiceStatus
		sub	esp, 8
		jmp	loc_40348A
; ---------------------------------------------------------------------------

loc_402F5F:				; CODE XREF: sub_4020C2+B1Dj
		cmp	[ebp+var_1C], 1F8h
		jnz	short loc_402F9A
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_402F7B
		mov	[esp+178h+lpServiceName], offset aListCrls ; "--list-crls"
		call	sub_401A7B
; ---------------------------------------------------------------------------

loc_402F7B:				; CODE XREF: sub_4020C2+EABj
		call	sub_401AE7
		call	sub_408D4C
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+178h+lpServiceName], eax ;	FILE *
		call	sub_40B140
		jmp	loc_40348A
; ---------------------------------------------------------------------------

loc_402F9A:				; CODE XREF: sub_4020C2+EA4j
		cmp	[ebp+var_1C], 1F9h
		jnz	loc_403053
		lea	eax, [ebp+var_13C]
		mov	edx, eax
		mov	ecx, 0
		mov	eax, 20h
		mov	ebx, eax
		and	ebx, 0FFFFFFFCh
		mov	eax, 0

loc_402FC3:				; CODE XREF: sub_4020C2+F09j
		mov	[edx+eax], ecx
		add	eax, 4
		cmp	eax, ebx
		jb	short loc_402FC3
		add	edx, eax
		lea	eax, [ebp+var_13C]
		mov	[esp+178h+lpServiceName], eax
		call	sub_4035E1
		call	sub_401AE7
		call	sub_40D0E6
		call	sub_408D4C
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_40303D
		mov	[esp+178h+lpHandlerProc], 0 ; char *
		lea	eax, [ebp+var_13C]
		mov	[esp+178h+lpServiceName], eax ;	int
		call	sub_40B19E
		mov	[ebp+var_44], eax
		jmp	loc_40348A
; ---------------------------------------------------------------------------

loc_403011:				; CODE XREF: sub_4020C2+F8Aj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+178h+lpHandlerProc], eax ;	char *
		lea	eax, [ebp+var_13C]
		mov	[esp+178h+lpServiceName], eax ;	int
		call	sub_40B19E
		mov	[ebp+var_44], eax
		mov	eax, [ebp+arg_0]
		sub	eax, 1
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	[ebp+arg_4], eax

loc_40303D:				; CODE XREF: sub_4020C2+F2Fj
		cmp	[ebp+var_44], 0
		jnz	loc_40348A
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_403011
		jmp	loc_40348A
; ---------------------------------------------------------------------------

loc_403053:				; CODE XREF: sub_4020C2+EDFj
		cmp	[ebp+var_1C], 1FAh
		jnz	loc_40316D
		mov	eax, [ebp+arg_0]
		cmp	eax, 1
		jz	short loc_403074
		mov	[esp+178h+lpServiceName], offset aFetchCrlUrl ;	"--fetch-crl URL"
		call	sub_401A7B
; ---------------------------------------------------------------------------

loc_403074:				; CODE XREF: sub_4020C2+FA4j
		lea	eax, [ebp+var_13C]
		mov	edx, eax
		mov	ecx, 0
		mov	eax, 20h
		mov	ebx, eax
		and	ebx, 0FFFFFFFCh
		mov	eax, 0

loc_403090:				; CODE XREF: sub_4020C2+FD6j
		mov	[edx+eax], ecx
		add	eax, 4
		cmp	eax, ebx
		jb	short loc_403090
		add	edx, eax
		lea	eax, [ebp+var_13C]
		mov	[esp+178h+lpServiceName], eax
		call	sub_4035E1
		call	sub_401AE7
		call	sub_40D0E6
		call	sub_408D4C
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		lea	edx, [ebp+var_CC]
		mov	[esp+178h+lpContext], edx ; int
		mov	[esp+178h+lpHandlerProc], eax ;	char *
		lea	eax, [ebp+var_13C]
		mov	[esp+178h+lpServiceName], eax ;	int
		call	sub_40B9E4
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jz	short loc_40310C
		mov	eax, [ebp+var_44]
		mov	[esp+178h+lpServiceName], eax
		call	gpg_strerror
		mov	edx, [ebp+arg_4]
		mov	edx, [edx]
		mov	[esp+178h+lpContext], eax
		mov	[esp+178h+lpHandlerProc], edx ;	char
		mov	[esp+178h+lpServiceName], offset aFetchingCrlFro ; "fetching CRL from `%s' failed: %s\n"
		call	sub_4233B1
		jmp	loc_40348A
; ---------------------------------------------------------------------------

loc_40310C:				; CODE XREF: sub_4020C2+101Fj
		mov	edx, [ebp+var_CC]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+178h+lpContext], edx ; char *
		mov	[esp+178h+lpHandlerProc], eax ;	char *
		lea	eax, [ebp+var_13C]
		mov	[esp+178h+lpServiceName], eax ;	int
		call	sub_40A08A
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jz	short loc_40315A
		mov	eax, [ebp+var_44]
		mov	[esp+178h+lpServiceName], eax
		call	gpg_strerror
		mov	edx, [ebp+arg_4]
		mov	edx, [edx]
		mov	[esp+178h+lpContext], eax
		mov	[esp+178h+lpHandlerProc], edx ;	char
		mov	[esp+178h+lpServiceName], offset aProcessingCrlF ; "processing CRL from	`%s' failed: %s\n"
		call	sub_4233B1

loc_40315A:				; CODE XREF: sub_4020C2+1072j
		mov	eax, [ebp+var_CC]
		mov	[esp+178h+lpServiceName], eax
		call	sub_40C1C5
		jmp	loc_40348A
; ---------------------------------------------------------------------------

loc_40316D:				; CODE XREF: sub_4020C2+F98j
		cmp	[ebp+var_1C], 1FCh
		jnz	short loc_403196
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_403189
		mov	[esp+178h+lpServiceName], offset aFlush	; "--flush"
		call	sub_401A7B
; ---------------------------------------------------------------------------

loc_403189:				; CODE XREF: sub_4020C2+10B9j
		call	sub_408DD1
		mov	[ebp+var_44], eax
		jmp	loc_40348A
; ---------------------------------------------------------------------------

loc_403196:				; CODE XREF: sub_4020C2+10B2j
		cmp	[ebp+var_1C], 1FEh
		jnz	short loc_4031B0
		mov	[esp+178h+lpServiceName], 0
		call	sub_4035CB
; ---------------------------------------------------------------------------
		jmp	loc_40348A
; ---------------------------------------------------------------------------

loc_4031B0:				; CODE XREF: sub_4020C2+10DBj
		cmp	[ebp+var_1C], 1FDh
		jnz	loc_40348A
		mov	[ebp+var_6C], 0
		or	[ebp+var_6C], 80h
		mov	eax, ds:dword_435FC0
		test	eax, eax
		jnz	short loc_4031F6
		mov	eax, ds:dword_435FB4
		mov	[esp+178h+lpContext], 0
		mov	[esp+178h+lpHandlerProc], offset aDirmngr_conf ; "dirmngr.conf"
		mov	[esp+178h+lpServiceName], eax
		call	sub_4259CC
		mov	ds:dword_435FC0, eax

loc_4031F6:				; CODE XREF: sub_4020C2+1110j
		mov	eax, ds:dword_435FC0
		mov	[esp+178h+lpHandlerProc], 0 ; char *
		mov	[esp+178h+lpServiceName], eax ;	int
		call	sub_42671F
		mov	[ebp+var_70], eax
		mov	eax, offset aGpgconfDirmngr ; "gpgconf-dirmngr.conf:%lu:\"%s\n"
		mov	edx, [ebp+var_70]
		mov	[esp+178h+lpContext], edx
		mov	[esp+178h+lpHandlerProc], 10h
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, [ebp+var_70]
		mov	[esp+178h+lpServiceName], eax
		call	gcry_free
		mov	eax, offset aVerboseLu ; "verbose:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aQuietLu ; "quiet:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, [ebp+var_6C]
		mov	edx, eax
		or	edx, 10h
		mov	eax, offset aDebugLevelLuNo ; "debug-level:%lu:\"none\n"
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aLogFileLu ; "log-file:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aForceLu ; "force:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_4032AE
		mov	eax, offset aLdapservers_co ; "ldapservers.conf"
		jmp	short loc_4032B3
; ---------------------------------------------------------------------------

loc_4032AE:				; CODE XREF: sub_4020C2+11E3j
		mov	eax, offset aDirmngr_ldapse ; "dirmngr_ldapservers.conf"

loc_4032B3:				; CODE XREF: sub_4020C2+11EAj
		mov	edx, ds:dword_435FB4
		mov	[esp+178h+lpContext], 0
		mov	[esp+178h+lpHandlerProc], eax
		mov	[esp+178h+lpServiceName], edx
		call	sub_4259CC
		mov	[ebp+var_70], eax
		mov	[esp+178h+lpHandlerProc], 0 ; char *
		mov	eax, [ebp+var_70]
		mov	[esp+178h+lpServiceName], eax ;	int
		call	sub_42671F
		mov	[ebp+var_74], eax
		mov	eax, [ebp+var_6C]
		mov	ecx, eax
		or	ecx, 10h
		mov	eax, offset aLdapserverlist ; "ldapserverlist-file:%lu:\"%s\n"
		mov	edx, [ebp+var_74]
		mov	[esp+178h+lpContext], edx
		mov	[esp+178h+lpHandlerProc], ecx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, [ebp+var_74]
		mov	[esp+178h+lpServiceName], eax
		call	gcry_free
		mov	eax, [ebp+var_70]
		mov	[esp+178h+lpServiceName], eax
		call	gcry_free
		mov	eax, [ebp+var_6C]
		mov	edx, eax
		or	edx, 10h
		mov	eax, offset aLdaptimeoutLuU ; "ldaptimeout:%lu:%u\n"
		mov	[esp+178h+lpContext], 64h
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, [ebp+var_6C]
		mov	edx, eax
		or	edx, 10h
		mov	eax, offset aMaxRepliesLuU ; "max-replies:%lu:%u\n"
		mov	[esp+178h+lpContext], 0Ah
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aAllowOcspLu ; "allow-ocsp:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aOcspResponderL ; "ocsp-responder:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aOcspSignerLu ; "ocsp-signer:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aFakedSystemTim ; "faked-system-time:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aNoGreetingLu ; "no-greeting:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aDisableHttpLu ; "disable-http:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aDisableLdapLu ; "disable-ldap:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aHonorHttpProxy ; "honor-http-proxy:%lu\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aHttpProxyLu ; "http-proxy:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aLdapProxyLu ; "ldap-proxy:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aOnlyLdapProxyL ; "only-ldap-proxy:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aIgnoreLdapDpLu ; "ignore-ldap-dp:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aIgnoreHttpDpLu ; "ignore-http-dp:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aIgnoreOcspServ ; "ignore-ocsp-service-url:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf
		mov	eax, offset aIgnoreOcspSe_0 ; "ignore-ocsp-servic-url:%lu:\n"
		mov	edx, [ebp+var_6C]
		mov	[esp+178h+lpHandlerProc], edx
		mov	[esp+178h+lpServiceName], eax ;	Format
		call	printf

loc_40348A:				; CODE XREF: sub_4020C2+B11j
					; sub_4020C2+E6Ej ...
		call	sub_403566
		cmp	[ebp+var_44], 0
		setnz	al
		movzx	eax, al
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4020C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4034A1	proc near		; CODE XREF: sub_401180+265p

Str1		= dword	ptr -34h
Str2		= dword	ptr -30h
ServiceStartTable= SERVICE_TABLE_ENTRYA	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  0Ch

		lea	ecx, [esp-8+arg_0]
		and	esp, 0FFFFFFF0h
		push	dword ptr [ecx-4]
		push	ebp
		mov	ebp, esp
		push	ebx
		push	ecx
		sub	esp, 30h
		mov	ebx, ecx
		call	sub_4290E0
		mov	[ebp+var_C], 1
		jmp	short loc_4034FC
; ---------------------------------------------------------------------------

loc_4034C3:				; CODE XREF: sub_4034A1+60j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebx+4]
		mov	eax, [eax]
		mov	[esp+34h+Str2],	offset aService	; "--service"
		mov	[esp+34h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4034F8
		mov	ds:dword_435FCC, 1
		mov	ds:dword_435FD0, 1
		jmp	short loc_403503
; ---------------------------------------------------------------------------

loc_4034F8:				; CODE XREF: sub_4034A1+3Fj
		add	[ebp+var_C], 1

loc_4034FC:				; CODE XREF: sub_4034A1+20j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebx]
		jl	short loc_4034C3

loc_403503:				; CODE XREF: sub_4034A1+55j
		mov	eax, ds:dword_435FCC
		test	eax, eax
		jnz	short loc_40351F
		mov	eax, [ebx+4]
		mov	[esp+34h+Str2],	eax
		mov	eax, [ebx]
		mov	[esp+34h+Str1],	eax
		call	sub_4020C2
		jmp	short loc_40355C
; ---------------------------------------------------------------------------

loc_40351F:				; CODE XREF: sub_4034A1+69j
		mov	[ebp+ServiceStartTable.lpServiceName], offset ServiceName ; "DirMngr"
		mov	eax, offset sub_4020C2
		mov	[ebp+ServiceStartTable.lpServiceProc], eax
		mov	[ebp+var_14], 0
		mov	[ebp+var_10], 0
		lea	eax, [ebp+ServiceStartTable]
		mov	[esp+34h+Str1],	eax ; lpServiceStartTable
		mov	eax, ds:StartServiceCtrlDispatcherA
		call	eax ; StartServiceCtrlDispatcherA
		sub	esp, 4
		test	eax, eax
		jnz	short loc_403557
		mov	eax, 1
		jmp	short loc_40355C
; ---------------------------------------------------------------------------

loc_403557:				; CODE XREF: sub_4034A1+ADj
		mov	eax, 0

loc_40355C:				; CODE XREF: sub_4034A1+7Cj
					; sub_4034A1+B4j
		lea	esp, [ebp-8]
		pop	ecx
		pop	ebx
		pop	ebp
		lea	esp, [ecx-4]
		retn
sub_4034A1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403566	proc near		; CODE XREF: sub_4020C2+BF8p
					; sub_4020C2:loc_40348Ap ...

Filename	= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_408DA9
		mov	[esp+18h+Filename], 1
		call	sub_40D198
		mov	eax, ds:dword_436010
		mov	[esp+18h+Filename], eax
		call	sub_40C240
		mov	ds:dword_436010, 0
		mov	eax, ds:dword_435038
		test	eax, eax
		jz	short locret_4035C9
		mov	ds:dword_435038, 0
		mov	eax, ds:Filename
		test	eax, eax
		jz	short locret_4035C9
		mov	eax, ds:Filename
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short locret_4035C9
		mov	eax, ds:Filename
		mov	[esp+18h+Filename], eax	; Filename
		call	remove

locret_4035C9:				; CODE XREF: sub_403566+35j
					; sub_403566+48j ...
		leave
		retn
sub_403566	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4035CB	proc near		; CODE XREF: sub_401A7B+65p
					; sub_401AE7+BDp ...

Code		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_403566
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Code],	eax ; Code
		call	exit
sub_4035CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4035E1	proc near		; CODE XREF: sub_4020C2+F16p
					; sub_4020C2+FE3p ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_4035E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4035E6(char *)
sub_4035E6	proc near		; CODE XREF: sub_4020C2+A25p
					; sub_4020C2+A42p

Filename	= dword	ptr -448h
Mode		= dword	ptr -444h
var_440		= dword	ptr -440h
var_42C		= dword	ptr -42Ch
var_424		= dword	ptr -424h
Buf		= byte ptr -420h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
File		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 444h
		mov	[ebp+var_14], 0
		mov	eax, offset Mode ; "r"
		mov	[esp+448h+Mode], eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+448h+Filename], eax ; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_403646
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+448h+Filename], eax ; int
		call	strerror
		mov	[esp+448h+var_440], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+448h+Mode], eax ; char
		mov	[esp+448h+Filename], offset aErrorOpeningSS ; "error opening `%s': %s\n"
		call	sub_4233B1
		mov	eax, 0
		jmp	loc_4037DB
; ---------------------------------------------------------------------------

loc_403646:				; CODE XREF: sub_4035E6+2Cj
		mov	[ebp+var_424], 0
		lea	eax, [ebp+var_424]
		mov	[ebp+var_10], eax
		jmp	loc_40376E
; ---------------------------------------------------------------------------

loc_40365E:				; CODE XREF: sub_4035E6+1A7j
		add	[ebp+var_14], 1
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_4036A4
		lea	eax, [ebp+Buf]
		mov	[ebp+var_42C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_42C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		movzx	eax, [ebp+eax+Buf]
		cmp	al, 0Ah
		jz	short loc_4036F4

loc_4036A4:				; CODE XREF: sub_4035E6+85j
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_4036BE
		mov	eax, [ebp+File]
		mov	[esp+448h+Filename], eax ; File
		call	feof
		test	eax, eax
		jnz	short loc_4036F4

loc_4036BE:				; CODE XREF: sub_4035E6+C7j
		mov	eax, [ebp+var_14]
		mov	[esp+448h+var_440], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+448h+Mode], eax ; char
		mov	[esp+448h+Filename], offset aSULineTooLongS ; "%s:%u: line too long - skipped\n"
		call	sub_4233B1

loc_4036D8:				; CODE XREF: sub_4035E6+10Aj
		mov	eax, [ebp+File]
		mov	[esp+448h+Filename], eax ; File
		call	fgetc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_40376A
		cmp	[ebp+var_1C], 0Ah
		jnz	short loc_4036D8
		jmp	short loc_40376A
; ---------------------------------------------------------------------------

loc_4036F4:				; CODE XREF: sub_4035E6+BCj
					; sub_4035E6+D6j
		lea	eax, [ebp+Buf]
		mov	[ebp+var_C], eax
		jmp	short loc_403703
; ---------------------------------------------------------------------------

loc_4036FF:				; CODE XREF: sub_4035E6+125j
					; sub_4035E6+12Fj
		add	[ebp+var_C], 1

loc_403703:				; CODE XREF: sub_4035E6+117j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4036FF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4036FF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40376D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_40376D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	short loc_40376D
		mov	eax, [ebp+var_14]
		mov	[esp+448h+var_440], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+448h+Mode], eax
		lea	eax, [ebp+Buf]
		mov	[esp+448h+Filename], eax
		call	sub_40C2F3
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_40376E
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[ebp+var_10], eax
		jmp	short loc_40376E
; ---------------------------------------------------------------------------

loc_40376A:				; CODE XREF: sub_4035E6+104j
					; sub_4035E6+10Cj
		nop
		jmp	short loc_40376E
; ---------------------------------------------------------------------------

loc_40376D:				; CODE XREF: sub_4035E6+139j
					; sub_4035E6+143j ...
		nop

loc_40376E:				; CODE XREF: sub_4035E6+73j
					; sub_4035E6+172j ...
		mov	eax, [ebp+File]
		mov	[esp+448h+var_440], eax	; File
		mov	[esp+448h+Mode], 400h ;	MaxCount
		lea	eax, [ebp+Buf]
		mov	[esp+448h+Filename], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_40365E
		mov	eax, [ebp+File]
		mov	[esp+448h+Filename], eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_4037CA
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+448h+Filename], eax ; int
		call	strerror
		mov	[esp+448h+var_440], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+448h+Mode], eax ; char
		mov	[esp+448h+Filename], offset aErrorReadingSS ; "error reading `%s': %s\n"
		call	sub_4233B1

loc_4037CA:				; CODE XREF: sub_4035E6+1BAj
		mov	eax, [ebp+File]
		mov	[esp+448h+Filename], eax ; File
		call	fclose
		mov	eax, [ebp+var_424]

loc_4037DB:				; CODE XREF: sub_4035E6+5Bj
		add	esp, 444h
		pop	edi
		pop	ebp
		retn
sub_4035E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4037E4(char *)
sub_4037E4	proc near		; CODE XREF: sub_401BC6+418p

Str		= dword	ptr -168h
Control		= dword	ptr -164h
File		= dword	ptr -160h
var_15C		= dword	ptr -15Ch
var_14C		= dword	ptr -14Ch
var_13C		= dword	ptr -13Ch
Buf		= byte ptr -138h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Filename	= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 164h
		mov	[ebp+var_18], 0
		mov	[ebp+var_24], 0
		mov	[esp+168h+Control], offset Control ; "/.~\\"
		mov	eax, [ebp+arg_0]
		mov	[esp+168h+Str],	eax ; Str
		call	strpbrk
		test	eax, eax
		jnz	loc_403958
		mov	[esp+168h+Control], 30h
		mov	[esp+168h+Str],	1
		call	gcry_xcalloc
		mov	[ebp+var_28], eax
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_20]
		mov	[ebp+var_1C], eax
		jmp	short loc_403881
; ---------------------------------------------------------------------------

loc_40383D:				; CODE XREF: sub_4037E4+FCj
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_40387D
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_403865
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		jmp	short loc_40386E
; ---------------------------------------------------------------------------

loc_403865:				; CODE XREF: sub_4037E4+71j
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]

loc_40386E:				; CODE XREF: sub_4037E4+7Fj
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		add	edx, ecx
		mov	[edx+4], al
		add	[ebp+var_20], 1

loc_40387D:				; CODE XREF: sub_4037E4+64j
		add	[ebp+var_1C], 1

loc_403881:				; CODE XREF: sub_4037E4+57j
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_4038DC
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4038A8
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4038DC

loc_4038A8:				; CODE XREF: sub_4037E4+B5j
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4038C2
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_4038DC

loc_4038C2:				; CODE XREF: sub_4037E4+CFj
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4038E6
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4038E6

loc_4038DC:				; CODE XREF: sub_4037E4+A8j
					; sub_4037E4+C2j ...
		cmp	[ebp+var_20], 27h
		jle	loc_40383D

loc_4038E6:				; CODE XREF: sub_4037E4+E9j
					; sub_4037E4+F6j
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_20]
		add	eax, edx
		mov	byte ptr [eax+4], 0
		cmp	[ebp+var_20], 28h
		jnz	short loc_40391F
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403950
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_403950
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403950

loc_40391F:				; CODE XREF: sub_4037E4+112j
		mov	[esp+168h+File], 0
		mov	[esp+168h+Control], offset aOcspSigner ; "--ocsp-signer"
		mov	[esp+168h+Str],	offset aSUInvalidFinge ; "%s:%u: invalid fingerprint detected\n"
		call	sub_4233B1
		mov	eax, [ebp+var_28]
		mov	[esp+168h+Str],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_403DA4
; ---------------------------------------------------------------------------

loc_403950:				; CODE XREF: sub_4037E4+11Fj
					; sub_4037E4+12Cj ...
		mov	eax, [ebp+var_28]
		jmp	loc_403DA4
; ---------------------------------------------------------------------------

loc_403958:				; CODE XREF: sub_4037E4+2Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_403979
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	short loc_403991
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_403991

loc_403979:				; CODE XREF: sub_4037E4+17Cj
		mov	[esp+168h+Control], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+168h+Str],	eax
		call	sub_4259CC
		mov	[ebp+Filename],	eax
		jmp	short loc_4039CB
; ---------------------------------------------------------------------------

loc_403991:				; CODE XREF: sub_4037E4+186j
					; sub_4037E4+193j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	short loc_4039AC
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4039AC
		add	[ebp+arg_0], 2

loc_4039AC:				; CODE XREF: sub_4037E4+1B5j
					; sub_4037E4+1C2j
		mov	eax, ds:dword_435FB4
		mov	[esp+168h+File], 0
		mov	edx, [ebp+arg_0]
		mov	[esp+168h+Control], edx
		mov	[esp+168h+Str],	eax
		call	sub_4259CC
		mov	[ebp+Filename],	eax

loc_4039CB:				; CODE XREF: sub_4037E4+1ABj
		mov	edx, offset Mode ; "r"
		mov	eax, [ebp+Filename]
		mov	[esp+168h+Control], edx	; Mode
		mov	[esp+168h+Str],	eax ; Filename
		call	fopen
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_403A27
		call	sub_4015AD
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[esp+168h+Str],	eax
		call	gpg_strerror
		mov	[esp+168h+File], eax
		mov	eax, [ebp+Filename]
		mov	[esp+168h+Control], eax	; char
		mov	[esp+168h+Str],	offset aCanTOpenSS ; "can't open `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+Filename]
		mov	[esp+168h+Str],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_403DA4
; ---------------------------------------------------------------------------

loc_403A27:				; CODE XREF: sub_4037E4+202j
		mov	[ebp+var_13C], 0
		lea	eax, [ebp+var_13C]
		mov	[ebp+var_14], eax
		jmp	short loc_403A3D
; ---------------------------------------------------------------------------

loc_403A3C:				; CODE XREF: sub_4037E4+584j
					; sub_4037E4+595j ...
		nop

loc_403A3D:				; CODE XREF: sub_4037E4+256j
		mov	eax, [ebp+var_2C]
		mov	[esp+168h+File], eax ; File
		mov	[esp+168h+Control], 0FFh ; MaxCount
		lea	eax, [ebp+Buf]
		mov	[esp+168h+Str],	eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_403AFE
		mov	eax, [ebp+var_2C]
		mov	[esp+168h+Str],	eax ; File
		call	feof
		test	eax, eax
		jnz	short loc_403AA9
		call	sub_4015AD
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[esp+168h+Str],	eax
		call	gpg_strerror
		mov	[esp+168h+var_15C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+168h+File], eax
		mov	eax, [ebp+Filename]
		mov	[esp+168h+Control], eax	; char
		mov	[esp+168h+Str],	offset aSUReadErrorS ; "%s:%u: read error: %s\n"
		call	sub_4233B1
		mov	[ebp+var_24], 1

loc_403AA9:				; CODE XREF: sub_4037E4+28Bj
		mov	eax, [ebp+var_2C]
		mov	[esp+168h+Str],	eax ; File
		call	fclose
		cmp	[ebp+var_24], 0
		jz	short loc_403AE8
		jmp	short loc_403ADE
; ---------------------------------------------------------------------------

loc_403ABC:				; CODE XREF: sub_4037E4+302j
		mov	eax, [ebp+var_13C]
		mov	eax, [eax]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_13C]
		mov	[esp+168h+Str],	eax
		call	gcry_free
		mov	eax, [ebp+var_34]
		mov	[ebp+var_13C], eax

loc_403ADE:				; CODE XREF: sub_4037E4+2D6j
		mov	eax, [ebp+var_13C]
		test	eax, eax
		jnz	short loc_403ABC

loc_403AE8:				; CODE XREF: sub_4037E4+2D4j
		mov	eax, [ebp+Filename]
		mov	[esp+168h+Str],	eax
		call	gcry_free
		mov	eax, [ebp+var_13C]
		jmp	loc_403DA4
; ---------------------------------------------------------------------------

loc_403AFE:				; CODE XREF: sub_4037E4+278j
		add	[ebp+var_18], 1
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_403B44
		lea	eax, [ebp+Buf]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		movzx	eax, [ebp+eax+Buf]
		cmp	al, 0Ah
		jz	short loc_403BB5

loc_403B44:				; CODE XREF: sub_4037E4+327j
					; sub_4037E4+378j
		mov	eax, [ebp+var_2C]
		mov	[esp+168h+Str],	eax ; File
		call	getc
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jz	short loc_403B5E
		cmp	[ebp+var_38], 0Ah
		jnz	short loc_403B44

loc_403B5E:				; CODE XREF: sub_4037E4+372j
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_403B70
		mov	eax, 61h
		jmp	short loc_403B75
; ---------------------------------------------------------------------------

loc_403B70:				; CODE XREF: sub_4037E4+383j
		mov	eax, 4Bh

loc_403B75:				; CODE XREF: sub_4037E4+38Aj
		mov	[esp+168h+Str],	eax
		call	sub_401577
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[esp+168h+Str],	eax
		call	gpg_strerror
		mov	[esp+168h+var_15C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+168h+File], eax
		mov	eax, [ebp+Filename]
		mov	[esp+168h+Control], eax	; char
		mov	[esp+168h+Str],	offset aSUReadErrorS ; "%s:%u: read error: %s\n"
		call	sub_4233B1
		mov	[ebp+var_24], 1
		jmp	loc_403D9F
; ---------------------------------------------------------------------------

loc_403BB5:				; CODE XREF: sub_4037E4+35Ej
		lea	eax, [ebp+Buf]
		mov	[ebp+var_10], eax
		jmp	short loc_403BC4
; ---------------------------------------------------------------------------

loc_403BC0:				; CODE XREF: sub_4037E4+3E8j
					; sub_4037E4+3F2j
		add	[ebp+var_10], 1

loc_403BC4:				; CODE XREF: sub_4037E4+3DAj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403BC0
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_403BC0
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_403D9E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	loc_403D9E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	loc_403D9E
		mov	[esp+168h+Control], 30h
		mov	[esp+168h+Str],	1
		call	gcry_xcalloc
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_28]
		mov	[eax], edx
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_20]
		mov	[ebp+var_1C], eax
		jmp	short loc_403C7A
; ---------------------------------------------------------------------------

loc_403C36:				; CODE XREF: sub_4037E4+4F5j
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_403C76
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_403C5E
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		jmp	short loc_403C67
; ---------------------------------------------------------------------------

loc_403C5E:				; CODE XREF: sub_4037E4+46Aj
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]

loc_403C67:				; CODE XREF: sub_4037E4+478j
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		add	edx, ecx
		mov	[edx+4], al
		add	[ebp+var_20], 1

loc_403C76:				; CODE XREF: sub_4037E4+45Dj
		add	[ebp+var_1C], 1

loc_403C7A:				; CODE XREF: sub_4037E4+450j
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_403CD5
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_403CA1
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_403CD5

loc_403CA1:				; CODE XREF: sub_4037E4+4AEj
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_403CBB
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_403CD5

loc_403CBB:				; CODE XREF: sub_4037E4+4C8j
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_403CDF
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_403CDF

loc_403CD5:				; CODE XREF: sub_4037E4+4A1j
					; sub_4037E4+4BBj ...
		cmp	[ebp+var_20], 27h
		jle	loc_403C36

loc_403CDF:				; CODE XREF: sub_4037E4+4E2j
					; sub_4037E4+4EFj
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_20]
		add	eax, edx
		mov	byte ptr [eax+4], 0
		cmp	[ebp+var_20], 28h
		jnz	short loc_403D18
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403D39
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_403D39
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_403D39

loc_403D18:				; CODE XREF: sub_4037E4+50Bj
		mov	eax, [ebp+var_18]
		mov	[esp+168h+File], eax
		mov	eax, [ebp+Filename]
		mov	[esp+168h+Control], eax	; char
		mov	[esp+168h+Str],	offset aSUInvalidFinge ; "%s:%u: invalid fingerprint detected\n"
		call	sub_4233B1
		mov	[ebp+var_24], 1

loc_403D39:				; CODE XREF: sub_4037E4+518j
					; sub_4037E4+525j ...
		add	[ebp+var_1C], 1
		jmp	short loc_403D43
; ---------------------------------------------------------------------------

loc_403D3F:				; CODE XREF: sub_4037E4+56Aj
					; sub_4037E4+577j
		add	[ebp+var_1C], 1

loc_403D43:				; CODE XREF: sub_4037E4+559j
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403D3F
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_403D3F
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_403A3C
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	loc_403A3C
		mov	eax, [ebp+var_18]
		mov	[esp+168h+File], eax
		mov	eax, [ebp+Filename]
		mov	[esp+168h+Control], eax	; char
		mov	[esp+168h+Str],	offset aSUGarbageAtEnd ; "%s:%u: garbage at end	of line	ignored\n"
		call	sub_423387
		jmp	loc_403A3C
; ---------------------------------------------------------------------------

loc_403D9E:				; CODE XREF: sub_4037E4+3FCj
					; sub_4037E4+40Aj ...
		nop

loc_403D9F:				; CODE XREF: sub_4037E4+3CCj
		jmp	loc_403A3C
; ---------------------------------------------------------------------------

loc_403DA4:				; CODE XREF: sub_4037E4+167j
					; sub_4037E4+16Fj ...
		add	esp, 164h
		pop	edi
		pop	ebp
		retn
sub_4037E4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	dword ptr [ebp-44h], 0
		mov	eax, ds:dword_435FC0
		test	eax, eax
		jz	loc_403EBB
		mov	edx, offset Mode ; "r"
		mov	eax, ds:dword_435FC0
		mov	[esp+4], edx
		mov	[esp], eax
		call	fopen
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_403E18
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	edx, ds:dword_435FC0
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aOptionFileSS ;	"option	file `%s': %s\n"
		call	sub_4233B1
		jmp	loc_403EBC
; ---------------------------------------------------------------------------

loc_403E18:				; CODE XREF: .text:00403DE6j
		mov	dword ptr [esp+4], 1
		mov	dword ptr [esp], 0
		call	sub_401BC6
		lea	eax, [ebp-40h]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 0Dh
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	dword ptr [ebp-48h], 0
		lea	eax, [ebp-48h]
		mov	[ebp-40h], eax
		mov	dword ptr [ebp-38h], 1
		jmp	short loc_403E7B
; ---------------------------------------------------------------------------

loc_403E57:				; CODE XREF: .text:00403EA7j
		mov	eax, [ebp-30h]
		cmp	eax, 0FFFFFFFFh
		jge	short loc_403E68
		mov	dword ptr [ebp-34h], 1
		jmp	short loc_403E7B
; ---------------------------------------------------------------------------

loc_403E68:				; CODE XREF: .text:00403E5Dj
		mov	dword ptr [esp+4], 1
		lea	eax, [ebp-40h]
		mov	[esp], eax
		call	sub_401BC6

loc_403E7B:				; CODE XREF: .text:00403E55j
					; .text:00403E66j
		mov	eax, ds:dword_435FC0
		mov	dword ptr [esp+10h], offset dword_42B000
		lea	edx, [ebp-40h]
		mov	[esp+0Ch], edx
		lea	edx, [ebp-44h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_423B0A
		test	eax, eax
		jnz	short loc_403E57
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	fclose
		call	sub_40180A
		jmp	short loc_403EBC
; ---------------------------------------------------------------------------

loc_403EBB:				; CODE XREF: .text:00403DC3j
		nop

loc_403EBC:				; CODE XREF: .text:00403E13j
					; .text:00403EB9j
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403EC3	proc near		; CODE XREF: sub_404046+E4p
					; sub_404046+1BCp ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aSignalDReceive ; "signal %d received - no action defined\"...
		call	sub_423387
		leave
		retn
sub_403EC3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403EDE	proc near		; CODE XREF: sub_404046+1F8p
					; sub_404046+27Dp

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, ds:dword_435044
		test	eax, eax
		jz	short loc_403EFA
		mov	[esp+18h+var_18], offset aSigtermReceive ; "SIGTERM received - shutting	down ...\n"
		call	sub_423387

loc_403EFA:				; CODE XREF: sub_403EDE+Ej
		mov	eax, ds:dword_435044
		cmp	eax, 2
		jle	short loc_403F4F
		mov	[esp+18h+var_18], offset aShutdownForced ; "shutdown forced\n"
		call	sub_423387
		mov	[esp+18h+var_18], 0Dh
		call	sub_425424
		mov	ebx, eax
		mov	[esp+18h+var_18], 0Bh
		call	sub_425424
		mov	[esp+18h+var_10], ebx
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aSSStopped ; "%s %s stopped\n"
		call	sub_423387
		call	sub_403566
		mov	[esp+18h+var_18], 0
		call	sub_4035CB
; ---------------------------------------------------------------------------

loc_403F4F:				; CODE XREF: sub_403EDE+24j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_403EDE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F55	proc near		; CODE XREF: sub_403FB2+20p

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_sock_check_nonce
		test	eax, eax
		jz	short loc_403FAB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	edx, dword ptr [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+var_18], offset aErrorReadingNo ; "error reading nonce	on fd %d: %s\n"
		call	sub_423387
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	assuan_sock_close
		mov	eax, 0FFFFFFFFh
		jmp	short locret_403FB0
; ---------------------------------------------------------------------------

loc_403FAB:				; CODE XREF: sub_403F55+1Aj
		mov	eax, 0

locret_403FB0:				; CODE XREF: sub_403F55+54j
		leave
		retn
sub_403F55	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403FB2	proc near		; DATA XREF: sub_404046+2AFo

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [ebp+var_C], eax
		mov	dword ptr [esp+28h+var_24], offset dword_435024
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_403F55
		test	eax, eax
		jz	short loc_403FE2
		mov	eax, 0
		jmp	short locret_404044
; ---------------------------------------------------------------------------

loc_403FE2:				; CODE XREF: sub_403FB2+27j
		mov	eax, ds:dword_435048
		add	eax, 1
		mov	ds:dword_435048, eax
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_40400B
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aHandlerForFdDS ; "handler for	fd %d started\n"
		call	sub_423387

loc_40400B:				; CODE XREF: sub_403FB2+44j
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_406596
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_404032
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aHandlerForFdDT ; "handler for	fd %d terminated\n"
		call	sub_423387

loc_404032:				; CODE XREF: sub_403FB2+6Bj
		mov	eax, ds:dword_435048
		sub	eax, 1
		mov	ds:dword_435048, eax
		mov	eax, 0

locret_404044:				; CODE XREF: sub_403FB2+2Ej
		leave
		retn
sub_403FB2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404046	proc near		; CODE XREF: sub_4020C2+E52p

var_B8		= dword	ptr -0B8h
var_B4		= byte ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= byte ptr -94h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0B4h
		mov	[ebp+var_98], 70h
		call	pth_attr_new
		mov	[ebp+var_10], eax
		mov	[esp+0B8h+var_B0], 0
		mov	dword ptr [esp+0B8h+var_B4], 2
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+var_B8], eax
		call	pth_attr_set
		mov	[esp+0B8h+var_B0], 100000h
		mov	dword ptr [esp+0B8h+var_B4], 4
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+var_B8], eax
		call	pth_attr_set
		mov	[esp+0B8h+var_B0], offset aDirmngr ; "dirmngr"
		mov	dword ptr [esp+0B8h+var_B4], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+var_B8], eax
		call	pth_attr_set
		mov	[ebp+var_1C], 0
		lea	eax, [ebp+var_24]
		mov	[esp+0B8h+var_B0], eax
		lea	eax, [ebp+var_1C]
		mov	dword ptr [esp+0B8h+var_B4], eax
		mov	[esp+0B8h+var_B8], 8
		call	pth_event
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0

loc_4040DE:				; CODE XREF: sub_404046+30Dj
					; sub_404046:loc_40435Cj
		mov	eax, ds:dword_435044
		test	eax, eax
		jz	short loc_404134
		mov	eax, ds:dword_435048
		test	eax, eax
		jz	loc_404361
		mov	[ebp+var_24], 0
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+var_B8], eax
		call	pth_wait
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_occurred
		test	eax, eax
		jz	loc_404358
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	loc_404358
		mov	eax, [ebp+var_24]
		mov	[esp+0B8h+var_B8], eax
		call	sub_403EC3
		jmp	loc_404358
; ---------------------------------------------------------------------------

loc_404134:				; CODE XREF: sub_404046+9Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_404165
		mov	dword ptr [esp+0B8h+var_B4], 0
		mov	[esp+0B8h+var_B8], 4
		call	pth_timeout
		mov	dword ptr [esp+0B8h+var_B4], eax
		mov	[esp+0B8h+var_B0], edx
		mov	[esp+0B8h+var_B8], 10h
		call	pth_event
		mov	[ebp+var_C], eax

loc_404165:				; CODE XREF: sub_404046+F2j
		cmp	[ebp+var_C], 0
		jz	short loc_404185
		mov	[esp+0B8h+var_B0], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+0B8h+var_B4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_concat

loc_404185:				; CODE XREF: sub_404046+123j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[esp+0B8h+var_AC], edx
		lea	edx, [ebp+var_98]
		mov	[esp+0B8h+var_B0], edx
		lea	edx, [ebp+var_94]
		mov	dword ptr [esp+0B8h+var_B4], edx
		mov	[esp+0B8h+var_B8], eax
		call	pth_accept_ev
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4041BF
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_isolate

loc_4041BF:				; CODE XREF: sub_404046+16Cj
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	loc_40427A
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_occurred
		test	eax, eax
		jnz	short loc_4041ED
		cmp	[ebp+var_C], 0
		jz	short loc_404248
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_404248

loc_4041ED:				; CODE XREF: sub_404046+190j
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_404207
		mov	eax, [ebp+var_24]
		mov	[esp+0B8h+var_B8], eax
		call	sub_403EC3

loc_404207:				; CODE XREF: sub_404046+1B4j
		cmp	[ebp+var_C], 0
		jz	loc_40435B
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_occurred
		test	eax, eax
		jz	loc_40435B
		mov	dword ptr [esp+0B8h+var_B4], 1
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_free
		mov	[ebp+var_C], 0
		call	sub_403EDE
		jmp	loc_40435B
; ---------------------------------------------------------------------------

loc_404248:				; CODE XREF: sub_404046+196j
					; sub_404046+1A5j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0B8h+var_B8], eax ; int
		call	strerror
		mov	dword ptr [esp+0B8h+var_B4], eax ; char
		mov	[esp+0B8h+var_B8], offset aAcceptFailedSW ; "accept failed: %s - waiting 1s\n"
		call	sub_4233B1
		mov	[esp+0B8h+var_B8], 1
		call	pth_sleep
		jmp	loc_40435C
; ---------------------------------------------------------------------------

loc_40427A:				; CODE XREF: sub_404046+17Dj
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_404294
		mov	eax, [ebp+var_24]
		mov	[esp+0B8h+var_B8], eax
		call	sub_403EC3

loc_404294:				; CODE XREF: sub_404046+241j
		cmp	[ebp+var_C], 0
		jz	short loc_4042C8
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_4042C8
		mov	dword ptr [esp+0B8h+var_B4], 1
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_free
		mov	[ebp+var_C], 0
		call	sub_403EDE

loc_4042C8:				; CODE XREF: sub_404046+252j
					; sub_404046+261j
		lea	eax, [ebp+var_20]
		mov	[esp+0B8h+var_B0], eax
		lea	eax, [ebp+var_1C]
		mov	dword ptr [esp+0B8h+var_B4], eax
		mov	[esp+0B8h+var_B8], 0
		call	pth_sigmask
		mov	eax, [ebp+var_18]
		mov	[ebp+var_9C], eax
		mov	eax, [ebp+var_9C]
		mov	[esp+0B8h+var_B0], eax
		mov	dword ptr [esp+0B8h+var_B4], offset sub_403FB2
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+var_B8], eax
		call	pth_spawn
		test	eax, eax
		jnz	short loc_404338
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0B8h+var_B8], eax ; int
		call	strerror
		mov	dword ptr [esp+0B8h+var_B4], eax ; char
		mov	[esp+0B8h+var_B8], offset aErrorSpawningC ; "error spawning connection handler:	%s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+var_B8], eax
		call	assuan_sock_close

loc_404338:				; CODE XREF: sub_404046+2C4j
		mov	[esp+0B8h+var_B0], 0
		lea	eax, [ebp+var_20]
		mov	dword ptr [esp+0B8h+var_B4], eax
		mov	[esp+0B8h+var_B8], 2
		call	pth_sigmask
		jmp	loc_4040DE
; ---------------------------------------------------------------------------

loc_404358:				; CODE XREF: sub_404046+CDj
					; sub_404046+D8j ...
		nop
		jmp	short loc_40435C
; ---------------------------------------------------------------------------

loc_40435B:				; CODE XREF: sub_404046+1C5j
					; sub_404046+1D8j ...
		nop

loc_40435C:				; CODE XREF: sub_404046+22Fj
					; sub_404046+313j
		jmp	loc_4040DE
; ---------------------------------------------------------------------------

loc_404361:				; CODE XREF: sub_404046+A8j
		nop
		mov	dword ptr [esp+0B8h+var_B4], 1
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_free
		cmp	[ebp+var_C], 0
		jz	short loc_40438E
		mov	dword ptr [esp+0B8h+var_B4], 1
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+var_B8], eax
		call	pth_event_free

loc_40438E:				; CODE XREF: sub_404046+333j
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+var_B8], eax
		call	pth_attr_destroy
		call	sub_403566
		mov	[esp+0B8h+var_B8], 0Dh
		call	sub_425424
		mov	ebx, eax
		mov	[esp+0B8h+var_B8], 0Bh
		call	sub_425424
		mov	[esp+0B8h+var_B0], ebx
		mov	dword ptr [esp+0B8h+var_B4], eax ; char
		mov	[esp+0B8h+var_B8], offset aSSStopped ; "%s %s stopped\n"
		call	sub_423387
		add	esp, 0B4h
		pop	ebx
		pop	ebp
		retn
sub_404046	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4043D8	proc near		; CODE XREF: sub_4043FF+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4043F8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4043FD
; ---------------------------------------------------------------------------

loc_4043F8:				; CODE XREF: sub_4043D8+7j
		mov	eax, 0

loc_4043FD:				; CODE XREF: sub_4043D8+1Ej
		pop	ebp
		retn
sub_4043D8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4043FF	proc near		; CODE XREF: sub_404427+14p
					; sub_404442+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_4043D8
		leave
		retn
sub_4043FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40441A	proc near		; CODE XREF: sub_405484+152p
					; sub_4059C0+193p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_40441A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404427	proc near		; CODE XREF: sub_4059C0+DDp

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_4043FF
		leave
		retn
sub_404427	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404442	proc near		; CODE XREF: sub_406036+117p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_4043FF
		leave
		retn
sub_404442	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404457	proc near		; CODE XREF: sub_4044C4+31p
					; sub_4059C0+4C5p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_404472
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx

loc_404472:				; CODE XREF: sub_404457+Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40449C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40449C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 1
		mov	edx, ds:dword_436010
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx

loc_40449C:				; CODE XREF: sub_404457+23j
					; sub_404457+2Dj
		pop	ebp
		retn
sub_404457	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40449E	proc near		; CODE XREF: sub_4044C4+46p
					; sub_4059C0+4D6p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 1
		jnz	short loc_4044BD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_4044BD
		mov	eax, 1
		jmp	short loc_4044C2
; ---------------------------------------------------------------------------

loc_4044BD:				; CODE XREF: sub_40449E+Cj
					; sub_40449E+16j
		mov	eax, 0

loc_4044C2:				; CODE XREF: sub_40449E+1Dj
		pop	ebp
		retn
sub_40449E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4044C4	proc near		; CODE XREF: sub_4059C0+1F9p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	sub_404515
		mov	edx, [ebp+arg_0]
		mov	[edx+8], eax
		jmp	short loc_4044FA
; ---------------------------------------------------------------------------

loc_4044EF:				; CODE XREF: sub_4044C4+4Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_404457

loc_4044FA:				; CODE XREF: sub_4044C4+29j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_404513
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40449E
		test	eax, eax
		jz	short loc_4044EF

locret_404513:				; CODE XREF: sub_4044C4+3Ej
		leave
		retn
sub_4044C4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404515	proc near		; CODE XREF: sub_4044C4+1Ep
					; sub_410BE0+1Ep

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_404533
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_404533
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	eax, [eax+4]
		jmp	short loc_404538
; ---------------------------------------------------------------------------

loc_404533:				; CODE XREF: sub_404515+7j
					; sub_404515+11j
		mov	eax, 0

loc_404538:				; CODE XREF: sub_404515+1Cj
		pop	ebp
		retn
sub_404515	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40453A	proc near		; CODE XREF: sub_4059C0+111p
					; sub_406036+12Ep

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	loc_404643
; ---------------------------------------------------------------------------

loc_404542:				; CODE XREF: sub_40453A+111j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_404614
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_404614
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_404614
		add	[ebp+arg_4], 1
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_404593
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4045BF
; ---------------------------------------------------------------------------

loc_404593:				; CODE XREF: sub_40453A+44j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_4045AE
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4045BD
; ---------------------------------------------------------------------------

loc_4045AE:				; CODE XREF: sub_40453A+61j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4045BD:				; CODE XREF: sub_40453A+72j
		mov	edx, eax

loc_4045BF:				; CODE XREF: sub_40453A+57j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_4045DA
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_404601
; ---------------------------------------------------------------------------

loc_4045DA:				; CODE XREF: sub_40453A+90j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_4045F5
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_404601
; ---------------------------------------------------------------------------

loc_4045F5:				; CODE XREF: sub_40453A+ABj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_404601:				; CODE XREF: sub_40453A+9Ej
					; sub_40453A+B9j
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 2
		jmp	short loc_404643
; ---------------------------------------------------------------------------

loc_404614:				; CODE XREF: sub_40453A+10j
					; sub_40453A+21j ...
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_40462E
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	20h
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_404643
; ---------------------------------------------------------------------------

loc_40462E:				; CODE XREF: sub_40453A+E2j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_404643:				; CODE XREF: sub_40453A+3j
					; sub_40453A+D8j ...
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_404542
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		pop	ebp
		retn
sub_40453A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404659(char *, char *)
sub_404659	proc near		; CODE XREF: sub_405080+31p
					; sub_405080+47p ...

Str		= dword	ptr -38h
SubStr		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+SubStr], eax ;	SubStr
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4046ED
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_0]
		jz	short loc_4046BF
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4046BF
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4046ED

loc_4046BF:				; CODE XREF: sub_404659+4Aj
					; sub_404659+57j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4046E6
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4046E6
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4046ED

loc_4046E6:				; CODE XREF: sub_404659+71j
					; sub_404659+7Ej
		mov	eax, 1
		jmp	short loc_4046F2
; ---------------------------------------------------------------------------

loc_4046ED:				; CODE XREF: sub_404659+42j
					; sub_404659+64j ...
		mov	eax, 0

loc_4046F2:				; CODE XREF: sub_404659+92j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_404659	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4046F8(int, char *)
sub_4046F8	proc near		; CODE XREF: sub_405F38+14p
					; sub_405F38+2Ap ...

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40473D
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40473D
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40473D
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40473D
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_404747

loc_40473D:				; CODE XREF: sub_4046F8+Fj
					; sub_4046F8+1Cj ...
		mov	eax, 0
		jmp	loc_404805
; ---------------------------------------------------------------------------

loc_404747:				; CODE XREF: sub_4046F8+43j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_4047E5
; ---------------------------------------------------------------------------

loc_40476B:				; CODE XREF: sub_4046F8+102j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		jmp	short loc_404777
; ---------------------------------------------------------------------------

loc_404773:				; CODE XREF: sub_4046F8+9Bj
		add	[ebp+arg_0], 1

loc_404777:				; CODE XREF: sub_4046F8+79j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404795
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_404795
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_404773

loc_404795:				; CODE XREF: sub_4046F8+87j
					; sub_4046F8+91j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_C]
		jnz	short loc_4047D0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+MaxCount], eax	; MaxCount
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str2],	eax ; Str2
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_4047D0
		mov	eax, 1
		jmp	short loc_404805
; ---------------------------------------------------------------------------

loc_4047CA:				; CODE XREF: sub_4046F8+E1j
					; sub_4046F8+EBj
		add	[ebp+arg_0], 1
		jmp	short loc_4047D1
; ---------------------------------------------------------------------------

loc_4047D0:				; CODE XREF: sub_4046F8+ACj
					; sub_4046F8+C9j
		nop

loc_4047D1:				; CODE XREF: sub_4046F8+D6j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4047CA
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4047CA

loc_4047E5:				; CODE XREF: sub_4046F8+71j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_404800
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	loc_40476B

loc_404800:				; CODE XREF: sub_4046F8+F5j
		mov	eax, 0

loc_404805:				; CODE XREF: sub_4046F8+4Aj
					; sub_4046F8+D0j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4046F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40480B	proc near		; CODE XREF: sub_405080+55p
					; sub_405654+30p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		jmp	short loc_404852
; ---------------------------------------------------------------------------

loc_404810:				; CODE XREF: sub_40480B+28j
		add	[ebp+arg_0], 1
		jmp	short loc_404817
; ---------------------------------------------------------------------------

loc_404816:				; CODE XREF: sub_40480B+5Cj
		nop

loc_404817:				; CODE XREF: sub_40480B+9j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40483D
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40483D
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_404810
		jmp	short loc_40483D
; ---------------------------------------------------------------------------

loc_404837:				; CODE XREF: sub_40480B+3Bj
					; sub_40480B+45j
		add	[ebp+arg_0], 1
		jmp	short loc_40483E
; ---------------------------------------------------------------------------

loc_40483D:				; CODE XREF: sub_40480B+14j
					; sub_40480B+1Ej ...
		nop

loc_40483E:				; CODE XREF: sub_40480B+30j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_404837
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_404837

loc_404852:				; CODE XREF: sub_40480B+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_404869
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_404816

loc_404869:				; CODE XREF: sub_40480B+4Fj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_40480B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40486E(int, char *, char)
sub_40486E	proc near		; CODE XREF: sub_4049E3+53p
					; sub_404A3D+53p

Dest		= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		cmp	[ebp+arg_4], 0
		jz	short loc_4048F5
		mov	eax, dword ptr [ebp+arg_8]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 2
		mov	[esp+58h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_C], eax
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+58h+Source], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Dest],	eax
		call	sub_4265EB
		mov	word ptr [eax],	20h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Source], eax ;	Source
		mov	[esp+58h+Dest],	edx ; Dest
		call	strcpy
		jmp	short loc_404903
; ---------------------------------------------------------------------------

loc_4048F5:				; CODE XREF: sub_40486E+Cj
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+58h+Dest],	eax
		call	gcry_xstrdup
		mov	[ebp+var_C], eax

loc_404903:				; CODE XREF: sub_40486E+85j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	[esp+58h+var_48], 2000h
		lea	edx, [ebp+var_18]
		mov	[esp+58h+var_4C], edx
		lea	edx, [ebp+var_14]
		mov	[esp+58h+var_50], edx
		mov	edx, [ebp+var_C]
		mov	[esp+58h+Source], edx
		mov	[esp+58h+Dest],	eax
		call	assuan_inquire
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		cmp	[ebp+var_10], 0
		jz	short loc_40496D
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Dest],	eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+Dest],	offset aAssuan_inquire ; "assuan_inquire(%s) failed: %s\n"
		call	sub_4233B1
		mov	eax, 0
		jmp	short loc_4049DC
; ---------------------------------------------------------------------------

loc_40496D:				; CODE XREF: sub_40486E+D4j
		mov	eax, [ebp+var_18]
		test	eax, eax
		jnz	short loc_404986
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_4049DC
; ---------------------------------------------------------------------------

loc_404986:				; CODE XREF: sub_40486E+104j
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+Dest],	eax
		call	ksba_cert_new
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4049CE
		mov	ecx, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], ecx
		mov	[esp+58h+Source], edx
		mov	[esp+58h+Dest],	eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4049CE
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Dest],	eax
		call	ksba_cert_release
		mov	[ebp+var_1C], 0

loc_4049CE:				; CODE XREF: sub_40486E+12Aj
					; sub_40486E+14Cj
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_1C]

loc_4049DC:				; CODE XREF: sub_40486E+FDj
					; sub_40486E+116j
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40486E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4049E3(int, char *)
sub_4049E3	proc near		; CODE XREF: sub_40E092+133p
					; sub_40E3E4+26Dp ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_404A05
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_404A05
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404A21

loc_404A05:				; CODE XREF: sub_4049E3+Aj
					; sub_4049E3+14j
		mov	eax, ds:dword_435FA0
		test	eax, eax
		jz	short loc_404A1A
		mov	[esp+18h+var_18], offset aGet_cert_local ; "get_cert_local called w/o context\n"
		call	sub_42344E

loc_404A1A:				; CODE XREF: sub_4049E3+29j
		mov	eax, 0
		jmp	short locret_404A3B
; ---------------------------------------------------------------------------

loc_404A21:				; CODE XREF: sub_4049E3+20j
		mov	dword ptr [esp+18h+var_10], offset aSendcert ; "SENDCERT"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_40486E

locret_404A3B:				; CODE XREF: sub_4049E3+3Cj
		leave
		retn
sub_4049E3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404A3D(int, char *)
sub_404A3D	proc near		; CODE XREF: sub_418114+DEp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_404A5F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_404A5F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404A7B

loc_404A5F:				; CODE XREF: sub_404A3D+Aj
					; sub_404A3D+14j
		mov	eax, ds:dword_435FA0
		test	eax, eax
		jz	short loc_404A74
		mov	[esp+18h+var_18], offset aGet_issuing_ce ; "get_issuing_cert_local called w/o conte"...
		call	sub_42344E

loc_404A74:				; CODE XREF: sub_404A3D+29j
		mov	eax, 0
		jmp	short locret_404A95
; ---------------------------------------------------------------------------

loc_404A7B:				; CODE XREF: sub_404A3D+20j
		mov	dword ptr [esp+18h+var_10], offset aSendissuercert ; "SENDISSUERCERT"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_40486E

locret_404A95:				; CODE XREF: sub_404A3D+3Cj
		leave
		retn
sub_404A3D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404A97(int, char *, int)
sub_404A97	proc near		; CODE XREF: sub_40E3E4+1D8p

Dest		= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		cmp	[ebp+arg_0], 0
		jz	short loc_404ABB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_404ABB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404ADA

loc_404ABB:				; CODE XREF: sub_404A97+Cj
					; sub_404A97+16j
		mov	eax, ds:dword_435FA0
		test	eax, eax
		jz	short loc_404AD0
		mov	[esp+58h+Dest],	offset aGet_cert_loc_0 ; "get_cert_local_ski called w/o	context\n"
		call	sub_42344E

loc_404AD0:				; CODE XREF: sub_404A97+2Bj
		mov	eax, 0
		jmp	loc_404CE2
; ---------------------------------------------------------------------------

loc_404ADA:				; CODE XREF: sub_404A97+22j
		cmp	[ebp+arg_4], 0
		jz	short loc_404AE6
		cmp	[ebp+arg_8], 0
		jnz	short loc_404AFC

loc_404AE6:				; CODE XREF: sub_404A97+47j
		mov	[esp+58h+Dest],	offset aGet_cert_loc_1 ; "get_cert_local_ski called with insuffic"...
		call	sub_42344E
		mov	eax, 0
		jmp	loc_404CE2
; ---------------------------------------------------------------------------

loc_404AFC:				; CODE XREF: sub_404A97+4Dj
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Dest],	eax
		call	sub_41644D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404B26
		mov	[esp+58h+Dest],	offset aSerial_hexFail ; "serial_hex() failed\n"
		call	sub_42344E
		mov	eax, 0
		jmp	loc_404CE2
; ---------------------------------------------------------------------------

loc_404B26:				; CODE XREF: sub_404A97+77j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[esp+58h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_404BB0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Dest],	eax ; int
		call	strerror
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+Dest],	offset aCanTAllocateEn ; "can't allocate enough memory: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_404CE2
; ---------------------------------------------------------------------------

loc_404BB0:				; CODE XREF: sub_404A97+E1j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 444E4553h
		mov	dword ptr [eax+4], 54524543h
		mov	dword ptr [eax+8], 494B535Fh
		mov	word ptr [eax+0Ch], 20h
		mov	eax, [ebp+var_10]
		lea	edx, [eax+0Dh]
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Source], eax
		mov	[esp+58h+Dest],	edx
		call	sub_4265EB
		mov	word ptr [eax],	2F20h
		mov	byte ptr [eax+2], 0
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Source], eax ;	Source
		mov	[esp+58h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	[esp+58h+var_48], 2000h
		lea	edx, [ebp+var_1C]
		mov	[esp+58h+var_4C], edx
		lea	edx, [ebp+var_18]
		mov	[esp+58h+var_50], edx
		mov	edx, [ebp+var_10]
		mov	[esp+58h+Source], edx
		mov	[esp+58h+Dest],	eax
		call	assuan_inquire
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		cmp	[ebp+var_14], 0
		jz	short loc_404C73
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dest],	eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Source], offset aSendcert_ski ; "SENDCERT_SKI"
		mov	[esp+58h+Dest],	offset aAssuan_inquire ; "assuan_inquire(%s) failed: %s\n"
		call	sub_4233B1
		mov	eax, 0
		jmp	short loc_404CE2
; ---------------------------------------------------------------------------

loc_404C73:				; CODE XREF: sub_404A97+1B0j
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jnz	short loc_404C8C
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_404CE2
; ---------------------------------------------------------------------------

loc_404C8C:				; CODE XREF: sub_404A97+1E1j
		lea	eax, [ebp+var_20]
		mov	[esp+58h+Dest],	eax
		call	ksba_cert_new
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_404CD4
		mov	ecx, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_50], ecx
		mov	[esp+58h+Source], edx
		mov	[esp+58h+Dest],	eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_404CD4
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dest],	eax
		call	ksba_cert_release
		mov	[ebp+var_20], 0

loc_404CD4:				; CODE XREF: sub_404A97+207j
					; sub_404A97+229j
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]

loc_404CE2:				; CODE XREF: sub_404A97+3Ej
					; sub_404A97+60j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_404A97	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404CE9	proc near		; CODE XREF: sub_408DFB+36Ap

var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= byte ptr -8Ch
var_88		= dword	ptr -88h
var_78		= byte ptr -78h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		cmp	[ebp+arg_0], 0
		jz	short loc_404D14
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_404D14
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_404D14
		cmp	dword ptr [ebp+arg_4], 0
		jnz	short loc_404D25

loc_404D14:				; CODE XREF: sub_404CE9+Dj
					; sub_404CE9+17j ...
		mov	[esp+98h+var_98], 2Dh
		call	sub_4043FF
		jmp	locret_404DFE
; ---------------------------------------------------------------------------

loc_404D25:				; CODE XREF: sub_404CE9+29j
		mov	eax, offset aIstrustedS	; "ISTRUSTED %s"
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+98h+var_8C], edx	; char
		mov	[esp+98h+var_90], eax ;	char *
		mov	[esp+98h+var_94], 64h ;	size_t
		lea	eax, [ebp+var_78]
		mov	[esp+98h+var_98], eax ;	char *
		call	sub_429570
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	[esp+98h+var_88], 64h
		lea	edx, [ebp+var_14]
		mov	dword ptr [esp+98h+var_8C], edx
		lea	edx, [ebp+var_10]
		mov	[esp+98h+var_90], edx
		lea	edx, [ebp+var_78]
		mov	[esp+98h+var_94], edx
		mov	[esp+98h+var_98], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404DA5
		mov	eax, [ebp+var_C]
		mov	[esp+98h+var_98], eax
		call	gpg_strerror
		mov	[esp+98h+var_90], eax
		lea	eax, [ebp+var_78]
		mov	[esp+98h+var_94], eax ;	char
		mov	[esp+98h+var_98], offset aAssuan_inquire ; "assuan_inquire(%s) failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		jmp	short locret_404DFE
; ---------------------------------------------------------------------------

loc_404DA5:				; CODE XREF: sub_404CE9+93j
		mov	eax, [ebp+var_14]
		test	eax, eax
		jz	short loc_404DE1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 31h
		jnz	short loc_404DE1
		mov	eax, [ebp+var_14]
		cmp	eax, 1
		jz	short loc_404DD8
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_404DD8
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_404DE1

loc_404DD8:				; CODE XREF: sub_404CE9+D3j
					; sub_404CE9+E0j
		mov	[ebp+var_C], 0
		jmp	short loc_404DF0
; ---------------------------------------------------------------------------

loc_404DE1:				; CODE XREF: sub_404CE9+C1j
					; sub_404CE9+CBj ...
		mov	[esp+98h+var_98], 62h
		call	sub_4043FF
		mov	[ebp+var_C], eax

loc_404DF0:				; CODE XREF: sub_404CE9+F6j
		mov	eax, [ebp+var_10]
		mov	[esp+98h+var_98], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

locret_404DFE:				; CODE XREF: sub_404CE9+37j
					; sub_404CE9+BAj
		leave
		retn
sub_404CE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404E00	proc near		; CODE XREF: sub_405080+1EDp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 0
		mov	[esp+48h+var_38], 0
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], offset aSendcert ; "SENDCERT"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404E5C
		mov	eax, [ebp+var_C]
		jmp	locret_404EED
; ---------------------------------------------------------------------------

loc_404E5C:				; CODE XREF: sub_404E00+52j
		mov	eax, [ebp+var_18]
		test	eax, eax
		jnz	short loc_404E71
		mov	[esp+48h+var_48], 39h
		call	sub_4043FF
		jmp	short locret_404EED
; ---------------------------------------------------------------------------

loc_404E71:				; CODE XREF: sub_404E00+61j
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404ED0
		mov	ecx, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], ecx
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404ED3
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_40B296
		mov	[ebp+var_C], eax
		jmp	short loc_404ED4
; ---------------------------------------------------------------------------

loc_404ED0:				; CODE XREF: sub_404E00+83j
		nop
		jmp	short loc_404ED4
; ---------------------------------------------------------------------------

loc_404ED3:				; CODE XREF: sub_404E00+A5j
		nop

loc_404ED4:				; CODE XREF: sub_404E00+CEj
					; sub_404E00+D1j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

locret_404EED:				; CODE XREF: sub_404E00+57j
					; sub_404E00+6Fj
		leave
		retn
sub_404E00	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404EEF(int, int, char	*)
sub_404EEF	proc near		; DATA XREF: sub_406596+289o

Str		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aForceCrlRefres ; "force-crl-refresh"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_404F57
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404F44
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	atoi
		jmp	short loc_404F49
; ---------------------------------------------------------------------------

loc_404F44:				; CODE XREF: sub_404EEF+46j
		mov	eax, 0

loc_404F49:				; CODE XREF: sub_404EEF+53j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+10h], edx
		jmp	short loc_404FB7
; ---------------------------------------------------------------------------

loc_404F57:				; CODE XREF: sub_404EEF+3Cj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aAuditEvents ; "audit-events"
		mov	ecx, 0Dh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_404FA9
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404F96
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	atoi
		jmp	short loc_404F9B
; ---------------------------------------------------------------------------

loc_404F96:				; CODE XREF: sub_404EEF+98j
		mov	eax, 0

loc_404F9B:				; CODE XREF: sub_404EEF+A5j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		mov	[eax+1Ch], edx
		jmp	short loc_404FB7
; ---------------------------------------------------------------------------

loc_404FA9:				; CODE XREF: sub_404EEF+8Ej
		mov	[esp+28h+Str], 0AEh
		call	sub_4043FF
		jmp	short loc_404FBC
; ---------------------------------------------------------------------------

loc_404FB7:				; CODE XREF: sub_404EEF+66j
					; sub_404EEF+B8j
		mov	eax, 0

loc_404FBC:				; CODE XREF: sub_404EEF+C6j
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_404EEF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404FC3	proc near		; DATA XREF: .data:0042B3A4o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		jmp	short loc_404FDD
; ---------------------------------------------------------------------------

loc_404FD9:				; CODE XREF: sub_404FC3+22j
					; sub_404FC3+2Cj
		add	[ebp+arg_4], 1

loc_404FDD:				; CODE XREF: sub_404FC3+14j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_404FD9
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_404FD9
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405020
		mov	[esp+28h+var_28], 118h
		call	sub_4043FF
		mov	[esp+28h+var_20], offset aLdapserverMiss ; "ldapserver missing"
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_set_error
		jmp	short locret_40507E
; ---------------------------------------------------------------------------

loc_405020:				; CODE XREF: sub_404FC3+36j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset word_42D2C2
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_40C2F3
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_405052
		mov	[esp+28h+var_28], 2Dh
		call	sub_4043FF
		jmp	short locret_40507E
; ---------------------------------------------------------------------------

loc_405052:				; CODE XREF: sub_404FC3+7Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		add	eax, 4
		mov	[ebp+var_C], eax
		jmp	short loc_405068
; ---------------------------------------------------------------------------

loc_405060:				; CODE XREF: sub_404FC3+ACj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_405068:				; CODE XREF: sub_404FC3+9Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_405060
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0

locret_40507E:				; CODE XREF: sub_404FC3+5Bj
					; sub_404FC3+8Dj
		leave
		retn
sub_404FC3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405080(int, char *)
sub_405080	proc near		; DATA XREF: .data:0042B3B0o

Str		= dword	ptr -58h
Val		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[esp+58h+Val], offset aOnlyOcsp	; "--only-ocsp"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; char *
		call	sub_404659
		mov	[ebp+var_20], eax
		mov	[esp+58h+Val], offset aForceDefaultRe ;	"--force-default-responder"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; char *
		call	sub_404659
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax
		call	sub_40480B
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax
		call	gcry_xstrdup
		mov	[ebp+var_28], eax
		mov	[esp+58h+Val], 2Eh ; Val
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405116
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		jmp	loc_405196
; ---------------------------------------------------------------------------

loc_405116:				; CODE XREF: sub_405080+85j
		mov	[esp+58h+Val], 20h ; Val
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_405138
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0

loc_405138:				; CODE XREF: sub_405080+B0j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 28h
		jz	short loc_40518F
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	[esp+58h+Str], 118h
		call	sub_4043FF
		mov	[esp+58h+var_50], offset aSerialnoMissin ; "serialno missing in	cert ID"
		mov	[esp+58h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	assuan_set_error
		jmp	loc_4052DC
; ---------------------------------------------------------------------------

loc_40518F:				; CODE XREF: sub_405080+DAj
		mov	[ebp+var_18], 1

loc_405196:				; CODE XREF: sub_405080+91j
					; sub_405080+202j
		cmp	[ebp+var_18], 0
		jz	short loc_4051E3
		mov	eax, ds:dword_436004
		test	eax, eax
		jnz	short loc_4051B9
		mov	[esp+58h+Str], 3Ch
		call	sub_4043FF
		mov	[ebp+var_10], eax
		jmp	loc_4052A5
; ---------------------------------------------------------------------------

loc_4051B9:				; CODE XREF: sub_405080+123j
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_4C], eax ;	int
		mov	[esp+58h+var_50], 0 ; char *
		mov	[esp+58h+Val], 0 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax ; int
		call	sub_418114
		mov	[ebp+var_10], eax
		jmp	loc_4052A5
; ---------------------------------------------------------------------------

loc_4051E3:				; CODE XREF: sub_405080+11Aj
		cmp	[ebp+var_20], 0
		jz	short loc_4051FD
		mov	[esp+58h+Str], 5Fh
		call	sub_4043FF
		mov	[ebp+var_10], eax
		jmp	loc_4052A5
; ---------------------------------------------------------------------------

loc_4051FD:				; CODE XREF: sub_405080+167j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		mov	[esp+58h+var_4C], eax ;	int
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_50], eax ;	int
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Val], eax ; char
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax ; int
		call	sub_4091A1
		cmp	eax, 1
		jz	short loc_40523F
		cmp	eax, 1
		jb	short loc_405236
		cmp	eax, 2
		jz	short loc_405250
		cmp	eax, 3
		jz	short loc_405287
		jmp	short loc_405298
; ---------------------------------------------------------------------------

loc_405236:				; CODE XREF: sub_405080+1A8j
		mov	[ebp+var_10], 0
		jmp	short loc_4052A5
; ---------------------------------------------------------------------------

loc_40523F:				; CODE XREF: sub_405080+1A3j
		mov	[esp+58h+Str], 5Eh
		call	sub_4043FF
		mov	[ebp+var_10], eax
		jmp	short loc_4052A5
; ---------------------------------------------------------------------------

loc_405250:				; CODE XREF: sub_405080+1ADj
		cmp	[ebp+var_14], 0
		jz	short loc_405267
		mov	[esp+58h+Str], 5Fh
		call	sub_4043FF
		mov	[ebp+var_10], eax
		jmp	short loc_4052A4
; ---------------------------------------------------------------------------

loc_405267:				; CODE XREF: sub_405080+1D4j
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	sub_404E00
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4052A4
		mov	[ebp+var_14], 1
		jmp	loc_405196
; ---------------------------------------------------------------------------

loc_405287:				; CODE XREF: sub_405080+1B2j
		mov	[esp+58h+Str], 5Fh
		call	sub_4043FF
		mov	[ebp+var_10], eax
		jmp	short loc_4052A5
; ---------------------------------------------------------------------------

loc_405298:				; CODE XREF: sub_405080+1B4j
		mov	[esp+58h+Str], offset aCrl_cache_isva ;	"crl_cache_isvalid returned invalid code"...
		call	sub_4233F4
; ---------------------------------------------------------------------------

loc_4052A4:				; CODE XREF: sub_405080+1E5j
					; sub_405080+1F9j
		nop

loc_4052A5:				; CODE XREF: sub_405080+134j
					; sub_405080+15Ej ...
		cmp	[ebp+var_10], 0
		jz	short loc_4052CE
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Str], eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Val], offset aIsvalid ; "ISVALID"
		mov	[esp+58h+Str], offset aCommandSFailed ;	"command %s failed: %s\n"
		call	sub_4233B1

loc_4052CE:				; CODE XREF: sub_405080+229j
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_10]

loc_4052DC:				; CODE XREF: sub_405080+10Aj
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_405080	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4052E2	proc near		; CODE XREF: sub_405484+21p
					; sub_405654+45p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	[ebp+var_8], 0
		jmp	loc_40545A
; ---------------------------------------------------------------------------

loc_4052FA:				; CODE XREF: sub_4052E2+18Aj
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40530E
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40533E

loc_40530E:				; CODE XREF: sub_4052E2+20j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_405322
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40533E

loc_405322:				; CODE XREF: sub_4052E2+34j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_405445
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_405445

loc_40533E:				; CODE XREF: sub_4052E2+2Aj
					; sub_4052E2+3Ej
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_405358
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_405394

loc_405358:				; CODE XREF: sub_4052E2+67j
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_405372
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_405394

loc_405372:				; CODE XREF: sub_4052E2+81j
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_405445
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_405445

loc_405394:				; CODE XREF: sub_4052E2+74j
					; sub_4052E2+8Ej
		cmp	[ebp+var_8], 13h
		jle	short loc_4053A4
		mov	eax, 0
		jmp	locret_405482
; ---------------------------------------------------------------------------

loc_4053A4:				; CODE XREF: sub_4052E2+B6j
		mov	eax, [ebp+var_8]
		mov	ecx, eax
		add	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4053C9
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4053F5
; ---------------------------------------------------------------------------

loc_4053C9:				; CODE XREF: sub_4052E2+D2j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4053E4
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4053F3
; ---------------------------------------------------------------------------

loc_4053E4:				; CODE XREF: sub_4052E2+EFj
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4053F3:				; CODE XREF: sub_4052E2+100j
		mov	edx, eax

loc_4053F5:				; CODE XREF: sub_4052E2+E5j
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_405410
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_405437
; ---------------------------------------------------------------------------

loc_405410:				; CODE XREF: sub_4052E2+11Ej
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40542B
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_405437
; ---------------------------------------------------------------------------

loc_40542B:				; CODE XREF: sub_4052E2+139j
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_405437:				; CODE XREF: sub_4052E2+12Cj
					; sub_4052E2+147j
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_8], 1
		add	[ebp+var_4], 1
		jmp	short loc_405456
; ---------------------------------------------------------------------------

loc_405445:				; CODE XREF: sub_4052E2+48j
					; sub_4052E2+56j ...
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_405456
		mov	eax, 0
		jmp	short locret_405482
; ---------------------------------------------------------------------------

loc_405456:				; CODE XREF: sub_4052E2+161j
					; sub_4052E2+16Bj
		add	[ebp+var_4], 1

loc_40545A:				; CODE XREF: sub_4052E2+13j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405472
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	loc_4052FA

loc_405472:				; CODE XREF: sub_4052E2+180j
		cmp	[ebp+var_8], 14h
		jz	short loc_40547F
		mov	eax, 0
		jmp	short locret_405482
; ---------------------------------------------------------------------------

loc_40547F:				; CODE XREF: sub_4052E2+194j
		mov	eax, [ebp+arg_4]

locret_405482:				; CODE XREF: sub_4052E2+BDj
					; sub_4052E2+172j ...
		leave
		retn
sub_4052E2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405484	proc near		; DATA XREF: .data:0042B3BCo

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_4052E2
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4054C0
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax ;	void *
		call	sub_40D39E
		jmp	short loc_4054C5
; ---------------------------------------------------------------------------

loc_4054C0:				; CODE XREF: sub_405484+2Dj
		mov	eax, 0

loc_4054C5:				; CODE XREF: sub_405484+3Aj
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	loc_40558E
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	[esp+58h+var_48], 2000h
		lea	edx, [ebp+var_34]
		mov	[esp+58h+var_4C], edx
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], offset aTargetcert ; "TARGETCERT"
		mov	[esp+58h+var_58], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405531
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aAssuan_inqui_0 ; "assuan_inquire failed: %s\n"
		call	sub_4233B1
		jmp	loc_40561B
; ---------------------------------------------------------------------------

loc_405531:				; CODE XREF: sub_405484+8Bj
		mov	eax, [ebp+var_34]
		test	eax, eax
		jnz	short loc_405549
		mov	[esp+58h+var_58], 39h
		call	sub_4043FF
		mov	[ebp+var_C], eax
		jmp	short loc_405579
; ---------------------------------------------------------------------------

loc_405549:				; CODE XREF: sub_405484+B2j
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405579
		mov	ecx, [ebp+var_34]
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], ecx
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_C], eax

loc_405579:				; CODE XREF: sub_405484+C3j
					; sub_405484+D7j
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	loc_40561A

loc_40558E:				; CODE XREF: sub_405484+49j
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_4055B1
		mov	[esp+58h+var_50], 2A8h ; int
		mov	[esp+58h+var_54], offset a____Dirmngr1_1 ; "../../dirmngr-1.1.1/src/server.c"
		mov	[esp+58h+var_58], offset aCert ; "cert"
		call	sub_429780

loc_4055B1:				; CODE XREF: sub_405484+10Fj
		mov	eax, [ebp+var_10]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_409253
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_40441A
		cmp	eax, 5Fh
		jnz	short loc_40561B
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_40B296
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40561B
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_409253
		mov	[ebp+var_C], eax
		jmp	short loc_40561B
; ---------------------------------------------------------------------------

loc_40561A:				; CODE XREF: sub_405484+104j
		nop

loc_40561B:				; CODE XREF: sub_405484+A8j
					; sub_405484+15Aj ...
		cmp	[ebp+var_C], 0
		jz	short loc_405644
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], offset aCheckcrl ; "CHECKCRL"
		mov	[esp+58h+var_58], offset aCommandSFailed ; "command %s failed: %s\n"
		call	sub_4233B1

loc_405644:				; CODE XREF: sub_405484+19Bj
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405484	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405654(int, char *)
sub_405654	proc near		; DATA XREF: .data:0042B3C8o

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[esp+58h+var_54], offset aForceDefaultRe ; "--force-default-responder"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_404659
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_40480B
		mov	[ebp+arg_4], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_4052E2
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4056B4
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax ;	void *
		call	sub_40D39E
		jmp	short loc_4056B9
; ---------------------------------------------------------------------------

loc_4056B4:				; CODE XREF: sub_405654+51j
		mov	eax, 0

loc_4056B9:				; CODE XREF: sub_405654+5Ej
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	loc_40577E
		mov	[ebp+var_34], 0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	[esp+58h+var_48], 2000h
		lea	edx, [ebp+var_38]
		mov	[esp+58h+var_4C], edx
		lea	edx, [ebp+var_34]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], offset aTargetcert ; "TARGETCERT"
		mov	[esp+58h+var_58], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405725
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aAssuan_inqui_0 ; "assuan_inquire failed: %s\n"
		call	sub_4233B1
		jmp	loc_4057E2
; ---------------------------------------------------------------------------

loc_405725:				; CODE XREF: sub_405654+AFj
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_40573D
		mov	[esp+58h+var_58], 39h
		call	sub_4043FF
		mov	[ebp+var_C], eax
		jmp	short loc_40576D
; ---------------------------------------------------------------------------

loc_40573D:				; CODE XREF: sub_405654+D6j
		lea	eax, [ebp+var_30]
		mov	[esp+58h+var_58], eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40576D
		mov	ecx, [ebp+var_38]
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_50], ecx
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_C], eax

loc_40576D:				; CODE XREF: sub_405654+E7j
					; sub_405654+FBj
		mov	eax, [ebp+var_34]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_4057E1

loc_40577E:				; CODE XREF: sub_405654+6Dj
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_4057A1
		mov	[esp+58h+var_50], 300h ; int
		mov	[esp+58h+var_54], offset a____Dirmngr1_1 ; "../../dirmngr-1.1.1/src/server.c"
		mov	[esp+58h+var_58], offset aCert ; "cert"
		call	sub_429780

loc_4057A1:				; CODE XREF: sub_405654+12Fj
		mov	eax, ds:dword_436004
		test	eax, eax
		jnz	short loc_4057BB
		mov	[esp+58h+var_58], 3Ch
		call	sub_4043FF
		mov	[ebp+var_C], eax
		jmp	short loc_4057E2
; ---------------------------------------------------------------------------

loc_4057BB:				; CODE XREF: sub_405654+154j
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_14]
		mov	[esp+58h+var_4C], edx ;	int
		mov	[esp+58h+var_50], 0 ; char *
		mov	[esp+58h+var_54], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_418114
		mov	[ebp+var_C], eax
		jmp	short loc_4057E2
; ---------------------------------------------------------------------------

loc_4057E1:				; CODE XREF: sub_405654+128j
		nop

loc_4057E2:				; CODE XREF: sub_405654+CCj
					; sub_405654+165j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40580B
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], offset aCheckocsp ; "CHECKOCSP"
		mov	[esp+58h+var_58], offset aCommandSFailed ; "command %s failed: %s\n"
		call	sub_4233B1

loc_40580B:				; CODE XREF: sub_405654+192j
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_58], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405654	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40581B	proc near		; CODE XREF: sub_405F38+A3p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_40C08C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405883
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFetch_cert_by_ ; "fetch_cert_by_url failed: %s\n"
		call	sub_4233B1
		jmp	short loc_405901
; ---------------------------------------------------------------------------

loc_405883:				; CODE XREF: sub_40581B+49j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], edx
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4058C3
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax

loc_4058C3:				; CODE XREF: sub_40581B+88j
		cmp	[ebp+var_C], 0
		jnz	short loc_4058DF
		mov	dword ptr [esp+28h+var_24], offset aEnd	; "END"
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_write_line
		mov	[ebp+var_C], eax

loc_4058DF:				; CODE XREF: sub_40581B+ACj
		cmp	[ebp+var_C], 0
		jz	short loc_405901
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorSendingDa ; "error sending data:	%s\n"
		call	sub_4233B1
		nop

loc_405901:				; CODE XREF: sub_40581B+66j
					; sub_40581B+C8j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40581B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405906	proc near		; DATA XREF: sub_4059C0+160o

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		lea	eax, [ebp+var_18]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_get_image
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40593E
		mov	[esp+28h+var_28], 0A4h
		call	sub_4043FF
		mov	[ebp+var_C], eax
		jmp	short loc_40599A
; ---------------------------------------------------------------------------

loc_40593E:				; CODE XREF: sub_405906+25j
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+var_14]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40597E
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax

loc_40597E:				; CODE XREF: sub_405906+58j
		cmp	[ebp+var_C], 0
		jnz	short loc_40599A
		mov	dword ptr [esp+28h+var_24], offset aEnd	; "END"
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	assuan_write_line
		mov	[ebp+var_C], eax

loc_40599A:				; CODE XREF: sub_405906+36j
					; sub_405906+7Cj
		cmp	[ebp+var_C], 0
		jz	short loc_4059BB
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorSendingDa ; "error sending data:	%s\n"
		call	sub_4233B1

loc_4059BB:				; CODE XREF: sub_405906+98j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405906	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4059C0	proc near		; CODE XREF: sub_405F38+C8p

Dest		= dword	ptr -0A8h
Format		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_8C		= dword	ptr -8Ch
var_7E		= byte ptr -7Eh
var_4C		= byte ptr -4Ch
var_48		= byte ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0A4h
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Dest], eax
		call	assuan_get_pointer
		mov	[ebp+var_30], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_38], 0
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	loc_405AEA
; ---------------------------------------------------------------------------

loc_405A1B:				; CODE XREF: sub_4059C0+74j
		add	[ebp+var_10], 1
		jmp	short loc_405A22
; ---------------------------------------------------------------------------

loc_405A21:				; CODE XREF: sub_4059C0+132j
		nop

loc_405A22:				; CODE XREF: sub_4059C0+5Fj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405A36
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_405A1B

loc_405A36:				; CODE XREF: sub_4059C0+6Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405A4A
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1

loc_405A4A:				; CODE XREF: sub_4059C0+7Ej
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_405AE4
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_8C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_8C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+0A8h+Dest], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_405AAA
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0A8h+Dest], eax
		call	sub_404427
		mov	[ebp+var_C], eax
		jmp	loc_405F21
; ---------------------------------------------------------------------------

loc_405AAA:				; CODE XREF: sub_4059C0+CFj
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_14]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+Format], eax
		mov	[esp+0A8h+Dest], edx
		call	sub_40453A
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_405AE4:				; CODE XREF: sub_4059C0+92j
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_4], eax

loc_405AEA:				; CODE XREF: sub_4059C0+56j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_405A21
		cmp	[ebp+arg_8], 0
		jz	short loc_405B08
		cmp	[ebp+arg_C], 0
		jz	loc_405BAC

loc_405B08:				; CODE XREF: sub_4059C0+13Cj
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		jmp	loc_405BA2
; ---------------------------------------------------------------------------

loc_405B13:				; CODE XREF: sub_4059C0+1E6j
		mov	eax, [ebp+var_14]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+var_A0], eax ; int
		mov	[esp+0A8h+Format], offset sub_405906 ; int
		mov	[esp+0A8h+Dest], edx ; char *
		call	sub_40DE2E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405B3D
		add	[ebp+var_28], 1

loc_405B3D:				; CODE XREF: sub_4059C0+177j
		cmp	[ebp+var_C], 0
		jnz	short loc_405B4D
		cmp	[ebp+arg_8], 0
		jnz	loc_405EB5

loc_405B4D:				; CODE XREF: sub_4059C0+181j
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dest], eax
		call	sub_40441A
		cmp	eax, 3Ah
		jnz	short loc_405B73
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_405B90
		mov	[ebp+var_2C], 1
		jmp	short loc_405B90
; ---------------------------------------------------------------------------

loc_405B73:				; CODE XREF: sub_4059C0+19Bj
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dest], eax
		call	sub_40441A
		cmp	eax, 58h
		jnz	short loc_405B90
		cmp	[ebp+arg_C], 0
		jnz	short loc_405B90
		mov	[ebp+var_C], 0

loc_405B90:				; CODE XREF: sub_4059C0+1A8j
					; sub_4059C0+1B1j ...
		cmp	[ebp+var_C], 0
		jnz	loc_405EB8
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_405BA2:				; CODE XREF: sub_4059C0+14Ej
		cmp	[ebp+var_14], 0
		jnz	loc_405B13

loc_405BAC:				; CODE XREF: sub_4059C0+142j
		mov	eax, [ebp+var_30]
		mov	[esp+0A8h+Format], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Dest], eax
		call	sub_4044C4
		jmp	loc_405E8A
; ---------------------------------------------------------------------------

loc_405BC3:				; CODE XREF: sub_4059C0+4EDj
		mov	eax, [ebp+var_40]
		mov	[ebp+var_34], eax
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_405C10
		mov	eax, [ebp+var_34]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_405BE7
		mov	eax, [ebp+var_34]
		mov	eax, [eax+14h]
		jmp	short loc_405BEC
; ---------------------------------------------------------------------------

loc_405BE7:				; CODE XREF: sub_4059C0+21Dj
		mov	eax, offset aDefault ; "[default]"

loc_405BEC:				; CODE XREF: sub_4059C0+225j
		mov	edx, [ebp+var_34]
		mov	ecx, [edx+8]
		mov	edx, [ebp+var_34]
		mov	edx, [edx+4]
		mov	[esp+0A8h+var_9C], eax
		mov	[esp+0A8h+var_A0], ecx
		mov	[esp+0A8h+Format], edx ; char
		mov	[esp+0A8h+Dest], offset	aCmd_lookupTryi	; "cmd_lookup: trying %s:%d base=%s\n"
		call	sub_42344E

loc_405C10:				; CODE XREF: sub_4059C0+213j
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+var_9C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0A8h+var_A0], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Format], eax ; char
		mov	eax, [ebp+var_30]
		mov	[esp+0A8h+Dest], eax
		call	sub_40BF43
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dest], eax
		call	sub_40441A
		cmp	eax, 3Ah
		jnz	short loc_405C6E
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_405C5B
		mov	[esp+0A8h+Dest], offset	aCmd_lookupNoDa	; "cmd_lookup: no data\n"
		call	sub_42344E

loc_405C5B:				; CODE XREF: sub_4059C0+28Dj
		mov	[ebp+var_C], 0
		mov	[ebp+var_2C], 1
		jmp	loc_405E7F
; ---------------------------------------------------------------------------

loc_405C6E:				; CODE XREF: sub_4059C0+281j
		cmp	[ebp+var_C], 0
		jz	loc_405E67
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dest], eax
		call	gpg_strerror
		mov	[esp+0A8h+Format], eax ; char
		mov	[esp+0A8h+Dest], offset	aStart_cert_fet	; "start_cert_fetch failed: %s\n"
		call	sub_4233B1
		jmp	loc_405F21
; ---------------------------------------------------------------------------

loc_405C98:				; CODE XREF: sub_4059C0+4ABj
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Dest], eax
		call	gcry_free
		mov	[ebp+var_38], 0
		mov	eax, dword ptr [ebp+var_4C]
		lea	edx, [ebp+var_3C]
		mov	[esp+0A8h+var_A0], edx
		lea	edx, [ebp+var_38]
		mov	[esp+0A8h+Format], edx
		mov	[esp+0A8h+Dest], eax
		call	sub_40BF96
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dest], eax
		call	sub_40441A
		cmp	eax, 3Ah
		jnz	short loc_405CE9
		mov	[ebp+var_C], 0
		mov	[ebp+var_2C], 1
		jmp	loc_405E74
; ---------------------------------------------------------------------------

loc_405CE9:				; CODE XREF: sub_4059C0+314j
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dest], eax
		call	sub_40441A
		cmp	eax, 4Ah
		jnz	short loc_405D0C
		mov	[ebp+var_1C], 1
		mov	[ebp+var_C], 0
		jmp	loc_405E74
; ---------------------------------------------------------------------------

loc_405D0C:				; CODE XREF: sub_4059C0+337j
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dest], eax
		call	sub_40441A
		cmp	eax, 3FFFh
		jnz	short loc_405D2A
		mov	[ebp+var_C], 0
		jmp	loc_405E74
; ---------------------------------------------------------------------------

loc_405D2A:				; CODE XREF: sub_4059C0+35Cj
		cmp	[ebp+var_C], 0
		jnz	short loc_405D4B
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_405D4B
		mov	[esp+0A8h+Dest], 3Bh
		call	sub_4043FF
		mov	[ebp+var_C], eax
		jmp	loc_405F21
; ---------------------------------------------------------------------------

loc_405D4B:				; CODE XREF: sub_4059C0+36Ej
					; sub_4059C0+375j
		cmp	[ebp+var_C], 0
		jz	short loc_405D7C
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dest], eax
		call	gpg_strerror
		mov	[esp+0A8h+Format], eax ; char
		mov	[esp+0A8h+Dest], offset	aFetch_next_cer	; "fetch_next_cert failed: %s\n"
		call	sub_4233B1
		mov	eax, dword ptr [ebp+var_4C]
		mov	[esp+0A8h+Dest], eax
		call	sub_40C079
		jmp	loc_405F21
; ---------------------------------------------------------------------------

loc_405D7C:				; CODE XREF: sub_4059C0+38Fj
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_405DAA
		cmp	[ebp+var_1C], 0
		jz	short loc_405D95
		mov	eax, offset aTruncated ; " (truncated)"
		jmp	short loc_405D9A
; ---------------------------------------------------------------------------

loc_405D95:				; CODE XREF: sub_4059C0+3CCj
		mov	eax, offset word_42D2C2

loc_405D9A:				; CODE XREF: sub_4059C0+3D3j
		mov	[esp+0A8h+Format], eax ; char
		mov	[esp+0A8h+Dest], offset	aCmd_lookupRetu	; "cmd_lookup: returning one cert%s\n"
		call	sub_42344E

loc_405DAA:				; CODE XREF: sub_4059C0+3C6j
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+var_A0], edx
		mov	[esp+0A8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Dest], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405DEA
		mov	[esp+0A8h+var_A0], 0
		mov	[esp+0A8h+Format], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Dest], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax

loc_405DEA:				; CODE XREF: sub_4059C0+40Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_405E06
		mov	[esp+0A8h+Format], offset aEnd ; "END"
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Dest], eax
		call	assuan_write_line
		mov	[ebp+var_C], eax

loc_405E06:				; CODE XREF: sub_4059C0+42Ej
		cmp	[ebp+var_C], 0
		jz	short loc_405E37
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dest], eax
		call	gpg_strerror
		mov	[esp+0A8h+Format], eax ; char
		mov	[esp+0A8h+Dest], offset	aErrorSendingDa	; "error sending data: %s\n"
		call	sub_4233B1
		mov	eax, dword ptr [ebp+var_4C]
		mov	[esp+0A8h+Dest], eax
		call	sub_40C079
		jmp	loc_405F21
; ---------------------------------------------------------------------------

loc_405E37:				; CODE XREF: sub_4059C0+44Aj
		add	[ebp+var_24], 1
		mov	eax, ds:dword_436008
		cmp	[ebp+var_24], eax
		jl	short loc_405E61
		mov	[ebp+var_20], 1
		mov	eax, ds:dword_436008
		mov	[esp+0A8h+Format], eax ; char
		mov	[esp+0A8h+Dest], offset	aMax_repliesDEx	; "max_replies %d exceeded\n"
		call	sub_423387

loc_405E61:				; CODE XREF: sub_4059C0+483j
		cmp	[ebp+arg_8], 0
		jnz	short loc_405E73

loc_405E67:				; CODE XREF: sub_4059C0+2B2j
		cmp	[ebp+var_20], 0
		jz	loc_405C98
		jmp	short loc_405E74
; ---------------------------------------------------------------------------

loc_405E73:				; CODE XREF: sub_4059C0+4A5j
		nop

loc_405E74:				; CODE XREF: sub_4059C0+324j
					; sub_4059C0+347j ...
		mov	eax, dword ptr [ebp+var_4C]
		mov	[esp+0A8h+Dest], eax
		call	sub_40C079

loc_405E7F:				; CODE XREF: sub_4059C0+2A9j
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Dest], eax
		call	sub_404457

loc_405E8A:				; CODE XREF: sub_4059C0+1FEj
		cmp	[ebp+arg_C], 0
		jnz	short loc_405EB9
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Dest], eax
		call	sub_40449E
		test	eax, eax
		jnz	short loc_405EB9
		mov	eax, [ebp+var_40]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405EB9
		cmp	[ebp+var_20], 0
		jz	loc_405BC3
		jmp	short loc_405EB9
; ---------------------------------------------------------------------------

loc_405EB5:				; CODE XREF: sub_4059C0+187j
		nop
		jmp	short loc_405EB9
; ---------------------------------------------------------------------------

loc_405EB8:				; CODE XREF: sub_4059C0+1D4j
		nop

loc_405EB9:				; CODE XREF: sub_4059C0+4CEj
					; sub_4059C0+4DDj ...
		cmp	[ebp+var_1C], 0
		jnz	short loc_405EC5
		cmp	[ebp+var_20], 0
		jz	short loc_405EFA

loc_405EC5:				; CODE XREF: sub_4059C0+4FDj
		mov	eax, offset aD	; "%d"
		mov	edx, [ebp+var_24]
		mov	[esp+0A8h+var_A0], edx
		mov	[esp+0A8h+Format], eax ; Format
		lea	eax, [ebp+var_7E]
		mov	[esp+0A8h+Dest], eax ; Dest
		call	sprintf
		lea	eax, [ebp+var_7E]
		mov	[esp+0A8h+var_A0], eax
		mov	[esp+0A8h+Format], offset aTruncated_0 ; "TRUNCATED"
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Dest], eax
		call	assuan_write_status

loc_405EFA:				; CODE XREF: sub_4059C0+503j
		cmp	[ebp+var_C], 0
		jnz	short loc_405F21
		cmp	[ebp+var_24], 0
		jnz	short loc_405F21
		cmp	[ebp+var_28], 0
		jnz	short loc_405F21
		cmp	[ebp+var_2C], 0
		jz	short loc_405F21
		mov	[esp+0A8h+Dest], 3Ah
		call	sub_4043FF
		mov	[ebp+var_C], eax

loc_405F21:				; CODE XREF: sub_4059C0+E5j
					; sub_4059C0+2D3j ...
		mov	eax, [ebp+var_18]
		mov	[esp+0A8h+Dest], eax
		call	sub_423574
		mov	eax, [ebp+var_C]
		add	esp, 0A4h
		pop	edi
		pop	ebp
		retn
sub_4059C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405F38	proc near		; DATA XREF: .data:0042B3D4o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], offset aUrl ;	"--url"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4046F8
		mov	[ebp+var_10], eax
		mov	[esp+28h+var_24], offset aSingle ; "--single"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4046F8
		mov	[ebp+var_14], eax
		mov	[esp+28h+var_24], offset aCacheOnly ; "--cache-only"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4046F8
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_40480B
		mov	[ebp+arg_4], eax
		cmp	[ebp+var_10], 0
		jz	short loc_405FAB
		cmp	[ebp+var_18], 0
		jz	short loc_405FAB
		mov	[esp+28h+var_28], 1Bh
		call	sub_4043FF
		mov	[ebp+var_C], eax
		jmp	short loc_406008
; ---------------------------------------------------------------------------

loc_405FAB:				; CODE XREF: sub_405F38+5Aj
					; sub_405F38+60j
		cmp	[ebp+var_10], 0
		jz	short loc_405FC8
		cmp	[ebp+var_14], 0
		jz	short loc_405FC8
		mov	[esp+28h+var_28], 45h
		call	sub_4043FF
		mov	[ebp+var_C], eax
		jmp	short loc_406008
; ---------------------------------------------------------------------------

loc_405FC8:				; CODE XREF: sub_405F38+77j
					; sub_405F38+7Dj
		cmp	[ebp+var_10], 0
		jz	short loc_405FE5
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40581B
		mov	[ebp+var_C], eax
		jmp	short loc_406008
; ---------------------------------------------------------------------------

loc_405FE5:				; CODE XREF: sub_405F38+94j
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4059C0
		mov	[ebp+var_C], eax

loc_406008:				; CODE XREF: sub_405F38+71j
					; sub_405F38+8Ej ...
		cmp	[ebp+var_C], 0
		jz	short loc_406031
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], offset aLookup ; "LOOKUP"
		mov	[esp+28h+var_28], offset aCommandSFailed ; "command %s failed: %s\n"
		call	sub_4233B1

loc_406031:				; CODE XREF: sub_405F38+D4j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405F38	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406036(int, char *)
sub_406036	proc near		; DATA XREF: .data:0042B3E0o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		mov	[esp+48h+var_44], offset aUrl ;	"--url"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_4046F8
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_40480B
		mov	[ebp+arg_4], eax
		cmp	[ebp+var_14], 0
		jz	loc_40611A
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40B9E4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4060C9
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aFetchingCrlF_0 ; "fetching CRL from `%s' failed: %s\n"
		call	sub_4233B1
		jmp	loc_406189
; ---------------------------------------------------------------------------

loc_4060C9:				; CODE XREF: sub_406036+6Aj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax ;	char *
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40A08A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40610D
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aProcessingCr_0 ; "processing CRL from	`%s' failed: %s\n"
		call	sub_4233B1

loc_40610D:				; CODE XREF: sub_406036+B3j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_40C1C5
		jmp	short loc_406189
; ---------------------------------------------------------------------------

loc_40611A:				; CODE XREF: sub_406036+44j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+48h+var_48], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_406157
		call	sub_404442
		mov	[ebp+var_C], eax
		jmp	short loc_406189
; ---------------------------------------------------------------------------

loc_406157:				; CODE XREF: sub_406036+115j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_40453A
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40B19E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_406189:				; CODE XREF: sub_406036+8Ej
					; sub_406036+E2j ...
		cmp	[ebp+var_C], 0
		jz	short loc_4061B2
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], offset aLoadcrl ; "LOADCRL"
		mov	[esp+48h+var_48], offset aCommandSFailed ; "command %s failed: %s\n"
		call	sub_4233B1

loc_4061B2:				; CODE XREF: sub_406036+157j
		mov	eax, [ebp+var_C]
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_406036	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4061BB	proc near		; DATA XREF: .data:0042B3ECo

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_data_fp
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4061FA
		mov	[esp+28h+var_28], 118h
		call	sub_4043FF
		mov	[esp+28h+var_20], offset aNoDataStream ; "no data stream"
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_set_error
		jmp	short locret_406234
; ---------------------------------------------------------------------------

loc_4061FA:				; CODE XREF: sub_4061BB+18j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_40B140
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406231
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], offset aListcrls ; "LISTCRLS"
		mov	[esp+28h+var_28], offset aCommandSFailed ; "command %s failed: %s\n"
		call	sub_4233B1

loc_406231:				; CODE XREF: sub_4061BB+51j
		mov	eax, [ebp+var_10]

locret_406234:				; CODE XREF: sub_4061BB+3Dj
		leave
		retn
sub_4061BB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406236	proc near		; DATA XREF: .data:0042B3F8o

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	[esp+48h+var_38], 2000h
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_3C], edx
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], offset aTargetcert ; "TARGETCERT"
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4062AC
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aAssuan_inqui_0 ; "assuan_inquire failed: %s\n"
		call	sub_4233B1
		jmp	short loc_406316
; ---------------------------------------------------------------------------

loc_4062AC:				; CODE XREF: sub_406236+57j
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jnz	short loc_4062C4
		mov	[esp+48h+var_48], 39h
		call	sub_4043FF
		mov	[ebp+var_C], eax
		jmp	short loc_4062F4
; ---------------------------------------------------------------------------

loc_4062C4:				; CODE XREF: sub_406236+7Bj
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4062F4
		mov	ecx, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_C], eax

loc_4062F4:				; CODE XREF: sub_406236+8Cj
					; sub_406236+A0j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_406315
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	sub_40D2A0
		mov	[ebp+var_C], eax
		jmp	short loc_406316
; ---------------------------------------------------------------------------

loc_406315:				; CODE XREF: sub_406236+CDj
		nop

loc_406316:				; CODE XREF: sub_406236+74j
					; sub_406236+DDj
		cmp	[ebp+var_C], 0
		jz	short loc_40633F
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], offset aCachecert ;	"CACHECERT"
		mov	[esp+48h+var_48], offset aCommandSFailed ; "command %s failed: %s\n"
		call	sub_4233B1

loc_40633F:				; CODE XREF: sub_406236+E4j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406236	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40634F	proc near		; DATA XREF: .data:0042B404o

var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_34		= byte ptr -34h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	[esp+58h+var_48], 2000h
		lea	edx, [ebp+var_20]
		mov	[esp+58h+var_4C], edx
		lea	edx, [ebp+var_1C]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], offset aTargetcert ; "TARGETCERT"
		mov	[esp+58h+var_58], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4063C8
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aAssuan_inqui_0 ; "assuan_inquire failed: %s\n"
		call	sub_4233B1
		jmp	loc_406488
; ---------------------------------------------------------------------------

loc_4063C8:				; CODE XREF: sub_40634F+57j
		mov	eax, [ebp+var_20]
		test	eax, eax
		jnz	short loc_4063E0
		mov	[esp+58h+var_58], 39h
		call	sub_4043FF
		mov	[ebp+var_C], eax
		jmp	short loc_406410
; ---------------------------------------------------------------------------

loc_4063E0:				; CODE XREF: sub_40634F+7Ej
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406410
		mov	ecx, [ebp+var_20]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_50], ecx
		mov	dword ptr [esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_C], eax

loc_406410:				; CODE XREF: sub_40634F+8Fj
					; sub_40634F+A3j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_406487
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+var_34]
		mov	dword ptr [esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	sub_40C831
		lea	eax, [ebp+var_34]
		mov	[esp+58h+var_58], eax ;	void *
		call	sub_40D39E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_406458
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_406458:				; CODE XREF: sub_40634F+F6j
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_48], 0 ; int
		mov	[esp+58h+var_4C], 0 ; int
		mov	[esp+58h+var_50], 0 ; char *
		mov	dword ptr [esp+58h+var_54], eax	; int
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_420043
		mov	[ebp+var_C], eax
		jmp	short loc_406488
; ---------------------------------------------------------------------------

loc_406487:				; CODE XREF: sub_40634F+D0j
		nop

loc_406488:				; CODE XREF: sub_40634F+74j
					; sub_40634F+136j
		cmp	[ebp+var_C], 0
		jz	short loc_4064B1
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	dword ptr [esp+58h+var_54], offset aValidate ; "VALIDATE"
		mov	[esp+58h+var_58], offset aCommandSFailed ; "command %s failed: %s\n"
		call	sub_4233B1

loc_4064B1:				; CODE XREF: sub_40634F+13Dj
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40634F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4064C1	proc near		; CODE XREF: sub_406596+15Ep

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_40653B
; ---------------------------------------------------------------------------

loc_4064D7:				; CODE XREF: sub_4064C1+8Fj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_42B3A0
		mov	ebx, [eax+8]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_42B3A0
		mov	ecx, [eax+4]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_42B3A0
		mov	eax, [eax]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_register_command
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_406537
		mov	eax, [ebp+var_14]
		jmp	short loc_406557
; ---------------------------------------------------------------------------

loc_406537:				; CODE XREF: sub_4064C1+6Fj
		add	[ebp+var_C], 1

loc_40653B:				; CODE XREF: sub_4064C1+14j
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_42B3A0
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4064D7
		mov	eax, 0

loc_406557:				; CODE XREF: sub_4064C1+74j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_4064C1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40655D	proc near		; DATA XREF: sub_406596+29Co

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	sub_40C240
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	dword ptr [eax+4], 0
		mov	eax, 0
		leave
		retn
sub_40655D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406596	proc near		; CODE XREF: sub_4020C2+B07p
					; sub_403FB2+5Fp

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	[esp+58h+var_54], 20h
		mov	[esp+58h+var_58], 1
		call	gcry_calloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4065D7
		mov	[esp+58h+var_54], 8
		mov	[esp+58h+var_58], 1
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_4065D7:				; CODE XREF: sub_406596+23j
		cmp	[ebp+var_10], 0
		jz	short loc_4065E7
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_406618

loc_4065E7:				; CODE XREF: sub_406596+45j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aCanTAllocateCo ; "can't allocate control structure: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		jmp	loc_406955
; ---------------------------------------------------------------------------

loc_406618:				; CODE XREF: sub_406596+4Fj
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_4035E1
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40665E
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aFailedToAlloca ; "failed to allocate assuan context: %s\n"
		call	sub_4233B1
		mov	[esp+58h+var_58], 2
		call	sub_4035CB
; ---------------------------------------------------------------------------

loc_40665E:				; CODE XREF: sub_406596+9Fj
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_406699
		mov	[esp+58h+var_58], 0
		call	assuan_fdopen
		mov	[ebp+var_24], eax
		mov	[esp+58h+var_58], 1
		call	assuan_fdopen
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_24]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	assuan_init_pipe_server
		mov	[ebp+var_C], eax
		jmp	short loc_4066B6
; ---------------------------------------------------------------------------

loc_406699:				; CODE XREF: sub_406596+CCj
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], 2
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	assuan_init_socket_server
		mov	[ebp+var_C], eax

loc_4066B6:				; CODE XREF: sub_406596+101j
		cmp	[ebp+var_C], 0
		jz	short loc_4066EE
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	assuan_release
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aFailedToInitia ; "failed to initialize the server: %s\n"
		call	sub_4233B1
		mov	[esp+58h+var_58], 2
		call	sub_4035CB
; ---------------------------------------------------------------------------

loc_4066EE:				; CODE XREF: sub_406596+124j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_4064C1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406729
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aFailedToTheReg ; "failed to the register commands with As"...
		call	sub_4233B1
		mov	[esp+58h+var_58], 2
		call	sub_4035CB
; ---------------------------------------------------------------------------

loc_406729:				; CODE XREF: sub_406596+16Aj
		mov	eax, ds:dword_435054
		test	eax, eax
		jnz	loc_4067EA
		mov	eax, ds:dword_435FC0
		test	eax, eax
		jz	short loc_406746
		mov	eax, ds:dword_435FC0
		jmp	short loc_40674B
; ---------------------------------------------------------------------------

loc_406746:				; CODE XREF: sub_406596+1A7j
		mov	eax, offset aNone_0 ; "[none]"

loc_40674B:				; CODE XREF: sub_406596+1AEj
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_435FB4
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 3Ch
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[esp+58h+var_58], eax
		call	gcry_xmalloc
		mov	ds:dword_435054, eax
		mov	ecx, ds:dword_435FB4
		mov	edx, offset aHomeSConfigSS ; "Home: %s\nConfig:	%s\n%s"
		mov	eax, ds:dword_435054
		mov	[esp+58h+var_44], offset aDirmngr1_1_1At ; "Dirmngr 1.1.1 at your service"
		mov	ebx, [ebp+var_14]
		mov	[esp+58h+var_48], ebx
		mov	dword ptr [esp+58h+var_4C], ecx	; char
		mov	[esp+58h+var_50], edx ;	char *
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_54], edx ;	size_t
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_429570
		mov	eax, ds:dword_435054
		add	eax, [ebp+var_18]
		mov	byte ptr [eax],	0

loc_4067EA:				; CODE XREF: sub_406596+19Aj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_10]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	assuan_set_pointer
		mov	edx, ds:dword_435054
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	assuan_set_hello_line
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_54], offset sub_404EEF
		mov	[esp+58h+var_58], eax
		call	assuan_register_option_handler
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_54], offset sub_40655D
		mov	[esp+58h+var_58], eax
		call	assuan_register_reset_notify
		mov	eax, ds:dword_435FA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_406867
		call	sub_422F93
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+var_58], edx
		call	assuan_set_log_stream
		jmp	short loc_406867
; ---------------------------------------------------------------------------

loc_406866:				; CODE XREF: sub_406596+31Aj
					; sub_406596+338j
		nop

loc_406867:				; CODE XREF: sub_406596+2B8j
					; sub_406596+2CEj
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	assuan_accept
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_4068D0
		cmp	[ebp+var_C], 0
		jz	short loc_40689E
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aAssuanAcceptPr ; "Assuan accept problem: %s\n"
		call	sub_423387
		jmp	short loc_4068D1
; ---------------------------------------------------------------------------

loc_40689E:				; CODE XREF: sub_406596+2E9j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	assuan_process
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406866
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aAssuanProcessi ; "Assuan processing failed: %s\n"
		call	sub_423387
		nop
		jmp	short loc_406866
; ---------------------------------------------------------------------------

loc_4068D0:				; CODE XREF: sub_406596+2E3j
		nop

loc_4068D1:				; CODE XREF: sub_406596+306j
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_4116F6
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	eax, [eax+4]
		mov	[esp+58h+var_58], eax
		call	sub_40C240
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	assuan_release
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_406931
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aOopsConnection ; "oops: connection control structure stil"...
		call	sub_4233B1
		jmp	short loc_406955
; ---------------------------------------------------------------------------

loc_406931:				; CODE XREF: sub_406596+382j
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_418A49
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	gcry_free

loc_406955:				; CODE XREF: sub_406596+7Dj
					; sub_406596+399j
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_406596	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40695C	proc near		; CODE XREF: sub_406A20+68p
					; sub_417BEE+DDp

var_3E8		= dword	ptr -3E8h
var_3E4		= dword	ptr -3E4h
var_3E0		= dword	ptr -3E0h
var_3D6		= byte ptr -3D6h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 3E8h
		mov	[ebp+var_C], 0
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_20]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_406A1B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_3D6]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_4069E2
; ---------------------------------------------------------------------------

loc_40699F:				; CODE XREF: sub_40695C+98j
		cmp	[ebp+var_18], 0
		jz	short loc_4069CE
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	20h
		add	[ebp+var_14], 1
		add	[ebp+var_18], 1
		jmp	short loc_4069CE
; ---------------------------------------------------------------------------

loc_4069B5:				; CODE XREF: sub_40695C+84j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		add	[ebp+var_10], 1
		add	[ebp+var_18], 1
		jmp	short loc_4069CF
; ---------------------------------------------------------------------------

loc_4069CE:				; CODE XREF: sub_40695C+47j
					; sub_40695C+57j
		nop

loc_4069CF:				; CODE XREF: sub_40695C+70j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4069E2
		cmp	[ebp+var_18], 3B3h
		jbe	short loc_4069B5

loc_4069E2:				; CODE XREF: sub_40695C+41j
					; sub_40695C+7Bj
		mov	eax, [ebp+var_20]
		lea	edx, [eax+4]
		mov	[ebp+var_20], edx
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40699F
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_3D6]
		mov	[esp+3E8h+var_3E0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+3E8h+var_3E4], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+3E8h+var_3E8], eax
		call	assuan_write_status
		mov	[ebp+var_C], eax

loc_406A1B:				; CODE XREF: sub_40695C+20j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40695C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406A20	proc near		; CODE XREF: sub_411791+DEp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0
		mov	[esp+38h+var_38], 0
		call	sub_429850
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_435050
		test	eax, eax
		jnz	short loc_406A52
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	ds:dword_435050, eax
		jmp	short loc_406ABF
; ---------------------------------------------------------------------------

loc_406A52:				; CODE XREF: sub_406A20+23j
		mov	eax, ds:dword_435050
		cmp	[ebp+var_10], eax
		jle	short loc_406ABF
		cmp	[ebp+arg_0], 0
		jz	short loc_406AB4
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], offset a?00 ;	"? 0 0"
		mov	[esp+38h+var_30], offset aTick ; "tick"
		mov	[esp+38h+var_34], offset aProgress ; "PROGRESS"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40695C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406AA5
		mov	[esp+38h+var_38], 63h
		call	sub_4043FF
		mov	[ebp+var_C], eax

loc_406AA5:				; CODE XREF: sub_406A20+74j
		mov	[esp+38h+var_38], 0
		call	sub_429850
		mov	[ebp+var_10], eax

loc_406AB4:				; CODE XREF: sub_406A20+40j
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	ds:dword_435050, eax

loc_406ABF:				; CODE XREF: sub_406A20+30j
					; sub_406A20+3Aj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406A20	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406AC4	proc near		; CODE XREF: sub_406AEB+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_406AE4
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_406AE9
; ---------------------------------------------------------------------------

loc_406AE4:				; CODE XREF: sub_406AC4+7j
		mov	eax, 0

loc_406AE9:				; CODE XREF: sub_406AC4+1Ej
		pop	ebp
		retn
sub_406AC4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406AEB	proc near		; CODE XREF: sub_406B13+14p
					; sub_406B2E+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_406AC4
		leave
		retn
sub_406AEB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406B06	proc near		; CODE XREF: sub_40A08A+522p
					; sub_40A08A+534p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_406B06	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406B13	proc near		; CODE XREF: sub_407EC1+BDp
					; sub_407EC1+176p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_406AEB
		leave
		retn
sub_406B13	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406B2E	proc near		; CODE XREF: sub_406F2F+65p
					; sub_406F2F+BCp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_406AEB
		leave
		retn
sub_406B2E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406B43(char *, char *)
sub_406B43	proc near		; CODE XREF: sub_408DFB+AEp
					; sub_40989B+174p ...

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406BA1
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Fh
		jnz	short loc_406B85
		mov	eax, [ebp+arg_4]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_406BA1

loc_406B85:				; CODE XREF: sub_406B43+33j
		mov	[esp+28h+var_20], offset aCopy_time ; "copy_time"
		mov	[esp+28h+Source], 39h
		mov	[esp+28h+Dest],	offset a____Dirmngr1_0 ; "../../dirmngr-1.1.1/src/misc.h"
		call	sub_423540
; ---------------------------------------------------------------------------

loc_406BA1:				; CODE XREF: sub_406B43+Fj
					; sub_406B43+40j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dest],	eax ; Dest
		call	strcpy
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_406B43	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406BB9	proc near		; CODE XREF: sub_408DFB+6p
					; sub_40A08A+11p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_435058
		test	eax, eax
		jnz	short loc_406BD4
		mov	[esp+18h+var_18], offset aCrlCacheHasNot ; "CRL	cache has not yet been initialized\"...
		call	sub_4233F4
; ---------------------------------------------------------------------------

loc_406BD4:				; CODE XREF: sub_406BB9+Dj
		mov	eax, ds:dword_435058
		leave
		retn
sub_406BB9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406BDB	proc near		; CODE XREF: sub_40719C+56p
					; sub_40719C+77p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_435FBC
		mov	[esp+28h+var_20], 0
		mov	edx, [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_4259CC
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_429860
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_406C88
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aCreatingDirect ; "creating directory `%s'\n"
		call	sub_423387
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	_mkdir
		test	eax, eax
		jz	short loc_406C93
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorCreatingD ; "error creating directory `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	short locret_406CA3
; ---------------------------------------------------------------------------

loc_406C88:				; CODE XREF: sub_406BDB+37j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_429BB0

loc_406C93:				; CODE XREF: sub_406BDB+59j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, 0

locret_406CA3:				; CODE XREF: sub_406BDB+ABj
		leave
		retn
sub_406BDB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406CA5	proc near		; CODE XREF: sub_40737F+112p
					; sub_408DD1+Dp

Filename	= dword	ptr -68h
var_64		= byte ptr -64h
var_60		= dword	ptr -60h
var_50		= byte ptr -50h
var_4A		= word ptr -4Ah
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 60h
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_406CBD
		mov	eax, offset aCrls_d ; "crls.d"
		jmp	short loc_406CC2
; ---------------------------------------------------------------------------

loc_406CBD:				; CODE XREF: sub_406CA5+Fj
		mov	eax, offset aDirmngrCache_d ; "dirmngr-cache.d"

loc_406CC2:				; CODE XREF: sub_406CA5+16j
		mov	edx, ds:dword_435FBC
		mov	[esp+68h+var_60], 0
		mov	dword ptr [esp+68h+var_64], eax
		mov	[esp+68h+Filename], edx
		call	sub_4259CC
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_406D64
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, offset asc_42EC1E ; "~/"
		mov	ecx, 3
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_406D3C
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, offset asc_42EC21 ; "/"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_406D64

loc_406D3C:				; CODE XREF: sub_406CA5+6Dj
		mov	eax, [ebp+var_14]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+Filename], offset aIgnoringDataba ; "ignoring database	dir `%s'\n"
		call	sub_4233B1
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	loc_406F28
; ---------------------------------------------------------------------------

loc_406D64:				; CODE XREF: sub_406CA5+45j
					; sub_406CA5+95j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; LPCSTR
		call	sub_429860
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_406EF7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax	; int
		call	strerror
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+var_14]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+Filename], offset aErrorReadingDi ; "error reading directory `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	loc_406F28
; ---------------------------------------------------------------------------

loc_406DB9:				; CODE XREF: sub_406CA5+264j
		mov	eax, [ebp+var_1C]
		add	eax, 8
		mov	edx, eax
		mov	eax, offset a__0 ; "."
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	loc_406EF7
		mov	eax, [ebp+var_1C]
		add	eax, 8
		mov	edx, eax
		mov	eax, offset a__	; ".."
		mov	ecx, 3
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	loc_406EF7
		mov	eax, [ebp+var_1C]
		add	eax, 8
		mov	[esp+68h+var_60], 0
		mov	dword ptr [esp+68h+var_64], eax
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	sub_4259CC
		mov	[ebp+var_20], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_406E46
		mov	[ebp+var_10], 1
		jmp	short loc_406E80
; ---------------------------------------------------------------------------

loc_406E46:				; CODE XREF: sub_406CA5+196j
		lea	eax, [ebp+var_50]
		mov	dword ptr [esp+68h+var_64], eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_stati64
		call	eax ; _stati64
		test	eax, eax
		jnz	short loc_406E78
		movzx	eax, [ebp+var_4A]
		movzx	eax, ax
		and	eax, 0F000h
		cmp	eax, 8000h
		jnz	short loc_406E78
		mov	eax, 1
		jmp	short loc_406E7D
; ---------------------------------------------------------------------------

loc_406E78:				; CODE XREF: sub_406CA5+1B7j
					; sub_406CA5+1CAj
		mov	eax, 0

loc_406E7D:				; CODE XREF: sub_406CA5+1D1j
		mov	[ebp+var_10], eax

loc_406E80:				; CODE XREF: sub_406CA5+19Fj
		cmp	[ebp+var_10], 0
		jz	short loc_406ED9
		mov	eax, [ebp+var_20]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+Filename], offset aRemovingCacheF ; "removing cache file `%s'\n"
		call	sub_423387
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Filename], eax	; Filename
		call	_unlink
		test	eax, eax
		jz	short loc_406EEC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax	; int
		call	strerror
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+var_20]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+Filename], offset aFailedToRemove ; "failed to	remove `%s': %s\n"
		call	sub_4233B1
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_406EEC
; ---------------------------------------------------------------------------

loc_406ED9:				; CODE XREF: sub_406CA5+1DFj
		mov	eax, [ebp+var_20]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+Filename], offset aNotRemovingFil ; "not removing file	`%s'\n"
		call	sub_423387

loc_406EEC:				; CODE XREF: sub_406CA5+201j
					; sub_406CA5+232j
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Filename], eax
		call	gcry_free

loc_406EF7:				; CODE XREF: sub_406CA5+D1j
					; sub_406CA5+13Dj ...
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax
		call	sub_429A90
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_406DB9
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_429BB0
		mov	eax, [ebp+var_C]

loc_406F28:				; CODE XREF: sub_406CA5+BAj
					; sub_406CA5+10Fj
		add	esp, 60h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_406CA5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406F2F(FILE *File, int)
sub_406F2F	proc near		; CODE XREF: sub_40737F+93p
					; sub_40751E+429p ...

Dst		= dword	ptr -168h
Src		= dword	ptr -164h
Size		= dword	ptr -160h
var_14C		= byte ptr -14Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
File		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 168h
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_14C]
		mov	[ebp+var_18], eax
		mov	[ebp+var_10], 12Bh
		jmp	loc_407027
; ---------------------------------------------------------------------------

loc_406F64:				; CODE XREF: sub_406F2F+110j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jb	loc_407016
		cmp	[ebp+var_C], 0
		jnz	short loc_406FC6
		add	[ebp+var_10], 400h
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+168h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406FA8
		call	sub_406B2E
		mov	edx, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, 0
		jmp	locret_4070B2
; ---------------------------------------------------------------------------

loc_406FA8:				; CODE XREF: sub_406F2F+63j
		lea	edx, [ebp+var_14C]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_14]
		mov	[esp+168h+Size], ecx ; Size
		mov	[esp+168h+Src],	edx ; Src
		mov	[esp+168h+Dst],	eax ; Dst
		call	memcpy
		jmp	short loc_407010
; ---------------------------------------------------------------------------

loc_406FC6:				; CODE XREF: sub_406F2F+45j
		add	[ebp+var_10], 400h
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+168h+Src],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+168h+Dst],	eax
		call	gcry_realloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40700A
		call	sub_406B2E
		mov	edx, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	[esp+168h+Dst],	eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_4070B2
; ---------------------------------------------------------------------------

loc_40700A:				; CODE XREF: sub_406F2F+BAj
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax

loc_407010:				; CODE XREF: sub_406F2F+95j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax

loc_407016:				; CODE XREF: sub_406F2F+3Bj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+var_20]
		mov	[edx], al
		add	[ebp+var_14], 1

loc_407027:				; CODE XREF: sub_406F2F+30j
		mov	eax, [ebp+File]
		mov	[esp+168h+Dst],	eax ; File
		call	getc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	short loc_407045
		cmp	[ebp+var_20], 0Ah
		jnz	loc_406F64

loc_407045:				; CODE XREF: sub_406F2F+10Aj
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_407058
		cmp	[ebp+var_14], 0
		jnz	short loc_407058
		mov	eax, 0
		jmp	short locret_4070B2
; ---------------------------------------------------------------------------

loc_407058:				; CODE XREF: sub_406F2F+11Aj
					; sub_406F2F+120j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		add	eax, edx
		mov	byte ptr [eax],	0
		cmp	[ebp+var_C], 0
		jz	short loc_407083
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+168h+Src],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+168h+Dst],	eax
		call	gcry_realloc
		mov	[ebp+var_1C], eax
		jmp	short loc_407094
; ---------------------------------------------------------------------------

loc_407083:				; CODE XREF: sub_406F2F+138j
		lea	eax, [ebp+var_14C]
		mov	[esp+168h+Dst],	eax
		call	gcry_strdup
		mov	[ebp+var_1C], eax

loc_407094:				; CODE XREF: sub_406F2F+152j
		cmp	[ebp+var_1C], 0
		jnz	short loc_4070AF
		call	sub_406B2E
		mov	edx, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	[esp+168h+Dst],	eax
		call	gcry_free

loc_4070AF:				; CODE XREF: sub_406F2F+169j
		mov	eax, [ebp+var_1C]

locret_4070B2:				; CODE XREF: sub_406F2F+74j
					; sub_406F2F+D6j ...
		leave
		retn
sub_406F2F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4070B4	proc near		; CODE XREF: sub_40714E+24p
					; sub_40A08A+8EDp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	locret_40714C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+6Ch]
		test	eax, eax
		jz	short loc_407125
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+6Ch]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+6Ch]
		mov	[esp+28h+var_28], eax
		call	sub_40F169
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+6Ch]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	_close
		test	eax, eax
		jz	short loc_407125
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorClosingCa ; "error closing cache	file: %s\n"
		call	sub_4233B1

loc_407125:				; CODE XREF: sub_4070B4+18j
					; sub_4070B4+4Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free

locret_40714C:				; CODE XREF: sub_4070B4+Aj
		leave
		retn
sub_4070B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40714E	proc near		; CODE XREF: sub_40751E+666p
					; sub_408DA9+17p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_407199
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_40717D
; ---------------------------------------------------------------------------

loc_407164:				; CODE XREF: sub_40714E+33j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4070B4
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_40717D:				; CODE XREF: sub_40714E+14j
		cmp	[ebp+var_C], 0
		jnz	short loc_407164
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short locret_40719A
; ---------------------------------------------------------------------------

loc_407199:				; CODE XREF: sub_40714E+Aj
		nop

locret_40719A:				; CODE XREF: sub_40714E+49j
		leave
		retn
sub_40714E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40719C(char *)
sub_40719C	proc near		; CODE XREF: sub_40737F+12Ap
					; sub_40751E+91p

Filename	= dword	ptr -28h
Mode		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, offset aR_0 ; "r"
		mov	[esp+28h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	loc_40737A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+Filename], eax	; int
		call	strerror
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Mode],	eax ; char
		mov	[esp+28h+Filename], offset aFailedToOpenCa ; "failed to	open cache dir file `%s': %s\"...
		call	sub_4233B1
		mov	[esp+28h+Filename], 0
		call	sub_406BDB
		test	eax, eax
		jnz	short loc_40721C
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_40720B
		mov	eax, offset aCrls_d ; "crls.d"
		jmp	short loc_407210
; ---------------------------------------------------------------------------

loc_40720B:				; CODE XREF: sub_40719C+66j
		mov	eax, offset aDirmngrCache_d ; "dirmngr-cache.d"

loc_407210:				; CODE XREF: sub_40719C+6Dj
		mov	[esp+28h+Filename], eax
		call	sub_406BDB
		test	eax, eax
		jz	short loc_407226

loc_40721C:				; CODE XREF: sub_40719C+5Dj
		mov	eax, 0
		jmp	locret_40737D
; ---------------------------------------------------------------------------

loc_407226:				; CODE XREF: sub_40719C+7Ej
		mov	eax, offset aW	; "w"
		mov	[esp+28h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_407275
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+Filename], eax	; int
		call	strerror
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Mode],	eax ; char
		mov	[esp+28h+Filename], offset aErrorCreatingN ; "error creating new cache dir file	`%s':"...
		call	sub_4233B1
		mov	eax, 0
		jmp	locret_40737D
; ---------------------------------------------------------------------------

loc_407275:				; CODE XREF: sub_40719C+A5j
		mov	eax, offset aVD	; "v:%d:\n"
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+Mode],	eax ; Format
		mov	eax, [ebp+File]
		mov	[esp+28h+Filename], eax	; File
		call	fprintf
		mov	eax, [ebp+File]
		mov	[esp+28h+Filename], eax	; File
		call	ferror
		test	eax, eax
		jz	short loc_4072DD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+Filename], eax	; int
		call	strerror
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Mode],	eax ; char
		mov	[esp+28h+Filename], offset aErrorWritingNe ; "error writing new	cache dir file `%s': "...
		call	sub_4233B1
		mov	eax, [ebp+File]
		mov	[esp+28h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	locret_40737D
; ---------------------------------------------------------------------------

loc_4072DD:				; CODE XREF: sub_40719C+102j
		mov	eax, [ebp+File]
		mov	[esp+28h+Filename], eax	; File
		call	fclose
		test	eax, eax
		jz	short loc_40731B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+Filename], eax	; int
		call	strerror
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Mode],	eax ; char
		mov	[esp+28h+Filename], offset aErrorClosingNe ; "error closing new	cache dir file `%s': "...
		call	sub_4233B1
		mov	eax, 0
		jmp	short locret_40737D
; ---------------------------------------------------------------------------

loc_40731B:				; CODE XREF: sub_40719C+14Ej
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Mode],	eax ; char
		mov	[esp+28h+Filename], offset aNewCacheDirFil ; "new cache	dir file `%s' created\n"
		call	sub_423387
		mov	eax, offset aR_0 ; "r"
		mov	[esp+28h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_40737A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+Filename], eax	; int
		call	strerror
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Mode],	eax ; char
		mov	[esp+28h+Filename], offset aFailedToReOpen ; "failed to	re-open	cache dir file `%s': "...
		call	sub_4233B1
		mov	eax, 0
		jmp	short locret_40737D
; ---------------------------------------------------------------------------

loc_40737A:				; CODE XREF: sub_40719C+21j
					; sub_40719C+1ADj
		mov	eax, [ebp+File]

locret_40737D:				; CODE XREF: sub_40719C+85j
					; sub_40719C+D4j ...
		leave
		retn
sub_40719C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40737F(int, char *, int, int)
sub_40737F	proc near		; CODE XREF: sub_40751E+D0p
					; sub_407EC1+10Ep

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+File], eax
		mov	[ebp+var_10], 0
		jmp	short loc_407405
; ---------------------------------------------------------------------------

loc_40739D:				; CODE XREF: sub_40737F+9Fj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 76h
		jnz	short loc_4073C1
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_407424

loc_4073C1:				; CODE XREF: sub_40737F+33j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	short loc_4073FA
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+EndPtr], eax ;	char
		mov	[esp+28h+Str], offset aFirstRecordOfS ;	"first record of `%s' is not the version"...
		call	sub_4233B1
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax
		call	gcry_free
		mov	[esp+28h+Str], 73h
		call	sub_406AEB
		jmp	locret_40751C
; ---------------------------------------------------------------------------

loc_4073FA:				; CODE XREF: sub_40737F+4Aj
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax
		call	gcry_free

loc_407405:				; CODE XREF: sub_40737F+1Cj
					; sub_40737F+163j
		lea	eax, [ebp+var_18]
		mov	[esp+28h+EndPtr], eax ;	int
		mov	eax, [ebp+File]
		mov	[esp+28h+Str], eax ; File
		call	sub_406F2F
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_40739D

loc_407424:				; CODE XREF: sub_40737F+40j
		mov	eax, [ebp+var_18]
		test	eax, eax
		jz	short loc_407433
		mov	eax, [ebp+var_18]
		jmp	locret_40751C
; ---------------------------------------------------------------------------

loc_407433:				; CODE XREF: sub_40737F+AAj
		mov	eax, [ebp+var_14]
		add	eax, 2
		mov	[esp+28h+Radix], 0Ah ; Radix
		mov	[esp+28h+EndPtr], 0 ; char
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		cmp	eax, 1
		jz	loc_40750C
		cmp	[ebp+var_10], 0
		jnz	loc_4074E7
		cmp	[ebp+arg_C], 0
		jz	short loc_4074E7
		mov	[esp+28h+Str], offset aOldVersionOfCa ;	"old version of	cache directory	- cleani"...
		call	sub_4233B1
		mov	eax, [ebp+File]
		mov	[esp+28h+Str], eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	[esp+28h+Str], 1
		call	sub_406CA5
		test	eax, eax
		jnz	short loc_4074E7
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; char *
		call	sub_40719C
		mov	edx, [ebp+arg_0]
		mov	[edx], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_4074DA
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax
		call	gcry_free
		mov	[esp+28h+Str], 73h
		call	sub_406AEB
		jmp	short locret_40751C
; ---------------------------------------------------------------------------

loc_4074DA:				; CODE XREF: sub_40737F+140j
		mov	[ebp+var_10], 1
		nop
		jmp	loc_407405
; ---------------------------------------------------------------------------

loc_4074E7:				; CODE XREF: sub_40737F+DFj
					; sub_40737F+E9j ...
		mov	[esp+28h+Str], offset aOldVersionOf_0 ;	"old version of	cache directory	- giving"...
		call	sub_4233B1
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax
		call	gcry_free
		mov	[esp+28h+Str], 73h
		call	sub_406AEB
		jmp	short locret_40751C
; ---------------------------------------------------------------------------

loc_40750C:				; CODE XREF: sub_40737F+D5j
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax
		call	gcry_free
		mov	eax, 0

locret_40751C:				; CODE XREF: sub_40737F+76j
					; sub_40737F+AFj ...
		leave
		retn
sub_40737F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40751E	proc near		; CODE XREF: sub_408D4C+2Ap

Str		= dword	ptr -68h
Val		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
File		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
Source		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	[ebp+var_10], 0
		mov	[ebp+var_34], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[esp+68h+Val], 4
		mov	[esp+68h+Str], 1
		call	gcry_calloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_407568
		call	sub_406B2E
		jmp	loc_407B9B
; ---------------------------------------------------------------------------

loc_407568:				; CODE XREF: sub_40751E+3Ej
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_407578
		mov	eax, offset aCrls_d ; "crls.d"
		jmp	short loc_40757D
; ---------------------------------------------------------------------------

loc_407578:				; CODE XREF: sub_40751E+51j
		mov	eax, offset aDirmngrCache_d ; "dirmngr-cache.d"

loc_40757D:				; CODE XREF: sub_40751E+58j
		mov	edx, ds:dword_435FBC
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Count], offset	aDir_txt ; "DIR.txt"
		mov	[esp+68h+Val], eax
		mov	[esp+68h+Str], edx
		call	sub_4259CC
		mov	[ebp+var_30], eax
		mov	[ebp+var_3C], 0
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Str], eax ; char *
		call	sub_40719C
		mov	[ebp+File], eax
		mov	eax, [ebp+File]
		test	eax, eax
		jnz	short loc_4075D2
		mov	[esp+68h+Str], 73h
		call	sub_406AEB
		mov	[ebp+var_1C], eax
		jmp	loc_407B50
; ---------------------------------------------------------------------------

loc_4075D2:				; CODE XREF: sub_40751E+9Ej
		mov	[esp+68h+var_5C], 1 ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+Count], eax ; int
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char *
		lea	eax, [ebp+File]
		mov	[esp+68h+Str], eax ; int
		call	sub_40737F
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_407B4F
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Str], eax
		call	gcry_free
		jmp	loc_40793A
; ---------------------------------------------------------------------------

loc_40761F:				; CODE XREF: sub_40751E+435j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 63h
		jz	short loc_40764A
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 75h
		jz	short loc_40764A
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 69h
		jnz	loc_407905

loc_40764A:				; CODE XREF: sub_40751E+112j
					; sub_40751E+11Cj
		mov	[esp+68h+Val], 7Ch
		mov	[esp+68h+Str], 1
		call	gcry_calloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_407674
		call	sub_406B2E
		mov	[ebp+var_1C], eax
		jmp	loc_407B50
; ---------------------------------------------------------------------------

loc_407674:				; CODE XREF: sub_40751E+147j
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_14]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 69h
		jnz	short loc_4076BA
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+Str], eax ; Str
		call	atoi
		mov	edx, [ebp+var_14]
		mov	[edx+24h], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+24h]
		test	eax, eax
		jg	short loc_4076CE
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+24h], 1
		jmp	short loc_4076CE
; ---------------------------------------------------------------------------

loc_4076BA:				; CODE XREF: sub_40751E+170j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 75h
		jnz	short loc_4076CE
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+28h], 1

loc_4076CE:				; CODE XREF: sub_40751E+18Ej
					; sub_40751E+19Aj ...
		mov	[ebp+var_24], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+Source], eax
		jmp	loc_407860
; ---------------------------------------------------------------------------

loc_4076E0:				; CODE XREF: sub_40751E+346j
		mov	[esp+68h+Val], 3Ah ; Val
		mov	eax, [ebp+Source]
		mov	[esp+68h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_407706
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0
		add	[ebp+var_2C], 1

loc_407706:				; CODE XREF: sub_40751E+1DCj
		cmp	[ebp+var_24], 0Bh ; switch 12 cases
		ja	loc_407820	; jumptable 0040771D default case
		mov	eax, [ebp+var_24]
		shl	eax, 2
		add	eax, offset off_42F06C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40771F:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+var_14] ; jumptable 0040771D case 2
		mov	edx, [ebp+Source]
		mov	[eax+1Ch], edx
		jmp	loc_407856
; ---------------------------------------------------------------------------

loc_40772D:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+Source] ; jumptable 0040771D case 3
		mov	[esp+68h+Str], eax
		call	sub_416568
		mov	edx, [ebp+var_14]
		mov	[edx+18h], eax
		jmp	loc_407856
; ---------------------------------------------------------------------------

loc_407743:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+Source] ; jumptable 0040771D case 4
		mov	[esp+68h+Str], eax
		call	sub_416568
		mov	edx, [ebp+var_14]
		mov	[edx+14h], eax
		jmp	loc_407856
; ---------------------------------------------------------------------------

loc_407759:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+Source] ; jumptable 0040771D case 5
		mov	edx, [ebp+var_14]
		add	edx, 30h
		mov	[esp+68h+Count], 0Fh ; Count
		mov	[esp+68h+Val], eax ; Source
		mov	[esp+68h+Str], edx ; Dest
		call	strncpy
		jmp	loc_407856
; ---------------------------------------------------------------------------

loc_40777B:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+Source] ; jumptable 0040771D case 6
		mov	edx, [ebp+var_14]
		add	edx, 40h
		mov	[esp+68h+Count], 0Fh ; Count
		mov	[esp+68h+Val], eax ; Source
		mov	[esp+68h+Str], edx ; Dest
		call	strncpy
		jmp	loc_407856
; ---------------------------------------------------------------------------

loc_40779D:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+var_14] ; jumptable 0040771D case 7
		mov	edx, [ebp+Source]
		mov	[eax+20h], edx
		jmp	loc_407856
; ---------------------------------------------------------------------------

loc_4077AB:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+Source] ; jumptable 0040771D case 8
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_407849
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+Source]
		mov	[eax+60h], edx
		jmp	loc_407849
; ---------------------------------------------------------------------------

loc_4077C7:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+Source] ; jumptable 0040771D case 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40784C
		mov	eax, [ebp+Source]
		mov	[esp+68h+Str], eax
		call	sub_416568
		mov	edx, [ebp+var_14]
		mov	[edx+64h], eax
		jmp	short loc_40784C
; ---------------------------------------------------------------------------

loc_4077E4:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+Source] ; jumptable 0040771D case 10
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40784F
		mov	eax, [ebp+Source]
		mov	[esp+68h+Str], eax
		call	sub_416568
		mov	edx, [ebp+var_14]
		mov	[edx+68h], eax
		jmp	short loc_40784F
; ---------------------------------------------------------------------------

loc_407801:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		mov	eax, [ebp+Source] ; jumptable 0040771D case 11
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407852
		mov	eax, [ebp+Source]
		mov	[esp+68h+Str], eax
		call	gcry_strdup
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax+2Ch], edx
		jmp	short loc_407852
; ---------------------------------------------------------------------------

loc_407820:				; CODE XREF: sub_40751E+1ECj
					; sub_40751E+1FFj
					; DATA XREF: ...
		mov	eax, [ebp+Source] ; jumptable 0040771D default case
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407855
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aExtraFieldDete ;	"extra field detected in crl record of `"...
		call	sub_423387
		jmp	short loc_407855
; ---------------------------------------------------------------------------

loc_407846:				; CODE XREF: sub_40751E+1FFj
					; DATA XREF: .rdata:off_42F06Co
		nop			; jumptable 0040771D case 1
		jmp	short loc_407856
; ---------------------------------------------------------------------------

loc_407849:				; CODE XREF: sub_40751E+295j
					; sub_40751E+2A4j
		nop
		jmp	short loc_407856
; ---------------------------------------------------------------------------

loc_40784C:				; CODE XREF: sub_40751E+2B1j
					; sub_40751E+2C4j
		nop
		jmp	short loc_407856
; ---------------------------------------------------------------------------

loc_40784F:				; CODE XREF: sub_40751E+2CEj
					; sub_40751E+2E1j
		nop
		jmp	short loc_407856
; ---------------------------------------------------------------------------

loc_407852:				; CODE XREF: sub_40751E+2EBj
					; sub_40751E+300j
		nop
		jmp	short loc_407856
; ---------------------------------------------------------------------------

loc_407855:				; CODE XREF: sub_40751E+30Aj
					; sub_40751E+326j
		nop

loc_407856:				; CODE XREF: sub_40751E+20Aj
					; sub_40751E+220j ...
		mov	eax, [ebp+var_2C]
		mov	[ebp+Source], eax
		add	[ebp+var_24], 1

loc_407860:				; CODE XREF: sub_40751E+1BDj
		cmp	[ebp+Source], 0
		jnz	loc_4076E0
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_4078A5
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aInvalidLineDet ;	"invalid line detected in `%s' line %u\n"
		call	sub_423387
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str], eax
		call	gcry_free
		mov	[ebp+var_14], 0
		jmp	loc_407929
; ---------------------------------------------------------------------------

loc_4078A5:				; CODE XREF: sub_40751E+354j
		mov	eax, [ebp+var_14]
		mov	edx, [eax+1Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+68h+Val], edx ; char *
		mov	[esp+68h+Str], eax ; int
		call	sub_408D0E
		test	eax, eax
		jz	short loc_4078EE
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aDuplicateEntry ;	"duplicate entry detected in `%s' line %"...
		call	sub_423387
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str], eax
		call	gcry_free
		mov	[ebp+var_14], 0
		jmp	short loc_407929
; ---------------------------------------------------------------------------

loc_4078EE:				; CODE XREF: sub_40751E+3A0j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax
		jmp	short loc_407929
; ---------------------------------------------------------------------------

loc_407905:				; CODE XREF: sub_40751E+126j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	short loc_407929
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aUnsupportedRec ;	"unsupported record type in `%s' line %u"...
		call	sub_423387

loc_407929:				; CODE XREF: sub_40751E+382j
					; sub_40751E+3CEj ...
		cmp	[ebp+var_10], 0
		jz	short loc_40793A
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Str], eax
		call	gcry_free

loc_40793A:				; CODE XREF: sub_40751E+FCj
					; sub_40751E+40Fj
		mov	eax, [ebp+File]
		lea	edx, [ebp+var_34]
		mov	[esp+68h+Val], edx ; int
		mov	[esp+68h+Str], eax ; File
		call	sub_406F2F
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40761F
		mov	eax, [ebp+var_34]
		test	eax, eax
		jz	short loc_40798D
		mov	eax, [ebp+var_34]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Str], eax
		call	gpg_strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aErrorReading_0 ;	"error reading `%s': %s\n"
		call	sub_4233B1
		jmp	loc_407B50
; ---------------------------------------------------------------------------

loc_40798D:				; CODE XREF: sub_40751E+440j
		mov	eax, [ebp+File]
		mov	[esp+68h+Str], eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_4079D8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Str], eax ; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aErrorReading_0 ;	"error reading `%s': %s\n"
		call	sub_4233B1
		mov	[esp+68h+Str], 73h
		call	sub_406AEB
		mov	[ebp+var_1C], eax
		jmp	loc_407B50
; ---------------------------------------------------------------------------

loc_4079D8:				; CODE XREF: sub_40751E+47Cj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		jmp	loc_407B16
; ---------------------------------------------------------------------------

loc_4079E5:				; CODE XREF: sub_40751E+5FCj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_407A0B
		mov	[esp+68h+Count], 296h ;	int
		mov	[esp+68h+Val], offset a____Dirmngr1_2 ;	"../../dirmngr-1.1.1/src/crlcache.c"
		mov	[esp+68h+Str], offset aEntryLineno ; "entry->lineno"
		call	sub_429780

loc_407A0B:				; CODE XREF: sub_40751E+4CFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 28h
		jz	short loc_407A55
		add	[ebp+var_20], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aInvalidIssuerH ;	"invalid issuer	hash in	`%s' line %u\n"
		call	sub_4233B1
		jmp	short loc_407ACA
; ---------------------------------------------------------------------------

loc_407A55:				; CODE XREF: sub_40751E+512j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407A85
		add	[ebp+var_20], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aNoIssuerDnInSL ;	"no issuer DN in `%s' line %u\n"
		call	sub_4233B1
		jmp	short loc_407ACA
; ---------------------------------------------------------------------------

loc_407A85:				; CODE XREF: sub_40751E+542j
		mov	eax, [ebp+var_14]
		add	eax, 30h
		mov	[esp+68h+Str], eax
		call	sub_415A73
		test	eax, eax
		jnz	short loc_407AA9
		mov	eax, [ebp+var_14]
		add	eax, 40h
		mov	[esp+68h+Str], eax
		call	sub_415A73
		test	eax, eax
		jz	short loc_407ACA

loc_407AA9:				; CODE XREF: sub_40751E+577j
		add	[ebp+var_20], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aInvalidTimesta ;	"invalid timestamp in `%s' line %u\n"
		call	sub_4233B1

loc_407ACA:				; CODE XREF: sub_40751E+535j
					; sub_40751E+565j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 20h
		jz	short loc_407B0E
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+Str], offset aWarningInvalid ;	"WARNING: invalid cache	file hash in `%s"...
		call	sub_423387

loc_407B0E:				; CODE XREF: sub_40751E+5D1j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_407B16:				; CODE XREF: sub_40751E+4C2j
		cmp	[ebp+var_14], 0
		jnz	loc_4079E5
		cmp	[ebp+var_20], 0
		jz	short loc_407B50
		mov	[esp+68h+Str], offset aDetectedErrors ;	"detected errors in cache dir file\n"
		call	sub_4233B1
		mov	[esp+68h+Str], offset aPleaseCheckThe ;	"please	check the reason and manually de"...
		call	sub_423387
		mov	[esp+68h+Str], 73h
		call	sub_406AEB
		mov	[ebp+var_1C], eax
		jmp	short loc_407B50
; ---------------------------------------------------------------------------

loc_407B4F:				; CODE XREF: sub_40751E+DCj
		nop

loc_407B50:				; CODE XREF: sub_40751E+AFj
					; sub_40751E+151j ...
		mov	eax, [ebp+File]
		test	eax, eax
		jz	short loc_407B62
		mov	eax, [ebp+File]
		mov	[esp+68h+Str], eax ; File
		call	fclose

loc_407B62:				; CODE XREF: sub_40751E+637j
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Str], eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jz	short loc_407B90
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Str], eax
		call	sub_40714E
		mov	[ebp+var_C], 0

loc_407B90:				; CODE XREF: sub_40751E+65Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]

loc_407B9B:				; CODE XREF: sub_40751E+45j
		add	esp, 64h
		pop	edi
		pop	ebp
		retn
sub_40751E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407BA1(int, FILE *)
sub_407BA1	proc near		; CODE XREF: sub_407C68+ADp
					; sub_407C68+D5p ...

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	loc_407C58
; ---------------------------------------------------------------------------

loc_407BAC:				; CODE XREF: sub_407BA1+BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_407BDC
		mov	eax, offset off_42F09C
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 3 ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		jmp	short loc_407C54
; ---------------------------------------------------------------------------

loc_407BDC:				; CODE XREF: sub_407BA1+13j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_407C0C
		mov	eax, offset off_42F0A0
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 3 ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		jmp	short loc_407C54
; ---------------------------------------------------------------------------

loc_407C0C:				; CODE XREF: sub_407BA1+43j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_407C3C
		mov	eax, offset dword_42F0A4
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 3 ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		jmp	short loc_407C54
; ---------------------------------------------------------------------------

loc_407C3C:				; CODE XREF: sub_407BA1+73j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+arg_4]
		mov	[esp+18h+Size],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	putc

loc_407C54:				; CODE XREF: sub_407BA1+39j
					; sub_407BA1+69j ...
		add	[ebp+arg_0], 1

loc_407C58:				; CODE XREF: sub_407BA1+6j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_407BAC
		leave
		retn
sub_407BA1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407C68(FILE *, int)
sub_407C68	proc near		; CODE XREF: sub_407EC1+33Ep
					; sub_407EC1+487p

File		= dword	ptr -18h
Format		= dword	ptr -14h
Count		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_407C98
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+24h]
		mov	eax, offset aID	; "i%d"
		mov	[esp+18h+Count], edx
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax ; File
		call	fprintf
		jmp	short loc_407CCA
; ---------------------------------------------------------------------------

loc_407C98:				; CODE XREF: sub_407C68+Ej
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_407CB7
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	75h ; Ch
		call	putc
		jmp	short loc_407CCA
; ---------------------------------------------------------------------------

loc_407CB7:				; CODE XREF: sub_407C68+38j
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	63h ; Ch
		call	putc

loc_407CCA:				; CODE XREF: sub_407C68+2Ej
					; sub_407C68+4Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+Format], edx ;	File
		mov	[esp+18h+File],	eax ; Str
		call	fputs
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+18h]
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+Format], edx ;	FILE *
		mov	[esp+18h+File],	eax ; int
		call	sub_407BA1
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+Format], edx ;	FILE *
		mov	[esp+18h+File],	eax ; int
		call	sub_407BA1
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		add	eax, 30h
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_C], edx ; File
		mov	[esp+18h+Count], 1 ; Count
		mov	[esp+18h+Format], 0Fh ;	Size
		mov	[esp+18h+File],	eax ; Str
		call	fwrite
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		add	eax, 40h
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_C], edx ; File
		mov	[esp+18h+Count], 1 ; Count
		mov	[esp+18h+Format], 0Fh ;	Size
		mov	[esp+18h+File],	eax ; Str
		call	fwrite
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+20h]
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+Format], edx ;	File
		mov	[esp+18h+File],	eax ; Str
		call	fputs
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+60h]
		test	eax, eax
		jz	short loc_407E0C
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+60h]
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+Format], edx ;	File
		mov	[esp+18h+File],	eax ; Str
		call	fputs

loc_407E0C:				; CODE XREF: sub_407C68+18Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+64h]
		test	eax, eax
		jz	short loc_407E3E
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+64h]
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+Format], edx ;	FILE *
		mov	[esp+18h+File],	eax ; int
		call	sub_407BA1

loc_407E3E:				; CODE XREF: sub_407C68+1BFj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+68h]
		test	eax, eax
		jz	short loc_407E70
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+68h]
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+Format], edx ;	File
		mov	[esp+18h+File],	eax ; Str
		call	fputs

loc_407E70:				; CODE XREF: sub_407C68+1F1j
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	3Ah ; Ch
		call	putc
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_407EAC
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_407EAC
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+Format], edx ;	File
		mov	[esp+18h+File],	eax ; Str
		call	fputs

loc_407EAC:				; CODE XREF: sub_407C68+223j
					; sub_407C68+22Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Format], eax ;	File
		mov	[esp+18h+File],	0Ah ; Ch
		call	putc
		leave
		retn
sub_407C68	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407EC1	proc near		; CODE XREF: sub_40A08A+8C6p

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
File		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
NewFilename	= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str		= dword	ptr -10h
OldFilename	= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+NewFilename], 0
		mov	[ebp+OldFilename], 0
		mov	[ebp+Str], 0
		mov	[ebp+var_34], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 0
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_407F01
		mov	eax, offset aCrls_d ; "crls.d"
		jmp	short loc_407F06
; ---------------------------------------------------------------------------

loc_407F01:				; CODE XREF: sub_407EC1+37j
		mov	eax, offset aDirmngrCache_d ; "dirmngr-cache.d"

loc_407F06:				; CODE XREF: sub_407EC1+3Ej
		mov	edx, ds:dword_435FBC
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Count], offset	aDir_txt ; "DIR.txt"
		mov	[esp+68h+Mode],	eax
		mov	[esp+68h+Filename], edx
		call	sub_4259CC
		mov	[ebp+NewFilename], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		jmp	short loc_407F47
; ---------------------------------------------------------------------------

loc_407F35:				; CODE XREF: sub_407EC1+8Aj
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_18], eax

loc_407F47:				; CODE XREF: sub_407EC1+72j
		cmp	[ebp+var_18], 0
		jnz	short loc_407F35
		mov	[ebp+var_3C], 0
		mov	edx, offset aR_0 ; "r"
		mov	eax, [ebp+NewFilename]
		mov	[esp+68h+Mode],	edx ; Mode
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		mov	eax, [ebp+File]
		test	eax, eax
		jnz	short loc_407FB3
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax
		call	sub_406B13
		mov	[ebp+var_1C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax	; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+NewFilename]
		mov	[esp+68h+Mode],	eax ; char
		mov	[esp+68h+Filename], offset aFailedToOpenCa ; "failed to	open cache dir file `%s': %s\"...
		call	sub_4233B1
		jmp	loc_408509
; ---------------------------------------------------------------------------

loc_407FB3:				; CODE XREF: sub_407EC1+AFj
		mov	[esp+68h+var_5C], 0 ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+Count], eax ; int
		mov	eax, [ebp+NewFilename]
		mov	[esp+68h+Mode],	eax ; char *
		lea	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; int
		call	sub_40737F
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_408505
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	rewind
		mov	[ebp+var_3C], 0
		mov	[ebp+var_2C], offset aUnknown ;	"unknown"
		call	_getpid
		lea	edx, [ebp+var_40]
		mov	[esp+68h+var_58], edx
		mov	[esp+68h+var_5C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Count], eax
		mov	[esp+68h+Mode],	offset aDirTmpSUP_txt_ ; "DIR-tmp-%s-%u-%p.txt.tmp"
		lea	eax, [ebp+var_40]
		mov	[esp+68h+Filename], eax
		call	sub_41F7BB
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_40806C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax
		call	sub_406B13
		mov	[ebp+var_1C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax	; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+68h+Mode],	eax ; char
		mov	[esp+68h+Filename], offset aFailedToCreate ; "failed to	create temporary cache dir fi"...
		call	sub_4233B1
		jmp	loc_408509
; ---------------------------------------------------------------------------

loc_40806C:				; CODE XREF: sub_407EC1+168j
		mov	eax, [ebp+var_40]
		mov	[ebp+var_20], eax
		jmp	short loc_408088
; ---------------------------------------------------------------------------

loc_408074:				; CODE XREF: sub_407EC1+1CFj
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_408084
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	2Eh

loc_408084:				; CODE XREF: sub_407EC1+1BBj
		add	[ebp+var_20], 1

loc_408088:				; CODE XREF: sub_407EC1+1B1j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408074
		mov	ecx, [ebp+var_40]
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_4080A5
		mov	eax, offset aCrls_d ; "crls.d"
		jmp	short loc_4080AA
; ---------------------------------------------------------------------------

loc_4080A5:				; CODE XREF: sub_407EC1+1DBj
		mov	eax, offset aDirmngrCache_d ; "dirmngr-cache.d"

loc_4080AA:				; CODE XREF: sub_407EC1+1E2j
		mov	edx, ds:dword_435FBC
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Count], ecx
		mov	[esp+68h+Mode],	eax
		mov	[esp+68h+Filename], edx
		call	sub_4259CC
		mov	[ebp+OldFilename], eax
		mov	eax, [ebp+var_40]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	edx, offset aW	; "w"
		mov	eax, [ebp+OldFilename]
		mov	[esp+68h+Mode],	edx ; Mode
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_4082D8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax
		call	sub_406B13
		mov	[ebp+var_1C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax	; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+68h+Mode],	eax ; char
		mov	[esp+68h+Filename], offset aFailedToCreate ; "failed to	create temporary cache dir fi"...
		call	sub_4233B1
		jmp	loc_408509
; ---------------------------------------------------------------------------

loc_408138:				; CODE XREF: sub_407EC1+431j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 63h
		jz	short loc_408163
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 75h
		jz	short loc_408163
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 69h
		jnz	loc_4082A6

loc_408163:				; CODE XREF: sub_407EC1+288j
					; sub_407EC1+292j
		mov	[esp+68h+Mode],	3Ah ; Val
		mov	eax, [ebp+Str]
		mov	[esp+68h+Filename], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_408198
		add	[ebp+var_24], 1
		mov	[esp+68h+Mode],	3Ah ; Val
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Filename], eax	; Str
		call	strchr
		jmp	short loc_40819D
; ---------------------------------------------------------------------------

loc_408198:				; CODE XREF: sub_407EC1+2BCj
		mov	eax, 0

loc_40819D:				; CODE XREF: sub_407EC1+2D5j
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	loc_408259
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_24]
		mov	[esp+68h+Mode],	edx ; char *
		mov	[esp+68h+Filename], eax	; int
		call	sub_408D0E
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	3Ah
		cmp	[ebp+var_18], 0
		jz	short loc_4081EC
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4081EC
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	loc_4082CB
; ---------------------------------------------------------------------------

loc_4081EC:				; CODE XREF: sub_407EC1+310j
					; sub_407EC1+31Aj
		cmp	[ebp+var_18], 0
		jz	short loc_408213
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Mode],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; FILE *
		call	sub_407C68
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	loc_4082A4
; ---------------------------------------------------------------------------

loc_408213:				; CODE XREF: sub_407EC1+32Fj
		call	_getpid
		mov	edx, eax
		mov	eax, offset aNextLineAddedB ; "# Next line added by another process; o"...
		mov	[esp+68h+Count], edx
		mov	[esp+68h+Mode],	eax ; Format
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; File
		call	fprintf
		mov	eax, [ebp+Str]
		mov	edx, [ebp+var_14]
		mov	[esp+68h+Mode],	edx ; File
		mov	[esp+68h+Filename], eax	; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Mode],	eax ; File
		mov	[esp+68h+Filename], 0Ah	; Ch
		call	putc
		jmp	short loc_4082A4
; ---------------------------------------------------------------------------

loc_408259:				; CODE XREF: sub_407EC1+2E3j
		mov	eax, offset aInvalidLineD_0 ; "# Invalid line detected:	"
		mov	edx, [ebp+var_14]
		mov	[esp+68h+var_5C], edx ;	File
		mov	[esp+68h+Count], 19h ; Count
		mov	[esp+68h+Mode],	1 ; Size
		mov	[esp+68h+Filename], eax	; Str
		call	fwrite
		mov	eax, [ebp+Str]
		mov	edx, [ebp+var_14]
		mov	[esp+68h+Mode],	edx ; File
		mov	[esp+68h+Filename], eax	; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Mode],	eax ; File
		mov	[esp+68h+Filename], 0Ah	; Ch
		call	putc
		jmp	short loc_4082CB
; ---------------------------------------------------------------------------

loc_4082A4:				; CODE XREF: sub_407EC1+34Dj
					; sub_407EC1+396j
		jmp	short loc_4082CB
; ---------------------------------------------------------------------------

loc_4082A6:				; CODE XREF: sub_407EC1+29Cj
		mov	eax, [ebp+Str]
		mov	edx, [ebp+var_14]
		mov	[esp+68h+Mode],	edx ; File
		mov	[esp+68h+Filename], eax	; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Mode],	eax ; File
		mov	[esp+68h+Filename], 0Ah	; Ch
		call	putc

loc_4082CB:				; CODE XREF: sub_407EC1+326j
					; sub_407EC1+3E1j ...
		mov	eax, [ebp+Str]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		jmp	short loc_4082D9
; ---------------------------------------------------------------------------

loc_4082D8:				; CODE XREF: sub_407EC1+230j
		nop

loc_4082D9:				; CODE XREF: sub_407EC1+415j
		mov	eax, [ebp+File]
		lea	edx, [ebp+var_34]
		mov	[esp+68h+Mode],	edx ; int
		mov	[esp+68h+Filename], eax	; File
		call	sub_406F2F
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	loc_408138
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	ferror
		test	eax, eax
		jnz	short loc_408365
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; File
		call	ferror
		test	eax, eax
		jnz	short loc_408365
		mov	eax, [ebp+var_34]
		test	eax, eax
		jnz	short loc_408365
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		jmp	short loc_40835F
; ---------------------------------------------------------------------------

loc_408327:				; CODE XREF: sub_407EC1+4A2j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_408357
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40834D
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Mode],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; FILE *
		call	sub_407C68

loc_40834D:				; CODE XREF: sub_407EC1+478j
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0

loc_408357:				; CODE XREF: sub_407EC1+46Ej
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_18], eax

loc_40835F:				; CODE XREF: sub_407EC1+464j
		cmp	[ebp+var_18], 0
		jnz	short loc_408327

loc_408365:				; CODE XREF: sub_407EC1+444j
					; sub_407EC1+453j ...
		mov	eax, [ebp+var_34]
		test	eax, eax
		jz	short loc_408399
		mov	eax, [ebp+var_34]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Filename], eax
		call	gpg_strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+NewFilename]
		mov	[esp+68h+Mode],	eax ; char
		mov	[esp+68h+Filename], offset aErrorReading_0 ; "error reading `%s': %s\n"
		call	sub_4233B1
		jmp	loc_408509
; ---------------------------------------------------------------------------

loc_408399:				; CODE XREF: sub_407EC1+4A9j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	ferror
		test	eax, eax
		jz	short loc_4083E4
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax
		call	sub_406B13
		mov	[ebp+var_1C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax	; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+NewFilename]
		mov	[esp+68h+Mode],	eax ; char
		mov	[esp+68h+Filename], offset aErrorReading_0 ; "error reading `%s': %s\n"
		call	sub_4233B1

loc_4083E4:				; CODE XREF: sub_407EC1+4E5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; File
		call	ferror
		test	eax, eax
		jz	short loc_40842F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax
		call	sub_406B13
		mov	[ebp+var_1C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax	; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+68h+Mode],	eax ; char
		mov	[esp+68h+Filename], offset aErrorWritingSS ; "error writing `%s': %s\n"
		call	sub_4233B1

loc_40842F:				; CODE XREF: sub_407EC1+530j
		cmp	[ebp+var_1C], 0
		jnz	loc_408508
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	[ebp+File], 0
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		test	eax, eax
		jz	short loc_408498
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax
		call	sub_406B13
		mov	[ebp+var_1C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax	; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+68h+Mode],	eax ; char
		mov	[esp+68h+Filename], offset aErrorClosingSS ; "error closing `%s': %s\n"
		call	sub_4233B1
		jmp	short loc_408509
; ---------------------------------------------------------------------------

loc_408498:				; CODE XREF: sub_407EC1+597j
		mov	[ebp+var_14], 0
		mov	eax, [ebp+NewFilename]
		mov	[esp+68h+Filename], eax	; Filename
		call	_unlink
		mov	eax, [ebp+NewFilename]
		mov	[esp+68h+Mode],	eax ; NewFilename
		mov	eax, [ebp+OldFilename]
		mov	[esp+68h+Filename], eax	; OldFilename
		call	rename
		test	eax, eax
		jz	short loc_408509
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax
		call	sub_406B13
		mov	[ebp+var_1C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Filename], eax	; int
		call	strerror
		mov	[esp+68h+var_5C], eax
		mov	eax, [ebp+NewFilename]
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+68h+Mode],	eax ; char
		mov	[esp+68h+Filename], offset aErrorRenamingS ; "error renaming `%s' to `%s': %s\n"
		call	sub_4233B1
		jmp	short loc_408509
; ---------------------------------------------------------------------------

loc_408505:				; CODE XREF: sub_407EC1+11Aj
		nop
		jmp	short loc_408509
; ---------------------------------------------------------------------------

loc_408508:				; CODE XREF: sub_407EC1+572j
		nop

loc_408509:				; CODE XREF: sub_407EC1+EDj
					; sub_407EC1+1A6j ...
		mov	eax, [ebp+Str]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+File]
		test	eax, eax
		jz	short loc_408526
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose

loc_408526:				; CODE XREF: sub_407EC1+658j
		mov	eax, [ebp+NewFilename]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		cmp	[ebp+var_14], 0
		jz	short loc_408559
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		cmp	[ebp+var_1C], 0
		jz	short loc_408559
		cmp	[ebp+OldFilename], 0
		jz	short loc_408559
		mov	eax, [ebp+OldFilename]
		mov	[esp+68h+Filename], eax	; Filename
		call	remove

loc_408559:				; CODE XREF: sub_407EC1+674j
					; sub_407EC1+685j ...
		mov	eax, [ebp+OldFilename]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		leave
		retn
sub_407EC1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408569	proc near		; CODE XREF: sub_40895E+144p
					; sub_40A08A+81Dp

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_4C		= dword	ptr -4Ch
var_3A		= byte ptr -3Ah
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 28h
		jz	short loc_4085B0
		mov	[esp+68h+var_60], 3CDh ; int
		mov	[esp+68h+var_64], offset a____Dirmngr1_2 ; "../../dirmngr-1.1.1/src/crlcache.c"
		mov	[esp+68h+var_68], offset aStrlenIssuer_h ; "strlen (issuer_hash) == 40"
		call	sub_429780

loc_4085B0:				; CODE XREF: sub_408569+29j
		mov	edx, offset aCrl ; "crl-"
		lea	eax, [ebp+var_3A]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [ebp+var_3A]
		add	edx, 4
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		mov	ecx, [eax+8]
		mov	[edx+8], ecx
		mov	ecx, [eax+0Ch]
		mov	[edx+0Ch], ecx
		mov	ecx, [eax+10h]
		mov	[edx+10h], ecx
		mov	ecx, [eax+14h]
		mov	[edx+14h], ecx
		mov	ecx, [eax+18h]
		mov	[edx+18h], ecx
		mov	ecx, [eax+1Ch]
		mov	[edx+1Ch], ecx
		mov	ecx, [eax+20h]
		mov	[edx+20h], ecx
		mov	eax, [eax+24h]
		mov	[edx+24h], eax
		mov	eax, offset a_db ; ".db"
		lea	edx, [ebp+var_3A]
		add	edx, 2Ch
		mov	eax, [eax]
		mov	[edx], eax
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_40861E
		mov	eax, offset aCrls_d ; "crls.d"
		jmp	short loc_408623
; ---------------------------------------------------------------------------

loc_40861E:				; CODE XREF: sub_408569+ACj
		mov	eax, offset aDirmngrCache_d ; "dirmngr-cache.d"

loc_408623:				; CODE XREF: sub_408569+B3j
		mov	edx, ds:dword_435FBC
		mov	[esp+68h+var_5C], 0
		lea	ecx, [ebp+var_3A]
		mov	[esp+68h+var_60], ecx
		mov	[esp+68h+var_64], eax
		mov	[esp+68h+var_68], edx
		call	sub_4259CC
		add	esp, 64h
		pop	edi
		pop	ebp
		retn
sub_408569	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40864A(char *, int)
sub_40864A	proc near		; CODE XREF: sub_4088CA+64p
					; sub_40A08A+3ACp

Filename	= dword	ptr -58h
Mode		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
File		= dword	ptr -10h
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[esp+58h+Filename], 10000h
		call	gcry_malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jz	short loc_40867C
		mov	eax, offset aRb	; "rb"
		mov	[esp+58h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Filename], eax	; Filename
		call	fopen
		jmp	short loc_408681
; ---------------------------------------------------------------------------

loc_40867C:				; CODE XREF: sub_40864A+1Aj
		mov	eax, 0

loc_408681:				; CODE XREF: sub_40864A+30j
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_4086C7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Filename], eax	; int
		call	strerror
		mov	[esp+58h+Count], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aCanTHashSS ; "can't hash `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+Dest]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	loc_4088C4
; ---------------------------------------------------------------------------

loc_4086C7:				; CODE XREF: sub_40864A+3Ej
		mov	[esp+58h+Count], 0
		mov	[esp+58h+Mode],	1
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+Filename], eax
		call	gcry_md_open
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_408726
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Filename], eax
		call	gpg_strerror
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aErrorSettingUp ; "error setting up MD5 hash	context: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+Dest]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+File]
		mov	[esp+58h+Filename], eax	; File
		call	fclose
		mov	eax, 0FFFFFFFFh
		jmp	loc_4088C4
; ---------------------------------------------------------------------------

loc_408726:				; CODE XREF: sub_40864A+9Fj
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_408736
		mov	eax, offset aCrls_d ; "crls.d"
		jmp	short loc_40873B
; ---------------------------------------------------------------------------

loc_408736:				; CODE XREF: sub_40864A+E3j
		mov	eax, offset aDirmngrCache_d ; "dirmngr-cache.d"

loc_40873B:				; CODE XREF: sub_40864A+EAj
		mov	edx, offset a_100s_100sD ; "%.100s/%.100s:%d"
		mov	[esp+58h+var_48], 1
		mov	[esp+58h+var_4C], offset aDir_txt ; "DIR.txt"
		mov	[esp+58h+Count], eax
		mov	[esp+58h+Mode],	edx ; Format
		mov	eax, [ebp+Dest]
		mov	[esp+58h+Filename], eax	; Dest
		call	sprintf
		mov	eax, [ebp+Dest]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Count], edx
		mov	edx, [ebp+Dest]
		mov	[esp+58h+Mode],	edx
		mov	[esp+58h+Filename], eax
		call	gcry_md_write

loc_408798:				; CODE XREF: sub_40864A+1FDj
		mov	eax, [ebp+Dest]
		mov	edx, [ebp+File]
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 10000h	; Count
		mov	[esp+58h+Mode],	1 ; ElementSize
		mov	[esp+58h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFh
		ja	short loc_408828
		mov	eax, [ebp+File]
		mov	[esp+58h+Filename], eax	; File
		call	ferror
		test	eax, eax
		jz	short loc_408828
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Filename], eax	; int
		call	strerror
		mov	[esp+58h+Count], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aErrorHashingSS ; "error hashing `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+Dest]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+File]
		mov	[esp+58h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Filename], eax
		call	gcry_md_close
		mov	eax, 0FFFFFFFFh
		jmp	loc_4088C4
; ---------------------------------------------------------------------------

loc_408828:				; CODE XREF: sub_40864A+17Aj
					; sub_40864A+189j
		cmp	[ebp+var_18], 0
		jz	short loc_40884C
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		mov	[esp+58h+Count], edx
		mov	edx, [ebp+Dest]
		mov	[esp+58h+Mode],	edx
		mov	[esp+58h+Filename], eax
		call	gcry_md_write
		jmp	loc_408798
; ---------------------------------------------------------------------------

loc_40884C:				; CODE XREF: sub_40864A+1E2j
		nop
		mov	eax, [ebp+File]
		mov	[esp+58h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+Dest]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Count], 0
		mov	[esp+58h+Mode],	5
		mov	[esp+58h+Filename], eax
		call	gcry_md_ctl
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Mode],	1
		mov	[esp+58h+Filename], eax
		call	gcry_md_read
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Filename], eax
		call	gcry_md_close
		mov	eax, 0

loc_4088C4:				; CODE XREF: sub_40864A+78j
					; sub_40864A+D7j ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_40864A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4088CA(char *, int)
sub_4088CA	proc near		; CODE XREF: sub_40895E+182p

Buf1		= dword	ptr -48h
Buf2		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= byte ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 20h
		jz	short loc_40890F
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Buf2],	eax ; char
		mov	[esp+48h+Buf1],	offset aInvalidFormatt ; "invalid formatted checksum for `%s'\n"
		call	sub_4233B1
		mov	eax, 0FFFFFFFFh
		jmp	short loc_408958
; ---------------------------------------------------------------------------

loc_40890F:				; CODE XREF: sub_4088CA+29j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Buf2],	eax
		lea	eax, [ebp+var_18]
		mov	[esp+48h+Buf1],	eax
		call	sub_416255
		lea	eax, [ebp+var_28]
		mov	[esp+48h+Buf2],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Buf1],	eax ; char *
		call	sub_40864A
		test	eax, eax
		jz	short loc_40893E
		mov	eax, 0FFFFFFFFh
		jmp	short loc_408958
; ---------------------------------------------------------------------------

loc_40893E:				; CODE XREF: sub_4088CA+6Bj
		mov	[esp+48h+Size],	10h ; Size
		lea	eax, [ebp+var_28]
		mov	[esp+48h+Buf2],	eax ; Buf2
		lea	eax, [ebp+var_18]
		mov	[esp+48h+Buf1],	eax ; Buf1
		call	memcmp

loc_408958:				; CODE XREF: sub_4088CA+43j
					; sub_4088CA+72j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_4088CA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40895E	proc near		; CODE XREF: sub_408DFB+152p
					; sub_40AA09+2BCp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+6Ch]
		test	eax, eax
		jz	short loc_408988
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+70h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_4]
		mov	[eax+70h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+6Ch]
		jmp	locret_408C3A
; ---------------------------------------------------------------------------

loc_408988:				; CODE XREF: sub_40895E+Ej
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_4089AF
; ---------------------------------------------------------------------------

loc_408999:				; CODE XREF: sub_40895E+55j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+6Ch]
		test	eax, eax
		jz	short loc_4089A7
		add	[ebp+var_C], 1

loc_4089A7:				; CODE XREF: sub_40895E+43j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_4089AF:				; CODE XREF: sub_40895E+39j
		cmp	[ebp+var_10], 0
		jnz	short loc_408999
		jmp	loc_408A8F
; ---------------------------------------------------------------------------

loc_4089BA:				; CODE XREF: sub_40895E+135j
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_408A08
; ---------------------------------------------------------------------------

loc_4089D2:				; CODE XREF: sub_40895E+AEj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+6Ch]
		test	eax, eax
		jz	short loc_408A00
		mov	eax, [ebp+var_10]
		mov	eax, [eax+70h]
		test	eax, eax
		jnz	short loc_408A00
		mov	eax, [ebp+var_10]
		mov	eax, [eax+74h]
		cmp	eax, [ebp+var_18]
		jnb	short loc_408A00
		mov	eax, [ebp+var_10]
		mov	eax, [eax+74h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax

loc_408A00:				; CODE XREF: sub_40895E+7Cj
					; sub_40895E+86j ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_408A08:				; CODE XREF: sub_40895E+72j
		cmp	[ebp+var_10], 0
		jnz	short loc_4089D2
		cmp	[ebp+var_14], 0
		jnz	short loc_408A2A
		mov	[esp+38h+var_38], offset aTooManyOpenCac ; "too	many open cache	files; can't open a"...
		call	sub_4233B1
		mov	eax, 0
		jmp	locret_408C3A
; ---------------------------------------------------------------------------

loc_408A2A:				; CODE XREF: sub_40895E+B4j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+6Ch]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+6Ch]
		mov	[esp+38h+var_38], eax
		call	sub_40F169
		mov	eax, [ebp+var_14]
		mov	eax, [eax+6Ch]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+6Ch], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	_close
		test	eax, eax
		jz	short loc_408A8B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aErrorClosingCa ; "error closing cache	file: %s\n"
		call	sub_4233B1

loc_408A8B:				; CODE XREF: sub_40895E+10Aj
		sub	[ebp+var_C], 1

loc_408A8F:				; CODE XREF: sub_40895E+57j
		cmp	[ebp+var_C], 4
		jg	loc_4089BA
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+1Ch]
		mov	[esp+38h+var_38], eax
		call	sub_408569
		mov	[ebp+var_20], eax
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_408AC6
		mov	eax, [ebp+var_20]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aOpeningCacheFi ; "opening cache file `%s'\n"
		call	sub_423387

loc_408AC6:				; CODE XREF: sub_40895E+153j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+78h]
		test	eax, eax
		jnz	short loc_408AF3
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+20h]
		mov	dword ptr [esp+38h+var_34], eax	; int
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_4088CA
		test	eax, eax
		jnz	short loc_408AF3
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+78h], 1

loc_408AF3:				; CODE XREF: sub_40895E+170j
					; sub_40895E+189j
		mov	dword ptr [esp+38h+var_34], 20h
		mov	[esp+38h+var_38], 1
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+6Ch], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+6Ch]
		test	eax, eax
		jnz	short loc_408B2E
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_408C3A
; ---------------------------------------------------------------------------

loc_408B2E:				; CODE XREF: sub_40895E+1B9j
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	_open
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_408B9F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_20]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aErrorOpeningCa ; "error opening cache	file `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+6Ch]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+6Ch], 0
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_408C3A
; ---------------------------------------------------------------------------

loc_408B9F:				; CODE XREF: sub_40895E+1EAj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+6Ch]
		mov	edx, [ebp+var_1C]
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_40F01C
		test	eax, eax
		jz	short loc_408C15
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_20]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aErrorInitializ ; "error initializing cache file `%s' for "...
		call	sub_4233B1
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+6Ch]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+6Ch], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	_close
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, 0
		jmp	short locret_408C3A
; ---------------------------------------------------------------------------

loc_408C15:				; CODE XREF: sub_40895E+258j
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+70h], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+74h], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+6Ch]

locret_408C3A:				; CODE XREF: sub_40895E+25j
					; sub_40895E+C7j ...
		leave
		retn
sub_40895E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408C3C	proc near		; CODE XREF: sub_408DFB+194p
					; sub_408DFB+39Cp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+6Ch]
		test	eax, eax
		jnz	short loc_408C5A
		mov	[esp+28h+var_28], offset aCallingUnlock_ ; "calling unlock_db_file on a	closed file"...
		call	sub_4233B1
		jmp	short loc_408C90
; ---------------------------------------------------------------------------

loc_408C5A:				; CODE XREF: sub_408C3C+Ej
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+70h]
		test	eax, eax
		jnz	short loc_408C72
		mov	[esp+28h+var_28], offset aCallingUnloc_0 ; "calling unlock_db_file on an unlocked f"...
		call	sub_4233B1
		jmp	short loc_408C90
; ---------------------------------------------------------------------------

loc_408C72:				; CODE XREF: sub_408C3C+26j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+70h]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_4]
		mov	[eax+70h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+74h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_4]
		mov	[eax+74h], edx

loc_408C90:				; CODE XREF: sub_408C3C+1Cj
					; sub_408C3C+34j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+70h]
		test	eax, eax
		jnz	short locret_408D0C
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short locret_408D0C
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_408CBE
; ---------------------------------------------------------------------------

loc_408CB6:				; CODE XREF: sub_408C3C+90j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_408CBE:				; CODE XREF: sub_408C3C+78j
		cmp	[ebp+var_C], 0
		jz	short loc_408CCE
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_408CB6

loc_408CCE:				; CODE XREF: sub_408C3C+86j
		cmp	[ebp+var_C], 0
		jnz	short loc_408CF0
		mov	[esp+28h+var_20], 4A4h ; int
		mov	[esp+28h+var_24], offset a____Dirmngr1_2 ; "../../dirmngr-1.1.1/src/crlcache.c"
		mov	[esp+28h+var_28], offset aEprev	; "eprev"
		call	sub_429780

loc_408CF0:				; CODE XREF: sub_408C3C+96j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, [ebp+var_C]
		jnz	short loc_408D04
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short locret_408D0C
; ---------------------------------------------------------------------------

loc_408D04:				; CODE XREF: sub_408C3C+BCj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

locret_408D0C:				; CODE XREF: sub_408C3C+5Cj
					; sub_408C3C+66j ...
		leave
		retn
sub_408C3C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408D0E(int, char *)
sub_408D0E	proc near		; CODE XREF: sub_40751E+399p
					; sub_407EC1+2FEp ...

Str1		= dword	ptr -18h
Str2		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_408D1E
; ---------------------------------------------------------------------------

loc_408D16:				; CODE XREF: sub_408D0E+1Ej
					; sub_408D0E+37j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+arg_0], eax

loc_408D1E:				; CODE XREF: sub_408D0E+6j
		cmp	[ebp+arg_0], 0
		jz	short loc_408D47
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_408D16
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+18h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408D16

loc_408D47:				; CODE XREF: sub_408D0E+14j
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_408D0E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D4C	proc near		; CODE XREF: sub_4020C2+AFBp
					; sub_4020C2+E1Ap ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_435058
		test	eax, eax
		jz	short loc_408D70
		mov	[esp+28h+var_28], offset aCrlCacheHasAlr ; "crl	cache has already been initialized "...
		call	sub_4233B1
		jmp	short locret_408DA7
; ---------------------------------------------------------------------------

loc_408D70:				; CODE XREF: sub_408D4C+14j
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_40751E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408D9F
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToCrea_0 ; "failed to create a new cache object: %s"...
		call	sub_4233F4
; ---------------------------------------------------------------------------

loc_408D9F:				; CODE XREF: sub_408D4C+36j
		mov	eax, [ebp+var_10]
		mov	ds:dword_435058, eax

locret_408DA7:				; CODE XREF: sub_408D4C+22j
		leave
		retn
sub_408D4C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408DA9	proc near		; CODE XREF: sub_403566+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_435058
		test	eax, eax
		jz	short locret_408DCF
		mov	eax, ds:dword_435058
		mov	[esp+18h+var_18], eax
		call	sub_40714E
		mov	ds:dword_435058, 0

locret_408DCF:				; CODE XREF: sub_408DA9+Dj
		leave
		retn
sub_408DA9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408DD1	proc near		; CODE XREF: sub_4020C2:loc_403189p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0
		call	sub_406CA5
		test	eax, eax
		jz	short loc_408DEE
		mov	eax, 0FFFFFFFFh
		jmp	short loc_408DF3
; ---------------------------------------------------------------------------

loc_408DEE:				; CODE XREF: sub_408DD1+14j
		mov	eax, 0

loc_408DF3:				; CODE XREF: sub_408DD1+1Bj
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408DD1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408DFB(int, char *, void *, size_t, int)
sub_408DFB	proc near		; CODE XREF: sub_4091A1+8Ep
					; sub_409253+1B4p

Str1		= dword	ptr -68h
Str2		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_48		= byte ptr -48h
var_38		= byte ptr -38h
var_28		= byte ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		call	sub_406BB9
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_4]
		mov	[esp+68h+Str2],	edx ; char *
		mov	[esp+68h+Str1],	eax ; int
		call	sub_408D0E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_408E43
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Str2],	eax ; char
		mov	[esp+68h+Str1],	offset aNoCrlAvailable ; "no CRL available for issuer id %s\n"
		call	sub_423387
		mov	eax, 2
		jmp	locret_40919F
; ---------------------------------------------------------------------------

loc_408E43:				; CODE XREF: sub_408DFB+29j
		lea	eax, [ebp+var_38]
		mov	[esp+68h+Str1],	eax ; char *
		call	sub_415940
		mov	eax, [ebp+var_14]
		lea	edx, [eax+40h]
		lea	eax, [ebp+var_38]
		mov	[esp+68h+Str2],	eax ; Str2
		mov	[esp+68h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jns	short loc_408E84
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Str2],	eax ; char
		mov	[esp+68h+Str1],	offset aCachedCrlForIs ; "cached CRL for issuer	id %s too old; up"...
		call	sub_423387
		mov	eax, 2
		jmp	locret_40919F
; ---------------------------------------------------------------------------

loc_408E84:				; CODE XREF: sub_408DFB+6Aj
		cmp	[ebp+arg_10], 0
		jz	loc_408F19
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+50h]
		test	al, al
		jz	short loc_408EFC
		mov	eax, [ebp+var_14]
		add	eax, 50h
		mov	[esp+68h+Str2],	eax ; char *
		lea	eax, [ebp+var_48]
		mov	[esp+68h+Str1],	eax ; char *
		call	sub_406B43
		mov	[esp+68h+Str2],	708h ; int
		lea	eax, [ebp+var_48]
		mov	[esp+68h+Str1],	eax ; char *
		call	sub_415EF7
		lea	eax, [ebp+var_38]
		mov	[esp+68h+Str2],	eax ; Str2
		lea	eax, [ebp+var_48]
		mov	[esp+68h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jns	short loc_408F19
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+var_60], eax
		mov	[esp+68h+Str2],	1Eh ; char
		mov	[esp+68h+Str1],	offset aForceCrlRefr_0 ; "force-crl-refresh active and %d minutes"...
		call	sub_423387
		mov	eax, 2
		jmp	locret_40919F
; ---------------------------------------------------------------------------

loc_408EFC:				; CODE XREF: sub_408DFB+9Cj
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Str2],	eax ; char
		mov	[esp+68h+Str1],	offset aForceCrlRefr_1 ; "force-crl-refresh active for issuer id "...
		call	sub_423387
		mov	eax, 2
		jmp	locret_40919F
; ---------------------------------------------------------------------------

loc_408F19:				; CODE XREF: sub_408DFB+8Dj
					; sub_408DFB+DAj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_408F40
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Str2],	eax ; char
		mov	[esp+68h+Str1],	offset aAvailableCrlFo ; "available CRL	for issuer ID %s can't be"...
		call	sub_423387
		mov	eax, 3
		jmp	locret_40919F
; ---------------------------------------------------------------------------

loc_408F40:				; CODE XREF: sub_408DFB+126j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Str1],	eax
		call	sub_40895E
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_408F65
		mov	eax, 2
		jmp	locret_40919F
; ---------------------------------------------------------------------------

loc_408F65:				; CODE XREF: sub_408DFB+15Ej
		mov	eax, [ebp+var_14]
		mov	eax, [eax+78h]
		test	eax, eax
		jnz	short loc_408F9E
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Str2],	eax ; char
		mov	[esp+68h+Str1],	offset aCachedCrlFor_0 ; "cached CRL for issuer	id %s tampered;	w"...
		call	sub_4233B1
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Str1],	eax
		call	sub_408C3C
		mov	eax, 2
		jmp	locret_40919F
; ---------------------------------------------------------------------------

loc_408F9E:				; CODE XREF: sub_408DFB+172j
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+var_60], eax ;	size_t
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+Str2],	eax ; char
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Str1],	eax ; int
		call	sub_40F21A
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 1
		jnz	loc_4090AD
		mov	eax, [ebp+var_18]
		mov	eax, [eax+14h]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 10h
		jz	short loc_408FFE
		mov	[esp+68h+Str1],	offset aWarningInval_0 ; "WARNING: invalid cache record	length fo"...
		call	sub_4233B1
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+Str2],	eax
		mov	[esp+68h+Str1],	offset word_42F54A
		call	sub_4234A8
		jmp	loc_4090A4
; ---------------------------------------------------------------------------

loc_408FFE:				; CODE XREF: sub_408DFB+1D6j
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	loc_4090A4
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+Str1],	eax
		call	sub_4163EE
		mov	dword ptr [ebp+var_24],	eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		mov	[esp+68h+var_5C], eax ;	int
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_60], eax ;	size_t
		lea	eax, [ebp+var_58]
		mov	[esp+68h+Str2],	eax ; void *
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Str1],	eax ; int
		call	sub_40F1BF
		test	eax, eax
		jz	short loc_409071
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Str1],	eax ; int
		call	strerror
		mov	[esp+68h+var_60], eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+68h+Str2],	eax ; char
		mov	[esp+68h+Str1],	offset aProblemReading ; "problem reading cache	record for S/N %s"...
		call	sub_4233B1
		jmp	short loc_409099
; ---------------------------------------------------------------------------

loc_409071:				; CODE XREF: sub_408DFB+24Aj
		movzx	eax, [ebp+var_58]
		movzx	eax, al
		lea	edx, [ebp+var_58]
		add	edx, 1
		mov	[esp+68h+var_5C], edx
		mov	[esp+68h+var_60], eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+68h+Str2],	eax ; char
		mov	[esp+68h+Str1],	offset aSNSIsNotValidR ; "S/N %s is not	valid; reason=%02X  date="...
		call	sub_423387

loc_409099:				; CODE XREF: sub_408DFB+274j
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+68h+Str1],	eax
		call	gcry_free

loc_4090A4:				; CODE XREF: sub_408DFB+1FEj
					; sub_408DFB+20Aj
		mov	[ebp+var_C], 1
		jmp	short loc_409120
; ---------------------------------------------------------------------------

loc_4090AD:				; CODE XREF: sub_408DFB+1C3j
		cmp	[ebp+var_1C], 0
		jnz	short loc_4090F8
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_4090EF
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+Str1],	eax
		call	sub_4163EE
		mov	dword ptr [ebp+var_28],	eax
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+68h+Str2],	eax ; char
		mov	[esp+68h+Str1],	offset aSNSIsValidItIs ; "S/N %s is valid, it is not listed in th"...
		call	sub_423387
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+68h+Str1],	eax
		call	gcry_free

loc_4090EF:				; CODE XREF: sub_408DFB+2BFj
		mov	[ebp+var_C], 0
		jmp	short loc_409120
; ---------------------------------------------------------------------------

loc_4090F8:				; CODE XREF: sub_408DFB+2B6j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Str1],	eax ; int
		call	strerror
		mov	[esp+68h+Str2],	eax ; char
		mov	[esp+68h+Str1],	offset aErrorGettingDa ; "error	getting	data from cache	file: %s\"...
		call	sub_4233B1
		mov	[ebp+var_C], 2

loc_409120:				; CODE XREF: sub_408DFB+2B0j
					; sub_408DFB+2FBj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_40918A
		cmp	[ebp+var_C], 0
		jz	short loc_409136
		cmp	[ebp+var_C], 1
		jnz	short loc_40918A

loc_409136:				; CODE XREF: sub_408DFB+333j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	short loc_409155
		mov	[esp+68h+Str1],	offset aInconsistentDa ; "inconsistent data on user trust check\n"
		call	sub_4233B1
		mov	[ebp+var_C], 3
		jmp	short loc_40918A
; ---------------------------------------------------------------------------

loc_409155:				; CODE XREF: sub_408DFB+343j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+2Ch]
		mov	[esp+68h+Str2],	eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str1],	eax
		call	sub_404CE9
		test	eax, eax
		jz	short loc_40918A
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_409183
		mov	[esp+68h+Str1],	offset aNoSystemTrustA ; "no system trust and client does not tru"...
		call	sub_423387

loc_409183:				; CODE XREF: sub_408DFB+37Aj
		mov	[ebp+var_C], 3

loc_40918A:				; CODE XREF: sub_408DFB+32Dj
					; sub_408DFB+339j ...
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Str1],	eax
		call	sub_408C3C
		mov	eax, [ebp+var_C]

locret_40919F:				; CODE XREF: sub_408DFB+43j
					; sub_408DFB+84j ...
		leave
		retn
sub_408DFB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4091A1(int, char *, int, int)
sub_4091A1	proc near		; CODE XREF: sub_405080+19Bp

var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_46		= byte ptr -46h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 74h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		shr	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 30h
		ja	short loc_4091DD
		lea	eax, [ebp+var_46]
		mov	[ebp+var_C], eax
		jmp	short loc_4091F8
; ---------------------------------------------------------------------------

loc_4091DD:				; CODE XREF: sub_4091A1+32j
		mov	eax, [ebp+var_10]
		mov	[esp+78h+var_78], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4091F8
		mov	eax, 2
		jmp	short loc_40924D
; ---------------------------------------------------------------------------

loc_4091F8:				; CODE XREF: sub_4091A1+3Aj
					; sub_4091A1+4Ej
		mov	eax, [ebp+arg_8]
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	sub_416255
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_68], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+78h+var_6C], eax ;	size_t
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_70], eax ;	void *
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_74], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+var_78], eax ;	int
		call	sub_408DFB
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_46]
		cmp	[ebp+var_C], eax
		jz	short loc_40924A
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	gcry_free

loc_40924A:				; CODE XREF: sub_4091A1+9Cj
		mov	eax, [ebp+var_14]

loc_40924D:				; CODE XREF: sub_4091A1+55j
		add	esp, 74h
		pop	edi
		pop	ebp
		retn
sub_4091A1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409253	proc near		; CODE XREF: sub_405484+144p
					; sub_405484+18Cp ...

Dest		= dword	ptr -98h
Format		= dword	ptr -94h
Radix		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_6C		= dword	ptr -6Ch
EndPtr		= dword	ptr -68h
var_61		= byte ptr -61h
var_38		= byte ptr -38h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
Str		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 94h
		mov	[esp+98h+Format], 0 ; char
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+Dest],	eax
		call	ksba_cert_get_issuer
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_409296
		mov	[esp+98h+Dest],	offset aOopsIssuerMiss ; "oops:	issuer missing in certificate\n"
		call	sub_4233B1
		mov	[esp+98h+Dest],	0A4h
		call	sub_406AEB
		jmp	loc_409483
; ---------------------------------------------------------------------------

loc_409296:				; CODE XREF: sub_409253+24j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+98h+var_8C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+98h+Radix], eax
		lea	eax, [ebp+var_38]
		mov	[esp+98h+Format], eax
		mov	[esp+98h+Dest],	2
		call	gcry_md_hash_buffer
		mov	eax, [ebp+var_10]
		mov	[esp+98h+Dest],	eax
		call	gcry_free
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_61]
		mov	[ebp+var_10], eax
		jmp	short loc_409319
; ---------------------------------------------------------------------------

loc_4092ED:				; CODE XREF: sub_409253+CAj
		lea	eax, [ebp+var_38]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x ; "%02X"
		mov	[esp+98h+Radix], edx
		mov	[esp+98h+Format], eax ;	char
		mov	eax, [ebp+var_10]
		mov	[esp+98h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_14], 1
		add	[ebp+var_10], 2

loc_409319:				; CODE XREF: sub_409253+98j
		cmp	[ebp+var_14], 13h
		jle	short loc_4092ED
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+Dest],	eax
		call	ksba_cert_get_serial
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_409350
		mov	[esp+98h+Dest],	offset aOopsSNMissingI ; "oops:	S/N missing in certificate\n"
		call	sub_4233B1
		mov	[esp+98h+Dest],	0A4h
		call	sub_406AEB
		jmp	loc_409483
; ---------------------------------------------------------------------------

loc_409350:				; CODE XREF: sub_409253+DEj
		mov	eax, [ebp+var_18]
		mov	[ebp+Str], eax
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_409388
		mov	[esp+98h+Dest],	offset aOopsInvalidSN ;	"oops: invalid S/N\n"
		call	sub_4233B1
		mov	eax, [ebp+var_18]
		mov	[esp+98h+Dest],	eax
		call	gcry_free
		mov	[esp+98h+Dest],	0A4h
		call	sub_406AEB
		jmp	loc_409483
; ---------------------------------------------------------------------------

loc_409388:				; CODE XREF: sub_409253+10Bj
		add	[ebp+Str], 1
		mov	eax, [ebp+Str]
		mov	[esp+98h+Radix], 0Ah ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+98h+Format], edx ;	char
		mov	[esp+98h+Dest],	eax ; Str
		call	strtoul
		mov	[ebp+var_20], eax
		mov	eax, [ebp+EndPtr]
		mov	[ebp+Str], eax
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_4093E1
		mov	[esp+98h+Dest],	offset aOopsInvalidSN ;	"oops: invalid S/N\n"
		call	sub_4233B1
		mov	eax, [ebp+var_18]
		mov	[esp+98h+Dest],	eax
		call	gcry_free
		mov	[esp+98h+Dest],	0A4h
		call	sub_406AEB
		jmp	loc_409483
; ---------------------------------------------------------------------------

loc_4093E1:				; CODE XREF: sub_409253+164j
		add	[ebp+Str], 1
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+var_88], eax ;	int
		mov	eax, [ebp+var_20]
		mov	[esp+98h+var_8C], eax ;	size_t
		mov	eax, [ebp+Str]
		mov	[esp+98h+Radix], eax ; void *
		lea	eax, [ebp+var_61]
		mov	[esp+98h+Format], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Dest],	eax ; int
		call	sub_408DFB
		mov	dword ptr [ebp+var_24],	eax
		mov	eax, dword ptr [ebp+var_24]
		cmp	eax, 1
		jz	short loc_409431
		cmp	eax, 1
		jb	short loc_409428
		cmp	eax, 2
		jz	short loc_409442
		cmp	eax, 3
		jz	short loc_409451
		jmp	short loc_409462
; ---------------------------------------------------------------------------

loc_409428:				; CODE XREF: sub_409253+1C7j
		mov	[ebp+var_C], 0
		jmp	short loc_409475
; ---------------------------------------------------------------------------

loc_409431:				; CODE XREF: sub_409253+1C2j
		mov	[esp+98h+Dest],	5Eh
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	short loc_409475
; ---------------------------------------------------------------------------

loc_409442:				; CODE XREF: sub_409253+1CCj
		mov	[esp+98h+Dest],	5Fh
		call	sub_406AEB
		mov	[ebp+var_C], eax

loc_409451:				; CODE XREF: sub_409253+1D1j
		mov	[esp+98h+Dest],	5Fh
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	short loc_409475
; ---------------------------------------------------------------------------

loc_409462:				; CODE XREF: sub_409253+1D3j
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+98h+Format], eax ;	char
		mov	[esp+98h+Dest],	offset aCache_isvalidR ; "cache_isvalid	returned invalid status	c"...
		call	sub_4233F4
; ---------------------------------------------------------------------------

loc_409475:				; CODE XREF: sub_409253+1DCj
					; sub_409253+1EDj ...
		mov	eax, [ebp+var_18]
		mov	[esp+98h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_409483:				; CODE XREF: sub_409253+3Ej
					; sub_409253+F8j ...
		add	esp, 94h
		pop	edi
		pop	ebp
		retn
sub_409253	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40948C	proc near		; CODE XREF: sub_40989B+C2p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	ksba_crl_get_digest_algo
		mov	dword ptr [ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_md_map_name
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4094EA
		cmp	dword ptr [ebp+var_C], 0
		jz	short loc_4094C4
		mov	eax, dword ptr [ebp+var_C]
		jmp	short loc_4094C9
; ---------------------------------------------------------------------------

loc_4094C4:				; CODE XREF: sub_40948C+31j
		mov	eax, offset a?	; "?"

loc_4094C9:				; CODE XREF: sub_40948C+36j
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aUnknownHashAlg ; "unknown hash algorithm `%s'\n"
		call	sub_4233B1
		mov	[esp+28h+var_28], 5
		call	sub_406AEB
		jmp	locret_40957C
; ---------------------------------------------------------------------------

loc_4094EA:				; CODE XREF: sub_40948C+2Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	gcry_md_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_409538
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_strerror
		mov	edx, [ebp+arg_8]
		mov	edx, [edx]
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+var_28], offset aGcry_md_openFo ; "gcry_md_open for algorithm %d failed: %"...
		call	sub_4233B1
		mov	eax, [ebp+var_10]
		jmp	short locret_40957C
; ---------------------------------------------------------------------------

loc_409538:				; CODE XREF: sub_40948C+81j
		mov	eax, ds:dword_435FA0
		and	eax, 200h
		test	eax, eax
		jz	short loc_40955B
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	dword ptr [esp+28h+var_24], offset aHash_cert ;	"hash.cert"
		mov	[esp+28h+var_28], eax
		call	gcry_md_debug

loc_40955B:				; CODE XREF: sub_40948C+B8j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], offset gcry_md_write
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	ksba_crl_set_hash_function
		mov	eax, 0

locret_40957C:				; CODE XREF: sub_40948C+59j
					; sub_40948C+AAj
		leave
		retn
sub_40948C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40957E	proc near		; CODE XREF: sub_40989B+4D7p

var_88		= dword	ptr -88h
var_84		= byte ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_52		= byte ptr -52h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 84h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_58], 0
		mov	[ebp+var_5C], 0
		mov	[ebp+var_60], 0
		mov	[esp+88h+var_7C], 0
		mov	[esp+88h+var_80], 0
		mov	dword ptr [esp+88h+var_84], 5
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	gcry_md_ctl
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax
		call	ksba_crl_get_sig_val
		mov	[ebp+var_1C], eax
		mov	[esp+88h+var_7C], 0
		mov	[esp+88h+var_80], 0
		mov	dword ptr [esp+88h+var_84], 0 ;	char
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+var_88], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_409628
		mov	[esp+88h+var_88], offset aGotAnInvalidSE ; "got	an invalid S-expression	from libksb"...
		call	sub_4233B1
		mov	[esp+88h+var_88], 53h
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	loc_40983A
; ---------------------------------------------------------------------------

loc_409628:				; CODE XREF: sub_40957E+88j
		mov	eax, [ebp+var_20]
		mov	[esp+88h+var_7C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+var_80], eax
		mov	dword ptr [esp+88h+var_84], 0
		lea	eax, [ebp+var_58]
		mov	[esp+88h+var_88], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409672
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gcry_strerror
		mov	dword ptr [esp+88h+var_84], eax	; char
		mov	[esp+88h+var_88], offset aConvertingSExp ; "converting S-expression failed: %s\n"
		call	sub_4233B1
		jmp	loc_40983A
; ---------------------------------------------------------------------------

loc_409672:				; CODE XREF: sub_40957E+D2j
		mov	eax, ds:dword_435FA0
		and	eax, 1
		test	al, al
		jz	short loc_409691
		mov	eax, [ebp+arg_C]
		mov	dword ptr [esp+88h+var_84], eax
		mov	[esp+88h+var_88], offset aCrl_issuer_cer ; "crl_issuer_cert"
		call	sub_416BE5

loc_409691:				; CODE XREF: sub_40957E+FEj
		mov	eax, [ebp+arg_C]
		mov	[esp+88h+var_88], eax
		call	ksba_cert_get_public_key
		mov	[ebp+var_10], eax
		mov	[esp+88h+var_7C], 0
		mov	[esp+88h+var_80], 0
		mov	dword ptr [esp+88h+var_84], 0 ;	char
		mov	eax, [ebp+var_10]
		mov	[esp+88h+var_88], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4096EB
		mov	[esp+88h+var_88], offset aGotAnInvalidSE ; "got	an invalid S-expression	from libksb"...
		call	sub_4233B1
		mov	[esp+88h+var_88], 53h
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	loc_40983A
; ---------------------------------------------------------------------------

loc_4096EB:				; CODE XREF: sub_40957E+14Bj
		mov	eax, [ebp+var_20]
		mov	[esp+88h+var_7C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+88h+var_80], eax
		mov	dword ptr [esp+88h+var_84], 0
		lea	eax, [ebp+var_60]
		mov	[esp+88h+var_88], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409735
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gcry_strerror
		mov	dword ptr [esp+88h+var_84], eax	; char
		mov	[esp+88h+var_88], offset aConvertingSExp ; "converting S-expression failed: %s\n"
		call	sub_4233B1
		jmp	loc_40983A
; ---------------------------------------------------------------------------

loc_409735:				; CODE XREF: sub_40957E+195j
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_88], eax
		call	gcry_md_algo_name
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_40976F
; ---------------------------------------------------------------------------

loc_40974C:				; CODE XREF: sub_40957E+1FFj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+88h+var_88], eax
		call	sub_4262F7
		mov	edx, eax
		lea	eax, [ebp+var_52]
		add	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_14], 1
		add	[ebp+var_18], 1

loc_40976F:				; CODE XREF: sub_40957E+1CCj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40977F
		cmp	[ebp+var_18], 30h
		jbe	short loc_40974C

loc_40977F:				; CODE XREF: sub_40957E+1F9j
		lea	eax, [ebp+var_52]
		add	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [esp+88h+var_84], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	gcry_md_read
		mov	ebx, eax
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_88], eax
		call	gcry_md_get_algo_dlen
		mov	[esp+88h+var_74], ebx
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_52]
		mov	[esp+88h+var_7C], eax
		mov	[esp+88h+var_80], offset aDataFlagsPkcs1 ; "(data(flags	pkcs1)(hash %s %b))"
		mov	dword ptr [esp+88h+var_84], 0
		lea	eax, [ebp+var_5C]
		mov	[esp+88h+var_88], eax
		call	gcry_sexp_build
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4097F7
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gcry_strerror
		mov	dword ptr [esp+88h+var_84], eax	; char
		mov	[esp+88h+var_88], offset aCreatingSExpre ; "creating S-expression failed: %s\n"
		call	sub_4233B1
		jmp	short loc_40983A
; ---------------------------------------------------------------------------

loc_4097F7:				; CODE XREF: sub_40957E+25Aj
		mov	ecx, [ebp+var_60]
		mov	edx, [ebp+var_5C]
		mov	eax, [ebp+var_58]
		mov	[esp+88h+var_80], ecx
		mov	dword ptr [esp+88h+var_84], edx
		mov	[esp+88h+var_88], eax
		call	gcry_pk_verify
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_435FA0
		and	eax, 1
		test	al, al
		jz	short loc_40983A
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gpg_strerror
		mov	dword ptr [esp+88h+var_84], eax	; char
		mov	[esp+88h+var_88], offset aGcry_pk_verify ; "gcry_pk_verify: %s\n"
		call	sub_42344E

loc_40983A:				; CODE XREF: sub_40957E+A5j
					; sub_40957E+EFj ...
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+var_88], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+88h+var_88], eax
		call	gcry_free
		mov	eax, [ebp+var_58]
		mov	[esp+88h+var_88], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_5C]
		mov	[esp+88h+var_88], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_60]
		mov	[esp+88h+var_88], eax
		call	gcry_sexp_release
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	gcry_md_close
		mov	eax, [ebp+var_C]
		add	esp, 84h
		pop	ebx
		pop	ebp
		retn
sub_40957E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409888	proc near		; CODE XREF: sub_40989B+5C4p

var_18		= dword	ptr -18h
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	gcry_md_close
		leave
		retn
sub_409888	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40989B(int, int, int,	int, int, char *, char *, int)
sub_40989B	proc near		; CODE XREF: sub_40A08A+2B6p

var_88		= dword	ptr -88h
Str1		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_64		= byte ptr -64h
var_60		= byte ptr -60h
var_5C		= dword	ptr -5Ch
Source		= dword	ptr -58h
var_54		= byte ptr -54h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 88h
		mov	[ebp+var_10], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_18]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_18]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_14]
		mov	[eax], dl
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0

loc_4098DC:				; CODE XREF: sub_40989B+585j
		lea	eax, [ebp+var_20]
		mov	[esp+88h+Str1],	eax ; char
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	ksba_crl_parse
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409917
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gpg_strerror
		mov	[esp+88h+Str1],	eax ; char
		mov	[esp+88h+var_88], offset aKsba_crl_parse ; "ksba_crl_parse failed: %s\n"
		call	sub_4233B1
		jmp	loc_409E4B
; ---------------------------------------------------------------------------

loc_409917:				; CODE XREF: sub_40989B+5Aj
		mov	eax, dword ptr [ebp+var_20]
		cmp	eax, 9
		jz	short loc_409949
		cmp	eax, 9
		ja	short loc_409932
		cmp	eax, 6
		jz	loc_409B6F
		jmp	loc_409DF6
; ---------------------------------------------------------------------------

loc_409932:				; CODE XREF: sub_40989B+87j
		cmp	eax, 0Ah
		jz	loc_409A2C
		cmp	eax, 0Bh
		jz	loc_409E13
		jmp	loc_409DF6
; ---------------------------------------------------------------------------

loc_409949:				; CODE XREF: sub_40989B+82j
		lea	eax, [ebp+var_28]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_24]
		mov	[esp+88h+Str1],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	sub_40948C
		test	eax, eax
		jnz	loc_409E4A
		mov	eax, [ebp+arg_18]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+88h+Str1],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	ksba_crl_get_update_times
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4099BB
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gpg_strerror
		mov	[esp+88h+Str1],	eax ; char
		mov	[esp+88h+var_88], offset aErrorGettingUp ; "error getting update times of CRL: %s\n"
		call	sub_4233B1
		mov	[esp+88h+var_88], 85h
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	loc_409E4B
; ---------------------------------------------------------------------------

loc_4099BB:				; CODE XREF: sub_40989B+EFj
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jnz	short loc_4099CE
		mov	eax, [ebp+arg_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4099E8

loc_4099CE:				; CODE XREF: sub_40989B+127j
		mov	eax, [ebp+arg_18]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+88h+Str1],	eax ; char
		mov	[esp+88h+var_88], offset aUpdateTimesOfT ; "update times of this CRL: this=%s next="...
		call	sub_423387

loc_4099E8:				; CODE XREF: sub_40989B+131j
		mov	eax, [ebp+arg_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_409E16
		mov	[esp+88h+var_88], offset aNextupdateNotG ; "nextUpdate not given; assuming a validi"...
		call	sub_423387
		mov	eax, [ebp+arg_14]
		mov	[esp+88h+Str1],	eax ; char *
		mov	eax, [ebp+arg_18]
		mov	[esp+88h+var_88], eax ;	char *
		call	sub_406B43
		mov	[esp+88h+Str1],	15180h ; int
		mov	eax, [ebp+arg_18]
		mov	[esp+88h+var_88], eax ;	char *
		call	sub_415EF7
		jmp	loc_409E16
; ---------------------------------------------------------------------------

loc_409A2C:				; CODE XREF: sub_40989B+9Aj
		lea	eax, [ebp+var_44]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_30]
		mov	[esp+88h+Str1],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	ksba_crl_get_item
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409A8F
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gpg_strerror
		mov	[esp+88h+Str1],	eax ; char
		mov	[esp+88h+var_88], offset aErrorGettingCr ; "error getting CRL item: %s\n"
		call	sub_4233B1
		mov	[esp+88h+var_88], 85h
		call	sub_406AEB
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+88h+var_88], eax
		call	ksba_free
		jmp	loc_409E4B
; ---------------------------------------------------------------------------

loc_409A8F:				; CODE XREF: sub_40989B+1B8j
		mov	eax, [ebp+var_30]
		lea	edx, [ebp+var_2C]
		mov	[esp+88h+Str1],	edx
		mov	[esp+88h+var_88], eax
		call	sub_4164FC
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_409AC6
		mov	[esp+88h+var_80], offset aCrl_parse_inse ; "crl_parse_insert"
		mov	[esp+88h+Str1],	6D0h
		mov	[esp+88h+var_88], offset a____Dirmngr1_2 ; "../../dirmngr-1.1.1/src/crlcache.c"
		call	sub_423540
; ---------------------------------------------------------------------------

loc_409AC6:				; CODE XREF: sub_40989B+20Dj
		mov	eax, [ebp+var_44]
		mov	[ebp+var_54], al
		lea	eax, [ebp+var_40]
		lea	edx, [ebp+var_54]
		add	edx, 1
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		mov	ecx, [eax+8]
		mov	[edx+8], ecx
		movzx	ecx, word ptr [eax+0Ch]
		mov	[edx+0Ch], cx
		movzx	eax, byte ptr [eax+0Eh]
		mov	[edx+0Eh], al
		mov	eax, [ebp+var_2C]
		mov	[esp+88h+var_78], 10h ;	size_t
		lea	edx, [ebp+var_54]
		mov	[esp+88h+var_7C], edx ;	void *
		mov	[esp+88h+var_80], eax ;	size_t
		mov	eax, [ebp+var_14]
		mov	[esp+88h+Str1],	eax ; void *
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_88], eax ;	int
		call	sub_40FCF0
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_409B5F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+var_88], eax
		call	sub_406B13
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+var_88], eax ;	int
		call	strerror
		mov	[esp+88h+Str1],	eax ; char
		mov	[esp+88h+var_88], offset aErrorInserting ; "error inserting item into temporary	cac"...
		call	sub_4233B1
		jmp	loc_409E4B
; ---------------------------------------------------------------------------

loc_409B5F:				; CODE XREF: sub_40989B+288j
		mov	eax, [ebp+var_30]
		mov	[esp+88h+var_88], eax
		call	ksba_free
		jmp	loc_409E1A
; ---------------------------------------------------------------------------

loc_409B6F:				; CODE XREF: sub_40989B+8Cj
		lea	eax, [ebp+Source]
		mov	[esp+88h+Str1],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	ksba_crl_get_issuer
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409BB9
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gpg_strerror
		mov	[esp+88h+Str1],	eax ; char
		mov	[esp+88h+var_88], offset aNoCrlIssuerFou ; "no CRL issuer found	in CRL:	%s\n"
		call	sub_4233B1
		mov	[esp+88h+var_88], 85h
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	loc_409E4B
; ---------------------------------------------------------------------------

loc_409BB9:				; CODE XREF: sub_40989B+2EDj
		mov	edx, [ebp+Source]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		lea	eax, [ebp+var_60]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_64]
		mov	[esp+88h+Str1],	eax ; char
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	ksba_crl_get_auth_key_id
		test	eax, eax
		jnz	loc_409D19
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_409BFE
		mov	[esp+88h+var_88], offset aLocatingCrlIss ; "locating CRL issuer	certificate by auth"...
		call	sub_423387

loc_409BFE:				; CODE XREF: sub_40989B+355j
		mov	eax, [ebp+var_5C]
		mov	[esp+88h+Str1],	0
		mov	[esp+88h+var_88], eax
		call	ksba_name_enum
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_409C40
		mov	eax, dword ptr [ebp+var_60]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_409C40
		mov	eax, dword ptr [ebp+var_60]
		mov	[esp+88h+var_80], eax ;	char
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+Str1],	eax ; Str1
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax ;	int
		call	sub_40E092
		mov	[ebp+var_10], eax

loc_409C40:				; CODE XREF: sub_40989B+37Dj
					; sub_40989B+387j
		cmp	[ebp+var_10], 0
		jnz	short loc_409C69
		mov	eax, dword ptr [ebp+var_64]
		test	eax, eax
		jz	short loc_409C69
		mov	edx, dword ptr [ebp+var_64]
		mov	eax, [ebp+Source]
		mov	[esp+88h+var_80], edx ;	int
		mov	[esp+88h+Str1],	eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax ;	int
		call	sub_40E3E4
		mov	[ebp+var_10], eax

loc_409C69:				; CODE XREF: sub_40989B+3A9j
					; sub_40989B+3B0j
		cmp	[ebp+var_10], 0
		jnz	loc_409CF6
		mov	[esp+88h+var_88], offset aCrlIssuerCerti ; "CRL	issuer certificate "
		call	sub_423387
		mov	eax, dword ptr [ebp+var_64]
		test	eax, eax
		jz	short loc_409CA9
		mov	[esp+88h+var_88], offset asc_42F973 ; "{"
		call	sub_423478
		mov	eax, dword ptr [ebp+var_64]
		mov	[esp+88h+var_88], eax
		call	sub_416A63
		mov	[esp+88h+var_88], offset asc_42F975 ; "} "
		call	sub_423478

loc_409CA9:				; CODE XREF: sub_40989B+3E9j
		mov	eax, dword ptr [ebp+var_60]
		test	eax, eax
		jz	short loc_409CEA
		mov	[esp+88h+var_88], offset asc_42F978 ; "(#"
		call	sub_423478
		mov	eax, dword ptr [ebp+var_60]
		mov	[esp+88h+var_88], eax
		call	sub_416A63
		mov	[esp+88h+var_88], offset asc_42EC21 ; "/"
		call	sub_423478
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+var_88], eax
		call	sub_416B16
		mov	[esp+88h+var_88], offset asc_42F97B ; ") "
		call	sub_423478

loc_409CEA:				; CODE XREF: sub_40989B+413j
		mov	[esp+88h+var_88], offset aNotFound ; "not found\n"
		call	sub_423478

loc_409CF6:				; CODE XREF: sub_40989B+3D2j
		mov	eax, [ebp+var_5C]
		mov	[esp+88h+var_88], eax
		call	ksba_name_release
		mov	eax, dword ptr [ebp+var_60]
		mov	[esp+88h+var_88], eax
		call	gcry_free
		mov	eax, dword ptr [ebp+var_64]
		mov	[esp+88h+var_88], eax
		call	gcry_free
		jmp	short loc_409D36
; ---------------------------------------------------------------------------

loc_409D19:				; CODE XREF: sub_40989B+348j
		mov	eax, [ebp+Source]
		mov	[esp+88h+var_80], 0 ; int
		mov	[esp+88h+Str1],	eax ; Source
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax ;	int
		call	sub_40E3E4
		mov	[ebp+var_10], eax

loc_409D36:				; CODE XREF: sub_40989B+47Cj
		mov	[ebp+var_C], 0
		cmp	[ebp+var_10], 0
		jnz	short loc_409D57
		mov	[esp+88h+var_88], 39h
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	loc_409E4B
; ---------------------------------------------------------------------------

loc_409D57:				; CODE XREF: sub_40989B+4A6j
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_24]
		mov	ecx, [ebp+var_10]
		mov	[esp+88h+var_7C], ecx
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Str1],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	sub_40957E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409DA0
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gpg_strerror
		mov	[esp+88h+Str1],	eax ; char
		mov	[esp+88h+var_88], offset aCrlSignatureVe ; "CRL	signature verification failed: %s\n"
		call	sub_4233B1
		jmp	loc_409E4B
; ---------------------------------------------------------------------------

loc_409DA0:				; CODE XREF: sub_40989B+4E3j
		mov	[ebp+var_24], 0
		mov	eax, [ebp+arg_1C]
		mov	[esp+88h+var_78], eax ;	int
		mov	[esp+88h+var_7C], 2 ; int
		mov	[esp+88h+var_80], 0 ; char *
		mov	eax, [ebp+var_10]
		mov	[esp+88h+Str1],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax ;	int
		call	sub_420043
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409E19
		mov	eax, [ebp+var_C]
		mov	[esp+88h+var_88], eax
		call	gpg_strerror
		mov	[esp+88h+Str1],	eax ; char
		mov	[esp+88h+var_88], offset aErrorCheckingV ; "error checking validity of CRL issuer c"...
		call	sub_4233B1
		jmp	short loc_409E4B
; ---------------------------------------------------------------------------

loc_409DF6:				; CODE XREF: sub_40989B+92j
					; sub_40989B+A9j
		mov	[esp+88h+var_88], offset aCrl_parse_in_0 ; "crl_parse_insert: unknown stop reason\n"
		call	sub_42344E
		mov	[esp+88h+var_88], 3Bh
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	short loc_409E4B
; ---------------------------------------------------------------------------

loc_409E13:				; CODE XREF: sub_40989B+A3j
		nop
		jmp	short loc_409E1A
; ---------------------------------------------------------------------------

loc_409E16:				; CODE XREF: sub_40989B+155j
					; sub_40989B+18Cj
		nop
		jmp	short loc_409E1A
; ---------------------------------------------------------------------------

loc_409E19:				; CODE XREF: sub_40989B+53Cj
		nop

loc_409E1A:				; CODE XREF: sub_40989B+2CFj
					; sub_40989B+579j ...
		mov	eax, dword ptr [ebp+var_20]
		cmp	eax, 6
		jnz	loc_4098DC
		cmp	[ebp+var_C], 0
		jz	short loc_409E4B
		mov	[esp+88h+var_80], 749h ; int
		mov	[esp+88h+Str1],	offset a____Dirmngr1_2 ; "../../dirmngr-1.1.1/src/crlcache.c"
		mov	[esp+88h+var_88], offset aErr ;	"!err"
		call	sub_429780
		jmp	short loc_409E4B
; ---------------------------------------------------------------------------

loc_409E4A:				; CODE XREF: sub_40989B+C9j
		nop

loc_409E4B:				; CODE XREF: sub_40989B+77j
					; sub_40989B+11Bj ...
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_409E64
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str1],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+var_88], eax
		call	sub_409888

loc_409E64:				; CODE XREF: sub_40989B+5B5j
		mov	eax, [ebp+var_10]
		mov	[esp+88h+var_88], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40989B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409E74	proc near		; CODE XREF: sub_40A08A+781p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	ksba_crl_get_crl_number
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409E9C
		mov	eax, 0
		jmp	short locret_409EB8
; ---------------------------------------------------------------------------

loc_409E9C:				; CODE XREF: sub_409E74+1Fj
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_41644D
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	ksba_free
		mov	eax, [ebp+var_10]

locret_409EB8:				; CODE XREF: sub_409E74+26j
		leave
		retn
sub_409E74	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409EBA	proc near		; CODE XREF: sub_40A08A+79Cp

Dest		= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_4C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Source], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dest],	eax
		call	ksba_crl_get_auth_key_id
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_409EFF
		mov	eax, 0
		jmp	loc_40A083
; ---------------------------------------------------------------------------

loc_409EFF:				; CODE XREF: sub_409EBA+39j
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Dest],	eax
		call	sub_41644D
		mov	edx, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Dest],	eax
		call	ksba_free
		mov	eax, [ebp+var_28]
		test	eax, eax
		jnz	short loc_409F32
		mov	[esp+58h+Dest],	offset word_42F54A
		call	gcry_xstrdup
		jmp	loc_40A083
; ---------------------------------------------------------------------------

loc_409F32:				; CODE XREF: sub_409EBA+65j
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_409F99
; ---------------------------------------------------------------------------

loc_409F42:				; CODE XREF: sub_409EBA+F8j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_C]
		mov	[esp+58h+Source], edx
		mov	[esp+58h+Dest],	eax
		call	ksba_name_get_uri
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_409F62
		mov	eax, [ebp+var_1C]
		jmp	short loc_409F65
; ---------------------------------------------------------------------------

loc_409F62:				; CODE XREF: sub_409EBA+A1j
		mov	eax, [ebp+var_18]

loc_409F65:				; CODE XREF: sub_409EBA+A6j
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		add	[ebp+var_C], 1

loc_409F99:				; CODE XREF: sub_409EBA+86j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_C]
		mov	[esp+58h+Source], edx
		mov	[esp+58h+Dest],	eax
		call	ksba_name_enum
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_409F42
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+58h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_40A075
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0
		mov	[ebp+var_C], 0
		jmp	short loc_40A056
; ---------------------------------------------------------------------------

loc_409FDE:				; CODE XREF: sub_409EBA+1B5j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_C]
		mov	[esp+58h+Source], edx
		mov	[esp+58h+Dest],	eax
		call	ksba_name_get_uri
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40A02A
		mov	ebx, offset byte_42FA18
		mov	eax, [ebp+var_20]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_20]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx

loc_40A02A:				; CODE XREF: sub_409EBA+141j
		cmp	[ebp+var_24], 0
		jz	short loc_40A035
		mov	eax, [ebp+var_24]
		jmp	short loc_40A038
; ---------------------------------------------------------------------------

loc_40A035:				; CODE XREF: sub_409EBA+174j
		mov	eax, [ebp+var_18]

loc_40A038:				; CODE XREF: sub_409EBA+179j
		mov	[esp+58h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dest],	eax ; Dest
		call	strcat
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		add	[ebp+var_C], 1

loc_40A056:				; CODE XREF: sub_409EBA+122j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_C]
		mov	[esp+58h+Source], edx
		mov	[esp+58h+Dest],	eax
		call	ksba_name_enum
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_409FDE

loc_40A075:				; CODE XREF: sub_409EBA+10Fj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dest],	eax
		call	ksba_name_release
		mov	eax, [ebp+var_20]

loc_40A083:				; CODE XREF: sub_409EBA+40j
					; sub_409EBA+73j
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_409EBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A08A(int, char *, char *, int)
sub_40A08A	proc near		; CODE XREF: sub_4020C2+1066p
					; sub_406036+A7p ...

var_14AC	= dword	ptr -14ACh
var_14A8	= dword	ptr -14A8h
var_1498	= dword	ptr -1498h
var_1494	= dword	ptr -1494h
var_1490	= dword	ptr -1490h
var_148C	= dword	ptr -148Ch
var_1488	= byte ptr -1488h
Str1		= byte ptr -1478h
var_1468	= byte ptr -1468h
var_1458	= dword	ptr -1458h
var_1454	= dword	ptr -1454h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
Source		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
NewFilename	= dword	ptr -18h
OldFilename	= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr -8
Str2		= dword	ptr -4
var_s0		= dword	ptr  0
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		mov	eax, 14D0h
		call	sub_4294A0
		sub	esp, eax
		call	sub_406BB9
		mov	[ebp+var_3C], eax
		mov	[ebp+OldFilename], 0
		mov	[ebp+NewFilename], 0
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	[ebp+var_1458],	0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+Source], 0
		mov	[ebp+var_30], 0
		mov	[ebp+var_1494],	0
		mov	[ebp+var_10], 0
		lea	eax, [ebp+var_44]
		mov	[esp+8+Filename], eax
		call	ksba_crl_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40A123
		mov	eax, [ebp+var_C]
		mov	[esp+8+Filename], eax
		call	gpg_strerror
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aKsba_crl_newFa ; "ksba_crl_new failed: %s\n"
		call	sub_4233B1
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A123:				; CODE XREF: sub_40A08A+77j
		mov	eax, [ebp+var_44]
		mov	edx, [ebp+arg_8]
		mov	[esp+8+Str2], edx
		mov	[esp+8+Filename], eax
		call	ksba_crl_set_reader
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40A15E
		mov	eax, [ebp+var_C]
		mov	[esp+8+Filename], eax
		call	gpg_strerror
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aKsba_crl_set_r ; "ksba_crl_set_reader	failed:	%s\n"
		call	sub_4233B1
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A15E:				; CODE XREF: sub_40A08A+B2j
		mov	[ebp+var_40], offset aUnknown ;	"unknown"
		call	_getpid
		lea	edx, [ebp+var_1498]
		mov	[esp+8+arg_0], edx
		mov	[esp+0Ch], eax
		mov	eax, [ebp+var_40]
		mov	[esp+8+var_s0],	eax
		mov	[esp+8+Str2], offset aCrlTmpSUP_db_t ; "crl-tmp-%s-%u-%p.db.tmp"
		lea	eax, [ebp+var_1498]
		mov	[esp+8+Filename], eax
		call	sub_41F7BB
		mov	eax, [ebp+var_1498]
		test	eax, eax
		jnz	short loc_40A1AC
		call	sub_406B2E
		mov	[ebp+var_C], eax
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A1AC:				; CODE XREF: sub_40A08A+113j
		mov	eax, [ebp+var_1498]
		mov	[ebp+var_38], eax
		jmp	short loc_40A1CB
; ---------------------------------------------------------------------------

loc_40A1B7:				; CODE XREF: sub_40A08A+149j
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40A1C7
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	2Eh

loc_40A1C7:				; CODE XREF: sub_40A08A+135j
		add	[ebp+var_38], 1

loc_40A1CB:				; CODE XREF: sub_40A08A+12Bj
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A1B7
		mov	ecx, [ebp+var_1498]
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_40A1EB
		mov	eax, offset aCrls_d ; "crls.d"
		jmp	short loc_40A1F0
; ---------------------------------------------------------------------------

loc_40A1EB:				; CODE XREF: sub_40A08A+158j
		mov	eax, offset aDirmngrCache_d ; "dirmngr-cache.d"

loc_40A1F0:				; CODE XREF: sub_40A08A+15Fj
		mov	edx, ds:dword_435FBC
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8+var_s0],	ecx
		mov	[esp+8+Str2], eax
		mov	[esp+8+Filename], edx
		call	sub_4259CC
		mov	[ebp+OldFilename], eax
		mov	eax, [ebp+var_1498]
		mov	[esp+8+Filename], eax
		call	gcry_free
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Filename], eax ;	Filename
		call	remove
		test	eax, eax
		jnz	short loc_40A243
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aRemovedStaleTe ; "removed stale temporary cache file `%s'"...
		call	sub_423387
		jmp	short loc_40A280
; ---------------------------------------------------------------------------

loc_40A243:				; CODE XREF: sub_40A08A+1A2j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_40A280
		call	sub_406B2E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+8+Filename], eax
		call	gpg_strerror
		mov	[esp+8+var_s0],	eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aProblemRemovin ; "problem removing stale temporary cache "...
		call	sub_4233B1
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A280:				; CODE XREF: sub_40A08A+1B7j
					; sub_40A08A+1C5j
		mov	[esp+8+var_s0],	1A4h
		mov	[esp+8+Str2], 301h
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Filename], eax
		call	_open
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_40A2E5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+8+Filename], eax
		call	sub_406B13
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+8+Filename], eax ;	int
		call	strerror
		mov	[esp+8+var_s0],	eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aErrorCreatingT ; "error creating temporary cache file	`%s"...
		call	sub_4233B1
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A2E5:				; CODE XREF: sub_40A08A+218j
		mov	eax, [ebp+var_1C]
		mov	[esp+8+Str2], eax
		lea	eax, [ebp+var_1454]
		mov	[esp+8+Filename], eax
		call	sub_41044E
		mov	eax, [ebp+var_44]
		lea	edx, [ebp+var_1494]
		mov	[esp+8+arg_C], edx ; int
		lea	edx, [ebp+Str1]
		mov	[esp+8+arg_8], edx ; char *
		lea	edx, [ebp+var_1468]
		mov	[esp+8+arg_4], edx ; char *
		lea	edx, [ebp+var_1458]
		mov	[esp+8+arg_0], edx ; int
		mov	edx, [ebp+OldFilename]
		mov	[esp+0Ch], edx	; int
		lea	edx, [ebp+var_1454]
		mov	[esp+8+var_s0],	edx ; int
		mov	[esp+8+Str2], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+8+Filename], eax ;	int
		call	sub_40989B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40A37C
		mov	eax, [ebp+var_C]
		mov	[esp+8+Filename], eax
		call	gpg_strerror
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aCrl_parse_in_1 ; "crl_parse_insert failed: %s\n"
		call	sub_4233B1
		lea	eax, [ebp+var_1454]
		mov	[esp+8+Filename], eax
		call	sub_410A9A
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A37C:				; CODE XREF: sub_40A08A+2C2j
		lea	eax, [ebp+var_1454]
		mov	[esp+8+Filename], eax
		call	sub_410A9A
		test	eax, eax
		jz	short loc_40A3CF
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+8+Filename], eax
		call	sub_406B13
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+8+Filename], eax ;	int
		call	strerror
		mov	[esp+8+var_s0],	eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aErrorFinishing ; "error finishing temporary cache file `%"...
		call	sub_4233B1
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A3CF:				; CODE XREF: sub_40A08A+302j
		mov	eax, [ebp+var_1C]
		mov	[esp+8+Filename], eax
		call	_close
		test	eax, eax
		jz	short loc_40A41F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+8+Filename], eax
		call	sub_406B13
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+8+Filename], eax ;	int
		call	strerror
		mov	[esp+8+var_s0],	eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aErrorClosingTe ; "error closing temporary cache file `%s'"...
		call	sub_4233B1
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A41F:				; CODE XREF: sub_40A08A+352j
		mov	[ebp+var_1C], 0FFFFFFFFh
		lea	eax, [ebp+var_14A8]
		mov	[esp+8+Str2], eax ; int
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Filename], eax ;	char *
		call	sub_40864A
		test	eax, eax
		jz	short loc_40A453
		mov	[esp+8+Filename], 0Ah
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A453:				; CODE XREF: sub_40A08A+3B3j
		mov	[esp+8+Str2], 10h
		lea	eax, [ebp+var_14A8]
		mov	[esp+8+Filename], eax
		call	sub_4163EE
		mov	[ebp+Source], eax
		lea	eax, [ebp+var_1488]
		mov	[esp+8+Filename], eax ;	char *
		call	sub_415940
		lea	eax, [ebp+var_1488]
		mov	[esp+8+Str2], eax ; Str2
		lea	eax, [ebp+Str1]
		mov	[esp+8+Filename], eax ;	Str1
		call	strcmp
		test	eax, eax
		jns	short loc_40A4E6
		mov	eax, ds:dword_435FD8
		test	eax, eax
		jz	short loc_40A4B7
		lea	eax, [ebp+Str1]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aWarningNewCrlS ; "WARNING: new CRL still too old; it expi"...
		call	sub_423387
		jmp	short loc_40A4E6
; ---------------------------------------------------------------------------

loc_40A4B7:				; CODE XREF: sub_40A08A+413j
		lea	eax, [ebp+Str1]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aNewCrlStillToo ; "new	CRL still too old; it expired on %s"...
		call	sub_4233B1
		cmp	[ebp+var_10], 0
		jnz	short loc_40A4E2
		mov	[esp+8+Filename], 60h
		call	sub_406AEB
		mov	[ebp+var_10], eax

loc_40A4E2:				; CODE XREF: sub_40A08A+447j
		or	[ebp+var_30], 1

loc_40A4E6:				; CODE XREF: sub_40A08A+40Aj
					; sub_40A08A+42Bj
		mov	[ebp+var_34], 0
		jmp	short loc_40A563
; ---------------------------------------------------------------------------

loc_40A4EF:				; CODE XREF: sub_40A08A+516j
		mov	eax, [ebp+var_1490]
		test	eax, eax
		jz	short loc_40A55E
		mov	eax, [ebp+var_148C]
		mov	[esp+8+Str2], offset a2_5_29_35	; "2.5.29.35"
		mov	[esp+8+Filename], eax ;	Str1
		call	strcmp
		test	eax, eax
		jz	short loc_40A55E
		mov	eax, [ebp+var_148C]
		mov	[esp+8+Str2], offset a2_5_29_20	; "2.5.29.20"
		mov	[esp+8+Filename], eax ;	Str1
		call	strcmp
		test	eax, eax
		jz	short loc_40A55E
		mov	eax, [ebp+var_148C]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aUnknownCritica ; "unknown critical CRL extension %s\n"
		call	sub_4233B1
		cmp	[ebp+var_10], 0
		jnz	short loc_40A558
		mov	[esp+8+Filename], 85h
		call	sub_406AEB
		mov	[ebp+var_10], eax

loc_40A558:				; CODE XREF: sub_40A08A+4BDj
		or	[ebp+var_30], 2
		jmp	short loc_40A55F
; ---------------------------------------------------------------------------

loc_40A55E:				; CODE XREF: sub_40A08A+46Dj
					; sub_40A08A+487j ...
		nop

loc_40A55F:				; CODE XREF: sub_40A08A+4D2j
		add	[ebp+var_34], 1

loc_40A563:				; CODE XREF: sub_40A08A+463j
		mov	eax, [ebp+var_44]
		mov	[esp+8+arg_4], 0
		mov	[esp+8+arg_0], 0
		lea	edx, [ebp+var_1490]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+var_148C]
		mov	[esp+8+var_s0],	edx
		mov	edx, [ebp+var_34]
		mov	[esp+8+Str2], edx
		mov	[esp+8+Filename], eax
		call	ksba_crl_get_extension
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_40A4EF
		mov	eax, [ebp+var_C]
		mov	[esp+8+Filename], eax
		call	sub_406B06
		cmp	eax, 3FFFh
		jz	short loc_40A5C8
		mov	eax, [ebp+var_C]
		mov	[esp+8+Filename], eax
		call	sub_406B06
		cmp	eax, 3Ah
		jnz	short loc_40A5CF

loc_40A5C8:				; CODE XREF: sub_40A08A+52Cj
		mov	[ebp+var_C], 0

loc_40A5CF:				; CODE XREF: sub_40A08A+53Cj
		cmp	[ebp+var_C], 0
		jz	short loc_40A5FF
		mov	eax, [ebp+var_C]
		mov	[esp+8+Filename], eax
		call	gpg_strerror
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aErrorReadingCr ; "error reading CRL extensions: %s\n"
		call	sub_4233B1
		mov	[esp+8+Filename], 85h
		call	sub_406AEB
		mov	[ebp+var_C], eax

loc_40A5FF:				; CODE XREF: sub_40A08A+549j
		mov	eax, [ebp+var_1458]
		mov	[ebp+var_14AC],	0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_1458]
		mov	[esp+8+Str2], edx
		mov	[esp+8+Filename], eax
		call	sub_4163B2
		mov	[ebp+var_20], eax
		mov	[esp+8+Str2], 7Ch
		mov	[esp+8+Filename], 1
		call	gcry_calloc
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40A666
		call	sub_406B2E
		mov	[ebp+var_C], eax
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A666:				; CODE XREF: sub_40A08A+5CDj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14AC],	0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_1458]
		mov	[ebp+var_14AC],	0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14AC],	0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+Source]
		mov	[ebp+var_14AC],	0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 4
		mov	[esp+8+Filename], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_24]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40A73F
		call	sub_406B2E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_24]
		mov	[esp+8+Filename], eax
		call	gcry_free
		mov	[ebp+var_24], 0
		jmp	loc_40A971
; ---------------------------------------------------------------------------

loc_40A73F:				; CODE XREF: sub_40A08A+694j
		mov	eax, [ebp+var_24]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_24]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_24]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	[esp+8+Str2], edx
		mov	[esp+8+Filename], eax
		call	sub_4265EB
		lea	edx, [eax+1]
		mov	eax, [ebp+var_24]
		mov	[eax+18h], edx
		mov	edx, [ebp+var_1458]
		mov	eax, [ebp+var_24]
		mov	eax, [eax+18h]
		mov	[esp+8+Str2], edx
		mov	[esp+8+Filename], eax
		call	sub_4265EB
		lea	edx, [eax+1]
		mov	eax, [ebp+var_24]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_24]
		mov	eax, [eax+14h]
		mov	edx, [ebp+arg_4]
		mov	[esp+8+Str2], edx
		mov	[esp+8+Filename], eax
		call	sub_4265EB
		lea	edx, [eax+1]
		mov	eax, [ebp+var_24]
		mov	[eax+20h], edx
		mov	edx, [ebp+Source]
		mov	eax, [ebp+var_24]
		mov	eax, [eax+20h]
		mov	[esp+8+Str2], edx ; Source
		mov	[esp+8+Filename], eax ;	Dest
		call	strcpy
		mov	eax, [ebp+var_24]
		lea	edx, [eax+30h]
		lea	eax, [ebp+var_1468]
		mov	[esp+8+Str2], eax ; char *
		mov	[esp+8+Filename], edx ;	char *
		call	sub_406B43
		mov	eax, [ebp+var_24]
		lea	edx, [eax+40h]
		lea	eax, [ebp+Str1]
		mov	[esp+8+Str2], eax ; char *
		mov	[esp+8+Filename], edx ;	char *
		call	sub_406B43
		mov	eax, [ebp+var_24]
		lea	edx, [eax+50h]
		lea	eax, [ebp+var_1488]
		mov	[esp+8+Str2], eax ; char *
		mov	[esp+8+Filename], edx ;	char *
		call	sub_406B43
		mov	eax, [ebp+var_44]
		mov	[esp+8+Filename], eax
		call	sub_409E74
		mov	edx, [ebp+var_24]
		mov	[edx+60h], eax
		mov	eax, [ebp+var_24]
		lea	edx, [eax+68h]
		mov	eax, [ebp+var_44]
		mov	[esp+8+Str2], edx
		mov	[esp+8+Filename], eax
		call	sub_409EBA
		mov	edx, [ebp+var_24]
		mov	[edx+64h], eax
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_30]
		mov	[eax+24h], edx
		mov	eax, [ebp+var_1494]
		test	eax, eax
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_24]
		mov	[eax+28h], edx
		mov	edx, [ebp+var_1494]
		mov	eax, [ebp+var_24]
		mov	[eax+2Ch], edx
		mov	[ebp+var_1494],	0
		mov	eax, [ebp+var_3C]
		mov	eax, [eax]
		mov	[ebp+var_28], eax
		jmp	short loc_40A880
; ---------------------------------------------------------------------------

loc_40A86E:				; CODE XREF: sub_40A08A+812j
		mov	eax, [ebp+var_28]
		mov	dword ptr [eax+4], 1
		mov	eax, [ebp+var_28]
		mov	eax, [eax]
		mov	[ebp+var_28], eax

loc_40A880:				; CODE XREF: sub_40A08A+7E2j
		mov	eax, [ebp+var_24]
		mov	eax, [eax+1Ch]
		mov	[esp+8+Str2], eax ; char *
		mov	eax, [ebp+var_28]
		mov	[esp+8+Filename], eax ;	int
		call	sub_408D0E
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_40A86E
		mov	eax, [ebp+var_24]
		mov	eax, [eax+1Ch]
		mov	[esp+8+Filename], eax
		call	sub_408569
		mov	[ebp+NewFilename], eax
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_40A8CB
		mov	eax, [ebp+NewFilename]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aCreatingCacheF ; "creating cache file	`%s'\n"
		call	sub_423387

loc_40A8CB:				; CODE XREF: sub_40A08A+82Cj
		mov	eax, [ebp+NewFilename]
		mov	[esp+8+Filename], eax ;	Filename
		call	_unlink
		mov	eax, [ebp+NewFilename]
		mov	[esp+8+Str2], eax ; char
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Filename], eax ;	OldFilename
		call	rename
		test	eax, eax
		jz	short loc_40A91F
		call	sub_406B2E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+8+Filename], eax
		call	gpg_strerror
		mov	[esp+0Ch], eax
		mov	eax, [ebp+NewFilename]
		mov	[esp+8+var_s0],	eax
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Str2], eax ; char
		mov	[esp+8+Filename], offset aProblemRenamin ; "problem renaming `%s' to `%s': %s\n"
		call	sub_4233B1
		jmp	short loc_40A971
; ---------------------------------------------------------------------------

loc_40A91F:				; CODE XREF: sub_40A08A+860j
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Filename], eax
		call	gcry_free
		mov	[ebp+OldFilename], 0
		mov	eax, [ebp+var_3C]
		mov	edx, [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], edx
		mov	eax, [ebp+var_3C]
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		mov	[ebp+var_24], 0
		mov	eax, [ebp+var_3C]
		mov	[esp+8+Filename], eax
		call	sub_407EC1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40A971
		mov	[esp+8+Filename], offset aUpdatingTheDir ; "updating the DIR file failed - cache en"...
		call	sub_4233B1
		mov	[ebp+var_C], 0

loc_40A971:				; CODE XREF: sub_40A08A+94j
					; sub_40A08A+CFj ...
		mov	eax, [ebp+var_24]
		mov	[esp+8+Filename], eax
		call	sub_4070B4
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_40A98D
		mov	eax, [ebp+var_1C]
		mov	[esp+8+Filename], eax
		call	_close

loc_40A98D:				; CODE XREF: sub_40A08A+8F6j
		cmp	[ebp+OldFilename], 0
		jz	short loc_40A9A9
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Filename], eax ;	Filename
		call	remove
		mov	eax, [ebp+OldFilename]
		mov	[esp+8+Filename], eax
		call	gcry_free

loc_40A9A9:				; CODE XREF: sub_40A08A+907j
		mov	eax, [ebp+NewFilename]
		mov	[esp+8+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_44]
		mov	[esp+8+Filename], eax
		call	ksba_crl_release
		mov	eax, [ebp+var_1458]
		mov	[esp+8+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+8+Filename], eax
		call	gcry_free
		mov	eax, [ebp+Source]
		mov	[esp+8+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_1494]
		mov	[esp+8+Filename], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_40A9FC
		mov	eax, [ebp+var_C]
		jmp	short loc_40A9FF
; ---------------------------------------------------------------------------

loc_40A9FC:				; CODE XREF: sub_40A08A+96Bj
		mov	eax, [ebp+var_10]

loc_40A9FF:				; CODE XREF: sub_40A08A+970j
		add	esp, 14D0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40A08A	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40AA09(int, int, FILE	*)
sub_40AA09	proc near		; CODE XREF: sub_40B140+33p

Str		= dword	ptr -168h
Size		= dword	ptr -164h
Count		= dword	ptr -160h
File		= dword	ptr -15Ch
var_158		= byte ptr -158h
var_58		= byte ptr -58h
var_48		= byte ptr -48h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 168h
		mov	[ebp+var_10], 0
		mov	eax, offset asc_42FCC8 ; "---------------------------------------"...
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 39h ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+14h]
		mov	eax, offset aBeginCrlDumpRe ; "Begin CRL dump (retrieved via %s)\n"
		mov	[esp+168h+Count], edx
		mov	[esp+168h+Size], eax ; Format
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+18h]
		mov	eax, offset aIssuerS ; " Issuer:\t%s\n"
		mov	[esp+168h+Count], edx
		mov	[esp+168h+Size], eax ; Format
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+1Ch]
		mov	eax, offset aIssuerHashS ; " Issuer Hash:\t%s\n"
		mov	[esp+168h+Count], edx
		mov	[esp+168h+Size], eax ; Format
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+30h]
		mov	eax, offset aThisUpdateS ; " This Update:\t%s\n"
		mov	[esp+168h+Count], edx
		mov	[esp+168h+Size], eax ; Format
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+40h]
		mov	eax, offset aNextUpdateS ; " Next Update:\t%s\n"
		mov	[esp+168h+Count], edx
		mov	[esp+168h+Size], eax ; Format
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+60h]
		test	eax, eax
		jz	short loc_40AAE5
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+60h]
		jmp	short loc_40AAEA
; ---------------------------------------------------------------------------

loc_40AAE5:				; CODE XREF: sub_40AA09+D2j
		mov	eax, offset aNone_1 ; "none"

loc_40AAEA:				; CODE XREF: sub_40AA09+DAj
		mov	edx, offset aCrlNumberS	; " CRL	Number :\t%s\n"
		mov	[esp+168h+Count], eax
		mov	[esp+168h+Size], edx ; Format
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+68h]
		test	eax, eax
		jz	short loc_40AB14
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+68h]
		jmp	short loc_40AB19
; ---------------------------------------------------------------------------

loc_40AB14:				; CODE XREF: sub_40AA09+101j
		mov	eax, offset aNone_1 ; "none"

loc_40AB19:				; CODE XREF: sub_40AA09+109j
		mov	edx, offset aAuthkeyidS	; " AuthKeyId  :\t%s\n"
		mov	[esp+168h+Count], eax
		mov	[esp+168h+Size], edx ; Format
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+68h]
		test	eax, eax
		jz	loc_40ABE5
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+64h]
		test	eax, eax
		jz	loc_40ABE5
		mov	eax, offset asc_42FD93 ; "	       \t"
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 0Eh ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+64h]
		mov	[ebp+var_14], eax
		jmp	short loc_40ABC8
; ---------------------------------------------------------------------------

loc_40AB7C:				; CODE XREF: sub_40AA09+1C7j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 1
		jnz	short loc_40ABAC
		mov	eax, offset asc_42FDA2 ; "\n		 \t"
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 0Fh ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		jmp	short loc_40ABC4
; ---------------------------------------------------------------------------

loc_40ABAC:				; CODE XREF: sub_40AA09+17Bj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+Size], edx ; File
		mov	[esp+168h+Str],	eax ; Ch
		call	putc

loc_40ABC4:				; CODE XREF: sub_40AA09+1A1j
		add	[ebp+var_14], 1

loc_40ABC8:				; CODE XREF: sub_40AA09+171j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40AB7C
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Size], eax ; File
		mov	[esp+168h+Str],	0Ah ; Ch
		call	putc

loc_40ABE5:				; CODE XREF: sub_40AA09+130j
					; sub_40AA09+13Ej
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_40AC08
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_40AC01
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		jmp	short loc_40AC06
; ---------------------------------------------------------------------------

loc_40AC01:				; CODE XREF: sub_40AA09+1EEj
		mov	eax, offset aMissing ; "[missing]"

loc_40AC06:				; CODE XREF: sub_40AA09+1F6j
		jmp	short loc_40AC0D
; ---------------------------------------------------------------------------

loc_40AC08:				; CODE XREF: sub_40AA09+1E4j
		mov	eax, offset aSystem ; "[system]"

loc_40AC0D:				; CODE XREF: sub_40AA09:loc_40AC06j
		mov	edx, offset aTrustCheckS ; " Trust Check:\t%s\n"
		mov	[esp+168h+Count], eax
		mov	[esp+168h+Size], edx ; Format
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		and	eax, 1
		test	al, al
		jz	short loc_40AC56
		mov	eax, offset aErrorTheCrlWil ; "	ERROR: The CRL will not	be used	becaus"...
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 4Fh ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite

loc_40AC56:				; CODE XREF: sub_40AA09+227j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		and	eax, 2
		test	eax, eax
		jz	short loc_40AC87
		mov	eax, offset aErrorTheCrlW_0 ; "	ERROR: The CRL will not	be used	due to"...
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 47h ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite

loc_40AC87:				; CODE XREF: sub_40AA09+258j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		and	eax, 0FFFFFFFCh
		test	eax, eax
		jz	short loc_40ACB8
		mov	eax, offset aErrorTheCrlW_1 ; "	ERROR: The CRL will not	be used\n"
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 21h ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite

loc_40ACB8:				; CODE XREF: sub_40AA09+289j
		mov	eax, [ebp+arg_4]
		mov	[esp+168h+Size], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+168h+Str],	eax
		call	sub_40895E
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40ACE4
		mov	[esp+168h+Str],	1
		call	sub_406AEB
		jmp	locret_40B13E
; ---------------------------------------------------------------------------

loc_40ACE4:				; CODE XREF: sub_40AA09+2C8j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+78h]
		test	eax, eax
		jnz	short loc_40AD12
		mov	eax, offset aErrorThisCache ; "	ERROR: This cached CRL may has been ta"...
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 34h ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite

loc_40AD12:				; CODE XREF: sub_40AA09+2E3j
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Size], eax ; File
		mov	[esp+168h+Str],	0Ah ; Ch
		call	putc
		mov	[esp+168h+File], 0
		mov	[esp+168h+Count], 0
		mov	eax, [ebp+var_24]
		mov	[esp+168h+Size], eax
		lea	eax, [ebp+var_48]
		mov	[esp+168h+Str],	eax
		call	sub_40F46B
		mov	[ebp+var_C], eax
		jmp	loc_40B097
; ---------------------------------------------------------------------------

loc_40AD4F:				; CODE XREF: sub_40AA09+6A6j
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_24]
		mov	eax, [eax+14h]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 10h
		jz	short loc_40AD84
		mov	[esp+168h+Str],	offset aWarningInval_1 ; " WARNING: invalid cache record length\n"
		call	sub_4233B1
		mov	[ebp+var_10], 1
		jmp	loc_40B097
; ---------------------------------------------------------------------------

loc_40AD84:				; CODE XREF: sub_40AA09+361j
		mov	eax, [ebp+var_24]
		mov	eax, [eax+10h]
		mov	[esp+168h+File], eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+168h+Count], eax ;	size_t
		lea	eax, [ebp+var_58]
		mov	[esp+168h+Size], eax ; void *
		mov	eax, [ebp+var_24]
		mov	[esp+168h+Str],	eax ; int
		call	sub_40F1BF
		test	eax, eax
		jz	short loc_40ADD8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+168h+Str],	eax ; int
		call	strerror
		mov	[esp+168h+Size], eax ; char
		mov	[esp+168h+Str],	offset aProblemReadi_0 ; "problem reading cache	record:	%s\n"
		call	sub_4233B1
		mov	[ebp+var_10], 1
		jmp	loc_40B097
; ---------------------------------------------------------------------------

loc_40ADD8:				; CODE XREF: sub_40AA09+3A0j
		mov	eax, [ebp+var_24]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 100h
		jbe	short loc_40ADF1
		mov	[ebp+var_1C], 100h

loc_40ADF1:				; CODE XREF: sub_40AA09+3DFj
		mov	eax, [ebp+var_24]
		mov	eax, [eax+18h]
		mov	[esp+168h+File], eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+168h+Count], eax ;	size_t
		lea	eax, [ebp+var_158]
		mov	[esp+168h+Size], eax ; void *
		mov	eax, [ebp+var_24]
		mov	[esp+168h+Str],	eax ; int
		call	sub_40F1BF
		test	eax, eax
		jz	short loc_40AE48
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+168h+Str],	eax ; int
		call	strerror
		mov	[esp+168h+Size], eax ; char
		mov	[esp+168h+Str],	offset aProblemReadi_1 ; "problem reading cache	key: %s\n"
		call	sub_4233B1
		mov	[ebp+var_10], 1
		jmp	loc_40B097
; ---------------------------------------------------------------------------

loc_40AE48:				; CODE XREF: sub_40AA09+410j
		movzx	eax, [ebp+var_58]
		movzx	eax, al
		mov	[ebp+var_28], eax
		mov	eax, offset asc_42FF37 ; "  "
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 2 ; Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	[ebp+var_20], 0
		jmp	short loc_40AEAA
; ---------------------------------------------------------------------------

loc_40AE7F:				; CODE XREF: sub_40AA09+4A7j
		lea	eax, [ebp+var_158]
		add	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x ; "%02X"
		mov	[esp+168h+Count], edx
		mov	[esp+168h+Size], eax ; Format
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf
		add	[ebp+var_20], 1

loc_40AEAA:				; CODE XREF: sub_40AA09+474j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_1C]
		jb	short loc_40AE7F
		mov	eax, offset aReasons ; ":\t reasons( "
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 0Ch ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	eax, [ebp+var_28]
		and	eax, 1
		test	al, al
		jz	short loc_40AF0B
		mov	eax, offset aUnspecified ; "unspecified	"
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 0Ch ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	[ebp+var_18], 1

loc_40AF0B:				; CODE XREF: sub_40AA09+4D5j
		mov	eax, [ebp+var_28]
		and	eax, 2
		test	eax, eax
		jz	short loc_40AF40
		mov	eax, offset aKey_compromise ; "key_compromise "
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 0Fh ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	[ebp+var_18], 1

loc_40AF40:				; CODE XREF: sub_40AA09+50Aj
		mov	eax, [ebp+var_28]
		and	eax, 4
		test	eax, eax
		jz	short loc_40AF75
		mov	eax, offset aCa_compromise ; "ca_compromise "
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 0Eh ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	[ebp+var_18], 1

loc_40AF75:				; CODE XREF: sub_40AA09+53Fj
		mov	eax, [ebp+var_28]
		and	eax, 8
		test	eax, eax
		jz	short loc_40AFAA
		mov	eax, offset aAffiliation_ch ; "affiliation_changed "
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 14h ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	[ebp+var_18], 1

loc_40AFAA:				; CODE XREF: sub_40AA09+574j
		mov	eax, [ebp+var_28]
		and	eax, 10h
		test	eax, eax
		jz	short loc_40AFDF
		mov	eax, offset aSuperseeded ; "superseeded"
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 0Bh ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	[ebp+var_18], 1

loc_40AFDF:				; CODE XREF: sub_40AA09+5A9j
		mov	eax, [ebp+var_28]
		and	eax, 20h
		test	eax, eax
		jz	short loc_40B014
		mov	eax, offset aCessation_of_o ; "cessation_of_operation"
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 16h ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	[ebp+var_18], 1

loc_40B014:				; CODE XREF: sub_40AA09+5DEj
		mov	eax, [ebp+var_28]
		and	eax, 40h
		test	eax, eax
		jz	short loc_40B049
		mov	eax, offset aCertificate_ho ; "certificate_hold"
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 10h ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	[ebp+var_18], 1

loc_40B049:				; CODE XREF: sub_40AA09+613j
		cmp	[ebp+var_28], 0
		jz	short loc_40B079
		cmp	[ebp+var_18], 0
		jnz	short loc_40B079
		mov	eax, offset aOther ; "other"
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 5 ; Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite

loc_40B079:				; CODE XREF: sub_40AA09+644j
					; sub_40AA09+64Aj
		mov	eax, offset aRdate_15s ; ") rdate: %.15s\n"
		lea	edx, [ebp+var_58]
		add	edx, 1
		mov	[esp+168h+Count], edx
		mov	[esp+168h+Size], eax ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Str],	eax ; File
		call	fprintf

loc_40B097:				; CODE XREF: sub_40AA09+341j
					; sub_40AA09+376j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_40B0B5
		lea	eax, [ebp+var_48]
		mov	[esp+168h+Str],	eax
		call	sub_40F5D0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jg	loc_40AD4F

loc_40B0B5:				; CODE XREF: sub_40AA09+692j
		cmp	[ebp+var_C], 0
		jz	short loc_40B0D6
		mov	eax, [ebp+var_C]
		mov	[esp+168h+Str],	eax ; int
		call	strerror
		mov	[esp+168h+Size], eax ; char
		mov	[esp+168h+Str],	offset aErrorReadingCa ; "error	reading	cache entry from db: %s\n"
		call	sub_4233B1

loc_40B0D6:				; CODE XREF: sub_40AA09+6B0j
		mov	eax, [ebp+arg_4]
		mov	[esp+168h+Size], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+168h+Str],	eax
		call	sub_408C3C
		mov	eax, offset aEndCrlDump	; "End CRL dump\n"
		mov	edx, [ebp+arg_8]
		mov	[esp+168h+File], edx ; File
		mov	[esp+168h+Count], 0Dh ;	Count
		mov	[esp+168h+Size], 1 ; Size
		mov	[esp+168h+Str],	eax ; Str
		call	fwrite
		mov	eax, [ebp+arg_8]
		mov	[esp+168h+Size], eax ; File
		mov	[esp+168h+Str],	0Ah ; Ch
		call	putc
		cmp	[ebp+var_C], 0
		jnz	short loc_40B12B
		cmp	[ebp+var_10], 0
		jz	short loc_40B139

loc_40B12B:				; CODE XREF: sub_40AA09+71Aj
		mov	[esp+168h+Str],	1
		call	sub_406AEB
		jmp	short locret_40B13E
; ---------------------------------------------------------------------------

loc_40B139:				; CODE XREF: sub_40AA09+720j
		mov	eax, 0

locret_40B13E:				; CODE XREF: sub_40AA09+2D6j
					; sub_40AA09+72Ej
		leave
		retn
sub_40AA09	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B140(FILE *)
sub_40B140	proc near		; CODE XREF: sub_4020C2+ECEp
					; sub_4061BB+45p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_406BB9
		mov	[ebp+var_14], eax
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_40B183
; ---------------------------------------------------------------------------

loc_40B15F:				; CODE XREF: sub_40B140+57j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_20], eax ;	FILE *
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_40AA09
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40B183:				; CODE XREF: sub_40B140+1Dj
		cmp	[ebp+var_C], 0
		jz	short loc_40B199
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40B199
		cmp	[ebp+var_10], 0
		jz	short loc_40B15F

loc_40B199:				; CODE XREF: sub_40B140+47j
					; sub_40B140+51j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40B140	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B19E(int, char *)
sub_40B19E	proc near		; CODE XREF: sub_4020C2+F42p
					; sub_4020C2+F61p ...

Filename	= dword	ptr -28h
Mode		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
File		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, offset aR_0 ; "r"
		mov	[esp+28h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_40B205
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+Filename], eax
		call	sub_406B13
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+Filename], eax	; int
		call	strerror
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Mode],	eax ; char
		mov	[esp+28h+Filename], offset aCanTOpenSS_0 ; "can't open `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		jmp	locret_40B294
; ---------------------------------------------------------------------------

loc_40B205:				; CODE XREF: sub_40B19E+21j
		lea	eax, [ebp+var_14]
		mov	[esp+28h+Filename], eax
		call	ksba_reader_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40B22E
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+File]
		mov	[esp+28h+Mode],	edx
		mov	[esp+28h+Filename], eax
		call	ksba_reader_set_file
		mov	[ebp+var_C], eax

loc_40B22E:				; CODE XREF: sub_40B19E+79j
		cmp	[ebp+var_C], 0
		jz	short loc_40B25F
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Filename], eax
		call	gpg_strerror
		mov	[esp+28h+Mode],	eax ; char
		mov	[esp+28h+Filename], offset aErrorInitial_0 ; "error initializing reader	object:	%s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Filename], eax
		call	ksba_reader_release
		mov	eax, [ebp+var_C]
		jmp	short locret_40B294
; ---------------------------------------------------------------------------

loc_40B25F:				; CODE XREF: sub_40B19E+94j
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	char *
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Mode],	eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Filename], eax	; int
		call	sub_40A08A
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Filename], eax
		call	ksba_reader_release
		mov	eax, [ebp+File]
		mov	[esp+28h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_C]

locret_40B294:				; CODE XREF: sub_40B19E+62j
					; sub_40B19E+BFj
		leave
		retn
sub_40B19E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B296	proc near		; CODE XREF: sub_404E00+C6p
					; sub_405484+169p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 50h
		mov	[ebp+var_2C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_30], 0
		mov	[ebp+var_34], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_40B2E4
		mov	[esp+58h+var_58], offset aCheckingDistri ; "checking distribution points\n"
		call	sub_423387

loc_40B2E4:				; CODE XREF: sub_40B296+40j
		mov	dword ptr [ebp+var_20],	0
		jmp	loc_40B573
; ---------------------------------------------------------------------------

loc_40B2F0:				; CODE XREF: sub_40B296+310j
		mov	[ebp+var_28], 0
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_40B323
		mov	eax, [ebp+var_34]
		test	eax, eax
		jnz	short loc_40B323
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	loc_40B5AE
		mov	[esp+58h+var_58], offset aNoIssuerNameAn ; "no issuer name and no distribution poin"...
		call	sub_423387
		jmp	loc_40B5AE
; ---------------------------------------------------------------------------

loc_40B323:				; CODE XREF: sub_40B296+66j
					; sub_40B296+6Dj
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	[ebp+var_18], 0
		mov	[ebp+var_24], 0
		jmp	loc_40B50E
; ---------------------------------------------------------------------------

loc_40B341:				; CODE XREF: sub_40B296+28Cj
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_24]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	ksba_name_get_uri
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_40B503
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, offset aLdap ; "ldap:"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40B3C2
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, offset aLdaps ; "ldaps:"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40B3D0

loc_40B3C2:				; CODE XREF: sub_40B296+102j
		mov	eax, ds:dword_435FF8
		test	eax, eax
		jz	short loc_40B431
		jmp	loc_40B50A
; ---------------------------------------------------------------------------

loc_40B3D0:				; CODE XREF: sub_40B296+12Aj
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, offset aHttp ; "http:"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40B424
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, offset aHttps ; "https:"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_40B506

loc_40B424:				; CODE XREF: sub_40B296+160j
		mov	eax, ds:dword_435FF4
		test	eax, eax
		jnz	loc_40B509

loc_40B431:				; CODE XREF: sub_40B296+133j
		mov	[ebp+var_1C], 1
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_40B454
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aFetchingCrlF_1 ; "fetching CRL from `%s'\n"
		call	sub_423387

loc_40B454:				; CODE XREF: sub_40B296+1A9j
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], eax ;	int
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_40B9E4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B499
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aCrl_fetchViaDp ; "crl_fetch via DP failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		mov	[ebp+var_28], eax
		jmp	short loc_40B50A
; ---------------------------------------------------------------------------

loc_40B499:				; CODE XREF: sub_40B296+1DEj
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_40B4B5
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aInsertingCrlRe ; "inserting CRL (reader %p)\n"
		call	sub_423387

loc_40B4B5:				; CODE XREF: sub_40B296+20Aj
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], eax ;	char *
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_40A08A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B4FA
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aCrl_cache_inse ; "crl_cache_insert via DP failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		mov	[ebp+var_28], eax
		jmp	short loc_40B50A
; ---------------------------------------------------------------------------

loc_40B4FA:				; CODE XREF: sub_40B296+23Fj
		mov	[ebp+var_28], 0
		jmp	short loc_40B528
; ---------------------------------------------------------------------------

loc_40B503:				; CODE XREF: sub_40B296+D6j
		nop
		jmp	short loc_40B50A
; ---------------------------------------------------------------------------

loc_40B506:				; CODE XREF: sub_40B296+188j
		nop
		jmp	short loc_40B50A
; ---------------------------------------------------------------------------

loc_40B509:				; CODE XREF: sub_40B296+195j
		nop

loc_40B50A:				; CODE XREF: sub_40B296+135j
					; sub_40B296+201j ...
		add	[ebp+var_24], 1

loc_40B50E:				; CODE XREF: sub_40B296+A6j
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_24]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	ksba_name_enum
		test	eax, eax
		jnz	loc_40B341

loc_40B528:				; CODE XREF: sub_40B296+26Bj
		cmp	[ebp+var_28], 0
		jz	short loc_40B539
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	loc_40B6EB
; ---------------------------------------------------------------------------

loc_40B539:				; CODE XREF: sub_40B296+296j
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_58], eax
		call	ksba_name_release
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_34]
		mov	[esp+58h+var_54], 0
		mov	[esp+58h+var_58], eax
		call	ksba_name_get_uri
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_34]
		mov	[esp+58h+var_58], eax
		call	ksba_name_release
		mov	[ebp+var_34], 0

loc_40B573:				; CODE XREF: sub_40B296+55j
		mov	eax, dword ptr [ebp+var_20]
		add	dword ptr [ebp+var_20],	1
		mov	[esp+58h+var_48], 0
		lea	edx, [ebp+var_34]
		mov	[esp+58h+var_4C], edx ;	int
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	ksba_cert_get_crl_dist_point
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_40B2F0
		jmp	short loc_40B5AF
; ---------------------------------------------------------------------------

loc_40B5AE:				; CODE XREF: sub_40B296+76j
					; sub_40B296+88j
		nop

loc_40B5AF:				; CODE XREF: sub_40B296+316j
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_406B06
		cmp	eax, 3FFFh
		jnz	short loc_40B5C8
		mov	[ebp+var_C], 0

loc_40B5C8:				; CODE XREF: sub_40B296+329j
		cmp	[ebp+var_1C], 0
		jnz	loc_40B6EB
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_40B5E7
		mov	[esp+58h+var_58], offset aNoDistribution ; "no distribution point - trying issuer n"...
		call	sub_423387

loc_40B5E7:				; CODE XREF: sub_40B296+343j
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_40B600
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	sub_40C1C5
		mov	[ebp+var_2C], 0

loc_40B600:				; CODE XREF: sub_40B296+356j
		mov	[esp+58h+var_54], 0 ; char
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	ksba_cert_get_issuer
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40B63C
		mov	[esp+58h+var_58], offset aOopsIssuerMiss ; "oops: issuer missing in certificate\n"
		call	sub_4233B1
		mov	[esp+58h+var_58], 0A4h
		call	sub_406AEB
		mov	[ebp+var_C], eax
		jmp	loc_40B6EB
; ---------------------------------------------------------------------------

loc_40B63C:				; CODE XREF: sub_40B296+384j
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_40B651
		mov	[esp+58h+var_58], offset aFetchingCrlF_2 ; "fetching CRL from default location\n"
		call	sub_423387

loc_40B651:				; CODE XREF: sub_40B296+3ADj
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40BE9B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B690
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aCrl_fetchViaIs ; "crl_fetch via issuer failed: %s\n"
		call	sub_4233B1
		jmp	short loc_40B6EB
; ---------------------------------------------------------------------------

loc_40B690:				; CODE XREF: sub_40B296+3DBj
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_40B6AC
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aInsertingCrlRe ; "inserting CRL (reader %p)\n"
		call	sub_423387

loc_40B6AC:				; CODE XREF: sub_40B296+401j
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], eax ;	char *
		mov	[esp+58h+var_54], offset aDefaultLocatio ; "default location(s)"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_40A08A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B6EB
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aCrl_cache_in_0 ; "crl_cache_insert via issuer	failed:	%s\"...
		call	sub_4233B1
		nop

loc_40B6EB:				; CODE XREF: sub_40B296+29Ej
					; sub_40B296+336j ...
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_40B6FD
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	sub_40C1C5

loc_40B6FD:				; CODE XREF: sub_40B296+45Aj
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_58], eax
		call	ksba_name_release
		mov	eax, [ebp+var_34]
		mov	[esp+58h+var_58], eax
		call	ksba_name_release
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	ksba_free
		mov	eax, [ebp+var_C]
		add	esp, 50h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40B296	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B740	proc near		; CODE XREF: sub_40B767+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40B760
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40B765
; ---------------------------------------------------------------------------

loc_40B760:				; CODE XREF: sub_40B740+7j
		mov	eax, 0

loc_40B765:				; CODE XREF: sub_40B740+1Ej
		pop	ebp
		retn
sub_40B740	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B767	proc near		; CODE XREF: sub_40B782+14p
					; sub_40B79D+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_40B740
		leave
		retn
sub_40B767	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B782	proc near		; CODE XREF: sub_40B9E4+37Fp

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_40B767
		leave
		retn
sub_40B782	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B79D	proc near		; CODE XREF: sub_40B9E4+21Cp
					; sub_40C08C+E8p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40B767
		leave
		retn
sub_40B79D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B7B2	proc near		; CODE XREF: sub_40B9E4+2C3p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h

loc_40B7B8:				; CODE XREF: sub_40B7B2+5Bj
		mov	[ebp+var_C], 0
		jmp	short loc_40B7EF
; ---------------------------------------------------------------------------

loc_40B7C1:				; CODE XREF: sub_40B7B2+41j
		mov	eax, [ebp+var_C]
		mov	eax, ds:dword_435060[eax*8]
		test	eax, eax
		jnz	short loc_40B7EB
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	ds:dword_435060[eax*8],	edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	ds:dword_435064[eax*8],	edx
		leave
		retn
; ---------------------------------------------------------------------------

loc_40B7EB:				; CODE XREF: sub_40B7B2+1Bj
		add	[ebp+var_C], 1

loc_40B7EF:				; CODE XREF: sub_40B7B2+Dj
		cmp	[ebp+var_C], 31h
		jle	short loc_40B7C1
		mov	[esp+28h+var_28], offset aReaderToFileMa ; "reader to file mapping table full -	wai"...
		call	sub_423387
		mov	[esp+28h+var_28], 2
		call	pth_sleep
		jmp	short loc_40B7B8
sub_40B7B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B80F	proc near		; CODE XREF: sub_40C1C5+12p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	[ebp+var_8], 0
		jmp	short loc_40B863
; ---------------------------------------------------------------------------

loc_40B825:				; CODE XREF: sub_40B80F+58j
		mov	eax, [ebp+var_8]
		mov	eax, ds:dword_435060[eax*8]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_40B85F
		mov	eax, [ebp+var_8]
		mov	eax, ds:dword_435064[eax*8]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_8]
		mov	ds:dword_435060[eax*8],	0
		mov	eax, [ebp+var_8]
		mov	ds:dword_435064[eax*8],	0
		jmp	short loc_40B869
; ---------------------------------------------------------------------------

loc_40B85F:				; CODE XREF: sub_40B80F+23j
		add	[ebp+var_8], 1

loc_40B863:				; CODE XREF: sub_40B80F+14j
		cmp	[ebp+var_8], 31h
		jle	short loc_40B825

loc_40B869:				; CODE XREF: sub_40B80F+4Ej
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40B80F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B86E	proc near		; DATA XREF: sub_40B9E4+252o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	ecx, [ebp+arg_C]
		mov	[esp+28h+var_1C], ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_41BD13
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B8AD
		mov	eax, [ebp+var_C]
		jmp	locret_40B9E2
; ---------------------------------------------------------------------------

loc_40B8AD:				; CODE XREF: sub_40B86E+35j
		cmp	[ebp+arg_8], 0
		jz	short loc_40B8DE
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40B8DE
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	sub_41B6FF
		test	eax, eax
		jz	short loc_40B8DE
		mov	[esp+28h+var_28], 3FFFh
		call	sub_40B767
		jmp	locret_40B9E2
; ---------------------------------------------------------------------------

loc_40B8DE:				; CODE XREF: sub_40B86E+43j
					; sub_40B86E+4Cj ...
		cmp	[ebp+arg_C], 0
		jnz	short loc_40B906
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	sub_41B771
		test	eax, eax
		jz	short loc_40B906
		mov	[esp+28h+var_28], 8031h
		call	sub_40B767
		jmp	locret_40B9E2
; ---------------------------------------------------------------------------

loc_40B906:				; CODE XREF: sub_40B86E+74j
					; sub_40B86E+85j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+4]
		and	eax, 1
		test	al, al
		jnz	short loc_40B97D
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40B97D
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax+4]
		or	edx, 1
		mov	[eax+4], dl
		mov	eax, [ebp+var_14]
		and	eax, 0C0h
		sar	eax, 6
		test	eax, eax
		jnz	short loc_40B95A
		mov	eax, [ebp+var_14]
		and	eax, 1Fh
		cmp	eax, 10h
		jnz	short loc_40B95A
		mov	eax, [ebp+var_14]
		and	eax, 20h
		test	eax, eax
		jnz	short loc_40B97D

loc_40B95A:				; CODE XREF: sub_40B86E+D5j
					; sub_40B86E+E0j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax+4]
		or	edx, 2
		mov	[eax+4], dl
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+28h+var_24], offset byte_430215
		mov	[esp+28h+var_28], eax
		call	sub_40EBAB

loc_40B97D:				; CODE XREF: sub_40B86E+A4j
					; sub_40B86E+ADj ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+4]
		and	eax, 2
		test	al, al
		jz	short loc_40B9DF
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40B9DF
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		lea	ecx, [edx+8]
		lea	edx, [ebp+var_18]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], ecx
		call	sub_40ECB6
		test	eax, eax
		jz	short loc_40B9D7
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	[esp+28h+var_28], 3FFFh
		call	sub_40B767
		mov	[ebp+var_C], eax
		jmp	short loc_40B9DF
; ---------------------------------------------------------------------------

loc_40B9D7:				; CODE XREF: sub_40B86E+14Dj
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_40B9DF:				; CODE XREF: sub_40B86E+11Bj
					; sub_40B86E+124j ...
		mov	eax, [ebp+var_C]

locret_40B9E2:				; CODE XREF: sub_40B86E+3Aj
					; sub_40B86E+6Bj ...
		leave
		retn
sub_40B86E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B9E4(int, char *, int)
sub_40B9E4	proc near		; CODE XREF: sub_4020C2+1013p
					; sub_406036+5Ep ...

Dest		= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 50h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 2
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_40BA03:				; CODE XREF: sub_40B9E4+3A2j
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Source], eax ;	char *
		lea	eax, [ebp+var_24]
		mov	[esp+58h+Dest],	eax ; int
		call	sub_4138E0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Dest],	eax
		call	sub_413952
		cmp	[ebp+var_C], 0
		jz	loc_40BAF5
		cmp	[ebp+arg_4], 0
		jz	loc_40BAF5
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aHttps_0 ; "https:"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_40BAF5
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40BAF5
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+6]
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 70747468h
		mov	word ptr [eax+4], 3Ah
		mov	eax, [ebp+var_10]
		add	eax, 5
		mov	[esp+58h+Source], edx ;	Source
		mov	[esp+58h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Source], eax ;	char
		lea	eax, [ebp+var_24]
		mov	[esp+58h+Dest],	eax ; int
		call	sub_4138E0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Dest],	eax
		call	sub_413952
		cmp	[ebp+var_C], 0
		jnz	short loc_40BAF5
		mov	[esp+58h+Dest],	offset aUsingHttpInste ; "using	\"http\" instead of \"https\"\n"
		call	sub_423387
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_4], eax

loc_40BAF5:				; CODE XREF: sub_40B9E4+43j
					; sub_40B9E4+4Dj ...
		cmp	[ebp+var_C], 0
		jnz	loc_40BE2C
		mov	eax, ds:dword_435FDC
		test	eax, eax
		jz	short loc_40BB2D
		mov	[esp+58h+Source], offset aHttp_0 ; "HTTP"
		mov	[esp+58h+Dest],	offset aCrlAccessNotPo ; "CRL access not possible due to disabled"...
		call	sub_4233B1
		mov	[esp+58h+Dest],	3Ch
		call	sub_40B767
		mov	[ebp+var_C], eax
		jmp	short loc_40BB8F
; ---------------------------------------------------------------------------

loc_40BB2D:				; CODE XREF: sub_40B9E4+122j
		mov	ecx, ds:dword_435FE8
		mov	eax, ds:dword_435FE4
		test	eax, eax
		jz	short loc_40BB43
		mov	edx, 11h
		jmp	short loc_40BB48
; ---------------------------------------------------------------------------

loc_40BB43:				; CODE XREF: sub_40B9E4+156j
		mov	edx, 10h

loc_40BB48:				; CODE XREF: sub_40B9E4+15Dj
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_40BB5B
		mov	eax, 8
		jmp	short loc_40BB60
; ---------------------------------------------------------------------------

loc_40BB5B:				; CODE XREF: sub_40B9E4+16Ej
		mov	eax, 0

loc_40BB60:				; CODE XREF: sub_40B9E4+175j
		or	eax, edx
		mov	[esp+58h+var_44], 0 ; int
		mov	[esp+58h+var_48], ecx ;	int
		mov	dword ptr [esp+58h+var_4C], eax	; int
		mov	[esp+58h+var_50], 0 ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Source], eax ;	char *
		lea	eax, [ebp+var_28]
		mov	[esp+58h+Dest],	eax ; int
		call	sub_41373C
		mov	[ebp+var_C], eax

loc_40BB8F:				; CODE XREF: sub_40B9E4+147j
		cmp	[ebp+var_C], 0
		jnz	short loc_40BBA2
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dest],	eax
		call	sub_4138C9
		jmp	short loc_40BBA7
; ---------------------------------------------------------------------------

loc_40BBA2:				; CODE XREF: sub_40B9E4+1AFj
		mov	eax, 1869Fh

loc_40BBA7:				; CODE XREF: sub_40B9E4+1BCj
		cmp	eax, 12Eh
		ja	short loc_40BBC5
		cmp	eax, 12Dh
		jnb	loc_40BCC4
		cmp	eax, 0C8h
		jz	short loc_40BBD5
		jmp	loc_40BDE6
; ---------------------------------------------------------------------------

loc_40BBC5:				; CODE XREF: sub_40B9E4+1C8j
		cmp	eax, 1869Fh
		jz	loc_40BDBE
		jmp	loc_40BDE6
; ---------------------------------------------------------------------------

loc_40BBD5:				; CODE XREF: sub_40B9E4+1DAj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dest],	eax
		call	sub_413899
		mov	[ebp+var_18], eax
		mov	[esp+58h+Source], 24h
		mov	[esp+58h+Dest],	1
		call	gcry_calloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40BC08
		call	sub_40B79D
		mov	[ebp+var_C], eax

loc_40BC08:				; CODE XREF: sub_40B9E4+21Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_40BC1C
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Dest],	eax
		call	ksba_reader_new
		mov	[ebp+var_C], eax

loc_40BC1C:				; CODE XREF: sub_40B9E4+228j
		cmp	[ebp+var_C], 0
		jnz	short loc_40BC49
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Source], offset sub_40B86E
		mov	[esp+58h+Dest],	eax
		call	ksba_reader_set_cb
		mov	[ebp+var_C], eax

loc_40BC49:				; CODE XREF: sub_40B9E4+23Cj
		cmp	[ebp+var_C], 0
		jz	short loc_40BC98
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Dest],	eax
		call	gpg_strerror
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+Dest],	offset aErrorInitial_1 ; "error	initializing reader object: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+58h+Dest],	eax
		call	ksba_reader_release
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Source], 0
		mov	[esp+58h+Dest],	eax
		call	sub_4137B6
		jmp	loc_40BE86
; ---------------------------------------------------------------------------

loc_40BC98:				; CODE XREF: sub_40B9E4+269j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+Source], edx
		mov	[esp+58h+Dest],	eax
		call	sub_40B7B2
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Source], 1
		mov	[esp+58h+Dest],	eax
		call	sub_4137B6
		jmp	loc_40BE86
; ---------------------------------------------------------------------------

loc_40BCC4:				; CODE XREF: sub_40B9E4+1CFj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Source], offset aLocation ; "Location"
		mov	[esp+58h+Dest],	eax ; int
		call	sub_414E2B
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dest],	eax
		call	sub_4138C9
		mov	edx, eax
		cmp	[ebp+var_20], 0
		jz	short loc_40BCF2
		mov	eax, [ebp+var_20]
		jmp	short loc_40BCF7
; ---------------------------------------------------------------------------

loc_40BCF2:				; CODE XREF: sub_40B9E4+307j
		mov	eax, offset aNone_2 ; "[none]"

loc_40BCF7:				; CODE XREF: sub_40B9E4+30Cj
		mov	dword ptr [esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+Dest],	offset aUrlSRedirected ; "URL `%s' redirected to `%s' (%u)\n"
		call	sub_423387
		cmp	[ebp+var_20], 0
		jz	short loc_40BD8B
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40BD8B
		cmp	[ebp+var_14], 0
		setnz	al
		sub	[ebp+var_14], 1
		test	al, al
		jz	short loc_40BD8B
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		mov	[ebp+arg_4], 0
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dest],	eax
		call	gcry_strdup
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40BD6D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Dest],	eax
		call	sub_40B782
		mov	[ebp+var_C], eax
		jmp	short loc_40BD9A
; ---------------------------------------------------------------------------

loc_40BD6D:				; CODE XREF: sub_40B9E4+371j
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Source], 0
		mov	[esp+58h+Dest],	eax
		call	sub_4137B6
		jmp	loc_40BA03
; ---------------------------------------------------------------------------

loc_40BD8B:				; CODE XREF: sub_40B9E4+332j
					; sub_40B9E4+33Cj ...
		mov	[esp+58h+Dest],	3Ah
		call	sub_40B767
		mov	[ebp+var_C], eax

loc_40BD9A:				; CODE XREF: sub_40B9E4+387j
		mov	[esp+58h+Dest],	offset aTooManyRedirec ; "too many redirections\n"
		call	sub_4233B1
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Source], 0
		mov	[esp+58h+Dest],	eax
		call	sub_4137B6
		jmp	loc_40BE86
; ---------------------------------------------------------------------------

loc_40BDBE:				; CODE XREF: sub_40B9E4+1E6j
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Dest],	eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+Dest],	offset aErrorRetrievin ; "error	retrieving `%s': %s\n"
		call	sub_4233B1
		nop
		jmp	loc_40BE86
; ---------------------------------------------------------------------------

loc_40BDE6:				; CODE XREF: sub_40B9E4+1DCj
					; sub_40B9E4+1ECj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dest],	eax
		call	sub_4138C9
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+Dest],	offset aErrorRetriev_0 ; "error	retrieving `%s': http status %u\n"
		call	sub_4233B1
		mov	[esp+58h+Dest],	3Ah
		call	sub_40B767
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Source], 0
		mov	[esp+58h+Dest],	eax
		call	sub_4137B6
		jmp	short loc_40BE86
; ---------------------------------------------------------------------------

loc_40BE2C:				; CODE XREF: sub_40B9E4+115j
		mov	eax, ds:dword_435FE0
		test	eax, eax
		jz	short loc_40BE5A
		mov	[esp+58h+Source], offset aLdap_0 ; "LDAP"
		mov	[esp+58h+Dest],	offset aCrlAccessNotPo ; "CRL access not possible due to disabled"...
		call	sub_4233B1
		mov	[esp+58h+Dest],	3Ch
		call	sub_40B767
		mov	[ebp+var_C], eax
		jmp	short loc_40BE86
; ---------------------------------------------------------------------------

loc_40BE5A:				; CODE XREF: sub_40B9E4+44Fj
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_48], eax ;	int
		mov	dword ptr [esp+58h+var_4C], 0 ;	char
		mov	[esp+58h+var_50], 0 ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Source], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dest],	eax ; int
		call	sub_411FE1
		mov	[ebp+var_C], eax

loc_40BE86:				; CODE XREF: sub_40B9E4+2AFj
					; sub_40B9E4+2DBj ...
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		add	esp, 50h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40B9E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BE9B	proc near		; CODE XREF: sub_40B296+3CFp

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_435FE0
		test	eax, eax
		jz	short loc_40BECC
		mov	dword ptr [esp+18h+var_14], offset aLdap_0 ; "LDAP"
		mov	[esp+18h+var_18], offset aCrlAccessNotPo ; "CRL	access not possible due	to disabled"...
		call	sub_4233B1
		mov	[esp+18h+var_18], 3Ch
		call	sub_40B767
		jmp	short locret_40BEED
; ---------------------------------------------------------------------------

loc_40BECC:				; CODE XREF: sub_40BE9B+Dj
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_C], eax
		mov	[esp+18h+var_10], offset aCertificaterev ; "certificateRevocationList"
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4121B9

locret_40BEED:				; CODE XREF: sub_40BE9B+2Fj
		leave
		retn
sub_40BE9B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BEEF	proc near		; CODE XREF: sub_40E092+19Cp
					; sub_40E3E4+2D6p

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_435FE0
		test	eax, eax
		jz	short loc_40BF20
		mov	dword ptr [esp+18h+var_14], offset aLdap_0 ; "LDAP"
		mov	[esp+18h+var_18], offset aCrlAccessNotPo ; "CRL	access not possible due	to disabled"...
		call	sub_4233B1
		mov	[esp+18h+var_18], 3Ch
		call	sub_40B767
		jmp	short locret_40BF41
; ---------------------------------------------------------------------------

loc_40BF20:				; CODE XREF: sub_40BEEF+Dj
		mov	[esp+18h+var_C], offset	aCacertificate ; "cACertificate"
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4127D6

locret_40BF41:				; CODE XREF: sub_40BEEF+2Fj
		leave
		retn
sub_40BEEF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BF43	proc near		; CODE XREF: sub_4059C0+26Bp

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_435FE0
		test	eax, eax
		jz	short loc_40BF74
		mov	dword ptr [esp+18h+var_14], offset aLdap_0 ; "LDAP"
		mov	[esp+18h+var_18], offset aCertificateSea ; "certificate	search not possible due	to "...
		call	sub_4233B1
		mov	[esp+18h+var_18], 3Ch
		call	sub_40B767
		jmp	short locret_40BF94
; ---------------------------------------------------------------------------

loc_40BF74:				; CODE XREF: sub_40BF43+Dj
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_41290B

locret_40BF94:				; CODE XREF: sub_40BF43+2Fj
		leave
		retn
sub_40BF43	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BF96	proc near		; CODE XREF: sub_4059C0+2FEp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_412CC5
		leave
		retn
sub_40BF96	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BFB7	proc near		; CODE XREF: sub_40E092+1D7p
					; sub_40E3E4+311p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_412CC5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BFFE
		mov	eax, [ebp+var_10]
		test	eax, eax
		jnz	short loc_40BFFE
		mov	[esp+28h+var_28], 3Bh
		call	sub_40B767
		mov	[ebp+var_C], eax

loc_40BFFE:				; CODE XREF: sub_40BFB7+2Fj
					; sub_40BFB7+36j
		cmp	[ebp+var_C], 0
		jz	short loc_40C009
		mov	eax, [ebp+var_C]
		jmp	short locret_40C077
; ---------------------------------------------------------------------------

loc_40C009:				; CODE XREF: sub_40BFB7+4Bj
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C02D
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short locret_40C077
; ---------------------------------------------------------------------------

loc_40C02D:				; CODE XREF: sub_40BFB7+64j
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_40C06A
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_C]
		jmp	short locret_40C077
; ---------------------------------------------------------------------------

loc_40C06A:				; CODE XREF: sub_40BFB7+A1j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

locret_40C077:				; CODE XREF: sub_40BFB7+50j
					; sub_40BFB7+74j ...
		leave
		retn
sub_40BFB7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C079	proc near		; CODE XREF: sub_4059C0+3B2p
					; sub_4059C0+46Dp ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_41305A
		leave
		retn
sub_40C079	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C08C	proc near		; CODE XREF: sub_40581B+3Dp

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_38], eax ;	int
		mov	dword ptr [esp+48h+var_3C], 0 ;	char
		mov	[esp+48h+Size],	0 ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Src], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax ; int
		call	sub_411FE1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40C1A3
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+Dst], eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40C1A6
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	ksba_cert_read_der
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40C1A9
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_14]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	ksba_cert_get_image
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40C148
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_40C159

loc_40C148:				; CODE XREF: sub_40C08C+B3j
		mov	[esp+48h+Dst], 0A4h
		call	sub_40B767
		mov	[ebp+var_C], eax
		jmp	short loc_40C1AA
; ---------------------------------------------------------------------------

loc_40C159:				; CODE XREF: sub_40C08C+BAj
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40C17E
		call	sub_40B79D
		mov	[ebp+var_C], eax
		jmp	short loc_40C1AA
; ---------------------------------------------------------------------------

loc_40C17E:				; CODE XREF: sub_40C08C+E6j
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		jmp	short loc_40C1AA
; ---------------------------------------------------------------------------

loc_40C1A3:				; CODE XREF: sub_40C08C+5Dj
		nop
		jmp	short loc_40C1AA
; ---------------------------------------------------------------------------

loc_40C1A6:				; CODE XREF: sub_40C08C+75j
		nop
		jmp	short loc_40C1AA
; ---------------------------------------------------------------------------

loc_40C1A9:				; CODE XREF: sub_40C08C+94j
		nop

loc_40C1AA:				; CODE XREF: sub_40C08C+CBj
					; sub_40C08C+F0j ...
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dst], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Dst], eax
		call	sub_4115C2
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40C08C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C1C5	proc near		; CODE XREF: sub_4020C2+10A1p
					; sub_406036+DDp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_40C23C
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40B80F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C224
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40C1FB
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_41B5DF

loc_40C1FB:				; CODE XREF: sub_40C1C5+27j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+4]
		and	eax, 2
		test	al, al
		jz	short loc_40C217
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	[esp+28h+var_28], eax
		call	sub_40EFDA

loc_40C217:				; CODE XREF: sub_40C1C5+42j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short loc_40C22F
; ---------------------------------------------------------------------------

loc_40C224:				; CODE XREF: sub_40C1C5+1Ej
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4115C2

loc_40C22F:				; CODE XREF: sub_40C1C5+5Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	ksba_reader_release
		jmp	short locret_40C23D
; ---------------------------------------------------------------------------

loc_40C23C:				; CODE XREF: sub_40C1C5+Aj
		nop

locret_40C23D:				; CODE XREF: sub_40C1C5+75j
		leave
		retn
sub_40C1C5	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C240	proc near		; CODE XREF: sub_403566+1Fp
					; sub_40655D+20p ...

Dst		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		jmp	loc_40C2E3
; ---------------------------------------------------------------------------

loc_40C24C:				; CODE XREF: sub_40C240+A7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40C2B6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+Dst], eax ; Dst
		call	memset

loc_40C2B6:				; CODE XREF: sub_40C240+38j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax

loc_40C2E3:				; CODE XREF: sub_40C240+7j
		cmp	[ebp+arg_0], 0
		jnz	loc_40C24C
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40C240	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C2F3	proc near		; CODE XREF: sub_4035E6+166p
					; sub_404FC3+73p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_18], 0
		mov	[esp+38h+Val], 18h
		mov	[esp+38h+Str], 1
		call	gcry_xcalloc
		mov	[ebp+var_1C], eax
		mov	[ebp+var_14], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	loc_40C48E
; ---------------------------------------------------------------------------

loc_40C329:				; CODE XREF: sub_40C2F3+19Fj
		mov	[esp+38h+Val], 3Ah ; Val
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40C34F
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1

loc_40C34F:				; CODE XREF: sub_40C2F3+50j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_4256E4
		cmp	[ebp+var_14], 5	; switch 6 cases
		ja	loc_40C477	; jumptable 0040C371 default case
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, offset off_4303E4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40C373:				; CODE XREF: sub_40C2F3+7Ej
					; DATA XREF: .rdata:off_4303E4o
		mov	eax, [ebp+var_C] ; jumptable 0040C371 case 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40C395
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[eax+4], edx
		jmp	loc_40C484
; ---------------------------------------------------------------------------

loc_40C395:				; CODE XREF: sub_40C2F3+88j
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aSUNoHostnameGi ;	"%s:%u:	no hostname given\n"
		call	sub_4233B1
		mov	[ebp+var_18], 1
		jmp	loc_40C484
; ---------------------------------------------------------------------------

loc_40C3BB:				; CODE XREF: sub_40C2F3+7Ej
					; DATA XREF: .rdata:off_4303E4o
		mov	eax, [ebp+var_C] ; jumptable 0040C371 case 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40C47A
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	atoi
		mov	edx, [ebp+var_1C]
		mov	[edx+8], eax
		jmp	loc_40C47A
; ---------------------------------------------------------------------------

loc_40C3DF:				; CODE XREF: sub_40C2F3+7Ej
					; DATA XREF: .rdata:off_4303E4o
		mov	eax, [ebp+var_C] ; jumptable 0040C371 case 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40C47D
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[eax+0Ch], edx
		jmp	short loc_40C47D
; ---------------------------------------------------------------------------

loc_40C402:				; CODE XREF: sub_40C2F3+7Ej
					; DATA XREF: .rdata:off_4303E4o
		mov	eax, [ebp+var_C] ; jumptable 0040C371 case 4
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40C439
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_40C439
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aSUPasswordGive ;	"%s:%u:	password given without user\n"
		call	sub_4233B1
		mov	[ebp+var_18], 1
		jmp	short loc_40C480
; ---------------------------------------------------------------------------

loc_40C439:				; CODE XREF: sub_40C2F3+117j
					; sub_40C2F3+121j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40C480
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[eax+10h], edx
		jmp	short loc_40C480
; ---------------------------------------------------------------------------

loc_40C458:				; CODE XREF: sub_40C2F3+7Ej
					; DATA XREF: .rdata:off_4303E4o
		mov	eax, [ebp+var_C] ; jumptable 0040C371 case 5
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40C483
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[eax+14h], edx
		jmp	short loc_40C483
; ---------------------------------------------------------------------------

loc_40C477:				; CODE XREF: sub_40C2F3+6Bj
					; sub_40C2F3+7Ej
					; DATA XREF: ...
		nop			; jumptable 0040C371 default case
		jmp	short loc_40C484
; ---------------------------------------------------------------------------

loc_40C47A:				; CODE XREF: sub_40C2F3+D0j
					; sub_40C2F3+E7j
		nop
		jmp	short loc_40C484
; ---------------------------------------------------------------------------

loc_40C47D:				; CODE XREF: sub_40C2F3+F4j
					; sub_40C2F3+10Dj
		nop
		jmp	short loc_40C484
; ---------------------------------------------------------------------------

loc_40C480:				; CODE XREF: sub_40C2F3+144j
					; sub_40C2F3+14Ej ...
		nop
		jmp	short loc_40C484
; ---------------------------------------------------------------------------

loc_40C483:				; CODE XREF: sub_40C2F3+16Dj
					; sub_40C2F3+182j
		nop

loc_40C484:				; CODE XREF: sub_40C2F3+9Dj
					; sub_40C2F3+C3j ...
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		add	[ebp+var_14], 1

loc_40C48E:				; CODE XREF: sub_40C2F3+31j
		cmp	[ebp+var_C], 0
		jnz	loc_40C329
		cmp	[ebp+var_18], 0
		jz	short loc_40C4C3
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aSUSkippingThis ;	"%s:%u:	skipping this line\n"
		call	sub_423387
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str], eax
		call	sub_40C240

loc_40C4C3:				; CODE XREF: sub_40C2F3+1A9j
		mov	eax, [ebp+var_1C]
		leave
		retn
sub_40C2F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C4C8	proc near		; CODE XREF: sub_40C4EF+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40C4E8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40C4ED
; ---------------------------------------------------------------------------

loc_40C4E8:				; CODE XREF: sub_40C4C8+7j
		mov	eax, 0

loc_40C4ED:				; CODE XREF: sub_40C4C8+1Ej
		pop	ebp
		retn
sub_40C4C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C4EF	proc near		; CODE XREF: sub_40C517+14p
					; sub_40C532+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_40C4C8
		leave
		retn
sub_40C4EF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C50A	proc near		; CODE XREF: sub_40CD34+28Cp
					; sub_40D2A0+3Cp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_40C50A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C517	proc near		; CODE XREF: sub_40C9C5+226p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_40C4EF
		leave
		retn
sub_40C517	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C532	proc near		; CODE XREF: sub_40DE2E+D3p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40C4EF
		leave
		retn
sub_40C532	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C547	proc near		; CODE XREF: sub_40D0E6+13p

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset dword_435600
		call	pth_rwlock_init
		test	eax, eax
		jnz	short locret_40C57E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aCanTInitialize ; "can't initialize certificate cache lock"...
		call	sub_4233F4
; ---------------------------------------------------------------------------

locret_40C57E:				; CODE XREF: sub_40C547+14j
		leave
		retn
sub_40C547	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C580	proc near		; CODE XREF: sub_40D39E+6p
					; sub_40D75D+6p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	[esp+18h+var_10], 0
		mov	dword ptr [esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset dword_435600
		call	pth_rwlock_acquire
		test	eax, eax
		jnz	short locret_40C5CF
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aCanTAcquireRea ; "can't acquire read lock on the certific"...
		call	sub_4233F4
; ---------------------------------------------------------------------------

locret_40C5CF:				; CODE XREF: sub_40C580+2Cj
		leave
		retn
sub_40C580	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C5D1	proc near		; CODE XREF: sub_40D0E6+18p
					; sub_40D198+13p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	[esp+18h+var_10], 0
		mov	dword ptr [esp+18h+var_14], 1
		mov	[esp+18h+var_18], offset dword_435600
		call	pth_rwlock_acquire
		test	eax, eax
		jnz	short locret_40C620
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aCanTAcquireWri ; "can't acquire write lock on the certifi"...
		call	sub_4233F4
; ---------------------------------------------------------------------------

locret_40C620:				; CODE XREF: sub_40C5D1+2Cj
		leave
		retn
sub_40C5D1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C622	proc near		; CODE XREF: sub_40D0E6+A3p
					; sub_40D198+CCp ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset dword_435600
		call	pth_rwlock_release
		test	eax, eax
		jnz	short locret_40C659
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aCanTReleaseLoc ; "can't release lock on the certificate c"...
		call	sub_4233F4
; ---------------------------------------------------------------------------

locret_40C659:				; CODE XREF: sub_40C622+14j
		leave
		retn
sub_40C622	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C65B	proc near		; CODE XREF: sub_40C750+13p
					; sub_40D75D+56p ...

Str		= dword	ptr -38h
EndPtr		= dword	ptr -34h
Radix		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C679
		cmp	[ebp+var_10], 0
		jnz	short loc_40C696

loc_40C679:				; CODE XREF: sub_40C65B+16j
		cmp	[ebp+var_C], 0
		jnz	short loc_40C685
		cmp	[ebp+var_10], 0
		jz	short loc_40C68C

loc_40C685:				; CODE XREF: sub_40C65B+22j
		mov	eax, 1
		jmp	short loc_40C691
; ---------------------------------------------------------------------------

loc_40C68C:				; CODE XREF: sub_40C65B+28j
		mov	eax, 0

loc_40C691:				; CODE XREF: sub_40C65B+2Fj
		jmp	locret_40C74E
; ---------------------------------------------------------------------------

loc_40C696:				; CODE XREF: sub_40C65B+1Cj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+1]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+EndPtr], eax ;	EndPtr
		mov	[esp+38h+Str], edx ; Str
		call	strtoul
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		lea	edx, [eax+1]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+EndPtr], eax ;	char
		mov	[esp+38h+Str], edx ; Str
		call	strtoul
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_40C6F6
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_40C709

loc_40C6F6:				; CODE XREF: sub_40C65B+8Fj
		mov	[esp+38h+Str], offset aInvalidSExpInC ;	"invalid S-exp in compare_serialno\n"
		call	sub_42344E
		mov	eax, 1
		jmp	short locret_40C74E
; ---------------------------------------------------------------------------

loc_40C709:				; CODE XREF: sub_40C65B+99j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jz	short loc_40C718
		mov	eax, 1
		jmp	short locret_40C74E
; ---------------------------------------------------------------------------

loc_40C718:				; CODE XREF: sub_40C65B+B4j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1
		jmp	short loc_40C72E
; ---------------------------------------------------------------------------

loc_40C722:				; CODE XREF: sub_40C65B+E7j
		sub	[ebp+var_14], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_40C72E:				; CODE XREF: sub_40C65B+C5j
		cmp	[ebp+var_14], 0
		jz	short loc_40C744
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_40C722

loc_40C744:				; CODE XREF: sub_40C65B+D7j
		cmp	[ebp+var_14], 0
		setnz	al
		movzx	eax, al

locret_40C74E:				; CODE XREF: sub_40C65B:loc_40C691j
					; sub_40C65B+ACj ...
		leave
		retn
sub_40C65B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C750	proc near		; CODE XREF: sub_40E3E4+148p
					; sub_40E3E4+430p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40C65B
		leave
		retn
sub_40C750	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C76A	proc near		; CODE XREF: sub_40DE2E+C5p

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_4C		= dword	ptr -4Ch
var_3C		= byte ptr -3Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_64], eax
		mov	[esp+68h+var_68], 0
		call	sub_416255
		mov	dword ptr [ebp+var_C], eax
		mov	eax, offset aU	; "(%u:"
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+68h+var_5C], edx	; char
		mov	[esp+68h+var_60], eax ;	char *
		mov	[esp+68h+var_64], 28h ;	size_t
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+var_68], eax ;	char *
		call	sub_429570
		lea	eax, [ebp+var_3C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, dword ptr [ebp+var_C]
		add	eax, 2
		mov	[esp+68h+var_68], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40C7E7
		mov	eax, 0
		jmp	short loc_40C82B
; ---------------------------------------------------------------------------

loc_40C7E7:				; CODE XREF: sub_40C76A+74j
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax
		call	sub_4265EB
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+var_14]
		mov	[esp+68h+var_68], eax
		call	sub_416255
		mov	dword ptr [ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	byte ptr [eax],	29h
		mov	eax, dword ptr [ebp+var_C]
		add	eax, 1
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_10]

loc_40C82B:				; CODE XREF: sub_40C76A+7Bj
		add	esp, 64h
		pop	edi
		pop	ebp
		retn
sub_40C76A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C831	proc near		; CODE XREF: sub_40634F+DFp
					; sub_40C9C5+163p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 2
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_md_open
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C876
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aGcry_md_openFa ; "gcry_md_open failed: %s\n"
		call	sub_4233F4
; ---------------------------------------------------------------------------

loc_40C876:				; CODE XREF: sub_40C831+28j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset gcry_md_write
		mov	dword ptr [esp+28h+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_hash
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C8E3
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aOopsKsba_cert_ ; "oops: ksba_cert_hash failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	dword ptr [eax+8], 0FFFFFFFFh
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		jmp	short loc_40C93A
; ---------------------------------------------------------------------------

loc_40C8E3:				; CODE XREF: sub_40C831+6Ej
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 5
		mov	[esp+28h+var_28], eax
		call	gcry_md_ctl
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+28h+var_24], 2
		mov	[esp+28h+var_28], eax
		call	gcry_md_read
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [edx+10h]
		mov	[eax+10h], edx

loc_40C93A:				; CODE XREF: sub_40C831+B0j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_md_close
		mov	eax, [ebp+arg_4]
		leave
		retn
sub_40C831	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C94A	proc near		; CODE XREF: sub_40C9C5+DBp
					; sub_40C9C5+2E3p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40C9C2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	[esp+28h+var_28], eax
		call	ksba_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+28h+var_28], eax
		call	ksba_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+var_28], eax
		call	ksba_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_release
		jmp	short locret_40C9C3
; ---------------------------------------------------------------------------

loc_40C9C2:				; CODE XREF: sub_40C94A+Ej
		nop

locret_40C9C3:				; CODE XREF: sub_40C94A+76j
		leave
		retn
sub_40C94A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C9C5	proc near		; CODE XREF: sub_40CD34+27Ep
					; sub_40D2A0+29p ...

Buf1		= dword	ptr -48h
Buf2		= dword	ptr -44h
Size		= dword	ptr -40h
var_30		= byte ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_C], 0
		jnz	short loc_40C9D6
		lea	eax, [ebp+var_30]
		jmp	short loc_40C9D9
; ---------------------------------------------------------------------------

loc_40C9D6:				; CODE XREF: sub_40C9C5+Aj
		mov	eax, [ebp+arg_C]

loc_40C9D9:				; CODE XREF: sub_40C9C5+Fj
		mov	[ebp+var_1C], eax
		cmp	[ebp+arg_4], 0
		jnz	loc_40CB1B
		mov	eax, ds:dword_43560C
		cmp	eax, 3E7h
		jbe	loc_40CB1B
		mov	dword ptr [ebp+var_18],	32h
		cmp	dword ptr [ebp+var_18],	1
		ja	short loc_40CA0A
		mov	dword ptr [ebp+var_18],	2

loc_40CA0A:				; CODE XREF: sub_40C9C5+3Cj
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+48h+Buf2],	eax ; char
		mov	[esp+48h+Buf1],	offset aDroppingUCerti ; "dropping %u certificates from	the cache"...
		call	sub_423387
		mov	eax, ds:dword_435610
		cmp	eax, 0FFh
		jle	short loc_40CA45
		mov	[esp+48h+Size],	11Fh ; int
		mov	[esp+48h+Buf2],	offset a____Dirmngr1_3 ; "../../dirmngr-1.1.1/src/certcache.c"
		mov	[esp+48h+Buf1],	offset aIdx256 ; "idx <	256"
		call	sub_429780

loc_40CA45:				; CODE XREF: sub_40C9C5+62j
		mov	eax, ds:dword_435610
		mov	[ebp+var_14], eax
		jmp	loc_40CAD5
; ---------------------------------------------------------------------------

loc_40CA52:				; CODE XREF: sub_40C9C5+114j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_14]
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40CA8E
; ---------------------------------------------------------------------------

loc_40CA68:				; CODE XREF: sub_40C9C5+CDj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40CA86
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+28h]
		and	eax, 1
		test	al, al
		jnz	short loc_40CA86
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax

loc_40CA86:				; CODE XREF: sub_40C9C5+ABj
					; sub_40C9C5+B9j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40CA8E:				; CODE XREF: sub_40C9C5+A1j
		cmp	[ebp+var_C], 0
		jnz	short loc_40CA68
		cmp	[ebp+var_10], 0
		jz	short loc_40CAB6
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Buf1],	eax
		call	sub_40C94A
		sub	dword ptr [ebp+var_18],	1
		mov	eax, ds:dword_43560C
		sub	eax, 1
		mov	ds:dword_43560C, eax

loc_40CAB6:				; CODE XREF: sub_40C9C5+D3j
		mov	eax, [ebp+var_14]
		lea	edx, [eax+1]
		mov	eax, edx
		sar	eax, 1Fh
		shr	eax, 18h
		add	edx, eax
		and	edx, 0FFh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax

loc_40CAD5:				; CODE XREF: sub_40C9C5+88j
		cmp	dword ptr [ebp+var_18],	0
		jnz	loc_40CA52
		mov	eax, ds:dword_435610
		cmp	[ebp+var_14], eax
		jnz	short loc_40CAF8
		mov	eax, ds:dword_435610
		add	eax, 1
		mov	ds:dword_435610, eax
		jmp	short loc_40CB00
; ---------------------------------------------------------------------------

loc_40CAF8:				; CODE XREF: sub_40C9C5+122j
		mov	eax, [ebp+var_14]
		mov	ds:dword_435610, eax

loc_40CB00:				; CODE XREF: sub_40C9C5+131j
		mov	eax, ds:dword_435610
		mov	edx, eax
		sar	edx, 1Fh
		shr	edx, 18h
		add	eax, edx
		and	eax, 0FFh
		sub	eax, edx
		mov	ds:dword_435610, eax

loc_40CB1B:				; CODE XREF: sub_40C9C5+1Bj
					; sub_40C9C5+2Bj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Buf1],	eax
		call	sub_40C831
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40CB86
; ---------------------------------------------------------------------------

loc_40CB42:				; CODE XREF: sub_40C9C5+1C5j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40CB7E
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	[esp+48h+Size],	14h ; Size
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Buf2],	eax ; Buf2
		mov	[esp+48h+Buf1],	edx ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_40CB7E
		mov	[esp+48h+Buf1],	9Dh
		call	sub_40C4EF
		jmp	locret_40CD32
; ---------------------------------------------------------------------------

loc_40CB7E:				; CODE XREF: sub_40C9C5+185j
					; sub_40C9C5+1A6j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40CB86:				; CODE XREF: sub_40C9C5+17Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_40CB42
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40CBB3
; ---------------------------------------------------------------------------

loc_40CBA1:				; CODE XREF: sub_40C9C5+1F2j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40CBBB
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40CBB3:				; CODE XREF: sub_40C9C5+1DAj
		cmp	[ebp+var_C], 0
		jnz	short loc_40CBA1
		jmp	short loc_40CBBC
; ---------------------------------------------------------------------------

loc_40CBBB:				; CODE XREF: sub_40C9C5+1E4j
		nop

loc_40CBBC:				; CODE XREF: sub_40C9C5+1F4j
		cmp	[ebp+var_C], 0
		jnz	short loc_40CC1F
		mov	[esp+48h+Buf2],	2Ch
		mov	[esp+48h+Buf1],	1
		call	gcry_calloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40CBF5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Buf1],	eax
		call	sub_40C517
		jmp	locret_40CD32
; ---------------------------------------------------------------------------

loc_40CBF5:				; CODE XREF: sub_40C9C5+218j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, ds:dword_435200[eax*4]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+var_C]
		mov	ds:dword_435200[eax*4],	edx
		jmp	short loc_40CC2B
; ---------------------------------------------------------------------------

loc_40CC1F:				; CODE XREF: sub_40C9C5+1FBj
		mov	eax, [ebp+var_C]
		add	eax, 28h
		mov	dword ptr [eax], 0

loc_40CC2B:				; CODE XREF: sub_40C9C5+258j
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Buf1],	eax
		call	ksba_cert_ref
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[eax+4], edx
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [edx+10h]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Buf1],	eax
		call	ksba_cert_get_serial
		mov	edx, [ebp+var_C]
		mov	[edx+20h], eax
		mov	[esp+48h+Buf2],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Buf1],	eax
		call	ksba_cert_get_issuer
		mov	edx, [ebp+var_C]
		mov	[edx+1Ch], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_40CCA2
		mov	eax, [ebp+var_C]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_40CCBB

loc_40CCA2:				; CODE XREF: sub_40C9C5+2D1j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Buf1],	eax
		call	sub_40C94A
		mov	[esp+48h+Buf1],	0A4h
		call	sub_40C4EF
		jmp	short locret_40CD32
; ---------------------------------------------------------------------------

loc_40CCBB:				; CODE XREF: sub_40C9C5+2DBj
		mov	[esp+48h+Buf2],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Buf1],	eax
		call	ksba_cert_get_subject
		mov	edx, [ebp+var_C]
		mov	[edx+24h], eax
		cmp	[ebp+arg_4], 0
		setnz	dl
		mov	eax, [ebp+var_C]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+28h]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+28h], dl
		cmp	[ebp+arg_8], 0
		setnz	dl
		mov	eax, [ebp+var_C]
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+28h]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+28h], dl
		cmp	[ebp+arg_4], 0
		jz	short loc_40CD20
		mov	eax, ds:dword_435608
		add	eax, 1
		mov	ds:dword_435608, eax
		jmp	short loc_40CD2D
; ---------------------------------------------------------------------------

loc_40CD20:				; CODE XREF: sub_40C9C5+34Aj
		mov	eax, ds:dword_43560C
		add	eax, 1
		mov	ds:dword_43560C, eax

loc_40CD2D:				; CODE XREF: sub_40C9C5+359j
		mov	eax, 0

locret_40CD32:				; CODE XREF: sub_40C9C5+1B4j
					; sub_40C9C5+22Bj ...
		leave
		retn
sub_40C9C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40CD34(LPCSTR, int)
sub_40CD34	proc near		; CODE XREF: sub_40D0E6+4Bp
					; sub_40D0E6+89p

Filename	= dword	ptr -58h
Mode		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 50h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Filename], eax	; LPCSTR
		call	sub_429860
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_40D0AC
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_40CD8C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Filename], eax	; int
		call	strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aCanTAccessDire ; "can't access directory `%s': %s\n"
		call	sub_423387

loc_40CD8C:				; CODE XREF: sub_40CD34+2Ej
		mov	eax, 0
		jmp	loc_40D0DF
; ---------------------------------------------------------------------------

loc_40CD96:				; CODE XREF: sub_40CD34+38Aj
		mov	eax, [ebp+var_18]
		add	eax, 8
		mov	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jz	loc_40D0A8
		mov	eax, dword ptr [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40D0A8
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 4
		jbe	loc_40D0AB
		mov	eax, [ebp+var_20]
		sub	eax, 4
		add	eax, dword ptr [ebp+var_1C]
		mov	edx, eax
		mov	eax, offset a_crt ; ".crt"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40CE47
		mov	eax, [ebp+var_20]
		sub	eax, 4
		add	eax, dword ptr [ebp+var_1C]
		mov	edx, eax
		mov	eax, offset a_der ; ".der"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_40D0AB

loc_40CE47:				; CODE XREF: sub_40CD34+DFj
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	[esp+58h+var_50], 0
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+Mode],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Filename], eax
		call	sub_4259CC
		mov	[ebp+var_10], eax
		mov	edx, offset aRb_0 ; "rb"
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Mode],	edx ; Mode
		mov	[esp+58h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_40CEB9
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Filename], eax	; int
		call	strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aCanTOpenSS_1 ; "can't open `%s': %s\n"
		call	sub_4233B1
		jmp	loc_40D0AC
; ---------------------------------------------------------------------------

loc_40CEB9:				; CODE XREF: sub_40CD34+156j
		lea	eax, [ebp+var_28]
		mov	[esp+58h+Filename], eax
		call	ksba_reader_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40CEE2
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+File]
		mov	[esp+58h+Mode],	edx
		mov	[esp+58h+Filename], eax
		call	ksba_reader_set_file
		mov	[ebp+var_C], eax

loc_40CEE2:				; CODE XREF: sub_40CD34+197j
		cmp	[ebp+var_C], 0
		jz	short loc_40CF1E
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Filename], eax
		call	gpg_strerror
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aCanTSetupKsbaR ; "can't setup KSBA reader: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Filename], eax
		call	ksba_reader_release
		mov	eax, [ebp+File]
		mov	[esp+58h+Filename], eax	; File
		call	fclose
		jmp	loc_40D0AC
; ---------------------------------------------------------------------------

loc_40CF1E:				; CODE XREF: sub_40CD34+1B2j
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+Filename], eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40CF47
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Mode],	edx
		mov	[esp+58h+Filename], eax
		call	ksba_cert_read_der
		mov	[ebp+var_C], eax

loc_40CF47:				; CODE XREF: sub_40CD34+1FCj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Filename], eax
		call	ksba_reader_release
		mov	eax, [ebp+File]
		mov	[esp+58h+Filename], eax	; File
		call	fclose
		cmp	[ebp+var_C], 0
		jz	short loc_40CF95
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Filename], eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aCanTParseCerti ; "can't parse certificate `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Filename], eax
		call	ksba_cert_release
		jmp	loc_40D0AC
; ---------------------------------------------------------------------------

loc_40CF95:				; CODE XREF: sub_40CD34+22Dj
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_4C], 0
		mov	edx, [ebp+arg_4]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Mode],	1
		mov	[esp+58h+Filename], eax
		call	sub_40C9C5
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Filename], eax
		call	sub_40C50A
		cmp	eax, 9Dh
		jnz	short loc_40CFE4
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aCertificateSAl ; "certificate `%s' already cached\n"
		call	sub_423387
		jmp	loc_40D09B
; ---------------------------------------------------------------------------

loc_40CFE4:				; CODE XREF: sub_40CD34+296j
		cmp	[ebp+var_C], 0
		jnz	loc_40D079
		cmp	[ebp+arg_4], 0
		jz	short loc_40D009
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aTrustedCertifi ; "trusted certificate `%s' loaded\n"
		call	sub_423387
		jmp	short loc_40D01C
; ---------------------------------------------------------------------------

loc_40D009:				; CODE XREF: sub_40CD34+2BEj
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aCertificateSLo ; "certificate `%s' loaded\n"
		call	sub_423387

loc_40D01C:				; CODE XREF: sub_40CD34+2D3j
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_40D09B
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Filename], eax
		call	sub_4168B2
		mov	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aSha1Fingerprin ; "	SHA1 fingerprint = %s\n"
		call	sub_423387
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Mode],	eax
		mov	[esp+58h+Filename], offset aIssuer ; "	 issuer	="
		call	sub_416DBE
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Mode],	eax
		mov	[esp+58h+Filename], offset aSubject ; "	 subject ="
		call	sub_416E7E
		jmp	short loc_40D09B
; ---------------------------------------------------------------------------

loc_40D079:				; CODE XREF: sub_40CD34+2B4j
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Filename], eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aErrorLoadingCe ; "error loading certificate	`%s': %s\n"
		call	sub_4233B1

loc_40D09B:				; CODE XREF: sub_40CD34+2ABj
					; sub_40CD34+2EFj ...
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Filename], eax
		call	ksba_cert_release
		jmp	short loc_40D0AC
; ---------------------------------------------------------------------------

loc_40D0A8:				; CODE XREF: sub_40CD34+73j
					; sub_40CD34+81j
		nop
		jmp	short loc_40D0AC
; ---------------------------------------------------------------------------

loc_40D0AB:				; CODE XREF: sub_40CD34+ADj
					; sub_40CD34+10Dj
		nop

loc_40D0AC:				; CODE XREF: sub_40CD34+21j
					; sub_40CD34+180j ...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Filename], eax
		call	sub_429A90
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_40CD96
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Filename], eax	; void *
		call	sub_429BB0
		mov	eax, 0

loc_40D0DF:				; CODE XREF: sub_40CD34+5Dj
		add	esp, 50h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40CD34	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D0E6	proc near		; CODE XREF: sub_4020C2+AF6p
					; sub_4020C2+E15p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_435604
		test	eax, eax
		jnz	loc_40D195
		call	sub_40C547
		call	sub_40C5D1
		mov	eax, ds:dword_435FB4
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset aTrustedCerts ; "trusted-certs"
		mov	[esp+28h+var_28], eax
		call	sub_4259CC
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_24], 1 ; int
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_40CD34
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, ds:dword_435FB8
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset aExtraCerts ; "extra-certs"
		mov	[esp+28h+var_28], eax
		call	sub_4259CC
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_40CD34
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	ds:dword_435604, 1
		call	sub_40C622
		call	sub_40D26E
		jmp	short locret_40D196
; ---------------------------------------------------------------------------

loc_40D195:				; CODE XREF: sub_40D0E6+Dj
		nop

locret_40D196:				; CODE XREF: sub_40D0E6+ADj
		leave
		retn
sub_40D0E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D198	proc near		; CODE XREF: sub_403566+12p

var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_435604
		test	eax, eax
		jz	loc_40D26B
		call	sub_40C5D1
		mov	[ebp+var_10], 0
		jmp	short loc_40D1E5
; ---------------------------------------------------------------------------

loc_40D1B9:				; CODE XREF: sub_40D198+54j
		mov	eax, [ebp+var_10]
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40D1DB
; ---------------------------------------------------------------------------

loc_40D1C8:				; CODE XREF: sub_40D198+47j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40C94A
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40D1DB:				; CODE XREF: sub_40D198+2Ej
		cmp	[ebp+var_C], 0
		jnz	short loc_40D1C8
		add	[ebp+var_10], 1

loc_40D1E5:				; CODE XREF: sub_40D198+1Fj
		cmp	[ebp+var_10], 0FFh
		jle	short loc_40D1B9
		cmp	[ebp+arg_0], 0
		jz	short loc_40D246
		mov	[ebp+var_10], 0
		jmp	short loc_40D23D
; ---------------------------------------------------------------------------

loc_40D1FD:				; CODE XREF: sub_40D198+ACj
		mov	eax, [ebp+var_10]
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40D225
; ---------------------------------------------------------------------------

loc_40D20C:				; CODE XREF: sub_40D198+91j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax

loc_40D225:				; CODE XREF: sub_40D198+72j
		cmp	[ebp+var_C], 0
		jnz	short loc_40D20C
		mov	eax, [ebp+var_10]
		mov	ds:dword_435200[eax*4],	0
		add	[ebp+var_10], 1

loc_40D23D:				; CODE XREF: sub_40D198+63j
		cmp	[ebp+var_10], 0FFh
		jle	short loc_40D1FD

loc_40D246:				; CODE XREF: sub_40D198+5Aj
		mov	ds:dword_435608, 0
		mov	ds:dword_43560C, 0
		mov	ds:dword_435604, 0
		call	sub_40C622
		jmp	short locret_40D26C
; ---------------------------------------------------------------------------

loc_40D26B:				; CODE XREF: sub_40D198+Dj
		nop

locret_40D26C:				; CODE XREF: sub_40D198+D1j
		leave
		retn
sub_40D198	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D26E	proc near		; CODE XREF: sub_40D0E6+A8p

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_435608
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aPermanentlyLoa ; "permanently	loaded certificates: %u\n"
		call	sub_423387
		mov	eax, ds:dword_43560C
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aRuntimeCachedC ; "	runtime	cached certificates: %u\n"
		call	sub_423387
		leave
		retn
sub_40D26E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D2A0	proc near		; CODE XREF: sub_406236+D5p
					; sub_40E092+153p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40C5D1
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0 ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40C9C5
		mov	[ebp+var_C], eax
		call	sub_40C622
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40C50A
		cmp	eax, 9Dh
		jnz	short loc_40D2F6
		mov	[esp+28h+var_28], offset aCertificateAlr ; "certificate	already	cached\n"
		call	sub_423387
		jmp	short loc_40D325
; ---------------------------------------------------------------------------

loc_40D2F6:				; CODE XREF: sub_40D2A0+46j
		cmp	[ebp+var_C], 0
		jnz	short loc_40D30A
		mov	[esp+28h+var_28], offset aCertificateCac ; "certificate	cached\n"
		call	sub_423387
		jmp	short loc_40D325
; ---------------------------------------------------------------------------

loc_40D30A:				; CODE XREF: sub_40D2A0+5Aj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorCachingCe ; "error caching certificate: %s\n"
		call	sub_4233B1

loc_40D325:				; CODE XREF: sub_40D2A0+54j
					; sub_40D2A0+68j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D2A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D32A	proc near		; CODE XREF: sub_417DA7+1CAp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40C5D1
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40C9C5
		mov	[ebp+var_C], eax
		call	sub_40C622
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40C50A
		cmp	eax, 9Dh
		jnz	short loc_40D378
		mov	[ebp+var_C], 0

loc_40D378:				; CODE XREF: sub_40D32A+45j
		cmp	[ebp+var_C], 0
		jz	short loc_40D399
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorCachingCe ; "error caching certificate: %s\n"
		call	sub_4233B1

loc_40D399:				; CODE XREF: sub_40D32A+52j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D32A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D39E(void *)
sub_40D39E	proc near		; CODE XREF: sub_405484+35p
					; sub_405654+59p ...

Buf1		= dword	ptr -28h
Buf2		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40C580
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40D40C
; ---------------------------------------------------------------------------

loc_40D3BE:				; CODE XREF: sub_40D39E+72j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40D404
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	[esp+28h+Size],	14h ; Size
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Buf2],	eax ; Buf2
		mov	[esp+28h+Buf1],	edx ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_40D404
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+Buf1],	eax
		call	ksba_cert_ref
		call	sub_40C622
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		jmp	short locret_40D41C
; ---------------------------------------------------------------------------

loc_40D404:				; CODE XREF: sub_40D39E+28j
					; sub_40D39E+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40D40C:				; CODE XREF: sub_40D39E+1Ej
		cmp	[ebp+var_C], 0
		jnz	short loc_40D3BE
		call	sub_40C622
		mov	eax, 0

locret_40D41C:				; CODE XREF: sub_40D39E+64j
		leave
		retn
sub_40D39E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D41E(char *)
sub_40D41E	proc near		; CODE XREF: sub_40DE2E+96p
					; sub_417DA7+F4p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Val], 3Ah ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_40D5D1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_40D520
; ---------------------------------------------------------------------------

loc_40D451:				; CODE XREF: sub_40D41E+168j
					; sub_40D41E+186j ...
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40D46F
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	loc_40D722

loc_40D46F:				; CODE XREF: sub_40D41E+3Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40D48C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40D4B8
; ---------------------------------------------------------------------------

loc_40D48C:				; CODE XREF: sub_40D41E+59j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40D4A7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40D4B6
; ---------------------------------------------------------------------------

loc_40D4A7:				; CODE XREF: sub_40D41E+76j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40D4B6:				; CODE XREF: sub_40D41E+87j
		mov	edx, eax

loc_40D4B8:				; CODE XREF: sub_40D41E+6Cj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40D4D3
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_40D4FA
; ---------------------------------------------------------------------------

loc_40D4D3:				; CODE XREF: sub_40D41E+A5j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40D4EE
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_40D4FA
; ---------------------------------------------------------------------------

loc_40D4EE:				; CODE XREF: sub_40D41E+C0j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_40D4FA:				; CODE XREF: sub_40D41E+B3j
					; sub_40D41E+CEj
		add	edx, eax
		lea	eax, [ebp+var_24]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_C], 2
		cmp	[ebp+var_10], 14h
		jz	short loc_40D520
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_40D520
		add	[ebp+var_C], 1

loc_40D520:				; CODE XREF: sub_40D41E+2Ej
					; sub_40D41E+F2j ...
		cmp	[ebp+var_10], 13h
		jg	loc_40D725
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40D53E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40D56E

loc_40D53E:				; CODE XREF: sub_40D41E+114j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40D552
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40D56E

loc_40D552:				; CODE XREF: sub_40D41E+128j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_40D725
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_40D725

loc_40D56E:				; CODE XREF: sub_40D41E+11Ej
					; sub_40D41E+132j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40D58C
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	loc_40D451

loc_40D58C:				; CODE XREF: sub_40D41E+15Bj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40D5AA
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	loc_40D451

loc_40D5AA:				; CODE XREF: sub_40D41E+179j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_40D725
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_40D451
		jmp	loc_40D725
; ---------------------------------------------------------------------------

loc_40D5D1:				; CODE XREF: sub_40D41E+1Bj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_40D680
; ---------------------------------------------------------------------------

loc_40D5E3:				; CODE XREF: sub_40D41E+2C0j
					; sub_40D41E+2DEj ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40D600
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40D62C
; ---------------------------------------------------------------------------

loc_40D600:				; CODE XREF: sub_40D41E+1CDj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40D61B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40D62A
; ---------------------------------------------------------------------------

loc_40D61B:				; CODE XREF: sub_40D41E+1EAj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40D62A:				; CODE XREF: sub_40D41E+1FBj
		mov	edx, eax

loc_40D62C:				; CODE XREF: sub_40D41E+1E0j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40D647
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_40D66E
; ---------------------------------------------------------------------------

loc_40D647:				; CODE XREF: sub_40D41E+219j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40D662
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_40D66E
; ---------------------------------------------------------------------------

loc_40D662:				; CODE XREF: sub_40D41E+234j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_40D66E:				; CODE XREF: sub_40D41E+227j
					; sub_40D41E+242j
		add	edx, eax
		lea	eax, [ebp+var_24]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_C], 2

loc_40D680:				; CODE XREF: sub_40D41E+1C0j
		cmp	[ebp+var_10], 13h
		jg	loc_40D726
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40D69E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40D6C6

loc_40D69E:				; CODE XREF: sub_40D41E+274j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40D6B2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40D6C6

loc_40D6B2:				; CODE XREF: sub_40D41E+288j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40D726
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_40D726

loc_40D6C6:				; CODE XREF: sub_40D41E+27Ej
					; sub_40D41E+292j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40D6E4
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	loc_40D5E3

loc_40D6E4:				; CODE XREF: sub_40D41E+2B3j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40D702
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	loc_40D5E3

loc_40D702:				; CODE XREF: sub_40D41E+2D1j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40D726
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_40D5E3
		jmp	short loc_40D726
; ---------------------------------------------------------------------------

loc_40D722:				; CODE XREF: sub_40D41E+4Bj
		nop
		jmp	short loc_40D726
; ---------------------------------------------------------------------------

loc_40D725:				; CODE XREF: sub_40D41E+106j
					; sub_40D41E+13Cj ...
		nop

loc_40D726:				; CODE XREF: sub_40D41E+266j
					; sub_40D41E+29Cj ...
		cmp	[ebp+var_10], 14h
		jnz	short loc_40D736
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40D750

loc_40D736:				; CODE XREF: sub_40D41E+30Cj
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aInvalidSha1Fin ;	"invalid SHA1 fingerprint string `%s'\n"
		call	sub_4233B1
		mov	eax, 0
		jmp	short locret_40D75B
; ---------------------------------------------------------------------------

loc_40D750:				; CODE XREF: sub_40D41E+316j
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Str], eax ; void *
		call	sub_40D39E

locret_40D75B:				; CODE XREF: sub_40D41E+330j
		leave
		retn
sub_40D41E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D75D(char *, int)
sub_40D75D	proc near		; CODE XREF: sub_40DE2E+EDp
					; sub_40E092+1Cp

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40C580
		mov	[ebp+var_10], 0
		jmp	short loc_40D7E9
; ---------------------------------------------------------------------------

loc_40D771:				; CODE XREF: sub_40D75D+93j
		mov	eax, [ebp+var_10]
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40D7DF
; ---------------------------------------------------------------------------

loc_40D780:				; CODE XREF: sub_40D75D+86j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40D7D7
		mov	eax, [ebp+var_C]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Str2],	edx ; Str2
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D7D7
		mov	eax, [ebp+var_C]
		mov	eax, [eax+20h]
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+Str2],	edx
		mov	[esp+28h+Str1],	eax
		call	sub_40C65B
		test	eax, eax
		jnz	short loc_40D7D7
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+Str1],	eax
		call	ksba_cert_ref
		call	sub_40C622
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		jmp	short locret_40D800
; ---------------------------------------------------------------------------

loc_40D7D7:				; CODE XREF: sub_40D75D+2Bj
					; sub_40D75D+44j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40D7DF:				; CODE XREF: sub_40D75D+21j
		cmp	[ebp+var_C], 0
		jnz	short loc_40D780
		add	[ebp+var_10], 1

loc_40D7E9:				; CODE XREF: sub_40D75D+12j
		cmp	[ebp+var_10], 0FFh
		jle	loc_40D771
		call	sub_40C622
		mov	eax, 0

locret_40D800:				; CODE XREF: sub_40D75D+78j
		leave
		retn
sub_40D75D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D802(char *, int)
sub_40D802	proc near		; CODE XREF: sub_40DE2E+164p

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40C580
		mov	[ebp+var_10], 0
		jmp	short loc_40D884
; ---------------------------------------------------------------------------

loc_40D816:				; CODE XREF: sub_40D802+89j
		mov	eax, [ebp+var_10]
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40D87A
; ---------------------------------------------------------------------------

loc_40D825:				; CODE XREF: sub_40D802+7Cj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40D872
		mov	eax, [ebp+var_C]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Str2],	edx ; Str2
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D872
		cmp	[ebp+arg_4], 0
		setz	al
		sub	[ebp+arg_4], 1
		test	al, al
		jz	short loc_40D872
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+Str1],	eax
		call	ksba_cert_ref
		call	sub_40C622
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		jmp	short locret_40D897
; ---------------------------------------------------------------------------

loc_40D872:				; CODE XREF: sub_40D802+2Bj
					; sub_40D802+44j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40D87A:				; CODE XREF: sub_40D802+21j
		cmp	[ebp+var_C], 0
		jnz	short loc_40D825
		add	[ebp+var_10], 1

loc_40D884:				; CODE XREF: sub_40D802+12j
		cmp	[ebp+var_10], 0FFh
		jle	short loc_40D816
		call	sub_40C622
		mov	eax, 0

locret_40D897:				; CODE XREF: sub_40D802+6Ej
		leave
		retn
sub_40D802	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D899(char *, int)
sub_40D899	proc near		; CODE XREF: sub_40DE2E+1E8p
					; sub_40E3E4+185p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40C580
		mov	[ebp+var_10], 0
		jmp	short loc_40D925
; ---------------------------------------------------------------------------

loc_40D8AD:				; CODE XREF: sub_40D899+93j
		mov	eax, [ebp+var_10]
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40D91B
; ---------------------------------------------------------------------------

loc_40D8BC:				; CODE XREF: sub_40D899+86j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40D913
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40D913
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Str2],	edx ; Str2
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D913
		cmp	[ebp+arg_4], 0
		setz	al
		sub	[ebp+arg_4], 1
		test	al, al
		jz	short loc_40D913
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+Str1],	eax
		call	ksba_cert_ref
		call	sub_40C622
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		jmp	short locret_40D93C
; ---------------------------------------------------------------------------

loc_40D913:				; CODE XREF: sub_40D899+2Bj
					; sub_40D899+35j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40D91B:				; CODE XREF: sub_40D899+21j
		cmp	[ebp+var_C], 0
		jnz	short loc_40D8BC
		add	[ebp+var_10], 1

loc_40D925:				; CODE XREF: sub_40D899+12j
		cmp	[ebp+var_10], 0FFh
		jle	loc_40D8AD
		call	sub_40C622
		mov	eax, 0

locret_40D93C:				; CODE XREF: sub_40D899+78j
		leave
		retn
sub_40D899	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D93E	proc near		; CODE XREF: sub_40DE2E+4Cp

Str		= dword	ptr -48h
Val		= dword	ptr -44h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		jmp	short loc_40D978
; ---------------------------------------------------------------------------

loc_40D974:				; CODE XREF: sub_40D93E+4Cj
					; sub_40D93E+56j
		add	[ebp+var_10], 1

loc_40D978:				; CODE XREF: sub_40D93E+34j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40D996
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40D974
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_40D974

loc_40D996:				; CODE XREF: sub_40D93E+42j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 40h	; switch 65 cases
		ja	loc_40DC15	; jumptable 0040D9AF default case
		mov	eax, ds:off_4307F8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40D9B1:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		mov	[ebp+var_C], 0	; jumptable 0040D9AF case 0
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40D9BD:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		mov	[ebp+var_C], 0	; jumptable 0040D9AF case 46
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40D9C9:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		mov	[ebp+var_C], 1	; jumptable 0040D9AF case 60
		add	[ebp+var_10], 1
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40D9D9:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		mov	[ebp+var_C], 2	; jumptable 0040D9AF case 64
		add	[ebp+var_10], 1
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40D9E9:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		mov	[ebp+var_C], 0	; jumptable 0040D9AF case 61
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40D9F5:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		mov	[ebp+var_2C], 0Bh ; jumptable 0040D9AF case 42
		add	[ebp+var_10], 1
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DA05:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		mov	[ebp+var_C], 0	; jumptable 0040D9AF case 43
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DA11:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		add	[ebp+var_10], 1	; jumptable 0040D9AF case 47
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DA33
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40DA33
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40DA3F

loc_40DA33:				; CODE XREF: sub_40D93E+DFj
					; sub_40D93E+E9j
		mov	[ebp+var_C], 0
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DA3F:				; CODE XREF: sub_40D93E+F3j
		mov	[ebp+var_C], 7
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DA4B:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		add	[ebp+var_10], 1	; jumptable 0040D9AF case 35
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40DA93
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DA7B
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40DA7B
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40DA87

loc_40DA7B:				; CODE XREF: sub_40D93E+127j
					; sub_40D93E+131j
		mov	[ebp+var_C], 0
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DA87:				; CODE XREF: sub_40D93E+13Bj
		mov	[ebp+var_C], 0Ah
		jmp	loc_40DB55
; ---------------------------------------------------------------------------

loc_40DA93:				; CODE XREF: sub_40D93E+119j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], eax
		jmp	short loc_40DABC
; ---------------------------------------------------------------------------

loc_40DA9B:				; CODE XREF: sub_40D93E+190j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+48h+Val], eax ; Val
		mov	[esp+48h+Str], offset a01234567890abc ;	"01234567890abcdefABCDEF"
		call	strchr
		test	eax, eax
		jz	short loc_40DAD2
		add	[ebp+var_1C], 1

loc_40DABC:				; CODE XREF: sub_40D93E+15Bj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DAD3
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40DA9B
		jmp	short loc_40DAD3
; ---------------------------------------------------------------------------

loc_40DAD2:				; CODE XREF: sub_40D93E+178j
		nop

loc_40DAD3:				; CODE XREF: sub_40D93E+186j
					; sub_40D93E+192j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DAF0
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_40DAF0
		mov	[ebp+var_C], 0
		jmp	short loc_40DB55
; ---------------------------------------------------------------------------

loc_40DAF0:				; CODE XREF: sub_40D93E+19Dj
					; sub_40D93E+1A7j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40DB19
		mov	[ebp+var_C], 8
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DB19:				; CODE XREF: sub_40D93E+1CDj
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DB40
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40DB40
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40DB49

loc_40DB40:				; CODE XREF: sub_40D93E+1ECj
					; sub_40D93E+1F6j
		mov	[ebp+var_C], 0
		jmp	short loc_40DB55
; ---------------------------------------------------------------------------

loc_40DB49:				; CODE XREF: sub_40D93E+200j
		mov	[ebp+var_C], 9
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DB55:				; CODE XREF: sub_40D93E+150j
					; sub_40D93E+1B0j ...
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DB5A:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		add	[ebp+var_10], 1	; jumptable 0040D9AF case 58
		mov	[esp+48h+Val], 3Ah ; Val
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_40DB86
		mov	[ebp+var_C], 0
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DB86:				; CODE XREF: sub_40D93E+23Aj
		mov	[ebp+var_24], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_20], eax
		jmp	short loc_40DBBA
; ---------------------------------------------------------------------------

loc_40DB95:				; CODE XREF: sub_40D93E+282j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+48h+Val], eax ; Val
		mov	[esp+48h+Str], offset a01234567890abc ;	"01234567890abcdefABCDEF"
		call	strchr
		test	eax, eax
		jz	short loc_40DBC4
		add	[ebp+var_20], 1
		add	[ebp+var_24], 1

loc_40DBBA:				; CODE XREF: sub_40D93E+255j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_30]
		jb	short loc_40DB95
		jmp	short loc_40DBC5
; ---------------------------------------------------------------------------

loc_40DBC4:				; CODE XREF: sub_40D93E+272j
		nop

loc_40DBC5:				; CODE XREF: sub_40D93E+284j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_30]
		jnb	short loc_40DBD9
		mov	[ebp+var_C], 0
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DBD9:				; CODE XREF: sub_40D93E+28Dj
		cmp	[ebp+var_24], 20h
		jnz	short loc_40DBEB
		mov	[ebp+var_C], 3
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DBEB:				; CODE XREF: sub_40D93E+29Fj
		cmp	[ebp+var_24], 28h
		jnz	short loc_40DBFD
		mov	[ebp+var_C], 4
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DBFD:				; CODE XREF: sub_40D93E+2B1j
		mov	[ebp+var_C], 0
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DC09:				; CODE XREF: sub_40D93E+71j
					; DATA XREF: .rdata:off_4307F8o
		mov	[ebp+var_C], 0	; jumptable 0040D9AF case 38
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DC15:				; CODE XREF: sub_40D93E+64j
					; sub_40D93E+71j
					; DATA XREF: ...
		mov	eax, [ebp+var_10] ; jumptable 0040D9AF default case
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_40DC37
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 78h
		jnz	short loc_40DC37
		mov	[ebp+var_14], 1
		add	[ebp+var_10], 2

loc_40DC37:				; CODE XREF: sub_40D93E+2DFj
					; sub_40D93E+2ECj
		mov	[esp+48h+Val], offset a0123456789abcd ;	"0123456789abcdefABCDEF"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax ; Str
		call	strspn
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40DC93
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DC93
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40DC93
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_40DC93
		cmp	[ebp+var_14], 0
		jz	short loc_40DC8C
		mov	[ebp+var_C], 0
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DC8C:				; CODE XREF: sub_40D93E+340j
		mov	[ebp+var_18], 0

loc_40DC93:				; CODE XREF: sub_40D93E+313j
					; sub_40D93E+320j ...
		cmp	[ebp+var_18], 8
		jz	short loc_40DCAF
		cmp	[ebp+var_14], 0
		jnz	short loc_40DCC5
		cmp	[ebp+var_18], 9
		jnz	short loc_40DCC5
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_40DCC5

loc_40DCAF:				; CODE XREF: sub_40D93E+359j
		cmp	[ebp+var_18], 9
		jnz	short loc_40DCB9
		add	[ebp+var_10], 1

loc_40DCB9:				; CODE XREF: sub_40D93E+375j
		mov	[ebp+var_C], 5
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DCC5:				; CODE XREF: sub_40D93E+35Fj
					; sub_40D93E+365j ...
		cmp	[ebp+var_18], 10h
		jz	short loc_40DCE1
		cmp	[ebp+var_14], 0
		jnz	short loc_40DCF7
		cmp	[ebp+var_18], 11h
		jnz	short loc_40DCF7
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_40DCF7

loc_40DCE1:				; CODE XREF: sub_40D93E+38Bj
		cmp	[ebp+var_18], 11h
		jnz	short loc_40DCEB
		add	[ebp+var_10], 1

loc_40DCEB:				; CODE XREF: sub_40D93E+3A7j
		mov	[ebp+var_C], 6
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DCF7:				; CODE XREF: sub_40D93E+391j
					; sub_40D93E+397j ...
		cmp	[ebp+var_18], 20h
		jz	short loc_40DD13
		cmp	[ebp+var_14], 0
		jnz	short loc_40DD29
		cmp	[ebp+var_18], 21h
		jnz	short loc_40DD29
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_40DD29

loc_40DD13:				; CODE XREF: sub_40D93E+3BDj
		cmp	[ebp+var_18], 21h
		jnz	short loc_40DD1D
		add	[ebp+var_10], 1

loc_40DD1D:				; CODE XREF: sub_40D93E+3D9j
		mov	[ebp+var_C], 3
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DD29:				; CODE XREF: sub_40D93E+3C3j
					; sub_40D93E+3C9j ...
		cmp	[ebp+var_18], 28h
		jz	short loc_40DD45
		cmp	[ebp+var_14], 0
		jnz	short loc_40DD5B
		cmp	[ebp+var_18], 29h
		jnz	short loc_40DD5B
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_40DD5B

loc_40DD45:				; CODE XREF: sub_40D93E+3EFj
		cmp	[ebp+var_18], 29h
		jnz	short loc_40DD4F
		add	[ebp+var_10], 1

loc_40DD4F:				; CODE XREF: sub_40D93E+40Bj
		mov	[ebp+var_C], 4
		jmp	loc_40DE10
; ---------------------------------------------------------------------------

loc_40DD5B:				; CODE XREF: sub_40D93E+3F5j
					; sub_40D93E+3FBj ...
		cmp	[ebp+var_14], 0
		jnz	loc_40DE09
		mov	[ebp+var_C], 0
		mov	[esp+48h+Val], offset a0123456789ab_0 ;	":0123456789abcdefABCDEF"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax ; Str
		call	strspn
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 3Bh
		jnz	short loc_40DDFA
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DDAF
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40DDAF
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40DDFA

loc_40DDAF:				; CODE XREF: sub_40D93E+455j
					; sub_40D93E+462j
		mov	[ebp+var_28], 0
		jmp	short loc_40DDE7
; ---------------------------------------------------------------------------

loc_40DDB8:				; CODE XREF: sub_40D93E+4ADj
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax
		call	sub_425B4F
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0FFFFFFFFh
		jz	short loc_40DDED
		cmp	[ebp+var_28], 12h
		jg	short loc_40DDDF
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_40DDED

loc_40DDDF:				; CODE XREF: sub_40D93E+492j
		add	[ebp+var_28], 1
		add	[ebp+var_10], 3

loc_40DDE7:				; CODE XREF: sub_40D93E+478j
		cmp	[ebp+var_28], 13h
		jle	short loc_40DDB8

loc_40DDED:				; CODE XREF: sub_40D93E+48Cj
					; sub_40D93E+49Fj
		cmp	[ebp+var_28], 14h
		jnz	short loc_40DDFA
		mov	[ebp+var_C], 4

loc_40DDFA:				; CODE XREF: sub_40D93E+448j
					; sub_40D93E+46Fj ...
		cmp	[ebp+var_C], 0
		jnz	short loc_40DE10
		mov	[ebp+var_C], 0Bh
		jmp	short loc_40DE10
; ---------------------------------------------------------------------------

loc_40DE09:				; CODE XREF: sub_40D93E+421j
		mov	[ebp+var_C], 0

loc_40DE10:				; CODE XREF: sub_40D93E+7Aj
					; sub_40D93E+86j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40DE29
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_40DE29:				; CODE XREF: sub_40D93E+4D6j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D93E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40DE2E(char *, int, int)
sub_40DE2E	proc near		; CODE XREF: sub_4059C0+16Bp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 3Bh
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_40DE55
		cmp	[ebp+arg_4], 0
		jnz	short loc_40DE66

loc_40DE55:				; CODE XREF: sub_40DE2E+1Fj
		mov	[esp+38h+var_38], 2Dh
		call	sub_40C4EF
		jmp	locret_40E090
; ---------------------------------------------------------------------------

loc_40DE66:				; CODE XREF: sub_40DE2E+25j
		lea	eax, [ebp+var_28]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40D93E
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_28]
		add	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_24]
		add	[ebp+arg_0], eax
		cmp	[ebp+var_1C], 0Bh ; switch 12 cases
		ja	loc_40E056	; jumptable 0040DEA8 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_4308FC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40DEAA:				; CODE XREF: sub_40DE2E+7Aj
					; DATA XREF: .rdata:off_4308FCo
		mov	[esp+38h+var_38], 58h ;	jumptable 0040DEA8 case	0
		call	sub_40C4EF
		mov	[ebp+var_C], eax
		jmp	loc_40E056	; jumptable 0040DEA8 default case
; ---------------------------------------------------------------------------

loc_40DEBE:				; CODE XREF: sub_40DE2E+7Aj
					; DATA XREF: .rdata:off_4308FCo
		mov	eax, [ebp+arg_0] ; jumptable 0040DEA8 case 4
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40D41E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40DEE0
		mov	[esp+38h+var_38], 1Bh
		call	sub_40C4EF
		jmp	short loc_40DEE5
; ---------------------------------------------------------------------------

loc_40DEE0:				; CODE XREF: sub_40DE2E+A2j
		mov	eax, 0

loc_40DEE5:				; CODE XREF: sub_40DE2E+B0j
		mov	[ebp+var_C], eax
		jmp	loc_40E056	; jumptable 0040DEA8 default case
; ---------------------------------------------------------------------------

loc_40DEED:				; CODE XREF: sub_40DE2E+7Aj
					; DATA XREF: .rdata:off_4308FCo
		mov	eax, [ebp+var_20] ; jumptable 0040DEA8 case 9
		mov	[esp+38h+var_38], eax
		call	sub_40C76A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40DF0E
		call	sub_40C532
		mov	[ebp+var_C], eax
		jmp	loc_40E056	; jumptable 0040DEA8 default case
; ---------------------------------------------------------------------------

loc_40DF0E:				; CODE XREF: sub_40DE2E+D1j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40D75D
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40DF37
		mov	[esp+38h+var_38], 1Bh
		call	sub_40C4EF
		jmp	short loc_40DF3C
; ---------------------------------------------------------------------------

loc_40DF37:				; CODE XREF: sub_40DE2E+F9j
		mov	eax, 0

loc_40DF3C:				; CODE XREF: sub_40DE2E+107j
		mov	[ebp+var_C], eax
		jmp	loc_40E056	; jumptable 0040DEA8 default case
; ---------------------------------------------------------------------------

loc_40DF44:				; CODE XREF: sub_40DE2E+7Aj
					; DATA XREF: .rdata:off_4308FCo
		mov	[ebp+var_18], 0	; jumptable 0040DEA8 case 10
		mov	[ebp+var_C], 0
		jmp	short loc_40DF7F
; ---------------------------------------------------------------------------

loc_40DF54:				; CODE XREF: sub_40DE2E+170j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_release
		mov	[ebp+var_14], 0
		add	[ebp+var_18], 1

loc_40DF7F:				; CODE XREF: sub_40DE2E+124j
		cmp	[ebp+var_C], 0
		jnz	short loc_40DFA0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_34], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40D802
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40DF54

loc_40DFA0:				; CODE XREF: sub_40DE2E+155j
		cmp	[ebp+var_C], 0
		jnz	loc_40E052
		cmp	[ebp+var_18], 0
		jnz	loc_40E052
		mov	[esp+38h+var_38], 1Bh
		call	sub_40C4EF
		mov	[ebp+var_C], eax
		jmp	loc_40E052
; ---------------------------------------------------------------------------

loc_40DFC8:				; CODE XREF: sub_40DE2E+7Aj
					; DATA XREF: .rdata:off_4308FCo
		mov	[ebp+var_18], 0	; jumptable 0040DEA8 case 7
		mov	[ebp+var_C], 0
		jmp	short loc_40E003
; ---------------------------------------------------------------------------

loc_40DFD8:				; CODE XREF: sub_40DE2E+1F4j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_release
		mov	[ebp+var_14], 0
		add	[ebp+var_18], 1

loc_40E003:				; CODE XREF: sub_40DE2E+1A8j
		cmp	[ebp+var_C], 0
		jnz	short loc_40E024
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_34], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40D899
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40DFD8

loc_40E024:				; CODE XREF: sub_40DE2E+1D9j
		cmp	[ebp+var_C], 0
		jnz	short loc_40E055
		cmp	[ebp+var_18], 0
		jnz	short loc_40E055
		mov	[esp+38h+var_38], 1Bh
		call	sub_40C4EF
		mov	[ebp+var_C], eax
		jmp	short loc_40E055
; ---------------------------------------------------------------------------

loc_40E041:				; CODE XREF: sub_40DE2E+7Aj
					; DATA XREF: .rdata:off_4308FCo
		mov	[esp+38h+var_38], 58h ;	jumptable 0040DEA8 cases 1-3,5,6,8,11
		call	sub_40C4EF
		mov	[ebp+var_C], eax
		jmp	short loc_40E056 ; jumptable 0040DEA8 default case
; ---------------------------------------------------------------------------

loc_40E052:				; CODE XREF: sub_40DE2E+176j
					; sub_40DE2E+180j ...
		nop
		jmp	short loc_40E056 ; jumptable 0040DEA8 default case
; ---------------------------------------------------------------------------

loc_40E055:				; CODE XREF: sub_40DE2E+1FAj
					; sub_40DE2E+200j ...
		nop

loc_40E056:				; CODE XREF: sub_40DE2E+67j
					; sub_40DE2E+8Bj ...
		cmp	[ebp+var_C], 0	; jumptable 0040DEA8 default case
		jnz	short loc_40E077
		cmp	[ebp+var_14], 0
		jz	short loc_40E077
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_C], eax

loc_40E077:				; CODE XREF: sub_40DE2E+22Cj
					; sub_40DE2E+232j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

locret_40E090:				; CODE XREF: sub_40DE2E+33j
		leave
		retn
sub_40DE2E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E092(int, char *Str1, char)
sub_40E092	proc near		; CODE XREF: sub_40989B+39Dp
					; sub_40E92B+D5p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
Str2		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str1		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_24], 0
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+48h+Source], eax ;	char
		mov	eax, [ebp+Str1]
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_40D75D
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_40E0C5
		mov	eax, [ebp+var_20]
		jmp	loc_40E3DD
; ---------------------------------------------------------------------------

loc_40E0C5:				; CODE XREF: sub_40E092+29j
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+48h+Dest],	eax
		call	sub_41644D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40E0EF
		mov	[esp+48h+Dest],	offset aSerial_hexFa_0 ; "serial_hex() failed\n"
		call	sub_4233B1
		mov	eax, 0
		jmp	loc_40E3DD
; ---------------------------------------------------------------------------

loc_40E0EF:				; CODE XREF: sub_40E092+45j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+Str1]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 3
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40E179
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dest],	eax ; int
		call	strerror
		mov	[esp+48h+Source], eax ;	char
		mov	[esp+48h+Dest],	offset aCanTAllocate_0 ; "can't allocate enough memory: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_40E3DD
; ---------------------------------------------------------------------------

loc_40E179:				; CODE XREF: sub_40E092+AFj
		mov	eax, [ebp+var_10]
		mov	word ptr [eax],	23h
		mov	eax, [ebp+var_10]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Source], eax
		mov	[esp+48h+Dest],	edx
		call	sub_4265EB
		mov	word ptr [eax],	2Fh
		lea	edx, [eax+1]
		mov	eax, [ebp+Str1]
		mov	[esp+48h+Source], eax ;	Source
		mov	[esp+48h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Source], eax ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dest],	eax ; int
		call	sub_4049E3
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_40E1F2
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax
		call	sub_40D2A0
		mov	eax, [ebp+var_20]
		jmp	loc_40E3DD
; ---------------------------------------------------------------------------

loc_40E1F2:				; CODE XREF: sub_40E092+14Bj
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	loc_40E3C0
		mov	[esp+48h+Dest],	offset aFind_cert_bysn ; "find_cert_bysn: certificate not returne"...
		call	sub_42344E
		jmp	loc_40E3C0
; ---------------------------------------------------------------------------

loc_40E213:				; CODE XREF: sub_40E092+334j
		mov	eax, [ebp+var_24]
		test	eax, eax
		jnz	short loc_40E25C
		mov	eax, [ebp+Str1]
		mov	[esp+48h+var_40], eax
		lea	eax, [ebp+var_24]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dest],	eax
		call	sub_40BEEF
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40E25C
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dest],	eax
		call	gpg_strerror
		mov	[esp+48h+Source], eax ;	char
		mov	[esp+48h+Dest],	offset aErrorFetchingC ; "error	fetching certificate by	S/N: %s\n"
		call	sub_4233B1
		jmp	loc_40E3CF
; ---------------------------------------------------------------------------

loc_40E25C:				; CODE XREF: sub_40E092+186j
					; sub_40E092+1A8j
		mov	eax, [ebp+var_24]
		lea	edx, [ebp+var_20]
		mov	[esp+48h+Source], edx
		mov	[esp+48h+Dest],	eax
		call	sub_40BFB7
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40E297
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dest],	eax
		call	gpg_strerror
		mov	[esp+48h+Source], eax ;	char
		mov	[esp+48h+Dest],	offset aErrorFetchingC ; "error	fetching certificate by	S/N: %s\n"
		call	sub_4233B1
		jmp	loc_40E3CF
; ---------------------------------------------------------------------------

loc_40E297:				; CODE XREF: sub_40E092+1E3j
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Source], 0
		mov	[esp+48h+Dest],	eax
		call	ksba_cert_get_issuer
		mov	[ebp+Str2], eax
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Source], eax ;	char
		mov	eax, [ebp+Str1]
		mov	[esp+48h+Dest],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_40E2F1
		mov	[esp+48h+Dest],	offset aFind_cert_by_0 ; "find_cert_bysn: Ooops: issuer	DN does	n"...
		call	sub_42344E
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax
		call	ksba_cert_release
		mov	[ebp+var_20], 0
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Dest],	eax
		call	ksba_free
		jmp	loc_40E3CF
; ---------------------------------------------------------------------------

loc_40E2F1:				; CODE XREF: sub_40E092+22Fj
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax
		call	ksba_cert_get_serial
		mov	dword ptr [ebp+var_1C],	eax
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_40E345
		mov	[esp+48h+Dest],	offset aConsideringCer ; "   considering certificate (#"
		call	sub_42344E
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	sub_416A63
		mov	[esp+48h+Dest],	offset asc_430A23 ; "/"
		call	sub_423478
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Dest],	eax
		call	sub_416B16
		mov	[esp+48h+Dest],	offset asc_430A25 ; ")\n"
		call	sub_423478

loc_40E345:				; CODE XREF: sub_40E092+277j
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+48h+Source], eax ;	char
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+48h+Dest],	eax
		call	sub_40C65B
		test	eax, eax
		jnz	short loc_40E396
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	ksba_free
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Dest],	eax
		call	ksba_free
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax
		call	sub_40D2A0
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_40E3CE
		mov	[esp+48h+Dest],	offset aFound ;	"   found\n"
		call	sub_42344E
		jmp	short loc_40E3CE
; ---------------------------------------------------------------------------

loc_40E396:				; CODE XREF: sub_40E092+2C7j
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	ksba_free
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Dest],	eax
		call	ksba_free
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax
		call	ksba_cert_release
		mov	[ebp+var_20], 0
		jmp	short loc_40E3C1
; ---------------------------------------------------------------------------

loc_40E3C0:				; CODE XREF: sub_40E092+16Aj
					; sub_40E092+17Cj
		nop

loc_40E3C1:				; CODE XREF: sub_40E092+32Cj
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	loc_40E213
		jmp	short loc_40E3CF
; ---------------------------------------------------------------------------

loc_40E3CE:				; CODE XREF: sub_40E092+2F4j
					; sub_40E092+302j
		nop

loc_40E3CF:				; CODE XREF: sub_40E092+1C5j
					; sub_40E092+200j ...
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax
		call	sub_40C079
		mov	eax, [ebp+var_20]

loc_40E3DD:				; CODE XREF: sub_40E092+2Ej
					; sub_40E092+58j ...
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40E092	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E3E4(int, char *Source, int)
sub_40E3E4	proc near		; CODE XREF: sub_40989B+3C6p
					; sub_40989B+493p ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
Size		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
Source		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_28], 0
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_40E4F2
		call	sub_40C580
		mov	[ebp+var_18], 0
		jmp	loc_40E4C8
; ---------------------------------------------------------------------------

loc_40E418:				; CODE XREF: sub_40E3E4+EBj
		mov	eax, [ebp+var_18]
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_10], eax
		jmp	loc_40E4BA
; ---------------------------------------------------------------------------

loc_40E42A:				; CODE XREF: sub_40E3E4+DAj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40E4B2
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40E4B2
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	edx, [ebp+Source]
		mov	[esp+58h+Str2],	edx ; Str2
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40E4B2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[ebp+var_14], eax
		jmp	short loc_40E4AC
; ---------------------------------------------------------------------------

loc_40E462:				; CODE XREF: sub_40E3E4+CCj
		mov	eax, [ebp+var_14]
		lea	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+58h+Size],	14h ; Size
		mov	[esp+58h+Str2],	edx ; char
		mov	[esp+58h+Str1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_40E4A4
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	ksba_cert_ref
		call	sub_40C622
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		jmp	loc_40E88C
; ---------------------------------------------------------------------------

loc_40E4A4:				; CODE XREF: sub_40E3E4+A0j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_40E4AC:				; CODE XREF: sub_40E3E4+7Cj
		cmp	[ebp+var_14], 0
		jnz	short loc_40E462

loc_40E4B2:				; CODE XREF: sub_40E3E4+4Ej
					; sub_40E3E4+58j ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_40E4BA:				; CODE XREF: sub_40E3E4+41j
		cmp	[ebp+var_10], 0
		jnz	loc_40E42A
		add	[ebp+var_18], 1

loc_40E4C8:				; CODE XREF: sub_40E3E4+2Fj
		cmp	[ebp+var_18], 0FFh
		jle	loc_40E418
		call	sub_40C622
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_40E4F2
		mov	[esp+58h+Str1],	offset aFind_cert_bysu ; "find_cert_bysubject: certificate not in"...
		call	sub_42344E

loc_40E4F2:				; CODE XREF: sub_40E3E4+1Dj
					; sub_40E3E4+100j
		mov	dword ptr [ebp+var_C], 0
		jmp	short loc_40E55C
; ---------------------------------------------------------------------------

loc_40E4FB:				; CODE XREF: sub_40E3E4+192j
		cmp	[ebp+arg_8], 0
		jz	short loc_40E57A
		mov	eax, [ebp+var_28]
		lea	edx, [ebp+var_30]
		mov	[esp+58h+Size],	edx
		mov	[esp+58h+Str2],	0
		mov	[esp+58h+Str1],	eax
		call	ksba_cert_get_subj_key_id
		test	eax, eax
		jnz	short loc_40E542
		mov	eax, dword ptr [ebp+var_30]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Str1],	eax
		call	sub_40C750
		test	eax, eax
		jnz	short loc_40E542
		mov	eax, dword ptr [ebp+var_30]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		jmp	short loc_40E57B
; ---------------------------------------------------------------------------

loc_40E542:				; CODE XREF: sub_40E3E4+139j
					; sub_40E3E4+14Fj
		mov	eax, dword ptr [ebp+var_30]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	ksba_cert_release
		add	dword ptr [ebp+var_C], 1

loc_40E55C:				; CODE XREF: sub_40E3E4+115j
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+58h+Str2],	eax ; char
		mov	eax, [ebp+Source]
		mov	[esp+58h+Str1],	eax ; char *
		call	sub_40D899
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		test	eax, eax
		jnz	short loc_40E4FB
		jmp	short loc_40E57B
; ---------------------------------------------------------------------------

loc_40E57A:				; CODE XREF: sub_40E3E4+11Bj
		nop

loc_40E57B:				; CODE XREF: sub_40E3E4+15Cj
					; sub_40E3E4+194j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_40E58A
		mov	eax, [ebp+var_28]
		jmp	loc_40E88C
; ---------------------------------------------------------------------------

loc_40E58A:				; CODE XREF: sub_40E3E4+19Cj
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_40E5A2
		mov	[esp+58h+Str1],	offset aFind_cert_by_1 ; "find_cert_bysubject: certificate not in"...
		call	sub_42344E

loc_40E5A2:				; CODE XREF: sub_40E3E4+1B0j
		cmp	[ebp+arg_8], 0
		jz	short loc_40E5C9
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Size],	eax ; int
		mov	eax, [ebp+Source]
		mov	[esp+58h+Str2],	eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; int
		call	sub_404A97
		mov	[ebp+var_28], eax
		jmp	loc_40E664
; ---------------------------------------------------------------------------

loc_40E5C9:				; CODE XREF: sub_40E3E4+1C2j
		mov	eax, [ebp+Source]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 2
		mov	[esp+58h+Str1],	eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40E627
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax ; int
		call	strerror
		mov	[esp+58h+Str2],	eax ; char
		mov	[esp+58h+Str1],	offset aCanTAllocate_0 ; "can't allocate enough memory: %s\n"
		call	sub_4233B1
		mov	eax, 0
		jmp	loc_40E88C
; ---------------------------------------------------------------------------

loc_40E627:				; CODE XREF: sub_40E3E4+216j
		mov	eax, [ebp+var_1C]
		mov	word ptr [eax],	2Fh
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+1]
		mov	eax, [ebp+Source]
		mov	[esp+58h+Str2],	eax ; Source
		mov	[esp+58h+Str1],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str2],	eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; int
		call	sub_4049E3
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str1],	eax
		call	gcry_free

loc_40E664:				; CODE XREF: sub_40E3E4+1E0j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_40E67E
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	sub_40D2A0
		mov	eax, [ebp+var_28]
		jmp	loc_40E88C
; ---------------------------------------------------------------------------

loc_40E67E:				; CODE XREF: sub_40E3E4+285j
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	loc_40E86C
		mov	[esp+58h+Str1],	offset aFind_cert_by_2 ; "find_cert_bysubject: certificate not re"...
		call	sub_42344E
		jmp	loc_40E86C
; ---------------------------------------------------------------------------

loc_40E69F:				; CODE XREF: sub_40E3E4+48Ej
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_40E6E8
		mov	eax, [ebp+Source]
		mov	[esp+58h+Size],	eax
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_40BEEF
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_40E6E8
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str1],	eax
		call	gpg_strerror
		mov	[esp+58h+Str2],	eax ; char
		mov	[esp+58h+Str1],	offset aErrorFetchin_0 ; "error	fetching certificate by	subject: "...
		call	sub_4233B1
		jmp	loc_40E87E
; ---------------------------------------------------------------------------

loc_40E6E8:				; CODE XREF: sub_40E3E4+2C0j
					; sub_40E3E4+2E2j
		mov	eax, [ebp+var_2C]
		lea	edx, [ebp+var_28]
		mov	[esp+58h+Str2],	edx
		mov	[esp+58h+Str1],	eax
		call	sub_40BFB7
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_40E723
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str1],	eax
		call	gpg_strerror
		mov	[esp+58h+Str2],	eax ; char
		mov	[esp+58h+Str1],	offset aErrorFetchin_0 ; "error	fetching certificate by	subject: "...
		call	sub_4233B1
		jmp	loc_40E87E
; ---------------------------------------------------------------------------

loc_40E723:				; CODE XREF: sub_40E3E4+31Dj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	0
		mov	[esp+58h+Str1],	eax
		call	ksba_cert_get_subject
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str2],	eax ; char
		mov	eax, [ebp+Source]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_40E77D
		mov	[esp+58h+Str1],	offset aFind_cert_by_3 ; "find_cert_bysubject: subject DN does no"...
		call	sub_423387
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	ksba_cert_release
		mov	[ebp+var_28], 0
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str1],	eax
		call	ksba_free
		jmp	loc_40E86D
; ---------------------------------------------------------------------------

loc_40E77D:				; CODE XREF: sub_40E3E4+369j
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_40E7AC
		mov	[esp+58h+Str1],	offset aConsideringC_0 ; "   considering certificate (/"
		call	sub_42344E
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str1],	eax
		call	sub_416B16
		mov	[esp+58h+Str1],	offset asc_430A25 ; ")\n"
		call	sub_423478

loc_40E7AC:				; CODE XREF: sub_40E3E4+3A3j
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str1],	eax
		call	ksba_free
		cmp	[ebp+arg_8], 0
		jnz	short loc_40E7E9
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	sub_40D2A0
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	loc_40E87A
		mov	[esp+58h+Str1],	offset aFound ;	"   found\n"
		call	sub_42344E
		jmp	loc_40E87A
; ---------------------------------------------------------------------------

loc_40E7E9:				; CODE XREF: sub_40E3E4+3D7j
		mov	eax, [ebp+var_28]
		lea	edx, [ebp+var_30]
		mov	[esp+58h+Size],	edx
		mov	[esp+58h+Str2],	0
		mov	[esp+58h+Str1],	eax
		call	ksba_cert_get_subj_key_id
		test	eax, eax
		jnz	short loc_40E84D
		mov	eax, dword ptr [ebp+var_30]
		mov	[esp+58h+Str2],	eax ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Str1],	eax
		call	sub_40C750
		test	eax, eax
		jnz	short loc_40E84D
		mov	eax, dword ptr [ebp+var_30]
		mov	[esp+58h+Str1],	eax
		call	ksba_free
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	sub_40D2A0
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_40E87D
		mov	[esp+58h+Str1],	offset aFound ;	"   found\n"
		call	sub_42344E
		jmp	short loc_40E87D
; ---------------------------------------------------------------------------

loc_40E84D:				; CODE XREF: sub_40E3E4+421j
					; sub_40E3E4+437j
		mov	eax, dword ptr [ebp+var_30]
		mov	[esp+58h+Str1],	eax
		call	ksba_free
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	ksba_cert_release
		mov	[ebp+var_28], 0
		jmp	short loc_40E86D
; ---------------------------------------------------------------------------

loc_40E86C:				; CODE XREF: sub_40E3E4+2A4j
					; sub_40E3E4+2B6j
		nop

loc_40E86D:				; CODE XREF: sub_40E3E4+394j
					; sub_40E3E4+486j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	loc_40E69F
		jmp	short loc_40E87E
; ---------------------------------------------------------------------------

loc_40E87A:				; CODE XREF: sub_40E3E4+3EEj
					; sub_40E3E4+400j
		nop
		jmp	short loc_40E87E
; ---------------------------------------------------------------------------

loc_40E87D:				; CODE XREF: sub_40E3E4+459j
					; sub_40E3E4+467j
		nop

loc_40E87E:				; CODE XREF: sub_40E3E4+2FFj
					; sub_40E3E4+33Aj ...
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Str1],	eax
		call	sub_40C079
		mov	eax, [ebp+var_28]

loc_40E88C:				; CODE XREF: sub_40E3E4+BBj
					; sub_40E3E4+1A1j ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_40E3E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E892	proc near		; CODE XREF: sub_41FB99+3Ap
					; sub_420043+457p

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_20		= byte ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [ebp+var_20]
		mov	[esp+38h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Buf1],	eax
		call	sub_40C831
		call	sub_40C580
		movzx	eax, [ebp+var_20]
		movzx	eax, al
		mov	eax, ds:dword_435200[eax*4]
		mov	[ebp+var_C], eax
		jmp	short loc_40E90F
; ---------------------------------------------------------------------------

loc_40E8C2:				; CODE XREF: sub_40E892+81j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40E907
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	[esp+38h+Size],	14h ; Size
		lea	eax, [ebp+var_20]
		mov	[esp+38h+Buf2],	eax ; Buf2
		mov	[esp+38h+Buf1],	edx ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_40E907
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+28h]
		and	eax, 2
		test	al, al
		jz	short loc_40E917
		call	sub_40C622
		mov	eax, 0
		jmp	short locret_40E929
; ---------------------------------------------------------------------------

loc_40E907:				; CODE XREF: sub_40E892+38j
					; sub_40E892+59j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40E90F:				; CODE XREF: sub_40E892+2Ej
		cmp	[ebp+var_C], 0
		jnz	short loc_40E8C2
		jmp	short loc_40E918
; ---------------------------------------------------------------------------

loc_40E917:				; CODE XREF: sub_40E892+67j
		nop

loc_40E918:				; CODE XREF: sub_40E892+83j
		call	sub_40C622
		mov	[esp+38h+Buf1],	62h
		call	sub_40C4EF

locret_40E929:				; CODE XREF: sub_40E892+73j
		leave
		retn
sub_40E892	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E92B	proc near		; CODE XREF: sub_418114+63p
					; sub_420043+60Cp

var_38		= dword	ptr -38h
Str1		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
Source		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[esp+38h+Str1],	0 ; char
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_get_issuer
		mov	[ebp+Source], eax
		cmp	[ebp+Source], 0
		jnz	short loc_40E97D
		mov	[esp+38h+var_38], offset aNoIssuerFoundI ; "no issuer found in certificate\n"
		call	sub_4233B1
		mov	[esp+38h+var_38], 24h
		call	sub_40C4EF
		mov	[ebp+var_C], eax
		jmp	loc_40EB0E
; ---------------------------------------------------------------------------

loc_40E97D:				; CODE XREF: sub_40E92B+30j
		lea	eax, [ebp+var_20]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_1C]
		mov	dword ptr [esp+38h+var_30], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Str1],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_get_auth_key_id
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40E9C6
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	[esp+38h+Str1],	eax ; char
		mov	[esp+38h+var_38], offset aErrorGettingAu ; "error getting authorityKeyIdentifier: %"...
		call	sub_423387
		jmp	loc_40EADF
; ---------------------------------------------------------------------------

loc_40E9C6:				; CODE XREF: sub_40E92B+79j
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str1],	0
		mov	[esp+38h+var_38], eax
		call	ksba_name_enum
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40EA08
		mov	eax, dword ptr [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40EA08
		mov	eax, dword ptr [ebp+var_20]
		mov	dword ptr [esp+38h+var_30], eax	; char
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax ; Str1
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_40E092
		mov	[ebp+var_10], eax

loc_40EA08:				; CODE XREF: sub_40E92B+B5j
					; sub_40E92B+BFj
		cmp	[ebp+var_10], 0
		jnz	short loc_40EA31
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_40EA31
		mov	eax, [ebp+var_24]
		mov	dword ptr [esp+38h+var_30], eax	; int
		mov	eax, [ebp+Source]
		mov	[esp+38h+Str1],	eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_40E3E4
		mov	[ebp+var_10], eax

loc_40EA31:				; CODE XREF: sub_40E92B+E1j
					; sub_40E92B+E8j
		cmp	[ebp+var_10], 0
		jnz	loc_40EABE
		mov	[esp+38h+var_38], offset aIssuerCertific ; "issuer certificate "
		call	sub_423387
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_40EA71
		mov	[esp+38h+var_38], offset asc_430BBA ; "{"
		call	sub_423478
		mov	eax, [ebp+var_24]
		mov	[esp+38h+var_38], eax
		call	sub_416A63
		mov	[esp+38h+var_38], offset asc_430BBC ; "} "
		call	sub_423478

loc_40EA71:				; CODE XREF: sub_40E92B+121j
		mov	eax, dword ptr [ebp+var_20]
		test	eax, eax
		jz	short loc_40EAB2
		mov	[esp+38h+var_38], offset asc_430BBF ; "(#"
		call	sub_423478
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	sub_416A63
		mov	[esp+38h+var_38], offset asc_430A23 ; "/"
		call	sub_423478
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	sub_416B16
		mov	[esp+38h+var_38], offset asc_430BC2 ; ") "
		call	sub_423478

loc_40EAB2:				; CODE XREF: sub_40E92B+14Bj
		mov	[esp+38h+var_38], offset aNotFoundUsingA ; "not	found using authorityKeyIdentifier\"...
		call	sub_423478

loc_40EABE:				; CODE XREF: sub_40E92B+10Aj
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	ksba_name_release
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+38h+var_38], eax
		call	gcry_free

loc_40EADF:				; CODE XREF: sub_40E92B+96j
		cmp	[ebp+var_C], 0
		jnz	short loc_40EAEB
		cmp	[ebp+var_10], 0
		jnz	short loc_40EB0E

loc_40EAEB:				; CODE XREF: sub_40E92B+1B8j
		mov	[esp+38h+Str1],	0 ; int
		mov	eax, [ebp+Source]
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40D899
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40EB0E
		mov	[ebp+var_C], 0

loc_40EB0E:				; CODE XREF: sub_40E92B+4Dj
					; sub_40E92B+1BEj ...
		cmp	[ebp+var_C], 0
		jnz	short loc_40EB29
		cmp	[ebp+var_10], 0
		jnz	short loc_40EB29
		mov	[esp+38h+var_38], 1Bh
		call	sub_40C4EF
		mov	[ebp+var_C], eax

loc_40EB29:				; CODE XREF: sub_40E92B+1E7j
					; sub_40E92B+1EDj
		mov	eax, [ebp+Source]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_40EB47
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_release
		jmp	short loc_40EB4F
; ---------------------------------------------------------------------------

loc_40EB47:				; CODE XREF: sub_40E92B+20Dj
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_40EB4F:				; CODE XREF: sub_40E92B+21Aj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40E92B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EB54	proc near		; CODE XREF: sub_40EB7B+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40EB74
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40EB79
; ---------------------------------------------------------------------------

loc_40EB74:				; CODE XREF: sub_40EB54+7j
		mov	eax, 0

loc_40EB79:				; CODE XREF: sub_40EB54+1Ej
		pop	ebp
		retn
sub_40EB54	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EB7B	proc near		; CODE XREF: sub_40EB96+Ep
					; sub_40EBAB+BDp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_40EB54
		leave
		retn
sub_40EB7B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EB96	proc near		; CODE XREF: sub_40EBAB+E1p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40EB7B
		leave
		retn
sub_40EB96	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EBAB	proc near		; CODE XREF: sub_40B86E+10Ap

var_28		= dword	ptr -28h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	eax, [ebp+arg_0]
		mov	edx, 1Ch
		mov	ecx, 0
		mov	ebx, eax
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_40EBD2
		mov	[eax], cl
		add	eax, 1
		sub	edx, 1

loc_40EBD2:				; CODE XREF: sub_40EBAB+1Dj
		mov	ebx, eax
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_40EBE4
		mov	[eax], cx
		add	eax, 2
		sub	edx, 2

loc_40EBE4:				; CODE XREF: sub_40EBAB+2Ej
		mov	esi, edx
		and	esi, 0FFFFFFFCh
		mov	ebx, 0

loc_40EBEE:				; CODE XREF: sub_40EBAB+4Bj
		mov	[eax+ebx], ecx
		add	ebx, 4
		cmp	ebx, esi
		jb	short loc_40EBEE
		add	eax, ebx
		mov	ebx, edx
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_40EC09
		mov	[eax], cx
		add	eax, 2

loc_40EC09:				; CODE XREF: sub_40EBAB+56j
		and	edx, 1
		test	edx, edx
		jz	short loc_40EC15
		mov	[eax], cl
		add	eax, 1

loc_40EC15:				; CODE XREF: sub_40EBAB+63j
		cmp	[ebp+arg_4], 0
		jz	loc_40EC9F
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset dword_430C80
		mov	ecx, 3
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40EC6F
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40EC61
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_40EC6F

loc_40EC61:				; CODE XREF: sub_40EBAB+A7j
		mov	[esp+28h+var_28], 45h
		call	sub_40EB7B
		jmp	short loc_40ECAE
; ---------------------------------------------------------------------------

loc_40EC6F:				; CODE XREF: sub_40EBAB+9Aj
					; sub_40EBAB+B4j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	gcry_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40EC93
		call	sub_40EB96
		jmp	short loc_40ECAE
; ---------------------------------------------------------------------------

loc_40EC93:				; CODE XREF: sub_40EBAB+DFj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		jmp	short loc_40ECA9
; ---------------------------------------------------------------------------

loc_40EC9F:				; CODE XREF: sub_40EBAB+6Ej
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 4

loc_40ECA9:				; CODE XREF: sub_40EBAB+F2j
		mov	eax, 0

loc_40ECAE:				; CODE XREF: sub_40EBAB+C2j
					; sub_40EBAB+E6j
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40EBAB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ECB6	proc near		; CODE XREF: sub_40B86E+146p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+14h]
		mov	[ebp+var_D], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 1
		test	al, al
		jz	short loc_40ED00
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	[esp+38h+var_38], 3FFFh
		call	sub_40EB7B
		jmp	locret_40EFD8
; ---------------------------------------------------------------------------

loc_40ED00:				; CODE XREF: sub_40ECB6+2Ej
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		jmp	loc_40EF8C
; ---------------------------------------------------------------------------

loc_40ED11:				; CODE XREF: sub_40ECB6+2E8j
		cmp	[ebp+var_C], 9	; switch 10 cases
		ja	loc_40EF5B	; jumptable 0040ED28 default case
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, offset off_430CB4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40ED2A:				; CODE XREF: sub_40ECB6+72j
					; DATA XREF: .rdata:off_430CB4o
		mov	eax, [ebp+var_1C] ; jumptable 0040ED28 case 1
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	loc_40EF77
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		jmp	loc_40EF77
; ---------------------------------------------------------------------------

loc_40ED4B:				; CODE XREF: sub_40ECB6+72j
					; DATA XREF: .rdata:off_430CB4o
		mov	[ebp+var_C], 2	; jumptable 0040ED28 case 0

loc_40ED52:				; CODE XREF: sub_40ECB6+72j
					; DATA XREF: .rdata:off_430CB4o
		mov	eax, [ebp+var_1C] ; jumptable 0040ED28 case 2
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		add	eax, offset aBegin ; "-----BEGIN "
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_40ED73
		mov	[ebp+var_C], 1
		jmp	loc_40EF84
; ---------------------------------------------------------------------------

loc_40ED73:				; CODE XREF: sub_40ECB6+AFj
		cmp	[ebp+var_14], 0Ah
		jnz	short loc_40ED85
		mov	[ebp+var_C], 3
		jmp	loc_40EF84
; ---------------------------------------------------------------------------

loc_40ED85:				; CODE XREF: sub_40ECB6+C1j
		add	[ebp+var_14], 1
		jmp	loc_40EF84
; ---------------------------------------------------------------------------

loc_40ED8E:				; CODE XREF: sub_40ECB6+72j
					; DATA XREF: .rdata:off_430CB4o
		mov	eax, [ebp+var_1C] ; jumptable 0040ED28 case 3
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	loc_40EF7A
		mov	[ebp+var_C], 4
		jmp	loc_40EF7A
; ---------------------------------------------------------------------------

loc_40EDA8:				; CODE XREF: sub_40ECB6+72j
					; DATA XREF: .rdata:off_430CB4o
		mov	eax, [ebp+var_1C] ; jumptable 0040ED28 cases 4-7
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40EDC8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40EDC8
		mov	[ebp+var_C], 9
		jmp	loc_40EF2D
; ---------------------------------------------------------------------------

loc_40EDC8:				; CODE XREF: sub_40ECB6+FAj
					; sub_40ECB6+104j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_40EE03
		cmp	[ebp+var_C], 5
		jnz	short loc_40EDE5
		movzx	edx, [ebp+var_D]
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1

loc_40EDE5:				; CODE XREF: sub_40ECB6+120j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40EDF6
		mov	eax, 8
		jmp	short loc_40EDFB
; ---------------------------------------------------------------------------

loc_40EDF6:				; CODE XREF: sub_40ECB6+137j
		mov	eax, 9

loc_40EDFB:				; CODE XREF: sub_40ECB6+13Ej
		mov	[ebp+var_C], eax
		jmp	loc_40EF7D
; ---------------------------------------------------------------------------

loc_40EE03:				; CODE XREF: sub_40ECB6+11Aj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	loc_40EF7D
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	loc_40EF7D
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	loc_40EF7D
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	loc_40EF7D
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40EE64
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		movzx	eax, ds:byte_430C00[eax]
		movzx	eax, al
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFh
		jnz	short loc_40EE76

loc_40EE64:				; CODE XREF: sub_40ECB6+18Dj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		or	edx, 2
		mov	[eax+18h], dl
		jmp	loc_40EF2D
; ---------------------------------------------------------------------------

loc_40EE76:				; CODE XREF: sub_40ECB6+1ACj
		cmp	[ebp+var_C], 4
		jnz	short loc_40EE91
		mov	eax, [ebp+var_20]
		shl	eax, 2
		mov	[ebp+var_D], al
		mov	[ebp+var_C], 5
		jmp	loc_40EF7D
; ---------------------------------------------------------------------------

loc_40EE91:				; CODE XREF: sub_40ECB6+1C4j
		cmp	[ebp+var_C], 5
		jnz	short loc_40EECD
		mov	eax, [ebp+var_20]
		sar	eax, 4
		mov	edx, eax
		and	edx, 3
		movzx	eax, [ebp+var_D]
		or	eax, edx
		mov	[ebp+var_D], al
		movzx	edx, [ebp+var_D]
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_20]
		shl	eax, 4
		mov	[ebp+var_D], al
		mov	[ebp+var_C], 6
		jmp	loc_40EF7D
; ---------------------------------------------------------------------------

loc_40EECD:				; CODE XREF: sub_40ECB6+1DFj
		cmp	[ebp+var_C], 6
		jnz	short loc_40EF06
		mov	eax, [ebp+var_20]
		sar	eax, 2
		mov	edx, eax
		and	edx, 0Fh
		movzx	eax, [ebp+var_D]
		or	eax, edx
		mov	[ebp+var_D], al
		movzx	edx, [ebp+var_D]
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_20]
		shl	eax, 6
		mov	[ebp+var_D], al
		mov	[ebp+var_C], 7
		jmp	short loc_40EF7D
; ---------------------------------------------------------------------------

loc_40EF06:				; CODE XREF: sub_40ECB6+21Bj
		mov	eax, [ebp+var_20]
		mov	edx, eax
		and	edx, 3Fh
		movzx	eax, [ebp+var_D]
		or	eax, edx
		mov	[ebp+var_D], al
		movzx	edx, [ebp+var_D]
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	[ebp+var_C], 4
		jmp	short loc_40EF7D
; ---------------------------------------------------------------------------

loc_40EF2D:				; CODE XREF: sub_40ECB6+10Dj
					; sub_40ECB6+1BBj
		jmp	short loc_40EF7D
; ---------------------------------------------------------------------------

loc_40EF2F:				; CODE XREF: sub_40ECB6+72j
					; DATA XREF: .rdata:off_430CB4o
		mov	eax, [ebp+var_1C] ; jumptable 0040ED28 case 8
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40EF80
		mov	[ebp+var_C], 9
		jmp	short loc_40EF80
; ---------------------------------------------------------------------------

loc_40EF42:				; CODE XREF: sub_40ECB6+72j
					; DATA XREF: .rdata:off_430CB4o
		mov	eax, [ebp+var_1C] ; jumptable 0040ED28 case 9
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_40EF83
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		or	edx, 1
		mov	[eax+18h], dl
		jmp	short loc_40EF83
; ---------------------------------------------------------------------------

loc_40EF5B:				; CODE XREF: sub_40ECB6+5Fj
		mov	[esp+38h+var_30], offset aB64dec_proc ;	jumptable 0040ED28 default case
		mov	[esp+38h+var_34], 0C2h
		mov	[esp+38h+var_38], offset a____Dirmngr1_4 ; "../../dirmngr-1.1.1/src/b64dec.c"
		call	sub_423540
; ---------------------------------------------------------------------------

loc_40EF77:				; CODE XREF: sub_40ECB6+7Cj
					; sub_40ECB6+90j
		nop
		jmp	short loc_40EF84
; ---------------------------------------------------------------------------

loc_40EF7A:				; CODE XREF: sub_40ECB6+E0j
					; sub_40ECB6+EDj
		nop
		jmp	short loc_40EF84
; ---------------------------------------------------------------------------

loc_40EF7D:				; CODE XREF: sub_40ECB6+148j
					; sub_40ECB6+155j ...
		nop
		jmp	short loc_40EF84
; ---------------------------------------------------------------------------

loc_40EF80:				; CODE XREF: sub_40ECB6+281j
					; sub_40ECB6+28Aj
		nop
		jmp	short loc_40EF84
; ---------------------------------------------------------------------------

loc_40EF83:				; CODE XREF: sub_40ECB6+294j
					; sub_40ECB6+2A3j
		nop

loc_40EF84:				; CODE XREF: sub_40ECB6+B8j
					; sub_40ECB6+CAj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_1C], 1

loc_40EF8C:				; CODE XREF: sub_40ECB6+56j
		cmp	[ebp+arg_8], 0
		jz	short loc_40EFA4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 1
		test	al, al
		jz	loc_40ED11

loc_40EFA4:				; CODE XREF: sub_40ECB6+2DAj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		movzx	edx, [ebp+var_D]
		mov	[eax+14h], dl
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+8], edx
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, 0

locret_40EFD8:				; CODE XREF: sub_40ECB6+45j
		leave
		retn
sub_40ECB6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EFDA	proc near		; CODE XREF: sub_40C1C5+4Dp

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 2
		test	al, al
		jz	short loc_40F014
		mov	[esp+18h+var_18], 59h
		call	sub_40EB7B
		jmp	short locret_40F019
; ---------------------------------------------------------------------------

loc_40F014:				; CODE XREF: sub_40EFDA+2Aj
		mov	eax, 0

locret_40F019:				; CODE XREF: sub_40EFDA+38j
		leave
		retn
sub_40EFDA	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F01C	proc near		; CODE XREF: sub_40895E+251p

hFile		= dword	ptr -68h
lpFileMappingAttributes= dword ptr -64h
flProtect	= dword	ptr -60h
dwMaximumSizeHigh= dword ptr -5Ch
dwMaximumSizeLow= dword	ptr -58h
lpName		= dword	ptr -54h
var_48		= byte ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_18		= dword	ptr -18h
hFileMappingObject= dword ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		lea	eax, [ebp+var_48]
		mov	[esp+68h+lpFileMappingAttributes], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+hFile], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jns	short loc_40F044
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F167
; ---------------------------------------------------------------------------

loc_40F044:				; CODE XREF: sub_40F01C+1Cj
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		test	edx, edx
		jg	short loc_40F070
		test	edx, edx
		js	short loc_40F059
		cmp	eax, 7FFh
		ja	short loc_40F070

loc_40F059:				; CODE XREF: sub_40F01C+34j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F167
; ---------------------------------------------------------------------------

loc_40F070:				; CODE XREF: sub_40F01C+30j
					; sub_40F01C+3Bj
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+hFile], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_40F099
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F167
; ---------------------------------------------------------------------------

loc_40F099:				; CODE XREF: sub_40F01C+71j
		mov	[esp+68h+lpName], 0 ; lpName
		mov	[esp+68h+dwMaximumSizeLow], 0 ;	dwMaximumSizeLow
		mov	[esp+68h+dwMaximumSizeHigh], 0 ; dwMaximumSizeHigh
		mov	[esp+68h+flProtect], 2 ; flProtect
		mov	[esp+68h+lpFileMappingAttributes], 0 ; lpFileMappingAttributes
		mov	eax, [ebp+var_10]
		mov	[esp+68h+hFile], eax ; hFile
		mov	eax, ds:CreateFileMappingA
		call	eax ; CreateFileMappingA
		sub	esp, 18h
		mov	[ebp+hFileMappingObject], eax
		cmp	[ebp+hFileMappingObject], 0
		jnz	short loc_40F0E4
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F167
; ---------------------------------------------------------------------------

loc_40F0E4:				; CODE XREF: sub_40F01C+BCj
		mov	[esp+68h+dwMaximumSizeLow], 0 ;	dwNumberOfBytesToMap
		mov	[esp+68h+dwMaximumSizeHigh], 0 ; dwFileOffsetLow
		mov	[esp+68h+flProtect], 0 ; dwFileOffsetHigh
		mov	[esp+68h+lpFileMappingAttributes], 4 ; dwDesiredAccess
		mov	eax, [ebp+hFileMappingObject]
		mov	[esp+68h+hFile], eax ; hFileMappingObject
		mov	eax, ds:MapViewOfFile
		call	eax ; MapViewOfFile
		sub	esp, 14h
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40F124
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F167
; ---------------------------------------------------------------------------

loc_40F124:				; CODE XREF: sub_40F01C+FFj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+hFileMappingObject]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, 0

locret_40F167:				; CODE XREF: sub_40F01C+23j
					; sub_40F01C+4Fj ...
		leave
		retn
sub_40F01C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F169	proc near		; CODE XREF: sub_4070B4+2Ep
					; sub_40895E+E0p

lpBaseAddress	= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40F1B3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+lpBaseAddress], eax ; lpBaseAddress
		mov	eax, ds:UnmapViewOfFile
		call	eax ; UnmapViewOfFile
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+lpBaseAddress], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_40F1B3:				; CODE XREF: sub_40F169+Ej
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		leave
		retn
sub_40F169	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F1BF(int, void *, size_t, int)
sub_40F1BF	proc near		; CODE XREF: sub_408DFB+243p
					; sub_40AA09+399p ...

Dst		= dword	ptr -18h
Src		= dword	ptr -14h
Size		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+arg_C]
		jb	short loc_40F1DE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		sub	eax, [ebp+arg_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_40F1F2

loc_40F1DE:				; CODE XREF: sub_40F1BF+Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F218
; ---------------------------------------------------------------------------

loc_40F1F2:				; CODE XREF: sub_40F1BF+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_C]
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+18h+Size],	ecx ; Size
		mov	[esp+18h+Src], edx ; Src
		mov	[esp+18h+Dst], eax ; Dst
		call	memcpy
		mov	eax, 0

locret_40F218:				; CODE XREF: sub_40F1BF+31j
		leave
		retn
sub_40F1BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F21A(int, void *, size_t)
sub_40F21A	proc near		; CODE XREF: sub_408DFB+1B7p

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_40F235
		mov	eax, 0
		jmp	locret_40F469
; ---------------------------------------------------------------------------

loc_40F235:				; CODE XREF: sub_40F21A+Fj
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Buf2],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Buf1],	eax
		call	sub_410ABE
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_14]
		shl	edx, 3
		and	edx, 7FFh
		add	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 4
		mov	[esp+38h+Buf1],	eax
		call	sub_40FCA0
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40F282
		mov	eax, 0
		jmp	locret_40F469
; ---------------------------------------------------------------------------

loc_40F282:				; CODE XREF: sub_40F21A+5Cj
		mov	eax, [ebp+var_18]
		shl	eax, 3
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Buf1],	eax
		call	sub_40FCA0
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		shr	eax, 3
		cmp	eax, [ebp+var_18]
		jb	short loc_40F2C0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_1C]
		jb	short loc_40F2C0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_10]
		jnb	short loc_40F2D7

loc_40F2C0:				; CODE XREF: sub_40F21A+8Bj
					; sub_40F21A+96j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F469
; ---------------------------------------------------------------------------

loc_40F2D7:				; CODE XREF: sub_40F21A+A4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, [ebp+var_1C]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_20]
		add	eax, edx
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_14]
		shr	eax, 8
		mov	edx, 0
		div	[ebp+var_18]
		mov	eax, edx
		shl	eax, 3
		add	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		jmp	short loc_40F30A
; ---------------------------------------------------------------------------

loc_40F309:				; CODE XREF: sub_40F21A+23Ej
					; sub_40F21A+24Aj
		nop

loc_40F30A:				; CODE XREF: sub_40F21A+EDj
		mov	eax, [ebp+var_C]
		add	eax, 4
		mov	[esp+38h+Buf1],	eax
		call	sub_40FCA0
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40F32B
		mov	eax, 0
		jmp	locret_40F469
; ---------------------------------------------------------------------------

loc_40F32B:				; CODE XREF: sub_40F21A+105j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Buf1],	eax
		call	sub_40FCA0
		cmp	eax, [ebp+var_14]
		jnz	loc_40F43D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		sub	eax, 8
		cmp	eax, [ebp+var_1C]
		jnb	short loc_40F364
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F469
; ---------------------------------------------------------------------------

loc_40F364:				; CODE XREF: sub_40F21A+131j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, [ebp+var_1C]
		mov	[esp+38h+Buf1],	eax
		call	sub_40FCA0
		cmp	eax, [ebp+arg_8]
		jnz	loc_40F43D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		sub	eax, [ebp+arg_8]
		mov	edx, [ebp+var_1C]
		add	edx, 8
		cmp	eax, edx
		jnb	short loc_40F3A8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F469
; ---------------------------------------------------------------------------

loc_40F3A8:				; CODE XREF: sub_40F21A+175j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_1C]
		add	edx, 8
		add	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Size],	eax ; Size
		mov	[esp+38h+Buf2],	edx ; Buf2
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_40F43D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_1C]
		add	edx, 4
		add	eax, edx
		mov	[esp+38h+Buf1],	eax
		call	sub_40FCA0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_8]
		add	eax, edx
		add	eax, 8
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_18]
		jb	short loc_40F410
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_18]
		cmp	eax, [ebp+var_1C]
		jnb	short loc_40F424

loc_40F410:				; CODE XREF: sub_40F21A+1E6j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F469
; ---------------------------------------------------------------------------

loc_40F424:				; CODE XREF: sub_40F21A+1F4j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+14h], edx
		mov	eax, 1
		jmp	short locret_40F469
; ---------------------------------------------------------------------------

loc_40F43D:				; CODE XREF: sub_40F21A+11Fj
					; sub_40F21A+15Ej ...
		sub	[ebp+var_10], 8
		cmp	[ebp+var_10], 0
		jnz	short loc_40F44E
		mov	eax, 0
		jmp	short locret_40F469
; ---------------------------------------------------------------------------

loc_40F44E:				; CODE XREF: sub_40F21A+22Bj
		add	[ebp+var_C], 8
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_24]
		jb	loc_40F309
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		jmp	loc_40F309
; ---------------------------------------------------------------------------

locret_40F469:				; CODE XREF: sub_40F21A+16j
					; sub_40F21A+63j ...
		leave
		retn
sub_40F21A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F46B	proc near		; CODE XREF: sub_40AA09+339p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+1Ch], edx
		cmp	[ebp+arg_8], 0
		jz	short loc_40F4A5
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	sub_410ABE
		jmp	short loc_40F4AA
; ---------------------------------------------------------------------------

loc_40F4A5:				; CODE XREF: sub_40F46B+24j
		mov	eax, 0

loc_40F4AA:				; CODE XREF: sub_40F46B+38j
		mov	edx, [ebp+arg_0]
		mov	[edx+4], eax
		cmp	[ebp+arg_8], 0
		jz	loc_40F5A7
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		shl	eax, 3
		and	eax, 7FFh
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		add	eax, 4
		mov	[esp+28h+var_28], eax
		call	sub_40FCA0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		lea	edx, ds:0[eax*8]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		cmp	[ebp+var_C], 0
		jnz	short loc_40F50A
		mov	eax, 0
		jmp	locret_40F5CE
; ---------------------------------------------------------------------------

loc_40F50A:				; CODE XREF: sub_40F46B+93j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax
		call	sub_40FCA0
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		shr	eax, 3
		cmp	eax, [ebp+var_C]
		jb	short loc_40F547
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_10]
		jb	short loc_40F547
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_10]
		cmp	edx, eax
		jbe	short loc_40F55B

loc_40F547:				; CODE XREF: sub_40F46B+BCj
					; sub_40F46B+C7j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F5CE
; ---------------------------------------------------------------------------

loc_40F55B:				; CODE XREF: sub_40F46B+DAj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		shr	eax, 8
		mov	edx, 0
		div	[ebp+var_C]
		mov	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		jmp	short loc_40F5C9
; ---------------------------------------------------------------------------

loc_40F5A7:				; CODE XREF: sub_40F46B+49j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx

loc_40F5C9:				; CODE XREF: sub_40F46B+13Aj
		mov	eax, 0

locret_40F5CE:				; CODE XREF: sub_40F46B+9Aj
					; sub_40F46B+EEj
		leave
		retn
sub_40F46B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F5D0	proc near		; CODE XREF: sub_40AA09+69Ap

Buf1		= dword	ptr -28h
Buf2		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_40F888
		jmp	loc_40F78D
; ---------------------------------------------------------------------------

loc_40F5F1:				; CODE XREF: sub_40F5D0+1C5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		add	eax, 4
		mov	[esp+28h+Buf1],	eax
		call	sub_40FCA0
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40F615
		mov	eax, 0
		jmp	locret_40F989
; ---------------------------------------------------------------------------

loc_40F615:				; CODE XREF: sub_40F5D0+39j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Buf1],	eax
		call	sub_40FCA0
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+4]
		cmp	eax, edx
		setz	al
		movzx	eax, al
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jb	short loc_40F65F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx

loc_40F65F:				; CODE XREF: sub_40F5D0+81j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		lea	edx, [eax-8]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		cmp	[ebp+var_14], 0
		jz	loc_40F78D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		sub	eax, 8
		cmp	eax, [ebp+var_10]
		jnb	short loc_40F69D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F989
; ---------------------------------------------------------------------------

loc_40F69D:				; CODE XREF: sub_40F5D0+B4j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		add	eax, [ebp+var_10]
		mov	[esp+28h+Buf1],	eax
		call	sub_40FCA0
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+1Ch]
		cmp	eax, edx
		jnz	loc_40F78D
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		sub	edx, eax
		mov	eax, [ebp+var_10]
		add	eax, 8
		cmp	edx, eax
		jnb	short loc_40F6EB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F989
; ---------------------------------------------------------------------------

loc_40F6EB:				; CODE XREF: sub_40F5D0+102j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+1Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, [ebp+var_10]
		add	ecx, 8
		add	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Buf2],	ecx ; Buf2
		mov	[esp+28h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_40F78D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_10]
		add	edx, 4
		add	eax, edx
		mov	[esp+28h+Buf1],	eax
		call	sub_40FCA0
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		add	eax, [ebp+var_10]
		add	eax, 8
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_14]
		jb	short loc_40F75A
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jnb	short loc_40F771

loc_40F75A:				; CODE XREF: sub_40F5D0+17Aj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F989
; ---------------------------------------------------------------------------

loc_40F771:				; CODE XREF: sub_40F5D0+188j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, 1
		jmp	locret_40F989
; ---------------------------------------------------------------------------

loc_40F78D:				; CODE XREF: sub_40F5D0+1Cj
					; sub_40F5D0+A2j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	loc_40F5F1
		jmp	loc_40F984
; ---------------------------------------------------------------------------

loc_40F7A0:				; CODE XREF: sub_40F5D0+2C7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 0FFh
		jbe	short loc_40F7B7
		mov	eax, 0
		jmp	locret_40F989
; ---------------------------------------------------------------------------

loc_40F7B7:				; CODE XREF: sub_40F5D0+1DBj
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		shl	eax, 3
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Buf1],	eax
		call	sub_40FCA0
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		add	eax, 4
		mov	[esp+28h+Buf1],	eax
		call	sub_40FCA0
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		lea	edx, ds:0[eax*8]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		shr	eax, 3
		cmp	eax, [ebp+var_14]
		jb	short loc_40F83E
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_10]
		jb	short loc_40F83E
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_10]
		cmp	edx, eax
		jbe	short loc_40F855

loc_40F83E:				; CODE XREF: sub_40F5D0+24Ej
					; sub_40F5D0+259j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F989
; ---------------------------------------------------------------------------

loc_40F855:				; CODE XREF: sub_40F5D0+26Cj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		jmp	short loc_40F889
; ---------------------------------------------------------------------------

loc_40F888:				; CODE XREF: sub_40F5D0+16j
					; sub_40F5D0+2F4j
		nop

loc_40F889:				; CODE XREF: sub_40F5D0+2B6j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	loc_40F7A0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		add	eax, 4
		mov	[esp+28h+Buf1],	eax
		call	sub_40FCA0
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		cmp	[ebp+var_10], 0
		jz	short loc_40F888
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		sub	eax, 8
		cmp	eax, [ebp+var_10]
		jnb	short loc_40F8EB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F989
; ---------------------------------------------------------------------------

loc_40F8EB:				; CODE XREF: sub_40F5D0+302j
		mov	eax, [ebp+var_10]
		lea	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		add	eax, [ebp+var_10]
		mov	[esp+28h+Buf1],	eax
		call	sub_40FCA0
		mov	edx, [ebp+var_C]
		mov	[edx+1Ch], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+1Ch]
		add	eax, [ebp+var_10]
		lea	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_10]
		add	edx, 4
		add	eax, edx
		mov	[esp+28h+Buf1],	eax
		call	sub_40FCA0
		mov	edx, [ebp+var_C]
		mov	[edx+14h], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+1Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		add	eax, edx
		add	eax, 8
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_10]
		jb	short loc_40F969
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jnb	short loc_40F97D

loc_40F969:				; CODE XREF: sub_40F5D0+389j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F989
; ---------------------------------------------------------------------------

loc_40F97D:				; CODE XREF: sub_40F5D0+397j
		mov	eax, 1
		jmp	short locret_40F989
; ---------------------------------------------------------------------------

loc_40F984:				; CODE XREF: sub_40F5D0+1CBj
		mov	eax, 0

locret_40F989:				; CODE XREF: sub_40F5D0+40j
					; sub_40F5D0+C8j ...
		leave
		retn
sub_40F5D0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F98B	proc near		; CODE XREF: .text:0040FA6Bp
					; .text:0040FB19p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_40F9EF
; ---------------------------------------------------------------------------

loc_40F993:				; CODE XREF: sub_40F98B+36j
					; sub_40F98B+68j
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_read
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40F9C3
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_40F993

loc_40F9C3:				; CODE XREF: sub_40F98B+28j
		cmp	[ebp+var_C], 0
		jg	short loc_40F9E3
		cmp	[ebp+var_C], 0
		jnz	short loc_40F9DC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 5

loc_40F9DC:				; CODE XREF: sub_40F98B+42j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F9FA
; ---------------------------------------------------------------------------

loc_40F9E3:				; CODE XREF: sub_40F98B+3Cj
		mov	eax, [ebp+var_C]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_C]
		sub	[ebp+arg_8], eax

loc_40F9EF:				; CODE XREF: sub_40F98B+6j
		cmp	[ebp+arg_8], 0
		jg	short loc_40F993
		mov	eax, 0

locret_40F9FA:				; CODE XREF: sub_40F98B+56j
		leave
		retn
sub_40F98B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 88h
		mov	dword ptr [ebp-14h], 1
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_410ABE
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		and	eax, 0FFh
		shl	eax, 3
		mov	[ebp-24h], eax
		mov	eax, [ebp-24h]
		mov	edx, 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	j__lseeki64
		test	edx, edx
		js	short loc_40FA74
		mov	dword ptr [esp+8], 8
		lea	eax, [ebp-70h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F98B
		test	eax, eax
		jns	short loc_40FA7E

loc_40FA74:				; CODE XREF: .text:0040FA54j
		mov	eax, 0FFFFFFFFh
		jmp	locret_40FC9E
; ---------------------------------------------------------------------------

loc_40FA7E:				; CODE XREF: .text:0040FA72j
		lea	eax, [ebp-70h]
		add	eax, 4
		mov	[esp], eax
		call	sub_40FCA0
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-28h], 0
		jnz	short loc_40FA9F
		mov	eax, 0
		jmp	locret_40FC9E
; ---------------------------------------------------------------------------

loc_40FA9F:				; CODE XREF: .text:0040FA93j
		mov	eax, [ebp-20h]
		shr	eax, 8
		mov	edx, 0
		div	dword ptr [ebp-28h]
		mov	[ebp-10h], edx
		mov	eax, [ebp-28h]
		mov	[ebp-0Ch], eax
		lea	eax, [ebp-70h]
		mov	[esp], eax
		call	sub_40FCA0
		mov	[ebp-2Ch], eax
		jmp	short loc_40FAC7
; ---------------------------------------------------------------------------

loc_40FAC6:				; CODE XREF: .text:0040FC86j
					; .text:0040FC99j
		nop

loc_40FAC7:				; CODE XREF: .text:0040FAC4j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40FB04
		mov	eax, [ebp-10h]
		shl	eax, 3
		add	eax, [ebp-2Ch]
		mov	edx, 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	j__lseeki64
		test	edx, edx
		jns	short loc_40FB04
		mov	eax, 0FFFFFFFFh
		jmp	locret_40FC9E
; ---------------------------------------------------------------------------

loc_40FB04:				; CODE XREF: .text:0040FACBj
					; .text:0040FAF8j
		mov	dword ptr [esp+8], 8
		lea	eax, [ebp-70h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F98B
		test	eax, eax
		jns	short loc_40FB2C
		mov	eax, 0FFFFFFFFh
		jmp	locret_40FC9E
; ---------------------------------------------------------------------------

loc_40FB2C:				; CODE XREF: .text:0040FB20j
		lea	eax, [ebp-70h]
		add	eax, 4
		mov	[esp], eax
		call	sub_40FCA0
		mov	[ebp-24h], eax
		cmp	dword ptr [ebp-24h], 0
		jnz	short loc_40FB4D
		mov	eax, 0
		jmp	locret_40FC9E
; ---------------------------------------------------------------------------

loc_40FB4D:				; CODE XREF: .text:0040FB41j
		lea	eax, [ebp-70h]
		mov	[esp], eax
		call	sub_40FCA0
		cmp	eax, [ebp-20h]
		jz	short loc_40FB69
		mov	dword ptr [ebp-14h], 0
		jmp	loc_40FC6B
; ---------------------------------------------------------------------------

loc_40FB69:				; CODE XREF: .text:0040FB5Bj
		mov	eax, [ebp-24h]
		mov	edx, 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	j__lseeki64
		test	edx, edx
		js	short loc_40FBAE
		mov	dword ptr [esp+8], 8
		lea	eax, [ebp-70h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F98B
		test	eax, eax
		jns	short loc_40FBB8

loc_40FBAE:				; CODE XREF: .text:0040FB8Ej
		mov	eax, 0FFFFFFFFh
		jmp	locret_40FC9E
; ---------------------------------------------------------------------------

loc_40FBB8:				; CODE XREF: .text:0040FBACj
		lea	eax, [ebp-70h]
		mov	[esp], eax
		call	sub_40FCA0
		cmp	eax, [ebp+10h]
		jnz	loc_40FC64
		mov	eax, [ebp+10h]
		mov	[ebp-18h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40FBF4
		lea	eax, [ebp-70h]
		add	eax, 4
		mov	[esp], eax
		call	sub_40FCA0
		mov	edx, [ebp+14h]
		mov	[edx], eax

loc_40FBF4:				; CODE XREF: .text:0040FBDFj
					; .text:0040FC61j
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40FC04
		mov	eax, 1
		jmp	locret_40FC9E
; ---------------------------------------------------------------------------

loc_40FC04:				; CODE XREF: .text:0040FBF8j
		mov	eax, 40h
		cmp	dword ptr [ebp-18h], 40h
		cmovbe	eax, [ebp-18h]
		mov	[ebp-30h], eax
		mov	eax, [ebp-30h]
		mov	[esp+8], eax
		lea	eax, [ebp-70h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F98B
		test	eax, eax
		jns	short loc_40FC38
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40FC9E
; ---------------------------------------------------------------------------

loc_40FC38:				; CODE XREF: .text:0040FC2Fj
		mov	eax, [ebp-30h]
		mov	[esp+8], eax
		mov	eax, [ebp-1Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-70h]
		mov	[esp], eax
		call	memcmp
		test	eax, eax
		jnz	short loc_40FC63
		mov	eax, [ebp-30h]
		add	[ebp-1Ch], eax
		mov	eax, [ebp-30h]
		sub	[ebp-18h], eax
		jmp	short loc_40FBF4
; ---------------------------------------------------------------------------

loc_40FC63:				; CODE XREF: .text:0040FC53j
		nop

loc_40FC64:				; CODE XREF: .text:0040FBC6j
		mov	dword ptr [ebp-14h], 1

loc_40FC6B:				; CODE XREF: .text:0040FB64j
		sub	dword ptr [ebp-0Ch], 1
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40FC7C
		mov	eax, 0
		jmp	short locret_40FC9E
; ---------------------------------------------------------------------------

loc_40FC7C:				; CODE XREF: .text:0040FC73j
		add	dword ptr [ebp-10h], 1
		mov	eax, [ebp-10h]
		cmp	eax, [ebp-28h]
		jnz	loc_40FAC6
		mov	eax, [ebp-2Ch]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-14h], 1
		jmp	loc_40FAC6
; ---------------------------------------------------------------------------

locret_40FC9E:				; CODE XREF: .text:0040FA79j
					; .text:0040FA9Aj ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FCA0	proc near		; CODE XREF: sub_40F21A+50p
					; sub_40F21A+77p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_4], eax
		shl	[ebp+var_4], 8
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	[ebp+var_4], eax
		shl	[ebp+var_4], 8
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	[ebp+var_4], eax
		shl	[ebp+var_4], 8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40FCA0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40FCF0(int, void *, size_t, void *, size_t)
sub_40FCF0	proc near		; CODE XREF: sub_40989B+27Cp

Size		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= byte ptr -18h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, 8
		not	eax
		cmp	eax, [ebp+arg_8]
		jb	short loc_40FD19
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		add	eax, 8
		not	eax
		cmp	eax, [ebp+arg_10]
		jnb	short loc_40FD30

loc_40FD19:				; CODE XREF: sub_40FCF0+14j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_40FE9B
; ---------------------------------------------------------------------------

loc_40FD30:				; CODE XREF: sub_40FCF0+27j
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Size],	eax
		call	sub_410ABE
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	edx, al
		mov	eax, [ebp+arg_0]
		add	edx, 404h
		mov	eax, [eax+edx*4]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40FD6D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FDh
		jbe	short loc_40FDCF

loc_40FD6D:				; CODE XREF: sub_40FCF0+6Ej
		mov	[esp+28h+Size],	7F8h ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40FD99
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_40FE9B
; ---------------------------------------------------------------------------

loc_40FD99:				; CODE XREF: sub_40FCF0+90j
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		movzx	edx, al
		mov	eax, [ebp+arg_0]
		add	edx, 404h
		mov	edx, [eax+edx*4]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		movzx	edx, al
		mov	eax, [ebp+arg_0]
		lea	ecx, [edx+404h]
		mov	edx, [ebp+var_C]
		mov	[eax+ecx*4], edx

loc_40FDCF:				; CODE XREF: sub_40FCF0+7Bj
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_10]
		mov	[eax+edx*8+8], ecx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	[eax+edx*8+0Ch], ecx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Size],	eax
		call	sub_410413
		lea	eax, [ebp+var_18]
		add	eax, 4
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+Size],	eax
		call	sub_410413
		mov	[esp+28h+var_20], 8 ; size_t
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; int
		call	sub_410538
		test	eax, eax
		js	short loc_40FE8F
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; int
		call	sub_410538
		test	eax, eax
		js	short loc_40FE8F
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; int
		call	sub_410538
		test	eax, eax
		jns	short loc_40FE96

loc_40FE8F:				; CODE XREF: sub_40FCF0+163j
					; sub_40FCF0+180j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40FE9B
; ---------------------------------------------------------------------------

loc_40FE96:				; CODE XREF: sub_40FCF0+19Dj
		mov	eax, 0

locret_40FE9B:				; CODE XREF: sub_40FCF0+3Bj
					; sub_40FCF0+A4j ...
		leave
		retn
sub_40FCF0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_410ABE
		mov	[ebp-14h], eax
		mov	eax, [ebp+1Ch]
		test	eax, eax
		jz	loc_40FF4E
		test	eax, eax
		js	loc_40FFEC
		cmp	eax, 3
		jg	loc_40FFEC
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41022F
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_40FF0E
		mov	eax, 0FFFFFFFFh
		jmp	locret_41010B
; ---------------------------------------------------------------------------

loc_40FF0E:				; CODE XREF: .text:0040FF02j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40FF4E
		cmp	dword ptr [ebp+1Ch], 2
		jnz	short loc_40FF31
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 11h
		mov	eax, 1
		jmp	locret_41010B
; ---------------------------------------------------------------------------

loc_40FF31:				; CODE XREF: .text:0040FF18j
		cmp	dword ptr [ebp+1Ch], 1
		jnz	short loc_40FF47
		sub	dword ptr [ebp-0Ch], 1
		mov	dword ptr [ebp-10h], 1
		jmp	loc_410003
; ---------------------------------------------------------------------------

loc_40FF47:				; CODE XREF: .text:0040FF35j
		mov	dword ptr [ebp-10h], 1

loc_40FF4E:				; CODE XREF: .text:0040FEBDj
					; .text:0040FF12j
		mov	eax, [ebp-14h]
		movzx	edx, al
		mov	eax, [ebp+8]
		add	edx, 404h
		mov	eax, [eax+edx*4]
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		test	eax, eax
		jz	short loc_40FF77
		mov	eax, [ebp-20h]
		mov	eax, [eax+4]
		cmp	eax, 0FDh
		jbe	short loc_40FFDA

loc_40FF77:				; CODE XREF: .text:0040FF68j
		mov	dword ptr [esp], 7F8h
		call	malloc
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		test	eax, eax
		jnz	short loc_40FFA4
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_41010B
; ---------------------------------------------------------------------------

loc_40FFA4:				; CODE XREF: .text:0040FF8Bj
		mov	eax, [ebp-20h]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp-20h]
		mov	edx, [ebp-14h]
		movzx	ecx, dl
		mov	edx, [ebp+8]
		add	ecx, 404h
		mov	edx, [edx+ecx*4]
		mov	[eax], edx
		mov	eax, [ebp-14h]
		movzx	ecx, al
		mov	edx, [ebp-20h]
		mov	eax, [ebp+8]
		add	ecx, 404h
		mov	[eax+ecx*4], edx

loc_40FFDA:				; CODE XREF: .text:0040FF75j
		mov	eax, [ebp-20h]
		mov	eax, [eax+4]
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_410003
; ---------------------------------------------------------------------------

loc_40FFEC:				; CODE XREF: .text:0040FEC5j
					; .text:0040FECEj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_41010B
; ---------------------------------------------------------------------------

loc_410003:				; CODE XREF: .text:0040FF42j
					; .text:0040FFEAj
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		add	eax, 8
		not	eax
		cmp	eax, [ebp+10h]
		jb	short loc_410026
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		add	eax, [ebp+10h]
		add	eax, 8
		not	eax
		cmp	eax, [ebp+18h]
		jnb	short loc_41003D

loc_410026:				; CODE XREF: .text:00410011j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_41010B
; ---------------------------------------------------------------------------

loc_41003D:				; CODE XREF: .text:00410024j
		mov	eax, [ebp-20h]
		mov	edx, [ebp-0Ch]
		mov	ecx, [ebp-14h]
		mov	[eax+edx*8+8], ecx
		mov	eax, [ebp-20h]
		mov	edx, [ebp+8]
		mov	ecx, [edx+4]
		mov	edx, [ebp-0Ch]
		mov	[eax+edx*8+0Ch], ecx
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp-20h]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_410082
		mov	eax, [ebp-20h]
		mov	edx, [eax+4]
		add	edx, 1
		mov	[eax+4], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+8], edx

loc_410082:				; CODE XREF: .text:00410065j
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_410413
		lea	eax, [ebp-1Ch]
		add	eax, 4
		mov	[esp+4], eax
		mov	eax, [ebp+18h]
		mov	[esp], eax
		call	sub_410413
		mov	dword ptr [esp+8], 8
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410538
		test	eax, eax
		js	short loc_410101
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410538
		test	eax, eax
		js	short loc_410101
		mov	eax, [ebp+18h]
		mov	[esp+8], eax
		mov	eax, [ebp+14h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410538
		test	eax, eax
		jns	short loc_410108

loc_410101:				; CODE XREF: .text:004100C5j
					; .text:004100E2j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41010B
; ---------------------------------------------------------------------------

loc_410108:				; CODE XREF: .text:004100FFj
		mov	eax, [ebp-10h]

locret_41010B:				; CODE XREF: .text:0040FF09j
					; .text:0040FF2Cj ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41010D(int, int, void	*, size_t)
sub_41010D	proc near		; CODE XREF: sub_41022F+DAp

Buf1		= dword	ptr -58h
Buf2		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_4]
		mov	edx, 0
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Buf2],	eax
		mov	[esp+58h+Size],	edx
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Buf1],	eax
		call	j__lseeki64
		test	edx, edx
		js	short loc_410159
		mov	[esp+58h+Size],	8
		lea	eax, [ebp+var_48]
		mov	[esp+58h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Buf1],	eax
		call	_read
		cmp	eax, 8
		jz	short loc_410163

loc_410159:				; CODE XREF: sub_41010D+2Bj
		mov	eax, 0FFFFFFFFh
		jmp	locret_41022D
; ---------------------------------------------------------------------------

loc_410163:				; CODE XREF: sub_41010D+4Aj
		lea	eax, [ebp+var_48]
		mov	[esp+58h+Buf1],	eax
		call	sub_40FCA0
		cmp	eax, [ebp+arg_C]
		jz	short loc_4101D3
		mov	eax, 0
		jmp	locret_41022D
; ---------------------------------------------------------------------------

loc_41017D:				; CODE XREF: sub_41010D+CAj
		mov	[esp+58h+Size],	40h
		lea	eax, [ebp+var_48]
		mov	[esp+58h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Buf1],	eax
		call	_read
		cmp	eax, 40h
		jz	short loc_4101A6
		mov	eax, 0FFFFFFFFh
		jmp	locret_41022D
; ---------------------------------------------------------------------------

loc_4101A6:				; CODE XREF: sub_41010D+8Dj
		mov	[esp+58h+Size],	40h ; Size
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Buf2],	eax ; Buf2
		lea	eax, [ebp+var_48]
		mov	[esp+58h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_4101CB
		mov	eax, 0
		jmp	short locret_41022D
; ---------------------------------------------------------------------------

loc_4101CB:				; CODE XREF: sub_41010D+B5j
		add	[ebp+arg_8], 40h
		sub	[ebp+arg_C], 40h

loc_4101D3:				; CODE XREF: sub_41010D+64j
		cmp	[ebp+arg_C], 40h
		ja	short loc_41017D
		cmp	[ebp+arg_C], 0
		jz	short loc_410228
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+58h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Buf1],	eax
		call	_read
		cmp	eax, [ebp+arg_C]
		jz	short loc_410204
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41022D
; ---------------------------------------------------------------------------

loc_410204:				; CODE XREF: sub_41010D+EEj
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Size],	eax ; Size
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Buf2],	eax ; Buf2
		lea	eax, [ebp+var_48]
		mov	[esp+58h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_410228
		mov	eax, 0
		jmp	short locret_41022D
; ---------------------------------------------------------------------------

loc_410228:				; CODE XREF: sub_41010D+D0j
					; sub_41010D+112j
		mov	eax, 1

locret_41022D:				; CODE XREF: sub_41010D+51j
					; sub_41010D+6Bj ...
		leave
		retn
sub_41010D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41022F(int, void *, size_t, int, int)
sub_41022F	proc near		; CODE XREF: .text:0040FEF6p
					; .text:0041040Cp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		movzx	edx, al
		mov	eax, [ebp+arg_0]
		add	edx, 404h
		mov	eax, [eax+edx*4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	loc_41038A
; ---------------------------------------------------------------------------

loc_410256:				; CODE XREF: sub_41022F+15Fj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	loc_410378
; ---------------------------------------------------------------------------

loc_410267:				; CODE XREF: sub_41022F+14Dj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	eax, [eax+edx*8+8]
		cmp	eax, [ebp+arg_C]
		jnz	loc_410370
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+100Ch]
		mov	edx, [ebp+arg_0]
		add	edx, 0Ch
		cmp	eax, edx
		jz	short loc_4102DE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+100Ch]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		lea	ecx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], ecx
		mov	[esp+28h+var_28], eax
		call	_write
		test	eax, eax
		jns	short loc_4102CF
		mov	eax, 0FFFFFFFFh
		jmp	locret_4103D2
; ---------------------------------------------------------------------------

loc_4102CF:				; CODE XREF: sub_41022F+94j
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+100Ch], edx

loc_4102DE:				; CODE XREF: sub_41022F+5Cj
		mov	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	edx, [eax+edx*8+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+var_1C], ecx ;	size_t
		mov	ecx, [ebp+arg_4]
		mov	[esp+28h+var_20], ecx ;	void *
		mov	[esp+28h+var_24], edx ;	int
		mov	[esp+28h+var_28], eax ;	int
		call	sub_41010D
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_410373
		cmp	[ebp+var_18], 0
		jns	short loc_410327
		mov	eax, 0FFFFFFFFh
		jmp	locret_4103D2
; ---------------------------------------------------------------------------

loc_410327:				; CODE XREF: sub_41022F+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], ecx
		call	j__lseeki64
		test	edx, edx
		jns	short loc_41035A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4103D2
; ---------------------------------------------------------------------------

loc_41035A:				; CODE XREF: sub_41022F+122j
		cmp	[ebp+arg_10], 0
		jz	short loc_410368
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_410368:				; CODE XREF: sub_41022F+12Fj
		mov	eax, [ebp+var_10]
		add	eax, 1
		jmp	short locret_4103D2
; ---------------------------------------------------------------------------

loc_410370:				; CODE XREF: sub_41022F+45j
		nop
		jmp	short loc_410374
; ---------------------------------------------------------------------------

loc_410373:				; CODE XREF: sub_41022F+E6j
		nop

loc_410374:				; CODE XREF: sub_41022F+142j
		sub	[ebp+var_10], 1

loc_410378:				; CODE XREF: sub_41022F+33j
		cmp	[ebp+var_10], 0
		jns	loc_410267
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41038A:				; CODE XREF: sub_41022F+22j
		cmp	[ebp+var_C], 0
		jnz	loc_410256
		cmp	[ebp+var_14], 0
		jz	short loc_4103CD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], ecx
		call	j__lseeki64
		test	edx, edx
		jns	short loc_4103CD
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4103D2
; ---------------------------------------------------------------------------

loc_4103CD:				; CODE XREF: sub_41022F+169j
					; sub_41022F+195j
		mov	eax, 0

locret_4103D2:				; CODE XREF: sub_41022F+9Bj
					; sub_41022F+F3j ...
		leave
		retn
sub_41022F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_410ABE
		mov	dword ptr [esp+10h], 0
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41022F
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410413	proc near		; CODE XREF: sub_40FCF0+12Dp
					; sub_40FCF0+142p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], dl
		shr	[ebp+arg_0], 8
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[edx], al
		shr	[ebp+arg_0], 8
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[edx], al
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+3]
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		mov	[edx], al
		pop	ebp
		retn
sub_410413	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41044E	proc near		; CODE XREF: sub_40A08A+26Bp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	ebx, 1410h
		mov	eax, 0
		mov	ecx, edx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_410473
		mov	[edx], al
		add	edx, 1
		sub	ebx, 1

loc_410473:				; CODE XREF: sub_41044E+1Bj
		mov	ecx, edx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_410485
		mov	[edx], ax
		add	edx, 2
		sub	ebx, 2

loc_410485:				; CODE XREF: sub_41044E+2Cj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, edx
		rep stosd
		mov	edx, edi
		mov	ecx, ebx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_41049F
		mov	[edx], ax
		add	edx, 2

loc_41049F:				; CODE XREF: sub_41044E+49j
		mov	ecx, ebx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_4104AD
		mov	[edx], al
		add	edx, 1

loc_4104AD:				; CODE XREF: sub_41044E+58j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 800h
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+80Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+100Ch], edx
		mov	eax, 0
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41044E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4104DA	proc near		; CODE XREF: sub_410538+7Bp
					; sub_410538+C3p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_41052B
; ---------------------------------------------------------------------------

loc_4104E2:				; CODE XREF: sub_4104DA+55j
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_write
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_410519
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_410519
		mov	eax, 0FFFFFFFFh
		jmp	short locret_410536
; ---------------------------------------------------------------------------

loc_410519:				; CODE XREF: sub_4104DA+28j
					; sub_4104DA+36j
		cmp	[ebp+var_C], 0
		jle	short loc_41052B
		mov	eax, [ebp+var_C]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+var_C]
		add	[ebp+arg_4], eax

loc_41052B:				; CODE XREF: sub_4104DA+6j
					; sub_4104DA+43j
		cmp	[ebp+arg_8], 0
		jnz	short loc_4104E2
		mov	eax, 0

locret_410536:				; CODE XREF: sub_4104DA+3Dj
		leave
		retn
sub_4104DA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410538(int, void *, size_t)
sub_410538	proc near		; CODE XREF: sub_40FCF0+15Cp
					; sub_40FCF0+179p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+100Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1000h
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jbe	loc_410626
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+100Ch]
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+Size],	1000h
		mov	[esp+28h+Src], edx
		mov	[esp+28h+Dst], eax
		call	sub_4104DA
		test	eax, eax
		jns	short loc_4105C6
		mov	eax, 0FFFFFFFFh
		jmp	locret_410667
; ---------------------------------------------------------------------------

loc_4105C6:				; CODE XREF: sub_410538+82j
		mov	eax, [ebp+var_C]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_C]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+arg_8]
		shr	eax, 0Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410617
		shl	[ebp+var_C], 0Ch
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+Size],	edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+Src], edx
		mov	[esp+28h+Dst], eax
		call	sub_4104DA
		test	eax, eax
		jns	short loc_41060B
		mov	eax, 0FFFFFFFFh
		jmp	short locret_410667
; ---------------------------------------------------------------------------

loc_41060B:				; CODE XREF: sub_410538+CAj
		mov	eax, [ebp+var_C]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_C]
		sub	[ebp+arg_8], eax

loc_410617:				; CODE XREF: sub_410538+A7j
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+100Ch], edx

loc_410626:				; CODE XREF: sub_410538+3Cj
		cmp	[ebp+arg_8], 0
		jz	short loc_410662
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+100Ch]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+100Ch]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+100Ch], edx

loc_410662:				; CODE XREF: sub_410538+F2j
		mov	eax, 0

locret_410667:				; CODE XREF: sub_410538+89j
					; sub_410538+D1j
		leave
		retn
sub_410538	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410669	proc near		; CODE XREF: sub_410A9A+Cp

Size		= dword	ptr -848h
var_844		= dword	ptr -844h
var_840		= dword	ptr -840h
var_83C		= dword	ptr -83Ch
var_830		= dword	ptr -830h
var_430		= dword	ptr -430h
var_30		= dword	ptr -30h
Memory		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 848h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		not	eax
		mov	edx, eax
		shr	edx, 3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_4106A0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_410A47
; ---------------------------------------------------------------------------

loc_4106A0:				; CODE XREF: sub_410669+1Ej
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_410742
; ---------------------------------------------------------------------------

loc_4106B3:				; CODE XREF: sub_410669+E0j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		add	edx, 404h
		mov	eax, [eax+edx*4]
		mov	[ebp+var_C], eax
		jmp	short loc_4106FA
; ---------------------------------------------------------------------------

loc_4106D5:				; CODE XREF: sub_410669+95j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_C], eax

loc_4106FA:				; CODE XREF: sub_410669+6Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_4106D5
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		lea	ecx, [edx+404h]
		mov	edx, [ebp+var_1C]
		mov	[eax+ecx*4], edx
		mov	eax, [ebp+var_18]
		lea	edx, [eax+eax]
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_430], edx
		mov	eax, [ebp+var_14]
		mov	eax, [ebp+eax*4+var_430]
		cmp	eax, [ebp+var_10]
		jbe	short loc_41073E
		mov	eax, [ebp+var_14]
		mov	eax, [ebp+eax*4+var_430]
		mov	[ebp+var_10], eax

loc_41073E:				; CODE XREF: sub_410669+C6j
		add	[ebp+var_14], 1

loc_410742:				; CODE XREF: sub_410669+45j
		cmp	[ebp+var_14], 0FFh
		jbe	loc_4106B3
		mov	eax, [ebp+var_10]
		add	eax, 2
		shl	eax, 3
		mov	[esp+848h+Size], eax ; Size
		call	malloc
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_410780
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	locret_410A47
; ---------------------------------------------------------------------------

loc_410780:				; CODE XREF: sub_410669+FEj
		mov	eax, [ebp+var_28]
		mov	[ebp+Memory], eax
		add	[ebp+var_28], 10h
		mov	[ebp+var_14], 0
		jmp	loc_410923
; ---------------------------------------------------------------------------

loc_410796:				; CODE XREF: sub_410669+2C1j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_830], edx
		mov	eax, [ebp+var_14]
		mov	eax, [ebp+eax*4+var_430]
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	loc_41091E
		mov	[ebp+var_18], 0
		jmp	short loc_4107EA
; ---------------------------------------------------------------------------

loc_4107C6:				; CODE XREF: sub_410669+187j
		mov	eax, [ebp+var_18]
		shl	eax, 3
		mov	edx, eax
		add	edx, [ebp+var_28]
		mov	eax, [ebp+var_18]
		shl	eax, 3
		add	eax, [ebp+var_28]
		mov	dword ptr [eax+4], 0
		mov	eax, [eax+4]
		mov	[edx], eax
		add	[ebp+var_18], 1

loc_4107EA:				; CODE XREF: sub_410669+15Bj
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_30]
		jb	short loc_4107C6
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		add	edx, 404h
		mov	eax, [eax+edx*4]
		mov	[ebp+var_C], eax
		jmp	short loc_410882
; ---------------------------------------------------------------------------

loc_410806:				; CODE XREF: sub_410669+21Dj
		mov	[ebp+var_18], 0
		jmp	short loc_41086F
; ---------------------------------------------------------------------------

loc_41080F:				; CODE XREF: sub_410669+20Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_18]
		mov	eax, [eax+edx*8+8]
		shr	eax, 8
		mov	edx, 0
		div	[ebp+var_30]
		mov	[ebp+var_20], edx
		jmp	short loc_41083C
; ---------------------------------------------------------------------------

loc_410829:				; CODE XREF: sub_410669+1E1j
		add	[ebp+var_20], 1
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_30]
		jnz	short loc_41083C
		mov	[ebp+var_20], 0

loc_41083C:				; CODE XREF: sub_410669+1BEj
					; sub_410669+1CAj
		mov	eax, [ebp+var_20]
		shl	eax, 3
		add	eax, [ebp+var_28]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_410829
		mov	eax, [ebp+var_20]
		shl	eax, 3
		mov	ecx, eax
		add	ecx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_18]
		lea	edx, [eax+edx*8+8]
		mov	eax, [edx]
		mov	edx, [edx+4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		add	[ebp+var_18], 1

loc_41086F:				; CODE XREF: sub_410669+1A4j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+var_18]
		ja	short loc_41080F
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_410882:				; CODE XREF: sub_410669+19Bj
		cmp	[ebp+var_C], 0
		jnz	loc_410806
		mov	[ebp+var_18], 0
		jmp	short loc_4108E1
; ---------------------------------------------------------------------------

loc_410895:				; CODE XREF: sub_410669+27Ej
		mov	eax, [ebp+var_18]
		shl	eax, 3
		mov	edx, eax
		add	edx, [ebp+Memory]
		mov	eax, [ebp+var_18]
		shl	eax, 3
		add	eax, [ebp+var_28]
		mov	eax, [eax]
		mov	[esp+848h+var_844], edx
		mov	[esp+848h+Size], eax
		call	sub_410413
		mov	eax, [ebp+var_18]
		shl	eax, 3
		add	eax, 4
		mov	edx, eax
		add	edx, [ebp+Memory]
		mov	eax, [ebp+var_18]
		shl	eax, 3
		add	eax, [ebp+var_28]
		mov	eax, [eax+4]
		mov	[esp+848h+var_844], edx
		mov	[esp+848h+Size], eax
		call	sub_410413
		add	[ebp+var_18], 1

loc_4108E1:				; CODE XREF: sub_410669+22Aj
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_30]
		jb	short loc_410895
		mov	eax, [ebp+var_30]
		shl	eax, 3
		mov	[esp+848h+var_840], eax	; size_t
		mov	eax, [ebp+Memory]
		mov	[esp+848h+var_844], eax	; void *
		mov	eax, [ebp+arg_0]
		mov	[esp+848h+Size], eax ; int
		call	sub_410538
		test	eax, eax
		jns	short loc_41091F
		mov	eax, [ebp+Memory]
		mov	[esp+848h+Size], eax ; Memory
		call	free
		mov	eax, 0FFFFFFFFh
		jmp	locret_410A47
; ---------------------------------------------------------------------------

loc_41091E:				; CODE XREF: sub_410669+14Ej
		nop

loc_41091F:				; CODE XREF: sub_410669+29Ej
		add	[ebp+var_14], 1

loc_410923:				; CODE XREF: sub_410669+128j
		cmp	[ebp+var_14], 0FFh
		jbe	loc_410796
		mov	eax, [ebp+Memory]
		mov	[esp+848h+Size], eax ; Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+100Ch]
		mov	edx, [ebp+arg_0]
		add	edx, 0Ch
		cmp	eax, edx
		jz	short loc_41098C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+100Ch]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+848h+var_840], ecx
		mov	[esp+848h+var_844], edx
		mov	[esp+848h+Size], eax
		call	sub_4104DA
		test	eax, eax
		jz	short loc_41098C
		mov	eax, 0FFFFFFFFh
		jmp	locret_410A47
; ---------------------------------------------------------------------------

loc_41098C:				; CODE XREF: sub_410669+2E3j
					; sub_410669+317j
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[ebp+Memory], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4109E7
; ---------------------------------------------------------------------------

loc_41099E:				; CODE XREF: sub_410669+385j
		mov	eax, [ebp+var_14]
		shl	eax, 3
		mov	edx, eax
		add	edx, [ebp+Memory]
		mov	eax, [ebp+var_14]
		mov	eax, [ebp+eax*4+var_830]
		mov	[esp+848h+var_844], edx
		mov	[esp+848h+Size], eax
		call	sub_410413
		mov	eax, [ebp+var_14]
		shl	eax, 3
		add	eax, 4
		mov	edx, eax
		add	edx, [ebp+Memory]
		mov	eax, [ebp+var_14]
		mov	eax, [ebp+eax*4+var_430]
		mov	[esp+848h+var_844], edx
		mov	[esp+848h+Size], eax
		call	sub_410413
		add	[ebp+var_14], 1

loc_4109E7:				; CODE XREF: sub_410669+333j
		cmp	[ebp+var_14], 0FFh
		jbe	short loc_41099E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+848h+var_83C], 0
		mov	[esp+848h+var_844], 0
		mov	[esp+848h+var_840], 0
		mov	[esp+848h+Size], eax
		call	j__lseeki64
		or	eax, edx
		test	eax, eax
		jnz	short loc_410A3B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+848h+var_840], 800h
		mov	edx, [ebp+Memory]
		mov	[esp+848h+var_844], edx
		mov	[esp+848h+Size], eax
		call	sub_4104DA
		test	eax, eax
		jz	short loc_410A42

loc_410A3B:				; CODE XREF: sub_410669+3B0j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_410A47
; ---------------------------------------------------------------------------

loc_410A42:				; CODE XREF: sub_410669+3D0j
		mov	eax, 0

locret_410A47:				; CODE XREF: sub_410669+32j
					; sub_410669+112j ...
		leave
		retn
sub_410669	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410A49	proc near		; CODE XREF: sub_410A9A+1Ap

Memory		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_410A8F
; ---------------------------------------------------------------------------

loc_410A58:				; CODE XREF: sub_410A49+4Dj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		add	edx, 404h
		mov	eax, [eax+edx*4]
		mov	[ebp+var_10], eax
		jmp	short loc_410A85
; ---------------------------------------------------------------------------

loc_410A6C:				; CODE XREF: sub_410A49+40j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free

loc_410A85:				; CODE XREF: sub_410A49+21j
		cmp	[ebp+var_10], 0
		jnz	short loc_410A6C
		add	[ebp+var_C], 1

loc_410A8F:				; CODE XREF: sub_410A49+Dj
		cmp	[ebp+var_C], 0FFh
		jbe	short loc_410A58
		leave
		retn
sub_410A49	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410A9A	proc near		; CODE XREF: sub_40A08A+2E8p
					; sub_40A08A+2FBp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410669
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410A49
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410A9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410ABE	proc near		; CODE XREF: sub_40F21A+28p
					; sub_40F46B+33p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		mov	ebx, [ebp+arg_0]
		mov	edi, ebx
		add	edi, [ebp+arg_4]
		mov	esi, 1505h
		jmp	short loc_410AE8
; ---------------------------------------------------------------------------

loc_410AD3:				; CODE XREF: sub_410ABE+2Cj
		mov	eax, esi
		shl	eax, 5
		lea	edx, [eax+esi]
		movzx	eax, byte ptr [ebx]
		movzx	eax, al
		mov	esi, edx
		xor	esi, eax
		add	ebx, 1

loc_410AE8:				; CODE XREF: sub_410ABE+13j
		cmp	ebx, edi
		jb	short loc_410AD3
		mov	eax, esi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_410ABE	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410AF4	proc near		; CODE XREF: sub_410B1B+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_410B14
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_410B19
; ---------------------------------------------------------------------------

loc_410B14:				; CODE XREF: sub_410AF4+7j
		mov	eax, 0

loc_410B19:				; CODE XREF: sub_410AF4+1Ej
		pop	ebp
		retn
sub_410AF4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B1B	proc near		; CODE XREF: sub_410B43+14p
					; sub_410B5E+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_410AF4
		leave
		retn
sub_410B1B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B36	proc near		; CODE XREF: sub_411148+24Cp
					; sub_4119CC+35Ap ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_410B36	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B43	proc near		; CODE XREF: sub_411791+152p
					; sub_4119CC+13Ap ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_410B1B
		leave
		retn
sub_410B43	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B5E	proc near		; CODE XREF: sub_4119CC+216p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_410B1B
		leave
		retn
sub_410B5E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B73	proc near		; CODE XREF: sub_410BE0+31p
					; sub_411FE1+1B2p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410B8E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx

loc_410B8E:				; CODE XREF: sub_410B73+Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_410BB8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_410BB8
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 1
		mov	edx, ds:dword_436010
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx

loc_410BB8:				; CODE XREF: sub_410B73+23j
					; sub_410B73+2Dj
		pop	ebp
		retn
sub_410B73	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410BBA	proc near		; CODE XREF: sub_410BE0+46p
					; sub_411FE1+1C3p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 1
		jnz	short loc_410BD9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_410BD9
		mov	eax, 1
		jmp	short loc_410BDE
; ---------------------------------------------------------------------------

loc_410BD9:				; CODE XREF: sub_410BBA+Cj
					; sub_410BBA+16j
		mov	eax, 0

loc_410BDE:				; CODE XREF: sub_410BBA+1Dj
		pop	ebp
		retn
sub_410BBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410BE0	proc near		; CODE XREF: sub_411FE1+126p
					; sub_4121B9+2Ep ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	sub_404515
		mov	edx, [ebp+arg_0]
		mov	[edx+8], eax
		jmp	short loc_410C16
; ---------------------------------------------------------------------------

loc_410C0B:				; CODE XREF: sub_410BE0+4Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_410B73

loc_410C16:				; CODE XREF: sub_410BE0+29j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_410C2F
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_410BBA
		test	eax, eax
		jz	short loc_410C0B

locret_410C2F:				; CODE XREF: sub_410BE0+3Ej
		leave
		retn
sub_410BE0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410C31(char *, int)
sub_410C31	proc near		; CODE XREF: sub_411FE1+9Cp
					; sub_411FE1+D1p

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 0
		jnz	short loc_410C4B
		mov	[ebp+arg_4], 185h

loc_410C4B:				; CODE XREF: sub_410C31+11j
		mov	eax, ds:dword_436010
		mov	[ebp+var_C], eax
		jmp	short loc_410C8B
; ---------------------------------------------------------------------------

loc_410C55:				; CODE XREF: sub_410C31+5Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Str2],	edx ; Str2
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_410C7D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		cmp	eax, [ebp+arg_4]
		jz	loc_410D72

loc_410C7D:				; CODE XREF: sub_410C31+3Bj
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_410C8B:				; CODE XREF: sub_410C31+22j
		cmp	[ebp+var_C], 0
		jnz	short loc_410C55
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		jmp	short loc_410CD8
; ---------------------------------------------------------------------------

loc_410C99:				; CODE XREF: sub_410C31+AFj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Str2],	eax ; Val
		mov	[esp+28h+Str1],	offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		call	strchr
		test	eax, eax
		jnz	short loc_410CD4
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Str2],	eax ; char
		mov	[esp+28h+Str1],	offset aInvalidChar0x0 ; "invalid char 0x%02x in host name - not "...
		call	sub_4233B1
		jmp	locret_410D73
; ---------------------------------------------------------------------------

loc_410CD4:				; CODE XREF: sub_410C31+83j
		add	[ebp+var_14], 1

loc_410CD8:				; CODE XREF: sub_410C31+66j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_410C99
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str2],	eax ; char
		mov	[esp+28h+Str1],	offset aAddingSDToTheL ; "adding `%s:%d' to the ldap server list\"...
		call	sub_423387
		mov	[esp+28h+Str2],	1
		mov	[esp+28h+Str1],	1
		call	gcry_calloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_410D3C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+Str1],	eax ; int
		call	strerror
		mov	[esp+28h+Str2],	eax ; char
		mov	[esp+28h+Str1],	offset aMallocFailedS ;	"malloc	failed:	%s\n"
		call	sub_4233B1
		jmp	short locret_410D73
; ---------------------------------------------------------------------------

loc_410D3C:				; CODE XREF: sub_410C31+E6j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+8], edx
		cmp	[ebp+var_10], 0
		jz	short loc_410D68
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	short locret_410D73
; ---------------------------------------------------------------------------

loc_410D68:				; CODE XREF: sub_410C31+12Bj
		mov	eax, [ebp+var_C]
		mov	ds:dword_436010, eax
		jmp	short locret_410D73
; ---------------------------------------------------------------------------

loc_410D72:				; CODE XREF: sub_410C31+46j
		nop

locret_410D73:				; CODE XREF: sub_410C31+9Ej
					; sub_410C31+109j ...
		leave
		retn
sub_410C31	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410D75	proc near		; CODE XREF: sub_411148+42Cp
					; sub_4119CC+2A2p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_410DA2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	sub_421CA0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax ;	HANDLE
		call	sub_421CAA

loc_410DA2:				; CODE XREF: sub_410D75+Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+var_28], eax
		call	ksba_reader_release
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_410DD4
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	pth_close
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_410DD4:				; CODE XREF: sub_410D75+48j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jz	short loc_410DF8
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_close
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFFh

loc_410DF8:				; CODE XREF: sub_410D75+6Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_410E18
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_event_free

loc_410E18:				; CODE XREF: sub_410D75+8Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		leave
		retn
sub_410D75	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410E33(int, char *)
sub_410E33	proc near		; CODE XREF: sub_41102A+89p
					; sub_41102A+F5p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_4], 0
		jnz	loc_410EF0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	loc_411023
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		test	eax, eax
		jz	loc_411023
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aS_0 ; "%s\n"
		call	sub_423387
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		jmp	loc_411023
; ---------------------------------------------------------------------------

loc_410E85:				; CODE XREF: sub_410E33+D7j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_410ED4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		test	eax, eax
		jz	short loc_410ED4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aS_1 ; "%s"
		call	sub_423387
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aS_0 ; "%s\n"
		call	sub_423478
		jmp	short loc_410EE7
; ---------------------------------------------------------------------------

loc_410ED4:				; CODE XREF: sub_410E33+60j
					; sub_410E33+6Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aS_0 ; "%s\n"
		call	sub_423387

loc_410EE7:				; CODE XREF: sub_410E33+9Fj
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+arg_4], eax

loc_410EF0:				; CODE XREF: sub_410E33+Bj
		mov	[esp+38h+Val], 0Ah ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_410E85
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_411024
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		add	eax, [ebp+var_10]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		cmp	edx, eax
		jb	loc_410FD9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	edx, [ebp+var_10]
		add	edx, 0FFh
		mov	dl, 0
		add	eax, edx
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_410F90
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax
		call	gcry_realloc
		jmp	short loc_410F9B
; ---------------------------------------------------------------------------

loc_410F90:				; CODE XREF: sub_410E33+144j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax
		call	gcry_malloc

loc_410F9B:				; CODE XREF: sub_410E33+15Bj
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_410FC7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+Str], eax ; int
		call	strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aErrorPrintingL ;	"error printing	log line: %s\n"
		call	sub_4233B1
		jmp	short loc_411024
; ---------------------------------------------------------------------------

loc_410FC7:				; CODE XREF: sub_410E33+16Fj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+2Ch], edx

loc_410FD9:				; CODE XREF: sub_410E33+11Dj
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		add	eax, ecx
		mov	ecx, [ebp+var_10]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Val], edx ; Src
		mov	[esp+38h+Str], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		add	eax, edx
		mov	byte ptr [eax],	0
		jmp	short loc_411024
; ---------------------------------------------------------------------------

loc_411023:				; CODE XREF: sub_410E33+19j
					; sub_410E33+27j ...
		nop

loc_411024:				; CODE XREF: sub_410E33+103j
					; sub_410E33+192j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_410E33	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41102A	proc near		; CODE XREF: sub_411148+1B0p

var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_110		= byte ptr -110h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 128h

loc_411033:				; CODE XREF: sub_41102A+3Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+128h+var_120], 0FFh
		lea	edx, [ebp+var_110]
		mov	[esp+128h+var_124], edx
		mov	[esp+128h+var_128], eax
		call	pth_read
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_41106A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_411033

loc_41106A:				; CODE XREF: sub_41102A+30j
		cmp	[ebp+var_C], 0
		jg	loc_411103
		cmp	[ebp+var_C], 0
		jns	short loc_4110A5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+128h+var_128], eax	; int
		call	strerror
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+4]
		mov	[esp+128h+var_120], eax
		mov	[esp+128h+var_124], edx	; char
		mov	[esp+128h+var_128], offset aErrorReadingLo ; "error reading log	from ldap wrapper %d:"...
		call	sub_4233B1

loc_4110A5:				; CODE XREF: sub_41102A+4Ej
		mov	[esp+128h+var_124], 0 ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+128h+var_128], eax	; int
		call	sub_410E33
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jz	short loc_4110DC
		mov	eax, [ebp+var_10]
		mov	[esp+128h+var_128], eax
		call	pth_close
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFFh

loc_4110DC:				; CODE XREF: sub_41102A+9Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+128h+var_124], 0
		mov	[esp+128h+var_128], eax
		call	pth_event_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, 1
		jmp	short locret_411146
; ---------------------------------------------------------------------------

loc_411103:				; CODE XREF: sub_41102A+44j
		lea	eax, [ebp+var_110]
		add	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_110]
		mov	[esp+128h+var_124], eax	; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+128h+var_128], eax	; int
		call	sub_410E33
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_411141
		mov	[esp+128h+var_128], 0
		call	sub_429850
		mov	edx, [ebp+arg_0]
		mov	[edx+34h], eax

loc_411141:				; CODE XREF: sub_41102A+103j
		mov	eax, 0

locret_411146:				; CODE XREF: sub_41102A+D7j
		leave
		retn
sub_41102A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_411148	proc near		; DATA XREF: sub_401AE7+7Eo

var_88		= dword	ptr -88h
var_84		= byte ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch

loc_411151:				; CODE XREF: sub_411148+447j
					; sub_411148:loc_411594j
		mov	[ebp+var_2C], 0
		mov	dword ptr [esp+88h+var_84], 0
		mov	[esp+88h+var_88], 1
		call	pth_timeout
		mov	dword ptr [esp+88h+var_84], eax
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+var_88], 10h
		call	pth_event
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_4111BB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+var_88], eax ;	int
		call	strerror
		mov	dword ptr [esp+88h+var_84], eax	; char
		mov	[esp+88h+var_88], offset aPth_eventFaile ; "pth_event failed: %s\n"
		call	sub_4233B1
		mov	[esp+88h+var_88], 0Ah
		call	pth_sleep
		jmp	loc_411594
; ---------------------------------------------------------------------------

loc_4111BB:				; CODE XREF: sub_411148+3Fj
		mov	eax, ds:dword_435620
		mov	dword ptr [ebp+var_20],	eax
		jmp	short loc_411203
; ---------------------------------------------------------------------------

loc_4111C5:				; CODE XREF: sub_411148+BFj
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+14h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4111FB
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+18h]
		mov	[esp+88h+var_88], eax
		call	pth_event_isolate
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+18h]
		mov	[esp+88h+var_80], 0
		mov	dword ptr [esp+88h+var_84], eax
		mov	eax, [ebp+var_30]
		mov	[esp+88h+var_88], eax
		call	pth_event_concat

loc_4111FB:				; CODE XREF: sub_411148+86j
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax]
		mov	dword ptr [ebp+var_20],	eax

loc_411203:				; CODE XREF: sub_411148+7Bj
		cmp	dword ptr [ebp+var_20],	0
		jnz	short loc_4111C5
		mov	eax, [ebp+var_30]
		mov	[esp+88h+var_88], eax
		call	pth_wait
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jns	short loc_411262
		mov	dword ptr [esp+88h+var_84], 0
		mov	eax, [ebp+var_30]
		mov	[esp+88h+var_88], eax
		call	pth_event_free
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+var_88], eax ;	int
		call	strerror
		mov	dword ptr [esp+88h+var_84], eax	; char
		mov	[esp+88h+var_88], offset aPth_waitFailed ; "pth_wait failed: %s\n"
		call	sub_4233B1
		mov	[esp+88h+var_88], 0Ah
		call	pth_sleep
		jmp	loc_411594
; ---------------------------------------------------------------------------

loc_411262:				; CODE XREF: sub_411148+D3j
		mov	eax, [ebp+var_30]
		mov	[esp+88h+var_88], eax
		call	pth_event_status
		cmp	eax, 1
		jnz	short loc_411276
		sub	[ebp+var_1C], 1

loc_411276:				; CODE XREF: sub_411148+128j
		mov	dword ptr [esp+88h+var_84], 0
		mov	eax, [ebp+var_30]
		mov	[esp+88h+var_88], eax
		call	pth_event_free
		mov	[esp+88h+var_88], 0
		call	sub_429850
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	edx, ds:dword_43600C
		add	edx, 12Ch
		cmp	eax, edx
		jbe	short loc_4112C1
		mov	edx, [ebp+var_28]
		mov	eax, ds:dword_43600C
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		sub	eax, 12Ch
		mov	[ebp+var_28], eax

loc_4112C1:				; CODE XREF: sub_411148+161j
		mov	eax, ds:dword_435620
		mov	dword ptr [ebp+var_20],	eax
		jmp	loc_411450
; ---------------------------------------------------------------------------

loc_4112CE:				; CODE XREF: sub_411148+30Cj
		cmp	[ebp+var_1C], 0
		jz	short loc_411308
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+14h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_411308
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+18h]
		mov	[esp+88h+var_88], eax
		call	pth_event_status
		cmp	eax, 1
		jnz	short loc_411308
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+88h+var_88], eax
		call	sub_41102A
		test	eax, eax
		jz	short loc_411308
		mov	[ebp+var_2C], 1

loc_411308:				; CODE XREF: sub_411148+18Aj
					; sub_411148+195j ...
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	loc_4113CA
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_3C]
		mov	[esp+88h+var_80], edx
		mov	dword ptr [esp+88h+var_84], 0
		mov	[esp+88h+var_88], eax
		call	sub_421B43
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_41138E
		mov	eax, dword ptr [ebp+var_20]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_3C]
		cmp	eax, 0Ah
		jnz	short loc_411352
		mov	eax, offset aLdapWrapperDRe ; "ldap wrapper %d ready: timeout\n"
		jmp	short loc_411357
; ---------------------------------------------------------------------------

loc_411352:				; CODE XREF: sub_411148+201j
		mov	eax, offset aLdapWrapperD_0 ; "ldap wrapper %d ready"

loc_411357:				; CODE XREF: sub_411148+208j
		mov	dword ptr [esp+88h+var_84], edx	; char
		mov	[esp+88h+var_88], eax ;	char *
		call	sub_423387
		mov	eax, dword ptr [ebp+var_20]
		mov	dword ptr [eax+20h], 1
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+4]
		mov	[esp+88h+var_88], eax ;	HANDLE
		call	sub_421CAA
		mov	eax, dword ptr [ebp+var_20]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	[ebp+var_2C], 1
		jmp	short loc_4113CA
; ---------------------------------------------------------------------------

loc_41138E:				; CODE XREF: sub_411148+1F3j
		mov	eax, [ebp+var_34]
		mov	[esp+88h+var_88], eax
		call	sub_410B36
		cmp	eax, 3Eh
		jz	short loc_4113CA
		mov	eax, [ebp+var_34]
		mov	[esp+88h+var_88], eax
		call	gpg_strerror
		mov	edx, dword ptr [ebp+var_20]
		mov	edx, [edx+4]
		mov	[esp+88h+var_80], eax
		mov	dword ptr [esp+88h+var_84], edx	; char
		mov	[esp+88h+var_88], offset aWaitingForLdap ; "waiting for	ldap wrapper %d	failed:	%s\"...
		call	sub_4233B1
		mov	[ebp+var_2C], 1

loc_4113CA:				; CODE XREF: sub_411148+1C9j
					; sub_411148+244j ...
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_411448
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+34h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_411448
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+34h]
		cmp	eax, [ebp+var_28]
		jge	short loc_411448
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+4]
		mov	[esp+88h+var_88], eax
		call	sub_421CA0
		test	eax, eax
		jnz	short loc_411407
		mov	eax, dword ptr [ebp+var_20]
		mov	dword ptr [eax+34h], 0FFFFFFFFh

loc_411407:				; CODE XREF: sub_411148+2B3j
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+4]
		mov	dword ptr [esp+88h+var_84], eax	; char
		mov	[esp+88h+var_88], offset aLdapWrapperDSt ; "ldap wrapper %d stalled - killing\n"
		call	sub_423387
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+14h]
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jz	short loc_411441
		mov	eax, [ebp+var_38]
		mov	[esp+88h+var_88], eax
		call	pth_close
		mov	eax, dword ptr [ebp+var_20]
		mov	dword ptr [eax+14h], 0FFFFFFFFh

loc_411441:				; CODE XREF: sub_411148+2E2j
		mov	[ebp+var_2C], 1

loc_411448:				; CODE XREF: sub_411148+28Bj
					; sub_411148+296j ...
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax]
		mov	dword ptr [ebp+var_20],	eax

loc_411450:				; CODE XREF: sub_411148+181j
		cmp	dword ptr [ebp+var_20],	0
		jnz	loc_4112CE
		cmp	[ebp+var_2C], 0
		jz	loc_411519
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	loc_411519
		mov	[esp+88h+var_88], offset aLdapWorkerStat ; "ldap worker	stati:\n"
		call	sub_423387
		mov	eax, ds:dword_435620
		mov	dword ptr [ebp+var_20],	eax
		jmp	loc_41150F
; ---------------------------------------------------------------------------

loc_41148D:				; CODE XREF: sub_411148+3CBj
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+20h]
		mov	[ebp+var_4C], eax
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+34h]
		mov	edi, eax
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_4114B2
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+1Ch]
		mov	edx, [eax]
		jmp	short loc_4114B7
; ---------------------------------------------------------------------------

loc_4114B2:				; CODE XREF: sub_411148+35Ej
		mov	edx, 0

loc_4114B7:				; CODE XREF: sub_411148+368j
		mov	eax, dword ptr [ebp+var_20]
		mov	esi, [eax+1Ch]
		mov	eax, dword ptr [ebp+var_20]
		mov	ebx, [eax+24h]
		mov	eax, dword ptr [ebp+var_20]
		mov	ecx, [eax+8]
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+4]
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+88h+var_68], eax
		mov	[esp+88h+var_6C], edi
		mov	[esp+88h+var_70], edx
		mov	[esp+88h+var_74], esi
		mov	[esp+88h+var_78], ebx
		mov	[esp+88h+var_7C], ecx
		mov	ecx, [ebp+var_50]
		mov	[esp+88h+var_80], ecx
		mov	eax, dword ptr [ebp+var_20]
		mov	dword ptr [esp+88h+var_84], eax	; char
		mov	[esp+88h+var_88], offset aCPPidDDRdrPCtr ; "  c=%p pid=%d/%d rdr=%p ctrl=%p/%d la=%"...
		call	sub_423387
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax]
		mov	dword ptr [ebp+var_20],	eax

loc_41150F:				; CODE XREF: sub_411148+340j
		cmp	dword ptr [ebp+var_20],	0
		jnz	loc_41148D

loc_411519:				; CODE XREF: sub_411148+316j
					; sub_411148+326j ...
		mov	[ebp+var_24], 0
		mov	eax, ds:dword_435620
		mov	dword ptr [ebp+var_20],	eax
		jmp	short loc_411589
; ---------------------------------------------------------------------------

loc_41152A:				; CODE XREF: sub_411148+445j
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_41157B
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+14h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_411549
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_411552

loc_411549:				; CODE XREF: sub_411148+3F5j
		mov	eax, ds:dword_435624
		test	eax, eax
		jz	short loc_41157B

loc_411552:				; CODE XREF: sub_411148+3FFj
		cmp	[ebp+var_24], 0
		jz	short loc_411564
		mov	eax, dword ptr [ebp+var_20]
		mov	edx, [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], edx
		jmp	short loc_41156E
; ---------------------------------------------------------------------------

loc_411564:				; CODE XREF: sub_411148+40Ej
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax]
		mov	ds:dword_435620, eax

loc_41156E:				; CODE XREF: sub_411148+41Aj
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+88h+var_88], eax
		call	sub_410D75
		jmp	short loc_411519
; ---------------------------------------------------------------------------

loc_41157B:				; CODE XREF: sub_411148+3EAj
					; sub_411148+408j
		mov	eax, dword ptr [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, [eax]
		mov	dword ptr [ebp+var_20],	eax

loc_411589:				; CODE XREF: sub_411148+3E0j
		cmp	dword ptr [ebp+var_20],	0
		jnz	short loc_41152A
		jmp	loc_411151
; ---------------------------------------------------------------------------

loc_411594:				; CODE XREF: sub_411148+6Ej
					; sub_411148+115j
		jmp	loc_411151
sub_411148	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411599	proc near		; CODE XREF: sub_401BB9+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	ds:dword_435624, 1
		jmp	short loc_4115B7
; ---------------------------------------------------------------------------

loc_4115AB:				; CODE XREF: sub_411599+25j
		mov	[esp+18h+var_18], 0
		call	pth_yield

loc_4115B7:				; CODE XREF: sub_411599+10j
		mov	eax, ds:dword_435620
		test	eax, eax
		jnz	short loc_4115AB
		leave
		retn
sub_411599	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4115C2	proc near		; CODE XREF: sub_40C08C+12Fp
					; sub_40C1C5+65p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		cmp	[ebp+arg_0], 0
		jz	loc_4116EB
		mov	eax, ds:dword_435620
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_4116DF
; ---------------------------------------------------------------------------

loc_4115E1:				; CODE XREF: sub_4115C2+121j
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [eax+24h]
		cmp	eax, [ebp+arg_0]
		jnz	loc_4116D7
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_411654
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_411610
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		jmp	short loc_411615
; ---------------------------------------------------------------------------

loc_411610:				; CODE XREF: sub_4115C2+42j
		mov	eax, 0

loc_411615:				; CODE XREF: sub_4115C2+4Cj
		mov	edx, dword ptr [ebp+var_C]
		mov	esi, [edx+1Ch]
		mov	edx, dword ptr [ebp+var_C]
		mov	ebx, [edx+24h]
		mov	edx, dword ptr [ebp+var_C]
		mov	ecx, [edx+8]
		mov	edx, dword ptr [ebp+var_C]
		mov	edx, [edx+4]
		mov	[esp+38h+var_20], eax
		mov	[esp+38h+var_24], esi
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aReleasingLdapW ; "releasing ldap worker c=%p pid=%d/%d rd"...
		call	sub_423387

loc_411654:				; CODE XREF: sub_4115C2+38j
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [eax+24h], 0
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jz	short loc_411682
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	pth_close
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_411682:				; CODE XREF: sub_4115C2+A9j
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_4116A3
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [eax+1Ch]
		mov	edx, [eax]
		sub	edx, 1
		mov	[eax], edx
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [eax+1Ch], 0

loc_4116A3:				; CODE XREF: sub_4115C2+C8j
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_4116EE
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [eax+10h]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	edx, dword ptr [ebp+var_C]
		mov	edx, [edx+8]
		mov	[esp+38h+var_30], eax
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], offset aReadingFromLda ; "reading from ldap wrapper %d failed: %s"...
		call	sub_423387
		jmp	short loc_4116EE
; ---------------------------------------------------------------------------

loc_4116D7:				; CODE XREF: sub_4115C2+28j
		mov	eax, dword ptr [ebp+var_C]
		mov	eax, [eax]
		mov	dword ptr [ebp+var_C], eax

loc_4116DF:				; CODE XREF: sub_4115C2+1Aj
		cmp	dword ptr [ebp+var_C], 0
		jnz	loc_4115E1
		jmp	short loc_4116EF
; ---------------------------------------------------------------------------

loc_4116EB:				; CODE XREF: sub_4115C2+Cj
		nop
		jmp	short loc_4116EF
; ---------------------------------------------------------------------------

loc_4116EE:				; CODE XREF: sub_4115C2+E9j
					; sub_4115C2+113j
		nop

loc_4116EF:				; CODE XREF: sub_4115C2+127j
					; sub_4115C2+12Aj
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4115C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4116F6	proc near		; CODE XREF: sub_406596+341p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_435620
		mov	[ebp+var_C], eax
		jmp	short loc_411785
; ---------------------------------------------------------------------------

loc_411706:				; CODE XREF: sub_4116F6+93j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_41177D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+1Ch]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_41177D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+1Ch]
		mov	edx, [eax]
		sub	edx, 1
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41174B
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	sub_421CA0

loc_41174B:				; CODE XREF: sub_4116F6+45j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_41177D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	edx, [ebp+var_C]
		mov	edx, [edx+8]
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+var_28], offset aReadingFromLda ; "reading from ldap wrapper %d failed: %s"...
		call	sub_423387

loc_41177D:				; CODE XREF: sub_4116F6+18j
					; sub_4116F6+23j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_411785:				; CODE XREF: sub_4116F6+Ej
		cmp	[ebp+var_C], 0
		jnz	loc_411706
		leave
		retn
sub_4116F6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411791	proc near		; DATA XREF: sub_4119CC+268o

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_4117BF
		cmp	[ebp+arg_8], 0
		jnz	short loc_4117BF
		cmp	[ebp+arg_C], 0
		jnz	short loc_4117BF
		mov	eax, 0FFFFFFFFh
		jmp	locret_4119CA
; ---------------------------------------------------------------------------

loc_4117BF:				; CODE XREF: sub_411791+16j
					; sub_411791+1Cj ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_4117D8
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jnz	loc_4119AB

loc_4117D8:				; CODE XREF: sub_411791+36j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	locret_4119CA
; ---------------------------------------------------------------------------

loc_4117EB:				; CODE XREF: sub_411791+21Ej
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], 1
		call	pth_timeout
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+var_38], 10h
		call	pth_event
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_18]
		mov	[esp+38h+var_2C], edx
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	pth_read_ev
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	loc_4118D1
		cmp	[ebp+var_18], 0
		jz	loc_4118D1
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_4118D1
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		mov	[esp+38h+var_38], eax
		call	sub_406A20
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_411963
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_1C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	short loc_4118AE
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	pth_close
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_4118AE:				; CODE XREF: sub_411791+106j
		cmp	[ebp+var_18], 0
		jz	short loc_4118C7
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	pth_event_free

loc_4118C7:				; CODE XREF: sub_411791+121j
		mov	eax, 0FFFFFFFFh
		jmp	locret_4119CA
; ---------------------------------------------------------------------------

loc_4118D1:				; CODE XREF: sub_411791+AFj
					; sub_411791+B9j ...
		cmp	[ebp+var_10], 0
		jns	short loc_411935
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax
		call	sub_410B43
		mov	edx, [ebp+var_14]
		mov	[edx+10h], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0FFFFFFFFh
		jz	short loc_411912
		mov	eax, [ebp+var_24]
		mov	[esp+38h+var_38], eax
		call	pth_close
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_411912:				; CODE XREF: sub_411791+16Aj
		cmp	[ebp+var_18], 0
		jz	short loc_41192B
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	pth_event_free

loc_41192B:				; CODE XREF: sub_411791+185j
		mov	eax, 0FFFFFFFFh
		jmp	locret_4119CA
; ---------------------------------------------------------------------------

loc_411935:				; CODE XREF: sub_411791+144j
		cmp	[ebp+var_10], 0
		jnz	short loc_411963
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnz	short loc_4119B7
		cmp	[ebp+var_18], 0
		jz	short loc_41195C
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	pth_event_free

loc_41195C:				; CODE XREF: sub_411791+1B6j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4119CA
; ---------------------------------------------------------------------------

loc_411963:				; CODE XREF: sub_411791+EAj
					; sub_411791+1A8j
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		add	[ebp+arg_4], eax
		cmp	[ebp+var_18], 0
		jz	short loc_411988
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	pth_event_free

loc_411988:				; CODE XREF: sub_411791+1E2j
		cmp	[ebp+var_10], 0
		jle	short loc_4119AB
		mov	eax, [ebp+var_14]
		mov	eax, [eax+34h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4119AB
		mov	[esp+38h+var_38], 0
		call	sub_429850
		mov	edx, [ebp+var_14]
		mov	[edx+34h], eax

loc_4119AB:				; CODE XREF: sub_411791+41j
					; sub_411791+1FBj ...
		cmp	[ebp+var_C], 0
		jnz	loc_4117EB
		jmp	short loc_4119B8
; ---------------------------------------------------------------------------

loc_4119B7:				; CODE XREF: sub_411791+1B0j
		nop

loc_4119B8:				; CODE XREF: sub_411791+224j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		sub	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, 0

locret_4119CA:				; CODE XREF: sub_411791+29j
					; sub_411791+55j ...
		leave
		retn
sub_411791	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4119CC	proc near		; CODE XREF: sub_411D68+272p
					; sub_41290B+342p

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2D		= byte ptr -2Dh
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
lpApplicationName= dword ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_435FC4
		test	eax, eax
		jz	short loc_4119F0
		mov	eax, ds:dword_435FC4
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4119FA

loc_4119F0:				; CODE XREF: sub_4119CC+16j
		call	sub_422318
		mov	[ebp+lpApplicationName], eax
		jmp	short loc_411A02
; ---------------------------------------------------------------------------

loc_4119FA:				; CODE XREF: sub_4119CC+22j
		mov	eax, ds:dword_435FC4
		mov	[ebp+lpApplicationName], eax

loc_411A02:				; CODE XREF: sub_4119CC+2Cj
		mov	[ebp+var_10], 0
		jmp	short loc_411A0F
; ---------------------------------------------------------------------------

loc_411A0B:				; CODE XREF: sub_4119CC+50j
		add	[ebp+var_10], 1

loc_411A0F:				; CODE XREF: sub_4119CC+3Dj
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_411A0B
		mov	eax, [ebp+var_10]
		add	eax, 2
		mov	[esp+58h+Str2],	4
		mov	[esp+58h+Str1],	eax
		call	gcry_xcalloc
		mov	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		jmp	loc_411ACA
; ---------------------------------------------------------------------------

loc_411A49:				; CODE XREF: sub_4119CC+10Bj
		cmp	[ebp+var_10], 0
		jnz	short loc_411AAC
		mov	eax, [ebp+var_10]
		add	eax, 1
		shl	eax, 2
		add	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_411AAC
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+58h+Str2],	offset aPass ; "--pass"
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_411AAC
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	dword ptr [eax], offset	aEnvPass ; "--env-pass"
		mov	eax, [ebp+arg_8]
		add	eax, 4
		mov	eax, [eax]
		mov	[esp+58h+Str2],	eax ; lpValue
		mov	[esp+58h+Str1],	offset Name ; "DIRMNGR_LDAP_PASS"
		mov	eax, ds:SetEnvironmentVariableA
		call	eax ; SetEnvironmentVariableA
		sub	esp, 8
		add	[ebp+var_10], 1
		jmp	short loc_411AC2
; ---------------------------------------------------------------------------

loc_411AAC:				; CODE XREF: sub_4119CC+81j
					; sub_4119CC+93j ...
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	edx, [ebp+arg_8]
		mov	edx, [edx]
		mov	[eax], edx

loc_411AC2:				; CODE XREF: sub_4119CC+DEj
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1

loc_411ACA:				; CODE XREF: sub_4119CC+78j
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_411A49
		mov	[esp+58h+Str2],	38h
		mov	[esp+58h+Str1],	1
		call	gcry_calloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_411B42
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_410B43
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax ; int
		call	strerror
		mov	[esp+58h+Str2],	eax ; char
		mov	[esp+58h+Str1],	offset aErrorAllocatin ; "error	allocating memory: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	locret_411D66
; ---------------------------------------------------------------------------

loc_411B42:				; CODE XREF: sub_4119CC+12Cj
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_48], eax ;	int
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_4C], eax ;	int
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_50], eax ;	int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str2],	eax ; int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+58h+Str1],	eax ; lpApplicationName
		call	sub_4216D5
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_411B90
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	locret_411D66
; ---------------------------------------------------------------------------

loc_411B90:				; CODE XREF: sub_4119CC+1AFj
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	[eax+4], edx
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	[eax+8], edx
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_20]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Str2],	eax
		mov	[esp+58h+Str1],	1002h
		call	pth_event
		mov	edx, [ebp+var_20]
		mov	[edx+18h], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	short loc_411BEC
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		call	sub_410B5E
		jmp	locret_411D66
; ---------------------------------------------------------------------------

loc_411BEC:				; CODE XREF: sub_4119CC+209j
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[esp+58h+Str1],	0
		call	sub_429850
		mov	edx, [ebp+var_20]
		mov	[edx+34h], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str1],	eax
		call	ksba_reader_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_411C47
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Str2],	offset sub_411791
		mov	[esp+58h+Str1],	eax
		call	ksba_reader_set_cb
		mov	[ebp+var_C], eax

loc_411C47:				; CODE XREF: sub_4119CC+25Aj
		cmp	[ebp+var_C], 0
		jz	short loc_411C91
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str1],	eax
		call	gpg_strerror
		mov	[esp+58h+Str2],	eax ; char
		mov	[esp+58h+Str1],	offset aErrorInitial_2 ; "error	initializing reader object: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str1],	eax
		call	sub_410D75
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	ksba_reader_release
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		jmp	locret_411D66
; ---------------------------------------------------------------------------

loc_411C91:				; CODE XREF: sub_4119CC+27Fj
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_20]
		mov	[eax+24h], edx
		mov	edx, ds:dword_435620
		mov	eax, [ebp+var_20]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	ds:dword_435620, eax
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_411CD8
		mov	eax, [ebp+var_20]
		mov	edx, [eax+24h]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+4]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Str2],	eax ; char
		mov	[esp+58h+Str1],	offset aLdapWrapperD_1 ; "ldap wrapper %d started (reader %p)\n"
		call	sub_423387

loc_411CD8:				; CODE XREF: sub_4119CC+2EAj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+58h+var_50], 1
		lea	edx, [ebp+var_2D]
		mov	[esp+58h+Str2],	edx
		mov	[esp+58h+Str1],	eax
		call	sub_412C76
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_411D45
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_4115C2
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	ksba_reader_release
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str1],	eax
		call	sub_410B36
		cmp	eax, 3FFFh
		jnz	short loc_411D40
		mov	[esp+58h+Str1],	3Ah
		call	sub_410B1B
		jmp	short locret_411D66
; ---------------------------------------------------------------------------

loc_411D40:				; CODE XREF: sub_4119CC+364j
		mov	eax, [ebp+var_C]
		jmp	short locret_411D66
; ---------------------------------------------------------------------------

loc_411D45:				; CODE XREF: sub_4119CC+32Fj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+58h+var_50], 1
		lea	edx, [ebp+var_2D]
		mov	[esp+58h+Str2],	edx
		mov	[esp+58h+Str1],	eax
		call	ksba_reader_unread
		mov	eax, 0

locret_411D66:				; CODE XREF: sub_4119CC+171j
					; sub_4119CC+1BFj ...
		leave
		retn
sub_4119CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411D68	proc near		; CODE XREF: sub_411FE1+69p
					; sub_411FE1+19Ep ...

Dest		= dword	ptr -0F8h
Format		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_E8		= byte ptr -0E8h
var_CA		= byte ptr -0CAh
var_AC		= dword	ptr -0ACh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h
arg_2C		= dword	ptr  34h
arg_30		= dword	ptr  38h

		push	ebp
		mov	ebp, esp
		sub	esp, 0F8h
		mov	eax, [ebp+arg_30]
		mov	dword ptr [eax], 0
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_1C], 0
		jz	short loc_411DAA
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aPass ; "--pass"
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[ebp+eax*4+var_AC], edx
		add	[ebp+var_C], 1

loc_411DAA:				; CODE XREF: sub_411D68+1Dj
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_411DC5
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aVv ; "-vv"
		add	[ebp+var_C], 1

loc_411DC5:				; CODE XREF: sub_411D68+49j
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aLogWithPid ; "--log-with-pid"
		add	[ebp+var_C], 1
		cmp	[ebp+arg_8], 0
		jz	short loc_411DEF
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aMulti ; "--multi"
		add	[ebp+var_C], 1

loc_411DEF:				; CODE XREF: sub_411D68+73j
		mov	eax, ds:dword_43600C
		test	eax, eax
		jz	short loc_411E57
		mov	edx, ds:dword_43600C
		mov	eax, offset aU_0 ; "%u"
		mov	[esp+0F8h+var_F0], edx
		mov	[esp+0F8h+Format], eax ; Format
		lea	eax, [ebp+var_E8]
		mov	[esp+0F8h+Dest], eax ; Dest
		call	sprintf
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aTimeout ; "--timeout"
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		lea	edx, [ebp+var_E8]
		mov	[ebp+eax*4+var_AC], edx
		add	[ebp+var_C], 1
		cmp	[ebp+arg_4], 0
		jz	short loc_411E57
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aOnlySearchTime ; "--only-search-timeout"
		add	[ebp+var_C], 1

loc_411E57:				; CODE XREF: sub_411D68+8Ej
					; sub_411D68+DBj
		cmp	[ebp+arg_C], 0
		jz	short loc_411E80
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aProxy ; "--proxy"
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_C]
		mov	[ebp+eax*4+var_AC], edx
		add	[ebp+var_C], 1

loc_411E80:				; CODE XREF: sub_411D68+F3j
		cmp	[ebp+arg_10], 0
		jz	short loc_411EA9
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aHost ; "--host"
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_10]
		mov	[ebp+eax*4+var_AC], edx
		add	[ebp+var_C], 1

loc_411EA9:				; CODE XREF: sub_411D68+11Cj
		cmp	[ebp+arg_14], 0
		jz	short loc_411EF3
		mov	eax, offset aD_0 ; "%d"
		mov	edx, [ebp+arg_14]
		mov	[esp+0F8h+var_F0], edx
		mov	[esp+0F8h+Format], eax ; Format
		lea	eax, [ebp+var_CA]
		mov	[esp+0F8h+Dest], eax ; Dest
		call	sprintf
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aPort ; "--port"
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		lea	edx, [ebp+var_CA]
		mov	[ebp+eax*4+var_AC], edx
		add	[ebp+var_C], 1

loc_411EF3:				; CODE XREF: sub_411D68+145j
		cmp	[ebp+arg_18], 0
		jz	short loc_411F1C
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aUser ; "--user"
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_18]
		mov	[ebp+eax*4+var_AC], edx
		add	[ebp+var_C], 1

loc_411F1C:				; CODE XREF: sub_411D68+18Fj
		cmp	[ebp+arg_20], 0
		jz	short loc_411F45
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aDn ; "--dn"
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_20]
		mov	[ebp+eax*4+var_AC], edx
		add	[ebp+var_C], 1

loc_411F45:				; CODE XREF: sub_411D68+1B8j
		cmp	[ebp+arg_24], 0
		jz	short loc_411F6E
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aFilter ; "--filter"
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_24]
		mov	[ebp+eax*4+var_AC], edx
		add	[ebp+var_C], 1

loc_411F6E:				; CODE XREF: sub_411D68+1E1j
		cmp	[ebp+arg_28], 0
		jz	short loc_411F97
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], offset aAttr ; "--attr"
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_28]
		mov	[ebp+eax*4+var_AC], edx
		add	[ebp+var_C], 1

loc_411F97:				; CODE XREF: sub_411D68+20Aj
		cmp	[ebp+arg_2C], 0
		jz	short loc_411FA2
		mov	eax, [ebp+arg_2C]
		jmp	short loc_411FA7
; ---------------------------------------------------------------------------

loc_411FA2:				; CODE XREF: sub_411D68+233j
		mov	eax, offset aLdap_1 ; "ldap://"

loc_411FA7:				; CODE XREF: sub_411D68+238j
		mov	edx, [ebp+var_C]
		mov	[ebp+edx*4+var_AC], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_AC], 0
		lea	eax, [ebp+var_AC]
		mov	[esp+0F8h+var_F0], eax
		mov	eax, [ebp+arg_30]
		mov	[esp+0F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+Dest], eax
		call	sub_4119CC
		leave
		retn
sub_411D68	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411FE1(int, int, char	*, char, int)
sub_411FE1	proc near		; CODE XREF: sub_40B9E4+49Ap
					; sub_40C08C+51p

var_68		= dword	ptr -68h
var_64		= byte ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= byte ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	edx, dword ptr [ebp+arg_C]
		mov	eax, ds:dword_435FEC
		mov	ecx, [ebp+arg_10]
		mov	[esp+68h+var_38], ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+68h+var_3C], ecx
		mov	[esp+68h+var_40], 0
		mov	[esp+68h+var_44], 0
		mov	[esp+68h+var_48], 0
		mov	[esp+68h+var_4C], 0
		mov	[esp+68h+var_50], 0
		mov	[esp+68h+var_54], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+68h+var_58], edx
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], 0
		mov	dword ptr [esp+68h+var_64], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_411D68
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4120C2
		mov	eax, ds:dword_436014
		test	eax, eax
		jz	short loc_4120C2
		mov	eax, ds:dword_435FEC
		test	eax, eax
		jnz	short loc_4120C2
		cmp	[ebp+arg_8], 0
		jz	short loc_412084
		mov	eax, dword ptr [ebp+arg_C]
		mov	dword ptr [esp+68h+var_64], eax	; int
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+var_68], eax ;	char *
		call	sub_410C31
		jmp	short loc_4120C2
; ---------------------------------------------------------------------------

loc_412084:				; CODE XREF: sub_411FE1+8Dj
		cmp	[ebp+arg_4], 0
		jz	short loc_4120C2
		lea	eax, [ebp+arg_C]
		mov	dword ptr [esp+68h+var_64], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+var_68], eax
		call	sub_417136
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4120C2
		mov	eax, dword ptr [ebp+arg_C]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax ;	char *
		call	sub_410C31
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax
		call	gcry_free

loc_4120C2:				; CODE XREF: sub_411FE1+75j
					; sub_411FE1+7Ej ...
		cmp	[ebp+var_C], 0
		jz	loc_4121B4
		mov	eax, ds:dword_435FEC
		test	eax, eax
		jz	short loc_4120E2
		mov	eax, ds:dword_435FF0
		test	eax, eax
		jnz	loc_4121B4

loc_4120E2:				; CODE XREF: sub_411FE1+F2j
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_4120FA
		mov	[esp+68h+var_68], offset aNoHostnameInUr ; "no hostname	in URL or query	failed;	try"...
		call	sub_42344E

loc_4120FA:				; CODE XREF: sub_411FE1+10Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+68h+var_64], eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+var_68], eax
		call	sub_410BE0
		jmp	loc_412198
; ---------------------------------------------------------------------------

loc_412111:				; CODE XREF: sub_411FE1+1CAj
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	ecx, [ebp+arg_10]
		mov	[esp+68h+var_38], ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+68h+var_3C], ecx
		mov	[esp+68h+var_40], 0
		mov	[esp+68h+var_44], 0
		mov	[esp+68h+var_48], 0
		mov	[esp+68h+var_4C], 0
		mov	[esp+68h+var_50], 0
		mov	[esp+68h+var_54], edx
		mov	[esp+68h+var_58], eax
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], 0
		mov	dword ptr [esp+68h+var_64], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_411D68
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4121B3
		lea	eax, [ebp+var_20]
		mov	[esp+68h+var_68], eax
		call	sub_410B73

loc_412198:				; CODE XREF: sub_411FE1+12Bj
		cmp	[ebp+var_C], 0
		jz	short loc_4121B4
		lea	eax, [ebp+var_20]
		mov	[esp+68h+var_68], eax
		call	sub_410BBA
		test	eax, eax
		jz	loc_412111
		jmp	short loc_4121B4
; ---------------------------------------------------------------------------

loc_4121B3:				; CODE XREF: sub_411FE1+1AAj
		nop

loc_4121B4:				; CODE XREF: sub_411FE1+E5j
					; sub_411FE1+FBj ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_411FE1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4121B9	proc near		; CODE XREF: sub_40BE9B+4Dp

var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= byte ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	[esp+78h+var_78], 73h
		call	sub_410B1B
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+var_74], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+var_78], eax
		call	sub_410BE0
		jmp	loc_41227C
; ---------------------------------------------------------------------------

loc_4121F1:				; CODE XREF: sub_4121B9+D0j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	esi, [eax+10h]
		mov	eax, [ebp+var_20]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_20]
		mov	ecx, [eax+8]
		mov	eax, [ebp+var_20]
		mov	edx, [eax+4]
		mov	eax, ds:dword_435FEC
		mov	edi, [ebp+arg_C]
		mov	[esp+78h+var_48], edi
		mov	[esp+78h+var_4C], 0
		mov	edi, [ebp+arg_8]
		mov	[esp+78h+var_50], edi
		mov	[esp+78h+var_54], offset aObjectclass ;	"objectClass=*"
		mov	edi, [ebp+arg_4]
		mov	[esp+78h+var_58], edi
		mov	[esp+78h+var_5C], esi
		mov	[esp+78h+var_60], ebx
		mov	[esp+78h+var_64], ecx
		mov	[esp+78h+var_68], edx
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], 0
		mov	[esp+78h+var_74], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+var_78], eax
		call	sub_411D68
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_412291
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+var_78], eax
		call	sub_410B73

loc_41227C:				; CODE XREF: sub_4121B9+33j
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+var_78], eax
		call	sub_410BBA
		test	eax, eax
		jz	loc_4121F1
		jmp	short loc_412292
; ---------------------------------------------------------------------------

loc_412291:				; CODE XREF: sub_4121B9+B6j
		nop

loc_412292:				; CODE XREF: sub_4121B9+D6j
		mov	eax, [ebp+var_1C]
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4121B9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41229D(char *)
sub_41229D	proc near		; CODE XREF: sub_41290B+21Cp

Dest		= dword	ptr -68h
Source		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_3C		= dword	ptr -3Ch
Format		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 2Ah
		jz	loc_412411
		cmp	eax, 2Ah
		jg	short loc_4122D0
		cmp	eax, 23h
		jz	loc_4123F6
		jmp	loc_412415
; ---------------------------------------------------------------------------

loc_4122D0:				; CODE XREF: sub_41229D+23j
		cmp	eax, 2Fh
		jz	loc_41238A
		cmp	eax, 3Ch
		jnz	loc_412415
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 11h
		mov	[esp+68h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	dword ptr [eax], 6C69616Dh
		mov	word ptr [eax+4], 3Dh
		lea	edx, [eax+5]
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Source], eax
		mov	[esp+68h+Dest],	edx
		call	sub_4265EB
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 3Eh
		jnz	short loc_412364
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0

loc_412364:				; CODE XREF: sub_41229D+BBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+8]
		test	al, al
		jnz	loc_4124D0
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Dest],	eax
		call	gcry_free
		mov	[ebp+var_C], 0
		jmp	loc_4124D0
; ---------------------------------------------------------------------------

loc_41238A:				; CODE XREF: sub_41229D+36j
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4124D3
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+68h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 1
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Source], eax ;	Source
		mov	[esp+68h+Dest],	edx ; Dest
		call	strcpy
		jmp	loc_4124D3
; ---------------------------------------------------------------------------

loc_4123F6:				; CODE XREF: sub_41229D+28j
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	loc_4124D6
		add	[ebp+arg_0], 1
		jmp	loc_4124D6
; ---------------------------------------------------------------------------

loc_412411:				; CODE XREF: sub_41229D+1Aj
		add	[ebp+arg_0], 1

loc_412415:				; CODE XREF: sub_41229D+2Ej
					; sub_41229D+3Fj
		mov	dword ptr [ebp+Format],	73287C28h
		mov	[ebp+var_30], 252A3D6Eh
		mov	[ebp+var_2C], 28292A73h
		mov	[ebp+var_28], 6E63287Ch
		mov	[ebp+var_24], 73252A3Dh
		mov	[ebp+var_20], 6D28292Ah
		mov	[ebp+var_1C], 3D6C6961h
		mov	[ebp+var_18], 2A73252Ah
		mov	[ebp+var_14], 292929h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4124D9
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		add	eax, 2Fh
		mov	[esp+68h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_58], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_5C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_60], eax
		lea	eax, [ebp+Format]
		mov	[esp+68h+Source], eax ;	Format
		mov	[esp+68h+Dest],	edx ; Dest
		call	sprintf
		jmp	short loc_4124D9
; ---------------------------------------------------------------------------

loc_4124D0:				; CODE XREF: sub_41229D+D0j
					; sub_41229D+E8j
		nop
		jmp	short loc_4124DA
; ---------------------------------------------------------------------------

loc_4124D3:				; CODE XREF: sub_41229D+F9j
					; sub_41229D+154j
		nop
		jmp	short loc_4124DA
; ---------------------------------------------------------------------------

loc_4124D6:				; CODE XREF: sub_41229D+165j
					; sub_41229D+16Fj
		nop
		jmp	short loc_4124DA
; ---------------------------------------------------------------------------

loc_4124D9:				; CODE XREF: sub_41229D+1BFj
					; sub_41229D+231j
		nop

loc_4124DA:				; CODE XREF: sub_41229D+234j
					; sub_41229D+237j ...
		mov	eax, [ebp+var_C]
		add	esp, 64h
		pop	edi
		pop	ebp
		retn
sub_41229D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4124E3	proc near		; CODE XREF: sub_4125D2+61p
					; sub_4125D2+8Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Dest		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_4124F6
		mov	[ebp+arg_0], offset dword_4310B4

loc_4124F6:				; CODE XREF: sub_4124E3+Aj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_412530
; ---------------------------------------------------------------------------

loc_412505:				; CODE XREF: sub_4124E3+55j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	[esp+28h+Str], offset aAbcdefghijkl_0 ;	"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		call	strchr
		test	eax, eax
		jz	short loc_412528
		add	[ebp+var_14], 1
		jmp	short loc_41252C
; ---------------------------------------------------------------------------

loc_412528:				; CODE XREF: sub_4124E3+3Dj
		add	[ebp+var_14], 3

loc_41252C:				; CODE XREF: sub_4124E3+43j
		add	[ebp+var_C], 1

loc_412530:				; CODE XREF: sub_4124E3+20j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412505
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+28h+Str], eax ; Size
		call	malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_412558
		mov	eax, 0
		jmp	short locret_4125D0
; ---------------------------------------------------------------------------

loc_412558:				; CODE XREF: sub_4124E3+6Cj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+Dest], eax
		jmp	short loc_4125BD
; ---------------------------------------------------------------------------

loc_412566:				; CODE XREF: sub_4124E3+E2j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	[esp+28h+Str], offset aAbcdefghijkl_0 ;	"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		call	strchr
		test	eax, eax
		jz	short loc_412594
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+Dest]
		mov	[eax], dl
		add	[ebp+Dest], 1
		jmp	short loc_4125B9
; ---------------------------------------------------------------------------

loc_412594:				; CODE XREF: sub_4124E3+9Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x_0 ; "%%%02X"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Val], eax ; Format
		mov	eax, [ebp+Dest]
		mov	[esp+28h+Str], eax ; Dest
		call	sprintf
		add	[ebp+Dest], 3

loc_4125B9:				; CODE XREF: sub_4124E3+AFj
		add	[ebp+var_C], 1

loc_4125BD:				; CODE XREF: sub_4124E3+81j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412566
		mov	eax, [ebp+Dest]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]

locret_4125D0:				; CODE XREF: sub_4124E3+73j
		leave
		retn
sub_4124E3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4125D2	proc near		; CODE XREF: sub_41290B+279p
					; sub_41290B+29Dp

Size		= dword	ptr -68h
Source		= dword	ptr -64h
var_4C		= dword	ptr -4Ch
var_3D		= dword	ptr -3Dh
var_39		= dword	ptr -39h
var_35		= dword	ptr -35h
var_31		= dword	ptr -31h
var_2D		= dword	ptr -2Dh
var_29		= dword	ptr -29h
var_25		= dword	ptr -25h
var_21		= dword	ptr -21h
var_1D		= dword	ptr -1Dh
var_19		= dword	ptr -19h
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_3D], 72657375h
		mov	[ebp+var_39], 74726543h
		mov	[ebp+var_35], 63696669h
		mov	[ebp+var_31], 2C657461h
		mov	[ebp+var_2D], 65436163h
		mov	[ebp+var_29], 66697472h
		mov	[ebp+var_25], 74616369h
		mov	[ebp+var_21], 35782C65h
		mov	[ebp+var_1D], 61633930h
		mov	[ebp+var_19], 74726543h
		mov	[ebp+var_15], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Size],	eax
		call	sub_4124E3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_412657
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Size],	eax
		call	sub_410B43
		jmp	loc_4127CF
; ---------------------------------------------------------------------------

loc_412657:				; CODE XREF: sub_4125D2+6Dj
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+Size],	eax
		call	sub_4124E3
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_412692
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Size],	eax
		call	sub_410B43
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Size],	eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	loc_4127CF
; ---------------------------------------------------------------------------

loc_412692:				; CODE XREF: sub_4125D2+97j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 37h
		mov	[esp+68h+Size],	eax ; Size
		call	malloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41271F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Size],	eax
		call	sub_410B43
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Size],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Size],	eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	loc_4127CF
; ---------------------------------------------------------------------------

loc_41271F:				; CODE XREF: sub_4125D2+119j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	dword ptr [eax], 7061646Ch
		mov	dword ptr [eax+4], 2F2F2F3Ah
		mov	byte ptr [eax+8], 0
		lea	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Source], eax
		mov	[esp+68h+Size],	edx
		call	sub_4265EB
		mov	word ptr [eax],	3Fh
		add	eax, 1
		lea	edx, [ebp+var_3D]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	ecx, [edx+24h]
		mov	[eax+24h], ecx
		movzx	edx, byte ptr [edx+28h]
		mov	[eax+28h], dl
		add	eax, 28h
		mov	dword ptr [eax], 6275733Fh
		mov	word ptr [eax+4], 3Fh
		lea	edx, [eax+5]
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Source], eax ;	Source
		mov	[esp+68h+Size],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Size],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Size],	eax
		call	gcry_free
		mov	eax, 0

loc_4127CF:				; CODE XREF: sub_4125D2+80j
					; sub_4125D2+BBj ...
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4125D2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4127D6	proc near		; CODE XREF: sub_40BEEF+4Dp

var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= byte ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	[esp+78h+var_74], 10h
		mov	[esp+78h+var_78], 1
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412819
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+var_78], eax
		call	sub_410B43
		jmp	loc_412903
; ---------------------------------------------------------------------------

loc_412819:				; CODE XREF: sub_4127D6+2Bj
		mov	[esp+78h+var_78], 73h
		call	sub_410B1B
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+var_74], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+var_78], eax
		call	sub_410BE0
		jmp	loc_4128CE
; ---------------------------------------------------------------------------

loc_41283F:				; CODE XREF: sub_4127D6+105j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	edi, eax
		mov	eax, [ebp+var_20]
		mov	esi, [eax+10h]
		mov	eax, [ebp+var_20]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_20]
		mov	ecx, [eax+8]
		mov	eax, [ebp+var_20]
		mov	edx, [eax+4]
		mov	eax, ds:dword_435FEC
		mov	[esp+78h+var_48], edi
		mov	[esp+78h+var_4C], 0
		mov	edi, [ebp+arg_C]
		mov	[esp+78h+var_50], edi
		mov	[esp+78h+var_54], offset aObjectclass ;	"objectClass=*"
		mov	edi, [ebp+arg_8]
		mov	[esp+78h+var_58], edi
		mov	[esp+78h+var_5C], esi
		mov	[esp+78h+var_60], ebx
		mov	[esp+78h+var_64], ecx
		mov	[esp+78h+var_68], edx
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+var_74], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+var_78], eax
		call	sub_411D68
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4128E3
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+var_78], eax
		call	sub_410B73

loc_4128CE:				; CODE XREF: sub_4127D6+64j
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+var_78], eax
		call	sub_410BBA
		test	eax, eax
		jz	loc_41283F
		jmp	short loc_4128E4
; ---------------------------------------------------------------------------

loc_4128E3:				; CODE XREF: sub_4127D6+EBj
		nop

loc_4128E4:				; CODE XREF: sub_4127D6+10Bj
		cmp	[ebp+var_1C], 0
		jz	short loc_412900
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_412900:				; CODE XREF: sub_4127D6+112j
		mov	eax, [ebp+var_1C]

loc_412903:				; CODE XREF: sub_4127D6+3Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4127D6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41290B	proc near		; CODE XREF: sub_40BF43+4Cp

Dest		= dword	ptr -148h
Format		= dword	ptr -144h
var_140		= dword	ptr -140h
var_130		= dword	ptr -130h
var_12C		= byte ptr -12Ch
var_10E		= byte ptr -10Eh
var_F0		= dword	ptr -0F0h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 148h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_412958
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+4]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+8]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+10h]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_412969
		jmp	short loc_412970
; ---------------------------------------------------------------------------

loc_412958:				; CODE XREF: sub_41290B+16j
		mov	[esp+148h+Dest], 45h
		call	sub_410B1B
		jmp	locret_412C74
; ---------------------------------------------------------------------------

loc_412969:				; CODE XREF: sub_41290B+49j
		mov	[ebp+var_10], offset dword_4310B4

loc_412970:				; CODE XREF: sub_41290B+4Bj
		mov	[ebp+var_14], 0
		cmp	[ebp+var_24], 0
		jz	short loc_4129A0
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], offset aPass ; "--pass"
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_24]
		mov	[ebp+eax*4+var_F0], edx
		add	[ebp+var_14], 1

loc_4129A0:				; CODE XREF: sub_41290B+70j
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_4129BB
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], offset aVv ; "-vv"
		add	[ebp+var_14], 1

loc_4129BB:				; CODE XREF: sub_41290B+9Cj
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], offset aLogWithPid ; "--log-with-pid"
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], offset aMulti ; "--multi"
		add	[ebp+var_14], 1
		mov	eax, ds:dword_43600C
		test	eax, eax
		jz	short loc_412A2F
		mov	edx, ds:dword_43600C
		mov	eax, offset aU_0 ; "%u"
		mov	[esp+148h+var_140], edx
		mov	[esp+148h+Format], eax ; Format
		lea	eax, [ebp+var_12C]
		mov	[esp+148h+Dest], eax ; Dest
		call	sprintf
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], offset aTimeout ; "--timeout"
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_12C]
		mov	[ebp+eax*4+var_F0], edx
		add	[ebp+var_14], 1

loc_412A2F:				; CODE XREF: sub_41290B+DBj
		mov	eax, ds:dword_435FEC
		test	eax, eax
		jz	short loc_412A5E
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], offset aProxy ; "--proxy"
		add	[ebp+var_14], 1
		mov	edx, ds:dword_435FEC
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], edx
		add	[ebp+var_14], 1

loc_412A5E:				; CODE XREF: sub_41290B+12Bj
		cmp	[ebp+var_18], 0
		jz	short loc_412A87
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], offset aHost ; "--host"
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[ebp+eax*4+var_F0], edx
		add	[ebp+var_14], 1

loc_412A87:				; CODE XREF: sub_41290B+157j
		cmp	[ebp+var_1C], 0
		jz	short loc_412AD1
		mov	eax, offset aD_0 ; "%d"
		mov	edx, [ebp+var_1C]
		mov	[esp+148h+var_140], edx
		mov	[esp+148h+Format], eax ; Format
		lea	eax, [ebp+var_10E]
		mov	[esp+148h+Dest], eax ; Dest
		call	sprintf
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], offset aPort ; "--port"
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_10E]
		mov	[ebp+eax*4+var_F0], edx
		add	[ebp+var_14], 1

loc_412AD1:				; CODE XREF: sub_41290B+180j
		cmp	[ebp+var_20], 0
		jz	loc_412BE5
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], offset aUser ; "--user"
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_20]
		mov	[ebp+eax*4+var_F0], edx
		add	[ebp+var_14], 1
		jmp	loc_412BE5
; ---------------------------------------------------------------------------

loc_412B03:				; CODE XREF: sub_41290B+2DEj
		mov	eax, [ebp+var_14]
		cmp	eax, 0C6h
		jbe	short loc_412B1E
		mov	[esp+148h+Dest], 21h
		call	sub_410B1B
		jmp	locret_412C74
; ---------------------------------------------------------------------------

loc_412B1E:				; CODE XREF: sub_41290B+200j
		mov	eax, [ebp+arg_8]
		add	eax, 8
		mov	[esp+148h+Dest], eax ; char *
		call	sub_41229D
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_412B5C
		mov	eax, [ebp+arg_8]
		add	eax, 8
		mov	[esp+148h+Format], eax ; char
		mov	[esp+148h+Dest], offset	aStart_cert_f_0	; "start_cert_fetch: invalid pattern `%s'\"...
		call	sub_4233B1
		mov	[esp+148h+Dest], 25h
		call	sub_410B1B
		jmp	locret_412C74
; ---------------------------------------------------------------------------

loc_412B5C:				; CODE XREF: sub_41290B+228j
		mov	eax, [ebp+var_28]
		mov	eax, [eax+4]
		and	eax, 1
		test	al, al
		jz	short loc_412B8E
		mov	eax, [ebp+var_28]
		add	eax, 8
		mov	[esp+148h+var_140], offset aObjectclass	; "objectClass=*"
		mov	[esp+148h+Format], eax
		lea	eax, [ebp+var_130]
		mov	[esp+148h+Dest], eax
		call	sub_4125D2
		mov	[ebp+var_C], eax
		jmp	short loc_412BB0
; ---------------------------------------------------------------------------

loc_412B8E:				; CODE XREF: sub_41290B+25Cj
		mov	eax, [ebp+var_28]
		add	eax, 8
		mov	[esp+148h+var_140], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+Format], eax
		lea	eax, [ebp+var_130]
		mov	[esp+148h+Dest], eax
		call	sub_4125D2
		mov	[ebp+var_C], eax

loc_412BB0:				; CODE XREF: sub_41290B+281j
		mov	eax, [ebp+var_28]
		mov	[esp+148h+Dest], eax
		call	sub_423574
		cmp	[ebp+var_C], 0
		jz	short loc_412BC9
		mov	eax, [ebp+var_C]
		jmp	locret_412C74
; ---------------------------------------------------------------------------

loc_412BC9:				; CODE XREF: sub_41290B+2B4j
		mov	edx, [ebp+var_130]
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], edx
		add	[ebp+var_14], 1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+arg_8], eax

loc_412BE5:				; CODE XREF: sub_41290B+1CAj
					; sub_41290B+1F3j
		cmp	[ebp+arg_8], 0
		jnz	loc_412B03
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_F0], 0
		mov	[esp+148h+Format], 10h
		mov	[esp+148h+Dest], 1
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412C34
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+148h+Dest], eax
		call	sub_410B43
		jmp	short locret_412C74
; ---------------------------------------------------------------------------

loc_412C34:				; CODE XREF: sub_41290B+314j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		lea	edx, [ebp+var_F0]
		mov	[esp+148h+var_140], edx
		mov	[esp+148h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+Dest], eax
		call	sub_4119CC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_412C71
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+148h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_412C71:				; CODE XREF: sub_41290B+34Ej
		mov	eax, [ebp+var_C]

locret_412C74:				; CODE XREF: sub_41290B+59j
					; sub_41290B+20Ej ...
		leave
		retn
sub_41290B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412C76	proc near		; CODE XREF: sub_4119CC+323p
					; sub_412CC5+49p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_412CB8
; ---------------------------------------------------------------------------

loc_412C7E:				; CODE XREF: sub_412C76+46j
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	ksba_reader_read
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_412CAC
		mov	eax, [ebp+var_C]
		jmp	short locret_412CC3
; ---------------------------------------------------------------------------

loc_412CAC:				; CODE XREF: sub_412C76+2Fj
		mov	eax, [ebp+var_10]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		sub	[ebp+arg_8], eax

loc_412CB8:				; CODE XREF: sub_412C76+6j
		cmp	[ebp+arg_8], 0
		jnz	short loc_412C7E
		mov	eax, 0

locret_412CC3:				; CODE XREF: sub_412C76+34j
		leave
		retn
sub_412C76	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412CC5	proc near		; CODE XREF: sub_40BF96+1Ap
					; sub_40BFB7+23p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= dword	ptr -20h
Str1		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_C], 0
		jmp	loc_412FEB
; ---------------------------------------------------------------------------

loc_412CF7:				; CODE XREF: sub_412CC5+32Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+38h+var_30], 5
		lea	edx, [ebp+var_25]
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax
		call	sub_412C76
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_412FF7
		movzx	eax, [ebp+var_24]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 18h
		movzx	eax, [ebp+var_23]
		movzx	eax, al
		shl	eax, 10h
		or	edx, eax
		movzx	eax, [ebp+var_22]
		movzx	eax, al
		shl	eax, 8
		or	edx, eax
		movzx	eax, [ebp+var_21]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_25]
		cmp	al, 56h
		jnz	short loc_412DBC
		cmp	[ebp+var_10], 0
		jz	short loc_412DBC
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412D8F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+Str], eax
		call	sub_410B43
		jmp	locret_413058
; ---------------------------------------------------------------------------

loc_412D8F:				; CODE XREF: sub_412CC5+B2j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	ecx, [ebp+var_18]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax
		call	sub_412C76
		mov	[ebp+var_C], eax
		jmp	loc_412FFB
; ---------------------------------------------------------------------------

loc_412DBC:				; CODE XREF: sub_412CC5+91j
					; sub_412CC5+97j
		cmp	[ebp+var_18], 0
		jnz	short loc_412DD6
		movzx	eax, [ebp+var_25]
		cmp	al, 41h
		jnz	short loc_412DD6
		mov	[ebp+var_10], 0
		jmp	loc_412FEB
; ---------------------------------------------------------------------------

loc_412DD6:				; CODE XREF: sub_412CC5+FBj
					; sub_412CC5+103j
		cmp	[ebp+var_18], 0
		jz	loc_412FEB
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jbe	short loc_412E44
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[esp+38h+Str], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_412E3B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+Str], eax
		call	sub_410B43
		jmp	locret_413058
; ---------------------------------------------------------------------------

loc_412E3B:				; CODE XREF: sub_412CC5+15Ej
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx

loc_412E44:				; CODE XREF: sub_412CC5+126j
		mov	ecx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax
		call	sub_412C76
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_412FFA
		movzx	eax, [ebp+var_25]
		cmp	al, 41h
		jnz	loc_412FA4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+Str1], eax
		mov	eax, [ebp+var_18]
		add	eax, [ebp+Str1]
		mov	byte ptr [eax],	0
		mov	[ebp+var_14], 0
		mov	[esp+38h+Val], 3Bh ; Val
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_412EB6
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0

loc_412EB6:				; CODE XREF: sub_412CC5+1E9j
		mov	[esp+38h+Val], offset aUsercertificat ;	"userCertificate"
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Str], eax
		call	sub_42630F
		test	eax, eax
		jnz	short loc_412EF9
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_412EED
		mov	[esp+38h+Val], offset aUsercertificat ;	"userCertificate"
		mov	[esp+38h+Str], offset aFetch_next_c_0 ;	"fetch_next_cert_ldap: got attribute `%s"...
		call	sub_42344E

loc_412EED:				; CODE XREF: sub_412CC5+212j
		mov	[ebp+var_10], 1
		jmp	loc_412FEB
; ---------------------------------------------------------------------------

loc_412EF9:				; CODE XREF: sub_412CC5+206j
		mov	[esp+38h+Val], offset aCacertificat_0 ;	"caCertificate"
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Str], eax
		call	sub_42630F
		test	eax, eax
		jnz	short loc_412F3C
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_412F30
		mov	[esp+38h+Val], offset aCacertificat_0 ;	"caCertificate"
		mov	[esp+38h+Str], offset aFetch_next_c_0 ;	"fetch_next_cert_ldap: got attribute `%s"...
		call	sub_42344E

loc_412F30:				; CODE XREF: sub_412CC5+255j
		mov	[ebp+var_10], 1
		jmp	loc_412FEB
; ---------------------------------------------------------------------------

loc_412F3C:				; CODE XREF: sub_412CC5+249j
		mov	[esp+38h+Val], offset aX509cacert ; "x509caCert"
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Str], eax
		call	sub_42630F
		test	eax, eax
		jnz	short loc_412F7C
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_412F73
		mov	[esp+38h+Val], offset aCacertificat_0 ;	"caCertificate"
		mov	[esp+38h+Str], offset aFetch_next_c_0 ;	"fetch_next_cert_ldap: got attribute `%s"...
		call	sub_42344E

loc_412F73:				; CODE XREF: sub_412CC5+298j
		mov	[ebp+var_10], 1
		jmp	short loc_412FEB
; ---------------------------------------------------------------------------

loc_412F7C:				; CODE XREF: sub_412CC5+28Cj
		mov	eax, ds:dword_435FA0
		and	eax, 2
		test	eax, eax
		jz	short loc_412F9B
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aFetch_next_c_1 ;	"fetch_next_cert_ldap: got attribute `%s"...
		call	sub_42344E

loc_412F9B:				; CODE XREF: sub_412CC5+2C1j
		mov	[ebp+var_10], 0
		jmp	short loc_412FEB
; ---------------------------------------------------------------------------

loc_412FA4:				; CODE XREF: sub_412CC5+1B0j
		movzx	eax, [ebp+var_25]
		cmp	al, 45h
		jnz	short loc_412FEB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+Str1], eax
		mov	eax, [ebp+var_18]
		add	eax, [ebp+Str1]
		mov	byte ptr [eax],	0
		mov	[esp+38h+Val], offset aTruncated_1 ; "truncated"
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_412FEB
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 1
		mov	[esp+38h+Str], offset aLdap_searchHit ;	"ldap_search hit the size limit	of the s"...
		call	sub_423387

loc_412FEB:				; CODE XREF: sub_412CC5+2Dj
					; sub_412CC5+10Cj ...
		cmp	[ebp+var_C], 0
		jz	loc_412CF7
		jmp	short loc_412FFB
; ---------------------------------------------------------------------------

loc_412FF7:				; CODE XREF: sub_412CC5+55j
		nop
		jmp	short loc_412FFB
; ---------------------------------------------------------------------------

loc_412FFA:				; CODE XREF: sub_412CC5+1A4j
		nop

loc_412FFB:				; CODE XREF: sub_412CC5+F2j
					; sub_412CC5+330j ...
		cmp	[ebp+var_C], 0
		jz	short loc_413055
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]

loc_413023:				; DATA XREF: .rdata:off_42F0A0o
		mov	[esp+38h+Str], eax
		call	sub_410B36
		cmp	eax, 3FFFh
		jnz	short loc_413055
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_413055
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	[esp+38h+Str], 4Ah
		call	sub_410B1B
		mov	[ebp+var_C], eax

loc_413055:				; CODE XREF: sub_412CC5+33Aj
					; sub_412CC5+36Bj ...
		mov	eax, [ebp+var_C]

locret_413058:				; CODE XREF: sub_412CC5+C5j
					; sub_412CC5+171j
		leave
		retn
sub_412CC5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41305A	proc near		; CODE XREF: sub_40C079+Cp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short locret_41309D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4115C2
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	ksba_reader_release

locret_41309D:				; CODE XREF: sub_41305A+Aj
		leave
		retn
sub_41305A	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4130A0	proc near		; CODE XREF: sub_4130C7+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4130C0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4130C5
; ---------------------------------------------------------------------------

loc_4130C0:				; CODE XREF: sub_4130A0+7j
		mov	eax, 0

loc_4130C5:				; CODE XREF: sub_4130A0+1Ej
		pop	ebp
		retn
sub_4130A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4130C7	proc near		; CODE XREF: sub_4130E2+14p
					; sub_4130FD+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_4130A0
		leave
		retn
sub_4130C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4130E2	proc near		; CODE XREF: sub_4141ED+2A3p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_4130C7
		leave
		retn
sub_4130E2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4130FD	proc near		; CODE XREF: sub_413430+57p
					; sub_4135D8+B2p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_4130C7
		leave
		retn
sub_4130FD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413112()
sub_413112	proc near		; DATA XREF: sub_413121:loc_4131C9o
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:WSACleanup
		call	eax ; WSACleanup
		leave
		retn
sub_413112	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413121	proc near		; CODE XREF: sub_4152A7+33p

wVersionRequested= word	ptr -28h
lpWSAData	= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_435640
		test	eax, eax
		jnz	loc_4131E1
		mov	[esp+28h+lpWSAData], offset stru_435660	; lpWSAData
		mov	dword ptr [esp+28h+wVersionRequested], 202h ; wVersionRequested
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		test	eax, eax
		jz	short loc_41316A
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+28h+lpWSAData], eax ; char
		mov	dword ptr [esp+28h+wVersionRequested], offset aErrorInitial_3 ;	"error initializing socket library: ec=%"...
		call	sub_4233B1
		jmp	short locret_4131E2
; ---------------------------------------------------------------------------

loc_41316A:				; CODE XREF: sub_413121+2Ej
		movzx	eax, ds:stru_435660.wVersion
		cmp	al, 2
		jnz	short loc_413184
		movzx	eax, ds:stru_435660.wVersion
		shr	ax, 8
		cmp	al, 2
		jz	short loc_4131C9

loc_413184:				; CODE XREF: sub_413121+52j
		movzx	eax, ds:stru_435660.wVersion
		shr	ax, 8
		movzx	edx, al
		movzx	eax, ds:stru_435660.wVersion
		movzx	eax, al
		mov	[esp+28h+var_18], 2
		mov	[esp+28h+var_1C], 2
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+lpWSAData], eax ; char
		mov	dword ptr [esp+28h+wVersionRequested], offset aSocketLibraryV ;	"socket	library	version	is %x.%x - but %"...
		call	sub_4233B1
		mov	eax, ds:WSACleanup
		call	eax ; WSACleanup
		jmp	short locret_4131E2
; ---------------------------------------------------------------------------

loc_4131C9:				; CODE XREF: sub_413121+61j
		mov	dword ptr [esp+28h+wVersionRequested], offset sub_413112 ; _onexit_t
		call	sub_4284C0
		mov	ds:dword_435640, 1
		jmp	short locret_4131E2
; ---------------------------------------------------------------------------

loc_4131E1:				; CODE XREF: sub_413121+Dj
		nop

locret_4131E2:				; CODE XREF: sub_413121+47j
					; sub_413121+A6j ...
		leave
		retn
sub_413121	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4131E4(int, char *, int, int)
sub_4131E4	proc near		; CODE XREF: sub_4141ED+1A5p
					; sub_4141ED+364p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_20]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	eax, [ebp+arg_C]
		add	eax, 2
		mov	[ebp+var_1C], eax
		mov	edx, 0AAAAAAABh
		mov	eax, [ebp+var_1C]
		mul	edx
		mov	eax, edx
		shr	eax, 1
		shl	eax, 2
		lea	ebx, [ecx+eax]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_20]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41326D
		mov	eax, 0
		jmp	loc_413424
; ---------------------------------------------------------------------------

loc_41326D:				; CODE XREF: sub_4131E4+7Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	sub_4265EB
		mov	[ebp+var_10], eax
		jmp	loc_413330
; ---------------------------------------------------------------------------

loc_413287:				; CODE XREF: sub_4131E4+150j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		shr	eax, 2
		and	eax, 3Fh
		movzx	eax, byte_42B460[eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		shl	eax, 4
		mov	edx, eax
		and	edx, 30h
		mov	eax, [ebp+var_C]
		add	eax, 4
		mov	eax, [eax]
		shr	eax, 4
		and	eax, 0Fh
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_42B460[eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		add	eax, 4
		mov	eax, [eax]
		shl	eax, 2
		mov	edx, eax
		and	edx, 3Ch
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	eax, [eax]
		shr	eax, 6
		and	eax, 3
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_42B460[eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	eax, [eax]
		and	eax, 3Fh
		movzx	eax, byte_42B460[eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl

loc_413324:				; DATA XREF: .rdata:off_42F09Co
		add	[ebp+var_10], 1
		sub	[ebp+arg_C], 3
		add	[ebp+var_C], 0Ch

loc_413330:				; CODE XREF: sub_4131E4+9Ej
		cmp	[ebp+arg_C], 2
		ja	loc_413287
		cmp	[ebp+arg_C], 2
		jnz	short loc_4133BB
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		shr	eax, 2
		and	eax, 3Fh
		movzx	eax, byte_42B460[eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		shl	eax, 4
		mov	edx, eax
		and	edx, 30h
		mov	eax, [ebp+var_C]
		add	eax, 4
		mov	eax, [eax]
		shr	eax, 4
		and	eax, 0Fh
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_42B460[eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		add	eax, 4
		mov	eax, [eax]
		shl	eax, 2
		and	eax, 3Ch
		movzx	eax, byte_42B460[eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	3Dh
		add	[ebp+var_10], 1
		jmp	short loc_41340F
; ---------------------------------------------------------------------------

loc_4133BB:				; CODE XREF: sub_4131E4+15Aj
		cmp	[ebp+arg_C], 1
		jnz	short loc_41340F
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		shr	eax, 2
		and	eax, 3Fh
		movzx	eax, byte_42B460[eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		shl	eax, 4
		and	eax, 30h
		movzx	eax, byte_42B460[eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	3Dh
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	3Dh
		add	[ebp+var_10], 1

loc_41340F:				; CODE XREF: sub_4131E4+1D5j
					; sub_4131E4+1DBj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+var_14]

loc_413424:				; CODE XREF: sub_4131E4+84j
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4131E4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413430(int, int, char	*, int,	int, int, int)
sub_413430	proc near		; CODE XREF: sub_41373C+37p
					; sub_41757C+164p

s		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 1
		jz	short loc_41345C
		cmp	[ebp+arg_4], 3
		jz	short loc_41345C
		mov	[esp+28h+s], 2Dh
		call	sub_4130C7
		jmp	locret_41357E
; ---------------------------------------------------------------------------

loc_41345C:				; CODE XREF: sub_413430+13j
					; sub_413430+19j
		mov	eax, [ebp+arg_10]
		and	eax, 20h
		test	eax, eax
		jnz	short loc_41346A
		or	[ebp+arg_10], 10h

loc_41346A:				; CODE XREF: sub_413430+34j
		mov	[esp+28h+var_24], 38h
		mov	[esp+28h+s], 1
		call	gcry_calloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_413491
		call	sub_4130FD
		jmp	locret_41357E
; ---------------------------------------------------------------------------

loc_413491:				; CODE XREF: sub_413430+55j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+24h], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_10]
		mov	[eax+30h], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_10]
		lea	edx, [eax+20h]
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_24], eax ;	char *
		mov	[esp+28h+s], edx ; int
		call	sub_4138E0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4134F0
		mov	eax, [ebp+arg_14]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+s], eax
		call	sub_4141ED
		mov	[ebp+var_C], eax

loc_4134F0:				; CODE XREF: sub_413430+A2j
		cmp	[ebp+var_C], 0
		jz	short loc_413573
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_413528
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_413528
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_413528
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_413528:				; CODE XREF: sub_413430+CEj
					; sub_413430+D8j ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_413540
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+s], eax ; void	*
		call	sub_41B5DF

loc_413540:				; CODE XREF: sub_413430+100j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_413558
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	[esp+28h+s], eax ; void	*
		call	sub_41B5DF

loc_413558:				; CODE XREF: sub_413430+118j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+20h]
		mov	[esp+28h+s], eax
		call	sub_413952
		mov	eax, [ebp+var_10]
		mov	[esp+28h+s], eax
		call	gcry_free
		jmp	short loc_41357B
; ---------------------------------------------------------------------------

loc_413573:				; CODE XREF: sub_413430+C4j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_41357B:				; CODE XREF: sub_413430+141j
		mov	eax, [ebp+var_C]

locret_41357E:				; CODE XREF: sub_413430+27j
					; sub_413430+5Cj
		leave
		retn
sub_413430	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413580	proc near		; CODE XREF: sub_4135D8+Cp
					; sub_41757C+1D0p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+8]
		and	eax, 1
		test	al, al
		jnz	short loc_4135C8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10h]
		mov	eax, offset asc_431258 ; "\r\n"
		mov	[esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	sub_41C01B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+var_18], eax
		call	sub_41B82C
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+8]
		or	edx, 1
		mov	[eax+8], dl
		jmp	short locret_4135D6
; ---------------------------------------------------------------------------

loc_4135C8:				; CODE XREF: sub_413580+12j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+var_18], eax
		call	sub_41B82C

locret_4135D6:				; CODE XREF: sub_413580+46j
		leave
		retn
sub_413580	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4135D8	proc near		; CODE XREF: sub_41373C+52p
					; sub_41757C+288p

s		= dword	ptr -38h
how		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+s], eax
		call	sub_413580
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_413609
		mov	[esp+38h+s], 3Fh
		call	sub_4130C7
		jmp	locret_41373A
; ---------------------------------------------------------------------------

loc_413609:				; CODE XREF: sub_4135D8+1Ej
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax+10h]
		or	edx, 2
		mov	[eax+10h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+38h+s], eax ; void	*
		call	sub_41B5DF
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		and	eax, 2
		test	eax, eax
		jz	short loc_413660
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+how], 1 ; how
		mov	[esp+38h+s], eax ; s
		mov	eax, ds:shutdown
		call	eax ; shutdown
		sub	esp, 8

loc_413660:				; CODE XREF: sub_4135D8+6Bj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+8]
		and	edx, 0FFFFFFFEh
		mov	[eax+8], dl
		mov	[esp+38h+how], 18h
		mov	[esp+38h+s], 1
		call	gcry_calloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_413694
		call	sub_4130FD
		jmp	locret_41373A
; ---------------------------------------------------------------------------

loc_413694:				; CODE XREF: sub_4135D8+B0j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4136B8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+1Ch]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx

loc_4136B8:				; CODE XREF: sub_4135D8+D2j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+18h], edx
		mov	edx, offset aR_1 ; "r"
		mov	eax, [ebp+var_C]
		mov	ecx, off_42B440
		mov	[esp+38h+var_30], ecx ;	int
		mov	ecx, off_42B444
		mov	[esp+38h+var_2C], ecx ;	int
		mov	ecx, dword_42B448
		mov	[esp+38h+var_28], ecx ;	int
		mov	ecx, off_42B44C
		mov	[esp+38h+var_24], ecx ;	int
		mov	[esp+38h+how], edx ; char *
		mov	[esp+38h+s], eax ; int
		call	sub_41B1C0
		mov	edx, [ebp+arg_0]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_413729
		mov	eax, [ebp+var_C]
		mov	[esp+38h+s], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		call	sub_4130FD
		jmp	short locret_41373A
; ---------------------------------------------------------------------------

loc_413729:				; CODE XREF: sub_4135D8+133j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+s], eax
		call	sub_414E72
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]

locret_41373A:				; CODE XREF: sub_4135D8+2Cj
					; sub_4135D8+B7j ...
		leave
		retn
sub_4135D8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41373C(int, char *, int, int,	int, int)
sub_41373C	proc near		; CODE XREF: sub_40B9E4+1A3p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_20], eax ;	int
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_24], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_28], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_30], eax ;	char *
		mov	[esp+38h+var_34], 1 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_413430
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413786
		mov	eax, [ebp+var_C]
		jmp	short locret_4137B4
; ---------------------------------------------------------------------------

loc_413786:				; CODE XREF: sub_41373C+43j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax
		call	sub_4135D8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4137B1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		call	sub_4137B6

loc_4137B1:				; CODE XREF: sub_41373C+5Ej
		mov	eax, [ebp+var_C]

locret_4137B4:				; CODE XREF: sub_41373C+48j
		leave
		retn
sub_41373C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4137B6	proc near		; CODE XREF: sub_40B9E4+2AAp
					; sub_40B9E4+2D6p ...

s		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	loc_413896
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_4137F8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_4137F8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4137F8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_4137F8:				; CODE XREF: sub_4137B6+18j
					; sub_4137B6+22j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_413816
		cmp	[ebp+arg_4], 0
		jnz	short loc_413816
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+s], eax ; void	*
		call	sub_41B5DF

loc_413816:				; CODE XREF: sub_4137B6+4Aj
					; sub_4137B6+50j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_41382E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+s], eax ; void	*
		call	sub_41B5DF

loc_41382E:				; CODE XREF: sub_4137B6+68j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	[esp+28h+s], eax
		call	sub_413952
		jmp	short loc_413871
; ---------------------------------------------------------------------------

loc_41383E:				; CODE XREF: sub_4137B6+C3j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	eax, [eax+4]
		mov	[esp+28h+s], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+28h+s], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+34h], edx

loc_413871:				; CODE XREF: sub_4137B6+86j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		test	eax, eax
		jnz	short loc_41383E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+28h+s], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+s], eax
		call	gcry_free
		jmp	short locret_413897
; ---------------------------------------------------------------------------

loc_413896:				; CODE XREF: sub_4137B6+Aj
		nop

locret_413897:				; CODE XREF: sub_4137B6+DEj
		leave
		retn
sub_4137B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413899	proc near		; CODE XREF: sub_40B9E4+1F7p
					; sub_41757C+434p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_4138AA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		jmp	short loc_4138AF
; ---------------------------------------------------------------------------

loc_4138AA:				; CODE XREF: sub_413899+7j
		mov	eax, 0

loc_4138AF:				; CODE XREF: sub_413899+Fj
		pop	ebp
		retn
sub_413899	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4138B1	proc near		; CODE XREF: sub_41757C+1B5p
					; sub_41757C+1DBp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_4138C2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		jmp	short loc_4138C7
; ---------------------------------------------------------------------------

loc_4138C2:				; CODE XREF: sub_4138B1+7j
		mov	eax, 0

loc_4138C7:				; CODE XREF: sub_4138B1+Fj
		pop	ebp
		retn
sub_4138B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4138C9	proc near		; CODE XREF: sub_40B9E4+1B7p
					; sub_40B9E4+2FCp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_4138D9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		jmp	short loc_4138DE
; ---------------------------------------------------------------------------

loc_4138D9:				; CODE XREF: sub_4138C9+7j
		mov	eax, 0

loc_4138DE:				; CODE XREF: sub_4138C9+Ej
		pop	ebp
		retn
sub_4138C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4138E0(int, char *)
sub_4138E0	proc near		; CODE XREF: sub_40B9E4+2Cp
					; sub_40B9E4+E6p ...

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 24h
		mov	[esp+28h+Source], eax
		mov	[esp+28h+Dest],	1
		call	gcry_xcalloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		lea	edx, [eax+20h]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	[esp+28h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+Source], 0
		mov	[esp+28h+Dest],	eax
		call	sub_413995
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_4138E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413952	proc near		; CODE XREF: sub_40B9E4+3Ap
					; sub_40B9E4+F4p ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short locret_413993
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		jmp	short loc_413982
; ---------------------------------------------------------------------------

loc_413969:				; CODE XREF: sub_413952+34j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_413982:				; CODE XREF: sub_413952+15j
		cmp	[ebp+var_C], 0
		jnz	short loc_413969
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free

locret_413993:				; CODE XREF: sub_413952+Aj
		leave
		retn
sub_413952	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413995	proc near		; CODE XREF: sub_4138E0+67p

Str		= dword	ptr -58h
Control		= dword	ptr -54h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_0]
		add	eax, 20h
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		add	eax, 20h
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		add	edx, [ebp+var_20]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	word ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+1Ch]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		mov	[esp+58h+Control], offset aAbcdefghijkl_1 ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax ; Str
		call	strspn
		mov	edx, [ebp+var_2C]
		cmp	eax, edx
		jz	short loc_413A45
		mov	[esp+58h+Str], 2Eh
		call	sub_4130C7
		jmp	loc_413DB4
; ---------------------------------------------------------------------------

loc_413A45:				; CODE XREF: sub_413995+9Dj
		cmp	[ebp+arg_4], 0
		jnz	loc_413C7F
		mov	[esp+58h+Control], 3Ah ; Val
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_413A73
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_20]
		jnz	short loc_413A84

loc_413A73:				; CODE XREF: sub_413995+D4j
		mov	[esp+58h+Str], 2Eh
		call	sub_4130C7
		jmp	loc_413DB4
; ---------------------------------------------------------------------------

loc_413A84:				; CODE XREF: sub_413995+DCj
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_20]
		mov	[ebp+var_28], eax
		jmp	short loc_413AB4
; ---------------------------------------------------------------------------

loc_413A96:				; CODE XREF: sub_413995+127j
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+58h+Str], eax ; C
		mov	eax, ds:tolower
		call	eax ; tolower
		mov	edx, eax
		mov	eax, [ebp+var_28]
		mov	[eax], dl
		add	[ebp+var_28], 1

loc_413AB4:				; CODE XREF: sub_413995+FFj
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413A96
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, offset aHttp_1 ; "http"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_413B0B
		mov	eax, [ebp+arg_0]
		mov	word ptr [eax+10h], 50h
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_413B1C
		jmp	short loc_413B2D
; ---------------------------------------------------------------------------

loc_413B0B:				; CODE XREF: sub_413995+159j
		mov	[esp+58h+Str], 2Fh
		call	sub_4130C7
		jmp	loc_413DB4
; ---------------------------------------------------------------------------

loc_413B1C:				; CODE XREF: sub_413995+172j
		mov	[esp+58h+Str], 2Fh
		call	sub_4130C7
		jmp	loc_413DB4
; ---------------------------------------------------------------------------

loc_413B2D:				; CODE XREF: sub_413995+174j
		add	[ebp+var_20], 1
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	loc_413C7F
		add	[ebp+var_20], 1
		mov	[esp+58h+Control], 2Fh ; Val
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_413B69
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1

loc_413B69:				; CODE XREF: sub_413995+1C8j
		mov	[esp+58h+Control], 40h ; Val
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	short loc_413B9E
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+8], edx
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	0
		add	[ebp+var_30], 1
		mov	eax, [ebp+var_30]
		mov	[ebp+var_20], eax

loc_413B9E:				; CODE XREF: sub_413995+1EEj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_28], eax
		jmp	short loc_413BC4
; ---------------------------------------------------------------------------

loc_413BA6:				; CODE XREF: sub_413995+237j
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+58h+Str], eax ; C
		mov	eax, ds:tolower
		call	eax ; tolower
		mov	edx, eax
		mov	eax, [ebp+var_28]
		mov	[eax], dl
		add	[ebp+var_28], 1

loc_413BC4:				; CODE XREF: sub_413995+20Fj
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413BA6
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	[esp+58h+Control], 3Ah ; Val
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	short loc_413C11
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	0
		add	[ebp+var_30], 1
		mov	eax, [ebp+var_30]
		mov	[esp+58h+Str], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], dx

loc_413C11:				; CODE XREF: sub_413995+25Cj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+58h+Str], eax
		call	sub_413DBC
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_413C42
		mov	[esp+58h+Str], 2Eh
		call	sub_4130C7
		jmp	loc_413DB4
; ---------------------------------------------------------------------------

loc_413C42:				; CODE XREF: sub_413995+29Aj
		mov	ebx, [ebp+var_2C]
		mov	eax, [ebp+var_20]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jz	short loc_413C79
		mov	[esp+58h+Str], 2Eh
		call	sub_4130C7
		jmp	loc_413DB4
; ---------------------------------------------------------------------------

loc_413C79:				; CODE XREF: sub_413995+2D1j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax

loc_413C7F:				; CODE XREF: sub_413995+B4j
					; sub_413995+1A4j
		cmp	[ebp+var_20], 0
		jz	short loc_413C8F
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413C99

loc_413C8F:				; CODE XREF: sub_413995+2EEj
		mov	eax, 0
		jmp	loc_413DB4
; ---------------------------------------------------------------------------

loc_413C99:				; CODE XREF: sub_413995+2F8j
		mov	[esp+58h+Control], 3Fh ; Val
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_413CBF
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1

loc_413CBF:				; CODE XREF: sub_413995+31Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	sub_413DBC
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_413CED
		mov	[esp+58h+Str], 2Eh
		call	sub_4130C7
		jmp	loc_413DB4
; ---------------------------------------------------------------------------

loc_413CED:				; CODE XREF: sub_413995+345j
		mov	ebx, [ebp+var_2C]
		mov	eax, [ebp+var_20]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jz	short loc_413D24
		mov	[esp+58h+Str], 2Eh
		call	sub_4130C7
		jmp	loc_413DB4
; ---------------------------------------------------------------------------

loc_413D24:				; CODE XREF: sub_413995+37Cj
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_413D3A
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413D41

loc_413D3A:				; CODE XREF: sub_413995+399j
		mov	eax, 0
		jmp	short loc_413DB4
; ---------------------------------------------------------------------------

loc_413D41:				; CODE XREF: sub_413995+3A3j
		mov	eax, [ebp+arg_0]
		add	eax, 1Ch
		mov	[ebp+var_1C], eax

loc_413D4A:				; CODE XREF: sub_413995+417j
		mov	[esp+58h+Control], 26h ; Val
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_413D70
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1

loc_413D70:				; CODE XREF: sub_413995+3CFj
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	sub_4140B3
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_413D92
		mov	[esp+58h+Str], 2Eh
		call	sub_4130C7
		jmp	short loc_413DB4
; ---------------------------------------------------------------------------

loc_413D92:				; CODE XREF: sub_413995+3EDj
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_34]
		mov	[eax], edx
		mov	eax, [ebp+var_34]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_24], 0
		jz	short loc_413DAE
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	short loc_413D4A
; ---------------------------------------------------------------------------

loc_413DAE:				; CODE XREF: sub_413995+40Fj
		nop
		mov	eax, 0

loc_413DB4:				; CODE XREF: sub_413995+ABj
					; sub_413995+EAj ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_413995	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413DBC	proc near		; CODE XREF: sub_413995+28Ep
					; sub_413995+339p ...

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		jmp	loc_413F87
; ---------------------------------------------------------------------------

loc_413DDA:				; CODE XREF: sub_413DBC+1D3j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_413F70
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_413F0C
		mov	eax, [ebp+var_14]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_413F0C
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isxdigit
		call	eax ; isxdigit
		test	eax, eax
		jz	loc_413F0C
		mov	eax, [ebp+var_14]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isxdigit
		call	eax ; isxdigit
		test	eax, eax
		jz	loc_413F0C
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_413E69
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_413E69
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_413E91
; ---------------------------------------------------------------------------

loc_413E69:				; CODE XREF: sub_413DBC+96j
					; sub_413DBC+A0j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jbe	short loc_413E88
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_413E88
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_413E91
; ---------------------------------------------------------------------------

loc_413E88:				; CODE XREF: sub_413DBC+B5j
					; sub_413DBC+BFj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_413E91:				; CODE XREF: sub_413DBC+ABj
					; sub_413DBC+CAj
		mov	edx, [ebp+var_10]
		mov	[edx], al
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		shl	edx, 4
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_413ED1
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_413ED1
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_413EF9
; ---------------------------------------------------------------------------

loc_413ED1:				; CODE XREF: sub_413DBC+FEj
					; sub_413DBC+108j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jbe	short loc_413EF0
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_413EF0
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_413EF9
; ---------------------------------------------------------------------------

loc_413EF0:				; CODE XREF: sub_413DBC+11Dj
					; sub_413DBC+127j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_413EF9:				; CODE XREF: sub_413DBC+113j
					; sub_413DBC+132j
		or	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1
		jmp	short loc_413F83
; ---------------------------------------------------------------------------

loc_413F0C:				; CODE XREF: sub_413DBC+37j
					; sub_413DBC+48j ...
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413F3C
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1

loc_413F3C:				; CODE XREF: sub_413DBC+16Bj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413F59
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1

loc_413F59:				; CODE XREF: sub_413DBC+188j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413F69
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0

loc_413F69:				; CODE XREF: sub_413DBC+1A5j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_413F9E
; ---------------------------------------------------------------------------

loc_413F70:				; CODE XREF: sub_413DBC+26j
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_413F83:				; CODE XREF: sub_413DBC+14Ej
		add	[ebp+var_14], 1

loc_413F87:				; CODE XREF: sub_413DBC+19j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_413DDA
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_C]

locret_413F9E:				; CODE XREF: sub_413DBC+1B2j
		leave
		retn
sub_413DBC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413FA0(char *Dest, int, char *)
sub_413FA0	proc near		; CODE XREF: .text:0041406Dp
					; .text:004140A0p ...

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Dest		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_41403F
; ---------------------------------------------------------------------------

loc_413FB8:				; CODE XREF: sub_413FA0+A7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	[esp+28h+Str], offset aAbcdefghijkl_1 ;	"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		call	strchr
		test	eax, eax
		jz	short loc_41400C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jnz	short loc_41400C
		cmp	[ebp+Dest], 0
		jz	short loc_414006
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+Dest]
		mov	[eax], dl
		add	[ebp+Dest], 1

loc_414006:				; CODE XREF: sub_413FA0+55j
		add	[ebp+var_10], 1
		jmp	short loc_41403B
; ---------------------------------------------------------------------------

loc_41400C:				; CODE XREF: sub_413FA0+33j
					; sub_413FA0+4Fj
		cmp	[ebp+Dest], 0
		jz	short loc_414037
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x_1 ; "%%%02X"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Val], eax ; Format
		mov	eax, [ebp+Dest]
		mov	[esp+28h+Str], eax ; Dest
		call	sprintf
		add	[ebp+Dest], 3

loc_414037:				; CODE XREF: sub_413FA0+70j
		add	[ebp+var_10], 3

loc_41403B:				; CODE XREF: sub_413FA0+6Aj
		add	[ebp+var_C], 1

loc_41403F:				; CODE XREF: sub_413FA0+13j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_413FB8
		mov	eax, [ebp+var_10]
		leave
		retn
sub_413FA0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_413FA0
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_4140AE
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_413FA0
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_4140AE:				; CODE XREF: .text:0041408Aj
		mov	eax, [ebp-10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4140B3	proc near		; CODE XREF: sub_413995+3E1p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	[esp+38h+Val], 3Dh ; Val
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4140E7
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1

loc_4140E7:				; CODE XREF: sub_4140B3+28j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_413DBC
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jns	short loc_414105
		mov	eax, 0
		jmp	loc_4141E6
; ---------------------------------------------------------------------------

loc_414105:				; CODE XREF: sub_4140B3+46j
		mov	ebx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jz	short loc_414135
		mov	eax, 0
		jmp	loc_4141E6
; ---------------------------------------------------------------------------

loc_414135:				; CODE XREF: sub_4140B3+76j
		mov	[esp+38h+Val], 14h
		mov	[esp+38h+Str], 1
		call	gcry_calloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41415C
		mov	eax, 0
		jmp	loc_4141E6
; ---------------------------------------------------------------------------

loc_41415C:				; CODE XREF: sub_4140B3+9Dj
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_10]
		mov	[eax+4], edx
		cmp	[ebp+var_C], 0
		jnz	short loc_4141AB
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+10h], 1
		jmp	short loc_4141E3
; ---------------------------------------------------------------------------

loc_4141AB:				; CODE XREF: sub_4140B3+B6j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_413DBC
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jns	short loc_4141D1
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_4141E6
; ---------------------------------------------------------------------------

loc_4141D1:				; CODE XREF: sub_4140B3+10Aj
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+0Ch], edx

loc_4141E3:				; CODE XREF: sub_4140B3+F6j
		mov	eax, [ebp+var_18]

loc_4141E6:				; CODE XREF: sub_4140B3+4Dj
					; sub_4140B3+7Dj ...
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4140B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4141ED	proc near		; CODE XREF: sub_413430+B8p

VarName		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= byte ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
var_6F		= byte ptr -6Fh
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_3E		= word ptr -3Eh
Source		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 9Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_414247
		cmp	[ebp+var_38], 0
		jnz	short loc_414247
		mov	[esp+0A8h+VarName], offset aTlsRequestedBu ; "TLS requested but	no GNUTLS context pro"...
		call	sub_4233B1
		mov	[esp+0A8h+VarName], 3Fh
		call	sub_4130C7
		jmp	loc_414883
; ---------------------------------------------------------------------------

loc_414247:				; CODE XREF: sub_4141ED+35j
					; sub_4141ED+3Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_414262
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	eax, [eax+0Ch]
		jmp	short loc_414267
; ---------------------------------------------------------------------------

loc_414262:				; CODE XREF: sub_4141ED+68j
		mov	eax, offset aLocalhost ; "localhost"

loc_414267:				; CODE XREF: sub_4141ED+73j
		mov	[ebp+Source], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		movzx	eax, word ptr [eax+10h]
		test	ax, ax
		jz	short loc_414285
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		movzx	eax, word ptr [eax+10h]
		jmp	short loc_41428A
; ---------------------------------------------------------------------------

loc_414285:				; CODE XREF: sub_4141ED+8Aj
		mov	eax, 50h

loc_41428A:				; CODE XREF: sub_4141ED+96j
		mov	[ebp+var_3E], ax
		cmp	[ebp+arg_8], 0
		jz	short loc_41429E
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4142D6

loc_41429E:				; CODE XREF: sub_4141ED+A5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		and	eax, 1
		test	al, al
		jz	loc_414433
		mov	[esp+0A8h+VarName], offset aHttp_proxy ; "http_proxy"
		call	getenv
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	loc_414433
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_414433

loc_4142D6:				; CODE XREF: sub_4141ED+AFj
		cmp	[ebp+arg_8], 0
		jz	short loc_4142E2
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_24], eax

loc_4142E2:				; CODE XREF: sub_4141ED+EDj
		mov	eax, [ebp+var_24]
		mov	[esp+0A8h+var_A4], eax ; char *
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+VarName], eax	; int
		call	sub_4138E0
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41433B
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+VarName], eax
		call	gpg_strerror
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+var_24]
		mov	[esp+0A8h+var_A4], eax ; char
		mov	[esp+0A8h+VarName], offset aInvalidHttpPro ; "invalid HTTP proxy (%s): %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_4C]
		mov	[esp+0A8h+VarName], eax
		call	sub_413952
		mov	[esp+0A8h+VarName], 73h
		call	sub_4130C7
		jmp	loc_414883
; ---------------------------------------------------------------------------

loc_41433B:				; CODE XREF: sub_4141ED+10Ej
		mov	eax, [ebp+var_4C]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4143BB
		mov	eax, [ebp+var_4C]
		mov	eax, [eax+8]
		mov	[esp+0A8h+VarName], eax
		call	sub_413DBC
		mov	eax, [ebp+var_4C]
		mov	eax, [eax+8]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_4C]
		mov	eax, [eax+8]
		mov	dword ptr [esp+0A8h+var_9C], edx ; int
		mov	[esp+0A8h+var_A0], eax ; int
		mov	[esp+0A8h+var_A4], offset asc_431258 ; "\r\n"
		mov	[esp+0A8h+VarName], offset aProxyAuthoriza ; "Proxy-Authorization: Basic "
		call	sub_4131E4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_4143BB
		call	sub_4130FD
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+0A8h+VarName], eax
		call	sub_413952
		mov	eax, [ebp+var_1C]
		jmp	loc_414883
; ---------------------------------------------------------------------------

loc_4143BB:				; CODE XREF: sub_4141ED+156j
					; sub_4141ED+1B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+30h]
		mov	eax, [ebp+var_4C]
		movzx	eax, word ptr [eax+10h]
		test	ax, ax
		jz	short loc_4143E1
		mov	eax, [ebp+var_4C]
		movzx	eax, word ptr [eax+10h]
		movzx	edx, ax
		jmp	short loc_4143E6
; ---------------------------------------------------------------------------

loc_4143E1:				; CODE XREF: sub_4141ED+1E6j
		mov	edx, 50h

loc_4143E6:				; CODE XREF: sub_4141ED+1F2j
		mov	eax, [ebp+var_4C]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4143FB
		mov	eax, [ebp+var_4C]
		mov	eax, [eax+0Ch]
		jmp	short loc_414400
; ---------------------------------------------------------------------------

loc_4143FB:				; CODE XREF: sub_4141ED+204j
		mov	eax, offset aLocalhost ; "localhost"

loc_414400:				; CODE XREF: sub_4141ED+20Cj
		mov	dword ptr [esp+0A8h+var_9C], ebx
		mov	[esp+0A8h+var_A0], ecx
		mov	[esp+0A8h+var_A4], edx ; int
		mov	[esp+0A8h+VarName], eax	; Source
		call	sub_4152A7
		mov	edx, [ebp+arg_0]
		mov	[edx+4], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+0A8h+VarName], eax
		call	sub_413952
		jmp	short loc_41446E
; ---------------------------------------------------------------------------

loc_414433:				; CODE XREF: sub_4141ED+BCj
					; sub_4141ED+D5j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		movzx	eax, [ebp+var_3E]
		mov	dword ptr [esp+0A8h+var_9C], ecx
		mov	[esp+0A8h+var_A0], edx
		mov	[esp+0A8h+var_A4], eax ; int
		mov	eax, [ebp+Source]
		mov	[esp+0A8h+VarName], eax	; Source
		call	sub_4152A7
		mov	edx, [ebp+arg_0]
		mov	[edx+4], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_30], eax

loc_41446E:				; CODE XREF: sub_4141ED+244j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4144A8
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free
		cmp	[ebp+var_30], 0
		jz	short loc_414497
		mov	eax, [ebp+var_30]
		mov	[esp+0A8h+VarName], eax
		call	sub_4130E2
		jmp	short loc_4144A3
; ---------------------------------------------------------------------------

loc_414497:				; CODE XREF: sub_4141ED+29Bj
		mov	[esp+0A8h+VarName], 1Bh
		call	sub_4130C7

loc_4144A3:				; CODE XREF: sub_4141ED+2A8j
		jmp	loc_414883
; ---------------------------------------------------------------------------

loc_4144A8:				; CODE XREF: sub_4141ED+28Aj
		cmp	[ebp+arg_4], 0
		jnz	short loc_4144BF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_414585

loc_4144BF:				; CODE XREF: sub_4141ED+2BFj
		cmp	[ebp+arg_4], 0
		jz	short loc_4144FB
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+VarName], eax
		call	gcry_strdup
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_4144EE
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free
		call	sub_4130FD
		jmp	loc_414883
; ---------------------------------------------------------------------------

loc_4144EE:				; CODE XREF: sub_4141ED+2EAj
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+VarName], eax
		call	sub_413DBC
		jmp	short loc_414518
; ---------------------------------------------------------------------------

loc_4144FB:				; CODE XREF: sub_4141ED+2D6j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	eax, [eax+8]
		mov	[esp+0A8h+VarName], eax
		call	sub_413DBC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	eax, [eax+8]
		mov	[ebp+var_34], eax

loc_414518:				; CODE XREF: sub_4141ED+30Cj
		mov	eax, [ebp+var_34]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	dword ptr [esp+0A8h+var_9C], eax ; int
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+var_A0], eax ; int
		mov	[esp+0A8h+var_A4], offset asc_431258 ; "\r\n"
		mov	[esp+0A8h+VarName], offset aAuthorizationB ; "Authorization: Basic %s"
		call	sub_4131E4
		mov	[ebp+var_2C], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_41456A
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free

loc_41456A:				; CODE XREF: sub_4141ED+370j
		cmp	[ebp+var_2C], 0
		jnz	short loc_414585
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free
		call	sub_4130FD
		jmp	loc_414883
; ---------------------------------------------------------------------------

loc_414585:				; CODE XREF: sub_4141ED+2CCj
					; sub_4141ED+381j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	[esp+0A8h+VarName], eax
		call	sub_41488E
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jnz	short loc_4145A6
		call	sub_4130FD
		jmp	loc_414883
; ---------------------------------------------------------------------------

loc_4145A6:				; CODE XREF: sub_4141ED+3ADj
		cmp	[ebp+var_24], 0
		jz	loc_41466A
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_41466A
		cmp	[ebp+var_28], 0
		jz	short loc_4145C9
		mov	ebx, [ebp+var_28]
		jmp	short loc_4145CE
; ---------------------------------------------------------------------------

loc_4145C9:				; CODE XREF: sub_4141ED+3D5j
		mov	ebx, offset byte_431360

loc_4145CE:				; CODE XREF: sub_4141ED+3DAj
		cmp	[ebp+var_2C], 0
		jz	short loc_4145D9
		mov	ecx, [ebp+var_2C]
		jmp	short loc_4145DE
; ---------------------------------------------------------------------------

loc_4145D9:				; CODE XREF: sub_4141ED+3E5j
		mov	ecx, offset byte_431360

loc_4145DE:				; CODE XREF: sub_4141ED+3EAj
		mov	eax, [ebp+var_44]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4145EF
		mov	edx, offset byte_431360
		jmp	short loc_4145F4
; ---------------------------------------------------------------------------

loc_4145EF:				; CODE XREF: sub_4141ED+3F9j
		mov	edx, offset asc_431361 ; "/"

loc_4145F4:				; CODE XREF: sub_4141ED+400j
		movzx	edi, [ebp+var_3E]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	eax, 1
		jz	short loc_41462E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	eax, 2
		jz	short loc_414627
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	eax, 3
		jnz	short loc_414620
		mov	eax, offset aPost ; "POST"
		jmp	short loc_414625
; ---------------------------------------------------------------------------

loc_414620:				; CODE XREF: sub_4141ED+42Aj
		mov	eax, offset aOops ; "OOPS"

loc_414625:				; CODE XREF: sub_4141ED+431j
		jmp	short loc_41462C
; ---------------------------------------------------------------------------

loc_414627:				; CODE XREF: sub_4141ED+41Fj
		mov	eax, offset aHead ; "HEAD"

loc_41462C:				; CODE XREF: sub_4141ED:loc_414625j
		jmp	short loc_414633
; ---------------------------------------------------------------------------

loc_41462E:				; CODE XREF: sub_4141ED+414j
		mov	eax, offset aGet ; "GET"

loc_414633:				; CODE XREF: sub_4141ED:loc_41462Cj
		mov	esi, offset aSHttpSHuSSHttp ; "%s http://%s:%hu%s%s HTTP/1.0\r\n%s%s"
		mov	[esp+0A8h+var_8C], ebx
		mov	[esp+0A8h+var_90], ecx
		mov	ecx, [ebp+var_44]
		mov	[esp+0A8h+var_94], ecx
		mov	[esp+0A8h+var_98], edx
		mov	dword ptr [esp+0A8h+var_9C], edi
		mov	edx, [ebp+Source]
		mov	[esp+0A8h+var_A0], edx
		mov	[esp+0A8h+var_A4], eax
		mov	[esp+0A8h+VarName], esi
		call	sub_41C5BB
		mov	[ebp+var_20], eax
		jmp	loc_41472D
; ---------------------------------------------------------------------------

loc_41466A:				; CODE XREF: sub_4141ED+3BDj
					; sub_4141ED+3CBj
		cmp	[ebp+var_3E], 50h
		jnz	short loc_414677
		mov	[ebp+var_6F], 0
		jmp	short loc_41469B
; ---------------------------------------------------------------------------

loc_414677:				; CODE XREF: sub_4141ED+482j
		movzx	edx, [ebp+var_3E]
		mov	eax, offset aU_1 ; ":%u"
		mov	dword ptr [esp+0A8h+var_9C], edx ; char
		mov	[esp+0A8h+var_A0], eax ; char *
		mov	[esp+0A8h+var_A4], 23h ; size_t
		lea	eax, [ebp+var_6F]
		mov	[esp+0A8h+VarName], eax	; char *
		call	sub_429570

loc_41469B:				; CODE XREF: sub_4141ED+488j
		cmp	[ebp+var_2C], 0
		jz	short loc_4146A6
		mov	ecx, [ebp+var_2C]
		jmp	short loc_4146AB
; ---------------------------------------------------------------------------

loc_4146A6:				; CODE XREF: sub_4141ED+4B2j
		mov	ecx, offset byte_431360

loc_4146AB:				; CODE XREF: sub_4141ED+4B7j
		mov	eax, [ebp+var_44]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4146BC
		mov	edx, offset byte_431360
		jmp	short loc_4146C1
; ---------------------------------------------------------------------------

loc_4146BC:				; CODE XREF: sub_4141ED+4C6j
		mov	edx, offset asc_431361 ; "/"

loc_4146C1:				; CODE XREF: sub_4141ED+4CDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	eax, 1
		jz	short loc_4146F7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	eax, 2
		jz	short loc_4146F0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	eax, 3
		jnz	short loc_4146E9
		mov	eax, offset aPost ; "POST"
		jmp	short loc_4146EE
; ---------------------------------------------------------------------------

loc_4146E9:				; CODE XREF: sub_4141ED+4F3j
		mov	eax, offset aOops ; "OOPS"

loc_4146EE:				; CODE XREF: sub_4141ED+4FAj
		jmp	short loc_4146F5
; ---------------------------------------------------------------------------

loc_4146F0:				; CODE XREF: sub_4141ED+4E8j
		mov	eax, offset aHead ; "HEAD"

loc_4146F5:				; CODE XREF: sub_4141ED:loc_4146EEj
		jmp	short loc_4146FC
; ---------------------------------------------------------------------------

loc_4146F7:				; CODE XREF: sub_4141ED+4DDj
		mov	eax, offset aGet ; "GET"

loc_4146FC:				; CODE XREF: sub_4141ED:loc_4146F5j
		mov	ebx, offset aSSSHttp1_0Host ; "%s %s%s HTTP/1.0\r\nHost: %s%s\r\n%s"
		mov	[esp+0A8h+var_90], ecx
		lea	ecx, [ebp+var_6F]
		mov	[esp+0A8h+var_94], ecx
		mov	ecx, [ebp+Source]
		mov	[esp+0A8h+var_98], ecx
		mov	ecx, [ebp+var_44]
		mov	dword ptr [esp+0A8h+var_9C], ecx
		mov	[esp+0A8h+var_A0], edx
		mov	[esp+0A8h+var_A4], eax
		mov	[esp+0A8h+VarName], ebx
		call	sub_41C5BB
		mov	[ebp+var_20], eax

loc_41472D:				; CODE XREF: sub_4141ED+478j
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free
		cmp	[ebp+var_20], 0
		jnz	short loc_414764
		call	sub_4130FD
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		jmp	loc_414883
; ---------------------------------------------------------------------------

loc_414764:				; CODE XREF: sub_4141ED+54Fj
		mov	[esp+0A8h+var_A4], 18h
		mov	[esp+0A8h+VarName], 1
		call	gcry_calloc
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jnz	short loc_41478E
		call	sub_4130FD
		mov	[ebp+var_1C], eax
		jmp	loc_41485F
; ---------------------------------------------------------------------------

loc_41478E:				; CODE XREF: sub_4141ED+592j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_48]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_48]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4147B8
		mov	eax, [ebp+var_48]
		mov	edx, [ebp+var_38]
		mov	[eax+4], edx

loc_4147B8:				; CODE XREF: sub_4141ED+5C0j
		mov	edx, offset aW_0 ; "w"
		mov	eax, [ebp+var_48]
		mov	ecx, off_42B440
		mov	[esp+0A8h+var_A0], ecx ; int
		mov	ecx, off_42B444
		mov	dword ptr [esp+0A8h+var_9C], ecx ; int
		mov	ecx, dword_42B448
		mov	[esp+0A8h+var_98], ecx ; int
		mov	ecx, off_42B44C
		mov	[esp+0A8h+var_94], ecx ; int
		mov	[esp+0A8h+var_A4], edx ; char *
		mov	[esp+0A8h+VarName], eax	; int
		call	sub_41B1C0
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_414823
		mov	eax, [ebp+var_48]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		call	sub_4130FD
		mov	[ebp+var_1C], eax
		jmp	short loc_41485F
; ---------------------------------------------------------------------------

loc_414823:				; CODE XREF: sub_4141ED+615j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_20]
		mov	[esp+0A8h+var_A4], edx
		mov	[esp+0A8h+VarName], eax
		call	sub_41C01B
		test	eax, eax
		jnz	short loc_41484E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+0A8h+VarName], eax
		call	sub_41B82C
		test	eax, eax
		jz	short loc_414858

loc_41484E:				; CODE XREF: sub_4141ED+64Dj
		call	sub_4130FD
		mov	[ebp+var_1C], eax
		jmp	short loc_41485F
; ---------------------------------------------------------------------------

loc_414858:				; CODE XREF: sub_4141ED+65Fj
		mov	[ebp+var_1C], 0

loc_41485F:				; CODE XREF: sub_4141ED+59Cj
					; sub_4141ED+634j ...
		mov	eax, [ebp+var_20]
		mov	[esp+0A8h+VarName], eax	; void *
		call	sub_41C4B7
		mov	eax, [ebp+var_2C]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+VarName], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]

loc_414883:				; CODE XREF: sub_4141ED+55j
					; sub_4141ED+149j ...
		add	esp, 9Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4141ED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41488E	proc near		; CODE XREF: sub_4141ED+3A1p

Dest		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+28h+var_20], offset a?_0 ;	"%;?&"
		mov	[esp+28h+var_24], eax ;	int
		mov	[esp+28h+Dest],	0 ; Dest
		call	sub_413FA0
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		jmp	short loc_41491C
; ---------------------------------------------------------------------------

loc_4148C0:				; CODE XREF: sub_41488E+92j
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_20], offset a?_1 ;	"%;?&="
		mov	[esp+28h+var_24], eax ;	int
		mov	[esp+28h+Dest],	0 ; Dest
		call	sub_413FA0
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_414914
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+var_20], offset a?_1 ;	"%;?&="
		mov	[esp+28h+var_24], eax ;	int
		mov	[esp+28h+Dest],	0 ; Dest
		call	sub_413FA0
		add	[ebp+var_14], eax

loc_414914:				; CODE XREF: sub_41488E+5Fj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41491C:				; CODE XREF: sub_41488E+30j
		cmp	[ebp+var_C], 0
		jnz	short loc_4148C0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41494A
		mov	eax, 0
		jmp	locret_414A19
; ---------------------------------------------------------------------------

loc_41494A:				; CODE XREF: sub_41488E+B0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+28h+var_20], offset a?_0 ;	"%;?&"
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Dest],	eax ; Dest
		call	sub_413FA0
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		add	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		jmp	loc_414A06
; ---------------------------------------------------------------------------

loc_41497E:				; CODE XREF: sub_41488E+17Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		cmp	eax, [ebp+var_C]
		jnz	short loc_414990
		mov	eax, 3Fh
		jmp	short loc_414995
; ---------------------------------------------------------------------------

loc_414990:				; CODE XREF: sub_41488E+F9j
		mov	eax, 26h

loc_414995:				; CODE XREF: sub_41488E+100j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_20], offset a?_1 ;	"%;?&="
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Dest],	eax ; Dest
		call	sub_413FA0
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_4149FE
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	3Dh
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+var_20], offset a?_1 ;	"%;?&="
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Dest],	eax ; Dest
		call	sub_413FA0
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		add	[ebp+var_10], eax

loc_4149FE:				; CODE XREF: sub_41488E+13Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_414A06:				; CODE XREF: sub_41488E+EBj
		cmp	[ebp+var_C], 0
		jnz	loc_41497E
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]

locret_414A19:				; CODE XREF: sub_41488E+B7j
		leave
		retn
sub_41488E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414A1B	proc near		; CODE XREF: sub_414AB2+15Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 1
		jmp	short loc_414A98
; ---------------------------------------------------------------------------

loc_414A2A:				; CODE XREF: sub_414A1B+8Fj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_414A3D
		mov	[ebp+var_4], 1
		jmp	short loc_414A94
; ---------------------------------------------------------------------------

loc_414A3D:				; CODE XREF: sub_414A1B+17j
		cmp	[ebp+var_4], 0
		jz	short loc_414A70
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_414A67
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ah
		jg	short loc_414A67
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sub	eax, 20h
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl

loc_414A67:				; CODE XREF: sub_414A1B+30j
					; sub_414A1B+3Aj
		mov	[ebp+var_4], 0
		jmp	short loc_414A94
; ---------------------------------------------------------------------------

loc_414A70:				; CODE XREF: sub_414A1B+26j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_414A94
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ah
		jg	short loc_414A94
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		add	eax, 20h
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl

loc_414A94:				; CODE XREF: sub_414A1B+20j
					; sub_414A1B+53j ...
		add	[ebp+arg_0], 1

loc_414A98:				; CODE XREF: sub_414A1B+Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short locret_414AB0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	loc_414A2A

locret_414AB0:				; CODE XREF: sub_414A1B+85j
		leave
		retn
sub_414A1B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414AB2(int, char *Str)
sub_414AB2	proc near		; CODE XREF: sub_414E72+398p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+Str]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_414B26
		mov	eax, [ebp+var_C]
		sub	eax, 1
		add	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_414B26
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+Str]
		add	eax, edx
		mov	byte ptr [eax],	0
		cmp	[ebp+var_C], 0
		jz	short loc_414B26
		mov	eax, [ebp+var_C]
		sub	eax, 1
		add	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_414B26
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+Str]
		add	eax, edx
		mov	byte ptr [eax],	0

loc_414B26:				; CODE XREF: sub_414AB2+2Ej
					; sub_414AB2+3Ej ...
		cmp	[ebp+var_C], 0
		jnz	short loc_414B3D
		mov	[esp+38h+Dest],	3Bh
		call	sub_4130C7
		jmp	loc_414E24
; ---------------------------------------------------------------------------

loc_414B3D:				; CODE XREF: sub_414AB2+78j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_414B55
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	loc_414C07

loc_414B55:				; CODE XREF: sub_414AB2+93j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		test	eax, eax
		jnz	short loc_414B70
		mov	[esp+38h+Dest],	0A8h
		call	sub_4130C7
		jmp	loc_414E24
; ---------------------------------------------------------------------------

loc_414B70:				; CODE XREF: sub_414AB2+ABj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_414BB9
		call	sub_4130FD
		jmp	loc_414E24
; ---------------------------------------------------------------------------

loc_414BB9:				; CODE XREF: sub_414AB2+FBj
		mov	ebx, [ebp+Str]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	eax, [eax+4]
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax
		call	sub_4265EB
		mov	[esp+38h+Source], ebx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	eax, [eax+4]
		mov	[esp+38h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_414E24
; ---------------------------------------------------------------------------

loc_414C07:				; CODE XREF: sub_414AB2+9Dj
		mov	eax, [ebp+Str]
		mov	[esp+38h+Dest],	eax
		call	sub_414A1B
		mov	[esp+38h+Source], 3Ah ;	Val
		mov	eax, [ebp+Str]
		mov	[esp+38h+Dest],	eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_414C3F
		mov	[esp+38h+Dest],	0A8h
		call	sub_4130C7
		jmp	loc_414E24
; ---------------------------------------------------------------------------

loc_414C3F:				; CODE XREF: sub_414AB2+17Aj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		jmp	short loc_414C4F
; ---------------------------------------------------------------------------

loc_414C4B:				; CODE XREF: sub_414AB2+1A5j
					; sub_414AB2+1AFj
		add	[ebp+var_10], 1

loc_414C4F:				; CODE XREF: sub_414AB2+197j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_414C4B
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_414C4B
		mov	eax, [ebp+var_10]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_14], eax
		jmp	short loc_414C95
; ---------------------------------------------------------------------------

loc_414C74:				; CODE XREF: sub_414AB2+1E7j
		mov	eax, [ebp+var_14]
		lea	edx, [eax+8]
		mov	eax, [ebp+Str]
		mov	[esp+38h+Source], eax ;	Str2
		mov	[esp+38h+Dest],	edx ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_414C9D
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_414C95:				; CODE XREF: sub_414AB2+1C0j
		cmp	[ebp+var_14], 0
		jnz	short loc_414C74
		jmp	short loc_414C9E
; ---------------------------------------------------------------------------

loc_414C9D:				; CODE XREF: sub_414AB2+1D9j
		nop

loc_414C9E:				; CODE XREF: sub_414AB2+1E9j
		cmp	[ebp+var_14], 0
		jz	loc_414D56
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 2
		mov	[esp+38h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_414D09
		call	sub_4130FD
		jmp	loc_414E24
; ---------------------------------------------------------------------------

loc_414D09:				; CODE XREF: sub_414AB2+24Bj
		mov	ebx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax
		call	sub_4265EB
		mov	word ptr [eax],	2Ch
		add	eax, 1
		mov	[esp+38h+Source], ebx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+38h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_414E24
; ---------------------------------------------------------------------------

loc_414D56:				; CODE XREF: sub_414AB2+1F0j
		mov	eax, [ebp+Str]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_414D93
		call	sub_4130FD
		jmp	loc_414E24
; ---------------------------------------------------------------------------

loc_414D93:				; CODE XREF: sub_414AB2+2D5j
		mov	eax, [ebp+Str]
		mov	edx, [ebp+var_14]
		add	edx, 8
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_414DF6
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	gcry_free
		call	sub_4130FD
		jmp	short loc_414E24
; ---------------------------------------------------------------------------

loc_414DF6:				; CODE XREF: sub_414AB2+330j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+34h], edx
		mov	eax, 0

loc_414E24:				; CODE XREF: sub_414AB2+86j
					; sub_414AB2+B9j ...
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_414AB2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414E2B(int, char *)
sub_414E2B	proc near		; CODE XREF: sub_40B9E4+2EEp
					; sub_414E72+3EAp ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_414E65
; ---------------------------------------------------------------------------

loc_414E3C:				; CODE XREF: sub_414E2B+3Ej
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_414E5D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		jmp	short locret_414E70
; ---------------------------------------------------------------------------

loc_414E5D:				; CODE XREF: sub_414E2B+28j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_414E65:				; CODE XREF: sub_414E2B+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_414E3C
		mov	eax, 0

locret_414E70:				; CODE XREF: sub_414E2B+30j
		leave
		retn
sub_414E2B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414E72	proc near		; CODE XREF: sub_4135D8+157p

Str		= dword	ptr -58h
Val		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Str1		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[ebp+var_14], eax
		jmp	short loc_414EB8
; ---------------------------------------------------------------------------

loc_414E85:				; CODE XREF: sub_414E72+4Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	eax, [eax+4]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+34h], edx

loc_414EB8:				; CODE XREF: sub_414E72+11j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		test	eax, eax
		jnz	short loc_414E85

loc_414EC2:				; CODE XREF: sub_414E72+13Dj
		mov	[ebp+var_2C], 4E20h
		mov	eax, [ebp+arg_0]
		lea	ebx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		lea	ecx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], ebx
		mov	[esp+58h+Val], ecx
		mov	[esp+58h+Str], eax
		call	sub_41C1F1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[ebp+Str1], eax
		cmp	[ebp+Str1], 0
		jnz	short loc_414F0E
		call	sub_4130FD
		jmp	loc_4152A0
; ---------------------------------------------------------------------------

loc_414F0E:				; CODE XREF: sub_414E72+90j
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_414F26
		mov	[esp+58h+Str], 4Ah
		call	sub_4130C7
		jmp	loc_4152A0
; ---------------------------------------------------------------------------

loc_414F26:				; CODE XREF: sub_414E72+A1j
		cmp	[ebp+var_1C], 0
		jnz	short loc_414F3D
		mov	[esp+58h+Str], 3FFFh
		call	sub_4130C7
		jmp	loc_4152A0
; ---------------------------------------------------------------------------

loc_414F3D:				; CODE XREF: sub_414E72+B8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		and	eax, 8
		test	eax, eax
		jz	short loc_414FA7
		mov	eax, [ebp+Str1]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	edx, eax
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_414F89
		mov	eax, [ebp+Str1]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_414F89
		mov	eax, 2
		jmp	short loc_414F8E
; ---------------------------------------------------------------------------

loc_414F89:				; CODE XREF: sub_414E72+101j
					; sub_414E72+10Ej
		mov	eax, 0

loc_414F8E:				; CODE XREF: sub_414E72+115j
		sub	edx, eax
		mov	eax, [ebp+Str1]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Val], edx ; char
		mov	[esp+58h+Str], offset aResp_S ;	"RESP: `%.*s'\n"
		call	sub_423387

loc_414FA7:				; CODE XREF: sub_414E72+D6j
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_414EC2
		mov	[esp+58h+Val], 2Fh ; Val
		mov	eax, [ebp+Str1]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_414FDB
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1

loc_414FDB:				; CODE XREF: sub_414E72+15Dj
		cmp	[ebp+var_C], 0
		jz	short loc_414FF8
		mov	[esp+58h+Val], offset aHttp_2 ;	"HTTP"
		mov	eax, [ebp+Str1]
		mov	[esp+58h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_415002

loc_414FF8:				; CODE XREF: sub_414E72+16Dj
		mov	eax, 0
		jmp	loc_4152A0
; ---------------------------------------------------------------------------

loc_415002:				; CODE XREF: sub_414E72+184j
		mov	[esp+58h+Val], offset asc_4313E1 ; " \t"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str], eax ; Str
		call	strpbrk
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41503E
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		mov	[esp+58h+Val], offset asc_4313E1 ; " \t"
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Str], eax ; Str
		call	strspn
		add	[ebp+var_10], eax

loc_41503E:				; CODE XREF: sub_414E72+1AAj
		cmp	[ebp+var_10], 0
		jnz	short loc_41504E
		mov	eax, 0
		jmp	loc_4152A0
; ---------------------------------------------------------------------------

loc_41504E:				; CODE XREF: sub_414E72+1D0j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	[esp+58h+Val], offset asc_4313E1 ; " \t"
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str], eax ; Str
		call	strpbrk
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41507A
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1

loc_41507A:				; CODE XREF: sub_414E72+1FCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		cmp	eax, 9
		ja	short loc_4150C0
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		cmp	eax, 9
		ja	short loc_4150C0
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		cmp	eax, 9
		ja	short loc_4150C0
		mov	eax, [ebp+var_C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4150E0

loc_4150C0:				; CODE XREF: sub_414E72+217j
					; sub_414E72+22Bj ...
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+8]
		or	edx, 2
		mov	[eax+8], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0C8h
		mov	eax, 0
		jmp	loc_4152A0
; ---------------------------------------------------------------------------

loc_4150E0:				; CODE XREF: sub_414E72+24Cj
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_4150F2:				; CODE XREF: sub_414E72+3BCj
		mov	[ebp+var_2C], 4E20h
		mov	eax, [ebp+arg_0]
		lea	ebx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		lea	ecx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], ebx
		mov	[esp+58h+Val], ecx
		mov	[esp+58h+Str], eax
		call	sub_41C1F1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[ebp+Str1], eax
		cmp	[ebp+Str1], 0
		jnz	short loc_41513E
		call	sub_4130FD
		jmp	loc_4152A0
; ---------------------------------------------------------------------------

loc_41513E:				; CODE XREF: sub_414E72+2C0j
		cmp	[ebp+var_1C], 0
		jnz	short loc_415155
		mov	[esp+58h+Str], 3FFFh
		call	sub_4130C7
		jmp	loc_4152A0
; ---------------------------------------------------------------------------

loc_415155:				; CODE XREF: sub_414E72+2D0j
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_41516C
		mov	eax, [ebp+Str1]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_415176

loc_41516C:				; CODE XREF: sub_414E72+2EBj
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41517C

loc_415176:				; CODE XREF: sub_414E72+2F8j
		mov	eax, [ebp+Str1]
		mov	byte ptr [eax],	0

loc_41517C:				; CODE XREF: sub_414E72+302j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		and	eax, 8
		test	eax, eax
		jz	short loc_4151E6
		mov	eax, [ebp+Str1]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	edx, eax
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4151C8
		mov	eax, [ebp+Str1]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4151C8
		mov	eax, 2
		jmp	short loc_4151CD
; ---------------------------------------------------------------------------

loc_4151C8:				; CODE XREF: sub_414E72+340j
					; sub_414E72+34Dj
		mov	eax, 0

loc_4151CD:				; CODE XREF: sub_414E72+354j
		sub	edx, eax
		mov	eax, [ebp+Str1]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Val], edx ; char
		mov	[esp+58h+Str], offset aResp_S ;	"RESP: `%.*s'\n"
		call	sub_423387

loc_4151E6:				; CODE XREF: sub_414E72+315j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		and	eax, 10h
		test	eax, eax
		jz	short loc_415220
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_415220
		mov	eax, [ebp+Str1]
		mov	[esp+58h+Val], eax ; Str
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax ; int
		call	sub_414AB2
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_415220
		mov	eax, [ebp+var_24]
		jmp	loc_4152A0
; ---------------------------------------------------------------------------

loc_415220:				; CODE XREF: sub_414E72+37Fj
					; sub_414E72+389j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_415234
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4150F2

loc_415234:				; CODE XREF: sub_414E72+3B2j
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax+10h]
		and	edx, 0FFFFFFFEh
		mov	[eax+10h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		and	eax, 20h
		test	eax, eax
		jnz	short loc_41529B
		mov	[esp+58h+Val], offset aContentLength ; "Content-Length"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax ; int
		call	sub_414E2B
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_41529B
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax+10h]
		or	edx, 1
		mov	[eax+10h], dl
		mov	[esp+58h+var_50], 0Ah
		mov	[esp+58h+Val], 0
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str], eax
		call	sub_429D50
		mov	ecx, [ebp+var_14]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx

loc_41529B:				; CODE XREF: sub_414E72+3DAj
					; sub_414E72+3F6j
		mov	eax, 0

loc_4152A0:				; CODE XREF: sub_414E72+97j
					; sub_414E72+AFj ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_414E72	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4152A7(char *Source, int)
sub_4152A7	proc near		; CODE XREF: sub_4141ED+222p
					; sub_4141ED+26Ap

cp		= dword	ptr -88h
type		= dword	ptr -84h
protocol	= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= word ptr -5Ch
var_50		= word ptr -50h
var_4E		= word ptr -4Eh
var_40		= word ptr -40h
var_3E		= word ptr -3Eh
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
s		= dword	ptr -0Ch
Source		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 88h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_5C], ax
		mov	[ebp+s], 0FFFFFFFFh
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		call	sub_413121
		mov	eax, [ebp+Source]
		mov	[esp+88h+cp], eax ; cp
		mov	eax, ds:inet_addr
		call	eax ; inet_addr
		sub	esp, 4
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		cmp	eax, 0FFFFFFFFh
		jz	loc_4153CA
		lea	eax, [ebp+var_40]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	[esp+88h+protocol], 0 ;	protocol
		mov	[esp+88h+type],	1 ; type
		mov	[esp+88h+cp], 2	; af
		mov	eax, ds:socket
		call	eax ; socket
		sub	esp, 0Ch
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jnz	short loc_415367
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	[esp+88h+type],	eax ; char
		mov	[esp+88h+cp], offset aErrorCreatingS ; "error creating socket: ec=%d\n"
		call	sub_4233B1
		mov	eax, 0FFFFFFFFh
		jmp	locret_415704
; ---------------------------------------------------------------------------

loc_415367:				; CODE XREF: sub_4152A7+9Dj
		mov	[ebp+var_40], 2
		movzx	eax, [ebp+var_5C]
		mov	[esp+88h+cp], eax ; hostshort
		mov	eax, ds:htons
		call	eax ; htons
		sub	esp, 4
		mov	[ebp+var_3E], ax
		lea	eax, [ebp+var_30]
		mov	eax, [eax]
		mov	[ebp+var_3C], eax
		mov	[esp+88h+protocol], 10h
		lea	eax, [ebp+var_40]
		mov	[esp+88h+type],	eax
		mov	eax, [ebp+s]
		mov	[esp+88h+cp], eax
		call	pth_connect
		test	eax, eax
		jnz	short loc_4153B0
		mov	eax, [ebp+s]
		jmp	locret_415704
; ---------------------------------------------------------------------------

loc_4153B0:				; CODE XREF: sub_4152A7+FFj
		mov	eax, [ebp+s]
		mov	[esp+88h+cp], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	locret_415704
; ---------------------------------------------------------------------------

loc_4153CA:				; CODE XREF: sub_4152A7+51j
		cmp	[ebp+var_24], 0
		jnz	short loc_415430
		mov	[esp+88h+type],	410h
		mov	[esp+88h+cp], 1
		call	gcry_calloc
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_4153F7
		mov	eax, 0FFFFFFFFh
		jmp	locret_415704
; ---------------------------------------------------------------------------

loc_4153F7:				; CODE XREF: sub_4152A7+144j
		mov	eax, [ebp+var_24]
		movzx	edx, [ebp+var_5C]
		mov	[eax+4], dx
		mov	eax, [ebp+var_24]
		lea	edx, [eax+0Ch]
		mov	[esp+88h+protocol], 401h ; Count
		mov	eax, [ebp+Source]
		mov	[esp+88h+type],	eax ; Source
		mov	[esp+88h+cp], edx ; Dest
		call	strncpy
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax+40Ch], 0
		mov	[ebp+var_10], 1

loc_415430:				; CODE XREF: sub_4152A7+127j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 0
		jmp	loc_415669
; ---------------------------------------------------------------------------

loc_415443:				; CODE XREF: sub_4152A7+3CEj
		mov	[ebp+var_2C], 0
		lea	eax, [ebp+var_50]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		shl	eax, 4
		mov	edx, eax
		shl	edx, 6
		add	eax, edx
		add	eax, [ebp+var_24]
		add	eax, 0Ch
		mov	[esp+88h+cp], eax ; name
		mov	eax, ds:gethostbyname
		call	eax ; gethostbyname
		sub	esp, 4
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	loc_415664
		mov	[ebp+var_14], 1
		cmp	[ebp+s], 0FFFFFFFFh
		jz	short loc_4154B2
		mov	eax, [ebp+s]
		mov	[esp+88h+cp], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_4154B2:				; CODE XREF: sub_4152A7+1F9j
		mov	eax, [ebp+var_2C]
		movzx	eax, word ptr [eax+8]
		cwde
		mov	[esp+88h+protocol], 0 ;	protocol
		mov	[esp+88h+type],	1 ; type
		mov	[esp+88h+cp], eax ; af
		mov	eax, ds:socket
		call	eax ; socket
		sub	esp, 0Ch
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jnz	short loc_415516
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+cp], eax ; int
		call	strerror
		mov	[esp+88h+type],	eax ; char
		mov	[esp+88h+cp], offset aErrorCreatin_0 ; "error creating socket: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_24]
		mov	[esp+88h+cp], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	locret_415704
; ---------------------------------------------------------------------------

loc_415516:				; CODE XREF: sub_4152A7+237j
		mov	eax, [ebp+var_2C]
		movzx	eax, word ptr [eax+8]
		mov	[ebp+var_50], ax
		movzx	eax, [ebp+var_50]
		cmp	ax, 2
		jz	short loc_415563
		mov	eax, [ebp+var_18]
		shl	eax, 4
		mov	edx, eax
		shl	edx, 6
		add	eax, edx
		add	eax, [ebp+var_24]
		add	eax, 0Ch
		mov	[esp+88h+type],	eax ; char
		mov	[esp+88h+cp], offset aUnknownAddress ; "unknown	address	family for `%s'\n"
		call	sub_4233B1
		mov	eax, [ebp+var_24]
		mov	[esp+88h+cp], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	locret_415704
; ---------------------------------------------------------------------------

loc_415563:				; CODE XREF: sub_4152A7+282j
		mov	eax, [ebp+var_18]
		shl	eax, 4
		mov	edx, eax
		shl	edx, 6
		add	eax, edx
		add	eax, [ebp+var_24]
		movzx	eax, word ptr [eax+4]
		movzx	eax, ax
		mov	[esp+88h+cp], eax ; hostshort
		mov	eax, ds:htons
		call	eax ; htons
		sub	esp, 4
		mov	[ebp+var_4E], ax
		mov	eax, [ebp+var_2C]
		movzx	eax, word ptr [eax+0Ah]
		cmp	ax, 4
		jz	short loc_4155D0
		mov	eax, [ebp+var_18]
		shl	eax, 4
		mov	edx, eax
		shl	edx, 6
		add	eax, edx
		add	eax, [ebp+var_24]
		add	eax, 0Ch
		mov	[esp+88h+type],	eax ; char
		mov	[esp+88h+cp], offset aIllegalAddress ; "illegal	address	length for `%s'\n"
		call	sub_4233B1
		mov	eax, [ebp+var_24]
		mov	[esp+88h+cp], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	locret_415704
; ---------------------------------------------------------------------------

loc_4155D0:				; CODE XREF: sub_4152A7+2EFj
		mov	[ebp+var_28], 0
		jmp	short loc_415644
; ---------------------------------------------------------------------------

loc_4155D9:				; CODE XREF: sub_4152A7+3B5j
		mov	eax, [ebp+var_2C]
		movzx	eax, word ptr [eax+0Ah]
		movsx	ecx, ax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_28]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	edx, eax
		lea	eax, [ebp+var_50]
		add	eax, 4
		mov	[esp+88h+protocol], ecx	; Size
		mov	[esp+88h+type],	edx ; Src
		mov	[esp+88h+cp], eax ; Dst
		call	memcpy
		mov	[esp+88h+protocol], 10h
		lea	eax, [ebp+var_50]
		mov	[esp+88h+type],	eax
		mov	eax, [ebp+s]
		mov	[esp+88h+cp], eax
		call	pth_connect
		test	eax, eax
		jz	short loc_41563B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		add	[ebp+var_28], 1
		jmp	short loc_415644
; ---------------------------------------------------------------------------

loc_41563B:				; CODE XREF: sub_4152A7+380j
		mov	[ebp+var_1C], 1
		jmp	short loc_415665
; ---------------------------------------------------------------------------

loc_415644:				; CODE XREF: sub_4152A7+330j
					; sub_4152A7+392j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_28]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_415665
		cmp	[ebp+var_1C], 0
		jz	loc_4155D9
		jmp	short loc_415665
; ---------------------------------------------------------------------------

loc_415664:				; CODE XREF: sub_4152A7+1E8j
		nop

loc_415665:				; CODE XREF: sub_4152A7+39Bj
					; sub_4152A7+3AFj ...
		add	[ebp+var_18], 1

loc_415669:				; CODE XREF: sub_4152A7+197j
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_10]
		jge	short loc_41567B
		cmp	[ebp+var_1C], 0
		jz	loc_415443

loc_41567B:				; CODE XREF: sub_4152A7+3C8j
		mov	eax, [ebp+var_24]
		mov	[esp+88h+cp], eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jnz	short loc_415701
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	ecx, eax
		cmp	[ebp+var_14], 0
		jz	short loc_4156A2
		mov	edx, offset byte_431360
		jmp	short loc_4156A7
; ---------------------------------------------------------------------------

loc_4156A2:				; CODE XREF: sub_4152A7+3F2j
		mov	edx, offset asc_431471 ; " - "

loc_4156A7:				; CODE XREF: sub_4152A7+3F9j
		cmp	[ebp+var_14], 0
		jz	short loc_4156B4
		mov	eax, offset byte_431360
		jmp	short loc_4156B9
; ---------------------------------------------------------------------------

loc_4156B4:				; CODE XREF: sub_4152A7+404j
		mov	eax, offset aHostNotFound ; "host not found"

loc_4156B9:				; CODE XREF: sub_4152A7+40Bj
		mov	[esp+88h+var_78], ecx
		mov	[esp+88h+var_7C], edx
		mov	[esp+88h+protocol], eax
		mov	eax, [ebp+Source]
		mov	[esp+88h+type],	eax ; char
		mov	[esp+88h+cp], offset aCanTConnectToS ; "can't connect to `%s': %s%sec=%d\n"
		call	sub_4233B1
		cmp	[ebp+s], 0FFFFFFFFh
		jz	short loc_4156EE
		mov	eax, [ebp+s]
		mov	[esp+88h+cp], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_4156EE:				; CODE XREF: sub_4152A7+435j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	short locret_415704
; ---------------------------------------------------------------------------

loc_415701:				; CODE XREF: sub_4152A7+3E3j
		mov	eax, [ebp+s]

locret_415704:				; CODE XREF: sub_4152A7+BBj
					; sub_4152A7+104j ...
		leave
		retn
sub_4152A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415706	proc near		; DATA XREF: .data:off_42B440o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+10h]
		and	eax, 1
		test	al, al
		jz	short loc_415763
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jnz	short loc_41573A
		mov	eax, 0
		jmp	loc_4157FC
; ---------------------------------------------------------------------------

loc_41573A:				; CODE XREF: sub_415706+28j
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+8]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+arg_8]
		mov	edx, 0
		cmp	ebx, edx
		ja	short loc_415763
		cmp	ebx, edx
		jb	short loc_415757
		cmp	ecx, eax
		jnb	short loc_415763

loc_415757:				; CODE XREF: sub_415706+4Bj
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		mov	[ebp+arg_8], eax

loc_415763:				; CODE XREF: sub_415706+19j
					; sub_415706+47j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	pth_read
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_415795
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_415763

loc_415795:				; CODE XREF: sub_415706+7Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+10h]
		and	eax, 1
		test	al, al
		jz	short loc_4157F9
		cmp	[ebp+var_10], 0
		jle	short loc_4157F9
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		mov	ebx, eax
		sar	ebx, 1Fh
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		cmp	ebx, edx
		ja	short loc_4157E8
		cmp	ebx, edx
		jb	short loc_4157C8
		cmp	ecx, eax
		jnb	short loc_4157E8

loc_4157C8:				; CODE XREF: sub_415706+BCj
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		mov	ecx, [ebp+var_10]
		mov	ebx, ecx
		sar	ebx, 1Fh
		sub	eax, ecx
		sbb	edx, ebx
		mov	ecx, [ebp+var_C]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		jmp	short loc_4157F9
; ---------------------------------------------------------------------------

loc_4157E8:				; CODE XREF: sub_415706+B8j
					; sub_415706+C0j
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0

loc_4157F9:				; CODE XREF: sub_415706+9Bj
					; sub_415706+A1j ...
		mov	eax, [ebp+var_10]

loc_4157FC:				; CODE XREF: sub_415706+2Fj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_415706	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415802	proc near		; DATA XREF: .data:off_42B444o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0

loc_415815:				; CODE XREF: sub_415802+43j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	pth_write
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_415847
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_415815

loc_415847:				; CODE XREF: sub_415802+35j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_415802	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41584C	proc near		; DATA XREF: .data:off_42B44Co

s		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_415865
		mov	eax, 0
		jmp	short locret_41589F
; ---------------------------------------------------------------------------

loc_415865:				; CODE XREF: sub_41584C+10j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41588F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+10h]
		and	eax, 2
		test	al, al
		jnz	short loc_41588F
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_41588F:				; CODE XREF: sub_41584C+21j
					; sub_41584C+2Fj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+s], eax
		call	gcry_free
		mov	eax, 0

locret_41589F:				; CODE XREF: sub_41584C+17j
		leave
		retn
sub_41584C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4158A4	proc near		; CODE XREF: sub_4158CB+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4158C4
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4158C9
; ---------------------------------------------------------------------------

loc_4158C4:				; CODE XREF: sub_4158A4+7j
		mov	eax, 0

loc_4158C9:				; CODE XREF: sub_4158A4+1Ej
		pop	ebp
		retn
sub_4158A4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4158CB	proc near		; CODE XREF: sub_415A73+17p
					; sub_415A73+4Bp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_4158A4
		leave
		retn
sub_4158CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4158E6	proc near		; CODE XREF: sub_415940+9p
					; sub_420043:loc_420172p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0
		call	sub_429850
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_435804
		test	eax, eax
		jnz	short loc_415909
		mov	eax, [ebp+var_C]
		jmp	short locret_41593E
; ---------------------------------------------------------------------------

loc_415909:				; CODE XREF: sub_4158E6+1Cj
		mov	eax, ds:dword_435804
		cmp	eax, 1
		jnz	short loc_41591A
		mov	eax, ds:dword_435800
		jmp	short locret_41593E
; ---------------------------------------------------------------------------

loc_41591A:				; CODE XREF: sub_4158E6+2Bj
		mov	eax, ds:dword_435804
		cmp	eax, 2
		jnz	short loc_415930
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_435800
		add	eax, edx
		jmp	short locret_41593E
; ---------------------------------------------------------------------------

loc_415930:				; CODE XREF: sub_4158E6+3Cj
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_435800
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_41593E:				; CODE XREF: sub_4158E6+21j
					; sub_4158E6+32j ...
		leave
		retn
sub_4158E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415940(char *)
sub_415940	proc near		; CODE XREF: sub_4020C2+9C7p
					; sub_408DFB+4Ep ...

Dest		= dword	ptr -58h
Format		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		call	sub_4158E6
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		test	eax, eax
		jns	short loc_415960
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		jmp	short loc_4159CC
; ---------------------------------------------------------------------------

loc_415960:				; CODE XREF: sub_415940+16j
		lea	eax, [ebp+var_20]
		mov	[esp+58h+Dest],	eax
		call	sub_42A060
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	esi, [eax]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		lea	edi, [eax+76Ch]
		mov	eax, offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	[esp+58h+var_3C], esi
		mov	[esp+58h+var_40], ebx
		mov	[esp+58h+var_44], ecx
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], edi
		mov	[esp+58h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dest],	eax ; Dest
		call	sprintf

loc_4159CC:				; CODE XREF: sub_415940+1Ej
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_415940	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4159D4	proc near		; CODE XREF: sub_4020C2+82Dp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0
		call	sub_429850
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	short loc_4159F7
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_415A0D

loc_4159F7:				; CODE XREF: sub_4159D4+19j
		mov	ds:dword_435804, 0
		mov	ds:dword_435800, 0
		jmp	short locret_415A67
; ---------------------------------------------------------------------------

loc_415A0D:				; CODE XREF: sub_4159D4+21j
		cmp	[ebp+arg_4], 0
		jz	short loc_415A27
		mov	ds:dword_435804, 1
		mov	eax, [ebp+var_C]
		mov	ds:dword_435800, eax
		jmp	short locret_415A67
; ---------------------------------------------------------------------------

loc_415A27:				; CODE XREF: sub_4159D4+3Dj
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_C]
		jle	short loc_415A4C
		mov	ds:dword_435804, 2
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_435800, eax
		jmp	short locret_415A67
; ---------------------------------------------------------------------------

loc_415A4C:				; CODE XREF: sub_4159D4+59j
		mov	ds:dword_435804, 3
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_435800, eax

locret_415A67:				; CODE XREF: sub_4159D4+37j
					; sub_4159D4+51j ...
		leave
		retn
sub_4159D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415A69	proc near		; CODE XREF: sub_4020C2:loc_402A77p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_435804
		pop	ebp
		retn
sub_415A69	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415A73	proc near		; CODE XREF: sub_40751E+570p
					; sub_40751E+582p ...

var_14		= dword	ptr -14h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415A94
		mov	[esp+14h+var_14], 1Ah
		call	sub_4158CB
		jmp	locret_415B2D
; ---------------------------------------------------------------------------

loc_415A94:				; CODE XREF: sub_415A73+Ej
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_415ACD
; ---------------------------------------------------------------------------

loc_415AA3:				; CODE XREF: sub_415A73+5Ej
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_415AB7
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_415AC5

loc_415AB7:				; CODE XREF: sub_415A73+38j
		mov	[esp+14h+var_14], 0A1h
		call	sub_4158CB
		jmp	short locret_415B2D
; ---------------------------------------------------------------------------

loc_415AC5:				; CODE XREF: sub_415A73+42j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_415ACD:				; CODE XREF: sub_415A73+2Ej
		cmp	[ebp+var_4], 7
		jle	short loc_415AA3
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_415AEB
		mov	[esp+14h+var_14], 0A1h
		call	sub_4158CB
		jmp	short locret_415B2D
; ---------------------------------------------------------------------------

loc_415AEB:				; CODE XREF: sub_415A73+68j
		add	[ebp+var_8], 1
		mov	[ebp+var_4], 9
		jmp	short loc_415B22
; ---------------------------------------------------------------------------

loc_415AF8:				; CODE XREF: sub_415A73+B3j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_415B0C
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_415B1A

loc_415B0C:				; CODE XREF: sub_415A73+8Dj
		mov	[esp+14h+var_14], 0A1h
		call	sub_4158CB
		jmp	short locret_415B2D
; ---------------------------------------------------------------------------

loc_415B1A:				; CODE XREF: sub_415A73+97j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_415B22:				; CODE XREF: sub_415A73+83j
		cmp	[ebp+var_4], 0Eh
		jle	short loc_415AF8
		mov	eax, 0

locret_415B2D:				; CODE XREF: sub_415A73+1Cj
					; sub_415A73+50j ...
		leave
		retn
sub_415A73	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415B2F	proc near		; CODE XREF: sub_415D59+8Dp

var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_415B9F
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_415B9F
		mov	[ebp+var_8], 0

loc_415B9F:				; CODE XREF: sub_415B2F+3Dj
					; sub_415B2F+67j
		cmp	[ebp+var_8], 0
		jz	short loc_415BAC
		mov	eax, 16Eh
		jmp	short loc_415BB1
; ---------------------------------------------------------------------------

loc_415BAC:				; CODE XREF: sub_415B2F+74j
		mov	eax, 16Dh

loc_415BB1:				; CODE XREF: sub_415B2F+7Bj
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_415B2F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415BB7	proc near		; CODE XREF: sub_415D59+105p
					; sub_415D59+125p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	[ebp+arg_4], 0Ch
		ja	loc_415C8E
		mov	eax, [ebp+arg_4]
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		and	edx, 15AAh
		test	edx, edx
		jnz	short loc_415C00
		mov	edx, eax
		and	edx, 0A50h
		test	edx, edx
		jnz	loc_415C87
		and	eax, 4
		test	eax, eax
		jnz	short loc_415C0A
		jmp	loc_415C8E
; ---------------------------------------------------------------------------

loc_415C00:				; CODE XREF: sub_415BB7+2Bj
		mov	eax, 1Fh
		jmp	loc_415CAA
; ---------------------------------------------------------------------------

loc_415C0A:				; CODE XREF: sub_415BB7+42j
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_415C73
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_415C73
		mov	[ebp+var_C], 0

loc_415C73:				; CODE XREF: sub_415BB7+89j
					; sub_415BB7+B3j
		cmp	[ebp+var_C], 0
		jz	short loc_415C80
		mov	eax, 1Dh
		jmp	short loc_415C85
; ---------------------------------------------------------------------------

loc_415C80:				; CODE XREF: sub_415BB7+C0j
		mov	eax, 1Ch

loc_415C85:				; CODE XREF: sub_415BB7+C7j
		jmp	short loc_415CAA
; ---------------------------------------------------------------------------

loc_415C87:				; CODE XREF: sub_415BB7+37j
		mov	eax, 1Eh
		jmp	short loc_415CAA
; ---------------------------------------------------------------------------

loc_415C8E:				; CODE XREF: sub_415BB7+Bj
					; sub_415BB7+44j
		mov	[esp+28h+var_20], offset aDays_per_month ; "days_per_month"
		mov	[esp+28h+var_24], 0B2h
		mov	[esp+28h+var_28], offset a____Dirmngr1_5 ; "../../dirmngr-1.1.1/src/misc.c"
		call	sub_423540
; ---------------------------------------------------------------------------

loc_415CAA:				; CODE XREF: sub_415BB7+4Ej
					; sub_415BB7:loc_415C85j ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_415BB7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415CB0	proc near		; CODE XREF: sub_415D59+76p
					; sub_415D59+E7p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		imul	ecx, eax, 16Dh
		mov	eax, [ebp+arg_4]
		lea	edx, [eax-1]
		mov	eax, edx
		shl	eax, 5
		sub	eax, edx
		add	eax, ecx
		add	eax, [ebp+arg_8]
		add	eax, 1A42E4h
		mov	[ebp+var_8], eax
		cmp	[ebp+arg_4], 2
		jg	short loc_415CE6
		sub	[ebp+arg_0], 1
		jmp	short loc_415D09
; ---------------------------------------------------------------------------

loc_415CE6:				; CODE XREF: sub_415CB0+2Ej
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		lea	ecx, [eax+17h]
		mov	edx, 66666667h
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		sub	[ebp+var_8], eax

loc_415D09:				; CODE XREF: sub_415CB0+34j
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	ebx, eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		lea	edx, [eax+1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		add	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_415CB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415D59	proc near		; CODE XREF: sub_415EF7+2D2p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jnz	short loc_415D6F
		mov	eax, 0
		jmp	locret_415EF5
; ---------------------------------------------------------------------------

loc_415D6F:				; CODE XREF: sub_415D59+Aj
		cmp	[ebp+arg_0], 1A4450h
		jbe	short loc_415D81
		cmp	[ebp+arg_0], 2B61CDh
		jbe	short loc_415D8B

loc_415D81:				; CODE XREF: sub_415D59+1Dj
		mov	eax, 0
		jmp	locret_415EF5
; ---------------------------------------------------------------------------

loc_415D8B:				; CODE XREF: sub_415D59+26j
		mov	eax, [ebp+arg_0]
		sub	eax, 1A42E4h
		mov	[ebp+var_1C], eax
		mov	edx, 0B30F6353h
		mov	eax, [ebp+var_1C]
		mul	edx
		mov	eax, edx
		shr	eax, 8
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_415DBB
; ---------------------------------------------------------------------------

loc_415DB7:				; CODE XREF: sub_415D59+95j
		add	[ebp+var_C], 1

loc_415DBB:				; CODE XREF: sub_415D59+5Cj
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_415CB0
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_415B2F
		cmp	[ebp+var_18], eax
		jg	short loc_415DB7
		mov	ecx, [ebp+var_18]
		mov	edx, 84210843h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 4
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_415E2C
; ---------------------------------------------------------------------------

loc_415E17:				; CODE XREF: sub_415D59+10Dj
		add	[ebp+var_10], 1
		cmp	[ebp+var_10], 0Ch
		jle	short loc_415E2C
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_415E2C:				; CODE XREF: sub_415D59+BCj
					; sub_415D59+C6j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_415CB0
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_415BB7
		cmp	[ebp+var_18], eax
		jg	short loc_415E17
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_415BB7
		cmp	eax, [ebp+var_14]
		jge	short loc_415E93
		mov	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_415E93:				; CODE XREF: sub_415D59+12Dj
		cmp	[ebp+var_10], 0Ch
		jle	short loc_415EA4
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_415EA4:				; CODE XREF: sub_415D59+13Ej
		cmp	[ebp+arg_4], 0
		jz	short loc_415EB2
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_415EB2:				; CODE XREF: sub_415D59+14Fj
		cmp	[ebp+arg_8], 0
		jz	short loc_415EC0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_415EC0:				; CODE XREF: sub_415D59+15Dj
		cmp	[ebp+arg_C], 0
		jz	short loc_415ECE
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx

loc_415ECE:				; CODE XREF: sub_415D59+16Bj
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_415CB0
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1

locret_415EF5:				; CODE XREF: sub_415D59+11j
					; sub_415D59+2Dj
		leave
		retn
sub_415D59	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415EF7(char *, int)
sub_415EF7	proc near		; CODE XREF: sub_408DFB+C1p
					; sub_40989B+187p ...

Dest		= dword	ptr -58h
Format		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 50h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dest],	eax
		call	sub_415A73
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_415F1B
		mov	eax, [ebp+var_C]
		jmp	loc_41624E
; ---------------------------------------------------------------------------

loc_415F1B:				; CODE XREF: sub_415EF7+1Aj
		cmp	[ebp+arg_4], 0
		js	short loc_415F2A
		cmp	[ebp+arg_4], 7FFFFFC1h
		jle	short loc_415F3B

loc_415F2A:				; CODE XREF: sub_415EF7+28j
		mov	[esp+58h+Dest],	37h
		call	sub_4158CB
		jmp	loc_41624E
; ---------------------------------------------------------------------------

loc_415F3B:				; CODE XREF: sub_415EF7+31j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_0]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_0]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_0]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_24]
		cmp	eax, 62Eh
		jg	short loc_41609E
		mov	[esp+58h+Dest],	37h
		call	sub_4158CB
		jmp	loc_41624E
; ---------------------------------------------------------------------------

loc_41609E:				; CODE XREF: sub_415EF7+194j
		mov	eax, [ebp+arg_4]
		add	[ebp+var_18], eax
		mov	ecx, [ebp+var_18]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		mov	ecx, [ebp+var_18]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp+var_18], eax
		mov	ecx, [ebp+var_14]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_10], eax
		mov	ecx, [ebp+var_14]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp+var_14], eax
		mov	ecx, [ebp+var_10]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		mov	ecx, [ebp+var_10]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp+var_10], eax
		mov	ecx, [ebp+var_2C]
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_50], ecx
		mov	[esp+58h+Format], edx
		mov	[esp+58h+Dest],	eax
		call	sub_415CB0
		mov	edx, [ebp+var_1C]
		add	eax, edx
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_4C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_50], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+Format], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dest],	eax
		call	sub_415D59
		mov	eax, [ebp+var_24]
		cmp	eax, 270Fh
		jg	short loc_4161FD
		mov	eax, [ebp+var_28]
		cmp	eax, 0Ch
		jg	short loc_4161FD
		mov	eax, [ebp+var_2C]
		cmp	eax, 1Fh
		jg	short loc_4161FD
		mov	eax, [ebp+var_24]
		test	eax, eax
		js	short loc_4161FD
		mov	eax, [ebp+var_28]
		test	eax, eax
		jle	short loc_4161FD
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jg	short loc_41620B

loc_4161FD:				; CODE XREF: sub_415EF7+2DFj
					; sub_415EF7+2E7j ...
		mov	[esp+58h+Dest],	37h
		call	sub_4158CB
		jmp	short loc_41624E
; ---------------------------------------------------------------------------

loc_41620B:				; CODE XREF: sub_415EF7+304j
		mov	ebx, [ebp+var_2C]
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	eax, offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	esi, [ebp+var_18]
		mov	[esp+58h+var_3C], esi
		mov	esi, [ebp+var_14]
		mov	[esp+58h+var_40], esi
		mov	esi, [ebp+var_10]
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+var_4C], ecx
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dest],	eax ; Dest
		call	sprintf
		mov	eax, 0

loc_41624E:				; CODE XREF: sub_415EF7+1Fj
					; sub_415EF7+3Fj ...
		add	esp, 50h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_415EF7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416255	proc near		; CODE XREF: sub_4088CA+52p
					; sub_4091A1+64p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_4], eax
		mov	[ebp+var_8], 0
		jmp	loc_416317
; ---------------------------------------------------------------------------

loc_41626D:				; CODE XREF: sub_416255+116j
					; sub_416255+134j ...
		cmp	[ebp+arg_0], 0
		jz	loc_41630F
		mov	eax, [ebp+var_8]
		mov	edx, [ebp+arg_0]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41629D
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4162C9
; ---------------------------------------------------------------------------

loc_41629D:				; CODE XREF: sub_416255+33j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4162B8
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4162C7
; ---------------------------------------------------------------------------

loc_4162B8:				; CODE XREF: sub_416255+50j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4162C7:				; CODE XREF: sub_416255+61j
		mov	edx, eax

loc_4162C9:				; CODE XREF: sub_416255+46j
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4162E4
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_41630B
; ---------------------------------------------------------------------------

loc_4162E4:				; CODE XREF: sub_416255+7Fj
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4162FF
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_41630B
; ---------------------------------------------------------------------------

loc_4162FF:				; CODE XREF: sub_416255+9Aj
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_41630B:				; CODE XREF: sub_416255+8Dj
					; sub_416255+A8j
		add	eax, edx
		mov	[ecx], al

loc_41630F:				; CODE XREF: sub_416255+1Cj
		add	[ebp+var_8], 1
		add	[ebp+var_4], 2

loc_416317:				; CODE XREF: sub_416255+13j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41632B
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_416353

loc_41632B:				; CODE XREF: sub_416255+CAj
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41633F
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_416353

loc_41633F:				; CODE XREF: sub_416255+DEj
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4163AD
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4163AD

loc_416353:				; CODE XREF: sub_416255+D4j
					; sub_416255+E8j
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_416371
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	loc_41626D

loc_416371:				; CODE XREF: sub_416255+109j
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41638F
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	loc_41626D

loc_41638F:				; CODE XREF: sub_416255+127j
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4163AD
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_41626D

loc_4163AD:				; CODE XREF: sub_416255+F2j
					; sub_416255+FCj ...
		mov	eax, [ebp+var_8]
		leave
		retn
sub_416255	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4163B2	proc near		; CODE XREF: sub_40A08A+5AAp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= byte ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], 2
		call	gcry_md_hash_buffer
		mov	[esp+38h+var_34], 14h
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	sub_4163EE
		leave
		retn
sub_4163B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4163EE	proc near		; CODE XREF: sub_408DFB+21Dp
					; sub_408DFB+2CEp ...

Dest		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		add	eax, eax
		add	eax, 1
		mov	[esp+28h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41643C
; ---------------------------------------------------------------------------

loc_416410:				; CODE XREF: sub_4163EE+58j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	ecx, al
		add	[ebp+arg_0], 1
		mov	edx, offset a02x_2 ; "%02X"
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_C], 2

loc_41643C:				; CODE XREF: sub_4163EE+20j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, edx
		cmp	eax, edx
		jb	short loc_416410
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4163EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41644D	proc near		; CODE XREF: sub_404A97+6Bp
					; sub_409E74+2Ep ...

Str		= dword	ptr -38h
EndPtr		= dword	ptr -34h
Radix		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_416469
		mov	eax, 0
		jmp	locret_4164FA
; ---------------------------------------------------------------------------

loc_416469:				; CODE XREF: sub_41644D+10j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	edx, [ebp+var_1C]
		mov	[esp+38h+EndPtr], edx ;	EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_4164A1
		mov	eax, 0
		jmp	short locret_4164FA
; ---------------------------------------------------------------------------

loc_4164A1:				; CODE XREF: sub_41644D+4Bj
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, 1
		mov	[esp+38h+Str], eax
		call	gcry_xmalloc
		mov	[ebp+var_18], eax
		add	[ebp+var_C], 1
		jmp	short loc_4164F1
; ---------------------------------------------------------------------------

loc_4164C1:				; CODE XREF: sub_41644D+A8j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	ecx, al
		mov	edx, offset a02x_2 ; "%02X"
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_18]
		mov	[esp+38h+Radix], ecx
		mov	[esp+38h+EndPtr], edx ;	Format
		mov	[esp+38h+Str], eax ; Dest
		call	sprintf
		add	[ebp+var_14], 2
		sub	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_4164F1:				; CODE XREF: sub_41644D+72j
		cmp	[ebp+var_10], 0
		jnz	short loc_4164C1
		mov	eax, [ebp+var_18]

locret_4164FA:				; CODE XREF: sub_41644D+17j
					; sub_41644D+52j
		leave
		retn
sub_41644D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4164FC	proc near		; CODE XREF: sub_40989B+201p

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_416518
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_41651F

loc_416518:				; CODE XREF: sub_4164FC+10j
		mov	eax, 0
		jmp	short locret_416566
; ---------------------------------------------------------------------------

loc_41651F:				; CODE XREF: sub_4164FC+1Aj
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Radix], 0Ah ; Radix
		lea	edx, [ebp+var_14]
		mov	[esp+28h+EndPtr], edx ;	EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_416557
		mov	eax, 0
		jmp	short locret_416566
; ---------------------------------------------------------------------------

loc_416557:				; CODE XREF: sub_4164FC+52j
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_C]

locret_416566:				; CODE XREF: sub_4164FC+21j
					; sub_4164FC+59j
		leave
		retn
sub_4164FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416568	proc near		; CODE XREF: sub_40751E+215p
					; sub_40751E+22Bp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		jmp	loc_416664
; ---------------------------------------------------------------------------

loc_41657F:				; CODE XREF: sub_416568+104j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_416651
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_416651
		mov	eax, [ebp+var_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_416651
		add	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4165D0
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4165FC
; ---------------------------------------------------------------------------

loc_4165D0:				; CODE XREF: sub_416568+53j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4165EB
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4165FA
; ---------------------------------------------------------------------------

loc_4165EB:				; CODE XREF: sub_416568+70j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4165FA:				; CODE XREF: sub_416568+81j
		mov	edx, eax

loc_4165FC:				; CODE XREF: sub_416568+66j
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_416617
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_41663E
; ---------------------------------------------------------------------------

loc_416617:				; CODE XREF: sub_416568+9Fj
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_416632
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_41663E
; ---------------------------------------------------------------------------

loc_416632:				; CODE XREF: sub_416568+BAj
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_41663E:				; CODE XREF: sub_416568+ADj
					; sub_416568+C8j
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		add	[ebp+var_8], 1
		add	[ebp+var_4], 2
		jmp	short loc_416664
; ---------------------------------------------------------------------------

loc_416651:				; CODE XREF: sub_416568+1Fj
					; sub_416568+30j ...
		mov	eax, [ebp+var_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		add	[ebp+var_8], 1
		add	[ebp+var_4], 1

loc_416664:				; CODE XREF: sub_416568+12j
					; sub_416568+E7j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_41657F
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_416568	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41667D	proc near		; CODE XREF: sub_417CE7+3Fp
					; sub_418114+438p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0 ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4166D5
		mov	[esp+28h+var_28], offset aInvalidCanonic ; "invalid canonical S-expression found\n"
		call	sub_4233B1
		mov	[esp+28h+var_28], 53h
		call	sub_4158CB
		mov	[ebp+var_C], eax
		jmp	short loc_416724
; ---------------------------------------------------------------------------

loc_4166D5:				; CODE XREF: sub_41667D+39j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], 0
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41671C
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aConvertingSE_0 ; "converting S-expression failed: %s\n"
		call	sub_4233B1
		jmp	short loc_416724
; ---------------------------------------------------------------------------

loc_41671C:				; CODE XREF: sub_41667D+80j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_416724:				; CODE XREF: sub_41667D+56j
					; sub_41667D+9Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41667D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416729	proc near		; CODE XREF: sub_416BE5+1A5p
					; sub_417BEE+12p ...

Dest		= dword	ptr -68h
Format		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+Format], 2
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+Dest],	eax
		call	gcry_md_open
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_416771
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dest],	eax
		call	gpg_strerror
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+Dest],	offset aGcry_md_open_0 ; "gcry_md_open failed: %s\n"
		call	sub_4233F4
; ---------------------------------------------------------------------------

loc_416771:				; CODE XREF: sub_416729+2Bj
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], offset gcry_md_write
		mov	[esp+68h+Format], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Dest],	eax
		call	ksba_cert_hash
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4167DE
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dest],	eax
		call	gpg_strerror
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+Dest],	offset aOopsKsba_cer_0 ; "oops:	ksba_cert_hash failed: %s\n"
		call	sub_4233B1
		lea	eax, [ebp+var_38]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	dword ptr [eax+8], 0FFFFFFFFh
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		jmp	short loc_416831
; ---------------------------------------------------------------------------

loc_4167DE:				; CODE XREF: sub_416729+71j
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+Format], 5
		mov	[esp+68h+Dest],	eax
		call	gcry_md_ctl
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Format], 2
		mov	[esp+68h+Dest],	eax
		call	gcry_md_read
		mov	edx, [eax]
		mov	[ebp+var_38], edx
		mov	edx, [eax+4]
		mov	[ebp+var_34], edx
		mov	edx, [eax+8]
		mov	[ebp+var_30], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_2C], edx
		mov	eax, [eax+10h]
		mov	[ebp+var_28], eax

loc_416831:				; CODE XREF: sub_416729+B3j
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Dest],	eax
		call	gcry_md_close
		mov	[esp+68h+Dest],	29h
		call	gcry_xmalloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	[ebp+var_1C], 0
		jmp	short loc_4168A1
; ---------------------------------------------------------------------------

loc_41685A:				; CODE XREF: sub_416729+17Cj
		lea	eax, [ebp+var_38]
		add	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	esi, al
		mov	ebx, offset a02x_2 ; "%02X"
		mov	eax, [ebp+var_24]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_24]
		mov	[esp+68h+var_60], esi
		mov	[esp+68h+Format], ebx ;	Format
		mov	[esp+68h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_1C], 1

loc_4168A1:				; CODE XREF: sub_416729+12Fj
		cmp	[ebp+var_1C], 13h
		jle	short loc_41685A
		mov	eax, [ebp+var_24]
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_416729	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4168B2	proc near		; CODE XREF: sub_40CD34+2F7p

Dest		= dword	ptr -68h
Format		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+Format], 2
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+Dest],	eax
		call	gcry_md_open
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4168FA
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dest],	eax
		call	gpg_strerror
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+Dest],	offset aGcry_md_open_0 ; "gcry_md_open failed: %s\n"
		call	sub_4233F4
; ---------------------------------------------------------------------------

loc_4168FA:				; CODE XREF: sub_4168B2+2Bj
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], offset gcry_md_write
		mov	[esp+68h+Format], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Dest],	eax
		call	ksba_cert_hash
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_416967
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dest],	eax
		call	gpg_strerror
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+Dest],	offset aOopsKsba_cer_0 ; "oops:	ksba_cert_hash failed: %s\n"
		call	sub_4233B1
		lea	eax, [ebp+var_38]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	dword ptr [eax+8], 0FFFFFFFFh
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		jmp	short loc_4169BA
; ---------------------------------------------------------------------------

loc_416967:				; CODE XREF: sub_4168B2+71j
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+Format], 5
		mov	[esp+68h+Dest],	eax
		call	gcry_md_ctl
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Format], 2
		mov	[esp+68h+Dest],	eax
		call	gcry_md_read
		mov	edx, [eax]
		mov	[ebp+var_38], edx
		mov	edx, [eax+4]
		mov	[ebp+var_34], edx
		mov	edx, [eax+8]
		mov	[ebp+var_30], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_2C], edx
		mov	eax, [eax+10h]
		mov	[ebp+var_28], eax

loc_4169BA:				; CODE XREF: sub_4168B2+B3j
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Dest],	eax
		call	gcry_md_close
		mov	[esp+68h+Dest],	3Dh
		call	gcry_xmalloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	[ebp+var_1C], 0
		jmp	short loc_416A2A
; ---------------------------------------------------------------------------

loc_4169E3:				; CODE XREF: sub_4168B2+17Cj
		lea	eax, [ebp+var_38]
		add	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	esi, al
		mov	ebx, offset a02x_3 ; "%02X:"
		mov	eax, [ebp+var_24]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_24]
		mov	[esp+68h+var_60], esi
		mov	[esp+68h+Format], ebx ;	Format
		mov	[esp+68h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_1C], 1

loc_416A2A:				; CODE XREF: sub_4168B2+12Fj
		cmp	[ebp+var_1C], 13h
		jle	short loc_4169E3
		mov	eax, [ebp+var_24]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_24]
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4168B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416A63	proc near		; CODE XREF: sub_40989B+3FDp
					; sub_40989B+427p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41644D
		mov	dword ptr [ebp+var_C], eax
		cmp	dword ptr [ebp+var_C], 0
		jz	short loc_416A82
		mov	eax, dword ptr [ebp+var_C]
		jmp	short loc_416A87
; ---------------------------------------------------------------------------

loc_416A82:				; CODE XREF: sub_416A63+18j
		mov	eax, offset a?_2 ; "?"

loc_416A87:				; CODE XREF: sub_416A63+1Dj
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aS_2 ;	"%s"
		call	sub_423478
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		leave
		retn
sub_416A63	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416AA4	proc near		; CODE XREF: sub_416BE5+AEp
					; sub_416BE5+EBp ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		cmp	dword ptr [ebp+arg_0], 0
		jz	short loc_416ABC
		mov	eax, dword ptr [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_416ACA

loc_416ABC:				; CODE XREF: sub_416AA4+Cj
		mov	[esp+28h+var_28], offset aNone_3 ; "[none]"
		call	sub_423478
		jmp	short loc_416B0F
; ---------------------------------------------------------------------------

loc_416ACA:				; CODE XREF: sub_416AA4+16j
		mov	eax, dword ptr [ebp+arg_0]
		lea	esi, [eax+0Dh]
		mov	eax, dword ptr [ebp+arg_0]
		lea	ebx, [eax+0Bh]
		mov	eax, dword ptr [ebp+arg_0]
		lea	ecx, [eax+9]
		mov	eax, dword ptr [ebp+arg_0]
		lea	edx, [eax+6]
		mov	eax, dword ptr [ebp+arg_0]
		add	eax, 4
		mov	[esp+28h+var_10], esi
		mov	[esp+28h+var_14], ebx
		mov	[esp+28h+var_18], ecx
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset a_4s_2s_2s_2s_2 ; "%.4s-%.2s-%.2s %.2s:%.2s:%s"
		call	sub_423478

loc_416B0F:				; CODE XREF: sub_416AA4+24j
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_416AA4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416B16	proc near		; CODE XREF: sub_40989B+43Ep
					; sub_40E092+2A2p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_416B34
		mov	[esp+38h+var_38], offset aError	; "[error]"
		call	sub_423478
		jmp	loc_416BDF
; ---------------------------------------------------------------------------

loc_416B34:				; CODE XREF: sub_416B16+Bj
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_416B5E
; ---------------------------------------------------------------------------

loc_416B3C:				; CODE XREF: sub_416B16+50j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_416B68
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jbe	short loc_416B5A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0A0h
		jbe	short loc_416B68

loc_416B5A:				; CODE XREF: sub_416B16+38j
		add	[ebp+var_C], 1

loc_416B5E:				; CODE XREF: sub_416B16+24j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_416B3C

loc_416B68:				; CODE XREF: sub_416B16+2Ej
					; sub_416B16+42j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_416B91
		mov	eax, dword ptr [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jz	short loc_416B91
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aS_2 ;	"%s"
		call	sub_423478
		jmp	short loc_416BDF
; ---------------------------------------------------------------------------

loc_416B91:				; CODE XREF: sub_416B16+5Aj
					; sub_416B16+64j
		mov	[esp+38h+var_38], offset asc_4315A7 ; "[ "
		call	sub_423478
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+38h+var_30], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], 0
		call	sub_4234A8
		mov	[esp+38h+var_38], offset asc_4315AA ; "	]"
		call	sub_423478

loc_416BDF:				; CODE XREF: sub_416B16+19j
					; sub_416B16+79j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_416B16	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416BE5	proc near		; CODE XREF: sub_40957E+10Ep
					; sub_420043+92p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_20		= byte ptr -20h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	dword ptr [ebp+arg_0], 0
		jz	short loc_416BF6
		mov	eax, dword ptr [ebp+arg_0]
		jmp	short loc_416BFB
; ---------------------------------------------------------------------------

loc_416BF6:				; CODE XREF: sub_416BE5+Aj
		mov	eax, offset byte_4315AD

loc_416BFB:				; CODE XREF: sub_416BE5+Fj
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aBeginCertifica ; "BEGIN Certificate `%s':\n"
		call	sub_42344E
		cmp	[ebp+arg_4], 0
		jz	loc_416DB0
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_get_serial
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_41644D
		mov	dword ptr [ebp+var_10],	eax
		cmp	dword ptr [ebp+var_10],	0
		jz	short loc_416C3C
		mov	eax, dword ptr [ebp+var_10]
		jmp	short loc_416C41
; ---------------------------------------------------------------------------

loc_416C3C:				; CODE XREF: sub_416BE5+50j
		mov	eax, offset a?_2 ; "?"

loc_416C41:				; CODE XREF: sub_416BE5+55j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aSerialS ; "	  serial: %s\n"
		call	sub_42344E
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	ksba_free
		lea	eax, [ebp+var_20]
		mov	[esp+38h+var_30], eax
		mov	dword ptr [esp+38h+var_34], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_get_validity
		mov	[esp+38h+var_38], offset aNotbefore ; "	 notBefore: "
		call	sub_42344E
		lea	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	sub_416AA4
		mov	[esp+38h+var_38], offset asc_4315E6 ; "\n"
		call	sub_423478
		lea	eax, [ebp+var_20]
		mov	[esp+38h+var_30], eax
		mov	dword ptr [esp+38h+var_34], 1 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_get_validity
		mov	[esp+38h+var_38], offset aNotafter ; "	 notAfter: "
		call	sub_42344E
		lea	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	sub_416AA4
		mov	[esp+38h+var_38], offset asc_4315E6 ; "\n"
		call	sub_423478
		mov	dword ptr [esp+38h+var_34], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_get_issuer
		mov	dword ptr [ebp+var_10],	eax
		mov	[esp+38h+var_38], offset aIssuer_0 ; "	   issuer: "
		call	sub_42344E
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_416B16
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	ksba_free
		mov	[esp+38h+var_38], offset asc_4315E6 ; "\n"
		call	sub_423478
		mov	dword ptr [esp+38h+var_34], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_get_subject
		mov	dword ptr [ebp+var_10],	eax
		mov	[esp+38h+var_38], offset aSubject_0 ; "	   subject: "
		call	sub_42344E
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_416B16
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	ksba_free
		mov	[esp+38h+var_38], offset asc_4315E6 ; "\n"
		call	sub_423478
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	ksba_cert_get_digest_algo
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aHashAlgoS ; "	 hash algo: %s\n"
		call	sub_42344E
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_416729
		mov	dword ptr [ebp+var_10],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aSha1Fingerpr_0 ; "  SHA1 fingerprint:	%s\n"
		call	sub_42344E
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_free

loc_416DB0:				; CODE XREF: sub_416BE5+2Aj
		mov	[esp+38h+var_38], offset aEndCertificate ; "END	Certificate\n"
		call	sub_42344E
		leave
		retn
sub_416BE5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416DBE	proc near		; CODE XREF: sub_40CD34+32Bp
					; sub_41FC23+F8p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jz	short loc_416DCF
		mov	eax, dword ptr [ebp+arg_0]
		jmp	short loc_416DD4
; ---------------------------------------------------------------------------

loc_416DCF:				; CODE XREF: sub_416DBE+Aj
		mov	eax, offset aCertificate ; "certificate"

loc_416DD4:				; CODE XREF: sub_416DBE+Fj
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aS_2 ;	"%s"
		call	sub_423387
		cmp	[ebp+arg_4], 0
		jz	loc_416E70
		mov	dword ptr [esp+28h+var_24], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_get_issuer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_get_serial
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jz	short loc_416E4E
		cmp	[ebp+var_10], 0
		jz	short loc_416E4E
		mov	[esp+28h+var_28], offset asc_431658 ; "	#"
		call	sub_423478
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_416A63
		mov	[esp+28h+var_28], offset asc_43165B ; "/"
		call	sub_423478
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_416B16
		jmp	short loc_416E5A
; ---------------------------------------------------------------------------

loc_416E4E:				; CODE XREF: sub_416DBE+58j
					; sub_416DBE+5Ej
		mov	[esp+28h+var_28], offset aInvalid ; " [invalid]"
		call	sub_423478

loc_416E5A:				; CODE XREF: sub_416DBE+8Ej
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	ksba_free
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free

loc_416E70:				; CODE XREF: sub_416DBE+2Aj
		mov	[esp+28h+var_28], offset asc_4315E6 ; "\n"
		call	sub_423478
		leave
		retn
sub_416DBE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416E7E	proc near		; CODE XREF: sub_40CD34+33Ep

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jz	short loc_416E8F
		mov	eax, dword ptr [ebp+arg_0]
		jmp	short loc_416E94
; ---------------------------------------------------------------------------

loc_416E8F:				; CODE XREF: sub_416E7E+Aj
		mov	eax, offset aSubject_1 ; "subject"

loc_416E94:				; CODE XREF: sub_416E7E+Fj
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aS_2 ;	"%s"
		call	sub_423387
		cmp	[ebp+arg_4], 0
		jz	short loc_416EF6
		mov	dword ptr [esp+28h+var_24], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_get_subject
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_416EEA
		mov	[esp+28h+var_28], offset asc_431670 ; "	/"
		call	sub_423478
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_416B16
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short loc_416EF6
; ---------------------------------------------------------------------------

loc_416EEA:				; CODE XREF: sub_416E7E+46j
		mov	[esp+28h+var_28], offset aInvalid ; " [invalid]"
		call	sub_423478

loc_416EF6:				; CODE XREF: sub_416E7E+2Aj
					; sub_416E7E+6Aj
		mov	[esp+28h+var_28], offset asc_4315E6 ; "\n"
		call	sub_423478
		leave
		retn
sub_416E7E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416F04	proc near		; CODE XREF: sub_417136+12Ap

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_8], eax
		jmp	loc_41711D
; ---------------------------------------------------------------------------

loc_416F22:				; CODE XREF: sub_416F04+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_417106
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4170A2
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4170A2
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_416F6C
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_416FA8

loc_416F6C:				; CODE XREF: sub_416F04+59j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jbe	short loc_416F86
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jbe	short loc_416FA8

loc_416F86:				; CODE XREF: sub_416F04+73j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jbe	loc_4170A2
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		ja	loc_4170A2

loc_416FA8:				; CODE XREF: sub_416F04+66j
					; sub_416F04+80j
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_416FC2
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_416FFE

loc_416FC2:				; CODE XREF: sub_416F04+AFj
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jbe	short loc_416FDC
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jbe	short loc_416FFE

loc_416FDC:				; CODE XREF: sub_416F04+C9j
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jbe	loc_4170A2
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		ja	loc_4170A2

loc_416FFE:				; CODE XREF: sub_416F04+BCj
					; sub_416F04+D6j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_41701F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41704B
; ---------------------------------------------------------------------------

loc_41701F:				; CODE XREF: sub_416F04+106j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_41703A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_417049
; ---------------------------------------------------------------------------

loc_41703A:				; CODE XREF: sub_416F04+123j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_417049:				; CODE XREF: sub_416F04+134j
		mov	edx, eax

loc_41704B:				; CODE XREF: sub_416F04+119j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_417066
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_41708D
; ---------------------------------------------------------------------------

loc_417066:				; CODE XREF: sub_416F04+152j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_417081
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_41708D
; ---------------------------------------------------------------------------

loc_417081:				; CODE XREF: sub_416F04+16Dj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_41708D:				; CODE XREF: sub_416F04+160j
					; sub_416F04+17Bj
		add	edx, eax
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		add	[ebp+var_C], 1
		add	[ebp+var_8], 1
		add	[ebp+var_4], 1
		jmp	short loc_417119
; ---------------------------------------------------------------------------

loc_4170A2:				; CODE XREF: sub_416F04+37j
					; sub_416F04+48j ...
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4170D2
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_4170D2:				; CODE XREF: sub_416F04+1B9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4170EF
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_4170EF:				; CODE XREF: sub_416F04+1D6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4170FF
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax],	0

loc_4170FF:				; CODE XREF: sub_416F04+1F3j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_417134
; ---------------------------------------------------------------------------

loc_417106:				; CODE XREF: sub_416F04+26j
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		add	[ebp+var_8], 1
		add	[ebp+var_4], 1

loc_417119:				; CODE XREF: sub_416F04+19Cj
		add	[ebp+var_C], 1

loc_41711D:				; CODE XREF: sub_416F04+19j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_416F22
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_4]

locret_417134:				; CODE XREF: sub_416F04+200j
		leave
		retn
sub_416F04	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417136	proc near		; CODE XREF: sub_411FE1+B6p

Str		= dword	ptr -48h
Val		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	[esp+48h+Val], 3Ah ; Val
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_417171
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jnz	short loc_41717B

loc_417171:				; CODE XREF: sub_417136+31j
		mov	eax, 0
		jmp	loc_4172B5
; ---------------------------------------------------------------------------

loc_41717B:				; CODE XREF: sub_417136+39j
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_417198
		mov	eax, 0
		jmp	loc_4172B5
; ---------------------------------------------------------------------------

loc_417198:				; CODE XREF: sub_417136+56j
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_4171B0
		mov	eax, 0
		jmp	loc_4172B5
; ---------------------------------------------------------------------------

loc_4171B0:				; CODE XREF: sub_417136+6Ej
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax
		call	gcry_strdup
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4171F3
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Str], eax ; int
		call	strerror
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Str], offset aMallocFailed_0 ;	"malloc	failed:	%s\n"
		call	sub_4233B1
		mov	eax, 0
		jmp	loc_4172B5
; ---------------------------------------------------------------------------

loc_4171F3:				; CODE XREF: sub_417136+90j
		mov	[esp+48h+Val], 2Fh ; Val
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_417219
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1

loc_417219:				; CODE XREF: sub_417136+D7j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax ; Str
		call	_strlwr
		mov	[esp+48h+Val], 3Ah ; char
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41725A
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax ; Str
		call	atoi
		mov	edx, [ebp+arg_4]
		mov	[edx], eax

loc_41725A:				; CODE XREF: sub_417136+108j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax
		call	sub_416F04
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		js	short loc_417294
		mov	ebx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jz	short loc_4172B2

loc_417294:				; CODE XREF: sub_417136+136j
		mov	[esp+48h+Str], offset aBadUrlEncoding ;	"bad URL encoding detected\n"
		call	sub_4233B1
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_4172B5
; ---------------------------------------------------------------------------

loc_4172B2:				; CODE XREF: sub_417136+15Cj
		mov	eax, [ebp+var_18]

loc_4172B5:				; CODE XREF: sub_417136+40j
					; sub_417136+5Dj ...
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_417136	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4172BC	proc near		; CODE XREF: sub_4172E3+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4172DC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4172E1
; ---------------------------------------------------------------------------

loc_4172DC:				; CODE XREF: sub_4172BC+7j
		mov	eax, 0

loc_4172E1:				; CODE XREF: sub_4172BC+1Ej
		pop	ebp
		retn
sub_4172BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4172E3	proc near		; CODE XREF: sub_41730B+14p
					; sub_41739C+186p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_4172BC
		leave
		retn
sub_4172E3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4172FE	proc near		; CODE XREF: sub_418114+28Bp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_4172FE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41730B	proc near		; CODE XREF: sub_41739C+3Fp
					; sub_41739C+D5p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_4172E3
		leave
		retn
sub_41730B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_417326(char *, char *)
sub_417326	proc near		; CODE XREF: sub_418114+7AEp
					; sub_418114+84Dp

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_417384
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Fh
		jnz	short loc_417368
		mov	eax, [ebp+arg_4]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_417384

loc_417368:				; CODE XREF: sub_417326+33j
		mov	[esp+28h+var_20], offset aCopy_time_0 ;	"copy_time"
		mov	[esp+28h+Source], 39h
		mov	[esp+28h+Dest],	offset a____Dirmngr1_6 ; "../../dirmngr-1.1.1/src/misc.h"
		call	sub_423540
; ---------------------------------------------------------------------------

loc_417384:				; CODE XREF: sub_417326+Fj
					; sub_417326+40j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dest],	eax ; Dest
		call	strcpy
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_417326	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41739C	proc near		; CODE XREF: sub_41757C+44Ap

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_10], 1000h
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4173E5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax
		call	sub_41730B
		jmp	locret_41757A
; ---------------------------------------------------------------------------

loc_4173E5:				; CODE XREF: sub_41739C+31j
		mov	[ebp+var_14], 0

loc_4173EC:				; CODE XREF: sub_41739C+1D9j
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jb	short loc_417417
		mov	[esp+38h+var_30], 4Ch ;	int
		mov	[esp+38h+var_34], offset a____Dirmngr1_7 ; "../../dirmngr-1.1.1/src/ocsp.c"
		mov	[esp+38h+var_38], offset aNbytesBufsize	; "nbytes < bufsize"
		call	sub_429780

loc_417417:				; CODE XREF: sub_41739C+5Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_2C], edx
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+var_34], 1
		mov	[esp+38h+var_38], eax
		call	sub_41BDF9
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_18]
		jbe	short loc_4174AD
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41B771
		test	eax, eax
		jz	short loc_4174AD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax
		call	sub_41730B
		mov	[ebp+var_1C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	[esp+38h+var_34], eax ;	char
		mov	[esp+38h+var_38], offset aErrorReadingFr ; "error reading from responder: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		jmp	locret_41757A
; ---------------------------------------------------------------------------

loc_4174AD:				; CODE XREF: sub_41739C+B8j
					; sub_41739C+C7j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_18]
		jnz	short loc_4174CD
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41B6FF
		test	eax, eax
		jz	short loc_4174ED

loc_4174CD:				; CODE XREF: sub_41739C+120j
		mov	eax, [ebp+var_18]
		add	[ebp+var_14], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_41757A
; ---------------------------------------------------------------------------

loc_4174ED:				; CODE XREF: sub_41739C+12Fj
		mov	eax, [ebp+var_18]
		add	[ebp+var_14], eax
		cmp	[ebp+var_10], 0FFFFh
		jbe	short loc_417529
		mov	[esp+38h+var_34], 10000h ; char
		mov	[esp+38h+var_38], offset aResponseFromSe ; "response from server too large; limit i"...
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	[esp+38h+var_38], 43h
		call	sub_4172E3
		jmp	short locret_41757A
; ---------------------------------------------------------------------------

loc_417529:				; CODE XREF: sub_41739C+15Ej
		add	[ebp+var_10], 1000h
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_realloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_41756F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax
		call	sub_41730B
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		jmp	short locret_41757A
; ---------------------------------------------------------------------------

loc_41756F:				; CODE XREF: sub_41739C+1ADj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		jmp	loc_4173EC
; ---------------------------------------------------------------------------

locret_41757A:				; CODE XREF: sub_41739C+44j
					; sub_41739C+10Cj ...
		leave
		retn
sub_41739C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41757C(int, int, int,	char *,	int, int)
sub_41757C	proc near		; CODE XREF: sub_418114+3DCp

var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_58		= byte ptr -58h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 70h
		mov	[ebp+var_14], 2
		mov	[ebp+var_18], 0
		mov	eax, ds:dword_435FDC
		test	eax, eax
		jz	short loc_4175B8
		mov	[esp+78h+var_78], offset aOcspRequestNot ; "OCSP request not possible due to disabl"...
		call	sub_4233B1
		mov	[esp+78h+var_78], 3Ch
		call	sub_4172E3
		jmp	loc_417BE7
; ---------------------------------------------------------------------------

loc_4175B8:				; CODE XREF: sub_41757C+1Dj
		mov	eax, [ebp+arg_14]
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_78], eax
		call	ksba_ocsp_add_target
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4175FD
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aErrorSettingOc ; "error setting OCSP target: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		jmp	loc_417BE7
; ---------------------------------------------------------------------------

loc_4175FD:				; CODE XREF: sub_41757C+5Cj
		mov	[esp+78h+var_70], 0
		mov	[esp+78h+var_74], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_78], eax
		call	ksba_ocsp_set_nonce
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 20h
		jbe	short loc_417628
		mov	[ebp+var_1C], 20h

loc_417628:				; CODE XREF: sub_41757C+A3j
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+var_74], eax
		lea	eax, [ebp+var_58]
		mov	[esp+78h+var_78], eax
		call	gcry_create_nonce
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_58]
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_78], eax
		call	ksba_ocsp_set_nonce
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_24]
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_78], eax
		call	ksba_ocsp_build_request
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_417698
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aErrorBuildingO ; "error building OCSP	request: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_C]
		jmp	loc_417BE7
; ---------------------------------------------------------------------------

loc_417698:				; CODE XREF: sub_41757C+F7j
					; sub_41757C+3B4j
		mov	edx, ds:dword_435FE8
		mov	eax, ds:dword_435FE4
		test	eax, eax
		jz	short loc_4176AE
		mov	eax, 11h
		jmp	short loc_4176B3
; ---------------------------------------------------------------------------

loc_4176AE:				; CODE XREF: sub_41757C+129j
		mov	eax, 10h

loc_4176B3:				; CODE XREF: sub_41757C+130j
		mov	[esp+78h+var_60], 0 ; int
		mov	[esp+78h+var_64], edx ;	int
		mov	[esp+78h+var_68], eax ;	int
		mov	[esp+78h+var_6C], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_70], eax ;	char *
		mov	[esp+78h+var_74], 3 ; int
		lea	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax ;	int
		call	sub_413430
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_417723
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aErrorConnectin ; "error connecting to	`%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_417BE7
; ---------------------------------------------------------------------------

loc_417723:				; CODE XREF: sub_41757C+170j
		mov	esi, [ebp+var_2C]
		mov	ebx, offset aContentTypeApp ; "Content-Type: application/ocsp-request\"...
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax
		call	sub_4138B1
		mov	[esp+78h+var_70], esi
		mov	[esp+78h+var_74], ebx
		mov	[esp+78h+var_78], eax
		call	sub_41C556
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax
		call	sub_413580
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax
		call	sub_4138B1
		mov	ecx, [ebp+var_2C]
		mov	edx, [ebp+var_24]
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+var_74], ecx
		mov	[esp+78h+var_78], edx
		call	sub_41BE83
		cmp	eax, 1
		jz	short loc_4177EC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+var_78], eax
		call	sub_41730B
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+var_78], eax ;	int
		call	strerror
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aErrorSendingRe ; "error sending request to `%s': %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_74], 0
		mov	[esp+78h+var_78], eax
		call	sub_4137B6
		mov	eax, [ebp+var_24]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_417BE7
; ---------------------------------------------------------------------------

loc_4177EC:				; CODE XREF: sub_41757C+201j
		mov	eax, [ebp+var_24]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	[ebp+var_24], 0
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax
		call	sub_4135D8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_417828
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax
		call	sub_4138C9
		cmp	eax, 0C8h
		jz	loc_4179AA

loc_417828:				; CODE XREF: sub_41757C+294j
		cmp	[ebp+var_C], 0
		jz	short loc_417855
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aErrorReadingHt ; "error reading HTTP response	for `%s': %"...
		call	sub_4233B1
		jmp	loc_417984
; ---------------------------------------------------------------------------

loc_417855:				; CODE XREF: sub_41757C+2B0j
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax
		call	sub_4138C9
		sub	eax, 12Dh
		cmp	eax, 1
		ja	loc_417952
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_74], offset aLocation_0 ; "Location"
		mov	[esp+78h+var_78], eax ;	int
		call	sub_414E2B
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax
		call	sub_4138C9
		mov	edx, eax
		cmp	[ebp+var_20], 0
		jz	short loc_41789C
		mov	eax, [ebp+var_20]
		jmp	short loc_4178A1
; ---------------------------------------------------------------------------

loc_41789C:				; CODE XREF: sub_41757C+319j
		mov	eax, offset aNone_4 ; "[none]"

loc_4178A1:				; CODE XREF: sub_41757C+31Ej
		mov	[esp+78h+var_6C], edx
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aUrlSRedirect_0 ; "URL	`%s' redirected to `%s' (%u)\n"
		call	sub_423387
		cmp	[ebp+var_20], 0
		jz	short loc_417935
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_417935
		cmp	[ebp+var_14], 0
		setnz	al
		sub	[ebp+var_14], 1
		test	al, al
		jz	short loc_417935
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	[ebp+arg_C], 0
		mov	eax, [ebp+var_20]
		mov	[esp+78h+var_78], eax
		call	gcry_strdup
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_417917
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+var_78], eax
		call	sub_41730B
		mov	[ebp+var_C], eax
		jmp	short loc_417944
; ---------------------------------------------------------------------------

loc_417917:				; CODE XREF: sub_41757C+383j
		mov	eax, [ebp+var_18]
		mov	[ebp+arg_C], eax
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_74], 0
		mov	[esp+78h+var_78], eax
		call	sub_4137B6
		jmp	loc_417698
; ---------------------------------------------------------------------------

loc_417935:				; CODE XREF: sub_41757C+344j
					; sub_41757C+34Ej ...
		mov	[esp+78h+var_78], 3Ah
		call	sub_4172E3
		mov	[ebp+var_C], eax

loc_417944:				; CODE XREF: sub_41757C+399j
		mov	[esp+78h+var_78], offset aTooManyRedir_0 ; "too	many redirections\n"
		call	sub_4233B1
		jmp	short loc_417984
; ---------------------------------------------------------------------------

loc_417952:				; CODE XREF: sub_41757C+2ECj
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax
		call	sub_4138C9
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aErrorAccessing ; "error accessing `%s': http status %u\n"
		call	sub_4233B1
		mov	[esp+78h+var_78], 3Ah
		call	sub_4172E3
		mov	[ebp+var_C], eax
		nop

loc_417984:				; CODE XREF: sub_41757C+2D4j
					; sub_41757C+3D4j
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_74], 0
		mov	[esp+78h+var_78], eax
		call	sub_4137B6
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_417BE7
; ---------------------------------------------------------------------------

loc_4179AA:				; CODE XREF: sub_41757C+2A6j
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_78], eax
		call	sub_413899
		lea	edx, [ebp+var_30]
		mov	[esp+78h+var_70], edx
		lea	edx, [ebp+var_28]
		mov	[esp+78h+var_74], edx
		mov	[esp+78h+var_78], eax
		call	sub_41739C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_74], 0
		mov	[esp+78h+var_78], eax
		call	sub_4137B6
		cmp	[ebp+var_C], 0
		jz	short loc_417A1C
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aErrorReadingHt ; "error reading HTTP response	for `%s': %"...
		call	sub_4233B1
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_417BE7
; ---------------------------------------------------------------------------

loc_417A1C:				; CODE XREF: sub_41757C+469j
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_28]
		lea	ecx, [ebp+var_38]
		mov	[esp+78h+var_6C], ecx
		mov	[esp+78h+var_70], edx
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_78], eax
		call	ksba_ocsp_parse_response
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_417A85
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aErrorParsingOc ; "error parsing OCSP response	for `%s': %"...
		call	sub_4233B1
		mov	eax, [ebp+var_28]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_417BE7
; ---------------------------------------------------------------------------

loc_417A85:				; CODE XREF: sub_41757C+4C7j
		mov	eax, [ebp+var_38]
		cmp	eax, 5
		jz	short loc_417AF1
		cmp	eax, 5
		ja	short loc_417AA8
		cmp	eax, 1
		jz	short loc_417AD6
		cmp	eax, 1
		jb	short loc_417ACD
		cmp	eax, 2
		jz	short loc_417ADF
		cmp	eax, 3
		jz	short loc_417AE8
		jmp	short loc_417B1E
; ---------------------------------------------------------------------------

loc_417AA8:				; CODE XREF: sub_41757C+514j
		cmp	eax, 0FDh
		jz	short loc_417B03
		cmp	eax, 0FDh
		ja	short loc_417ABD
		cmp	eax, 6
		jz	short loc_417AFA
		jmp	short loc_417B1E
; ---------------------------------------------------------------------------

loc_417ABD:				; CODE XREF: sub_41757C+538j
		cmp	eax, 0FEh
		jz	short loc_417B0C
		cmp	eax, 0FFh
		jz	short loc_417B15
		jmp	short loc_417B1E
; ---------------------------------------------------------------------------

loc_417ACD:				; CODE XREF: sub_41757C+51Ej
		mov	[ebp+var_10], offset aSuccess ;	"success"
		jmp	short loc_417B26
; ---------------------------------------------------------------------------

loc_417AD6:				; CODE XREF: sub_41757C+519j
		mov	[ebp+var_10], offset aMalformed	; "malformed"
		jmp	short loc_417B26
; ---------------------------------------------------------------------------

loc_417ADF:				; CODE XREF: sub_41757C+523j
		mov	[ebp+var_10], offset aInternalError ; "internal	error"
		jmp	short loc_417B26
; ---------------------------------------------------------------------------

loc_417AE8:				; CODE XREF: sub_41757C+528j
		mov	[ebp+var_10], offset aTryLater ; "try later"
		jmp	short loc_417B26
; ---------------------------------------------------------------------------

loc_417AF1:				; CODE XREF: sub_41757C+50Fj
		mov	[ebp+var_10], offset aMustSignReques ; "must sign request"
		jmp	short loc_417B26
; ---------------------------------------------------------------------------

loc_417AFA:				; CODE XREF: sub_41757C+53Dj
		mov	[ebp+var_10], offset aUnauthorized ; "unauthorized"
		jmp	short loc_417B26
; ---------------------------------------------------------------------------

loc_417B03:				; CODE XREF: sub_41757C+531j
		mov	[ebp+var_10], offset aReplayDetected ; "replay detected"
		jmp	short loc_417B26
; ---------------------------------------------------------------------------

loc_417B0C:				; CODE XREF: sub_41757C+546j
		mov	[ebp+var_10], offset aOtherUnknown ; "other (unknown)"
		jmp	short loc_417B26
; ---------------------------------------------------------------------------

loc_417B15:				; CODE XREF: sub_41757C+54Dj
		mov	[ebp+var_10], offset aNoStatus ; "no status"
		jmp	short loc_417B26
; ---------------------------------------------------------------------------

loc_417B1E:				; CODE XREF: sub_41757C+52Aj
					; sub_41757C+53Fj ...
		mov	[ebp+var_10], offset aUnknownStatus ; "[unknown	status]"
		nop

loc_417B26:				; CODE XREF: sub_41757C+558j
					; sub_41757C+561j ...
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_417BA5
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_417B50
		mov	eax, [ebp+var_10]
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aOcspResponderA ; "OCSP responder at `%s' status: %s\n"
		call	sub_423387

loc_417B50:				; CODE XREF: sub_41757C+5B8j
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_28]
		mov	ecx, [ebp+arg_8]
		mov	[esp+78h+var_68], ecx
		mov	[esp+78h+var_6C], offset gcry_md_write
		mov	[esp+78h+var_70], edx
		mov	[esp+78h+var_74], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_78], eax
		call	ksba_ocsp_hash_response
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_417BCE
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aHashingTheOcsp ; "hashing the	OCSP response for `%s' fail"...
		call	sub_4233B1
		jmp	short loc_417BCE
; ---------------------------------------------------------------------------

loc_417BA5:				; CODE XREF: sub_41757C+5AFj
		mov	eax, [ebp+var_10]
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_74], eax ;	char
		mov	[esp+78h+var_78], offset aOcspResponderA ; "OCSP responder at `%s' status: %s\n"
		call	sub_4233B1
		mov	[esp+78h+var_78], 1
		call	sub_4172E3
		mov	[ebp+var_C], eax

loc_417BCE:				; CODE XREF: sub_41757C+603j
					; sub_41757C+627j
		mov	eax, [ebp+var_28]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_417BE7:				; CODE XREF: sub_41757C+37j
					; sub_41757C+7Cj ...
		add	esp, 70h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_41757C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417BEE	proc near		; CODE XREF: sub_417CE7+8Ep

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_8], 0
		jz	short loc_417C68
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str1],	eax
		call	sub_416729
		mov	[ebp+var_10], eax
		jmp	short loc_417C12
; ---------------------------------------------------------------------------

loc_417C0A:				; CODE XREF: sub_417BEE+41j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+arg_8], eax

loc_417C12:				; CODE XREF: sub_417BEE+1Aj
		cmp	[ebp+arg_8], 0
		jz	short loc_417C31
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str2],	eax ; char
		mov	[esp+38h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_417C0A

loc_417C31:				; CODE XREF: sub_417BEE+28j
		cmp	[ebp+arg_8], 0
		jz	short loc_417C40
		mov	[ebp+var_C], 0
		jmp	short loc_417C5B
; ---------------------------------------------------------------------------

loc_417C40:				; CODE XREF: sub_417BEE+47j
		mov	[esp+38h+Str1],	offset aNotSignedByADe ; "not signed by	a default OCSP signer's c"...
		call	sub_4233B1
		mov	[esp+38h+Str1],	64h
		call	sub_4172E3
		mov	[ebp+var_C], eax

loc_417C5B:				; CODE XREF: sub_417BEE+50j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str1],	eax
		call	gcry_free
		jmp	short loc_417CE2
; ---------------------------------------------------------------------------

loc_417C68:				; CODE XREF: sub_417BEE+Aj
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jz	short loc_417CA0
		mov	[esp+38h+var_28], 0 ; int
		mov	[esp+38h+var_2C], 3 ; int
		mov	[esp+38h+var_30], 0 ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str2],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax ; int
		call	sub_420043
		mov	[ebp+var_C], eax
		jmp	short loc_417CE2
; ---------------------------------------------------------------------------

loc_417CA0:				; CODE XREF: sub_417BEE+81j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str1],	eax
		call	sub_416729
		mov	[ebp+var_10], eax
		mov	[esp+38h+var_2C], 0
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+Str2],	offset aOnly_valid_if_ ; "ONLY_VALID_IF_CERT_VALID"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_40695C
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str1],	eax
		call	gcry_free
		mov	[ebp+var_C], 0

loc_417CE2:				; CODE XREF: sub_417BEE+78j
					; sub_417BEE+B0j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_417BEE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417CE7	proc near		; CODE XREF: sub_417DA7+146p
					; sub_417DA7+318p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_get_public_key
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_417D19
		mov	[esp+28h+var_28], 41h
		call	sub_4172E3
		mov	[ebp+var_C], eax
		jmp	short loc_417D2E
; ---------------------------------------------------------------------------

loc_417D19:				; CODE XREF: sub_417CE7+1Fj
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_41667D
		mov	[ebp+var_C], eax

loc_417D2E:				; CODE XREF: sub_417CE7+30j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_417D5B
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	gcry_pk_verify
		mov	[ebp+var_C], eax

loc_417D5B:				; CODE XREF: sub_417CE7+56j
		cmp	[ebp+var_C], 0
		jnz	short loc_417D7D
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_417BEE
		mov	[ebp+var_C], eax

loc_417D7D:				; CODE XREF: sub_417CE7+78j
		cmp	[ebp+var_C], 0
		jnz	short loc_417D95
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_release
		mov	eax, 0
		jmp	short locret_417DA5
; ---------------------------------------------------------------------------

loc_417D95:				; CODE XREF: sub_417CE7+9Aj
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_release
		mov	eax, 0FFFFFFFFh

locret_417DA5:				; CODE XREF: sub_417CE7+ACj
		leave
		retn
sub_417CE7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417DA7	proc near		; CODE XREF: sub_418114+481p

var_48		= dword	ptr -48h
Source		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+Source], 5 ; char
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_48], eax
		call	gcry_md_ctl
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_48], eax
		call	gcry_md_get_algo
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 2
		jz	short loc_417E02
		mov	[esp+48h+var_48], offset aOnlySha1IsSupp ; "only SHA-1 is supported for	OCSP respon"...
		call	sub_4233B1
		mov	[esp+48h+var_48], 5
		call	sub_4172E3
		jmp	loc_41810E
; ---------------------------------------------------------------------------

loc_417E02:				; CODE XREF: sub_417DA7+3Cj
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_48], eax
		call	gcry_md_read
		mov	ebx, eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_md_get_algo_dlen
		mov	[esp+48h+var_38], ebx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], offset aDataFlagsPkc_0 ; "(data(flags	pkcs1)(hash sha1 %b))"
		mov	[esp+48h+Source], 0
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_build
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_417E70
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_strerror
		mov	[esp+48h+Source], eax ;	char
		mov	[esp+48h+var_48], offset aCreatingSExp_0 ; "creating S-expression failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_18]
		jmp	loc_41810E
; ---------------------------------------------------------------------------

loc_417E70:				; CODE XREF: sub_417DA7+A4j
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_418A49
		cmp	[ebp+arg_10], 0
		jz	loc_417F26
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_417F26
		mov	eax, [ebp+arg_10]
		add	eax, 4
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_40D41E
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_417EC1
		mov	eax, [ebp+arg_10]
		add	eax, 4
		mov	[esp+48h+Source], eax ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_4049E3
		mov	[ebp+var_10], eax

loc_417EC1:				; CODE XREF: sub_417DA7+100j
		cmp	[ebp+var_10], 0
		jz	loc_4180EA
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+arg_10]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_417CE7
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_release
		mov	[ebp+var_10], 0
		cmp	[ebp+var_18], 0
		jnz	loc_4180EA
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_release
		mov	eax, 0
		jmp	loc_41810E
; ---------------------------------------------------------------------------

loc_417F26:				; CODE XREF: sub_417DA7+D8j
					; sub_417DA7+E5j
		mov	[ebp+var_C], 0
		jmp	short loc_417F9F
; ---------------------------------------------------------------------------

loc_417F2F:				; CODE XREF: sub_417DA7+211j
		mov	[esp+48h+var_48], 18h
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_417F61
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_strerror
		mov	[esp+48h+Source], eax ;	char
		mov	[esp+48h+var_48], offset aAllocatingList ; "allocating list item failed: %s\n"
		call	sub_4233B1
		jmp	short loc_417F9B
; ---------------------------------------------------------------------------

loc_417F61:				; CODE XREF: sub_417DA7+19Bj
		mov	eax, [ebp+var_1C]
		add	eax, 4
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_40D32A
		test	eax, eax
		jnz	short loc_417F90
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax+18h], edx
		jmp	short loc_417F9B
; ---------------------------------------------------------------------------

loc_417F90:				; CODE XREF: sub_417DA7+1D1j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_417F9B:				; CODE XREF: sub_417DA7+1B8j
					; sub_417DA7+1E7j
		add	[ebp+var_C], 1

loc_417F9F:				; CODE XREF: sub_417DA7+186j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	ksba_ocsp_get_cert
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_417F2F
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_40], eax
		lea	eax, [ebp+var_24]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	ksba_ocsp_get_responder_id
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_418003
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_strerror
		mov	[esp+48h+Source], eax ;	char
		mov	[esp+48h+var_48], offset aErrorGettingRe ; "error getting responder ID:	%s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_18]
		jmp	loc_41810E
; ---------------------------------------------------------------------------

loc_418003:				; CODE XREF: sub_417DA7+237j
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_40], edx ;	int
		mov	[esp+48h+Source], eax ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40E3E4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_418081
		mov	[esp+48h+var_48], offset aResponderCerti ; "responder certificate "
		call	sub_4233B1
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_41804B
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Source], eax ;	char
		mov	[esp+48h+var_48], offset aS_3 ;	"`/%s' "
		call	sub_423478

loc_41804B:				; CODE XREF: sub_417DA7+28Fj
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_418075
		mov	[esp+48h+var_48], offset asc_431B32 ; "{"
		call	sub_423478
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_416A63
		mov	[esp+48h+var_48], offset asc_431B34 ; "} "
		call	sub_423478

loc_418075:				; CODE XREF: sub_417DA7+2A9j
		mov	[esp+48h+var_48], offset aNotFound_0 ; "not found\n"
		call	sub_423478

loc_418081:				; CODE XREF: sub_417DA7+27Cj
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	ksba_free
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	ksba_free
		cmp	[ebp+var_10], 0
		jz	short loc_4180EB
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+arg_10]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_417CE7
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_release
		cmp	[ebp+var_18], 0
		jnz	short loc_4180EB
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_release
		mov	eax, 0
		jmp	short loc_41810E
; ---------------------------------------------------------------------------

loc_4180EA:				; CODE XREF: sub_417DA7+11Ej
					; sub_417DA7+164j
		nop

loc_4180EB:				; CODE XREF: sub_417DA7+2F4j
					; sub_417DA7+32Fj
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_release
		mov	[esp+48h+var_48], offset aNoSuitableCert ; "no suitable	certificate found to verify"...
		call	sub_4233B1
		mov	[esp+48h+var_48], 9
		call	sub_4172E3

loc_41810E:				; CODE XREF: sub_417DA7+56j
					; sub_417DA7+C4j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_417DA7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418114(int, int, char	*, int)
sub_418114	proc near		; CODE XREF: sub_405080+156p
					; sub_405654+183p

Str1		= dword	ptr -0D8h
Str2		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= byte ptr -94h
var_84		= byte ptr -84h
var_74		= byte ptr -74h
var_64		= byte ptr -64h
var_54		= byte ptr -54h
var_44		= byte ptr -44h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0D4h
		mov	[ebp+var_2C], 0
		mov	[ebp+var_30], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_34], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_A0], 0
		mov	[ebp+var_24], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_4181A9
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+Str1], eax
		call	ksba_cert_ref
		lea	eax, [ebp+var_30]
		mov	[esp+0D8h+var_D0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Str1], eax
		call	sub_40E92B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_418221
		mov	eax, [ebp+var_C]
		mov	[esp+0D8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aIssuerCertif_0	; "issuer certificate not found: %s\n"
		call	sub_4233B1
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_4181A9:				; CODE XREF: sub_418114+42j
		mov	eax, [ebp+arg_8]
		mov	[esp+0D8h+Str2], eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Str1], eax ; int
		call	sub_4049E3
		mov	[ebp+arg_4], eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_4181E4
		mov	[esp+0D8h+Str1], offset	aCallerDidNotRe	; "caller did not return the target certif"...
		call	sub_4233B1
		mov	[esp+0D8h+Str1], 1
		call	sub_4172E3
		mov	[ebp+var_C], eax
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_4181E4:				; CODE XREF: sub_418114+AEj
		mov	[esp+0D8h+Str2], 0 ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Str1], eax ; int
		call	sub_404A3D
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_418221
		mov	[esp+0D8h+Str1], offset	aCallerDidNot_0	; "caller did not return the issuing certi"...
		call	sub_4233B1
		mov	[esp+0D8h+Str1], 1
		call	sub_4172E3
		mov	[ebp+var_C], eax
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_418221:				; CODE XREF: sub_418114+6Fj
					; sub_418114+EBj
		lea	eax, [ebp+var_2C]
		mov	[esp+0D8h+Str1], eax
		call	ksba_ocsp_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_418255
		mov	eax, [ebp+var_C]
		mov	[esp+0D8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aFailedToAllo_0	; "failed to allocate OCSP context: %s\n"
		call	sub_4233B1
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_418255:				; CODE XREF: sub_418114+11Fj
		mov	[ebp+var_18], 0
		mov	dword ptr [ebp+var_20],	0
		jmp	loc_41834B
; ---------------------------------------------------------------------------

loc_418268:				; CODE XREF: sub_418114+279j
		mov	eax, [ebp+var_A4]
		mov	[esp+0D8h+Str2], offset	a1_3_6_1_5_5_7_	; "1.3.6.1.5.5.7.48.1"
		mov	[esp+0D8h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_41832B
		mov	[ebp+var_1C], 0
		jmp	short loc_418308
; ---------------------------------------------------------------------------

loc_41828F:				; CODE XREF: sub_418114+211j
		mov	eax, [ebp+var_A8]
		mov	edx, [ebp+var_1C]
		mov	[esp+0D8h+Str2], edx
		mov	[esp+0D8h+Str1], eax
		call	ksba_name_get_uri
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_4182F9
		mov	[esp+0D8h+var_D0], 5
		mov	[esp+0D8h+Str2], offset	aHttp_3	; "http:"
		mov	eax, [ebp+var_28]
		mov	[esp+0D8h+Str1], eax
		call	sub_4263C9
		test	eax, eax
		jz	short loc_4182EB
		mov	[esp+0D8h+var_D0], 6
		mov	[esp+0D8h+Str2], offset	aHttps_1 ; "https:"
		mov	eax, [ebp+var_28]
		mov	[esp+0D8h+Str1], eax
		call	sub_4263C9
		test	eax, eax
		jnz	short loc_4182F9

loc_4182EB:				; CODE XREF: sub_418114+1B6j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax
		jmp	short loc_418304
; ---------------------------------------------------------------------------

loc_4182F9:				; CODE XREF: sub_418114+197j
					; sub_418114+1D5j
		mov	eax, [ebp+var_28]
		mov	[esp+0D8h+Str1], eax
		call	gcry_free

loc_418304:				; CODE XREF: sub_418114+1E3j
		add	[ebp+var_1C], 1

loc_418308:				; CODE XREF: sub_418114+179j
		cmp	[ebp+var_18], 0
		jnz	short loc_41832B
		mov	eax, [ebp+var_A8]
		mov	edx, [ebp+var_1C]
		mov	[esp+0D8h+Str2], edx
		mov	[esp+0D8h+Str1], eax
		call	ksba_name_enum
		test	eax, eax
		jnz	loc_41828F

loc_41832B:				; CODE XREF: sub_418114+16Cj
					; sub_418114+1F8j
		mov	eax, [ebp+var_A8]
		mov	[esp+0D8h+Str1], eax
		call	ksba_name_release
		mov	eax, [ebp+var_A4]
		mov	[esp+0D8h+Str1], eax
		call	ksba_free
		add	dword ptr [ebp+var_20],	1

loc_41834B:				; CODE XREF: sub_418114+14Fj
		cmp	[ebp+var_18], 0
		jnz	short loc_418393
		mov	eax, ds:dword_435FFC
		test	eax, eax
		jnz	short loc_418393
		cmp	[ebp+arg_C], 0
		jnz	short loc_418393
		lea	eax, [ebp+var_A8]
		mov	[esp+0D8h+var_CC], eax
		lea	eax, [ebp+var_A4]
		mov	[esp+0D8h+var_D0], eax
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+0D8h+Str2], eax ; char
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+Str1], eax
		call	ksba_cert_get_authority_info_access
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_418268

loc_418393:				; CODE XREF: sub_418114+23Bj
					; sub_418114+244j ...
		cmp	[ebp+var_C], 0
		jz	short loc_4183CB
		mov	eax, [ebp+var_C]
		mov	[esp+0D8h+Str1], eax
		call	sub_4172FE
		cmp	eax, 3FFFh
		jz	short loc_4183CB
		mov	eax, [ebp+var_C]
		mov	[esp+0D8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aCanTGetAuthori	; "can't get authorityInfoAccess: %s\n"
		call	sub_4233B1
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_4183CB:				; CODE XREF: sub_418114+283j
					; sub_418114+295j
		cmp	[ebp+var_18], 0
		jnz	loc_418461
		mov	eax, ds:dword_436018
		test	eax, eax
		jz	short loc_4183EA
		mov	eax, ds:dword_436018
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41840A

loc_4183EA:				; CODE XREF: sub_418114+2C8j
		mov	[esp+0D8h+Str1], offset	aNoDefaultOcspR	; "no default OCSP responder defined\n"
		call	sub_423387
		mov	[esp+0D8h+Str1], 73h
		call	sub_4172E3
		mov	[ebp+var_C], eax
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_41840A:				; CODE XREF: sub_418114+2D4j
		mov	eax, ds:dword_43601C
		test	eax, eax
		jnz	short loc_418433
		mov	[esp+0D8h+Str1], offset	aNoDefaultOcspS	; "no default OCSP signer defined\n"
		call	sub_423387
		mov	[esp+0D8h+Str1], 73h
		call	sub_4172E3
		mov	[ebp+var_C], eax
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_418433:				; CODE XREF: sub_418114+2FDj
		mov	eax, ds:dword_436018
		mov	[ebp+var_18], eax
		mov	eax, ds:dword_43601C
		mov	[ebp+var_24], eax
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_41847D
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aUsingDefaultOc	; "using default OCSP responder	`%s'\n"
		call	sub_423387
		jmp	short loc_41847D
; ---------------------------------------------------------------------------

loc_418461:				; CODE XREF: sub_418114+2BBj
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_41847D
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aUsingOcspRespo	; "using OCSP responder	`%s'\n"
		call	sub_423387

loc_41847D:				; CODE XREF: sub_418114+336j
					; sub_418114+34Bj ...
		mov	[esp+0D8h+var_D0], 0
		mov	[esp+0D8h+Str2], 2
		lea	eax, [ebp+var_A0]
		mov	[esp+0D8h+Str1], eax
		call	gcry_md_open
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4184C4
		mov	eax, [ebp+var_C]
		mov	[esp+0D8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aFailedToEstabl	; "failed to establish a hashing context f"...
		call	sub_4233B1
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_4184C4:				; CODE XREF: sub_418114+38Ej
		mov	ecx, [ebp+var_30]
		mov	edx, [ebp+var_A0]
		mov	eax, [ebp+var_2C]
		mov	[esp+0D8h+var_C4], ecx ; int
		mov	ecx, [ebp+arg_4]
		mov	[esp+0D8h+var_C8], ecx ; int
		mov	ecx, [ebp+var_18]
		mov	[esp+0D8h+var_CC], ecx ; char *
		mov	[esp+0D8h+var_D0], edx ; int
		mov	[esp+0D8h+Str2], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Str1], eax ; int
		call	sub_41757C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_4189E6
		mov	eax, [ebp+var_2C]
		lea	edx, [ebp+var_84]
		mov	[esp+0D8h+Str2], edx
		mov	[esp+0D8h+Str1], eax
		call	ksba_ocsp_get_sig_val
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41852B
		movzx	eax, [ebp+var_84]
		test	al, al
		jnz	short loc_41853F

loc_41852B:				; CODE XREF: sub_418114+40Aj
		mov	[esp+0D8h+Str1], 41h
		call	sub_4172E3
		mov	[ebp+var_C], eax
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_41853F:				; CODE XREF: sub_418114+415j
		lea	eax, [ebp+var_34]
		mov	[esp+0D8h+Str2], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0D8h+Str1], eax
		call	sub_41667D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_4189E9
		mov	eax, [ebp+var_10]
		mov	[esp+0D8h+Str1], eax
		call	gcry_free
		mov	[ebp+var_10], 0
		mov	ecx, [ebp+var_A0]
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ebx, [ebp+var_24]
		mov	[esp+0D8h+var_C8], ebx
		mov	[esp+0D8h+var_CC], ecx
		mov	[esp+0D8h+var_D0], edx
		mov	[esp+0D8h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Str1], eax
		call	sub_417DA7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_4189EC
		mov	eax, [ebp+var_2C]
		lea	edx, [ebp+var_9C]
		mov	[esp+0D8h+var_C0], edx
		lea	edx, [ebp+var_74]
		mov	[esp+0D8h+var_C4], edx
		lea	edx, [ebp+var_64]
		mov	[esp+0D8h+var_C8], edx
		lea	edx, [ebp+var_54]
		mov	[esp+0D8h+var_CC], edx
		lea	edx, [ebp+var_98]
		mov	[esp+0D8h+var_D0], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+0D8h+Str2], edx
		mov	[esp+0D8h+Str1], eax
		call	ksba_ocsp_get_status
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41860B
		mov	eax, [ebp+var_C]
		mov	[esp+0D8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aErrorGettingOc	; "error getting OCSP status for target	ce"...
		call	sub_4233B1
		jmp	loc_4189ED
; ---------------------------------------------------------------------------

loc_41860B:				; CODE XREF: sub_418114+4D5j
		mov	eax, [ebp+var_98]
		cmp	eax, 4
		jnz	short loc_418670
		mov	[ebp+var_AC], 0
		mov	[esp+0D8h+var_CC], 4
		lea	eax, [ebp+var_AC]
		mov	[esp+0D8h+var_D0], eax
		mov	[esp+0D8h+Str2], offset	aValidated_at ;	"validated_at"
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+Str1], eax
		call	ksba_cert_set_user_data
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_418670
		mov	eax, [ebp+var_C]
		mov	[esp+0D8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aSet_user_dataV	; "set_user_data(validated_at) failed: %s\"...
		call	sub_4233B1
		mov	[ebp+var_C], 0

loc_418670:				; CODE XREF: sub_418114+500j
					; sub_418114+538j
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	loc_4187F0
		mov	eax, [ebp+var_98]
		cmp	eax, 2
		jz	short loc_4186C4
		mov	eax, [ebp+var_98]
		cmp	eax, 4
		jz	short loc_4186BD
		mov	eax, [ebp+var_98]
		cmp	eax, 1
		jz	short loc_4186B6
		mov	eax, [ebp+var_98]
		test	eax, eax
		jnz	short loc_4186AF
		mov	eax, offset aNone_5 ; "none"
		jmp	short loc_4186B4
; ---------------------------------------------------------------------------

loc_4186AF:				; CODE XREF: sub_418114+592j
		mov	eax, offset a?_3 ; "?"

loc_4186B4:				; CODE XREF: sub_418114+599j
		jmp	short loc_4186BB
; ---------------------------------------------------------------------------

loc_4186B6:				; CODE XREF: sub_418114+588j
		mov	eax, offset aUnknown_0 ; "unknown"

loc_4186BB:				; CODE XREF: sub_418114:loc_4186B4j
		jmp	short loc_4186C2
; ---------------------------------------------------------------------------

loc_4186BD:				; CODE XREF: sub_418114+57Dj
		mov	eax, offset aRevoked ; "revoked"

loc_4186C2:				; CODE XREF: sub_418114:loc_4186BBj
		jmp	short loc_4186C9
; ---------------------------------------------------------------------------

loc_4186C4:				; CODE XREF: sub_418114+572j
		mov	eax, offset aGood ; "good"

loc_4186C9:				; CODE XREF: sub_418114:loc_4186C2j
		lea	edx, [ebp+var_64]
		mov	[esp+0D8h+var_CC], edx
		lea	edx, [ebp+var_54]
		mov	[esp+0D8h+var_D0], edx
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aCertificateSta	; "certificate status is: %s  (this=%s	ne"...
		call	sub_423387
		mov	eax, [ebp+var_98]
		cmp	eax, 4
		jnz	loc_4187F0
		mov	eax, [ebp+var_9C]
		cmp	eax, 1
		jz	loc_4187D4
		mov	eax, [ebp+var_9C]
		cmp	eax, 2
		jz	loc_4187CD
		mov	eax, [ebp+var_9C]
		cmp	eax, 4
		jz	loc_4187C6
		mov	eax, [ebp+var_9C]
		cmp	eax, 8
		jz	loc_4187BF
		mov	eax, [ebp+var_9C]
		cmp	eax, 10h
		jz	short loc_4187B8
		mov	eax, [ebp+var_9C]
		cmp	eax, 20h
		jz	short loc_4187B1
		mov	eax, [ebp+var_9C]
		cmp	eax, 40h
		jz	short loc_4187AA
		mov	eax, [ebp+var_9C]
		cmp	eax, 100h
		jz	short loc_4187A3
		mov	eax, [ebp+var_9C]
		cmp	eax, 200h
		jz	short loc_41879C
		mov	eax, [ebp+var_9C]
		cmp	eax, 400h
		jz	short loc_418795
		mov	eax, [ebp+var_9C]
		cmp	eax, 8000h
		jnz	short loc_41878E
		mov	eax, offset aOther_0 ; "other"
		jmp	short loc_418793
; ---------------------------------------------------------------------------

loc_41878E:				; CODE XREF: sub_418114+671j
		mov	eax, offset a?_3 ; "?"

loc_418793:				; CODE XREF: sub_418114+678j
		jmp	short loc_41879A
; ---------------------------------------------------------------------------

loc_418795:				; CODE XREF: sub_418114+664j
		mov	eax, offset aAaCompromise ; "AA	compromise"

loc_41879A:				; CODE XREF: sub_418114:loc_418793j
		jmp	short loc_4187A1
; ---------------------------------------------------------------------------

loc_41879C:				; CODE XREF: sub_418114+657j
		mov	eax, offset aPrivilegeWithd ; "privilege withdrawn"

loc_4187A1:				; CODE XREF: sub_418114:loc_41879Aj
		jmp	short loc_4187A8
; ---------------------------------------------------------------------------

loc_4187A3:				; CODE XREF: sub_418114+64Aj
		mov	eax, offset aRemovedFromCrl ; "removed from CRL"

loc_4187A8:				; CODE XREF: sub_418114:loc_4187A1j
		jmp	short loc_4187AF
; ---------------------------------------------------------------------------

loc_4187AA:				; CODE XREF: sub_418114+63Dj
		mov	eax, offset aCertificateOnH ; "certificate on hold"

loc_4187AF:				; CODE XREF: sub_418114:loc_4187A8j
		jmp	short loc_4187B6
; ---------------------------------------------------------------------------

loc_4187B1:				; CODE XREF: sub_418114+632j
		mov	eax, offset aCessationOfOpe ; "cessation of operation"

loc_4187B6:				; CODE XREF: sub_418114:loc_4187AFj
		jmp	short loc_4187BD
; ---------------------------------------------------------------------------

loc_4187B8:				; CODE XREF: sub_418114+627j
		mov	eax, offset aSuperseeded_0 ; "superseeded"

loc_4187BD:				; CODE XREF: sub_418114:loc_4187B6j
		jmp	short loc_4187C4
; ---------------------------------------------------------------------------

loc_4187BF:				; CODE XREF: sub_418114+618j
		mov	eax, offset aAffiliationCha ; "affiliation changed"

loc_4187C4:				; CODE XREF: sub_418114:loc_4187BDj
		jmp	short loc_4187CB
; ---------------------------------------------------------------------------

loc_4187C6:				; CODE XREF: sub_418114+609j
		mov	eax, offset aCaCompromise ; "CA	compromise"

loc_4187CB:				; CODE XREF: sub_418114:loc_4187C4j
		jmp	short loc_4187D2
; ---------------------------------------------------------------------------

loc_4187CD:				; CODE XREF: sub_418114+5FAj
		mov	eax, offset aKeyCompromise ; "key compromise"

loc_4187D2:				; CODE XREF: sub_418114:loc_4187CBj
		jmp	short loc_4187D9
; ---------------------------------------------------------------------------

loc_4187D4:				; CODE XREF: sub_418114+5EBj
		mov	eax, offset aUnspecified_0 ; "unspecified"

loc_4187D9:				; CODE XREF: sub_418114:loc_4187D2j
		mov	[esp+0D8h+var_D0], eax
		lea	eax, [ebp+var_74]
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aCertificateHas	; "certificate has been	revoked	at: %s due"...
		call	sub_423387

loc_4187F0:				; CODE XREF: sub_418114+563j
					; sub_418114+5DCj
		mov	eax, [ebp+var_98]
		cmp	eax, 4
		jnz	short loc_41880C
		mov	[esp+0D8h+Str1], 5Eh
		call	sub_4172E3
		mov	[ebp+var_C], eax
		jmp	short loc_418842
; ---------------------------------------------------------------------------

loc_41880C:				; CODE XREF: sub_418114+6E5j
		mov	eax, [ebp+var_98]
		cmp	eax, 1
		jnz	short loc_418828
		mov	[esp+0D8h+Str1], 3Ah
		call	sub_4172E3
		mov	[ebp+var_C], eax
		jmp	short loc_418842
; ---------------------------------------------------------------------------

loc_418828:				; CODE XREF: sub_418114+701j
		mov	eax, [ebp+var_98]
		cmp	eax, 2
		jz	short loc_418842
		mov	[esp+0D8h+Str1], 1
		call	sub_4172E3
		mov	[ebp+var_C], eax

loc_418842:				; CODE XREF: sub_418114+6F6j
					; sub_418114+712j ...
		lea	eax, [ebp+var_44]
		mov	[esp+0D8h+Str1], eax ; char *
		call	sub_415940
		mov	eax, ds:dword_436020
		mov	[esp+0D8h+Str2], eax ; int
		lea	eax, [ebp+var_44]
		mov	[esp+0D8h+Str1], eax ; char *
		call	sub_415EF7
		lea	eax, [ebp+var_44]
		mov	[esp+0D8h+Str2], eax ; char
		lea	eax, [ebp+var_54]
		mov	[esp+0D8h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jle	short loc_4188B2
		mov	[esp+0D8h+Str1], offset	aOcspResponderR	; "OCSP	responder returned a status in the"...
		call	sub_4233B1
		lea	eax, [ebp+var_54]
		mov	[esp+0D8h+var_D0], eax
		lea	eax, [ebp+var_44]
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aUsedNowSThis_u	; "used	now: %s	 this_update: %s\n"
		call	sub_423387
		cmp	[ebp+var_C], 0
		jnz	short loc_4188B2
		mov	[esp+0D8h+Str1], 27h
		call	sub_4172E3
		mov	[ebp+var_C], eax

loc_4188B2:				; CODE XREF: sub_418114+761j
					; sub_418114+78Dj
		lea	eax, [ebp+var_54]
		mov	[esp+0D8h+Str2], eax ; char *
		lea	eax, [ebp+var_94]
		mov	[esp+0D8h+Str1], eax ; char *
		call	sub_417326
		mov	edx, ds:dword_436024
		mov	eax, ds:dword_436020
		add	eax, edx
		mov	[esp+0D8h+Str2], eax ; int
		lea	eax, [ebp+var_94]
		mov	[esp+0D8h+Str1], eax ; char *
		call	sub_415EF7
		movzx	eax, [ebp+var_94]
		test	al, al
		jz	short loc_41890A
		lea	eax, [ebp+var_44]
		mov	[esp+0D8h+Str2], eax ; char
		lea	eax, [ebp+var_94]
		mov	[esp+0D8h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jns	short loc_418945

loc_41890A:				; CODE XREF: sub_418114+7DBj
		mov	[esp+0D8h+Str1], offset	aOcspResponde_0	; "OCSP	responder returned a non-current s"...
		call	sub_4233B1
		lea	eax, [ebp+var_54]
		mov	[esp+0D8h+var_D0], eax
		lea	eax, [ebp+var_44]
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aUsedNowSThis_u	; "used	now: %s	 this_update: %s\n"
		call	sub_423387
		cmp	[ebp+var_C], 0
		jnz	short loc_418945
		mov	[esp+0D8h+Str1], 27h
		call	sub_4172E3
		mov	[ebp+var_C], eax

loc_418945:				; CODE XREF: sub_418114+7F4j
					; sub_418114+820j
		movzx	eax, [ebp+var_64]
		test	al, al
		jz	loc_4189ED
		lea	eax, [ebp+var_64]
		mov	[esp+0D8h+Str2], eax ; char *
		lea	eax, [ebp+var_94]
		mov	[esp+0D8h+Str1], eax ; char *
		call	sub_417326
		mov	edx, ds:dword_436028
		mov	eax, ds:dword_436020
		add	eax, edx
		mov	[esp+0D8h+Str2], eax ; int
		lea	eax, [ebp+var_94]
		mov	[esp+0D8h+Str1], eax ; char *
		call	sub_415EF7
		movzx	eax, [ebp+var_94]
		test	al, al
		jnz	short loc_4189ED
		lea	eax, [ebp+var_44]
		mov	[esp+0D8h+Str2], eax ; char
		lea	eax, [ebp+var_94]
		mov	[esp+0D8h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jns	short loc_4189ED
		mov	[esp+0D8h+Str1], offset	aOcspResponde_1	; "OCSP	responder returned an too old stat"...
		call	sub_4233B1
		lea	eax, [ebp+var_64]
		mov	[esp+0D8h+var_D0], eax
		lea	eax, [ebp+var_44]
		mov	[esp+0D8h+Str2], eax ; char
		mov	[esp+0D8h+Str1], offset	aUsedNowSNext_u	; "used	now: %s	 next_update: %s\n"
		call	sub_423387
		cmp	[ebp+var_C], 0
		jnz	short loc_4189ED
		mov	[esp+0D8h+Str1], 27h
		call	sub_4172E3
		mov	[ebp+var_C], eax
		jmp	short loc_4189ED
; ---------------------------------------------------------------------------

loc_4189E6:				; CODE XREF: sub_418114+3E8j
		nop
		jmp	short loc_4189ED
; ---------------------------------------------------------------------------

loc_4189E9:				; CODE XREF: sub_418114+444j
		nop
		jmp	short loc_4189ED
; ---------------------------------------------------------------------------

loc_4189EC:				; CODE XREF: sub_418114+48Dj
		nop

loc_4189ED:				; CODE XREF: sub_418114+90j
					; sub_418114+CBj ...
		mov	eax, [ebp+var_A0]
		mov	[esp+0D8h+Str1], eax
		call	gcry_md_close
		mov	eax, [ebp+var_34]
		mov	[esp+0D8h+Str1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_10]
		mov	[esp+0D8h+Str1], eax
		call	gcry_free
		mov	eax, [ebp+var_30]
		mov	[esp+0D8h+Str1], eax
		call	ksba_cert_release
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+Str1], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_2C]
		mov	[esp+0D8h+Str1], eax
		call	ksba_ocsp_release
		mov	eax, [ebp+var_14]
		mov	[esp+0D8h+Str1], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		add	esp, 0D4h
		pop	ebx
		pop	ebp
		retn
sub_418114	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418A49	proc near		; CODE XREF: sub_406596+3A1p
					; sub_417DA7+CFp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_418A73
; ---------------------------------------------------------------------------

loc_418A51:				; CODE XREF: sub_418A49+32j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+18h], edx

loc_418A73:				; CODE XREF: sub_418A49+6j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	short loc_418A51
		leave
		retn
sub_418A49	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418A80(size_t)
sub_418A80	proc near		; CODE XREF: sub_418A9D+12p
					; sub_418AE3+Dp ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_418A90
		add	[ebp+arg_0], 1

loc_418A90:				; CODE XREF: sub_418A80+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_418A80	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418A9D(void *, size_t)
sub_418A9D	proc near		; CODE XREF: .text:0041C15Cp
					; sub_41C1F1+1A6p
					; DATA XREF: ...

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_418AB6
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Memory], eax ;	size_t
		call	sub_418A80
		jmp	short locret_418AC8
; ---------------------------------------------------------------------------

loc_418AB6:				; CODE XREF: sub_418A9D+Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc

locret_418AC8:				; CODE XREF: sub_418A9D+17j
		leave
		retn
sub_418A9D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418ACA(void *)
sub_418ACA	proc near		; CODE XREF: sub_418B78+63p
					; sub_419231+29p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_418AE1
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_418AE1:				; CODE XREF: sub_418ACA+Aj
		leave
		retn
sub_418ACA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418AE3	proc near		; CODE XREF: sub_419CF7+DFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0Ch ;	size_t
		call	sub_418A80
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_418B07
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_418B73
; ---------------------------------------------------------------------------

loc_418B07:				; CODE XREF: sub_418AE3+19j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_43580C
		call	pth_mutex_acquire
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	edx, ds:dword_435808
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], offset dword_435808
		mov	eax, ds:dword_435808
		test	eax, eax
		jz	short loc_418B58
		mov	eax, ds:dword_435808
		mov	edx, [ebp+var_10]
		add	edx, 4
		mov	[eax+8], edx

loc_418B58:				; CODE XREF: sub_418AE3+65j
		mov	eax, [ebp+var_10]
		mov	ds:dword_435808, eax
		mov	[esp+28h+var_28], offset dword_43580C
		call	pth_mutex_release
		mov	[ebp+var_C], 0

loc_418B73:				; CODE XREF: sub_418AE3+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_418AE3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418B78	proc near		; CODE XREF: sub_419E16+19p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_43580C
		call	pth_mutex_acquire
		mov	eax, ds:dword_435808
		mov	[ebp+var_C], eax
		jmp	short loc_418BEB
; ---------------------------------------------------------------------------

loc_418BA4:				; CODE XREF: sub_418B78+77j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_418BE2
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_418BD5
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+8]
		mov	[eax+8], edx

loc_418BD5:				; CODE XREF: sub_418B78+4Cj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_418ACA
		jmp	short loc_418BF1
; ---------------------------------------------------------------------------

loc_418BE2:				; CODE XREF: sub_418B78+34j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_418BEB:				; CODE XREF: sub_418B78+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_418BA4

loc_418BF1:				; CODE XREF: sub_418B78+68j
		mov	[esp+28h+var_28], offset dword_43580C
		call	pth_mutex_release
		leave
		retn
sub_418B78	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418BFF	proc near		; CODE XREF: sub_41B82C+7Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_43580C
		call	pth_mutex_acquire
		mov	eax, ds:dword_435808
		mov	[ebp+var_C], eax
		jmp	short loc_418C4B
; ---------------------------------------------------------------------------

loc_418C32:				; CODE XREF: sub_418BFF+50j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+arg_0]
		call	eax
		or	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_418C4B:				; CODE XREF: sub_418BFF+31j
		cmp	[ebp+var_C], 0
		jnz	short loc_418C32
		mov	[esp+28h+var_28], offset dword_43580C
		call	pth_mutex_release
		mov	eax, [ebp+var_10]
		leave
		retn
sub_418BFF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418C62	proc near		; CODE XREF: .text:0041AED5p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_435810
		test	eax, eax
		jnz	short loc_418CA9
		call	pth_init
		test	eax, eax
		jnz	short loc_418C8F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_418C8F
		mov	eax, 0FFFFFFFFh
		jmp	short locret_418CAE
; ---------------------------------------------------------------------------

loc_418C8F:				; CODE XREF: sub_418C62+16j
					; sub_418C62+24j
		mov	[esp+18h+var_18], offset dword_43580C
		call	pth_mutex_init
		test	eax, eax
		jz	short loc_418CA9
		mov	ds:dword_435810, 1

loc_418CA9:				; CODE XREF: sub_418C62+Dj
					; sub_418C62+3Bj
		mov	eax, 0

locret_418CAE:				; CODE XREF: sub_418C62+2Bj
		leave
		retn
sub_418C62	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418CB0	proc near		; CODE XREF: sub_41A842+69p
					; .text:0041B041p ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 28h ;	size_t
		call	sub_418A80
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_418CD7
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_418D6C
; ---------------------------------------------------------------------------

loc_418CD7:				; CODE XREF: sub_418CB0+19j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_20]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_24]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_10]
		mov	[eax+18h], edx
		cmp	[ebp+arg_14], 0
		setnz	dl
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+1Ch], dl
		cmp	[ebp+arg_18], 0
		jz	short loc_418D3C
		mov	eax, [ebp+arg_18]
		jmp	short loc_418D41
; ---------------------------------------------------------------------------

loc_418D3C:				; CODE XREF: sub_418CB0+85j
		mov	eax, offset sub_418A9D

loc_418D41:				; CODE XREF: sub_418CB0+8Aj
		mov	edx, [ebp+var_10]
		mov	[edx+20h], eax
		cmp	[ebp+arg_1C], 0
		jz	short loc_418D52
		mov	eax, [ebp+arg_1C]
		jmp	short loc_418D57
; ---------------------------------------------------------------------------

loc_418D52:				; CODE XREF: sub_418CB0+9Bj
		mov	eax, offset sub_418ACA

loc_418D57:				; CODE XREF: sub_418CB0+A0j
		mov	edx, [ebp+var_10]
		mov	[edx+24h], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_418D6C:				; CODE XREF: sub_418CB0+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_418CB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418D71(int, void *, size_t)
sub_418D71	proc near		; DATA XREF: .data:off_42B4C0o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_418DA9
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+arg_8], eax

loc_418DA9:				; CODE XREF: sub_418D71+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_418DE6
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx

loc_418DE6:				; CODE XREF: sub_418D71+3Cj
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		leave
		retn
sub_418D71	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418DF1(int, void *, size_t)
sub_418DF1	proc near		; DATA XREF: .data:off_42B4C4o

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_418E0D
		mov	eax, 0
		jmp	locret_419012
; ---------------------------------------------------------------------------

loc_418E0D:				; CODE XREF: sub_418DF1+10j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		and	eax, 8
		test	eax, eax
		jz	short loc_418E25
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx

loc_418E25:				; CODE XREF: sub_418DF1+26j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_418E5F
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_418E5F
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+arg_8], eax

loc_418E5F:				; CODE XREF: sub_418DF1+40j
					; sub_418DF1+57j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	loc_418FAC
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+18h]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		add	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_10]
		jbe	short loc_418EB9
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_419012
; ---------------------------------------------------------------------------

loc_418EB9:				; CODE XREF: sub_418DF1+AFj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+18h]
		add	eax, [ebp+var_10]
		sub	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_10]
		jbe	short loc_418EEA
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_419012
; ---------------------------------------------------------------------------

loc_418EEA:				; CODE XREF: sub_418DF1+E0j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+18h]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_10]
		mov	edx, 0
		div	[ebp+var_1C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_10]
		imul	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_418F3C
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_10]
		jnb	short loc_418F3C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_419012
; ---------------------------------------------------------------------------

loc_418F3C:				; CODE XREF: sub_418DF1+127j
					; sub_418DF1+132j
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Src], edx
		mov	[esp+38h+Dst], eax
		call	ecx
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_418F67
		mov	eax, 0FFFFFFFFh
		jmp	locret_419012
; ---------------------------------------------------------------------------

loc_418F67:				; CODE XREF: sub_418DF1+16Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+8], edx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_418FAC
		mov	[esp+38h+Size],	1EFh ; int
		mov	[esp+38h+Src], offset a____Dirmngr1_8 ;	"../../dirmngr-1.1.1/src/estream.c"
		mov	[esp+38h+Dst], offset aSizeMem_cookie ;	"!(size	> (mem_cookie->memory_size - mem"...
		call	sub_429780

loc_418FAC:				; CODE XREF: sub_418DF1+83j
					; sub_418DF1+19Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		cmp	edx, eax
		jbe	short loc_418FF8
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+14h], edx

loc_418FF8:				; CODE XREF: sub_418DF1+1F4j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_419012:				; CODE XREF: sub_418DF1+17j
					; sub_418DF1+C3j ...
		leave
		retn
sub_418DF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419014	proc near		; DATA XREF: .data:off_42B4C8o

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, 1
		jz	short loc_419041
		cmp	eax, 2
		jz	short loc_41906A
		test	eax, eax
		jnz	short loc_419093
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_4190AA
; ---------------------------------------------------------------------------

loc_419041:				; CODE XREF: sub_419014+12j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+10h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4190AA
; ---------------------------------------------------------------------------

loc_41906A:				; CODE XREF: sub_419014+17j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4190AA
; ---------------------------------------------------------------------------

loc_419093:				; CODE XREF: sub_419014+1Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_41922F
; ---------------------------------------------------------------------------

loc_4190AA:				; CODE XREF: sub_419014+2Bj
					; sub_419014+54j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	loc_4191BF
		cmp	edx, [ebp+var_C]
		jl	short loc_4190CC
		cmp	eax, [ebp+var_10]
		jnb	loc_4191BF

loc_4190CC:				; CODE XREF: sub_419014+ADj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_4190F1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_41922F
; ---------------------------------------------------------------------------

loc_4190F1:				; CODE XREF: sub_419014+C4j
		mov	eax, [ebp+var_14]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		add	eax, edx
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_419130
		cmp	edx, [ebp+var_C]
		jl	short loc_419119
		cmp	eax, [ebp+var_10]
		jnb	short loc_419130

loc_419119:				; CODE XREF: sub_419014+FEj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_41922F
; ---------------------------------------------------------------------------

loc_419130:				; CODE XREF: sub_419014+F9j
					; sub_419014+103j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_18]
		imul	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_419182
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_18]
		jnb	short loc_419182
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_41922F
; ---------------------------------------------------------------------------

loc_419182:				; CODE XREF: sub_419014+14Aj
					; sub_419014+155j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+Val], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4191AD
		mov	eax, 0FFFFFFFFh
		jmp	locret_41922F
; ---------------------------------------------------------------------------

loc_4191AD:				; CODE XREF: sub_419014+18Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx

loc_4191BF:				; CODE XREF: sub_419014+A4j
					; sub_419014+B2j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_419213
		cmp	edx, [ebp+var_C]
		jl	short loc_4191D9
		cmp	eax, [ebp+var_10]
		jnb	short loc_419213

loc_4191D9:				; CODE XREF: sub_419014+1BEj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		add	eax, edx
		mov	edx, ecx
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Val], 0 ; Val
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx

loc_419213:				; CODE XREF: sub_419014+1B9j
					; sub_419014+1C3j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_41922F:				; CODE XREF: sub_419014+91j
					; sub_419014+D8j ...
		leave
		retn
sub_419014	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419231	proc near		; CODE XREF: sub_41A842+32Fp
					; .text:0041B0C0p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_41925F
		mov	eax, [ebp+var_C]
		mov	edx, [eax+24h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_418ACA

loc_41925F:				; CODE XREF: sub_419231+10j
		mov	eax, 0
		leave
		retn
sub_419231	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419266	proc near		; CODE XREF: sub_41B23B+51p
					; .text:0041C8B4p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_418A80
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41928A
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_4192C9
; ---------------------------------------------------------------------------

loc_41928A:				; CODE XREF: sub_419266+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_4192A9
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_4192A9:				; CODE XREF: sub_419266+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_4192C9:				; CODE XREF: sub_419266+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_419266	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4192CE	proc near		; DATA XREF: .data:off_42B4D0o
					; .data:off_42B4F0o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax

loc_4192DA:				; CODE XREF: sub_4192CE+3Cj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	pth_read
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_41930C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_4192DA

loc_41930C:				; CODE XREF: sub_4192CE+2Ej
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4192CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419311	proc near		; DATA XREF: .data:off_42B4D4o
					; .data:off_42B4F4o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax

loc_41931D:				; CODE XREF: sub_419311+3Cj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	pth_write
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_41934F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_41931D

loc_41934F:				; CODE XREF: sub_419311+2Ej
		mov	eax, [ebp+var_10]
		leave
		retn
sub_419311	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419354	proc near		; DATA XREF: .data:off_42B4D8o
					; .data:off_42B4F8o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx]
		mov	ebx, [ebp+arg_8]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], ecx
		call	j__lseeki64
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_14]
		mov	edx, eax
		xor	edx, 0FFFFFFFFh
		mov	eax, [ebp+var_18]
		xor	eax, 0FFFFFFFFh
		or	eax, edx
		test	eax, eax
		jnz	short loc_4193A8
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_4193BD
; ---------------------------------------------------------------------------

loc_4193A8:				; CODE XREF: sub_419354+49j
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	[ebp+var_C], 0

loc_4193BD:				; CODE XREF: sub_419354+52j
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_419354	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4193C6	proc near		; CODE XREF: .text:0041AFB9p
					; sub_41B23B+CFp ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_419406
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_4193F1
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	_close
		jmp	short loc_4193F6
; ---------------------------------------------------------------------------

loc_4193F1:				; CODE XREF: sub_4193C6+1Aj
		mov	eax, 0

loc_4193F6:				; CODE XREF: sub_4193C6+29j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_418ACA
		jmp	short loc_41940D
; ---------------------------------------------------------------------------

loc_419406:				; CODE XREF: sub_4193C6+10j
		mov	[ebp+var_C], 0

loc_41940D:				; CODE XREF: sub_4193C6+3Ej
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4193C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419412(int, FILE *, int, int)
sub_419412	proc near		; CODE XREF: sub_41B355+61p

File		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+File],	8 ; size_t
		call	sub_418A80
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_419436
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_41947D
; ---------------------------------------------------------------------------

loc_419436:				; CODE XREF: sub_419412+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_41945D
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[esp+28h+var_24], 8000h
		mov	[esp+28h+File],	eax
		call	_setmode

loc_41945D:				; CODE XREF: sub_419412+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_41947D:				; CODE XREF: sub_419412+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_419412	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419482(int, void *, size_t)
sub_419482	proc near		; DATA XREF: .data:off_42B4E0o

DstBuf		= dword	ptr -28h
ElementSize	= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+ElementSize], 1 ; ElementSize
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4194D2
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_4194D2
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4194D5
; ---------------------------------------------------------------------------

loc_4194D2:				; CODE XREF: sub_419482+36j
					; sub_419482+47j
		mov	eax, [ebp+var_10]

locret_4194D5:				; CODE XREF: sub_419482+4Ej
		leave
		retn
sub_419482	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4194D7(int, void *, size_t)
sub_4194D7	proc near		; DATA XREF: .data:off_42B4E4o

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jz	short loc_419518
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41951B
; ---------------------------------------------------------------------------

loc_419518:				; CODE XREF: sub_4194D7+38j
		mov	eax, [ebp+var_10]

locret_41951B:				; CODE XREF: sub_4194D7+3Fj
		leave
		retn
sub_4194D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41951D	proc near		; DATA XREF: .data:off_42B4E8o

File		= dword	ptr -28h
Offset		= dword	ptr -24h
Origin		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Origin], ecx ;	Origin
		mov	[esp+28h+Offset], edx ;	Offset
		mov	[esp+28h+File],	eax ; File
		call	fseek
		test	eax, eax
		jz	short loc_419595
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [eax]
		mov	eax, offset aFseekFailedErr ; "\nfseek failed: errno=%d	(%s)\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+Origin], edx
		mov	[esp+28h+Offset], eax ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	short loc_419605
; ---------------------------------------------------------------------------

loc_419595:				; CODE XREF: sub_41951D+31j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	ftell
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_4195F0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [eax]
		mov	eax, offset aFtellFailedErr ; "\nftell failed: errno=%d	(%s)\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+Origin], edx
		mov	[esp+28h+Offset], eax ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		mov	eax, 0FFFFFFFFh
		jmp	short loc_419605
; ---------------------------------------------------------------------------

loc_4195F0:				; CODE XREF: sub_41951D+8Cj
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

loc_419605:				; CODE XREF: sub_41951D+76j
					; sub_41951D+D1j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_41951D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41960B	proc near		; CODE XREF: sub_41B355+E7p
					; DATA XREF: .data:off_42B4ECo

File		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_419658
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fflush
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_419643
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		jmp	short loc_419648
; ---------------------------------------------------------------------------

loc_419643:				; CODE XREF: sub_41960B+27j
		mov	eax, 0

loc_419648:				; CODE XREF: sub_41960B+36j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+File],	eax ; void *
		call	sub_418ACA
		jmp	short loc_41965F
; ---------------------------------------------------------------------------

loc_419658:				; CODE XREF: sub_41960B+10j
		mov	[ebp+var_C], 0

loc_41965F:				; CODE XREF: sub_41960B+4Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41960B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419664	proc near		; CODE XREF: .text:0041AF37p
					; .text:0041B50Dp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_418A80
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_419696
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_419703
; ---------------------------------------------------------------------------

loc_419696:				; CODE XREF: sub_419664+27j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_20], 180h
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_4196C2
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_419703
; ---------------------------------------------------------------------------

loc_4196C2:				; CODE XREF: sub_419664+53j
		mov	eax, [ebp+arg_C]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_4196E1
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_4196E1:				; CODE XREF: sub_419664+68j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_419703:				; CODE XREF: sub_419664+30j
					; sub_419664+5Cj
		cmp	[ebp+var_C], 0
		jz	short loc_419714
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_418ACA

loc_419714:				; CODE XREF: sub_419664+A3j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_419664	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419719(char *, int)
sub_419719	proc near		; CODE XREF: .text:0041AF0Ap
					; .text:0041AFE8p ...

Str1		= dword	ptr -0A8h
Str2		= dword	ptr -0A4h
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 9Ch
		lea	edx, [ebp+var_98]
		mov	ebx, offset off_42B500
		mov	eax, 1Eh
		mov	edi, edx
		mov	esi, ebx
		mov	ecx, eax
		rep movsd
		mov	[ebp+var_1C], 0
		jmp	short loc_419767
; ---------------------------------------------------------------------------

loc_419746:				; CODE XREF: sub_419719+52j
		mov	eax, [ebp+var_1C]
		mov	eax, [ebp+eax*8+var_98]
		mov	edx, [ebp+arg_0]
		mov	[esp+0A8h+Str2], edx ; Str2
		mov	[esp+0A8h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_41976F
		add	[ebp+var_1C], 1

loc_419767:				; CODE XREF: sub_419719+2Bj
		cmp	[ebp+var_1C], 0Eh
		jbe	short loc_419746
		jmp	short loc_419770
; ---------------------------------------------------------------------------

loc_41976F:				; CODE XREF: sub_419719+48j
		nop

loc_419770:				; CODE XREF: sub_419719+54j
		cmp	[ebp+var_1C], 0Fh
		jnz	short loc_41978C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_20], 0FFFFFFFFh
		jmp	short loc_4197A2
; ---------------------------------------------------------------------------

loc_41978C:				; CODE XREF: sub_419719+5Bj
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+eax*8+var_94]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_4197A2:				; CODE XREF: sub_419719+71j
		mov	eax, [ebp+var_20]
		add	esp, 9Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_419719	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4197B0	proc near		; CODE XREF: sub_419F20+2Fp
					; sub_41A758+4Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+228h]
		test	eax, eax
		jnz	short loc_4197E5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_419841
; ---------------------------------------------------------------------------

loc_4197E5:				; CODE XREF: sub_4197B0+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+228h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_419834
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_419841
; ---------------------------------------------------------------------------

loc_419834:				; CODE XREF: sub_4197B0+72j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0

loc_419841:				; CODE XREF: sub_4197B0+33j
					; sub_4197B0+82j
		cmp	[ebp+var_10], 0
		jz	short loc_41985F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		or	edx, 1
		mov	[eax+240h], dl
		jmp	short loc_41987B
; ---------------------------------------------------------------------------

loc_41985F:				; CODE XREF: sub_4197B0+95j
		cmp	[ebp+var_C], 0
		jnz	short loc_41987B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		or	edx, 2
		mov	[eax+240h], dl

loc_41987B:				; CODE XREF: sub_4197B0+ADj
					; sub_4197B0+B3j
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+220h]
		mov	ebx, [eax+224h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+220h], eax
		mov	[esi+224h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4197B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4198CB	proc near		; CODE XREF: sub_419C2D+7Cp
					; sub_41A037+35p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+22Ch]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_41990C
		mov	[esp+38h+var_30], 3F9h ; int
		mov	[esp+38h+var_34], offset a____Dirmngr1_8 ; "../../dirmngr-1.1.1/src/estream.c"
		mov	[esp+38h+var_38], offset aStreamFlags_wr ; "stream->flags.writing"
		call	sub_429780

loc_41990C:				; CODE XREF: sub_4198CB+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_419A37
		cmp	[ebp+var_18], 0
		jnz	short loc_41992C
		mov	[ebp+var_C], 28h
		jmp	loc_419A3E
; ---------------------------------------------------------------------------

loc_41992C:				; CODE XREF: sub_4198CB+53j
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	short loc_419998
; ---------------------------------------------------------------------------

loc_41993C:				; CODE XREF: sub_4198CB+DEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		sub	ecx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_419986
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_41998C
; ---------------------------------------------------------------------------

loc_419986:				; CODE XREF: sub_4198CB+A9j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax

loc_41998C:				; CODE XREF: sub_4198CB+B9j
		mov	eax, [ebp+var_10]
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4199AD

loc_419998:				; CODE XREF: sub_4198CB+6Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_14]
		test	eax, eax
		jle	short loc_4199AE
		cmp	[ebp+var_C], 0
		jz	short loc_41993C
		jmp	short loc_4199AE
; ---------------------------------------------------------------------------

loc_4199AD:				; CODE XREF: sub_4198CB+CBj
		nop

loc_4199AE:				; CODE XREF: sub_4198CB+D8j
					; sub_4198CB+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_14]
		jnz	short loc_419A3E
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+220h]
		mov	ebx, [eax+224h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+220h], eax
		mov	[esi+224h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		jmp	short loc_419A3E
; ---------------------------------------------------------------------------

loc_419A37:				; CODE XREF: sub_4198CB+49j
		mov	[ebp+var_C], 0

loc_419A3E:				; CODE XREF: sub_4198CB+5Cj
					; sub_4198CB+FDj ...
		cmp	[ebp+var_C], 0
		jz	short loc_419A5A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		or	edx, 1
		mov	[eax+240h], dl

loc_419A5A:				; CODE XREF: sub_4198CB+177j
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4198CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419A64	proc near		; CODE XREF: sub_41A22A+116p
					; sub_41AD00+33p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_419A94
		mov	[esp+18h+var_10], 43Ch ; int
		mov	[esp+18h+var_14], offset a____Dirmngr1_8 ; "../../dirmngr-1.1.1/src/estream.c"
		mov	[esp+18h+var_18], offset aStreamFlags__0 ; "!stream->flags.writing"
		call	sub_429780

loc_419A94:				; CODE XREF: sub_419A64+12j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		leave
		retn
sub_419A64	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419AB4	proc near		; CODE XREF: sub_419CF7+D4p
					; .text:0041B565p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+214h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+218h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	dword ptr [eax+224h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_C]
		mov	[eax+228h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_10]
		mov	[eax+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_14]
		mov	[eax+230h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_18]
		mov	[eax+234h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+238h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+23Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+244h]
		and	edx, 0FFFFFFFDh
		mov	[eax+244h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+248h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+24Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+250h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		and	edx, 0FFFFFFFEh
		mov	[eax+240h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		and	edx, 0FFFFFFFDh
		mov	[eax+240h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+244h]
		and	edx, 0FFFFFFFEh
		mov	[eax+244h], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_1C]
		and	eax, 1
		test	al, al
		jnz	short loc_419C0F
		mov	eax, [ebp+arg_1C]
		and	eax, 2
		test	eax, eax
		jz	short loc_419C1E

loc_419C0F:				; CODE XREF: sub_419AB4+14Fj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl
		jmp	short loc_419C2B
; ---------------------------------------------------------------------------

loc_419C1E:				; CODE XREF: sub_419AB4+159j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_419C2B:				; CODE XREF: sub_419AB4+168j
		pop	ebp
		retn
sub_419AB4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419C2D	proc near		; CODE XREF: sub_419CF7+10Ap
					; sub_419E16+24p ...

File		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+250h]
		test	eax, eax
		jz	short loc_419C7F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+250h]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+250h], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_419C7F:				; CODE XREF: sub_419C2D+14j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_419CC3
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax
		call	sub_4198CB
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_419CC3
		cmp	[ebp+var_18], 0
		jz	short loc_419CC3
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_419CC3:				; CODE XREF: sub_419C2D+74j
					; sub_419C2D+88j ...
		cmp	[ebp+var_14], 0
		jz	short loc_419CF2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+File],	eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_419CF2
		cmp	[ebp+var_18], 0
		jz	short loc_419CF2
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_419CF2:				; CODE XREF: sub_419C2D+9Aj
					; sub_419C2D+B7j ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_419C2D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419CF7	proc near		; CODE XREF: sub_41A842+C0p
					; .text:0041AF8Fp ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[esp+38h+var_38], 28h ;	size_t
		call	sub_418A80
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_419D2C
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_419DEF
; ---------------------------------------------------------------------------

loc_419D2C:				; CODE XREF: sub_419CF7+27j
		mov	[esp+38h+var_38], 258h ; size_t
		call	sub_418A80
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_419D4D
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_419DEF
; ---------------------------------------------------------------------------

loc_419D4D:				; CODE XREF: sub_419CF7+48j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 200h
		mov	eax, [ebp+var_14]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 10h
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+24h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_38], eax
		call	pth_mutex_init
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_419AB4
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_418AE3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_419DEE
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_419DEF
; ---------------------------------------------------------------------------

loc_419DEE:				; CODE XREF: sub_419CF7+EBj
		nop

loc_419DEF:				; CODE XREF: sub_419CF7+30j
					; sub_419CF7+51j ...
		cmp	[ebp+var_C], 0
		jz	short loc_419E11
		cmp	[ebp+var_10], 0
		jz	short loc_419E11
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_419C2D
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_418ACA

loc_419E11:				; CODE XREF: sub_419CF7+FCj
					; sub_419CF7+102j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_419CF7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419E16(void *)
sub_419E16	proc near		; CODE XREF: sub_41A842+31Bp
					; .text:0041B58Dp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_419E5B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_418B78
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_419C2D
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_418ACA
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_418ACA

loc_419E5B:				; CODE XREF: sub_419E16+11j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_419E16	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419E60	proc near		; CODE XREF: sub_41A037+DFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+228h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_419ED3
; ---------------------------------------------------------------------------

loc_419E87:				; CODE XREF: sub_419E60+79j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_419EC7
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_419EDE
; ---------------------------------------------------------------------------

loc_419EC7:				; CODE XREF: sub_419E60+5Cj
		cmp	[ebp+var_18], 0
		jz	short loc_419EDD
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_419ED3:				; CODE XREF: sub_419E60+25j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_419E87
		jmp	short loc_419EDE
; ---------------------------------------------------------------------------

loc_419EDD:				; CODE XREF: sub_419E60+6Bj
		nop

loc_419EDE:				; CODE XREF: sub_419E60+65j
					; sub_419E60+7Bj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+220h]
		mov	ebx, [eax+224h]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+220h], eax
		mov	[esi+224h], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_419E60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419F20	proc near		; CODE XREF: sub_41A009+21p
					; sub_41A037+141p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_419FE7
; ---------------------------------------------------------------------------

loc_419F39:				; CODE XREF: sub_419F20+D3j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_419F6B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_4197B0
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_419F6B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_419FFB

loc_419F6B:				; CODE XREF: sub_419F20+27j
					; sub_419F20+3Bj
		cmp	[ebp+var_14], 0
		jnz	short loc_419FE7
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_419FA3
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_419FA3:				; CODE XREF: sub_419F20+7Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_419FE7:				; CODE XREF: sub_419F20+14j
					; sub_419F20+4Fj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_419FFC
		cmp	[ebp+var_14], 0
		jz	loc_419F39
		jmp	short loc_419FFC
; ---------------------------------------------------------------------------

loc_419FFB:				; CODE XREF: sub_419F20+45j
		nop

loc_419FFC:				; CODE XREF: sub_419F20+CDj
					; sub_419F20+D9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_419F20	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A009	proc near		; CODE XREF: sub_41A037+110p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_419F20
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41A009	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A037	proc near		; CODE XREF: sub_41BADF+22p
					; sub_41BD13+4Ap ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41A0BE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4198CB
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_41A182
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl
		jmp	short loc_41A0BE
; ---------------------------------------------------------------------------

loc_41A08D:				; CODE XREF: sub_41A037+97j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		sub	eax, 1
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		mov	[edx], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		add	[ebp+var_C], 1

loc_41A0BE:				; CODE XREF: sub_41A037+2Dj
					; sub_41A037+54j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jz	short loc_41A0D0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_41A08D

loc_41A0D0:				; CODE XREF: sub_41A037+8Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		cmp	eax, 4
		jz	short loc_41A0EF
		cmp	eax, 40h
		jz	short loc_41A120
		test	eax, eax
		jz	short loc_41A151
		jmp	loc_41A183
; ---------------------------------------------------------------------------

loc_41A0EF:				; CODE XREF: sub_41A037+A8j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_419E60
		mov	[ebp+var_10], eax
		jmp	short loc_41A183
; ---------------------------------------------------------------------------

loc_41A120:				; CODE XREF: sub_41A037+ADj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41A009
		mov	[ebp+var_10], eax
		jmp	short loc_41A183
; ---------------------------------------------------------------------------

loc_41A151:				; CODE XREF: sub_41A037+B1j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_419F20
		mov	[ebp+var_10], eax
		jmp	short loc_41A183
; ---------------------------------------------------------------------------

loc_41A182:				; CODE XREF: sub_41A037+41j
		nop

loc_41A183:				; CODE XREF: sub_41A037+B3j
					; sub_41A037+E7j ...
		cmp	[ebp+arg_C], 0
		jz	short loc_41A196
		mov	eax, [ebp+var_18]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_41A196:				; CODE XREF: sub_41A037+150j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_41A037	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A19B(int, void *, size_t, int)
sub_41A19B	proc near		; CODE XREF: .text:0041BCE8p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_41A1C4
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_8], eax

loc_41A1C4:				; CODE XREF: sub_41A19B+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_41A219
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		and	edx, 0FFFFFFFDh
		mov	[eax+240h], dl
		jmp	short loc_41A21A
; ---------------------------------------------------------------------------

loc_41A219:				; CODE XREF: sub_41A19B+2Dj
		nop

loc_41A21A:				; CODE XREF: sub_41A19B+7Cj
		cmp	[ebp+arg_C], 0
		jz	short locret_41A228
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[eax], edx

locret_41A228:				; CODE XREF: sub_41A19B+83j
		leave
		retn
sub_41A19B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A22A	proc near		; CODE XREF: sub_41A618+58p
					; sub_41A842+268p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_41A26D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	loc_41A38A
; ---------------------------------------------------------------------------

loc_41A26D:				; CODE XREF: sub_41A22A+28j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41A2A0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4198CB
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_41A389
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_41A2A0:				; CODE XREF: sub_41A22A+4Fj
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		cmp	[ebp+arg_C], 1
		jnz	short loc_41A2FF
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+8]
		mov	ebx, 0
		mov	esi, eax
		mov	edi, edx
		sub	esi, ecx
		sbb	edi, ebx
		mov	ecx, esi
		mov	ebx, edi
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	ebx, 0
		sub	eax, ecx
		sbb	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx

loc_41A2FF:				; CODE XREF: sub_41A22A+86j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_50], edx
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+var_20]
		call	eax
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	short loc_41A333
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	short loc_41A38A
; ---------------------------------------------------------------------------

loc_41A333:				; CODE XREF: sub_41A22A+FEj
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_419A64
		cmp	[ebp+arg_10], 0
		jz	short loc_41A359
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_10]
		mov	[ecx], eax
		mov	[ecx+4], edx

loc_41A359:				; CODE XREF: sub_41A22A+11Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		and	edx, 0FFFFFFFDh
		mov	[eax+240h], dl
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ecx+220h], eax
		mov	[ecx+224h], edx
		jmp	short loc_41A38A
; ---------------------------------------------------------------------------

loc_41A389:				; CODE XREF: sub_41A22A+63j
		nop

loc_41A38A:				; CODE XREF: sub_41A22A+3Ej
					; sub_41A22A+107j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_41A3A6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		or	edx, 1
		mov	[eax+240h], dl

loc_41A3A6:				; CODE XREF: sub_41A22A+164j
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41A22A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A3B1	proc near		; CODE XREF: sub_41A552+79p
					; sub_41A618+B6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+22Ch]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_41A3E0
		cmp	[ebp+var_14], 0
		jnz	short loc_41A3E0
		mov	[ebp+var_10], 28h
		jmp	loc_41A476
; ---------------------------------------------------------------------------

loc_41A3E0:				; CODE XREF: sub_41A3B1+1Bj
					; sub_41A3B1+21j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_41A436
; ---------------------------------------------------------------------------

loc_41A3F0:				; CODE XREF: sub_41A3B1+8Bj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_41A430
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_41A43E
; ---------------------------------------------------------------------------

loc_41A430:				; CODE XREF: sub_41A3B1+74j
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_41A436:				; CODE XREF: sub_41A3B1+3Dj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_41A3F0

loc_41A43E:				; CODE XREF: sub_41A3B1+7Dj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+220h]
		mov	ebx, [eax+224h]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+220h], eax
		mov	[esi+224h], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_41A476:				; CODE XREF: sub_41A3B1+2Aj
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_41A3B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A480	proc near		; CODE XREF: sub_41A552+ACp
					; sub_41A618+100p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_41A533
; ---------------------------------------------------------------------------

loc_41A499:				; CODE XREF: sub_41A480+BFj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_41A4B7
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_4198CB
		mov	[ebp+var_14], eax

loc_41A4B7:				; CODE XREF: sub_41A480+27j
		cmp	[ebp+var_14], 0
		jnz	short loc_41A533
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_41A4EF
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_41A4EF:				; CODE XREF: sub_41A480+67j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_41A533:				; CODE XREF: sub_41A480+14j
					; sub_41A480+3Bj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_41A545
		cmp	[ebp+var_14], 0
		jz	loc_41A499

loc_41A545:				; CODE XREF: sub_41A480+B9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_41A480	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A552	proc near		; CODE XREF: sub_41A618+DBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0Ah
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_4266E3
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41A5D3
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4198CB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41A5D3
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41A3B1
		mov	[ebp+var_C], eax

loc_41A5D3:				; CODE XREF: sub_41A552+3Cj
					; sub_41A552+50j
		cmp	[ebp+var_C], 0
		jnz	short loc_41A606
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		add	eax, [ebp+arg_4]
		lea	edx, [ebp+var_18]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41A480
		mov	[ebp+var_C], eax

loc_41A606:				; CODE XREF: sub_41A552+85j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41A552	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A618	proc near		; CODE XREF: sub_41ABAB+2Ep
					; sub_41BB26+29p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_41A697
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		test	eax, eax
		jz	short loc_41A697
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 1
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41A22A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41A697
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 1Dh
		jnz	loc_41A722
		mov	[ebp+var_C], 0

loc_41A697:				; CODE XREF: sub_41A618+20j
					; sub_41A618+30j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		cmp	eax, 4
		jz	short loc_41A6B3
		cmp	eax, 40h
		jz	short loc_41A6D8
		test	eax, eax
		jz	short loc_41A6FD
		jmp	short loc_41A723
; ---------------------------------------------------------------------------

loc_41A6B3:				; CODE XREF: sub_41A618+8Ej
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41A3B1
		mov	[ebp+var_C], eax
		jmp	short loc_41A723
; ---------------------------------------------------------------------------

loc_41A6D8:				; CODE XREF: sub_41A618+93j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41A552
		mov	[ebp+var_C], eax
		jmp	short loc_41A723
; ---------------------------------------------------------------------------

loc_41A6FD:				; CODE XREF: sub_41A618+97j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41A480
		mov	[ebp+var_C], eax
		jmp	short loc_41A723
; ---------------------------------------------------------------------------

loc_41A722:				; CODE XREF: sub_41A618+72j
		nop

loc_41A723:				; CODE XREF: sub_41A618+99j
					; sub_41A618+BEj ...
		cmp	[ebp+arg_C], 0
		jz	short loc_41A731
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_41A731:				; CODE XREF: sub_41A618+10Fj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_41A753
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_41A753
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl

loc_41A753:				; CODE XREF: sub_41A618+11Ej
					; sub_41A618+12Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41A618	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A758	proc near		; CODE XREF: sub_41A842+106p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41A78D
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4198CB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41A7EB
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_41A78D:				; CODE XREF: sub_41A758+12j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_41A7B1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4197B0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41A7EE

loc_41A7B1:				; CODE XREF: sub_41A758+43j
		cmp	[ebp+arg_4], 0
		jz	short loc_41A7C9
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_41A7C9:				; CODE XREF: sub_41A758+5Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_41A7E2
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_41A7E2:				; CODE XREF: sub_41A758+75j
		mov	[ebp+var_C], 0
		jmp	short loc_41A7EF
; ---------------------------------------------------------------------------

loc_41A7EB:				; CODE XREF: sub_41A758+26j
		nop
		jmp	short loc_41A7EF
; ---------------------------------------------------------------------------

loc_41A7EE:				; CODE XREF: sub_41A758+57j
		nop

loc_41A7EF:				; CODE XREF: sub_41A758+91j
					; sub_41A758+94j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41A758	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A7F4	proc near		; CODE XREF: sub_41A842+1B3p
					; sub_41A842+1FFp

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jbe	short loc_41A825
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_41A83D
; ---------------------------------------------------------------------------

loc_41A825:				; CODE XREF: sub_41A7F4+19j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	[ebp+var_C], 0

loc_41A83D:				; CODE XREF: sub_41A7F4+2Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41A7F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A842	proc near		; CODE XREF: .text:0041C109p

Buf		= dword	ptr -68h
Val		= dword	ptr -64h
MaxCount	= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_14], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_44], 0
		mov	[esp+68h+var_48], 2
		mov	[esp+68h+var_4C], offset sub_418ACA
		mov	[esp+68h+var_50], offset sub_418A9D
		mov	[esp+68h+var_54], 1
		mov	[esp+68h+var_58], 200h
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+Buf], eax
		call	sub_418CB0
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_41AB43
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_4C], 2
		mov	edx, off_42B4C0
		mov	[esp+68h+var_5C], edx
		mov	edx, off_42B4C4
		mov	[esp+68h+var_58], edx
		mov	edx, off_42B4C8
		mov	[esp+68h+var_54], edx
		mov	edx, off_42B4CC
		mov	[esp+68h+var_50], edx
		mov	[esp+68h+MaxCount], 0FFFFFFFFh
		mov	[esp+68h+Val], eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf], eax
		call	sub_419CF7
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_41AB46
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_41A924
; ---------------------------------------------------------------------------

loc_41A923:				; CODE XREF: sub_41A842+208j
		nop

loc_41A924:				; CODE XREF: sub_41A842+DFj
		cmp	[ebp+arg_4], 0
		jz	short loc_41A934
		cmp	[ebp+var_C], 1
		jz	loc_41AA52

loc_41A934:				; CODE XREF: sub_41A842+E6j
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+MaxCount], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_41A758
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_41AA53
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	loc_41AA53
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jnb	short loc_41A97B
		mov	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_2C], eax

loc_41A97B:				; CODE XREF: sub_41A842+12Ej
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	[esp+68h+MaxCount], edx	; MaxCount
		mov	[esp+68h+Val], 0Ah ; Val
		mov	[esp+68h+Buf], eax ; Buf
		call	memchr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41A9FC
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_41BD86
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41AA46
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_41A7F4
		jmp	short loc_41AA53
; ---------------------------------------------------------------------------

loc_41A9FC:				; CODE XREF: sub_41A842+15Aj
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_41BD86
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41AA46
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_41A7F4

loc_41AA46:				; CODE XREF: sub_41A842+198j
					; sub_41A842+1E4j
		cmp	[ebp+var_18], 0
		jz	loc_41A923
		jmp	short loc_41AA53
; ---------------------------------------------------------------------------

loc_41AA52:				; CODE XREF: sub_41A842+ECj
		nop

loc_41AA53:				; CODE XREF: sub_41A842+112j
					; sub_41A842+11Dj ...
		cmp	[ebp+var_18], 0
		jnz	loc_41AB49
		cmp	[ebp+arg_4], 1
		jbe	short loc_41AA84
		cmp	[ebp+var_10], 0
		jnz	short loc_41AA84
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		or	edx, 2
		mov	[eax+240h], dl
		jmp	loc_41AB50
; ---------------------------------------------------------------------------

loc_41AA84:				; CODE XREF: sub_41A842+21Fj
					; sub_41A842+225j
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Buf], eax
		call	sub_41A22A
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_41AB4C
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41AAE5
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+Buf], eax ; size_t
		call	sub_418A80
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41AAED
		mov	[ebp+var_18], 0FFFFFFFFh
		jmp	short loc_41AB50
; ---------------------------------------------------------------------------

loc_41AAE5:				; CODE XREF: sub_41A842+281j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_41AAED:				; CODE XREF: sub_41A842+298j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	ecx, [ebp+var_10]
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_41BD13
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41AB4F
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41AB33
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_41AB33:				; CODE XREF: sub_41A842+2E7j
		cmp	[ebp+arg_C], 0
		jz	short loc_41AB50
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_41AB50
; ---------------------------------------------------------------------------

loc_41AB43:				; CODE XREF: sub_41A842+75j
		nop
		jmp	short loc_41AB50
; ---------------------------------------------------------------------------

loc_41AB46:				; CODE XREF: sub_41A842+CCj
		nop
		jmp	short loc_41AB50
; ---------------------------------------------------------------------------

loc_41AB49:				; CODE XREF: sub_41A842+215j
		nop
		jmp	short loc_41AB50
; ---------------------------------------------------------------------------

loc_41AB4C:				; CODE XREF: sub_41A842+274j
		nop
		jmp	short loc_41AB50
; ---------------------------------------------------------------------------

loc_41AB4F:				; CODE XREF: sub_41A842+2D3j
		nop

loc_41AB50:				; CODE XREF: sub_41A842+23Dj
					; sub_41A842+2A1j ...
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_41AB64
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Buf], eax ; void *
		call	sub_419E16
		jmp	short loc_41AB76
; ---------------------------------------------------------------------------

loc_41AB64:				; CODE XREF: sub_41A842+313j
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_41AB76
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Buf], eax
		call	sub_419231

loc_41AB76:				; CODE XREF: sub_41A842+320j
					; sub_41A842+327j
		cmp	[ebp+var_18], 0
		jz	short loc_41ABA6
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41AB90
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Buf], eax ; void *
		call	sub_418ACA

loc_41AB90:				; CODE XREF: sub_41A842+341j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+240h]
		or	edx, 1
		mov	[eax+240h], dl

loc_41ABA6:				; CODE XREF: sub_41A842+338j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_41A842	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41ABAB	proc near		; DATA XREF: sub_41AC03+2Bo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_41A618
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+24h]
		mov	ecx, [edx+24Ch]
		mov	edx, [ebp+var_14]
		add	edx, ecx
		mov	[eax+24Ch], edx
		mov	eax, [ebp+var_10]
		leave
		retn
sub_41ABAB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AC03	proc near		; CODE XREF: .text:0041C507p
					; sub_41C527+22p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+24Ch], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], offset sub_41ABAB
		call	sub_41ED7C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AC4A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41AC56
; ---------------------------------------------------------------------------

loc_41AC4A:				; CODE XREF: sub_41AC03+3Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+24Ch]

locret_41AC56:				; CODE XREF: sub_41AC03+45j
		leave
		retn
sub_41AC03	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AC58	proc near		; CODE XREF: sub_41AD00+4Ep
					; sub_41B7C0+1Cp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	short loc_41AC85
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_4], 0
		setnz	dl
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+240h]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+240h], dl

loc_41AC85:				; CODE XREF: sub_41AC58+7j
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	short loc_41ACB0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_8], 0
		setnz	dl
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+240h]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+240h], dl

loc_41ACB0:				; CODE XREF: sub_41AC58+31j
		pop	ebp
		retn
sub_41AC58	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41ACB2	proc near		; CODE XREF: sub_41B6DC+1Cp
					; sub_41B74E+1Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_41ACDD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+240h]
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax
		jmp	short loc_41ACFB
; ---------------------------------------------------------------------------

loc_41ACDD:				; CODE XREF: sub_41ACB2+11j
		cmp	[ebp+arg_8], 0
		jz	short loc_41ACFB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+240h]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax

loc_41ACFB:				; CODE XREF: sub_41ACB2+29j
					; sub_41ACB2+2Fj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_41ACB2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41AD00(int, int, int,	size_t)
sub_41AD00	proc near		; CODE XREF: .text:0041C9AFp
					; .text:0041CA39p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41AD2D
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4198CB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AD38
		jmp	loc_41AE13
; ---------------------------------------------------------------------------

loc_41AD2D:				; CODE XREF: sub_41AD00+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_419A64

loc_41AD38:				; CODE XREF: sub_41AD00+26j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41AC58
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+244h]
		and	eax, 1
		test	al, al
		jz	short loc_41AD93
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+244h]
		and	edx, 0FFFFFFFEh
		mov	[eax+244h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_418ACA
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

loc_41AD93:				; CODE XREF: sub_41AD00+65j
		cmp	[ebp+arg_8], 4
		jnz	short loc_41ADA5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		jmp	short loc_41ADFD
; ---------------------------------------------------------------------------

loc_41ADA5:				; CODE XREF: sub_41AD00+97j
		cmp	[ebp+arg_4], 0
		jz	short loc_41ADB3
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_41ADD0
; ---------------------------------------------------------------------------

loc_41ADB3:				; CODE XREF: sub_41AD00+A9j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_418A80
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41ADD0
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_41AE13
; ---------------------------------------------------------------------------

loc_41ADD0:				; CODE XREF: sub_41AD00+B1j
					; sub_41AD00+C5j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		cmp	[ebp+arg_4], 0
		jnz	short loc_41ADFD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+244h]
		or	edx, 1
		mov	[eax+244h], dl

loc_41ADFD:				; CODE XREF: sub_41AD00+A3j
					; sub_41AD00+E5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+238h], edx
		mov	[ebp+var_C], 0

loc_41AE13:				; CODE XREF: sub_41AD00+28j
					; sub_41AD00+CEj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41AD00	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AE18	proc near		; CODE XREF: .text:0041B9D8p
					; .text:0041BA35p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+220h]
		mov	ebx, [eax+224h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jl	short loc_41AE70
		cmp	edx, [ebp+var_C]
		jg	short loc_41AE60
		cmp	eax, [ebp+var_10]
		jbe	short loc_41AE70

loc_41AE60:				; CODE XREF: sub_41AE18+41j
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_41AE81
; ---------------------------------------------------------------------------

loc_41AE70:				; CODE XREF: sub_41AE18+3Cj
					; sub_41AE18+46j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		sub	[ebp+var_10], eax
		sbb	[ebp+var_C], edx

loc_41AE81:				; CODE XREF: sub_41AE18+56j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_41AE18	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AE8D	proc near		; CODE XREF: .text:0041CA91p
					; .text:0041CAE9p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		jz	short loc_41AEA7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+218h]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_41AEA7:				; CODE XREF: sub_41AE8D+7j
		cmp	[ebp+arg_4], 0
		jz	short loc_41AEBC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+218h], edx

loc_41AEBC:				; CODE XREF: sub_41AE8D+1Ej
		pop	ebp
		retn
sub_41AE8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AEBE	proc near		; CODE XREF: sub_41B5F8+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+23Ch]
		pop	ebp
		retn
sub_41AEBE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_418C62
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_419719
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_41AF9D
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-20h]
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_419664
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41AFA0
		mov	dword ptr [ebp-0Ch], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-20h]
		mov	eax, [ebp-1Ch]
		mov	[esp+1Ch], ecx
		mov	ecx, off_42B4F0
		mov	[esp+0Ch], ecx
		mov	ecx, off_42B4F4
		mov	[esp+10h], ecx
		mov	ecx, off_42B4F8
		mov	[esp+14h], ecx
		mov	ecx, off_42B4FC
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_419CF7
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jmp	short loc_41AFA1
; ---------------------------------------------------------------------------

loc_41AF9D:				; CODE XREF: .text:0041AF16j
		nop
		jmp	short loc_41AFA1
; ---------------------------------------------------------------------------

loc_41AFA0:				; CODE XREF: .text:0041AF43j
		nop

loc_41AFA1:				; CODE XREF: .text:0041AF9Bj
					; .text:0041AF9Ej
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_41AFBB
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41AFBB
		mov	edx, off_42B4FC
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_4193C6

loc_41AFBB:				; CODE XREF: .text:0041AFA5j
					; .text:0041AFABj
		mov	eax, [ebp-18h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+20h]
		mov	[esp], eax
		call	sub_419719
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_41B0A4
		mov	edx, [ebp-14h]
		lea	eax, [ebp-1Ch]
		mov	dword ptr [esp+24h], 0
		mov	[esp+20h], edx
		mov	edx, [ebp+1Ch]
		mov	[esp+1Ch], edx
		mov	edx, [ebp+18h]
		mov	[esp+18h], edx
		mov	edx, [ebp+14h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 200h
		mov	edx, [ebp+10h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_418CB0
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41B0A7
		mov	dword ptr [ebp-0Ch], 1
		mov	edx, [ebp-14h]
		mov	eax, [ebp-1Ch]
		mov	[esp+1Ch], edx
		mov	edx, off_42B4C0
		mov	[esp+0Ch], edx
		mov	edx, off_42B4C4
		mov	[esp+10h], edx
		mov	edx, off_42B4C8
		mov	[esp+14h], edx
		mov	edx, off_42B4CC
		mov	[esp+18h], edx
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_419CF7
		mov	[ebp-10h], eax
		jmp	short loc_41B0A8
; ---------------------------------------------------------------------------

loc_41B0A4:				; CODE XREF: .text:0041AFF4j
		nop
		jmp	short loc_41B0A8
; ---------------------------------------------------------------------------

loc_41B0A7:				; CODE XREF: .text:0041B04Dj
		nop

loc_41B0A8:				; CODE XREF: .text:0041B0A2j
					; .text:0041B0A5j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_41B0C2
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41B0C2
		mov	edx, off_42B4CC
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_419231

loc_41B0C2:				; CODE XREF: .text:0041B0ACj
					; .text:0041B0B2j
		mov	eax, [ebp-18h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-14h], 0
		lea	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_419719
		test	eax, eax
		jz	short loc_41B0FB
		mov	eax, 0
		jmp	locret_41B1BE
; ---------------------------------------------------------------------------

loc_41B0FB:				; CODE XREF: .text:0041B0EFj
		mov	eax, [ebp-0Ch]
		or	eax, 2
		mov	[ebp-0Ch], eax
		mov	edx, [ebp-0Ch]
		lea	eax, [ebp-14h]
		mov	ecx, [ebp+8]
		mov	[esp+24h], ecx
		mov	[esp+20h], edx
		mov	dword ptr [esp+1Ch], offset sub_418ACA
		mov	dword ptr [esp+18h], offset sub_418A9D
		mov	dword ptr [esp+14h], 1
		mov	dword ptr [esp+10h], 200h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	sub_418CB0
		test	eax, eax
		jz	short loc_41B160
		mov	eax, 0
		jmp	short locret_41B1BE
; ---------------------------------------------------------------------------

loc_41B160:				; CODE XREF: .text:0041B157j
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp-14h]
		mov	[esp+1Ch], edx
		mov	edx, off_42B4C0
		mov	[esp+0Ch], edx
		mov	edx, off_42B4C4
		mov	[esp+10h], edx
		mov	edx, off_42B4C8
		mov	[esp+14h], edx
		mov	edx, off_42B4CC
		mov	[esp+18h], edx
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_419CF7
		test	eax, eax
		jz	short loc_41B1BB
		mov	edx, off_42B4CC
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	edx ; sub_419231

loc_41B1BB:				; CODE XREF: .text:0041B1ABj
		mov	eax, [ebp-10h]

locret_41B1BE:				; CODE XREF: .text:0041B0F6j
					; .text:0041B15Ej
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B1C0(int, char *, int, int,	int, int)
sub_41B1C0	proc near		; CODE XREF: sub_4135D8+120p
					; sub_4141ED+602p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_14], 0
		mov	[ebp+var_10], 0
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_419719
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41B235
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_20], eax
		mov	[esp+38h+var_30], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	sub_419CF7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jmp	short loc_41B236
; ---------------------------------------------------------------------------

loc_41B235:				; CODE XREF: sub_41B1C0+2Dj
		nop

loc_41B236:				; CODE XREF: sub_41B1C0+73j
		mov	eax, [ebp+var_14]
		leave
		retn
sub_41B1C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B23B(int, char *, int)
sub_41B23B	proc near		; CODE XREF: .text:0041B32Cp
					; .text:0041B34Ep

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_44], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_419719
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41B2EE
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_44], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_419266
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41B2F1
		mov	[ebp+var_C], 1
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_2C], edx
		mov	edx, off_42B4D0
		mov	[esp+48h+var_3C], edx
		mov	edx, off_42B4D4
		mov	[esp+48h+var_38], edx
		mov	edx, off_42B4D8
		mov	[esp+48h+var_34], edx
		mov	edx, off_42B4DC
		mov	[esp+48h+var_30], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_419CF7
		mov	[ebp+var_10], eax
		jmp	short loc_41B2F2
; ---------------------------------------------------------------------------

loc_41B2EE:				; CODE XREF: sub_41B23B+34j
		nop
		jmp	short loc_41B2F2
; ---------------------------------------------------------------------------

loc_41B2F1:				; CODE XREF: sub_41B23B+5Dj
		nop

loc_41B2F2:				; CODE XREF: sub_41B23B+B1j
					; sub_41B23B+B4j
		cmp	[ebp+var_10], 0
		jz	short loc_41B30C
		cmp	[ebp+var_C], 0
		jz	short loc_41B30C
		mov	edx, off_42B4DC
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	edx ; sub_4193C6

loc_41B30C:				; CODE XREF: sub_41B23B+BBj
					; sub_41B23B+C1j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_41B23B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B23B
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B23B
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B355(FILE *, char *, int)
sub_41B355	proc near		; CODE XREF: .text:0041B462p
					; .text:0041B484p

File		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_44], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+File],	eax ; char *
		call	sub_419719
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_41B420
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+File],	eax ; File
		call	fflush
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_3C], edx ;	int
		mov	[esp+48h+var_40], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_44], eax ;	FILE *
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+File],	eax ; int
		call	sub_419412
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41B423
		mov	[ebp+var_C], 1
		mov	ebx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+File],	eax ; File
		call	_fileno
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_2C], ebx
		mov	ecx, off_42B4E0
		mov	[esp+48h+var_3C], ecx
		mov	ecx, off_42B4E4
		mov	[esp+48h+var_38], ecx
		mov	ecx, off_42B4E8
		mov	[esp+48h+var_34], ecx
		mov	ecx, off_42B4EC
		mov	[esp+48h+var_30], ecx
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], edx
		lea	eax, [ebp+var_18]
		mov	[esp+48h+File],	eax
		call	sub_419CF7
		mov	[ebp+var_10], eax
		jmp	short loc_41B424
; ---------------------------------------------------------------------------

loc_41B420:				; CODE XREF: sub_41B355+35j
		nop
		jmp	short loc_41B424
; ---------------------------------------------------------------------------

loc_41B423:				; CODE XREF: sub_41B355+6Dj
		nop

loc_41B424:				; CODE XREF: sub_41B355+C9j
					; sub_41B355+CCj
		cmp	[ebp+var_10], 0
		jz	short loc_41B43E
		cmp	[ebp+var_C], 0
		jz	short loc_41B43E
		mov	edx, off_42B4EC
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+File],	eax
		call	edx ; sub_41960B

loc_41B43E:				; CODE XREF: sub_41B355+D3j
					; sub_41B355+D9j
		mov	eax, [ebp+var_18]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_41B355	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B355
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B355
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	dword ptr [ebp+8], 0
		jz	loc_41B5B0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_419C2D
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_419719
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41B56C
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_419664
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41B56F
		mov	dword ptr [ebp-10h], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-18h]
		mov	[esp+1Ch], ecx
		mov	ecx, off_42B4F0
		mov	[esp+0Ch], ecx
		mov	ecx, off_42B4F4
		mov	[esp+10h], ecx
		mov	ecx, off_42B4F8
		mov	[esp+14h], ecx
		mov	ecx, off_42B4FC
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_419AB4
		jmp	short loc_41B570
; ---------------------------------------------------------------------------

loc_41B56C:				; CODE XREF: .text:0041B4F0j
		nop
		jmp	short loc_41B570
; ---------------------------------------------------------------------------

loc_41B56F:				; CODE XREF: .text:0041B519j
		nop

loc_41B570:				; CODE XREF: .text:0041B56Aj
					; .text:0041B56Dj
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41B59B
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_41B587
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_4193C6

loc_41B587:				; CODE XREF: .text:0041B57Aj
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_419E16
		mov	dword ptr [ebp+10h], 0
		jmp	short loc_41B5DA
; ---------------------------------------------------------------------------

loc_41B59B:				; CODE XREF: .text:0041B574j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		jmp	short loc_41B5DA
; ---------------------------------------------------------------------------

loc_41B5B0:				; CODE XREF: .text:0041B495j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_419C2D
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_419E16
		mov	dword ptr [ebp+10h], 0

loc_41B5DA:				; CODE XREF: .text:0041B599j
					; .text:0041B5AEj
		mov	eax, [ebp+10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B5DF(void *)
sub_41B5DF	proc near		; CODE XREF: sub_40C1C5+31p
					; sub_413430+10Bp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_419E16
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41B5DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B5F8	proc near		; CODE XREF: .text:0041B6BCp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	[esp+4+var_4], eax
		call	sub_41AEBE
		leave
		retn
sub_41B5F8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	pth_mutex_acquire
		cmp	eax, 1
		jnz	short loc_41B66B
		mov	eax, 0
		jmp	short locret_41B670
; ---------------------------------------------------------------------------

loc_41B66B:				; CODE XREF: .text:0041B662j
		mov	eax, 0FFFFFFFFh

locret_41B670:				; CODE XREF: .text:0041B669j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B5F8
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B6DC	proc near		; CODE XREF: sub_41B6FF+2Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 1
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_41ACB2
		leave
		retn
sub_41B6DC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B6FF	proc near		; CODE XREF: sub_40B86E+56p
					; sub_41739C+128p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41B6DC
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41B6FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B74E	proc near		; CODE XREF: sub_41B771+2Fp
					; .text:0041CEC9p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_41ACB2
		leave
		retn
sub_41B74E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B771	proc near		; CODE XREF: sub_40B86E+7Ep
					; sub_41739C+C0p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41B74E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41B771	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B7C0	proc near		; CODE XREF: .text:0041B812p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_41AC58
		leave
		retn
sub_41B7C0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B7C0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B82C	proc near		; CODE XREF: sub_413580+34p
					; sub_413580+51p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_41B8A0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41B879
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4198CB
		mov	[ebp+var_C], eax
		jmp	short loc_41B88B
; ---------------------------------------------------------------------------

loc_41B879:				; CODE XREF: sub_41B82C+3Bj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_419A64
		mov	[ebp+var_C], 0

loc_41B88B:				; CODE XREF: sub_41B82C+4Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_41B8AF
; ---------------------------------------------------------------------------

loc_41B8A0:				; CODE XREF: sub_41B82C+Aj
		mov	[esp+28h+var_28], offset sub_41B82C
		call	sub_418BFF
		mov	[ebp+var_C], eax

loc_41B8AF:				; CODE XREF: sub_41B82C+72j
		cmp	[ebp+var_C], 0
		jz	short loc_41B8BC
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41B8C1
; ---------------------------------------------------------------------------

loc_41B8BC:				; CODE XREF: sub_41B82C+87j
		mov	eax, 0

locret_41B8C1:				; CODE XREF: sub_41B82C+8Ej
		leave
		retn
sub_41B82C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+0Ch]
		mov	edx, eax
		sar	edx, 1Fh
		mov	dword ptr [esp+10h], 0
		mov	ecx, [ebp+10h]
		mov	[esp+0Ch], ecx
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41A22A
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41A22A
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AE18
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AE18
		mov	[ebp-10h], eax
		mov	[ebp-0Ch], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41A22A
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AC58
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BADF	proc near		; CODE XREF: .text:0041BBDFp
					; .text:0041BFBAp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_D]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41A037
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41BB1F
		mov	eax, [ebp+var_14]
		test	eax, eax
		jz	short loc_41BB1F
		movzx	eax, [ebp+var_D]
		movzx	eax, al
		jmp	short locret_41BB24
; ---------------------------------------------------------------------------

loc_41BB1F:				; CODE XREF: sub_41BADF+2Ej
					; sub_41BADF+35j
		mov	eax, 0FFFFFFFFh

locret_41BB24:				; CODE XREF: sub_41BADF+3Ej
		leave
		retn
sub_41BADF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BB26	proc near		; CODE XREF: .text:0041BC7Dp
					; .text:0041CBD0p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_D], al
		lea	eax, [ebp+var_D]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_41A618
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41BB62
		mov	eax, [ebp+arg_0]
		jmp	short locret_41BB67
; ---------------------------------------------------------------------------

loc_41BB62:				; CODE XREF: sub_41BB26+35j
		mov	eax, 0FFFFFFFFh

locret_41BB67:				; CODE XREF: sub_41BB26+3Aj
		leave
		retn
sub_41BB26	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_41BBD9
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_41BBD9
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_41BBD9
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_41BBE4
; ---------------------------------------------------------------------------

loc_41BBD9:				; CODE XREF: .text:0041BB9Ej
					; .text:0041BBAEj ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41BADF

loc_41BBE4:				; CODE XREF: .text:0041BBD7j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41BC70
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41BC70
		cmp	dword ptr [ebp+8], 0Ah
		jz	short loc_41BC70
		mov	eax, [ebp+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		mov	ecx, [ebp+8]
		mov	[eax], cl
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+0Ch]
		mov	[edx+0Ch], ecx
		jmp	short loc_41BC82
; ---------------------------------------------------------------------------

loc_41BC70:				; CODE XREF: .text:0041BC34j
					; .text:0041BC44j ...
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41BB26

loc_41BC82:				; CODE XREF: .text:0041BC6Ej
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-9], al
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		lea	eax, [ebp-9]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_41A19B
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-10h]
		test	eax, eax
		jz	short loc_41BD0C
		mov	eax, [ebp+8]
		jmp	short locret_41BD11
; ---------------------------------------------------------------------------

loc_41BD0C:				; CODE XREF: .text:0041BD05j
		mov	eax, 0FFFFFFFFh

locret_41BD11:				; CODE XREF: .text:0041BD0Aj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BD13	proc near		; CODE XREF: sub_40B86E+29p
					; sub_41A842+2C7p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_41BD7A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41A037
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_41BD81
; ---------------------------------------------------------------------------

loc_41BD7A:				; CODE XREF: sub_41BD13+Aj
		mov	[ebp+var_C], 0

loc_41BD81:				; CODE XREF: sub_41BD13+65j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41BD13	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BD86	proc near		; CODE XREF: sub_41A842+18Cp
					; sub_41A842+1D8p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_41BDED
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41A618
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_41BDF4
; ---------------------------------------------------------------------------

loc_41BDED:				; CODE XREF: sub_41BD86+Aj
		mov	[ebp+var_C], 0

loc_41BDF4:				; CODE XREF: sub_41BD86+65j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41BD86	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BDF9	proc near		; CODE XREF: sub_41739C+A1p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		test	eax, eax
		jz	short loc_41BE77
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax
		call	sub_41A037
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		mov	eax, [ebp+var_14]
		mov	edx, 0
		div	[ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_41BE7E
; ---------------------------------------------------------------------------

loc_41BE77:				; CODE XREF: sub_41BDF9+Fj
		mov	[ebp+var_C], 0

loc_41BE7E:				; CODE XREF: sub_41BDF9+7Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41BDF9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BE83	proc near		; CODE XREF: sub_41757C+1F9p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		test	eax, eax
		jz	short loc_41BF01
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax
		call	sub_41A618
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		mov	eax, [ebp+var_14]
		mov	edx, 0
		div	[ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_41BF08
; ---------------------------------------------------------------------------

loc_41BF01:				; CODE XREF: sub_41BE83+Fj
		mov	[ebp+var_C], 0

loc_41BF08:				; CODE XREF: sub_41BE83+7Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41BE83	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_41BF29
		mov	eax, 0
		jmp	locret_41C019
; ---------------------------------------------------------------------------

loc_41BF29:				; CODE XREF: .text:0041BF1Dj
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		jmp	short loc_41BF67
; ---------------------------------------------------------------------------

loc_41BF55:				; CODE XREF: .text:0041BFCCj
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+0Ch], 1

loc_41BF67:				; CODE XREF: .text:0041BF53j
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_41BFCE
		mov	eax, [ebp+10h]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_41BFB4
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+10h]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_41BFB4
		mov	eax, [ebp+10h]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_41BFB4
		mov	eax, [ebp+10h]
		mov	ecx, [eax]
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+10h]
		mov	[edx+0Ch], ecx
		jmp	short loc_41BFBF
; ---------------------------------------------------------------------------

loc_41BFB4:				; CODE XREF: .text:0041BF79j
					; .text:0041BF89j ...
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_41BADF

loc_41BFBF:				; CODE XREF: .text:0041BFB2j
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_41BFCE
		cmp	dword ptr [ebp-10h], 0Ah
		jnz	short loc_41BF55

loc_41BFCE:				; CODE XREF: .text:0041BF6Bj
					; .text:0041BFC6j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_41BFF6
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_41BFF6
		mov	eax, 0
		jmp	short locret_41C019
; ---------------------------------------------------------------------------

loc_41BFF6:				; CODE XREF: .text:0041BFE5j
					; .text:0041BFEDj
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_41C010
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_41C010
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_41C010:				; CODE XREF: .text:0041BFFAj
					; .text:0041C000j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]

locret_41C019:				; CODE XREF: .text:0041BF24j
					; .text:0041BFF4j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C01B	proc near		; CODE XREF: sub_413580+26p
					; sub_4141ED+646p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		call	pth_mutex_acquire
		mov	[esp+38h+var_2C], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_41A618
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_38], eax
		call	pth_mutex_release
		cmp	[ebp+var_10], 0
		jz	short loc_41C0AB
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41C0B0
; ---------------------------------------------------------------------------

loc_41C0AB:				; CODE XREF: sub_41C01B+87j
		mov	eax, 0

loc_41C0B0:				; CODE XREF: sub_41C01B+8Ej
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_41C01B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		lea	eax, [ebp-14h]
		lea	edx, [ebp-18h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_41A842
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_41C1E0
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_41C1CC
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	edx, [ebp-18h]
		add	edx, 1
		cmp	eax, edx
		jnb	short loc_41C185
		mov	eax, [ebp-18h]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_418A9D
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41C173
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	short loc_41C185
; ---------------------------------------------------------------------------

loc_41C173:				; CODE XREF: .text:0041C168j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, [ebp-10h]
		jz	short loc_41C185
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_41C185:				; CODE XREF: .text:0041C148j
					; .text:0041C171j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41C1BF
		mov	eax, [ebp-18h]
		lea	ecx, [eax+1]
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+0Ch]
		mov	edx, [eax]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jz	short loc_41C1BF
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_41C1BF:				; CODE XREF: .text:0041C189j
					; .text:0041C1B5j
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_418ACA
		jmp	short loc_41C1E1
; ---------------------------------------------------------------------------

loc_41C1CC:				; CODE XREF: .text:0041C135j
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_41C1E1
; ---------------------------------------------------------------------------

loc_41C1E0:				; CODE XREF: .text:0041C128j
		nop

loc_41C1E1:				; CODE XREF: .text:0041C1CAj
					; .text:0041C1DEj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41C1EC
		mov	eax, [ebp-18h]
		jmp	short locret_41C1EF
; ---------------------------------------------------------------------------

loc_41C1EC:				; CODE XREF: .text:0041C1E5j
		mov	eax, [ebp-0Ch]

locret_41C1EF:				; CODE XREF: .text:0041C1EAj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C1F1	proc near		; CODE XREF: sub_414E72+7Bp
					; sub_414E72+2ABp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_41C21B
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		jmp	short loc_41C220
; ---------------------------------------------------------------------------

loc_41C21B:				; CODE XREF: sub_41C1F1+21j
		mov	eax, 0

loc_41C220:				; CODE XREF: sub_41C1F1+28j
		mov	[ebp+var_20], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41C276
		mov	[ebp+var_14], 100h
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax ;	size_t
		call	sub_418A80
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		cmp	[ebp+var_10], 0
		jnz	short loc_41C26E
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_41C264
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_41C264:				; CODE XREF: sub_41C1F1+68j
		mov	eax, 0FFFFFFFFh
		jmp	locret_41C4B5
; ---------------------------------------------------------------------------

loc_41C26E:				; CODE XREF: sub_41C1F1+59j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx

loc_41C276:				; CODE XREF: sub_41C1F1+36j
		cmp	[ebp+var_14], 3
		ja	short loc_41C293
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_41C4B5
; ---------------------------------------------------------------------------

loc_41C293:				; CODE XREF: sub_41C1F1+89j
		sub	[ebp+var_14], 3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], eax
		jmp	loc_41C434
; ---------------------------------------------------------------------------

loc_41C2C5:				; CODE XREF: sub_41C1F1+29Cj
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_14]
		jnz	loc_41C41C
		cmp	[ebp+var_20], 0
		jz	loc_41C36E
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jbe	loc_41C36E

loc_41C2E7:				; CODE XREF: sub_41C1F1+155j
		cmp	[ebp+var_C], 0Ah
		jz	short loc_41C348
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_41C334
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_41C334
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_41C334
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+0Ch], ecx
		jmp	short loc_41C33F
; ---------------------------------------------------------------------------

loc_41C334:				; CODE XREF: sub_41C1F1+108j
					; sub_41C1F1+118j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41BADF

loc_41C33F:				; CODE XREF: sub_41C1F1+141j
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41C2E7

loc_41C348:				; CODE XREF: sub_41C1F1+FAj
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0Ah
		add	[ebp+var_1C], 1
		add	[ebp+var_18], 1
		cmp	[ebp+arg_C], 0
		jz	loc_41C495
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		jmp	loc_41C495
; ---------------------------------------------------------------------------

loc_41C36E:				; CODE XREF: sub_41C1F1+E4j
					; sub_41C1F1+F0j
		add	[ebp+var_14], 3
		cmp	[ebp+var_14], 3FFh
		ja	short loc_41C382
		mov	eax, 100h
		jmp	short loc_41C387
; ---------------------------------------------------------------------------

loc_41C382:				; CODE XREF: sub_41C1F1+188j
		mov	eax, 400h

loc_41C387:				; CODE XREF: sub_41C1F1+18Fj
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax ;	size_t
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_418A9D
		mov	edx, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41C3FD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_418ACA
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	edx, [eax]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_38], eax
		call	pth_mutex_release
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_41C4B5
; ---------------------------------------------------------------------------

loc_41C3FD:				; CODE XREF: sub_41C1F1+1B7j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		sub	[ebp+var_14], 3
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	[ebp+var_1C], eax

loc_41C41C:				; CODE XREF: sub_41C1F1+DAj
		mov	eax, [ebp+var_C]
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[eax], dl
		add	[ebp+var_1C], 1
		add	[ebp+var_18], 1
		cmp	[ebp+var_C], 0Ah
		jz	short loc_41C498

loc_41C434:				; CODE XREF: sub_41C1F1+CFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_41C47B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_41C47B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_41C47B
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+0Ch], ecx
		jmp	short loc_41C486
; ---------------------------------------------------------------------------

loc_41C47B:				; CODE XREF: sub_41C1F1+24Fj
					; sub_41C1F1+25Fj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41BADF

loc_41C486:				; CODE XREF: sub_41C1F1+288j
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	loc_41C2C5
		jmp	short loc_41C499
; ---------------------------------------------------------------------------

loc_41C495:				; CODE XREF: sub_41C1F1+169j
					; sub_41C1F1+178j
		nop
		jmp	short loc_41C499
; ---------------------------------------------------------------------------

loc_41C498:				; CODE XREF: sub_41C1F1+241j
		nop

loc_41C499:				; CODE XREF: sub_41C1F1+2A2j
					; sub_41C1F1+2A5j
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_38], eax
		call	pth_mutex_release
		mov	eax, [ebp+var_18]

locret_41C4B5:				; CODE XREF: sub_41C1F1+78j
					; sub_41C1F1+9Dj ...
		leave
		retn
sub_41C1F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C4B7(void *)
sub_41C4B7	proc near		; CODE XREF: sub_4141ED+678p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	void *
		call	sub_418ACA
		leave
		retn
sub_41C4B7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AC03
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C527	proc near		; CODE XREF: .text:0041CE2Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41AC03
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41C527	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C556	proc near		; CODE XREF: sub_41757C+1C5p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41AC03
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41C556	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C5BB	proc near		; CODE XREF: sub_4141ED+470p
					; sub_4141ED+538p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_41F6A2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_41C5F2
		mov	eax, 0
		jmp	short locret_41C5F5
; ---------------------------------------------------------------------------

loc_41C5F2:				; CODE XREF: sub_41C5BB+2Ej
		mov	eax, [ebp+var_14]

locret_41C5F5:				; CODE XREF: sub_41C5BB+35j
		leave
		retn
sub_41C5BB	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_41F6A2
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_41C626
		mov	eax, 0
		jmp	short locret_41C629
; ---------------------------------------------------------------------------

loc_41C626:				; CODE XREF: .text:0041C61Dj
		mov	eax, [ebp-10h]

locret_41C629:				; CODE XREF: .text:0041C624j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C62B	proc near		; CODE XREF: .text:0041C881p

nBufferLength	= dword	ptr -178h
lpBuffer	= dword	ptr -174h
dwShareMode	= dword	ptr -170h
lpSecurityAttributes= dword ptr	-16Ch
dwCreationDisposition= dword ptr -168h
dwFlagsAndAttributes= dword ptr	-164h
hTemplateFile	= dword	ptr -160h
var_14C		= dword	ptr -14Ch
Buffer		= byte ptr -146h
var_2C		= dword	ptr -2Ch
hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 174h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+lpBuffer], eax ; lpBuffer
		mov	[esp+178h+nBufferLength], 105h ; nBufferLength
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41C69B
		cmp	[ebp+var_20], 104h
		jg	short loc_41C69B
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_41C6B2

loc_41C69B:				; CODE XREF: sub_41C62B+36j
					; sub_41C62B+3Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	loc_41C85A
; ---------------------------------------------------------------------------

loc_41C6B2:				; CODE XREF: sub_41C62B+6Ej
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Buffer]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	edx, offset a_estream ;	"_estream"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		add	[ebp+var_10], 8
		mov	[esp+178h+lpBuffer], 0 ; lpSecurityAttributes
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], eax
		mov	[ebp+var_C], 0
		jmp	loc_41C83E
; ---------------------------------------------------------------------------

loc_41C739:				; CODE XREF: sub_41C62B+217j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp+var_1C]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_41C78A
; ---------------------------------------------------------------------------

loc_41C75A:				; CODE XREF: sub_41C62B+163j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_41C770
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_41C779
; ---------------------------------------------------------------------------

loc_41C770:				; CODE XREF: sub_41C62B+138j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 37h

loc_41C779:				; CODE XREF: sub_41C62B+143j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		shl	[ebp+var_14], 4
		add	[ebp+var_18], 1

loc_41C78A:				; CODE XREF: sub_41C62B+12Dj
		cmp	[ebp+var_18], 7
		jle	short loc_41C75A
		mov	edx, offset a_tmp ; ".tmp"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	[esp+178h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+178h+dwFlagsAndAttributes], 4000100h ; dwFlagsAndAttributes
		mov	[esp+178h+dwCreationDisposition], 1 ; dwCreationDisposition
		mov	[esp+178h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+178h+dwShareMode],	0 ; dwShareMode
		mov	[esp+178h+lpBuffer], 0C0000000h	; dwDesiredAccess
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_41C829
		mov	eax, [ebp+hObject]
		mov	[esp+178h+lpBuffer], 0
		mov	[esp+178h+nBufferLength], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0FFFFFFFFh
		jnz	short loc_41C824
		mov	eax, [ebp+hObject]
		mov	[esp+178h+nBufferLength], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41C85A
; ---------------------------------------------------------------------------

loc_41C824:				; CODE XREF: sub_41C62B+1E0j
		mov	eax, [ebp+var_2C]
		jmp	short loc_41C85A
; ---------------------------------------------------------------------------

loc_41C829:				; CODE XREF: sub_41C62B+1C2j
		mov	[esp+178h+nBufferLength], 1 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	[ebp+var_C], 1

loc_41C83E:				; CODE XREF: sub_41C62B+109j
		cmp	[ebp+var_C], 9
		jle	loc_41C739
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh

loc_41C85A:				; CODE XREF: sub_41C62B+82j
					; sub_41C62B+1F7j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_41C62B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-14h], 302h
		mov	dword ptr [ebp-20h], 0
		call	sub_41C62B
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_41C898
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		jmp	short loc_41C917
; ---------------------------------------------------------------------------

loc_41C898:				; CODE XREF: .text:0041C88Dj
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_419266
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41C916
		mov	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-20h]
		mov	edx, [ebp-14h]
		mov	[esp+1Ch], edx
		mov	edx, off_42B4D0
		mov	[esp+0Ch], edx
		mov	edx, off_42B4D4
		mov	[esp+10h], edx
		mov	edx, off_42B4D8
		mov	[esp+14h], edx
		mov	edx, off_42B4DC
		mov	[esp+18h], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_419CF7
		mov	[ebp-10h], eax
		jmp	short loc_41C917
; ---------------------------------------------------------------------------

loc_41C916:				; CODE XREF: .text:0041C8C0j
		nop

loc_41C917:				; CODE XREF: .text:0041C896j
					; .text:0041C914j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_41C948
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41C930
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_4193C6
		jmp	short loc_41C941
; ---------------------------------------------------------------------------

loc_41C930:				; CODE XREF: .text:0041C921j
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jz	short loc_41C941
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	_close

loc_41C941:				; CODE XREF: .text:0041C92Ej
					; .text:0041C934j
		mov	dword ptr [ebp-1Ch], 0

loc_41C948:				; CODE XREF: .text:0041C91Bj
		mov	eax, [ebp-1Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_41C965
		cmp	dword ptr [ebp+10h], 40h
		jz	short loc_41C965
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_41C9CC

loc_41C965:				; CODE XREF: .text:0041C957j
					; .text:0041C95Dj
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_41C971
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_41C9CC

loc_41C971:				; CODE XREF: .text:0041C969j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AD00
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		jmp	short loc_41C9E0
; ---------------------------------------------------------------------------

loc_41C9CC:				; CODE XREF: .text:0041C963j
					; .text:0041C96Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh

loc_41C9E0:				; CODE XREF: .text:0041C9CAj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_41CA1B
		mov	eax, 0
		jmp	short loc_41CA20
; ---------------------------------------------------------------------------

loc_41CA1B:				; CODE XREF: .text:0041CA12j
		mov	eax, 4

loc_41CA20:				; CODE XREF: .text:0041CA19j
		mov	dword ptr [esp+0Ch], 200h
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AD00
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AE8D
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		lea	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AE8D
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		jmp	loc_41CEAB
; ---------------------------------------------------------------------------

loc_41CB41:				; CODE XREF: .text:0041CEAFj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_41CB89
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_41CB89
		cmp	dword ptr [ebp+14h], 0
		jz	loc_41CE3A
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jnz	short loc_41CB89
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_41CE3A

loc_41CB89:				; CODE XREF: .text:0041CB49j
					; .text:0041CB53j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41CBC2
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41CBC2
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	5Ch
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41CBD5
; ---------------------------------------------------------------------------

loc_41CBC2:				; CODE XREF: .text:0041CB95j
					; .text:0041CBA5j
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 5Ch
		call	sub_41BB26

loc_41CBD5:				; CODE XREF: .text:0041CBC0j
		add	dword ptr [ebp-10h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41CC38
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41CC1C
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41CC1C
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	6Eh
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41CC2F
; ---------------------------------------------------------------------------

loc_41CC1C:				; CODE XREF: .text:0041CBEFj
					; .text:0041CBFFj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 6Eh
		call	sub_41BB26

loc_41CC2F:				; CODE XREF: .text:0041CC1Aj
		add	dword ptr [ebp-10h], 1
		jmp	loc_41CE9F
; ---------------------------------------------------------------------------

loc_41CC38:				; CODE XREF: .text:0041CBE1j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_41CC97
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41CC7B
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41CC7B
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	72h
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41CC8E
; ---------------------------------------------------------------------------

loc_41CC7B:				; CODE XREF: .text:0041CC4Ej
					; .text:0041CC5Ej
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 72h
		call	sub_41BB26

loc_41CC8E:				; CODE XREF: .text:0041CC79j
		add	dword ptr [ebp-10h], 1
		jmp	loc_41CE9F
; ---------------------------------------------------------------------------

loc_41CC97:				; CODE XREF: .text:0041CC40j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_41CCF6
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41CCDA
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41CCDA
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	66h
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41CCED
; ---------------------------------------------------------------------------

loc_41CCDA:				; CODE XREF: .text:0041CCADj
					; .text:0041CCBDj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 66h
		call	sub_41BB26

loc_41CCED:				; CODE XREF: .text:0041CCD8j
		add	dword ptr [ebp-10h], 1
		jmp	loc_41CE9F
; ---------------------------------------------------------------------------

loc_41CCF6:				; CODE XREF: .text:0041CC9Fj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_41CD55
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41CD39
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41CD39
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	76h
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41CD4C
; ---------------------------------------------------------------------------

loc_41CD39:				; CODE XREF: .text:0041CD0Cj
					; .text:0041CD1Cj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 76h
		call	sub_41BB26

loc_41CD4C:				; CODE XREF: .text:0041CD37j
		add	dword ptr [ebp-10h], 1
		jmp	loc_41CE9F
; ---------------------------------------------------------------------------

loc_41CD55:				; CODE XREF: .text:0041CCFEj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_41CDB4
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41CD98
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41CD98
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	62h
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41CDAB
; ---------------------------------------------------------------------------

loc_41CD98:				; CODE XREF: .text:0041CD6Bj
					; .text:0041CD7Bj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 62h
		call	sub_41BB26

loc_41CDAB:				; CODE XREF: .text:0041CD96j
		add	dword ptr [ebp-10h], 1
		jmp	loc_41CE9F
; ---------------------------------------------------------------------------

loc_41CDB4:				; CODE XREF: .text:0041CD5Dj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41CE13
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41CDF7
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41CDF7
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	30h
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41CE0A
; ---------------------------------------------------------------------------

loc_41CDF7:				; CODE XREF: .text:0041CDCAj
					; .text:0041CDDAj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 30h
		call	sub_41BB26

loc_41CE0A:				; CODE XREF: .text:0041CDF5j
		add	dword ptr [ebp-10h], 1
		jmp	loc_41CE9F
; ---------------------------------------------------------------------------

loc_41CE13:				; CODE XREF: .text:0041CDBCj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41C527
		add	dword ptr [ebp-10h], 3
		jmp	short loc_41CE9F
; ---------------------------------------------------------------------------

loc_41CE3A:				; CODE XREF: .text:0041CB59j
					; .text:0041CB83j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41CE83
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41CE83
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_41CE83
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41CE9B
; ---------------------------------------------------------------------------

loc_41CE83:				; CODE XREF: .text:0041CE46j
					; .text:0041CE56j ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_41BB26

loc_41CE9B:				; CODE XREF: .text:0041CE81j
		add	dword ptr [ebp-10h], 1

loc_41CE9F:				; CODE XREF: .text:0041CC33j
					; .text:0041CC92j ...
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1

loc_41CEAB:				; CODE XREF: .text:0041CB3Cj
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_41CB41
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_41CEC3
		mov	eax, [ebp+18h]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_41CEC3:				; CODE XREF: .text:0041CEB9j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B74E
		test	eax, eax
		jz	short loc_41CED9
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41CEDE
; ---------------------------------------------------------------------------

loc_41CED9:				; CODE XREF: .text:0041CED0j
		mov	eax, 0

loc_41CEDE:				; CODE XREF: .text:0041CED7j
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-14h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_41CF16
		mov	eax, 0
		jmp	locret_41D0F0
; ---------------------------------------------------------------------------

loc_41CF16:				; CODE XREF: .text:0041CF0Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_41D0A4
; ---------------------------------------------------------------------------

loc_41CF44:				; CODE XREF: .text:0041D0A8j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41CFAB
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41CFAB
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_41CF92
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 30h
		jmp	short loc_41CF9E
; ---------------------------------------------------------------------------

loc_41CF92:				; CODE XREF: .text:0041CF82j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 37h

loc_41CF9E:				; CODE XREF: .text:0041CF90j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41CFF4
; ---------------------------------------------------------------------------

loc_41CFAB:				; CODE XREF: .text:0041CF50j
					; .text:0041CF60j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_41CFD3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_41CFE5
; ---------------------------------------------------------------------------

loc_41CFD3:				; CODE XREF: .text:0041CFBDj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_41CFE5:				; CODE XREF: .text:0041CFD1j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_41BB26

loc_41CFF4:				; CODE XREF: .text:0041CFA9j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41D058
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41D058
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_41D03F
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 30h
		jmp	short loc_41D04B
; ---------------------------------------------------------------------------

loc_41D03F:				; CODE XREF: .text:0041D02Fj
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 37h

loc_41D04B:				; CODE XREF: .text:0041D03Dj
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_41D098
; ---------------------------------------------------------------------------

loc_41D058:				; CODE XREF: .text:0041D000j
					; .text:0041D010j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_41D07A
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_41D089
; ---------------------------------------------------------------------------

loc_41D07A:				; CODE XREF: .text:0041D067j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_41D089:				; CODE XREF: .text:0041D078j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_41BB26

loc_41D098:				; CODE XREF: .text:0041D056j
		add	dword ptr [ebp-10h], 2
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_41D0A4:				; CODE XREF: .text:0041CF3Fj
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_41CF44
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_41D0BC
		mov	eax, [ebp+18h]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_41D0BC:				; CODE XREF: .text:0041D0B2j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B74E
		test	eax, eax
		jz	short loc_41D0D2
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41D0D7
; ---------------------------------------------------------------------------

loc_41D0D2:				; CODE XREF: .text:0041D0C9j
		mov	eax, 0

loc_41D0D7:				; CODE XREF: .text:0041D0D0j
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		mov	eax, [ebp-14h]

locret_41D0F0:				; CODE XREF: .text:0041CF11j
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D0F4	proc near		; CODE XREF: sub_41D2F5+6E9p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_41D2F3	; jumptable 0041D10D default case
		mov	eax, ds:off_43208C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41D10F:				; CODE XREF: sub_41D0F4+19j
					; DATA XREF: .rdata:off_43208Co
		mov	eax, [ebp+arg_0] ; jumptable 0041D10D case 0
		mov	dword ptr [eax+24h], 0
		jmp	loc_41D2F3	; jumptable 0041D10D default case
; ---------------------------------------------------------------------------

loc_41D11E:				; CODE XREF: sub_41D0F4+19j
					; DATA XREF: .rdata:off_43208Co
		mov	eax, [ebp+arg_0] ; jumptable 0041D10D case 1
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_41D186 ; jumptable 0041D130 default case
		mov	eax, ds:off_4320D8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41D132:				; CODE XREF: sub_41D0F4+3Cj
					; DATA XREF: .rdata:off_4320D8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D130 case 1
		mov	dword ptr [eax+24h], 2
		jmp	short loc_41D191
; ---------------------------------------------------------------------------

loc_41D13E:				; CODE XREF: sub_41D0F4+3Cj
					; DATA XREF: .rdata:off_4320D8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D130 case 2
		mov	dword ptr [eax+24h], 4
		jmp	short loc_41D191
; ---------------------------------------------------------------------------

loc_41D14A:				; CODE XREF: sub_41D0F4+3Cj
					; DATA XREF: .rdata:off_4320D8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D130 case 3
		mov	dword ptr [eax+24h], 8
		jmp	short loc_41D191
; ---------------------------------------------------------------------------

loc_41D156:				; CODE XREF: sub_41D0F4+3Cj
					; DATA XREF: .rdata:off_4320D8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D130 case 4
		mov	dword ptr [eax+24h], 0Ah
		jmp	short loc_41D191
; ---------------------------------------------------------------------------

loc_41D162:				; CODE XREF: sub_41D0F4+3Cj
					; DATA XREF: .rdata:off_4320D8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D130 case 5
		mov	dword ptr [eax+24h], 0Fh
		jmp	short loc_41D191
; ---------------------------------------------------------------------------

loc_41D16E:				; CODE XREF: sub_41D0F4+3Cj
					; DATA XREF: .rdata:off_4320D8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D130 case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_41D191
; ---------------------------------------------------------------------------

loc_41D17A:				; CODE XREF: sub_41D0F4+3Cj
					; DATA XREF: .rdata:off_4320D8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D130 case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_41D191
; ---------------------------------------------------------------------------

loc_41D186:				; CODE XREF: sub_41D0F4+33j
					; sub_41D0F4+3Cj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 0041D130 default case
		mov	dword ptr [eax+24h], 6
		nop

loc_41D191:				; CODE XREF: sub_41D0F4+48j
					; sub_41D0F4+54j ...
		jmp	loc_41D2F3	; jumptable 0041D10D default case
; ---------------------------------------------------------------------------

loc_41D196:				; CODE XREF: sub_41D0F4+19j
					; DATA XREF: .rdata:off_43208Co
		mov	eax, [ebp+arg_0] ; jumptable 0041D10D cases 2-5
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_41D1FE ; jumptable 0041D1A8 default case
		mov	eax, ds:off_4320F8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41D1AA:				; CODE XREF: sub_41D0F4+B4j
					; DATA XREF: .rdata:off_4320F8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D1A8 case 1
		mov	dword ptr [eax+24h], 3
		jmp	short loc_41D209
; ---------------------------------------------------------------------------

loc_41D1B6:				; CODE XREF: sub_41D0F4+B4j
					; DATA XREF: .rdata:off_4320F8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D1A8 case 2
		mov	dword ptr [eax+24h], 5
		jmp	short loc_41D209
; ---------------------------------------------------------------------------

loc_41D1C2:				; CODE XREF: sub_41D0F4+B4j
					; DATA XREF: .rdata:off_4320F8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D1A8 case 3
		mov	dword ptr [eax+24h], 9
		jmp	short loc_41D209
; ---------------------------------------------------------------------------

loc_41D1CE:				; CODE XREF: sub_41D0F4+B4j
					; DATA XREF: .rdata:off_4320F8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D1A8 case 4
		mov	dword ptr [eax+24h], 0Bh
		jmp	short loc_41D209
; ---------------------------------------------------------------------------

loc_41D1DA:				; CODE XREF: sub_41D0F4+B4j
					; DATA XREF: .rdata:off_4320F8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D1A8 case 5
		mov	dword ptr [eax+24h], 10h
		jmp	short loc_41D209
; ---------------------------------------------------------------------------

loc_41D1E6:				; CODE XREF: sub_41D0F4+B4j
					; DATA XREF: .rdata:off_4320F8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D1A8 case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_41D209
; ---------------------------------------------------------------------------

loc_41D1F2:				; CODE XREF: sub_41D0F4+B4j
					; DATA XREF: .rdata:off_4320F8o
		mov	eax, [ebp+arg_0] ; jumptable 0041D1A8 case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_41D209
; ---------------------------------------------------------------------------

loc_41D1FE:				; CODE XREF: sub_41D0F4+ABj
					; sub_41D0F4+B4j
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 0041D1A8 default case
		mov	dword ptr [eax+24h], 7
		nop

loc_41D209:				; CODE XREF: sub_41D0F4+C0j
					; sub_41D0F4+CCj ...
		jmp	loc_41D2F3	; jumptable 0041D10D default case
; ---------------------------------------------------------------------------

loc_41D20E:				; CODE XREF: sub_41D0F4+19j
					; DATA XREF: .rdata:off_43208Co
		mov	eax, [ebp+arg_0] ; jumptable 0041D10D cases 6-13
		mov	eax, [eax+10h]
		cmp	eax, 3
		jz	short loc_41D22A
		cmp	eax, 8
		jnz	short loc_41D236
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Dh
		jmp	short loc_41D241
; ---------------------------------------------------------------------------

loc_41D22A:				; CODE XREF: sub_41D0F4+123j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		jmp	short loc_41D241
; ---------------------------------------------------------------------------

loc_41D236:				; CODE XREF: sub_41D0F4+128j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		nop

loc_41D241:				; CODE XREF: sub_41D0F4+134j
					; sub_41D0F4+140j
		jmp	loc_41D2F3	; jumptable 0041D10D default case
; ---------------------------------------------------------------------------

loc_41D246:				; CODE XREF: sub_41D0F4+19j
					; DATA XREF: .rdata:off_43208Co
		mov	eax, [ebp+arg_0] ; jumptable 0041D10D case 14
		mov	dword ptr [eax+24h], 6
		jmp	loc_41D2F3	; jumptable 0041D10D default case
; ---------------------------------------------------------------------------

loc_41D255:				; CODE XREF: sub_41D0F4+19j
					; DATA XREF: .rdata:off_43208Co
		mov	eax, [ebp+arg_0] ; jumptable 0041D10D case 15
		mov	dword ptr [eax+24h], 0Eh
		jmp	loc_41D2F3	; jumptable 0041D10D default case
; ---------------------------------------------------------------------------

loc_41D264:				; CODE XREF: sub_41D0F4+19j
					; DATA XREF: .rdata:off_43208Co
		mov	eax, [ebp+arg_0] ; jumptable 0041D10D case 16
		mov	dword ptr [eax+24h], 13h
		jmp	loc_41D2F3	; jumptable 0041D10D default case
; ---------------------------------------------------------------------------

loc_41D273:				; CODE XREF: sub_41D0F4+19j
					; DATA XREF: .rdata:off_43208Co
		mov	eax, [ebp+arg_0] ; jumptable 0041D10D case 17
		mov	dword ptr [eax+24h], 0Eh
		jmp	short loc_41D2F3 ; jumptable 0041D10D default case
; ---------------------------------------------------------------------------

loc_41D27F:				; CODE XREF: sub_41D0F4+19j
					; DATA XREF: .rdata:off_43208Co
		mov	eax, [ebp+arg_0] ; jumptable 0041D10D case 18
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_41D2E7 ; jumptable 0041D291 default case
		mov	eax, ds:off_432118[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41D293:				; CODE XREF: sub_41D0F4+19Dj
					; DATA XREF: .rdata:off_432118o
		mov	eax, [ebp+arg_0] ; jumptable 0041D291 case 1
		mov	dword ptr [eax+24h], 15h
		jmp	short loc_41D2F2
; ---------------------------------------------------------------------------

loc_41D29F:				; CODE XREF: sub_41D0F4+19Dj
					; DATA XREF: .rdata:off_432118o
		mov	eax, [ebp+arg_0] ; jumptable 0041D291 case 2
		mov	dword ptr [eax+24h], 16h
		jmp	short loc_41D2F2
; ---------------------------------------------------------------------------

loc_41D2AB:				; CODE XREF: sub_41D0F4+19Dj
					; DATA XREF: .rdata:off_432118o
		mov	eax, [ebp+arg_0] ; jumptable 0041D291 case 3
		mov	dword ptr [eax+24h], 18h
		jmp	short loc_41D2F2
; ---------------------------------------------------------------------------

loc_41D2B7:				; CODE XREF: sub_41D0F4+19Dj
					; DATA XREF: .rdata:off_432118o
		mov	eax, [ebp+arg_0] ; jumptable 0041D291 case 4
		mov	dword ptr [eax+24h], 19h
		jmp	short loc_41D2F2
; ---------------------------------------------------------------------------

loc_41D2C3:				; CODE XREF: sub_41D0F4+19Dj
					; DATA XREF: .rdata:off_432118o
		mov	eax, [ebp+arg_0] ; jumptable 0041D291 case 5
		mov	dword ptr [eax+24h], 1Ah
		jmp	short loc_41D2F2
; ---------------------------------------------------------------------------

loc_41D2CF:				; CODE XREF: sub_41D0F4+19Dj
					; DATA XREF: .rdata:off_432118o
		mov	eax, [ebp+arg_0] ; jumptable 0041D291 case 6
		mov	dword ptr [eax+24h], 1Bh
		jmp	short loc_41D2F2
; ---------------------------------------------------------------------------

loc_41D2DB:				; CODE XREF: sub_41D0F4+19Dj
					; DATA XREF: .rdata:off_432118o
		mov	eax, [ebp+arg_0] ; jumptable 0041D291 case 7
		mov	dword ptr [eax+24h], 1Ch
		jmp	short loc_41D2F2
; ---------------------------------------------------------------------------

loc_41D2E7:				; CODE XREF: sub_41D0F4+194j
					; sub_41D0F4+19Dj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 0041D291 default case
		mov	dword ptr [eax+24h], 17h
		nop

loc_41D2F2:				; CODE XREF: sub_41D0F4+1A9j
					; sub_41D0F4+1B5j ...
		nop

loc_41D2F3:				; CODE XREF: sub_41D0F4+Cj
					; sub_41D0F4+25j ...
		pop	ebp		; jumptable 0041D10D default case
		retn
sub_41D0F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D2F5	proc near		; CODE XREF: sub_41ED7C+58p

NumOfElements	= dword	ptr -68h
SizeOfElements	= dword	ptr -64h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Memory		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+Memory], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_0], 0
		jnz	loc_41D9F9
		jmp	loc_41DA38
; ---------------------------------------------------------------------------

loc_41D319:				; CODE XREF: sub_41D2F5+70Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_41D9EF
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_41DA1F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	loc_41D9F2
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_41D3E5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41D3E5
		mov	eax, [ebp+var_C]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1
		jmp	short loc_41D3AA
; ---------------------------------------------------------------------------

loc_41D387:				; CODE XREF: sub_41D2F5+C7j
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1

loc_41D3AA:				; CODE XREF: sub_41D2F5+90j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D3BE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D387

loc_41D3BE:				; CODE XREF: sub_41D2F5+BDj
		cmp	[ebp+var_2C], 0
		js	loc_41DA22
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	short loc_41D3D8
		add	[ebp+var_C], 1
		jmp	short loc_41D3E5
; ---------------------------------------------------------------------------

loc_41D3D8:				; CODE XREF: sub_41D2F5+DBj
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_C], eax

loc_41D3E5:				; CODE XREF: sub_41D2F5+67j
					; sub_41D2F5+75j ...
		mov	[ebp+var_18], 0
		jmp	short loc_41D42F
; ---------------------------------------------------------------------------

loc_41D3EE:				; CODE XREF: sub_41D2F5+142j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 20h	; switch 17 cases
		cmp	eax, 10h
		ja	short loc_41D43B ; jumptable 0041D406 default case
		mov	eax, ds:off_432138[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41D408:				; CODE XREF: sub_41D2F5+111j
					; DATA XREF: .rdata:off_432138o
		or	[ebp+var_18], 1	; jumptable 0041D406 case 39
		jmp	short loc_41D42B
; ---------------------------------------------------------------------------

loc_41D40E:				; CODE XREF: sub_41D2F5+111j
					; DATA XREF: .rdata:off_432138o
		or	[ebp+var_18], 2	; jumptable 0041D406 case 45
		jmp	short loc_41D42B
; ---------------------------------------------------------------------------

loc_41D414:				; CODE XREF: sub_41D2F5+111j
					; DATA XREF: .rdata:off_432138o
		or	[ebp+var_18], 4	; jumptable 0041D406 case 43
		jmp	short loc_41D42B
; ---------------------------------------------------------------------------

loc_41D41A:				; CODE XREF: sub_41D2F5+111j
					; DATA XREF: .rdata:off_432138o
		or	[ebp+var_18], 8	; jumptable 0041D406 case 32
		jmp	short loc_41D42B
; ---------------------------------------------------------------------------

loc_41D420:				; CODE XREF: sub_41D2F5+111j
					; DATA XREF: .rdata:off_432138o
		or	[ebp+var_18], 10h ; jumptable 0041D406 case 35
		jmp	short loc_41D42B
; ---------------------------------------------------------------------------

loc_41D426:				; CODE XREF: sub_41D2F5+111j
					; DATA XREF: .rdata:off_432138o
		or	[ebp+var_18], 20h ; jumptable 0041D406 case 48
		nop

loc_41D42B:				; CODE XREF: sub_41D2F5+117j
					; sub_41D2F5+11Dj ...
		add	[ebp+var_C], 1

loc_41D42F:				; CODE XREF: sub_41D2F5+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D3EE
		jmp	short loc_41D43C
; ---------------------------------------------------------------------------

loc_41D43B:				; CODE XREF: sub_41D2F5+108j
					; sub_41D2F5+111j
					; DATA XREF: ...
		nop			; jumptable 0041D406 default case

loc_41D43C:				; CODE XREF: sub_41D2F5+144j
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_41D4EF
		mov	[ebp+var_1C], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_41D575
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_41D575
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_41D575
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1
		jmp	short loc_41D4BA
; ---------------------------------------------------------------------------

loc_41D497:				; CODE XREF: sub_41D2F5+1D7j
		mov	edx, [ebp+var_30]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1

loc_41D4BA:				; CODE XREF: sub_41D2F5+1A0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D4CE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D497

loc_41D4CE:				; CODE XREF: sub_41D2F5+1CDj
		cmp	[ebp+var_30], 0
		jle	loc_41DA25
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_41DA28
		add	[ebp+var_C], 1
		jmp	loc_41D575
; ---------------------------------------------------------------------------

loc_41D4EF:				; CODE XREF: sub_41D2F5+156j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D56E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41D56E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1
		jmp	short loc_41D54F
; ---------------------------------------------------------------------------

loc_41D518:				; CODE XREF: sub_41D2F5+26Cj
		cmp	[ebp+var_1C], 0
		jnz	short loc_41D52C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_41DA2B

loc_41D52C:				; CODE XREF: sub_41D2F5+227j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1

loc_41D54F:				; CODE XREF: sub_41D2F5+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D563
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D518

loc_41D563:				; CODE XREF: sub_41D2F5+262j
		cmp	[ebp+var_1C], 0
		jns	short loc_41D575
		jmp	loc_41DA38
; ---------------------------------------------------------------------------

loc_41D56E:				; CODE XREF: sub_41D2F5+202j
					; sub_41D2F5+20Cj
		mov	[ebp+var_1C], 0FFFFFFFFh

loc_41D575:				; CODE XREF: sub_41D2F5+16Bj
					; sub_41D2F5+179j ...
		mov	[ebp+var_34], 0
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	loc_41D6E8
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		setz	al
		movzx	eax, al
		mov	[ebp+var_40], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_41D655
		mov	[ebp+var_20], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_41D6DB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_41D6DB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_41D6DB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1
		jmp	short loc_41D620
; ---------------------------------------------------------------------------

loc_41D5FD:				; CODE XREF: sub_41D2F5+33Dj
		mov	edx, [ebp+var_34]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1

loc_41D620:				; CODE XREF: sub_41D2F5+306j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D634
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D5FD

loc_41D634:				; CODE XREF: sub_41D2F5+333j
		cmp	[ebp+var_34], 0
		jle	loc_41DA2E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_41DA31
		add	[ebp+var_C], 1
		jmp	loc_41D6DB
; ---------------------------------------------------------------------------

loc_41D655:				; CODE XREF: sub_41D2F5+2BCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D6D4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41D6D4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1
		jmp	short loc_41D6B5
; ---------------------------------------------------------------------------

loc_41D67E:				; CODE XREF: sub_41D2F5+3D2j
		cmp	[ebp+var_20], 0
		jnz	short loc_41D692
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_41DA34

loc_41D692:				; CODE XREF: sub_41D2F5+38Dj
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1

loc_41D6B5:				; CODE XREF: sub_41D2F5+387j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D6C9
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D67E

loc_41D6C9:				; CODE XREF: sub_41D2F5+3C8j
		cmp	[ebp+var_20], 0
		jns	short loc_41D6DB
		jmp	loc_41DA38
; ---------------------------------------------------------------------------

loc_41D6D4:				; CODE XREF: sub_41D2F5+368j
					; sub_41D2F5+372j
		mov	[ebp+var_20], 0

loc_41D6DB:				; CODE XREF: sub_41D2F5+2D1j
					; sub_41D2F5+2DFj ...
		cmp	[ebp+var_40], 0
		jz	short loc_41D6E8
		mov	[ebp+var_20], 0FFFFFFFFh

loc_41D6E8:				; CODE XREF: sub_41D2F5+296j
					; sub_41D2F5+3EAj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 4Ch	; switch 47 cases
		cmp	eax, 2Eh
		ja	loc_41D788	; jumptable 0041D704 default case
		mov	eax, ds:off_43217C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41D706:				; CODE XREF: sub_41D2F5+40Fj
					; DATA XREF: .rdata:off_43217Co
		mov	eax, [ebp+var_C] ; jumptable 0041D704 case 104
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jnz	short loc_41D720
		mov	[ebp+var_24], 1
		add	[ebp+var_C], 1
		jmp	short loc_41D727
; ---------------------------------------------------------------------------

loc_41D720:				; CODE XREF: sub_41D2F5+41Cj
		mov	[ebp+var_24], 2

loc_41D727:				; CODE XREF: sub_41D2F5+429j
		add	[ebp+var_C], 1
		jmp	short loc_41D790
; ---------------------------------------------------------------------------

loc_41D72D:				; CODE XREF: sub_41D2F5+40Fj
					; DATA XREF: .rdata:off_43217Co
		mov	eax, [ebp+var_C] ; jumptable 0041D704 case 108
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 6Ch
		jnz	short loc_41D747
		mov	[ebp+var_24], 4
		add	[ebp+var_C], 1
		jmp	short loc_41D74E
; ---------------------------------------------------------------------------

loc_41D747:				; CODE XREF: sub_41D2F5+443j
		mov	[ebp+var_24], 3

loc_41D74E:				; CODE XREF: sub_41D2F5+450j
		add	[ebp+var_C], 1
		jmp	short loc_41D790
; ---------------------------------------------------------------------------

loc_41D754:				; CODE XREF: sub_41D2F5+40Fj
					; DATA XREF: .rdata:off_43217Co
		mov	[ebp+var_24], 5	; jumptable 0041D704 case 106
		add	[ebp+var_C], 1
		jmp	short loc_41D790
; ---------------------------------------------------------------------------

loc_41D761:				; CODE XREF: sub_41D2F5+40Fj
					; DATA XREF: .rdata:off_43217Co
		mov	[ebp+var_24], 6	; jumptable 0041D704 case 122
		add	[ebp+var_C], 1
		jmp	short loc_41D790
; ---------------------------------------------------------------------------

loc_41D76E:				; CODE XREF: sub_41D2F5+40Fj
					; DATA XREF: .rdata:off_43217Co
		mov	[ebp+var_24], 7	; jumptable 0041D704 case 116
		add	[ebp+var_C], 1
		jmp	short loc_41D790
; ---------------------------------------------------------------------------

loc_41D77B:				; CODE XREF: sub_41D2F5+40Fj
					; DATA XREF: .rdata:off_43217Co
		mov	[ebp+var_24], 8	; jumptable 0041D704 case 76
		add	[ebp+var_C], 1
		jmp	short loc_41D790
; ---------------------------------------------------------------------------

loc_41D788:				; CODE XREF: sub_41D2F5+402j
					; sub_41D2F5+40Fj
					; DATA XREF: ...
		mov	[ebp+var_24], 0	; jumptable 0041D704 default case
		nop

loc_41D790:				; CODE XREF: sub_41D2F5+436j
					; sub_41D2F5+45Dj ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 41h	; switch 56 cases
		cmp	eax, 37h
		ja	loc_41D88F	; jumptable 0041D7AC default case
		mov	eax, ds:off_432238[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41D7AE:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 1	; jumptable 0041D7AC cases 100,105
		jmp	loc_41D896
; ---------------------------------------------------------------------------

loc_41D7BA:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 2	; jumptable 0041D7AC case 111
		jmp	loc_41D896
; ---------------------------------------------------------------------------

loc_41D7C6:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 3	; jumptable 0041D7AC case 117
		jmp	loc_41D896
; ---------------------------------------------------------------------------

loc_41D7D2:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 4	; jumptable 0041D7AC case 120
		jmp	loc_41D896
; ---------------------------------------------------------------------------

loc_41D7DE:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 5	; jumptable 0041D7AC case 88
		jmp	loc_41D896
; ---------------------------------------------------------------------------

loc_41D7EA:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 6	; jumptable 0041D7AC case 102
		jmp	loc_41D896
; ---------------------------------------------------------------------------

loc_41D7F6:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 7	; jumptable 0041D7AC case 70
		jmp	loc_41D896
; ---------------------------------------------------------------------------

loc_41D802:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 8	; jumptable 0041D7AC case 101
		jmp	loc_41D896
; ---------------------------------------------------------------------------

loc_41D80E:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 9	; jumptable 0041D7AC case 69
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D817:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 0Ah ; jumptable 0041D7AC case 103
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D820:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 0Bh ; jumptable 0041D7AC case 71
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D829:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 0Ch ; jumptable 0041D7AC case 97
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D832:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 0Dh ; jumptable 0041D7AC case 65
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D83B:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 0Eh ; jumptable 0041D7AC case 99
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D844:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 0Fh ; jumptable 0041D7AC case 115
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D84D:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 10h ; jumptable 0041D7AC case 112
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D856:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 12h ; jumptable 0041D7AC case 110
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D85F:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 0Eh ; jumptable 0041D7AC case 67
		mov	[ebp+var_24], 3
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D86F:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 0Fh ; jumptable 0041D7AC case 83
		mov	[ebp+var_24], 3
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D87F:				; CODE XREF: sub_41D2F5+4B7j
					; DATA XREF: .rdata:off_432238o
		mov	[ebp+var_28], 11h ; jumptable 0041D7AC case 109
		mov	[ebp+var_2C], 0FFFFFFFFh
		jmp	short loc_41D896
; ---------------------------------------------------------------------------

loc_41D88F:				; CODE XREF: sub_41D2F5+4AAj
					; sub_41D2F5+4B7j
					; DATA XREF: ...
		mov	[ebp+var_28], 0	; jumptable 0041D7AC default case

loc_41D896:				; CODE XREF: sub_41D2F5+4C0j
					; sub_41D2F5+4CCj ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jb	loc_41D967
		mov	eax, [ebp+arg_8]
		add	eax, 0Ah
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		cmp	eax, [ebp+arg_8]
		jbe	loc_41DA37
		mov	[esp+68h+SizeOfElements], 28h ;	SizeOfElements
		mov	eax, [ebp+var_44]
		mov	[esp+68h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jz	loc_41DA47
		mov	[ebp+var_38], 0
		jmp	short loc_41D93E
; ---------------------------------------------------------------------------

loc_41D8E0:				; CODE XREF: sub_41D2F5+64Fj
		mov	edx, [ebp+var_38]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+var_48]
		mov	ecx, [ebp+var_38]
		mov	edx, ecx
		shl	edx, 2
		add	edx, ecx
		shl	edx, 3
		add	edx, [ebp+Memory]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	edx, [edx+24h]
		mov	[eax+24h], edx
		add	[ebp+var_38], 1

loc_41D93E:				; CODE XREF: sub_41D2F5+5E9j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_14]
		jb	short loc_41D8E0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_41D95B
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_41D95B:				; CODE XREF: sub_41D2F5+659j
		mov	eax, [ebp+var_48]
		mov	[ebp+Memory], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+arg_8], eax

loc_41D967:				; CODE XREF: sub_41D2F5+5A7j
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	[ebp+var_4C], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_4C]
		mov	[eax], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_1C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_24]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_2C]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_30]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_34]
		mov	[eax+20h], edx
		mov	eax, [ebp+var_4C]
		mov	[esp+68h+NumOfElements], eax
		call	sub_41D0F4
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax
		jmp	short loc_41D9F3
; ---------------------------------------------------------------------------

loc_41D9EF:				; CODE XREF: sub_41D2F5+2Cj
		nop
		jmp	short loc_41D9F3
; ---------------------------------------------------------------------------

loc_41D9F2:				; CODE XREF: sub_41D2F5+52j
		nop

loc_41D9F3:				; CODE XREF: sub_41D2F5+6F8j
					; sub_41D2F5+6FBj
		add	[ebp+arg_0], 1
		jmp	short loc_41D9FA
; ---------------------------------------------------------------------------

loc_41D9F9:				; CODE XREF: sub_41D2F5+19j
		nop

loc_41D9FA:				; CODE XREF: sub_41D2F5+702j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_41D319
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+Memory]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_41DA6B
; ---------------------------------------------------------------------------

loc_41DA1F:				; CODE XREF: sub_41D2F5+44j
		nop
		jmp	short loc_41DA38
; ---------------------------------------------------------------------------

loc_41DA22:				; CODE XREF: sub_41D2F5+CDj
		nop
		jmp	short loc_41DA38
; ---------------------------------------------------------------------------

loc_41DA25:				; CODE XREF: sub_41D2F5+1DDj
		nop
		jmp	short loc_41DA38
; ---------------------------------------------------------------------------

loc_41DA28:				; CODE XREF: sub_41D2F5+1EBj
		nop
		jmp	short loc_41DA38
; ---------------------------------------------------------------------------

loc_41DA2B:				; CODE XREF: sub_41D2F5+231j
		nop
		jmp	short loc_41DA38
; ---------------------------------------------------------------------------

loc_41DA2E:				; CODE XREF: sub_41D2F5+343j
		nop
		jmp	short loc_41DA38
; ---------------------------------------------------------------------------

loc_41DA31:				; CODE XREF: sub_41D2F5+351j
		nop
		jmp	short loc_41DA38
; ---------------------------------------------------------------------------

loc_41DA34:				; CODE XREF: sub_41D2F5+397j
		nop
		jmp	short loc_41DA38
; ---------------------------------------------------------------------------

loc_41DA37:				; CODE XREF: sub_41D2F5+5BCj
		nop

loc_41DA38:				; CODE XREF: sub_41D2F5+1Fj
					; sub_41D2F5+274j ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		jmp	short loc_41DA48
; ---------------------------------------------------------------------------

loc_41DA47:				; CODE XREF: sub_41D2F5+5DCj
		nop

loc_41DA48:				; CODE XREF: sub_41D2F5+750j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_41DA5D
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_41DA5D:				; CODE XREF: sub_41D2F5+75Bj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh

locret_41DA6B:				; CODE XREF: sub_41D2F5+728j
		leave
		retn
sub_41D2F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DA6D	proc near		; CODE XREF: sub_41ED7C+4D8p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		jmp	loc_41DC46
; ---------------------------------------------------------------------------

loc_41DA7F:				; CODE XREF: sub_41DA6D+1DFj
		mov	eax, [ebp+var_4]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		add	eax, 8
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_4]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 1Bh ; switch 28 cases
		ja	loc_41DC3B	; jumptable 0041DAB3 default case
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, offset off_432318
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41DAB5:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 1
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DACC:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 20
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DAE1:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 2
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DAF8:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 21
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DB0D:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 3
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_8]
		mov	[eax], dl
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DB24:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 4
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_8]
		mov	[eax], dx
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DB3C:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 5
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_8]
		mov	[eax], dx
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DB54:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 22
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DB69:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 6
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DB7E:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 23
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DB93:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 7
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DBA8:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 8
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	loc_41DC42
; ---------------------------------------------------------------------------

loc_41DBBD:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 9
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	short loc_41DC42
; ---------------------------------------------------------------------------

loc_41DBCF:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 24
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	short loc_41DC42
; ---------------------------------------------------------------------------

loc_41DBE1:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 12
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		fld	qword ptr [eax]
		mov	eax, [ebp+var_8]
		fstp	qword ptr [eax]
		jmp	short loc_41DC42
; ---------------------------------------------------------------------------

loc_41DBF3:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 14
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	short loc_41DC42
; ---------------------------------------------------------------------------

loc_41DC05:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 19
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	short loc_41DC42
; ---------------------------------------------------------------------------

loc_41DC17:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 17
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	short loc_41DC42
; ---------------------------------------------------------------------------

loc_41DC29:				; CODE XREF: sub_41DA6D+46j
					; DATA XREF: .rdata:off_432318o
		mov	eax, [ebp+arg_8] ; jumptable 0041DAB3 case 27
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_8]
		mov	[eax], edx
		jmp	short loc_41DC42
; ---------------------------------------------------------------------------

loc_41DC3B:				; CODE XREF: sub_41DA6D+33j
					; sub_41DA6D+46j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 0041DAB3 default case
		jmp	short locret_41DC57
; ---------------------------------------------------------------------------

loc_41DC42:				; CODE XREF: sub_41DA6D+5Aj
					; sub_41DA6D+6Fj ...
		add	[ebp+var_4], 1

loc_41DC46:				; CODE XREF: sub_41DA6D+Dj
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+arg_4]
		jb	loc_41DA7F
		mov	eax, 0

locret_41DC57:				; CODE XREF: sub_41DA6D+1D3j
		leave
		retn
sub_41DA6D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DC59	proc near		; CODE XREF: sub_41DCD7+38Cp
					; sub_41DCD7+480p ...

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_30		= byte ptr -30h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		jmp	short loc_41DCCA
; ---------------------------------------------------------------------------

loc_41DC61:				; CODE XREF: sub_41DC59+75j
		mov	eax, [ebp+arg_C]
		mov	edx, 20h
		cmp	eax, 20h
		cmova	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax ; Size
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Val], eax ; Val
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Dst], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41DCB2
		mov	eax, [ebp+var_10]
		jmp	short locret_41DCD5
; ---------------------------------------------------------------------------

loc_41DCB2:				; CODE XREF: sub_41DC59+52j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		sub	eax, [ebp+var_C]
		mov	[ebp+arg_C], eax

loc_41DCCA:				; CODE XREF: sub_41DC59+6j
		cmp	[ebp+arg_C], 0
		jg	short loc_41DC61
		mov	eax, 0

locret_41DCD5:				; CODE XREF: sub_41DC59+57j
		leave
		retn
sub_41DC59	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DCD7	proc near		; CODE XREF: sub_41E927+2D5p

var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_99		= byte ptr -99h
var_98		= byte ptr -98h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0D4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_B0], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_AC], eax
		mov	[ebp+var_99], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jnz	short loc_41DD66
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 6
		jz	short loc_41DD27
		cmp	eax, 8
		jz	short loc_41DD32
		cmp	eax, 4
		jnz	short loc_41DD3D
		movzx	eax, word ptr [ebp+var_B0]
		cwde
		mov	[ebp+var_1C], eax
		jmp	short loc_41DD47
; ---------------------------------------------------------------------------

loc_41DD27:				; CODE XREF: sub_41DCD7+37j
		mov	eax, [ebp+var_B0]
		mov	[ebp+var_1C], eax
		jmp	short loc_41DD47
; ---------------------------------------------------------------------------

loc_41DD32:				; CODE XREF: sub_41DCD7+3Cj
		mov	eax, [ebp+var_B0]
		mov	[ebp+var_1C], eax
		jmp	short loc_41DD47
; ---------------------------------------------------------------------------

loc_41DD3D:				; CODE XREF: sub_41DCD7+41j
		mov	eax, 0FFFFFFFFh
		jmp	loc_41E227
; ---------------------------------------------------------------------------

loc_41DD47:				; CODE XREF: sub_41DCD7+4Ej
					; sub_41DCD7+59j ...
		cmp	[ebp+var_1C], 0
		jns	short loc_41DD5E
		mov	eax, [ebp+var_1C]
		neg	eax
		mov	[ebp+var_C], eax
		mov	[ebp+var_99], 2Dh
		jmp	short loc_41DDAA
; ---------------------------------------------------------------------------

loc_41DD5E:				; CODE XREF: sub_41DCD7+74j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_41DDAA
; ---------------------------------------------------------------------------

loc_41DD66:				; CODE XREF: sub_41DCD7+2Cj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 7
		jz	short loc_41DD8A
		cmp	eax, 9
		jz	short loc_41DD95
		cmp	eax, 5
		jnz	short loc_41DDA0
		movzx	eax, word ptr [ebp+var_B0]
		movzx	eax, ax
		mov	[ebp+var_C], eax
		jmp	short loc_41DDAA
; ---------------------------------------------------------------------------

loc_41DD8A:				; CODE XREF: sub_41DCD7+98j
		mov	eax, [ebp+var_B0]
		mov	[ebp+var_C], eax
		jmp	short loc_41DDAA
; ---------------------------------------------------------------------------

loc_41DD95:				; CODE XREF: sub_41DCD7+9Dj
		mov	eax, [ebp+var_B0]
		mov	[ebp+var_C], eax
		jmp	short loc_41DDAA
; ---------------------------------------------------------------------------

loc_41DDA0:				; CODE XREF: sub_41DCD7+A2j
		mov	eax, 0FFFFFFFFh
		jmp	loc_41E227
; ---------------------------------------------------------------------------

loc_41DDAA:				; CODE XREF: sub_41DCD7+85j
					; sub_41DCD7+8Dj ...
		movzx	eax, [ebp+var_99]
		cmp	al, 2Dh
		jz	short loc_41DDDF
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_41DDCB
		mov	[ebp+var_99], 2Bh
		jmp	short loc_41DDDF
; ---------------------------------------------------------------------------

loc_41DDCB:				; CODE XREF: sub_41DCD7+E9j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_41DDDF
		mov	[ebp+var_99], 20h

loc_41DDDF:				; CODE XREF: sub_41DCD7+DCj
					; sub_41DCD7+F2j ...
		movzx	eax, [ebp+var_99]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_98]
		add	eax, 64h
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41DE17
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_41DF6F

loc_41DE17:				; CODE XREF: sub_41DCD7+130j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jz	short loc_41DE31
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	loc_41DECF

loc_41DE31:				; CODE XREF: sub_41DCD7+149j
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	[ebp+var_2C], offset byte_432388

loc_41DE3F:				; CODE XREF: sub_41DCD7+1EDj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 1
		test	al, al
		jz	short loc_41DE76
		add	[ebp+var_20], 1
		cmp	[ebp+var_20], 3
		jnz	short loc_41DE76
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41DE76
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_2C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	[ebp+var_20], 0

loc_41DE76:				; CODE XREF: sub_41DCD7+173j
					; sub_41DCD7+17Dj ...
		sub	[ebp+var_10], 1
		mov	ecx, [ebp+var_C]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	ecx, [ebp+var_C]
		mov	[ebp+var_B4], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_B4]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41DE3F
		jmp	loc_41DF6F
; ---------------------------------------------------------------------------

loc_41DECF:				; CODE XREF: sub_41DCD7+154j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 2
		jnz	short loc_41DF20

loc_41DEDA:				; CODE XREF: sub_41DCD7+224j
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		and	eax, 7
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		shr	eax, 3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41DEDA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_41DF6F
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_41DF6F
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h
		jmp	short loc_41DF6F
; ---------------------------------------------------------------------------

loc_41DF20:				; CODE XREF: sub_41DCD7+201j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_41DF32
		mov	eax, offset a0123456789ab_1 ; "0123456789abcdef"
		jmp	short loc_41DF37
; ---------------------------------------------------------------------------

loc_41DF32:				; CODE XREF: sub_41DCD7+252j
		mov	eax, offset a0123456789ab_2 ; "0123456789ABCDEF"

loc_41DF37:				; CODE XREF: sub_41DCD7+259j
		mov	[ebp+var_28], eax

loc_41DF3A:				; CODE XREF: sub_41DCD7+285j
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		and	eax, 0Fh
		add	eax, [ebp+var_28]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		shr	eax, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41DF3A
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_41DF6F
		add	[ebp+var_18], 2

loc_41DF6F:				; CODE XREF: sub_41DCD7+13Aj
					; sub_41DCD7+1F3j ...
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_41DFC8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41DFC8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_41DFC8
		cmp	[ebp+var_30], 0
		jz	short loc_41DFC8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_18]
		cmp	eax, [ebp+var_30]
		jbe	short loc_41DFC8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_18]
		sub	eax, [ebp+var_30]
		mov	[ebp+var_14], eax
		jmp	short loc_41DFF2
; ---------------------------------------------------------------------------

loc_41DFC8:				; CODE XREF: sub_41DCD7+2B2j
					; sub_41DCD7+2BDj ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jle	short loc_41DFEB
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_30]
		jbe	short loc_41DFEB
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_30]
		mov	[ebp+var_14], eax
		jmp	short loc_41DFF2
; ---------------------------------------------------------------------------

loc_41DFEB:				; CODE XREF: sub_41DCD7+2F9j
					; sub_41DCD7+304j
		mov	[ebp+var_14], 0

loc_41DFF2:				; CODE XREF: sub_41DCD7+2EFj
					; sub_41DCD7+312j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_41E079
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_41E079
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_18]
		cmp	eax, [ebp+var_30]
		jbe	short loc_41E079
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_18]
		mov	edx, eax
		sub	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		cmp	edx, eax
		jb	short loc_41E079
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_18]
		mov	edx, eax
		sub	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, [ebp+arg_14]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_41DC59
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_41E079
		mov	eax, [ebp+var_34]
		jmp	loc_41E227
; ---------------------------------------------------------------------------

loc_41E079:				; CODE XREF: sub_41DCD7+326j
					; sub_41DCD7+330j ...
		movzx	eax, [ebp+var_99]
		test	al, al
		jz	short loc_41E0BF
		mov	[esp+0D8h+var_D0], 1
		lea	eax, [ebp+var_99]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_41E0B2
		mov	eax, [ebp+var_34]
		jmp	loc_41E227
; ---------------------------------------------------------------------------

loc_41E0B2:				; CODE XREF: sub_41DCD7+3D1j
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx

loc_41E0BF:				; CODE XREF: sub_41DCD7+3ABj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_41E12E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jz	short loc_41E0E2
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 5
		jnz	short loc_41E12E

loc_41E0E2:				; CODE XREF: sub_41DCD7+3FEj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_41E0F4
		mov	eax, offset a0x	; "0x"
		jmp	short loc_41E0F9
; ---------------------------------------------------------------------------

loc_41E0F4:				; CODE XREF: sub_41DCD7+414j
		mov	eax, offset a0x_0 ; "0X"

loc_41E0F9:				; CODE XREF: sub_41DCD7+41Bj
		mov	[esp+0D8h+var_D0], 2
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_41E121
		mov	eax, [ebp+var_34]
		jmp	loc_41E227
; ---------------------------------------------------------------------------

loc_41E121:				; CODE XREF: sub_41DCD7+440j
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx

loc_41E12E:				; CODE XREF: sub_41DCD7+3F3j
					; sub_41DCD7+409j
		cmp	[ebp+var_14], 0
		jz	short loc_41E16D
		mov	eax, [ebp+arg_14]
		mov	[esp+0D8h+var_C8], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 30h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_41DC59
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_41E16D
		mov	eax, [ebp+var_34]
		jmp	loc_41E227
; ---------------------------------------------------------------------------

loc_41E16D:				; CODE XREF: sub_41DCD7+45Bj
					; sub_41DCD7+48Cj
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+0D8h+var_D0], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_41E1A0
		mov	eax, [ebp+var_34]
		jmp	loc_41E227
; ---------------------------------------------------------------------------

loc_41E1A0:				; CODE XREF: sub_41DCD7+4BFj
		mov	eax, [ebp+arg_14]
		mov	edx, [eax]
		mov	ecx, [ebp+var_24]
		mov	eax, [ebp+var_10]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_41E222
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_41E222
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_18]
		sub	eax, [ebp+var_14]
		cmp	eax, [ebp+var_30]
		jbe	short loc_41E222
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_18]
		sub	eax, [ebp+var_14]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_14]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_41DC59
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_41E222
		mov	eax, [ebp+var_34]
		jmp	short loc_41E227
; ---------------------------------------------------------------------------

loc_41E222:				; CODE XREF: sub_41DCD7+4ECj
					; sub_41DCD7+4F6j ...
		mov	eax, 0

loc_41E227:				; CODE XREF: sub_41DCD7+6Bj
					; sub_41DCD7+CEj ...
		add	esp, 0D4h
		pop	ebx
		pop	ebp
		retn
sub_41DCD7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E230	proc near		; CODE XREF: sub_41E927+30Bp

Dest		= dword	ptr -1C8h
Format		= dword	ptr -1C4h
var_1C0		= qword	ptr -1C0h
var_1B8		= dword	ptr -1B8h
var_1A8		= dword	ptr -1A8h
var_1A4		= dword	ptr -1A4h
var_1A0		= qword	ptr -1A0h
var_197		= byte ptr -197h
var_196		= byte ptr -196h
var_182		= byte ptr -182h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= qword	ptr -18h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1C0h
		mov	eax, [ebp+arg_C]
		mov	dword ptr [ebp+var_1A0], eax
		mov	eax, [ebp+arg_10]
		mov	dword ptr [ebp+var_1A0+4], eax
		mov	[ebp+var_197], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Ch
		jnz	short loc_41E28F
		fld	[ebp+var_1A0]
		fstp	[ebp+var_18]
		nop
		lea	eax, [ebp+var_196]
		add	eax, 14h
		mov	[ebp+var_C], eax
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		sub	eax, 6
		cmp	eax, 7
		ja	short loc_41E302
		jmp	short loc_41E299
; ---------------------------------------------------------------------------

loc_41E28F:				; CODE XREF: sub_41E230+2Dj
		mov	eax, 0FFFFFFFFh
		jmp	loc_41E5B9
; ---------------------------------------------------------------------------

loc_41E299:				; CODE XREF: sub_41E230+5Dj
		mov	eax, ds:off_4323B4[eax*4]
		jmp	eax
; ---------------------------------------------------------------------------

loc_41E2A2:				; DATA XREF: .rdata:off_4323B4o
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	66h
		jmp	short loc_41E30C
; ---------------------------------------------------------------------------

loc_41E2AE:				; DATA XREF: .rdata:004323B8o
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	46h
		jmp	short loc_41E30C
; ---------------------------------------------------------------------------

loc_41E2BA:				; DATA XREF: .rdata:004323BCo
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	65h
		jmp	short loc_41E30C
; ---------------------------------------------------------------------------

loc_41E2C6:				; DATA XREF: .rdata:004323C0o
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	45h
		jmp	short loc_41E30C
; ---------------------------------------------------------------------------

loc_41E2D2:				; DATA XREF: .rdata:004323C4o
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	67h
		jmp	short loc_41E30C
; ---------------------------------------------------------------------------

loc_41E2DE:				; DATA XREF: .rdata:004323C8o
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	47h
		jmp	short loc_41E30C
; ---------------------------------------------------------------------------

loc_41E2EA:				; DATA XREF: .rdata:004323CCo
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	61h
		jmp	short loc_41E30C
; ---------------------------------------------------------------------------

loc_41E2F6:				; DATA XREF: .rdata:004323D0o
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	41h
		jmp	short loc_41E30C
; ---------------------------------------------------------------------------

loc_41E302:				; CODE XREF: sub_41E230+5Bj
		mov	eax, 0FFFFFFFFh
		jmp	loc_41E5B9
; ---------------------------------------------------------------------------

loc_41E30C:				; CODE XREF: sub_41E230+7Cj
					; sub_41E230+88j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41E385
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	edx, 64h
		cmp	eax, 64h
		cmovg	eax, edx
		mov	[ebp+var_10], eax

loc_41E32B:				; CODE XREF: sub_41E230+149j
		sub	[ebp+var_C], 1
		mov	ecx, [ebp+var_10]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	ecx, [ebp+var_10]
		mov	[ebp+var_1A4], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_1A4]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41E32B
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	2Eh

loc_41E385:				; CODE XREF: sub_41E230+E5j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_41E39C
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	23h

loc_41E39C:				; CODE XREF: sub_41E230+160j
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	25h
		mov	eax, [ebp+var_C]
		fld	[ebp+var_18]
		fstp	[esp+1C8h+var_1C0]
		mov	[esp+1C8h+Format], eax ; Format
		lea	eax, [ebp+var_182]
		mov	[esp+1C8h+Dest], eax ; Dest
		call	sprintf
		lea	eax, [ebp+var_182]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_182]
		mov	[ebp+var_1A8], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1A8]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		add	eax, edx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_41E41C
		mov	[ebp+var_197], 2Dh
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1
		jmp	short loc_41E446
; ---------------------------------------------------------------------------

loc_41E41C:				; CODE XREF: sub_41E230+1D9j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_41E432
		mov	[ebp+var_197], 2Bh
		jmp	short loc_41E446
; ---------------------------------------------------------------------------

loc_41E432:				; CODE XREF: sub_41E230+1F7j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_41E446
		mov	[ebp+var_197], 20h

loc_41E446:				; CODE XREF: sub_41E230+1EAj
					; sub_41E230+200j ...
		movzx	eax, [ebp+var_197]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_41E4BF
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_41E4BF
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_20]
		cmp	eax, [ebp+var_10]
		jbe	short loc_41E4BF
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_20]
		sub	eax, [ebp+var_10]
		mov	edx, [ebp+arg_14]
		mov	[esp+1C8h+var_1B8], edx
		mov	dword ptr [esp+1C8h+var_1C0+4],	eax
		mov	dword ptr [esp+1C8h+var_1C0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1C8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1C8h+Dest], eax
		call	sub_41DC59
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41E4BF
		mov	eax, [ebp+var_24]
		jmp	loc_41E5B9
; ---------------------------------------------------------------------------

loc_41E4BF:				; CODE XREF: sub_41E230+233j
					; sub_41E230+23Dj ...
		movzx	eax, [ebp+var_197]
		test	al, al
		jz	short loc_41E505
		mov	dword ptr [esp+1C8h+var_1C0], 1
		lea	eax, [ebp+var_197]
		mov	[esp+1C8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1C8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41E4F8
		mov	eax, [ebp+var_24]
		jmp	loc_41E5B9
; ---------------------------------------------------------------------------

loc_41E4F8:				; CODE XREF: sub_41E230+2BEj
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx

loc_41E505:				; CODE XREF: sub_41E230+298j
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+1C8h+var_1C0], eax
		mov	eax, [ebp+var_C]
		mov	[esp+1C8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1C8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41E538
		mov	eax, [ebp+var_24]
		jmp	loc_41E5B9
; ---------------------------------------------------------------------------

loc_41E538:				; CODE XREF: sub_41E230+2FEj
		mov	eax, [ebp+arg_14]
		mov	edx, [eax]
		mov	ecx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_41E5B4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_41E5B4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_20]
		cmp	eax, [ebp+var_10]
		jbe	short loc_41E5B4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_20]
		sub	eax, [ebp+var_10]
		mov	edx, [ebp+arg_14]
		mov	[esp+1C8h+var_1B8], edx
		mov	dword ptr [esp+1C8h+var_1C0+4],	eax
		mov	dword ptr [esp+1C8h+var_1C0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1C8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1C8h+Dest], eax
		call	sub_41DC59
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41E5B4
		mov	eax, [ebp+var_24]
		jmp	short loc_41E5B9
; ---------------------------------------------------------------------------

loc_41E5B4:				; CODE XREF: sub_41E230+32Bj
					; sub_41E230+335j ...
		mov	eax, 0

loc_41E5B9:				; CODE XREF: sub_41E230+64j
					; sub_41E230+D7j ...
		add	esp, 1C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41E230	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E5C3	proc near		; CODE XREF: sub_41E927+341p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 6
		jz	short loc_41E5E7
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41E627
; ---------------------------------------------------------------------------

loc_41E5E7:				; CODE XREF: sub_41E5C3+1Bj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_D], al
		mov	[esp+38h+var_30], 1
		lea	eax, [ebp+var_D]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41E615
		mov	eax, [ebp+var_C]
		jmp	short locret_41E627
; ---------------------------------------------------------------------------

loc_41E615:				; CODE XREF: sub_41E5C3+4Bj
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, 0

locret_41E627:				; CODE XREF: sub_41E5C3+22j
					; sub_41E5C3+50j
		leave
		retn
sub_41E5C3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E629	proc near		; CODE XREF: sub_41E927+377p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Eh
		jz	short loc_41E651
		mov	eax, 0FFFFFFFFh
		jmp	loc_41E7B8
; ---------------------------------------------------------------------------

loc_41E651:				; CODE XREF: sub_41E629+1Cj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41E664
		mov	[ebp+var_10], offset aNull ; "(null)"

loc_41E664:				; CODE XREF: sub_41E629+32j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		js	short loc_41E69C
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_41E685
; ---------------------------------------------------------------------------

loc_41E67D:				; CODE XREF: sub_41E629+6Fj
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_41E685:				; CODE XREF: sub_41E629+52j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41E6BE
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		ja	short loc_41E67D
		jmp	short loc_41E6BE
; ---------------------------------------------------------------------------

loc_41E69C:				; CODE XREF: sub_41E629+43j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_24]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax

loc_41E6BE:				; CODE XREF: sub_41E629+64j
					; sub_41E629+71j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_41E71F
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_41E71F
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_41E71F
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_14]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41DC59
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41E71F
		mov	eax, [ebp+var_18]
		jmp	loc_41E7B8
; ---------------------------------------------------------------------------

loc_41E71F:				; CODE XREF: sub_41E629+A0j
					; sub_41E629+AAj ...
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41E746
		mov	eax, [ebp+var_18]
		jmp	short loc_41E7B8
; ---------------------------------------------------------------------------

loc_41E746:				; CODE XREF: sub_41E629+116j
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_41E7B3
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_41E7B3
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_41E7B3
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_14]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41DC59
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41E7B3
		mov	eax, [ebp+var_18]
		jmp	short loc_41E7B8
; ---------------------------------------------------------------------------

loc_41E7B3:				; CODE XREF: sub_41E629+137j
					; sub_41E629+141j ...
		mov	eax, 0

loc_41E7B8:				; CODE XREF: sub_41E629+23j
					; sub_41E629+F1j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_41E629	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E7BE	proc near		; CODE XREF: sub_41E927+3AAp

var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= byte ptr -7Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 13h
		jz	short loc_41E7EF
		mov	eax, 0FFFFFFFFh
		jmp	loc_41E8AA
; ---------------------------------------------------------------------------

loc_41E7EF:				; CODE XREF: sub_41E7BE+25j
		mov	eax, [ebp+var_90]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_7C]
		add	eax, 64h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_41E807:				; CODE XREF: sub_41E7BE+6Cj
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		and	eax, 0Fh
		movzx	edx, ds:byte_4323DB[eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		shr	eax, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41E807
		jmp	short loc_41E838
; ---------------------------------------------------------------------------

loc_41E82E:				; CODE XREF: sub_41E7BE+89j
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h

loc_41E838:				; CODE XREF: sub_41E7BE+6Ej
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 7
		jbe	short loc_41E82E
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	78h
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41E88D
		mov	eax, [ebp+var_18]
		jmp	short loc_41E8AA
; ---------------------------------------------------------------------------

loc_41E88D:				; CODE XREF: sub_41E7BE+C8j
		mov	eax, [ebp+arg_14]
		mov	edx, [eax]
		mov	ecx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, 0

loc_41E8AA:				; CODE XREF: sub_41E7BE+2Cj
					; sub_41E7BE+CDj
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_41E7BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E8B3	proc near		; CODE XREF: sub_41E927+3DDp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 15h	; switch 7 cases
		cmp	eax, 6
		ja	short loc_41E919 ; jumptable 0041E8DA default case
		mov	eax, ds:off_4323F0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41E8DC:				; CODE XREF: sub_41E8B3+27j
					; DATA XREF: .rdata:off_4323F0o
		mov	eax, [ebp+var_8] ; jumptable 0041E8DA case 21
		mov	edx, [ebp+arg_14]
		mov	edx, [edx]
		mov	[eax], dl
		jmp	short loc_41E920
; ---------------------------------------------------------------------------

loc_41E8E8:				; CODE XREF: sub_41E8B3+27j
					; DATA XREF: .rdata:off_4323F0o
		mov	eax, [ebp+var_8] ; jumptable 0041E8DA case 22
		mov	edx, [ebp+arg_14]
		mov	edx, [edx]
		mov	[eax], dx
		jmp	short loc_41E920
; ---------------------------------------------------------------------------

loc_41E8F5:				; CODE XREF: sub_41E8B3+27j
					; DATA XREF: .rdata:off_4323F0o
		mov	eax, [ebp+var_8] ; jumptable 0041E8DA case 24
		mov	edx, [ebp+arg_14]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_41E920
; ---------------------------------------------------------------------------

loc_41E901:				; CODE XREF: sub_41E8B3+27j
					; DATA XREF: .rdata:off_4323F0o
		mov	eax, [ebp+var_8] ; jumptable 0041E8DA case 27
		mov	edx, [ebp+arg_14]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_41E920
; ---------------------------------------------------------------------------

loc_41E90D:				; CODE XREF: sub_41E8B3+27j
					; DATA XREF: .rdata:off_4323F0o
		mov	eax, [ebp+var_8] ; jumptable 0041E8DA case 23
		mov	edx, [ebp+arg_14]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_41E920
; ---------------------------------------------------------------------------

loc_41E919:				; CODE XREF: sub_41E8B3+1Ej
					; sub_41E8B3+27j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 0041E8DA default case
		jmp	short locret_41E925
; ---------------------------------------------------------------------------

loc_41E920:				; CODE XREF: sub_41E8B3+33j
					; sub_41E8B3+40j ...
		mov	eax, 0

locret_41E925:				; CODE XREF: sub_41E8B3+6Bj
		leave
		retn
sub_41E8B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E927	proc near		; CODE XREF: sub_41ED7C+526p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_41ED1C
; ---------------------------------------------------------------------------

loc_41E94C:				; CODE XREF: sub_41E927+3FDj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_41E95F
		add	[ebp+var_10], 1
		jmp	loc_41ED1C
; ---------------------------------------------------------------------------

loc_41E95F:				; CODE XREF: sub_41E927+2Dj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jz	short loc_41E9AF
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41E9A0
		mov	eax, [ebp+var_C]
		jmp	locret_41ED7A
; ---------------------------------------------------------------------------

loc_41E9A0:				; CODE XREF: sub_41E927+6Fj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_41E9AF:				; CODE XREF: sub_41E927+3Ej
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_41EA03
		mov	[esp+48h+var_40], 1
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41E9E7
		mov	eax, [ebp+var_C]
		jmp	locret_41ED7A
; ---------------------------------------------------------------------------

loc_41E9E7:				; CODE XREF: sub_41E927+B6j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		add	[ebp+var_10], 2
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		jmp	loc_41ED1C
; ---------------------------------------------------------------------------

loc_41EA03:				; CODE XREF: sub_41E927+93j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_10]
		jb	short loc_41EA35
		mov	[esp+48h+var_40], 529h ; int
		mov	[esp+48h+var_44], offset a____Dirmngr1_9 ; "../../dirmngr-1.1.1/src/estream-printf."...
		mov	[esp+48h+var_48], offset aArgidxArgspecs ; "argidx < argspecs_len"
		call	sub_429780

loc_41EA35:				; CODE XREF: sub_41E927+F0j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_41EAB9
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		sub	eax, 1
		shl	eax, 4
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_41EA76
		mov	[esp+48h+var_40], 52Fh ; int
		mov	[esp+48h+var_44], offset a____Dirmngr1_9 ; "../../dirmngr-1.1.1/src/estream-printf."...
		mov	[esp+48h+var_48], offset aValuetableArgW ; "valuetable[arg->width_pos-1].vt == VALT"...
		call	sub_429780

loc_41EA76:				; CODE XREF: sub_41E927+131j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		sub	eax, 1
		shl	eax, 4
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		test	eax, eax
		jns	short loc_41EAB9
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+var_14]
		mov	[eax+4], edx

loc_41EAB9:				; CODE XREF: sub_41E927+11Bj
					; sub_41E927+16Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_41EB22
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		sub	eax, 1
		shl	eax, 4
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_41EAF6
		mov	[esp+48h+var_40], 539h ; int
		mov	[esp+48h+var_44], offset a____Dirmngr1_9 ; "../../dirmngr-1.1.1/src/estream-printf."...
		mov	[esp+48h+var_48], offset aValuetableArgP ; "valuetable[arg->precision_pos-1].vt	== "...
		call	sub_429780

loc_41EAF6:				; CODE XREF: sub_41E927+1B1j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		sub	eax, 1
		shl	eax, 4
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jns	short loc_41EB22
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_41EB22:				; CODE XREF: sub_41E927+19Bj
					; sub_41E927+1EFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41EB48
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 11h
		jnz	short loc_41EB48
		mov	eax, [ebp+arg_18]
		mov	[esp+48h+var_48], eax ;	int
		call	strerror
		mov	[ebp+var_28], eax
		jmp	short loc_41EB9A
; ---------------------------------------------------------------------------

loc_41EB48:				; CODE XREF: sub_41E927+204j
					; sub_41E927+20Fj
		mov	eax, [ebp+var_14]
		mov	edx, [eax+24h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		sub	eax, 1
		shl	eax, 4
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	edx, eax
		jz	short loc_41EB7F
		mov	[esp+48h+var_40], 543h ; int
		mov	[esp+48h+var_44], offset a____Dirmngr1_9 ; "../../dirmngr-1.1.1/src/estream-printf."...
		mov	[esp+48h+var_48], offset aArgVtValuetabl ; "arg->vt == valuetable[arg->arg_pos-1].v"...
		call	sub_429780

loc_41EB7F:				; CODE XREF: sub_41E927+23Aj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		sub	eax, 1
		shl	eax, 4
		add	eax, [ebp+arg_14]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx

loc_41EB9A:				; CODE XREF: sub_41E927+21Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_41ED0D	; jumptable 0041EBB0 default case
		mov	eax, ds:off_4324E0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41EBB2:				; CODE XREF: sub_41E927+289j
					; DATA XREF: .rdata:off_4324E0o
		mov	[esp+48h+var_40], 549h ; jumptable 0041EBB0 case 0
		mov	[esp+48h+var_44], offset a____Dirmngr1_9 ; "../../dirmngr-1.1.1/src/estream-printf."...
		mov	[esp+48h+var_48], offset aBug ;	"!\"bug\""
		call	sub_429780
		jmp	loc_41ED0D	; jumptable 0041EBB0 default case
; ---------------------------------------------------------------------------

loc_41EBD3:				; CODE XREF: sub_41E927+289j
					; DATA XREF: .rdata:off_4324E0o
		mov	eax, [ebp+arg_1C] ; jumptable 0041EBB0 cases 1-5
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_38], edx
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41DCD7
		mov	[ebp+var_C], eax
		jmp	loc_41ED0D	; jumptable 0041EBB0 default case
; ---------------------------------------------------------------------------

loc_41EC09:				; CODE XREF: sub_41E927+289j
					; DATA XREF: .rdata:off_4324E0o
		mov	eax, [ebp+arg_1C] ; jumptable 0041EBB0 cases 6-13
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_38], edx
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41E230
		mov	[ebp+var_C], eax
		jmp	loc_41ED0D	; jumptable 0041EBB0 default case
; ---------------------------------------------------------------------------

loc_41EC3F:				; CODE XREF: sub_41E927+289j
					; DATA XREF: .rdata:off_4324E0o
		mov	eax, [ebp+arg_1C] ; jumptable 0041EBB0 case 14
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_38], edx
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41E5C3
		mov	[ebp+var_C], eax
		jmp	loc_41ED0D	; jumptable 0041EBB0 default case
; ---------------------------------------------------------------------------

loc_41EC75:				; CODE XREF: sub_41E927+289j
					; DATA XREF: .rdata:off_4324E0o
		mov	eax, [ebp+arg_1C] ; jumptable 0041EBB0 cases 15,17
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_38], edx
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41E629
		mov	[ebp+var_C], eax
		jmp	short loc_41ED0D ; jumptable 0041EBB0 default case
; ---------------------------------------------------------------------------

loc_41ECA8:				; CODE XREF: sub_41E927+289j
					; DATA XREF: .rdata:off_4324E0o
		mov	eax, [ebp+arg_1C] ; jumptable 0041EBB0 case 16
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_38], edx
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41E7BE
		mov	[ebp+var_C], eax
		jmp	short loc_41ED0D ; jumptable 0041EBB0 default case
; ---------------------------------------------------------------------------

loc_41ECDB:				; CODE XREF: sub_41E927+289j
					; DATA XREF: .rdata:off_4324E0o
		mov	eax, [ebp+arg_1C] ; jumptable 0041EBB0 case 18
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_38], edx
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41E8B3
		mov	[ebp+var_C], eax
		nop

loc_41ED0D:				; CODE XREF: sub_41E927+27Cj
					; sub_41E927+2A7j ...
		cmp	[ebp+var_C], 0	; jumptable 0041EBB0 default case
		jz	short loc_41ED18
		mov	eax, [ebp+var_C]
		jmp	short locret_41ED7A
; ---------------------------------------------------------------------------

loc_41ED18:				; CODE XREF: sub_41E927+3EAj
		add	[ebp+var_14], 28h

loc_41ED1C:				; CODE XREF: sub_41E927+20j
					; sub_41E927+33j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_41E94C
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41ED5A
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_0]
		call	eax
		jmp	short loc_41ED5F
; ---------------------------------------------------------------------------

loc_41ED5A:				; CODE XREF: sub_41E927+416j
		mov	eax, 0

loc_41ED5F:				; CODE XREF: sub_41E927+431j
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41ED77
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_41ED77:				; CODE XREF: sub_41E927+43Fj
		mov	eax, [ebp+var_C]

locret_41ED7A:				; CODE XREF: sub_41E927+74j
					; sub_41E927+BBj ...
		leave
		retn
sub_41E927	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41ED7C	proc near		; CODE XREF: sub_41AC03+32p
					; .text:0041F37Ep ...

NumOfElements	= dword	ptr -1A8h
SizeOfElements	= dword	ptr -1A4h
var_1A0		= dword	ptr -1A0h
var_19C		= dword	ptr -19Ch
var_198		= dword	ptr -198h
var_194		= dword	ptr -194h
var_190		= dword	ptr -190h
var_18C		= dword	ptr -18Ch
var_17C		= dword	ptr -17Ch
var_174		= dword	ptr -174h
var_170		= byte ptr -170h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= byte ptr -0E8h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1A0h
		lea	eax, [ebp+var_E8]
		mov	[ebp+var_EC], eax
		lea	eax, [ebp+var_170]
		mov	[ebp+Memory], eax
		mov	[ebp+var_174], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_F0]
		mov	[esp+1A8h+var_19C], eax
		mov	[esp+1A8h+var_1A0], 5
		lea	eax, [ebp+var_EC]
		mov	[esp+1A8h+SizeOfElements], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1A8h+NumOfElements], eax
		call	sub_41D2F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_41F2CC
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 0
		jmp	loc_41EEC2
; ---------------------------------------------------------------------------

loc_41EDF9:				; CODE XREF: sub_41ED7C+14Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41EE4E
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_41EE4E
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		mov	[ebp+var_1C], eax

loc_41EE4E:				; CODE XREF: sub_41ED7C+98j
					; sub_41ED7C+B5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		cmp	eax, [ebp+var_1C]
		jle	short loc_41EE86
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], eax

loc_41EE86:				; CODE XREF: sub_41ED7C+EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_41EEBE
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		mov	[ebp+var_1C], eax

loc_41EEBE:				; CODE XREF: sub_41ED7C+125j
		add	[ebp+var_14], 1

loc_41EEC2:				; CODE XREF: sub_41ED7C+78j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_41EDF9
		cmp	[ebp+var_1C], 0
		jnz	loc_41EFB6
		mov	[ebp+var_14], 0
		jmp	loc_41EFA2
; ---------------------------------------------------------------------------

loc_41EEE7:				; CODE XREF: sub_41ED7C+22Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_41EF24
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+1Ch], eax

loc_41EF24:				; CODE XREF: sub_41ED7C+186j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_41EF61
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+20h], eax

loc_41EF61:				; CODE XREF: sub_41ED7C+1C3j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41EF9E
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+18h], eax

loc_41EF9E:				; CODE XREF: sub_41ED7C+200j
		add	[ebp+var_14], 1

loc_41EFA2:				; CODE XREF: sub_41ED7C+166j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_41EEE7
		jmp	loc_41F06F
; ---------------------------------------------------------------------------

loc_41EFB6:				; CODE XREF: sub_41ED7C+159j
		mov	[ebp+var_14], 0
		jmp	loc_41F060
; ---------------------------------------------------------------------------

loc_41EFC2:				; CODE XREF: sub_41ED7C+2EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_41F2B6
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_41F01F
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_41F2B6

loc_41F01F:				; CODE XREF: sub_41ED7C+281j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_41F05C
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_41F2B6

loc_41F05C:				; CODE XREF: sub_41ED7C+2BEj
		add	[ebp+var_14], 1

loc_41F060:				; CODE XREF: sub_41ED7C+241j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_41EFC2

loc_41F06F:				; CODE XREF: sub_41ED7C+235j
		cmp	[ebp+var_1C], 0
		js	loc_41F2B6
		mov	ebx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_17C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_17C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jnb	loc_41F2B6
		mov	eax, [ebp+var_1C]
		cmp	eax, 8
		jbe	short loc_41F0D2
		mov	eax, [ebp+var_1C]
		mov	[esp+1A8h+SizeOfElements], 10h ; SizeOfElements
		mov	[esp+1A8h+NumOfElements], eax ;	NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_41F0F4
		jmp	loc_41F2C3
; ---------------------------------------------------------------------------

loc_41F0D2:				; CODE XREF: sub_41ED7C+333j
		mov	[ebp+var_18], 0
		jmp	short loc_41F0EE
; ---------------------------------------------------------------------------

loc_41F0DB:				; CODE XREF: sub_41ED7C+376j
		mov	eax, [ebp+var_18]
		shl	eax, 4
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		add	[ebp+var_18], 1

loc_41F0EE:				; CODE XREF: sub_41ED7C+35Dj
		cmp	[ebp+var_18], 7
		jbe	short loc_41F0DB

loc_41F0F4:				; CODE XREF: sub_41ED7C+34Fj
		mov	[ebp+var_14], 0
		jmp	loc_41F231
; ---------------------------------------------------------------------------

loc_41F100:				; CODE XREF: sub_41ED7C+4BEj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41F173
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		shl	eax, 4
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41F2AC
		mov	eax, [ebp+var_18]
		shl	eax, 4
		mov	ecx, eax
		add	ecx, [ebp+Memory]
		mov	ebx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ebx
		mov	eax, [eax+24h]
		mov	[ecx], eax

loc_41F173:				; CODE XREF: sub_41ED7C+39Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_41F1D0
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		shl	eax, 4
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41F2AF
		mov	eax, [ebp+var_18]
		shl	eax, 4
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_41F1D0:				; CODE XREF: sub_41ED7C+412j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_41F22D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		shl	eax, 4
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41F2B2
		mov	eax, [ebp+var_18]
		shl	eax, 4
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_41F22D:				; CODE XREF: sub_41ED7C+46Fj
		add	[ebp+var_14], 1

loc_41F231:				; CODE XREF: sub_41ED7C+37Fj
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_41F100
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_C]
		mov	[esp+1A8h+var_1A0], edx
		mov	[esp+1A8h+SizeOfElements], eax
		mov	eax, [ebp+Memory]
		mov	[esp+1A8h+NumOfElements], eax
		call	sub_41DA6D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41F2B5
		mov	edx, [ebp+var_F0]
		mov	eax, [ebp+var_EC]
		lea	ecx, [ebp+var_174]
		mov	[esp+1A8h+var_18C], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+1A8h+var_190], ecx
		mov	ecx, [ebp+Memory]
		mov	[esp+1A8h+var_194], ecx
		mov	[esp+1A8h+var_198], edx
		mov	[esp+1A8h+var_19C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1A8h+var_1A0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1A8h+SizeOfElements], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1A8h+NumOfElements], eax
		call	sub_41E927
		mov	[ebp+var_10], eax
		jmp	short loc_41F2CD
; ---------------------------------------------------------------------------

loc_41F2AC:				; CODE XREF: sub_41ED7C+3CCj
		nop
		jmp	short loc_41F2B6
; ---------------------------------------------------------------------------

loc_41F2AF:				; CODE XREF: sub_41ED7C+43Fj
		nop
		jmp	short loc_41F2B6
; ---------------------------------------------------------------------------

loc_41F2B2:				; CODE XREF: sub_41ED7C+49Cj
		nop
		jmp	short loc_41F2B6
; ---------------------------------------------------------------------------

loc_41F2B5:				; CODE XREF: sub_41ED7C+4E4j
		nop

loc_41F2B6:				; CODE XREF: sub_41ED7C+260j
					; sub_41ED7C+29Dj ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h

loc_41F2C3:				; CODE XREF: sub_41ED7C+351j
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_41F2CD
; ---------------------------------------------------------------------------

loc_41F2CC:				; CODE XREF: sub_41ED7C+64j
		nop

loc_41F2CD:				; CODE XREF: sub_41ED7C+52Ej
					; sub_41ED7C+54Ej
		lea	eax, [ebp+var_170]
		cmp	[ebp+Memory], eax
		jz	short loc_41F2E3
		mov	eax, [ebp+Memory]
		mov	[esp+1A8h+NumOfElements], eax ;	Memory
		call	free

loc_41F2E3:				; CODE XREF: sub_41ED7C+55Aj
		mov	edx, [ebp+var_EC]
		lea	eax, [ebp+var_E8]
		cmp	edx, eax
		jz	short loc_41F301
		mov	eax, [ebp+var_EC]
		mov	[esp+1A8h+NumOfElements], eax ;	Memory
		call	free

loc_41F301:				; CODE XREF: sub_41ED7C+575j
		mov	eax, [ebp+var_10]
		add	esp, 1A0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41ED7C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F30E(int, void *, size_t)
sub_41F30E	proc near		; DATA XREF: .text:0041F377o
					; .text:0041F3AEo ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 1 ; Count
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_41F347
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41F34C
; ---------------------------------------------------------------------------

loc_41F347:				; CODE XREF: sub_41F30E+30j
		mov	eax, 0

locret_41F34C:				; CODE XREF: sub_41F30E+37j
		leave
		retn
sub_41F30E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	sub_41F30E
		call	sub_41ED7C
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_41F30E
		call	sub_41ED7C
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_41F30E
		call	sub_41ED7C
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F3EB(int, void *, size_t)
sub_41F3EB	proc near		; CODE XREF: sub_41F4A7+6Dp
					; DATA XREF: sub_41F4A7+42o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_41F4A0
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jnb	short loc_41F48B
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		jmp	short loc_41F4A0
; ---------------------------------------------------------------------------

loc_41F463:				; CODE XREF: sub_41F3EB+B3j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		add	[ebp+arg_4], 1
		sub	[ebp+arg_8], 1

loc_41F48B:				; CODE XREF: sub_41F3EB+3Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_41F4A0
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jb	short loc_41F463

loc_41F4A0:				; CODE XREF: sub_41F3EB+25j
					; sub_41F3EB+76j ...
		mov	eax, 0
		leave
		retn
sub_41F3EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F4A7	proc near		; CODE XREF: .text:0041F589p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_41F4CC
		mov	eax, [ebp+arg_0]
		jmp	short loc_41F4D1
; ---------------------------------------------------------------------------

loc_41F4CC:				; CODE XREF: sub_41F4A7+1Ej
		mov	eax, 0

loc_41F4D1:				; CODE XREF: sub_41F4A7+23j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset sub_41F3EB
		call	sub_41ED7C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F51C
		mov	[esp+38h+var_30], 1 ; size_t
		mov	[esp+38h+var_34], offset byte_43252C ; void *
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_41F3EB
		mov	[ebp+var_C], eax

loc_41F51C:				; CODE XREF: sub_41F4A7+55j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41F529
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41F55E
; ---------------------------------------------------------------------------

loc_41F529:				; CODE XREF: sub_41F4A7+79j
		cmp	[ebp+arg_4], 0
		jz	short loc_41F552
		cmp	[ebp+arg_0], 0
		jz	short loc_41F552
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_41F552
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jb	short loc_41F552
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0

loc_41F552:				; CODE XREF: sub_41F4A7+86j
					; sub_41F4A7+8Cj ...
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_41F55E:				; CODE XREF: sub_41F4A7+80j
		leave
		retn
sub_41F4A7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+14h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41F4A7
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F596(int, void *Src, size_t)
sub_41F596	proc near		; CODE XREF: sub_41F6A2+83p
					; DATA XREF: sub_41F6A2+58o

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41F5C3
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_C]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_41F6A0
; ---------------------------------------------------------------------------

loc_41F5C3:				; CODE XREF: sub_41F596+13j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_41F664
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+NewSize], edx ; NewSize
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41F65B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41F62A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		jmp	short loc_41F62F
; ---------------------------------------------------------------------------

loc_41F62A:				; CODE XREF: sub_41F596+87j
		mov	eax, 0Ch

loc_41F62F:				; CODE XREF: sub_41F596+92j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+NewSize], 0 ; Val
		mov	[esp+28h+Memory], eax ;	Dst
		call	memset
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41F6A0
; ---------------------------------------------------------------------------

loc_41F65B:				; CODE XREF: sub_41F596+7Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_41F664:				; CODE XREF: sub_41F596+40j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+NewSize], edx ; Src
		mov	[esp+28h+Memory], eax ;	Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, 0

locret_41F6A0:				; CODE XREF: sub_41F596+28j
					; sub_41F596+C3j
		leave
		retn
sub_41F596	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F6A2	proc near		; CODE XREF: sub_41C5BB+22p
					; .text:0041C611p ...

Dst		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 200h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		test	eax, eax
		jnz	short loc_41F6E5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	locret_41F7B9
; ---------------------------------------------------------------------------

loc_41F6E5:				; CODE XREF: sub_41F6A2+2Ej
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Val], eax
		mov	[esp+38h+Dst], offset sub_41F596
		call	sub_41ED7C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F72D
		mov	[esp+38h+Size],	1 ; size_t
		mov	[esp+38h+Val], offset byte_43252C ; Src
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Dst], eax ; int
		call	sub_41F596
		mov	[ebp+var_C], eax

loc_41F72D:				; CODE XREF: sub_41F6A2+6Bj
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_41F74D
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_41F74D
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_1C]
		mov	[eax], edx

loc_41F74D:				; CODE XREF: sub_41F6A2+8Fj
					; sub_41F6A2+96j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41F788
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41F7B9
; ---------------------------------------------------------------------------

loc_41F788:				; CODE XREF: sub_41F6A2+AFj
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_41F7AB
		mov	[esp+38h+Size],	6E5h ; int
		mov	[esp+38h+Val], offset a____Dirmngr1_9 ;	"../../dirmngr-1.1.1/src/estream-printf."...
		mov	[esp+38h+Dst], offset aParm_used ; "parm.used"
		call	sub_429780

loc_41F7AB:				; CODE XREF: sub_41F6A2+EBj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		sub	eax, 1

locret_41F7B9:				; CODE XREF: sub_41F6A2+3Ej
					; sub_41F6A2+E4j
		leave
		retn
sub_41F6A2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F7BB	proc near		; CODE XREF: sub_407EC1+15Ep
					; sub_40A08A+106p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41F6A2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41F7BB	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F7EC	proc near		; CODE XREF: sub_41F813+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41F80C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_41F811
; ---------------------------------------------------------------------------

loc_41F80C:				; CODE XREF: sub_41F7EC+7j
		mov	eax, 0

loc_41F811:				; CODE XREF: sub_41F7EC+1Ej
		pop	ebp
		retn
sub_41F7EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F813	proc near		; CODE XREF: sub_41F83B+14p
					; sub_41F8CC+DEp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_41F7EC
		leave
		retn
sub_41F813	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F82E	proc near		; CODE XREF: sub_41F8CC+136p
					; sub_41FA19+22p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_41F82E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F83B	proc near		; CODE XREF: sub_420043+538p
					; sub_420043+797p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_41F813
		leave
		retn
sub_41F83B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F856(char *, char *)
sub_41F856	proc near		; CODE XREF: sub_420043+289p
					; sub_420043+2B9p ...

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41F8B4
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Fh
		jnz	short loc_41F898
		mov	eax, [ebp+arg_4]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_41F8B4

loc_41F898:				; CODE XREF: sub_41F856+33j
		mov	[esp+28h+var_20], offset aCopy_time_1 ;	"copy_time"
		mov	[esp+28h+Source], 39h
		mov	[esp+28h+Dest],	offset a____Dirmngr_10 ; "../../dirmngr-1.1.1/src/misc.h"
		call	sub_423540
; ---------------------------------------------------------------------------

loc_41F8B4:				; CODE XREF: sub_41F856+Fj
					; sub_41F856+40j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dest],	eax ; Dest
		call	strcpy
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_41F856	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F8CC	proc near		; CODE XREF: sub_420043+382p

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_10], 0
		jmp	loc_41F9B9
; ---------------------------------------------------------------------------

loc_41F8E5:				; CODE XREF: sub_41F8CC+124j
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	loc_41F9B4
		mov	[ebp+var_C], 0
		jmp	short loc_41F8FD
; ---------------------------------------------------------------------------

loc_41F8F9:				; CODE XREF: sub_41F8CC+5Aj
		add	[ebp+var_C], 1

loc_41F8FD:				; CODE XREF: sub_41F8CC+2Bj
		mov	eax, [ebp+var_C]
		mov	eax, off_42B588[eax*4]
		test	eax, eax
		jz	short loc_41F928
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	eax, off_42B588[eax*4]
		mov	[esp+48h+Str2],	edx ; Str2
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41F8F9

loc_41F928:				; CODE XREF: sub_41F8CC+3Dj
		mov	eax, [ebp+var_C]
		mov	eax, off_42B588[eax*4]
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41F98A
		mov	eax, ds:dword_436000
		test	eax, eax
		jz	short loc_41F98A
		mov	eax, ds:dword_436000
		mov	[ebp+var_18], eax
		jmp	short loc_41F95E
; ---------------------------------------------------------------------------

loc_41F956:				; CODE XREF: sub_41F8CC+AFj
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_18], eax

loc_41F95E:				; CODE XREF: sub_41F8CC+88j
		cmp	[ebp+var_18], 0
		jz	short loc_41F97D
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_18]
		add	edx, 8
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41F956

loc_41F97D:				; CODE XREF: sub_41F8CC+96j
		cmp	[ebp+var_18], 0
		jz	short loc_41F98A
		mov	[ebp+var_14], 0

loc_41F98A:				; CODE XREF: sub_41F8CC+75j
					; sub_41F8CC+7Ej ...
		cmp	[ebp+var_14], 0
		jz	short loc_41F9B5
		mov	eax, [ebp+var_28]
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aCriticalCertif ; "critical certificate extension %s is no"...
		call	sub_4233B1
		mov	[esp+48h+Str1],	67h
		call	sub_41F813
		mov	[ebp+var_1C], eax
		jmp	short loc_41F9B5
; ---------------------------------------------------------------------------

loc_41F9B4:				; CODE XREF: sub_41F8CC+1Ej
		nop

loc_41F9B5:				; CODE XREF: sub_41F8CC+C2j
					; sub_41F8CC+E6j
		add	[ebp+var_10], 1

loc_41F9B9:				; CODE XREF: sub_41F8CC+14j
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str1],	eax
		call	ksba_cert_get_extension
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_41F8E5
		cmp	[ebp+var_20], 0
		jz	short loc_41FA14
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Str1],	eax
		call	sub_41F82E
		cmp	eax, 3FFFh
		jz	short loc_41FA14
		mov	eax, [ebp+var_20]
		mov	[ebp+var_1C], eax

loc_41FA14:				; CODE XREF: sub_41F8CC+12Ej
					; sub_41F8CC+140j
		mov	eax, [ebp+var_1C]
		leave
		retn
sub_41F8CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FA19	proc near		; CODE XREF: sub_420043+39Ap

Str		= dword	ptr -48h
SubStr		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		lea	eax, [ebp+var_20]
		mov	[esp+48h+SubStr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	ksba_cert_get_cert_policies
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	sub_41F82E
		cmp	eax, 3Ah
		jnz	short loc_41FA4F
		mov	eax, 0
		jmp	loc_41FB93
; ---------------------------------------------------------------------------

loc_41FA4F:				; CODE XREF: sub_41FA19+2Aj
		cmp	[ebp+var_C], 0
		jz	short loc_41FA5D
		mov	eax, [ebp+var_C]
		jmp	loc_41FB93
; ---------------------------------------------------------------------------

loc_41FA5D:				; CODE XREF: sub_41FA19+3Aj
		mov	eax, ds:dword_435FA4
		cmp	eax, 1
		jle	short loc_41FA7A
		mov	eax, [ebp+var_20]
		mov	[esp+48h+SubStr], eax ;	char
		mov	[esp+48h+Str], offset aCertificateSPo ;	"certificate's policy list: %s\n"
		call	sub_423387

loc_41FA7A:				; CODE XREF: sub_41FA19+4Cj
		mov	eax, [ebp+var_20]
		mov	[esp+48h+SubStr], offset SubStr	; ":C"
		mov	[esp+48h+Str], eax ; Str
		call	strstr
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_18], eax
		mov	[ebp+var_10], 0
		jmp	loc_41FB3D
; ---------------------------------------------------------------------------

loc_41FAA4:				; CODE XREF: sub_41FA19+130j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		jmp	short loc_41FB13
; ---------------------------------------------------------------------------

loc_41FAAC:				; CODE XREF: sub_41FA19+11Aj
		mov	eax, [ebp+var_20]
		cmp	[ebp+var_1C], eax
		jz	short loc_41FAC1
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41FB06

loc_41FAC1:				; CODE XREF: sub_41FA19+99j
		mov	eax, [ebp+var_10]
		mov	eax, off_42B580[eax*4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_41FB09
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Str], eax
		call	ksba_free
		mov	eax, 0
		jmp	loc_41FB93
; ---------------------------------------------------------------------------

loc_41FB06:				; CODE XREF: sub_41FA19+A6j
		nop
		jmp	short loc_41FB0A
; ---------------------------------------------------------------------------

loc_41FB09:				; CODE XREF: sub_41FA19+D6j
		nop

loc_41FB0A:				; CODE XREF: sub_41FA19+EEj
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[ebp+var_14], eax

loc_41FB13:				; CODE XREF: sub_41FA19+91j
		mov	eax, [ebp+var_10]
		mov	eax, off_42B580[eax*4]
		mov	[esp+48h+SubStr], eax ;	char
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_41FAAC
		add	[ebp+var_10], 1

loc_41FB3D:				; CODE XREF: sub_41FA19+86j
		mov	eax, [ebp+var_10]
		mov	eax, off_42B580[eax*4]
		test	eax, eax
		jnz	loc_41FAA4
		cmp	[ebp+var_18], 0
		jnz	short loc_41FB6A
		mov	[esp+48h+Str], offset aNoteNonCritica ;	"note: non-critical certificate	policy n"...
		call	sub_423387
		mov	[ebp+var_C], 0
		jmp	short loc_41FB85
; ---------------------------------------------------------------------------

loc_41FB6A:				; CODE XREF: sub_41FA19+13Aj
		mov	[esp+48h+Str], offset aCertificatePol ;	"certificate policy not	allowed"
		call	sub_423387
		mov	[esp+48h+Str], 74h
		call	sub_41F813
		mov	[ebp+var_C], eax

loc_41FB85:				; CODE XREF: sub_41FA19+14Fj
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Str], eax
		call	ksba_free
		mov	eax, [ebp+var_C]

loc_41FB93:				; CODE XREF: sub_41FA19+31j
					; sub_41FA19+3Fj ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_41FA19	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FB99	proc near		; CODE XREF: sub_420043+43Fp
					; sub_420043+700p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		lea	eax, [ebp+var_10]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	ksba_cert_is_ca
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41FBC6
		mov	eax, [ebp+var_C]
		jmp	short locret_41FC21
; ---------------------------------------------------------------------------

loc_41FBC6:				; CODE XREF: sub_41FB99+26j
		mov	eax, dword ptr [ebp+var_10]
		test	eax, eax
		jnz	short loc_41FC1C
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40E892
		test	eax, eax
		jnz	short loc_41FC02
		cmp	[ebp+arg_4], 0
		jz	short loc_41FBEB
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 3

loc_41FBEB:				; CODE XREF: sub_41FB99+47j
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_41FC1C
		mov	[esp+28h+var_28], offset aAcceptingRootC ; "accepting root CA not marked as a CA"
		call	sub_423387
		jmp	short loc_41FC1C
; ---------------------------------------------------------------------------

loc_41FC02:				; CODE XREF: sub_41FB99+41j
		mov	[esp+28h+var_28], offset aIssuerCertif_1 ; "issuer certificate is not marked as	a C"...
		call	sub_4233B1
		mov	[esp+28h+var_28], 64h
		call	sub_41F813
		jmp	short locret_41FC21
; ---------------------------------------------------------------------------

loc_41FC1C:				; CODE XREF: sub_41FB99+32j
					; sub_41FB99+59j ...
		mov	eax, 0

locret_41FC21:				; CODE XREF: sub_41FB99+2Bj
					; sub_41FB99+81j
		leave
		retn
sub_41FB99	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FC23	proc near		; CODE XREF: sub_420043+895p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		test	eax, eax
		jns	short loc_41FC6B
		mov	[esp+38h+var_30], 0E0h ; int
		mov	[esp+38h+var_34], offset a____Dirmngr_11 ; "../../dirmngr-1.1.1/src/validate.c"
		mov	[esp+38h+var_38], offset aCtrlCheck_revo ; "ctrl->check_revocations_nest_level >= 0"
		call	sub_429780

loc_41FC6B:				; CODE XREF: sub_41FC23+2Aj
		cmp	[ebp+arg_4], 0
		jnz	short loc_41FC8D
		mov	[esp+38h+var_30], 0E1h ; int
		mov	[esp+38h+var_34], offset a____Dirmngr_11 ; "../../dirmngr-1.1.1/src/validate.c"
		mov	[esp+38h+var_38], offset aChain	; "chain"
		call	sub_429780

loc_41FC8D:				; CODE XREF: sub_41FC23+4Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 0Ah
		jle	short loc_41FCB5
		mov	[esp+38h+var_38], offset aCrlCheckingToo ; "CRL	checking too deeply nested\n"
		call	sub_4233B1
		mov	[esp+38h+var_38], 38h
		call	sub_41F813
		jmp	locret_41FE8B
; ---------------------------------------------------------------------------

loc_41FCB5:				; CODE XREF: sub_41FC23+73j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		jmp	loc_41FE1D
; ---------------------------------------------------------------------------

loc_41FCCF:				; CODE XREF: sub_41FC23+1FEj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41FCF5
		mov	[esp+38h+var_30], 0EDh ; int
		mov	[esp+38h+var_34], offset a____Dirmngr_11 ; "../../dirmngr-1.1.1/src/validate.c"
		mov	[esp+38h+var_38], offset aCiCert ; "ci->cert"
		call	sub_429780

loc_41FCF5:				; CODE XREF: sub_41FC23+B4j
		mov	eax, [ebp+var_1C]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_41FD25
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	loc_41FE14
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset aNotCheckingCrl ; "not	checking CRL for"
		call	sub_416DBE
		jmp	loc_41FE14
; ---------------------------------------------------------------------------

loc_41FD25:				; CODE XREF: sub_41FC23+D8j
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_41FD44
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset aCheckingCrlFor ; "checking CRL for"
		call	sub_416DBE

loc_41FD44:				; CODE XREF: sub_41FC23+109j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_409253
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_41F82E
		cmp	eax, 5Fh
		jnz	short loc_41FDB2
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40B296
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41FDB2
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_409253
		mov	[ebp+var_C], eax

loc_41FDB2:				; CODE XREF: sub_41FC23+14Fj
					; sub_41FC23+16Dj
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_41F82E
		cmp	eax, 5Fh
		jz	short loc_41FDF2
		cmp	eax, 5Fh
		ja	short loc_41FDD2
		test	eax, eax
		jz	short loc_41FDD9
		cmp	eax, 5Eh
		jz	short loc_41FDE2
		jmp	short loc_41FE12
; ---------------------------------------------------------------------------

loc_41FDD2:				; CODE XREF: sub_41FC23+1A2j
		cmp	eax, 60h
		jz	short loc_41FE02
		jmp	short loc_41FE12
; ---------------------------------------------------------------------------

loc_41FDD9:				; CODE XREF: sub_41FC23+1A6j
		mov	[ebp+var_C], 0
		jmp	short loc_41FE15
; ---------------------------------------------------------------------------

loc_41FDE2:				; CODE XREF: sub_41FC23+1ABj
		mov	[ebp+var_10], 1
		mov	[ebp+var_C], 0
		jmp	short loc_41FE15
; ---------------------------------------------------------------------------

loc_41FDF2:				; CODE XREF: sub_41FC23+19Dj
		mov	[ebp+var_14], 1
		mov	[ebp+var_C], 0
		jmp	short loc_41FE15
; ---------------------------------------------------------------------------

loc_41FE02:				; CODE XREF: sub_41FC23+1B2j
		mov	[ebp+var_18], 1
		mov	[ebp+var_C], 0
		jmp	short loc_41FE15
; ---------------------------------------------------------------------------

loc_41FE12:				; CODE XREF: sub_41FC23+1ADj
					; sub_41FC23+1B4j
		jmp	short loc_41FE15
; ---------------------------------------------------------------------------

loc_41FE14:				; CODE XREF: sub_41FC23+E1j
					; sub_41FC23+FDj
		nop

loc_41FE15:				; CODE XREF: sub_41FC23+1BDj
					; sub_41FC23+1CDj ...
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax

loc_41FE1D:				; CODE XREF: sub_41FC23+A7j
		cmp	[ebp+var_1C], 0
		jnz	loc_41FCCF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		cmp	[ebp+var_C], 0
		jnz	short loc_41FE88
		cmp	[ebp+var_10], 0
		jz	short loc_41FE53
		mov	[esp+38h+var_38], 5Eh
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	short loc_41FE88
; ---------------------------------------------------------------------------

loc_41FE53:				; CODE XREF: sub_41FC23+21Dj
		cmp	[ebp+var_14], 0
		jz	short loc_41FE6A
		mov	[esp+38h+var_38], 5Fh
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	short loc_41FE88
; ---------------------------------------------------------------------------

loc_41FE6A:				; CODE XREF: sub_41FC23+234j
		cmp	[ebp+var_18], 0
		jz	short loc_41FE81
		mov	[esp+38h+var_38], 60h
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	short loc_41FE88
; ---------------------------------------------------------------------------

loc_41FE81:				; CODE XREF: sub_41FC23+24Bj
		mov	[ebp+var_C], 0

loc_41FE88:				; CODE XREF: sub_41FC23+217j
					; sub_41FC23+22Ej ...
		mov	eax, [ebp+var_C]

locret_41FE8B:				; CODE XREF: sub_41FC23+8Dj
		leave
		retn
sub_41FC23	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41FE8D(int, char *, char *)
sub_41FE8D	proc near		; CODE XREF: sub_420043+3E0p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0
		mov	[ebp+var_28], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_41FEAD
		cmp	[ebp+arg_8], 0
		jnz	short loc_41FEB7

loc_41FEAD:				; CODE XREF: sub_41FE8D+18j
		mov	eax, 0
		jmp	locret_420041
; ---------------------------------------------------------------------------

loc_41FEB7:				; CODE XREF: sub_41FE8D+1Ej
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_41FED7
		mov	eax, 0
		jmp	locret_420041
; ---------------------------------------------------------------------------

loc_41FED7:				; CODE XREF: sub_41FE8D+3Ej
		lea	eax, [ebp+var_24]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_20]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	ksba_cert_get_auth_key_id
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41FF3F
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str1],	eax
		call	sub_41F82E
		cmp	eax, 3Ah
		jnz	short loc_41FF1A
		mov	eax, 1
		jmp	locret_420041
; ---------------------------------------------------------------------------

loc_41FF1A:				; CODE XREF: sub_41FE8D+81j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str1],	eax
		call	gpg_strerror
		mov	[esp+38h+Str2],	eax ; char
		mov	[esp+38h+Str1],	offset aErrorGetting_0 ; "error	getting	authorityKeyIdentifier:	%"...
		call	sub_4233B1
		mov	eax, 0
		jmp	locret_420041
; ---------------------------------------------------------------------------

loc_41FF3F:				; CODE XREF: sub_41FE8D+71j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	ksba_cert_get_serial
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41FF73
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str1],	eax
		call	gpg_strerror
		mov	[esp+38h+Str2],	eax ; char
		mov	[esp+38h+Str1],	offset aErrorGettingSe ; "error	getting	serialno: %s\n"
		call	sub_4233B1
		jmp	loc_420007
; ---------------------------------------------------------------------------

loc_41FF73:				; CODE XREF: sub_41FE8D+C4j
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Str2],	0
		mov	[esp+38h+Str1],	eax
		call	ksba_name_enum
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41FFC4
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str2],	eax ; Str2
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41FFC4
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+Str2],	edx
		mov	[esp+38h+Str1],	eax
		call	sub_40C750
		test	eax, eax
		jnz	short loc_41FFC4
		mov	[ebp+var_C], 1
		jmp	short loc_420007
; ---------------------------------------------------------------------------

loc_41FFC4:				; CODE XREF: sub_41FE8D+100j
					; sub_41FE8D+116j ...
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_420007
		lea	eax, [ebp+var_28]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+Str2],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	ksba_cert_get_subj_key_id
		test	eax, eax
		jnz	short loc_420007
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str2],	edx
		mov	[esp+38h+Str1],	eax
		call	sub_40C750
		test	eax, eax
		jnz	short loc_420007
		mov	[ebp+var_C], 1
		nop

loc_420007:				; CODE XREF: sub_41FE8D+E1j
					; sub_41FE8D+135j ...
		mov	eax, [ebp+var_28]
		mov	[esp+38h+Str1],	eax
		call	ksba_free
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str1],	eax
		call	ksba_free
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Str1],	eax
		call	ksba_name_release
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Str1],	eax
		call	ksba_free
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str1],	eax
		call	ksba_free
		mov	eax, [ebp+var_C]

locret_420041:				; CODE XREF: sub_41FE8D+25j
					; sub_41FE8D+45j ...
		leave
		retn
sub_41FE8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_420043(int, int, char	*, int,	int)
sub_420043	proc near		; CODE XREF: sub_40634F+12Ep
					; sub_40989B+530p ...

Str1		= dword	ptr -0B8h
Str2		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_98		= dword	ptr -98h
var_94		= byte ptr -94h
var_90		= byte ptr -90h
var_80		= byte ptr -80h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= byte ptr -68h
var_58		= byte ptr -58h
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 0B8h
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	dword ptr [ebp+var_1C],	0
		mov	[ebp+var_48], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		cmp	[ebp+arg_8], 0
		jz	short loc_420089
		mov	eax, [ebp+arg_8]
		mov	byte ptr [eax],	0

loc_420089:				; CODE XREF: sub_420043+3Ej
		mov	[ebp+var_68], 0
		cmp	[ebp+arg_10], 0
		jz	short loc_42009C
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0

loc_42009C:				; CODE XREF: sub_420043+4Ej
		mov	eax, ds:dword_435FD0
		test	eax, eax
		jnz	short loc_4200BB
		mov	[esp+0B8h+Str1], offset	aRunningInCompa	; "running in compatibility mode - certifi"...
		call	sub_423387
		mov	eax, 0
		jmp	locret_420A87
; ---------------------------------------------------------------------------

loc_4200BB:				; CODE XREF: sub_420043+60j
		mov	eax, ds:dword_435FA0
		and	eax, 1
		test	al, al
		jz	short loc_4200DA
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+Str2], eax
		mov	[esp+0B8h+Str1], offset	aSubject_2 ; "subject"
		call	sub_416BE5

loc_4200DA:				; CODE XREF: sub_420043+82j
		mov	eax, [ebp+arg_C]
		cmp	eax, 1
		jl	short loc_42010C
		cmp	eax, 2
		jle	short loc_4200FC
		cmp	eax, 3
		jnz	short loc_42010C
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+Str1], eax
		call	sub_42142F
		mov	[ebp+var_C], eax
		jmp	short loc_420114
; ---------------------------------------------------------------------------

loc_4200FC:				; CODE XREF: sub_420043+A2j
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+Str1], eax
		call	sub_42144A
		mov	[ebp+var_C], eax
		jmp	short loc_420114
; ---------------------------------------------------------------------------

loc_42010C:				; CODE XREF: sub_420043+9Dj
					; sub_420043+A7j
		mov	[ebp+var_C], 0
		nop

loc_420114:				; CODE XREF: sub_420043+B7j
					; sub_420043+C7j
		cmp	[ebp+var_C], 0
		jz	short loc_420122
		mov	eax, [ebp+var_C]
		jmp	locret_420A87
; ---------------------------------------------------------------------------

loc_420122:				; CODE XREF: sub_420043+D5j
		cmp	[ebp+arg_8], 0
		jnz	short loc_4201A3
		lea	eax, [ebp+var_6C]
		mov	[esp+0B8h+var_A8], eax
		mov	[esp+0B8h+var_AC], 4
		lea	eax, [ebp+var_70]
		mov	[esp+0B8h+var_B0], eax
		mov	[esp+0B8h+Str2], offset	aValidated_at_0	; "validated_at"
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_get_user_data
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420169
		mov	eax, [ebp+var_6C]
		cmp	eax, 4
		jnz	short loc_420169
		mov	eax, [ebp+var_70]
		test	eax, eax
		jnz	short loc_420172

loc_420169:				; CODE XREF: sub_420043+115j
					; sub_420043+11Dj
		mov	[ebp+var_C], 0
		jmp	short loc_4201A3
; ---------------------------------------------------------------------------

loc_420172:				; CODE XREF: sub_420043+124j
		call	sub_4158E6
		lea	edx, [eax+708h]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		jle	short loc_4201A3
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_420199
		mov	[esp+0B8h+Str1], offset	aCertificateIsG	; "certificate is good (cached)\n"
		call	sub_423387

loc_420199:				; CODE XREF: sub_420043+148j
		mov	eax, 0
		jmp	locret_420A87
; ---------------------------------------------------------------------------

loc_4201A3:				; CODE XREF: sub_420043+E3j
					; sub_420043+12Dj ...
		lea	eax, [ebp+var_58]
		mov	[esp+0B8h+Str1], eax ; char *
		call	sub_415940
		mov	eax, [ebp+arg_4]
		mov	dword ptr [ebp+var_1C],	eax
		mov	[ebp+var_34], 0Ah
		mov	dword ptr [ebp+var_28],	0
		mov	[ebp+var_10], 0

loc_4201C9:				; CODE XREF: sub_420043+7FDj
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+Str1], eax
		call	ksba_free
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Str1], eax
		call	ksba_free
		mov	[esp+0B8h+Str2], 0
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_get_issuer
		mov	[ebp+var_14], eax
		mov	[esp+0B8h+Str2], 0 ; char
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_get_subject
		mov	[ebp+var_18], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_420231
		mov	[esp+0B8h+Str1], offset	aNoIssuerFoun_0	; "no issuer found in certificate\n"
		call	sub_4233B1
		mov	[esp+0B8h+Str1], 24h
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_420231:				; CODE XREF: sub_420043+1CCj
		lea	eax, [ebp+var_80]
		mov	[esp+0B8h+var_B0], eax
		mov	[esp+0B8h+Str2], 0
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_get_validity
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420274
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+var_B0], eax
		mov	[esp+0B8h+Str2], 1
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_get_validity
		mov	[ebp+var_C], eax

loc_420274:				; CODE XREF: sub_420043+20Fj
		cmp	[ebp+var_C], 0
		jz	short loc_4202A9
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0B8h+Str2], eax ; char
		mov	[esp+0B8h+Str1], offset	aCertificateWit	; "certificate with invalid validity: %s"
		call	sub_4233B1
		mov	[esp+0B8h+Str1], 24h
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_4202A9:				; CODE XREF: sub_420043+235j
		movzx	eax, [ebp+var_90]
		test	al, al
		jz	short loc_420301
		movzx	eax, [ebp+var_68]
		test	al, al
		jnz	short loc_4202D3
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+Str2], eax ; char *
		lea	eax, [ebp+var_68]
		mov	[esp+0B8h+Str1], eax ; char *
		call	sub_41F856
		jmp	short loc_420301
; ---------------------------------------------------------------------------

loc_4202D3:				; CODE XREF: sub_420043+277j
		lea	eax, [ebp+var_68]
		mov	[esp+0B8h+Str2], eax ; Str2
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jns	short loc_420301
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+Str2], eax ; char *
		lea	eax, [ebp+var_68]
		mov	[esp+0B8h+Str1], eax ; char *
		call	sub_41F856

loc_420301:				; CODE XREF: sub_420043+26Fj
					; sub_420043+28Ej ...
		movzx	eax, [ebp+var_80]
		test	al, al
		jz	short loc_420362
		lea	eax, [ebp+var_80]
		mov	[esp+0B8h+Str2], eax ; char
		lea	eax, [ebp+var_58]
		mov	[esp+0B8h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jns	short loc_420362
		mov	[esp+0B8h+Str1], offset	aCertificateNot	; "certificate not yet valid"
		call	sub_4233B1
		mov	[esp+0B8h+Str1], offset	aValidFrom ; "(valid from "
		call	sub_423387
		lea	eax, [ebp+var_80]
		mov	[esp+0B8h+Str1], eax
		call	sub_416AA4
		mov	[esp+0B8h+Str1], offset	asc_432891 ; ")\n"
		call	sub_423478
		mov	[esp+0B8h+Str1], 66h
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_420362:				; CODE XREF: sub_420043+2C4j
					; sub_420043+2DAj
		movzx	eax, [ebp+var_90]
		test	al, al
		jz	short loc_4203BF
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+Str2], eax ; char
		lea	eax, [ebp+var_58]
		mov	[esp+0B8h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jle	short loc_4203BF
		mov	[esp+0B8h+Str1], offset	aCertificateH_0	; "certificate has expired"
		call	sub_4233B1
		mov	[esp+0B8h+Str1], offset	aExpiredAt ; "(expired at "
		call	sub_423387
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+Str1], eax
		call	sub_416AA4
		mov	[esp+0B8h+Str1], offset	asc_432891 ; ")\n"
		call	sub_423478
		mov	[ebp+var_20], 1

loc_4203BF:				; CODE XREF: sub_420043+328j
					; sub_420043+341j
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	sub_41F8CC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_420937
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	sub_41FA19
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Str1], eax
		call	sub_41F82E
		cmp	eax, 74h
		jnz	short loc_420405
		mov	[ebp+var_24], 1
		mov	[ebp+var_C], 0
		jmp	short loc_42040F
; ---------------------------------------------------------------------------

loc_420405:				; CODE XREF: sub_420043+3B0j
		cmp	[ebp+var_C], 0
		jnz	loc_42093A

loc_42040F:				; CODE XREF: sub_420043+3C0j
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+var_B0], eax ; char *
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+Str2], eax ; char
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax ; int
		call	sub_41FE8D
		test	eax, eax
		jz	loc_4205FD
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str2], eax ; char
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	sub_420BAC
		test	eax, eax
		jz	short loc_420474
		mov	[esp+0B8h+Str1], offset	aSelfsignedCert	; "selfsigned certificate has a	BAD signat"...
		call	sub_4233B1
		cmp	[ebp+var_10], 0
		jz	short loc_42045F
		mov	eax, 38h
		jmp	short loc_420464
; ---------------------------------------------------------------------------

loc_42045F:				; CODE XREF: sub_420043+413j
		mov	eax, 24h

loc_420464:				; CODE XREF: sub_420043+41Aj
		mov	[esp+0B8h+Str1], eax
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_420474:				; CODE XREF: sub_420043+401j
		mov	[esp+0B8h+Str2], 0 ; char
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	sub_41FB99
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_42093D
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	sub_40E892
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_420548
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Str1], eax
		call	sub_41F82E
		cmp	eax, 62h
		jnz	short loc_42052D
		mov	[esp+0B8h+Str1], offset	aRootCertificat	; "root	certificate is not marked trusted"
		call	sub_4233B1
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	sub_416729
		mov	dword ptr [ebp+var_38],	eax
		cmp	dword ptr [ebp+var_38],	0
		jz	short loc_4204E1
		mov	eax, dword ptr [ebp+var_38]
		jmp	short loc_4204E6
; ---------------------------------------------------------------------------

loc_4204E1:				; CODE XREF: sub_420043+497j
		mov	eax, offset a?_4 ; "?"

loc_4204E6:				; CODE XREF: sub_420043+49Cj
		mov	[esp+0B8h+Str2], eax ; char
		mov	[esp+0B8h+Str1], offset	aFingerprintS ;	"fingerprint=%s\n"
		call	sub_423387
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str2], eax
		mov	[esp+0B8h+Str1], offset	aIssuer_1 ; "issuer"
		call	sub_416BE5
		cmp	[ebp+arg_10], 0
		jz	short loc_420520
		mov	eax, [ebp+arg_10]
		mov	edx, dword ptr [ebp+var_38]
		mov	[eax], edx
		mov	[ebp+var_C], 0
		jmp	short loc_420548
; ---------------------------------------------------------------------------

loc_420520:				; CODE XREF: sub_420043+4CAj
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0B8h+Str1], eax
		call	gcry_free
		jmp	short loc_420548
; ---------------------------------------------------------------------------

loc_42052D:				; CODE XREF: sub_420043+477j
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0B8h+Str2], eax ; char
		mov	[esp+0B8h+Str1], offset	aCheckingTrustw	; "checking trustworthiness of root certif"...
		call	sub_4233B1

loc_420548:				; CODE XREF: sub_420043+463j
					; sub_420043+4DBj ...
		cmp	[ebp+var_C], 0
		jnz	loc_420940
		mov	[esp+0B8h+Str2], 24h
		mov	[esp+0B8h+Str1], 1
		call	gcry_calloc
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jnz	short loc_420588
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0B8h+Str1], eax
		call	sub_41F83B
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_420588:				; CODE XREF: sub_420043+52Aj
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_ref
		mov	eax, [ebp+var_3C]
		mov	edx, dword ptr [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_3C]
		add	eax, 8
		mov	[esp+0B8h+Str2], eax ; char
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	sub_40C831
		mov	eax, [ebp+var_3C]
		mov	edx, dword ptr [ebp+var_28]
		mov	[eax], edx
		mov	eax, [ebp+var_3C]
		mov	dword ptr [ebp+var_28],	eax
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	loc_420845
		cmp	[ebp+arg_10], 0
		jz	short loc_4205EC
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4205EC
		mov	[esp+0B8h+Str1], offset	aRootCertific_0	; "root	certificate is good but	not truste"...
		call	sub_423387
		jmp	loc_420845
; ---------------------------------------------------------------------------

loc_4205EC:				; CODE XREF: sub_420043+58Dj
					; sub_420043+596j
		mov	[esp+0B8h+Str1], offset	aRootCertific_1	; "root	certificate is good and	trusted\n"
		call	sub_423387
		jmp	loc_420845
; ---------------------------------------------------------------------------

loc_4205FD:				; CODE XREF: sub_420043+3E7j
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_34]
		jle	short loc_420629
		mov	[esp+0B8h+Str1], offset	aCertificateCha	; "certificate chain too long\n"
		call	sub_4233B1
		mov	[esp+0B8h+Str1], 38h
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_420629:				; CODE XREF: sub_420043+5C4j
		mov	eax, [ebp+var_48]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_release
		mov	[ebp+var_48], 0
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+var_B0], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str2], eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Str1], eax
		call	sub_40E92B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4206CD
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Str1], eax
		call	sub_41F82E
		cmp	eax, 1Bh
		jnz	short loc_42069E
		mov	[esp+0B8h+Str1], offset	aIssuerCertif_2	; "issuer certificate not found"
		call	sub_4233B1
		mov	[esp+0B8h+Str1], offset	aIssuerCertif_3	; "issuer certificate: #/"
		call	sub_423387
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+Str1], eax
		call	sub_416B16
		mov	[esp+0B8h+Str1], offset	asc_432A06 ; "\n"
		call	sub_423478
		jmp	short loc_4206B9
; ---------------------------------------------------------------------------

loc_42069E:				; CODE XREF: sub_420043+628j
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0B8h+Str2], eax ; char
		mov	[esp+0B8h+Str1], offset	aIssuerCertif_4	; "issuer certificate not found: %s\n"
		call	sub_4233B1

loc_4206B9:				; CODE XREF: sub_420043+659j
		mov	[esp+0B8h+Str1], 39h
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_4206CD:				; CODE XREF: sub_420043+618j
		mov	eax, ds:dword_435FA0
		and	eax, 1
		test	al, al
		jz	short loc_4206F8
		mov	[esp+0B8h+Str1], offset	aGotIssuerSCert	; "got issuer's certificate:\n"
		call	sub_42344E
		mov	eax, [ebp+var_48]
		mov	[esp+0B8h+Str2], eax
		mov	[esp+0B8h+Str1], offset	aIssuer_1 ; "issuer"
		call	sub_416BE5

loc_4206F8:				; CODE XREF: sub_420043+694j
		mov	eax, [ebp+var_48]
		mov	edx, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str2], edx ; char
		mov	[esp+0B8h+Str1], eax
		call	sub_420BAC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_420733
		mov	[esp+0B8h+Str1], offset	aCertificateH_1	; "certificate has a BAD signature"
		call	sub_4233B1
		mov	[esp+0B8h+Str1], 38h
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_420733:				; CODE XREF: sub_420043+6CEj
		mov	eax, [ebp+var_48]
		lea	edx, [ebp+var_94]
		mov	[esp+0B8h+Str2], edx
		mov	[esp+0B8h+Str1], eax
		call	sub_41FB99
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_420943
		mov	eax, dword ptr [ebp+var_94]
		test	eax, eax
		js	short loc_420799
		mov	eax, [ebp+var_10]
		lea	edx, [eax-1]
		mov	eax, dword ptr [ebp+var_94]
		cmp	edx, eax
		jle	short loc_420799
		mov	eax, dword ptr [ebp+var_94]
		mov	[esp+0B8h+Str2], eax ; char
		mov	[esp+0B8h+Str1], offset	aCertificateC_0	; "certificate chain longer than allowed b"...
		call	sub_4233B1
		mov	[esp+0B8h+Str1], 38h
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_420799:				; CODE XREF: sub_420043+71Aj
					; sub_420043+72Aj
		mov	eax, [ebp+var_48]
		mov	[esp+0B8h+Str1], eax
		call	sub_421414
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_420946
		mov	[esp+0B8h+Str2], 24h
		mov	[esp+0B8h+Str1], 1
		call	gcry_calloc
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jnz	short loc_4207E7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0B8h+Str1], eax
		call	sub_41F83B
		mov	[ebp+var_C], eax
		jmp	loc_420947
; ---------------------------------------------------------------------------

loc_4207E7:				; CODE XREF: sub_420043+789j
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_ref
		mov	eax, [ebp+var_40]
		mov	edx, dword ptr [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_40]
		add	eax, 8
		mov	[esp+0B8h+Str2], eax ; char
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	sub_40C831
		mov	eax, [ebp+var_40]
		mov	edx, dword ptr [ebp+var_28]
		mov	[eax], edx
		mov	eax, [ebp+var_40]
		mov	dword ptr [ebp+var_28],	eax
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_420833
		mov	[esp+0B8h+Str1], offset	aCertificateI_0	; "certificate is good\n"
		call	sub_423387

loc_420833:				; CODE XREF: sub_420043+7E2j
		mov	eax, [ebp+var_48]
		mov	dword ptr [ebp+var_1C],	eax
		mov	[ebp+var_48], 0
		jmp	loc_4201C9
; ---------------------------------------------------------------------------

loc_420845:				; CODE XREF: sub_420043+583j
					; sub_420043+5A4j ...
		nop
		cmp	[ebp+var_C], 0
		jnz	short loc_420878
		cmp	[ebp+var_20], 0
		jz	short loc_420863
		mov	[esp+0B8h+Str1], 65h
		call	sub_41F813
		mov	[ebp+var_C], eax
		jmp	short loc_420878
; ---------------------------------------------------------------------------

loc_420863:				; CODE XREF: sub_420043+80Dj
		cmp	[ebp+var_24], 0
		jz	short loc_420878
		mov	[esp+0B8h+Str1], 74h
		call	sub_41F813
		mov	[ebp+var_C], eax

loc_420878:				; CODE XREF: sub_420043+807j
					; sub_420043+81Ej ...
		cmp	[ebp+var_C], 0
		jnz	short loc_4208BF
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_4208BF
		mov	[esp+0B8h+Str1], offset	aCertificateC_1	; "certificate chain is	good\n"
		call	sub_423387
		mov	eax, dword ptr [ebp+var_28]
		mov	[ebp+var_2C], eax
		jmp	short loc_4208B9
; ---------------------------------------------------------------------------

loc_42089B:				; CODE XREF: sub_420043+87Aj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		mov	[esp+0B8h+Str2], eax
		mov	[esp+0B8h+Str1], offset	aCertificate_0 ; "  certificate"
		call	sub_416DBE
		mov	eax, [ebp+var_2C]
		mov	eax, [eax]
		mov	[ebp+var_2C], eax

loc_4208B9:				; CODE XREF: sub_420043+856j
		cmp	[ebp+var_2C], 0
		jnz	short loc_42089B

loc_4208BF:				; CODE XREF: sub_420043+839j
					; sub_420043+842j
		cmp	[ebp+var_C], 0
		jnz	short loc_4208E0
		cmp	[ebp+arg_C], 1
		jz	short loc_4208E0
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+0B8h+Str2], eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Str1], eax
		call	sub_41FC23
		mov	[ebp+var_C], eax

loc_4208E0:				; CODE XREF: sub_420043+880j
					; sub_420043+886j
		cmp	[ebp+var_C], 0
		jnz	short loc_42091A
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_42091A
		cmp	[ebp+arg_10], 0
		jz	short loc_42090C
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42090C
		mov	[esp+0B8h+Str1], offset	aTargetCertific	; "target certificate may be valid\n"
		call	sub_423387
		jmp	short loc_420947
; ---------------------------------------------------------------------------

loc_42090C:				; CODE XREF: sub_420043+8B0j
					; sub_420043+8B9j
		mov	[esp+0B8h+Str1], offset	aTargetCertif_0	; "target certificate is valid\n"
		call	sub_423387
		jmp	short loc_420947
; ---------------------------------------------------------------------------

loc_42091A:				; CODE XREF: sub_420043+8A1j
					; sub_420043+8AAj
		cmp	[ebp+var_C], 0
		jz	short loc_420947
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_420947
		mov	[esp+0B8h+Str1], offset	aTargetCertif_1	; "target certificate is NOT valid\n"
		call	sub_423387
		jmp	short loc_420947
; ---------------------------------------------------------------------------

loc_420937:				; CODE XREF: sub_420043+38Ej
		nop
		jmp	short loc_420947
; ---------------------------------------------------------------------------

loc_42093A:				; CODE XREF: sub_420043+3C6j
		nop
		jmp	short loc_420947
; ---------------------------------------------------------------------------

loc_42093D:				; CODE XREF: sub_420043+44Bj
		nop
		jmp	short loc_420947
; ---------------------------------------------------------------------------

loc_420940:				; CODE XREF: sub_420043+509j
		nop
		jmp	short loc_420947
; ---------------------------------------------------------------------------

loc_420943:				; CODE XREF: sub_420043+70Cj
		nop
		jmp	short loc_420947
; ---------------------------------------------------------------------------

loc_420946:				; CODE XREF: sub_420043+768j
		nop

loc_420947:				; CODE XREF: sub_420043+1E9j
					; sub_420043+261j ...
		cmp	[ebp+var_C], 0
		jnz	loc_4209D4
		cmp	[ebp+arg_10], 0
		jz	short loc_420960
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4209D4

loc_420960:				; CODE XREF: sub_420043+912j
		call	sub_4158E6
		mov	[ebp+var_98], eax
		mov	eax, dword ptr [ebp+var_28]
		mov	[ebp+var_30], eax
		jmp	short loc_4209CE
; ---------------------------------------------------------------------------

loc_420973:				; CODE XREF: sub_420043+98Fj
		mov	eax, [ebp+var_30]
		mov	eax, [eax+4]
		mov	[esp+0B8h+var_AC], 4
		lea	edx, [ebp+var_98]
		mov	[esp+0B8h+var_B0], edx
		mov	[esp+0B8h+Str2], offset	aValidated_at_0	; "validated_at"
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_set_user_data
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4209C6
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Str1], eax
		call	gpg_strerror
		mov	[esp+0B8h+Str2], eax ; char
		mov	[esp+0B8h+Str1], offset	aSet_user_dat_0	; "set_user_data(validated_at) failed: %s\"...
		call	sub_4233B1
		mov	[ebp+var_C], 0

loc_4209C6:				; CODE XREF: sub_420043+95Fj
		mov	eax, [ebp+var_30]
		mov	eax, [eax]
		mov	[ebp+var_30], eax

loc_4209CE:				; CODE XREF: sub_420043+92Ej
		cmp	[ebp+var_30], 0
		jnz	short loc_420973

loc_4209D4:				; CODE XREF: sub_420043+908j
					; sub_420043+91Bj
		cmp	[ebp+arg_8], 0
		jz	short loc_4209EC
		lea	eax, [ebp+var_68]
		mov	[esp+0B8h+Str2], eax ; char *
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+Str1], eax ; char *
		call	sub_41F856

loc_4209EC:				; CODE XREF: sub_420043+995j
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+Str1], eax
		call	ksba_free
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Str1], eax
		call	ksba_free
		mov	eax, [ebp+var_48]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_release
		mov	eax, dword ptr [ebp+var_1C]
		cmp	eax, [ebp+arg_4]
		jz	short loc_420A53
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_release
		jmp	short loc_420A53
; ---------------------------------------------------------------------------

loc_420A22:				; CODE XREF: sub_420043+A14j
		mov	eax, dword ptr [ebp+var_28]
		mov	eax, [eax]
		mov	[ebp+var_44], eax
		mov	eax, dword ptr [ebp+var_28]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_420A42
		mov	eax, dword ptr [ebp+var_28]
		mov	eax, [eax+4]
		mov	[esp+0B8h+Str1], eax
		call	ksba_cert_release

loc_420A42:				; CODE XREF: sub_420043+9EFj
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+0B8h+Str1], eax
		call	gcry_free
		mov	eax, [ebp+var_44]
		mov	dword ptr [ebp+var_28],	eax

loc_420A53:				; CODE XREF: sub_420043+9D0j
					; sub_420043+9DDj
		cmp	dword ptr [ebp+var_28],	0
		jnz	short loc_420A22
		cmp	[ebp+var_C], 0
		jz	short loc_420A84
		cmp	[ebp+arg_10], 0
		jz	short loc_420A84
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_420A84
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[esp+0B8h+Str1], eax
		call	gcry_free
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0

loc_420A84:				; CODE XREF: sub_420043+A1Aj
					; sub_420043+A20j ...
		mov	eax, [ebp+var_C]

locret_420A87:				; CODE XREF: sub_420043+73j
					; sub_420043+DAj ...
		leave
		retn
sub_420043	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_420A89	proc near		; CODE XREF: sub_420BAC+3C7p

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Size],	0
		mov	[esp+38h+Buf2],	offset aPublicKey ; "public-key"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Buf1],	eax
		call	gcry_sexp_find_token
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_420ABD
		mov	eax, 0
		jmp	locret_420BAA
; ---------------------------------------------------------------------------

loc_420ABD:				; CODE XREF: sub_420A89+28j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Buf1],	eax
		call	gcry_sexp_cadr
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Buf1],	eax
		call	gcry_sexp_release
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Buf2],	0
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Buf1],	eax
		call	gcry_sexp_nth_data
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_420B05
		mov	[ebp+var_C], 0
		jmp	loc_420B9C
; ---------------------------------------------------------------------------

loc_420B05:				; CODE XREF: sub_420A89+6Ej
		mov	eax, [ebp+var_1C]
		cmp	eax, 3
		jnz	short loc_420B35
		mov	[esp+38h+Size],	3 ; Size
		mov	[esp+38h+Buf2],	offset aRsa ; "rsa"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_420B35
		mov	[ebp+var_C], 1
		jmp	short loc_420B9C
; ---------------------------------------------------------------------------

loc_420B35:				; CODE XREF: sub_420A89+82j
					; sub_420A89+A1j
		mov	eax, [ebp+var_1C]
		cmp	eax, 3
		jnz	short loc_420B65
		mov	[esp+38h+Size],	3 ; Size
		mov	[esp+38h+Buf2],	offset aDsa ; "dsa"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_420B65
		mov	[ebp+var_C], 11h
		jmp	short loc_420B9C
; ---------------------------------------------------------------------------

loc_420B65:				; CODE XREF: sub_420A89+B2j
					; sub_420A89+D1j
		mov	eax, [ebp+var_1C]
		cmp	eax, 0Dh
		jnz	short loc_420B95
		mov	[esp+38h+Size],	0Dh ; Size
		mov	[esp+38h+Buf2],	offset aAmbiguousRsa ; "ambiguous-rsa"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_420B95
		mov	[ebp+var_C], 1
		jmp	short loc_420B9C
; ---------------------------------------------------------------------------

loc_420B95:				; CODE XREF: sub_420A89+E2j
					; sub_420A89+101j
		mov	[ebp+var_C], 0

loc_420B9C:				; CODE XREF: sub_420A89+77j
					; sub_420A89+AAj ...
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Buf1],	eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_C]

locret_420BAA:				; CODE XREF: sub_420A89+2Fj
		leave
		retn
sub_420A89	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_420BAC	proc near		; CODE XREF: sub_420043+3FAp
					; sub_420043+6C2p

C		= dword	ptr -78h
var_74		= byte ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_51		= byte ptr -51h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+C], eax
		call	ksba_cert_get_digest_algo
		mov	dword ptr [ebp+var_18],	eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+78h+C], eax
		call	gcry_md_map_name
		mov	dword ptr [ebp+var_1C],	eax
		cmp	dword ptr [ebp+var_1C],	0
		jnz	short loc_420C05
		cmp	dword ptr [ebp+var_18],	0
		jz	short loc_420BDF
		mov	eax, dword ptr [ebp+var_18]
		jmp	short loc_420BE4
; ---------------------------------------------------------------------------

loc_420BDF:				; CODE XREF: sub_420BAC+2Cj
		mov	eax, offset a?_4 ; "?"

loc_420BE4:				; CODE XREF: sub_420BAC+31j
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+C], offset aUnknownHashA_0 ; "unknown hash algorithm `%s'\n"
		call	sub_4233B1
		mov	[esp+78h+C], 1
		call	sub_41F813
		jmp	locret_4210D0
; ---------------------------------------------------------------------------

loc_420C05:				; CODE XREF: sub_420BAC+26j
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+78h+C], eax
		call	gcry_md_algo_name
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_420C41
; ---------------------------------------------------------------------------

loc_420C1C:				; CODE XREF: sub_420BAC+A5j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+78h+C], eax ; C
		mov	eax, ds:tolower
		call	eax ; tolower
		mov	edx, eax
		lea	eax, [ebp+var_51]
		add	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_420C41:				; CODE XREF: sub_420BAC+6Ej
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_420C53
		mov	eax, [ebp+var_C]
		cmp	eax, 0Fh
		jbe	short loc_420C1C

loc_420C53:				; CODE XREF: sub_420BAC+9Dj
		lea	eax, [ebp+var_51]
		add	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	[esp+78h+var_70], 0
		mov	eax, dword ptr [ebp+var_1C]
		mov	dword ptr [esp+78h+var_74], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+C], eax
		call	gcry_md_open
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_420CA2
		mov	eax, [ebp+var_20]
		mov	[esp+78h+C], eax
		call	gpg_strerror
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+C], offset aMd_openFailedS ; "md_open failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_20]
		jmp	locret_4210D0
; ---------------------------------------------------------------------------

loc_420CA2:				; CODE XREF: sub_420BAC+D1j
		mov	eax, ds:dword_435FA0
		and	eax, 200h
		test	eax, eax
		jz	short loc_420CC3
		mov	eax, [ebp+var_34]
		mov	dword ptr [esp+78h+var_74], offset aHash_cert_0	; "hash.cert"
		mov	[esp+78h+C], eax
		call	gcry_md_debug

loc_420CC3:				; CODE XREF: sub_420BAC+102j
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], offset gcry_md_write
		mov	dword ptr [esp+78h+var_74], 1
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+C], eax
		call	ksba_cert_hash
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_420D1C
		mov	eax, [ebp+var_20]
		mov	[esp+78h+C], eax
		call	gpg_strerror
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+C], offset aKsba_cert_hash ; "ksba_cert_hash failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_34]
		mov	[esp+78h+C], eax
		call	gcry_md_close
		mov	eax, [ebp+var_20]
		jmp	locret_4210D0
; ---------------------------------------------------------------------------

loc_420D1C:				; CODE XREF: sub_420BAC+140j
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 0
		mov	dword ptr [esp+78h+var_74], 5
		mov	[esp+78h+C], eax
		call	gcry_md_ctl
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+C], eax
		call	ksba_cert_get_sig_val
		mov	[ebp+var_24], eax
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 0
		mov	dword ptr [esp+78h+var_74], 0 ;	char
		mov	eax, [ebp+var_24]
		mov	[esp+78h+C], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_420DAC
		mov	[esp+78h+C], offset aLibksbaDidNotR ; "libksba did not return a	proper S-Exp\n"
		call	sub_4233B1
		mov	eax, [ebp+var_34]
		mov	[esp+78h+C], eax
		call	gcry_md_close
		mov	eax, [ebp+var_24]
		mov	[esp+78h+C], eax
		call	ksba_free
		mov	[esp+78h+C], 3Bh
		call	sub_41F813
		jmp	locret_4210D0
; ---------------------------------------------------------------------------

loc_420DAC:				; CODE XREF: sub_420BAC+1CBj
		mov	eax, ds:dword_435FA0
		and	eax, 4
		test	eax, eax
		jz	short loc_420E01
		mov	[esp+78h+C], offset aSignatureValue ; "signature value:"
		call	sub_42344E
		mov	[ebp+var_14], 0
		jmp	short loc_420DED
; ---------------------------------------------------------------------------

loc_420DCD:				; CODE XREF: sub_420BAC+247j
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+C], offset a02x_4 ; " %02X"
		call	sub_423478
		add	[ebp+var_14], 1

loc_420DED:				; CODE XREF: sub_420BAC+21Fj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_28]
		jb	short loc_420DCD
		mov	[esp+78h+C], offset asc_432A06 ; "\n"
		call	sub_423478

loc_420E01:				; CODE XREF: sub_420BAC+20Aj
		mov	eax, [ebp+var_28]
		mov	[esp+78h+var_6C], eax
		mov	eax, [ebp+var_24]
		mov	[esp+78h+var_70], eax
		mov	dword ptr [esp+78h+var_74], 0
		lea	eax, [ebp+var_38]
		mov	[esp+78h+C], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_24]
		mov	[esp+78h+C], eax
		call	ksba_free
		cmp	[ebp+var_20], 0
		jz	short loc_420E64
		mov	eax, [ebp+var_20]
		mov	[esp+78h+C], eax
		call	gpg_strerror
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+C], offset aGcry_sexp_scan ; "gcry_sexp_scan failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_34]
		mov	[esp+78h+C], eax
		call	gcry_md_close
		mov	eax, [ebp+var_20]
		jmp	locret_4210D0
; ---------------------------------------------------------------------------

loc_420E64:				; CODE XREF: sub_420BAC+288j
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+C], eax
		call	ksba_cert_get_public_key
		mov	[ebp+var_24], eax
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 0
		mov	dword ptr [esp+78h+var_74], 0 ;	char
		mov	eax, [ebp+var_24]
		mov	[esp+78h+C], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_420EDC
		mov	[esp+78h+C], offset aLibksbaDidNotR ; "libksba did not return a	proper S-Exp\n"
		call	sub_4233B1
		mov	eax, [ebp+var_34]
		mov	[esp+78h+C], eax
		call	gcry_md_close
		mov	eax, [ebp+var_24]
		mov	[esp+78h+C], eax
		call	ksba_free
		mov	eax, [ebp+var_38]
		mov	[esp+78h+C], eax
		call	gcry_sexp_release
		mov	[esp+78h+C], 3Bh
		call	sub_41F813
		jmp	locret_4210D0
; ---------------------------------------------------------------------------

loc_420EDC:				; CODE XREF: sub_420BAC+2F0j
		mov	eax, [ebp+var_28]
		mov	[esp+78h+var_6C], eax
		mov	eax, [ebp+var_24]
		mov	[esp+78h+var_70], eax
		mov	dword ptr [esp+78h+var_74], 0
		lea	eax, [ebp+var_40]
		mov	[esp+78h+C], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_24]
		mov	[esp+78h+C], eax
		call	ksba_free
		cmp	[ebp+var_20], 0
		jz	short loc_420F4A
		mov	eax, [ebp+var_20]
		mov	[esp+78h+C], eax
		call	gpg_strerror
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+C], offset aGcry_sexp_scan ; "gcry_sexp_scan failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+var_34]
		mov	[esp+78h+C], eax
		call	gcry_md_close
		mov	eax, [ebp+var_38]
		mov	[esp+78h+C], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_20]
		jmp	locret_4210D0
; ---------------------------------------------------------------------------

loc_420F4A:				; CODE XREF: sub_420BAC+363j
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+78h+C], eax
		call	gcry_md_get_algo_dlen
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_34]
		mov	edx, dword ptr [ebp+var_1C]
		mov	dword ptr [esp+78h+var_74], edx	; char
		mov	[esp+78h+C], eax
		call	gcry_md_read
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_40]
		mov	[esp+78h+C], eax
		call	sub_420A89
		cmp	eax, 11h
		jnz	loc_42100E
		cmp	[ebp+var_2C], 14h
		jz	short loc_420FC5
		mov	[esp+78h+C], offset aDsaRequiresThe ; "DSA requires the	use of a 160 bit hash "...
		call	sub_4233B1
		mov	eax, [ebp+var_34]
		mov	[esp+78h+C], eax
		call	gcry_md_close
		mov	eax, [ebp+var_38]
		mov	[esp+78h+C], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_40]
		mov	[esp+78h+C], eax
		call	gcry_sexp_release
		mov	[esp+78h+C], 3Fh
		call	sub_41F813
		jmp	locret_4210D0
; ---------------------------------------------------------------------------

loc_420FC5:				; CODE XREF: sub_420BAC+3D9j
		mov	eax, [ebp+var_30]
		mov	[esp+78h+var_68], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], offset aDataFlagsRawVa ; "(data(flags	raw)(value %b))"
		mov	dword ptr [esp+78h+var_74], 0
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+C], eax
		call	gcry_sexp_build
		test	eax, eax
		jz	short loc_42105E
		mov	[esp+78h+var_70], offset aCheck_cert_sig ; "check_cert_sig"
		mov	dword ptr [esp+78h+var_74], 3D6h
		mov	[esp+78h+C], offset a____Dirmngr_11 ; "../../dirmngr-1.1.1/src/validate.c"
		call	sub_423540
; ---------------------------------------------------------------------------

loc_42100E:				; CODE XREF: sub_420BAC+3CFj
		mov	eax, [ebp+var_30]
		mov	[esp+78h+var_64], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_51]
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], offset aDataFlagsPkc_1 ; "(data(flags	pkcs1)(hash %s %b))"
		mov	dword ptr [esp+78h+var_74], 0
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+C], eax
		call	gcry_sexp_build
		test	eax, eax
		jz	short loc_42105E
		mov	[esp+78h+var_70], offset aCheck_cert_sig ; "check_cert_sig"
		mov	dword ptr [esp+78h+var_74], 3DCh
		mov	[esp+78h+C], offset a____Dirmngr_11 ; "../../dirmngr-1.1.1/src/validate.c"
		call	sub_423540
; ---------------------------------------------------------------------------

loc_42105E:				; CODE XREF: sub_420BAC+444j
					; sub_420BAC+494j
		mov	ecx, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_38]
		mov	[esp+78h+var_70], ecx
		mov	dword ptr [esp+78h+var_74], edx
		mov	[esp+78h+C], eax
		call	gcry_pk_verify
		mov	[ebp+var_20], eax
		mov	eax, ds:dword_435FA0
		and	eax, 1
		test	al, al
		jz	short loc_4210A1
		mov	eax, [ebp+var_20]
		mov	[esp+78h+C], eax
		call	gpg_strerror
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+C], offset aGcry_pk_veri_0 ; "gcry_pk_verify: %s\n"
		call	sub_42344E

loc_4210A1:				; CODE XREF: sub_420BAC+4D8j
		mov	eax, [ebp+var_34]
		mov	[esp+78h+C], eax
		call	gcry_md_close
		mov	eax, [ebp+var_38]
		mov	[esp+78h+C], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+C], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_40]
		mov	[esp+78h+C], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_20]

locret_4210D0:				; CODE XREF: sub_420BAC+54j
					; sub_420BAC+F1j ...
		leave
		retn
sub_420BAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4210D2	proc near		; CODE XREF: sub_421414+14p
					; sub_42142F+14p ...

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
Str		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	ksba_cert_get_ext_key_usages
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str1],	eax
		call	sub_41F82E
		cmp	eax, 3Ah
		jnz	short loc_42110B
		mov	[ebp+var_C], 0

loc_42110B:				; CODE XREF: sub_4210D2+30j
		cmp	[ebp+var_C], 0
		jnz	loc_4212C8
		mov	[ebp+var_14], 0FFFFFFFFh
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	loc_421271
		mov	[ebp+var_1C], 0
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_28]
		mov	[ebp+var_18], eax
		jmp	loc_42122C
; ---------------------------------------------------------------------------

loc_421140:				; CODE XREF: sub_4210D2+17Aj
		mov	eax, [ebp+Str]
		mov	byte ptr [eax],	0
		add	[ebp+Str], 1
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 43h
		jnz	loc_4211EE
		mov	[ebp+var_1C], 1
		mov	[esp+38h+Str2],	offset a1_3_6_1_5_5__0 ; "1.3.6.1.5.5.7.3.1"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_42117C
		or	[ebp+var_14], 15h
		jmp	short loc_4211EE
; ---------------------------------------------------------------------------

loc_42117C:				; CODE XREF: sub_4210D2+A2j
		mov	[esp+38h+Str2],	offset a1_3_6_1_5_5__1 ; "1.3.6.1.5.5.7.3.2"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_421199
		or	[ebp+var_14], 11h
		jmp	short loc_4211EE
; ---------------------------------------------------------------------------

loc_421199:				; CODE XREF: sub_4210D2+BFj
		mov	[esp+38h+Str2],	offset a1_3_6_1_5_5__2 ; "1.3.6.1.5.5.7.3.3"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4211B6
		or	[ebp+var_14], 1
		jmp	short loc_4211EE
; ---------------------------------------------------------------------------

loc_4211B6:				; CODE XREF: sub_4210D2+DCj
		mov	[esp+38h+Str2],	offset a1_3_6_1_5_5__3 ; "1.3.6.1.5.5.7.3.4"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4211D3
		or	[ebp+var_14], 17h
		jmp	short loc_4211EE
; ---------------------------------------------------------------------------

loc_4211D3:				; CODE XREF: sub_4210D2+F9j
		mov	[esp+38h+Str2],	offset a1_3_6_1_5_5__4 ; "1.3.6.1.5.5.7.3.8"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4211EE
		or	[ebp+var_14], 3

loc_4211EE:				; CODE XREF: sub_4210D2+80j
					; sub_4210D2+A8j ...
		mov	[esp+38h+Str2],	offset a1_3_6_1_5_5__5 ; "1.3.6.1.5.5.7.3.9"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_42120C
		mov	[ebp+var_10], 1

loc_42120C:				; CODE XREF: sub_4210D2+131j
		mov	[esp+38h+Str2],	0Ah ; Val
		mov	eax, [ebp+Str]
		mov	[esp+38h+Str1],	eax ; Str
		call	strchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_42122C
		add	[ebp+var_18], 1

loc_42122C:				; CODE XREF: sub_4210D2+69j
					; sub_4210D2+154j
		cmp	[ebp+var_18], 0
		jz	short loc_421252
		mov	[esp+38h+Str2],	3Ah ; Val
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax ; Str
		call	strchr
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	loc_421140

loc_421252:				; CODE XREF: sub_4210D2+15Ej
		mov	eax, [ebp+var_28]
		mov	[esp+38h+Str1],	eax
		call	ksba_free
		mov	[ebp+var_28], 0
		cmp	[ebp+var_1C], 0
		jnz	short loc_421271
		mov	[ebp+var_14], 0FFFFFFFFh

loc_421271:				; CODE XREF: sub_4210D2+4Fj
					; sub_4210D2+196j
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Str2],	eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	ksba_cert_get_key_usage
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str1],	eax
		call	sub_41F82E
		cmp	eax, 3Ah
		jnz	short loc_4212BF
		mov	[ebp+var_C], 0
		mov	eax, ds:dword_435FA4
		test	eax, eax
		jz	short loc_4212B8
		cmp	[ebp+arg_4], 1
		jg	short loc_4212B8
		mov	[esp+38h+Str1],	offset aNoKeyUsageSpec ; "no key usage specified - assuming all	u"...
		call	sub_423387

loc_4212B8:				; CODE XREF: sub_4210D2+1D2j
					; sub_4210D2+1D8j
		mov	dword ptr [ebp+var_24],	0FFFFFFFFh

loc_4212BF:				; CODE XREF: sub_4210D2+1C2j
		mov	eax, dword ptr [ebp+var_24]
		and	eax, [ebp+var_14]
		mov	dword ptr [ebp+var_24],	eax

loc_4212C8:				; CODE XREF: sub_4210D2+3Dj
		cmp	[ebp+var_C], 0
		jz	short loc_4212FC
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str1],	eax
		call	gpg_strerror
		mov	[esp+38h+Str2],	eax ; char
		mov	[esp+38h+Str1],	offset aErrorGettingKe ; "error	getting	key usage information: %s"...
		call	sub_4233B1
		mov	eax, [ebp+var_28]
		mov	[esp+38h+Str1],	eax
		call	ksba_free
		mov	eax, [ebp+var_C]
		jmp	locret_421412
; ---------------------------------------------------------------------------

loc_4212FC:				; CODE XREF: sub_4210D2+1FAj
		cmp	[ebp+arg_4], 4
		jnz	short loc_421333
		mov	eax, dword ptr [ebp+var_24]
		and	eax, 20h
		test	eax, eax
		jz	short loc_421316
		mov	eax, 0
		jmp	locret_421412
; ---------------------------------------------------------------------------

loc_421316:				; CODE XREF: sub_4210D2+238j
		mov	[esp+38h+Str1],	offset aCertificateSho ; "certificate should have not been used	f"...
		call	sub_423387
		mov	[esp+38h+Str1],	7Dh
		call	sub_41F813
		jmp	locret_421412
; ---------------------------------------------------------------------------

loc_421333:				; CODE XREF: sub_4210D2+22Ej
		cmp	[ebp+arg_4], 5
		jnz	short loc_421378
		mov	eax, dword ptr [ebp+var_24]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_42135B
		cmp	[ebp+var_10], 0
		jnz	short loc_421351
		mov	eax, dword ptr [ebp+var_24]
		and	eax, 60h
		test	eax, eax
		jz	short loc_42135B

loc_421351:				; CODE XREF: sub_4210D2+273j
		mov	eax, 0
		jmp	locret_421412
; ---------------------------------------------------------------------------

loc_42135B:				; CODE XREF: sub_4210D2+26Dj
					; sub_4210D2+27Dj
		mov	[esp+38h+Str1],	offset aCertificateS_0 ; "certificate should have not been used	f"...
		call	sub_423387
		mov	[esp+38h+Str1],	7Dh
		call	sub_41F813
		jmp	locret_421412
; ---------------------------------------------------------------------------

loc_421378:				; CODE XREF: sub_4210D2+265j
		cmp	[ebp+arg_4], 6
		jnz	short loc_4213AC
		mov	eax, dword ptr [ebp+var_24]
		and	eax, 40h
		test	eax, eax
		jz	short loc_421392
		mov	eax, 0
		jmp	locret_421412
; ---------------------------------------------------------------------------

loc_421392:				; CODE XREF: sub_4210D2+2B4j
		mov	[esp+38h+Str1],	offset aCertificateS_1 ; "certificate should have not been used	f"...
		call	sub_423387
		mov	[esp+38h+Str1],	7Dh
		call	sub_41F813
		jmp	short locret_421412
; ---------------------------------------------------------------------------

loc_4213AC:				; CODE XREF: sub_4210D2+2AAj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		test	al, al
		jz	short loc_4213BD
		mov	eax, 0Ch
		jmp	short loc_4213C2
; ---------------------------------------------------------------------------

loc_4213BD:				; CODE XREF: sub_4210D2+2E2j
		mov	eax, 3

loc_4213C2:				; CODE XREF: sub_4210D2+2E9j
		mov	edx, dword ptr [ebp+var_24]
		and	eax, edx
		test	eax, eax
		jz	short loc_4213D2
		mov	eax, 0
		jmp	short locret_421412
; ---------------------------------------------------------------------------

loc_4213D2:				; CODE XREF: sub_4210D2+2F7j
		cmp	[ebp+arg_4], 3
		jz	short loc_4213F9
		cmp	[ebp+arg_4], 2
		jz	short loc_4213F2
		cmp	[ebp+arg_4], 1
		jnz	short loc_4213EB
		mov	eax, offset aCertificateIsN ; "certificate is not usable for encryptio"...
		jmp	short loc_4213F0
; ---------------------------------------------------------------------------

loc_4213EB:				; CODE XREF: sub_4210D2+310j
		mov	eax, offset aCertificateI_1 ; "certificate is not usable for signing\n"

loc_4213F0:				; CODE XREF: sub_4210D2+317j
		jmp	short loc_4213F7
; ---------------------------------------------------------------------------

loc_4213F2:				; CODE XREF: sub_4210D2+30Aj
		mov	eax, offset aCertificateS_2 ; "certificate should have not been	used f"...

loc_4213F7:				; CODE XREF: sub_4210D2:loc_4213F0j
		jmp	short loc_4213FE
; ---------------------------------------------------------------------------

loc_4213F9:				; CODE XREF: sub_4210D2+304j
		mov	eax, offset aCertificateS_3 ; "certificate should have not been	used f"...

loc_4213FE:				; CODE XREF: sub_4210D2:loc_4213F7j
		mov	[esp+38h+Str1],	eax ; char *
		call	sub_423387
		mov	[esp+38h+Str1],	7Dh
		call	sub_41F813

locret_421412:				; CODE XREF: sub_4210D2+225j
					; sub_4210D2+23Fj ...
		leave
		retn
sub_4210D2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421414	proc near		; CODE XREF: sub_420043+75Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], 4
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4210D2
		leave
		retn
sub_421414	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42142F	proc near		; CODE XREF: sub_420043+AFp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], 5
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4210D2
		leave
		retn
sub_42142F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42144A	proc near		; CODE XREF: sub_420043+BFp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], 6
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4210D2
		leave
		retn
sub_42144A	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421468	proc near		; CODE XREF: sub_42148F+14p
					; sub_421B43+156p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_421488
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_42148D
; ---------------------------------------------------------------------------

loc_421488:				; CODE XREF: sub_421468+7j
		mov	eax, 0

loc_42148D:				; CODE XREF: sub_421468+1Ej
		pop	ebp
		retn
sub_421468	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42148F	proc near		; CODE XREF: sub_4214AA+Ep
					; sub_4216D5+91p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0Ah
		call	sub_421468
		leave
		retn
sub_42148F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4214AA	proc near		; CODE XREF: sub_421577+ECp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_42148F
		leave
		retn
sub_4214AA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4214BF(int, char *)
sub_4214BF	proc near		; CODE XREF: sub_421577+100p
					; sub_421577+130p

Str		= dword	ptr -28h
Control		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4214EA
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	2222h
		mov	byte ptr [eax+2], 0
		add	[ebp+var_C], 2
		jmp	loc_421572
; ---------------------------------------------------------------------------

loc_4214EA:				; CODE XREF: sub_4214BF+14j
		mov	[esp+28h+Control], offset asc_432EDC ; " \t\n\v"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strpbrk
		test	eax, eax
		jz	short loc_42155D
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_421541
; ---------------------------------------------------------------------------

loc_421515:				; CODE XREF: sub_4214BF+8Aj
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_42153D
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_42153D:				; CODE XREF: sub_4214BF+6Dj
		add	[ebp+var_10], 1

loc_421541:				; CODE XREF: sub_4214BF+54j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421515
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		jmp	short loc_421572
; ---------------------------------------------------------------------------

loc_42155D:				; CODE XREF: sub_4214BF+40j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Control], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_4265EB
		mov	[ebp+var_C], eax

loc_421572:				; CODE XREF: sub_4214BF+26j
					; sub_4214BF+9Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4214BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_421577(char *, int, int)
sub_421577	proc near		; CODE XREF: sub_4216D5+5Dp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_4215D2
; ---------------------------------------------------------------------------

loc_4215C0:				; CODE XREF: sub_421577+63j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_4215CE
		add	[ebp+var_10], 1

loc_4215CE:				; CODE XREF: sub_421577+51j
		add	[ebp+var_14], 1

loc_4215D2:				; CODE XREF: sub_421577+47j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4215C0
		mov	[ebp+var_C], 0
		jmp	short loc_421631
; ---------------------------------------------------------------------------

loc_4215E5:				; CODE XREF: sub_421577+CCj
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_421623
; ---------------------------------------------------------------------------

loc_421611:				; CODE XREF: sub_421577+B4j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_42161F
		add	[ebp+var_10], 1

loc_42161F:				; CODE XREF: sub_421577+A2j
		add	[ebp+var_14], 1

loc_421623:				; CODE XREF: sub_421577+98j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421611
		add	[ebp+var_C], 1

loc_421631:				; CODE XREF: sub_421577+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4215E5
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_42166A
		call	sub_4214AA
		jmp	short loc_4216CF
; ---------------------------------------------------------------------------

loc_42166A:				; CODE XREF: sub_421577+EAj
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_4214BF
		mov	[ebp+var_18], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4216B3
; ---------------------------------------------------------------------------

loc_421688:				; CODE XREF: sub_421577+149j
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	20h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_4214BF
		mov	[ebp+var_18], eax
		add	[ebp+var_C], 1

loc_4216B3:				; CODE XREF: sub_421577+10Fj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_421688
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, 0

loc_4216CF:				; CODE XREF: sub_421577+F1j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_421577	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4216D5(LPCSTR	lpApplicationName, int,	int, int, int)
sub_4216D5	proc near		; CODE XREF: sub_4119CC+198p

hObject		= dword	ptr -0B8h
dwDesiredAccess	= dword	ptr -0B4h
dwShareMode	= dword	ptr -0B0h
lpSecurityAttributes= dword ptr	-0ACh
dwCreationDisposition= dword ptr -0A8h
dwFlagsAndAttributes= dword ptr	-0A4h
hTemplateFile	= dword	ptr -0A0h
lpCurrentDirectory= dword ptr -9Ch
lpStartupInfo	= dword	ptr -98h
lpProcessInformation= dword ptr	-94h
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
lpCommandLine	= dword	ptr -78h
StartupInfo	= _STARTUPINFOA	ptr -74h
ProcessInformation= _PROCESS_INFORMATION ptr -30h
SecurityAttributes= _SECURITY_ATTRIBUTES ptr -20h
dwCreationFlags	= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpApplicationName= dword ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	[ebp+ProcessInformation.hProcess], 0
		mov	[ebp+ProcessInformation.hThread], 0
		mov	[ebp+ProcessInformation.dwProcessId], 0
		mov	[ebp+ProcessInformation.dwThreadId], 0
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0FFFFFFFFh
		lea	eax, [ebp+lpCommandLine]
		mov	[esp+0B8h+dwShareMode],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+dwDesiredAccess], eax	; int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0B8h+hObject], eax	; char *
		call	sub_421577
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_421748
		mov	eax, [ebp+var_10]
		jmp	loc_421B3C
; ---------------------------------------------------------------------------

loc_421748:				; CODE XREF: sub_4216D5+69j
		mov	[esp+0B8h+dwDesiredAccess], 1
		lea	eax, [ebp+var_80]
		mov	[esp+0B8h+hObject], eax
		call	pth_pipe
		test	eax, eax
		jz	short loc_42179C
		mov	[esp+0B8h+hObject], 1
		call	sub_42148F
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+hObject], eax
		call	gpg_strerror
		mov	[esp+0B8h+dwDesiredAccess], eax	; char
		mov	[esp+0B8h+hObject], offset aErrorCreatingA ; "error creating a pipe: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+lpCommandLine]
		mov	[esp+0B8h+hObject], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		jmp	loc_421B3C
; ---------------------------------------------------------------------------

loc_42179C:				; CODE XREF: sub_4216D5+88j
		mov	[esp+0B8h+dwDesiredAccess], 1
		lea	eax, [ebp+var_88]
		mov	[esp+0B8h+hObject], eax
		call	pth_pipe
		test	eax, eax
		jz	short loc_421813
		mov	[esp+0B8h+hObject], 1
		call	sub_42148F
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+hObject], eax
		call	gpg_strerror
		mov	[esp+0B8h+dwDesiredAccess], eax	; char
		mov	[esp+0B8h+hObject], offset aErrorCreatingA ; "error creating a pipe: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+lpCommandLine]
		mov	[esp+0B8h+hObject], eax
		call	gcry_free
		mov	eax, [ebp+var_80]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_7C]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_10]
		jmp	loc_421B3C
; ---------------------------------------------------------------------------

loc_421813:				; CODE XREF: sub_4216D5+DFj
		lea	eax, [ebp+SecurityAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+SecurityAttributes.nLength], 0Ch
		mov	[ebp+SecurityAttributes.bInheritHandle], 1
		mov	[esp+0B8h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+0B8h+dwFlagsAndAttributes], 80h ; dwFlagsAndAttributes
		mov	[esp+0B8h+dwCreationDisposition], 3 ; dwCreationDisposition
		lea	eax, [ebp+SecurityAttributes]
		mov	[esp+0B8h+lpSecurityAttributes], eax ; lpSecurityAttributes
		mov	[esp+0B8h+dwShareMode],	3 ; dwShareMode
		mov	[esp+0B8h+dwDesiredAccess], 0C0000000h ; dwDesiredAccess
		mov	[esp+0B8h+hObject], offset FileName ; "nul"
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	loc_421908
		mov	[esp+0B8h+hObject], 1
		call	sub_42148F
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+hObject], eax
		call	gpg_strerror
		mov	[esp+0B8h+dwDesiredAccess], eax	; char
		mov	[esp+0B8h+hObject], offset aErrorOpeningNu ; "error opening nul: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+lpCommandLine]
		mov	[esp+0B8h+hObject], eax
		call	gcry_free
		mov	eax, [ebp+var_80]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_7C]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_88]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_84]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_10]
		jmp	loc_421B3C
; ---------------------------------------------------------------------------

loc_421908:				; CODE XREF: sub_4216D5+1AAj
		lea	eax, [ebp+SecurityAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+SecurityAttributes.nLength], 0Ch
		mov	[ebp+SecurityAttributes.bInheritHandle], 0
		lea	eax, [ebp+StartupInfo]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+StartupInfo.cb], 44h
		mov	[ebp+StartupInfo.dwFlags], 101h
		mov	[ebp+StartupInfo.wShowWindow], 6
		mov	eax, [ebp+var_C]
		mov	[ebp+StartupInfo.hStdInput], eax
		mov	eax, [ebp+var_7C]
		mov	[ebp+StartupInfo.hStdOutput], eax
		mov	eax, [ebp+var_84]
		mov	[ebp+StartupInfo.hStdError], eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+0B8h+hObject], eax	; hProcess
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, 4000004h
		mov	[ebp+dwCreationFlags], eax
		mov	eax, [ebp+lpCommandLine]
		mov	[esp+0B8h+dwShareMode],	eax
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0B8h+dwDesiredAccess], eax	; char
		mov	[esp+0B8h+hObject], offset aCreateprocessP ; "CreateProcess, path=`%s' cmdline=`%s'\n"
		call	sub_42344E
		mov	edx, [ebp+dwCreationFlags]
		mov	eax, [ebp+lpCommandLine]
		lea	ecx, [ebp+ProcessInformation]
		mov	[esp+0B8h+lpProcessInformation], ecx ; lpProcessInformation
		lea	ecx, [ebp+StartupInfo]
		mov	[esp+0B8h+lpStartupInfo], ecx ;	lpStartupInfo
		mov	[esp+0B8h+lpCurrentDirectory], 0 ; lpCurrentDirectory
		mov	[esp+0B8h+hTemplateFile], 0 ; lpEnvironment
		mov	[esp+0B8h+dwFlagsAndAttributes], edx ; dwCreationFlags
		mov	[esp+0B8h+dwCreationDisposition], 1 ; bInheritHandles
		lea	edx, [ebp+SecurityAttributes]
		mov	[esp+0B8h+lpSecurityAttributes], edx ; lpThreadAttributes
		lea	edx, [ebp+SecurityAttributes]
		mov	[esp+0B8h+dwShareMode],	edx ; lpProcessAttributes
		mov	[esp+0B8h+dwDesiredAccess], eax	; lpCommandLine
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0B8h+hObject], eax	; lpApplicationName
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	loc_421A89
		mov	[esp+0B8h+hObject], 0FFFFFFFFh ; DWORD
		call	sub_426248
		mov	[esp+0B8h+dwDesiredAccess], eax	; char
		mov	[esp+0B8h+hObject], offset aCreateprocessF ; "CreateProcess failed: %s\n"
		call	sub_4233B1
		mov	eax, [ebp+lpCommandLine]
		mov	[esp+0B8h+hObject], eax
		call	gcry_free
		mov	eax, [ebp+var_80]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_7C]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_88]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_84]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	[esp+0B8h+hObject], 1
		call	sub_42148F
		jmp	loc_421B3C
; ---------------------------------------------------------------------------

loc_421A89:				; CODE XREF: sub_4216D5+320j
		mov	eax, [ebp+lpCommandLine]
		mov	[esp+0B8h+hObject], eax
		call	gcry_free
		mov	[ebp+lpCommandLine], 0
		mov	eax, [ebp+var_7C]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_84]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.dwThreadId]
		mov	ebx, eax
		mov	eax, [ebp+ProcessInformation.dwProcessId]
		mov	ecx, eax
		mov	edx, [ebp+ProcessInformation.hThread]
		mov	eax, [ebp+ProcessInformation.hProcess]
		mov	[esp+0B8h+dwCreationDisposition], ebx
		mov	[esp+0B8h+lpSecurityAttributes], ecx
		mov	[esp+0B8h+dwShareMode],	edx
		mov	[esp+0B8h+dwDesiredAccess], eax	; char
		mov	[esp+0B8h+hObject], offset aCreateprocessR ; "CreateProcess ready: hProcess=%p hThrea"...
		call	sub_42344E
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0B8h+hObject], eax	; hThread
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0B8h+hObject], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	edx, [ebp+var_80]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	edx, [ebp+var_88]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+ProcessInformation.hProcess]
		mov	edx, eax
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, 0

loc_421B3C:				; CODE XREF: sub_4216D5+6Ej
					; sub_4216D5+C2j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4216D5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421B43	proc near		; CODE XREF: sub_411148+1E7p

hHandle		= dword	ptr -28h
dwMilliseconds	= dword	ptr -24h
var_20		= dword	ptr -20h
ExitCode	= dword	ptr -18h
var_14		= byte ptr -14h
hProcess	= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+hProcess],	eax
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0FFFFFFFFh
		cmp	dword ptr [ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_421B6F
		mov	[esp+28h+hHandle], 37h
		call	sub_42148F
		jmp	locret_421C9E
; ---------------------------------------------------------------------------

loc_421B6F:				; CODE XREF: sub_421B43+19j
		cmp	[ebp+arg_4], 0
		jz	short loc_421B7C
		mov	eax, 0FFFFFFFFh
		jmp	short loc_421B81
; ---------------------------------------------------------------------------

loc_421B7C:				; CODE XREF: sub_421B43+30j
		mov	eax, 0

loc_421B81:				; CODE XREF: sub_421B43+37j
		mov	[esp+28h+dwMilliseconds], eax ;	dwMilliseconds
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	dword ptr [ebp+var_14],	eax
		mov	eax, dword ptr [ebp+var_14]
		test	eax, eax
		jz	short loc_421BEB
		cmp	eax, 102h
		jz	short loc_421BB0
		cmp	eax, 0FFFFFFFFh
		jz	short loc_421BBC
		jmp	loc_421C69
; ---------------------------------------------------------------------------

loc_421BB0:				; CODE XREF: sub_421B43+61j
		mov	[ebp+var_C], 3Eh
		jmp	loc_421C8B
; ---------------------------------------------------------------------------

loc_421BBC:				; CODE XREF: sub_421B43+66j
		mov	[esp+28h+hHandle], 0FFFFFFFFh ;	DWORD
		call	sub_426248
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+dwMilliseconds], eax ;	char
		mov	[esp+28h+hHandle], offset aWaitingForProc ; "waiting for process %d to terminate fai"...
		call	sub_4233B1
		mov	[ebp+var_C], 0
		jmp	loc_421C8B
; ---------------------------------------------------------------------------

loc_421BEB:				; CODE XREF: sub_421B43+5Aj
		lea	eax, [ebp+ExitCode]
		mov	[esp+28h+dwMilliseconds], eax ;	lpExitCode
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hProcess
		mov	eax, ds:GetExitCodeProcess
		call	eax ; GetExitCodeProcess
		sub	esp, 8
		test	eax, eax
		jnz	short loc_421C32
		mov	[esp+28h+hHandle], 0FFFFFFFFh ;	DWORD
		call	sub_426248
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+dwMilliseconds], eax ;	char
		mov	[esp+28h+hHandle], offset aErrorGettingEx ; "error getting exit	code of	process	%d: "...
		call	sub_4233B1
		mov	[ebp+var_C], 1
		jmp	short loc_421C8B
; ---------------------------------------------------------------------------

loc_421C32:				; CODE XREF: sub_421B43+C1j
		mov	eax, [ebp+ExitCode]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+ExitCode]
		test	eax, eax
		jz	short loc_421C60
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+28h+var_20], offset byte_433007
		mov	[esp+28h+dwMilliseconds], eax ;	char
		mov	[esp+28h+hHandle], offset aErrorDetectedE ; "error detected: exit status %d%s\n"
		call	sub_4233B1

loc_421C60:				; CODE XREF: sub_421B43+FEj
		mov	[ebp+var_C], 0
		jmp	short loc_421C8B
; ---------------------------------------------------------------------------

loc_421C69:				; CODE XREF: sub_421B43+68j
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+28h+dwMilliseconds], eax ;	char
		mov	[esp+28h+hHandle], offset aWaitforsingleo ; "WaitForSingleObject returned unexpected"...
		call	sub_4233B1
		mov	[ebp+var_C], 1
		nop

loc_421C8B:				; CODE XREF: sub_421B43+74j
					; sub_421B43+A3j ...
		mov	eax, [ebp+var_C]
		mov	[esp+28h+dwMilliseconds], eax
		mov	[esp+28h+hHandle], 0Ah
		call	sub_421468

locret_421C9E:				; CODE XREF: sub_421B43+27j
		leave
		retn
sub_421B43	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421CA0	proc near		; CODE XREF: sub_410D75+1Ap
					; sub_411148+2ACp ...
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_421CA0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_421CAA(HANDLE)
sub_421CAA	proc near		; CODE XREF: sub_410D75+28p
					; sub_411148+22Ep

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		leave
		retn
sub_421CAA	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_421CC8(LPCSTR)
sub_421CC8	proc near		; CODE XREF: sub_42223E+42p

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_421CC8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_421CE6(HMODULE, LPCSTR)
sub_421CE6	proc near		; CODE XREF: sub_42223E+5Ep

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_421D24
		cmp	[ebp+arg_4], 0
		jz	short loc_421D24
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_421D1F
		mov	eax, 0
		jmp	short locret_421D29
; ---------------------------------------------------------------------------

loc_421D1F:				; CODE XREF: sub_421CE6+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_421D29
; ---------------------------------------------------------------------------

loc_421D24:				; CODE XREF: sub_421CE6+Aj
					; sub_421CE6+10j
		mov	eax, 0

locret_421D29:				; CODE XREF: sub_421CE6+37j
					; sub_421CE6+3Cj
		leave
		retn
sub_421CE6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_421D2B(HMODULE)
sub_421D2B	proc near		; CODE XREF: sub_42223E+77p

hLibModule	= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_421D4E
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hLibModule], eax ; hLibModule
		mov	eax, ds:FreeLibrary
		call	eax ; FreeLibrary
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_421D53
; ---------------------------------------------------------------------------

loc_421D4E:				; CODE XREF: sub_421D2B+Aj
		mov	eax, 0FFFFFFFFh

locret_421D53:				; CODE XREF: sub_421D2B+21j
		leave
		retn
sub_421D2B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_421D55(int, LPCSTR, LPCSTR lpValueName)
sub_421D55	proc near		; CODE XREF: sub_4224DB+59p

hKey		= dword	ptr -58h
lpSubKey	= dword	ptr -54h
ulOptions	= dword	ptr -50h
samDesired	= dword	ptr -4Ch
phkResult	= dword	ptr -48h
lpcbData	= dword	ptr -44h
var_2C		= dword	ptr -2Ch
Type		= dword	ptr -24h
cbData		= dword	ptr -20h
Size		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpDst		= dword	ptr -14h
lpData		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpValueName	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 50h
		mov	[ebp+lpData], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_421D76
		mov	[ebp+var_C], 80000001h
		jmp	loc_421EAF
; ---------------------------------------------------------------------------

loc_421D76:				; CODE XREF: sub_421D55+13j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_classes_r ; "HKEY_CLASSES_ROOT"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_421DAA
		mov	[ebp+var_C], 80000000h
		jmp	loc_421EAF
; ---------------------------------------------------------------------------

loc_421DAA:				; CODE XREF: sub_421D55+47j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_421DDE
		mov	[ebp+var_C], 80000001h
		jmp	loc_421EAF
; ---------------------------------------------------------------------------

loc_421DDE:				; CODE XREF: sub_421D55+7Bj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_421E12
		mov	[ebp+var_C], 80000002h
		jmp	loc_421EAF
; ---------------------------------------------------------------------------

loc_421E12:				; CODE XREF: sub_421D55+AFj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_users	; "HKEY_USERS"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_421E43
		mov	[ebp+var_C], 80000003h
		jmp	short loc_421EAF
; ---------------------------------------------------------------------------

loc_421E43:				; CODE XREF: sub_421D55+E3j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		mov	ecx, 16h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_421E74
		mov	[ebp+var_C], 80000004h
		jmp	short loc_421EAF
; ---------------------------------------------------------------------------

loc_421E74:				; CODE XREF: sub_421D55+114j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_421EA5
		mov	[ebp+var_C], 80000005h
		jmp	short loc_421EAF
; ---------------------------------------------------------------------------

loc_421EA5:				; CODE XREF: sub_421D55+145j
		mov	eax, 0
		jmp	loc_422237
; ---------------------------------------------------------------------------

loc_421EAF:				; CODE XREF: sub_421D55+1Cj
					; sub_421D55+50j ...
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	eax, [ebp+var_C]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_421F2E
		cmp	[ebp+arg_0], 0
		jz	short loc_421EF1
		mov	eax, 0
		jmp	loc_422237
; ---------------------------------------------------------------------------

loc_421EF1:				; CODE XREF: sub_421D55+190j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_421F2E
		mov	eax, 0
		jmp	loc_422237
; ---------------------------------------------------------------------------

loc_421F2E:				; CODE XREF: sub_421D55+18Aj
					; sub_421D55+1CDj
		mov	[ebp+cbData], 1
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	loc_422008
		cmp	[ebp+arg_0], 0
		jnz	loc_422217
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_421FCA
		mov	eax, 0
		jmp	loc_422237
; ---------------------------------------------------------------------------

loc_421FCA:				; CODE XREF: sub_421D55+269j
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jnz	loc_42221A

loc_422008:				; CODE XREF: sub_421D55+218j
		mov	eax, [ebp+cbData]
		add	eax, 1
		mov	[ebp+Size], eax
		mov	eax, [ebp+Size]
		mov	[esp+58h+hKey],	eax ; Size
		call	malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jz	loc_42221D
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+Size]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	edx, [ebp+lpData]
		mov	[esp+58h+phkResult], edx ; lpData
		lea	edx, [ebp+Type]
		mov	[esp+58h+samDesired], edx ; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	short loc_422078
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		mov	[ebp+lpData], 0
		jmp	loc_422224
; ---------------------------------------------------------------------------

loc_422078:				; CODE XREF: sub_421D55+30Aj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpData]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Type]
		cmp	eax, 2
		jnz	loc_422224
		mov	[esp+58h+lpSubKey], 25h	; Val
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_422224
		mov	eax, [ebp+Size]
		add	eax, 3E8h
		mov	[ebp+Size], eax
		mov	eax, [ebp+Size]
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; Size
		call	malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_422220
		mov	eax, [ebp+Size]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	loc_422195
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+Size]
		cmp	edx, eax
		jbe	loc_422195
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		mov	eax, [ebp+cbData]
		mov	[ebp+Size], eax
		mov	eax, [ebp+Size]
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; Size
		call	malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_422223
		mov	eax, [ebp+Size]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_422176
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+Size]
		cmp	edx, eax
		jbe	short loc_422176
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		jmp	loc_422224
; ---------------------------------------------------------------------------

loc_422176:				; CODE XREF: sub_421D55+405j
					; sub_421D55+40Fj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	loc_422224
; ---------------------------------------------------------------------------

loc_422195:				; CODE XREF: sub_421D55+39Fj
					; sub_421D55+3ADj
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_42220A
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		mov	eax, [ebp+lpDst]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; Size
		call	malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jnz	short loc_4221EB
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	short loc_422224
; ---------------------------------------------------------------------------

loc_4221EB:				; CODE XREF: sub_421D55+48Cj
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; Source
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		jmp	short loc_422224
; ---------------------------------------------------------------------------

loc_42220A:				; CODE XREF: sub_421D55+445j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; Memory
		call	free
		jmp	short loc_422224
; ---------------------------------------------------------------------------

loc_422217:				; CODE XREF: sub_421D55+222j
		nop
		jmp	short loc_422224
; ---------------------------------------------------------------------------

loc_42221A:				; CODE XREF: sub_421D55+2ADj
		nop
		jmp	short loc_422224
; ---------------------------------------------------------------------------

loc_42221D:				; CODE XREF: sub_421D55+2CEj
		nop
		jmp	short loc_422224
; ---------------------------------------------------------------------------

loc_422220:				; CODE XREF: sub_421D55+373j
		nop
		jmp	short loc_422224
; ---------------------------------------------------------------------------

loc_422223:				; CODE XREF: sub_421D55+3D9j
		nop

loc_422224:				; CODE XREF: sub_421D55+31Ej
					; sub_421D55+332j ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		mov	eax, [ebp+lpData]

loc_422237:				; CODE XREF: sub_421D55+155j
					; sub_421D55+197j ...
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_421D55	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42223E	proc near		; CODE XREF: sub_4223D7+41p
					; sub_422661+41p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_435958
		test	eax, eax
		jnz	loc_4222D9
		mov	ds:dword_435958, 1
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_4222C5
; ---------------------------------------------------------------------------

loc_42226B:				; CODE XREF: sub_42223E+99j
		mov	eax, [ebp+var_10]
		mov	eax, off_42B59C[eax*4]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax ;	LPCSTR
		call	sub_421CC8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4222C1
		mov	[esp+38h+var_34], offset aShgetfolderpat ; "SHGetFolderPathA"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_421CE6
		mov	ds:dword_43595C, eax
		mov	eax, ds:dword_43595C
		test	eax, eax
		jnz	short loc_4222C1
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_421D2B
		mov	[ebp+var_C], 0

loc_4222C1:				; CODE XREF: sub_42223E+4Ej
					; sub_42223E+6Fj
		add	[ebp+var_10], 1

loc_4222C5:				; CODE XREF: sub_42223E+2Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_4222D9
		mov	eax, [ebp+var_10]
		mov	eax, off_42B59C[eax*4]
		test	eax, eax
		jnz	short loc_42226B

loc_4222D9:				; CODE XREF: sub_42223E+Dj
					; sub_42223E+8Bj
		mov	eax, ds:dword_43595C
		test	eax, eax
		jz	short loc_422311
		mov	edx, ds:dword_43595C
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx ; dword_43595C
		sub	esp, 14h
		jmp	short locret_422316
; ---------------------------------------------------------------------------

loc_422311:				; CODE XREF: sub_42223E+A2j
		mov	eax, 0FFFFFFFFh

locret_422316:				; CODE XREF: sub_42223E+D1j
		leave
		retn
sub_42223E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422318	proc near		; CODE XREF: sub_4119CC:loc_4119F0p

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_435954
		test	eax, eax
		jnz	loc_4223B8
		call	sub_4227D4
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aDirmngr_ldap_e ; "\\dirmngr_ldap.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	ds:dword_435954, eax
		mov	eax, ds:dword_435954
		test	eax, eax
		jz	short loc_4223B8
		mov	eax, ds:dword_435954
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Size],	eax
		call	sub_4265EB
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy

loc_4223B8:				; CODE XREF: sub_422318+Fj
					; sub_422318+7Bj
		mov	eax, ds:dword_435954
		test	eax, eax
		jnz	short loc_4223CB
		mov	ds:dword_435954, offset	aHomeIntevation	; "/home/intevation/gpg4win/src/playground"...

loc_4223CB:				; CODE XREF: sub_422318+A7j
		mov	eax, ds:dword_435954
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_422318	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4223D7	proc near		; CODE XREF: sub_4224DB+9Ap

lpPathName	= dword	ptr -148h
lpSecurityAttributes= dword ptr	-144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_110		= byte ptr -110h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:lpPathName
		test	eax, eax
		jnz	loc_4224CF
		lea	eax, [ebp+var_110]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], 801Ah
		mov	[esp+148h+lpPathName], 0
		call	sub_42223E
		test	eax, eax
		js	loc_4224C5
		lea	eax, [ebp+var_110]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 7
		mov	[esp+148h+lpPathName], eax
		call	gcry_xmalloc
		mov	[ebp+var_C], eax
		mov	ebx, offset aGnupg ; "\\gnupg"
		lea	eax, [ebp+var_110]
		mov	[esp+148h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_C]
		mov	[esp+148h+lpPathName], eax
		call	sub_4265EB
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, word ptr [ebx+4]
		mov	[eax+4], dx
		movzx	edx, byte ptr [ebx+6]
		mov	[eax+6], dl
		mov	eax, [ebp+var_C]
		mov	ds:lpPathName, eax
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0
		mov	[esp+148h+lpPathName], eax
		call	_access
		test	eax, eax
		jz	short loc_4224CF
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+148h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		jmp	short loc_4224CF
; ---------------------------------------------------------------------------

loc_4224C5:				; CODE XREF: sub_4223D7+48j
		mov	ds:lpPathName, offset aCGnupg ;	"c:/gnupg"

loc_4224CF:				; CODE XREF: sub_4223D7+12j
					; sub_4223D7+D0j ...
		mov	eax, ds:lpPathName
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4223D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4224DB	proc near		; CODE XREF: sub_4020C2:loc_4023BFp

VarName		= dword	ptr -28h
var_24		= dword	ptr -24h
lpValueName	= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+VarName], offset aGnupghome ; "GNUPGHOME"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_422504
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_422587

loc_422504:				; CODE XREF: sub_4224DB+19j
		mov	eax, ds:dword_43594C
		test	eax, eax
		jnz	short loc_42257F
		cmp	[ebp+var_C], 0
		jz	short loc_42251D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42256C

loc_42251D:				; CODE XREF: sub_4224DB+36j
		mov	[esp+28h+lpValueName], offset ValueName	; "HomeDir"
		mov	[esp+28h+var_24], offset aSoftwareGnuGnu ; "Software\\GNU\\GnuPG"
		mov	[esp+28h+VarName], 0 ; int
		call	sub_421D55
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42255E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42255E
		mov	eax, [ebp+var_10]
		mov	[esp+28h+VarName], eax
		call	gcry_free
		mov	[ebp+var_10], 0

loc_42255E:				; CODE XREF: sub_4224DB+65j
					; sub_4224DB+6Fj
		cmp	[ebp+var_10], 0
		jz	short loc_42256C
		mov	eax, [ebp+var_10]
		mov	ds:dword_43594C, eax

loc_42256C:				; CODE XREF: sub_4224DB+40j
					; sub_4224DB+87j
		mov	eax, ds:dword_43594C
		test	eax, eax
		jnz	short loc_42257F
		call	sub_4223D7
		mov	ds:dword_43594C, eax

loc_42257F:				; CODE XREF: sub_4224DB+30j
					; sub_4224DB+98j
		mov	eax, ds:dword_43594C
		mov	[ebp+var_C], eax

loc_422587:				; CODE XREF: sub_4224DB+23j
		cmp	[ebp+var_C], 0
		jz	short loc_422597
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42259E

loc_422597:				; CODE XREF: sub_4224DB+B0j
		mov	[ebp+var_C], offset aCGnupg ; "c:/gnupg"

loc_42259E:				; CODE XREF: sub_4224DB+BAj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4224DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4225A3	proc near		; CODE XREF: sub_422661:loc_422710p
					; sub_4227D4+6p

hModule		= dword	ptr -28h
lpFilename	= dword	ptr -24h
nSize		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_435834
		test	eax, eax
		jnz	loc_422648
		mov	[esp+28h+nSize], 104h ;	nSize
		mov	[esp+28h+lpFilename], offset byte_435840 ; lpFilename
		mov	[esp+28h+hModule], 0 ; hModule
		mov	eax, ds:GetModuleFileNameA
		call	eax ; GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_4225FE
		mov	[esp+28h+hModule], 0 ; DWORD
		call	sub_426248
		mov	[esp+28h+lpFilename], eax ; char
		mov	[esp+28h+hModule], offset aGetmodulefilen ; "GetModuleFileName failed: %s\n"
		call	sub_42344E
		mov	ds:byte_435840,	0

loc_4225FE:				; CODE XREF: sub_4225A3+36j
		mov	ds:dword_435834, 1
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset byte_435840 ;	Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42262D
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		jmp	short loc_422648
; ---------------------------------------------------------------------------

loc_42262D:				; CODE XREF: sub_4225A3+80j
		mov	[esp+28h+lpFilename], offset byte_435840 ; char
		mov	[esp+28h+hModule], offset aBadFilenameSRe ; "bad filename `%s' returned for this pro"...
		call	sub_42344E
		mov	ds:byte_435840,	0

loc_422648:				; CODE XREF: sub_4225A3+Dj
					; sub_4225A3+88j
		movzx	eax, ds:byte_435840
		test	al, al
		jz	short loc_42265A
		mov	eax, offset byte_435840
		jmp	short locret_42265F
; ---------------------------------------------------------------------------

loc_42265A:				; CODE XREF: sub_4225A3+AEj
		mov	eax, offset aHomeIntevati_0 ; "/home/intevation/gpg4win/src/playground"...

locret_42265F:				; CODE XREF: sub_4225A3+B5j
		leave
		retn
sub_4225A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422661	proc near		; CODE XREF: sub_422731+15p
					; sub_4227E1+15p

var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_110		= byte ptr -110h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_435830
		test	eax, eax
		jnz	loc_422722
		lea	eax, [ebp+var_110]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+var_144], 23h
		mov	[esp+148h+var_148], 0
		call	sub_42223E
		test	eax, eax
		js	short loc_422710
		lea	eax, [ebp+var_110]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+148h+var_148], eax
		call	gcry_xmalloc
		mov	[ebp+var_C], eax
		mov	ebx, offset aGnu ; "\\GNU"
		lea	eax, [ebp+var_110]
		mov	[esp+148h+var_144], eax
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_148], eax
		call	sub_4265EB
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_C]
		mov	ds:dword_435830, eax
		jmp	short loc_422722
; ---------------------------------------------------------------------------

loc_422710:				; CODE XREF: sub_422661+48j
		call	sub_4225A3
		mov	[esp+148h+var_148], eax
		call	gcry_xstrdup
		mov	ds:dword_435830, eax

loc_422722:				; CODE XREF: sub_422661+12j
					; sub_422661+ADj
		mov	eax, ds:dword_435830
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_422661	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422731	proc near		; CODE XREF: sub_4020C2+469p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_43582C
		test	eax, eax
		jnz	loc_4227C8
		call	sub_422661
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aEtcDirmngr ; "\\etc\\dirmngr"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_43582C, eax
		mov	eax, ds:dword_43582C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_4265EB
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_4227C8:				; CODE XREF: sub_422731+Fj
		mov	eax, ds:dword_43582C
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_422731	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4227D4	proc near		; CODE XREF: sub_422318+15p
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_4225A3
		leave
		retn
sub_4227D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4227E1	proc near		; CODE XREF: sub_4020C2+473p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_435828
		test	eax, eax
		jnz	loc_422878
		call	sub_422661
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aLibDirmngr ; "\\lib\\dirmngr"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_435828, eax
		mov	eax, ds:dword_435828
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_4265EB
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_422878:				; CODE XREF: sub_4227E1+Fj
		mov	eax, ds:dword_435828
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4227E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422884	proc near		; CODE XREF: sub_4020C2+47Dp

lpPathName	= dword	ptr -168h
lpSecurityAttributes= dword ptr	-164h
var_160		= dword	ptr -160h
var_15C		= dword	ptr -15Ch
var_158		= dword	ptr -158h
var_13C		= dword	ptr -13Ch
var_12C		= byte ptr -12Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 164h
		mov	eax, ds:dword_435824
		test	eax, eax
		jnz	loc_422A09
		mov	[ebp+var_28], offset aGnu_0 ; "GNU"
		mov	[ebp+var_24], offset aCache ; "cache"
		mov	[ebp+var_20], offset aDirmngr_1	; "dirmngr"
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		jmp	short loc_4228FC
; ---------------------------------------------------------------------------

loc_4228C6:				; CODE XREF: sub_422884+7Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_13C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_13C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_C]
		add	eax, edx
		add	eax, 1
		mov	[ebp+var_C], eax
		add	[ebp+var_10], 4

loc_4228FC:				; CODE XREF: sub_422884+40j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4228C6
		lea	eax, [ebp+var_12C]
		mov	[esp+168h+var_158], eax
		mov	[esp+168h+var_15C], 0
		mov	[esp+168h+var_160], 0
		mov	[esp+168h+lpSecurityAttributes], 801Ch
		mov	[esp+168h+lpPathName], 0
		call	sub_42223E
		test	eax, eax
		js	loc_4229FF
		lea	eax, [ebp+var_12C]
		mov	[ebp+var_13C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_13C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_C]
		add	eax, edx
		add	eax, 1
		mov	[esp+168h+lpPathName], eax
		call	gcry_xmalloc
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_12C]
		mov	[esp+168h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_18]
		mov	[esp+168h+lpPathName], eax
		call	sub_4265EB
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		jmp	short loc_4229EC
; ---------------------------------------------------------------------------

loc_422996:				; CODE XREF: sub_422884+16Fj
		mov	eax, [ebp+var_14]
		mov	word ptr [eax],	5Ch
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+168h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_14]
		mov	[esp+168h+lpPathName], eax
		call	sub_4265EB
		mov	[ebp+var_14], eax
		mov	[esp+168h+lpSecurityAttributes], 0
		mov	eax, [ebp+var_18]
		mov	[esp+168h+lpPathName], eax
		call	_access
		test	eax, eax
		jz	short loc_4229E8
		mov	[esp+168h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	eax, [ebp+var_18]
		mov	[esp+168h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8

loc_4229E8:				; CODE XREF: sub_422884+14Aj
		add	[ebp+var_10], 4

loc_4229EC:				; CODE XREF: sub_422884+110j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_422996
		mov	eax, [ebp+var_18]
		mov	ds:dword_435824, eax
		jmp	short loc_422A09
; ---------------------------------------------------------------------------

loc_4229FF:				; CODE XREF: sub_422884+B1j
		mov	ds:dword_435824, offset	aCTempCacheDirm	; "c:\\temp\\cache\\dirmngr"

loc_422A09:				; CODE XREF: sub_422884+11j
					; sub_422884+179j
		mov	eax, ds:dword_435824
		mov	edi, [ebp+var_4]
		leave
		retn
sub_422884	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422A13	proc near		; CODE XREF: sub_4020C2+32Fp

Dest		= dword	ptr -148h
Source		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_110		= byte ptr -110h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_435820
		test	eax, eax
		jnz	loc_422B0D
		lea	eax, [ebp+var_110]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+Source], 24h
		mov	[esp+148h+Dest], 0
		call	sub_42223E
		test	eax, eax
		jns	short loc_422A81
		mov	edx, offset aCWindows ;	"C:\\WINDOWS"
		lea	eax, [ebp+var_110]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	ecx, word ptr [edx+8]
		mov	[eax+8], cx
		movzx	edx, byte ptr [edx+0Ah]
		mov	[eax+0Ah], dl

loc_422A81:				; CODE XREF: sub_422A13+48j
		mov	[ebp+var_C], offset aS_dirmngr ; "\\S.dirmngr"
		lea	eax, [ebp+var_110]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_C]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+148h+Dest], eax
		call	gcry_xmalloc
		mov	ds:dword_435820, eax
		mov	eax, ds:dword_435820
		lea	edx, [ebp+var_110]
		mov	[esp+148h+Source], edx
		mov	[esp+148h+Dest], eax
		call	sub_4265EB
		mov	edx, [ebp+var_C]
		mov	[esp+148h+Source], edx ; Source
		mov	[esp+148h+Dest], eax ; Dest
		call	strcpy

loc_422B0D:				; CODE XREF: sub_422A13+12j
		mov	eax, ds:dword_435820
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_422A13	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422B1C	proc near		; CODE XREF: sub_4020C2+8EFp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_4359EC
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_422B3A
		mov	ds:dword_4359EC, 0

loc_422B3A:				; CODE XREF: sub_422B1C+12j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_422B1C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4359EC
		add	eax, 1
		mov	ds:dword_4359EC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_422B51(char *Filename, int FileHandle)
sub_422B51	proc near		; CODE XREF: sub_422DEE+21p
					; .text:00422E2Ap

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		cmp	[ebp+Filename],	0
		jz	short loc_422BA1
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_433298 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_422BA1
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_422BA1:				; CODE XREF: sub_422B51+Cj
					; sub_422B51+34j
		cmp	[ebp+Filename],	0
		jz	short loc_422BF7
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_422BE3
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_422BE3
		mov	eax, 1
		jmp	short loc_422BE8
; ---------------------------------------------------------------------------

loc_422BE3:				; CODE XREF: sub_422B51+7Cj
					; sub_422B51+89j
		mov	eax, 0

loc_422BE8:				; CODE XREF: sub_422B51+90j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_422BFE
		add	[ebp+Filename],	9
		jmp	short loc_422BFE
; ---------------------------------------------------------------------------

loc_422BF7:				; CODE XREF: sub_422B51+54j
		mov	[ebp+var_10], 0

loc_422BFE:				; CODE XREF: sub_422B51+9Ej
					; sub_422B51+A4j
		cmp	[ebp+var_10], 0
		jz	short loc_422C3A
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_422C95
; ---------------------------------------------------------------------------

loc_422C3A:				; CODE XREF: sub_422B51+B1j
		cmp	[ebp+Filename],	0
		jz	short loc_422C59
		mov	eax, offset aA	; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_422C95
; ---------------------------------------------------------------------------

loc_422C59:				; CODE XREF: sub_422B51+EDj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_422C6C
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_422C95
; ---------------------------------------------------------------------------

loc_422C6C:				; CODE XREF: sub_422B51+10Cj
		cmp	[ebp+FileHandle], 2
		jnz	short loc_422C7F
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_422C95
; ---------------------------------------------------------------------------

loc_422C7F:				; CODE XREF: sub_422B51+11Fj
		mov	[esp+28h+Size],	offset aA ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_422C95:				; CODE XREF: sub_422B51+E7j
					; sub_422B51+106j ...
		mov	dword_42B5A8, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jz	short loc_422CE7
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_422CE7
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_422CDD
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_422CDD
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_422CDD:				; CODE XREF: sub_422B51+16Cj
					; sub_422B51+17Dj
		mov	ds:File, 0

loc_422CE7:				; CODE XREF: sub_422B51+152j
					; sub_422B51+15Bj
		cmp	[ebp+var_C], 0
		jnz	loc_422D72
		cmp	[ebp+Filename],	0
		jz	short loc_422D2F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_422D65
; ---------------------------------------------------------------------------

loc_422D2F:				; CODE XREF: sub_422B51+1A4j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_422D65:				; CODE XREF: sub_422B51+1DCj
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_422D95
; ---------------------------------------------------------------------------

loc_422D72:				; CODE XREF: sub_422B51+19Aj
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_422D95:				; CODE XREF: sub_422B51+21Fj
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_422DCD
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_422DCD
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_422DCD
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_422DCD:				; CODE XREF: sub_422B51+24Bj
					; sub_422B51+25Cj ...
		mov	eax, [ebp+var_C]
		mov	ds:File, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_4359E4, eax
		mov	ds:dword_4359E8, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_422B51	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_422DEE(char *)
sub_422DEE	proc near		; CODE XREF: sub_401BC6+323p
					; sub_4020C2+AA4p ...

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_422DFF
		mov	eax, [ebp+arg_0]
		jmp	short loc_422E04
; ---------------------------------------------------------------------------

loc_422DFF:				; CODE XREF: sub_422DEE+Aj
		mov	eax, offset asc_433298 ; "-"

loc_422E04:				; CODE XREF: sub_422DEE+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_422B51
		leave
		retn
sub_422DEE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_422B51
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_4359DC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_422E3E(char *, int)
sub_422E3E	proc near		; CODE XREF: sub_4020C2+135p
					; sub_4020C2+AB8p ...

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_422E6C
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset Dest ; Dest
		call	strncpy
		mov	ds:byte_4359CF,	0

loc_422E6C:				; CODE XREF: sub_422E3E+Aj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		mov	ds:dword_4359D4, eax
		mov	eax, [ebp+arg_4]
		and	eax, 2
		mov	ds:dword_4359D0, eax
		mov	eax, [ebp+arg_4]
		and	eax, 4
		mov	ds:dword_4359D8, eax
		mov	eax, [ebp+arg_4]
		and	eax, 100h
		mov	ds:dword_4359E0, eax
		leave
		retn
sub_422E3E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422E9C	proc near		; CODE XREF: sub_4020C2+249p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_422F0E
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_4359D4
		test	eax, eax
		jz	short loc_422EC6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_422EC6:				; CODE XREF: sub_422E9C+19j
		mov	eax, ds:dword_4359D0
		test	eax, eax
		jz	short loc_422EDE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_422EDE:				; CODE XREF: sub_422E9C+31j
		mov	eax, ds:dword_4359D8
		test	eax, eax
		jz	short loc_422EF6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_422EF6:				; CODE XREF: sub_422E9C+49j
		mov	eax, ds:dword_4359E0
		test	eax, eax
		jz	short loc_422F0E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_422F0E:				; CODE XREF: sub_422E9C+7j
					; sub_422E9C+61j
		mov	eax, offset Dest
		pop	ebp
		retn
sub_422E9C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_422F49
		mov	eax, ds:File
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_422F49
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_422F49
		mov	eax, 1
		jmp	short locret_422F69
; ---------------------------------------------------------------------------

loc_422F49:				; CODE XREF: .text:00422F22j
					; .text:00422F38j ...
		mov	eax, dword_42B5A8
		cmp	eax, 0FFFFFFFFh
		jz	short loc_422F64
		mov	eax, dword_42B5A8
		cmp	eax, [ebp+8]
		jnz	short loc_422F64
		mov	eax, 1
		jmp	short locret_422F69
; ---------------------------------------------------------------------------

loc_422F64:				; CODE XREF: .text:00422F51j
					; .text:00422F5Bj
		mov	eax, 0

locret_422F69:				; CODE XREF: .text:00422F47j
					; .text:00422F62j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_422F84
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_422F89
; ---------------------------------------------------------------------------

loc_422F84:				; CODE XREF: .text:00422F78j
		mov	eax, ds:File

loc_422F89:				; CODE XREF: .text:00422F82j
		mov	[esp], eax
		call	_fileno
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422F93	proc near		; CODE XREF: sub_406596+2BAp
		push	ebp
		mov	ebp, esp
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_422FA9
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_422FAE
; ---------------------------------------------------------------------------

loc_422FA9:				; CODE XREF: sub_422F93+Aj
		mov	eax, ds:File

loc_422FAE:				; CODE XREF: sub_422F93+14j
		pop	ebp
		retn
sub_422F93	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_422FB0(int, char *Format, va_list ArgList)
sub_422FB0	proc near		; CODE XREF: sub_42333D+22p
					; sub_423366+1Ap ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_422FF3
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_422DEE
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_422FF3
		mov	[esp+58h+Count], 1BEh ;	int
		mov	[esp+58h+File],	offset a____Dirmngr_12 ; "../../dirmngr-1.1.1/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_429780

loc_422FF3:				; CODE XREF: sub_422FB0+10j
					; sub_422FB0+25j
		mov	eax, ds:dword_4359E8
		test	eax, eax
		jz	short loc_423017
		cmp	[ebp+arg_0], 1
		jz	short loc_423017
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_423017:				; CODE XREF: sub_422FB0+4Aj
					; sub_422FB0+50j
		mov	ds:dword_4359E8, 0
		cmp	[ebp+arg_0], 1
		jz	loc_4231BA
		mov	eax, ds:dword_4359D0
		test	eax, eax
		jz	loc_4230C7
		mov	eax, ds:dword_4359E4
		test	eax, eax
		jnz	loc_4230C7
		mov	[esp+58h+var_58], 0
		call	sub_429850
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	sub_42A070
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:File
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_4230C7:				; CODE XREF: sub_422FB0+82j
					; sub_422FB0+8Fj
		mov	eax, ds:dword_4359D4
		test	eax, eax
		jnz	short loc_4230D9
		mov	eax, ds:dword_4359E4
		test	eax, eax
		jz	short loc_4230F0

loc_4230D9:				; CODE XREF: sub_422FB0+11Ej
		mov	edx, ds:File
		mov	eax, offset Dest
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_4230F0:				; CODE XREF: sub_422FB0+127j
		mov	eax, ds:dword_4359D8
		test	eax, eax
		jnz	short loc_423102
		mov	eax, ds:dword_4359E4
		test	eax, eax
		jz	short loc_423168

loc_423102:				; CODE XREF: sub_422FB0+147j
		call	_getpid
		mov	[ebp+var_20], eax
		mov	eax, ds:dword_4359DC
		test	eax, eax
		jz	short loc_42314B
		mov	edx, ds:dword_4359DC
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_58], eax
		call	edx ; dword_4359DC
		test	eax, eax
		jz	short loc_42314B
		mov	ecx, [ebp+var_28]
		mov	edx, offset aU_D ; "[%u.%d]"
		mov	eax, ds:File
		mov	[esp+58h+var_4C], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_423168
; ---------------------------------------------------------------------------

loc_42314B:				; CODE XREF: sub_422FB0+161j
					; sub_422FB0+173j
		mov	edx, offset aU_2 ; "[%u]"
		mov	eax, ds:File
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_423168:				; CODE XREF: sub_422FB0+150j
					; sub_422FB0+199j
		mov	eax, ds:dword_4359D0
		test	eax, eax
		jz	short loc_42317A
		mov	eax, ds:dword_4359E4
		test	eax, eax
		jz	short loc_42318F

loc_42317A:				; CODE XREF: sub_422FB0+1BFj
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_42318F:				; CODE XREF: sub_422FB0+1C8j
		cmp	[ebp+Format], 0
		jz	short loc_4231A5
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_4231A5
		add	[ebp+Format], 1
		jmp	short loc_4231BA
; ---------------------------------------------------------------------------

loc_4231A5:				; CODE XREF: sub_422FB0+1E3j
					; sub_422FB0+1EDj
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_4231BA:				; CODE XREF: sub_422FB0+75j
					; sub_422FB0+1F3j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_42324E	; jumptable 004231D1 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_4333C8
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4231D3:				; CODE XREF: sub_422FB0+221j
					; DATA XREF: .rdata:off_4333C8o
		mov	edx, ds:File	; jumptable 004231D1 case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_42326E
; ---------------------------------------------------------------------------

loc_4231FC:				; CODE XREF: sub_422FB0+221j
					; DATA XREF: .rdata:off_4333C8o
		mov	edx, ds:File	; jumptable 004231D1 case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_42326E
; ---------------------------------------------------------------------------

loc_423225:				; CODE XREF: sub_422FB0+221j
					; DATA XREF: .rdata:off_4333C8o
		mov	edx, ds:File	; jumptable 004231D1 case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_42326E
; ---------------------------------------------------------------------------

loc_42324E:				; CODE XREF: sub_422FB0+20Ej
		mov	edx, offset aUnknownLogLeve ; jumptable	004231D1 default case
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_42326E
; ---------------------------------------------------------------------------

loc_42326D:				; CODE XREF: sub_422FB0+221j
					; DATA XREF: .rdata:off_4333C8o
		nop			; jumptable 004231D1 cases 0-4

loc_42326E:				; CODE XREF: sub_422FB0+24Aj
					; sub_422FB0+273j ...
		cmp	[ebp+Format], 0
		jz	short loc_4232CF
		mov	eax, ds:File
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4232CF
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4232CF
		mov	ds:dword_4359E8, 1

loc_4232CF:				; CODE XREF: sub_422FB0+2C2j
					; sub_422FB0+2E7j ...
		cmp	[ebp+arg_0], 5
		jnz	short loc_4232FF
		mov	eax, ds:dword_4359E8
		test	eax, eax
		jz	short loc_4232F3
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_4232F3:				; CODE XREF: sub_422FB0+32Cj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4232FF:				; CODE XREF: sub_422FB0+323j
		cmp	[ebp+arg_0], 6
		jnz	short loc_423328
		mov	eax, ds:dword_4359E8
		test	eax, eax
		jz	short loc_423323
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_423323:				; CODE XREF: sub_422FB0+35Cj
		call	abort
; ---------------------------------------------------------------------------

loc_423328:				; CODE XREF: sub_422FB0+353j
		mov	eax, ds:File
		mov	[esp+58h+var_58], eax ;	File
		call	fflush
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_422FB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42333D(int, char *, char)
sub_42333D	proc near		; CODE XREF: sub_423540+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_422FB0
		leave
		retn
sub_42333D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_423366(int, char *, va_list)
sub_423366	proc near		; CODE XREF: sub_4016E6+8Fp

var_18		= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_422FB0
		leave
		retn
sub_423366	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_423387(char *, char)
sub_423387	proc near		; CODE XREF: sub_40180A+1E9p
					; sub_4020C2+520p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_422FB0
		leave
		retn
sub_423387	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4233B1(char *, char)
sub_4233B1	proc near		; CODE XREF: sub_40180A+1D5p
					; sub_401AE7+B1p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_422FB0
		mov	eax, ds:dword_4359EC
		cmp	eax, 752Fh
		jg	short locret_4233F2
		mov	eax, ds:dword_4359EC
		add	eax, 1
		mov	ds:dword_4359EC, eax

locret_4233F2:				; CODE XREF: sub_4233B1+32j
		leave
		retn
sub_4233B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_4233F4(char *, char)
sub_4233F4	proc near		; CODE XREF: sub_4020C2+185p
					; sub_4020C2+1E1p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 5 ; int
		call	sub_422FB0
		call	abort
sub_4233F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_423421(char *, char)
sub_423421	proc near		; CODE XREF: sub_4238BC+7Ep

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_422FB0
		call	abort
sub_423421	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42344E(char *, char)
sub_42344E	proc near		; CODE XREF: sub_4020C2+AD3p
					; sub_4020C2+AECp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_422FB0
		leave
		retn
sub_42344E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_423478(char *, char)
sub_423478	proc near		; CODE XREF: sub_40989B+3F2p
					; sub_40989B+409p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_422FB0
		leave
		retn
sub_423478	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4234A8	proc near		; CODE XREF: sub_408DFB+1F9p
					; sub_416B16+B8p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jz	short loc_4234D1
		mov	eax, dword ptr [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4234D1
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset dword_4333E8 ;	char *
		call	sub_42344E

loc_4234D1:				; CODE XREF: sub_4234A8+Aj
					; sub_4234A8+14j
		cmp	[ebp+arg_8], 0
		jz	short loc_42352C
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset a02x_5	; "%02X"
		call	sub_423478
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		jmp	short loc_42351D
; ---------------------------------------------------------------------------

loc_423500:				; CODE XREF: sub_4234A8+82j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset a02x_6	; " %02X"
		call	sub_423478
		add	[ebp+var_C], 1

loc_42351D:				; CODE XREF: sub_4234A8+56j
		cmp	[ebp+arg_8], 0
		setnz	al
		sub	[ebp+arg_8], 1
		test	al, al
		jnz	short loc_423500

loc_42352C:				; CODE XREF: sub_4234A8+2Dj
		cmp	dword ptr [ebp+arg_0], 0
		jz	short locret_42353E
		mov	[esp+28h+var_28], offset asc_4333F7 ; "\n"
		call	sub_423478

locret_42353E:				; CODE XREF: sub_4234A8+88j
		leave
		retn
sub_4234A8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_423540	proc near		; CODE XREF: sub_406B43+59p
					; sub_40989B+226p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_42333D
		call	abort
sub_423540	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_423574	proc near		; CODE XREF: sub_401BC6+100p
					; sub_4059C0+567p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_423595
; ---------------------------------------------------------------------------

loc_42357C:				; CODE XREF: sub_423574+25j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax

loc_423595:				; CODE XREF: sub_423574+6j
		cmp	[ebp+arg_0], 0
		jnz	short loc_42357C
		leave
		retn
sub_423574	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42359D(int, char *)
sub_42359D	proc near		; CODE XREF: sub_401BC6+469p
					; .text:00423624p ...

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_42359D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_42362E
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42359D
		mov	[ebp-0Ch], eax
		jmp	short loc_42365C
; ---------------------------------------------------------------------------

loc_42362E:				; CODE XREF: .text:00423615j
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_426F2A
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42359D
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_42365C:				; CODE XREF: .text:0042362Cj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_423661(int, char *)
sub_423661	proc near		; CODE XREF: .text:00423715p
					; .text:0042373Ap

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4236D0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4236F3
; ---------------------------------------------------------------------------

loc_4236D0:				; CODE XREF: sub_423661+63j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_4236E2
; ---------------------------------------------------------------------------

loc_4236DA:				; CODE XREF: sub_423661+88j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4236E2:				; CODE XREF: sub_423661+77j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4236DA
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_4236F3:				; CODE XREF: sub_423661+6Dj
		mov	eax, [ebp+var_10]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_423661	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_42371F
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_423661
		mov	[ebp-0Ch], eax
		jmp	short loc_42374D
; ---------------------------------------------------------------------------

loc_42371F:				; CODE XREF: .text:00423706j
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_426F2A
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_423661
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_42374D:				; CODE XREF: .text:0042371Dj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	dword ptr [ebp-10h], 0
		lea	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_4237DB
; ---------------------------------------------------------------------------

loc_423768:				; CODE XREF: .text:004237DFj
		mov	eax, [ebp+8]
		add	eax, 8
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	edx, [ebp+8]
		mov	edx, [edx+4]
		mov	[eax+4], edx
		mov	eax, [ebp+8]
		add	eax, 8
		mov	edx, [ebp-14h]
		add	edx, 8
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		mov	eax, [ebp-14h]
		mov	dword ptr [eax], 0
		mov	edx, [ebp-14h]
		mov	eax, [ebp-0Ch]
		mov	[eax], edx
		lea	eax, [ebp-14h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp+8], eax

loc_4237DB:				; CODE XREF: .text:00423766j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_423768
		mov	eax, [ebp-10h]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_423807
; ---------------------------------------------------------------------------

loc_4237F9:				; CODE XREF: .text:00423813j
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp+8], eax

loc_423807:				; CODE XREF: .text:004237F7j
		cmp	dword ptr [ebp+8], 0
		jz	short loc_423815
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_4237F9

loc_423815:				; CODE XREF: .text:0042380Bj
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_423836
		jmp	short loc_42382D
; ---------------------------------------------------------------------------

loc_423825:				; CODE XREF: .text:00423834j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp+8], eax

loc_42382D:				; CODE XREF: .text:00423823j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423825

loc_423836:				; CODE XREF: .text:00423821j
		mov	eax, [ebp+8]
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_4238B1
		mov	eax, [ebp-10h]
		add	eax, 8
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		add	eax, 8
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp-10h]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_4238B1:				; CODE XREF: .text:00423855j
		mov	eax, [ebp-0Ch]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4238BC	proc near		; CODE XREF: sub_423B0A+5Ep
					; sub_42435A+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_42393F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_42393F
		mov	[esp+28h+Code],	offset aInvalidArgumen ; "Invalid argument for ArgParse\n"
		call	sub_423421
; ---------------------------------------------------------------------------

loc_42393F:				; CODE XREF: sub_4238BC+13j
					; sub_4238BC+75j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_423AEF
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_4239FE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_42396B
		mov	dword ptr [ebp+var_C], offset aArgumentNotExp ;	"argument not expected\n"
		jmp	short loc_4239D6
; ---------------------------------------------------------------------------

loc_42396B:				; CODE XREF: sub_4238BC+A4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_42397F
		mov	dword ptr [ebp+var_C], offset aReadError ; "read error\n"
		jmp	short loc_4239D6
; ---------------------------------------------------------------------------

loc_42397F:				; CODE XREF: sub_4238BC+B8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_423993
		mov	dword ptr [ebp+var_C], offset aKeywordTooLong ;	"keyword too long\n"
		jmp	short loc_4239D6
; ---------------------------------------------------------------------------

loc_423993:				; CODE XREF: sub_4238BC+CCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_4239A7
		mov	dword ptr [ebp+var_C], offset aMissingArgumen ;	"missing argument\n"
		jmp	short loc_4239D6
; ---------------------------------------------------------------------------

loc_4239A7:				; CODE XREF: sub_4238BC+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_4239BB
		mov	dword ptr [ebp+var_C], offset aInvalidCommand ;	"invalid command\n"
		jmp	short loc_4239D6
; ---------------------------------------------------------------------------

loc_4239BB:				; CODE XREF: sub_4238BC+F4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_4239CF
		mov	dword ptr [ebp+var_C], offset aInvalidAliasDe ;	"invalid alias definition\n"
		jmp	short loc_4239D6
; ---------------------------------------------------------------------------

loc_4239CF:				; CODE XREF: sub_4238BC+108j
		mov	dword ptr [ebp+var_C], offset aInvalidOption ; "invalid	option\n"

loc_4239D6:				; CODE XREF: sub_4238BC+ADj
					; sub_4238BC+C1j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_4233B1
		jmp	loc_423ACE
; ---------------------------------------------------------------------------

loc_4239FE:				; CODE XREF: sub_4238BC+95j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_423A10
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_423A15
; ---------------------------------------------------------------------------

loc_423A10:				; CODE XREF: sub_4238BC+14Aj
		mov	eax, offset a??	; "[??]"

loc_423A15:				; CODE XREF: sub_4238BC+152j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_423A3B
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "Missing argument for option \"%.50s\"\n"
		call	sub_4233B1
		jmp	loc_423ACE
; ---------------------------------------------------------------------------

loc_423A3B:				; CODE XREF: sub_4238BC+165j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_423A5B
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "Option \"%.50s\" does	not expect an arg"...
		call	sub_4233B1
		jmp	short loc_423ACE
; ---------------------------------------------------------------------------

loc_423A5B:				; CODE XREF: sub_4238BC+188j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_423A7B
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "Invalid command \"%.50s\"\n"
		call	sub_4233B1
		jmp	short loc_423ACE
; ---------------------------------------------------------------------------

loc_423A7B:				; CODE XREF: sub_4238BC+1A8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_423A9B
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "Option \"%.50s\" is ambiguous\n"
		call	sub_4233B1
		jmp	short loc_423ACE
; ---------------------------------------------------------------------------

loc_423A9B:				; CODE XREF: sub_4238BC+1C8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF7h
		jnz	short loc_423ABB
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "Command \"%.50s\" is ambiguous\n"
		call	sub_4233B1
		jmp	short loc_423ACE
; ---------------------------------------------------------------------------

loc_423ABB:				; CODE XREF: sub_4238BC+1E8j
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "Invalid option \"%.50s\"\n"
		call	sub_4233B1

loc_423ACE:				; CODE XREF: sub_4238BC+13Dj
					; sub_4238BC+17Aj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_423AE5
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_423AE5:				; CODE XREF: sub_4238BC+21Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_423AEF:				; CODE XREF: sub_4238BC+8Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_4238BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_423B05	proc near		; CODE XREF: sub_423B0A+2DFp
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_423B05	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_423B0A(FILE *, int, int, int,	int)
sub_423B0A	proc near		; CODE XREF: sub_4020C2+89Dp
					; .text:00403EA0p

File		= dword	ptr -0B8h
Str2		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_9C		= dword	ptr -9Ch
Str1		= byte ptr -94h
C		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Str		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0B4h
		mov	[ebp+var_14], 0
		mov	[ebp+Str], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_2C], 0
		mov	[ebp+var_20], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_423B54
		mov	eax, [ebp+arg_10]
		mov	[esp+0B8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0B8h+File], eax
		call	sub_42435A
		jmp	loc_4241F9
; ---------------------------------------------------------------------------

loc_423B54:				; CODE XREF: sub_423B0A+31j
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0B8h+File], eax
		call	sub_4238BC
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_423B7D
; ---------------------------------------------------------------------------

loc_423B7C:				; CODE XREF: sub_423B0A+44Bj
					; sub_423B0A+488j ...
		nop

loc_423B7D:				; CODE XREF: sub_423B0A+70j
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+File], eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jz	short loc_423B9B
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	loc_423F51

loc_423B9B:				; CODE XREF: sub_423B0A+85j
		cmp	[ebp+C], 0FFFFFFFFh
		jz	short loc_423BAE
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_423BAE:				; CODE XREF: sub_423B0A+95j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_4241EF
		cmp	[ebp+var_C], 2
		jnz	loc_423CDA
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_423C0D
; ---------------------------------------------------------------------------

loc_423BD7:				; CODE XREF: sub_423B0A+110j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_423C09
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0B8h+Str2], edx ; Str2
		mov	[esp+0B8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_423C1E

loc_423C09:				; CODE XREF: sub_423B0A+DBj
		add	[ebp+var_10], 1

loc_423C0D:				; CODE XREF: sub_423B0A+CBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423BD7
		jmp	short loc_423C1F
; ---------------------------------------------------------------------------

loc_423C1E:				; CODE XREF: sub_423B0A+FDj
		nop

loc_423C1F:				; CODE XREF: sub_423B0A+112j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		cmp	[ebp+var_2C], 0
		jz	short loc_423C4C
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx

loc_423C4C:				; CODE XREF: sub_423B0A+130j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423C87
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 100h
		test	eax, eax
		jz	short loc_423C77
		mov	eax, 0FFFFFFF9h
		jmp	short loc_423C7C
; ---------------------------------------------------------------------------

loc_423C77:				; CODE XREF: sub_423B0A+164j
		mov	eax, 0FFFFFFFEh

loc_423C7C:				; CODE XREF: sub_423B0A+16Bj
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423C87:				; CODE XREF: sub_423B0A+14Fj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_423CA9
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423CA9:				; CODE XREF: sub_423B0A+18Ej
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_423CCB
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423CCB:				; CODE XREF: sub_423B0A+1B0j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423CDA:				; CODE XREF: sub_423B0A+B2j
		cmp	[ebp+var_C], 3
		jnz	short loc_423D48
		cmp	[ebp+var_20], 0
		jz	short loc_423CF5
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423CF5:				; CODE XREF: sub_423B0A+1DAj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_423D17
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423D17:				; CODE XREF: sub_423B0A+1FCj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_423D39
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423D39:				; CODE XREF: sub_423B0A+21Ej
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423D48:				; CODE XREF: sub_423B0A+1D4j
		cmp	[ebp+var_C], 4
		jnz	loc_423F0B
		cmp	[ebp+var_20], 0
		jz	loc_423DF3
		cmp	[ebp+Str], 0
		jnz	short loc_423D71
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_423F06
; ---------------------------------------------------------------------------

loc_423D71:				; CODE XREF: sub_423B0A+256j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0
		mov	[esp+0B8h+Str2], offset	asc_43358C ; " \t"
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+File], eax ; Str
		call	strpbrk
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_423DAB
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	[esp+0B8h+File], eax
		call	sub_4256E4

loc_423DAB:				; CODE XREF: sub_423B0A+28Aj
		cmp	[ebp+var_24], 0
		jz	short loc_423DBB
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_423DD5

loc_423DBB:				; CODE XREF: sub_423B0A+2A5j
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+File], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_4241F2
; ---------------------------------------------------------------------------

loc_423DD5:				; CODE XREF: sub_423B0A+2AFj
		mov	eax, [ebp+var_24]
		mov	[esp+0B8h+Size], eax
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0B8h+File], eax
		call	sub_423B05
		jmp	loc_423F06
; ---------------------------------------------------------------------------

loc_423DF3:				; CODE XREF: sub_423B0A+24Cj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_423E15
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_4241F2
; ---------------------------------------------------------------------------

loc_423E15:				; CODE XREF: sub_423B0A+2FAj
		cmp	[ebp+Str], 0
		jnz	short loc_423E3A
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+Str1]
		mov	[esp+0B8h+File], eax
		call	gcry_xstrdup
		mov	[ebp+Str], eax
		jmp	short loc_423E43
; ---------------------------------------------------------------------------

loc_423E3A:				; CODE XREF: sub_423B0A+30Fj
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0

loc_423E43:				; CODE XREF: sub_423B0A+32Ej
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+File], eax
		call	sub_4256E4
		mov	eax, [ebp+Str]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_423ECC
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_423ECC
		mov	eax, [ebp+var_28]
		mov	[ebp+var_9C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_423ECC
		mov	eax, [ebp+var_28]
		mov	[ebp+var_9C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_423ECC:				; CODE XREF: sub_423B0A+352j
					; sub_423B0A+360j ...
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_28]
		mov	[esp+0B8h+Size], edx ; char *
		mov	[esp+0B8h+Str2], eax ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+0B8h+File], eax ; int
		call	sub_424AF8
		test	eax, eax
		jnz	loc_4241F2
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+File], eax
		call	gcry_free
		jmp	loc_4241F2
; ---------------------------------------------------------------------------

loc_423F06:				; CODE XREF: sub_423B0A+262j
					; sub_423B0A+2E4j
		jmp	loc_4241F2
; ---------------------------------------------------------------------------

loc_423F0B:				; CODE XREF: sub_423B0A+242j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_423F3E
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+File], eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_423F2F
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423F2F:				; CODE XREF: sub_423B0A+414j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0
		jmp	loc_4241F3
; ---------------------------------------------------------------------------

loc_423F3E:				; CODE XREF: sub_423B0A+405j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	loc_4241EA
; ---------------------------------------------------------------------------

loc_423F51:				; CODE XREF: sub_423B0A+8Bj
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_423B7C
		cmp	[ebp+var_C], 0
		jnz	short loc_423F76
		mov	eax, [ebp+C]
		mov	[esp+0B8h+File], eax ; C
		mov	eax, ds:__imp_isspace
		call	eax ; __imp_isspace
		test	eax, eax
		jnz	loc_4241EA

loc_423F76:				; CODE XREF: sub_423B0A+455j
		cmp	[ebp+var_C], 0
		jnz	short loc_423F8E
		cmp	[ebp+C], 23h
		jnz	short loc_423F8E
		mov	[ebp+var_C], 1
		jmp	loc_4241EA
; ---------------------------------------------------------------------------

loc_423F8E:				; CODE XREF: sub_423B0A+470j
					; sub_423B0A+476j
		cmp	[ebp+var_C], 1
		jz	loc_423B7C
		cmp	[ebp+var_C], 2
		jnz	loc_4240A6
		mov	eax, [ebp+C]
		mov	[esp+0B8h+File], eax ; C
		mov	eax, ds:__imp_isspace
		call	eax ; __imp_isspace
		test	eax, eax
		jz	loc_4240A6
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_424002
; ---------------------------------------------------------------------------

loc_423FCC:				; CODE XREF: sub_423B0A+505j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_423FFE
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0B8h+Str2], edx ; Str2
		mov	[esp+0B8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_424013

loc_423FFE:				; CODE XREF: sub_423B0A+4D0j
		add	[ebp+var_10], 1

loc_424002:				; CODE XREF: sub_423B0A+4C0j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423FCC
		jmp	short loc_424014
; ---------------------------------------------------------------------------

loc_424013:				; CODE XREF: sub_423B0A+4F2j
		nop

loc_424014:				; CODE XREF: sub_423B0A+507j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42409A
		mov	[esp+0B8h+Str2], offset	aAlias ; "alias"
		lea	eax, [ebp+Str1]
		mov	[esp+0B8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_424067
		mov	[ebp+var_20], 1
		mov	[ebp+var_C], 3
		jmp	loc_4241EA
; ---------------------------------------------------------------------------

loc_424067:				; CODE XREF: sub_423B0A+548j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 100h
		test	eax, eax
		jz	short loc_424083
		mov	eax, 0FFFFFFF9h
		jmp	short loc_424088
; ---------------------------------------------------------------------------

loc_424083:				; CODE XREF: sub_423B0A+570j
		mov	eax, 0FFFFFFFEh

loc_424088:				; CODE XREF: sub_423B0A+577j
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_4241EA
; ---------------------------------------------------------------------------

loc_42409A:				; CODE XREF: sub_423B0A+52Ej
		mov	[ebp+var_C], 3
		jmp	loc_4241EA
; ---------------------------------------------------------------------------

loc_4240A6:				; CODE XREF: sub_423B0A+492j
					; sub_423B0A+4A7j
		cmp	[ebp+var_C], 3
		jnz	short loc_4240E8
		mov	eax, [ebp+C]
		mov	[esp+0B8h+File], eax ; C
		mov	eax, ds:__imp_isspace
		call	eax ; __imp_isspace
		test	eax, eax
		jnz	loc_423B7C
		mov	[ebp+var_10], 0
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 4
		jmp	loc_423B7C
; ---------------------------------------------------------------------------

loc_4240E8:				; CODE XREF: sub_423B0A+5A0j
		cmp	[ebp+var_C], 4
		jnz	loc_4241AC
		cmp	[ebp+Str], 0
		jz	short loc_424146
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_424119
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_423B7C
; ---------------------------------------------------------------------------

loc_424119:				; CODE XREF: sub_423B0A+5F9j
		add	[ebp+var_1C], 32h
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Str2], eax
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+File], eax
		call	gcry_xrealloc
		mov	[ebp+Str], eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_423B7C
; ---------------------------------------------------------------------------

loc_424146:				; CODE XREF: sub_423B0A+5ECj
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_424167
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_423B7C
; ---------------------------------------------------------------------------

loc_424167:				; CODE XREF: sub_423B0A+642j
		mov	[ebp+var_1C], 96h
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+File], eax
		call	gcry_xmalloc
		mov	[ebp+Str], eax
		mov	ecx, [ebp+var_10]
		lea	edx, [ebp+Str1]
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Str2], edx ; Src
		mov	[esp+0B8h+File], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_423B7C
; ---------------------------------------------------------------------------

loc_4241AC:				; CODE XREF: sub_423B0A+5E2j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		jbe	short loc_4241CA
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_423B7C
; ---------------------------------------------------------------------------

loc_4241CA:				; CODE XREF: sub_423B0A+6A8j
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 2
		jmp	loc_423B7C
; ---------------------------------------------------------------------------

loc_4241EA:				; CODE XREF: sub_423B0A+442j
					; sub_423B0A+466j ...
		jmp	loc_423B7C
; ---------------------------------------------------------------------------

loc_4241EF:				; CODE XREF: sub_423B0A+A8j
		nop
		jmp	short loc_4241F3
; ---------------------------------------------------------------------------

loc_4241F2:				; CODE XREF: sub_423B0A+2C6j
					; sub_423B0A+306j ...
		nop

loc_4241F3:				; CODE XREF: sub_423B0A+178j
					; sub_423B0A+19Aj ...
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+10h]

loc_4241F9:				; CODE XREF: sub_423B0A+45j
		add	esp, 0B4h
		pop	edi
		pop	ebp
		retn
sub_423B0A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_424202(int, int, char	*)
sub_424202	proc near		; CODE XREF: sub_42435A+182p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42421D
		mov	eax, 0FFFFFFFFh
		jmp	loc_424354
; ---------------------------------------------------------------------------

loc_42421D:				; CODE XREF: sub_424202+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_424261
; ---------------------------------------------------------------------------

loc_424226:				; CODE XREF: sub_424202+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_42425D
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_42425D
		mov	eax, [ebp+var_C]
		jmp	loc_424354
; ---------------------------------------------------------------------------

loc_42425D:				; CODE XREF: sub_424202+32j
					; sub_424202+51j
		add	[ebp+var_C], 1

loc_424261:				; CODE XREF: sub_424202+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_424226
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_42433C
; ---------------------------------------------------------------------------

loc_42429E:				; CODE XREF: sub_424202+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_424338
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_424338
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_424324
; ---------------------------------------------------------------------------

loc_4242E3:				; CODE XREF: sub_424202+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_424320
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_424320
		mov	eax, 0FFFFFFFEh
		jmp	short loc_424354
; ---------------------------------------------------------------------------

loc_424320:				; CODE XREF: sub_424202+EFj
					; sub_424202+115j
		add	[ebp+var_10], 1

loc_424324:				; CODE XREF: sub_424202+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4242E3
		mov	eax, [ebp+var_C]
		jmp	short loc_424354
; ---------------------------------------------------------------------------

loc_424338:				; CODE XREF: sub_424202+AAj
					; sub_424202+D4j
		add	[ebp+var_C], 1

loc_42433C:				; CODE XREF: sub_424202+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_42429E
		mov	eax, 0FFFFFFFFh

loc_424354:				; CODE XREF: sub_424202+16j
					; sub_424202+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_424202	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42435A	proc near		; CODE XREF: sub_4020C2+44Dp
					; sub_423B0A+40p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_4238BC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4243BE
		cmp	[ebp+var_10], 0
		jz	short loc_4243BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_4243BE
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_4243BE:				; CODE XREF: sub_42435A+43j
					; sub_42435A+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_4243D3
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_424AD2
; ---------------------------------------------------------------------------

loc_4243D3:				; CODE XREF: sub_42435A+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_424429
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_424429
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_424AD2
; ---------------------------------------------------------------------------

loc_424429:				; CODE XREF: sub_42435A+92j
					; sub_42435A+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_424442
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_424AD2
; ---------------------------------------------------------------------------

loc_424442:				; CODE XREF: sub_42435A+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_4247AD
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_4247AD
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4244A0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_4244A0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_4243BE
; ---------------------------------------------------------------------------

loc_4244A0:				; CODE XREF: sub_42435A+11Cj
					; sub_42435A+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], 3Dh ; Val
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_4244C5
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_4244C5:				; CODE XREF: sub_42435A+163j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_424202
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_4244F0
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_4244F0:				; CODE XREF: sub_42435A+18Ej
		cmp	[ebp+var_20], 0
		jns	short loc_42452A
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aHelp ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_42452A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_424C69
; ---------------------------------------------------------------------------
		jmp	loc_42464E
; ---------------------------------------------------------------------------

loc_42452A:				; CODE XREF: sub_42435A+19Aj
					; sub_42435A+1B4j
		cmp	[ebp+var_20], 0
		jns	short loc_42456C
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aVersion ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_42456C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_42464E
		call	sub_4251CC
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_42456C:				; CODE XREF: sub_42435A+1D4j
					; sub_42435A+1EEj
		cmp	[ebp+var_20], 0
		jns	short loc_4245AC
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_4245AC
		mov	[esp+38h+Str], 10h
		call	sub_425424
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4245AC:				; CODE XREF: sub_42435A+216j
					; sub_42435A+230j
		cmp	[ebp+var_20], 0
		jns	loc_42464E
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	short loc_42464E
		mov	[ebp+var_20], 0
		jmp	short loc_42460A
; ---------------------------------------------------------------------------

loc_4245D9:				; CODE XREF: sub_42435A+2BDj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_424606
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, offset aS_4 ; "--%s\n"
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax ; Format
		call	printf

loc_424606:				; CODE XREF: sub_42435A+28Dj
		add	[ebp+var_20], 1

loc_42460A:				; CODE XREF: sub_42435A+27Dj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4245D9
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aDumpOptionsHel ; "--dump-options\n--help\n--version\n--wa"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Bh ; Count
		mov	[esp+38h+Val], 1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_42464E:				; CODE XREF: sub_42435A+1CBj
					; sub_42435A+1FBj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_424660
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_42468F
; ---------------------------------------------------------------------------

loc_424660:				; CODE XREF: sub_42435A+2F8j
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_42467E
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_42468F
; ---------------------------------------------------------------------------

loc_42467E:				; CODE XREF: sub_42435A+30Aj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_42468F:				; CODE XREF: sub_42435A+304j
					; sub_42435A+322j
		cmp	[ebp+var_20], 0
		js	loc_42479C
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_42477D
		cmp	[ebp+var_28], 0
		jz	short loc_4246D2
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4246DB
		mov	[ebp+var_1C], 0
		jmp	short loc_4246DB
; ---------------------------------------------------------------------------

loc_4246D2:				; CODE XREF: sub_42435A+35Aj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_4246DB:				; CODE XREF: sub_42435A+36Dj
					; sub_42435A+376j
		cmp	[ebp+var_1C], 0
		jnz	short loc_424703
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_424703
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_42479C
; ---------------------------------------------------------------------------

loc_424703:				; CODE XREF: sub_42435A+385j
					; sub_42435A+398j
		cmp	[ebp+var_1C], 0
		jnz	short loc_424718
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_42479B
; ---------------------------------------------------------------------------

loc_424718:				; CODE XREF: sub_42435A+3ADj
		cmp	[ebp+var_28], 0
		jnz	short loc_424747
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_424747
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_424747
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_42479C
; ---------------------------------------------------------------------------

loc_424747:				; CODE XREF: sub_42435A+3C2j
					; sub_42435A+3CCj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_424AF8
		cmp	[ebp+var_28], 0
		jnz	short loc_42479B
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_42479B
; ---------------------------------------------------------------------------

loc_42477D:				; CODE XREF: sub_42435A+350j
		cmp	[ebp+var_28], 0
		jz	short loc_42478F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_42479C
; ---------------------------------------------------------------------------

loc_42478F:				; CODE XREF: sub_42435A+427j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_42479C
; ---------------------------------------------------------------------------

loc_42479B:				; CODE XREF: sub_42435A+3B9j
					; sub_42435A+413j ...
		nop

loc_42479C:				; CODE XREF: sub_42435A+339j
					; sub_42435A+3A4j ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_424AD2
; ---------------------------------------------------------------------------

loc_4247AD:				; CODE XREF: sub_42435A+F0j
					; sub_42435A+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4247C4
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4247D2

loc_4247C4:				; CODE XREF: sub_42435A+45Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_424A8A

loc_4247D2:				; CODE XREF: sub_42435A+468j
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_42485D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_42485D
		mov	[ebp+var_20], 0
		jmp	short loc_42484E
; ---------------------------------------------------------------------------

loc_42480F:				; CODE XREF: sub_42435A+501j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_42484A
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+38h+Val], edx ; Str2
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_42484A
		mov	[ebp+var_24], 1
		jmp	short loc_42485D
; ---------------------------------------------------------------------------

loc_42484A:				; CODE XREF: sub_42435A+4C3j
					; sub_42435A+4E5j
		add	[ebp+var_20], 1

loc_42484E:				; CODE XREF: sub_42435A+4B3j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42480F

loc_42485D:				; CODE XREF: sub_42435A+48Ej
					; sub_42435A+4AAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_4248A3
		mov	[ebp+var_20], 0
		jmp	short loc_424891
; ---------------------------------------------------------------------------

loc_424875:				; CODE XREF: sub_42435A+544j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_4248A2
		add	[ebp+var_20], 1

loc_424891:				; CODE XREF: sub_42435A+519j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_424875
		jmp	short loc_4248A3
; ---------------------------------------------------------------------------

loc_4248A2:				; CODE XREF: sub_42435A+531j
		nop

loc_4248A3:				; CODE XREF: sub_42435A+510j
					; sub_42435A+546j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4248DB
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_4248C6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_4248DB

loc_4248C6:				; CODE XREF: sub_42435A+560j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_424C69
; ---------------------------------------------------------------------------

loc_4248DB:				; CODE XREF: sub_42435A+556j
					; sub_42435A+56Aj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42493F
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 100h
		test	eax, eax
		jz	short loc_424917
		mov	eax, 0FFFFFFF9h
		jmp	short loc_42491C
; ---------------------------------------------------------------------------

loc_424917:				; CODE XREF: sub_42435A+5B4j
		mov	eax, 0FFFFFFFEh

loc_42491C:				; CODE XREF: sub_42435A+5BBj
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_424A5F
; ---------------------------------------------------------------------------

loc_42493F:				; CODE XREF: sub_42435A+59Fj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_424A46
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424999
		cmp	[ebp+var_24], 0
		jnz	short loc_424999
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_424AF8
		jmp	loc_424A3D
; ---------------------------------------------------------------------------

loc_424999:				; CODE XREF: sub_42435A+607j
					; sub_42435A+60Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4249C7
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4249C7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_424A3D
; ---------------------------------------------------------------------------

loc_4249C7:				; CODE XREF: sub_42435A+64Cj
					; sub_42435A+65Fj
		cmp	[ebp+var_1C], 0
		jnz	short loc_4249D9
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_424A3D
; ---------------------------------------------------------------------------

loc_4249D9:				; CODE XREF: sub_42435A+671j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_424A0F
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424A0F
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_424A0F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_424A3D
; ---------------------------------------------------------------------------

loc_424A0F:				; CODE XREF: sub_42435A+687j
					; sub_42435A+694j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_424AF8
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_424A3D:				; CODE XREF: sub_42435A+63Aj
					; sub_42435A+66Bj ...
		mov	[ebp+var_18], offset asc_4335EC	; "x"
		jmp	short loc_424A5F
; ---------------------------------------------------------------------------

loc_424A46:				; CODE XREF: sub_42435A+5F6j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_424A5F:				; CODE XREF: sub_42435A+5E0j
					; sub_42435A+6EAj
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424A72
		cmp	[ebp+var_24], 0
		jz	short loc_424AD1

loc_424A72:				; CODE XREF: sub_42435A+710j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_424AD1
; ---------------------------------------------------------------------------

loc_424A8A:				; CODE XREF: sub_42435A+472j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_424AC2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_424AD2
; ---------------------------------------------------------------------------

loc_424AC2:				; CODE XREF: sub_42435A+73Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_4243BE
; ---------------------------------------------------------------------------

loc_424AD1:				; CODE XREF: sub_42435A+716j
					; sub_42435A+72Ej
		nop

loc_424AD2:				; CODE XREF: sub_42435A+74j
					; sub_42435A+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_42435A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_424AF8(int, int, char	*)
sub_424AF8	proc near		; CODE XREF: sub_423B0A+3DFp
					; sub_42435A+40Ap ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_424B0F
		mov	eax, 0
		jmp	short loc_424B14
; ---------------------------------------------------------------------------

loc_424B0F:				; CODE XREF: sub_424AF8+Ej
		mov	eax, 0Ah

loc_424B14:				; CODE XREF: sub_424AF8+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_424B61
		cmp	eax, 4
		jz	short loc_424B88
		cmp	eax, 1
		jnz	short loc_424BAF
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, 0
		jmp	short locret_424BBD
; ---------------------------------------------------------------------------

loc_424B61:				; CODE XREF: sub_424AF8+36j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, 0
		jmp	short locret_424BBD
; ---------------------------------------------------------------------------

loc_424B88:				; CODE XREF: sub_424AF8+3Bj
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, 0
		jmp	short locret_424BBD
; ---------------------------------------------------------------------------

loc_424BAF:				; CODE XREF: sub_424AF8+40j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_424BBD:				; CODE XREF: sub_424AF8+67j
					; sub_424AF8+8Ej ...
		leave
		retn
sub_424AF8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424BBF	proc near		; CODE XREF: sub_424C69+8Ep

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_424C60
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_424C60
		call	sub_426F20
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_424C4B
		add	[ebp+var_C], 1
		jmp	short loc_424C4B
; ---------------------------------------------------------------------------

loc_424C26:				; CODE XREF: sub_424BBF+9Fj
		cmp	[ebp+var_14], 0
		jz	short loc_424C45
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_424C45
		add	[ebp+var_C], 1

loc_424C45:				; CODE XREF: sub_424BBF+6Bj
					; sub_424BBF+80j
		add	[ebp+var_10], 1
		jmp	short loc_424C4C
; ---------------------------------------------------------------------------

loc_424C4B:				; CODE XREF: sub_424BBF+5Fj
					; sub_424BBF+65j
		nop

loc_424C4C:				; CODE XREF: sub_424BBF+8Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424C60
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_424C26

loc_424C60:				; CODE XREF: sub_424BBF+34j
					; sub_424BBF+41j ...
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_424BBF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_424C69	proc near		; CODE XREF: sub_42435A+1C6p
					; sub_42435A+57Cp

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		call	sub_4251CC
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Str], 29h
		call	sub_425424
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_4250C9
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_424D17
; ---------------------------------------------------------------------------

loc_424CB8:				; CODE XREF: sub_424C69+BBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_424D13
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_424CEB
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_424D13

loc_424CEB:				; CODE XREF: sub_424C69+6Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_424BBF
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_424D13
		cmp	[ebp+var_14], 22h
		jg	short loc_424D13
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_424D13:				; CODE XREF: sub_424C69+5Dj
					; sub_424C69+80j ...
		add	[ebp+var_10], 1

loc_424D17:				; CODE XREF: sub_424C69+4Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_424CB8
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_424D43
		mov	[esp+38h+Str], offset aOptions ; "Options:"
		call	puts

loc_424D43:				; CODE XREF: sub_424C69+CCj
		mov	[ebp+var_10], 0
		jmp	loc_4250A0
; ---------------------------------------------------------------------------

loc_424D4F:				; CODE XREF: sub_424C69+444j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_424D7F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_424D7F
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_42509B

loc_424D7F:				; CODE XREF: sub_424C69+F9j
					; sub_424C69+103j
		cmp	[ebp+var_C], 0
		jz	short loc_424DEA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_424DEA
		add	[ebp+var_C], 1
		jmp	short loc_424DCF
; ---------------------------------------------------------------------------

loc_424D95:				; CODE XREF: sub_424C69+16Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_424DBA
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424DCB
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_424DCB
; ---------------------------------------------------------------------------

loc_424DBA:				; CODE XREF: sub_424C69+134j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_424DCB:				; CODE XREF: sub_424C69+141j
					; sub_424C69+14Fj
		add	[ebp+var_C], 1

loc_424DCF:				; CODE XREF: sub_424C69+12Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_424D95
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_42509C
; ---------------------------------------------------------------------------

loc_424DEA:				; CODE XREF: sub_424C69+11Aj
					; sub_424C69+124j
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_424E9E
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset aC_0 ; " -%c"
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Str], eax ; Format
		call	printf
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_424EC7
		cmp	[ebp+var_C], 0
		jz	loc_424EC7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_424EC7
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_424E7A
; ---------------------------------------------------------------------------

loc_424E61:				; CODE XREF: sub_424C69+223j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_424E7A:				; CODE XREF: sub_424C69+1F6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424E8E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_424E61

loc_424E8E:				; CODE XREF: sub_424C69+219j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424EC7
		add	[ebp+var_C], 1
		jmp	short loc_424EC7
; ---------------------------------------------------------------------------

loc_424E9E:				; CODE XREF: sub_424C69+198j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_4335FC ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_424EC7:				; CODE XREF: sub_424C69+1C8j
					; sub_424C69+1D2j ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_424FCA
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_424F00
		mov	eax, 2Ch
		jmp	short loc_424F05
; ---------------------------------------------------------------------------

loc_424F00:				; CODE XREF: sub_424C69+28Ej
		mov	eax, 20h

loc_424F05:				; CODE XREF: sub_424C69+295j
		mov	edx, offset aCS	; "%c --%s"
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str], edx ; Format
		call	printf
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	short loc_424F8B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_424F8B
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_424F68
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		jmp	short loc_424F68
; ---------------------------------------------------------------------------

loc_424F4D:				; CODE XREF: sub_424C69+312j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_424F69
; ---------------------------------------------------------------------------

loc_424F68:				; CODE XREF: sub_424C69+2D0j
					; sub_424C69+2E2j
		nop

loc_424F69:				; CODE XREF: sub_424C69+2FDj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424F7D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_424F4D

loc_424F7D:				; CODE XREF: sub_424C69+308j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424F8B
		add	[ebp+var_C], 1

loc_424F8B:				; CODE XREF: sub_424C69+2B8j
					; sub_424C69+2C2j ...
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_4335FC ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_14], 3
		jmp	short loc_424FCA
; ---------------------------------------------------------------------------

loc_424FBA:				; CODE XREF: sub_424C69+367j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_424FCA:				; CODE XREF: sub_424C69+26Cj
					; sub_424C69+34Fj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_424FBA
		cmp	[ebp+var_C], 0
		jz	loc_42508D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_425082
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_425082
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_42501B
; ---------------------------------------------------------------------------

loc_42500B:				; CODE XREF: sub_424C69+3B8j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_42501B:				; CODE XREF: sub_424C69+3A0j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_42500B
		jmp	short loc_425082
; ---------------------------------------------------------------------------

loc_425025:				; CODE XREF: sub_424C69+422j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_42506B
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42507C
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_425061
; ---------------------------------------------------------------------------

loc_425051:				; CODE XREF: sub_424C69+3FEj
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_425061:				; CODE XREF: sub_424C69+3E6j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_425051
		jmp	short loc_42507C
; ---------------------------------------------------------------------------

loc_42506B:				; CODE XREF: sub_424C69+3C4j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_42507C:				; CODE XREF: sub_424C69+3D1j
					; sub_424C69+400j
		add	[ebp+var_C], 1
		jmp	short loc_425083
; ---------------------------------------------------------------------------

loc_425082:				; CODE XREF: sub_424C69+37Bj
					; sub_424C69+387j ...
		nop

loc_425083:				; CODE XREF: sub_424C69+417j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425025

loc_42508D:				; CODE XREF: sub_424C69+36Dj
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_42509C
; ---------------------------------------------------------------------------

loc_42509B:				; CODE XREF: sub_424C69+110j
		nop

loc_42509C:				; CODE XREF: sub_424C69+17Cj
					; sub_424C69+430j
		add	[ebp+var_10], 1

loc_4250A0:				; CODE XREF: sub_424C69+E1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_424D4F
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_4250C9
		mov	[esp+38h+Str], offset aASingleDashMay ;	"\n(A single dash may be used instead of"...
		call	puts

loc_4250C9:				; CODE XREF: sub_424C69+3Aj
					; sub_424C69+452j
		mov	[esp+38h+Str], 13h
		call	sub_425424
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_4251B0
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Size],	offset a@email@	; "@EMAIL@"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_425199
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jz	short loc_425149
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	ecx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_425149:				; CODE XREF: sub_424C69+4ADj
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aBugDirmngr@g_0 ; "bug-dirmngr@gnupg.org"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 15h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_1C], 7
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4251B0
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		jmp	short loc_4251B0
; ---------------------------------------------------------------------------

loc_425199:				; CODE XREF: sub_424C69+49Fj
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Size],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_4251B0:				; CODE XREF: sub_424C69+473j
					; sub_424C69+515j ...
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Str], eax ; File
		call	fflush
		mov	[esp+38h+Str], 0 ; Code
		call	exit
sub_424C69	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4251CC	proc near		; CODE XREF: sub_42435A+201p
					; sub_424C69+7p

Str		= dword	ptr -28h
File		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	[esp+28h+Str], 0Bh
		call	sub_425424
		mov	[esp+28h+File],	ebx ; File
		mov	[esp+28h+Str], eax ; Str
		call	fputs
		mov	[esp+28h+Str], 0Ch
		call	sub_425424
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42521C
		mov	eax, offset aS_5 ; " (%s)"
		mov	edx, [ebp+var_10]
		mov	[esp+28h+File],	edx
		mov	[esp+28h+Str], eax ; Format
		call	printf

loc_42521C:				; CODE XREF: sub_4251CC+3Aj
		mov	[esp+28h+Str], 0Dh
		call	sub_425424
		mov	edx, offset aS_6 ; " %s\n"
		mov	[esp+28h+File],	eax
		mov	[esp+28h+Str], edx ; Format
		call	printf
		mov	[ebp+var_C], 14h
		jmp	short loc_425265
; ---------------------------------------------------------------------------

loc_425242:				; CODE XREF: sub_4251CC+9Dj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_425424
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_425261
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_425261:				; CODE XREF: sub_4251CC+88j
		add	[ebp+var_C], 1

loc_425265:				; CODE XREF: sub_4251CC+74j
		cmp	[ebp+var_C], 1Dh
		jle	short loc_425242
		mov	[esp+28h+Str], 0Eh
		call	sub_425424
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42528B
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_42528B:				; CODE XREF: sub_4251CC+B2j
		mov	[esp+28h+Str], 0Ah
		call	sub_425424
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4252AB
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_4252AB:				; CODE XREF: sub_4251CC+D2j
		mov	[esp+28h+Str], 0Fh
		call	sub_425424
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4252D7
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_4252D7:				; CODE XREF: sub_4251CC+F2j
		mov	[esp+28h+Str], 12h
		call	sub_425424
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_425303
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_425303:				; CODE XREF: sub_4251CC+11Ej
		mov	[ebp+var_C], 1Eh
		jmp	short loc_42533B
; ---------------------------------------------------------------------------

loc_42530C:				; CODE XREF: sub_4251CC+173j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_425424
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_425337
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_425337:				; CODE XREF: sub_4251CC+152j
		add	[ebp+var_C], 1

loc_42533B:				; CODE XREF: sub_4251CC+13Ej
		cmp	[ebp+var_C], 27h
		jle	short loc_42530C
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_4251CC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4253C5
		mov	dword ptr [esp], 0Eh
		call	sub_425424
		mov	esi, eax
		mov	dword ptr [esp], 0Dh
		call	sub_425424
		mov	ebx, eax
		mov	dword ptr [esp], 0Bh
		call	sub_425424
		mov	edx, offset aSSS_0 ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+10h], esi
		mov	[esp+0Ch], ebx
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], ecx
		call	fprintf
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp], eax
		call	fflush
		jmp	short loc_42541D
; ---------------------------------------------------------------------------

loc_4253C5:				; CODE XREF: .text:00425363j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_4253F7
		mov	eax, ds:_iob
		lea	ebx, [eax+40h]
		mov	dword ptr [esp], 28h
		call	sub_425424
		mov	[esp+4], ebx
		mov	[esp], eax
		call	fputs
		mov	dword ptr [esp], 2
		call	exit
; ---------------------------------------------------------------------------

loc_4253F7:				; CODE XREF: .text:004253C9j
		cmp	dword ptr [ebp+8], 2
		jnz	short loc_42541D
		mov	dword ptr [esp], 29h
		call	sub_425424
		mov	[esp], eax
		call	puts
		mov	dword ptr [esp], 0
		call	exit
; ---------------------------------------------------------------------------

loc_42541D:				; CODE XREF: .text:004253C3j
					; .text:004253FBj
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425424	proc near		; CODE XREF: sub_4020C2+944p
					; sub_4020C2+952p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_435A00
		test	eax, eax
		jz	short loc_425443
		mov	edx, ds:dword_435A00
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_435A00
		jmp	short loc_425448
; ---------------------------------------------------------------------------

loc_425443:				; CODE XREF: sub_425424+Dj
		mov	eax, 0

loc_425448:				; CODE XREF: sub_425424+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_425456
		mov	eax, [ebp+var_C]
		jmp	short locret_4254AB
; ---------------------------------------------------------------------------

loc_425456:				; CODE XREF: sub_425424+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_4254A8 ; jumptable 00425468 default case
		mov	eax, ds:off_4339D4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_42546A:				; CODE XREF: sub_425424+44j
					; DATA XREF: .rdata:off_4339D4o
		mov	[ebp+var_C], offset aLicenseGplv3Gn ; jumptable	00425468 case 10
		jmp	short loc_4254A8 ; jumptable 00425468 default case
; ---------------------------------------------------------------------------

loc_425473:				; CODE XREF: sub_425424+44j
					; DATA XREF: .rdata:off_4339D4o
		mov	[ebp+var_C], offset aFoo ; jumptable 00425468 case 11
		jmp	short loc_4254A8 ; jumptable 00425468 default case
; ---------------------------------------------------------------------------

loc_42547C:				; CODE XREF: sub_425424+44j
					; DATA XREF: .rdata:off_4339D4o
		mov	[ebp+var_C], offset a0_0 ; jumptable 00425468 case 13
		jmp	short loc_4254A8 ; jumptable 00425468 default case
; ---------------------------------------------------------------------------

loc_425485:				; CODE XREF: sub_425424+44j
					; DATA XREF: .rdata:off_4339D4o
		mov	[ebp+var_C], offset aCopyrightC2010 ; jumptable	00425468 case 14
		jmp	short loc_4254A8 ; jumptable 00425468 default case
; ---------------------------------------------------------------------------

loc_42548E:				; CODE XREF: sub_425424+44j
					; DATA XREF: .rdata:off_4339D4o
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	00425468 case 15
		jmp	short loc_4254A8 ; jumptable 00425468 default case
; ---------------------------------------------------------------------------

loc_425497:				; CODE XREF: sub_425424+44j
					; DATA XREF: .rdata:off_4339D4o
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	00425468 case 16
		jmp	short loc_4254A8 ; jumptable 00425468 default case
; ---------------------------------------------------------------------------

loc_4254A0:				; CODE XREF: sub_425424+44j
					; DATA XREF: .rdata:off_4339D4o
		mov	[ebp+var_C], offset dword_4339D0 ; jumptable 00425468 cases 40,41
		nop

loc_4254A8:				; CODE XREF: sub_425424+3Bj
					; sub_425424+44j ...
		mov	eax, [ebp+var_C] ; jumptable 00425468 default case

locret_4254AB:				; CODE XREF: sub_425424+30j
		leave
		retn
sub_425424	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4254AD	proc near		; CODE XREF: sub_4020C2+121p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_435A00, eax
		pop	ebp
		retn
sub_4254AD	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_42558D
; ---------------------------------------------------------------------------

loc_4254E0:				; CODE XREF: .text:00425591j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_425585
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_425532
; ---------------------------------------------------------------------------

loc_425526:				; CODE XREF: .text:00425562j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_425532:				; CODE XREF: .text:00425524j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_425564
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_425526

loc_425564:				; CODE XREF: .text:00425536j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425573
		mov	eax, [ebp-18h]
		jmp	short loc_42559C
; ---------------------------------------------------------------------------

loc_425573:				; CODE XREF: .text:0042556Cj
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_425585:				; CODE XREF: .text:0042550Aj
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_42558D:				; CODE XREF: .text:004254DBj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_4254E0
		mov	eax, 0

loc_42559C:				; CODE XREF: .text:00425571j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_42566B
; ---------------------------------------------------------------------------

loc_4255C6:				; CODE XREF: .text:0042566Fj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4262DF
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4262DF
		cmp	ebx, eax
		jnz	short loc_425663
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_425614
; ---------------------------------------------------------------------------

loc_425608:				; CODE XREF: .text:00425640j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_425614:				; CODE XREF: .text:00425606j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_425642
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4262DF
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_4262DF
		cmp	ebx, eax
		jz	short loc_425608

loc_425642:				; CODE XREF: .text:00425618j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425651
		mov	eax, [ebp-18h]
		jmp	short loc_42567A
; ---------------------------------------------------------------------------

loc_425651:				; CODE XREF: .text:0042564Aj
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_425663:				; CODE XREF: .text:004255ECj
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_42566B:				; CODE XREF: .text:004255C1j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_4255C6
		mov	eax, 0

loc_42567A:				; CODE XREF: .text:0042564Fj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_4256DF
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4256A0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp+8], eax

loc_4256A0:				; CODE XREF: .text:00425690j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_4256C9
; ---------------------------------------------------------------------------

loc_4256B2:				; CODE XREF: .text:004256D7j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_4256C9:				; CODE XREF: .text:004256B0j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_4256D9
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4256B2

loc_4256D9:				; CODE XREF: .text:004256CDj
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_4256DF:				; CODE XREF: .text:0042568Aj
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4256E4	proc near		; CODE XREF: sub_40C2F3+62p
					; sub_423B0A+29Cp ...

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_4256FC
; ---------------------------------------------------------------------------

loc_4256F8:				; CODE XREF: sub_4256E4+37j
		add	[ebp+var_10], 1

loc_4256FC:				; CODE XREF: sub_4256E4+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42571D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:__imp_isspace
		call	eax ; __imp_isspace
		test	eax, eax
		jnz	short loc_4256F8

loc_42571D:				; CODE XREF: sub_4256E4+20j
		mov	[ebp+var_14], 0
		jmp	short loc_42575A
; ---------------------------------------------------------------------------

loc_425726:				; CODE XREF: sub_4256E4+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:__imp_isspace
		call	eax ; __imp_isspace
		test	eax, eax
		jz	short loc_42574B
		cmp	[ebp+var_14], 0
		jnz	short loc_425752
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_425752
; ---------------------------------------------------------------------------

loc_42574B:				; CODE XREF: sub_4256E4+57j
		mov	[ebp+var_14], 0

loc_425752:				; CODE XREF: sub_4256E4+5Dj
					; sub_4256E4+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_42575A:				; CODE XREF: sub_4256E4+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425726
		cmp	[ebp+var_14], 0
		jz	short loc_42577B
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_42577B:				; CODE XREF: sub_4256E4+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_4256E4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_4257C5
; ---------------------------------------------------------------------------

loc_425795:				; CODE XREF: .text:004257CDj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:__imp_isspace
		call	eax ; __imp_isspace
		test	eax, eax
		jz	short loc_4257BA
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_4257C1
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_4257C1
; ---------------------------------------------------------------------------

loc_4257BA:				; CODE XREF: .text:004257AAj
		mov	dword ptr [ebp-10h], 0

loc_4257C1:				; CODE XREF: .text:004257B0j
					; .text:004257B8j
		add	dword ptr [ebp-0Ch], 1

loc_4257C5:				; CODE XREF: .text:00425793j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425795
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_4257DB
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_4257DB:				; CODE XREF: .text:004257D3j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4257E0(int, int, char	*)
sub_4257E0	proc near		; CODE XREF: .text:00425877p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_425835
; ---------------------------------------------------------------------------

loc_4257FC:				; CODE XREF: sub_4257E0+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_425826
		cmp	[ebp+var_10], 0
		jnz	short loc_42582D
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_42582D
; ---------------------------------------------------------------------------

loc_425826:				; CODE XREF: sub_4257E0+36j
		mov	[ebp+var_10], 0

loc_42582D:				; CODE XREF: sub_4257E0+3Cj
					; sub_4257E0+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_425835:				; CODE XREF: sub_4257E0+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_4257FC
		cmp	[ebp+var_10], 0
		jz	short loc_425857
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_42585A
; ---------------------------------------------------------------------------

loc_425857:				; CODE XREF: sub_4257E0+61j
		mov	eax, [ebp+arg_4]

locret_42585A:				; CODE XREF: sub_4257E0+75j
		leave
		retn
sub_4257E0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_433A54 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4257E0
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42587E(int, int, char	*)
sub_42587E	proc near		; CODE XREF: .text:0042590Fp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4258D3
; ---------------------------------------------------------------------------

loc_42589A:				; CODE XREF: sub_42587E+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4258C4
		cmp	[ebp+var_10], 0
		jnz	short loc_4258CB
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_4258CB
; ---------------------------------------------------------------------------

loc_4258C4:				; CODE XREF: sub_42587E+36j
		mov	[ebp+var_10], 0

loc_4258CB:				; CODE XREF: sub_42587E+3Cj
					; sub_42587E+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_4258D3:				; CODE XREF: sub_42587E+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_42589A
		cmp	[ebp+var_10], 0
		jz	short loc_4258EF
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_4258F2
; ---------------------------------------------------------------------------

loc_4258EF:				; CODE XREF: sub_42587E+61j
		mov	eax, [ebp+arg_4]

locret_4258F2:				; CODE XREF: sub_42587E+6Fj
		leave
		retn
sub_42587E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_433A54 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42587E
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_425945
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		jmp	short locret_425953
; ---------------------------------------------------------------------------

loc_425945:				; CODE XREF: .text:00425936j
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xstrdup

locret_425953:				; CODE XREF: .text:00425943j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_425985
		mov	dword ptr [esp], offset	a__1 ; "."
		call	gcry_xstrdup
		jmp	short locret_4259CA
; ---------------------------------------------------------------------------

loc_425985:				; CODE XREF: .text:00425975j
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_4259CA:				; CODE XREF: .text:00425983j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4259CC	proc near		; CODE XREF: sub_4020C2+4A5p
					; sub_4020C2+A17p ...

VarName		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_20]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_425A2B
; ---------------------------------------------------------------------------

loc_425A03:				; CODE XREF: sub_4259CC+71j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax

loc_425A2B:				; CODE XREF: sub_4259CC+35j
		mov	eax, [ebp+var_20]
		lea	edx, [eax+4]
		mov	[ebp+var_20], edx
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_425A03
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	short loc_425A9E
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_425A9E
		mov	[esp+48h+VarName], offset aHome	; "HOME"
		call	getenv
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_425A9E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_425A9E
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_C], eax

loc_425A9E:				; CODE XREF: sub_4259CC+82j
					; sub_4259CC+8Fj ...
		mov	eax, [ebp+var_C]
		mov	[esp+48h+VarName], eax
		call	gcry_xmalloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_10], 0
		jz	short loc_425AD8
		mov	eax, [ebp+arg_0]
		lea	ebx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+VarName], eax
		call	sub_4265EB
		mov	[esp+48h+var_44], ebx
		mov	[esp+48h+VarName], eax
		call	sub_4265EB
		jmp	short loc_425AEA
; ---------------------------------------------------------------------------

loc_425AD8:				; CODE XREF: sub_4259CC+E4j
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+VarName], eax
		call	sub_4265EB

loc_425AEA:				; CODE XREF: sub_4259CC+10Aj
		mov	[ebp+var_14], eax
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_20]
		mov	[eax], edx
		jmp	short loc_425B17
; ---------------------------------------------------------------------------

loc_425AF7:				; CODE XREF: sub_4259CC+15Dj
		mov	eax, [ebp+var_14]
		mov	word ptr [eax],	2Fh
		mov	eax, [ebp+var_14]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+VarName], edx
		call	sub_4265EB
		mov	[ebp+var_14], eax

loc_425B17:				; CODE XREF: sub_4259CC+129j
		mov	eax, [ebp+var_20]
		lea	edx, [eax+4]
		mov	[ebp+var_20], edx
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_425AF7
		mov	eax, [ebp+var_1C]
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4259CC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strcmp
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425B4F	proc near		; CODE XREF: sub_40D93E+480p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_425B7D
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_425B7D
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp+var_4], eax
		jmp	short loc_425BD4
; ---------------------------------------------------------------------------

loc_425B7D:				; CODE XREF: sub_425B4F+Ej
					; sub_425B4F+18j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_425BA5
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_425BA5
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp+var_4], eax
		jmp	short loc_425BD4
; ---------------------------------------------------------------------------

loc_425BA5:				; CODE XREF: sub_425B4F+36j
					; sub_425B4F+40j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_425BCD
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_425BCD
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp+var_4], eax
		jmp	short loc_425BD4
; ---------------------------------------------------------------------------

loc_425BCD:				; CODE XREF: sub_425B4F+5Ej
					; sub_425B4F+68j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_425C51
; ---------------------------------------------------------------------------

loc_425BD4:				; CODE XREF: sub_425B4F+2Cj
					; sub_425B4F+54j ...
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_425BFD
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_425BFD
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp+var_4], eax
		jmp	short loc_425C4E
; ---------------------------------------------------------------------------

loc_425BFD:				; CODE XREF: sub_425B4F+91j
					; sub_425B4F+9Bj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_425C22
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_425C22
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp+var_4], eax
		jmp	short loc_425C4E
; ---------------------------------------------------------------------------

loc_425C22:				; CODE XREF: sub_425B4F+B6j
					; sub_425B4F+C0j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_425C47
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_425C47
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp+var_4], eax
		jmp	short loc_425C4E
; ---------------------------------------------------------------------------

loc_425C47:				; CODE XREF: sub_425B4F+DBj
					; sub_425B4F+E5j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_425C51
; ---------------------------------------------------------------------------

loc_425C4E:				; CODE XREF: sub_425B4F+ACj
					; sub_425B4F+D1j ...
		mov	eax, [ebp+var_4]

locret_425C51:				; CODE XREF: sub_425B4F+83j
					; sub_425B4F+FDj
		leave
		retn
sub_425B4F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_425C53(FILE *, int, int, int,	int)
sub_425C53	proc near		; CODE XREF: sub_425E16+29p
					; .text:00425F53p

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_425E07
; ---------------------------------------------------------------------------

loc_425C6B:				; CODE XREF: sub_425C53+1B8j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_425CC3
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jbe	short loc_425C89
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9Fh
		jbe	short loc_425CC3

loc_425C89:				; CODE XREF: sub_425C53+2Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_425CC3
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_425CC3
		cmp	[ebp+arg_C], 0
		jnz	short loc_425CB5
		cmp	[ebp+arg_10], 0
		jz	loc_425DDF

loc_425CB5:				; CODE XREF: sub_425C53+56j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_425DDF

loc_425CC3:				; CODE XREF: sub_425C53+20j
					; sub_425C53+34j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_425D00
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_425DFB
; ---------------------------------------------------------------------------

loc_425D00:				; CODE XREF: sub_425C53+8Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_425D26
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_425DFB
; ---------------------------------------------------------------------------

loc_425D26:				; CODE XREF: sub_425C53+B5j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_425D4C
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_425DFB
; ---------------------------------------------------------------------------

loc_425D4C:				; CODE XREF: sub_425C53+DBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_425D72
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_425DFB
; ---------------------------------------------------------------------------

loc_425D72:				; CODE XREF: sub_425C53+101j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_425D95
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_425DFB
; ---------------------------------------------------------------------------

loc_425D95:				; CODE XREF: sub_425C53+127j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425DB8
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_425DFB
; ---------------------------------------------------------------------------

loc_425DB8:				; CODE XREF: sub_425C53+14Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_425DFB
; ---------------------------------------------------------------------------

loc_425DDF:				; CODE XREF: sub_425C53+5Cj
					; sub_425C53+6Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_425DFB:				; CODE XREF: sub_425C53+A8j
					; sub_425C53+CEj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_425E07:				; CODE XREF: sub_425C53+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_425C6B
		mov	eax, [ebp+var_10]
		leave
		retn
sub_425C53	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_425E16(FILE *, int, int, int)
sub_425E16	proc near		; CODE XREF: sub_425E46+B7p
					; .text:00425FA9p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_425C53
		leave
		retn
sub_425E16	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_425E46(FILE *, int, int, int)
sub_425E46	proc near		; CODE XREF: .text:00425FFFp

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_425E6F
; ---------------------------------------------------------------------------

loc_425E5C:				; CODE XREF: sub_425E46+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_425E79
		add	[ebp+var_C], 1

loc_425E6F:				; CODE XREF: sub_425E46+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_425E5C
		jmp	short loc_425E7A
; ---------------------------------------------------------------------------

loc_425E79:				; CODE XREF: sub_425E46+23j
		nop

loc_425E7A:				; CODE XREF: sub_425E46+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_425EE2
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_42795C
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_425F02
; ---------------------------------------------------------------------------

loc_425EE2:				; CODE XREF: sub_425E46+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_425E16

loc_425F02:				; CODE XREF: sub_425E46+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_425E46	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_425F5A
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_425C53
		jmp	short loc_425F5F
; ---------------------------------------------------------------------------

loc_425F5A:				; CODE XREF: .text:00425F13j
		mov	eax, 0

loc_425F5F:				; CODE XREF: .text:00425F58j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_425FB0
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_425E16
		jmp	short loc_425FB5
; ---------------------------------------------------------------------------

loc_425FB0:				; CODE XREF: .text:00425F70j
		mov	eax, 0

loc_425FB5:				; CODE XREF: .text:00425FAEj
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_426006
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_425E46
		jmp	short loc_42600B
; ---------------------------------------------------------------------------

loc_426006:				; CODE XREF: .text:00425FC6j
		mov	eax, 0

loc_42600B:				; CODE XREF: .text:00426004j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 1
		jmp	loc_4260BB
; ---------------------------------------------------------------------------

loc_426035:				; CODE XREF: .text:004260BFj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_426067
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_426067
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_426067
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_4260AF
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4260AF

loc_426067:				; CODE XREF: .text:0042603Dj
					; .text:00426047j ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4260A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_4260A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_4260A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_4260A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_4260A3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4260A9

loc_4260A3:				; CODE XREF: .text:0042606Fj
					; .text:00426079j ...
		add	dword ptr [ebp-10h], 2
		jmp	short loc_4260B3
; ---------------------------------------------------------------------------

loc_4260A9:				; CODE XREF: .text:004260A1j
		add	dword ptr [ebp-10h], 5
		jmp	short loc_4260B3
; ---------------------------------------------------------------------------

loc_4260AF:				; CODE XREF: .text:0042605Bj
					; .text:00426065j
		add	dword ptr [ebp-10h], 1

loc_4260B3:				; CODE XREF: .text:004260A7j
					; .text:004260ADj
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_4260BB:				; CODE XREF: .text:00426030j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_426035
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-18h]
		mov	[ebp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-14h], eax
		jmp	loc_4261F8
; ---------------------------------------------------------------------------

loc_4260EA:				; CODE XREF: .text:004261FCj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_426124
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_426124
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_426124
		cmp	dword ptr [ebp+10h], 0
		jz	loc_4261DF
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4261DF

loc_426124:				; CODE XREF: .text:004260F2j
					; .text:004260FCj ...
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_426147
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	6Eh
		add	dword ptr [ebp-14h], 1
		jmp	loc_4261F0
; ---------------------------------------------------------------------------

loc_426147:				; CODE XREF: .text:00426136j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_426160
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	72h
		add	dword ptr [ebp-14h], 1
		jmp	loc_4261F0
; ---------------------------------------------------------------------------

loc_426160:				; CODE XREF: .text:0042614Fj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_426176
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	66h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_4261F0
; ---------------------------------------------------------------------------

loc_426176:				; CODE XREF: .text:00426168j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_42618C
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	76h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_4261F0
; ---------------------------------------------------------------------------

loc_42618C:				; CODE XREF: .text:0042617Ej
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_4261A2
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	62h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_4261F0
; ---------------------------------------------------------------------------

loc_4261A2:				; CODE XREF: .text:00426194j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4261B8
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	30h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_4261F0
; ---------------------------------------------------------------------------

loc_4261B8:				; CODE XREF: .text:004261AAj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sprintf
		add	dword ptr [ebp-14h], 3
		jmp	short loc_4261F0
; ---------------------------------------------------------------------------

loc_4261DF:				; CODE XREF: .text:00426110j
					; .text:0042611Ej
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1

loc_4261F0:				; CODE XREF: .text:00426142j
					; .text:0042615Bj ...
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_4261F8:				; CODE XREF: .text:004260E5j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_4260EA
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_426239
; ---------------------------------------------------------------------------

loc_42621C:				; CODE XREF: .text:00426241j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_426235
		add	dword ptr [ebp-4], 1

loc_426235:				; CODE XREF: .text:0042622Fj
		add	dword ptr [ebp+8], 1

loc_426239:				; CODE XREF: .text:0042621Aj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42621C
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_426248(DWORD)
sub_426248	proc near		; CODE XREF: sub_4216D5+32Dp
					; sub_421B43+80p ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_42625E
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_42625E:				; CODE XREF: sub_426248+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_426248	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_4262BB
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_4262BB
		mov	eax, 1
		jmp	short loc_4262C0
; ---------------------------------------------------------------------------

loc_4262BB:				; CODE XREF: .text:004262ACj
					; .text:004262B2j
		mov	eax, 0

loc_4262C0:				; CODE XREF: .text:004262B9j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_4262D8
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_4262D8
		mov	eax, 1
		jmp	short loc_4262DD
; ---------------------------------------------------------------------------

loc_4262D8:				; CODE XREF: .text:004262C9j
					; .text:004262CFj
		mov	eax, 0

loc_4262DD:				; CODE XREF: .text:004262D6j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4262DF	proc near		; CODE XREF: .text:004255D2p
					; .text:004255E5p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_4262F2
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_4262F2
		and	[ebp+arg_0], 0FFFFFFDFh

loc_4262F2:				; CODE XREF: sub_4262DF+7j
					; sub_4262DF+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_4262DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4262F7	proc near		; CODE XREF: sub_40957E+1DAp
					; sub_4263C9+33p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_42630A
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_42630A
		or	[ebp+arg_0], 20h

loc_42630A:				; CODE XREF: sub_4262F7+7j
					; sub_4262F7+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_4262F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42630F	proc near		; CODE XREF: sub_412CC5+1FFp
					; sub_412CC5+242p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_42636A
		mov	eax, 0
		jmp	loc_4263C3
; ---------------------------------------------------------------------------

loc_426328:				; CODE XREF: sub_42630F+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_426360
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_4262DF
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_4262DF
		cmp	ebx, eax
		jnz	short loc_426381

loc_426360:				; CODE XREF: sub_42630F+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_42636B
; ---------------------------------------------------------------------------

loc_42636A:				; CODE XREF: sub_42630F+Dj
		nop

loc_42636B:				; CODE XREF: sub_42630F+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_426382
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_426328
		jmp	short loc_426382
; ---------------------------------------------------------------------------

loc_426381:				; CODE XREF: sub_42630F+4Fj
		nop

loc_426382:				; CODE XREF: sub_42630F+64j
					; sub_42630F+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4263BE
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_4262DF
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_4262DF
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_4263C3
; ---------------------------------------------------------------------------

loc_4263BE:				; CODE XREF: sub_42630F+81j
		mov	eax, 0

loc_4263C3:				; CODE XREF: sub_42630F+14j
					; sub_42630F+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_42630F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4263C9	proc near		; CODE XREF: sub_418114+1AFp
					; sub_418114+1CEp

var_14		= dword	ptr -14h
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+var_8]
		jz	short loc_4263E9
		cmp	[ebp+arg_8], 0
		jnz	short loc_4263F0

loc_4263E9:				; CODE XREF: sub_4263C9+18j
		mov	eax, 0
		jmp	short locret_426447
; ---------------------------------------------------------------------------

loc_4263F0:				; CODE XREF: sub_4263C9+1Ej
					; sub_4263C9+6Ej
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+14h+var_14], eax
		call	sub_4262F7
		mov	[ebp+var_9], al
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+14h+var_14], eax
		call	sub_4262F7
		mov	[ebp+var_A], al
		sub	[ebp+arg_8], 1
		cmp	[ebp+arg_8], 0
		jz	short loc_426439
		cmp	[ebp+var_9], 0
		jz	short loc_426439
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1
		movzx	eax, [ebp+var_9]
		cmp	al, [ebp+var_A]
		jz	short loc_4263F0

loc_426439:				; CODE XREF: sub_4263C9+57j
					; sub_4263C9+5Dj
		movzx	edx, [ebp+var_9]
		movzx	eax, [ebp+var_A]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_426447:				; CODE XREF: sub_4263C9+25j
		leave
		retn
sub_4263C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426449	proc near		; CODE XREF: .text:004265CAp
					; .text:00426D13p

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_4264F9
		mov	eax, 0
		jmp	loc_426508
; ---------------------------------------------------------------------------

loc_426472:				; CODE XREF: sub_426449+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4264ED
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_4262DF
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_4262DF
		cmp	ebx, eax
		jz	short loc_4264ED
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4264E6
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_4262DF
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_4262DF
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_4264EB
; ---------------------------------------------------------------------------

loc_4264E6:				; CODE XREF: sub_426449+6Fj
		mov	eax, 0

loc_4264EB:				; CODE XREF: sub_426449+9Bj
		jmp	short loc_426508
; ---------------------------------------------------------------------------

loc_4264ED:				; CODE XREF: sub_426449+37j
					; sub_426449+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_4264F9:				; CODE XREF: sub_426449+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_426472
		mov	eax, 0

loc_426508:				; CODE XREF: sub_426449+24j
					; sub_426449:loc_4264EBj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_426449	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_42653A
		mov	eax, 0
		jmp	short loc_426581
; ---------------------------------------------------------------------------

loc_426520:				; CODE XREF: .text:0042654Dj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_426551
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_42653B
; ---------------------------------------------------------------------------

loc_42653A:				; CODE XREF: .text:00426517j
		nop

loc_42653B:				; CODE XREF: .text:00426538j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_426552
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_426520
		jmp	short loc_426552
; ---------------------------------------------------------------------------

loc_426551:				; CODE XREF: .text:0042652Ej
		nop

loc_426552:				; CODE XREF: .text:00426543j
					; .text:0042654Fj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_42657C
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_426581
; ---------------------------------------------------------------------------

loc_42657C:				; CODE XREF: .text:00426560j
		mov	eax, 0

loc_426581:				; CODE XREF: .text:0042651Ej
					; .text:0042657Aj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_426594
		mov	eax, [ebp+8]
		jmp	short locret_4265E9
; ---------------------------------------------------------------------------

loc_426594:				; CODE XREF: .text:0042658Dj
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_4265E4
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_4265DC
; ---------------------------------------------------------------------------

loc_4265B6:				; CODE XREF: .text:004265E2j
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_426449
		test	eax, eax
		jnz	short loc_4265D8
		mov	eax, [ebp-4]
		jmp	short locret_4265E9
; ---------------------------------------------------------------------------

loc_4265D8:				; CODE XREF: .text:004265D1j
		add	dword ptr [ebp-4], 1

loc_4265DC:				; CODE XREF: .text:004265B4j
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_4265B6

loc_4265E4:				; CODE XREF: .text:0042659Aj
		mov	eax, 0

locret_4265E9:				; CODE XREF: .text:00426592j
					; .text:004265D6j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4265EB	proc near		; CODE XREF: sub_40486E+69p
					; sub_404A97+146p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_426603
; ---------------------------------------------------------------------------

loc_4265F0:				; CODE XREF: sub_4265EB+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_426603:				; CODE XREF: sub_4265EB+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4265F0
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_4265EB	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_426636
		mov	eax, 0
		jmp	locret_4266E1
; ---------------------------------------------------------------------------

loc_426636:				; CODE XREF: .text:0042662Aj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42664D
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4266A6

loc_42664D:				; CODE XREF: .text:0042663Ej
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_426665
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4266BB
; ---------------------------------------------------------------------------

loc_426665:				; CODE XREF: .text:0042665Aj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_426678
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_4266BB
; ---------------------------------------------------------------------------

loc_426678:				; CODE XREF: .text:0042666Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42668B
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4266BB
; ---------------------------------------------------------------------------

loc_42668B:				; CODE XREF: .text:00426680j
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_4266BB
; ---------------------------------------------------------------------------

loc_4266A6:				; CODE XREF: .text:0042664Bj
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_4266BB:				; CODE XREF: .text:00426663j
					; .text:00426676j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4266D5
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_4266DE
; ---------------------------------------------------------------------------

loc_4266D5:				; CODE XREF: .text:004266BFj
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_4266DE:				; CODE XREF: .text:004266D3j
		mov	eax, [ebp-10h]

locret_4266E1:				; CODE XREF: .text:00426631j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4266E3	proc near		; CODE XREF: sub_41A552+30p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		add	[ebp+var_4], eax
		jmp	short loc_426712
; ---------------------------------------------------------------------------

loc_4266F7:				; CODE XREF: sub_4266E3+33j
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_4]
		jnz	short loc_42670E
		mov	eax, [ebp+var_4]
		jmp	short locret_42671D
; ---------------------------------------------------------------------------

loc_42670E:				; CODE XREF: sub_4266E3+24j
		sub	[ebp+arg_8], 1

loc_426712:				; CODE XREF: sub_4266E3+12j
		cmp	[ebp+arg_8], 0
		jnz	short loc_4266F7
		mov	eax, 0

locret_42671D:				; CODE XREF: sub_4266E3+29j
		leave
		retn
sub_4266E3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42671F(int, char *)
sub_42671F	proc near		; CODE XREF: sub_4020C2+1144p
					; sub_4020C2+121Cp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_426735
		mov	eax, 0
		jmp	locret_426904
; ---------------------------------------------------------------------------

loc_426735:				; CODE XREF: sub_42671F+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_42678B
; ---------------------------------------------------------------------------

loc_426744:				; CODE XREF: sub_42671F+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_426783
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_426783
		cmp	[ebp+arg_4], 0
		jz	short loc_426787
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_426787

loc_426783:				; CODE XREF: sub_42671F+30j
					; sub_42671F+3Dj
		add	[ebp+var_10], 1

loc_426787:				; CODE XREF: sub_42671F+43j
					; sub_42671F+62j
		add	[ebp+var_C], 1

loc_42678B:				; CODE XREF: sub_42671F+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_426744
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_4268EA
; ---------------------------------------------------------------------------

loc_4267BA:				; CODE XREF: sub_42671F+1D3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_4267F0
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_4268E6
; ---------------------------------------------------------------------------

loc_4267F0:				; CODE XREF: sub_42671F+A3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_426826
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_4268E6
; ---------------------------------------------------------------------------

loc_426826:				; CODE XREF: sub_42671F+D9j
		cmp	[ebp+arg_4], 0
		jz	loc_4268D4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_4268D4
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_426887
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_426893
; ---------------------------------------------------------------------------

loc_426887:				; CODE XREF: sub_42671F+158j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_426893:				; CODE XREF: sub_42671F+166j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4268C0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_4268CC
; ---------------------------------------------------------------------------

loc_4268C0:				; CODE XREF: sub_42671F+191j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_4268CC:				; CODE XREF: sub_42671F+19Fj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_4268E6
; ---------------------------------------------------------------------------

loc_4268D4:				; CODE XREF: sub_42671F+10Bj
					; sub_42671F+12Bj
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_4268E6:				; CODE XREF: sub_42671F+CCj
					; sub_42671F+102j ...
		add	[ebp+arg_0], 1

loc_4268EA:				; CODE XREF: sub_42671F+96j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4267BA
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_426904:				; CODE XREF: sub_42671F+11j
		leave
		retn
sub_42671F	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_426908(LPCSTR)
sub_426908	proc near		; CODE XREF: sub_4269C2+2Cp

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_426908	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_426926(HMODULE, LPCSTR)
sub_426926	proc near		; CODE XREF: sub_4269C2+48p
					; sub_4269C2+69p ...

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_426964
		cmp	[ebp+arg_4], 0
		jz	short loc_426964
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42695F
		mov	eax, 0
		jmp	short locret_426969
; ---------------------------------------------------------------------------

loc_42695F:				; CODE XREF: sub_426926+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_426969
; ---------------------------------------------------------------------------

loc_426964:				; CODE XREF: sub_426926+Aj
					; sub_426926+10j
		mov	eax, 0

locret_426969:				; CODE XREF: sub_426926+37j
					; sub_426926+3Cj
		leave
		retn
sub_426926	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42696B	proc near		; CODE XREF: sub_4269C2:loc_426A65p

Dest		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, offset aEcLu ; "ec=%lu"
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+Format], edx ;	Format
		mov	[esp+18h+Dest],	offset byte_435B80 ; Dest
		call	sprintf
		mov	eax, offset byte_435B80
		leave
		retn
sub_42696B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_426998(HANDLE)
sub_426998	proc near		; CODE XREF: sub_4269C2+F6p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_4269BB
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_4269C0
; ---------------------------------------------------------------------------

loc_4269BB:				; CODE XREF: sub_426998+Aj
		mov	eax, 0FFFFFFFFh

locret_4269C0:				; CODE XREF: sub_426998+21j
		leave
		retn
sub_426998	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4269C2	proc near		; CODE XREF: .text:loc_426E26p
					; .text:0042798Cp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_435B6C
		test	eax, eax
		jnz	loc_426ABD
		mov	ds:dword_435B6C, 1
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset aIconv_dll ; "iconv.dll"
		call	sub_426908
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_426A56
		mov	[esp+28h+var_24], offset aLibiconv_open	; "libiconv_open"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HMODULE
		call	sub_426926
		mov	ds:dword_435B2C, eax
		mov	eax, ds:dword_435B2C
		test	eax, eax
		jz	short loc_426A35
		mov	[esp+28h+var_24], offset aLibiconv ; "libiconv"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HMODULE
		call	sub_426926
		mov	ds:dword_435B30, eax

loc_426A35:				; CODE XREF: sub_4269C2+59j
		mov	eax, ds:dword_435B30
		test	eax, eax
		jz	short loc_426A56
		mov	[esp+28h+var_24], offset aLibiconv_close ; "libiconv_close"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HMODULE
		call	sub_426926
		mov	ds:dword_435B34, eax

loc_426A56:				; CODE XREF: sub_4269C2+38j
					; sub_4269C2+7Aj
		cmp	[ebp+var_C], 0
		jz	short loc_426A65
		mov	eax, ds:dword_435B34
		test	eax, eax
		jnz	short loc_426ABD

loc_426A65:				; CODE XREF: sub_4269C2+98j
		call	sub_42696B
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], offset aIconv_dll ; "iconv.dll"
		mov	[esp+28h+var_28], offset aErrorLoadingSS ; "error loading `%s': %s\n"
		call	sub_423387
		mov	[esp+28h+var_28], offset aPleaseSeeHttpW ; "please see http://www.gnupg.org/downloa"...
		call	sub_423387
		mov	ds:dword_435B2C, 0
		mov	ds:dword_435B30, 0
		mov	ds:dword_435B34, 0
		cmp	[ebp+var_C], 0
		jz	short loc_426ABD
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HANDLE
		call	sub_426998

loc_426ABD:				; CODE XREF: sub_4269C2+Dj
					; sub_4269C2+A1j ...
		mov	eax, ds:dword_435B2C
		test	eax, eax
		jz	short loc_426ACD
		mov	eax, 0
		jmp	short locret_426AD2
; ---------------------------------------------------------------------------

loc_426ACD:				; CODE XREF: sub_4269C2+102j
		mov	eax, 0FFFFFFFFh

locret_426AD2:				; CODE XREF: sub_4269C2+109j
		leave
		retn
sub_4269C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426AD4	proc near		; CODE XREF: .text:00426E71p
					; .text:00426EC9p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_426B60
		cmp	[ebp+arg_0], 0
		jz	short loc_426B2C
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_426B2C
		mov	eax, ds:dword_435B60
		mov	[ebp+var_C], eax
		mov	ds:dword_435B60, 1
		jmp	short loc_426B3E
; ---------------------------------------------------------------------------

loc_426B2C:				; CODE XREF: sub_426AD4+1Aj
					; sub_426AD4+42j
		mov	eax, ds:dword_435B64
		mov	[ebp+var_C], eax
		mov	ds:dword_435B64, 1

loc_426B3E:				; CODE XREF: sub_426AD4+56j
		cmp	[ebp+var_C], 0
		jnz	short loc_426B94
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_423387
		jmp	short loc_426B94
; ---------------------------------------------------------------------------

loc_426B60:				; CODE XREF: sub_426AD4+14j
		mov	eax, ds:dword_435B68
		test	eax, eax
		jnz	short loc_426B8A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_423387

loc_426B8A:				; CODE XREF: sub_426AD4+93j
		mov	ds:dword_435B68, 1

loc_426B94:				; CODE XREF: sub_426AD4+6Ej
					; sub_426AD4+8Aj
		cmp	[ebp+arg_8], 0
		jz	short loc_426BC2
		mov	off_42B5AC, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_435B24, 0
		mov	ds:dword_435B20, 0
		mov	ds:dword_435B28, 0

loc_426BC2:				; CODE XREF: sub_426AD4+C4j
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_426AD4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jnz	loc_426CD3
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_426BF4
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp-0Ch], eax

loc_426BF4:				; CODE XREF: .text:00426BE8j
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp-0Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_435B40
		call	sprintf
		mov	dword ptr [ebp+8], offset dword_435B40
		mov	dword ptr [ebp-10h], offset aCp936 ; "CP936"
		jmp	loc_426CC5
; ---------------------------------------------------------------------------

loc_426C23:				; CODE XREF: .text:00426CCDj
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_435B40
		call	strcmp
		test	eax, eax
		jz	short loc_426C51
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_426C7B
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_426C7B

loc_426C51:				; CODE XREF: .text:00426C38j
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp-10h]
		mov	[ebp+8], eax
		jmp	short loc_426CD3
; ---------------------------------------------------------------------------

loc_426C7B:				; CODE XREF: .text:00426C42j
					; .text:00426C4Fj
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax

loc_426CC5:				; CODE XREF: .text:00426C1Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_426C23

loc_426CD3:				; CODE XREF: .text:00426BD4j
					; .text:00426C79j
		mov	eax, [ebp+8]
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_426D38
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], offset aIso ; "iso"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_426449
		test	eax, eax
		jnz	short loc_426D38
		add	dword ptr [ebp+8], 3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_426D34
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_426D38

loc_426D34:				; CODE XREF: .text:00426D28j
		add	dword ptr [ebp+8], 1

loc_426D38:				; CODE XREF: .text:00426CFBj
					; .text:00426D1Aj ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_426D9E
		mov	dword ptr [esp+4], offset a88591 ; "8859-1"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42630F
		test	eax, eax
		jz	short loc_426D9E
		mov	dword ptr [esp+4], offset a646 ; "646"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42630F
		test	eax, eax
		jz	short loc_426D9E
		mov	dword ptr [esp+4], offset aAscii ; "ASCII"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42630F
		test	eax, eax
		jz	short loc_426D9E
		mov	dword ptr [esp+4], offset aAnsi_x3_41968 ; "ANSI_X3.4-1968"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42630F
		test	eax, eax
		jnz	short loc_426DCB

loc_426D9E:				; CODE XREF: .text:00426D40j
					; .text:00426D57j ...
		mov	off_42B5AC, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_435B24, 0
		mov	ds:dword_435B20, 0
		mov	ds:dword_435B28, 0
		jmp	loc_426F0C
; ---------------------------------------------------------------------------

loc_426DCB:				; CODE XREF: .text:00426D9Cj
		mov	dword ptr [esp+4], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42630F
		test	eax, eax
		jz	short loc_426DF9
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42630F
		test	eax, eax
		jnz	short loc_426E26

loc_426DF9:				; CODE XREF: .text:00426DE0j
		mov	off_42B5AC, offset aUtf8 ; "utf-8"
		mov	ds:dword_435B24, 1
		mov	ds:dword_435B20, 0
		mov	ds:dword_435B28, 0
		jmp	loc_426F0C
; ---------------------------------------------------------------------------

loc_426E26:				; CODE XREF: .text:00426DF7j
		call	sub_4269C2
		test	eax, eax
		jz	short loc_426E39
		mov	eax, 0FFFFFFFFh
		jmp	loc_426F11
; ---------------------------------------------------------------------------

loc_426E39:				; CODE XREF: .text:00426E2Dj
		mov	edx, ds:dword_435B2C
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	edx ; dword_435B2C
		sub	esp, 8
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_426E80
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_426AD4
		mov	eax, 0FFFFFFFFh
		jmp	loc_426F11
; ---------------------------------------------------------------------------

loc_426E80:				; CODE XREF: .text:00426E59j
		mov	edx, ds:dword_435B34
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	edx ; dword_435B34
		sub	esp, 4
		mov	edx, ds:dword_435B2C
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	edx ; dword_435B2C
		sub	esp, 8
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_426ED5
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	sub_426AD4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_426F11
; ---------------------------------------------------------------------------

loc_426ED5:				; CODE XREF: .text:00426EB1j
		mov	edx, ds:dword_435B34
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	edx ; dword_435B34
		sub	esp, 4
		mov	eax, [ebp-14h]
		mov	off_42B5AC, eax
		mov	ds:dword_435B24, 0
		mov	ds:dword_435B20, 0
		mov	ds:dword_435B28, 1

loc_426F0C:				; CODE XREF: .text:00426DC6j
					; .text:00426E21j
		mov	eax, 0

loc_426F11:				; CODE XREF: .text:00426E34j
					; .text:00426E7Bj ...
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_42B5AC
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426F20	proc near		; CODE XREF: sub_424BBF+43p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_435B24
		pop	ebp
		retn
sub_426F20	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426F2A	proc near		; CODE XREF: .text:00423634p
					; .text:00423725p ...

Dest		= dword	ptr -68h
Source		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	eax, ds:dword_435B24
		test	eax, eax
		jz	short loc_426F5A
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Dest],	eax
		call	gcry_xstrdup
		mov	[ebp+var_10], eax
		jmp	loc_42717E
; ---------------------------------------------------------------------------

loc_426F5A:				; CODE XREF: sub_426F2A+1Bj
		mov	eax, ds:dword_435B20
		test	eax, eax
		jnz	loc_42701D
		mov	eax, ds:dword_435B28
		test	eax, eax
		jnz	loc_42701D
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_426F92
; ---------------------------------------------------------------------------

loc_426F7C:				; CODE XREF: sub_426F2A+70j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_426F8E
		add	[ebp+var_18], 1

loc_426F8E:				; CODE XREF: sub_426F2A+5Ej
		add	[ebp+var_C], 1

loc_426F92:				; CODE XREF: sub_426F2A+50j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_426F7C
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[esp+68h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_427008
; ---------------------------------------------------------------------------

loc_426FBB:				; CODE XREF: sub_426F2A+E6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_426FF5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	short loc_427004
; ---------------------------------------------------------------------------

loc_426FF5:				; CODE XREF: sub_426F2A+99j
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1

loc_427004:				; CODE XREF: sub_426F2A+C9j
		add	[ebp+var_C], 1

loc_427008:				; CODE XREF: sub_426F2A+8Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_426FBB
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		jmp	loc_42717E
; ---------------------------------------------------------------------------

loc_42701D:				; CODE XREF: sub_426F2A+37j
					; sub_426F2A+44j
		mov	edx, ds:dword_435B2C
		mov	eax, off_42B5AC
		mov	[esp+68h+Source], eax
		mov	[esp+68h+Dest],	offset aUtf8 ; "utf-8"
		call	edx ; dword_435B2C
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_42706E
		mov	eax, off_42B5AC
		mov	[esp+68h+var_60], 1
		mov	[esp+68h+Source], eax
		mov	[esp+68h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_426AD4
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Dest],	eax
		call	sub_426F2A
		jmp	loc_427181
; ---------------------------------------------------------------------------

loc_42706E:				; CODE XREF: sub_426F2A+115j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_42708C
; ---------------------------------------------------------------------------

loc_427076:				; CODE XREF: sub_426F2A+16Aj
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_427088
		add	[ebp+var_18], 5

loc_427088:				; CODE XREF: sub_426F2A+158j
		add	[ebp+var_C], 1

loc_42708C:				; CODE XREF: sub_426F2A+14Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_427076
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[esp+68h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_30], eax
		mov	edx, ds:dword_435B30
		lea	eax, [ebp+var_30]
		mov	[esp+54h+var_44], eax
		lea	eax, [ebp+var_28]
		mov	[esp+54h+var_48], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+54h+var_4C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+54h+var_50], eax
		mov	eax, [ebp+var_20]
		mov	[esp+54h+var_54], eax
		call	edx ; dword_435B30
		sub	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_427167
		mov	eax, ds:dword_435B3C
		test	eax, eax
		jnz	short loc_427149
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+Dest],	eax ; int
		call	strerror
		mov	edx, off_42B5AC
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], offset aUtf8 ; "utf-8"
		mov	[esp+68h+Source], edx ;	char
		mov	[esp+68h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_423387

loc_427149:				; CODE XREF: sub_426F2A+1EAj
		mov	ds:dword_435B3C, 1
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Source], eax ;	Source
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_42716D
; ---------------------------------------------------------------------------

loc_427167:				; CODE XREF: sub_426F2A+1E1j
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_42716D:				; CODE XREF: sub_426F2A+23Bj
		mov	edx, ds:dword_435B34
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dest],	eax
		call	edx ; dword_435B34
		sub	esp, 4

loc_42717E:				; CODE XREF: sub_426F2A+2Bj
					; sub_426F2A+EEj
		mov	eax, [ebp+var_10]

loc_427181:				; CODE XREF: sub_426F2A+13Fj
		mov	edi, [ebp+var_4]
		leave
		retn
sub_426F2A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427186	proc near		; CODE XREF: sub_427186+79Ap
					; sub_42795C+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 88h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_4271AB:				; CODE XREF: sub_427186+5EEj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_42774D
; ---------------------------------------------------------------------------

loc_4271D0:				; CODE XREF: sub_427186+5CBj
		cmp	[ebp+var_30], 0
		jz	short loc_42722F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_427228
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_4271F4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_427228

loc_4271F4:				; CODE XREF: sub_427186+62j
		cmp	[ebp+var_24], 0
		jz	short loc_42721F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_42721F:				; CODE XREF: sub_427186+72j
		add	[ebp+var_1C], 4
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_427228:				; CODE XREF: sub_427186+58j
					; sub_427186+6Cj
		mov	[ebp+var_30], 0

loc_42722F:				; CODE XREF: sub_427186+4Ej
		cmp	[ebp+var_C], 0
		jnz	loc_427562
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_4273BA
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_42739A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_42728B
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_42728B
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_42728B
		cmp	[ebp+arg_8], 0
		jz	loc_42739A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_42739A

loc_42728B:				; CODE XREF: sub_427186+D3j
					; sub_427186+DDj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_42729F
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_42729F:				; CODE XREF: sub_427186+10Dj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_427350	; jumptable 004272B8 default case
		mov	eax, ds:off_433CF8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4272BA:				; CODE XREF: sub_427186+132j
					; DATA XREF: .rdata:off_433CF8o
		add	[ebp+var_1C], 1	; jumptable 004272B8 case 10
		cmp	[ebp+var_24], 0
		jz	loc_427381
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_427381
; ---------------------------------------------------------------------------

loc_4272D7:				; CODE XREF: sub_427186+132j
					; DATA XREF: .rdata:off_433CF8o
		add	[ebp+var_1C], 1	; jumptable 004272B8 case 13
		cmp	[ebp+var_24], 0
		jz	loc_427384
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_427384
; ---------------------------------------------------------------------------

loc_4272F4:				; CODE XREF: sub_427186+132j
					; DATA XREF: .rdata:off_433CF8o
		add	[ebp+var_1C], 1	; jumptable 004272B8 case 12
		cmp	[ebp+var_24], 0
		jz	loc_427387
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_427387
; ---------------------------------------------------------------------------

loc_42730E:				; CODE XREF: sub_427186+132j
					; DATA XREF: .rdata:off_433CF8o
		add	[ebp+var_1C], 1	; jumptable 004272B8 case 11
		cmp	[ebp+var_24], 0
		jz	short loc_42738A
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_42738A
; ---------------------------------------------------------------------------

loc_427324:				; CODE XREF: sub_427186+132j
					; DATA XREF: .rdata:off_433CF8o
		add	[ebp+var_1C], 1	; jumptable 004272B8 case 8
		cmp	[ebp+var_24], 0
		jz	short loc_42738D
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_42738D
; ---------------------------------------------------------------------------

loc_42733A:				; CODE XREF: sub_427186+132j
					; DATA XREF: .rdata:off_433CF8o
		add	[ebp+var_1C], 1	; jumptable 004272B8 case 0
		cmp	[ebp+var_24], 0
		jz	short loc_427390
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_427390
; ---------------------------------------------------------------------------

loc_427350:				; CODE XREF: sub_427186+125j
					; sub_427186+132j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 004272B8 default case
		cmp	[ebp+var_24], 0
		jz	short loc_427393
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_427393
; ---------------------------------------------------------------------------

loc_427381:				; CODE XREF: sub_427186+13Cj
					; sub_427186+14Cj
		nop
		jmp	short loc_427394
; ---------------------------------------------------------------------------

loc_427384:				; CODE XREF: sub_427186+159j
					; sub_427186+169j
		nop
		jmp	short loc_427394
; ---------------------------------------------------------------------------

loc_427387:				; CODE XREF: sub_427186+176j
					; sub_427186+186j
		nop
		jmp	short loc_427394
; ---------------------------------------------------------------------------

loc_42738A:				; CODE XREF: sub_427186+190j
					; sub_427186+19Cj
		nop
		jmp	short loc_427394
; ---------------------------------------------------------------------------

loc_42738D:				; CODE XREF: sub_427186+1A6j
					; sub_427186+1B2j
		nop
		jmp	short loc_427394
; ---------------------------------------------------------------------------

loc_427390:				; CODE XREF: sub_427186+1BCj
					; sub_427186+1C8j
		nop
		jmp	short loc_427394
; ---------------------------------------------------------------------------

loc_427393:				; CODE XREF: sub_427186+1D2j
					; sub_427186+1F9j
		nop

loc_427394:				; CODE XREF: sub_427186+1FCj
					; sub_427186+1FFj ...
		nop
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_42739A:				; CODE XREF: sub_427186+C5j
					; sub_427186+F1j ...
		cmp	[ebp+var_24], 0
		jz	short loc_4273B1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_4273B1:				; CODE XREF: sub_427186+218j
		add	[ebp+var_1C], 1
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_4273BA:				; CODE XREF: sub_427186+BBj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_427403
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_427403:				; CODE XREF: sub_427186+247j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_42744C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_42744C:				; CODE XREF: sub_427186+290j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_427495
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_427495:				; CODE XREF: sub_427186+2D9j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_4274DE
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_4274DE:				; CODE XREF: sub_427186+322j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_427527
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_427527:				; CODE XREF: sub_427186+36Bj
		cmp	[ebp+var_24], 0
		jz	short loc_427552
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_427552:				; CODE XREF: sub_427186+3A5j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_427562:				; CODE XREF: sub_427186+ADj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_42757A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_427608

loc_42757A:				; CODE XREF: sub_427186+3E4j
		cmp	[ebp+var_24], 0
		jz	short loc_4275E2
		mov	[ebp+var_10], 0
		jmp	short loc_4275B5
; ---------------------------------------------------------------------------

loc_427589:				; CODE XREF: sub_427186+435j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_4275B5:				; CODE XREF: sub_427186+401j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_427589
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_4275E2:				; CODE XREF: sub_427186+3F8j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_427608:				; CODE XREF: sub_427186+3EEj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_427745
		mov	eax, ds:dword_435B24
		test	eax, eax
		jz	short loc_427685
		cmp	[ebp+var_24], 0
		jz	short loc_427673
		mov	[ebp+var_10], 0
		jmp	short loc_42766B
; ---------------------------------------------------------------------------

loc_427653:				; CODE XREF: sub_427186+4EBj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_42766B:				; CODE XREF: sub_427186+4CBj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_427653

loc_427673:				; CODE XREF: sub_427186+4C2j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_427745
; ---------------------------------------------------------------------------

loc_427685:				; CODE XREF: sub_427186+4BCj
		cmp	[ebp+arg_C], 0
		jz	short loc_4276C9
		cmp	[ebp+var_24], 0
		jz	short loc_4276BA
		mov	[ebp+var_10], 0
		jmp	short loc_4276B2
; ---------------------------------------------------------------------------

loc_42769A:				; CODE XREF: sub_427186+532j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_4276B2:				; CODE XREF: sub_427186+512j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_42769A

loc_4276BA:				; CODE XREF: sub_427186+509j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_427745
; ---------------------------------------------------------------------------

loc_4276C9:				; CODE XREF: sub_427186+503j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_4276F2
		cmp	[ebp+var_28], 0FFh
		ja	short loc_4276F2
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_427745
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_427745
; ---------------------------------------------------------------------------

loc_4276F2:				; CODE XREF: sub_427186+547j
					; sub_427186+550j
		cmp	[ebp+var_24], 0
		jz	short loc_427735
		mov	[ebp+var_10], 0
		jmp	short loc_42772D
; ---------------------------------------------------------------------------

loc_427701:				; CODE XREF: sub_427186+5ADj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_42772D:				; CODE XREF: sub_427186+579j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_427701

loc_427735:				; CODE XREF: sub_427186+570j
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_427745:				; CODE XREF: sub_427186+9Dj
					; sub_427186+20Fj ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_42774D:				; CODE XREF: sub_427186+45j
		cmp	[ebp+var_2C], 0
		jnz	loc_4271D0
		cmp	[ebp+var_20], 0
		jnz	short loc_427779
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_4271AB
; ---------------------------------------------------------------------------

loc_427779:				; CODE XREF: sub_427186+5D5j
		cmp	[ebp+arg_C], 0
		jz	loc_427951
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	edx, ds:dword_435B2C
		mov	eax, off_42B5AC
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	edx ; dword_435B2C
		sub	esp, 8
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_4277F3
		mov	eax, off_42B5AC
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_426AD4
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_42795C
		jmp	locret_42795A
; ---------------------------------------------------------------------------

loc_4277F3:				; CODE XREF: sub_427186+625j
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_427857
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 28Ch
		mov	[esp+88h+Dest],	offset a____Dirmngr_13 ; "../../dirmngr-1.1.1/jnlib/utf8conv.c"
		call	sub_423540
; ---------------------------------------------------------------------------

loc_427857:				; CODE XREF: sub_427186+6B3j
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		mov	edx, ds:dword_435B30
		lea	eax, [ebp+var_50]
		mov	[esp+74h+var_64], eax
		lea	eax, [ebp+var_48]
		mov	[esp+74h+var_68], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+74h+var_6C], eax
		lea	eax, [ebp+var_44]
		mov	[esp+74h+var_70], eax
		mov	eax, [ebp+var_38]
		mov	[esp+74h+var_74], eax
		call	edx ; dword_435B30
		sub	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jnz	loc_42792A
		mov	eax, ds:dword_435B38
		test	eax, eax
		jnz	short loc_4278DD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	edx, off_42B5AC
		mov	[esp+88h+var_7C], eax
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_423387

loc_4278DD:				; CODE XREF: sub_427186+722j
		mov	ds:dword_435B38, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_427186
		mov	[ebp+var_34], eax
		jmp	short loc_42793B
; ---------------------------------------------------------------------------

loc_42792A:				; CODE XREF: sub_427186+715j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free

loc_42793B:				; CODE XREF: sub_427186+7A2j
		mov	edx, ds:dword_435B34
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	edx ; dword_435B34
		sub	esp, 4
		mov	eax, [ebp+var_34]
		jmp	short locret_42795A
; ---------------------------------------------------------------------------

loc_427951:				; CODE XREF: sub_427186+5F7j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

locret_42795A:				; CODE XREF: sub_427186+668j
					; sub_427186+7C9j
		leave
		retn
sub_427186	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42795C	proc near		; CODE XREF: sub_425E46+50p
					; sub_427186+663p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_435B28
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_427186
		leave
		retn
sub_42795C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4269C2
		test	eax, eax
		jz	short loc_42799C
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4279B4
; ---------------------------------------------------------------------------

loc_42799C:				; CODE XREF: .text:00427993j
		mov	edx, ds:dword_435B2C
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx ; dword_435B2C
		sub	esp, 8

locret_4279B4:				; CODE XREF: .text:0042799Aj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_4269C2
		test	eax, eax
		jz	short loc_4279CC
		mov	eax, 0
		jmp	short locret_4279F9
; ---------------------------------------------------------------------------

loc_4279CC:				; CODE XREF: .text:004279C3j
		mov	edx, ds:dword_435B30
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx ; dword_435B30
		sub	esp, 14h

locret_4279F9:				; CODE XREF: .text:004279CAj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4269C2
		test	eax, eax
		jz	short loc_427A11
		mov	eax, 0
		jmp	short locret_427A22
; ---------------------------------------------------------------------------

loc_427A11:				; CODE XREF: .text:00427A08j
		mov	edx, ds:dword_435B34
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx ; dword_435B34
		sub	esp, 4

locret_427A22:				; CODE XREF: .text:00427A0Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_427A24(int, char *Format, int)
sub_427A24	proc near		; CODE XREF: sub_427C63+1Ap

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Radix		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
EndPtr		= dword	ptr -14h
var_10		= dword	ptr -10h
Size		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+Format]
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+Format]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+Size], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		jmp	loc_427C10
; ---------------------------------------------------------------------------

loc_427A63:				; CODE XREF: sub_427A24+1F4j
		mov	eax, [ebp+EndPtr]
		movzx	edx, byte ptr [eax]
		cmp	dl, 25h
		setz	dl
		add	eax, 1
		mov	[ebp+EndPtr], eax
		test	dl, dl
		jz	loc_427C10
		jmp	short loc_427A88
; ---------------------------------------------------------------------------

loc_427A7F:				; CODE XREF: sub_427A24+7Fj
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax

loc_427A88:				; CODE XREF: sub_427A24+59j
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Val], eax ; Val
		mov	[esp+38h+Str], offset a0 ; "-+ #0"
		call	strchr
		test	eax, eax
		jnz	short loc_427A7F
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_427AD1
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	edx, eax
		sar	edx, 1Fh
		xor	eax, edx
		sub	eax, edx
		add	[ebp+Size], eax
		jmp	short loc_427AF3
; ---------------------------------------------------------------------------

loc_427AD1:				; CODE XREF: sub_427A24+89j
		mov	eax, [ebp+EndPtr]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+38h+Val], edx ; EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+Size]
		add	eax, edx
		mov	[ebp+Size], eax

loc_427AF3:				; CODE XREF: sub_427A24+ABj
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	short loc_427B61
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_427B32
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	edx, eax
		sar	edx, 1Fh
		xor	eax, edx
		sub	eax, edx
		add	[ebp+Size], eax
		jmp	short loc_427B61
; ---------------------------------------------------------------------------

loc_427B32:				; CODE XREF: sub_427A24+EAj
		mov	eax, [ebp+EndPtr]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+38h+Val], edx ; EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+Size]
		add	eax, edx
		mov	[ebp+Size], eax
		jmp	short loc_427B61
; ---------------------------------------------------------------------------

loc_427B56:				; CODE XREF: sub_427A24+159j
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		jmp	short loc_427B62
; ---------------------------------------------------------------------------

loc_427B61:				; CODE XREF: sub_427A24+D7j
					; sub_427A24+10Cj ...
		nop

loc_427B62:				; CODE XREF: sub_427A24+13Bj
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Val], eax ; Val
		mov	[esp+38h+Str], offset aHll ; "hlL"
		call	strchr
		test	eax, eax
		jnz	short loc_427B56
		add	[ebp+Size], 1Eh
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 45h	; switch 52 cases
		cmp	eax, 33h
		ja	short loc_427C07 ; jumptable 00427B9B default case
		mov	eax, ds:off_433D50[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_427B9D:				; CODE XREF: sub_427A24+177j
					; DATA XREF: .rdata:off_433D50o
		mov	eax, [ebp+var_18] ; jumptable 00427B9B cases 88,99,100,105,111,117,120
		add	eax, 4
		mov	[ebp+var_18], eax
		jmp	short loc_427C07 ; jumptable 00427B9B default case
; ---------------------------------------------------------------------------

loc_427BA8:				; CODE XREF: sub_427A24+177j
					; DATA XREF: .rdata:off_433D50o
		mov	eax, [ebp+var_18] ; jumptable 00427B9B cases 69,71,101-103
		add	eax, 8
		mov	[ebp+var_18], eax
		add	[ebp+Size], 133h
		jmp	short loc_427C07 ; jumptable 00427B9B default case
; ---------------------------------------------------------------------------

loc_427BBA:				; CODE XREF: sub_427A24+177j
					; DATA XREF: .rdata:off_433D50o
		mov	eax, [ebp+var_18] ; jumptable 00427B9B case 115
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_427BF7
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+Size]
		add	eax, edx
		mov	[ebp+Size], eax
		jmp	short loc_427C07 ; jumptable 00427B9B default case
; ---------------------------------------------------------------------------

loc_427BF7:				; CODE XREF: sub_427A24+1A8j
		add	[ebp+Size], 19h
		jmp	short loc_427C07 ; jumptable 00427B9B default case
; ---------------------------------------------------------------------------

loc_427BFD:				; CODE XREF: sub_427A24+177j
					; DATA XREF: .rdata:off_433D50o
		mov	eax, [ebp+var_18] ; jumptable 00427B9B cases 110,112
		add	eax, 4
		mov	[ebp+var_18], eax
		nop

loc_427C07:				; CODE XREF: sub_427A24+16Ej
					; sub_427A24+177j ...
		mov	eax, [ebp+EndPtr] ; jumptable 00427B9B default case
		add	eax, 1
		mov	[ebp+EndPtr], eax

loc_427C10:				; CODE XREF: sub_427A24+3Aj
					; sub_427A24+53j
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_427A63
		mov	eax, [ebp+Size]
		mov	[esp+38h+Str], eax ; Size
		call	malloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_427C58
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+38h+Radix], edx ; Args
		mov	edx, [ebp+Format]
		mov	[esp+38h+Val], edx ; Format
		mov	[esp+38h+Str], eax ; Dest
		call	vsprintf
		jmp	short loc_427C5D
; ---------------------------------------------------------------------------

loc_427C58:				; CODE XREF: sub_427A24+213j
		mov	eax, 0

loc_427C5D:				; CODE XREF: sub_427A24+232j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_427A24	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_427C63(int, char *, int)
sub_427C63	proc near		; CODE XREF: .text:00427CA6p

var_18		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		lea	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_427A24
		leave
		retn
sub_427C63	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_427C63
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_pipe
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_close
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_spawn
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_socketpair
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_socket
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_connect
; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_malloc_hooks]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_assuan_log_prefix]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_gpg_err_source]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_system_hooks]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_bind]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_get_nonce]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_check_nonce]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_inquire]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_get_pointer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_error]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_send_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_write_line]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_write_status]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_get_data_fp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_command]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_init_pipe_server]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_init_socket_server]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_pointer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_hello_line]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_option_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_reset_notify]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_log_stream]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_accept]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_process]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_syserror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_set_errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_hash_buffer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_control]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_malloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_check_version]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_log_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xstrdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xcalloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xmalloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_ctl]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_map_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_debug]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_canon_len]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_sscan]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_algo_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_get_algo_dlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_build]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_verify]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_create_nonce]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_get_algo]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_find_token]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_cadr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_nth_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xrealloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_check_version]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_set_malloc_hooks]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_set_hash_buffer_function]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_init_from_mem]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_image]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_issuer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_serial]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_get_digest_algo]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_set_hash_function]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_get_sig_val]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_public_key]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_parse]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_get_update_times]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_get_item]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_get_issuer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_get_auth_key_id]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_name_enum]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_name_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_get_crl_number]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_name_get_uri]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_set_reader]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_get_extension]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_crl_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_reader_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_reader_set_file]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_reader_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_crl_dist_point]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_reader_set_cb]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_read_der]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_hash]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_ref]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_subject]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_subj_key_id]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_auth_key_id]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_reader_unread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_reader_read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_validity]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_digest_algo]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_add_target]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_set_nonce]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_build_request]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_parse_response]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_hash_response]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_get_cert]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_get_responder_id]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_authority_info_access]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_get_sig_val]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_get_status]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_set_user_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_ocsp_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_extension]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_cert_policies]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_is_ca]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_user_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_sig_val]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_ext_key_usages]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_key_usage]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_usleep]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_waitpid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_attr_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_attr_set]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_spawn]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_attr_destroy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_wait]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_occurred]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_timeout]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_concat]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_accept_ev]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_isolate]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_sleep]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_sigmask]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_rwlock_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_rwlock_acquire]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_rwlock_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_status]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_yield]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_read_ev]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_connect]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_mutex_acquire]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_mutex_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_mutex_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_pipe]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:0043A024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_428210
		cmp	eax, 3
		jz	short loc_428210
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_428210:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_429400
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_433E5Co ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_428284
		cmp	dword_42B5C0, 2
		jz	short loc_428266
		mov	dword_42B5C0, 2

loc_428266:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_428373
		cmp	eax, 1
		jz	loc_428312

loc_428278:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_428284:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_436050, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_4283A3
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_43604C, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_436048, eax
		jz	loc_4283A3
		mov	ecx, ds:dword_43604C
		test	ecx, ecx
		jz	short loc_428333
		test	eax, eax
		jz	short loc_428333
		mov	dword_42B5C0, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_428312:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_429400
		jmp	loc_428278
; ---------------------------------------------------------------------------

loc_428333:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_436048, 0
		mov	ds:dword_43604C, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_428353:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_42B5C0, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_428373:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_43A030
		cmp	ebx, offset dword_43A030
		jz	loc_428278

loc_428384:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_42838C
		call	eax

loc_42838C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_43A030
		jnz	short loc_428384
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4283A3:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_436048, 0
		mov	ds:dword_43604C, 0
		jmp	short loc_428353
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4283D0	proc near		; DATA XREF: .CRT:0043A014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_4283D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4283E0	proc near		; CODE XREF: sub_428400+10p
					; sub_428400+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_4283E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4283F0	proc near		; CODE XREF: sub_401060+59p
					; sub_428400+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_4283F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_428400(_onexit_t)
sub_428400	proc near		; CODE XREF: sub_4284C0+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_436058
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_4283E0
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_4284A0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_436058
		mov	[esp+2Ch+Func],	eax
		call	sub_4283E0
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_436054
		mov	[esp+2Ch+Func],	eax
		call	sub_4283E0
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_4283F0
		mov	ds:dword_436058, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_4283F0
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_436054, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4284A0:				; CODE XREF: sub_428400+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_428400	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4284C0(_onexit_t)
sub_4284C0	proc near		; CODE XREF: sub_413121+AFp
					; sub_4290E0-27p ...

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_428400
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_4284C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_428537
		cmp	eax, 0C000008Dh
		jb	short loc_428564

loc_4284FB:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_428500:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_428630
		test	eax, eax
		jz	short loc_42854C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_42852F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_428537:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_4285A5
		cmp	eax, 0C0000096h
		jz	short loc_428572
		cmp	eax, 0C0000093h
		jz	short loc_4284FB

loc_42854C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_435BC8
		test	eax, eax
		jz	loc_428623
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_428564:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_4285B0
		cmp	eax, 0C000001Dh
		jnz	short loc_42854C

loc_428572:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_4285E7
		test	eax, eax
		jz	short loc_42854C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4285A5:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_428500
; ---------------------------------------------------------------------------
		align 10h

loc_4285B0:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_428605
		test	eax, eax
		jz	loc_42854C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4285E7:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_42852F
; ---------------------------------------------------------------------------

loc_428605:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_42852F
; ---------------------------------------------------------------------------

loc_428623:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_42852F
; ---------------------------------------------------------------------------
		align 10h

loc_428630:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_42852F
		mov	[esp+2Ch+var_10], eax
		call	sub_429050
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_42852F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_435BCC
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_4286B1
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_435BCC
		jmp	short loc_4286B7
; ---------------------------------------------------------------------------

loc_4286B1:				; CODE XREF: .text:00428686j
		fstp	st
		fstp	st
		fstp	st

loc_4286B7:				; CODE XREF: .text:004286AFj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4286C0	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_435BCC, eax
		jmp	__setusermatherr
sub_4286C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4286D0	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_4286ED
		mov	edx, ds:off_433F7C[ecx*4]

loc_4286ED:				; CODE XREF: sub_4286D0+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_4286D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_428730	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_428730	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_428740(char *Format, char ArgList)
sub_428740	proc near		; CODE XREF: sub_4287A0+1DDp
					; sub_4287A0+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_428740	endp

; ---------------------------------------------------------------------------
		jmp	short sub_4287A0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_4287A0(size_t Size)
sub_4287A0	proc near		; CODE XREF: .text:00428791j
					; sub_4289E0+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_435BD8
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_428982
		mov	eax, ds:dword_435BD4
		xor	esi, esi

loc_4287C4:				; CODE XREF: sub_4287A0+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_4287D9
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_4288B0

loc_4287D9:				; CODE XREF: sub_4287A0+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_4287C4

loc_4287E3:				; CODE XREF: sub_4287A0+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_428DA0
		test	eax, eax
		mov	edi, eax
		jz	loc_4289A9
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_435BD4
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_428E80
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_435BD4
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_428989
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_428931

loc_42885F:				; CODE XREF: sub_4287A0+194j
					; sub_4287A0+1C6j
		add	ds:dword_435BD8, 1

loc_428866:				; CODE XREF: sub_4287A0+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_4289B9
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_4288B8

loc_42888F:				; CODE XREF: sub_4287A0+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_4288A3:				; CODE XREF: sub_4287A0+162j
					; sub_4287A0+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4288B0:				; CODE XREF: sub_4287A0+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_428866
; ---------------------------------------------------------------------------

loc_4288B8:				; CODE XREF: sub_4287A0+EDj
		cmp	eax, 40h
		jz	short loc_42888F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_4288A3
		cmp	eax, 4
		jz	short loc_4288A3
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_428931:				; CODE XREF: sub_4287A0+B9j
		cmp	eax, 40h
		jz	loc_42885F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_435BD4
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_42885F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_428740
; ---------------------------------------------------------------------------

loc_428982:				; CODE XREF: sub_4287A0+17j
		xor	esi, esi
		jmp	loc_4287E3
; ---------------------------------------------------------------------------

loc_428989:				; CODE XREF: sub_4287A0+ACj
		mov	eax, ds:dword_435BD4
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_428740
; ---------------------------------------------------------------------------

loc_4289A9:				; CODE XREF: sub_4287A0+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_428740
; ---------------------------------------------------------------------------

loc_4289B9:				; CODE XREF: sub_4287A0+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_428740
sub_4287A0	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4289E0	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_435BD0
		test	eax, eax
		jz	short loc_428A00

loc_4289F2:				; CODE XREF: sub_4289E0+66j
					; sub_4289E0+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_428A00:				; CODE XREF: sub_4289E0+10j
		mov	ds:dword_435BD0, 1
		call	sub_428DE0
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_4294A0
		mov	ds:dword_435BD8, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_435BD4, eax
		mov	eax, offset dword_43410C
		sub	eax, offset dword_43410C
		cmp	eax, 7
		jle	short loc_4289F2
		cmp	eax, 0Bh
		mov	ebx, offset dword_43410C
		jle	loc_428B40
		mov	eax, ds:dword_43410C
		test	eax, eax
		jnz	short loc_428A70
		mov	eax, ds:dword_434110
		test	eax, eax
		jz	loc_428B2C
		lea	esi, [esi+0]

loc_428A70:				; CODE XREF: sub_4289E0+7Dj
					; sub_4289E0+164j ...
		cmp	ebx, offset dword_43410C
		jnb	loc_4289F2
		mov	esi, 400000h

loc_428A81:				; CODE XREF: sub_4289E0+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_4287A0
		cmp	ebx, offset dword_43410C
		jb	short loc_428A81

loc_428AA5:				; CODE XREF: sub_4289E0+24Bj
		mov	ecx, ds:dword_435BD8
		test	ecx, ecx
		jle	loc_4289F2
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_428AD2
; ---------------------------------------------------------------------------
		align 10h

loc_428AC0:				; CODE XREF: sub_4289E0+FDj
					; sub_4289E0+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_435BD8
		jge	loc_4289F2

loc_428AD2:				; CODE XREF: sub_4289E0+DDj
		mov	eax, ds:dword_435BD4
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_428AC0
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_428C52
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_435BD4
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_428AC0
; ---------------------------------------------------------------------------

loc_428B2C:				; CODE XREF: sub_4289E0+86j
		mov	eax, ds:dword_434114
		test	eax, eax
		jnz	short loc_428B55
		mov	ebx, offset dword_434118
		lea	esi, [esi+0]

loc_428B40:				; CODE XREF: sub_4289E0+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_428A70
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_428A70

loc_428B55:				; CODE XREF: sub_4289E0+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_428C75
		add	ebx, 0Ch
		cmp	ebx, offset dword_43410C
		jnb	loc_4289F2

loc_428B70:				; CODE XREF: sub_4289E0+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_428BCA
		cmp	edx, 20h
		jz	short loc_428C00
		cmp	edx, 8
		jz	short loc_428BAA
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_428740
; ---------------------------------------------------------------------------

loc_428BAA:				; CODE XREF: sub_4289E0+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_428BD5
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_428BF1
; ---------------------------------------------------------------------------

loc_428BCA:				; CODE XREF: sub_4289E0+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_428C30

loc_428BD5:				; CODE XREF: sub_4289E0+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_428C43
		cmp	edx, 20h
		jz	short loc_428C0F
		cmp	edx, 8
		jnz	short loc_428C1C

loc_428BF1:				; CODE XREF: sub_4289E0+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_4287A0
		jmp	short loc_428C1C
; ---------------------------------------------------------------------------

loc_428C00:				; CODE XREF: sub_4289E0+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_428C0F:				; CODE XREF: sub_4289E0+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_4287A0

loc_428C1C:				; CODE XREF: sub_4289E0+20Fj
					; sub_4289E0+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_43410C
		jb	loc_428B70
		jmp	loc_428AA5
; ---------------------------------------------------------------------------

loc_428C30:				; CODE XREF: sub_4289E0+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_428C43:				; CODE XREF: sub_4289E0+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_4287A0
		jmp	short loc_428C1C
; ---------------------------------------------------------------------------

loc_428C52:				; CODE XREF: sub_4289E0+11Bj
		add	ebx, ds:dword_435BD4
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_428740
; ---------------------------------------------------------------------------

loc_428C75:				; CODE XREF: sub_4289E0+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_428740
sub_4289E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_428C90	proc near		; CODE XREF: .text:00428D31p
					; sub_428DA0+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_428CA0

locret_428C9D:				; CODE XREF: sub_428C90+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_428CA0:				; CODE XREF: sub_428C90+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_428C9D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_428C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_428CC0	proc near		; CODE XREF: sub_428DA0+2Bp
					; .text:00428EE4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_428CFE
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_428CE4:				; CODE XREF: sub_428CC0+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_428CF2
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_428CFE

loc_428CF2:				; CODE XREF: sub_428CC0+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_428CE4
		xor	eax, eax

loc_428CFE:				; CODE XREF: sub_428CC0+19j
					; sub_428CC0+30j
		pop	ebx
		pop	esi
		retn
sub_428CC0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_428D10
; ---------------------------------------------------------------------------
		align 10h

loc_428D10:				; CODE XREF: .text:00428D01j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_428D83
		mov	dword ptr [esp], 400000h
		call	sub_428C90
		test	eax, eax
		jz	short loc_428D83
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_428D83
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_428D6B
; ---------------------------------------------------------------------------

loc_428D61:				; CODE XREF: .text:00428D81j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_428D90

loc_428D6B:				; CODE XREF: .text:00428D5Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_428D61

loc_428D83:				; CODE XREF: .text:00428D28j
					; .text:00428D38j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_428D90:				; CODE XREF: .text:00428D69j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_428DA0	proc near		; CODE XREF: sub_4287A0+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_428C90
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_428DD0
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_428CC0

loc_428DD0:				; CODE XREF: sub_428DA0+15j
		add	esp, 8
		retn
sub_428DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_428DE0	proc near		; CODE XREF: sub_4289E0+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_428C90
		xor	edx, edx
		test	eax, eax
		jz	short loc_428E01
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_428E01:				; CODE XREF: sub_428DE0+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_428DE0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_428C90
		xor	edx, edx
		test	eax, eax
		jz	short loc_428E69
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_428E69
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_428E50:				; CODE XREF: .text:00428E65j
		test	byte ptr [edx+27h], 20h
		jz	short loc_428E5D
		test	ebx, ebx
		jz	short loc_428E69
		sub	ebx, 1

loc_428E5D:				; CODE XREF: .text:00428E54j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_428E50
		xor	edx, edx

loc_428E69:				; CODE XREF: .text:00428E29j
					; .text:00428E45j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_428E80
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_428E80	proc near		; CODE XREF: sub_4287A0+70p
					; .text:00428E71j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_428C90
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_428E80	endp

; ---------------------------------------------------------------------------
		jmp	short loc_428EB0
; ---------------------------------------------------------------------------
		align 10h

loc_428EB0:				; CODE XREF: .text:00428EA1j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_428C90
		test	eax, eax
		jnz	short loc_428ED0

loc_428EC6:				; CODE XREF: .text:00428EEBj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_428ED0:				; CODE XREF: .text:00428EC4j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_428CC0
		test	eax, eax
		jz	short loc_428EC6
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_428F00	proc near		; CODE XREF: sub_428F90+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_428C90
		test	eax, eax
		jz	short loc_428F71
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_428F71
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_428CC0
		test	eax, eax
		jz	short loc_428F71
		add	esi, 400000h
		jnz	short loc_428F56
		jmp	short loc_428F71
; ---------------------------------------------------------------------------
		align 10h

loc_428F50:				; CODE XREF: sub_428F00+66j
		sub	ebx, 1
		add	esi, 14h

loc_428F56:				; CODE XREF: sub_428F00+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_428F64
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_428F80

loc_428F64:				; CODE XREF: sub_428F00+5Bj
		test	ebx, ebx
		jg	short loc_428F50
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_428F71:				; CODE XREF: sub_428F00+1Aj
					; sub_428F00+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_428F80:				; CODE XREF: sub_428F00+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_428F00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_428F90	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_435BDC
		test	eax, eax
		jz	short loc_428FA2

loc_428F9D:				; CODE XREF: sub_428F90+97j
					; sub_428F90+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_428FA2:				; CODE XREF: sub_428F90+Bj
		xor	eax, eax

loc_428FA4:				; CODE XREF: sub_428F90+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_428F00
		test	eax, eax
		jz	short loc_429030
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_428FC0
		cmp	dl, 6Dh
		jnz	short loc_429010

loc_428FC0:				; CODE XREF: sub_428F90+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_428FCE
		cmp	dl, 73h
		jnz	short loc_429010

loc_428FCE:				; CODE XREF: sub_428F90+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_428FDC
		cmp	dl, 76h
		jnz	short loc_429010

loc_428FDC:				; CODE XREF: sub_428F90+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_428FEA
		cmp	dl, 63h
		jnz	short loc_429010

loc_428FEA:				; CODE XREF: sub_428F90+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_428FF8
		cmp	dl, 72h
		jnz	short loc_429010

loc_428FF8:				; CODE XREF: sub_428F90+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_429014
		cmp	dl, 74h
		jz	short loc_429014
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_429014
		xchg	ax, ax

loc_429010:				; CODE XREF: sub_428F90+2Ej
					; sub_428F90+3Cj ...
		mov	eax, ebx
		jmp	short loc_428FA4
; ---------------------------------------------------------------------------

loc_429014:				; CODE XREF: sub_428F90+6Fj
					; sub_428F90+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_435BDC, eax
		jnz	loc_428F9D
		lea	esi, [esi+0]

loc_429030:				; CODE XREF: sub_428F90+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_435BDC, eax
		jmp	loc_428F9D
sub_428F90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_429050	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_429050	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_429060()
sub_429060	proc near		; DATA XREF: sub_4290E0:loc_4290B2o
		sub	esp, 0Ch
		mov	eax, off_42B5BC
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_429087
		xchg	ax, ax

loc_429070:				; CODE XREF: sub_429060+25j
		call	eax
		mov	eax, off_42B5BC
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_42B5BC, edx
		test	eax, eax
		jnz	short loc_429070

loc_429087:				; CODE XREF: sub_429060+Cj
		add	esp, 0Ch
		retn
sub_429060	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_4290E0

loc_429090:				; CODE XREF: sub_4290E0+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_42A420
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_4290C3

loc_42909F:				; CODE XREF: sub_4290E0-9j
		test	ebx, ebx
		jz	short loc_4290B2

loc_4290A3:				; CODE XREF: sub_4290E0-30j
		call	ds:dword_42A420[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_4290A3

loc_4290B2:				; CODE XREF: sub_4290E0-3Fj
		mov	[esp+1Ch+var_1C], offset sub_429060 ; _onexit_t
		call	sub_4284C0
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4290C3:				; CODE XREF: sub_4290E0-43j
		xor	ebx, ebx
		jmp	short loc_4290C9
; ---------------------------------------------------------------------------

loc_4290C7:				; CODE XREF: sub_4290E0-Bj
		mov	ebx, eax

loc_4290C9:				; CODE XREF: sub_4290E0-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_42A420[eax*4]
		test	edx, edx
		jnz	short loc_4290C7
		jmp	short loc_42909F
; END OF FUNCTION CHUNK	FOR sub_4290E0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4290E0	proc near		; CODE XREF: sub_401180+239p
					; sub_4034A1+14p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00429090 SIZE 00000049 BYTES

		mov	ecx, ds:dword_435BE0
		test	ecx, ecx
		jz	short loc_4290F0
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_4290F0:				; CODE XREF: sub_4290E0+8j
		mov	ds:dword_435BE0, 1
		jmp	short loc_429090
sub_4290E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_429100	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_42B5C8
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_429150
		not	eax
		mov	dword_42B5CC, eax

loc_429136:				; CODE XREF: sub_429100+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_429150:				; CODE XREF: sub_429100+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_4291C2

loc_4291B2:				; CODE XREF: sub_429100+CCj
		mov	dword_42B5C8, ebp
		mov	dword_42B5CC, eax
		jmp	loc_429136
; ---------------------------------------------------------------------------

loc_4291C2:				; CODE XREF: sub_429100+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_4291B2
sub_429100	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_435CC4, edx
		mov	ds:dword_435EE0, 0C0000409h
		mov	ds:dword_435EE4, 1
		mov	ds:dword_435CB8, eax
		mov	ds:dword_435EEC, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_435CAC, eax
		mov	eax, dword_42B5C8
		mov	[ebp-10h], eax
		mov	eax, dword_42B5CC
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_4340A4
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_429260	proc near		; CODE XREF: sub_429400+79p
					; sub_429400:loc_429492p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_435F5C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_4292B5
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_429290:				; CODE XREF: sub_429260+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_4292AE
		test	esi, esi
		jz	short loc_4292AE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_4292AE:				; CODE XREF: sub_429260+40j
					; sub_429260+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_429290

loc_4292B5:				; CODE XREF: sub_429260+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_429260	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_435F40
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_4292F4

loc_4292E6:				; CODE XREF: .text:0042935Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_4292F4:				; CODE XREF: .text:004292E4j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_429357
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_435F5C
		mov	ds:dword_435F5C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_429357:				; CODE XREF: .text:0042930Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_4292E6
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_435F40
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_429378
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_429378:				; CODE XREF: .text:0042936Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_435F5C
		sub	esp, 4
		test	edx, edx
		jz	short loc_4293AF
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_4293A8
		jmp	short loc_4293E6
; ---------------------------------------------------------------------------
		align 10h

loc_4293A0:				; CODE XREF: .text:004293ADj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_4293C6
		mov	edx, eax

loc_4293A8:				; CODE XREF: .text:00429396j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_4293A0

loc_4293AF:				; CODE XREF: .text:00429390j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_4293BF:				; CODE XREF: .text:004293E4j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4293C6:				; CODE XREF: .text:004293A4j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_4293CC:				; CODE XREF: .text:004293F0j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_4293BF
; ---------------------------------------------------------------------------

loc_4293E6:				; CODE XREF: .text:00429398j
		mov	eax, [edx+8]
		mov	ds:dword_435F5C, eax
		mov	eax, edx
		jmp	short loc_4293CC
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_429400	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_429450
		jb	short loc_429420
		cmp	eax, 3
		jz	short loc_429470

loc_429413:				; CODE XREF: sub_429400+31j
					; sub_429400+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_429420:				; CODE XREF: sub_429400+Cj
		mov	eax, ds:dword_435F40
		test	eax, eax
		jnz	short loc_429492

loc_429429:				; CODE XREF: sub_429400+97j
		mov	eax, ds:dword_435F40
		cmp	eax, 1
		jnz	short loc_429413
		mov	ds:dword_435F40, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_429413
; ---------------------------------------------------------------------------
		align 10h

loc_429450:				; CODE XREF: sub_429400+Aj
		mov	eax, ds:dword_435F40
		test	eax, eax
		jz	short loc_429480

loc_429459:				; CODE XREF: sub_429400+90j
		mov	ds:dword_435F40, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_429470:				; CODE XREF: sub_429400+11j
		mov	eax, ds:dword_435F40
		test	eax, eax
		jz	short loc_429413
		call	sub_429260
		jmp	short loc_429413
; ---------------------------------------------------------------------------

loc_429480:				; CODE XREF: sub_429400+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_429459
; ---------------------------------------------------------------------------

loc_429492:				; CODE XREF: sub_429400+27j
		call	sub_429260
		jmp	short loc_429429
sub_429400	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4294A0	proc near		; CODE XREF: sub_401180+19p
					; sub_40A08A+Ap ...

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_4294C2

loc_4294AD:				; CODE XREF: sub_4294A0+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_4294AD

loc_4294C2:				; CODE XREF: sub_4294A0+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_4294A0	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _mkdir]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _unlink]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strlwr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _setmode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _access]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_429550
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_429550	proc near		; CODE XREF: sub_401180+A7p
					; .text:00429541j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_429550	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_429570(char *, size_t, char *, char)
sub_429570	proc near		; CODE XREF: sub_404CE9+5Ap
					; sub_406596+244p ...

DstBuf		= dword	ptr -1Ch
MaxCount	= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 1Ch
		lea	eax, [esp+1Ch+arg_C]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+Format], eax ;	Format
		mov	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+MaxCount], eax	; MaxCount
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+DstBuf], eax ;	DstBuf
		call	_vsnprintf
		add	esp, 1Ch
		retn
sub_429570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_4295A0	proc near		; CODE XREF: sub_429780+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_4295EC
		jmp	short loc_4295F4
; ---------------------------------------------------------------------------
		align 10h

loc_4295E0:				; CODE XREF: sub_4295A0+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_4295F4

loc_4295EC:				; CODE XREF: sub_4295A0+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_4295E0

loc_4295F4:				; CODE XREF: sub_4295A0+39j
					; sub_4295A0+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_42961C
		jmp	short loc_429624
; ---------------------------------------------------------------------------
		align 10h

loc_429610:				; CODE XREF: sub_4295A0+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_429624

loc_42961C:				; CODE XREF: sub_4295A0+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_429610

loc_429624:				; CODE XREF: sub_4295A0+6Aj
					; sub_4295A0+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_4296E0
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_42970E

loc_429643:				; CODE XREF: sub_4295A0+168j
					; sub_4295A0+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_429720

loc_429673:				; CODE XREF: sub_4295A0+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_435BC0
		test	eax, eax
		jz	loc_429759
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_429741
		cmp	eax, 5
		jnz	short loc_42973C
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4296E0:				; CODE XREF: sub_4295A0+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_429643

loc_42970E:				; CODE XREF: sub_4295A0+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_429643
; ---------------------------------------------------------------------------
		align 10h

loc_429720:				; CODE XREF: sub_4295A0+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_429673
; ---------------------------------------------------------------------------

loc_42973C:				; CODE XREF: sub_4295A0+133j
		call	abort
; ---------------------------------------------------------------------------

loc_429741:				; CODE XREF: sub_4295A0+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_429759:				; CODE XREF: sub_4295A0+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_7 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_4295A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_429780(char *, char *, int)
sub_429780	proc near		; CODE XREF: sub_405484+128p
					; sub_405654+148p ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_4297E6
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_4297D0:				; CODE XREF: sub_429780+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_4297D0
		add	edx, edx

loc_4297E6:				; CODE XREF: sub_429780+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_42980D
		xor	edi, edi

loc_4297F7:				; CODE XREF: sub_429780+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_4297F7
		add	edx, edx

loc_42980D:				; CODE XREF: sub_429780+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_4295A0
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_429780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_429850	proc near		; CODE XREF: sub_406A20+14p
					; sub_406A20+8Cp ...
		jmp	sub_42A080
sub_429850	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_429860(LPCSTR)
sub_429860	proc near		; CODE XREF: sub_406BDB+2Bp
					; sub_406CA5+C5p ...

lpFileName	= dword	ptr -12Ch
Path		= dword	ptr -128h
SizeInBytes	= dword	ptr -124h
FullPath	= byte ptr -110h
arg_0		= dword	ptr  4

		push	edi
		push	esi
		push	ebx
		sub	esp, 120h
		mov	ebx, [esp+12Ch+arg_0]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	loc_429A72
		cmp	byte ptr [ebx],	0
		jz	loc_429A30
		mov	[esp+12Ch+lpFileName], ebx ; lpFileName
		call	ds:GetFileAttributesA
		sub	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	loc_429A50
		test	al, 10h
		jz	loc_429A30
		lea	esi, [esp+12Ch+FullPath]
		mov	[esp+12Ch+SizeInBytes],	104h ; SizeInBytes
		mov	[esp+12Ch+Path], ebx ; Path
		mov	[esp+12Ch+lpFileName], esi ; FullPath
		call	_fullpath
		mov	edx, esi

loc_4298C3:				; CODE XREF: sub_429860+77j
		mov	ecx, [edx]
		add	edx, 4
		lea	eax, [ecx-1010101h]
		not	ecx
		and	eax, ecx
		and	eax, 80808080h
		jz	short loc_4298C3
		mov	ecx, eax
		shr	ecx, 10h
		test	eax, 8080h
		cmovz	eax, ecx
		lea	ecx, [edx+2]
		cmovz	edx, ecx
		add	al, al
		sbb	edx, 3
		sub	edx, esi
		add	edx, 233h
		mov	[esp+12Ch+lpFileName], edx ; Size
		call	malloc
		test	eax, eax
		mov	ebx, eax
		jz	loc_429A62
		lea	edi, [eax+22Ch]
		mov	[esp+12Ch+Path], esi ; Source
		mov	[esp+12Ch+lpFileName], edi ; Dest
		call	strcpy
		mov	eax, edi
		cmp	byte ptr [ebx+22Ch], 0
		jnz	loc_4299B5

loc_42992C:				; CODE XREF: sub_429860+E1j
		mov	ecx, [eax]
		add	eax, 4
		lea	edx, [ecx-1010101h]
		not	ecx
		and	edx, ecx
		and	edx, 80808080h
		jz	short loc_42992C

loc_429943:				; CODE XREF: sub_429860+1C4j
		mov	ecx, edx
		shr	ecx, 10h
		test	edx, 8080h
		cmovz	edx, ecx
		lea	ecx, [eax+2]
		cmovz	eax, ecx
		add	dl, dl
		sbb	eax, 3
		sub	eax, edi

loc_42995E:				; CODE XREF: sub_429860+192j
					; sub_429860+19Bj
		lea	edx, [ebx+120h]
		mov	ecx, 41h
		mov	word ptr [ebx+eax+22Ch], 2Ah
		mov	edi, edx
		xor	eax, eax
		rep stosd
		mov	dword ptr [ebx+224h], 0FFFFFFFFh
		mov	dword ptr [ebx+228h], 0
		mov	dword ptr [ebx+118h], 0
		mov	word ptr [ebx+11Ch], 0
		mov	word ptr [ebx+11Eh], 0

loc_4299A9:				; CODE XREF: sub_429860+1FDj
					; sub_429860+20Dj ...
		add	esp, 120h
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_4299B5:				; CODE XREF: sub_429860+C6j
					; sub_429860+16Aj
		mov	ecx, [eax]
		add	eax, 4
		lea	edx, [ecx-1010101h]
		not	ecx
		and	edx, ecx
		and	edx, 80808080h
		jz	short loc_4299B5
		mov	ecx, edx
		shr	ecx, 10h
		test	edx, 8080h
		cmovz	edx, ecx
		lea	ecx, [eax+2]
		cmovz	eax, ecx
		add	dl, dl
		sbb	eax, 3
		sub	eax, edi
		movzx	edx, byte ptr [ebx+eax+22Bh]
		cmp	dl, 2Fh
		jz	loc_42995E
		cmp	dl, 5Ch
		jz	loc_42995E
		mov	word ptr [ebx+eax+22Ch], 5Ch
		mov	eax, edi

loc_429A0D:				; CODE XREF: sub_429860+1C2j
		mov	ecx, [eax]
		add	eax, 4
		lea	edx, [ecx-1010101h]
		not	ecx
		and	edx, ecx
		and	edx, 80808080h
		jz	short loc_429A0D
		jmp	loc_429943
; ---------------------------------------------------------------------------
		align 10h

loc_429A30:				; CODE XREF: sub_429860+26j
					; sub_429860+43j
		call	_errno
		xor	ebx, ebx
		mov	dword ptr [eax], 14h
		add	esp, 120h
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_429A50:				; CODE XREF: sub_429860+3Bj
		call	_errno
		xor	ebx, ebx
		mov	dword ptr [eax], 2
		jmp	loc_4299A9
; ---------------------------------------------------------------------------

loc_429A62:				; CODE XREF: sub_429860+A5j
		call	_errno
		mov	dword ptr [eax], 0Ch
		jmp	loc_4299A9
; ---------------------------------------------------------------------------

loc_429A72:				; CODE XREF: sub_429860+1Dj
		call	_errno
		mov	dword ptr [eax], 0Eh
		jmp	loc_4299A9
sub_429860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_429A90	proc near		; CODE XREF: sub_406CA5+258p
					; sub_40CD34+37Ep ...

Str		= dword	ptr -1Ch
Source		= dword	ptr -18h
arg_0		= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, [esp+1Ch+arg_0]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	loc_429B9D
		xor	esi, esi
		cmp	dword ptr [ebx+228h], 0
		jl	short loc_429B0C
		mov	[esp+1Ch+Source], ebx
		jz	short loc_429B14
		mov	eax, [ebx+224h]
		mov	[esp+1Ch+Str], eax
		call	_findnext
		test	eax, eax
		jnz	short loc_429B40
		mov	eax, [ebx+228h]
		add	eax, 1
		test	eax, eax
		mov	[ebx+228h], eax
		jle	short loc_429B0C

loc_429AE2:				; CODE XREF: sub_429A90+A7j
		lea	esi, [ebx+14h]
		mov	[esp+1Ch+Str], esi ; Str
		call	strlen
		mov	[ebx+11Eh], ax
		lea	eax, [ebx+120h]
		mov	[esp+1Ch+Source], esi ;	Source
		lea	esi, [ebx+118h]
		mov	[esp+1Ch+Str], eax ; Dest
		call	strcpy

loc_429B0C:				; CODE XREF: sub_429A90+25j
					; sub_429A90+50j ...
		add	esp, 14h
		mov	eax, esi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_429B14:				; CODE XREF: sub_429A90+2Bj
		lea	eax, [ebx+22Ch]
		mov	[esp+1Ch+Str], eax
		call	_findfirst
		cmp	eax, 0FFFFFFFFh
		mov	[ebx+224h], eax
		jz	short loc_429B77
		mov	dword ptr [ebx+228h], 1
		jmp	short loc_429AE2
; ---------------------------------------------------------------------------
		align 10h

loc_429B40:				; CODE XREF: sub_429A90+3Dj
		call	ds:GetLastError
		cmp	eax, 12h
		jz	short loc_429B90

loc_429B4B:				; CODE XREF: sub_429A90+10Bj
		mov	eax, [ebx+224h]
		xor	esi, esi
		mov	[esp+1Ch+Str], eax
		call	_findclose
		mov	eax, esi
		mov	dword ptr [ebx+224h], 0FFFFFFFFh
		mov	dword ptr [ebx+228h], 0FFFFFFFFh
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_429B77:				; CODE XREF: sub_429A90+9Bj
		mov	dword ptr [ebx+228h], 0FFFFFFFFh
		add	esp, 14h
		mov	eax, esi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_429B90:				; CODE XREF: sub_429A90+B9j
		call	_errno
		mov	dword ptr [eax], 0
		jmp	short loc_429B4B
; ---------------------------------------------------------------------------

loc_429B9D:				; CODE XREF: sub_429A90+16j
		call	_errno
		xor	esi, esi
		mov	dword ptr [eax], 0Eh
		jmp	loc_429B0C
sub_429A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_429BB0(void *)
sub_429BB0	proc near		; CODE XREF: sub_406BDB+B3p
					; sub_406CA5+27Bp ...

Memory		= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	[esp+1Ch+var_8], ebx
		mov	ebx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_4], esi
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	short loc_429BFB
		mov	eax, [ebx+224h]
		xor	esi, esi
		cmp	eax, 0FFFFFFFFh
		jz	short loc_429BE5
		mov	[esp+1Ch+Memory], eax
		call	_findclose
		mov	esi, eax

loc_429BE5:				; CODE XREF: sub_429BB0+29j
		mov	[esp+1Ch+Memory], ebx ;	Memory
		call	free

loc_429BED:				; CODE XREF: sub_429BB0+5Bj
		mov	eax, esi
		mov	ebx, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_429BFB:				; CODE XREF: sub_429BB0+1Cj
		call	_errno
		mov	esi, 0FFFFFFFFh
		mov	dword ptr [eax], 0Eh
		jmp	short loc_429BED
sub_429BB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_429C10	proc near		; CODE XREF: .text:00429CC6p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 18h
		mov	ebx, [esp+1Ch+arg_0]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	short loc_429C53
		mov	eax, [ebx+224h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_429C3A
		mov	[esp+1Ch+var_1C], eax
		call	_findclose

loc_429C3A:				; CODE XREF: sub_429C10+20j
		mov	dword ptr [ebx+224h], 0FFFFFFFFh
		mov	dword ptr [ebx+228h], 0

loc_429C4E:				; CODE XREF: sub_429C10+4Ej
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_429C53:				; CODE XREF: sub_429C10+15j
		call	_errno
		mov	dword ptr [eax], 0Eh
		jmp	short loc_429C4E
sub_429C10	endp

; ---------------------------------------------------------------------------
		push	ebx
		sub	esp, 8
		mov	ebx, [esp+10h]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	short loc_429C82
		mov	eax, [ebx+228h]

loc_429C7D:				; CODE XREF: .text:00429C92j
		add	esp, 8
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_429C82:				; CODE XREF: .text:00429C75j
		call	_errno
		mov	dword ptr [eax], 0Eh
		mov	eax, 0FFFFFFFFh
		jmp	short loc_429C7D
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, [esp+20h]
		mov	esi, [esp+24h]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	short loc_429D2D
		cmp	esi, 0FFFFFFFFh
		jl	short loc_429D20
		jz	short loc_429CF0
		mov	[esp], ebx
		call	sub_429C10
		nop
		lea	esi, [esi+0]
		jmp	short loc_429CDE
; ---------------------------------------------------------------------------

loc_429CD2:				; CODE XREF: .text:00429CE4j
		mov	[esp], ebx
		call	sub_429A90
		test	eax, eax
		jz	short loc_429D17

loc_429CDE:				; CODE XREF: .text:00429CD0j
		cmp	esi, [ebx+228h]
		jg	short loc_429CD2
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_429CF0:				; CODE XREF: .text:00429CC1j
		mov	eax, [ebx+224h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_429D03
		mov	[esp], eax
		call	_findclose

loc_429D03:				; CODE XREF: .text:00429CF9j
		mov	dword ptr [ebx+224h], 0FFFFFFFFh
		mov	dword ptr [ebx+228h], 0FFFFFFFFh

loc_429D17:				; CODE XREF: .text:00429CDCj
					; .text:00429D2Bj ...
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_429D20:				; CODE XREF: .text:00429CBFj
		call	_errno
		mov	dword ptr [eax], 16h
		jmp	short loc_429D17
; ---------------------------------------------------------------------------

loc_429D2D:				; CODE XREF: .text:00429CBAj
		call	_errno
		mov	dword ptr [eax], 0Eh
		jmp	short loc_429D17
; ---------------------------------------------------------------------------
		align 10h
; [00000005 BYTES: COLLAPSED FUNCTION j__lseeki64]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_429D50	proc near		; CODE XREF: sub_414E72+41Bp

C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	edi, [esp+4Ch+arg_4]
		mov	ebp, [esp+4Ch+arg_0]
		test	edi, edi
		jz	short loc_429D69
		mov	eax, [esp+4Ch+arg_4]
		mov	[eax], ebp

loc_429D69:				; CODE XREF: sub_429D50+11j
		cmp	[esp+4Ch+arg_8], 1
		jz	short loc_429D82
		mov	eax, [esp+4Ch+arg_8]
		shr	eax, 1Fh
		test	al, al
		jnz	short loc_429D82
		cmp	[esp+4Ch+arg_8], 24h
		jle	short loc_429DA3

loc_429D82:				; CODE XREF: sub_429D50+1Ej
					; sub_429D50+29j
		call	_errno
		xor	esi, esi
		xor	edi, edi
		mov	dword ptr [eax], 21h

loc_429D91:				; CODE XREF: sub_429D50+151j
					; sub_429D50+15Ej
		add	esp, 3Ch
		mov	eax, esi
		pop	ebx
		mov	edx, edi
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_429DA0:				; CODE XREF: sub_429D50+64j
		add	ebp, 1

loc_429DA3:				; CODE XREF: sub_429D50+30j
		movzx	ebx, byte ptr [ebp+0]
		movsx	eax, bl
		mov	[esp+4Ch+C], eax ; C
		call	isspace
		test	eax, eax
		jnz	short loc_429DA0
		xor	edx, edx
		cmp	bl, 2Dh
		setz	dl
		mov	eax, ebp
		mov	[esp+4Ch+var_20], edx
		jz	loc_429EB3
		cmp	bl, 2Bh
		jz	loc_429EB3
		mov	esi, [esp+4Ch+arg_8]
		test	esi, esi
		jnz	loc_429EC6

loc_429DDF:				; CODE XREF: sub_429D50+170j
		cmp	bl, 30h
		mov	[esp+4Ch+arg_8], 0Ah
		jz	loc_42A026

loc_429DF0:				; CODE XREF: sub_429D50+17Bj
					; sub_429D50+184j ...
		movsx	ebx, bl
		lea	eax, [ebx-30h]
		cmp	eax, 9
		ja	loc_429FB0

loc_429DFF:				; CODE XREF: sub_429D50+1A8j
		lea	esi, [ebx-30h]
		mov	edx, esi
		shr	edx, 1Fh

loc_429E07:				; CODE XREF: sub_429D50+280j
					; sub_429D50+28Ej
		cmp	[esp+4Ch+arg_8], esi
		jle	loc_42A016

loc_429E11:				; CODE XREF: sub_429D50+2C0j
		test	dl, dl
		jnz	loc_42A016
		mov	eax, [esp+4Ch+arg_8]
		mov	edi, esi
		add	ebp, 1
		sar	edi, 1Fh
		mov	[esp+4Ch+var_30], edi
		mov	edi, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_24], 0
		mov	edx, eax
		sar	edx, 1Fh
		mov	[esp+4Ch+var_2C], eax
		mov	[esp+4Ch+var_28], edx
		mov	[esp+4Ch+var_34], esi

loc_429E46:				; CODE XREF: sub_429D50+24Ej
		movsx	esi, byte ptr [ebp+0]
		lea	ebx, [esi-30h]
		cmp	ebx, 9
		jbe	loc_429F03
		mov	[esp+4Ch+C], esi ; C
		lea	ebx, [esi-37h]
		call	isupper
		test	eax, eax
		jnz	loc_429F03
		mov	[esp+4Ch+C], esi ; C
		call	islower
		test	eax, eax
		jnz	loc_429F00

loc_429E79:				; CODE XREF: sub_429D50+1C3j
		mov	ecx, [esp+4Ch+arg_4]
		mov	esi, [esp+4Ch+var_34]
		mov	edi, [esp+4Ch+var_30]
		test	ecx, ecx
		jz	short loc_429E8F
		mov	edx, [esp+4Ch+arg_4]
		mov	[edx], ebp

loc_429E8F:				; CODE XREF: sub_429D50+137j
		mov	edx, [esp+4Ch+var_24]
		test	edx, edx
		jnz	loc_429FE3
		mov	eax, [esp+4Ch+var_20]
		test	eax, eax
		jz	loc_429D91
		neg	esi
		adc	edi, 0
		neg	edi
		jmp	loc_429D91
; ---------------------------------------------------------------------------

loc_429EB3:				; CODE XREF: sub_429D50+74j
					; sub_429D50+7Dj
		mov	esi, [esp+4Ch+arg_8]
		add	ebp, 1
		movzx	ebx, byte ptr [eax+1]
		test	esi, esi
		jz	loc_429DDF

loc_429EC6:				; CODE XREF: sub_429D50+89j
		cmp	[esp+4Ch+arg_8], 10h
		jnz	loc_429DF0
		cmp	bl, 30h
		jnz	loc_429DF0
		movzx	eax, byte ptr [ebp+1]
		cmp	al, 58h
		setz	dl
		cmp	al, 78h
		jz	loc_42A032
		test	dl, dl
		jnz	loc_42A032
		mov	ebx, 30h
		jmp	loc_429DFF
; ---------------------------------------------------------------------------
		align 10h

loc_429F00:				; CODE XREF: sub_429D50+123j
		lea	ebx, [esi-57h]

loc_429F03:				; CODE XREF: sub_429D50+100j
					; sub_429D50+113j
		mov	eax, ebx
		xor	edx, edx
		not	eax
		cmp	edi, ebx
		setnle	dl
		shr	eax, 1Fh
		test	edx, eax
		jz	loc_429E79
		mov	eax, [esp+4Ch+var_2C]
		mov	edx, [esp+4Ch+var_28]
		mov	[esp+4Ch+C], 0FFFFFFFFh
		mov	[esp+4Ch+var_48], 0FFFFFFFFh
		mov	[esp+4Ch+var_44], eax
		mov	[esp+4Ch+var_40], edx
		call	sub_42A300
		add	eax, 1
		adc	edx, 0
		cmp	[esp+4Ch+var_30], edx
		ja	short loc_429F93
		jb	short loc_429F51
		cmp	[esp+4Ch+var_34], eax
		ja	short loc_429F93

loc_429F51:				; CODE XREF: sub_429D50+1F9j
		mov	eax, [esp+4Ch+var_30]
		mov	ecx, ebx
		mov	edx, [esp+4Ch+var_28]
		sar	ebx, 1Fh
		imul	eax, [esp+4Ch+var_2C]
		imul	edx, [esp+4Ch+var_34]
		lea	esi, [eax+edx]
		mov	eax, [esp+4Ch+var_34]
		mul	[esp+4Ch+var_2C]
		add	edx, esi
		mov	[esp+4Ch+var_3C], eax
		mov	[esp+4Ch+var_38], edx
		add	ecx, [esp+4Ch+var_3C]
		adc	ebx, [esp+4Ch+var_38]
		cmp	[esp+4Ch+var_30], ebx
		jb	short loc_429FA3
		ja	short loc_429F93
		cmp	[esp+4Ch+var_34], ecx
		jbe	short loc_429FA3

loc_429F93:				; CODE XREF: sub_429D50+1F7j
					; sub_429D50+1FFj ...
		mov	[esp+4Ch+var_24], 1

loc_429F9B:				; CODE XREF: sub_429D50+25Bj
		add	ebp, 1
		jmp	loc_429E46
; ---------------------------------------------------------------------------

loc_429FA3:				; CODE XREF: sub_429D50+239j
					; sub_429D50+241j
		mov	[esp+4Ch+var_34], ecx
		mov	[esp+4Ch+var_30], ebx
		jmp	short loc_429F9B
; ---------------------------------------------------------------------------
		align 10h

loc_429FB0:				; CODE XREF: sub_429D50+A9j
		mov	[esp+4Ch+C], ebx ; C
		call	isupper
		test	eax, eax
		jnz	short loc_42A004
		mov	[esp+4Ch+C], ebx ; C
		mov	esi, 0FFFFFFFFh
		call	islower
		mov	edx, 1
		test	eax, eax
		jz	loc_429E07
		lea	esi, [ebx-57h]
		mov	edx, esi
		shr	edx, 1Fh
		jmp	loc_429E07
; ---------------------------------------------------------------------------

loc_429FE3:				; CODE XREF: sub_429D50+145j
		call	_errno
		mov	esi, 0FFFFFFFFh
		mov	edi, 0FFFFFFFFh
		mov	edx, edi
		mov	dword ptr [eax], 22h
		add	esp, 3Ch
		mov	eax, esi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_42A004:				; CODE XREF: sub_429D50+26Aj
		lea	esi, [ebx-37h]
		mov	edx, esi
		shr	edx, 1Fh
		cmp	[esp+4Ch+arg_8], esi
		jg	loc_429E11

loc_42A016:				; CODE XREF: sub_429D50+BBj
					; sub_429D50+C3j
		add	esp, 3Ch
		xor	esi, esi
		xor	edi, edi
		mov	eax, esi
		pop	ebx
		mov	edx, edi
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_42A026:				; CODE XREF: sub_429D50+9Aj
		movzx	eax, byte ptr [ebp+1]
		cmp	al, 78h
		jz	short loc_42A032
		cmp	al, 58h
		jnz	short loc_42A046

loc_42A032:				; CODE XREF: sub_429D50+195j
					; sub_429D50+19Dj ...
		movzx	ebx, byte ptr [ebp+2]
		add	ebp, 2
		mov	[esp+4Ch+arg_8], 10h
		jmp	loc_429DF0
; ---------------------------------------------------------------------------

loc_42A046:				; CODE XREF: sub_429D50+2E0j
		mov	[esp+4Ch+arg_8], 8
		jmp	loc_429DF0
sub_429D50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_42A060	proc near		; CODE XREF: sub_415940+26p
		jmp	sub_42A090
sub_42A060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_42A070	proc near		; CODE XREF: sub_422FB0+AAp
		jmp	sub_42A0A0
sub_42A070	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_42A080	proc near		; CODE XREF: sub_429850j
		mov	eax, ds:time
		jmp	eax
sub_42A080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_42A090	proc near		; CODE XREF: sub_42A060j
		mov	eax, ds:gmtime
		jmp	eax
sub_42A090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_42A0A0	proc near		; CODE XREF: sub_42A070j
		mov	eax, ds:localtime
		jmp	eax
sub_42A0A0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _errno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION remove]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION feof]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fgetc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fgets]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION rewind]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION rename]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strspn]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fseek]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ftell]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION isspace]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vsprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _vsnprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fullpath]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _findnext]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _findfirst]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _findclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lseeki64]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION isupper]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION islower]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_42A300	proc near		; CODE XREF: sub_429D50+1E8p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	edx, [esp+2Ch+arg_C]
		mov	[esp+2Ch+var_C], esi
		mov	ecx, [esp+2Ch+arg_8]
		mov	esi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, [esp+2Ch+arg_4]
		test	edx, edx
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+var_24], esi
		jnz	short loc_42A368
		cmp	ecx, ebx
		ja	short loc_42A390
		test	ecx, ecx
		jnz	short loc_42A340
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_42A340:				; CODE XREF: sub_42A300+33j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, esi
		div	ecx
		mov	ecx, ebx
		mov	esi, eax

loc_42A350:				; CODE XREF: sub_42A300+6Ej
					; sub_42A300+80j ...
		mov	eax, esi
		mov	edx, ecx
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_42A368:				; CODE XREF: sub_42A300+2Bj
		xor	ecx, ecx
		xor	esi, esi
		cmp	edx, ebx
		ja	short loc_42A350
		bsr	ebp, edx
		xor	ebp, 1Fh
		jnz	short loc_42A3A0
		cmp	edi, [esp+2Ch+var_24]
		jbe	short loc_42A382
		cmp	edx, ebx
		jnb	short loc_42A350

loc_42A382:				; CODE XREF: sub_42A300+7Cj
		xor	ecx, ecx
		mov	esi, 1
		jmp	short loc_42A350
; ---------------------------------------------------------------------------
		align 10h

loc_42A390:				; CODE XREF: sub_42A300+2Fj
		mov	eax, esi
		mov	edx, ebx
		div	ecx
		xor	ecx, ecx
		mov	esi, eax
		jmp	short loc_42A350
; ---------------------------------------------------------------------------
		align 10h

loc_42A3A0:				; CODE XREF: sub_42A300+76j
		mov	eax, 20h
		mov	ecx, ebp
		sub	eax, ebp
		mov	esi, edi
		shl	edx, cl
		mov	ecx, eax
		shr	esi, cl
		mov	ecx, ebp
		or	esi, edx
		mov	edx, ebx
		mov	[esp+2Ch+var_20], esi
		mov	esi, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, eax
		shr	edx, cl
		mov	ecx, ebp
		shl	ebx, cl
		mov	ecx, eax
		shr	esi, cl
		or	esi, ebx
		mov	eax, esi
		div	[esp+2Ch+var_20]
		mov	ebx, edx
		mov	esi, eax
		mul	edi
		cmp	ebx, edx
		jb	short loc_42A3EF
		mov	edi, [esp+2Ch+var_24]
		mov	ecx, ebp
		shl	edi, cl
		cmp	edi, eax
		jnb	short loc_42A3F2
		cmp	ebx, edx
		jnz	short loc_42A3F2

loc_42A3EF:				; CODE XREF: sub_42A300+DDj
		sub	esi, 1

loc_42A3F2:				; CODE XREF: sub_42A300+E9j
					; sub_42A300+EDj
		xor	ecx, ecx
		jmp	loc_42A350
sub_42A300	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A400	proc near		; DATA XREF: .text:0042A424o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_4284C0
		leave
		retn
sub_42A400	endp

; ---------------------------------------------------------------------------
		align 10h
dword_42A420	dd 0FFFFFFFFh		; DATA XREF: sub_4290E0-4Cr
					; sub_4290E0:loc_4290A3r ...
		dd offset sub_42A400
		dd 0
		dd 0FFFFFFFFh
dword_42A430	dd 74h dup(0)		; DATA XREF: .data:off_42B5BCo
		dd 280h	dup(?)
_text		ends

; Section 2. (virtual address 0002B000)
; Virtual size			: 000005D4 (   1492.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00029A00
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 42B000h
dword_42B000	dd 12Ch, 2 dup(0)	; DATA XREF: sub_4020C2:loc_4024FEo
					; sub_4020C2:loc_402936o ...
		dd offset a@commands	; "@Commands:\n	"
		dd 1F5h, 42C051h, 100h,	42C058h, 1F6h, 42C078h,	100h, 42C080h
		dd 1F7h, 42C0A0h, 100h,	42C0A8h, 1F8h, 42C0CCh,	100h, 42C0D8h
		dd 1F9h, 42C0FBh, 100h,	42C104h, 1FAh, 42C128h,	100h, 42C132h
		dd 1FBh, 42C14Ch, 100h,	42C155h, 1FCh, 42C16Ah,	100h, 42C170h
		dd 1FDh, 42C180h, 100h,	42C18Dh, 1FEh, 42C18Fh,	100h, 42C18Dh
		dd 12Dh, 2 dup(0)
		dd offset a@Options	; "@\nOptions:\n "
		dd 76h,	42C1A9h, 0
		dd offset aVerbose	; "verbose"
		dd 71h,	42C1B1h, 0
		dd offset aBeSomewhatMore ; "be	somewhat more quiet"
		dd 73h,	42C1CEh, 0
		dd offset aShStyleCommand ; "sh-style command output"
		dd 63h,	42C1E9h, 0
		dd offset aCshStyleComman ; "csh-style command output"
		dd 1FFh, 42C206h, 2, 42C20Eh, 203h, 42C22Bh, 2,	42C238h
		dd 207h, 42C260h, 0
		dd offset aDoNotDetachFro ; "do	not detach from	the console"
		dd 208h, 42C28Bh, 2, 42C294h, 209h, 42C2B9h, 0
		dd offset aRunWithoutAski ; "run without asking	a user"
		dd 21Dh, 42C2D9h, 0
		dd offset aForceLoadingOf ; "force loading of outdated CRLs"
		dd 21Eh, 42C2FFh, 0
		dd offset aAllowSendingOc ; "allow sending OCSP	requests"
		dd 20Ah, 42C326h, 0
		dd offset aInhibitTheUseO ; "inhibit the use of	HTTP"
		dd 20Bh, 42C34Bh, 0
		dd offset aInhibitTheUs_0 ; "inhibit the use of	LDAP"
		dd 20Dh, 42C370h, 0
		dd offset aIgnoreHttpCrlD ; "ignore HTTP CRL distribution points"
		dd 20Ch, 42C3A4h, 0
		dd offset aIgnoreLdapCrlD ; "ignore LDAP CRL distribution points"
		dd 20Eh, 42C3D8h, 0
		dd offset aIgnoreCertific ; "ignore certificate	contained OCSP servi"...
		dd 20Eh, 42C41Fh, 0
		dd offset a@		; "@"
		dd 210h, 42C436h, 2, 42C444h, 211h, 42C46Bh, 2,	42C478h
		dd 212h, 42C498h, 0
		dd offset aDoNotUseFallba ; "do	not use	fallback hosts with --ldap-p"...
		dd 213h, 42C4D4h, 2, 42C4E8h, 215h, 42C50Eh, 0
		dd offset aAddNewServersD ; "add new servers discovered	in CRL distr"...
		dd 214h, 42C560h, 1, 42C56Ch, 216h, 42C58Dh, 2,	42C59Ch
		dd 217h, 42C5BBh, 2, 42C5C8h, 218h, 42C5E9h, 1,	42C18Dh
		dd 219h, 42C5FDh, 1, 42C18Dh, 21Ah, 42C60Dh, 1,	42C18Dh
		dd 21Bh, 42C621h, 1, 42C630h, 21Fh, 42C660h, 2,	42C66Ch
		dd 21Ch, 42C688h, 4, 42C18Dh, 200h, 42C69Ah, 14h, 42C18Dh
		dd 201h, 42C6A0h, 0
		dd offset a@		; "@"
		dd 202h, 42C6AAh, 1, 42C18Dh, 204h, 42C6B5h, 0
		dd offset a@		; "@"
		dd 206h, 42C6C1h, 2, 42C18Dh, 220h, 42C6C9h, 2,	42C18Dh
		dd 221h, 42C6DEh, 2, 42C18Dh, 20Fh, 42C6F3h, 0
		dd offset a@		; "@"
		dd 222h, 42C704h, 2, 42C18Dh, 12Eh, 2 dup(0)
		dd offset a@SeeTheInfoMan ; "@\n(See the \"info\" manual for a compl"...
		align 20h
dword_42B360	dd 2, 4015C2h, 427CB4h,	427CBCh, 4015D5h, 4015F6h, 401617h
					; DATA XREF: sub_4020C2+262o
		dd 401630h, 427CC4h, 401649h, 427CCCh, 427CD4h,	427CDCh
		dd 102h, 2 dup(0)
off_42B3A0	dd offset aLdapserver	; DATA XREF: sub_4064C1+22o
					; sub_4064C1+36o ...
					; "LDAPSERVER"
		dd offset sub_404FC3
		dd offset aLdapserverData ; "LDAPSERVER	<data>\n\nAdd a	new LDAP ser"...
		dd offset aIsvalid	; "ISVALID"
		dd offset sub_405080
		dd offset aIsvalidOnlyOcs ; "ISVALID [--only-ocsp] [--force-default-"...
		dd offset aCheckcrl	; "CHECKCRL"
		dd offset sub_405484
		dd offset aCheckcrlFinger ; "CHECKCRL [<fingerprint>]\n\nCheck wheth"...
		dd offset aCheckocsp	; "CHECKOCSP"
		dd offset sub_405654
		dd offset aCheckocspForce ; "CHECKOCSP [--force-default-responder] ["...
		dd offset aLookup	; "LOOKUP"
		dd offset sub_405F38
		dd offset aLookupUrlSingl ; "LOOKUP [--url] [--single] [--cache-only"...
		dd offset aLoadcrl	; "LOADCRL"
		dd offset sub_406036
		dd offset aLoadcrlUrlFile ; "LOADCRL [--url] <filename|url>\n\nLoad "...
		dd offset aListcrls	; "LISTCRLS"
		dd offset sub_4061BB
		dd offset aListcrlsListTh ; "LISTCRLS\n\nList the content of all CRL"...
		dd offset aCachecert	; "CACHECERT"
		dd offset sub_406236
		dd offset aCachecertPutAC ; "CACHECERT\n\nPut a	certificate into the"...
		dd offset aValidate	; "VALIDATE"
		dd offset sub_40634F
		dd offset aValidateValida ; "VALIDATE\n\nValidate a certificate	usin"...
		dd offset aInput	; "INPUT"
		dd 2 dup(0)
		dd offset aOutput	; "OUTPUT"
		align 40h
; int off_42B440
off_42B440	dd offset sub_415706	; DATA XREF: sub_4135D8+F1r
					; sub_4141ED+5D3r
; int off_42B444
off_42B444	dd offset sub_415802	; DATA XREF: sub_4135D8+FBr
					; sub_4141ED+5DDr
; int dword_42B448
dword_42B448	dd 0			; DATA XREF: sub_4135D8+105r
					; sub_4141ED+5E7r
; int off_42B44C
off_42B44C	dd offset sub_41584C	; DATA XREF: sub_4135D8+10Fr
					; sub_4141ED+5F1r
		align 20h
byte_42B460	db 41h			; DATA XREF: sub_4131E4+AEr
					; sub_4131E4+E0r ...
aBcdefghijklmno	db 'BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',0
		align 20h
off_42B4C0	dd offset sub_418D71	; DATA XREF: sub_41A842+86r
					; .text:0041B060r ...
off_42B4C4	dd offset sub_418DF1	; DATA XREF: sub_41A842+90r
					; .text:0041B06Ar ...
off_42B4C8	dd offset sub_419014	; DATA XREF: sub_41A842+9Ar
					; .text:0041B074r ...
off_42B4CC	dd offset sub_419231	; DATA XREF: sub_41A842+A4r
					; .text:0041B07Er ...
off_42B4D0	dd offset sub_4192CE	; DATA XREF: sub_41B23B+70r
					; .text:0041C8D3r
off_42B4D4	dd offset sub_419311	; DATA XREF: sub_41B23B+7Ar
					; .text:0041C8DDr
off_42B4D8	dd offset sub_419354	; DATA XREF: sub_41B23B+84r
					; .text:0041C8E7r
off_42B4DC	dd offset sub_4193C6	; DATA XREF: sub_41B23B+8Er
					; sub_41B23B+C3r ...
off_42B4E0	dd offset sub_419482	; DATA XREF: sub_41B355+8Br
off_42B4E4	dd offset sub_4194D7	; DATA XREF: sub_41B355+95r
off_42B4E8	dd offset sub_41951D	; DATA XREF: sub_41B355+9Fr
off_42B4EC	dd offset sub_41960B	; DATA XREF: sub_41B355+A9r
					; sub_41B355+DBr
off_42B4F0	dd offset sub_4192CE	; DATA XREF: .text:0041AF59r
					; .text:0041B52Fr
off_42B4F4	dd offset sub_419311	; DATA XREF: .text:0041AF63r
					; .text:0041B539r
off_42B4F8	dd offset sub_419354	; DATA XREF: .text:0041AF6Dr
					; .text:0041B543r
off_42B4FC	dd offset sub_4193C6	; DATA XREF: .text:0041AF77r
					; .text:0041AFADr ...
off_42B500	dd offset aR_2		; DATA XREF: sub_419719+12o
					; "r"
		align 8
		dd offset aRb_1		; "rb"
		dd 8000h, 43201Eh, 301h, 432020h, 8301h, 432023h, 109h
		dd 432025h, 8109h, 432028h, 2, 43202Bh,	8002h, 43202Fh
		dd 8001h, 432033h, 302h, 432036h, 8302h, 43203Ah, 8302h
		dd 43203Eh, 10Ah, 432041h, 810Ah, 432045h, 810Ah, 2 dup(0)
; char *off_42B580
off_42B580	dd offset a2_289_9_9	; DATA XREF: sub_41FA19+ABr
					; sub_41FA19+FDr ...
					; "2.289.9.9"
		align 8
; char *off_42B588
off_42B588	dd offset a2_5_29_15	; DATA XREF: sub_41F8CC+34r
					; sub_41F8CC+45r ...
					; "2.5.29.15"
		dd offset a2_5_29_19	; "2.5.29.19"
		dd offset a2_5_29_32	; "2.5.29.32"
		dd offset a2_5_29_37	; "2.5.29.37"
		dd 0
; LPCSTR off_42B59C
off_42B59C	dd offset aShell32_dll	; DATA XREF: sub_42223E+30r
					; sub_42223E+90r
					; "shell32.dll"
		dd offset aShfolder_dll	; "shfolder.dll"
		align 8
dword_42B5A8	dd 0FFFFFFFFh		; DATA XREF: sub_422B51:loc_422C95w
					; .text:loc_422F49r ...
; char off_42B5AC[]
off_42B5AC	dd offset aIso88591	; DATA XREF: sub_426AD4+C6w
					; .text:loc_426D9Ew ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_42B5BC	dd offset dword_42A430	; DATA XREF: sub_429060+3r
					; sub_429060+12r ...
dword_42B5C0	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_42B5C4	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_42B5C8	dd 0BB40E64Eh		; DATA XREF: sub_429100+3r
					; sub_429100:loc_4291B2w ...
dword_42B5CC	dd 44BF19B1h		; DATA XREF: sub_429100+31w
					; sub_429100+B8w ...
dword_42B5D0	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0002C000)
; Virtual size			: 0000810C (  33036.)
; Section size in file		: 00008200 (  33280.)
; Offset to raw	data for section: 0002A000
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 42C000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
a@commands	db '@Commands:',0Ah     ; DATA XREF: .data:0042B00Co
		db ' ',0
aServer_0	db 'server',0
aRunInServerMod	db 'run in server mode (foreground)',0
aDaemon_0	db 'daemon',0
		align 10h
aRunInDaemonMod	db 'run in daemon mode (background)',0
aService_0	db 'service',0
aRunAsWindowsSe	db 'run as windows service (background)',0
aListCrls_0	db 'list-crls',0
		align 4
aListTheContent	db 'list the contents of the CRL cache',0
aLoadCrl	db 'load-crl',0
aFileLoadCrlFro	db '|FILE|load CRL from FILE into cache',0
aFetchCrl	db 'fetch-crl',0
aUrlFetchACrlFr	db '|URL|fetch a CRL from URL',0
aShutdown	db 'shutdown',0
aShutdownTheDir	db 'shutdown the dirmngr',0
aFlush_0	db 'flush',0
aFlushTheCache	db 'flush the cache',0
aGpgconfList	db 'gpgconf-list',0
a@		db '@',0                ; DATA XREF: .data:0042B1CCo
					; .data:0042B2CCo ...
aGpgconfTest	db 'gpgconf-test',0
a@Options	db '@',0Ah              ; DATA XREF: .data:0042B0BCo
		db 'Options:',0Ah
		db ' ',0
aVerbose	db 'verbose',0          ; DATA XREF: .data:0042B0CCo
aQuiet		db 'quiet',0
aBeSomewhatMore	db 'be somewhat more quiet',0 ; DATA XREF: .data:0042B0DCo
aSh		db 'sh',0
aShStyleCommand	db 'sh-style command output',0 ; DATA XREF: .data:0042B0ECo
; char Str2[4]
Str2		db 'csh',0              ; DATA XREF: sub_4020C2+2E2o
aCshStyleComman	db 'csh-style command output',0 ; DATA XREF: .data:0042B0FCo
aOptions_0	db 'options',0
aFileReadOption	db '|FILE|read options from FILE',0
aDebugLevel	db 'debug-level',0
		align 4
aLevelSetTheDeb	db '|LEVEL|set the debugging level to LEVEL',0
aNoDetach	db 'no-detach',0
		align 4
aDoNotDetachFro	db 'do not detach from the console',0 ; DATA XREF: .data:0042B12Co
aLogFile	db 'log-file',0
aFileWriteServe	db '|FILE|write server mode logs to FILE',0
aBatch		db 'batch',0
aRunWithoutAski	db 'run without asking a user',0 ; DATA XREF: .data:0042B14Co
aForce		db 'force',0
		align 10h
aForceLoadingOf	db 'force loading of outdated CRLs',0 ; DATA XREF: .data:0042B15Co
aAllowOcsp	db 'allow-ocsp',0
aAllowSendingOc	db 'allow sending OCSP requests',0 ; DATA XREF: .data:0042B16Co
aDisableHttp	db 'disable-http',0
aInhibitTheUseO	db 'inhibit the use of HTTP',0 ; DATA XREF: .data:0042B17Co
aDisableLdap	db 'disable-ldap',0
aInhibitTheUs_0	db 'inhibit the use of LDAP',0 ; DATA XREF: .data:0042B18Co
aIgnoreHttpDp	db 'ignore-http-dp',0
		align 10h
aIgnoreHttpCrlD	db 'ignore HTTP CRL distribution points',0 ; DATA XREF: .data:0042B19Co
aIgnoreLdapDp	db 'ignore-ldap-dp',0
		align 4
aIgnoreLdapCrlD	db 'ignore LDAP CRL distribution points',0 ; DATA XREF: .data:0042B1ACo
aIgnoreOcspSe_1	db 'ignore-ocsp-service-url',0
aIgnoreCertific	db 'ignore certificate contained OCSP service URLs',0
					; DATA XREF: .data:0042B1BCo
aIgnoreOcspSe_2	db 'ignore-ocsp-servic-url',0
aHttpProxy	db 'http-proxy',0
		align 4
aUrlRedirectAll	db '|URL|redirect all HTTP requests to URL',0
aLdapProxy	db 'ldap-proxy',0
		align 4
aHostUseHostFor	db '|HOST|use HOST for LDAP queries',0
aOnlyLdapProxy	db 'only-ldap-proxy',0
aDoNotUseFallba	db 'do not use fallback hosts with --ldap-proxy',0
					; DATA XREF: .data:0042B1FCo
aLdapserverli_0	db 'ldapserverlist-file',0
aFileReadLdapSe	db '|FILE|read LDAP server list from FILE',0
aAddServers	db 'add-servers',0
		align 4
aAddNewServersD	db 'add new servers discovered in CRL distribution points to serverli'
					; DATA XREF: .data:0042B21Co
		db 'st',0
aLdaptimeout	db 'ldaptimeout',0
aNSetLdapTimeou	db '|N|set LDAP timeout to N seconds',0
aOcspResponder	db 'ocsp-responder',0
aUrlUseOcspResp	db '|URL|use OCSP responder at URL',0
aOcspSigner_0	db 'ocsp-signer',0
		align 4
aFprOcspRespons	db '|FPR|OCSP response signed by FPR',0
aOcspMaxClockSk	db 'ocsp-max-clock-skew',0
aOcspMaxPeriod	db 'ocsp-max-period',0
aOcspCurrentPer	db 'ocsp-current-period',0
aMaxReplies	db 'max-replies',0
		align 10h
aNDoNotReturnMo	db '|N|do not return more than N items in one query',0
aSocketName	db 'socket-name',0
aFileListenOnSo	db '|FILE|listen on socket FILE',0
aFakedSystemT_0	db 'faked-system-time',0
aDebug		db 'debug',0
aDebugAll	db 'debug-all',0
aDebugWait	db 'debug-wait',0
aNoGreeting	db 'no-greeting',0
aHomedir_0	db 'homedir',0
aLdapWrapperPro	db 'ldap-wrapper-program',0
aHttpWrapperPro	db 'http-wrapper-program',0
aHonorHttpPro_0	db 'honor-http-proxy',0
aIgnoreCertExte	db 'ignore-cert-extension',0
		align 4
a@SeeTheInfoMan	db '@',0Ah              ; DATA XREF: .data:0042B34Co
		db '(See the "info" manual for a complete listing of all commands and'
		db ' options)',0Ah,0
; char aDirmngr[]
aDirmngr	db 'dirmngr',0          ; DATA XREF: sub_401677:loc_401692o
					; sub_4020C2+12Eo ...
a1_1_1		db '1.1.1',0            ; DATA XREF: sub_401677:loc_40169Bo
aCopyrightC2013	db 'Copyright (C) 2013 g10 Code GmbH',0 ; DATA XREF: sub_401677:loc_4016A4o
aMingw32	db 'MingW32',0          ; DATA XREF: sub_401677:loc_4016ADo
		align 4
aPleaseReportBu	db 'Please report bugs to <@EMAIL@>.',0Ah,0
					; DATA XREF: sub_401677:loc_4016B6o
aBugDirmngr@gnu	db 'bug-dirmngr@gnupg.org',0 ; DATA XREF: sub_401677:loc_4016BFo
aUsageDirmngrOp	db 'Usage: dirmngr [options] (-h for help)',0
					; DATA XREF: sub_401677:loc_4016C8o
		align 4
aSyntaxDirmngrO	db 'Syntax: dirmngr [options] [command [args]]',0Ah
					; DATA XREF: sub_401677:loc_4016D1o
		db 'LDAP and OCSP access for GnuPG',0Ah,0
		align 10h
off_42C850	dd offset loc_4016DA	; DATA XREF: sub_401677+12o
		dd offset loc_4016C8	; jump table for switch	statement
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_401692
		dd offset loc_4016DA
		dd offset loc_40169B
		dd offset loc_4016A4
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016AD
		dd offset loc_4016DA
		dd offset loc_4016B6
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016C8
		dd offset loc_4016D1
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016DA
		dd offset loc_4016BF
a1_3_14_3_2_26	db '1.3.14.3.2.26',0    ; DATA XREF: sub_40177C+13o
aNone		db 'none',0             ; DATA XREF: sub_40180A+69o
aBasic		db 'basic',0            ; DATA XREF: sub_40180A+AEo
aAdvanced	db 'advanced',0         ; DATA XREF: sub_40180A+F3o
aExpert		db 'expert',0           ; DATA XREF: sub_40180A+138o
aGuru		db 'guru',0             ; DATA XREF: sub_40180A+17Do
		align 4
; char aInvalidDebugLe[]
aInvalidDebugLe	db 'invalid debug-level `%s',27h,' given',0Ah,0 ; DATA XREF: sub_40180A+1CEo
aNoneBasicAdvan	db 'none, basic, advanced, expert, guru',0 ; DATA XREF: sub_40180A+1DAo
; char aValidDebugLeve[]
aValidDebugLeve	db 'valid debug levels are: %s',0Ah,0 ; DATA XREF: sub_40180A+1E2o
aUsageDirmngr_0	db 'usage: dirmngr [options] ',0 ; DATA XREF: sub_401A7B+Eo
aLdapReaper	db 'ldap-reaper',0      ; DATA XREF: sub_401AE7+5Bo
		align 10h
; char aErrorSpawningL[]
aErrorSpawningL	db 'error spawning ldap wrapper reaper thread: %s',0Ah,0
					; DATA XREF: sub_401AE7+AAo
; CHAR ServiceName[]
ServiceName	db 'DirMngr',0          ; DATA XREF: sub_4020C2+84o
					; sub_4034A1:loc_40351Fo
		align 4
; char aFailedToRegist[]
aFailedToRegist	db 'failed to register service control handler: ec=%d',0
					; DATA XREF: sub_4020C2+AEo
a1_4_0		db '1.4.0',0            ; DATA XREF: sub_4020C2+14Eo
					; sub_4020C2+16Eo
aLibgcrypt	db 'libgcrypt',0        ; DATA XREF: sub_4020C2+176o
		align 4
; char aSIsTooOldNeedS[]
aSIsTooOldNeedS	db '%s is too old (need %s, have %s)',0Ah,0 ; DATA XREF: sub_4020C2+17Eo
					; sub_4020C2+1DAo
a1_0_2		db '1.0.2',0            ; DATA XREF: sub_4020C2+1AAo
					; sub_4020C2+1CAo
aLibksba	db 'libksba',0          ; DATA XREF: sub_4020C2+1D2o
; char VarName[]
VarName		db 'SHELL',0            ; DATA XREF: sub_4020C2+278o
aDirmngr_conf	db 'dirmngr.conf',0     ; DATA XREF: sub_4020C2+49Ao
					; sub_4020C2+111Fo
; char Mode[]
Mode		db 'r',0                ; DATA XREF: sub_4020C2+4E9o
					; sub_4035E6+11o ...
		align 4
; char aNoteNoDefaultO[]
aNoteNoDefaultO	db 'NOTE: no default option file `%s',27h,0Ah,0 ; DATA XREF: sub_4020C2+519o
; char aOptionFileSS[]
aOptionFileSS	db 'option file `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4020C2+543o
					; .text:00403E07o
; char aReadingOptions[]
aReadingOptions	db 'reading options from `%s',27h,0Ah,0 ; DATA XREF: sub_4020C2+580o
; char Format[]
Format		db '%s %s; %s',0Ah,0    ; DATA XREF: sub_4020C2+965o
; char aS[]
aS		db '%s',0Ah,0           ; DATA XREF: sub_4020C2+997o
		align 4
; char aWarningRunning[]
aWarningRunning	db 'WARNING: running with faked system time %s',0Ah,0
					; DATA XREF: sub_4020C2+9D6o
aLdapservers_co	db 'ldapservers.conf',0 ; DATA XREF: sub_4020C2+9F6o
					; sub_4020C2+11E5o
aDirmngr_ldapse	db 'dirmngr_ldapservers.conf',0 ; DATA XREF: sub_4020C2:loc_402ABFo
					; sub_4020C2:loc_4032AEo
; char aServer[]
aServer		db '--server',0         ; DATA XREF: sub_4020C2+A8Co
		align 4
; char aWaitingForDebu[]
aWaitingForDebu	db 'waiting for debugger - my pid is %u .....',0Ah,0
					; DATA XREF: sub_4020C2+ACCo
; char a___Okay[]
a___Okay	db '... okay',0Ah,0     ; DATA XREF: sub_4020C2+AE5o
; char aDaemon[]
aDaemon		db '--daemon',0         ; DATA XREF: sub_4020C2+B2Ao
; char aNameOfSocketTo[]
aNameOfSocketTo	db 'name of socket too long',0Ah,0 ; DATA XREF: sub_4020C2+B9Ao
; char aCanTCreateSock[]
aCanTCreateSock	db 'can',27h,'t create socket: %s',0Ah,0 ; DATA XREF: sub_4020C2+BECo
; char aErrorGettingNo[]
aErrorGettingNo	db 'error getting nonce for the socket',0Ah,0 ; DATA XREF: sub_4020C2+D02o
; char aErrorBindingSo[]
aErrorBindingSo	db 'error binding socket to `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_4020C2+D3Eo
; char aListenFailedS[]
aListenFailedS	db 'listen() failed: %s',0Ah,0 ; DATA XREF: sub_4020C2+D9Do
; char aListeningOnSoc[]
aListeningOnSoc	db 'listening on socket `%s',27h,0Ah,0 ; DATA XREF: sub_4020C2+DD2o
; char aSetDirmngr_inf[]
aSetDirmngr_inf	db 'set DIRMNGR_INFO=%s;%lu;1',0Ah,0 ; DATA XREF: sub_4020C2+DFBo
; char aListCrls[]
aListCrls	db '--list-crls',0      ; DATA XREF: sub_4020C2+EADo
; char aFetchCrlUrl[]
aFetchCrlUrl	db '--fetch-crl URL',0  ; DATA XREF: sub_4020C2+FA6o
; char aFetchingCrlFro[]
aFetchingCrlFro	db 'fetching CRL from `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_4020C2+1039o
		align 4
; char aProcessingCrlF[]
aProcessingCrlF	db 'processing CRL from `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_4020C2+108Co
; char aFlush[]
aFlush		db '--flush',0          ; DATA XREF: sub_4020C2+10BBo
; char aGpgconfDirmngr[]
aGpgconfDirmngr	db 'gpgconf-dirmngr.conf:%lu:"%s',0Ah,0 ; DATA XREF: sub_4020C2+114Co
; char aVerboseLu[]
aVerboseLu	db 'verbose:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+1173o
; char aQuietLu[]
aQuietLu	db 'quiet:%lu:',0Ah,0   ; DATA XREF: sub_4020C2+1187o
; char aDebugLevelLuNo[]
aDebugLevelLuNo	db 'debug-level:%lu:"none',0Ah,0 ; DATA XREF: sub_4020C2+11A3o
; char aLogFileLu[]
aLogFileLu	db 'log-file:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+11B4o
; char aForceLu[]
aForceLu	db 'force:%lu:',0Ah,0   ; DATA XREF: sub_4020C2+11C8o
; char aLdapserverlist[]
aLdapserverlist	db 'ldapserverlist-file:%lu:"%s',0Ah,0 ; DATA XREF: sub_4020C2+122Co
; char aLdaptimeoutLuU[]
aLdaptimeoutLuU	db 'ldaptimeout:%lu:%u',0Ah,0 ; DATA XREF: sub_4020C2+1262o
; char aMaxRepliesLuU[]
aMaxRepliesLuU	db 'max-replies:%lu:%u',0Ah,0 ; DATA XREF: sub_4020C2+1283o
; char aAllowOcspLu[]
aAllowOcspLu	db 'allow-ocsp:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+129Co
; char aOcspResponderL[]
aOcspResponderL	db 'ocsp-responder:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+12B0o
; char aOcspSignerLu[]
aOcspSignerLu	db 'ocsp-signer:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+12C4o
; char aFakedSystemTim[]
aFakedSystemTim	db 'faked-system-time:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+12D8o
; char aNoGreetingLu[]
aNoGreetingLu	db 'no-greeting:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+12ECo
; char aDisableHttpLu[]
aDisableHttpLu	db 'disable-http:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+1300o
; char aDisableLdapLu[]
aDisableLdapLu	db 'disable-ldap:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+1314o
; char aHonorHttpProxy[]
aHonorHttpProxy	db 'honor-http-proxy:%lu',0Ah,0 ; DATA XREF: sub_4020C2+1328o
; char aHttpProxyLu[]
aHttpProxyLu	db 'http-proxy:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+133Co
; char aLdapProxyLu[]
aLdapProxyLu	db 'ldap-proxy:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+1350o
; char aOnlyLdapProxyL[]
aOnlyLdapProxyL	db 'only-ldap-proxy:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+1364o
; char aIgnoreLdapDpLu[]
aIgnoreLdapDpLu	db 'ignore-ldap-dp:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+1378o
; char aIgnoreHttpDpLu[]
aIgnoreHttpDpLu	db 'ignore-http-dp:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+138Co
; char aIgnoreOcspServ[]
aIgnoreOcspServ	db 'ignore-ocsp-service-url:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+13A0o
; char aIgnoreOcspSe_0[]
aIgnoreOcspSe_0	db 'ignore-ocsp-servic-url:%lu:',0Ah,0 ; DATA XREF: sub_4020C2+13B4o
; char aService[]
aService	db '--service',0        ; DATA XREF: sub_4034A1+2Do
; char aErrorOpeningSS[]
aErrorOpeningSS	db 'error opening `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4035E6+4Ao
		align 4
; char aSULineTooLongS[]
aSULineTooLongS	db '%s:%u: line too long - skipped',0Ah,0 ; DATA XREF: sub_4035E6+E6o
; char aErrorReadingSS[]
aErrorReadingSS	db 'error reading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4035E6+1D8o
; char Control[]
Control		db '/.~\',0             ; DATA XREF: sub_4037E4+18o
aOcspSigner	db '--ocsp-signer',0    ; DATA XREF: sub_4037E4+143o
		align 10h
; char aSUInvalidFinge[]
aSUInvalidFinge	db '%s:%u: invalid fingerprint detected',0Ah,0 ; DATA XREF: sub_4037E4+14Bo
					; sub_4037E4+542o
; char aCanTOpenSS[]
aCanTOpenSS	db 'can',27h,'t open `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4037E4+222o
; char aSUReadErrorS[]
aSUReadErrorS	db '%s:%u: read error: %s',0Ah,0 ; DATA XREF: sub_4037E4+2B2o
					; sub_4037E4+3B9o
		align 4
; char aSUGarbageAtEnd[]
aSUGarbageAtEnd	db '%s:%u: garbage at end of line ignored',0Ah,0
					; DATA XREF: sub_4037E4+5A9o
		align 4
; char aSignalDReceive[]
aSignalDReceive	db 'signal %d received - no action defined',0Ah,0 ; DATA XREF: sub_403EC3+Do
; char aSigtermReceive[]
aSigtermReceive	db 'SIGTERM received - shutting down ...',0Ah,0 ; DATA XREF: sub_403EDE+10o
; char aShutdownForced[]
aShutdownForced	db 'shutdown forced',0Ah,0 ; DATA XREF: sub_403EDE+26o
; char aSSStopped[]
aSSStopped	db '%s %s stopped',0Ah,0 ; DATA XREF: sub_403EDE+54o
					; sub_404046+37Ao
		align 4
; char aErrorReadingNo[]
aErrorReadingNo	db 'error reading nonce on fd %d: %s',0Ah,0 ; DATA XREF: sub_403F55+38o
; char aHandlerForFdDS[]
aHandlerForFdDS	db 'handler for fd %d started',0Ah,0 ; DATA XREF: sub_403FB2+4Do
; char aHandlerForFdDT[]
aHandlerForFdDT	db 'handler for fd %d terminated',0Ah,0 ; DATA XREF: sub_403FB2+74o
		align 4
; char aAcceptFailedSW[]
aAcceptFailedSW	db 'accept failed: %s - waiting 1s',0Ah,0 ; DATA XREF: sub_404046+217o
; char aErrorSpawningC[]
aErrorSpawningC	db 'error spawning connection handler: %s',0Ah,0
					; DATA XREF: sub_404046+2DBo
		align 20h
; char aAssuan_inquire[]
aAssuan_inquire	db 'assuan_inquire(%s) failed: %s',0Ah,0 ; DATA XREF: sub_40486E+ECo
					; sub_404A97+1C9o ...
		align 10h
; char aGet_cert_local[]
aGet_cert_local	db 'get_cert_local called w/o context',0Ah,0 ; DATA XREF: sub_4049E3+2Bo
aSendcert	db 'SENDCERT',0         ; DATA XREF: sub_4049E3:loc_404A21o
					; sub_404E00+38o
; char aGet_issuing_ce[]
aGet_issuing_ce	db 'get_issuing_cert_local called w/o context',0Ah,0
					; DATA XREF: sub_404A3D+2Bo
aSendissuercert	db 'SENDISSUERCERT',0   ; DATA XREF: sub_404A3D:loc_404A7Bo
		align 4
; char aGet_cert_loc_0[]
aGet_cert_loc_0	db 'get_cert_local_ski called w/o context',0Ah,0 ; DATA XREF: sub_404A97+2Do
		align 10h
; char aGet_cert_loc_1[]
aGet_cert_loc_1	db 'get_cert_local_ski called with insufficient arguments',0Ah,0
					; DATA XREF: sub_404A97:loc_404AE6o
; char aSerial_hexFail[]
aSerial_hexFail	db 'serial_hex() failed',0Ah,0 ; DATA XREF: sub_404A97+79o
; char aCanTAllocateEn[]
aCanTAllocateEn	db 'can',27h,'t allocate enough memory: %s',0Ah,0
					; DATA XREF: sub_404A97+F8o
aSendcert_ski	db 'SENDCERT_SKI',0     ; DATA XREF: sub_404A97+1C1o
; char aIstrustedS[]
aIstrustedS	db 'ISTRUSTED %s',0     ; DATA XREF: sub_404CE9:loc_404D25o
aForceCrlRefres	db 'force-crl-refresh',0 ; DATA XREF: sub_404EEF+1Bo
aAuditEvents	db 'audit-events',0     ; DATA XREF: sub_404EEF+6Do
		align 10h
aLdapserverData	db 'LDAPSERVER <data>',0Ah ; DATA XREF: .data:0042B3A8o
		db 0Ah
		db 'Add a new LDAP server to the list of configured LDAP servers.',0Ah
		db 'DATA is in the same format as expected in the configure file.',0
aLdapserverMiss	db 'ldapserver missing',0 ; DATA XREF: sub_404FC3+44o
word_42D2C2	dw 0			; DATA XREF: sub_404FC3+65o
					; sub_4059C0:loc_405D95o
		align 20h
aIsvalidOnlyOcs	db 'ISVALID [--only-ocsp] [--force-default-responder] <certificate_id'
					; DATA XREF: .data:0042B3B4o
		db '>|<certificate_fpr>',0Ah
		db 0Ah
		db 'This command checks whether the certificate identified by the',0Ah
		db 'certificate_id is valid.  This is done by consulting CRLs or',0Ah
		db 'whatever has been configured.  Note, that the returned error code'
		db 's',0Ah
		db 'are from gpg-error.h.  The command may callback using the inquire'
		db 0Ah
		db 'function.  See the manual for details.',0Ah
		db 0Ah
		db 'The CERTIFICATE_ID is a hex encoded string consisting of two part'
		db 's,',0Ah
		db 'delimited by a single dot.  The first part is the SHA-1 hash of t'
		db 'he',0Ah
		db 'issuer name and the second part the serial number.',0Ah
		db 0Ah
		db 'Alternatively the certificate',27h,'s fingerprint may be given in wh'
		db 'ich',0Ah
		db 'case an OCSP request is done before consulting the CRL.',0Ah
		db 0Ah
		db 'If the option --only-ocsp is given, no fallback to a CRL check wi'
		db 'll',0Ah
		db 'be used.',0Ah
		db 0Ah
		db 'If the option --force-default-responder is given, only the defaul'
		db 't',0Ah
		db 'OCSP responder will be used and any other methods of obtaining an'
		db 0Ah
		db 'OCSP responder URL won',27h,'t be used.',0
; char aOnlyOcsp[]
aOnlyOcsp	db '--only-ocsp',0      ; DATA XREF: sub_405080+23o
; char aForceDefaultRe[]
aForceDefaultRe	db '--force-default-responder',0 ; DATA XREF: sub_405080+39o
					; sub_405654+14o
aSerialnoMissin	db 'serialno missing in cert ID',0 ; DATA XREF: sub_405080+F3o
; char aCrl_cache_isva[]
aCrl_cache_isva	db 'crl_cache_isvalid returned invalid code',0Ah,0
					; DATA XREF: sub_405080:loc_405298o
aIsvalid	db 'ISVALID',0          ; DATA XREF: sub_405080+23Ao
					; .data:0042B3ACo
; char aCommandSFailed[]
aCommandSFailed	db 'command %s failed: %s',0Ah,0 ; DATA XREF: sub_405080+242o
					; sub_405484+1B4o ...
		align 10h
aCheckcrlFinger	db 'CHECKCRL [<fingerprint>]',0Ah ; DATA XREF: .data:0042B3C0o
		db 0Ah
		db 'Check whether the certificate with FINGERPRINT (SHA-1 hash of the'
		db 0Ah
		db 'entire X.509 certificate blob) is valid or not by consulting the',0Ah
		db 'CRL responsible for this certificate.  If the fingerprint has not'
		db 0Ah
		db 'been given or the certificate is not known, the function ',0Ah
		db 'inquires the certificate using an',0Ah
		db 0Ah
		db '  INQUIRE TARGETCERT',0Ah
		db 0Ah
		db 'and the caller is expected to return the certificate for the',0Ah
		db 'request (which should match FINGERPRINT) as a binary blob.',0Ah
		db 'Processing then takes place without further interaction; in',0Ah
		db 'particular dirmngr tries to locate other required certificate by',0Ah
		db 'its own mechanism which includes a local certificate store as wel'
		db 'l',0Ah
		db 'as a list of trusted root certificates.',0Ah
		db 0Ah
		db 'The return value is the usual gpg-error code or 0 for ducesss;',0Ah
		db 'i.e. the certificate validity has been confirmed by a valid CRL.',0
aTargetcert	db 'TARGETCERT',0       ; DATA XREF: sub_405484+74o
					; sub_405654+98o ...
; char aAssuan_inqui_0[]
aAssuan_inqui_0	db 'assuan_inquire failed: %s',0Ah,0 ; DATA XREF: sub_405484+9Co
					; sub_405654+C0o ...
		align 4
; char a____Dirmngr1_1[]
a____Dirmngr1_1	db '../../dirmngr-1.1.1/src/server.c',0 ; DATA XREF: sub_405484+119o
					; sub_405654+139o
; char aCert[]
aCert		db 'cert',0             ; DATA XREF: sub_405484+121o
					; sub_405654+141o
aCheckcrl	db 'CHECKCRL',0         ; DATA XREF: sub_405484+1ACo
					; .data:0042B3B8o
		align 20h
aCheckocspForce	db 'CHECKOCSP [--force-default-responder] [<fingerprint>]',0Ah
					; DATA XREF: .data:0042B3CCo
		db 0Ah
		db 'Check whether the certificate with FINGERPRINT (SHA-1 hash of the'
		db 0Ah
		db 'entire X.509 certificate blob) is valid or not by asking an OCSP',0Ah
		db 'responder responsible for this certificate.  The optional',0Ah
		db 'fingerprint may be used for a quick check in case an OCSP check h'
		db 'as',0Ah
		db 'been done for this certificate recently (we always cache OCSP',0Ah
		db 'responses for a couple of minutes). If the fingerprint has not be'
		db 'en',0Ah
		db 'given or there is no cached result, the function inquires the',0Ah
		db 'certificate using an',0Ah
		db 0Ah
		db '   INQUIRE TARGETCERT',0Ah
		db 0Ah
		db 'and the caller is expected to return the certificate for the',0Ah
		db 'request (which should match FINGERPRINT) as a binary blob.',0Ah
		db 'Processing then takes place without further interaction; in',0Ah
		db 'particular dirmngr tries to locate other required certificates by'
		db 0Ah
		db 'its own mechanism which includes a local certificate store as wel'
		db 'l',0Ah
		db 'as a list of trusted root certifciates.',0Ah
		db 0Ah
		db 'If the option --force-default-responder is given, only the defaul'
		db 't',0Ah
		db 'OCSP responder will be used and any other methods of obtaining an'
		db 0Ah
		db 'OCSP responder URL won',27h,'t be used.',0Ah
		db 0Ah
		db 'The return value is the usual gpg-error code or 0 for ducesss;',0Ah
		db 'i.e. the certificate validity has been confirmed by a valid CRL.',0
aCheckocsp	db 'CHECKOCSP',0        ; DATA XREF: sub_405654+1A3o
					; .data:0042B3C4o
; char aFetch_cert_by_[]
aFetch_cert_by_	db 'fetch_cert_by_url failed: %s',0Ah,0 ; DATA XREF: sub_40581B+5Ao
aEnd		db 'END',0              ; DATA XREF: sub_40581B+AEo
					; sub_405906+7Eo ...
; char aErrorSendingDa[]
aErrorSendingDa	db 'error sending data: %s',0Ah,0 ; DATA XREF: sub_40581B+D9o
					; sub_405906+A9o ...
aDefault	db '[default]',0        ; DATA XREF: sub_4059C0:loc_405BE7o
		align 10h
; char aCmd_lookupTryi[]
aCmd_lookupTryi	db 'cmd_lookup: trying %s:%d base=%s',0Ah,0 ; DATA XREF: sub_4059C0+244o
; char aCmd_lookupNoDa[]
aCmd_lookupNoDa	db 'cmd_lookup: no data',0Ah,0 ; DATA XREF: sub_4059C0+28Fo
; char aStart_cert_fet[]
aStart_cert_fet	db 'start_cert_fetch failed: %s',0Ah,0 ; DATA XREF: sub_4059C0+2C7o
; char aFetch_next_cer[]
aFetch_next_cer	db 'fetch_next_cert failed: %s',0Ah,0 ; DATA XREF: sub_4059C0+3A0o
aTruncated	db ' (truncated)',0     ; DATA XREF: sub_4059C0+3CEo
		align 10h
; char aCmd_lookupRetu[]
aCmd_lookupRetu	db 'cmd_lookup: returning one cert%s',0Ah,0 ; DATA XREF: sub_4059C0+3DEo
; char aMax_repliesDEx[]
aMax_repliesDEx	db 'max_replies %d exceeded',0Ah,0 ; DATA XREF: sub_4059C0+495o
; char aD[]
aD		db '%d',0               ; DATA XREF: sub_4059C0:loc_405EC5o
aTruncated_0	db 'TRUNCATED',0        ; DATA XREF: sub_4059C0+527o
		align 20h
aLookupUrlSingl	db 'LOOKUP [--url] [--single] [--cache-only] <pattern>',0Ah
					; DATA XREF: .data:0042B3D8o
		db 0Ah
		db 'Lookup certificates matching PATTERN. With --url the pattern is',0Ah
		db 'expected to be one URL.',0Ah
		db 0Ah
		db 'If --url is not given:  To allow for multiple patterns (which are'
		db ' ORed)',0Ah
		db 'quoting is required: Spaces are translated to "+" or "%20";',0Ah
		db 'obviously this requires that the usual escape quoting rules are a'
		db 'pplied.',0Ah
		db 0Ah
		db 'If --url is given no special escaping is required because URLs ar'
		db 'e',0Ah
		db 'already escaped this way.',0Ah
		db 0Ah
		db 'If --single is given the first and only the first match will be',0Ah
		db 'returned.  If --cache-only is _not_ given, no local query will be'
		db 0Ah
		db 'done.',0Ah
		db 0Ah
		db 'If --cache-only is given no external lookup is done so that only',0Ah
		db 'certificates from the cache may get returned.',0
; char aUrl[]
aUrl		db '--url',0            ; DATA XREF: sub_405F38+6o
					; sub_406036+1Co
; char aSingle[]
aSingle		db '--single',0         ; DATA XREF: sub_405F38+1Co
; char aCacheOnly[]
aCacheOnly	db '--cache-only',0     ; DATA XREF: sub_405F38+32o
aLookup		db 'LOOKUP',0           ; DATA XREF: sub_405F38+E5o
					; .data:0042B3D0o
		align 10h
aLoadcrlUrlFile	db 'LOADCRL [--url] <filename|url>',0Ah ; DATA XREF: .data:0042B3E4o
		db 0Ah
		db 'Load the CRL in the file with name FILENAME into our cache.  Note'
		db 0Ah
		db 'that FILENAME should be given with an absolute path because',0Ah
		db 'Dirmngrs cwd is not known.  With --url the CRL is directly loaded'
		db 0Ah
		db 'from the given URL.',0Ah
		db 0Ah
		db 'This command is usually used by gpgsm using the invocation "gpgsm'
		db 0Ah
		db '--call-dirmngr loadcrl <filename>".  A direct invocation of Dirmn'
		db 'gr',0Ah
		db 'is not useful because gpgsm might need to callback gpgsm to ask f'
		db 'or',0Ah
		db 'the CA',27h,'s certificate.',0
		align 4
; char aFetchingCrlF_0[]
aFetchingCrlF_0	db 'fetching CRL from `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_406036+82o
		align 4
; char aProcessingCr_0[]
aProcessingCr_0	db 'processing CRL from `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_406036+CBo
aLoadcrl	db 'LOADCRL',0          ; DATA XREF: sub_406036+168o
					; .data:0042B3DCo
		align 20h
aListcrlsListTh	db 'LISTCRLS',0Ah       ; DATA XREF: .data:0042B3F0o
		db 0Ah
		db 'List the content of all CRLs in a readable format.  This command '
		db 'is',0Ah
		db 'usually used by gpgsm using the invocation "gpgsm --call-dirmngr',0Ah
		db 'listcrls".  It may also be used directly using "dirmngr',0Ah
		db '--list-crls".',0
aNoDataStream	db 'no data stream',0   ; DATA XREF: sub_4061BB+26o
aListcrls	db 'LISTCRLS',0         ; DATA XREF: sub_4061BB+62o
					; .data:0042B3E8o
		align 20h
aCachecertPutAC	db 'CACHECERT',0Ah      ; DATA XREF: .data:0042B3FCo
		db 0Ah
		db 'Put a certificate into the internal cache.  This command might be'
		db 0Ah
		db 'useful if a client knows in advance certificates required for a',0Ah
		db 'test and wnats to make sure they get added to the internal cache.'
		db 0Ah
		db 'It is also helpful for debugging.  To get the actual certificate,'
		db 0Ah
		db 'this command immediately inquires it using',0Ah
		db 0Ah
		db '  INQUIRE TARGETCERT',0Ah
		db 0Ah
		db 'and the caller is expected to return the certificate for the',0Ah
		db 'request as a binary blob.',0
aCachecert	db 'CACHECERT',0        ; DATA XREF: sub_406236+F5o
					; .data:0042B3F4o
		align 10h
aValidateValida	db 'VALIDATE',0Ah       ; DATA XREF: .data:0042B408o
		db 0Ah
		db 'Validate a certificate using the certificate validation function',0Ah
		db 'used internally by dirmngr.  This command is only useful for',0Ah
		db 'debugging.  To get the actual certificate, this command immediate'
		db 'ly',0Ah
		db 'inquires it using',0Ah
		db 0Ah
		db '  INQUIRE TARGETCERT',0Ah
		db 0Ah
		db 'and the caller is expected to return the certificate for the',0Ah
		db 'request as a binary blob.',0
aValidate	db 'VALIDATE',0         ; DATA XREF: sub_40634F+14Eo
					; .data:0042B400o
		align 4
; char aCanTAllocateCo[]
aCanTAllocateCo	db 'can',27h,'t allocate control structure: %s',0Ah,0
					; DATA XREF: sub_406596+66o
		align 10h
; char aFailedToAlloca[]
aFailedToAlloca	db 'failed to allocate assuan context: %s',0Ah,0 ; DATA XREF: sub_406596+B0o
		align 4
; char aFailedToInitia[]
aFailedToInitia	db 'failed to initialize the server: %s',0Ah,0 ; DATA XREF: sub_406596+140o
		align 10h
; char aFailedToTheReg[]
aFailedToTheReg	db 'failed to the register commands with Assuan: %s',0Ah,0
					; DATA XREF: sub_406596+17Bo
aNone_0		db '[none]',0           ; DATA XREF: sub_406596:loc_406746o
; char aHomeSConfigSS[]
aHomeSConfigSS	db 'Home: %s',0Ah       ; DATA XREF: sub_406596+219o
		db 'Config: %s',0Ah
		db '%s',0
; char aAssuanAcceptPr[]
aAssuanAcceptPr	db 'Assuan accept problem: %s',0Ah,0 ; DATA XREF: sub_406596+2FAo
; char aAssuanProcessi[]
aAssuanProcessi	db 'Assuan processing failed: %s',0Ah,0 ; DATA XREF: sub_406596+32Bo
; char aOopsConnection[]
aOopsConnection	db 'oops: connection control structure still referenced (%d)',0Ah,0
					; DATA XREF: sub_406596+38Do
a?00		db '? 0 0',0            ; DATA XREF: sub_406A20+4Ao
aTick		db 'tick',0             ; DATA XREF: sub_406A20+52o
aProgress	db 'PROGRESS',0         ; DATA XREF: sub_406A20+5Ao
aDirmngr1_1_1At	db 'Dirmngr 1.1.1 at your service',0 ; DATA XREF: sub_406596+223o
aLdapserver	db 'LDAPSERVER',0       ; DATA XREF: .data:off_42B3A0o
aInput		db 'INPUT',0            ; DATA XREF: .data:0042B40Co
aOutput		db 'OUTPUT',0           ; DATA XREF: .data:0042B418o
		align 10h
a____Dirmngr1_0	db '../../dirmngr-1.1.1/src/misc.h',0 ; DATA XREF: sub_406B43+52o
; char a2_5_29_20[]
a2_5_29_20	db '2.5.29.20',0        ; DATA XREF: sub_40A08A+48Fo
a2_5_29_28	db '2.5.29.28',0
; char a2_5_29_35[]
a2_5_29_35	db '2.5.29.35',0        ; DATA XREF: sub_40A08A+475o
		align 10h
; char aCrlCacheHasNot[]
aCrlCacheHasNot	db 'CRL cache has not yet been initialized',0Ah,0 ; DATA XREF: sub_406BB9+Fo
; char aCreatingDirect[]
aCreatingDirect	db 'creating directory `%s',27h,0Ah,0 ; DATA XREF: sub_406BDB+40o
		align 4
; char aErrorCreatingD[]
aErrorCreatingD	db 'error creating directory `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_406BDB+83o
aCrls_d		db 'crls.d',0           ; DATA XREF: sub_406CA5+11o
					; sub_40719C+68o ...
aDirmngrCache_d	db 'dirmngr-cache.d',0  ; DATA XREF: sub_406CA5:loc_406CBDo
					; sub_40719C:loc_40720Bo ...
asc_42EC1E	db '~/',0               ; DATA XREF: sub_406CA5+4Co
; char asc_42EC21[]
asc_42EC21	db '/',0                ; DATA XREF: sub_406CA5+74o
					; sub_40989B+42Co
; char aIgnoringDataba[]
aIgnoringDataba	db 'ignoring database dir `%s',27h,0Ah,0 ; DATA XREF: sub_406CA5+9Eo
		align 10h
; char aErrorReadingDi[]
aErrorReadingDi	db 'error reading directory `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_406CA5+F3o
a__0		db '.',0                ; DATA XREF: sub_406CA5+11Co
a__		db '..',0               ; DATA XREF: sub_406CA5+14Bo
; char aRemovingCacheF[]
aRemovingCacheF	db 'removing cache file `%s',27h,0Ah,0 ; DATA XREF: sub_406CA5+1E8o
; char aFailedToRemove[]
aFailedToRemove	db 'failed to remove `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_406CA5+21Fo
; char aNotRemovingFil[]
aNotRemovingFil	db 'not removing file `%s',27h,0Ah,0 ; DATA XREF: sub_406CA5+23Bo
; char aErrorClosingCa[]
aErrorClosingCa	db 'error closing cache file: %s',0Ah,0 ; DATA XREF: sub_4070B4+65o
					; sub_40895E+121o
; char aR_0[]
aR_0		db 'r',0                ; DATA XREF: sub_40719C+6o
					; sub_40719C+192o ...
; char aFailedToOpenCa[]
aFailedToOpenCa	db 'failed to open cache dir file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40719C+43o
					; sub_407EC1+E1o
; char aW[]
aW		db 'w',0                ; DATA XREF: sub_40719C:loc_407226o
					; sub_407EC1+215o
		align 10h
; char aErrorCreatingN[]
aErrorCreatingN	db 'error creating new cache dir file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40719C+C3o
; char aVD[]
aVD		db 'v:%d:',0Ah,0        ; DATA XREF: sub_40719C:loc_407275o
		align 4
; char aErrorWritingNe[]
aErrorWritingNe	db 'error writing new cache dir file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40719C+120o
		align 10h
; char aErrorClosingNe[]
aErrorClosingNe	db 'error closing new cache dir file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40719C+16Co
		align 4
; char aNewCacheDirFil[]
aNewCacheDirFil	db 'new cache dir file `%s',27h,' created',0Ah,0
					; DATA XREF: sub_40719C+186o
		align 10h
; char aFailedToReOpen[]
aFailedToReOpen	db 'failed to re-open cache dir file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40719C+1CBo
		align 4
; char aFirstRecordOfS[]
aFirstRecordOfS	db 'first record of `%s',27h,' is not the version',0Ah,0
					; DATA XREF: sub_40737F+53o
		align 4
; char aOldVersionOfCa[]
aOldVersionOfCa	db 'old version of cache directory - cleaning up',0Ah,0
					; DATA XREF: sub_40737F+EBo
		align 4
; char aOldVersionOf_0[]
aOldVersionOf_0	db 'old version of cache directory - giving up',0Ah,0
					; DATA XREF: sub_40737F:loc_4074E7o
aDir_txt	db 'DIR.txt',0          ; DATA XREF: sub_40751E+6Do
					; sub_407EC1+53o ...
; char aExtraFieldDete[]
aExtraFieldDete	db 'extra field detected in crl record of `%s',27h,' line %u',0Ah,0
					; DATA XREF: sub_40751E+31Ao
; char aInvalidLineDet[]
aInvalidLineDet	db 'invalid line detected in `%s',27h,' line %u',0Ah,0
					; DATA XREF: sub_40751E+364o
		align 4
; char aDuplicateEntry[]
aDuplicateEntry	db 'duplicate entry detected in `%s',27h,' line %u',0Ah,0
					; DATA XREF: sub_40751E+3B0o
		align 4
; char aUnsupportedRec[]
aUnsupportedRec	db 'unsupported record type in `%s',27h,' line %u skipped',0Ah,0
					; DATA XREF: sub_40751E+3FFo
; char aErrorReading_0[]
aErrorReading_0	db 'error reading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_40751E+45Eo
					; sub_40751E+49Ao ...
		align 10h
; char a____Dirmngr1_2[]
a____Dirmngr1_2	db '../../dirmngr-1.1.1/src/crlcache.c',0 ; DATA XREF: sub_40751E+4D9o
					; sub_408569+33o ...
; char aEntryLineno[]
aEntryLineno	db 'entry->lineno',0    ; DATA XREF: sub_40751E+4E1o
		align 4
; char aInvalidIssuerH[]
aInvalidIssuerH	db 'invalid issuer hash in `%s',27h,' line %u',0Ah,0
					; DATA XREF: sub_40751E+529o
; char aNoIssuerDnInSL[]
aNoIssuerDnInSL	db 'no issuer DN in `%s',27h,' line %u',0Ah,0 ; DATA XREF: sub_40751E+559o
		align 4
; char aInvalidTimesta[]
aInvalidTimesta	db 'invalid timestamp in `%s',27h,' line %u',0Ah,0
					; DATA XREF: sub_40751E+5A0o
		align 4
; char aWarningInvalid[]
aWarningInvalid	db 'WARNING: invalid cache file hash in `%s',27h,' line %u',0Ah,0
					; DATA XREF: sub_40751E+5E4o
		align 10h
; char aDetectedErrors[]
aDetectedErrors	db 'detected errors in cache dir file',0Ah,0 ; DATA XREF: sub_40751E+608o
		align 4
; char aPleaseCheckThe[]
aPleaseCheckThe	db 'please check the reason and manually delete that file',0Ah,0
					; DATA XREF: sub_40751E+614o
		align 4
off_42F06C	dd offset loc_407820	; DATA XREF: sub_40751E+1F8o
		dd offset loc_407846	; jump table for switch	statement
		dd offset loc_40771F
		dd offset loc_40772D
		dd offset loc_407743
		dd offset loc_407759
		dd offset loc_40777B
		dd offset loc_40779D
		dd offset loc_4077AB
		dd offset loc_4077C7
		dd offset loc_4077E4
		dd offset loc_407801
off_42F09C	dd offset loc_413324+1	; DATA XREF: sub_407BA1+15o
off_42F0A0	dd offset loc_413023+2	; DATA XREF: sub_407BA1+45o
dword_42F0A4	dd 443025h		; DATA XREF: sub_407BA1+75o
; char aID[4]
aID		db 'i%d',0              ; DATA XREF: sub_407C68+16o
aUnknown	db 'unknown',0          ; DATA XREF: sub_407EC1+132o
					; sub_40A08A:loc_40A15Eo
aDirTmpSUP_txt_	db 'DIR-tmp-%s-%u-%p.txt.tmp',0 ; DATA XREF: sub_407EC1+150o
		align 10h
; char aFailedToCreate[]
aFailedToCreate	db 'failed to create temporary cache dir file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_407EC1+19Ao
					; sub_407EC1+266o
; char aNextLineAddedB[]
aNextLineAddedB	db '# Next line added by another process; our pid is %lu',0Ah,0
					; DATA XREF: sub_407EC1+359o
aInvalidLineD_0	db '# Invalid line detected: ',0 ; DATA XREF: sub_407EC1:loc_408259o
; char aErrorWritingSS[]
aErrorWritingSS	db 'error writing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_407EC1+562o
; char aErrorClosingSS[]
aErrorClosingSS	db 'error closing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_407EC1+5C9o
; char aErrorRenamingS[]
aErrorRenamingS	db 'error renaming `%s',27h,' to `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_407EC1+636o
; char aStrlenIssuer_h[]
aStrlenIssuer_h	db 'strlen (issuer_hash) == 40',0 ; DATA XREF: sub_408569+3Bo
aCrl		db 'crl-',0             ; DATA XREF: sub_408569:loc_4085B0o
a_db		db '.db',0              ; DATA XREF: sub_408569+96o
; char aRb[]
aRb		db 'rb',0               ; DATA XREF: sub_40864A+1Co
; char aCanTHashSS[]
aCanTHashSS	db 'can',27h,'t hash `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_40864A+5Co
		align 4
; char aErrorSettingUp[]
aErrorSettingUp	db 'error setting up MD5 hash context: %s',0Ah,0 ; DATA XREF: sub_40864A+B0o
; char a_100s_100sD[]
a_100s_100sD	db '%.100s/%.100s:%d',0 ; DATA XREF: sub_40864A:loc_40873Bo
; char aErrorHashingSS[]
aErrorHashingSS	db 'error hashing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_40864A+1A7o
; char aInvalidFormatt[]
aInvalidFormatt	db 'invalid formatted checksum for `%s',27h,0Ah,0
					; DATA XREF: sub_4088CA+32o
		align 4
; char aTooManyOpenCac[]
aTooManyOpenCac	db 'too many open cache files; can',27h,'t open anymore',0Ah,0
					; DATA XREF: sub_40895E+B6o
; char aOpeningCacheFi[]
aOpeningCacheFi	db 'opening cache file `%s',27h,0Ah,0 ; DATA XREF: sub_40895E+15Co
; char aErrorOpeningCa[]
aErrorOpeningCa	db 'error opening cache file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40895E+208o
		align 4
; char aErrorInitializ[]
aErrorInitializ	db 'error initializing cache file `%s',27h,' for reading: %s',0Ah,0
					; DATA XREF: sub_40895E+276o
; char aCallingUnlock_[]
aCallingUnlock_	db 'calling unlock_db_file on a closed file',0Ah,0
					; DATA XREF: sub_408C3C+10o
		align 4
; char aCallingUnloc_0[]
aCallingUnloc_0	db 'calling unlock_db_file on an unlocked file',0Ah,0
					; DATA XREF: sub_408C3C+28o
; char aEprev[]
aEprev		db 'eprev',0            ; DATA XREF: sub_408C3C+A8o
		align 4
; char aCrlCacheHasAlr[]
aCrlCacheHasAlr	db 'crl cache has already been initialized - not doing twice',0Ah,0
					; DATA XREF: sub_408D4C+16o
		align 4
; char aFailedToCrea_0[]
aFailedToCrea_0	db 'failed to create a new cache object: %s',0Ah,0
					; DATA XREF: sub_408D4C+47o
		align 4
; char aNoCrlAvailable[]
aNoCrlAvailable	db 'no CRL available for issuer id %s',0Ah,0 ; DATA XREF: sub_408DFB+32o
		align 4
; char aCachedCrlForIs[]
aCachedCrlForIs	db 'cached CRL for issuer id %s too old; update required',0Ah,0
					; DATA XREF: sub_408DFB+73o
		align 10h
; char aForceCrlRefr_0[]
aForceCrlRefr_0	db 'force-crl-refresh active and %d minutes passed for issuer id %s; '
					; DATA XREF: sub_408DFB+EBo
		db 'update required',0Ah,0
		align 4
; char aForceCrlRefr_1[]
aForceCrlRefr_1	db 'force-crl-refresh active for issuer id %s; update required',0Ah,0
					; DATA XREF: sub_408DFB+108o
; char aAvailableCrlFo[]
aAvailableCrlFo	db 'available CRL for issuer ID %s can',27h,'t be used',0Ah,0
					; DATA XREF: sub_408DFB+12Fo
		align 10h
; char aCachedCrlFor_0[]
aCachedCrlFor_0	db 'cached CRL for issuer id %s tampered; we need to update',0Ah,0
					; DATA XREF: sub_408DFB+17Bo
		align 4
; char aWarningInval_0[]
aWarningInval_0	db 'WARNING: invalid cache record length for S/N ',0
					; DATA XREF: sub_408DFB+1D8o
word_42F54A	dw 0			; DATA XREF: sub_408DFB+1F2o
					; sub_409EBA+67o
; char aProblemReading[]
aProblemReading	db 'problem reading cache record for S/N %s: %s',0Ah,0
					; DATA XREF: sub_408DFB+268o
		align 4
; char aSNSIsNotValidR[]
aSNSIsNotValidR	db 'S/N %s is not valid; reason=%02X  date=%.15s',0Ah,0
					; DATA XREF: sub_408DFB+292o
		align 4
; char aSNSIsValidItIs[]
aSNSIsValidItIs	db 'S/N %s is valid, it is not listed in the CRL',0Ah,0
					; DATA XREF: sub_408DFB+2DDo
		align 4
; char aErrorGettingDa[]
aErrorGettingDa	db 'error getting data from cache file: %s',0Ah,0
					; DATA XREF: sub_408DFB+312o
; char aInconsistentDa[]
aInconsistentDa	db 'inconsistent data on user trust check',0Ah,0
					; DATA XREF: sub_408DFB+345o
		align 4
; char aNoSystemTrustA[]
aNoSystemTrustA	db 'no system trust and client does not trust either',0Ah,0
					; DATA XREF: sub_408DFB+37Co
		align 10h
; char aOopsIssuerMiss[]
aOopsIssuerMiss	db 'oops: issuer missing in certificate',0Ah,0 ; DATA XREF: sub_409253+26o
					; sub_40B296+386o
; char a02x[]
a02x		db '%02X',0             ; DATA XREF: sub_409253+A6o
					; sub_40AA09+485o
		align 4
; char aOopsSNMissingI[]
aOopsSNMissingI	db 'oops: S/N missing in certificate',0Ah,0 ; DATA XREF: sub_409253+E0o
; char aOopsInvalidSN[]
aOopsInvalidSN	db 'oops: invalid S/N',0Ah,0 ; DATA XREF: sub_409253+10Do
					; sub_409253+166o
		align 4
; char aCache_isvalidR[]
aCache_isvalidR	db 'cache_isvalid returned invalid status code %d',0Ah,0
					; DATA XREF: sub_409253+216o
a?		db '?',0                ; DATA XREF: sub_40948C:loc_4094C4o
; char aUnknownHashAlg[]
aUnknownHashAlg	db 'unknown hash algorithm `%s',27h,0Ah,0 ; DATA XREF: sub_40948C+41o
		align 4
; char aGcry_md_openFo[]
aGcry_md_openFo	db 'gcry_md_open for algorithm %d failed: %s',0Ah,0
					; DATA XREF: sub_40948C+9Bo
aHash_cert	db 'hash.cert',0        ; DATA XREF: sub_40948C+BFo
; char aGotAnInvalidSE[]
aGotAnInvalidSE	db 'got an invalid S-expression from libksba',0Ah,0
					; DATA XREF: sub_40957E+8Ao
					; sub_40957E+14Do
		align 4
; char aConvertingSExp[]
aConvertingSExp	db 'converting S-expression failed: %s',0Ah,0 ; DATA XREF: sub_40957E+E3o
					; sub_40957E+1A6o
aCrl_issuer_cer	db 'crl_issuer_cert',0  ; DATA XREF: sub_40957E+107o
aDataFlagsPkcs1	db '(data(flags pkcs1)(hash %s %b))',0 ; DATA XREF: sub_40957E+238o
; char aCreatingSExpre[]
aCreatingSExpre	db 'creating S-expression failed: %s',0Ah,0 ; DATA XREF: sub_40957E+26Bo
; char aGcry_pk_verify[]
aGcry_pk_verify	db 'gcry_pk_verify: %s',0Ah,0 ; DATA XREF: sub_40957E+2B0o
; char aKsba_crl_parse[]
aKsba_crl_parse	db 'ksba_crl_parse failed: %s',0Ah,0 ; DATA XREF: sub_40989B+6Bo
		align 4
; char aErrorGettingUp[]
aErrorGettingUp	db 'error getting update times of CRL: %s',0Ah,0
					; DATA XREF: sub_40989B+100o
		align 4
; char aUpdateTimesOfT[]
aUpdateTimesOfT	db 'update times of this CRL: this=%s next=%s',0Ah,0
					; DATA XREF: sub_40989B+141o
		align 10h
; char aNextupdateNotG[]
aNextupdateNotG	db 'nextUpdate not given; assuming a validity period of one day',0Ah,0
					; DATA XREF: sub_40989B+15Bo
; char aErrorGettingCr[]
aErrorGettingCr	db 'error getting CRL item: %s',0Ah,0 ; DATA XREF: sub_40989B+1C9o
		align 4
; char aErrorInserting[]
aErrorInserting	db 'error inserting item into temporary cache file: %s',0Ah,0
					; DATA XREF: sub_40989B+2B3o
; char aNoCrlIssuerFou[]
aNoCrlIssuerFou	db 'no CRL issuer found in CRL: %s',0Ah,0 ; DATA XREF: sub_40989B+2FEo
; char aLocatingCrlIss[]
aLocatingCrlIss	db 'locating CRL issuer certificate by authorityKeyIdentifier',0Ah,0
					; DATA XREF: sub_40989B+357o
; char aCrlIssuerCerti[]
aCrlIssuerCerti	db 'CRL issuer certificate ',0 ; DATA XREF: sub_40989B+3D8o
; char asc_42F973[]
asc_42F973	db '{',0                ; DATA XREF: sub_40989B+3EBo
; char asc_42F975[]
asc_42F975	db '} ',0               ; DATA XREF: sub_40989B+402o
; char asc_42F978[]
asc_42F978	db '(#',0               ; DATA XREF: sub_40989B+415o
; char asc_42F97B[]
asc_42F97B	db ') ',0               ; DATA XREF: sub_40989B+443o
; char aNotFound[]
aNotFound	db 'not found',0Ah,0    ; DATA XREF: sub_40989B:loc_409CEAo
		align 4
; char aCrlSignatureVe[]
aCrlSignatureVe	db 'CRL signature verification failed: %s',0Ah,0
					; DATA XREF: sub_40989B+4F4o
		align 4
; char aErrorCheckingV[]
aErrorCheckingV	db 'error checking validity of CRL issuer certificate: %s',0Ah,0
					; DATA XREF: sub_40989B+54Do
		align 4
; char aCrl_parse_in_0[]
aCrl_parse_in_0	db 'crl_parse_insert: unknown stop reason',0Ah,0
					; DATA XREF: sub_40989B:loc_409DF6o
; char aErr[]
aErr		db '!err',0             ; DATA XREF: sub_40989B+5A1o
byte_42FA18	db 1, 0			; DATA XREF: sub_409EBA+143o
; char aKsba_crl_newFa[]
aKsba_crl_newFa	db 'ksba_crl_new failed: %s',0Ah,0 ; DATA XREF: sub_40A08A+88o
		align 4
; char aKsba_crl_set_r[]
aKsba_crl_set_r	db 'ksba_crl_set_reader failed: %s',0Ah,0 ; DATA XREF: sub_40A08A+C3o
aCrlTmpSUP_db_t	db 'crl-tmp-%s-%u-%p.db.tmp',0 ; DATA XREF: sub_40A08A+F5o
; char aRemovedStaleTe[]
aRemovedStaleTe	db 'removed stale temporary cache file `%s',27h,0Ah,0
					; DATA XREF: sub_40A08A+1ABo
		align 4
; char aProblemRemovin[]
aProblemRemovin	db 'problem removing stale temporary cache file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40A08A+1E5o
		align 10h
; char aErrorCreatingT[]
aErrorCreatingT	db 'error creating temporary cache file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40A08A+24Ao
; char aCrl_parse_in_1[]
aCrl_parse_in_1	db 'crl_parse_insert failed: %s',0Ah,0 ; DATA XREF: sub_40A08A+2D3o
		align 4
; char aErrorFinishing[]
aErrorFinishing	db 'error finishing temporary cache file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40A08A+334o
		align 4
; char aErrorClosingTe[]
aErrorClosingTe	db 'error closing temporary cache file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40A08A+384o
		align 4
; char aWarningNewCrlS[]
aWarningNewCrlS	db 'WARNING: new CRL still too old; it expired on %s - loading anyway'
					; DATA XREF: sub_40A08A+41Fo
		db 0Ah,0
		align 10h
; char aNewCrlStillToo[]
aNewCrlStillToo	db 'new CRL still too old; it expired on %s',0Ah,0
					; DATA XREF: sub_40A08A+437o
		align 4
; char aUnknownCritica[]
aUnknownCritica	db 'unknown critical CRL extension %s',0Ah,0 ; DATA XREF: sub_40A08A+4ADo
		align 10h
; char aErrorReadingCr[]
aErrorReadingCr	db 'error reading CRL extensions: %s',0Ah,0 ; DATA XREF: sub_40A08A+55Ao
; char aCreatingCacheF[]
aCreatingCacheF	db 'creating cache file `%s',27h,0Ah,0 ; DATA XREF: sub_40A08A+835o
; char aProblemRenamin[]
aProblemRenamin	db 'problem renaming `%s',27h,' to `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40A08A+887o
		align 10h
; char aUpdatingTheDir[]
aUpdatingTheDir	db 'updating the DIR file failed - cache entry will get lost with the'
					; DATA XREF: sub_40A08A+8D4o
		db ' next program start',0Ah,0
		align 4
asc_42FCC8	db '--------------------------------------------------------',0Ah,0
					; DATA XREF: sub_40AA09+10o
		align 4
; char aBeginCrlDumpRe[]
aBeginCrlDumpRe	db 'Begin CRL dump (retrieved via %s)',0Ah,0 ; DATA XREF: sub_40AA09+3Ao
; char aIssuerS[]
aIssuerS	db ' Issuer:',9,'%s',0Ah,0 ; DATA XREF: sub_40AA09+58o
; char aIssuerHashS[]
aIssuerHashS	db ' Issuer Hash:',9,'%s',0Ah,0 ; DATA XREF: sub_40AA09+76o
; char aThisUpdateS[]
aThisUpdateS	db ' This Update:',9,'%s',0Ah,0 ; DATA XREF: sub_40AA09+94o
; char aNextUpdateS[]
aNextUpdateS	db ' Next Update:',9,'%s',0Ah,0 ; DATA XREF: sub_40AA09+B2o
aNone_1		db 'none',0             ; DATA XREF: sub_40AA09:loc_40AAE5o
					; sub_40AA09:loc_40AB14o
; char aCrlNumberS[]
aCrlNumberS	db ' CRL Number :',9,'%s',0Ah,0 ; DATA XREF: sub_40AA09:loc_40AAEAo
; char aAuthkeyidS[]
aAuthkeyidS	db ' AuthKeyId  :',9,'%s',0Ah,0 ; DATA XREF: sub_40AA09:loc_40AB19o
asc_42FD93	db '             ',9,0  ; DATA XREF: sub_40AA09+144o
asc_42FDA2	db 0Ah			; DATA XREF: sub_40AA09+17Do
		db '             ',9,0
aMissing	db '[missing]',0        ; DATA XREF: sub_40AA09:loc_40AC01o
aSystem		db '[system]',0         ; DATA XREF: sub_40AA09:loc_40AC08o
; char aTrustCheckS[]
aTrustCheckS	db ' Trust Check:',9,'%s',0Ah,0 ; DATA XREF: sub_40AA09:loc_40AC0Do
		align 4
aErrorTheCrlWil	db ' ERROR: The CRL will not be used because it was still too old aft'
					; DATA XREF: sub_40AA09+229o
		db 'er an update!',0Ah,0
aErrorTheCrlW_0	db ' ERROR: The CRL will not be used due to an unknown critical exten'
					; DATA XREF: sub_40AA09+25Ao
		db 'sion!',0Ah,0
aErrorTheCrlW_1	db ' ERROR: The CRL will not be used',0Ah,0 ; DATA XREF: sub_40AA09+28Bo
		align 4
aErrorThisCache	db ' ERROR: This cached CRL may has been tampered with!',0Ah,0
					; DATA XREF: sub_40AA09+2E5o
		align 4
; char aWarningInval_1[]
aWarningInval_1	db ' WARNING: invalid cache record length',0Ah,0
					; DATA XREF: sub_40AA09+363o
		align 4
; char aProblemReadi_0[]
aProblemReadi_0	db 'problem reading cache record: %s',0Ah,0 ; DATA XREF: sub_40AA09+3B7o
		align 4
; char aProblemReadi_1[]
aProblemReadi_1	db 'problem reading cache key: %s',0Ah,0 ; DATA XREF: sub_40AA09+427o
asc_42FF37	db '  ',0               ; DATA XREF: sub_40AA09+449o
aReasons	db ':',9,' reasons( ',0 ; DATA XREF: sub_40AA09+4A9o
aUnspecified	db 'unspecified ',0     ; DATA XREF: sub_40AA09+4D7o
aKey_compromise	db 'key_compromise ',0  ; DATA XREF: sub_40AA09+50Co
aCa_compromise	db 'ca_compromise ',0   ; DATA XREF: sub_40AA09+541o
aAffiliation_ch	db 'affiliation_changed ',0 ; DATA XREF: sub_40AA09+576o
aSuperseeded	db 'superseeded',0      ; DATA XREF: sub_40AA09+5ABo
aCessation_of_o	db 'cessation_of_operation',0 ; DATA XREF: sub_40AA09+5E0o
aCertificate_ho	db 'certificate_hold',0 ; DATA XREF: sub_40AA09+615o
aOther		db 'other',0            ; DATA XREF: sub_40AA09+64Co
; char aRdate_15s[]
aRdate_15s	db ') rdate: %.15s',0Ah,0 ; DATA XREF: sub_40AA09:loc_40B079o
		align 4
; char aErrorReadingCa[]
aErrorReadingCa	db 'error reading cache entry from db: %s',0Ah,0
					; DATA XREF: sub_40AA09+6C1o
aEndCrlDump	db 'End CRL dump',0Ah,0 ; DATA XREF: sub_40AA09+6DFo
; char aCanTOpenSS_0[]
aCanTOpenSS_0	db 'can',27h,'t open `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_40B19E+53o
		align 10h
; char aErrorInitial_0[]
aErrorInitial_0	db 'error initializing reader object: %s',0Ah,0 ; DATA XREF: sub_40B19E+A5o
; char aCheckingDistri[]
aCheckingDistri	db 'checking distribution points',0Ah,0 ; DATA XREF: sub_40B296+42o
; char aNoIssuerNameAn[]
aNoIssuerNameAn	db 'no issuer name and no distribution point',0Ah,0
					; DATA XREF: sub_40B296+7Co
aLdap		db 'ldap:',0            ; DATA XREF: sub_40B296+E1o
aLdaps		db 'ldaps:',0           ; DATA XREF: sub_40B296+109o
aHttp		db 'http:',0            ; DATA XREF: sub_40B296+13Fo
aHttps		db 'https:',0           ; DATA XREF: sub_40B296+167o
; char aFetchingCrlF_1[]
aFetchingCrlF_1	db 'fetching CRL from `%s',27h,0Ah,0 ; DATA XREF: sub_40B296+1B2o
; char aCrl_fetchViaDp[]
aCrl_fetchViaDp	db 'crl_fetch via DP failed: %s',0Ah,0 ; DATA XREF: sub_40B296+1EFo
; char aInsertingCrlRe[]
aInsertingCrlRe	db 'inserting CRL (reader %p)',0Ah,0 ; DATA XREF: sub_40B296+213o
					; sub_40B296+40Ao
; char aCrl_cache_inse[]
aCrl_cache_inse	db 'crl_cache_insert via DP failed: %s',0Ah,0 ; DATA XREF: sub_40B296+250o
; char aNoDistribution[]
aNoDistribution	db 'no distribution point - trying issuer name',0Ah,0
					; DATA XREF: sub_40B296+345o
; char aFetchingCrlF_2[]
aFetchingCrlF_2	db 'fetching CRL from default location',0Ah,0 ; DATA XREF: sub_40B296+3AFo
; char aCrl_fetchViaIs[]
aCrl_fetchViaIs	db 'crl_fetch via issuer failed: %s',0Ah,0 ; DATA XREF: sub_40B296+3ECo
; char aDefaultLocatio[]
aDefaultLocatio	db 'default location(s)',0 ; DATA XREF: sub_40B296+41Do
		align 4
; char aCrl_cache_in_0[]
aCrl_cache_in_0	db 'crl_cache_insert via issuer failed: %s',0Ah,0
					; DATA XREF: sub_40B296+448o
aCopy_time	db 'copy_time',0        ; DATA XREF: sub_406B43:loc_406B85o
aCrl_parse_inse	db 'crl_parse_insert',0 ; DATA XREF: sub_40989B+20Fo
		align 4
; char aReaderToFileMa[]
aReaderToFileMa	db 'reader to file mapping table full - waiting',0Ah,0
					; DATA XREF: sub_40B7B2+43o
byte_430215	db 0			; DATA XREF: sub_40B86E+FFo
aHttps_0	db 'https:',0           ; DATA XREF: sub_40B9E4+58o
		align 10h
; char aUsingHttpInste[]
aUsingHttpInste	db 'using "http" instead of "https"',0Ah,0 ; DATA XREF: sub_40B9E4+FFo
aHttp_0		db 'HTTP',0             ; DATA XREF: sub_40B9E4+124o
		align 4
; char aCrlAccessNotPo[]
aCrlAccessNotPo	db 'CRL access not possible due to disabled %s',0Ah,0
					; DATA XREF: sub_40B9E4+12Co
					; sub_40B9E4+459o ...
; char aErrorInitial_1[]
aErrorInitial_1	db 'error initializing reader object: %s',0Ah,0 ; DATA XREF: sub_40B9E4+27Ao
; char aLocation[]
aLocation	db 'Location',0         ; DATA XREF: sub_40B9E4+2E3o
aNone_2		db '[none]',0           ; DATA XREF: sub_40B9E4:loc_40BCF2o
		align 4
; char aUrlSRedirected[]
aUrlSRedirected	db 'URL `%s',27h,' redirected to `%s',27h,' (%u)',0Ah,0
					; DATA XREF: sub_40B9E4+322o
; char aTooManyRedirec[]
aTooManyRedirec	db 'too many redirections',0Ah,0 ; DATA XREF: sub_40B9E4:loc_40BD9Ao
; char aErrorRetrievin[]
aErrorRetrievin	db 'error retrieving `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_40B9E4+3F0o
; char aErrorRetriev_0[]
aErrorRetriev_0	db 'error retrieving `%s',27h,': http status %u',0Ah,0
					; DATA XREF: sub_40B9E4+418o
aLdap_0		db 'LDAP',0             ; DATA XREF: sub_40B9E4+451o
					; sub_40BE9B+Fo ...
aCertificaterev	db 'certificateRevocationList',0 ; DATA XREF: sub_40BE9B+38o
aCacertificate	db 'cACertificate',0    ; DATA XREF: sub_40BEEF:loc_40BF20o
; char aCertificateSea[]
aCertificateSea	db 'certificate search not possible due to disabled %s',0Ah,0
					; DATA XREF: sub_40BF43+17o
; char aSUNoHostnameGi[]
aSUNoHostnameGi	db '%s:%u: no hostname given',0Ah,0 ; DATA XREF: sub_40C2F3+B0o
		align 4
; char aSUPasswordGive[]
aSUPasswordGive	db '%s:%u: password given without user',0Ah,0 ; DATA XREF: sub_40C2F3+131o
; char aSUSkippingThis[]
aSUSkippingThis	db '%s:%u: skipping this line',0Ah,0 ; DATA XREF: sub_40C2F3+1B9o
		align 4
off_4303E4	dd offset loc_40C477	; DATA XREF: sub_40C2F3+77o
		dd offset loc_40C373	; jump table for switch	statement
		dd offset loc_40C3BB
		dd offset loc_40C3DF
		dd offset loc_40C402
		dd offset loc_40C458
; char aCanTInitialize[]
aCanTInitialize	db 'can',27h,'t initialize certificate cache lock: %s',0Ah,0
					; DATA XREF: sub_40C547+2Bo
		align 4
; char aCanTAcquireRea[]
aCanTAcquireRea	db 'can',27h,'t acquire read lock on the certificate cache: %s',0Ah,0
					; DATA XREF: sub_40C580+43o
		align 4
; char aCanTAcquireWri[]
aCanTAcquireWri	db 'can',27h,'t acquire write lock on the certificate cache: %s',0Ah,0
					; DATA XREF: sub_40C5D1+43o
		align 4
; char aCanTReleaseLoc[]
aCanTReleaseLoc	db 'can',27h,'t release lock on the certificate cache: %s',0Ah,0
					; DATA XREF: sub_40C622+2Bo
		align 10h
; char aInvalidSExpInC[]
aInvalidSExpInC	db 'invalid S-exp in compare_serialno',0Ah,0
					; DATA XREF: sub_40C65B:loc_40C6F6o
; char aU[]
aU		db '(%u:',0             ; DATA XREF: sub_40C76A+1Do
; char aGcry_md_openFa[]
aGcry_md_openFa	db 'gcry_md_open failed: %s',0Ah,0 ; DATA XREF: sub_40C831+39o
		align 4
; char aOopsKsba_cert_[]
aOopsKsba_cert_	db 'oops: ksba_cert_hash failed: %s',0Ah,0 ; DATA XREF: sub_40C831+7Fo
		align 4
; char aDroppingUCerti[]
aDroppingUCerti	db 'dropping %u certificates from the cache',0Ah,0
					; DATA XREF: sub_40C9C5+4Co
		align 4
; char a____Dirmngr1_3[]
a____Dirmngr1_3	db '../../dirmngr-1.1.1/src/certcache.c',0 ; DATA XREF: sub_40C9C5+6Co
; char aIdx256[]
aIdx256		db 'idx < 256',0        ; DATA XREF: sub_40C9C5+74o
		align 4
; char aCanTAccessDire[]
aCanTAccessDire	db 'can',27h,'t access directory `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40CD34+4Co
a_crt		db '.crt',0             ; DATA XREF: sub_40CD34+BEo
a_der		db '.der',0             ; DATA XREF: sub_40CD34+ECo
; char aRb_0[]
aRb_0		db 'rb',0               ; DATA XREF: sub_40CD34+13Bo
; char aCanTOpenSS_1[]
aCanTOpenSS_1	db 'can',27h,'t open `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_40CD34+174o
; char aCanTSetupKsbaR[]
aCanTSetupKsbaR	db 'can',27h,'t setup KSBA reader: %s',0Ah,0 ; DATA XREF: sub_40CD34+1C3o
; char aCanTParseCerti[]
aCanTParseCerti	db 'can',27h,'t parse certificate `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40CD34+245o
		align 4
; char aCertificateSAl[]
aCertificateSAl	db 'certificate `%s',27h,' already cached',0Ah,0
					; DATA XREF: sub_40CD34+29Fo
		align 4
; char aTrustedCertifi[]
aTrustedCertifi	db 'trusted certificate `%s',27h,' loaded',0Ah,0
					; DATA XREF: sub_40CD34+2C7o
; char aCertificateSLo[]
aCertificateSLo	db 'certificate `%s',27h,' loaded',0Ah,0 ; DATA XREF: sub_40CD34+2DCo
; char aSha1Fingerprin[]
aSha1Fingerprin	db '  SHA1 fingerprint = %s',0Ah,0 ; DATA XREF: sub_40CD34+306o
aIssuer		db '   issuer =',0      ; DATA XREF: sub_40CD34+324o
aSubject	db '  subject =',0      ; DATA XREF: sub_40CD34+337o
		align 4
; char aErrorLoadingCe[]
aErrorLoadingCe	db 'error loading certificate `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40CD34+35Bo
aTrustedCerts	db 'trusted-certs',0    ; DATA XREF: sub_40D0E6+2Ao
aExtraCerts	db 'extra-certs',0      ; DATA XREF: sub_40D0E6+68o
		align 4
; char aPermanentlyLoa[]
aPermanentlyLoa	db 'permanently loaded certificates: %u',0Ah,0 ; DATA XREF: sub_40D26E+Fo
		align 10h
; char aRuntimeCachedC[]
aRuntimeCachedC	db '    runtime cached certificates: %u',0Ah,0 ; DATA XREF: sub_40D26E+24o
; char aCertificateAlr[]
aCertificateAlr	db 'certificate already cached',0Ah,0 ; DATA XREF: sub_40D2A0+48o
; char aCertificateCac[]
aCertificateCac	db 'certificate cached',0Ah,0 ; DATA XREF: sub_40D2A0+5Co
		align 4
; char aErrorCachingCe[]
aErrorCachingCe	db 'error caching certificate: %s',0Ah,0 ; DATA XREF: sub_40D2A0+79o
					; sub_40D32A+63o
		align 4
; char aInvalidSha1Fin[]
aInvalidSha1Fin	db 'invalid SHA1 fingerprint string `%s',27h,0Ah,0
					; DATA XREF: sub_40D41E+31Fo
; char a01234567890abc[]
a01234567890abc	db '01234567890abcdefABCDEF',0 ; DATA XREF: sub_40D93E+16Ao
					; sub_40D93E+264o
; char a0123456789abcd[]
a0123456789abcd	db '0123456789abcdefABCDEF',0 ; DATA XREF: sub_40D93E:loc_40DC37o
; char a0123456789ab_0[]
a0123456789ab_0	db ':0123456789abcdefABCDEF',0 ; DATA XREF: sub_40D93E+42Eo
		align 4
off_4307F8	dd offset loc_40D9B1, offset loc_40DC15, offset	loc_40DC15
					; DATA XREF: sub_40D93E+6Ar
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15 ; jump table	for switch statement
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DA4B
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC09
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40D9F5, offset loc_40DA05, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40D9BD, offset	loc_40DA11
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DC15, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40DB5A, offset	loc_40DC15
		dd offset loc_40D9C9, offset loc_40D9E9, offset	loc_40DC15
		dd offset loc_40DC15, offset loc_40D9D9
off_4308FC	dd offset loc_40DEAA	; DATA XREF: sub_40DE2E+73o
		dd offset loc_40E041	; jump table for switch	statement
		dd offset loc_40E041
		dd offset loc_40E041
		dd offset loc_40DEBE
		dd offset loc_40E041
		dd offset loc_40E041
		dd offset loc_40DFC8
		dd offset loc_40E041
		dd offset loc_40DEED
		dd offset loc_40DF44
		dd offset loc_40E041
; char aSerial_hexFa_0[]
aSerial_hexFa_0	db 'serial_hex() failed',0Ah,0 ; DATA XREF: sub_40E092+47o
		align 4
; char aCanTAllocate_0[]
aCanTAllocate_0	db 'can',27h,'t allocate enough memory: %s',0Ah,0
					; DATA XREF: sub_40E092+C6o
					; sub_40E3E4+22Do
		align 4
; char aFind_cert_bysn[]
aFind_cert_bysn	db 'find_cert_bysn: certificate not returned by caller - doing lookup'
					; DATA XREF: sub_40E092+170o
		db 0Ah,0
		align 4
; char aErrorFetchingC[]
aErrorFetchingC	db 'error fetching certificate by S/N: %s',0Ah,0
					; DATA XREF: sub_40E092+1B9o
					; sub_40E092+1F4o
		align 4
; char aFind_cert_by_0[]
aFind_cert_by_0	db 'find_cert_bysn: Ooops: issuer DN does not match',0Ah,0
					; DATA XREF: sub_40E092+231o
; char aConsideringCer[]
aConsideringCer	db '   considering certificate (#',0 ; DATA XREF: sub_40E092+279o
; char asc_430A23[]
asc_430A23	db '/',0                ; DATA XREF: sub_40E092+290o
					; sub_40E92B+164o
; char asc_430A25[]
asc_430A25	db ')',0Ah,0            ; DATA XREF: sub_40E092+2A7o
					; sub_40E3E4+3BCo
; char aFound[]
aFound		db '   found',0Ah,0     ; DATA XREF: sub_40E092+2F6o
					; sub_40E3E4+3F4o ...
		align 4
; char aFind_cert_bysu[]
aFind_cert_bysu	db 'find_cert_bysubject: certificate not in ocsp_certs',0Ah,0
					; DATA XREF: sub_40E3E4+102o
; char aFind_cert_by_1[]
aFind_cert_by_1	db 'find_cert_bysubject: certificate not in cache',0Ah,0
					; DATA XREF: sub_40E3E4+1B2o
		align 4
; char aFind_cert_by_2[]
aFind_cert_by_2	db 'find_cert_bysubject: certificate not returned by caller - doing l'
					; DATA XREF: sub_40E3E4+2AAo
		db 'ookup',0Ah,0
; char aErrorFetchin_0[]
aErrorFetchin_0	db 'error fetching certificate by subject: %s',0Ah,0
					; DATA XREF: sub_40E3E4+2F3o
					; sub_40E3E4+32Eo
		align 4
; char aFind_cert_by_3[]
aFind_cert_by_3	db 'find_cert_bysubject: subject DN does not match',0Ah,0
					; DATA XREF: sub_40E3E4+36Bo
; char aConsideringC_0[]
aConsideringC_0	db '   considering certificate (/',0 ; DATA XREF: sub_40E3E4+3A5o
		align 4
; char aNoIssuerFoundI[]
aNoIssuerFoundI	db 'no issuer found in certificate',0Ah,0 ; DATA XREF: sub_40E92B+32o
; char aErrorGettingAu[]
aErrorGettingAu	db 'error getting authorityKeyIdentifier: %s',0Ah,0
					; DATA XREF: sub_40E92B+8Ao
; char aIssuerCertific[]
aIssuerCertific	db 'issuer certificate ',0 ; DATA XREF: sub_40E92B+110o
; char asc_430BBA[]
asc_430BBA	db '{',0                ; DATA XREF: sub_40E92B+123o
; char asc_430BBC[]
asc_430BBC	db '} ',0               ; DATA XREF: sub_40E92B+13Ao
; char asc_430BBF[]
asc_430BBF	db '(#',0               ; DATA XREF: sub_40E92B+14Do
; char asc_430BC2[]
asc_430BC2	db ') ',0               ; DATA XREF: sub_40E92B+17Bo
		align 4
; char aNotFoundUsingA[]
aNotFoundUsingA	db 'not found using authorityKeyIdentifier',0Ah,0
					; DATA XREF: sub_40E92B:loc_40EAB2o
		align 20h
byte_430C00	db 0FFh			; DATA XREF: sub_40ECB6+198r
		db 3 dup(0FFh)
		dd 9 dup(0FFFFFFFFh), 3EFFFFFFh, 3FFFFFFFh, 37363534h
		dd 3B3A3938h, 0FFFF3D3Ch, 0FFFFFFFFh, 20100FFh,	6050403h
		dd 0A090807h, 0E0D0C0Bh, 1211100Fh, 16151413h, 0FF191817h
		dd 0FFFFFFFFh, 1C1B1AFFh, 201F1E1Dh, 24232221h,	28272625h
		dd 2C2B2A29h, 302F2E2Dh, 0FF333231h, 0FFFFFFFFh
dword_430C80	dd 504750h		; DATA XREF: sub_40EBAB+79o
a____Dirmngr1_4	db '../../dirmngr-1.1.1/src/b64dec.c',0 ; DATA XREF: sub_40ECB6+2B5o
aBegin		db '-----BEGIN ',0      ; DATA XREF: sub_40ECB6+A5o
		align 4
off_430CB4	dd offset loc_40ED4B	; DATA XREF: sub_40ECB6+6Bo
		dd offset loc_40ED2A	; jump table for switch	statement
		dd offset loc_40ED52
		dd offset loc_40ED8E
		dd offset loc_40EDA8
		dd offset loc_40EDA8
		dd offset loc_40EDA8
		dd offset loc_40EDA8
		dd offset loc_40EF2F
		dd offset loc_40EF42
aB64dec_proc	db 'b64dec_proc',0      ; DATA XREF: sub_40ECB6:loc_40EF5Bo
		align 20h
; char aAbcdefghijklmn[]
aAbcdefghijklmn	db 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890.-'
					; DATA XREF: sub_410C31+75o
		db 0
		align 4
; char aInvalidChar0x0[]
aInvalidChar0x0	db 'invalid char 0x%02x in host name - not added',0Ah,0
					; DATA XREF: sub_410C31+92o
		align 4
; char aAddingSDToTheL[]
aAddingSDToTheL	db 'adding `%s:%d',27h,' to the ldap server list',0Ah,0
					; DATA XREF: sub_410C31+BFo
; char aMallocFailedS[]
aMallocFailedS	db 'malloc failed: %s',0Ah,0 ; DATA XREF: sub_410C31+FDo
; char aS_0[]
aS_0		db '%s',0Ah,0           ; DATA XREF: sub_410E33+37o
					; sub_410E33+93o ...
; char aS_1[]
aS_1		db '%s',0               ; DATA XREF: sub_410E33+76o
; char aErrorPrintingL[]
aErrorPrintingL	db 'error printing log line: %s',0Ah,0 ; DATA XREF: sub_410E33+186o
		align 4
; char aErrorReadingLo[]
aErrorReadingLo	db 'error reading log from ldap wrapper %d: %s',0Ah,0
					; DATA XREF: sub_41102A+6Fo
; char aPth_eventFaile[]
aPth_eventFaile	db 'pth_event failed: %s',0Ah,0 ; DATA XREF: sub_411148+56o
; char aPth_waitFailed[]
aPth_waitFailed	db 'pth_wait failed: %s',0Ah,0 ; DATA XREF: sub_411148+FDo
		align 4
; char aLdapWrapperDRe[]
aLdapWrapperDRe	db 'ldap wrapper %d ready: timeout',0Ah,0 ; DATA XREF: sub_411148+203o
aLdapWrapperD_0	db 'ldap wrapper %d ready',0 ; DATA XREF: sub_411148:loc_411352o
		align 4
; char aWaitingForLdap[]
aWaitingForLdap	db 'waiting for ldap wrapper %d failed: %s',0Ah,0
					; DATA XREF: sub_411148+26Fo
; char aLdapWrapperDSt[]
aLdapWrapperDSt	db 'ldap wrapper %d stalled - killing',0Ah,0 ; DATA XREF: sub_411148+2C9o
; char aLdapWorkerStat[]
aLdapWorkerStat	db 'ldap worker stati:',0Ah,0 ; DATA XREF: sub_411148+32Co
		align 4
; char aCPPidDDRdrPCtr[]
aCPPidDDRdrPCtr	db '  c=%p pid=%d/%d rdr=%p ctrl=%p/%d la=%lu rdy=%d',0Ah,0
					; DATA XREF: sub_411148+3B3o
		align 4
; char aReleasingLdapW[]
aReleasingLdapW	db 'releasing ldap worker c=%p pid=%d/%d rdr=%p ctrl=%p/%d',0Ah,0
					; DATA XREF: sub_4115C2+86o
; char aReadingFromLda[]
aReadingFromLda	db 'reading from ldap wrapper %d failed: %s',0Ah,0
					; DATA XREF: sub_4115C2+107o
					; sub_4116F6+7Bo
; char aPass[]
aPass		db '--pass',0           ; DATA XREF: sub_4119CC+9Ao
					; sub_411D68+22o ...
aEnvPass	db '--env-pass',0       ; DATA XREF: sub_4119CC+B7o
; CHAR Name[]
Name		db 'DIRMNGR_LDAP_PASS',0 ; DATA XREF: sub_4119CC+C9o
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating memory: %s',0Ah,0 ; DATA XREF: sub_4119CC+157o
		align 4
; char aErrorInitial_2[]
aErrorInitial_2	db 'error initializing reader object: %s',0Ah,0 ; DATA XREF: sub_4119CC+290o
		align 4
; char aLdapWrapperD_1[]
aLdapWrapperD_1	db 'ldap wrapper %d started (reader %p)',0Ah,0 ; DATA XREF: sub_4119CC+300o
aVv		db '-vv',0              ; DATA XREF: sub_411D68+4Eo
					; sub_41290B+A1o
aLogWithPid	db '--log-with-pid',0   ; DATA XREF: sub_411D68+60o
					; sub_41290B+B3o
aMulti		db '--multi',0          ; DATA XREF: sub_411D68+78o
					; sub_41290B+C5o
; char aU_0[]
aU_0		db '%u',0               ; DATA XREF: sub_411D68+96o
					; sub_41290B+E3o
aTimeout	db '--timeout',0        ; DATA XREF: sub_411D68+B4o
					; sub_41290B+101o
aOnlySearchTime	db '--only-search-timeout',0 ; DATA XREF: sub_411D68+E0o
aProxy		db '--proxy',0          ; DATA XREF: sub_411D68+F8o
					; sub_41290B+130o
aHost		db '--host',0           ; DATA XREF: sub_411D68+121o
					; sub_41290B+15Co
; char aD_0[]
aD_0		db '%d',0               ; DATA XREF: sub_411D68+147o
					; sub_41290B+182o
aPort		db '--port',0           ; DATA XREF: sub_411D68+168o
					; sub_41290B+1A3o
aUser		db '--user',0           ; DATA XREF: sub_411D68+194o
					; sub_41290B+1D3o
aDn		db '--dn',0             ; DATA XREF: sub_411D68+1BDo
aFilter		db '--filter',0         ; DATA XREF: sub_411D68+1E6o
aAttr		db '--attr',0           ; DATA XREF: sub_411D68+20Fo
aLdap_1		db 'ldap://',0          ; DATA XREF: sub_411D68:loc_411FA2o
; char aNoHostnameInUr[]
aNoHostnameInUr	db 'no hostname in URL or query failed; trying all default hostnames',0Ah
					; DATA XREF: sub_411FE1+10Do
		db 0
aObjectclass	db 'objectClass=*',0    ; DATA XREF: sub_4121B9+71o
					; sub_4127D6+A6o ...
dword_4310B4	dd 0			; DATA XREF: sub_4124E3+Co
					; sub_41290B:loc_412969o
; char aAbcdefghijkl_0[]
aAbcdefghijkl_0	db 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890$-'
					; DATA XREF: sub_4124E3+2Fo
					; sub_4124E3+90o
		db '_.+!*',27h,'(),',0
; char a02x_0[]
a02x_0		db '%%%02X',0           ; DATA XREF: sub_4124E3+BAo
		align 4
; char aStart_cert_f_0[]
aStart_cert_f_0	db 'start_cert_fetch: invalid pattern `%s',27h,0Ah,0
					; DATA XREF: sub_41290B+234o
aUsercertificat	db 'userCertificate',0  ; DATA XREF: sub_412CC5:loc_412EB6o
					; sub_412CC5+214o
; char aFetch_next_c_0[]
aFetch_next_c_0	db 'fetch_next_cert_ldap: got attribute `%s',27h,0Ah,0
					; DATA XREF: sub_412CC5+21Co
					; sub_412CC5+25Fo ...
aCacertificat_0	db 'caCertificate',0    ; DATA XREF: sub_412CC5:loc_412EF9o
					; sub_412CC5+257o ...
aX509cacert	db 'x509caCert',0       ; DATA XREF: sub_412CC5:loc_412F3Co
		align 4
; char aFetch_next_c_1[]
aFetch_next_c_1	db 'fetch_next_cert_ldap: got attribute `%s',27h,' -  ignored',0Ah,0
					; DATA XREF: sub_412CC5+2CAo
; char aTruncated_1[]
aTruncated_1	db 'truncated',0        ; DATA XREF: sub_412CC5+2F9o
		align 4
; char aLdap_searchHit[]
aLdap_searchHit	db 'ldap_search hit the size limit of the server',0Ah,0
					; DATA XREF: sub_412CC5+31Ao
		align 4
; char aErrorInitial_3[]
aErrorInitial_3	db 'error initializing socket library: ec=%d',0Ah,0
					; DATA XREF: sub_413121+3Bo
		align 4
; char aSocketLibraryV[]
aSocketLibraryV	db 'socket library version is %x.%x - but %d.%d needed',0Ah,0
					; DATA XREF: sub_413121+93o
; char asc_431258[]
asc_431258	db 0Dh,0Ah,0		; DATA XREF: sub_413580+1Ao
					; sub_4141ED+196o ...
; char aR_1[]
aR_1		db 'r',0                ; DATA XREF: sub_4135D8+E9o
		align 10h
; char aAbcdefghijkl_1[]
aAbcdefghijkl_1	db 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890@!'
					; DATA XREF: sub_413995+85o
					; sub_413FA0+25o
		db '"#$%&',27h,'()*+,-./:;<=>?[\]^_{|}~',0
aHttp_1		db 'http',0             ; DATA XREF: sub_413995+138o
; char a02x_1[]
a02x_1		db '%%%02X',0           ; DATA XREF: sub_413FA0+7Bo
		align 4
; char aTlsRequestedBu[]
aTlsRequestedBu	db 'TLS requested but no GNUTLS context provided',0Ah,0
					; DATA XREF: sub_4141ED+3Do
aLocalhost	db 'localhost',0        ; DATA XREF: sub_4141ED:loc_414262o
					; sub_4141ED:loc_4143FBo
; char aHttp_proxy[]
aHttp_proxy	db 'http_proxy',0       ; DATA XREF: sub_4141ED+C2o
; char aInvalidHttpPro[]
aInvalidHttpPro	db 'invalid HTTP proxy (%s): %s',0Ah,0 ; DATA XREF: sub_4141ED+126o
aProxyAuthoriza	db 'Proxy-Authorization: Basic ',0 ; DATA XREF: sub_4141ED+19Eo
aAuthorizationB	db 'Authorization: Basic %s',0 ; DATA XREF: sub_4141ED+35Do
byte_431360	db 0			; DATA XREF: sub_4141ED:loc_4145C9o
					; sub_4141ED:loc_4145D9o ...
asc_431361	db '/',0                ; DATA XREF: sub_4141ED:loc_4145EFo
					; sub_4141ED:loc_4146BCo
aPost		db 'POST',0             ; DATA XREF: sub_4141ED+42Co
					; sub_4141ED+4F5o
aOops		db 'OOPS',0             ; DATA XREF: sub_4141ED:loc_414620o
					; sub_4141ED:loc_4146E9o
aHead		db 'HEAD',0             ; DATA XREF: sub_4141ED:loc_414627o
					; sub_4141ED:loc_4146F0o
aGet		db 'GET',0              ; DATA XREF: sub_4141ED:loc_41462Eo
					; sub_4141ED:loc_4146F7o
		align 4
aSHttpSHuSSHttp	db '%s http://%s:%hu%s%s HTTP/1.0',0Dh,0Ah
					; DATA XREF: sub_4141ED:loc_414633o
		db '%s%s',0
; char aU_1[]
aU_1		db ':%u',0              ; DATA XREF: sub_4141ED+48Eo
aSSSHttp1_0Host	db '%s %s%s HTTP/1.0',0Dh,0Ah ; DATA XREF: sub_4141ED:loc_4146FCo
		db 'Host: %s%s',0Dh,0Ah
		db '%s',0
; char aW_0[]
aW_0		db 'w',0                ; DATA XREF: sub_4141ED:loc_4147B8o
; char a__0[]
a?_0		db '%;?&',0             ; DATA XREF: sub_41488E+Co
					; sub_41488E+C2o
; char a__1[]
a?_1		db '%;?&=',0            ; DATA XREF: sub_41488E+3Co
					; sub_41488E+6Bo ...
; char aResp_S[]
aResp_S		db 'RESP: `%.*s',27h,0Ah,0 ; DATA XREF: sub_414E72+129o
					; sub_414E72+368o
; char aHttp_2[]
aHttp_2		db 'HTTP',0             ; DATA XREF: sub_414E72+16Fo
; char asc_4313E1[]
asc_4313E1	db ' ',9,0              ; DATA XREF: sub_414E72:loc_415002o
					; sub_414E72+1B6o ...
; char aContentLength[]
aContentLength	db 'Content-Length',0   ; DATA XREF: sub_414E72+3DCo
; char aErrorCreatingS[]
aErrorCreatingS	db 'error creating socket: ec=%d',0Ah,0 ; DATA XREF: sub_4152A7+AAo
; char aErrorCreatin_0[]
aErrorCreatin_0	db 'error creating socket: %s',0Ah,0 ; DATA XREF: sub_4152A7+24Eo
; char aUnknownAddress[]
aUnknownAddress	db 'unknown address family for `%s',27h,0Ah,0 ; DATA XREF: sub_4152A7+29Bo
		align 10h
; char aIllegalAddress[]
aIllegalAddress	db 'illegal address length for `%s',27h,0Ah,0 ; DATA XREF: sub_4152A7+308o
asc_431471	db ' - ',0              ; DATA XREF: sub_4152A7:loc_4156A2o
aHostNotFound	db 'host not found',0   ; DATA XREF: sub_4152A7:loc_4156B4o
; char aCanTConnectToS[]
aCanTConnectToS	db 'can',27h,'t connect to `%s',27h,': %s%sec=%d',0Ah,0
					; DATA XREF: sub_4152A7+425o
		align 4
; char a04d02d02dt02d0[]
a04d02d02dt02d0	db '%04d%02d%02dT%02d%02d%02d',0 ; DATA XREF: sub_415940+5Do
					; sub_415EF7+31Do
		align 4
a____Dirmngr1_5	db '../../dirmngr-1.1.1/src/misc.c',0 ; DATA XREF: sub_415BB7+E7o
; char a02x_2[]
a02x_2		db '%02X',0             ; DATA XREF: sub_4163EE+2Fo
					; sub_41644D+7Do ...
; char aInvalidCanonic[]
aInvalidCanonic	db 'invalid canonical S-expression found',0Ah,0 ; DATA XREF: sub_41667D+3Bo
		align 10h
; char aConvertingSE_0[]
aConvertingSE_0	db 'converting S-expression failed: %s',0Ah,0 ; DATA XREF: sub_41667D+91o
; char aGcry_md_open_0[]
aGcry_md_open_0	db 'gcry_md_open failed: %s',0Ah,0 ; DATA XREF: sub_416729+3Co
					; sub_4168B2+3Co
		align 10h
; char aOopsKsba_cer_0[]
aOopsKsba_cer_0	db 'oops: ksba_cert_hash failed: %s',0Ah,0 ; DATA XREF: sub_416729+82o
					; sub_4168B2+82o
; char a02x_3[]
a02x_3		db '%02X:',0            ; DATA XREF: sub_4168B2+13Do
a?_2		db '?',0                ; DATA XREF: sub_416A63:loc_416A82o
					; sub_416BE5:loc_416C3Co
; char aS_2[]
aS_2		db '%s',0               ; DATA XREF: sub_416A63+28o
					; sub_416B16+6Do ...
; char aNone_3[]
aNone_3		db '[none]',0           ; DATA XREF: sub_416AA4:loc_416ABCo
; char a_4s_2s_2s_2s_2[]
a_4s_2s_2s_2s_2	db '%.4s-%.2s-%.2s %.2s:%.2s:%s',0 ; DATA XREF: sub_416AA4+5Fo
; char aError[]
aError		db '[error]',0          ; DATA XREF: sub_416B16+Do
; char asc_4315A7[]
asc_4315A7	db '[ ',0               ; DATA XREF: sub_416B16:loc_416B91o
; char asc_4315AA[]
asc_4315AA	db ' ]',0               ; DATA XREF: sub_416B16+BDo
byte_4315AD	db 0			; DATA XREF: sub_416BE5:loc_416BF6o
; char aBeginCertifica[]
aBeginCertifica	db 'BEGIN Certificate `%s',27h,':',0Ah,0 ; DATA XREF: sub_416BE5+1Ao
; char aSerialS[]
aSerialS	db '     serial: %s',0Ah,0 ; DATA XREF: sub_416BE5+60o
; char aNotbefore[]
aNotbefore	db '  notBefore: ',0    ; DATA XREF: sub_416BE5+9Co
; char asc_4315E6[]
asc_4315E6	db 0Ah,0		; DATA XREF: sub_416BE5+B3o
					; sub_416BE5+F0o ...
; char aNotafter[]
aNotafter	db '   notAfter: ',0    ; DATA XREF: sub_416BE5+D9o
; char aIssuer_0[]
aIssuer_0	db '     issuer: ',0    ; DATA XREF: sub_416BE5+112o
; char aSubject_0[]
aSubject_0	db '    subject: ',0    ; DATA XREF: sub_416BE5+156o
; char aHashAlgoS[]
aHashAlgoS	db '  hash algo: %s',0Ah,0 ; DATA XREF: sub_416BE5+193o
; char aSha1Fingerpr_0[]
aSha1Fingerpr_0	db '  SHA1 fingerprint: %s',0Ah,0 ; DATA XREF: sub_416BE5+1B4o
; char aEndCertificate[]
aEndCertificate	db 'END Certificate',0Ah,0 ; DATA XREF: sub_416BE5:loc_416DB0o
aCertificate	db 'certificate',0      ; DATA XREF: sub_416DBE:loc_416DCFo
; char asc_431658[]
asc_431658	db ' #',0               ; DATA XREF: sub_416DBE+60o
; char asc_43165B[]
asc_43165B	db '/',0                ; DATA XREF: sub_416DBE+77o
; char aInvalid[]
aInvalid	db ' [invalid]',0       ; DATA XREF: sub_416DBE:loc_416E4Eo
					; sub_416E7E:loc_416EEAo
aSubject_1	db 'subject',0          ; DATA XREF: sub_416E7E:loc_416E8Fo
; char asc_431670[]
asc_431670	db ' /',0               ; DATA XREF: sub_416E7E+48o
; char aMallocFailed_0[]
aMallocFailed_0	db 'malloc failed: %s',0Ah,0 ; DATA XREF: sub_417136+A7o
; char aBadUrlEncoding[]
aBadUrlEncoding	db 'bad URL encoding detected',0Ah,0 ; DATA XREF: sub_417136:loc_417294o
aDays_per_month	db 'days_per_month',0   ; DATA XREF: sub_415BB7:loc_415C8Eo
a____Dirmngr1_6	db '../../dirmngr-1.1.1/src/misc.h',0 ; DATA XREF: sub_417326+52o
; char a1_3_6_1_5_5_7_[]
a1_3_6_1_5_5_7_	db '1.3.6.1.5.5.7.48.1',0 ; DATA XREF: sub_418114+15Ao
a1_3_36_8_3_13	db '1.3.36.8.3.13',0
; char a____Dirmngr1_7[]
a____Dirmngr1_7	db '../../dirmngr-1.1.1/src/ocsp.c',0 ; DATA XREF: sub_41739C+67o
; char aNbytesBufsize[]
aNbytesBufsize	db 'nbytes < bufsize',0 ; DATA XREF: sub_41739C+6Fo
; char aErrorReadingFr[]
aErrorReadingFr	db 'error reading from responder: %s',0Ah,0 ; DATA XREF: sub_41739C+F2o
		align 4
; char aResponseFromSe[]
aResponseFromSe	db 'response from server too large; limit is %d bytes',0Ah,0
					; DATA XREF: sub_41739C+168o
		align 4
; char aOcspRequestNot[]
aOcspRequestNot	db 'OCSP request not possible due to disabled HTTP',0Ah,0
					; DATA XREF: sub_41757C+1Fo
; char aErrorSettingOc[]
aErrorSettingOc	db 'error setting OCSP target: %s',0Ah,0 ; DATA XREF: sub_41757C+6Do
		align 4
; char aErrorBuildingO[]
aErrorBuildingO	db 'error building OCSP request: %s',0Ah,0 ; DATA XREF: sub_41757C+108o
; char aErrorConnectin[]
aErrorConnectin	db 'error connecting to `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_41757C+188o
		align 4
aContentTypeApp	db 'Content-Type: application/ocsp-request',0Dh,0Ah
					; DATA XREF: sub_41757C+1AAo
		db 'Content-Length: %lu',0Dh,0Ah,0
		align 4
; char aErrorSendingRe[]
aErrorSendingRe	db 'error sending request to `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_41757C+233o
		align 4
; char aErrorReadingHt[]
aErrorReadingHt	db 'error reading HTTP response for `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_41757C+2C8o
					; sub_41757C+481o
; char aLocation_0[]
aLocation_0	db 'Location',0         ; DATA XREF: sub_41757C+2F5o
aNone_4		db '[none]',0           ; DATA XREF: sub_41757C:loc_41789Co
		align 4
; char aUrlSRedirect_0[]
aUrlSRedirect_0	db 'URL `%s',27h,' redirected to `%s',27h,' (%u)',0Ah,0
					; DATA XREF: sub_41757C+334o
; char aTooManyRedir_0[]
aTooManyRedir_0	db 'too many redirections',0Ah,0 ; DATA XREF: sub_41757C:loc_417944o
		align 4
; char aErrorAccessing[]
aErrorAccessing	db 'error accessing `%s',27h,': http status %u',0Ah,0
					; DATA XREF: sub_41757C+3ECo
		align 4
; char aErrorParsingOc[]
aErrorParsingOc	db 'error parsing OCSP response for `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_41757C+4DFo
aSuccess	db 'success',0          ; DATA XREF: sub_41757C:loc_417ACDo
aMalformed	db 'malformed',0        ; DATA XREF: sub_41757C:loc_417AD6o
aInternalError	db 'internal error',0   ; DATA XREF: sub_41757C:loc_417ADFo
aTryLater	db 'try later',0        ; DATA XREF: sub_41757C:loc_417AE8o
aMustSignReques	db 'must sign request',0 ; DATA XREF: sub_41757C:loc_417AF1o
aUnauthorized	db 'unauthorized',0     ; DATA XREF: sub_41757C:loc_417AFAo
aReplayDetected	db 'replay detected',0  ; DATA XREF: sub_41757C:loc_417B03o
aOtherUnknown	db 'other (unknown)',0  ; DATA XREF: sub_41757C:loc_417B0Co
aNoStatus	db 'no status',0        ; DATA XREF: sub_41757C:loc_417B15o
aUnknownStatus	db '[unknown status]',0 ; DATA XREF: sub_41757C:loc_417B1Eo
		align 4
; char aOcspResponderA[]
aOcspResponderA	db 'OCSP responder at `%s',27h,' status: %s',0Ah,0
					; DATA XREF: sub_41757C+5C8o
					; sub_41757C+637o
		align 10h
; char aHashingTheOcsp[]
aHashingTheOcsp	db 'hashing the OCSP response for `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_41757C+61Bo
		align 10h
; char aNotSignedByADe[]
aNotSignedByADe	db 'not signed by a default OCSP signer',27h,'s certificate',0
					; DATA XREF: sub_417BEE:loc_417C40o
aOnly_valid_if_	db 'ONLY_VALID_IF_CERT_VALID',0 ; DATA XREF: sub_417BEE+CFo
		align 4
; char aOnlySha1IsSupp[]
aOnlySha1IsSupp	db 'only SHA-1 is supported for OCSP responses',0Ah,0
					; DATA XREF: sub_417DA7+3Eo
aDataFlagsPkc_0	db '(data(flags pkcs1)(hash sha1 %b))',0 ; DATA XREF: sub_417DA7+82o
		align 4
; char aCreatingSExp_0[]
aCreatingSExp_0	db 'creating S-expression failed: %s',0Ah,0 ; DATA XREF: sub_417DA7+B5o
		align 10h
; char aAllocatingList[]
aAllocatingList	db 'allocating list item failed: %s',0Ah,0 ; DATA XREF: sub_417DA7+1ACo
		align 4
; char aErrorGettingRe[]
aErrorGettingRe	db 'error getting responder ID: %s',0Ah,0 ; DATA XREF: sub_417DA7+248o
; char aResponderCerti[]
aResponderCerti	db 'responder certificate ',0 ; DATA XREF: sub_417DA7+27Eo
; char aS_3[]
aS_3		db '`/%s',27h,' ',0     ; DATA XREF: sub_417DA7+298o
; char asc_431B32[]
asc_431B32	db '{',0                ; DATA XREF: sub_417DA7+2ABo
; char asc_431B34[]
asc_431B34	db '} ',0               ; DATA XREF: sub_417DA7+2C2o
; char aNotFound_0[]
aNotFound_0	db 'not found',0Ah,0    ; DATA XREF: sub_417DA7:loc_418075o
		align 4
; char aNoSuitableCert[]
aNoSuitableCert	db 'no suitable certificate found to verify the OCSP response',0Ah,0
					; DATA XREF: sub_417DA7+34Fo
		align 10h
; char aIssuerCertif_0[]
aIssuerCertif_0	db 'issuer certificate not found: %s',0Ah,0 ; DATA XREF: sub_418114+84o
		align 4
; char aCallerDidNotRe[]
aCallerDidNotRe	db 'caller did not return the target certificate',0Ah,0
					; DATA XREF: sub_418114+B0o
		align 4
; char aCallerDidNot_0[]
aCallerDidNot_0	db 'caller did not return the issuing certificate',0Ah,0
					; DATA XREF: sub_418114+EDo
		align 4
; char aFailedToAllo_0[]
aFailedToAllo_0	db 'failed to allocate OCSP context: %s',0Ah,0 ; DATA XREF: sub_418114+130o
aHttp_3		db 'http:',0            ; DATA XREF: sub_418114+1A1o
aHttps_1	db 'https:',0           ; DATA XREF: sub_418114+1C0o
		align 4
; char aCanTGetAuthori[]
aCanTGetAuthori	db 'can',27h,'t get authorityInfoAccess: %s',0Ah,0
					; DATA XREF: sub_418114+2A6o
		align 4
; char aNoDefaultOcspR[]
aNoDefaultOcspR	db 'no default OCSP responder defined',0Ah,0
					; DATA XREF: sub_418114:loc_4183EAo
		align 10h
; char aNoDefaultOcspS[]
aNoDefaultOcspS	db 'no default OCSP signer defined',0Ah,0 ; DATA XREF: sub_418114+2FFo
; char aUsingDefaultOc[]
aUsingDefaultOc	db 'using default OCSP responder `%s',27h,0Ah,0 ; DATA XREF: sub_418114+33Fo
; char aUsingOcspRespo[]
aUsingOcspRespo	db 'using OCSP responder `%s',27h,0Ah,0 ; DATA XREF: sub_418114+35Do
		align 10h
; char aFailedToEstabl[]
aFailedToEstabl	db 'failed to establish a hashing context for OCSP: %s',0Ah,0
					; DATA XREF: sub_418114+39Fo
; char aErrorGettingOc[]
aErrorGettingOc	db 'error getting OCSP status for target certificate: %s',0Ah,0
					; DATA XREF: sub_418114+4E6o
aValidated_at	db 'validated_at',0     ; DATA XREF: sub_418114+51Eo
		align 4
; char aSet_user_dataV[]
aSet_user_dataV	db 'set_user_data(validated_at) failed: %s',0Ah,0
					; DATA XREF: sub_418114+549o
aNone_5		db 'none',0             ; DATA XREF: sub_418114+594o
a?_3		db '?',0                ; DATA XREF: sub_418114:loc_4186AFo
					; sub_418114:loc_41878Eo
aUnknown_0	db 'unknown',0          ; DATA XREF: sub_418114:loc_4186B6o
aRevoked	db 'revoked',0          ; DATA XREF: sub_418114:loc_4186BDo
aGood		db 'good',0             ; DATA XREF: sub_418114:loc_4186C4o
; char aCertificateSta[]
aCertificateSta	db 'certificate status is: %s  (this=%s  next=%s)',0Ah,0
					; DATA XREF: sub_418114+5C7o
aOther_0	db 'other',0            ; DATA XREF: sub_418114+673o
aAaCompromise	db 'AA compromise',0    ; DATA XREF: sub_418114:loc_418795o
aPrivilegeWithd	db 'privilege withdrawn',0 ; DATA XREF: sub_418114:loc_41879Co
aRemovedFromCrl	db 'removed from CRL',0 ; DATA XREF: sub_418114:loc_4187A3o
aCertificateOnH	db 'certificate on hold',0 ; DATA XREF: sub_418114:loc_4187AAo
aCessationOfOpe	db 'cessation of operation',0 ; DATA XREF: sub_418114:loc_4187B1o
aSuperseeded_0	db 'superseeded',0      ; DATA XREF: sub_418114:loc_4187B8o
aAffiliationCha	db 'affiliation changed',0 ; DATA XREF: sub_418114:loc_4187BFo
aCaCompromise	db 'CA compromise',0    ; DATA XREF: sub_418114:loc_4187C6o
aKeyCompromise	db 'key compromise',0   ; DATA XREF: sub_418114:loc_4187CDo
aUnspecified_0	db 'unspecified',0      ; DATA XREF: sub_418114:loc_4187D4o
; char aCertificateHas[]
aCertificateHas	db 'certificate has been revoked at: %s due to: %s',0Ah,0
					; DATA XREF: sub_418114+6D0o
; char aOcspResponderR[]
aOcspResponderR	db 'OCSP responder returned a status in the future',0Ah,0
					; DATA XREF: sub_418114+763o
; char aUsedNowSThis_u[]
aUsedNowSThis_u	db 'used now: %s  this_update: %s',0Ah,0 ; DATA XREF: sub_418114+77Do
					; sub_418114+810o
		align 4
; char aOcspResponde_0[]
aOcspResponde_0	db 'OCSP responder returned a non-current status',0Ah,0
					; DATA XREF: sub_418114:loc_41890Ao
		align 4
; char aOcspResponde_1[]
aOcspResponde_1	db 'OCSP responder returned an too old status',0Ah,0
					; DATA XREF: sub_418114+895o
		align 4
; char aUsedNowSNext_u[]
aUsedNowSNext_u	db 'used now: %s  next_update: %s',0Ah,0 ; DATA XREF: sub_418114+8AFo
aCopy_time_0	db 'copy_time',0        ; DATA XREF: sub_417326:loc_417368o
		align 10h
; char a____Dirmngr1_8[]
a____Dirmngr1_8	db '../../dirmngr-1.1.1/src/estream.c',0 ; DATA XREF: sub_418DF1+1A7o
					; sub_4198CB+2Do ...
		align 4
; char aSizeMem_cookie[]
aSizeMem_cookie	db '!(size > (mem_cookie->memory_size - mem_cookie->offset))',0
					; DATA XREF: sub_418DF1+1AFo
; char aFseekFailedErr[]
aFseekFailedErr	db 0Ah			; DATA XREF: sub_41951D+4Fo
		db 'fseek failed: errno=%d (%s)',0Ah,0
; char aFtellFailedErr[]
aFtellFailedErr	db 0Ah			; DATA XREF: sub_41951D+AAo
		db 'ftell failed: errno=%d (%s)',0Ah,0
aR_2		db 'r',0                ; DATA XREF: .data:off_42B500o
aRb_1		db 'rb',0               ; DATA XREF: .data:0042B508o
aW_1		db 'w',0
aWb		db 'wb',0
aA_0		db 'a',0
aAb		db 'ab',0
aR		db 'r+',0
aRb_2		db 'rb+',0
aRB		db 'r+b',0
aW_2		db 'w+',0
aWb_0		db 'wb+',0
aWB		db 'w+b',0
aA_1		db 'a+',0
aAb_0		db 'ab+',0
aAB		db 'a+b',0
; char aStreamFlags_wr[]
aStreamFlags_wr	db 'stream->flags.writing',0 ; DATA XREF: sub_4198CB+35o
; char aStreamFlags__0[]
aStreamFlags__0	db '!stream->flags.writing',0 ; DATA XREF: sub_419A64+24o
a_estream	db '_estream',0         ; DATA XREF: sub_41C62B+BAo
a_tmp		db '.tmp',0             ; DATA XREF: sub_41C62B+165o
aX02x		db 'x%02x',0            ; DATA XREF: .text:0041CE1Co
		align 4
off_43208C	dd offset loc_41D10F	; DATA XREF: sub_41D0F4+12r
		dd offset loc_41D11E	; jump table for switch	statement
		dd offset loc_41D196
		dd offset loc_41D196
		dd offset loc_41D196
		dd offset loc_41D196
		dd offset loc_41D20E
		dd offset loc_41D20E
		dd offset loc_41D20E
		dd offset loc_41D20E
		dd offset loc_41D20E
		dd offset loc_41D20E
		dd offset loc_41D20E
		dd offset loc_41D20E
		dd offset loc_41D246
		dd offset loc_41D255
		dd offset loc_41D264
		dd offset loc_41D273
		dd offset loc_41D27F
off_4320D8	dd offset loc_41D186	; DATA XREF: sub_41D0F4+35r
		dd offset loc_41D132	; jump table for switch	statement
		dd offset loc_41D13E
		dd offset loc_41D14A
		dd offset loc_41D156
		dd offset loc_41D162
		dd offset loc_41D16E
		dd offset loc_41D17A
off_4320F8	dd offset loc_41D1FE	; DATA XREF: sub_41D0F4+ADr
		dd offset loc_41D1AA	; jump table for switch	statement
		dd offset loc_41D1B6
		dd offset loc_41D1C2
		dd offset loc_41D1CE
		dd offset loc_41D1DA
		dd offset loc_41D1E6
		dd offset loc_41D1F2
off_432118	dd offset loc_41D2E7	; DATA XREF: sub_41D0F4+196r
		dd offset loc_41D293	; jump table for switch	statement
		dd offset loc_41D29F
		dd offset loc_41D2AB
		dd offset loc_41D2B7
		dd offset loc_41D2C3
		dd offset loc_41D2CF
		dd offset loc_41D2DB
off_432138	dd offset loc_41D41A	; DATA XREF: sub_41D2F5+10Ar
		dd offset loc_41D43B	; jump table for switch	statement
		dd offset loc_41D43B
		dd offset loc_41D420
		dd offset loc_41D43B
		dd offset loc_41D43B
		dd offset loc_41D43B
		dd offset loc_41D408
		dd offset loc_41D43B
		dd offset loc_41D43B
		dd offset loc_41D43B
		dd offset loc_41D414
		dd offset loc_41D43B
		dd offset loc_41D40E
		dd offset loc_41D43B
		dd offset loc_41D43B
		dd offset loc_41D426
off_43217C	dd offset loc_41D77B	; DATA XREF: sub_41D2F5+408r
		dd offset loc_41D788	; jump table for switch	statement
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D706
		dd offset loc_41D788
		dd offset loc_41D754
		dd offset loc_41D788
		dd offset loc_41D72D
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D76E
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D788
		dd offset loc_41D761
off_432238	dd offset loc_41D832, offset loc_41D88F, offset	loc_41D85F
					; DATA XREF: sub_41D2F5+4B0r
		dd offset loc_41D88F, offset loc_41D80E, offset	loc_41D7F6 ; jump table	for switch statement
		dd offset loc_41D820, offset loc_41D88F, offset	loc_41D88F
		dd offset loc_41D88F, offset loc_41D88F, offset	loc_41D88F
		dd offset loc_41D88F, offset loc_41D88F, offset	loc_41D88F
		dd offset loc_41D88F, offset loc_41D88F, offset	loc_41D88F
		dd offset loc_41D86F, offset loc_41D88F, offset	loc_41D88F
		dd offset loc_41D88F, offset loc_41D88F, offset	loc_41D7DE
		dd offset loc_41D88F, offset loc_41D88F, offset	loc_41D88F
		dd offset loc_41D88F, offset loc_41D88F, offset	loc_41D88F
		dd offset loc_41D88F, offset loc_41D88F, offset	loc_41D829
		dd offset loc_41D88F, offset loc_41D83B, offset	loc_41D7AE
		dd offset loc_41D802, offset loc_41D7EA, offset	loc_41D817
		dd offset loc_41D88F, offset loc_41D7AE, offset	loc_41D88F
		dd offset loc_41D88F, offset loc_41D88F, offset	loc_41D87F
		dd offset loc_41D856, offset loc_41D7BA, offset	loc_41D84D
		dd offset loc_41D88F, offset loc_41D88F, offset	loc_41D844
		dd offset loc_41D88F, offset loc_41D7C6, offset	loc_41D88F
		dd offset loc_41D88F, offset loc_41D7D2
off_432318	dd offset loc_41DC3B	; DATA XREF: sub_41DA6D+3Fo
		dd offset loc_41DAB5	; jump table for switch	statement
		dd offset loc_41DAE1
		dd offset loc_41DB0D
		dd offset loc_41DB24
		dd offset loc_41DB3C
		dd offset loc_41DB69
		dd offset loc_41DB93
		dd offset loc_41DBA8
		dd offset loc_41DBBD
		dd offset loc_41DC3B
		dd offset loc_41DC3B
		dd offset loc_41DBE1
		dd offset loc_41DC3B
		dd offset loc_41DBF3
		dd offset loc_41DC3B
		dd offset loc_41DC3B
		dd offset loc_41DC17
		dd offset loc_41DC3B
		dd offset loc_41DC05
		dd offset loc_41DACC
		dd offset loc_41DAF8
		dd offset loc_41DB54
		dd offset loc_41DB7E
		dd offset loc_41DBCF
		dd offset loc_41DC3B
		dd offset loc_41DC3B
		dd offset loc_41DC29
byte_432388	db 27h,	0		; DATA XREF: sub_41DCD7+161o
a0123456789ab_1	db '0123456789abcdef',0 ; DATA XREF: sub_41DCD7+254o
a0123456789ab_2	db '0123456789ABCDEF',0 ; DATA XREF: sub_41DCD7:loc_41DF32o
a0x		db '0x',0               ; DATA XREF: sub_41DCD7+416o
a0x_0		db '0X',0               ; DATA XREF: sub_41DCD7:loc_41E0F4o
		align 4
off_4323B4	dd offset loc_41E2A2	; DATA XREF: sub_41E230:loc_41E299r
		dd offset loc_41E2AE
		dd offset loc_41E2BA
		dd offset loc_41E2C6
		dd offset loc_41E2D2
		dd offset loc_41E2DE
		dd offset loc_41E2EA
		dd offset loc_41E2F6
aNull		db '(null)',0           ; DATA XREF: sub_41E629+34o
byte_4323DB	db 30h			; DATA XREF: sub_41E7BE+53r
a123456789abcde	db '123456789abcdefx',0
		align 10h
off_4323F0	dd offset loc_41E8DC	; DATA XREF: sub_41E8B3+20r
		dd offset loc_41E8E8	; jump table for switch	statement
		dd offset loc_41E90D
		dd offset loc_41E8F5
		dd offset loc_41E919
		dd offset loc_41E919
		dd offset loc_41E901
; char a____Dirmngr1_9[]
a____Dirmngr1_9	db '../../dirmngr-1.1.1/src/estream-printf.c',0 ; DATA XREF: sub_41E927+FAo
					; sub_41E927+13Bo ...
; char aArgidxArgspecs[]
aArgidxArgspecs	db 'argidx < argspecs_len',0 ; DATA XREF: sub_41E927+102o
		align 4
; char aValuetableArgW[]
aValuetableArgW	db 'valuetable[arg->width_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_41E927+143o
		align 4
; char aValuetableArgP[]
aValuetableArgP	db 'valuetable[arg->precision_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_41E927+1C3o
		align 10h
; char aArgVtValuetabl[]
aArgVtValuetabl	db 'arg->vt == valuetable[arg->arg_pos-1].vt',0 ; DATA XREF: sub_41E927+24Co
; char aBug[]
aBug		db '!"bug"',0           ; DATA XREF: sub_41E927+29Bo
off_4324E0	dd offset loc_41EBB2	; DATA XREF: sub_41E927+282r
		dd offset loc_41EBD3	; jump table for switch	statement
		dd offset loc_41EBD3
		dd offset loc_41EBD3
		dd offset loc_41EBD3
		dd offset loc_41EBD3
		dd offset loc_41EC09
		dd offset loc_41EC09
		dd offset loc_41EC09
		dd offset loc_41EC09
		dd offset loc_41EC09
		dd offset loc_41EC09
		dd offset loc_41EC09
		dd offset loc_41EC09
		dd offset loc_41EC3F
		dd offset loc_41EC75
		dd offset loc_41ECA8
		dd offset loc_41EC75
		dd offset loc_41ECDB
byte_43252C	db 0			; DATA XREF: sub_41F4A7+5Fo
					; sub_41F6A2+75o
; char aParm_used[]
aParm_used	db 'parm.used',0        ; DATA XREF: sub_41F6A2+FDo
		align 4
a____Dirmngr_10	db '../../dirmngr-1.1.1/src/misc.h',0 ; DATA XREF: sub_41F856+52o
; char a1_3_6_1_5_5__0[]
a1_3_6_1_5_5__0	db '1.3.6.1.5.5.7.3.1',0 ; DATA XREF: sub_4210D2+8Do
; char a1_3_6_1_5_5__1[]
a1_3_6_1_5_5__1	db '1.3.6.1.5.5.7.3.2',0 ; DATA XREF: sub_4210D2:loc_42117Co
; char a1_3_6_1_5_5__2[]
a1_3_6_1_5_5__2	db '1.3.6.1.5.5.7.3.3',0 ; DATA XREF: sub_4210D2:loc_421199o
; char a1_3_6_1_5_5__3[]
a1_3_6_1_5_5__3	db '1.3.6.1.5.5.7.3.4',0 ; DATA XREF: sub_4210D2:loc_4211B6o
; char a1_3_6_1_5_5__4[]
a1_3_6_1_5_5__4	db '1.3.6.1.5.5.7.3.8',0 ; DATA XREF: sub_4210D2:loc_4211D3o
; char a1_3_6_1_5_5__5[]
a1_3_6_1_5_5__5	db '1.3.6.1.5.5.7.3.9',0 ; DATA XREF: sub_4210D2:loc_4211EEo
		align 4
; char aCriticalCertif[]
aCriticalCertif	db 'critical certificate extension %s is not supported',0
					; DATA XREF: sub_41F8CC+CBo
		align 4
; char aCertificateSPo[]
aCertificateSPo	db 'certificate',27h,'s policy list: %s',0Ah,0 ; DATA XREF: sub_41FA19+55o
; char SubStr[]
SubStr		db ':C',0               ; DATA XREF: sub_41FA19+64o
		align 4
; char aNoteNonCritica[]
aNoteNonCritica	db 'note: non-critical certificate policy not allowed',0
					; DATA XREF: sub_41FA19+13Co
		align 10h
; char aCertificatePol[]
aCertificatePol	db 'certificate policy not allowed',0 ; DATA XREF: sub_41FA19:loc_41FB6Ao
		align 10h
; char aAcceptingRootC[]
aAcceptingRootC	db 'accepting root CA not marked as a CA',0 ; DATA XREF: sub_41FB99+5Bo
		align 4
; char aIssuerCertif_1[]
aIssuerCertif_1	db 'issuer certificate is not marked as a CA',0
					; DATA XREF: sub_41FB99:loc_41FC02o
		align 4
; char a____Dirmngr_11[]
a____Dirmngr_11	db '../../dirmngr-1.1.1/src/validate.c',0 ; DATA XREF: sub_41FC23+34o
					; sub_41FC23+56o ...
		align 4
; char aCtrlCheck_revo[]
aCtrlCheck_revo	db 'ctrl->check_revocations_nest_level >= 0',0 ; DATA XREF: sub_41FC23+3Co
; char aChain[]
aChain		db 'chain',0            ; DATA XREF: sub_41FC23+5Eo
		align 4
; char aCrlCheckingToo[]
aCrlCheckingToo	db 'CRL checking too deeply nested',0Ah,0 ; DATA XREF: sub_41FC23+75o
; char aCiCert[]
aCiCert		db 'ci->cert',0         ; DATA XREF: sub_41FC23+C6o
aNotCheckingCrl	db 'not checking CRL for',0 ; DATA XREF: sub_41FC23+F1o
aCheckingCrlFor	db 'checking CRL for',0 ; DATA XREF: sub_41FC23+115o
		align 4
; char aErrorGetting_0[]
aErrorGetting_0	db 'error getting authorityKeyIdentifier: %s',0Ah,0
					; DATA XREF: sub_41FE8D+9Co
; char aErrorGettingSe[]
aErrorGettingSe	db 'error getting serialno: %s',0Ah,0 ; DATA XREF: sub_41FE8D+D5o
		align 10h
; char aRunningInCompa[]
aRunningInCompa	db 'running in compatibility mode - certificate chain not checked!',0Ah,0
					; DATA XREF: sub_420043+62o
aSubject_2	db 'subject',0          ; DATA XREF: sub_420043+8Bo
aValidated_at_0	db 'validated_at',0     ; DATA XREF: sub_420043+FBo
					; sub_420043+948o
; char aCertificateIsG[]
aCertificateIsG	db 'certificate is good (cached)',0Ah,0 ; DATA XREF: sub_420043+14Ao
		align 4
; char aNoIssuerFoun_0[]
aNoIssuerFoun_0	db 'no issuer found in certificate',0Ah,0 ; DATA XREF: sub_420043+1CEo
; char aCertificateWit[]
aCertificateWit	db 'certificate with invalid validity: %s',0 ; DATA XREF: sub_420043+246o
; char aCertificateNot[]
aCertificateNot	db 'certificate not yet valid',0 ; DATA XREF: sub_420043+2DCo
; char aValidFrom[]
aValidFrom	db '(valid from ',0     ; DATA XREF: sub_420043+2E8o
; char asc_432891[]
asc_432891	db ')',0Ah,0            ; DATA XREF: sub_420043+2FFo
					; sub_420043+369o
; char aCertificateH_0[]
aCertificateH_0	db 'certificate has expired',0 ; DATA XREF: sub_420043+343o
; char aExpiredAt[]
aExpiredAt	db '(expired at ',0     ; DATA XREF: sub_420043+34Fo
		align 4
; char aSelfsignedCert[]
aSelfsignedCert	db 'selfsigned certificate has a BAD signature',0
					; DATA XREF: sub_420043+403o
		align 4
; char aRootCertificat[]
aRootCertificat	db 'root certificate is not marked trusted',0 ; DATA XREF: sub_420043+479o
a?_4		db '?',0                ; DATA XREF: sub_420043:loc_4204E1o
					; sub_420BAC:loc_420BDFo
; char aFingerprintS[]
aFingerprintS	db 'fingerprint=%s',0Ah,0 ; DATA XREF: sub_420043+4A7o
aIssuer_1	db 'issuer',0           ; DATA XREF: sub_420043+4BAo
					; sub_420043+6A9o
; char aCheckingTrustw[]
aCheckingTrustw	db 'checking trustworthiness of root certificate failed: %s',0Ah,0
					; DATA XREF: sub_420043+4F9o
		align 4
; char aRootCertific_0[]
aRootCertific_0	db 'root certificate is good but not trusted',0Ah,0
					; DATA XREF: sub_420043+598o
		align 10h
; char aRootCertific_1[]
aRootCertific_1	db 'root certificate is good and trusted',0Ah,0
					; DATA XREF: sub_420043:loc_4205ECo
; char aCertificateCha[]
aCertificateCha	db 'certificate chain too long',0Ah,0 ; DATA XREF: sub_420043+5C6o
; char aIssuerCertif_2[]
aIssuerCertif_2	db 'issuer certificate not found',0 ; DATA XREF: sub_420043+62Ao
; char aIssuerCertif_3[]
aIssuerCertif_3	db 'issuer certificate: #/',0 ; DATA XREF: sub_420043+636o
; char asc_432A06[]
asc_432A06	db 0Ah,0		; DATA XREF: sub_420043+64Do
					; sub_420BAC+249o
; char aIssuerCertif_4[]
aIssuerCertif_4	db 'issuer certificate not found: %s',0Ah,0 ; DATA XREF: sub_420043+66Ao
; char aGotIssuerSCert[]
aGotIssuerSCert	db 'got issuer',27h,'s certificate:',0Ah,0 ; DATA XREF: sub_420043+696o
		align 4
; char aCertificateH_1[]
aCertificateH_1	db 'certificate has a BAD signature',0 ; DATA XREF: sub_420043+6D0o
; char aCertificateC_0[]
aCertificateC_0	db 'certificate chain longer than allowed by CA (%d)',0
					; DATA XREF: sub_420043+736o
; char aCertificateI_0[]
aCertificateI_0	db 'certificate is good',0Ah,0 ; DATA XREF: sub_420043+7E4o
; char aCertificateC_1[]
aCertificateC_1	db 'certificate chain is good',0Ah,0 ; DATA XREF: sub_420043+844o
aCertificate_0	db '  certificate',0    ; DATA XREF: sub_420043+862o
		align 4
; char aTargetCertific[]
aTargetCertific	db 'target certificate may be valid',0Ah,0 ; DATA XREF: sub_420043+8BBo
; char aTargetCertif_0[]
aTargetCertif_0	db 'target certificate is valid',0Ah,0 ; DATA XREF: sub_420043:loc_42090Co
		align 4
; char aTargetCertif_1[]
aTargetCertif_1	db 'target certificate is NOT valid',0Ah,0 ; DATA XREF: sub_420043+8E6o
		align 4
; char aSet_user_dat_0[]
aSet_user_dat_0	db 'set_user_data(validated_at) failed: %s',0Ah,0
					; DATA XREF: sub_420043+970o
aPublicKey	db 'public-key',0       ; DATA XREF: sub_420A89+Eo
aRsa		db 'rsa',0              ; DATA XREF: sub_420A89+8Co
aDsa		db 'dsa',0              ; DATA XREF: sub_420A89+BCo
aAmbiguousRsa	db 'ambiguous-rsa',0    ; DATA XREF: sub_420A89+ECo
; char aUnknownHashA_0[]
aUnknownHashA_0	db 'unknown hash algorithm `%s',27h,0Ah,0 ; DATA XREF: sub_420BAC+3Co
; char aMd_openFailedS[]
aMd_openFailedS	db 'md_open failed: %s',0Ah,0 ; DATA XREF: sub_420BAC+E2o
aHash_cert_0	db 'hash.cert',0        ; DATA XREF: sub_420BAC+107o
; char aKsba_cert_hash[]
aKsba_cert_hash	db 'ksba_cert_hash failed: %s',0Ah,0 ; DATA XREF: sub_420BAC+151o
		align 4
; char aLibksbaDidNotR[]
aLibksbaDidNotR	db 'libksba did not return a proper S-Exp',0Ah,0
					; DATA XREF: sub_420BAC+1CDo
					; sub_420BAC+2F2o
; char aSignatureValue[]
aSignatureValue	db 'signature value:',0 ; DATA XREF: sub_420BAC+20Co
; char a02x_4[]
a02x_4		db ' %02X',0            ; DATA XREF: sub_420BAC+231o
; char aGcry_sexp_scan[]
aGcry_sexp_scan	db 'gcry_sexp_scan failed: %s',0Ah,0 ; DATA XREF: sub_420BAC+299o
					; sub_420BAC+374o
		align 4
; char aDsaRequiresThe[]
aDsaRequiresThe	db 'DSA requires the use of a 160 bit hash algorithm',0Ah,0
					; DATA XREF: sub_420BAC+3DBo
aDataFlagsRawVa	db '(data(flags raw)(value %b))',0 ; DATA XREF: sub_420BAC+427o
		align 4
aDataFlagsPkc_1	db '(data(flags pkcs1)(hash %s %b))',0 ; DATA XREF: sub_420BAC+477o
; char aGcry_pk_veri_0[]
aGcry_pk_veri_0	db 'gcry_pk_verify: %s',0Ah,0 ; DATA XREF: sub_420BAC+4E9o
; char aNoKeyUsageSpec[]
aNoKeyUsageSpec	db 'no key usage specified - assuming all usages',0Ah,0
					; DATA XREF: sub_4210D2+1DAo
		align 4
; char aErrorGettingKe[]
aErrorGettingKe	db 'error getting key usage information: %s',0Ah,0
					; DATA XREF: sub_4210D2+20Bo
		align 4
; char aCertificateSho[]
aCertificateSho	db 'certificate should have not been used for certification',0Ah,0
					; DATA XREF: sub_4210D2:loc_421316o
		align 4
; char aCertificateS_0[]
aCertificateS_0	db 'certificate should have not been used for OCSP response signing',0Ah
					; DATA XREF: sub_4210D2:loc_42135Bo
		db 0
		align 4
; char aCertificateS_1[]
aCertificateS_1	db 'certificate should have not been used for CRL signing',0Ah,0
					; DATA XREF: sub_4210D2:loc_421392o
		align 10h
; char aCertificateIsN[]
aCertificateIsN	db 'certificate is not usable for encryption',0Ah,0
					; DATA XREF: sub_4210D2+312o
		align 4
aCertificateI_1	db 'certificate is not usable for signing',0Ah,0
					; DATA XREF: sub_4210D2:loc_4213EBo
		align 4
aCertificateS_2	db 'certificate should have not been used for signing',0Ah,0
					; DATA XREF: sub_4210D2:loc_4213F2o
		align 4
aCertificateS_3	db 'certificate should have not been used for encryption',0Ah,0
					; DATA XREF: sub_4210D2:loc_4213F9o
aCheck_cert_sig	db 'check_cert_sig',0   ; DATA XREF: sub_420BAC+446o
					; sub_420BAC+496o
aCopy_time_1	db 'copy_time',0        ; DATA XREF: sub_41F856:loc_41F898o
a2_289_9_9	db '2.289.9.9',0        ; DATA XREF: .data:off_42B580o
a2_5_29_15	db '2.5.29.15',0        ; DATA XREF: .data:off_42B588o
a2_5_29_19	db '2.5.29.19',0        ; DATA XREF: .data:0042B58Co
a2_5_29_32	db '2.5.29.32',0        ; DATA XREF: .data:0042B590o
a2_5_29_37	db '2.5.29.37',0        ; DATA XREF: .data:0042B594o
		align 4
; char asc_432EDC[4]
asc_432EDC	db ' ',9,0Ah,0Bh        ; DATA XREF: sub_4214BF:loc_4214EAo
		db 0Ch,	22h, 0
; char aErrorCreatingA[]
aErrorCreatingA	db 'error creating a pipe: %s',0Ah,0 ; DATA XREF: sub_4216D5+A8o
					; sub_4216D5+FFo
; CHAR FileName[]
FileName	db 'nul',0              ; DATA XREF: sub_4216D5+192o
; char aErrorOpeningNu[]
aErrorOpeningNu	db 'error opening nul: %s',0Ah,0 ; DATA XREF: sub_4216D5+1CEo
		align 4
; char aCreateprocessP[]
aCreateprocessP	db 'CreateProcess, path=`%s',27h,' cmdline=`%s',27h,0Ah,0
					; DATA XREF: sub_4216D5+2C0o
; char aCreateprocessF[]
aCreateprocessF	db 'CreateProcess failed: %s',0Ah,0 ; DATA XREF: sub_4216D5+336o
		align 10h
; char aCreateprocessR[]
aCreateprocessR	db 'CreateProcess ready: hProcess=%p hThread=%p dwProcessID=%d dwThre'
					; DATA XREF: sub_4216D5+419o
		db 'adId=%d',0Ah,0
		align 4
; char aWaitingForProc[]
aWaitingForProc	db 'waiting for process %d to terminate failed: %s',0Ah,0
					; DATA XREF: sub_421B43+90o
; char aErrorGettingEx[]
aErrorGettingEx	db 'error getting exit code of process %d: %s',0Ah,0
					; DATA XREF: sub_421B43+DAo
byte_433007	db 0			; DATA XREF: sub_421B43+105o
; char aErrorDetectedE[]
aErrorDetectedE	db 'error detected: exit status %d%s',0Ah,0 ; DATA XREF: sub_421B43+111o
		align 4
; char aWaitforsingleo[]
aWaitforsingleo	db 'WaitForSingleObject returned unexpected code %d for pid %d',0Ah,0
					; DATA XREF: sub_421B43+134o
aHkey_classes_r	db 'HKEY_CLASSES_ROOT',0 ; DATA XREF: sub_421D55+26o
aHkey_current_u	db 'HKEY_CURRENT_USER',0 ; DATA XREF: sub_421D55+5Ao
aHkey_local_mac	db 'HKEY_LOCAL_MACHINE',0 ; DATA XREF: sub_421D55+8Eo
aHkey_users	db 'HKEY_USERS',0       ; DATA XREF: sub_421D55+C2o
aHkey_performan	db 'HKEY_PERFORMANCE_DATA',0 ; DATA XREF: sub_421D55+F3o
aHkey_current_c	db 'HKEY_CURRENT_CONFIG',0 ; DATA XREF: sub_421D55+124o
; CHAR aShgetfolderpat[]
aShgetfolderpat	db 'SHGetFolderPathA',0 ; DATA XREF: sub_42223E+50o
aDirmngr_ldap_e	db '\dirmngr_ldap.exe',0 ; DATA XREF: sub_422318+1Do
		align 4
aHomeIntevation	db '/home/intevation/gpg4win/src/playground/install/pkgs/dirmngr-1.1.'
					; DATA XREF: sub_422318+A9o
		db '1/libexec/dirmngr_ldap',0
aGnupg		db '\gnupg',0           ; DATA XREF: sub_4223D7+84o
aCGnupg		db 'c:/gnupg',0         ; DATA XREF: sub_4223D7:loc_4224C5o
					; sub_4224DB:loc_422597o
; char aGnupghome[]
aGnupghome	db 'GNUPGHOME',0        ; DATA XREF: sub_4224DB+6o
; CHAR ValueName[]
ValueName	db 'HomeDir',0          ; DATA XREF: sub_4224DB:loc_42251Do
; CHAR aSoftwareGnuGnu[]
aSoftwareGnuGnu	db 'Software\GNU\GnuPG',0 ; DATA XREF: sub_4224DB+4Ao
; char aGetmodulefilen[]
aGetmodulefilen	db 'GetModuleFileName failed: %s',0Ah,0 ; DATA XREF: sub_4225A3+48o
		align 4
; char aBadFilenameSRe[]
aBadFilenameSRe	db 'bad filename `%s',27h,' returned for this process',0Ah,0
					; DATA XREF: sub_4225A3+92o
		align 4
aHomeIntevati_0	db '/home/intevation/gpg4win/src/playground/install/pkgs/dirmngr-1.1.'
					; DATA XREF: sub_4225A3:loc_42265Ao
		db '1/libexec',0
aGnu		db '\GNU',0             ; DATA XREF: sub_422661+80o
aEtcDirmngr	db '\etc\dirmngr',0     ; DATA XREF: sub_422731+1Do
aLibDirmngr	db '\lib\dirmngr',0     ; DATA XREF: sub_4227E1+1Do
aGnu_0		db 'GNU',0              ; DATA XREF: sub_422884+17o
aCache		db 'cache',0            ; DATA XREF: sub_422884+1Eo
aDirmngr_1	db 'dirmngr',0          ; DATA XREF: sub_422884+25o
aCTempCacheDirm	db 'c:\temp\cache\dirmngr',0 ; DATA XREF: sub_422884:loc_4229FFo
aCWindows	db 'C:\WINDOWS',0       ; DATA XREF: sub_422A13+4Ao
aS_dirmngr	db '\S.dirmngr',0       ; DATA XREF: sub_422A13:loc_422A81o
aShell32_dll	db 'shell32.dll',0      ; DATA XREF: .data:off_42B59Co
aShfolder_dll	db 'shfolder.dll',0     ; DATA XREF: .data:0042B5A0o
		align 4
asc_433298	db '-',0                ; DATA XREF: sub_422B51+13o
					; sub_422DEE:loc_422DFFo
aSocket		db 'socket://',0        ; DATA XREF: sub_422B51+5Bo
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_422B51+BBo
; char aA[]
aA		db 'a',0                ; DATA XREF: sub_422B51+EFo
					; sub_422B51:loc_422C7Fo
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_422B51+1B7o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_422B51+1EFo
		align 4
; char a____Dirmngr_12[]
a____Dirmngr_12	db '../../dirmngr-1.1.1/jnlib/logging.c',0 ; DATA XREF: sub_422FB0+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_422FB0+37o
		align 4
; char a04d02d02d02d02[]
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_422FB0+E3o
; char aU_D[]
aU_D		db '[%u.%d]',0          ; DATA XREF: sub_422FB0+178o
; char aU_2[]
aU_2		db '[%u]',0             ; DATA XREF: sub_422FB0:loc_42314Bo
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_422FB0+229o
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_422FB0+252o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_422FB0+27Bo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_422FB0:loc_42324Eo
		align 4
off_4333C8	dd offset loc_42326D	; DATA XREF: sub_422FB0+21Ao
		dd offset loc_42326D	; jump table for switch	statement
		dd offset loc_42326D
		dd offset loc_42326D
		dd offset loc_42326D
		dd offset loc_4231D3
		dd offset loc_4231FC
		dd offset loc_423225
; char dword_4333E8[]
dword_4333E8	dd 207325h		; DATA XREF: sub_4234A8+1Do
; char a02x_5[]
a02x_5		db '%02X',0             ; DATA XREF: sub_4234A8+42o
; char a02x_6[]
a02x_6		db ' %02X',0            ; DATA XREF: sub_4234A8+65o
; char asc_4333F7[]
asc_4333F7	db 0Ah,0		; DATA XREF: sub_4234A8+8Ao
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_423540+1Bo
		align 4
; char aInvalidArgumen[]
aInvalidArgumen	db 'Invalid argument for ArgParse',0Ah,0 ; DATA XREF: sub_4238BC+77o
aArgumentNotExp	db 'argument not expected',0Ah,0 ; DATA XREF: sub_4238BC+A6o
aReadError	db 'read error',0Ah,0   ; DATA XREF: sub_4238BC+BAo
aKeywordTooLong	db 'keyword too long',0Ah,0 ; DATA XREF: sub_4238BC+CEo
aMissingArgumen	db 'missing argument',0Ah,0 ; DATA XREF: sub_4238BC+E2o
aInvalidCommand	db 'invalid command',0Ah,0 ; DATA XREF: sub_4238BC+F6o
aInvalidAliasDe	db 'invalid alias definition',0Ah,0 ; DATA XREF: sub_4238BC+10Ao
aInvalidOption	db 'invalid option',0Ah,0 ; DATA XREF: sub_4238BC:loc_4239CFo
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_4238BC+131o
a??		db '[??]',0             ; DATA XREF: sub_4238BC:loc_423A10o
		align 4
; char aMissingArgum_0[]
aMissingArgum_0	db 'Missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_4238BC+16Eo
		align 4
; char aOption_50sDoes[]
aOption_50sDoes	db 'Option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_4238BC+191o
; char aInvalidComma_0[]
aInvalidComma_0	db 'Invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_4238BC+1B1o
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'Option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_4238BC+1D1o
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'Command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_4238BC+1F1o
; char aInvalidOption_[]
aInvalidOption_	db 'Invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_4238BC+206o
; char asc_43358C[]
asc_43358C	db ' ',9,0              ; DATA XREF: sub_423B0A+270o
; char aAlias[]
aAlias		db 'alias',0            ; DATA XREF: sub_423B0A+530o
; char aHelp[]
aHelp		db 'help',0             ; DATA XREF: sub_42435A+1A6o
; char aVersion[]
aVersion	db 'version',0          ; DATA XREF: sub_42435A+1E0o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_42435A+222o
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_42435A+266o
; char aS_4[]
aS_4		db '--%s',0Ah,0         ; DATA XREF: sub_42435A+29Bo
		align 10h
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_42435A+2C7o
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_4335EC	db 'x',0                ; DATA XREF: sub_42435A:loc_424A3Do
; char aOptions[]
aOptions	db 'Options:',0         ; DATA XREF: sub_424C69+CEo
; char aC_0[]
aC_0		db ' -%c',0             ; DATA XREF: sub_424C69+1A9o
asc_4335FC	db '   ',0              ; DATA XREF: sub_424C69+23Do
					; sub_424C69+32Ao
; char aCS[]
aCS		db '%c --%s',0          ; DATA XREF: sub_424C69:loc_424F05o
; char aASingleDashMay[]
aASingleDashMay	db 0Ah			; DATA XREF: sub_424C69+454o
		db '(A single dash may be used instead of the double ones)',0
; char a_email_[]
a@email@	db '@EMAIL@',0          ; DATA XREF: sub_424C69+485o
aBugDirmngr@g_0	db 'bug-dirmngr@gnupg.org',0 ; DATA XREF: sub_424C69+4E8o
; char aS_5[]
aS_5		db ' (%s)',0            ; DATA XREF: sub_4251CC+3Co
; char aS_6[]
aS_6		db ' %s',0Ah,0          ; DATA XREF: sub_4251CC+5Co
aSSS_0		db '%s %s; %s',0Ah,0    ; DATA XREF: .text:0042538Do
aLicenseGplv3Gn	db 'License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licens'
					; DATA XREF: sub_425424:loc_42546Ao
		db 'es/gpl.html>',0
aFoo		db 'foo',0              ; DATA XREF: sub_425424:loc_425473o
a0_0		db '0.0',0              ; DATA XREF: sub_425424:loc_42547Co
		align 4
aCopyrightC2010	db 'Copyright (C) 2010 Free Software Foundation, Inc.',0
					; DATA XREF: sub_425424:loc_425485o
		align 10h
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_425424:loc_42548Eo
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 4
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_425424:loc_425497o
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 3 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_4339D0	dd 0			; DATA XREF: sub_425424:loc_4254A0o
off_4339D4	dd offset loc_42546A	; DATA XREF: sub_425424+3Dr
		dd offset loc_425473	; jump table for switch	statement
		dd offset loc_4254A8
		dd offset loc_42547C
		dd offset loc_425485
		dd offset loc_42548E
		dd offset loc_425497
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A8
		dd offset loc_4254A0
		dd offset loc_4254A0
asc_433A54	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:00425862o
					; .text:004258FAo
a__1		db '.',0                ; DATA XREF: .text:00425977o
; char aHome[]
aHome		db 'HOME',0             ; DATA XREF: sub_4259CC+91o
; char aX02x_0[]
aX02x_0		db 'x%02x',0            ; DATA XREF: sub_425C53+16Eo
					; .text:004261C1o
		align 4
; char aEcLu[]
aEcLu		db 'ec=%lu',0           ; DATA XREF: sub_42696B+Do
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_426AD4+C6o
					; .text:loc_426D9Eo ...
; CHAR aIconv_dll[]
aIconv_dll	db 'iconv.dll',0        ; DATA XREF: sub_4269C2+25o
					; sub_4269C2+ACo
; CHAR aLibiconv_open[]
aLibiconv_open	db 'libiconv_open',0    ; DATA XREF: sub_4269C2+3Ao
; CHAR aLibiconv[]
aLibiconv	db 'libiconv',0         ; DATA XREF: sub_4269C2+5Bo
; CHAR aLibiconv_close[]
aLibiconv_close	db 'libiconv_close',0   ; DATA XREF: sub_4269C2+7Co
; char aErrorLoadingSS[]
aErrorLoadingSS	db 'error loading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4269C2+B4o
		align 4
; char aPleaseSeeHttpW[]
aPleaseSeeHttpW	db 'please see http://www.gnupg.org/download/iconv.html for more info'
					; DATA XREF: sub_4269C2+C0o
		db 'rmation',0Ah,0
aUtf8		db 'utf-8',0            ; DATA XREF: sub_426AD4+21o
					; .text:00426DE2o ...
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_426AD4+7Eo
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_426AD4+AAo
aCpU		db 'CP%u',0             ; DATA XREF: .text:loc_426BF4o
aCp936		db 'CP936',0            ; DATA XREF: .text:00426C17o
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: .text:00426D05o
a88591		db '8859-1',0           ; DATA XREF: .text:00426D42o
a646		db '646',0              ; DATA XREF: .text:00426D59o
aAscii		db 'ASCII',0            ; DATA XREF: .text:00426D70o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: .text:00426D87o
aUtf8_0		db 'utf8',0             ; DATA XREF: .text:loc_426DCBo
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_426F2A+213o
					; sub_427186+74Bo
; char aX02x_1[]
aX02x_1		db '\x%02x',0           ; DATA XREF: sub_427186+7Do
					; sub_427186+3B0o ...
; char aX02x_2[]
aX02x_2		db 'x%02x',0            ; DATA XREF: sub_427186+1DDo
		align 10h
a____Dirmngr_13	db '../../dirmngr-1.1.1/jnlib/utf8conv.c',0 ; DATA XREF: sub_427186+6C5o
		align 4
off_433CF8	dd offset loc_42733A	; DATA XREF: sub_427186+12Br
		dd offset loc_427350	; jump table for switch	statement
		dd offset loc_427350
		dd offset loc_427350
		dd offset loc_427350
		dd offset loc_427350
		dd offset loc_427350
		dd offset loc_427350
		dd offset loc_427324
		dd offset loc_427350
		dd offset loc_4272BA
		dd offset loc_42730E
		dd offset loc_4272F4
		dd offset loc_4272D7
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_427186+6B5o
		align 4
; char a0[]
a0		db '-+ #0',0            ; DATA XREF: sub_427A24+71o
; char aHll[]
aHll		db 'hlL',0              ; DATA XREF: sub_427A24+14Bo
		align 10h
off_433D50	dd offset loc_427BA8, offset loc_427C07, offset	loc_427BA8
					; DATA XREF: sub_427A24+170r
		dd offset loc_427C07, offset loc_427C07, offset	loc_427C07 ; jump table	for switch statement
		dd offset loc_427C07, offset loc_427C07, offset	loc_427C07
		dd offset loc_427C07, offset loc_427C07, offset	loc_427C07
		dd offset loc_427C07, offset loc_427C07, offset	loc_427C07
		dd offset loc_427C07, offset loc_427C07, offset	loc_427C07
		dd offset loc_427C07, offset loc_427B9D, offset	loc_427C07
		dd offset loc_427C07, offset loc_427C07, offset	loc_427C07
		dd offset loc_427C07, offset loc_427C07, offset	loc_427C07
		dd offset loc_427C07, offset loc_427C07, offset	loc_427C07
		dd offset loc_427B9D, offset loc_427B9D, offset	loc_427BA8
		dd offset loc_427BA8, offset loc_427BA8, offset	loc_427C07
		dd offset loc_427B9D, offset loc_427C07, offset	loc_427C07
		dd offset loc_427C07, offset loc_427C07, offset	loc_427BFD
		dd offset loc_427B9D, offset loc_427BFD, offset	loc_427C07
		dd offset loc_427C07, offset loc_427BBA, offset	loc_427C07
		dd offset loc_427B9D, offset loc_427C07, offset	loc_427C07
		dd offset loc_427B9D
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_433E5C	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_4286D0+3o
		align 10h
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_4286D0+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_433F7Co
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:00433F80o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:00433F84o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:00433F88o
		align 10h
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:00433F8Co
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:00433F90o
		align 4
off_433F7C	dd offset aArgumentDomain ; DATA XREF: sub_4286D0+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_428740+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_4287A0+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_4287A0+1F9o
					; sub_4287A0+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_4287A0+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_4289E0+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_4289E0+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_428F90:loc_429030o
		unicode	0, <msvcrt.dll>,0
		align 4
off_4340A4	dd offset dword_435EE0	; DATA XREF: .text:00429228o
		dd offset dword_435C00
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_4295A0+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_7[]
aS_7		db '%s',0Ah,0           ; DATA XREF: sub_4295A0+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_4295A0+10Fo
		align 4
dword_43410C	dd 0			; DATA XREF: sub_4289E0+59o
					; sub_4289E0+5Eo ...
dword_434110	dd 0			; DATA XREF: sub_4289E0+7Fr
dword_434114	dd 0			; DATA XREF: sub_4289E0:loc_428B2Cr
dword_434118	dd 3Ah dup(0)		; DATA XREF: sub_4289E0+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00035000)
; Virtual size			: 00001074 (   4212.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 435000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_435000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_435004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_435008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_43500C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_435010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_435014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_435018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_43501C	dd ?			; DATA XREF: sub_401010+3Aw
; char *Filename
Filename	dd ?			; DATA XREF: sub_4020C2+334w
					; sub_4020C2+846w ...
dword_435024	dd 5 dup(?)		; DATA XREF: sub_4020C2+CDCo
					; sub_403FB2+12o
dword_435038	dd ?			; DATA XREF: sub_4020C2:loc_402E23w
					; sub_403566+2Er ...
; char *Str1
Str1		dd ?			; DATA XREF: sub_401BC6:loc_401EAEr
					; sub_401BC6+301r ...
; char *Str
Str		dd ?			; DATA XREF: sub_40180A+8r
					; sub_40180A+11r ...
dword_435044	dd ?			; DATA XREF: HandlerProc+37w
					; HandlerProc+67w ...
dword_435048	dd ?			; DATA XREF: sub_403FB2:loc_403FE2r
					; sub_403FB2+38w ...
dword_43504C	dd ?			; DATA XREF: sub_401AE7+6r
					; sub_401AE7+13w
dword_435050	dd ?			; DATA XREF: sub_406A20+1Cr
					; sub_406A20+2Bw ...
; char *dword_435054
dword_435054	dd ?			; DATA XREF: sub_406596:loc_406729r
					; sub_406596+20Ew ...
dword_435058	dd ?			; DATA XREF: sub_406BB9+6r
					; sub_406BB9:loc_406BD4r ...
		align 10h
dword_435060	dd ?			; DATA XREF: sub_40B7B2+12r
					; sub_40B7B2+23w ...
dword_435064	dd ?			; DATA XREF: sub_40B7B2+30w
					; sub_40B80F+28r ...
		align 200h
dword_435200	dd ?			; DATA XREF: sub_40C9C5+97r
					; sub_40C9C5+171r ...
		dd 0FFh	dup(?)
dword_435600	dd ?			; DATA XREF: sub_40C547+6o
					; sub_40C580+1Eo ...
dword_435604	dd ?			; DATA XREF: sub_40D0E6+6r
					; sub_40D0E6+99w ...
; char dword_435608[]
dword_435608	dd ?			; DATA XREF: sub_40C9C5+34Cr
					; sub_40C9C5+354w ...
; char dword_43560C[]
dword_43560C	dd ?			; DATA XREF: sub_40C9C5+21r
					; sub_40C9C5+E4r ...
dword_435610	dd ?			; DATA XREF: sub_40C9C5+58r
					; sub_40C9C5:loc_40CA45r ...
		align 10h
dword_435620	dd ?			; DATA XREF: sub_411148:loc_4111BBr
					; sub_411148:loc_4112C1r ...
dword_435624	dd ?			; DATA XREF: sub_411148:loc_411549r
					; sub_411599+6w
		align 20h
dword_435640	dd ?			; DATA XREF: sub_413121+6r
					; sub_413121+B4w
		align 20h
; struct WSAData stru_435660
stru_435660	WSAData	<?>		; DATA XREF: sub_413121+13o
					; sub_413121:loc_41316Ar ...
		align 20h
dword_435800	dd ?			; DATA XREF: sub_4158E6+2Dr
					; sub_4158E6+41r ...
dword_435804	dd ?			; DATA XREF: sub_4158E6+15r
					; sub_4158E6:loc_415909r ...
dword_435808	dd ?			; DATA XREF: sub_418AE3+48r
					; sub_418AE3+57o ...
dword_43580C	dd ?			; DATA XREF: sub_418AE3+34o
					; sub_418AE3+7Do ...
dword_435810	dd ?			; DATA XREF: sub_418C62+6r
					; sub_418C62+3Dw
		align 10h
dword_435820	dd ?			; DATA XREF: sub_422A13+Br
					; sub_422A13+CFw ...
dword_435824	dd ?			; DATA XREF: sub_422884+Ar
					; sub_422884+174w ...
dword_435828	dd ?			; DATA XREF: sub_4227E1+8r
					; sub_4227E1+6Fw ...
dword_43582C	dd ?			; DATA XREF: sub_422731+8r
					; sub_422731+6Fw ...
dword_435830	dd ?			; DATA XREF: sub_422661+Br
					; sub_422661+A8w ...
dword_435834	dd ?			; DATA XREF: sub_4225A3+6r
					; sub_4225A3:loc_4225FEw
		align 10h
; CHAR byte_435840
byte_435840	db ?			; DATA XREF: sub_4225A3+1Bo
					; sub_4225A3+54w ...
		align 4
		dd 42h dup(?)
dword_43594C	dd ?			; DATA XREF: sub_4224DB:loc_422504r
					; sub_4224DB+8Cw ...
; LPCSTR lpPathName
lpPathName	dd ?			; DATA XREF: sub_4223D7+Br
					; sub_4223D7+B4w ...
dword_435954	dd ?			; DATA XREF: sub_422318+8r
					; sub_422318+6Fw ...
dword_435958	dd ?			; DATA XREF: sub_42223E+6r
					; sub_42223E+13w
dword_43595C	dd ?			; DATA XREF: sub_42223E+63w
					; sub_42223E+68r ...
; FILE *File
File		dd ?			; DATA XREF: sub_422B51+154r
					; sub_422B51+165r ...
		align 20h
; char Dest[79]
Dest		db 4Fh dup(?)		; DATA XREF: sub_422E3E+1Bo
					; sub_422E9C:loc_422F0Eo ...
byte_4359CF	db ?			; DATA XREF: sub_422E3E+27w
dword_4359D0	dd ?			; DATA XREF: sub_422E3E+3Fw
					; sub_422E9C:loc_422EC6r ...
dword_4359D4	dd ?			; DATA XREF: sub_422E3E+34w
					; sub_422E9C+12r ...
dword_4359D8	dd ?			; DATA XREF: sub_422E3E+4Aw
					; sub_422E9C:loc_422EDEr ...
dword_4359DC	dd ?			; DATA XREF: .text:00422E37w
					; sub_422FB0+15Ar ...
dword_4359E0	dd ?			; DATA XREF: sub_422E3E+57w
					; sub_422E9C:loc_422EF6r
dword_4359E4	dd ?			; DATA XREF: sub_422B51+287w
					; sub_422FB0+88r ...
dword_4359E8	dd ?			; DATA XREF: sub_422B51+28Cw
					; sub_422FB0:loc_422FF3r ...
dword_4359EC	dd ?			; DATA XREF: sub_422B1C+6r
					; sub_422B1C+14w ...
		align 20h
dword_435A00	dd ?			; DATA XREF: sub_425424+6r
					; sub_425424+Fr ...
		align 20h
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_426248+29o
					; sub_426248+56o
dword_435B20	dd ?			; DATA XREF: sub_426AD4+DAw
					; .text:00426DB2w ...
dword_435B24	dd ?			; DATA XREF: sub_426AD4+D0w
					; .text:00426DA8w ...
dword_435B28	dd ?			; DATA XREF: sub_426AD4+E4w
					; .text:00426DBCw ...
dword_435B2C	dd ?			; DATA XREF: sub_4269C2+4Dw
					; sub_4269C2+52r ...
dword_435B30	dd ?			; DATA XREF: sub_4269C2+6Ew
					; sub_4269C2:loc_426A35r ...
dword_435B34	dd ?			; DATA XREF: sub_4269C2+8Fw
					; sub_4269C2+9Ar ...
dword_435B38	dd ?			; DATA XREF: sub_427186+71Br
					; sub_427186:loc_4278DDw
dword_435B3C	dd ?			; DATA XREF: sub_426F2A+1E3r
					; sub_426F2A:loc_427149w
dword_435B40	dd 8 dup(?)		; DATA XREF: .text:00426C04o
					; .text:00426C10o ...
dword_435B60	dd ?			; DATA XREF: sub_426AD4+44r
					; sub_426AD4+4Cw
dword_435B64	dd ?			; DATA XREF: sub_426AD4:loc_426B2Cr
					; sub_426AD4+60w
dword_435B68	dd ?			; DATA XREF: sub_426AD4:loc_426B60r
					; sub_426AD4:loc_426B8Aw
dword_435B6C	dd ?			; DATA XREF: sub_4269C2+6r
					; sub_4269C2+13w
		align 20h
; char byte_435B80[52]
byte_435B80	db 34h dup(?)		; DATA XREF: sub_42696B+1Ao
					; sub_42696B+26o
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_435BBC	dd ?			; DATA XREF: sub_401060+2Cw
dword_435BC0	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_435BC4	dd ?			; DATA XREF: sub_401060+5Er
dword_435BC8	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_42854Cr
dword_435BCC	dd ?			; DATA XREF: .text:00428673r
					; sub_4286C0+4w
dword_435BD0	dd ?			; DATA XREF: sub_4289E0+9r
					; sub_4289E0:loc_428A00w
dword_435BD4	dd ?			; DATA XREF: sub_4287A0+1Dr
					; sub_4287A0+58r ...
dword_435BD8	dd ?			; DATA XREF: sub_4287A0+Br
					; sub_4287A0:loc_42885Fw ...
dword_435BDC	dd ?			; DATA XREF: sub_428F90+4r
					; sub_428F90+92w ...
dword_435BE0	dd ?			; DATA XREF: sub_4290E0r
					; sub_4290E0:loc_4290F0w
		align 20h
dword_435C00	dd 2Bh dup(?)		; DATA XREF: .rdata:004340A8o
dword_435CAC	dd ?			; DATA XREF: .text:0042920Aw
		dd 2 dup(?)
dword_435CB8	dd ?			; DATA XREF: .text:004291F6w
		dd 2 dup(?)
dword_435CC4	dd ?			; DATA XREF: .text:004291DCw
		dd 86h dup(?)
dword_435EE0	dd ?			; DATA XREF: .text:004291E2w
					; .rdata:off_4340A4o
dword_435EE4	dd ?			; DATA XREF: .text:004291ECw
		dd ?
dword_435EEC	dd ?			; DATA XREF: .text:004291FBw
		dd 14h dup(?)
dword_435F40	dd ?			; DATA XREF: .text:004292D3r
					; .text:00429364r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_429260+7o
					; sub_429260:loc_4292B5o ...
dword_435F5C	dd ?			; DATA XREF: sub_429260+14r
					; .text:00429328r ...
		dd ?
dword_435F64	dd ?			; DATA XREF: sub_401180+1A8w
dword_435F68	dd ?			; DATA XREF: sub_401180+1BFw
dword_435F6C	dd ?			; DATA XREF: sub_401180+1B2w
		align 20h
; SERVICE_STATUS_HANDLE	hServiceStatus
hServiceStatus	dd ?			; DATA XREF: HandlerProc+1Dr
					; HandlerProc+4Dr ...
		align 20h
dword_435FA0	dd ?			; DATA XREF: sub_40180A:loc_4018A2w
					; sub_40180A:loc_4018E7w ...
dword_435FA4	dd ?			; DATA XREF: sub_40180A+201r
					; sub_40180A+20Aw ...
dword_435FA8	dd ?			; DATA XREF: sub_40180A+232r
					; sub_40180A+23Bw ...
		align 10h
dword_435FB0	dd ?			; DATA XREF: sub_4020C2:loc_4027F1w
; char dword_435FB4[]
dword_435FB4	dd ?			; DATA XREF: sub_4020C2+302w
					; sub_4020C2+3CEw ...
dword_435FB8	dd ?			; DATA XREF: sub_4020C2+478w
					; sub_4020C2:loc_4029D3r ...
dword_435FBC	dd ?			; DATA XREF: sub_4020C2+482w
					; sub_4020C2:loc_4029E6r ...
; int dword_435FC0
dword_435FC0	dd ?			; DATA XREF: sub_4020C2+8C5w
					; sub_4020C2+1109r ...
dword_435FC4	dd ?			; DATA XREF: sub_401BC6+2Ew
					; sub_401BC6+353w ...
dword_435FC8	dd ?			; DATA XREF: sub_401BC6+363w
dword_435FCC	dd ?			; DATA XREF: sub_4020C2+67r
					; sub_4020C2+402w ...
dword_435FD0	dd ?			; DATA XREF: sub_4020C2+3E9w
					; sub_4020C2+40Cw ...
		align 8
dword_435FD8	dd ?			; DATA XREF: sub_4020C2:loc_4028F6w
					; sub_40A08A+40Cr
dword_435FDC	dd ?			; DATA XREF: sub_401BC6+38w
					; sub_401BC6:loc_401F33w ...
dword_435FE0	dd ?			; DATA XREF: sub_401BC6+42w
					; sub_401BC6:loc_401F42w ...
dword_435FE4	dd ?			; DATA XREF: sub_401BC6+4Cw
					; sub_401BC6:loc_401F51w ...
; int dword_435FE8
dword_435FE8	dd ?			; DATA XREF: sub_401BC6+56w
					; sub_401BC6+3A0w ...
dword_435FEC	dd ?			; DATA XREF: sub_401BC6+60w
					; sub_401BC6+3B0w ...
dword_435FF0	dd ?			; DATA XREF: sub_401BC6+6Aw
					; sub_401BC6:loc_401F80w ...
dword_435FF4	dd ?			; DATA XREF: sub_401BC6+74w
					; sub_401BC6:loc_401F8Fw ...
dword_435FF8	dd ?			; DATA XREF: sub_401BC6+7Ew
					; sub_401BC6:loc_401F9Ew ...
dword_435FFC	dd ?			; DATA XREF: sub_401BC6+88w
					; sub_401BC6:loc_401FADw ...
dword_436000	dd ?			; DATA XREF: sub_401BC6+F8r
					; sub_401BC6+105w ...
dword_436004	dd ?			; DATA XREF: sub_401BC6+92w
					; sub_401BC6:loc_401FBCw ...
; char dword_436008[]
dword_436008	dd ?			; DATA XREF: sub_401BC6+C4w
					; sub_401BC6+451w ...
dword_43600C	dd ?			; DATA XREF: sub_4020C2+325w
					; sub_4020C2+815w ...
dword_436010	dd ?			; DATA XREF: sub_4020C2+A2Aw
					; sub_4020C2+A47w ...
dword_436014	dd ?			; DATA XREF: sub_4020C2+31Bw
					; sub_4020C2:loc_4028C5w ...
dword_436018	dd ?			; DATA XREF: sub_401BC6+9Cw
					; sub_401BC6+408w ...
dword_43601C	dd ?			; DATA XREF: sub_401BC6:loc_401C96r
					; sub_401BC6+DAr ...
; int dword_436020
dword_436020	dd ?			; DATA XREF: sub_401BC6+A6w
					; sub_401BC6+42Aw ...
dword_436024	dd ?			; DATA XREF: sub_401BC6+B0w
					; sub_401BC6+437w ...
dword_436028	dd ?			; DATA XREF: sub_401BC6+BAw
					; sub_401BC6+444w ...
; struct _SERVICE_STATUS ServiceStatus
ServiceStatus	_SERVICE_STATUS	<?>	; DATA XREF: HandlerProc+22o
					; HandlerProc+52o ...
dword_436048	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_428333w ...
dword_43604C	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_436050	dd ?			; DATA XREF: TlsCallback_0:loc_428284w
dword_436054	dd ?			; DATA XREF: sub_401060+64w
					; sub_428400+3Fr ...
dword_436058	dd ?			; DATA XREF: sub_401060+69w
					; sub_428400+4r ...
dword_43605C	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_436060	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 1000h
_bss		ends

;
; Imports from libksba-8.dll
;
; Section 5. (virtual address 00037000)
; Virtual size			: 00002800 (  10240.)
; Section size in file		: 00002800 (  10240.)
; Offset to raw	data for section: 00032200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_ksba_cert_get_auth_key_id:dword
					; DATA XREF: ksba_cert_get_auth_key_idr
		extrn __imp_ksba_cert_get_authority_info_access:dword
					; DATA XREF: ksba_cert_get_authority_info_accessr
		extrn __imp_ksba_cert_get_cert_policies:dword
					; DATA XREF: ksba_cert_get_cert_policiesr
		extrn __imp_ksba_cert_get_crl_dist_point:dword
					; DATA XREF: ksba_cert_get_crl_dist_pointr
		extrn __imp_ksba_cert_get_digest_algo:dword
					; DATA XREF: ksba_cert_get_digest_algor
		extrn __imp_ksba_cert_get_ext_key_usages:dword
					; DATA XREF: ksba_cert_get_ext_key_usagesr
		extrn __imp_ksba_cert_get_extension:dword
					; DATA XREF: ksba_cert_get_extensionr
		extrn __imp_ksba_cert_get_image:dword ;	DATA XREF: ksba_cert_get_imager
		extrn __imp_ksba_cert_get_issuer:dword ; DATA XREF: ksba_cert_get_issuerr
		extrn __imp_ksba_cert_get_key_usage:dword
					; DATA XREF: ksba_cert_get_key_usager
		extrn __imp_ksba_cert_get_public_key:dword
					; DATA XREF: ksba_cert_get_public_keyr
		extrn __imp_ksba_cert_get_serial:dword ; DATA XREF: ksba_cert_get_serialr
		extrn __imp_ksba_cert_get_sig_val:dword	; DATA XREF: ksba_cert_get_sig_valr
		extrn __imp_ksba_cert_get_subj_key_id:dword
					; DATA XREF: ksba_cert_get_subj_key_idr
		extrn __imp_ksba_cert_get_subject:dword	; DATA XREF: ksba_cert_get_subjectr
		extrn __imp_ksba_cert_get_user_data:dword
					; DATA XREF: ksba_cert_get_user_datar
		extrn __imp_ksba_cert_get_validity:dword
					; DATA XREF: ksba_cert_get_validityr
		extrn __imp_ksba_cert_hash:dword ; DATA	XREF: ksba_cert_hashr
		extrn __imp_ksba_cert_init_from_mem:dword
					; DATA XREF: ksba_cert_init_from_memr
		extrn __imp_ksba_cert_is_ca:dword ; DATA XREF: ksba_cert_is_car
		extrn __imp_ksba_cert_new:dword	; DATA XREF: ksba_cert_newr
		extrn __imp_ksba_cert_read_der:dword ; DATA XREF: ksba_cert_read_derr
		extrn __imp_ksba_cert_ref:dword	; DATA XREF: ksba_cert_refr
		extrn __imp_ksba_cert_release:dword ; DATA XREF: ksba_cert_releaser
		extrn __imp_ksba_cert_set_user_data:dword
					; DATA XREF: ksba_cert_set_user_datar
		extrn __imp_ksba_check_version:dword ; DATA XREF: ksba_check_versionr
		extrn __imp_ksba_crl_get_auth_key_id:dword
					; DATA XREF: ksba_crl_get_auth_key_idr
		extrn __imp_ksba_crl_get_crl_number:dword
					; DATA XREF: ksba_crl_get_crl_numberr
		extrn __imp_ksba_crl_get_digest_algo:dword
					; DATA XREF: ksba_crl_get_digest_algor
		extrn __imp_ksba_crl_get_extension:dword
					; DATA XREF: ksba_crl_get_extensionr
		extrn __imp_ksba_crl_get_issuer:dword ;	DATA XREF: ksba_crl_get_issuerr
		extrn __imp_ksba_crl_get_item:dword ; DATA XREF: ksba_crl_get_itemr
		extrn __imp_ksba_crl_get_sig_val:dword ; DATA XREF: ksba_crl_get_sig_valr
		extrn __imp_ksba_crl_get_update_times:dword
					; DATA XREF: ksba_crl_get_update_timesr
		extrn __imp_ksba_crl_new:dword ; DATA XREF: ksba_crl_newr
		extrn __imp_ksba_crl_parse:dword ; DATA	XREF: ksba_crl_parser
		extrn __imp_ksba_crl_release:dword ; DATA XREF:	ksba_crl_releaser
		extrn __imp_ksba_crl_set_hash_function:dword
					; DATA XREF: ksba_crl_set_hash_functionr
		extrn __imp_ksba_crl_set_reader:dword ;	DATA XREF: ksba_crl_set_readerr
		extrn __imp_ksba_free:dword ; DATA XREF: ksba_freer
		extrn __imp_ksba_name_enum:dword ; DATA	XREF: ksba_name_enumr
		extrn __imp_ksba_name_get_uri:dword ; DATA XREF: ksba_name_get_urir
		extrn __imp_ksba_name_release:dword ; DATA XREF: ksba_name_releaser
		extrn __imp_ksba_ocsp_add_target:dword ; DATA XREF: ksba_ocsp_add_targetr
		extrn __imp_ksba_ocsp_build_request:dword
					; DATA XREF: ksba_ocsp_build_requestr
		extrn __imp_ksba_ocsp_get_cert:dword ; DATA XREF: ksba_ocsp_get_certr
		extrn __imp_ksba_ocsp_get_responder_id:dword
					; DATA XREF: ksba_ocsp_get_responder_idr
		extrn __imp_ksba_ocsp_get_sig_val:dword	; DATA XREF: ksba_ocsp_get_sig_valr
		extrn __imp_ksba_ocsp_get_status:dword ; DATA XREF: ksba_ocsp_get_statusr
		extrn __imp_ksba_ocsp_hash_response:dword
					; DATA XREF: ksba_ocsp_hash_responser
		extrn __imp_ksba_ocsp_new:dword	; DATA XREF: ksba_ocsp_newr
		extrn __imp_ksba_ocsp_parse_response:dword
					; DATA XREF: ksba_ocsp_parse_responser
		extrn __imp_ksba_ocsp_release:dword ; DATA XREF: ksba_ocsp_releaser
		extrn __imp_ksba_ocsp_set_nonce:dword ;	DATA XREF: ksba_ocsp_set_noncer
		extrn __imp_ksba_reader_new:dword ; DATA XREF: ksba_reader_newr
		extrn __imp_ksba_reader_read:dword ; DATA XREF:	ksba_reader_readr
		extrn __imp_ksba_reader_release:dword ;	DATA XREF: ksba_reader_releaser
		extrn __imp_ksba_reader_set_cb:dword ; DATA XREF: ksba_reader_set_cbr
		extrn __imp_ksba_reader_set_file:dword ; DATA XREF: ksba_reader_set_filer
		extrn __imp_ksba_reader_unread:dword ; DATA XREF: ksba_reader_unreadr
		extrn __imp_ksba_set_hash_buffer_function:dword
					; DATA XREF: ksba_set_hash_buffer_functionr
		extrn __imp_ksba_set_malloc_hooks:dword	; DATA XREF: ksba_set_malloc_hooksr

;
; Imports from libw32pth-0.dll
;
		extrn __imp_pth_accept_ev:dword	; DATA XREF: pth_accept_evr
		extrn __imp_pth_attr_destroy:dword ; DATA XREF:	pth_attr_destroyr
		extrn __imp_pth_attr_new:dword ; DATA XREF: pth_attr_newr
		extrn __imp_pth_attr_set:dword ; DATA XREF: pth_attr_setr
		extrn __imp_pth_close:dword ; DATA XREF: pth_closer
		extrn __imp_pth_connect:dword ;	DATA XREF: pth_connectr
		extrn __imp_pth_event:dword ; DATA XREF: pth_eventr
		extrn __imp_pth_event_concat:dword ; DATA XREF:	pth_event_concatr
		extrn __imp_pth_event_free:dword ; DATA	XREF: pth_event_freer
		extrn __imp_pth_event_isolate:dword ; DATA XREF: pth_event_isolater
		extrn __imp_pth_event_occurred:dword ; DATA XREF: pth_event_occurredr
		extrn __imp_pth_event_status:dword ; DATA XREF:	pth_event_statusr
		extrn __imp_pth_init:dword ; DATA XREF:	pth_initr
		extrn __imp_pth_mutex_acquire:dword ; DATA XREF: pth_mutex_acquirer
		extrn __imp_pth_mutex_init:dword ; DATA	XREF: pth_mutex_initr
		extrn __imp_pth_mutex_release:dword ; DATA XREF: pth_mutex_releaser
		extrn __imp_pth_pipe:dword ; DATA XREF:	pth_piper
		extrn __imp_pth_read:dword ; DATA XREF:	pth_readr
		extrn __imp_pth_read_ev:dword ;	DATA XREF: pth_read_evr
		extrn __imp_pth_rwlock_acquire:dword ; DATA XREF: pth_rwlock_acquirer
		extrn __imp_pth_rwlock_init:dword ; DATA XREF: pth_rwlock_initr
		extrn __imp_pth_rwlock_release:dword ; DATA XREF: pth_rwlock_releaser
		extrn __imp_pth_sigmask:dword ;	DATA XREF: pth_sigmaskr
		extrn __imp_pth_sleep:dword ; DATA XREF: pth_sleepr
		extrn __imp_pth_spawn:dword ; DATA XREF: pth_spawnr
		extrn __imp_pth_timeout:dword ;	DATA XREF: pth_timeoutr
		extrn __imp_pth_usleep:dword ; DATA XREF: pth_usleepr
		extrn __imp_pth_wait:dword ; DATA XREF:	pth_waitr
		extrn __imp_pth_waitpid:dword ;	DATA XREF: pth_waitpidr
		extrn __imp_pth_write:dword ; DATA XREF: pth_writer
		extrn __imp_pth_yield:dword ; DATA XREF: pth_yieldr

;
; Imports from libassuan-0.dll
;
		extrn __assuan_close:dword ; DATA XREF:	.text:00427CBCr
		extrn __assuan_connect:dword ; DATA XREF: .text:00427CDCr
		extrn __assuan_pipe:dword ; DATA XREF: .text:00427CB4r
		extrn __assuan_socket:dword ; DATA XREF: .text:00427CD4r
		extrn __assuan_socketpair:dword	; DATA XREF: .text:00427CCCr
		extrn __assuan_spawn:dword ; DATA XREF:	.text:00427CC4r
		extrn __imp_assuan_accept:dword	; DATA XREF: assuan_acceptr
		extrn __imp_assuan_fdopen:dword	; DATA XREF: assuan_fdopenr
		extrn __imp_assuan_get_data_fp:dword ; DATA XREF: assuan_get_data_fpr
		extrn __imp_assuan_get_pointer:dword ; DATA XREF: assuan_get_pointerr
		extrn __imp_assuan_init_pipe_server:dword
					; DATA XREF: assuan_init_pipe_serverr
		extrn __imp_assuan_init_socket_server:dword
					; DATA XREF: assuan_init_socket_serverr
		extrn __imp_assuan_inquire:dword ; DATA	XREF: assuan_inquirer
		extrn __imp_assuan_new:dword ; DATA XREF: assuan_newr
		extrn __imp_assuan_process:dword ; DATA	XREF: assuan_processr
		extrn __imp_assuan_register_command:dword
					; DATA XREF: assuan_register_commandr
		extrn __imp_assuan_register_option_handler:dword
					; DATA XREF: assuan_register_option_handlerr
		extrn __imp_assuan_register_reset_notify:dword
					; DATA XREF: assuan_register_reset_notifyr
		extrn __imp_assuan_release:dword ; DATA	XREF: assuan_releaser
		extrn __imp_assuan_send_data:dword ; DATA XREF:	assuan_send_datar
		extrn __imp_assuan_set_assuan_log_prefix:dword
					; DATA XREF: assuan_set_assuan_log_prefixr
		extrn __imp_assuan_set_error:dword ; DATA XREF:	assuan_set_errorr
		extrn __imp_assuan_set_gpg_err_source:dword
					; DATA XREF: assuan_set_gpg_err_sourcer
		extrn __imp_assuan_set_hello_line:dword	; DATA XREF: assuan_set_hello_liner
		extrn __imp_assuan_set_log_stream:dword	; DATA XREF: assuan_set_log_streamr
		extrn __imp_assuan_set_malloc_hooks:dword
					; DATA XREF: assuan_set_malloc_hooksr
		extrn __imp_assuan_set_pointer:dword ; DATA XREF: assuan_set_pointerr
		extrn __imp_assuan_set_system_hooks:dword
					; DATA XREF: assuan_set_system_hooksr
		extrn __imp_assuan_sock_bind:dword ; DATA XREF:	assuan_sock_bindr
		extrn __imp_assuan_sock_check_nonce:dword
					; DATA XREF: assuan_sock_check_noncer
		extrn __imp_assuan_sock_close:dword ; DATA XREF: assuan_sock_closer
		extrn __imp_assuan_sock_get_nonce:dword	; DATA XREF: assuan_sock_get_noncer
		extrn __imp_assuan_sock_init:dword ; DATA XREF:	assuan_sock_initr
		extrn __imp_assuan_sock_new:dword ; DATA XREF: assuan_sock_newr
		extrn __imp_assuan_write_line:dword ; DATA XREF: assuan_write_liner
		extrn __imp_assuan_write_status:dword ;	DATA XREF: assuan_write_statusr

;
; Imports from libgcrypt-20.dll
;
		extrn __imp_gcry_calloc:dword ;	DATA XREF: gcry_callocr
		extrn __imp_gcry_check_version:dword ; DATA XREF: gcry_check_versionr
		extrn __imp_gcry_control:dword ; DATA XREF: gcry_controlr
		extrn __imp_gcry_create_nonce:dword ; DATA XREF: gcry_create_noncer
		extrn __imp_gcry_free:dword ; DATA XREF: gcry_freer
		extrn __imp_gcry_malloc:dword ;	DATA XREF: gcry_mallocr
		extrn __imp_gcry_md_algo_name:dword ; DATA XREF: gcry_md_algo_namer
		extrn __imp_gcry_md_close:dword	; DATA XREF: gcry_md_closer
		extrn __imp_gcry_md_ctl:dword ;	DATA XREF: gcry_md_ctlr
		extrn __imp_gcry_md_debug:dword	; DATA XREF: gcry_md_debugr
		extrn __imp_gcry_md_get_algo:dword ; DATA XREF:	gcry_md_get_algor
		extrn __imp_gcry_md_get_algo_dlen:dword	; DATA XREF: gcry_md_get_algo_dlenr
		extrn __imp_gcry_md_hash_buffer:dword ;	DATA XREF: gcry_md_hash_bufferr
		extrn __imp_gcry_md_map_name:dword ; DATA XREF:	gcry_md_map_namer
		extrn __imp_gcry_md_open:dword ; DATA XREF: gcry_md_openr
		extrn __imp_gcry_md_read:dword ; DATA XREF: gcry_md_readr
		extrn __imp_gcry_md_write:dword	; DATA XREF: gcry_md_writer
		extrn __imp_gcry_pk_verify:dword ; DATA	XREF: gcry_pk_verifyr
		extrn __imp_gcry_realloc:dword ; DATA XREF: gcry_reallocr
		extrn __imp_gcry_set_log_handler:dword ; DATA XREF: gcry_set_log_handlerr
		extrn __imp_gcry_sexp_build:dword ; DATA XREF: gcry_sexp_buildr
		extrn __imp_gcry_sexp_cadr:dword ; DATA	XREF: gcry_sexp_cadrr
		extrn __imp_gcry_sexp_canon_len:dword ;	DATA XREF: gcry_sexp_canon_lenr
		extrn __imp_gcry_sexp_find_token:dword ; DATA XREF: gcry_sexp_find_tokenr
		extrn __imp_gcry_sexp_nth_data:dword ; DATA XREF: gcry_sexp_nth_datar
		extrn __imp_gcry_sexp_release:dword ; DATA XREF: gcry_sexp_releaser
		extrn __imp_gcry_sexp_sscan:dword ; DATA XREF: gcry_sexp_sscanr
		extrn __imp_gcry_strdup:dword ;	DATA XREF: gcry_strdupr
		extrn __imp_gcry_strerror:dword	; DATA XREF: gcry_strerrorr
		extrn __imp_gcry_xcalloc:dword ; DATA XREF: gcry_xcallocr
		extrn __imp_gcry_xmalloc:dword ; DATA XREF: gcry_xmallocr
		extrn __imp_gcry_xrealloc:dword	; DATA XREF: gcry_xreallocr
		extrn __imp_gcry_xstrdup:dword ; DATA XREF: gcry_xstrdupr

;
; Imports from libgpg-error-0.dll
;
		extrn __imp_gpg_err_code_from_errno:dword
					; DATA XREF: gpg_err_code_from_errnor
		extrn __imp_gpg_err_code_from_syserror:dword
					; DATA XREF: gpg_err_code_from_syserrorr
		extrn __imp_gpg_err_set_errno:dword ; DATA XREF: gpg_err_set_errnor
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr

;
; Imports from ADVAPI32.dll
;
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_421D55+233p
					; sub_421D55+4DAp
					; DATA XREF: ...
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_421D55+183p
					; sub_421D55+1C6p ...
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_421D55+211p
					; sub_421D55+2A6p ...
; SERVICE_STATUS_HANDLE	__stdcall RegisterServiceCtrlHandlerExA(LPCSTR lpServiceName, LPHANDLER_FUNCTION_EX lpHandlerProc, LPVOID lpContext)
		extrn RegisterServiceCtrlHandlerExA:dword ; CODE XREF: sub_4020C2+90p
					; DATA XREF: sub_4020C2+8Br
; BOOL __stdcall SetServiceStatus(SERVICE_STATUS_HANDLE	hServiceStatus,	LPSERVICE_STATUS lpServiceStatus)
		extrn SetServiceStatus:dword ; CODE XREF: HandlerProc+32p
					; HandlerProc+62p ...
; BOOL __stdcall StartServiceCtrlDispatcherA(const SERVICE_TABLE_ENTRYA	*lpServiceStartTable)
		extrn StartServiceCtrlDispatcherA:dword	; CODE XREF: sub_4034A1+A6p
					; DATA XREF: sub_4034A1+A1r

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_40F169+31p
					; sub_41C62B+1EDp ...
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: sub_41C62B+EDp
					; sub_4223D7+E7p ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_41C62B+1B6p
					; sub_4216D5+19Ep
					; DATA XREF: ...
; HANDLE __stdcall CreateFileMappingA(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCSTR lpName)
		extrn CreateFileMappingA:dword ; CODE XREF: sub_40F01C+B0p
					; DATA XREF: sub_40F01C+ABr
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	sub_4216D5+319p
					; DATA XREF: sub_4216D5+314r
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_429400+44p
					; DATA XREF: sub_429400+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_429260+Ep
					; .text:00429322p ...
; DWORD	__stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR	lpDst, DWORD nSize)
		extrn ExpandEnvironmentStringsA:dword ;	CODE XREF: sub_421D55+392p
					; sub_421D55+3F8p
					; DATA XREF: ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_426248+51p
					; DATA XREF: sub_426248+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: sub_421D2B+17p
					; TlsCallback_0+10Ap
					; DATA XREF: ...
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: .text:00426BEFp
					; DATA XREF: .text:00426BEAr
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: .text:00426BDFp
					; DATA XREF: .text:00426BDAr
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_4216D5+29Bp
					; .text:00429238p
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_41C62B+Fp
					; sub_429100+6Cp
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_429100+74p
					; DATA XREF: sub_429100+74r
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: sub_421B43+BAp
					; DATA XREF: sub_421B43+B5r
; DWORD	__stdcall GetFileAttributesA(LPCSTR lpFileName)
		extrn GetFileAttributesA:dword ; CODE XREF: sub_429860+2Fp
					; DATA XREF: sub_429860+2Fr
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_4020C2+A8p
					; sub_426248+11p ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_4225A3+2Fp
					; sub_4295A0+C2p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_428F90+87p
					; DATA XREF: ...
; DWORD	__stdcall GetPriorityClass(HANDLE hProcess)
		extrn GetPriorityClass:dword ; CODE XREF: sub_4216D5+2A5p
					; DATA XREF: sub_4216D5+2A0r
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_429100+57p
					; DATA XREF: sub_429100+57r
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: sub_41C62B+2Ap
					; DATA XREF: sub_41C62B+25r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_41C62B+119p
					; sub_429100+7Cp
					; DATA XREF: ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_429400+87p
					; DATA XREF: sub_429400+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_429260+5Cp
					; .text:00429340p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_421CC8+11p
					; sub_426908+11p ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_428F90+A7p
					; DATA XREF: sub_428F90+A7r
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap)
		extrn MapViewOfFile:dword ; CODE XREF: sub_40F01C+F3p
					; DATA XREF: sub_40F01C+EEr
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_429100+8Bp
					; DATA XREF: sub_429100+8Br
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword ; CODE	XREF: sub_4216D5+430p
					; DATA XREF: sub_4216D5+42Br
; BOOL __stdcall SetEnvironmentVariableA(LPCSTR	lpName,	LPCSTR lpValue)
		extrn SetEnvironmentVariableA:dword ; CODE XREF: sub_4119CC+D5p
					; DATA XREF: sub_4119CC+D0r
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0042921Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; sub_41C62B+20Ap
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00429249p
					; DATA XREF: .text:00429249r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_429260+35p
					; DATA XREF: sub_429260+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0042922Fp
					; DATA XREF: .text:0042922Fr
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; CODE XREF: sub_40F169+1Ep
					; DATA XREF: sub_40F169+19r
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_4287A0+142p
					; sub_4287A0+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_4287A0+A1p
					; sub_4287A0+D9p ...
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: sub_421B43+4Dp
					; DATA XREF: sub_421B43+48r

;
; Imports from msvcrt.dll
;
		extrn __imp__access:dword ; DATA XREF: _accessr
		extrn __imp__close:dword ; DATA	XREF: _closer
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
		extrn __imp__mkdir:dword ; DATA	XREF: _mkdirr
		extrn __imp__open:dword	; DATA XREF: _openr
		extrn __imp__read:dword	; DATA XREF: _readr
		extrn __imp__setmode:dword ; DATA XREF:	_setmoder
; char *__cdecl	_strlwr(char *Str)
		extrn __imp__strlwr:dword ; DATA XREF: _strlwrr
; int __cdecl _unlink(const char *Filename)
		extrn __imp__unlink:dword ; DATA XREF: _unlinkr
		extrn __imp__write:dword ; DATA	XREF: _writer

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_4283D0r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl _errno()
		extrn __imp__errno:dword ; CODE	XREF: sub_401AE7+9Ap
					; sub_4020C2+52Cp ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
		extrn __imp__findclose:dword ; DATA XREF: _findcloser
		extrn __imp__findfirst:dword ; DATA XREF: _findfirstr
		extrn __imp__findnext:dword ; DATA XREF: _findnextr
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: sub_40F01C+18p
					; DATA XREF: sub_40F01C+13r
; char *__cdecl	_fullpath(char *FullPath, const	char *Path, size_t SizeInBytes)
		extrn __imp__fullpath:dword ; DATA XREF: _fullpathr
		extrn _get_osfhandle:dword ; CODE XREF:	sub_40F01C+68p
					; DATA XREF: sub_40F01C+63r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_401A7B+6r
					; sub_401A7B+2Fr ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__lseeki64:dword ; DATA XREF: _lseeki64r
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_428400+A3p
					; DATA XREF: sub_428400+A3r
		extrn _open_osfhandle:dword ; CODE XREF: sub_41C62B+1D7p
					; DATA XREF: sub_41C62B+1D2r
; void __cdecl sleep(unsigned __int32 Duration)
		extrn _sleep:dword	; CODE XREF: sub_4020C2+AE3p
					; DATA XREF: sub_4020C2+ADEr
		extrn _stati64:dword	; CODE XREF: sub_406CA5+1B3p
					; DATA XREF: sub_406CA5+1AEr
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
; int __cdecl _vsnprintf(char *DstBuf, size_t MaxCount,	const char *Format, va_list ArgList)
		extrn __imp__vsnprintf:dword ; DATA XREF: _vsnprintfr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl feof(FILE	*File)
		extrn __imp_feof:dword	; DATA XREF: feofr
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; int __cdecl fgetc(FILE *File)
		extrn __imp_fgetc:dword	; DATA XREF: fgetcr
; char *__cdecl	fgets(char *Buf, int MaxCount, FILE *File)
		extrn __imp_fgets:dword	; DATA XREF: fgetsr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; int __cdecl fseek(FILE *File,	__int32	Offset,	int Origin)
		extrn __imp_fseek:dword	; DATA XREF: fseekr
; __int32 __cdecl ftell(FILE *File)
		extrn __imp_ftell:dword	; DATA XREF: ftellr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; struct tm *__cdecl static gmtime(const time_t	*Time)
		extrn gmtime:dword	; DATA XREF: sub_42A090r
; int __cdecl islower(int C)
		extrn __imp_islower:dword ; DATA XREF: islowerr
; int __cdecl isspace(int C)
		extrn __imp_isspace:dword ; CODE XREF: sub_423B0A+462p
					; sub_423B0A+4A3p ...
; int __cdecl isupper(int C)
		extrn __imp_isupper:dword ; DATA XREF: isupperr
; int __cdecl isxdigit(int C)
		extrn isxdigit:dword	; CODE XREF: sub_413DBC+62p
					; sub_413DBC+80p
					; DATA XREF: ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_42A0A0r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn __imp_memchr:dword ; DATA	XREF: memchrr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl remove(const char	*Filename)
		extrn __imp_remove:dword ; DATA	XREF: remover
; int __cdecl rename(const char	*OldFilename, const char *NewFilename)
		extrn __imp_rename:dword ; DATA	XREF: renamer
; void __cdecl rewind(FILE *File)
		extrn __imp_rewind:dword ; DATA	XREF: rewindr
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; size_t __cdecl strspn(const char *Str, const char *Control)
		extrn __imp_strspn:dword ; DATA	XREF: strspnr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_42A080r
; int __cdecl tolower(int C)
		extrn tolower:dword	; CODE XREF: sub_413995+112p
					; sub_413995+222p ...
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:004254F1p
					; .text:00425506p ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr
; int __cdecl vsprintf(char *Dest, const char *Format, va_list Args)
		extrn __imp_vsprintf:dword ; DATA XREF:	vsprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_4295A0+122p
					; DATA XREF: sub_4295A0+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSACleanup()
		extrn WSACleanup:dword	; CODE XREF: sub_413112+Bp
					; sub_413121+A4p
					; DATA XREF: ...
; int __stdcall	WSAGetLastError()
		extrn WSAGetLastError:dword ; CODE XREF: sub_413121+35p
					; sub_4152A7+A4p ...
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: sub_413121+27p
					; DATA XREF: sub_413121+22r
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; CODE XREF: sub_413430+F3p
					; sub_4137B6+3Dp ...
; struct hostent *__stdcall gethostbyname(const	char *name)
		extrn gethostbyname:dword ; CODE XREF: sub_4152A7+1DCp
					; DATA XREF: sub_4152A7+1D7r
; u_short __stdcall htons(u_short hostshort)
		extrn htons:dword	; CODE XREF: sub_4152A7+D2p
					; sub_4152A7+2DBp
					; DATA XREF: ...
; unsigned __int32 __stdcall inet_addr(const char *cp)
		extrn inet_addr:dword	; CODE XREF: sub_4152A7+43p
					; DATA XREF: sub_4152A7+3Er
; int __stdcall	listen(SOCKET s, int backlog)
		extrn listen:dword	; CODE XREF: sub_4020C2+D7Ep
					; DATA XREF: sub_4020C2+D79r
; int __stdcall	shutdown(SOCKET	s, int how)
		extrn shutdown:dword	; CODE XREF: sub_4135D8+83p
					; DATA XREF: sub_4135D8+7Er
; SOCKET __stdcall socket(int af, int type, int	protocol)
		extrn socket:dword	; CODE XREF: sub_4152A7+91p
					; sub_4152A7+22Bp
					; DATA XREF: ...


; Section 6. (virtual address 0003A000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00034A00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 43A000h
dword_43A000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_43A008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_43A00C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_4283D0
dword_43A018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_43A030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_428373o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 0003B000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00034C00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 43B000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
