;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	81B8A65C524674764FC5ED4AAA6BE7C6
; Input	CRC32 :	D554B78C

; File Name   :	C:\compspace\compare\gpg\dlls\original\gpg-agent.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 0003BCA4 ( 244900.)
; Section size in file		: 0003BE00 ( 245248.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:0044D004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_4499C0
		mov	[esp+2Ch+var_1C], offset dword_449018
		mov	[esp+2Ch+var_24], offset dword_44900C
		mov	[esp+2Ch+var_28], offset dword_449008
		mov	ds:dword_449018, eax
		mov	eax, ds:dword_4499C4
		mov	[esp+2Ch+var_2C], offset dword_449004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_44901C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:0044D010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_4499D0, 1
		mov	ds:dword_4499CC, 1
		mov	ds:dword_4499C8, 1
		mov	ds:dword_4499DC, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_449014, eax
		mov	eax, ds:dword_4499E0
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_43A560
		mov	edx, ds:dword_4499E4
		mov	ds:dword_449E44, eax
		mov	ds:dword_449E48, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_43A8A0
		cmp	dword_43D8AC, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_43A840
		call	sub_43A830
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_43B610
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_4499E0
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_449E4C
		call	sub_43B920
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_449E50
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_449E50
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_449000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_449E50
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_449E4C

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_44825C
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_43AB50
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_4499E8, eax
		call	sub_43B100
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_43B1C0
		mov	eax, ds:dword_4499E0
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_449D84, eax
		mov	eax, 0Ah
		mov	ds:dword_449D8C, 400000h
		cmovnz	eax, edx
		mov	ds:dword_449D88, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_449004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_449008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_449008, eax
		call	sub_43B250
		mov	eax, ds:__initenv
		mov	edx, ds:dword_44900C
		mov	[eax], edx
		mov	eax, ds:dword_44900C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_449008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_449004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_402066
		mov	esi, ds:dword_449014
		test	esi, esi
		mov	ds:dword_449010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_449000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_449010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_449E50
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_449E50
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_44D008
		mov	[esp+88h+dwMilliseconds], offset dword_44D000
		call	_initterm
		mov	ds:dword_449E50, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_449E50, 1
		mov	[esp+88h+lpProcName], offset dword_44D018
		mov	[esp+88h+dwMilliseconds], offset dword_44D00C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_4499E0, 1
		call	sub_43B270
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_4499E0, 0
		call	sub_43B270
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_43CC70+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_43D8B8
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_43D8B8
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_43CC70+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_401577+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_401570
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_401575
; ---------------------------------------------------------------------------

loc_401570:				; CODE XREF: sub_401550+7j
		mov	eax, 0

loc_401575:				; CODE XREF: sub_401550+1Ej
		pop	ebp
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401577	proc near		; CODE XREF: sub_401592+14p
					; sub_4015AD+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_401550
		leave
		retn
sub_401577	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401592	proc near		; CODE XREF: sub_4038EB+27Dp

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_401577
		leave
		retn
sub_401592	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015AD	proc near		; CODE XREF: sub_402066+27Ap

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_401577
		leave
		retn
sub_4015AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015C2	proc near		; CODE XREF: sub_402066+320p
					; sub_402066+FBAp ...
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_4015C2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	pth_usleep
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+14h]
		mov	[esp+8], edx
		mov	edx, [ebp+10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	pth_read
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+14h]
		mov	[esp+8], edx
		mov	edx, [ebp+10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	pth_write
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], 28h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], 28h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_40167A
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+18h]
		mov	[esp+8], edx
		mov	edx, [ebp+14h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	pth_waitpid
		jmp	short locret_40167F
; ---------------------------------------------------------------------------

loc_40167A:				; CODE XREF: .text:0040165Dj
		mov	eax, 0

locret_40167F:				; CODE XREF: .text:00401678j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401681	proc near		; CODE XREF: sub_401748+63p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, dword_43D360
		test	eax, eax
		jz	short loc_4016B8
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Source], 0
		mov	[esp+38h+Dest],	18h
		call	gcry_control
		mov	dword_43D360, 0

loc_4016B8:				; CODE XREF: sub_401681+Fj
		mov	[esp+38h+Dest],	0
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 2
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	word ptr [eax],	20h
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_10]
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_401681	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401748	proc near		; DATA XREF: sub_402066+B8o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 29h ; switch 42 cases
		ja	loc_4017E1	; jumptable 00401765 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_43E71C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_401767:				; CODE XREF: sub_401748+1Dj
					; DATA XREF: .rdata:off_43E71Co
		mov	[ebp+var_C], offset aGpgAgentGnupg ; jumptable 00401765	case 11
		jmp	short loc_4017E8
; ---------------------------------------------------------------------------

loc_401770:				; CODE XREF: sub_401748+1Dj
					; DATA XREF: .rdata:off_43E71Co
		mov	[ebp+var_C], offset a2_0_30 ; jumptable	00401765 case 13
		jmp	short loc_4017E8
; ---------------------------------------------------------------------------

loc_401779:				; CODE XREF: sub_401748+1Dj
					; DATA XREF: .rdata:off_43E71Co
		mov	[ebp+var_C], offset aMingw32 ; jumptable 00401765 case 17
		jmp	short loc_4017E8
; ---------------------------------------------------------------------------

loc_401782:				; CODE XREF: sub_401748+1Dj
					; DATA XREF: .rdata:off_43E71Co
		mov	[esp+28h+var_28], offset aPleaseReportBu ; jumptable 00401765 case 19
		call	sub_435294
		mov	[ebp+var_C], eax
		jmp	short loc_4017E8
; ---------------------------------------------------------------------------

loc_401793:				; CODE XREF: sub_401748+1Dj
					; DATA XREF: .rdata:off_43E71Co
		mov	eax, ds:dword_44908C ; jumptable 00401765 case 20
		test	eax, eax
		jnz	short loc_4017B5
		mov	[esp+28h+var_24], offset gcry_check_version
		mov	[esp+28h+var_28], offset aLibgcrypt ; "libgcrypt"
		call	sub_401681
		mov	ds:dword_44908C, eax

loc_4017B5:				; CODE XREF: sub_401748+52j
		mov	eax, ds:dword_44908C
		mov	[ebp+var_C], eax
		jmp	short loc_4017E8
; ---------------------------------------------------------------------------

loc_4017BF:				; CODE XREF: sub_401748+1Dj
					; DATA XREF: .rdata:off_43E71Co
		mov	[esp+28h+var_28], offset aUsageGpgAgentO ; jumptable 00401765 cases 1,40
		call	sub_435294
		mov	[ebp+var_C], eax
		jmp	short loc_4017E8
; ---------------------------------------------------------------------------

loc_4017D0:				; CODE XREF: sub_401748+1Dj
					; DATA XREF: .rdata:off_43E71Co
		mov	[esp+28h+var_28], offset aSyntaxGpgAgent ; jumptable 00401765 case 41
		call	sub_435294
		mov	[ebp+var_C], eax
		jmp	short loc_4017E8
; ---------------------------------------------------------------------------

loc_4017E1:				; CODE XREF: sub_401748+Aj
					; sub_401748+1Dj
					; DATA XREF: ...
		mov	[ebp+var_C], 0	; jumptable 00401765 default case

loc_4017E8:				; CODE XREF: sub_401748+26j
					; sub_401748+2Fj ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_401748	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4017ED	proc near		; CODE XREF: sub_402066:loc_402C5Ep
					; sub_4034EE+112p

Str		= dword	ptr -68h
var_64		= byte ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	eax, ds:Str
		test	eax, eax
		jz	short loc_40181E
		mov	eax, ds:Str
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40181E
		mov	eax, ds:Str
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40181E
		mov	eax, 1
		jmp	short loc_401823
; ---------------------------------------------------------------------------

loc_40181E:				; CODE XREF: sub_4017ED+10j
					; sub_4017ED+1Cj ...
		mov	eax, 0

loc_401823:				; CODE XREF: sub_4017ED+2Fj
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40183B
		mov	eax, ds:Str
		mov	[esp+68h+Str], eax ; Str
		call	atoi
		jmp	short loc_401840
; ---------------------------------------------------------------------------

loc_40183B:				; CODE XREF: sub_4017ED+3Dj
		mov	eax, 0

loc_401840:				; CODE XREF: sub_4017ED+4Cj
		mov	[ebp+var_20], eax
		mov	eax, ds:Str
		test	eax, eax
		jz	loc_4019D8
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aNone ; "none"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_401886
		cmp	[ebp+var_1C], 0
		jz	short loc_401895
		cmp	[ebp+var_20], 0
		jg	short loc_401895

loc_401886:				; CODE XREF: sub_4017ED+8Bj
		mov	ds:dword_449DA0, 0
		jmp	loc_4019D8
; ---------------------------------------------------------------------------

loc_401895:				; CODE XREF: sub_4017ED+91j
					; sub_4017ED+97j
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aBasic ; "basic"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4018CB
		cmp	[ebp+var_1C], 0
		jz	short loc_4018DA
		cmp	[ebp+var_20], 2
		jg	short loc_4018DA

loc_4018CB:				; CODE XREF: sub_4017ED+D0j
		mov	ds:dword_449DA0, 400h
		jmp	loc_4019D8
; ---------------------------------------------------------------------------

loc_4018DA:				; CODE XREF: sub_4017ED+D6j
					; sub_4017ED+DCj
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aAdvanced ;	"advanced"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_401910
		cmp	[ebp+var_1C], 0
		jz	short loc_40191F
		cmp	[ebp+var_20], 5
		jg	short loc_40191F

loc_401910:				; CODE XREF: sub_4017ED+115j
		mov	ds:dword_449DA0, 401h
		jmp	loc_4019D8
; ---------------------------------------------------------------------------

loc_40191F:				; CODE XREF: sub_4017ED+11Bj
					; sub_4017ED+121j
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aExpert ; "expert"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_401955
		cmp	[ebp+var_1C], 0
		jz	short loc_401961
		cmp	[ebp+var_20], 8
		jg	short loc_401961

loc_401955:				; CODE XREF: sub_4017ED+15Aj
		mov	ds:dword_449DA0, 441h
		jmp	short loc_4019D8
; ---------------------------------------------------------------------------

loc_401961:				; CODE XREF: sub_4017ED+160j
					; sub_4017ED+166j
		mov	eax, ds:Str
		mov	edx, eax
		mov	eax, offset aGuru ; "guru"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_401991
		cmp	[ebp+var_1C], 0
		jz	short loc_4019B0

loc_401991:				; CODE XREF: sub_4017ED+19Cj
		mov	ds:dword_449DA0, 0FFFFFFFFh
		cmp	[ebp+var_1C], 0
		jz	short loc_4019D8
		mov	eax, ds:dword_449DA0
		and	ah, 0FDh
		mov	ds:dword_449DA0, eax
		jmp	short loc_4019D8
; ---------------------------------------------------------------------------

loc_4019B0:				; CODE XREF: sub_4017ED+1A2j
		mov	ebx, ds:Str
		mov	[esp+68h+Str], offset aInvalidDebugLe ;	"invalid debug-level `%s' given\n"
		call	sub_435294
		mov	dword ptr [esp+68h+var_64], ebx	; char
		mov	[esp+68h+Str], eax ; char *
		call	sub_435B7D
		mov	ds:dword_449DA0, 0

loc_4019D8:				; CODE XREF: sub_4017ED+5Dj
					; sub_4017ED+A3j ...
		mov	eax, ds:dword_449DA0
		test	eax, eax
		jz	short loc_4019F4
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jnz	short loc_4019F4
		mov	ds:dword_449DA4, 1

loc_4019F4:				; CODE XREF: sub_4017ED+1F2j
					; sub_4017ED+1FBj
		mov	eax, ds:dword_449DA0
		test	eax, eax
		jz	short loc_401A10
		mov	eax, ds:dword_449DA8
		test	eax, eax
		jz	short loc_401A10
		mov	ds:dword_449DA8, 0

loc_401A10:				; CODE XREF: sub_4017ED+20Ej
					; sub_4017ED+217j
		mov	eax, ds:dword_449DA0
		and	eax, 2
		test	eax, eax
		jz	short loc_401A30
		mov	dword ptr [esp+68h+var_64], 2
		mov	[esp+68h+Str], 14h
		call	gcry_control

loc_401A30:				; CODE XREF: sub_4017ED+22Dj
		mov	eax, ds:dword_449DA0
		and	eax, 4
		test	eax, eax
		jz	short loc_401A50
		mov	dword ptr [esp+68h+var_64], 1
		mov	[esp+68h+Str], 14h
		call	gcry_control

loc_401A50:				; CODE XREF: sub_4017ED+24Dj
		mov	eax, ds:dword_449DA4
		mov	dword ptr [esp+68h+var_64], eax
		mov	[esp+68h+Str], 13h
		call	gcry_control
		mov	eax, ds:dword_449DA0
		test	eax, eax
		jz	loc_401B72
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_401A87
		mov	ecx, offset aAssuan ; "	assuan"
		jmp	short loc_401A8C
; ---------------------------------------------------------------------------

loc_401A87:				; CODE XREF: sub_4017ED+291j
		mov	ecx, offset byte_43E80C

loc_401A8C:				; CODE XREF: sub_4017ED+298j
		mov	eax, ds:dword_449DA0
		and	eax, 200h
		test	eax, eax
		jz	short loc_401AA3
		mov	[ebp+var_2C], offset aHashing ;	" hashing"
		jmp	short loc_401AAA
; ---------------------------------------------------------------------------

loc_401AA3:				; CODE XREF: sub_4017ED+2ABj
		mov	[ebp+var_2C], offset byte_43E80C

loc_401AAA:				; CODE XREF: sub_4017ED+2B4j
		mov	eax, ds:dword_449DA0
		and	eax, 80h
		test	eax, eax
		jz	short loc_401AC1
		mov	[ebp+var_30], offset aMemstat ;	" memstat"
		jmp	short loc_401AC8
; ---------------------------------------------------------------------------

loc_401AC1:				; CODE XREF: sub_4017ED+2C9j
		mov	[ebp+var_30], offset byte_43E80C

loc_401AC8:				; CODE XREF: sub_4017ED+2D2j
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_401ADB
		mov	edi, offset aCache ; " cache"
		jmp	short loc_401AE0
; ---------------------------------------------------------------------------

loc_401ADB:				; CODE XREF: sub_4017ED+2E5j
		mov	edi, offset byte_43E80C

loc_401AE0:				; CODE XREF: sub_4017ED+2ECj
		mov	eax, ds:dword_449DA0
		and	eax, 20h
		test	eax, eax
		jz	short loc_401AF3
		mov	esi, offset aMemory ; "	memory"
		jmp	short loc_401AF8
; ---------------------------------------------------------------------------

loc_401AF3:				; CODE XREF: sub_4017ED+2FDj
		mov	esi, offset byte_43E80C

loc_401AF8:				; CODE XREF: sub_4017ED+304j
		mov	eax, ds:dword_449DA0
		and	eax, 4
		test	eax, eax
		jz	short loc_401B0B
		mov	ebx, offset aCrypto ; "	crypto"
		jmp	short loc_401B10
; ---------------------------------------------------------------------------

loc_401B0B:				; CODE XREF: sub_4017ED+315j
		mov	ebx, offset byte_43E80C

loc_401B10:				; CODE XREF: sub_4017ED+31Cj
		mov	eax, ds:dword_449DA0
		and	eax, 2
		test	eax, eax
		jz	short loc_401B23
		mov	edx, offset aMpi ; " mpi"
		jmp	short loc_401B28
; ---------------------------------------------------------------------------

loc_401B23:				; CODE XREF: sub_4017ED+32Dj
		mov	edx, offset byte_43E80C

loc_401B28:				; CODE XREF: sub_4017ED+334j
		mov	eax, ds:dword_449DA0
		and	eax, 1
		test	al, al
		jz	short loc_401B3B
		mov	eax, offset aCommand ; " command"
		jmp	short loc_401B40
; ---------------------------------------------------------------------------

loc_401B3B:				; CODE XREF: sub_4017ED+345j
		mov	eax, offset byte_43E80C

loc_401B40:				; CODE XREF: sub_4017ED+34Cj
		mov	[esp+68h+var_48], ecx
		mov	ecx, [ebp+var_2C]
		mov	[esp+68h+var_4C], ecx
		mov	ecx, [ebp+var_30]
		mov	[esp+68h+var_50], ecx
		mov	[esp+68h+var_54], edi
		mov	[esp+68h+var_58], esi
		mov	[esp+68h+var_5C], ebx
		mov	[esp+68h+var_60], edx
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+Str], offset aEnabledDebugFl ;	"enabled debug flags:%s%s%s%s%s%s%s%s\n"
		call	sub_435B53

loc_401B72:				; CODE XREF: sub_4017ED+27Fj
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4017ED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401B7A(char *Str)
sub_401B7A	proc near		; CODE XREF: sub_401BD6+Ep
					; sub_401BD6+1Bp

Filename	= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
Str		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+Str], 0
		jz	short locret_401BD4
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short locret_401BD4
		mov	eax, [ebp+Str]
		mov	[esp+28h+Filename], eax	; Filename
		call	remove
		mov	[esp+28h+var_24], 2Fh ;	Ch
		mov	eax, [ebp+Str]
		mov	[esp+28h+Filename], eax	; Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401BCE
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Str]
		mov	[esp+28h+Filename], eax
		call	_rmdir
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	2Fh

loc_401BCE:				; CODE XREF: sub_401B7A+3Bj
		mov	eax, [ebp+Str]
		mov	byte ptr [eax],	0

locret_401BD4:				; CODE XREF: sub_401B7A+Aj
					; sub_401B7A+14j
		leave
		retn
sub_401B7A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401BD6()
sub_401BD6	proc near		; CODE XREF: sub_402066+C19p
					; sub_404743:loc_404F4Cp
					; DATA XREF: ...

Str		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449030
		mov	[esp+18h+Str], eax ; Str
		call	sub_401B7A
		mov	eax, ds:dword_449034
		mov	[esp+18h+Str], eax ; Str
		call	sub_401B7A
		leave
		retn
sub_401BD6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BF8	proc near		; CODE XREF: sub_402066+1AEp
					; sub_402066+64Ep ...

Str1		= dword	ptr -18h
Str2		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	loc_401CE4
		mov	ds:dword_449DA8, 0
		mov	ds:dword_449DA4, 0
		mov	ds:dword_449DA0, 0
		mov	ds:dword_449DD8, 0
		mov	ds:dword_449DCC, 0
		mov	ds:dword_449DDC, 0
		mov	ds:dword_449DD0, 0
		mov	ds:dword_449DE0, 258h
		mov	ds:dword_449DE4, 708h
		mov	ds:dword_449DE8, 1C20h
		mov	ds:dword_449DEC, 1C20h
		mov	ds:dword_449DF0, 0
		mov	ds:dword_449DF4, 8
		mov	ds:dword_449DF8, 1
		mov	ds:dword_449DFC, 0
		mov	ds:dword_449E00, 0
		mov	ds:dword_449E04, 0
		mov	ds:dword_449E0C, 0
		mov	ds:dword_449E10, 1
		mov	ds:dword_449DD4, 0
		mov	ds:dword_449E18, 1
		mov	eax, 1
		jmp	locret_402064
; ---------------------------------------------------------------------------

loc_401CE4:				; CODE XREF: sub_401BF8+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 211h
		jz	loc_401FAC
		cmp	eax, 211h
		jg	loc_401DA9
		cmp	eax, 201h
		jz	loc_401F3E
		cmp	eax, 201h
		jg	short loc_401D56
		cmp	eax, 1F9h
		jz	loc_401E77
		cmp	eax, 1F9h
		jg	short loc_401D3B
		cmp	eax, 71h
		jz	loc_401E56
		cmp	eax, 76h
		jz	loc_401E65
		jmp	loc_402057
; ---------------------------------------------------------------------------

loc_401D3B:				; CODE XREF: sub_401BF8+12Aj
		cmp	eax, 1FAh
		jz	loc_401E8F
		cmp	eax, 1FBh
		jz	loc_401E9E
		jmp	loc_402057
; ---------------------------------------------------------------------------

loc_401D56:				; CODE XREF: sub_401BF8+118j
		cmp	eax, 207h
		jz	loc_401F5D
		cmp	eax, 207h
		jg	short loc_401D83
		cmp	eax, 202h
		jz	loc_401EAE
		cmp	eax, 206h
		jz	loc_401F4D
		jmp	loc_402057
; ---------------------------------------------------------------------------

loc_401D83:				; CODE XREF: sub_401BF8+16Ej
		cmp	eax, 20Fh
		jz	loc_401F8C
		cmp	eax, 20Fh
		jg	loc_401F9C
		cmp	eax, 20Eh
		jz	loc_401F6D
		jmp	loc_402057
; ---------------------------------------------------------------------------

loc_401DA9:				; CODE XREF: sub_401BF8+102j
		cmp	eax, 218h
		jz	loc_40200F
		cmp	eax, 218h
		jg	short loc_401E03
		cmp	eax, 214h
		jz	loc_401FDB
		cmp	eax, 214h
		jg	short loc_401DE8
		cmp	eax, 212h
		jz	loc_401FBC
		cmp	eax, 213h
		jz	loc_401FCC
		jmp	loc_402057
; ---------------------------------------------------------------------------

loc_401DE8:				; CODE XREF: sub_401BF8+1D3j
		cmp	eax, 216h
		jz	loc_401FF5
		cmp	eax, 216h
		jg	loc_402002
		jmp	loc_401FE8
; ---------------------------------------------------------------------------

loc_401E03:				; CODE XREF: sub_401BF8+1C1j
		cmp	eax, 21Eh
		jz	loc_402033
		cmp	eax, 21Eh
		jg	short loc_401E30
		cmp	eax, 21Ch
		jz	loc_40201B
		cmp	eax, 21Dh
		jz	loc_402027
		jmp	loc_402057
; ---------------------------------------------------------------------------

loc_401E30:				; CODE XREF: sub_401BF8+21Bj
		cmp	eax, 220h
		jz	loc_40204B
		cmp	eax, 220h
		jl	loc_40203F
		cmp	eax, 225h
		jz	loc_401F7D
		jmp	loc_402057
; ---------------------------------------------------------------------------

loc_401E56:				; CODE XREF: sub_401BF8+12Fj
		mov	ds:dword_449DA8, 1
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401E65:				; CODE XREF: sub_401BF8+138j
		mov	eax, ds:dword_449DA4
		add	eax, 1
		mov	ds:dword_449DA4, eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401E77:				; CODE XREF: sub_401BF8+11Fj
		mov	edx, ds:dword_449DA0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		or	eax, edx
		mov	ds:dword_449DA0, eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401E8F:				; CODE XREF: sub_401BF8+148j
		mov	ds:dword_449DA0, 0FFFFFFFFh
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401E9E:				; CODE XREF: sub_401BF8+153j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:Str,	eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401EAE:				; CODE XREF: sub_401BF8+175j
		cmp	[ebp+arg_4], 0
		jnz	short loc_401EBE
		mov	eax, 0
		jmp	locret_402064
; ---------------------------------------------------------------------------

loc_401EBE:				; CODE XREF: sub_401BF8+2BAj
		mov	eax, ds:Str1
		test	eax, eax
		jz	short loc_401EF0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_401EF0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, ds:Str1
		mov	[esp+18h+Str2],	edx ; Str2
		mov	[esp+18h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_40205E

loc_401EF0:				; CODE XREF: sub_401BF8+2CDj
					; sub_401BF8+2D7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+Str1],	eax ; char *
		call	sub_4355C4
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_401F19
		call	sub_435769
		mov	[esp+18h+Str1],	eax
		call	assuan_set_assuan_log_stream

loc_401F19:				; CODE XREF: sub_401BF8+312j
		mov	eax, ds:Str1
		mov	[esp+18h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+Str1],	eax
		call	gcry_strdup
		mov	ds:Str1, eax
		jmp	loc_40205E
; ---------------------------------------------------------------------------

loc_401F3E:				; CODE XREF: sub_401BF8+10Dj
		mov	ds:dword_449DD8, 1
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401F4D:				; CODE XREF: sub_401BF8+180j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DCC, eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401F5D:				; CODE XREF: sub_401BF8+163j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DDC, eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401F6D:				; CODE XREF: sub_401BF8+1A6j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DD0, eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401F7D:				; CODE XREF: sub_401BF8+253j
		mov	ds:dword_449DD4, 1
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401F8C:				; CODE XREF: sub_401BF8+190j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DE0, eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401F9C:				; CODE XREF: sub_401BF8+19Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DE4, eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401FAC:				; CODE XREF: sub_401BF8+F7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DE8, eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401FBC:				; CODE XREF: sub_401BF8+1DAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DEC, eax
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401FCC:				; CODE XREF: sub_401BF8+1E5j
		mov	ds:dword_449DF0, 1
		jmp	loc_40205F
; ---------------------------------------------------------------------------

loc_401FDB:				; CODE XREF: sub_401BF8+1C8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DF4, eax
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_401FE8:				; CODE XREF: sub_401BF8+206j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DF8, eax
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_401FF5:				; CODE XREF: sub_401BF8+1F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449DFC, eax
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_402002:				; CODE XREF: sub_401BF8+200j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	ds:dword_449E00, eax
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_40200F:				; CODE XREF: sub_401BF8+1B6j
		mov	ds:dword_449E04, 1
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_40201B:				; CODE XREF: sub_401BF8+222j
		mov	ds:dword_449E0C, 1
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_402027:				; CODE XREF: sub_401BF8+22Dj
		mov	ds:dword_449E10, 1
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_402033:				; CODE XREF: sub_401BF8+210j
		mov	ds:dword_449E10, 0
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_40203F:				; CODE XREF: sub_401BF8+248j
		mov	ds:dword_449E14, 1
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_40204B:				; CODE XREF: sub_401BF8+23Dj
		mov	ds:dword_449E18, 0
		jmp	short loc_40205F
; ---------------------------------------------------------------------------

loc_402057:				; CODE XREF: sub_401BF8+13Ej
					; sub_401BF8+159j ...
		mov	eax, 0
		jmp	short locret_402064
; ---------------------------------------------------------------------------

loc_40205E:				; CODE XREF: sub_401BF8+2F2j
					; sub_401BF8+341j
		nop

loc_40205F:				; CODE XREF: sub_401BF8+268j
					; sub_401BF8+27Aj ...
		mov	eax, 1

locret_402064:				; CODE XREF: sub_401BF8+E7j
					; sub_401BF8+2C1j ...
		leave
		retn
sub_401BF8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402066	proc near		; CODE XREF: sub_401180+265p

VarName		= dword	ptr -0FCh
Str2		= dword	ptr -0F8h
Radix		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_D0		= dword	ptr -0D0h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
Str		= dword	ptr -98h
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
Filename	= dword	ptr -14h
File		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 0F0h
		call	sub_43B250
		mov	[esp+0FCh+File], 0
		mov	[esp+0FCh+Filename], 0
		mov	[esp+0FCh+var_18], 0
		mov	[esp+0FCh+var_1C], 1
		mov	[esp+0FCh+var_20], 0
		mov	[esp+0FCh+var_24], 0
		mov	[esp+0FCh+var_28], 0
		mov	[esp+0FCh+var_2C], 0
		mov	[esp+0FCh+var_4C], 0
		mov	[esp+0FCh+var_50], 0
		mov	[esp+0FCh+var_30], 0
		mov	[esp+0FCh+var_34], 0
		mov	[esp+0FCh+var_38], 0
		mov	[esp+0FCh+var_54], 0
		call	sub_41CF97
		mov	ds:dword_449024, eax
		mov	[esp+0FCh+VarName], offset sub_401748
		call	sub_437F22
		mov	[esp+0FCh+VarName], 1Ch
		call	gcry_control
		mov	[esp+0FCh+Str2], 5 ; int
		mov	[esp+0FCh+VarName], offset aGpgAgent ; "gpg-agent"
		call	sub_435614
		call	sub_41DE5C
		call	sub_41DED4
		mov	[esp+0FCh+VarName], offset a1_5_0 ; "1.5.0"
		call	gcry_check_version
		test	eax, eax
		jnz	short loc_40219A
		mov	[esp+0FCh+VarName], 0
		call	gcry_check_version
		mov	ebx, eax
		mov	[esp+0FCh+VarName], offset aSIsTooOldNeedS ; "%s is too	old (need %s, have %s)\n"
		call	sub_435294
		mov	[esp+0FCh+var_F0], ebx
		mov	[esp+0FCh+Radix], offset a1_5_0	; "1.5.0"
		mov	[esp+0FCh+Str2], offset	aLibgcrypt ; "libgcrypt"
		mov	[esp+0FCh+VarName], eax	; char *
		call	sub_435BC0
; ---------------------------------------------------------------------------

loc_40219A:				; CODE XREF: sub_402066+FCj
		mov	[esp+0FCh+var_C0], offset gcry_malloc
		mov	[esp+0FCh+var_BC], offset gcry_realloc
		mov	[esp+0FCh+var_B8], offset gcry_free
		lea	eax, [esp+0FCh+var_C0]
		mov	[esp+0FCh+VarName], eax
		call	assuan_set_malloc_hooks
		mov	[esp+0FCh+VarName], 0
		call	sub_435672
		mov	[esp+0FCh+VarName], eax
		call	assuan_set_assuan_log_prefix
		mov	[esp+0FCh+VarName], 4
		call	assuan_set_gpg_err_source
		mov	[esp+0FCh+VarName], offset dword_43D380
		call	assuan_set_system_hooks
		call	assuan_sock_init
		call	sub_41E06D
		mov	[esp+0FCh+VarName], 16h
		call	gcry_control
		call	sub_41E421
		mov	[esp+0FCh+Str2], 0
		mov	[esp+0FCh+VarName], 0
		call	sub_401BF8
		mov	ds:dword_449DC4, 1
		mov	[esp+0FCh+VarName], offset VarName ; "SHELL"
		call	getenv
		mov	[esp+0FCh+var_58], eax
		cmp	[esp+0FCh+var_58], 0
		jz	short loc_4022B8
		mov	eax, [esp+0FCh+var_58]
		mov	[esp+0FCh+var_D0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+0FCh+var_D0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 2
		jbe	short loc_4022B8
		mov	eax, [esp+0FCh+var_58]
		mov	[esp+0FCh+var_D0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+0FCh+var_D0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 3
		add	eax, [esp+0FCh+var_58]
		mov	[esp+0FCh+Str2], offset	Str2 ; "csh"
		mov	[esp+0FCh+VarName], eax	; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4022B8
		mov	[esp+0FCh+var_50], 1

loc_4022B8:				; CODE XREF: sub_402066+1D8j
					; sub_402066+202j ...
		call	sub_41ECD9
		mov	ds:dword_449DB4, eax
		mov	[esp+0FCh+var_3C], 0
		call	sub_41FB5C
		mov	ds:dword_449DB8, eax
		mov	eax, ds:dword_449DB8
		test	eax, eax
		jnz	short loc_4022EC
		call	sub_4015AD
		mov	[esp+0FCh+var_3C], eax

loc_4022EC:				; CODE XREF: sub_402066+278j
		mov	[esp+0FCh+var_40], 0
		jmp	short loc_402359
; ---------------------------------------------------------------------------

loc_4022F9:				; CODE XREF: sub_402066+30Dj
		mov	eax, [esp+0FCh+var_40]
		mov	eax, off_43D3B4[eax*4]
		mov	[esp+0FCh+VarName], eax	; VarName
		call	getenv
		mov	[esp+0FCh+var_5C], eax
		cmp	[esp+0FCh+var_5C], 0
		jz	short loc_402351
		mov	eax, [esp+0FCh+var_40]
		mov	edx, off_43D3B4[eax*4]
		mov	eax, ds:dword_449DB8
		mov	ecx, [esp+0FCh+var_5C]
		mov	[esp+0FCh+Radix], ecx ;	int
		mov	[esp+0FCh+Str2], edx ; char *
		mov	[esp+0FCh+VarName], eax	; int
		call	sub_42008C
		mov	[esp+0FCh+var_3C], eax

loc_402351:				; CODE XREF: sub_402066+2B8j
		add	[esp+0FCh+var_40], 1

loc_402359:				; CODE XREF: sub_402066+291j
		cmp	[esp+0FCh+var_3C], 0
		jnz	short loc_402375
		mov	eax, [esp+0FCh+var_40]
		mov	eax, off_43D3B4[eax*4]
		test	eax, eax
		jnz	short loc_4022F9

loc_402375:				; CODE XREF: sub_402066+2FBj
		cmp	[esp+0FCh+var_3C], 0
		jnz	short loc_4023C3
		mov	[esp+0FCh+VarName], 0
		call	sub_4015C2
		mov	[esp+0FCh+var_5C], eax
		cmp	[esp+0FCh+var_5C], 0
		jz	short loc_4023C3
		mov	eax, ds:dword_449DB8
		mov	edx, [esp+0FCh+var_5C]
		mov	[esp+0FCh+Radix], edx ;	int
		mov	[esp+0FCh+Str2], offset	aGpg_tty ; "GPG_TTY"
		mov	[esp+0FCh+VarName], eax	; int
		call	sub_42008C
		mov	[esp+0FCh+var_3C], eax

loc_4023C3:				; CODE XREF: sub_402066+317j
					; sub_402066+334j
		cmp	[esp+0FCh+var_3C], 0
		jz	short loc_4023EC
		mov	eax, [esp+0FCh+var_3C]
		mov	[esp+0FCh+VarName], eax
		call	gpg_strerror
		mov	[esp+0FCh+Str2], eax ; char
		mov	[esp+0FCh+VarName], offset aErrorRecording ; "error recording startup environment: %s"...
		call	sub_435BC0
; ---------------------------------------------------------------------------

loc_4023EC:				; CODE XREF: sub_402066+365j
		mov	[esp+0FCh+VarName], offset aLc_ctype ; "LC_CTYPE"
		call	getenv
		mov	ds:dword_449DBC, eax
		mov	eax, ds:dword_449DBC
		test	eax, eax
		jz	short loc_402418
		mov	eax, ds:dword_449DBC
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_449DBC, eax

loc_402418:				; CODE XREF: sub_402066+39Ej
		mov	[esp+0FCh+VarName], offset aLc_messages	; "LC_MESSAGES"
		call	getenv
		mov	ds:dword_449DC0, eax
		mov	eax, ds:dword_449DC0
		test	eax, eax
		jz	short loc_402444
		mov	eax, ds:dword_449DC0
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_449DC0, eax

loc_402444:				; CODE XREF: sub_402066+3CAj
		mov	eax, [ebp+arg_0]
		mov	[esp+0FCh+var_60], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0FCh+var_64], eax
		lea	eax, [ebp+arg_0]
		mov	[esp+0FCh+var_B0], eax
		lea	eax, [ebp+arg_4]
		mov	[esp+0FCh+var_AC], eax
		mov	[esp+0FCh+var_A8], 41h
		jmp	short loc_4024D4
; ---------------------------------------------------------------------------

loc_402470:				; CODE XREF: sub_402066+484j
		mov	eax, [esp+0FCh+var_A0]
		cmp	eax, 1F9h
		jz	short loc_402486
		mov	eax, [esp+0FCh+var_A0]
		cmp	eax, 1FAh
		jnz	short loc_402490

loc_402486:				; CODE XREF: sub_402066+413j
		add	[esp+0FCh+var_18], 1
		jmp	short loc_4024D4
; ---------------------------------------------------------------------------

loc_402490:				; CODE XREF: sub_402066+41Ej
		mov	eax, [esp+0FCh+var_A0]
		cmp	eax, 1F8h
		jnz	short loc_4024A8
		mov	[esp+0FCh+var_1C], 0
		jmp	short loc_4024D4
; ---------------------------------------------------------------------------

loc_4024A8:				; CODE XREF: sub_402066+433j
		mov	eax, [esp+0FCh+var_A0]
		cmp	eax, 1FEh
		jnz	short loc_4024C0
		mov	[esp+0FCh+var_1C], 0
		jmp	short loc_4024D4
; ---------------------------------------------------------------------------

loc_4024C0:				; CODE XREF: sub_402066+44Bj
		mov	eax, [esp+0FCh+var_A0]
		cmp	eax, 1FFh
		jnz	short loc_4024D4
		mov	eax, [esp+0FCh+Str]
		mov	ds:dword_449DB4, eax

loc_4024D4:				; CODE XREF: sub_402066+408j
					; sub_402066+428j ...
		mov	[esp+0FCh+Str2], offset	dword_43D000
		lea	eax, [esp+0FCh+var_B0]
		mov	[esp+0FCh+VarName], eax
		call	sub_436C8D
		test	eax, eax
		jnz	short loc_402470
		mov	[esp+0FCh+Radix], 0
		mov	[esp+0FCh+Str2], 8000h
		mov	[esp+0FCh+VarName], 18h
		call	gcry_control
		mov	dword_43D360, 0
		cmp	[esp+0FCh+var_1C], 0
		jz	short loc_402540
		mov	eax, ds:dword_449DB4
		mov	[esp+0FCh+Radix], 0
		mov	[esp+0FCh+Str2], offset	aGpgAgent_conf ; "gpg-agent.conf"
		mov	[esp+0FCh+VarName], eax
		call	sub_432667
		mov	[esp+0FCh+Filename], eax

loc_402540:				; CODE XREF: sub_402066+4B4j
		mov	eax, [esp+0FCh+var_60]
		mov	[ebp+arg_0], eax
		mov	eax, [esp+0FCh+var_64]
		mov	[ebp+arg_4], eax
		lea	ecx, [ebp+arg_0]
		mov	[esp+0FCh+var_B0], ecx
		lea	eax, [ebp+arg_4]
		mov	[esp+0FCh+var_AC], eax
		mov	[esp+0FCh+var_A8], 1

loc_40256A:				; CODE XREF: sub_402066+876j
					; sub_402066+B26j
		cmp	[esp+0FCh+Filename], 0
		jz	loc_402AF2
		mov	[esp+0FCh+var_B4], 0
		mov	edx, offset Mode ; "r"
		mov	eax, [esp+0FCh+Filename]
		mov	[esp+0FCh+Str2], edx ; Mode
		mov	[esp+0FCh+VarName], eax	; Filename
		call	fopen
		mov	[esp+0FCh+File], eax
		cmp	[esp+0FCh+File], 0
		jnz	loc_402662
		cmp	[esp+0FCh+var_1C], 0
		jz	short loc_402620
		cmp	[esp+0FCh+var_18], 0
		jz	short loc_4025E0
		mov	[esp+0FCh+VarName], offset aNoteNoDefaultO ; "NOTE: no default option file `%s'\n"
		call	sub_435294
		mov	edx, [esp+0FCh+Filename]
		mov	[esp+0FCh+Str2], edx ; char
		mov	[esp+0FCh+VarName], eax	; char *
		call	sub_435B53

loc_4025E0:				; CODE XREF: sub_402066+559j
		mov	eax, ds:Filename
		mov	[esp+0FCh+VarName], eax
		call	gcry_free
		mov	eax, [esp+0FCh+Filename]
		mov	ds:Filename, eax
		mov	[esp+0FCh+Filename], 0
		mov	eax, [esp+0FCh+Filename]
		mov	[esp+0FCh+VarName], eax
		call	gcry_free
		mov	[esp+0FCh+Filename], 0
		jmp	short loc_402662
; ---------------------------------------------------------------------------

loc_402620:				; CODE XREF: sub_402066+54Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0FCh+VarName], eax	; int
		call	strerror
		mov	ebx, eax
		mov	[esp+0FCh+VarName], offset aOptionFileSS ; "option file	`%s': %s\n"
		call	sub_435294
		mov	[esp+0FCh+Radix], ebx
		mov	edx, [esp+0FCh+Filename]
		mov	[esp+0FCh+Str2], edx ; char
		mov	[esp+0FCh+VarName], eax	; char *
		call	sub_435B7D
		mov	[esp+0FCh+VarName], 2 ;	Code
		call	exit
; ---------------------------------------------------------------------------

loc_402662:				; CODE XREF: sub_402066+541j
					; sub_402066+5B8j
		cmp	[esp+0FCh+var_18], 0
		jz	short loc_402695
		cmp	[esp+0FCh+Filename], 0
		jz	short loc_402695
		mov	[esp+0FCh+VarName], offset aReadingOptions ; "reading options from `%s'\n"
		call	sub_435294
		mov	edx, [esp+0FCh+Filename]
		mov	[esp+0FCh+Str2], edx ; char
		mov	[esp+0FCh+VarName], eax	; char *
		call	sub_435B53

loc_402695:				; CODE XREF: sub_402066+604j
					; sub_402066+60Ej
		mov	[esp+0FCh+var_1C], 0
		jmp	loc_402AF2
; ---------------------------------------------------------------------------

loc_4026A5:				; CODE XREF: sub_402066+ACAj
		mov	[esp+0FCh+Str2], 0
		lea	eax, [esp+0FCh+var_B0]
		mov	[esp+0FCh+VarName], eax
		call	sub_401BF8
		test	eax, eax
		jnz	loc_402AF5
		mov	eax, [esp+0FCh+var_A0]
		cmp	eax, 204h
		jz	loc_40295E
		cmp	eax, 204h
		jg	loc_40278F
		cmp	eax, 1F8h
		jz	loc_4028AC
		cmp	eax, 1F8h
		jg	short loc_402731
		cmp	eax, 1F4h
		jz	loc_4028F1
		cmp	eax, 1F4h
		jg	short loc_402716
		cmp	eax, 63h
		jz	loc_40292E
		cmp	eax, 73h
		jz	loc_40293E
		jmp	loc_402AD6
; ---------------------------------------------------------------------------

loc_402716:				; CODE XREF: sub_402066+697j
		cmp	eax, 1F6h
		jz	loc_40286D
		cmp	eax, 1F6h
		jg	loc_40287D
		jmp	loc_40285D
; ---------------------------------------------------------------------------

loc_402731:				; CODE XREF: sub_402066+685j
		cmp	eax, 1FFh
		jz	loc_402900
		cmp	eax, 1FFh
		jg	short loc_402769
		cmp	eax, 1FDh
		jz	loc_4028E1
		cmp	eax, 1FDh
		jg	loc_402AF8
		cmp	eax, 1FCh
		jz	loc_40289C
		jmp	loc_402AD6
; ---------------------------------------------------------------------------

loc_402769:				; CODE XREF: sub_402066+6DBj
		cmp	eax, 202h
		jz	loc_40291E
		cmp	eax, 202h
		jg	loc_40294E
		cmp	eax, 200h
		jz	loc_40290E
		jmp	loc_402AD6
; ---------------------------------------------------------------------------

loc_40278F:				; CODE XREF: sub_402066+66Fj
		cmp	eax, 219h
		jz	loc_4029ED
		cmp	eax, 219h
		jg	short loc_4027FF
		cmp	eax, 20Ah
		jz	loc_40299A
		cmp	eax, 20Ah
		jg	short loc_4027D9
		cmp	eax, 208h
		jz	loc_40296E
		cmp	eax, 208h
		jg	loc_402984
		cmp	eax, 205h
		jz	loc_40288D
		jmp	loc_402AD6
; ---------------------------------------------------------------------------

loc_4027D9:				; CODE XREF: sub_402066+74Bj
		cmp	eax, 20Ch
		jz	loc_4029C6
		cmp	eax, 20Ch
		jl	loc_4029B0
		cmp	eax, 20Dh
		jz	loc_4029D7
		jmp	loc_402AD6
; ---------------------------------------------------------------------------

loc_4027FF:				; CODE XREF: sub_402066+739j
		cmp	eax, 222h
		jz	loc_402A76
		cmp	eax, 222h
		jg	short loc_402837
		cmp	eax, 21Bh
		jz	loc_402A0B
		cmp	eax, 21Bh
		jl	loc_4029FC
		cmp	eax, 221h
		jz	loc_402A67
		jmp	loc_402AD6
; ---------------------------------------------------------------------------

loc_402837:				; CODE XREF: sub_402066+7A9j
		cmp	eax, 224h
		jz	loc_402A8E
		cmp	eax, 224h
		jl	loc_402A82
		cmp	eax, 226h
		jz	loc_402AA4
		jmp	loc_402AD6
; ---------------------------------------------------------------------------

loc_40285D:				; CODE XREF: sub_402066+6C6j
		mov	[esp+0FCh+var_38], 1
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40286D:				; CODE XREF: sub_402066+6B5j
		mov	[esp+0FCh+var_38], 2
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40287D:				; CODE XREF: sub_402066+6C0j
		mov	[esp+0FCh+var_38], 3
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40288D:				; CODE XREF: sub_402066+768j
		mov	ds:dword_449DB0, 1
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40289C:				; CODE XREF: sub_402066+6F8j
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+var_34], eax
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_4028AC:				; CODE XREF: sub_402066+67Aj
		cmp	[esp+0FCh+File], 0
		jnz	loc_402AFB
		mov	eax, [esp+0FCh+Filename]
		mov	[esp+0FCh+VarName], eax
		call	gcry_free
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	[esp+0FCh+Filename], eax
		jmp	loc_40256A
; ---------------------------------------------------------------------------

loc_4028E1:				; CODE XREF: sub_402066+6E2j
		mov	[esp+0FCh+var_24], 1
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_4028F1:				; CODE XREF: sub_402066+68Cj
		mov	ds:dword_449DA4, 0
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_402900:				; CODE XREF: sub_402066+6D0j
		mov	eax, [esp+0FCh+Str]
		mov	ds:dword_449DB4, eax
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40290E:				; CODE XREF: sub_402066+71Ej
		mov	[esp+0FCh+var_4C], 1
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40291E:				; CODE XREF: sub_402066+708j
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+var_30], eax
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40292E:				; CODE XREF: sub_402066+69Cj
		mov	[esp+0FCh+var_50], 1
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40293E:				; CODE XREF: sub_402066+6A5j
		mov	[esp+0FCh+var_50], 0
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40294E:				; CODE XREF: sub_402066+713j
		mov	[esp+0FCh+var_28], 1
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40295E:				; CODE XREF: sub_402066+664j
		mov	[esp+0FCh+var_2C], 1
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40296E:				; CODE XREF: sub_402066+752j
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_449060, eax
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_402984:				; CODE XREF: sub_402066+75Dj
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_449064, eax
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_40299A:				; CODE XREF: sub_402066+740j
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_449068, eax
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_4029B0:				; CODE XREF: sub_402066+783j
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_44906C, eax
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_4029C6:				; CODE XREF: sub_402066+778j
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_449070, eax

loc_4029D7:				; CODE XREF: sub_402066+78Ej
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_449074, eax
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_4029ED:				; CODE XREF: sub_402066+72Ej
		mov	ds:dword_449DC4, 1
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_4029FC:				; CODE XREF: sub_402066+7BBj
		mov	ds:dword_449DC4, 0
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_402A0B:				; CODE XREF: sub_402066+7B0j
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+VarName], eax
		call	sub_42082F
		mov	[esp+0FCh+var_44], eax
		cmp	[esp+0FCh+var_44], 0FFFFFFFFh
		jnz	short loc_402A4B
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+Radix], 0Ah ;	Radix
		mov	[esp+0FCh+Str2], 0 ; EndPtr
		mov	[esp+0FCh+VarName], eax	; Str
		call	strtoul
		mov	[esp+0FCh+var_44], eax

loc_402A4B:				; CODE XREF: sub_402066+9C0j
		mov	[esp+0FCh+Str2], 0
		mov	eax, [esp+0FCh+var_44]
		mov	[esp+0FCh+VarName], eax
		call	sub_4205B5
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_402A67:				; CODE XREF: sub_402066+7C6j
		mov	ds:dword_449E1C, 1
		jmp	loc_402AFC
; ---------------------------------------------------------------------------

loc_402A76:				; CODE XREF: sub_402066+79Ej
		mov	ds:dword_449E20, 1
		jmp	short loc_402AFC
; ---------------------------------------------------------------------------

loc_402A82:				; CODE XREF: sub_402066+7E1j
		mov	ds:dword_449E24, 1
		jmp	short loc_402AFC
; ---------------------------------------------------------------------------

loc_402A8E:				; CODE XREF: sub_402066+7D6j
		mov	ds:dword_449020, 1
		mov	ds:dword_449E24, 1
		jmp	short loc_402AFC
; ---------------------------------------------------------------------------

loc_402AA4:				; CODE XREF: sub_402066+7ECj
		mov	eax, [esp+0FCh+var_9C]
		test	eax, eax
		jz	short loc_402AB9
		mov	eax, [esp+0FCh+Str]
		mov	[esp+0FCh+var_54], eax
		jmp	short loc_402AFC
; ---------------------------------------------------------------------------

loc_402AB9:				; CODE XREF: sub_402066+A44j
		mov	[esp+0FCh+Str2], 0
		mov	[esp+0FCh+VarName], offset a_gpgAgentInfo ; "~/.gpg-agent-info"
		call	sub_432667
		mov	[esp+0FCh+var_54], eax
		jmp	short loc_402AFC
; ---------------------------------------------------------------------------

loc_402AD6:				; CODE XREF: sub_402066+6ABj
					; sub_402066+6FEj ...
		cmp	[esp+0FCh+File], 0
		jz	short loc_402AE7
		mov	eax, 1
		jmp	short loc_402AEC
; ---------------------------------------------------------------------------

loc_402AE7:				; CODE XREF: sub_402066+A78j
		mov	eax, 2

loc_402AEC:				; CODE XREF: sub_402066+A7Fj
		mov	[esp+0FCh+var_A4], eax
		jmp	short loc_402AFC
; ---------------------------------------------------------------------------

loc_402AF2:				; CODE XREF: sub_402066+50Cj
					; sub_402066+63Aj
		nop
		jmp	short loc_402AFC
; ---------------------------------------------------------------------------

loc_402AF5:				; CODE XREF: sub_402066+655j
		nop
		jmp	short loc_402AFC
; ---------------------------------------------------------------------------

loc_402AF8:				; CODE XREF: sub_402066+6EDj
		nop
		jmp	short loc_402AFC
; ---------------------------------------------------------------------------

loc_402AFB:				; CODE XREF: sub_402066+84Ej
		nop

loc_402AFC:				; CODE XREF: sub_402066+802j
					; sub_402066+812j ...
		mov	[esp+0FCh+var_EC], offset dword_43D000 ; int
		lea	eax, [esp+0FCh+var_B0]
		mov	[esp+0FCh+var_F0], eax ; int
		lea	eax, [esp+0FCh+var_B4]
		mov	[esp+0FCh+Radix], eax ;	int
		mov	eax, [esp+0FCh+Filename]
		mov	[esp+0FCh+Str2], eax ; int
		mov	eax, [esp+0FCh+File]
		mov	[esp+0FCh+VarName], eax	; FILE *
		call	sub_4362AA
		test	eax, eax
		jnz	loc_4026A5
		cmp	[esp+0FCh+File], 0
		jz	short loc_402B91
		mov	eax, [esp+0FCh+File]
		mov	[esp+0FCh+VarName], eax	; File
		call	fclose
		mov	[esp+0FCh+File], 0
		mov	eax, ds:Filename
		cmp	eax, [esp+0FCh+Filename]
		jz	short loc_402B81
		mov	eax, ds:Filename
		mov	[esp+0FCh+VarName], eax
		call	gcry_free
		mov	eax, [esp+0FCh+Filename]
		mov	ds:Filename, eax

loc_402B81:				; CODE XREF: sub_402066+B00j
		mov	[esp+0FCh+Filename], 0
		jmp	loc_40256A
; ---------------------------------------------------------------------------

loc_402B91:				; CODE XREF: sub_402066+AD8j
		mov	eax, [esp+0FCh+Filename]
		mov	[esp+0FCh+VarName], eax
		call	gcry_free
		mov	[esp+0FCh+Filename], 0
		mov	[esp+0FCh+VarName], 0
		call	sub_435330
		test	eax, eax
		jz	short loc_402BC7
		mov	[esp+0FCh+VarName], 2 ;	Code
		call	exit
; ---------------------------------------------------------------------------

loc_402BC7:				; CODE XREF: sub_402066+B53j
		cmp	[esp+0FCh+var_24], 0
		jz	short loc_402BDC
		mov	[esp+0FCh+var_20], 0

loc_402BDC:				; CODE XREF: sub_402066+B69j
		cmp	[esp+0FCh+var_20], 0
		jz	short loc_402C5E
		mov	[esp+0FCh+VarName], 0Eh
		call	sub_437E99
		mov	esi, eax
		mov	[esp+0FCh+VarName], 0Dh
		call	sub_437E99
		mov	ebx, eax
		mov	[esp+0FCh+VarName], 0Bh
		call	sub_437E99
		mov	edx, offset Format ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0FCh+var_EC], esi
		mov	[esp+0FCh+var_F0], ebx
		mov	[esp+0FCh+Radix], eax
		mov	[esp+0FCh+Str2], edx ; Format
		mov	[esp+0FCh+VarName], ecx	; File
		call	fprintf
		mov	[esp+0FCh+VarName], 0Fh
		call	sub_437E99
		mov	edx, offset aS	; "%s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0FCh+Radix], eax
		mov	[esp+0FCh+Str2], edx ; char
		mov	[esp+0FCh+VarName], ecx	; File
		call	fprintf

loc_402C5E:				; CODE XREF: sub_402066+B7Ej
		call	sub_4017ED
		mov	[esp+0FCh+VarName], offset sub_401BD6 ;	_onexit_t
		call	sub_43A630
		test	eax, eax
		jz	short loc_402C90
		mov	[esp+0FCh+VarName], offset aAtexitFailed ; "atexit failed\n"
		call	sub_435B7D
		call	sub_401BD6
		mov	[esp+0FCh+VarName], 1 ;	Code
		call	exit
; ---------------------------------------------------------------------------

loc_402C90:				; CODE XREF: sub_402066+C0Bj
		call	sub_40E559
		call	sub_41A03C
		call	sub_417D25
		call	sub_403D1A
		cmp	[esp+0FCh+var_34], 0
		jz	short loc_402CE8
		cmp	[esp+0FCh+var_28], 0
		jz	short loc_402CE8
		call	_getpid
		mov	[esp+0FCh+Str2], eax ; char
		mov	[esp+0FCh+VarName], offset aWaitingForDebu ; "waiting for debugger - my	pid is %u ..."...
		call	sub_435C1A
		mov	eax, [esp+0FCh+var_34]
		mov	[esp+0FCh+VarName], eax
		call	sub_41E499
		mov	[esp+0FCh+VarName], offset a___Okay ; "... okay\n"
		call	sub_435C1A

loc_402CE8:				; CODE XREF: sub_402066+C46j
					; sub_402066+C50j
		cmp	[esp+0FCh+var_38], 3
		jnz	short loc_402D07
		mov	eax, ds:dword_449DC4
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[esp+0FCh+VarName], eax
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_402D07:				; CODE XREF: sub_402066+C8Aj
		cmp	[esp+0FCh+var_38], 2
		jnz	short loc_402D1D
		mov	[esp+0FCh+VarName], 0
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_402D1D:				; CODE XREF: sub_402066+CA9j
		cmp	[esp+0FCh+var_38], 0
		jz	loc_402F6C
		mov	eax, ds:dword_449DB4
		mov	[esp+0FCh+Radix], 0
		mov	[esp+0FCh+Str2], offset	aGpgAgent_conf ; "gpg-agent.conf"
		mov	[esp+0FCh+VarName], eax
		call	sub_432667
		mov	[esp+0FCh+var_68], eax
		mov	[esp+0FCh+Str2], 0 ; char *
		mov	eax, [esp+0FCh+var_68]
		mov	[esp+0FCh+VarName], eax	; int
		call	sub_43358E
		mov	[esp+0FCh+var_6C], eax
		mov	eax, offset aGpgconfGpgAgen ; "gpgconf-gpg-agent.conf:%lu:\"%s\n"
		mov	edx, [esp+0FCh+var_6C]
		mov	[esp+0FCh+Radix], edx
		mov	[esp+0FCh+Str2], 10h
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, [esp+0FCh+var_68]
		mov	[esp+0FCh+VarName], eax
		call	gcry_free
		mov	eax, [esp+0FCh+var_6C]
		mov	[esp+0FCh+VarName], eax
		call	gcry_free
		mov	eax, offset aVerboseLuQuiet ; "verbose:%lu:\nquiet:%lu:\ndebug-level:%"...
		mov	[esp+0FCh+var_EC], 8
		mov	[esp+0FCh+var_F0], 18h
		mov	[esp+0FCh+Radix], 8
		mov	[esp+0FCh+Str2], 8
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aDefaultCacheTt ; "default-cache-ttl:%lu:%d:\n"
		mov	[esp+0FCh+Radix], 258h
		mov	[esp+0FCh+Str2], 18h
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aDefaultCache_0 ; "default-cache-ttl-ssh:%lu:%d:\n"
		mov	[esp+0FCh+Radix], 708h
		mov	[esp+0FCh+Str2], 18h
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aMaxCacheTtlLuD ; "max-cache-ttl:%lu:%d:\n"
		mov	[esp+0FCh+Radix], 1C20h
		mov	[esp+0FCh+Str2], 18h
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aMaxCacheTtlSsh ; "max-cache-ttl-ssh:%lu:%d:\n"
		mov	[esp+0FCh+Radix], 1C20h
		mov	[esp+0FCh+Str2], 18h
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aEnforcePassphr ; "enforce-passphrase-constraints:%lu:\n"
		mov	[esp+0FCh+Str2], 8
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aMinPassphraseL ; "min-passphrase-len:%lu:%d:\n"
		mov	[esp+0FCh+Radix], 8
		mov	[esp+0FCh+Str2], 18h
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aMinPassphraseN ; "min-passphrase-nonalpha:%lu:%d:\n"
		mov	[esp+0FCh+Radix], 1
		mov	[esp+0FCh+Str2], 18h
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aCheckPassphras ; "check-passphrase-pattern:%lu:\n"
		mov	[esp+0FCh+Str2], 18h
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aMaxPassphraseD ; "max-passphrase-days:%lu:%d:\n"
		mov	[esp+0FCh+Radix], 0
		mov	[esp+0FCh+Str2], 18h
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aEnablePassphra ; "enable-passphrase-history:%lu:\n"
		mov	[esp+0FCh+Str2], 8
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aNoGrabLu ;	"no-grab:%lu:\n"
		mov	[esp+0FCh+Str2], 8
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aIgnoreCacheFor ; "ignore-cache-for-signing:%lu:\n"
		mov	[esp+0FCh+Str2], 8
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aNoAllowMarkTru ; "no-allow-mark-trusted:%lu:\n"
		mov	[esp+0FCh+Str2], 8
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aNoAllowExterna ; "no-allow-external-cache:%lu:\n"
		mov	[esp+0FCh+Str2], 8
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aDisableScdaemo ; "disable-scdaemon:%lu:\n"
		mov	[esp+0FCh+Str2], 8
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	eax, offset aEnablePuttySup ; "enable-putty-support:%lu:\n"
		mov	[esp+0FCh+Str2], 0
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	[esp+0FCh+VarName], 0
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_402F6C:				; CODE XREF: sub_402066+CBFj
		cmp	[esp+0FCh+var_28], 0
		jnz	short loc_402FB4
		cmp	[esp+0FCh+var_2C], 0
		jnz	short loc_402FB4
		mov	[esp+0FCh+Str2], 1 ; int
		mov	[esp+0FCh+VarName], 0 ;	char *
		call	sub_435614
		mov	[esp+0FCh+Str2], 0
		mov	[esp+0FCh+VarName], 0
		call	sub_4052F2
		mov	[esp+0FCh+VarName], 0
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_402FB4:				; CODE XREF: sub_402066+F0Ej
					; sub_402066+F18j
		cmp	[esp+0FCh+var_30], 0
		jz	short loc_402FF5
		mov	eax, [esp+0FCh+var_30]
		mov	[esp+0FCh+VarName], eax	; char *
		call	sub_4355C4
		mov	[esp+0FCh+Str2], 7 ; int
		mov	[esp+0FCh+VarName], 0 ;	char *
		call	sub_435614
		mov	eax, [esp+0FCh+var_30]
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:Str1, eax

loc_402FF5:				; CODE XREF: sub_402066+F56j
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_403010
		call	sub_435769
		mov	[esp+0FCh+VarName], eax
		call	assuan_set_assuan_log_stream

loc_403010:				; CODE XREF: sub_402066+F9Bj
		mov	eax, ds:dword_449064
		test	eax, eax
		jnz	short loc_403042
		mov	[esp+0FCh+VarName], 1
		call	sub_4015C2
		test	eax, eax
		jz	short loc_403042
		mov	[esp+0FCh+VarName], 1
		call	sub_4015C2
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_449064, eax

loc_403042:				; CODE XREF: sub_402066+FB1j
					; sub_402066+FC1j
		mov	eax, ds:dword_449068
		test	eax, eax
		jnz	short loc_403074
		mov	[esp+0FCh+VarName], offset aTerm ; "TERM"
		call	getenv
		test	eax, eax
		jz	short loc_403074
		mov	[esp+0FCh+VarName], offset aTerm ; "TERM"
		call	getenv
		mov	[esp+0FCh+VarName], eax
		call	gcry_xstrdup
		mov	ds:dword_449068, eax

loc_403074:				; CODE XREF: sub_402066+FE3j
					; sub_402066+FF3j
		cmp	[esp+0FCh+var_28], 0
		jz	loc_40317E
		mov	[esp+0FCh+Str2], 84h
		mov	[esp+0FCh+VarName], 1
		call	gcry_calloc
		mov	[esp+0FCh+var_70], eax
		cmp	[esp+0FCh+var_70], 0
		jnz	short loc_4030D4
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0FCh+VarName], eax	; int
		call	strerror
		mov	[esp+0FCh+Str2], eax ; char
		mov	[esp+0FCh+VarName], offset aErrorAllocatin ; "error allocating connection control dat"...
		call	sub_435B7D
		mov	[esp+0FCh+VarName], 1
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_4030D4:				; CODE XREF: sub_402066+103Fj
		call	sub_41FB5C
		mov	edx, [esp+0FCh+var_70]
		mov	[edx+0Ch], eax
		mov	eax, [esp+0FCh+var_70]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_40312D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0FCh+VarName], eax	; int
		call	strerror
		mov	[esp+0FCh+Str2], eax ; char
		mov	[esp+0FCh+VarName], offset aErrorAllocat_0 ; "error allocating session environment bl"...
		call	sub_435B7D
		mov	eax, [esp+0FCh+var_70]
		mov	[esp+0FCh+VarName], eax
		call	gcry_free
		mov	[esp+0FCh+VarName], 1
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_40312D:				; CODE XREF: sub_402066+1089j
		mov	eax, [esp+0FCh+var_70]
		mov	[esp+0FCh+VarName], eax
		call	sub_403366
		mov	[esp+0FCh+Radix], 0FFFFFFFFh
		mov	[esp+0FCh+Str2], 0FFFFFFFFh
		mov	eax, [esp+0FCh+var_70]
		mov	[esp+0FCh+VarName], eax
		call	sub_40901E
		mov	eax, [esp+0FCh+var_70]
		mov	[esp+0FCh+VarName], eax
		call	sub_4034A8
		mov	eax, [esp+0FCh+var_70]
		mov	[esp+0FCh+VarName], eax
		call	gcry_free
		jmp	loc_4032D7
; ---------------------------------------------------------------------------

loc_40317E:				; CODE XREF: sub_402066+1016j
		cmp	[esp+0FCh+var_2C], 0
		jz	loc_4032D7
		mov	[esp+0FCh+Str2], offset	aTmpGpgXxxxxxS_	; "/tmp/gpg-XXXXXX/S.gpg-agent"
		mov	[esp+0FCh+VarName], offset aS_gpgAgent ; "S.gpg-agent"
		call	sub_40378F
		mov	ds:dword_449030, eax
		mov	eax, ds:dword_449E24
		test	eax, eax
		jz	short loc_4031C7
		mov	[esp+0FCh+Str2], offset	aTmpGpgXxxxxx_0	; "/tmp/gpg-XXXXXX/S.gpg-agent.ssh"
		mov	[esp+0FCh+VarName], offset aS_gpgAgent_ssh ; "S.gpg-agent.ssh"
		call	sub_40378F
		mov	ds:dword_449034, eax

loc_4031C7:				; CODE XREF: sub_402066+1146j
		mov	eax, ds:dword_449030
		mov	[esp+0FCh+Radix], offset dword_449038 ;	int
		mov	[esp+0FCh+Str2], 0 ; int
		mov	[esp+0FCh+VarName], eax	; Filename
		call	sub_4038EB
		mov	[esp+0FCh+var_74], eax
		mov	eax, ds:dword_449E24
		test	eax, eax
		jz	short loc_40321A
		mov	eax, ds:dword_449034
		mov	[esp+0FCh+Radix], offset dword_44904C ;	int
		mov	[esp+0FCh+Str2], 1 ; int
		mov	[esp+0FCh+VarName], eax	; Filename
		call	sub_4038EB
		mov	[esp+0FCh+var_48], eax
		jmp	short loc_403225
; ---------------------------------------------------------------------------

loc_40321A:				; CODE XREF: sub_402066+118Cj
		mov	[esp+0FCh+var_48], 0FFFFFFFFh

loc_403225:				; CODE XREF: sub_402066+11B2j
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_403236
		call	_getpid
		mov	dword_43D364, eax

loc_403236:				; CODE XREF: sub_402066+11C4j
		mov	[esp+0FCh+VarName], 0 ;	File
		call	fflush
		call	_getpid
		mov	[esp+0FCh+var_78], eax
		mov	ecx, [esp+0FCh+var_78]
		mov	edx, ds:dword_449030
		mov	eax, offset aSetGpg_agent_i ; "set GPG_AGENT_INFO=%s;%lu;1\n"
		mov	[esp+0FCh+Radix], ecx
		mov	[esp+0FCh+Str2], edx
		mov	[esp+0FCh+VarName], eax	; Format
		call	printf
		mov	[esp+0FCh+VarName], 0Dh
		call	sub_437E99
		mov	ebx, eax
		mov	[esp+0FCh+VarName], 0Bh
		call	sub_437E99
		mov	[esp+0FCh+Radix], ebx
		mov	[esp+0FCh+Str2], eax ; char
		mov	[esp+0FCh+VarName], offset aSSStarted ;	"%s %s started\n"
		call	sub_435B53
		mov	eax, ds:dword_449E24
		test	eax, eax
		jz	short loc_4032B0
		mov	eax, [esp+0FCh+var_48]
		jmp	short loc_4032B5
; ---------------------------------------------------------------------------

loc_4032B0:				; CODE XREF: sub_402066+123Fj
		mov	eax, 0FFFFFFFFh

loc_4032B5:				; CODE XREF: sub_402066+1248j
		mov	[esp+0FCh+Str2], eax ; SOCKET
		mov	eax, [esp+0FCh+var_74]
		mov	[esp+0FCh+VarName], eax	; SOCKET
		call	sub_404743
		mov	eax, [esp+0FCh+var_74]
		mov	[esp+0FCh+VarName], eax
		call	assuan_sock_close

loc_4032D7:				; CODE XREF: sub_402066+1113j
					; sub_402066+1120j
		mov	eax, 0
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_402066	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4032E4	proc near		; CODE XREF: sub_402066+C9Cp
					; sub_402066+CB2p ...

Code		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449DA0
		and	eax, 80h
		test	eax, eax
		jz	short loc_403310
		mov	[esp+18h+Code],	17h
		call	gcry_control
		mov	[esp+18h+Code],	0Dh
		call	gcry_control

loc_403310:				; CODE XREF: sub_4032E4+12j
		mov	eax, ds:dword_449DA0
		test	eax, eax
		jz	short loc_403325
		mov	[esp+18h+Code],	0Eh
		call	gcry_control

loc_403325:				; CODE XREF: sub_4032E4+33j
		mov	[esp+18h+Code],	19h
		call	gcry_control
		cmp	[ebp+arg_0], 0
		jnz	short loc_403355
		mov	[esp+18h+Code],	0
		call	sub_435330
		test	eax, eax
		jz	short loc_40334E
		mov	eax, 2
		jmp	short loc_403353
; ---------------------------------------------------------------------------

loc_40334E:				; CODE XREF: sub_4032E4+61j
		mov	eax, 0

loc_403353:				; CODE XREF: sub_4032E4+68j
		jmp	short loc_403358
; ---------------------------------------------------------------------------

loc_403355:				; CODE XREF: sub_4032E4+51j
		mov	eax, [ebp+arg_0]

loc_403358:				; CODE XREF: sub_4032E4:loc_403353j
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Code],	eax ; Code
		call	exit
sub_4032E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403366	proc near		; CODE XREF: sub_402066+10D1p
					; sub_403FC2+386p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_403392
		mov	[esp+18h+var_10], 548h ; int
		mov	[esp+18h+var_14], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/agent/gpg-agent.c"
		mov	[esp+18h+var_18], offset aCtrlSession_en ; "ctrl->session_env"
		call	sub_43BB20

loc_403392:				; CODE XREF: sub_403366+Ej
		mov	edx, ds:dword_449060
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+var_10], edx ;	int
		mov	[esp+18h+var_14], offset aDisplay ; "DISPLAY"
		mov	[esp+18h+var_18], eax ;	int
		call	sub_42008C
		mov	edx, ds:dword_449064
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+var_10], edx ;	int
		mov	[esp+18h+var_14], offset aGpg_tty ; "GPG_TTY"
		mov	[esp+18h+var_18], eax ;	int
		call	sub_42008C
		mov	edx, ds:dword_449068
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+var_10], edx ;	int
		mov	[esp+18h+var_14], offset aTerm ; "TERM"
		mov	[esp+18h+var_18], eax ;	int
		call	sub_42008C
		mov	edx, ds:dword_449074
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+var_10], edx ;	int
		mov	[esp+18h+var_14], offset aXauthority ; "XAUTHORITY"
		mov	[esp+18h+var_18], eax ;	int
		call	sub_42008C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], offset aPinentry_user_ ; "PINENTRY_USER_DATA"
		mov	[esp+18h+var_18], eax ;	int
		call	sub_42008C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_403448
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+var_18], eax
		call	gcry_free

loc_403448:				; CODE XREF: sub_403366+D2j
		mov	eax, ds:dword_44906C
		test	eax, eax
		jz	short loc_403460
		mov	eax, ds:dword_44906C
		mov	[esp+18h+var_18], eax
		call	gcry_strdup
		jmp	short loc_403465
; ---------------------------------------------------------------------------

loc_403460:				; CODE XREF: sub_403366+E9j
		mov	eax, 0

loc_403465:				; CODE XREF: sub_403366+F8j
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_403483
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+18h+var_18], eax
		call	gcry_free

loc_403483:				; CODE XREF: sub_403366+10Dj
		mov	eax, ds:dword_449070
		test	eax, eax
		jz	short loc_40349B
		mov	eax, ds:dword_449070
		mov	[esp+18h+var_18], eax
		call	gcry_strdup
		jmp	short loc_4034A0
; ---------------------------------------------------------------------------

loc_40349B:				; CODE XREF: sub_403366+124j
		mov	eax, 0

loc_4034A0:				; CODE XREF: sub_403366+133j
		mov	edx, [ebp+arg_0]
		mov	[edx+14h], eax
		leave
		retn
sub_403366	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4034A8	proc near		; CODE XREF: sub_402066+10FFp
					; sub_403FC2+3B6p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+var_18], eax
		call	sub_41FBD7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_4034D4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+var_18], eax
		call	gcry_free

loc_4034D4:				; CODE XREF: sub_4034A8+1Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short locret_4034EC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+18h+var_18], eax
		call	gcry_free

locret_4034EC:				; CODE XREF: sub_4034A8+34j
		leave
		retn
sub_4034A8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4034EE	proc near		; CODE XREF: sub_403EE1+17p

Filename	= dword	ptr -88h
Mode		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
File		= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	[ebp+var_58], 0
		mov	eax, ds:Filename
		test	eax, eax
		jz	loc_403607
		mov	edx, offset Mode ; "r"
		mov	eax, ds:Filename
		mov	[esp+88h+Mode],	edx ; Mode
		mov	[esp+88h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_403564
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+Filename], eax	; int
		call	strerror
		mov	ebx, eax
		mov	esi, ds:Filename
		mov	[esp+88h+Filename], offset aOptionFileSS ; "option file	`%s': %s\n"
		call	sub_435294
		mov	[esp+88h+var_80], ebx
		mov	[esp+88h+Mode],	esi ; char
		mov	[esp+88h+Filename], eax	; char *
		call	sub_435B53
		jmp	loc_403608
; ---------------------------------------------------------------------------

loc_403564:				; CODE XREF: sub_4034EE+3Aj
		mov	[esp+88h+Mode],	1
		mov	[esp+88h+Filename], 0
		call	sub_401BF8
		lea	eax, [ebp+var_54]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 0Eh
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+var_5C], 0
		lea	eax, [ebp+var_5C]
		mov	[ebp+var_54], eax
		mov	[ebp+var_4C], 1
		jmp	short loc_4035C7
; ---------------------------------------------------------------------------

loc_4035A3:				; CODE XREF: sub_4034EE+105j
		mov	eax, [ebp+var_44]
		cmp	eax, 0FFFFFFFFh
		jge	short loc_4035B4
		mov	[ebp+var_48], 1
		jmp	short loc_4035C7
; ---------------------------------------------------------------------------

loc_4035B4:				; CODE XREF: sub_4034EE+BBj
		mov	[esp+88h+Mode],	1
		lea	eax, [ebp+var_54]
		mov	[esp+88h+Filename], eax
		call	sub_401BF8

loc_4035C7:				; CODE XREF: sub_4034EE+B3j
					; sub_4034EE+C4j
		mov	eax, ds:Filename
		mov	[esp+88h+var_78], offset dword_43D000 ;	int
		lea	edx, [ebp+var_54]
		mov	[esp+88h+var_7C], edx ;	int
		lea	edx, [ebp+var_58]
		mov	[esp+88h+var_80], edx ;	int
		mov	[esp+88h+Mode],	eax ; int
		mov	eax, [ebp+File]
		mov	[esp+88h+Filename], eax	; FILE *
		call	sub_4362AA
		test	eax, eax
		jnz	short loc_4035A3
		mov	eax, [ebp+File]
		mov	[esp+88h+Filename], eax	; File
		call	fclose
		call	sub_4017ED
		jmp	short loc_403608
; ---------------------------------------------------------------------------

loc_403607:				; CODE XREF: sub_4034EE+17j
		nop

loc_403608:				; CODE XREF: sub_4034EE+71j
					; sub_4034EE+117j
		add	esp, 7Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4034EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403610	proc near		; CODE XREF: sub_408650+107p
					; sub_40E7CF+845p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_449030
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jz	short loc_403633
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403633
		mov	eax, [ebp+var_4]
		jmp	short locret_403638
; ---------------------------------------------------------------------------

loc_403633:				; CODE XREF: sub_403610+12j
					; sub_403610+1Cj
		mov	eax, 0

locret_403638:				; CODE XREF: sub_403610+21j
		leave
		retn
sub_403610	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40363A	proc near		; CODE XREF: sub_408650+17Dp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_449034
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jz	short loc_40365D
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40365D
		mov	eax, [ebp+var_4]
		jmp	short locret_403662
; ---------------------------------------------------------------------------

loc_40365D:				; CODE XREF: sub_40363A+12j
					; sub_40363A+1Cj
		mov	eax, 0

locret_403662:				; CODE XREF: sub_40363A+21j
		leave
		retn
sub_40363A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403664	proc near		; CODE XREF: sub_404743+51p
					; sub_41A1F1+565p

lpEventAttributes= dword ptr -48h
bManualReset	= dword	ptr -44h
bInitialState	= dword	ptr -40h
lpName		= dword	ptr -3Ch
dwDesiredAccess	= dword	ptr -38h
bInheritHandle	= dword	ptr -34h
dwOptions	= dword	ptr -30h
EventAttributes	= _SECURITY_ATTRIBUTES ptr -1Ch
TargetHandle	= dword	ptr -10h
hSourceHandle	= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, ds:dword_449088
		test	eax, eax
		jnz	loc_403770
		mov	[ebp+EventAttributes.nLength], 0Ch
		mov	[ebp+EventAttributes.lpSecurityDescriptor], 0
		mov	[ebp+EventAttributes.bInheritHandle], 1
		mov	[esp+48h+lpName], 0 ; lpName
		mov	[esp+48h+bInitialState], 0 ; bInitialState
		mov	[esp+48h+bManualReset],	1 ; bManualReset
		lea	eax, [ebp+EventAttributes]
		mov	[esp+48h+lpEventAttributes], eax ; lpEventAttributes
		mov	eax, ds:CreateEventA
		call	eax ; CreateEventA
		sub	esp, 10h
		mov	[ebp+hSourceHandle], eax
		cmp	[ebp+hSourceHandle], 0
		jnz	short loc_4036DF
		mov	[esp+48h+lpEventAttributes], 0FFFFFFFFh	; DWORD
		call	sub_432EA2
		mov	[esp+48h+bManualReset],	eax ; char
		mov	[esp+48h+lpEventAttributes], offset aCanTCreateScdN ; "can't create scd notify event: %s\n"
		call	sub_435B7D
		jmp	loc_403770
; ---------------------------------------------------------------------------

loc_4036DF:				; CODE XREF: sub_403664+58j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+48h+dwOptions], 0 ; dwOptions
		mov	[esp+48h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+48h+dwDesiredAccess], 100002h ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+48h+lpName], edx ;	lpTargetHandle
		mov	[esp+48h+bInitialState], ebx ; hTargetProcessHandle
		mov	edx, [ebp+hSourceHandle]
		mov	[esp+48h+bManualReset],	edx ; hSourceHandle
		mov	[esp+48h+lpEventAttributes], eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_403758
		mov	[esp+48h+lpEventAttributes], 0FFFFFFFFh	; DWORD
		call	sub_432EA2
		mov	[esp+48h+bManualReset],	eax ; char
		mov	[esp+48h+lpEventAttributes], offset aSettingSyncron ; "setting syncronize for scd notify event"...
		call	sub_435B7D
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_403770
; ---------------------------------------------------------------------------

loc_403758:				; CODE XREF: sub_403664+C4j
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+lpEventAttributes], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+TargetHandle]
		mov	ds:dword_449088, eax

loc_403770:				; CODE XREF: sub_403664+Ej
					; sub_403664+76j ...
		mov	eax, ds:dword_449088
		mov	[esp+48h+bManualReset],	eax ; char
		mov	[esp+48h+lpEventAttributes], offset aReturningNotif ; "returning notify	handle %p\n"
		call	sub_435C1A
		mov	eax, ds:dword_449088
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_403664	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40378F	proc near		; CODE XREF: sub_402066+1135p
					; sub_402066+1157p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_449DC4
		test	eax, eax
		jz	short loc_4037C4
		mov	eax, ds:dword_449DB4
		mov	[esp+38h+var_30], 0
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax
		call	sub_432667
		mov	[ebp+var_C], eax
		jmp	loc_403863
; ---------------------------------------------------------------------------

loc_4037C4:				; CODE XREF: sub_40378F+Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	gcry_xstrdup
		mov	[ebp+var_C], eax
		mov	[esp+38h+Val], 2Fh ; Ch
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strrchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40380A
		mov	[esp+38h+var_30], offset aCreate_socket_ ; "create_socket_name"
		mov	[esp+38h+Val], 5EEh
		mov	[esp+38h+Str], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/agent/gpg-agent.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_40380A:				; CODE XREF: sub_40378F+5Dj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_439832
		test	eax, eax
		jnz	short loc_40385D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+Str], eax ; int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+Str], offset aCanTCreateDire ;	"can't create directory `%s': %s\n"
		call	sub_435294
		mov	[esp+38h+var_30], ebx
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Val], edx ; char
		mov	[esp+38h+Str], eax ; char *
		call	sub_435B7D
		mov	[esp+38h+Str], 2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_40385D:				; CODE XREF: sub_40378F+8Ej
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	2Fh

loc_403863:				; CODE XREF: sub_40378F+30j
		mov	[esp+38h+Val], 3Bh ; char
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_40389A
		mov	[esp+38h+Val], offset asc_43EDC5 ; ";"
		mov	[esp+38h+Str], offset aSAreNotAllowed ;	"`%s' are not allowed in the socket name"...
		call	sub_435B7D
		mov	[esp+38h+Str], 2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_40389A:				; CODE XREF: sub_40378F+E9j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		cmp	eax, 65h
		jbe	short loc_4038E1
		mov	[esp+38h+Str], offset aNameOfSocketTo ;	"name of socket	too long\n"
		call	sub_435294
		mov	[esp+38h+Str], eax ; char *
		call	sub_435B7D
		mov	[esp+38h+Str], 2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_4038E1:				; CODE XREF: sub_40378F+130j
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40378F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4038EB(char *Filename, int, int)
sub_4038EB	proc near		; CODE XREF: sub_402066+1179p
					; sub_402066+11A6p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
s		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Filename	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+Source], 1
		mov	[esp+48h+Dest],	1
		call	assuan_sock_new
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jnz	short loc_403950
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	[esp+48h+Dest],	offset aCanTCreateSock ; "can't create socket: %s\n"
		call	sub_435294
		mov	[esp+48h+Source], ebx ;	char
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_435B7D
		mov	[esp+48h+Dest],	2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_403950:				; CODE XREF: sub_4038EB+2Cj
		mov	[esp+48h+Dest],	70h
		call	gcry_xmalloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	ebx, 70h
		mov	eax, 0
		mov	ecx, edx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_40397F
		mov	[edx], al
		add	edx, 1
		sub	ebx, 1

loc_40397F:				; CODE XREF: sub_4038EB+8Aj
		mov	ecx, edx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_403991
		mov	[edx], ax
		add	edx, 2
		sub	ebx, 2

loc_403991:				; CODE XREF: sub_4038EB+9Bj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, edx
		rep stosd
		mov	edx, edi
		mov	ecx, ebx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_4039AB
		mov	[edx], ax
		add	edx, 2

loc_4039AB:				; CODE XREF: sub_4038EB+B8j
		mov	ecx, ebx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_4039B9
		mov	[edx], al
		add	edx, 1

loc_4039B9:				; CODE XREF: sub_4038EB+C7j
		mov	eax, [ebp+var_24]
		mov	word ptr [eax],	1
		mov	eax, [ebp+Filename]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		cmp	eax, 65h
		jbe	short loc_403A0F
		mov	[esp+48h+Dest],	offset aSocketNameSIsT ; "socket name `%s' is too long\n"
		call	sub_435294
		mov	edx, [ebp+Filename]
		mov	[esp+48h+Source], edx ;	char
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_435B7D
		mov	[esp+48h+Dest],	2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_403A0F:				; CODE XREF: sub_4038EB+FBj
		mov	eax, [ebp+Filename]
		mov	edx, [ebp+var_24]
		add	edx, 8
		mov	[esp+48h+Source], eax ;	Source
		mov	[esp+48h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_24]
		add	eax, 8
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 8
		mov	dword ptr [ebp+var_28],	eax
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+s]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_bind
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_449DC4
		test	eax, eax
		jz	loc_403B1A
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	loc_403B1A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2740h
		jnz	loc_403B1A
		cmp	[ebp+arg_4], 0
		jnz	short loc_403AF3
		mov	[esp+48h+Source], 1 ; char
		mov	[esp+48h+Dest],	1
		call	sub_4052F2
		test	eax, eax
		jnz	short loc_403AF3
		mov	[esp+48h+Dest],	offset aAGpgAgentIsAlr ; "a gpg-agent is already running - not st"...
		call	sub_435294
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_435B7D
		mov	eax, [ebp+Filename]
		mov	byte ptr [eax],	0
		mov	eax, ds:dword_449E24
		test	eax, eax
		jz	short loc_403ADC
		mov	eax, ds:dword_449034
		mov	byte ptr [eax],	0

loc_403ADC:				; CODE XREF: sub_4038EB+1E7j
		mov	eax, [ebp+s]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_close
		mov	[esp+48h+Dest],	2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_403AF3:				; CODE XREF: sub_4038EB+1ACj
					; sub_4038EB+1C4j
		mov	eax, [ebp+Filename]
		mov	[esp+48h+Dest],	eax ; Filename
		call	remove
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+s]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_bind
		mov	[ebp+var_1C], eax

loc_403B1A:				; CODE XREF: sub_4038EB+184j
					; sub_4038EB+18Ej ...
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_403B56
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+48h+Source], eax ;	char
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_get_nonce
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_403B56
		mov	[esp+48h+Dest],	offset aErrorGettingNo ; "error	getting	nonce for the socket\n"
		call	sub_435294
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_435B7D

loc_403B56:				; CODE XREF: sub_4038EB+233j
					; sub_4038EB+255j
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_403BBF
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dest],	eax
		call	sub_401592
		mov	[esp+48h+Dest],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	eax, [ebp+var_24]
		lea	esi, [eax+8]
		mov	[esp+48h+Dest],	offset aErrorBindingSo ; "error	binding	socket to `%s': %s\n"
		call	sub_435294
		mov	[esp+48h+var_40], ebx
		mov	[esp+48h+Source], esi ;	char
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_435B7D
		mov	eax, [ebp+s]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_close
		mov	eax, ds:dword_449DC4
		test	eax, eax
		jz	short loc_403BB3
		mov	eax, [ebp+Filename]
		mov	byte ptr [eax],	0

loc_403BB3:				; CODE XREF: sub_4038EB+2C0j
		mov	[esp+48h+Dest],	2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_403BBF:				; CODE XREF: sub_4038EB+26Fj
		mov	eax, [ebp+s]
		mov	[esp+48h+Source], 5 ; backlog
		mov	[esp+48h+Dest],	eax ; s
		mov	eax, ds:listen
		call	eax ; listen
		sub	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_403C1E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	[esp+48h+Dest],	offset aListenFailedS ;	"listen() failed: %s\n"
		call	sub_435294
		mov	[esp+48h+Source], ebx ;	char
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_435B7D
		mov	eax, [ebp+s]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_close
		mov	[esp+48h+Dest],	2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_403C1E:				; CODE XREF: sub_4038EB+2EFj
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_403C45
		mov	eax, [ebp+var_24]
		lea	ebx, [eax+8]
		mov	[esp+48h+Dest],	offset aListeningOnSoc ; "listening on socket `%s'\n"
		call	sub_435294
		mov	[esp+48h+Source], ebx ;	char
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_435B53

loc_403C45:				; CODE XREF: sub_4038EB+33Aj
		mov	eax, [ebp+s]
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4038EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403C50	proc near		; CODE XREF: sub_403D1A+E7p
					; sub_403D1A+158p

lpPathName	= dword	ptr -58h
lpSecurityAttributes= dword ptr	-54h
var_50		= dword	ptr -50h
var_40		= byte ptr -40h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+lpSecurityAttributes],	offset aPrivateKeysV1_ ; "private-keys-v1.d"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+lpPathName], eax
		call	sub_432667
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+58h+lpSecurityAttributes],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpPathName], eax
		mov	eax, ds:_stati64
		call	eax ; _stati64
		test	eax, eax
		jz	short loc_403D0A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_403D0A
		mov	[esp+58h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		test	eax, eax
		jnz	short loc_403CE6
		mov	[esp+58h+lpPathName], 0FFFFFFFFh ; DWORD
		call	sub_432EA2
		mov	ebx, eax
		mov	[esp+58h+lpPathName], offset aCanTCreateDire ; "can't create directory `%s': %s\n"
		call	sub_435294
		mov	[esp+58h+var_50], ebx
		mov	edx, [ebp+var_C]
		mov	[esp+58h+lpSecurityAttributes],	edx ; char
		mov	[esp+58h+lpPathName], eax ; char *
		call	sub_435B7D
		jmp	short loc_403D0A
; ---------------------------------------------------------------------------

loc_403CE6:				; CODE XREF: sub_403C50+65j
		mov	eax, ds:dword_449DA8
		test	eax, eax
		jnz	short loc_403D0A
		mov	[esp+58h+lpPathName], offset aDirectorySCrea ; "directory `%s' created\n"
		call	sub_435294
		mov	edx, [ebp+var_C]
		mov	[esp+58h+lpSecurityAttributes],	edx ; char
		mov	[esp+58h+lpPathName], eax ; char *
		call	sub_435B53

loc_403D0A:				; CODE XREF: sub_403C50+3Bj
					; sub_403C50+49j ...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpPathName], eax
		call	gcry_free
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_403C50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403D1A	proc near		; CODE XREF: sub_402066+C39p

lpPathName	= dword	ptr -58h
lpSecurityAttributes= dword ptr	-54h
var_50		= dword	ptr -50h
var_40		= byte ptr -40h
var_3A		= word ptr -3Ah
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		call	sub_41EB9F
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449DB4
		mov	[esp+58h+lpSecurityAttributes],	0
		mov	[esp+58h+lpPathName], eax
		call	sub_432667
		mov	[ebp+var_10], eax
		lea	eax, [ebp+var_40]
		mov	[esp+58h+lpSecurityAttributes],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+lpPathName], eax
		mov	eax, ds:_stati64
		call	eax ; _stati64
		test	eax, eax
		jz	loc_403E3C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2
		jnz	loc_403E08
		mov	eax, [ebp+var_C]
		mov	[esp+58h+lpSecurityAttributes],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+lpPathName], eax
		call	sub_4326C7
		test	eax, eax
		jnz	loc_403E77
		mov	[esp+58h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	eax, [ebp+var_10]
		mov	[esp+58h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		test	eax, eax
		jnz	short loc_403DD7
		mov	[esp+58h+lpPathName], 0FFFFFFFFh ; DWORD
		call	sub_432EA2
		mov	ebx, eax
		mov	[esp+58h+lpPathName], offset aCanTCreateDire ; "can't create directory `%s': %s\n"
		call	sub_435294
		mov	[esp+58h+var_50], ebx
		mov	edx, [ebp+var_10]
		mov	[esp+58h+lpSecurityAttributes],	edx ; char
		mov	[esp+58h+lpPathName], eax ; char *
		call	sub_435B7D
		jmp	loc_403E77
; ---------------------------------------------------------------------------

loc_403DD7:				; CODE XREF: sub_403D1A+89j
		mov	eax, ds:dword_449DA8
		test	eax, eax
		jnz	short loc_403DFB
		mov	[esp+58h+lpPathName], offset aDirectorySCrea ; "directory `%s' created\n"
		call	sub_435294
		mov	edx, [ebp+var_10]
		mov	[esp+58h+lpSecurityAttributes],	edx ; char
		mov	[esp+58h+lpPathName], eax ; char *
		call	sub_435B53

loc_403DFB:				; CODE XREF: sub_403D1A+C4j
		mov	eax, [ebp+var_10]
		mov	[esp+58h+lpPathName], eax
		call	sub_403C50
		jmp	short loc_403E77
; ---------------------------------------------------------------------------

loc_403E08:				; CODE XREF: sub_403D1A+4Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+lpPathName], eax ; int
		call	strerror
		mov	ebx, eax
		mov	[esp+58h+lpPathName], offset aStatFailedForS ; "stat() failed for `%s': %s\n"
		call	sub_435294
		mov	[esp+58h+var_50], ebx
		mov	edx, [ebp+var_10]
		mov	[esp+58h+lpSecurityAttributes],	edx ; char
		mov	[esp+58h+lpPathName], eax ; char *
		call	sub_435B7D
		jmp	short loc_403E77
; ---------------------------------------------------------------------------

loc_403E3C:				; CODE XREF: sub_403D1A+3Dj
		movzx	eax, [ebp+var_3A]
		movzx	eax, ax
		and	eax, 0F000h
		cmp	eax, 4000h
		jz	short loc_403E6C
		mov	[esp+58h+lpPathName], offset aCanTUseSAsHome ; "can't use `%s' as home directory\n"
		call	sub_435294
		mov	edx, [ebp+var_10]
		mov	[esp+58h+lpSecurityAttributes],	edx ; char
		mov	[esp+58h+lpPathName], eax ; char *
		call	sub_435B7D
		jmp	short loc_403E77
; ---------------------------------------------------------------------------

loc_403E6C:				; CODE XREF: sub_403D1A+133j
		mov	eax, [ebp+var_10]
		mov	[esp+58h+lpPathName], eax
		call	sub_403C50

loc_403E77:				; CODE XREF: sub_403D1A+69j
					; sub_403D1A+B8j ...
		mov	eax, [ebp+var_10]
		mov	[esp+58h+lpPathName], eax
		call	gcry_free
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_403D1A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403E87	proc near		; CODE XREF: sub_404743+371p
					; sub_404743+3FAp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, ds:dword_449084
		test	eax, eax
		jnz	short loc_403EA8
		mov	[esp+18h+var_18], 0
		call	sub_43BBF0
		mov	ds:dword_449084, eax

loc_403EA8:				; CODE XREF: sub_403E87+Ej
		call	sub_41A85A
		mov	eax, ds:dword_449084
		lea	ebx, [eax+3Ch]
		mov	[esp+18h+var_18], 0
		call	sub_43BBF0
		cmp	ebx, eax
		jg	short loc_403EDB
		call	sub_4051ED
		mov	[esp+18h+var_18], 0
		call	sub_43BBF0
		mov	ds:dword_449084, eax

loc_403EDB:				; CODE XREF: sub_403E87+3Cj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_403E87	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403EE1	proc near		; CODE XREF: sub_40863E+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aSighupReceived ; "SIGHUP received - re-reading configurat"...
		call	sub_435B53
		call	sub_41128F
		call	sub_4034EE
		call	sub_419203
		leave
		retn
sub_403EE1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F04	proc near		; CODE XREF: sub_404743+335p
					; sub_404743+3C6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_403F1F
		mov	[esp+18h+var_18], offset aSigusr2Receive ; "SIGUSR2 received - updating	card event "...
		call	sub_435B53

loc_403F1F:				; CODE XREF: sub_403F04+Dj
		call	sub_405DD9
		leave
		retn
sub_403F04	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aSignalDReceive	; "signal %d received -	no action defined\"...
		call	sub_435B53
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F41	proc near		; CODE XREF: sub_40458F+1Cp
					; sub_40466D+1Cp

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], edx
		mov	[esp+18h+var_18], eax
		call	assuan_sock_check_nonce
		test	eax, eax
		jz	short loc_403FB6
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	esi, eax
		mov	[esp+18h+var_18], offset aErrorReadingNo ; "error reading nonce	on fd %d: %s\n"
		call	sub_435294
		mov	[esp+18h+var_10], ebx
		mov	dword ptr [esp+18h+var_14], esi	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_435B53
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax
		call	assuan_sock_close
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	short loc_403FBB
; ---------------------------------------------------------------------------

loc_403FB6:				; CODE XREF: sub_403F41+1Ej
		mov	eax, 0

loc_403FBB:				; CODE XREF: sub_403F41+73j
		add	esp, 10h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_403F41	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_403FC2(HWND, UINT, WPARAM, LPARAM)
sub_403FC2	proc near		; DATA XREF: sub_4043EA+10o

hWnd		= dword	ptr -58h
Msg		= dword	ptr -54h
wParam		= dword	ptr -50h
lParam		= dword	ptr -4Ch
ppsidGroup	= dword	ptr -48h
ppDacl		= dword	ptr -44h
ppSacl		= dword	ptr -40h
ppSecurityDescriptor= dword ptr	-3Ch
StringSid	= dword	ptr -34h
hMem		= dword	ptr -30h
ppsidOwner	= dword	ptr -2Ch
var_28		= byte ptr -28h
handle		= dword	ptr -24h
lpName		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Sid		= dword	ptr -18h
var_14		= dword	ptr -14h
lpBaseAddress	= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	[ebp+Sid], 0
		mov	[ebp+ppsidOwner], 0
		mov	[ebp+lpBaseAddress], 0
		mov	[ebp+hMem], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 4Ah
		jz	short loc_404022
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+lParam], eax ;	lParam
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+wParam], eax ;	wParam
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Msg], eax ; Msg
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+hWnd],	eax ; hWnd
		mov	eax, ds:DefWindowProcA
		call	eax ; DefWindowProcA
		sub	esp, 10h
		jmp	locret_4043E6
; ---------------------------------------------------------------------------

loc_404022:				; CODE XREF: sub_403FC2+34j
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		cmp	eax, 804E50BAh
		jz	short loc_40403E
		mov	eax, 0
		jmp	locret_4043E6
; ---------------------------------------------------------------------------

loc_40403E:				; CODE XREF: sub_403FC2+70j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+8]
		mov	[ebp+lpName], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_404064
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		sub	eax, 1
		add	eax, [ebp+lpName]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40406E

loc_404064:				; CODE XREF: sub_403FC2+8Dj
		mov	eax, 0
		jmp	locret_4043E6
; ---------------------------------------------------------------------------

loc_40406E:				; CODE XREF: sub_403FC2+A0j
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_404099
		call	pth_leave
		mov	eax, [ebp+lpName]
		mov	[esp+58h+Msg], eax ; char
		mov	[esp+58h+hWnd],	offset aSshMapFileS ; "ssh map file '%s'"
		call	sub_435C1A
		call	pth_enter

loc_404099:				; CODE XREF: sub_403FC2+B8j
		mov	eax, [ebp+lpName]
		mov	[esp+58h+wParam], eax ;	lpName
		mov	[esp+58h+Msg], 0 ; bInheritHandle
		mov	[esp+58h+hWnd],	0F001Fh	; dwDesiredAccess
		mov	eax, ds:OpenFileMappingA
		call	eax ; OpenFileMappingA
		sub	esp, 0Ch
		mov	[ebp+handle], eax
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_4040E7
		call	pth_leave
		mov	eax, [ebp+handle]
		mov	[esp+58h+Msg], eax ; char
		mov	[esp+58h+hWnd],	offset aSshMapHandleP ;	"ssh map handle	%p\n"
		call	sub_435C1A
		call	pth_enter

loc_4040E7:				; CODE XREF: sub_403FC2+106j
		cmp	[ebp+handle], 0
		jz	short loc_4040F3
		cmp	[ebp+handle], 0FFFFFFFFh
		jnz	short loc_4040FD

loc_4040F3:				; CODE XREF: sub_403FC2+129j
		mov	eax, 0
		jmp	locret_4043E6
; ---------------------------------------------------------------------------

loc_4040FD:				; CODE XREF: sub_403FC2+12Fj
		call	pth_leave
		call	sub_41E853
		mov	[ebp+Sid], eax
		cmp	[ebp+Sid], 0
		jnz	short loc_404121
		mov	[esp+58h+hWnd],	offset aErrorGettingMy ; "error	getting	my sid\n"
		call	sub_435B7D
		jmp	loc_404380
; ---------------------------------------------------------------------------

loc_404121:				; CODE XREF: sub_403FC2+14Cj
		lea	eax, [ebp+hMem]
		mov	[esp+58h+ppSecurityDescriptor],	eax ; ppSecurityDescriptor
		mov	[esp+58h+ppSacl], 0 ; ppSacl
		mov	[esp+58h+ppDacl], 0 ; ppDacl
		mov	[esp+58h+ppsidGroup], 0	; ppsidGroup
		lea	eax, [ebp+ppsidOwner]
		mov	[esp+58h+lParam], eax ;	ppsidOwner
		mov	[esp+58h+wParam], 1 ; SecurityInfo
		mov	[esp+58h+Msg], 6 ; ObjectType
		mov	eax, [ebp+handle]
		mov	[esp+58h+hWnd],	eax ; handle
		mov	eax, ds:GetSecurityInfo
		call	eax ; GetSecurityInfo
		sub	esp, 20h
		mov	dword ptr [ebp+var_28],	eax
		cmp	dword ptr [ebp+var_28],	0
		jz	short loc_404188
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+58h+Msg], eax ; char
		mov	[esp+58h+hWnd],	offset aErrorGettingSi ; "error	getting	sid of ssh map file: rc=%"...
		call	sub_435B7D
		jmp	loc_404380
; ---------------------------------------------------------------------------

loc_404188:				; CODE XREF: sub_403FC2+1ACj
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	loc_404240
		lea	eax, [ebp+StringSid]
		mov	[esp+58h+Msg], eax ; StringSid
		mov	eax, [ebp+Sid]
		mov	[esp+58h+hWnd],	eax ; Sid
		mov	eax, ds:ConvertSidToStringSidA
		call	eax ; ConvertSidToStringSidA
		sub	esp, 8
		test	eax, eax
		jnz	short loc_4041BC
		mov	[ebp+StringSid], 0

loc_4041BC:				; CODE XREF: sub_403FC2+1F1j
		mov	eax, [ebp+StringSid]
		test	eax, eax
		jz	short loc_4041C8
		mov	eax, [ebp+StringSid]
		jmp	short loc_4041CD
; ---------------------------------------------------------------------------

loc_4041C8:				; CODE XREF: sub_403FC2+1FFj
		mov	eax, offset aError ; "[error]"

loc_4041CD:				; CODE XREF: sub_403FC2+204j
		mov	[esp+58h+Msg], eax ; char
		mov	[esp+58h+hWnd],	offset aMySidS ; "	    my sid: '%s'"
		call	sub_435C1A
		mov	eax, [ebp+StringSid]
		mov	[esp+58h+hWnd],	eax ; hMem
		mov	eax, ds:LocalFree
		call	eax ; LocalFree
		sub	esp, 4
		mov	eax, [ebp+ppsidOwner]
		lea	edx, [ebp+StringSid]
		mov	[esp+58h+Msg], edx ; StringSid
		mov	[esp+58h+hWnd],	eax ; Sid
		mov	eax, ds:ConvertSidToStringSidA
		call	eax ; ConvertSidToStringSidA
		sub	esp, 8
		test	eax, eax
		jnz	short loc_40420F
		mov	[ebp+StringSid], 0

loc_40420F:				; CODE XREF: sub_403FC2+244j
		mov	eax, [ebp+StringSid]
		test	eax, eax
		jz	short loc_40421B
		mov	eax, [ebp+StringSid]
		jmp	short loc_404220
; ---------------------------------------------------------------------------

loc_40421B:				; CODE XREF: sub_403FC2+252j
		mov	eax, offset aError ; "[error]"

loc_404220:				; CODE XREF: sub_403FC2+257j
		mov	[esp+58h+Msg], eax ; char
		mov	[esp+58h+hWnd],	offset aSshMapFileSidS ; "ssh map file sid: '%s'"
		call	sub_435C1A
		mov	eax, [ebp+StringSid]
		mov	[esp+58h+hWnd],	eax ; hMem
		mov	eax, ds:LocalFree
		call	eax ; LocalFree
		sub	esp, 4

loc_404240:				; CODE XREF: sub_403FC2+1D2j
		mov	eax, [ebp+ppsidOwner]
		mov	[esp+58h+Msg], eax ; char
		mov	eax, [ebp+Sid]
		mov	[esp+58h+hWnd],	eax ; pSid1
		mov	eax, ds:EqualSid
		call	eax ; EqualSid
		sub	esp, 8
		test	eax, eax
		jnz	short loc_40426C
		mov	[esp+58h+hWnd],	offset aSshMapFileHasA ; "ssh map file has a non-matching sid\n"
		call	sub_435B7D
		jmp	loc_404380
; ---------------------------------------------------------------------------

loc_40426C:				; CODE XREF: sub_403FC2+297j
		mov	[esp+58h+ppsidGroup], 0	; dwNumberOfBytesToMap
		mov	[esp+58h+lParam], 0 ; dwFileOffsetLow
		mov	[esp+58h+wParam], 0 ; dwFileOffsetHigh
		mov	[esp+58h+Msg], 0F001Fh ; dwDesiredAccess
		mov	eax, [ebp+handle]
		mov	[esp+58h+hWnd],	eax ; hFileMappingObject
		mov	eax, ds:MapViewOfFile
		call	eax ; MapViewOfFile
		sub	esp, 14h
		mov	[ebp+lpBaseAddress], eax
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_4042C0
		mov	eax, [ebp+lpBaseAddress]
		mov	[esp+58h+Msg], eax ; char
		mov	[esp+58h+hWnd],	offset aSshIpcBufferAt ; "ssh IPC buffer at %p\n"
		call	sub_435C1A

loc_4042C0:				; CODE XREF: sub_403FC2+2E9j
		cmp	[ebp+lpBaseAddress], 0
		jz	loc_40437F
		mov	[esp+58h+Msg], 84h
		mov	[esp+58h+hWnd],	1
		call	gcry_calloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40430A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+hWnd],	eax ; int
		call	strerror
		mov	[esp+58h+Msg], eax ; char
		mov	[esp+58h+hWnd],	offset aErrorAllocatin ; "error	allocating connection control dat"...
		call	sub_435B7D
		jmp	short loc_404380
; ---------------------------------------------------------------------------

loc_40430A:				; CODE XREF: sub_403FC2+323j
		call	sub_41FB5C
		mov	edx, [ebp+var_14]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_404342
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+hWnd],	eax ; int
		call	strerror
		mov	[esp+58h+Msg], eax ; char
		mov	[esp+58h+hWnd],	offset aErrorAllocat_0 ; "error	allocating session environment bl"...
		call	sub_435B7D
		jmp	short loc_404380
; ---------------------------------------------------------------------------

loc_404342:				; CODE XREF: sub_403FC2+35Bj
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hWnd],	eax
		call	sub_403366
		mov	[esp+58h+wParam], 4000h
		mov	eax, [ebp+lpBaseAddress]
		mov	[esp+58h+Msg], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hWnd],	eax
		call	sub_40E084
		test	eax, eax
		jnz	short loc_404372
		mov	[ebp+var_C], 1

loc_404372:				; CODE XREF: sub_403FC2+3A7j
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hWnd],	eax
		call	sub_4034A8
		jmp	short loc_404380
; ---------------------------------------------------------------------------

loc_40437F:				; CODE XREF: sub_403FC2+302j
		nop

loc_404380:				; CODE XREF: sub_403FC2+15Aj
					; sub_403FC2+1C1j ...
		mov	eax, [ebp+var_14]
		mov	[esp+58h+hWnd],	eax
		call	gcry_free
		cmp	[ebp+lpBaseAddress], 0
		jz	short loc_4043A1
		mov	eax, [ebp+lpBaseAddress]
		mov	[esp+58h+hWnd],	eax ; lpBaseAddress
		mov	eax, ds:UnmapViewOfFile
		call	eax ; UnmapViewOfFile
		sub	esp, 4

loc_4043A1:				; CODE XREF: sub_403FC2+3CDj
		mov	eax, [ebp+ppsidOwner]
		mov	[esp+58h+hWnd],	eax
		call	gcry_free
		mov	eax, [ebp+hMem]
		test	eax, eax
		jz	short loc_4043C3
		mov	eax, [ebp+hMem]
		mov	[esp+58h+hWnd],	eax ; hMem
		mov	eax, ds:LocalFree
		call	eax ; LocalFree
		sub	esp, 4

loc_4043C3:				; CODE XREF: sub_403FC2+3EFj
		mov	eax, [ebp+Sid]
		mov	[esp+58h+hWnd],	eax
		call	gcry_free
		mov	eax, [ebp+handle]
		mov	[esp+58h+hWnd],	eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		call	pth_enter
		mov	eax, [ebp+var_C]

locret_4043E6:				; CODE XREF: sub_403FC2+5Bj
					; sub_403FC2+77j ...
		leave
		retn	10h
sub_403FC2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4043EA	proc near		; DATA XREF: sub_404743+A3o

lpWndClass	= dword	ptr -88h
lpClassName	= dword	ptr -84h
lpWindowName	= dword	ptr -80h
dwStyle		= dword	ptr -7Ch
X		= dword	ptr -78h
Y		= dword	ptr -74h
nWidth		= dword	ptr -70h
nHeight		= dword	ptr -6Ch
hWndParent	= dword	ptr -68h
hMenu		= dword	ptr -64h
hInstance	= dword	ptr -60h
lpParam		= dword	ptr -5Ch
Msg		= MSG ptr -50h
WndClass	= WNDCLASSA ptr	-34h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 88h
		mov	[ebp+WndClass.style], 0
		mov	[ebp+WndClass.lpfnWndProc], offset sub_403FC2
		mov	[ebp+WndClass.cbClsExtra], 0
		mov	[ebp+WndClass.cbWndExtra], 0
		mov	[ebp+WndClass.hInstance], 0
		mov	[ebp+WndClass.hIcon], 0
		mov	[ebp+WndClass.hCursor],	0
		mov	[ebp+WndClass.hbrBackground], 0
		mov	[ebp+WndClass.lpszMenuName], 0
		mov	[ebp+WndClass.lpszClassName], offset WindowName	; "Pageant"
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_404457
		call	pth_thread_id
		mov	[esp+88h+lpClassName], eax ; char
		mov	[esp+88h+lpWndClass], offset aPuttyMessageLo ; "putty message loop thread 0x%lx	started"...
		call	sub_435B53

loc_404457:				; CODE XREF: sub_4043EA+56j
		call	pth_enter
		lea	eax, [ebp+WndClass]
		mov	[esp+88h+lpWndClass], eax ; lpWndClass
		mov	eax, ds:RegisterClassA
		call	eax ; RegisterClassA
		sub	esp, 4
		test	ax, ax
		jnz	short loc_40448C
		call	pth_leave
		mov	[esp+88h+lpWndClass], offset aErrorRegisteri ; "error registering Pageant window class"
		call	sub_435B7D
		mov	eax, 0
		jmp	locret_40458D
; ---------------------------------------------------------------------------

loc_40448C:				; CODE XREF: sub_4043EA+85j
		mov	[esp+88h+lpParam], 0 ; lpParam
		mov	[esp+88h+hInstance], 0 ; hInstance
		mov	[esp+88h+hMenu], 0 ; hMenu
		mov	[esp+88h+hWndParent], 0FFFFFFFDh ; hWndParent
		mov	[esp+88h+nHeight], 0 ; nHeight
		mov	[esp+88h+nWidth], 0 ; nWidth
		mov	[esp+88h+Y], 0	; Y
		mov	[esp+88h+X], 0	; X
		mov	[esp+88h+dwStyle], 0 ; dwStyle
		mov	[esp+88h+lpWindowName],	offset WindowName ; "Pageant"
		mov	[esp+88h+lpClassName], offset WindowName ; "Pageant"
		mov	[esp+88h+lpWndClass], 0	; dwExStyle
		mov	eax, ds:CreateWindowExA
		call	eax ; CreateWindowExA
		sub	esp, 30h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404538
		call	pth_leave
		mov	[esp+88h+lpWndClass], offset aErrorCreatingP ; "error creating Pageant window"
		call	sub_435B7D
		mov	eax, 0
		jmp	short locret_40458D
; ---------------------------------------------------------------------------

loc_404516:				; CODE XREF: sub_4043EA+179j
		lea	eax, [ebp+Msg]
		mov	[esp+88h+lpWndClass], eax ; lpMsg
		mov	eax, ds:TranslateMessage
		call	eax ; TranslateMessage
		sub	esp, 4
		lea	eax, [ebp+Msg]
		mov	[esp+88h+lpWndClass], eax ; lpMsg
		mov	eax, ds:DispatchMessageA
		call	eax ; DispatchMessageA
		sub	esp, 4
		jmp	short loc_404539
; ---------------------------------------------------------------------------

loc_404538:				; CODE XREF: sub_4043EA+112j
		nop

loc_404539:				; CODE XREF: sub_4043EA+14Cj
		mov	[esp+88h+dwStyle], 0 ; wMsgFilterMax
		mov	[esp+88h+lpWindowName],	0 ; wMsgFilterMin
		mov	[esp+88h+lpClassName], 0 ; hWnd
		lea	eax, [ebp+Msg]
		mov	[esp+88h+lpWndClass], eax ; lpMsg
		mov	eax, ds:GetMessageA
		call	eax ; GetMessageA
		sub	esp, 10h
		test	eax, eax
		jnz	short loc_404516
		call	pth_leave
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_404588
		call	pth_thread_id
		mov	[esp+88h+lpClassName], eax ; char
		mov	[esp+88h+lpWndClass], offset aPuttyMessage_0 ; "putty message loop thread 0x%lx	stopped"...
		call	sub_435B53

loc_404588:				; CODE XREF: sub_4043EA+187j
		mov	eax, 0

locret_40458D:				; CODE XREF: sub_4043EA+9Dj
					; sub_4043EA+12Aj
		leave
		retn
sub_4043EA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40458F	proc near		; DATA XREF: sub_404743+596o

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	dword ptr [esp+28h+var_24], offset dword_449038
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_403F41
		test	eax, eax
		jz	short loc_4045BE
		mov	eax, 0
		jmp	loc_404666
; ---------------------------------------------------------------------------

loc_4045BE:				; CODE XREF: sub_40458F+23j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_403366
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_4045FC
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	esi, eax
		call	pth_thread_id
		mov	ebx, eax
		mov	[esp+28h+var_28], offset aHandler0xLxFor ; "handler 0x%lx for fd %d started\n"
		call	sub_435294
		mov	[esp+28h+var_20], esi
		mov	dword ptr [esp+28h+var_24], ebx	; char
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_435B53

loc_4045FC:				; CODE XREF: sub_40458F+41j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40901E
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_40464B
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	esi, eax
		call	pth_thread_id
		mov	ebx, eax
		mov	[esp+28h+var_28], offset aHandler0xLxF_0 ; "handler 0x%lx for fd %d terminated\n"
		call	sub_435294
		mov	[esp+28h+var_20], esi
		mov	dword ptr [esp+28h+var_24], ebx	; char
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_435B53

loc_40464B:				; CODE XREF: sub_40458F+90j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4034A8
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, 0

loc_404666:				; CODE XREF: sub_40458F+2Aj
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40458F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40466D	proc near		; DATA XREF: sub_404743+77Co

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	dword ptr [esp+28h+var_24], offset dword_44904C
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_403F41
		test	eax, eax
		jz	short loc_40469C
		mov	eax, 0
		jmp	loc_40473C
; ---------------------------------------------------------------------------

loc_40469C:				; CODE XREF: sub_40466D+23j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_403366
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_4046DA
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	esi, eax
		call	pth_thread_id
		mov	ebx, eax
		mov	[esp+28h+var_28], offset aSshHandler0xLx ; "ssh	handler	0x%lx for fd %d	started\n"
		call	sub_435294
		mov	[esp+28h+var_20], esi
		mov	dword ptr [esp+28h+var_24], ebx	; char
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_435B53

loc_4046DA:				; CODE XREF: sub_40466D+41j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40DF58
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_404721
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	esi, eax
		call	pth_thread_id
		mov	ebx, eax
		mov	[esp+28h+var_28], offset aSshHandler0x_0 ; "ssh	handler	0x%lx for fd %d	terminated\"...
		call	sub_435294
		mov	[esp+28h+var_20], esi
		mov	dword ptr [esp+28h+var_24], ebx	; char
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_435B53

loc_404721:				; CODE XREF: sub_40466D+88j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4034A8
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, 0

loc_40473C:				; CODE XREF: sub_40466D+2Aj
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40466D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404743(SOCKET, SOCKET)
sub_404743	proc near		; CODE XREF: sub_402066+125Dp

fd		= dword	ptr -328h
var_324		= dword	ptr -324h
var_320		= dword	ptr -320h
var_31C		= dword	ptr -31Ch
var_318		= dword	ptr -318h
var_314		= dword	ptr -314h
var_2FE		= byte ptr -2FEh
var_2CD		= byte ptr -2CDh
var_2CC		= dword	ptr -2CCh
var_2C8		= dword	ptr -2C8h
var_2C4		= fd_set ptr -2C4h
var_1C0		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_BC		= dword	ptr -0BCh
var_B8		= byte ptr -0B8h
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 31Ch
		call	pth_attr_new
		mov	[ebp+var_2C], eax
		mov	[esp+328h+var_320], 0
		mov	[esp+328h+var_324], 2
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_attr_set
		mov	[esp+328h+var_320], 40000h
		mov	[esp+328h+var_324], 4
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_attr_set
		mov	[ebp+var_48], 0
		call	sub_403664
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+fd], 400h
		call	pth_event
		mov	[ebp+var_30], eax
		mov	[ebp+var_34], 0
		mov	[ebp+var_1C], 0
		mov	eax, ds:dword_449020
		test	eax, eax
		jz	short loc_40481E
		mov	[esp+328h+var_320], offset aPuttyMessage_1 ; "putty message loop"
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_attr_set
		mov	[esp+328h+var_320], 0
		mov	[esp+328h+var_324], offset sub_4043EA
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_spawn
		test	eax, eax
		jnz	short loc_40481E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aErrorSpawningP ;	"error spawning	putty message loop: %s\n"
		call	sub_435B7D

loc_40481E:				; CODE XREF: sub_404743+7Ej
					; sub_404743+B8j
		mov	ds:dword_449DC8, 1
		mov	[ebp+var_1C0], 0
		mov	[ebp+var_24], 0
		jmp	short loc_404850
; ---------------------------------------------------------------------------

loc_40483B:				; CODE XREF: sub_404743+116j
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+eax*4+var_1BC]
		mov	eax, [ebp+arg_0]
		cmp	edx, eax
		jz	short loc_40485B
		add	[ebp+var_24], 1

loc_404850:				; CODE XREF: sub_404743+F6j
		mov	eax, [ebp+var_1C0]
		cmp	eax, [ebp+var_24]
		ja	short loc_40483B

loc_40485B:				; CODE XREF: sub_404743+107j
		mov	eax, [ebp+var_1C0]
		cmp	eax, [ebp+var_24]
		jnz	short loc_40488D
		mov	eax, [ebp+var_1C0]
		cmp	eax, 3Fh
		ja	short loc_40488D
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_24]
		mov	[ebp+eax*4+var_1BC], edx
		mov	eax, [ebp+var_1C0]
		add	eax, 1
		mov	[ebp+var_1C0], eax

loc_40488D:				; CODE XREF: sub_404743+121j
					; sub_404743+12Cj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	short loc_404907
		mov	[ebp+var_28], 0
		jmp	short loc_4048B7
; ---------------------------------------------------------------------------

loc_4048A2:				; CODE XREF: sub_404743+17Dj
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+eax*4+var_1BC]
		mov	eax, [ebp+arg_4]
		cmp	edx, eax
		jz	short loc_4048C2
		add	[ebp+var_28], 1

loc_4048B7:				; CODE XREF: sub_404743+15Dj
		mov	eax, [ebp+var_1C0]
		cmp	eax, [ebp+var_28]
		ja	short loc_4048A2

loc_4048C2:				; CODE XREF: sub_404743+16Ej
		mov	eax, [ebp+var_1C0]
		cmp	eax, [ebp+var_28]
		jnz	short loc_4048F4
		mov	eax, [ebp+var_1C0]
		cmp	eax, 3Fh
		ja	short loc_4048F4
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_28]
		mov	[ebp+eax*4+var_1BC], edx
		mov	eax, [ebp+var_1C0]
		add	eax, 1
		mov	[ebp+var_1C0], eax

loc_4048F4:				; CODE XREF: sub_404743+188j
					; sub_404743+193j
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		cmp	edx, eax
		jbe	short loc_404907
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_20], eax
		jmp	short loc_404907
; ---------------------------------------------------------------------------

loc_404906:				; CODE XREF: sub_404743+5F2j
					; sub_404743+5FCj ...
		nop

loc_404907:				; CODE XREF: sub_404743+154j
					; sub_404743+1B9j ...
		mov	[esp+328h+var_320], 0
		lea	eax, [ebp+var_48]
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+fd], 1
		call	pth_sigmask
		mov	eax, ds:dword_449028
		test	eax, eax
		jz	short loc_40494A
		mov	[esp+328h+fd], 3F0h
		call	pth_ctrl
		cmp	eax, 1
		jz	loc_404F1F
		mov	[ebp+var_1C0], 0

loc_40494A:				; CODE XREF: sub_404743+1E6j
		cmp	[ebp+var_1C], 0
		jnz	short loc_4049B7
		mov	[esp+328h+var_324], 0
		mov	[esp+328h+fd], 4
		call	pth_timeout
		mov	[ebp+var_2CC], eax
		mov	[ebp+var_2C8], edx
		mov	eax, [ebp+var_2C8]
		cmp	eax, 0Ah
		jle	short loc_404994
		mov	eax, [ebp+var_2CC]
		add	eax, 1
		mov	[ebp+var_2CC], eax
		mov	[ebp+var_2C8], 0

loc_404994:				; CODE XREF: sub_404743+236j
		mov	eax, [ebp+var_2CC]
		mov	edx, [ebp+var_2C8]
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+var_320], edx
		mov	[esp+328h+fd], 10h
		call	pth_event
		mov	[ebp+var_1C], eax

loc_4049B7:				; CODE XREF: sub_404743+20Bj
		lea	edx, [ebp+var_2C4]
		lea	ebx, [ebp+var_1C0]
		mov	eax, 41h
		mov	edi, edx
		mov	esi, ebx
		mov	ecx, eax
		rep movsd
		cmp	[ebp+var_1C], 0
		jz	short loc_4049F0
		mov	[esp+328h+var_320], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+var_324], eax
		mov	eax, [ebp+var_30]
		mov	[esp+328h+fd], eax
		call	pth_event_concat

loc_4049F0:				; CODE XREF: sub_404743+291j
		mov	eax, [ebp+var_20]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_30]
		mov	[esp+328h+var_314], eax
		mov	[esp+328h+var_318], 0
		mov	[esp+328h+var_31C], 0
		mov	[esp+328h+var_320], 0
		lea	eax, [ebp+var_2C4]
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+fd], edx
		call	pth_select_ev
		mov	[ebp+var_38], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_404A3B
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_isolate

loc_404A3B:				; CODE XREF: sub_404743+2EBj
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	loc_404AFA
		mov	eax, [ebp+var_30]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jnz	short loc_404A69
		cmp	[ebp+var_1C], 0
		jz	short loc_404ABE
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_404ABE

loc_404A69:				; CODE XREF: sub_404743+30Fj
		mov	eax, [ebp+var_30]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_404A7D
		call	sub_403F04

loc_404A7D:				; CODE XREF: sub_404743+333j
		cmp	[ebp+var_1C], 0
		jz	loc_404F19
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	loc_404F19
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_free
		mov	[ebp+var_1C], 0
		call	sub_403E87
		jmp	loc_404F19
; ---------------------------------------------------------------------------

loc_404ABE:				; CODE XREF: sub_404743+315j
					; sub_404743+324j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	ebx, eax
		mov	[esp+328h+fd], offset aPth_selectFail ;	"pth_select failed: %s - waiting 1s\n"
		call	sub_435294
		mov	[esp+328h+var_324], ebx	; char
		mov	[esp+328h+fd], eax ; char *
		call	sub_435B7D
		mov	[esp+328h+fd], 1
		call	pth_sleep
		jmp	loc_404F1A
; ---------------------------------------------------------------------------

loc_404AFA:				; CODE XREF: sub_404743+2FCj
		mov	eax, [ebp+var_30]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_404B0E
		call	sub_403F04

loc_404B0E:				; CODE XREF: sub_404743+3C4j
		cmp	[ebp+var_1C], 0
		jz	short loc_404B42
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_404B42
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_free
		mov	[ebp+var_1C], 0
		call	sub_403E87

loc_404B42:				; CODE XREF: sub_404743+3CFj
					; sub_404743+3DEj
		mov	[esp+328h+var_320], 0
		lea	eax, [ebp+var_48]
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+fd], 0
		call	pth_sigmask
		mov	eax, ds:dword_449028
		test	eax, eax
		jnz	loc_404D2E
		mov	eax, [ebp+arg_0]
		lea	edx, [ebp+var_2C4]
		mov	[esp+328h+var_324], edx	; fd_set *
		mov	[esp+328h+fd], eax ; fd
		call	__WSAFDIsSet
		sub	esp, 8
		test	eax, eax
		jz	loc_404D2E
		mov	[ebp+var_BC], 70h
		mov	eax, [ebp+arg_0]
		lea	edx, [ebp+var_BC]
		mov	[esp+328h+var_320], edx
		lea	edx, [ebp+var_B8]
		mov	[esp+328h+var_324], edx
		mov	[esp+328h+fd], eax
		call	pth_accept
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0FFFFFFFFh
		jnz	short loc_404BE2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aAcceptFailedS ; "accept failed: %s\n"
		call	sub_435B7D
		jmp	loc_404D27
; ---------------------------------------------------------------------------

loc_404BE2:				; CODE XREF: sub_404743+477j
		mov	[esp+328h+var_324], 84h
		mov	[esp+328h+fd], 1
		call	gcry_calloc
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jnz	short loc_404C30
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aErrorAllocatin ;	"error allocating connection control dat"...
		call	sub_435B7D
		mov	eax, [ebp+var_3C]
		mov	[esp+328h+fd], eax
		call	assuan_sock_close
		jmp	loc_404D27
; ---------------------------------------------------------------------------

loc_404C30:				; CODE XREF: sub_404743+4BAj
		call	sub_41FB5C
		mov	edx, [ebp+var_40]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_40]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_404C81
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aErrorAllocat_0 ;	"error allocating session environment bl"...
		call	sub_435B7D
		mov	eax, [ebp+var_40]
		mov	[esp+328h+fd], eax
		call	gcry_free
		mov	eax, [ebp+var_3C]
		mov	[esp+328h+fd], eax
		call	assuan_sock_close
		jmp	loc_404D27
; ---------------------------------------------------------------------------

loc_404C81:				; CODE XREF: sub_404743+500j
		mov	eax, [ebp+var_3C]
		mov	[esp+328h+var_31C], eax
		mov	[esp+328h+var_320], offset aConnFdDGpg ; "conn fd=%d (gpg)"
		mov	[esp+328h+var_324], 31h
		lea	eax, [ebp+var_2FE]
		mov	[esp+328h+fd], eax
		call	sub_4241F9
		mov	[ebp+var_2CD], 0
		lea	eax, [ebp+var_2FE]
		mov	[esp+328h+var_320], eax
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_attr_set
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[eax], edx
		mov	eax, [ebp+var_40]
		mov	[esp+328h+var_320], eax
		mov	[esp+328h+var_324], offset sub_40458F
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_spawn
		test	eax, eax
		jnz	short loc_404D27
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aErrorSpawningC ;	"error spawning	connection handler: %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_3C]
		mov	[esp+328h+fd], eax
		call	assuan_sock_close
		mov	eax, [ebp+var_40]
		mov	[esp+328h+fd], eax
		call	gcry_free

loc_404D27:				; CODE XREF: sub_404743+49Aj
					; sub_404743+4E8j ...
		mov	[ebp+var_3C], 0FFFFFFFFh

loc_404D2E:				; CODE XREF: sub_404743+421j
					; sub_404743+441j
		mov	eax, ds:dword_449028
		test	eax, eax
		jnz	loc_404906
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	loc_404906
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_2C4]
		mov	[esp+328h+var_324], edx	; fd_set *
		mov	[esp+328h+fd], eax ; fd
		call	__WSAFDIsSet
		sub	esp, 8
		test	eax, eax
		jz	loc_404906
		mov	[ebp+var_BC], 70h
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_BC]
		mov	[esp+328h+var_320], edx
		lea	edx, [ebp+var_B8]
		mov	[esp+328h+var_324], edx
		mov	[esp+328h+fd], eax
		call	pth_accept
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0FFFFFFFFh
		jnz	short loc_404DBD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aAcceptFailedFo ;	"accept	failed for ssh:	%s\n"
		call	sub_435B7D
		jmp	loc_404F0D
; ---------------------------------------------------------------------------

loc_404DBD:				; CODE XREF: sub_404743+652j
		mov	[esp+328h+var_324], 84h
		mov	[esp+328h+fd], 1
		call	gcry_calloc
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jnz	short loc_404E0B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aErrorAllocatin ;	"error allocating connection control dat"...
		call	sub_435B7D
		mov	eax, [ebp+var_3C]
		mov	[esp+328h+fd], eax
		call	assuan_sock_close
		jmp	loc_404F0D
; ---------------------------------------------------------------------------

loc_404E0B:				; CODE XREF: sub_404743+695j
		call	sub_41FB5C
		mov	edx, [ebp+var_44]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_44]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_404E5C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aErrorAllocat_0 ;	"error allocating session environment bl"...
		call	sub_435B7D
		mov	eax, [ebp+var_44]
		mov	[esp+328h+fd], eax
		call	gcry_free
		mov	eax, [ebp+var_3C]
		mov	[esp+328h+fd], eax
		call	assuan_sock_close
		jmp	loc_404F0D
; ---------------------------------------------------------------------------

loc_404E5C:				; CODE XREF: sub_404743+6DBj
		mov	eax, [ebp+var_44]
		mov	[esp+328h+fd], eax
		call	sub_403366
		mov	eax, [ebp+var_3C]
		mov	[esp+328h+var_31C], eax
		mov	[esp+328h+var_320], offset aConnFdDSsh ; "conn fd=%d (ssh)"
		mov	[esp+328h+var_324], 31h
		lea	eax, [ebp+var_2FE]
		mov	[esp+328h+fd], eax
		call	sub_4241F9
		mov	[ebp+var_2CD], 0
		lea	eax, [ebp+var_2FE]
		mov	[esp+328h+var_320], eax
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_attr_set
		mov	eax, [ebp+var_44]
		mov	edx, [ebp+var_3C]
		mov	[eax], edx
		mov	eax, [ebp+var_44]
		mov	[esp+328h+var_320], eax
		mov	[esp+328h+var_324], offset sub_40466D
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_spawn
		test	eax, eax
		jnz	short loc_404F0D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aErrorSpawningS ;	"error spawning	ssh connection handler:	"...
		call	sub_435B7D
		mov	eax, [ebp+var_3C]
		mov	[esp+328h+fd], eax
		call	assuan_sock_close
		mov	eax, [ebp+var_44]
		mov	[esp+328h+fd], eax
		call	gcry_free

loc_404F0D:				; CODE XREF: sub_404743+675j
					; sub_404743+6C3j ...
		mov	[ebp+var_3C], 0FFFFFFFFh
		jmp	loc_404906
; ---------------------------------------------------------------------------

loc_404F19:				; CODE XREF: sub_404743+33Ej
					; sub_404743+351j ...
		nop

loc_404F1A:				; CODE XREF: sub_404743+3B2j
		jmp	loc_404906
; ---------------------------------------------------------------------------

loc_404F1F:				; CODE XREF: sub_404743+1F7j
		nop
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_30]
		mov	[esp+328h+fd], eax
		call	pth_event_free
		cmp	[ebp+var_1C], 0
		jz	short loc_404F4C
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_free

loc_404F4C:				; CODE XREF: sub_404743+7F4j
		call	sub_401BD6
		mov	[esp+328h+fd], 0Dh
		call	sub_437E99
		mov	esi, eax
		mov	[esp+328h+fd], 0Bh
		call	sub_437E99
		mov	ebx, eax
		mov	[esp+328h+fd], offset aSSStopped ; "%s %s stopped\n"
		call	sub_435294
		mov	[esp+328h+var_320], esi
		mov	[esp+328h+var_324], ebx	; char
		mov	[esp+328h+fd], eax ; char *
		call	sub_435B53
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_404743	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404F91(int, void *, size_t)
sub_404F91	proc near		; DATA XREF: sub_404FBD+DDo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_424524
		mov	eax, 0
		leave
		retn
sub_404F91	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404FBD	proc near		; DATA XREF: sub_4051ED+B7o

Str		= dword	ptr -48h
EndPtr		= dword	ptr -44h
Radix		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	[ebp+var_18], 0
		mov	eax, ds:dword_44902C
		add	eax, 1
		mov	ds:dword_44902C, eax
		lea	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405012
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	gpg_strerror
		mov	[esp+48h+EndPtr], eax ;	char
		mov	[esp+48h+Str], offset aCanTAllocateAs ;	"can't allocate assuan context: %s\n"
		call	sub_435B7D
		jmp	loc_40517A
; ---------------------------------------------------------------------------

loc_405012:				; CODE XREF: sub_404FBD+33j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+Radix], 0FFFFFFFFh
		mov	edx, [ebp+var_10]
		mov	[esp+48h+EndPtr], edx
		mov	[esp+48h+Str], eax
		call	assuan_socket_connect
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40505D
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	gpg_strerror
		mov	[esp+48h+EndPtr], eax ;	char
		mov	[esp+48h+Str], offset aCanTConnectMyO ;	"can't connect my own socket: %s\n"
		call	sub_435B7D
		jmp	loc_40517A
; ---------------------------------------------------------------------------

loc_40505D:				; CODE XREF: sub_404FBD+7Ej
		mov	[esp+48h+EndPtr], 64h
		lea	eax, [ebp+var_28]
		mov	[esp+48h+Str], eax
		call	sub_424484
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_2C], 0
		mov	[esp+48h+var_30], 0
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		lea	edx, [ebp+var_28]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Radix], offset	sub_404F91
		mov	[esp+48h+EndPtr], offset aGetinfoPid ; "GETINFO	pid"
		mov	[esp+48h+Str], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	[esp+48h+Radix], 1 ; size_t
		mov	[esp+48h+EndPtr], offset byte_43E80C ; void *
		lea	eax, [ebp+var_28]
		mov	[esp+48h+Str], eax ; int
		call	sub_424524
		mov	[esp+48h+EndPtr], 0
		lea	eax, [ebp+var_28]
		mov	[esp+48h+Str], eax
		call	sub_424656
		mov	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4050F2
		cmp	[ebp+var_14], 0
		jnz	short loc_40511E

loc_4050F2:				; CODE XREF: sub_404FBD+12Dj
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	gpg_strerror
		mov	[esp+48h+Radix], eax
		mov	[esp+48h+EndPtr], offset aGetinfoPid ; "GETINFO	pid"
		mov	[esp+48h+Str], offset aSendingCommand ;	"sending command \"%s\"	to my own socket"...
		call	sub_435B7D
		mov	[ebp+var_C], 1
		jmp	short loc_40516F
; ---------------------------------------------------------------------------

loc_40511E:				; CODE XREF: sub_404FBD+133j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Radix], 0Ah ; Radix
		mov	[esp+48h+EndPtr], 0 ; char
		mov	[esp+48h+Str], eax ; Str
		call	strtoul
		mov	ebx, eax
		call	_getpid
		cmp	ebx, eax
		jz	short loc_405159
		mov	[esp+48h+Str], offset aSocketIsNowSer ;	"socket	is now serviced	by another serve"...
		call	sub_435B7D
		mov	[ebp+var_C], 1
		jmp	short loc_40516F
; ---------------------------------------------------------------------------

loc_405159:				; CODE XREF: sub_404FBD+185j
		mov	eax, ds:dword_449DA4
		cmp	eax, 1
		jle	short loc_40516F
		mov	[esp+48h+Str], offset aSocketIsStillS ;	"socket	is still served	by this	server\n"
		call	sub_435B7D

loc_40516F:				; CODE XREF: sub_404FBD+15Fj
					; sub_404FBD+19Aj ...
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Str], eax
		call	gcry_free

loc_40517A:				; CODE XREF: sub_404FBD+50j
					; sub_404FBD+9Bj
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		test	eax, eax
		jz	short loc_405197
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax
		call	assuan_release

loc_405197:				; CODE XREF: sub_404FBD+1CDj
		cmp	[ebp+var_C], 0
		jz	short loc_4051D5
		mov	eax, ds:dword_449030
		test	eax, eax
		jz	short loc_4051AE
		mov	eax, ds:dword_449030
		mov	byte ptr [eax],	0

loc_4051AE:				; CODE XREF: sub_404FBD+1E7j
		mov	eax, ds:dword_449034
		test	eax, eax
		jz	short loc_4051BF
		mov	eax, ds:dword_449034
		mov	byte ptr [eax],	0

loc_4051BF:				; CODE XREF: sub_404FBD+1F8j
		mov	ds:dword_449028, 2
		mov	[esp+48h+Str], offset aThisProcessIsU ;	"this process is useless - shutting down"...
		call	sub_435B53

loc_4051D5:				; CODE XREF: sub_404FBD+1DEj
		mov	eax, ds:dword_44902C
		sub	eax, 1
		mov	ds:dword_44902C, eax
		mov	eax, 0
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_404FBD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4051ED	proc near		; CODE XREF: sub_403E87+3Ep

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449DC4
		test	eax, eax
		jz	loc_4052E9
		mov	eax, ds:dword_44902C
		test	eax, eax
		jnz	loc_4052EC
		mov	eax, ds:dword_449028
		test	eax, eax
		jnz	loc_4052EC
		mov	eax, ds:dword_449DB4
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], offset aS_gpgAgent ; "S.gpg-agent"
		mov	[esp+28h+var_28], eax
		call	sub_432667
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_4052EF
		call	pth_attr_new
		mov	[ebp+var_10], eax
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 2
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_attr_set
		mov	[esp+28h+var_20], 40000h
		mov	dword ptr [esp+28h+var_24], 4
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_attr_set
		mov	[esp+28h+var_20], offset aCheckOwnSocket ; "check-own-socket"
		mov	dword ptr [esp+28h+var_24], 1
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_attr_set
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], offset sub_404FBD
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_spawn
		test	eax, eax
		jnz	short loc_4052DC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorSpawnin_0 ; "error spawning check_own_socket_thread:"...
		call	sub_435B7D

loc_4052DC:				; CODE XREF: sub_4051ED+CCj
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_attr_destroy
		jmp	short locret_4052F0
; ---------------------------------------------------------------------------

loc_4052E9:				; CODE XREF: sub_4051ED+Dj
		nop
		jmp	short locret_4052F0
; ---------------------------------------------------------------------------

loc_4052EC:				; CODE XREF: sub_4051ED+1Aj
					; sub_4051ED+27j
		nop
		jmp	short locret_4052F0
; ---------------------------------------------------------------------------

loc_4052EF:				; CODE XREF: sub_4051ED+51j
		nop

locret_4052F0:				; CODE XREF: sub_4051ED+FAj
					; sub_4051ED+FDj ...
		leave
		retn
sub_4051ED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4052F2	proc near		; CODE XREF: sub_402066+F3Dp
					; sub_4038EB+1BDp ...

VarName		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_20], 0
		cmp	[ebp+arg_4], 0
		jnz	loc_4054A0
		mov	[esp+38h+VarName], offset aGpg_agent_info ; "GPG_AGENT_INFO"
		call	getenv
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_405328
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40536D

loc_405328:				; CODE XREF: sub_4052F2+2Aj
		mov	[esp+38h+Val], 1 ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax
		call	sub_4052F2
		test	eax, eax
		jnz	short loc_405349
		mov	eax, 0
		jmp	locret_40559F
; ---------------------------------------------------------------------------

loc_405349:				; CODE XREF: sub_4052F2+4Bj
		cmp	[ebp+arg_0], 0
		jnz	short loc_405363
		mov	[esp+38h+VarName], offset aNoGpgAgentRunn ; "no	gpg-agent running in this session\n"
		call	sub_435294
		mov	[esp+38h+VarName], eax ; char *
		call	sub_435B7D

loc_405363:				; CODE XREF: sub_4052F2+5Bj
		mov	eax, 0FFFFFFFFh
		jmp	locret_40559F
; ---------------------------------------------------------------------------

loc_40536D:				; CODE XREF: sub_4052F2+34j
		mov	eax, [ebp+Str]
		mov	[esp+38h+VarName], eax
		call	gcry_xstrdup
		mov	[ebp+Str], eax
		mov	[esp+38h+Val], 3Bh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+38h+VarName], eax ; Str
		call	strchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40539F
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+Str]
		jnz	short loc_4053EF

loc_40539F:				; CODE XREF: sub_4052F2+A3j
		mov	eax, [ebp+Str]
		mov	[esp+38h+VarName], eax
		call	gcry_free
		mov	[esp+38h+Val], 1 ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax
		call	sub_4052F2
		test	eax, eax
		jnz	short loc_4053CB
		mov	eax, 0
		jmp	locret_40559F
; ---------------------------------------------------------------------------

loc_4053CB:				; CODE XREF: sub_4052F2+CDj
		cmp	[ebp+arg_0], 0
		jnz	short loc_4053E5
		mov	[esp+38h+VarName], offset aMalformedGpg_a ; "malformed GPG_AGENT_INFO environment va"...
		call	sub_435294
		mov	[esp+38h+VarName], eax ; char *
		call	sub_435B7D

loc_4053E5:				; CODE XREF: sub_4052F2+DDj
		mov	eax, 0FFFFFFFFh
		jmp	locret_40559F
; ---------------------------------------------------------------------------

loc_4053EF:				; CODE XREF: sub_4052F2+ABj
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	[esp+38h+VarName], eax ; Str
		call	atoi
		mov	[ebp+var_18], eax
		jmp	short loc_40540D
; ---------------------------------------------------------------------------

loc_405409:				; CODE XREF: sub_4052F2+12Dj
		add	[ebp+var_14], 1

loc_40540D:				; CODE XREF: sub_4052F2+115j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405421
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Bh
		jnz	short loc_405409

loc_405421:				; CODE XREF: sub_4052F2+123j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40543B
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+38h+VarName], eax ; Str
		call	atoi
		jmp	short loc_405440
; ---------------------------------------------------------------------------

loc_40543B:				; CODE XREF: sub_4052F2+137j
		mov	eax, 0

loc_405440:				; CODE XREF: sub_4052F2+147j
		mov	dword ptr [ebp+var_1C],	eax
		cmp	dword ptr [ebp+var_1C],	1
		jz	short loc_4054C7
		mov	eax, [ebp+Str]
		mov	[esp+38h+VarName], eax
		call	gcry_free
		cmp	[ebp+arg_0], 0
		jnz	short loc_405475
		mov	[esp+38h+VarName], offset aGpgAgentProtoc ; "gpg-agent protocol	version	%d is not su"...
		call	sub_435294
		mov	edx, dword ptr [ebp+var_1C]
		mov	[esp+38h+Val], edx ; char
		mov	[esp+38h+VarName], eax ; char *
		call	sub_435B7D

loc_405475:				; CODE XREF: sub_4052F2+166j
		mov	[esp+38h+Val], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax
		call	sub_4052F2
		test	eax, eax
		jnz	short loc_405496
		mov	eax, 0
		jmp	locret_40559F
; ---------------------------------------------------------------------------

loc_405496:				; CODE XREF: sub_4052F2+198j
		mov	eax, 0FFFFFFFFh
		jmp	locret_40559F
; ---------------------------------------------------------------------------

loc_4054A0:				; CODE XREF: sub_4052F2+11j
		mov	eax, ds:dword_449DB4
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Val], offset aS_gpgAgent ; "S.gpg-agent"
		mov	[esp+38h+VarName], eax
		call	sub_432667
		mov	[ebp+Str], eax
		mov	[ebp+var_18], 0FFFFFFFFh

loc_4054C7:				; CODE XREF: sub_4052F2+155j
		lea	eax, [ebp+var_20]
		mov	[esp+38h+VarName], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4054FF
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_2C], 0
		mov	edx, [ebp+var_18]
		mov	[esp+38h+var_30], edx
		mov	edx, [ebp+Str]
		mov	[esp+38h+Val], edx ; char
		mov	[esp+38h+VarName], eax
		call	assuan_socket_connect
		mov	[ebp+var_C], eax

loc_4054FF:				; CODE XREF: sub_4052F2+1E7j
		mov	eax, [ebp+Str]
		mov	[esp+38h+VarName], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_405574
		cmp	[ebp+arg_4], 0
		jnz	short loc_405534
		mov	[esp+38h+Val], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax
		call	sub_4052F2
		test	eax, eax
		jnz	short loc_405534
		mov	eax, 0
		jmp	short locret_40559F
; ---------------------------------------------------------------------------

loc_405534:				; CODE XREF: sub_4052F2+222j
					; sub_4052F2+239j
		cmp	[ebp+arg_4], 0
		jnz	short loc_40555B
		cmp	[ebp+arg_0], 0
		jnz	short loc_40555B
		mov	eax, [ebp+var_C]
		mov	[esp+38h+VarName], eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+VarName], offset aCanTConnectToT ; "can't connect to the agent: %s\n"
		call	sub_435B7D

loc_40555B:				; CODE XREF: sub_4052F2+246j
					; sub_4052F2+24Cj
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_40556D
		mov	eax, [ebp+var_20]
		mov	[esp+38h+VarName], eax
		call	assuan_release

loc_40556D:				; CODE XREF: sub_4052F2+26Ej
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40559F
; ---------------------------------------------------------------------------

loc_405574:				; CODE XREF: sub_4052F2+21Cj
		mov	eax, ds:dword_449DA8
		test	eax, eax
		jnz	short loc_40558F
		cmp	[ebp+arg_0], 0
		jnz	short loc_40558F
		mov	[esp+38h+VarName], offset aGpgAgentRunnin ; "gpg-agent running and available\n"
		call	sub_435B53

loc_40558F:				; CODE XREF: sub_4052F2+289j
					; sub_4052F2+28Fj
		mov	eax, [ebp+var_20]
		mov	[esp+38h+VarName], eax
		call	assuan_release
		mov	eax, 0

locret_40559F:				; CODE XREF: sub_4052F2+52j
					; sub_4052F2+76j ...
		leave
		retn
sub_4052F2	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4055A4	proc near		; CODE XREF: sub_4055CB+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4055C4
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4055C9
; ---------------------------------------------------------------------------

loc_4055C4:				; CODE XREF: sub_4055A4+7j
		mov	eax, 0

loc_4055C9:				; CODE XREF: sub_4055A4+1Ej
		pop	ebp
		retn
sub_4055A4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4055CB	proc near		; CODE XREF: sub_4055F3+Ep
					; sub_4059FE+7Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_4055A4
		leave
		retn
sub_4055CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4055E6	proc near		; CODE XREF: sub_405DF8+13Ap
					; sub_405DF8+155p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_4055E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4055F3	proc near		; CODE XREF: sub_405608+6p
					; sub_4069FA+C7p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_4055CB
		leave
		retn
sub_4055F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405608	proc near		; CODE XREF: sub_40565D+21p
					; sub_40624F+C5p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_4055F3
		leave
		retn
sub_405608	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405615	proc near		; CODE XREF: sub_406727+89p
					; sub_406810+A9p ...

Dst		= dword	ptr -28h
Val		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_10]
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_424656
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short locret_40565B
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Val], 0 ; Val
		mov	[esp+28h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Dst], eax
		call	gcry_free

locret_40565B:				; CODE XREF: sub_405615+1Fj
		leave
		retn
sub_405615	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40565D	proc near		; CODE XREF: sub_406727+9Dp
					; sub_406810+BDp ...

Dst		= dword	ptr -28h
Val		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Dst], eax
		call	sub_424656
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405685
		call	sub_405608
		jmp	short locret_4056C9
; ---------------------------------------------------------------------------

loc_405685:				; CODE XREF: sub_40565D+1Fj
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	assuan_send_data
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Val], 0 ; Val
		mov	[esp+28h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_10]

locret_4056C9:				; CODE XREF: sub_40565D+26j
		leave
		retn
sub_40565D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4056CB	proc near		; DATA XREF: sub_408F4F+9Eo

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 64h
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+78h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+5Ch], 0
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, 0
		leave
		retn
sub_4056CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405740(char *, char *)
sub_405740	proc near		; CODE XREF: sub_406326+3Dp
					; sub_406326+60p ...

Str		= dword	ptr -38h
SubStr		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+SubStr], eax ;	SubStr
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4057D4
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_0]
		jz	short loc_4057A6
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4057A6
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4057D4

loc_4057A6:				; CODE XREF: sub_405740+4Aj
					; sub_405740+57j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4057CD
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4057CD
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4057D4

loc_4057CD:				; CODE XREF: sub_405740+71j
					; sub_405740+7Ej
		mov	eax, 1
		jmp	short loc_4057D9
; ---------------------------------------------------------------------------

loc_4057D4:				; CODE XREF: sub_405740+42j
					; sub_405740+64j ...
		mov	eax, 0

loc_4057D9:				; CODE XREF: sub_405740+92j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_405740	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4057DF(char *, char *)
sub_4057DF	proc near		; CODE XREF: sub_406326+22p
					; sub_4074BA+9Fp

Str		= dword	ptr -38h
SubStr		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+SubStr], eax ;	SubStr
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_405880
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_0]
		jz	short loc_405845
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_405845
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_405880

loc_405845:				; CODE XREF: sub_4057DF+4Aj
					; sub_4057DF+57j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405879
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_405879
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_405879
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_405880

loc_405879:				; CODE XREF: sub_4057DF+71j
					; sub_4057DF+7Ej ...
		mov	eax, 1
		jmp	short loc_405885
; ---------------------------------------------------------------------------

loc_405880:				; CODE XREF: sub_4057DF+42j
					; sub_4057DF+64j ...
		mov	eax, 0

loc_405885:				; CODE XREF: sub_4057DF+9Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4057DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40588B(char *, char *)
sub_40588B	proc near		; CODE XREF: sub_4074BA+B6p

Str		= dword	ptr -38h
SubStr		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+SubStr], eax ;	SubStr
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_40596B
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_0]
		jz	short loc_4058F5
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4058F5
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40596B

loc_4058F5:				; CODE XREF: sub_40588B+4Ej
					; sub_40588B+5Bj
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40596B
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_405929
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_405929
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_40596B

loc_405929:				; CODE XREF: sub_40588B+82j
					; sub_40588B+8Fj
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	[ebp+var_10], eax
		mov	[esp+38h+SubStr], offset Control ; " "
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax ; Str
		call	strspn
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40596B
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40596B
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_40596B
		mov	eax, [ebp+var_10]
		jmp	short loc_405970
; ---------------------------------------------------------------------------

loc_40596B:				; CODE XREF: sub_40588B+42j
					; sub_40588B+68j ...
		mov	eax, 0

loc_405970:				; CODE XREF: sub_40588B+DEj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40588B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405976	proc near		; CODE XREF: sub_406326+173p
					; sub_406F3A+A5p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		jmp	short loc_4059BD
; ---------------------------------------------------------------------------

loc_40597B:				; CODE XREF: sub_405976+28j
		add	[ebp+arg_0], 1
		jmp	short loc_405982
; ---------------------------------------------------------------------------

loc_405981:				; CODE XREF: sub_405976+5Cj
		nop

loc_405982:				; CODE XREF: sub_405976+9j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4059A8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4059A8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40597B
		jmp	short loc_4059A8
; ---------------------------------------------------------------------------

loc_4059A2:				; CODE XREF: sub_405976+3Bj
					; sub_405976+45j
		add	[ebp+arg_0], 1
		jmp	short loc_4059A9
; ---------------------------------------------------------------------------

loc_4059A8:				; CODE XREF: sub_405976+14j
					; sub_405976+1Ej ...
		nop

loc_4059A9:				; CODE XREF: sub_405976+30j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4059A2
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4059A2

loc_4059BD:				; CODE XREF: sub_405976+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4059D4
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_405981

loc_4059D4:				; CODE XREF: sub_405976+4Fj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_405976	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4059D9	proc near		; CODE XREF: sub_40624F+8Ep
					; sub_4074BA+3A7p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		jmp	short loc_4059F2
; ---------------------------------------------------------------------------

loc_4059DE:				; CODE XREF: sub_4059D9+21j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_4059EE
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	20h

loc_4059EE:				; CODE XREF: sub_4059D9+Dj
		add	[ebp+arg_0], 1

loc_4059F2:				; CODE XREF: sub_4059D9+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4059DE
		pop	ebp
		retn
sub_4059D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4059FE	proc near		; CODE XREF: sub_405AD8+21p
					; sub_406326+23Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_405A1B
; ---------------------------------------------------------------------------

loc_405A13:				; CODE XREF: sub_4059FE+2Fj
					; sub_4059FE+43j ...
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_405A1B:				; CODE XREF: sub_4059FE+13j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_405A2F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_405A13

loc_405A2F:				; CODE XREF: sub_4059FE+25j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_405A43
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_405A13

loc_405A43:				; CODE XREF: sub_4059FE+39j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_405A57
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_405A13

loc_405A57:				; CODE XREF: sub_4059FE+4Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_405A9A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_405A9A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405A9A
		mov	[esp+28h+var_28], 118h
		call	sub_4055CB
		mov	[esp+28h+var_20], offset aInvalidHexstri ; "invalid hexstring"
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_set_error
		jmp	short locret_405AD6
; ---------------------------------------------------------------------------

loc_405A9A:				; CODE XREF: sub_4059FE+61j
					; sub_4059FE+6Bj ...
		mov	eax, [ebp+var_10]
		and	eax, 1
		test	al, al
		jz	short loc_405AC9
		mov	[esp+28h+var_28], 118h
		call	sub_4055CB
		mov	[esp+28h+var_20], offset aOddNumberOfDig ; "odd	number of digits"
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_set_error
		jmp	short locret_405AD6
; ---------------------------------------------------------------------------

loc_405AC9:				; CODE XREF: sub_4059FE+A4j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, 0

locret_405AD6:				; CODE XREF: sub_4059FE+9Aj
					; sub_4059FE+C9j
		leave
		retn
sub_4059FE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405AD8	proc near		; CODE XREF: sub_4061AF+1Ap
					; sub_406200+2Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4059FE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405B0C
		mov	eax, [ebp+var_C]
		jmp	short locret_405B89
; ---------------------------------------------------------------------------

loc_405B0C:				; CODE XREF: sub_405AD8+2Dj
		mov	eax, [ebp+var_10]
		shr	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, 14h
		jz	short loc_405B41
		mov	[esp+28h+var_28], 118h
		call	sub_4055CB
		mov	[esp+28h+var_20], offset aInvalidLengthO ; "invalid length of keygrip"
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_set_error
		jmp	short locret_405B89
; ---------------------------------------------------------------------------

loc_405B41:				; CODE XREF: sub_405AD8+42j
		mov	[esp+28h+var_20], 14h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_4246F8
		test	eax, eax
		jns	short loc_405B84
		mov	[esp+28h+var_28], 3Bh
		call	sub_4055CB
		mov	[esp+28h+var_20], offset aHex2bin ; "hex2bin"
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_set_error
		jmp	short locret_405B89
; ---------------------------------------------------------------------------

loc_405B84:				; CODE XREF: sub_405AD8+85j
		mov	eax, 0

locret_405B89:				; CODE XREF: sub_405AD8+32j
					; sub_405AD8+67j ...
		leave
		retn
sub_405AD8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405B8B	proc near		; CODE XREF: sub_405D08+ABp
					; sub_406B69+2CBp ...

var_3E8		= dword	ptr -3E8h
var_3E4		= dword	ptr -3E4h
var_3E0		= dword	ptr -3E0h
var_3D6		= byte ptr -3D6h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 3E8h
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_20]
		mov	[eax], edx
		lea	eax, [ebp+var_3D6]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		jmp	loc_405C46
; ---------------------------------------------------------------------------

loc_405BC3:				; CODE XREF: sub_405B8B+CDj
		cmp	[ebp+var_14], 0
		jz	short loc_405C32
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	20h
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1
		jmp	short loc_405C32
; ---------------------------------------------------------------------------

loc_405BD9:				; CODE XREF: sub_405B8B+B9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_405BF9
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_10], 1
		jmp	short loc_405C28
; ---------------------------------------------------------------------------

loc_405BF9:				; CODE XREF: sub_405B8B+56j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_405C19
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	72h
		add	[ebp+var_10], 1
		jmp	short loc_405C28
; ---------------------------------------------------------------------------

loc_405C19:				; CODE XREF: sub_405B8B+76j
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1

loc_405C28:				; CODE XREF: sub_405B8B+6Cj
					; sub_405B8B+8Cj
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_405C33
; ---------------------------------------------------------------------------

loc_405C32:				; CODE XREF: sub_405B8B+3Cj
					; sub_405B8B+4Cj
		nop

loc_405C33:				; CODE XREF: sub_405B8B+A5j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405C46
		cmp	[ebp+var_14], 3B2h
		jbe	short loc_405BD9

loc_405C46:				; CODE XREF: sub_405B8B+33j
					; sub_405B8B+B0j
		mov	eax, [ebp+var_20]
		lea	edx, [eax+4]
		mov	[ebp+var_20], edx
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_405BC3
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_3D6]
		mov	[esp+3E8h+var_3E0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+3E8h+var_3E4], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+3E8h+var_3E8], eax
		call	assuan_write_status
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		leave
		retn
sub_405B8B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405C88	proc near		; CODE XREF: sub_40E7CF+94Bp

var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_6C		= byte ptr -6Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		cmp	[ebp+arg_0], 0
		jz	short loc_405CAE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405CAE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	short loc_405CB5

loc_405CAE:				; CODE XREF: sub_405C88+Dj
					; sub_405C88+17j
		mov	eax, 0
		jmp	short locret_405D06
; ---------------------------------------------------------------------------

loc_405CB5:				; CODE XREF: sub_405C88+24j
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+var_8C], eax
		mov	[esp+98h+var_90], offset aPinentry_launc ; "PINENTRY_LAUNCHED %lu"
		mov	[esp+98h+var_94], 63h
		lea	eax, [ebp+var_6C]
		mov	[esp+98h+var_98], eax
		call	sub_4241F9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[esp+98h+var_88], 0
		mov	[esp+98h+var_8C], 0
		mov	[esp+98h+var_90], 0
		lea	edx, [ebp+var_6C]
		mov	[esp+98h+var_94], edx
		mov	[esp+98h+var_98], eax
		call	assuan_inquire

locret_405D06:				; CODE XREF: sub_405C88+2Bj
		leave
		retn
sub_405C88	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405D08	proc near		; DATA XREF: .data:0043D3E4o

var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_57		= byte ptr -57h
var_3E		= byte ptr -3Eh
var_25		= byte ptr -25h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+var_78], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449E28
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], offset aU_2 ;	"%u"
		mov	[esp+78h+var_74], 19h
		lea	eax, [ebp+var_25]
		mov	[esp+78h+var_78], eax
		call	sub_4241F9
		mov	eax, ds:dword_449E2C
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], offset aU_2 ;	"%u"
		mov	[esp+78h+var_74], 19h
		lea	eax, [ebp+var_3E]
		mov	[esp+78h+var_78], eax
		call	sub_4241F9
		mov	eax, ds:dword_449E30
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], offset aU_2 ;	"%u"
		mov	[esp+78h+var_74], 19h
		lea	eax, [ebp+var_57]
		mov	[esp+78h+var_78], eax
		call	sub_4241F9
		mov	[esp+78h+var_64], 0
		lea	eax, [ebp+var_57]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_3E]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_25]
		mov	[esp+78h+var_70], eax
		mov	[esp+78h+var_74], offset aEventcounter ; "EVENTCOUNTER"
		mov	eax, [ebp+var_C]
		mov	[esp+78h+var_78], eax
		call	sub_405B8B
		leave
		retn
sub_405D08	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405DBA	proc near		; CODE XREF: sub_4118C7:loc_411B48p
					; sub_419203+31p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_449E2C
		add	eax, 1
		mov	ds:dword_449E2C, eax
		mov	eax, ds:dword_449E28
		add	eax, 1
		mov	ds:dword_449E28, eax
		pop	ebp
		retn
sub_405DBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405DD9	proc near		; CODE XREF: sub_403F04:loc_403F1Fp
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_449E30
		add	eax, 1
		mov	ds:dword_449E30, eax
		mov	eax, ds:dword_449E28
		add	eax, 1
		mov	ds:dword_449E28, eax
		pop	ebp
		retn
sub_405DD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405DF8	proc near		; DATA XREF: .data:0043D3F0o

var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= dword	ptr -50h
var_45		= byte ptr -45h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	assuan_get_pointer
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_405E23
; ---------------------------------------------------------------------------

loc_405E1B:				; CODE XREF: sub_405DF8+3Dj
					; sub_405DF8+51j ...
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_405E23:				; CODE XREF: sub_405DF8+21j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_405E37
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_405E1B

loc_405E37:				; CODE XREF: sub_405DF8+33j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_405E4B
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_405E1B

loc_405E4B:				; CODE XREF: sub_405DF8+47j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_405E5F
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_405E1B

loc_405E5F:				; CODE XREF: sub_405DF8+5Bj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405E75
		cmp	[ebp+var_C], 28h
		jz	short loc_405E9D
		cmp	[ebp+var_C], 20h
		jz	short loc_405E9D

loc_405E75:				; CODE XREF: sub_405DF8+6Fj
		mov	[esp+58h+var_58], 118h
		call	sub_4055CB
		mov	[esp+58h+var_50], offset aInvalidFingerp ; "invalid fingerprint"
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	assuan_set_error
		jmp	locret_405F85
; ---------------------------------------------------------------------------

loc_405E9D:				; CODE XREF: sub_405DF8+75j
					; sub_405DF8+7Bj
		mov	[ebp+var_10], 0
		cmp	[ebp+var_C], 20h
		jnz	short loc_405EC7
		mov	edx, offset a00000000 ;	"00000000"
		lea	eax, [ebp+var_45]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		add	[ebp+var_10], 8

loc_405EC7:				; CODE XREF: sub_405DF8+B0j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	short loc_405EFA
; ---------------------------------------------------------------------------

loc_405ECF:				; CODE XREF: sub_405DF8+106j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_405EE4
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		jmp	short loc_405EEA
; ---------------------------------------------------------------------------

loc_405EE4:				; CODE XREF: sub_405DF8+DFj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]

loc_405EEA:				; CODE XREF: sub_405DF8+EAj
		lea	edx, [ebp+var_45]
		add	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_405EFA:				; CODE XREF: sub_405DF8+D5j
		cmp	[ebp+var_10], 27h
		jle	short loc_405ECF
		lea	eax, [ebp+var_45]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[esp+58h+var_50], 0
		lea	eax, [ebp+var_45]
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_418748
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_405F3C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_4055E6
		cmp	eax, 62h
		jnz	short loc_405F41

loc_405F3C:				; CODE XREF: sub_405DF8+132j
		mov	eax, [ebp+var_1C]
		jmp	short locret_405F85
; ---------------------------------------------------------------------------

loc_405F41:				; CODE XREF: sub_405DF8+142j
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_405F59
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_4055E6
		cmp	eax, 3FFFh
		jnz	short loc_405F67

loc_405F59:				; CODE XREF: sub_405DF8+14Dj
		mov	[esp+58h+var_58], 62h
		call	sub_4055CB
		jmp	short locret_405F85
; ---------------------------------------------------------------------------

loc_405F67:				; CODE XREF: sub_405DF8+15Fj
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aCommandIs_trus ; "command is_trusted failed: %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_1C]

locret_405F85:				; CODE XREF: sub_405DF8+A0j
					; sub_405DF8+147j ...
		leave
		retn
sub_405DF8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405F87	proc near		; DATA XREF: .data:0043D4A4o

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4188E0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405FBC
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aCommandListtru ; "command listtrusted	failed:	%s\n"
		call	sub_435B7D

loc_405FBC:				; CODE XREF: sub_405F87+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405F87	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405FC1	proc near		; DATA XREF: .data:0043D4B0o

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_49		= dword	ptr -49h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	assuan_get_pointer
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_405FEC
; ---------------------------------------------------------------------------

loc_405FE4:				; CODE XREF: sub_405FC1+3Dj
					; sub_405FC1+51j ...
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_405FEC:				; CODE XREF: sub_405FC1+21j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_406000
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_405FE4

loc_406000:				; CODE XREF: sub_405FC1+33j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_406014
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_405FE4

loc_406014:				; CODE XREF: sub_405FC1+47j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_406028
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_405FE4

loc_406028:				; CODE XREF: sub_405FC1+5Bj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40603C
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_406048

loc_40603C:				; CODE XREF: sub_405FC1+6Fj
		cmp	[ebp+var_C], 28h
		jz	short loc_406070
		cmp	[ebp+var_C], 20h
		jz	short loc_406070

loc_406048:				; CODE XREF: sub_405FC1+79j
		mov	[esp+68h+var_68], 118h
		call	sub_4055CB
		mov	[esp+68h+var_60], offset aInvalidFingerp ; "invalid fingerprint"
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	assuan_set_error
		jmp	locret_4061AD
; ---------------------------------------------------------------------------

loc_406070:				; CODE XREF: sub_405FC1+7Fj
					; sub_405FC1+85j
		mov	[ebp+var_10], 0
		cmp	[ebp+var_C], 20h
		jnz	short loc_40609A
		mov	edx, offset a00000000 ;	"00000000"
		lea	eax, [ebp+var_49]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		add	[ebp+var_10], 8

loc_40609A:				; CODE XREF: sub_405FC1+BAj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	short loc_4060CD
; ---------------------------------------------------------------------------

loc_4060A2:				; CODE XREF: sub_405FC1+110j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4060B7
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		jmp	short loc_4060BD
; ---------------------------------------------------------------------------

loc_4060B7:				; CODE XREF: sub_405FC1+E9j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]

loc_4060BD:				; CODE XREF: sub_405FC1+F4j
		lea	edx, [ebp+var_49]
		add	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_4060CD:				; CODE XREF: sub_405FC1+DFj
		cmp	[ebp+var_10], 27h
		jle	short loc_4060A2
		lea	eax, [ebp+var_49]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		jmp	short loc_4060E2
; ---------------------------------------------------------------------------

loc_4060DE:				; CODE XREF: sub_405FC1+129j
					; sub_405FC1+133j
		add	[ebp+var_14], 1

loc_4060E2:				; CODE XREF: sub_405FC1+11Bj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4060DE
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4060DE
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[ebp+var_1C], eax
		add	[ebp+var_14], 1
		cmp	[ebp+var_1C], 53h
		jz	short loc_406112
		cmp	[ebp+var_1C], 50h
		jnz	short loc_406126

loc_406112:				; CODE XREF: sub_405FC1+149j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_406151
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_406151

loc_406126:				; CODE XREF: sub_405FC1+14Fj
		mov	[esp+68h+var_68], 118h
		call	sub_4055CB
		mov	[esp+68h+var_60], offset aInvalidFlagMus ; "invalid flag - must	be P or	S"
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	assuan_set_error
		jmp	short locret_4061AD
; ---------------------------------------------------------------------------

loc_40614B:				; CODE XREF: sub_405FC1+199j
					; sub_405FC1+1A3j
		add	[ebp+var_14], 1
		jmp	short loc_406152
; ---------------------------------------------------------------------------

loc_406151:				; CODE XREF: sub_405FC1+159j
					; sub_405FC1+163j
		nop

loc_406152:				; CODE XREF: sub_405FC1+18Ej
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40614B
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_40614B
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+var_5C], eax ;	int
		lea	eax, [ebp+var_49]
		mov	[esp+68h+var_60], eax ;	int
		mov	eax, [ebp+var_14]
		mov	[esp+68h+var_64], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+68h+var_68], eax ;	int
		call	sub_418C2D
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4061AA
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_68], eax
		call	gpg_strerror
		mov	[esp+68h+var_64], eax ;	char
		mov	[esp+68h+var_68], offset aCommandMarktru ; "command marktrusted	failed:	%s\n"
		call	sub_435B7D

loc_4061AA:				; CODE XREF: sub_405FC1+1CCj
		mov	eax, [ebp+var_20]

locret_4061AD:				; CODE XREF: sub_405FC1+AAj
					; sub_405FC1+188j
		leave
		retn
sub_405FC1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4061AF	proc near		; DATA XREF: .data:0043D3FCo

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= byte ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [ebp+var_20]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_405AD8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4061DC
		mov	eax, [ebp+var_C]
		jmp	short locret_4061FE
; ---------------------------------------------------------------------------

loc_4061DC:				; CODE XREF: sub_4061AF+26j
		lea	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	sub_413151
		test	eax, eax
		jz	short loc_4061F9
		mov	[esp+38h+var_38], 11h
		call	sub_4055CB
		jmp	short locret_4061FE
; ---------------------------------------------------------------------------

loc_4061F9:				; CODE XREF: sub_4061AF+3Aj
		mov	eax, 0

locret_4061FE:				; CODE XREF: sub_4061AF+2Bj
					; sub_4061AF+48j
		leave
		retn
sub_4061AF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406200	proc near		; DATA XREF: .data:0043D414o
					; .data:0043D420o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 64h
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_405AD8
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40623E
		mov	eax, [ebp+var_10]
		jmp	short locret_40624D
; ---------------------------------------------------------------------------

loc_40623E:				; CODE XREF: sub_406200+37j
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+78h], 1
		mov	eax, 0

locret_40624D:				; CODE XREF: sub_406200+3Cj
		leave
		retn
sub_406200	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40624F	proc near		; DATA XREF: .data:0043D42Co

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_406270
; ---------------------------------------------------------------------------

loc_40626C:				; CODE XREF: sub_40624F+29j
		add	[ebp+var_C], 1

loc_406270:				; CODE XREF: sub_40624F+1Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40626C
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		mov	[esp+28h+Val], 20h ; Val
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4062A2
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0

loc_4062A2:				; CODE XREF: sub_40624F+4Bj
		cmp	[ebp+var_14], 0
		jz	short loc_4062B2
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4062D7

loc_4062B2:				; CODE XREF: sub_40624F+57j
		mov	[esp+28h+Str], 118h
		call	sub_4055CB
		mov	[esp+28h+var_20], offset aNoDescriptionG ; "no description given"
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	assuan_set_error
		jmp	short loc_406320
; ---------------------------------------------------------------------------

loc_4062D7:				; CODE XREF: sub_40624F+61j
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax
		call	sub_4059D9
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	ebx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax
		call	gcry_strdup
		mov	[ebx+0Ch], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_40631B
		call	sub_405608
		jmp	short loc_406320
; ---------------------------------------------------------------------------

loc_40631B:				; CODE XREF: sub_40624F+C3j
		mov	eax, 0

loc_406320:				; CODE XREF: sub_40624F+86j
					; sub_40624F+CAj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_40624F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406326(int, char *)
sub_406326	proc near		; DATA XREF: .data:0043D438o

Str		= dword	ptr -38h
EndPtr		= dword	ptr -34h
Radix		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_14], eax
		mov	[esp+38h+EndPtr], offset aHash ; "--hash"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_4057DF
		test	eax, eax
		jz	loc_40648C
		mov	[esp+38h+EndPtr], offset aHashSha1 ; "--hash=sha1"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_405740
		test	eax, eax
		jz	short loc_406378
		mov	[ebp+var_10], 2
		jmp	loc_406493
; ---------------------------------------------------------------------------

loc_406378:				; CODE XREF: sub_406326+44j
		mov	[esp+38h+EndPtr], offset aHashSha224 ; "--hash=sha224"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_405740
		test	eax, eax
		jz	short loc_40639B
		mov	[ebp+var_10], 0Bh
		jmp	loc_406493
; ---------------------------------------------------------------------------

loc_40639B:				; CODE XREF: sub_406326+67j
		mov	[esp+38h+EndPtr], offset aHashSha256 ; "--hash=sha256"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_405740
		test	eax, eax
		jz	short loc_4063BE
		mov	[ebp+var_10], 8
		jmp	loc_406493
; ---------------------------------------------------------------------------

loc_4063BE:				; CODE XREF: sub_406326+8Aj
		mov	[esp+38h+EndPtr], offset aHashSha384 ; "--hash=sha384"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_405740
		test	eax, eax
		jz	short loc_4063E1
		mov	[ebp+var_10], 9
		jmp	loc_406493
; ---------------------------------------------------------------------------

loc_4063E1:				; CODE XREF: sub_406326+ADj
		mov	[esp+38h+EndPtr], offset aHashSha512 ; "--hash=sha512"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_405740
		test	eax, eax
		jz	short loc_406404
		mov	[ebp+var_10], 0Ah
		jmp	loc_406493
; ---------------------------------------------------------------------------

loc_406404:				; CODE XREF: sub_406326+D0j
		mov	[esp+38h+EndPtr], offset aHashRmd160 ; "--hash=rmd160"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_405740
		test	eax, eax
		jz	short loc_406424
		mov	[ebp+var_10], 3
		jmp	short loc_406493
; ---------------------------------------------------------------------------

loc_406424:				; CODE XREF: sub_406326+F3j
		mov	[esp+38h+EndPtr], offset aHashMd5 ; "--hash=md5"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_405740
		test	eax, eax
		jz	short loc_406444
		mov	[ebp+var_10], 1
		jmp	short loc_406493
; ---------------------------------------------------------------------------

loc_406444:				; CODE XREF: sub_406326+113j
		mov	[esp+38h+EndPtr], offset aHashTlsMd5sha1 ; "--hash=tls-md5sha1"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; char *
		call	sub_405740
		test	eax, eax
		jz	short loc_406464
		mov	[ebp+var_10], 401h
		jmp	short loc_406493
; ---------------------------------------------------------------------------

loc_406464:				; CODE XREF: sub_406326+133j
		mov	[esp+38h+Str], 118h
		call	sub_4055CB
		mov	[esp+38h+Radix], offset	aInvalidHashAlg	; "invalid hash	algorithm"
		mov	[esp+38h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_set_error
		jmp	locret_406725
; ---------------------------------------------------------------------------

loc_40648C:				; CODE XREF: sub_406326+29j
		mov	[ebp+var_10], 0

loc_406493:				; CODE XREF: sub_406326+4Dj
					; sub_406326+70j ...
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_405976
		mov	[ebp+arg_4], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40653D
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	edx, [ebp+var_24]
		mov	[esp+38h+EndPtr], edx ;	EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+arg_4], eax
		jmp	short loc_4064D4
; ---------------------------------------------------------------------------

loc_4064D0:				; CODE XREF: sub_406326+1B6j
					; sub_406326+1C0j
		add	[ebp+arg_4], 1

loc_4064D4:				; CODE XREF: sub_406326+1A8j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4064D0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4064D0
		cmp	[ebp+var_10], 0
		jz	short loc_406515
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Radix], 0
		mov	[esp+38h+EndPtr], 8
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	gcry_md_algo_info
		test	eax, eax
		jz	short loc_40653D

loc_406515:				; CODE XREF: sub_406326+1C6j
		mov	[esp+38h+Str], 54h
		call	sub_4055CB
		mov	[esp+38h+Radix], 0
		mov	[esp+38h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_set_error
		jmp	locret_406725
; ---------------------------------------------------------------------------

loc_40653D:				; CODE XREF: sub_406326+17Fj
					; sub_406326+1EDj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx
		mov	[ebp+var_20], 0
		lea	eax, [ebp+var_20]
		mov	[esp+38h+Radix], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_4059FE
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_406577
		mov	eax, [ebp+var_18]
		jmp	locret_406725
; ---------------------------------------------------------------------------

loc_406577:				; CODE XREF: sub_406326+247j
		mov	eax, [ebp+var_20]
		shr	eax, 1
		mov	[ebp+var_20], eax
		cmp	[ebp+var_10], 401h
		jnz	short loc_406590
		mov	eax, [ebp+var_20]
		cmp	eax, 24h
		jz	short loc_4065F0

loc_406590:				; CODE XREF: sub_406326+260j
		mov	eax, [ebp+var_20]
		cmp	eax, 10h
		jz	short loc_4065F0
		mov	eax, [ebp+var_20]
		cmp	eax, 14h
		jz	short loc_4065F0
		mov	eax, [ebp+var_20]
		cmp	eax, 18h
		jz	short loc_4065F0
		mov	eax, [ebp+var_20]
		cmp	eax, 1Ch
		jz	short loc_4065F0
		mov	eax, [ebp+var_20]
		cmp	eax, 20h
		jz	short loc_4065F0
		mov	eax, [ebp+var_20]
		cmp	eax, 30h
		jz	short loc_4065F0
		mov	eax, [ebp+var_20]
		cmp	eax, 40h
		jz	short loc_4065F0
		mov	[esp+38h+Str], 118h
		call	sub_4055CB
		mov	[esp+38h+Radix], offset	aUnsupportedLen	; "unsupported length of hash"
		mov	[esp+38h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_set_error
		jmp	locret_406725
; ---------------------------------------------------------------------------

loc_4065F0:				; CODE XREF: sub_406326+268j
					; sub_406326+270j ...
		mov	eax, [ebp+var_20]
		cmp	eax, 40h
		jbe	short loc_406620
		mov	[esp+38h+Str], 118h
		call	sub_4055CB
		mov	[esp+38h+Radix], offset	aHashValueToLon	; "hash	value to long"
		mov	[esp+38h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_set_error
		jmp	locret_406725
; ---------------------------------------------------------------------------

loc_406620:				; CODE XREF: sub_406326+2D0j
		mov	eax, [ebp+var_14]
		add	eax, 1Ch
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax+5Ch], edx
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_20], 0
		jmp	loc_4066EA
; ---------------------------------------------------------------------------

loc_406646:				; CODE XREF: sub_406326+3D1j
		mov	eax, [ebp+var_20]
		mov	ecx, eax
		add	ecx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40666B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_406697
; ---------------------------------------------------------------------------

loc_40666B:				; CODE XREF: sub_406326+330j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_406686
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_406695
; ---------------------------------------------------------------------------

loc_406686:				; CODE XREF: sub_406326+34Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_406695:				; CODE XREF: sub_406326+35Ej
		mov	edx, eax

loc_406697:				; CODE XREF: sub_406326+343j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4066B2
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_4066D9
; ---------------------------------------------------------------------------

loc_4066B2:				; CODE XREF: sub_406326+37Cj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4066CD
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_4066D9
; ---------------------------------------------------------------------------

loc_4066CD:				; CODE XREF: sub_406326+397j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_4066D9:				; CODE XREF: sub_406326+38Aj
					; sub_406326+3A5j
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_C], 2
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax

loc_4066EA:				; CODE XREF: sub_406326+31Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+5Ch]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		cmp	edx, eax
		ja	loc_406646
		jmp	short loc_406711
; ---------------------------------------------------------------------------

loc_4066FF:				; CODE XREF: sub_406326+3F8j
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax

loc_406711:				; CODE XREF: sub_406326+3D7j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+5Ch]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		cmp	edx, eax
		ja	short loc_4066FF
		mov	eax, 0

locret_406725:				; CODE XREF: sub_406326+161j
					; sub_406326+212j ...
		leave
		retn
sub_406326	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406727	proc near		; DATA XREF: .data:0043D444o

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= byte ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_get_pointer
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_449E0C
		test	eax, eax
		jz	short loc_406754
		mov	[ebp+var_10], 0
		jmp	short loc_406768
; ---------------------------------------------------------------------------

loc_406754:				; CODE XREF: sub_406727+22j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_406768
		mov	[ebp+var_10], 0

loc_406768:				; CODE XREF: sub_406727+2Bj
					; sub_406727+38j
		mov	dword ptr [esp+38h+var_34], 200h
		lea	eax, [ebp+var_24]
		mov	[esp+38h+var_38], eax
		call	sub_424484
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+var_2C], edx
		lea	edx, [ebp+var_24]
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	sub_4139AE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4067B7
		lea	eax, [ebp+var_24]
		mov	[esp+38h+var_38], eax
		call	sub_405615
		jmp	short loc_4067CC
; ---------------------------------------------------------------------------

loc_4067B7:				; CODE XREF: sub_406727+81j
		lea	eax, [ebp+var_24]
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40565D
		mov	[ebp+var_C], eax

loc_4067CC:				; CODE XREF: sub_406727+8Ej
		cmp	[ebp+var_C], 0
		jz	short loc_4067ED
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aCommandPksignF ; "command pksign failed: %s\n"
		call	sub_435B7D

loc_4067ED:				; CODE XREF: sub_406727+A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406727	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406810	proc near		; DATA XREF: .data:0043D450o

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= byte ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[esp+48h+var_38], 1000h
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], offset aCiphertext ; "CIPHERTEXT"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40685F
		mov	eax, [ebp+var_C]
		jmp	loc_406917
; ---------------------------------------------------------------------------

loc_40685F:				; CODE XREF: sub_406810+45j
		mov	dword ptr [esp+48h+var_44], 200h
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_424484
		mov	ecx, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	eax, [eax+0Ch]
		lea	ebx, [ebp+var_28]
		mov	[esp+48h+var_38], ebx
		mov	[esp+48h+var_3C], ecx
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_413B27
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_4068C0
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_405615
		jmp	short loc_4068D5
; ---------------------------------------------------------------------------

loc_4068C0:				; CODE XREF: sub_406810+A1j
		lea	eax, [ebp+var_28]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_40565D
		mov	[ebp+var_C], eax

loc_4068D5:				; CODE XREF: sub_406810+AEj
		cmp	[ebp+var_C], 0
		jz	short loc_4068F6
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aCommandPkdecry ; "command pkdecrypt failed: %s\n"
		call	sub_435B7D

loc_4068F6:				; CODE XREF: sub_406810+C9j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_C]

loc_406917:				; CODE XREF: sub_406810+4Aj
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_406810	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40691D	proc near		; DATA XREF: .data:0043D45Co

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= byte ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[esp+48h+var_38], 400h
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], offset aKeyparam ; "KEYPARAM"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40696B
		mov	eax, [ebp+var_C]
		jmp	locret_4069F8
; ---------------------------------------------------------------------------

loc_40696B:				; CODE XREF: sub_40691D+44j
		mov	dword ptr [esp+48h+var_44], 200h
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_424484
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		lea	ecx, [ebp+var_28]
		mov	[esp+48h+var_3C], ecx
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_414701
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_4069BF
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_405615
		jmp	short loc_4069D4
; ---------------------------------------------------------------------------

loc_4069BF:				; CODE XREF: sub_40691D+93j
		lea	eax, [ebp+var_28]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_40565D
		mov	[ebp+var_C], eax

loc_4069D4:				; CODE XREF: sub_40691D+A0j
		cmp	[ebp+var_C], 0
		jz	short loc_4069F5
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aCommandGenkeyF ; "command genkey failed: %s\n"
		call	sub_435B7D

loc_4069F5:				; CODE XREF: sub_40691D+BBj
		mov	eax, [ebp+var_C]

locret_4069F8:				; CODE XREF: sub_40691D+49j
		leave
		retn
sub_40691D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4069FA	proc near		; DATA XREF: .data:0043D468o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_30], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_405AD8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406A3F
		mov	eax, [ebp+var_C]
		jmp	locret_406B67
; ---------------------------------------------------------------------------

loc_406A3F:				; CODE XREF: sub_4069FA+3Bj
		lea	eax, [ebp+var_30]
		mov	[esp+48h+var_40], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_4129F5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_406B43
		mov	eax, [ebp+var_30]
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_406AAD
		mov	[esp+48h+var_40], 32Fh ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/agent/command.c"
		mov	[esp+48h+var_48], offset aLen ;	"len"
		call	sub_43BB20

loc_406AAD:				; CODE XREF: sub_4069FA+95j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_406ACB
		call	sub_4055F3
		mov	[ebp+var_C], eax
		jmp	short loc_406B38
; ---------------------------------------------------------------------------

loc_406ACB:				; CODE XREF: sub_4069FA+C5j
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_406B11
		mov	[esp+48h+var_40], 336h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/agent/command.c"
		mov	[esp+48h+var_48], offset aLen ;	"len"
		call	sub_43BB20

loc_406B11:				; CODE XREF: sub_4069FA+F9j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_406B38:				; CODE XREF: sub_4069FA+CFj
		mov	eax, [ebp+var_30]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_release

loc_406B43:				; CODE XREF: sub_4069FA+65j
		cmp	[ebp+var_C], 0
		jz	short loc_406B64
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aCommandReadkey ; "command readkey failed: %s\n"
		call	sub_435B7D

loc_406B64:				; CODE XREF: sub_4069FA+14Dj
		mov	eax, [ebp+var_C]

locret_406B67:				; CODE XREF: sub_4069FA+40j
		leave
		retn
sub_4069FA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406B69	proc near		; CODE XREF: sub_406F3A+134p
					; sub_406F3A+34Ap ...

var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_71		= byte ptr -71h
var_6C		= byte ptr -6Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_41		= byte ptr -41h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	[ebp+var_48], 0
		mov	[ebp+var_50], 0
		mov	[ebp+var_54], 0
		mov	[ebp+var_58], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_50]
		mov	[esp+0B8h+var_AC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0B8h+var_B0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+var_B4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+var_B8], eax
		call	sub_4131E4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406BE5
		cmp	[ebp+arg_14], 0
		jz	loc_406F01
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+var_B8], eax
		call	sub_4055E6
		cmp	eax, 1Bh
		jnz	loc_406F01
		mov	[ebp+var_14], 1

loc_406BE5:				; CODE XREF: sub_406B69+55j
		lea	eax, [ebp+var_41]
		mov	[esp+0B8h+var_B0], eax
		mov	[esp+0B8h+var_B4], 14h
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+var_B8], eax
		call	sub_424BE8
		cmp	[ebp+arg_18], 0
		jle	short loc_406C29
		mov	eax, [ebp+arg_18]
		mov	[esp+0B8h+var_AC], eax
		mov	[esp+0B8h+var_B0], offset aD_0 ; "%d"
		mov	[esp+0B8h+var_B4], 14h
		lea	eax, [ebp+var_6C]
		mov	[esp+0B8h+var_B8], eax
		call	sub_4241F9
		jmp	short loc_406C37
; ---------------------------------------------------------------------------

loc_406C29:				; CODE XREF: sub_406B69+9Aj
		mov	edx, offset off_4407DF
		lea	eax, [ebp+var_6C]
		movzx	edx, word ptr [edx]
		mov	[eax], dx

loc_406C37:				; CODE XREF: sub_406B69+BEj
		mov	[ebp+var_71], 0
		cmp	[ebp+arg_1C], 0
		jz	short loc_406C70
		mov	ebx, 4407E1h
		lea	eax, [ebp+var_71]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+var_71]
		add	edx, eax
		movzx	eax, word ptr [ebx]
		mov	[edx], ax

loc_406C70:				; CODE XREF: sub_406B69+D6j
		cmp	[ebp+arg_14], 0
		jz	short loc_406CA5
		mov	ebx, offset byte_4407E3
		lea	eax, [ebp+var_71]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+var_71]
		add	edx, eax
		movzx	eax, word ptr [ebx]
		mov	[edx], ax

loc_406CA5:				; CODE XREF: sub_406B69+10Bj
		cmp	[ebp+arg_20], 0
		jz	short loc_406CDA
		mov	ebx, offset byte_4407E5
		lea	eax, [ebp+var_71]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+var_71]
		add	edx, eax
		movzx	eax, word ptr [ebx]
		mov	[edx], ax

loc_406CDA:				; CODE XREF: sub_406B69+140j
		movzx	eax, [ebp+var_71]
		test	al, al
		jnz	short loc_406CF0
		mov	edx, offset off_4407DF
		lea	eax, [ebp+var_71]
		movzx	edx, word ptr [edx]
		mov	[eax], dx

loc_406CF0:				; CODE XREF: sub_406B69+177j
		cmp	[ebp+var_14], 0
		jz	short loc_406CFF
		mov	[ebp+var_10], offset off_4407DF
		jmp	short loc_406D34
; ---------------------------------------------------------------------------

loc_406CFF:				; CODE XREF: sub_406B69+18Bj
		mov	eax, [ebp+var_4C]
		cmp	eax, 2
		jz	short loc_406D1A
		cmp	eax, 3
		jz	short loc_406D23
		cmp	eax, 1
		jnz	short loc_406D2C
		mov	[ebp+var_10], 4407E1h
		jmp	short loc_406D34
; ---------------------------------------------------------------------------

loc_406D1A:				; CODE XREF: sub_406B69+19Cj
		mov	[ebp+var_10], 4407E1h
		jmp	short loc_406D34
; ---------------------------------------------------------------------------

loc_406D23:				; CODE XREF: sub_406B69+1A1j
		mov	[ebp+var_10], offset byte_4407E7
		jmp	short loc_406D34
; ---------------------------------------------------------------------------

loc_406D2C:				; CODE XREF: sub_406B69+1A6j
		mov	[ebp+var_10], offset asc_4407E9	; "X"
		nop

loc_406D34:				; CODE XREF: sub_406B69+194j
					; sub_406B69+1AFj ...
		cmp	[ebp+arg_10], 0
		jz	short loc_406D7C
		lea	eax, [ebp+var_78]
		mov	[esp+0B8h+var_B0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+var_B4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+var_B8], eax
		call	sub_4129BE
		test	eax, eax
		jnz	short loc_406D7C
		mov	eax, [ebp+var_78]
		mov	[esp+0B8h+var_B0], 4
		lea	edx, [ebp+var_48]
		mov	[esp+0B8h+var_B4], edx
		mov	[esp+0B8h+var_B8], eax
		call	sub_425664
		mov	eax, [ebp+var_78]
		mov	[esp+0B8h+var_B8], eax
		call	gcry_sexp_release

loc_406D7C:				; CODE XREF: sub_406B69+1CFj
					; sub_406B69+1ECj
		mov	eax, [ebp+var_50]
		test	eax, eax
		jz	short loc_406DA9
		mov	eax, [ebp+var_50]
		lea	edx, [ebp+var_58]
		mov	[esp+0B8h+var_B0], edx
		lea	edx, [ebp+var_54]
		mov	[esp+0B8h+var_B4], edx
		mov	[esp+0B8h+var_B8], eax
		call	sub_417B49
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_406F00

loc_406DA9:				; CODE XREF: sub_406B69+218j
		cmp	[ebp+arg_C], 0
		jnz	loc_406E41
		mov	eax, [ebp+var_48]
		test	eax, eax
		jz	short loc_406DBF
		mov	ecx, [ebp+var_48]
		jmp	short loc_406DC4
; ---------------------------------------------------------------------------

loc_406DBF:				; CODE XREF: sub_406B69+24Fj
		mov	ecx, offset off_4407DF

loc_406DC4:				; CODE XREF: sub_406B69+254j
		mov	eax, [ebp+var_58]
		test	eax, eax
		jz	short loc_406DD0
		mov	edx, [ebp+var_58]
		jmp	short loc_406DD5
; ---------------------------------------------------------------------------

loc_406DD0:				; CODE XREF: sub_406B69+260j
		mov	edx, offset off_4407DF

loc_406DD5:				; CODE XREF: sub_406B69+265j
		mov	eax, [ebp+var_54]
		test	eax, eax
		jz	short loc_406DE1
		mov	eax, [ebp+var_54]
		jmp	short loc_406DE6
; ---------------------------------------------------------------------------

loc_406DE1:				; CODE XREF: sub_406B69+271j
		mov	eax, offset off_4407DF

loc_406DE6:				; CODE XREF: sub_406B69+276j
		mov	[esp+0B8h+var_8C], 0
		lea	ebx, [ebp+var_71]
		mov	[esp+0B8h+var_90], ebx
		lea	ebx, [ebp+var_6C]
		mov	[esp+0B8h+var_94], ebx
		mov	[esp+0B8h+var_98], ecx
		mov	[esp+0B8h+var_9C], offset off_4407DF
		mov	[esp+0B8h+var_A0], offset off_4407DF
		mov	[esp+0B8h+var_A4], edx
		mov	[esp+0B8h+var_A8], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+var_AC], eax
		lea	eax, [ebp+var_41]
		mov	[esp+0B8h+var_B0], eax
		mov	[esp+0B8h+var_B4], offset aKeyinfo ; "KEYINFO"
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+var_B8], eax
		call	sub_405B8B
		mov	[ebp+var_C], eax
		jmp	loc_406F01
; ---------------------------------------------------------------------------

loc_406E41:				; CODE XREF: sub_406B69+244j
		mov	eax, [ebp+var_48]
		test	eax, eax
		jz	short loc_406E4D
		mov	ecx, [ebp+var_48]
		jmp	short loc_406E52
; ---------------------------------------------------------------------------

loc_406E4D:				; CODE XREF: sub_406B69+2DDj
		mov	ecx, offset off_4407DF

loc_406E52:				; CODE XREF: sub_406B69+2E2j
		mov	eax, [ebp+var_58]
		test	eax, eax
		jz	short loc_406E5E
		mov	edx, [ebp+var_58]
		jmp	short loc_406E63
; ---------------------------------------------------------------------------

loc_406E5E:				; CODE XREF: sub_406B69+2EEj
		mov	edx, offset off_4407DF

loc_406E63:				; CODE XREF: sub_406B69+2F3j
		mov	eax, [ebp+var_54]
		test	eax, eax
		jz	short loc_406E6F
		mov	eax, [ebp+var_54]
		jmp	short loc_406E74
; ---------------------------------------------------------------------------

loc_406E6F:				; CODE XREF: sub_406B69+2FFj
		mov	eax, offset off_4407DF

loc_406E74:				; CODE XREF: sub_406B69+304j
		lea	ebx, [ebp+var_71]
		mov	[esp+0B8h+var_9C], ebx
		lea	ebx, [ebp+var_6C]
		mov	[esp+0B8h+var_A0], ebx
		mov	[esp+0B8h+var_A4], ecx
		mov	[esp+0B8h+var_A8], edx
		mov	[esp+0B8h+var_AC], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+var_B0], eax
		lea	eax, [ebp+var_41]
		mov	[esp+0B8h+var_B4], eax
		mov	[esp+0B8h+var_B8], offset aSSSSSSS ; "%s %s %s %s - - %s %s %s\n"
		call	sub_4256F5
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_406EBB
		call	sub_4055F3
		mov	[ebp+var_C], eax
		jmp	short loc_406EF3
; ---------------------------------------------------------------------------

loc_406EBB:				; CODE XREF: sub_406B69+346j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+0B8h+var_B0], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+var_B4], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+var_B8], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax

loc_406EF3:				; CODE XREF: sub_406B69+350j
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+var_B8], eax
		call	gcry_free
		jmp	short loc_406F01
; ---------------------------------------------------------------------------

loc_406F00:				; CODE XREF: sub_406B69+23Aj
		nop

loc_406F01:				; CODE XREF: sub_406B69+5Bj
					; sub_406B69+6Fj ...
		mov	eax, [ebp+var_48]
		mov	[esp+0B8h+var_B8], eax
		call	gcry_free
		mov	eax, [ebp+var_50]
		mov	[esp+0B8h+var_B8], eax
		call	gcry_free
		mov	eax, [ebp+var_54]
		mov	[esp+0B8h+var_B8], eax
		call	gcry_free
		mov	eax, [ebp+var_58]
		mov	[esp+0B8h+var_B8], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		add	esp, 0B0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_406B69	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406F3A(int, char *)
sub_406F3A	proc near		; DATA XREF: .data:0043D408o

Dest		= dword	ptr -0C8h
Source		= dword	ptr -0C4h
Count		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_8C		= dword	ptr -8Ch
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_71		= byte ptr -71h
var_49		= byte ptr -49h
var_48		= byte ptr -48h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 0C0h
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Dest], eax
		call	assuan_get_pointer
		mov	[ebp+var_20], eax
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 0
		mov	[esp+0C8h+Source], offset aSshList ; "--ssh-list"
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Dest], eax ; char *
		call	sub_405740
		test	eax, eax
		jz	short loc_406F81
		mov	[ebp+var_14], 2
		jmp	short loc_406F97
; ---------------------------------------------------------------------------

loc_406F81:				; CODE XREF: sub_406F3A+3Cj
		mov	[esp+0C8h+Source], offset aList	; "--list"
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Dest], eax ; char *
		call	sub_405740
		mov	[ebp+var_14], eax

loc_406F97:				; CODE XREF: sub_406F3A+45j
		mov	[esp+0C8h+Source], offset aData	; "--data"
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Dest], eax ; char *
		call	sub_405740
		mov	[ebp+var_24], eax
		mov	[esp+0C8h+Source], offset aSshFpr ; "--ssh-fpr"
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Dest], eax ; char *
		call	sub_405740
		mov	[ebp+var_28], eax
		mov	[esp+0C8h+Source], offset aWithSsh ; "--with-ssh"
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Dest], eax ; char *
		call	sub_405740
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Dest], eax
		call	sub_405976
		mov	[ebp+arg_4], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_406FF3
		cmp	[ebp+var_14], 2
		jnz	short loc_406FFB

loc_406FF3:				; CODE XREF: sub_406F3A+B1j
		call	sub_40A407
		mov	[ebp+var_18], eax

loc_406FFB:				; CODE XREF: sub_406F3A+B7j
		cmp	[ebp+var_14], 2
		jnz	loc_4070BE
		cmp	[ebp+var_18], 0
		jz	loc_4070B2
		jmp	short loc_407083
; ---------------------------------------------------------------------------

loc_407011:				; CODE XREF: sub_406F3A+172j
		mov	[esp+0C8h+Count], 14h
		lea	eax, [ebp+var_48]
		mov	[esp+0C8h+Source], eax
		lea	eax, [ebp+var_71]
		mov	[esp+0C8h+Dest], eax
		call	sub_4246F8
		test	eax, eax
		js	short loc_407082
		mov	ecx, [ebp+var_80]
		mov	edx, [ebp+var_78]
		mov	eax, [ebp+var_7C]
		mov	[esp+0C8h+var_A8], ecx
		mov	[esp+0C8h+var_AC], edx
		mov	[esp+0C8h+var_B0], eax
		mov	[esp+0C8h+var_B4], 1
		mov	eax, [ebp+var_28]
		mov	[esp+0C8h+var_B8], eax
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+var_BC], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Count], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0C8h+Source], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Dest], eax
		call	sub_406B69
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_407396
		jmp	short loc_407083
; ---------------------------------------------------------------------------

loc_407082:				; CODE XREF: sub_406F3A+F3j
		nop

loc_407083:				; CODE XREF: sub_406F3A+D5j
					; sub_406F3A+146j
		lea	eax, [ebp+var_80]
		mov	[esp+0C8h+var_B8], eax ; int
		lea	eax, [ebp+var_7C]
		mov	[esp+0C8h+var_BC], eax ; int
		lea	eax, [ebp+var_78]
		mov	[esp+0C8h+Count], eax ;	int
		lea	eax, [ebp+var_71]
		mov	[esp+0C8h+Source], eax ; char *
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+Dest], eax ; int
		call	sub_40A443
		test	eax, eax
		jz	loc_407011

loc_4070B2:				; CODE XREF: sub_406F3A+CFj
		mov	[ebp+var_C], 0
		jmp	loc_4073A3
; ---------------------------------------------------------------------------

loc_4070BE:				; CODE XREF: sub_406F3A+C5j
		cmp	[ebp+var_14], 0
		jz	loc_4072C0
		mov	eax, ds:dword_449DB4
		mov	[esp+0C8h+Count], 0
		mov	[esp+0C8h+Source], offset aPrivateKeysV_0 ; "private-keys-v1.d"
		mov	[esp+0C8h+Dest], eax
		call	sub_432697
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_4070FB
		call	sub_4055F3
		mov	[ebp+var_C], eax
		jmp	loc_4073A3
; ---------------------------------------------------------------------------

loc_4070FB:				; CODE XREF: sub_406F3A+1B2j
		mov	eax, [ebp+var_30]
		mov	[esp+0C8h+Dest], eax ; LPCSTR
		call	sub_43BC00
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_407127
		call	sub_4055F3
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+0C8h+Dest], eax
		call	gcry_free
		jmp	loc_4073A3
; ---------------------------------------------------------------------------

loc_407127:				; CODE XREF: sub_406F3A+1D3j
		mov	eax, [ebp+var_30]
		mov	[esp+0C8h+Dest], eax
		call	gcry_free
		jmp	loc_40729C
; ---------------------------------------------------------------------------

loc_407137:				; CODE XREF: sub_406F3A+374j
		mov	eax, [ebp+var_34]
		add	eax, 8
		mov	[ebp+var_8C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_8C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 2Ch
		jnz	loc_407298
		mov	eax, [ebp+var_34]
		add	eax, 30h
		mov	edx, eax
		mov	eax, offset a_key ; ".key"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_407298
		mov	eax, [ebp+var_34]
		add	eax, 8
		mov	[esp+0C8h+Count], 28h ;	Count
		mov	[esp+0C8h+Source], eax ; Source
		lea	eax, [ebp+var_71]
		mov	[esp+0C8h+Dest], eax ; Dest
		call	strncpy
		mov	[ebp+var_49], 0
		mov	[esp+0C8h+Count], 14h
		lea	eax, [ebp+var_48]
		mov	[esp+0C8h+Source], eax
		lea	eax, [ebp+var_71]
		mov	[esp+0C8h+Dest], eax
		call	sub_4246F8
		test	eax, eax
		js	loc_40729B
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_80], eax
		mov	eax, [ebp+var_80]
		mov	[ebp+var_7C], eax
		mov	eax, [ebp+var_7C]
		mov	[ebp+var_78], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_407246
		lea	eax, [ebp+var_80]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_78]
		mov	[esp+0C8h+Count], eax
		lea	eax, [ebp+var_71]
		mov	[esp+0C8h+Source], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+Dest], eax
		call	sub_40A4C0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_407232
		mov	[ebp+var_1C], 1
		jmp	short loc_407246
; ---------------------------------------------------------------------------

loc_407232:				; CODE XREF: sub_406F3A+2EDj
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dest], eax
		call	sub_4055E6
		cmp	eax, 1Bh
		jnz	loc_407399

loc_407246:				; CODE XREF: sub_406F3A+2BDj
					; sub_406F3A+2F6j
		mov	ecx, [ebp+var_80]
		mov	edx, [ebp+var_78]
		mov	eax, [ebp+var_7C]
		mov	[esp+0C8h+var_A8], ecx
		mov	[esp+0C8h+var_AC], edx
		mov	[esp+0C8h+var_B0], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+var_B4], eax
		mov	eax, [ebp+var_28]
		mov	[esp+0C8h+var_B8], eax
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+var_BC], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Count], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0C8h+Source], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Dest], eax
		call	sub_406B69
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40739C
		jmp	short loc_40729C
; ---------------------------------------------------------------------------

loc_407298:				; CODE XREF: sub_406F3A+228j
					; sub_406F3A+257j
		nop
		jmp	short loc_40729C
; ---------------------------------------------------------------------------

loc_40729B:				; CODE XREF: sub_406F3A+29Aj
		nop

loc_40729C:				; CODE XREF: sub_406F3A+1F8j
					; sub_406F3A+35Cj ...
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+Dest], eax
		call	sub_43BE30
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	loc_407137
		mov	[ebp+var_C], 0
		jmp	loc_4073A3
; ---------------------------------------------------------------------------

loc_4072C0:				; CODE XREF: sub_406F3A+188j
		lea	eax, [ebp+var_48]
		mov	[esp+0C8h+Count], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Dest], eax
		call	sub_405AD8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40739F
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_80], eax
		mov	eax, [ebp+var_80]
		mov	[ebp+var_7C], eax
		mov	eax, [ebp+var_7C]
		mov	[ebp+var_78], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_40734E
		lea	eax, [ebp+var_80]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_78]
		mov	[esp+0C8h+Count], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Source], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+Dest], eax
		call	sub_40A4C0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40733E
		mov	[ebp+var_1C], 1
		jmp	short loc_40734E
; ---------------------------------------------------------------------------

loc_40733E:				; CODE XREF: sub_406F3A+3F9j
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dest], eax
		call	sub_4055E6
		cmp	eax, 1Bh
		jnz	short loc_4073A2

loc_40734E:				; CODE XREF: sub_406F3A+3C9j
					; sub_406F3A+402j
		mov	ecx, [ebp+var_80]
		mov	edx, [ebp+var_78]
		mov	eax, [ebp+var_7C]
		mov	[esp+0C8h+var_A8], ecx
		mov	[esp+0C8h+var_AC], edx
		mov	[esp+0C8h+var_B0], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+var_B4], eax
		mov	eax, [ebp+var_28]
		mov	[esp+0C8h+var_B8], eax
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+var_BC], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Count], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0C8h+Source], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Dest], eax
		call	sub_406B69
		mov	[ebp+var_C], eax
		jmp	short loc_4073A3
; ---------------------------------------------------------------------------

loc_407396:				; CODE XREF: sub_406F3A+140j
		nop
		jmp	short loc_4073A3
; ---------------------------------------------------------------------------

loc_407399:				; CODE XREF: sub_406F3A+306j
		nop
		jmp	short loc_4073A3
; ---------------------------------------------------------------------------

loc_40739C:				; CODE XREF: sub_406F3A+356j
		nop
		jmp	short loc_4073A3
; ---------------------------------------------------------------------------

loc_40739F:				; CODE XREF: sub_406F3A+3A6j
		nop
		jmp	short loc_4073A3
; ---------------------------------------------------------------------------

loc_4073A2:				; CODE XREF: sub_406F3A+412j
		nop

loc_4073A3:				; CODE XREF: sub_406F3A+17Fj
					; sub_406F3A+1BCj ...
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+Dest], eax
		call	sub_40A430
		cmp	[ebp+var_10], 0
		jz	short loc_4073BF
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+Dest], eax ; void *
		call	sub_43BF50

loc_4073BF:				; CODE XREF: sub_406F3A+478j
		cmp	[ebp+var_C], 0
		jz	short loc_4073F0
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dest], eax
		call	sub_4055E6
		cmp	eax, 1Bh
		jz	short loc_4073F0
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dest], eax
		call	gpg_strerror
		mov	[esp+0C8h+Source], eax ; char
		mov	[esp+0C8h+Dest], offset	aCommandKeyinfo	; "command keyinfo failed: %s\n"
		call	sub_435B7D

loc_4073F0:				; CODE XREF: sub_406F3A+489j
					; sub_406F3A+499j
		mov	eax, [ebp+var_C]
		add	esp, 0C0h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_406F3A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4073FD	proc near		; CODE XREF: sub_4074BA+369p
					; sub_4074BA+57Ep

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_begin_confidential
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_407455
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	short loc_4074B1
; ---------------------------------------------------------------------------

loc_407455:				; CODE XREF: sub_4073FD+38j
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, 1
		mov	[esp+38h+var_38], eax
		call	gcry_malloc_secure
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_407478
		call	sub_4055F3
		mov	[ebp+var_C], eax
		jmp	short loc_4074B1
; ---------------------------------------------------------------------------

loc_407478:				; CODE XREF: sub_4073FD+6Fj
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_38], eax
		call	sub_424BE8
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_set_okay_line
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	gcry_free

loc_4074B1:				; CODE XREF: sub_4073FD+56j
					; sub_4073FD+79j
		mov	eax, [ebp+var_C]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4073FD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4074BA(int, char *)
sub_4074BA	proc near		; DATA XREF: .data:0043D474o

Str		= dword	ptr -88h
Val		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_5C		= dword	ptr -5Ch
Str1		= dword	ptr -54h
var_50		= dword	ptr -50h
Str2		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Source		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		add	esp, 0FFFFFF80h
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_30], eax
		mov	[ebp+Source], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[esp+88h+Str], offset aPleaseReEnterT ;	"Please	re-enter this passphrase"
		call	sub_435294
		mov	[ebp+var_34], eax
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[esp+88h+Val], offset aData ; "--data"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str], eax ; char *
		call	sub_405740
		mov	[ebp+var_38], eax
		mov	[esp+88h+Val], offset aCheck ; "--check"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str], eax ; char *
		call	sub_405740
		mov	[ebp+var_3C], eax
		mov	[esp+88h+Val], offset aNoAsk ; "--no-ask"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str], eax ; char *
		call	sub_405740
		mov	[ebp+var_40], eax
		mov	[esp+88h+Val], offset aRepeat ;	"--repeat"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str], eax ; char *
		call	sub_4057DF
		test	eax, eax
		jz	short loc_407595
		mov	[esp+88h+Val], offset aRepeat ;	"--repeat"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str], eax ; char *
		call	sub_40588B
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_40758E
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Str], eax ; Str
		call	atoi
		mov	[ebp+var_24], eax
		jmp	short loc_407595
; ---------------------------------------------------------------------------

loc_40758E:				; CODE XREF: sub_4074BA+C2j
		mov	[ebp+var_24], 1

loc_407595:				; CODE XREF: sub_4074BA+A6j
					; sub_4074BA+D2j
		mov	[esp+88h+Val], offset aQualitybar ; "--qualitybar"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str], eax ; char *
		call	sub_405740
		mov	[ebp+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str], eax
		call	sub_405976
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+Source], eax
		mov	[esp+88h+Val], 20h ; Val
		mov	eax, [ebp+Source]
		mov	[esp+88h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_407699
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0
		add	[ebp+var_20], 1
		jmp	short loc_4075EF
; ---------------------------------------------------------------------------

loc_4075EB:				; CODE XREF: sub_4074BA+13Dj
		add	[ebp+var_20], 1

loc_4075EF:				; CODE XREF: sub_4074BA+12Fj
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4075EB
		mov	eax, [ebp+var_20]
		mov	[ebp+var_1C], eax
		mov	[esp+88h+Val], 20h ; Val
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_407699
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0
		add	[ebp+var_20], 1
		jmp	short loc_40762B
; ---------------------------------------------------------------------------

loc_407627:				; CODE XREF: sub_4074BA+179j
		add	[ebp+var_20], 1

loc_40762B:				; CODE XREF: sub_4074BA+16Bj
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_407627
		mov	eax, [ebp+var_20]
		mov	[ebp+var_18], eax
		mov	[esp+88h+Val], 20h ; Val
		mov	eax, [ebp+var_18]
		mov	[esp+88h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_407699
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0
		add	[ebp+var_20], 1
		jmp	short loc_407667
; ---------------------------------------------------------------------------

loc_407663:				; CODE XREF: sub_4074BA+1B5j
		add	[ebp+var_20], 1

loc_407667:				; CODE XREF: sub_4074BA+1A7j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_407663
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		mov	[esp+88h+Val], 20h ; Val
		mov	eax, [ebp+var_14]
		mov	[esp+88h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_407699
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0

loc_407699:				; CODE XREF: sub_4074BA+11Fj
					; sub_4074BA+15Fj ...
		cmp	[ebp+Source], 0
		jz	short loc_4076CD
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4076CD
		mov	eax, [ebp+Source]
		mov	[ebp+var_5C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 32h
		jbe	short loc_4076F5

loc_4076CD:				; CODE XREF: sub_4074BA+1E3j
					; sub_4074BA+1EDj
		mov	[esp+88h+Str], 118h
		call	sub_4055CB
		mov	[esp+88h+var_80], offset aInvalidLengt_0 ; "invalid length of cacheID"
		mov	[esp+88h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	assuan_set_error
		jmp	loc_407A6F
; ---------------------------------------------------------------------------

loc_4076F5:				; CODE XREF: sub_4074BA+211j
		cmp	[ebp+var_14], 0
		jnz	short loc_407723
		mov	[esp+88h+Str], 118h
		call	sub_4055CB
		mov	[esp+88h+var_80], offset aNoDescriptionG ; "no description given"
		mov	[esp+88h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	assuan_set_error
		jmp	loc_407A6F
; ---------------------------------------------------------------------------

loc_407723:				; CODE XREF: sub_4074BA+23Fj
		mov	eax, [ebp+Source]
		mov	edx, eax
		mov	eax, offset asc_4407E9 ; "X"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_407752
		mov	[ebp+Source], 0

loc_407752:				; CODE XREF: sub_4074BA+28Fj
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		mov	eax, offset asc_4407E9 ; "X"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_407781
		mov	[ebp+var_1C], 0

loc_407781:				; CODE XREF: sub_4074BA+2BEj
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, offset asc_4407E9 ; "X"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4077B0
		mov	[ebp+var_18], 0

loc_4077B0:				; CODE XREF: sub_4074BA+2EDj
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, offset asc_4407E9 ; "X"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4077DF
		mov	[ebp+var_14], 0

loc_4077DF:				; CODE XREF: sub_4074BA+31Cj
		cmp	[ebp+Source], 0
		jz	short loc_407801
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_80], eax ;	int
		mov	[esp+88h+Val], 3 ; int
		mov	eax, [ebp+Source]
		mov	[esp+88h+Str], eax ; char *
		call	sub_4115E1
		jmp	short loc_407806
; ---------------------------------------------------------------------------

loc_407801:				; CODE XREF: sub_4074BA+329j
		mov	eax, 0

loc_407806:				; CODE XREF: sub_4074BA+345j
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jz	short loc_40783B
		mov	eax, [ebp+var_48]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	sub_4073FD
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+Str], eax
		call	sub_411754
		jmp	loc_407A4B
; ---------------------------------------------------------------------------

loc_40783B:				; CODE XREF: sub_4074BA+353j
		cmp	[ebp+var_40], 0
		jz	short loc_407855
		mov	[esp+88h+Str], 3Ah
		call	sub_4055CB
		mov	[ebp+var_C], eax
		jmp	loc_407A4B
; ---------------------------------------------------------------------------

loc_407855:				; CODE XREF: sub_4074BA+385j
		cmp	[ebp+var_1C], 0
		jz	short loc_407866
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+Str], eax
		call	sub_4059D9

loc_407866:				; CODE XREF: sub_4074BA+39Fj
		cmp	[ebp+var_18], 0
		jz	short loc_407877
		mov	eax, [ebp+var_18]
		mov	[esp+88h+Str], eax
		call	sub_4059D9

loc_407877:				; CODE XREF: sub_4074BA+3B0j
		cmp	[ebp+var_14], 0
		jz	short loc_40788B
		mov	eax, [ebp+var_14]
		mov	[esp+88h+Str], eax
		call	sub_4059D9
		jmp	short loc_40788B
; ---------------------------------------------------------------------------

loc_40788A:				; CODE XREF: sub_4074BA+50Ej
		nop

loc_40788B:				; CODE XREF: sub_4074BA+3C1j
					; sub_4074BA+3CEj ...
		cmp	[ebp+var_28], 0
		jz	short loc_407896
		mov	eax, [ebp+var_28]
		jmp	short loc_407899
; ---------------------------------------------------------------------------

loc_407896:				; CODE XREF: sub_4074BA+3D5j
		mov	eax, [ebp+var_1C]

loc_407899:				; CODE XREF: sub_4074BA+3DAj
		mov	[esp+88h+var_6C], 3 ; int
		mov	edx, [ebp+Source]
		mov	[esp+88h+var_70], edx ;	int
		mov	edx, [ebp+var_44]
		mov	[esp+88h+var_74], edx ;	int
		mov	[esp+88h+var_78], eax ;	int
		mov	eax, [ebp+var_18]
		mov	[esp+88h+var_7C], eax ;	int
		mov	eax, [ebp+var_14]
		mov	[esp+88h+var_80], eax ;	char *
		lea	eax, [ebp+Str2]
		mov	[esp+88h+Val], eax ; int
		mov	eax, [ebp+var_30]
		mov	[esp+88h+Str], eax ; int
		call	sub_4100EE
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_28]
		mov	[esp+88h+Str], eax
		call	gcry_free
		mov	[ebp+var_28], 0
		cmp	[ebp+var_C], 0
		jnz	loc_407A4B
		cmp	[ebp+var_3C], 0
		jz	short loc_407926
		mov	eax, [ebp+Str2]
		mov	[esp+88h+var_80], 0 ; int
		mov	[esp+88h+Val], eax ; void *
		mov	eax, [ebp+var_30]
		mov	[esp+88h+Str], eax ; int
		call	sub_414492
		test	eax, eax
		jz	short loc_407926
		mov	eax, [ebp+Str2]
		mov	[esp+88h+Str], eax
		call	gcry_free
		jmp	loc_40788B
; ---------------------------------------------------------------------------

loc_407926:				; CODE XREF: sub_4074BA+43Cj
					; sub_4074BA+45Aj
		mov	[ebp+var_2C], 0
		jmp	loc_4079E7
; ---------------------------------------------------------------------------

loc_407932:				; CODE XREF: sub_4074BA+533j
		mov	[esp+88h+var_6C], 3 ; int
		mov	eax, [ebp+Source]
		mov	[esp+88h+var_70], eax ;	int
		mov	[esp+88h+var_74], 0 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+var_78], eax ;	int
		mov	eax, [ebp+var_18]
		mov	[esp+88h+var_7C], eax ;	int
		mov	eax, [ebp+var_34]
		mov	[esp+88h+var_80], eax ;	char *
		lea	eax, [ebp+Str1]
		mov	[esp+88h+Val], eax ; int
		mov	eax, [ebp+var_30]
		mov	[esp+88h+Str], eax ; int
		call	sub_4100EE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4079F5
		mov	edx, [ebp+Str2]
		mov	eax, [ebp+Str1]
		mov	[esp+88h+Val], edx ; Str2
		mov	[esp+88h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_4079D8
		mov	eax, [ebp+Str1]
		mov	[esp+88h+Str], eax
		call	gcry_free
		mov	eax, [ebp+Str2]
		mov	[esp+88h+Str], eax
		call	gcry_free
		mov	[esp+88h+Str], offset aDoesNotMatchTr ;	"does not match	- try again"
		call	sub_435294
		mov	[esp+88h+Val], 0 ; char	*
		mov	[esp+88h+Str], eax ; int
		call	sub_4335B0
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_40788A
		call	sub_4055F3
		mov	[ebp+var_C], eax
		jmp	short loc_4079F6
; ---------------------------------------------------------------------------

loc_4079D8:				; CODE XREF: sub_4074BA+4D3j
		mov	eax, [ebp+Str1]
		mov	[esp+88h+Str], eax
		call	gcry_free
		add	[ebp+var_2C], 1

loc_4079E7:				; CODE XREF: sub_4074BA+473j
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_24]
		jl	loc_407932
		jmp	short loc_4079F6
; ---------------------------------------------------------------------------

loc_4079F5:				; CODE XREF: sub_4074BA+4BDj
		nop

loc_4079F6:				; CODE XREF: sub_4074BA+51Cj
					; sub_4074BA+539j
		cmp	[ebp+var_C], 0
		jnz	short loc_407A40
		cmp	[ebp+Source], 0
		jz	short loc_407A24
		mov	eax, [ebp+Str2]
		mov	[esp+88h+var_7C], 0 ; int
		mov	[esp+88h+var_80], eax ;	void *
		mov	[esp+88h+Val], 3 ; int
		mov	eax, [ebp+Source]
		mov	[esp+88h+Str], eax ; Source
		call	sub_411372

loc_407A24:				; CODE XREF: sub_4074BA+546j
		mov	eax, [ebp+Str2]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax
		call	sub_4073FD
		mov	[ebp+var_C], eax

loc_407A40:				; CODE XREF: sub_4074BA+540j
		mov	eax, [ebp+Str2]
		mov	[esp+88h+Str], eax
		call	gcry_free

loc_407A4B:				; CODE XREF: sub_4074BA+37Cj
					; sub_4074BA+396j ...
		cmp	[ebp+var_C], 0
		jz	short loc_407A6C
		mov	eax, [ebp+var_C]
		mov	[esp+88h+Str], eax
		call	gpg_strerror
		mov	[esp+88h+Val], eax ; char
		mov	[esp+88h+Str], offset aCommandGet_pas ;	"command get_passphrase	failed:	%s\n"
		call	sub_435B7D

loc_407A6C:				; CODE XREF: sub_4074BA+595j
		mov	eax, [ebp+var_C]

loc_407A6F:				; CODE XREF: sub_4074BA+236j
					; sub_4074BA+264j
		sub	esp, 0FFFFFF80h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4074BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407A76	proc near		; DATA XREF: .data:0043D48Co

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
Source		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+Source], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_407A9E
; ---------------------------------------------------------------------------

loc_407A9A:				; CODE XREF: sub_407A76+30j
		add	[ebp+var_C], 1

loc_407A9E:				; CODE XREF: sub_407A76+22j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_407A9A
		mov	eax, [ebp+var_C]
		mov	[ebp+Source], eax
		mov	[esp+38h+Val], 20h ; Val
		mov	eax, [ebp+Source]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_407AD0
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0

loc_407AD0:				; CODE XREF: sub_407A76+52j
		cmp	[ebp+Source], 0
		jz	short loc_407B04
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407B04
		mov	eax, [ebp+Source]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 32h
		jbe	short loc_407B29

loc_407B04:				; CODE XREF: sub_407A76+5Ej
					; sub_407A76+68j
		mov	[esp+38h+Str], 118h
		call	sub_4055CB
		mov	[esp+38h+var_30], offset aInvalidLengt_0 ; "invalid length of cacheID"
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_set_error
		jmp	short loc_407B6B
; ---------------------------------------------------------------------------

loc_407B29:				; CODE XREF: sub_407A76+8Cj
		mov	[esp+38h+var_2C], 0 ; int
		mov	[esp+38h+var_30], 0 ; void *
		mov	[esp+38h+Val], 3 ; int
		mov	eax, [ebp+Source]
		mov	[esp+38h+Str], eax ; Source
		call	sub_411372
		mov	[esp+38h+var_30], 3
		mov	eax, [ebp+Source]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_410ED8
		mov	eax, 0

loc_407B6B:				; CODE XREF: sub_407A76+B1j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_407A76	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407B71	proc near		; DATA XREF: .data:0043D498o

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str1		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_14], eax
		mov	[ebp+Str1], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_407B98
; ---------------------------------------------------------------------------

loc_407B94:				; CODE XREF: sub_407B71+2Fj
		add	[ebp+var_10], 1

loc_407B98:				; CODE XREF: sub_407B71+21j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_407B94
		mov	eax, [ebp+var_10]
		mov	[ebp+Str1], eax
		mov	[esp+38h+Val], 20h ; Val
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_407BCA
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0

loc_407BCA:				; CODE XREF: sub_407B71+51j
		cmp	[ebp+Str1], 0
		jz	short loc_407BDA
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407C02

loc_407BDA:				; CODE XREF: sub_407B71+5Dj
		mov	[esp+38h+Str], 118h
		call	sub_4055CB
		mov	[esp+38h+var_30], offset aNoDescriptionG ; "no description given"
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_set_error
		jmp	locret_407C82
; ---------------------------------------------------------------------------

loc_407C02:				; CODE XREF: sub_407B71+67j
		mov	[esp+38h+Val], offset asc_4407E9 ; "X"
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_407C20
		mov	[ebp+Str1], 0

loc_407C20:				; CODE XREF: sub_407B71+A6j
		cmp	[ebp+Str1], 0
		jz	short loc_407C31
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Str], eax
		call	sub_4059D9

loc_407C31:				; CODE XREF: sub_407B71+B3j
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax
		call	sub_4105B0
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_407C7F
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str], eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aCommandGet_con ;	"command get_confirmation failed: %s\n"
		call	sub_435B7D

loc_407C7F:				; CODE XREF: sub_407B71+F1j
		mov	eax, [ebp+var_18]

locret_407C82:				; CODE XREF: sub_407B71+8Cj
		leave
		retn
sub_407B71	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407C84(int, char *)
sub_407C84	proc near		; DATA XREF: .data:0043D4BCo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_24], offset aSend ; "--send"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_405740
		test	eax, eax
		jz	short loc_407CB4
		mov	eax, [ebp+arg_0]
		jmp	short loc_407CB9
; ---------------------------------------------------------------------------

loc_407CB4:				; CODE XREF: sub_407C84+29j
		mov	eax, 0

loc_407CB9:				; CODE XREF: sub_407C84+2Ej
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_41C8BC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_407CEC
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+var_28], offset aCommandLearnFa ; "command learn failed: %s\n"
		call	sub_435B7D

loc_407CEC:				; CODE XREF: sub_407C84+4Bj
		mov	eax, [ebp+var_10]
		leave
		retn
sub_407C84	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407CF1	proc near		; DATA XREF: .data:0043D4C8o

var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_28], 0
		mov	[ebp+var_2C], 0
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_405AD8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_407E02
		mov	eax, [ebp+var_10]
		mov	eax, [eax+80h]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[eax+80h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_28]
		mov	[esp+58h+var_40], edx
		mov	[esp+58h+var_44], 0
		mov	[esp+58h+var_48], 0
		lea	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		lea	edx, [ebp+var_24]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_412630
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_407DCD
		mov	eax, [ebp+var_28]
		test	eax, eax
		jnz	short loc_407DB8
		mov	[esp+58h+var_58], offset aChangingASmart ; "changing a smartcard PIN is	not yet	sup"...
		call	sub_435B7D
		mov	[esp+58h+var_58], 45h
		call	sub_4055CB
		mov	[ebp+var_C], eax
		jmp	short loc_407DCD
; ---------------------------------------------------------------------------

loc_407DB8:				; CODE XREF: sub_407CF1+A8j
		mov	eax, [ebp+var_28]
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_414C0D
		mov	[ebp+var_C], eax

loc_407DCD:				; CODE XREF: sub_407CF1+A1j
					; sub_407CF1+C5j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+80h]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[eax+80h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	eax, [eax+0Ch]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	dword ptr [eax+0Ch], 0
		jmp	short loc_407E03
; ---------------------------------------------------------------------------

loc_407E02:				; CODE XREF: sub_407CF1+42j
		nop

loc_407E03:				; CODE XREF: sub_407CF1+10Fj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_407E3A
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aCommandPasswdF ; "command passwd failed: %s\n"
		call	sub_435B7D

loc_407E3A:				; CODE XREF: sub_407CF1+12Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407CF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407E3F	proc near		; DATA XREF: .data:0043D480o

Source		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_14], 0
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_449E14
		test	eax, eax
		jnz	short loc_407E85
		mov	[esp+48h+Source], 3Ch
		call	sub_4055CB
		mov	[esp+48h+var_40], offset aNoAllowPresetP ; "no --allow-preset-passphrase"
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax
		call	assuan_set_error
		jmp	loc_408073
; ---------------------------------------------------------------------------

loc_407E85:				; CODE XREF: sub_407E3F+1Cj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	short loc_407E91
; ---------------------------------------------------------------------------

loc_407E8D:				; CODE XREF: sub_407E3F+6Ej
		add	[ebp+arg_4], 1

loc_407E91:				; CODE XREF: sub_407E3F+4Cj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407EAF
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_407EAF
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_407E8D

loc_407EAF:				; CODE XREF: sub_407E3F+5Aj
					; sub_407E3F+64j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407ECA
		mov	[esp+48h+Source], 80h
		call	sub_4055CB
		jmp	loc_408073
; ---------------------------------------------------------------------------

loc_407ECA:				; CODE XREF: sub_407E3F+78j
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		add	[ebp+arg_4], 1
		jmp	short loc_407EDA
; ---------------------------------------------------------------------------

loc_407ED6:				; CODE XREF: sub_407E3F+ADj
					; sub_407E3F+B7j
		add	[ebp+arg_4], 1

loc_407EDA:				; CODE XREF: sub_407E3F+95j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407EF8
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_407ED6
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_407ED6

loc_407EF8:				; CODE XREF: sub_407E3F+A3j
		mov	[ebp+var_18], 0FFFFFFFFh
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_407F16
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 31h
		jz	short loc_407F27

loc_407F16:				; CODE XREF: sub_407E3F+C8j
		mov	[esp+48h+Source], 45h
		call	sub_4055CB
		jmp	loc_408073
; ---------------------------------------------------------------------------

loc_407F27:				; CODE XREF: sub_407E3F+D5j
		add	[ebp+arg_4], 1
		add	[ebp+arg_4], 1
		jmp	short loc_407F35
; ---------------------------------------------------------------------------

loc_407F31:				; CODE XREF: sub_407E3F+FEj
					; sub_407E3F+108j
		add	[ebp+arg_4], 1

loc_407F35:				; CODE XREF: sub_407E3F+F0j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_407F31
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_407F31
		mov	[ebp+var_1C], 0
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax
		call	sub_4059FE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_407F7A
		mov	eax, [ebp+var_C]
		jmp	loc_408073
; ---------------------------------------------------------------------------

loc_407F7A:				; CODE XREF: sub_407E3F+131j
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407FFF
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Source], eax
		call	sub_424C3A
		test	eax, eax
		jnz	short loc_408025
		mov	[esp+48h+Source], 118h
		call	sub_4055CB
		mov	[esp+48h+var_40], offset aInvalidHexstri ; "invalid hexstring"
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax
		call	assuan_set_error
		mov	[ebp+var_C], eax
		jmp	short loc_408025
; ---------------------------------------------------------------------------

loc_407FFF:				; CODE XREF: sub_407E3F+14Cj
		mov	[esp+48h+Source], 45h
		call	sub_4055CB
		mov	[esp+48h+var_40], offset aPassphraseIsRe ; "passphrase is required"
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax
		call	assuan_set_error
		mov	[ebp+var_C], eax

loc_408025:				; CODE XREF: sub_407E3F+196j
					; sub_407E3F+1BEj
		cmp	[ebp+var_C], 0
		jnz	short loc_40804F
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_40], eax ;	void *
		mov	dword ptr [esp+48h+var_44], 1 ;	int
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Source], eax ;	Source
		call	sub_411372
		mov	[ebp+var_C], eax

loc_40804F:				; CODE XREF: sub_407E3F+1EAj
		cmp	[ebp+var_C], 0
		jz	short loc_408070
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Source], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+Source], offset aCommandPreset_ ; "command preset_passphrase failed: %s\n"
		call	sub_435B7D

loc_408070:				; CODE XREF: sub_407E3F+214j
		mov	eax, [ebp+var_C]

loc_408073:				; CODE XREF: sub_407E3F+41j
					; sub_407E3F+86j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_407E3F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408079	proc near		; DATA XREF: .data:0043D4ECo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_419F50
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		leave
		retn
sub_408079	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4080AE	proc near		; DATA XREF: .data:0043D4F8o

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
Str2		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	[ebp+Str2], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_4080CE
; ---------------------------------------------------------------------------

loc_4080CA:				; CODE XREF: sub_4080AE+28j
		add	[ebp+var_C], 1

loc_4080CE:				; CODE XREF: sub_4080AE+1Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4080CA
		mov	eax, [ebp+var_C]
		mov	[ebp+Str2], eax
		mov	[esp+28h+Val], 20h ; Val
		mov	eax, [ebp+Str2]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408146
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		jmp	short loc_40810A
; ---------------------------------------------------------------------------

loc_408106:				; CODE XREF: sub_4080AE+64j
		add	[ebp+var_C], 1

loc_40810A:				; CODE XREF: sub_4080AE+56j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408106
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408146
		mov	[esp+28h+Str], 118h
		call	sub_4055CB
		mov	[esp+28h+var_20], offset aTooManyArgumen ; "too	many arguments"
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	assuan_set_error
		jmp	locret_408216
; ---------------------------------------------------------------------------

loc_408146:				; CODE XREF: sub_4080AE+4Aj
					; sub_4080AE+6Ej
		cmp	[ebp+Str2], 0
		jz	short loc_408156
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40817E

loc_408156:				; CODE XREF: sub_4080AE+9Cj
		mov	[esp+28h+Str], 118h
		call	sub_4055CB
		mov	[esp+28h+var_20], offset aNoKeyGiven ; "no key given"
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	assuan_set_error
		jmp	locret_408216
; ---------------------------------------------------------------------------

loc_40817E:				; CODE XREF: sub_4080AE+A6j
		mov	eax, ds:dword_449090
		mov	[ebp+var_10], eax
		jmp	short loc_4081A9
; ---------------------------------------------------------------------------

loc_408188:				; CODE XREF: sub_4080AE+FFj
		mov	eax, [ebp+var_10]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+Str2]
		mov	[esp+28h+Val], eax ; Str2
		mov	[esp+28h+Str], edx ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_4081B1
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_4081A9:				; CODE XREF: sub_4080AE+D8j
		cmp	[ebp+var_10], 0
		jnz	short loc_408188
		jmp	short loc_4081B2
; ---------------------------------------------------------------------------

loc_4081B1:				; CODE XREF: sub_4080AE+F1j
		nop

loc_4081B2:				; CODE XREF: sub_4080AE+101j
		cmp	[ebp+var_10], 0
		jz	short loc_4081EA
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_10]
		lea	ecx, [edx+0Ch]
		mov	edx, [ebp+var_10]
		mov	edx, [edx+4]
		add	edx, ecx
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+Val], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	assuan_send_data
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4081F8
		jmp	short loc_408213
; ---------------------------------------------------------------------------

loc_4081EA:				; CODE XREF: sub_4080AE+108j
		mov	[esp+28h+Str], 3Ah
		call	sub_4055CB
		jmp	short locret_408216
; ---------------------------------------------------------------------------

loc_4081F8:				; CODE XREF: sub_4080AE+138j
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax
		call	gpg_strerror
		mov	[esp+28h+Val], eax ; char
		mov	[esp+28h+Str], offset aCommandGetvalF ;	"command getval	failed:	%s\n"
		call	sub_435B7D

loc_408213:				; CODE XREF: sub_4080AE+13Aj
		mov	eax, [ebp+var_14]

locret_408216:				; CODE XREF: sub_4080AE+93j
					; sub_4080AE+CBj ...
		leave
		retn
sub_4080AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408218	proc near		; DATA XREF: .data:0043D504o

Str		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
Str2		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_C], 0
		mov	[ebp+Str2], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		jmp	short loc_408247
; ---------------------------------------------------------------------------

loc_408243:				; CODE XREF: sub_408218+37j
		add	[ebp+var_18], 1

loc_408247:				; CODE XREF: sub_408218+29j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408243
		mov	eax, [ebp+var_18]
		mov	[ebp+Str2], eax
		mov	[esp+48h+Val], 20h ; Val
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4082D5
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		add	[ebp+var_18], 1
		jmp	short loc_408283
; ---------------------------------------------------------------------------

loc_40827F:				; CODE XREF: sub_408218+73j
		add	[ebp+var_18], 1

loc_408283:				; CODE XREF: sub_408218+65j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40827F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4082D5
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		mov	[esp+48h+Val], 20h ; Val
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4082BF
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0

loc_4082BF:				; CODE XREF: sub_408218+9Fj
		mov	[esp+48h+Val], 0
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax
		call	sub_425BDD
		mov	[ebp+var_14], eax

loc_4082D5:				; CODE XREF: sub_408218+59j
					; sub_408218+7Dj
		cmp	[ebp+Str2], 0
		jz	short loc_4082E5
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40830D

loc_4082E5:				; CODE XREF: sub_408218+C1j
		mov	[esp+48h+Str], 118h
		call	sub_4055CB
		mov	[esp+48h+Size],	offset aNoKeyGiven ; "no key given"
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	assuan_set_error
		jmp	loc_408468
; ---------------------------------------------------------------------------

loc_40830D:				; CODE XREF: sub_408218+CBj
		mov	eax, ds:dword_449090
		mov	[ebp+var_1C], eax
		mov	[ebp+var_20], 0
		jmp	short loc_408345
; ---------------------------------------------------------------------------

loc_40831E:				; CODE XREF: sub_408218+131j
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Val], eax ; Str2
		mov	[esp+48h+Str], edx ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_40834D
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax

loc_408345:				; CODE XREF: sub_408218+104j
		cmp	[ebp+var_1C], 0
		jnz	short loc_40831E
		jmp	short loc_40834E
; ---------------------------------------------------------------------------

loc_40834D:				; CODE XREF: sub_408218+11Dj
		nop

loc_40834E:				; CODE XREF: sub_408218+133j
		cmp	[ebp+var_1C], 0
		jz	short loc_40837B
		cmp	[ebp+var_20], 0
		jz	short loc_408366
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_20]
		mov	[eax], edx
		jmp	short loc_408370
; ---------------------------------------------------------------------------

loc_408366:				; CODE XREF: sub_408218+140j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	ds:dword_449090, eax

loc_408370:				; CODE XREF: sub_408218+14Cj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str], eax
		call	gcry_free

loc_40837B:				; CODE XREF: sub_408218+13Aj
		cmp	[ebp+var_14], 0
		jz	loc_408444
		mov	eax, [ebp+Str2]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_14]
		add	eax, 10h
		mov	[esp+48h+Str], eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4083C5
		call	sub_4055F3
		mov	[ebp+var_C], eax
		jmp	short loc_408444
; ---------------------------------------------------------------------------

loc_4083C5:				; CODE XREF: sub_408218+1A1j
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+Str2]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		lea	edx, [eax+1]
		mov	eax, [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+Str2]
		mov	edx, [ebp+var_1C]
		add	edx, 0Ch
		mov	[esp+48h+Val], eax ; Source
		mov	[esp+48h+Str], edx ; Dest
		call	strcpy
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		mov	ecx, eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+4]
		add	eax, ecx
		mov	ecx, [ebp+var_14]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Val], edx ; Src
		mov	[esp+48h+Str], eax ; Dst
		call	memcpy
		mov	edx, ds:dword_449090
		mov	eax, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		mov	ds:dword_449090, eax

loc_408444:				; CODE XREF: sub_408218+167j
					; sub_408218+1ABj
		cmp	[ebp+var_C], 0
		jz	short loc_408465
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	gpg_strerror
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Str], offset aCommandPutvalF ;	"command putval	failed:	%s\n"
		call	sub_435B7D

loc_408465:				; CODE XREF: sub_408218+230j
		mov	eax, [ebp+var_C]

loc_408468:				; CODE XREF: sub_408218+F0j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_408218	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40846E	proc near		; DATA XREF: .data:0043D510o

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_get_pointer
		mov	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		call	sub_41FB5C
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4084AD
		call	sub_4055F3
		mov	[ebp+var_C], eax

loc_4084AD:				; CODE XREF: sub_40846E+35j
		mov	[ebp+var_10], 0
		jmp	short loc_408502
; ---------------------------------------------------------------------------

loc_4084B6:				; CODE XREF: sub_40846E+A6j
		mov	eax, [ebp+var_10]
		mov	edx, off_43D548[eax*4]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+var_34], edx ;	char *
		mov	[esp+38h+var_38], eax ;	int
		call	sub_420115
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_4084FE
		mov	eax, [ebp+var_10]
		mov	eax, off_43D548[eax*4]
		mov	edx, [ebp+var_24]
		mov	[esp+38h+var_30], edx ;	int
		mov	[esp+38h+var_34], eax ;	char *
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_42008C
		mov	[ebp+var_C], eax

loc_4084FE:				; CODE XREF: sub_40846E+6Bj
		add	[ebp+var_10], 1

loc_408502:				; CODE XREF: sub_40846E+46j
		cmp	[ebp+var_C], 0
		jnz	short loc_408516
		mov	eax, [ebp+var_10]
		mov	eax, off_43D548[eax*4]
		test	eax, eax
		jnz	short loc_4084B6

loc_408516:				; CODE XREF: sub_40846E+98j
		cmp	[ebp+var_C], 0
		jnz	short loc_408545
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_408545
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		mov	[esp+38h+var_38], eax
		call	gcry_strdup
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_408545
		call	sub_4055F3
		mov	[ebp+var_C], eax

loc_408545:				; CODE XREF: sub_40846E+ACj
					; sub_40846E+B6j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_408574
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_408574
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		mov	[esp+38h+var_38], eax
		call	gcry_strdup
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_408574
		call	sub_4055F3
		mov	[ebp+var_C], eax

loc_408574:				; CODE XREF: sub_40846E+DBj
					; sub_40846E+E5j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40859D
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_38], eax
		call	sub_41FBD7
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		jmp	short loc_4085DC
; ---------------------------------------------------------------------------

loc_40859D:				; CODE XREF: sub_40846E+10Aj
		mov	eax, ds:dword_449DB8
		mov	[esp+38h+var_38], eax
		call	sub_41FBD7
		mov	eax, [ebp+var_20]
		mov	ds:dword_449DB8, eax
		mov	eax, ds:dword_449DBC
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	ds:dword_449DBC, eax
		mov	eax, ds:dword_449DC0
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	ds:dword_449DC0, eax

loc_4085DC:				; CODE XREF: sub_40846E+12Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40846E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4085E1	proc near		; DATA XREF: .data:0043D51Co

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449DC4
		test	eax, eax
		jnz	short loc_408623
		mov	[esp+28h+var_28], 3Ch
		call	sub_4055CB
		mov	[esp+28h+var_20], offset aNoUseStandardS ; "no --use-standard-socket"
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_set_error
		jmp	short locret_40863C
; ---------------------------------------------------------------------------

loc_408623:				; CODE XREF: sub_4085E1+1Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	dword ptr [eax+14h], 1
		mov	[esp+28h+var_28], 3FFFh
		call	sub_4055CB

locret_40863C:				; CODE XREF: sub_4085E1+40j
		leave
		retn
sub_4085E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40863E	proc near		; DATA XREF: .data:0043D528o
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_403EE1
		mov	eax, 0
		leave
		retn
sub_40863E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408650(int, char *)
sub_408650	proc near		; DATA XREF: .data:0043D534o

Str1		= dword	ptr -88h
Str2		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_6C		= dword	ptr -6Ch
var_66		= byte ptr -66h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
VarName		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		add	esp, 0FFFFFF80h
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str1],	eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		mov	[esp+88h+Str2],	offset aVersion	; "version"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4086C8
		mov	[ebp+var_14], offset a2_0_30_0 ; "2.0.30"
		mov	eax, [ebp+var_14]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_14]
		mov	[esp+88h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str1],	eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_4086C8:				; CODE XREF: sub_408650+32j
		mov	[esp+88h+Str2],	offset aPid ; "pid"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408740
		call	_getpid
		mov	[esp+88h+var_7C], eax
		mov	[esp+88h+var_80], offset aLu ; "%lu"
		mov	[esp+88h+Str2],	32h
		lea	eax, [ebp+var_66]
		mov	[esp+88h+Str1],	eax
		call	sub_4241F9
		lea	eax, [ebp+var_66]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_66]
		mov	[esp+88h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str1],	eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_408740:				; CODE XREF: sub_408650+8Dj
		mov	[esp+88h+Str2],	offset aSocket_name ; "socket_name"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4087B6
		call	sub_403610
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4087A2
		mov	eax, [ebp+var_18]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_18]
		mov	[esp+88h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str1],	eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_4087A2:				; CODE XREF: sub_408650+113j
		mov	[esp+88h+Str1],	3Ah
		call	sub_4055CB
		mov	[ebp+var_C], eax
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_4087B6:				; CODE XREF: sub_408650+105j
		mov	[esp+88h+Str2],	offset aSsh_socket_nam ; "ssh_socket_name"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40882C
		call	sub_40363A
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_408818
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str1],	eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_408818:				; CODE XREF: sub_408650+189j
		mov	[esp+88h+Str1],	3Ah
		call	sub_4055CB
		mov	[ebp+var_C], eax
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_40882C:				; CODE XREF: sub_408650+17Bj
		mov	[esp+88h+Str2],	offset aScd_running ; "scd_running"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408867
		call	sub_41A848
		test	eax, eax
		jnz	short loc_40885A
		mov	[esp+88h+Str1],	1
		call	sub_4055CB
		jmp	short loc_40885F
; ---------------------------------------------------------------------------

loc_40885A:				; CODE XREF: sub_408650+1FAj
		mov	eax, 0

loc_40885F:				; CODE XREF: sub_408650+208j
		mov	[ebp+var_C], eax
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_408867:				; CODE XREF: sub_408650+1F1j
		mov	[esp+88h+Str2],	offset aS2k_count ; "s2k_count"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4088DF
		call	sub_415380
		mov	[esp+88h+var_7C], eax
		mov	[esp+88h+var_80], offset aLu ; "%lu"
		mov	[esp+88h+Str2],	32h
		lea	eax, [ebp+var_66]
		mov	[esp+88h+Str1],	eax
		call	sub_4241F9
		lea	eax, [ebp+var_66]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_66]
		mov	[esp+88h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str1],	eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_4088DF:				; CODE XREF: sub_408650+22Cj
		mov	[esp+88h+Str2],	offset aStd_session_en ; "std_session_env"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_408911
		mov	[esp+88h+Str2],	offset aStd_startup_en ; "std_startup_env"
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_408A18

loc_408911:				; CODE XREF: sub_408650+2A4j
		mov	[ebp+var_34], 0
		jmp	loc_4089ED
; ---------------------------------------------------------------------------

loc_40891D:				; CODE XREF: sub_408650+3B7j
		mov	eax, [ebp+arg_4]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 74h
		jnz	short loc_408931
		mov	eax, ds:dword_449DB8
		jmp	short loc_408937
; ---------------------------------------------------------------------------

loc_408931:				; CODE XREF: sub_408650+2D8j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]

loc_408937:				; CODE XREF: sub_408650+2DFj
		mov	[esp+88h+var_80], 0 ; int
		mov	edx, [ebp+VarName]
		mov	[esp+88h+Str2],	edx ; VarName
		mov	[esp+88h+Str1],	eax ; int
		call	sub_4201C8
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	loc_4089ED
		mov	eax, [ebp+var_2C]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+VarName]
		mov	[esp+88h+Str2],	eax
		mov	[esp+88h+Str1],	offset aSS ; "%s=%s"
		call	sub_4256F5
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_408988
		call	sub_4055F3
		mov	[ebp+var_C], eax
		jmp	short loc_4089E7
; ---------------------------------------------------------------------------

loc_408988:				; CODE XREF: sub_408650+32Cj
		mov	eax, [ebp+var_30]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_30]
		mov	[esp+88h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str1],	eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4089E7
		mov	[esp+88h+var_80], 0
		mov	[esp+88h+Str2],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str1],	eax
		call	assuan_send_data
		mov	[ebp+var_C], eax

loc_4089E7:				; CODE XREF: sub_408650+336j
					; sub_408650+377j
		cmp	[ebp+var_C], 0
		jnz	short loc_408A12

loc_4089ED:				; CODE XREF: sub_408650+2C8j
					; sub_408650+305j
		mov	[esp+88h+Str2],	0
		lea	eax, [ebp+var_34]
		mov	[esp+88h+Str1],	eax
		call	sub_41FB0D
		mov	[ebp+VarName], eax
		cmp	[ebp+VarName], 0
		jnz	loc_40891D
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_408A12:				; CODE XREF: sub_408650+39Bj
		nop
		jmp	loc_408B88
; ---------------------------------------------------------------------------

loc_408A18:				; CODE XREF: sub_408650+2BBj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aCmd_has_option ; "cmd_has_option"
		mov	ecx, 0Eh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_408B5F
		mov	eax, [ebp+arg_4]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408A6F
		mov	eax, [ebp+arg_4]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_408A6F
		mov	eax, [ebp+arg_4]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_408B5F

loc_408A6F:				; CODE XREF: sub_408650+3FFj
					; sub_408650+40Cj
		add	[ebp+arg_4], 0Eh
		jmp	short loc_408A79
; ---------------------------------------------------------------------------

loc_408A75:				; CODE XREF: sub_408650+431j
					; sub_408650+43Bj
		add	[ebp+arg_4], 1

loc_408A79:				; CODE XREF: sub_408650+423j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408A75
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_408A75
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408AAB
		mov	[esp+88h+Str1],	80h
		call	sub_4055CB
		mov	[ebp+var_C], eax
		jmp	loc_408B87
; ---------------------------------------------------------------------------

loc_408AAB:				; CODE XREF: sub_408650+445j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_20], eax
		jmp	short loc_408AB7
; ---------------------------------------------------------------------------

loc_408AB3:				; CODE XREF: sub_408650+483j
		add	[ebp+arg_4], 1

loc_408AB7:				; CODE XREF: sub_408650+461j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408AD5
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408AD5
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_408AB3

loc_408AD5:				; CODE XREF: sub_408650+46Fj
					; sub_408650+479j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408AF3
		mov	[esp+88h+Str1],	80h
		call	sub_4055CB
		mov	[ebp+var_C], eax
		jmp	loc_408B87
; ---------------------------------------------------------------------------

loc_408AF3:				; CODE XREF: sub_408650+48Dj
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		add	[ebp+arg_4], 1
		jmp	short loc_408B03
; ---------------------------------------------------------------------------

loc_408AFF:				; CODE XREF: sub_408650+4BBj
					; sub_408650+4C5j
		add	[ebp+arg_4], 1

loc_408B03:				; CODE XREF: sub_408650+4ADj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408AFF
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_408AFF
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408B32
		mov	[esp+88h+Str1],	80h
		call	sub_4055CB
		mov	[ebp+var_C], eax
		jmp	short loc_408B87
; ---------------------------------------------------------------------------

loc_408B32:				; CODE XREF: sub_408650+4CFj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str2],	eax ; char *
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Str1],	eax ; char *
		call	sub_408F0D
		test	eax, eax
		jnz	short loc_408B87
		mov	[esp+88h+Str1],	1
		call	sub_4055CB
		mov	[ebp+var_C], eax
		jmp	short loc_408B87
; ---------------------------------------------------------------------------

loc_408B5F:				; CODE XREF: sub_408650+3EEj
					; sub_408650+419j
		mov	[esp+88h+Str1],	118h
		call	sub_4055CB
		mov	[esp+88h+var_80], offset aUnknownValueFo ; "unknown value for WHAT"
		mov	[esp+88h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str1],	eax
		call	assuan_set_error
		mov	[ebp+var_C], eax
		jmp	short loc_408B88
; ---------------------------------------------------------------------------

loc_408B87:				; CODE XREF: sub_408650+456j
					; sub_408650+49Ej ...
		nop

loc_408B88:				; CODE XREF: sub_408650+73j
					; sub_408650+EBj ...
		mov	eax, [ebp+var_C]
		sub	esp, 0FFFFFF80h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_408650	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408B92(int, char *, char *Str)
sub_408B92	proc near		; DATA XREF: sub_408F4F+B1o

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
Str		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		mov	[esp+28h+Str2],	offset aPutenv ; "putenv"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408BE2
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+Str]
		mov	[esp+28h+Str2],	edx ; char *
		mov	[esp+28h+Str1],	eax ; int
		call	sub_41FFEE
		mov	[ebp+var_C], eax
		jmp	loc_408E4C
; ---------------------------------------------------------------------------

loc_408BE2:				; CODE XREF: sub_408B92+31j
		mov	[esp+28h+Str2],	offset aDisplay_0 ; "display"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408C1E
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+Str]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+Str2],	offset aDisplay_1 ; "DISPLAY"
		mov	[esp+28h+Str1],	eax ; int
		call	sub_42008C
		mov	[ebp+var_C], eax
		jmp	loc_408E4C
; ---------------------------------------------------------------------------

loc_408C1E:				; CODE XREF: sub_408B92+65j
		mov	[esp+28h+Str2],	offset aTtyname	; "ttyname"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408C67
		mov	eax, ds:dword_449E1C
		test	eax, eax
		jnz	loc_408E4C
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+Str]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+Str2],	offset aGpg_tty_0 ; "GPG_TTY"
		mov	[esp+28h+Str1],	eax ; int
		call	sub_42008C
		mov	[ebp+var_C], eax
		jmp	loc_408E4C
; ---------------------------------------------------------------------------

loc_408C67:				; CODE XREF: sub_408B92+A1j
		mov	[esp+28h+Str2],	offset aTtytype	; "ttytype"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408CB0
		mov	eax, ds:dword_449E1C
		test	eax, eax
		jnz	loc_408E4C
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+Str]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+Str2],	offset aTerm_0 ; "TERM"
		mov	[esp+28h+Str1],	eax ; int
		call	sub_42008C
		mov	[ebp+var_C], eax
		jmp	loc_408E4C
; ---------------------------------------------------------------------------

loc_408CB0:				; CODE XREF: sub_408B92+EAj
		mov	[esp+28h+Str2],	offset aLcCtype	; "lc-ctype"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408D0A
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_408CDF
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	[esp+28h+Str1],	eax
		call	gcry_free

loc_408CDF:				; CODE XREF: sub_408B92+13Dj
		mov	eax, [ebp+Str]
		mov	[esp+28h+Str1],	eax
		call	gcry_strdup
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	loc_408E4C
		call	sub_405608
		jmp	loc_408E4F
; ---------------------------------------------------------------------------

loc_408D0A:				; CODE XREF: sub_408B92+133j
		mov	[esp+28h+Str2],	offset aLcMessages ; "lc-messages"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408D64
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_408D39
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		mov	[esp+28h+Str1],	eax
		call	gcry_free

loc_408D39:				; CODE XREF: sub_408B92+197j
		mov	eax, [ebp+Str]
		mov	[esp+28h+Str1],	eax
		call	gcry_strdup
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	loc_408E4C
		call	sub_405608
		jmp	loc_408E4F
; ---------------------------------------------------------------------------

loc_408D64:				; CODE XREF: sub_408B92+18Dj
		mov	[esp+28h+Str2],	offset aXauthority_0 ; "xauthority"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408DA0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+Str]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+Str2],	offset aXauthority_1 ; "XAUTHORITY"
		mov	[esp+28h+Str1],	eax ; int
		call	sub_42008C
		mov	[ebp+var_C], eax
		jmp	loc_408E4C
; ---------------------------------------------------------------------------

loc_408DA0:				; CODE XREF: sub_408B92+1E7j
		mov	[esp+28h+Str2],	offset aPinentryUserDa ; "pinentry-user-data"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408DD9
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+Str]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+Str2],	offset aPinentry_use_0 ; "PINENTRY_USER_DATA"
		mov	[esp+28h+Str1],	eax ; int
		call	sub_42008C
		mov	[ebp+var_C], eax
		jmp	short loc_408E4C
; ---------------------------------------------------------------------------

loc_408DD9:				; CODE XREF: sub_408B92+223j
		mov	[esp+28h+Str2],	offset aUseCacheForSig ; "use-cache-for-signing"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408E17
		mov	eax, [ebp+var_10]
		mov	ebx, [eax+4]
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408E0D
		mov	eax, [ebp+Str]
		mov	[esp+28h+Str1],	eax ; Str
		call	atoi
		jmp	short loc_408E12
; ---------------------------------------------------------------------------

loc_408E0D:				; CODE XREF: sub_408B92+26Cj
		mov	eax, 0

loc_408E12:				; CODE XREF: sub_408B92+279j
		mov	[ebx+8], eax
		jmp	short loc_408E4C
; ---------------------------------------------------------------------------

loc_408E17:				; CODE XREF: sub_408B92+25Cj
		mov	[esp+28h+Str2],	offset aAllowPinentryN ; "allow-pinentry-notify"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408E3D
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	dword ptr [eax+18h], 1
		jmp	short loc_408E4C
; ---------------------------------------------------------------------------

loc_408E3D:				; CODE XREF: sub_408B92+29Aj
		mov	[esp+28h+Str1],	0AEh
		call	sub_4055CB
		mov	[ebp+var_C], eax

loc_408E4C:				; CODE XREF: sub_408B92+4Bj
					; sub_408B92+87j ...
		mov	eax, [ebp+var_C]

loc_408E4F:				; CODE XREF: sub_408B92+173j
					; sub_408B92+1CDj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_408B92	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408E55	proc near		; DATA XREF: sub_408F4F+8Bo

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	dword ptr [eax+10h], 0
		leave
		retn
sub_408E55	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408E78	proc near		; DATA XREF: sub_40901E+19Eo

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_408EF5
		cmp	[ebp+arg_8], 0
		jnz	short loc_408EF5
		cmp	[ebp+arg_10], 0Eh
		jbe	short loc_408EF5
		mov	eax, [ebp+arg_C]
		mov	edx, eax
		mov	eax, offset aGeteventcounte ; "GETEVENTCOUNTER"
		mov	ecx, 0Fh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_408EF5
		cmp	[ebp+arg_10], 0Fh
		jz	short loc_408EE8
		mov	eax, [ebp+arg_C]
		add	eax, 0Fh
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_408EE8
		mov	eax, [ebp+arg_C]
		add	eax, 0Fh
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_408EF5

loc_408EE8:				; CODE XREF: sub_408E78+54j
					; sub_408E78+61j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	dword ptr [eax+10h], 1

loc_408EF5:				; CODE XREF: sub_408E78+1Aj
					; sub_408E78+20j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	eax, [eax+10h]
		test	eax, eax
		setnz	al
		movzx	eax, al
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_408E78	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408F0D(char *, char *)
sub_408F0D	proc near		; CODE XREF: sub_408650+4F5p

Str1		= dword	ptr -18h
Str2		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+Str2],	offset aGet_passphrase ; "GET_PASSPHRASE"
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408F48
		mov	[esp+18h+Str2],	offset aRepeat_0 ; "repeat"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408F48
		mov	eax, 1
		jmp	short locret_408F4D
; ---------------------------------------------------------------------------

loc_408F48:				; CODE XREF: sub_408F0D+1Bj
					; sub_408F0D+32j
		mov	eax, 0

locret_408F4D:				; CODE XREF: sub_408F0D+39j
		leave
		retn
sub_408F0D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408F4F	proc near		; CODE XREF: sub_40901E+FEp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	[ebp+var_C], 0
		jmp	short loc_408FC3
; ---------------------------------------------------------------------------

loc_408F5F:				; CODE XREF: sub_408F4F+89j
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D3E0
		mov	ebx, [eax+8]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D3E0
		mov	ecx, [eax+4]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D3E0
		mov	eax, [eax]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_register_command
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_408FBF
		mov	eax, [ebp+var_10]
		jmp	short loc_409018
; ---------------------------------------------------------------------------

loc_408FBF:				; CODE XREF: sub_408F4F+69j
		add	[ebp+var_C], 1

loc_408FC3:				; CODE XREF: sub_408F4F+Ej
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D3E0
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_408F5F
		mov	[esp+28h+var_24], offset sub_408E55
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_register_post_cmd_notify
		mov	[esp+28h+var_24], offset sub_4056CB
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_register_reset_notify
		mov	[esp+28h+var_24], offset sub_408B92
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_register_option_handler
		mov	eax, 0

loc_409018:				; CODE XREF: sub_408F4F+6Ej
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_408F4F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40901E	proc near		; CODE XREF: sub_402066+10F0p
					; sub_40458F+84p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409066
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToAlloca ; "failed to allocate assuan context: %s\n"
		call	sub_435B7D
		mov	[esp+28h+var_28], 2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_409066:				; CODE XREF: sub_40901E+1Fj
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_4090A7
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jnz	short loc_4090A7
		mov	[esp+28h+var_28], 0
		call	assuan_fdopen
		mov	[ebp+var_18], eax
		mov	[esp+28h+var_28], 1
		call	assuan_fdopen
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		lea	edx, [ebp+var_18]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	assuan_init_pipe_server
		mov	[ebp+var_C], eax
		jmp	short loc_4090E9
; ---------------------------------------------------------------------------

loc_4090A7:				; CODE XREF: sub_40901E+4Cj
					; sub_40901E+52j
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	short loc_4090CC
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], 0
		mov	edx, [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	assuan_init_socket_server
		mov	[ebp+var_C], eax
		jmp	short loc_4090E9
; ---------------------------------------------------------------------------

loc_4090CC:				; CODE XREF: sub_40901E+8Dj
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], 2
		mov	edx, [ebp+arg_8]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	assuan_init_socket_server
		mov	[ebp+var_C], eax

loc_4090E9:				; CODE XREF: sub_40901E+87j
					; sub_40901E+ACj
		cmp	[ebp+var_C], 0
		jz	short loc_409116
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToInitia ; "failed to initialize the server: %s\n"
		call	sub_435B7D
		mov	[esp+28h+var_28], 2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_409116:				; CODE XREF: sub_40901E+CFj
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_408F4F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409151
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToRegist ; "failed to register commands	with Assuan"...
		call	sub_435B7D
		mov	[esp+28h+var_28], 2
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_409151:				; CODE XREF: sub_40901E+10Aj
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	assuan_set_pointer
		mov	dword ptr [esp+28h+var_24], 1Ch
		mov	[esp+28h+var_28], 1
		call	gcry_xcalloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [eax+8], 1
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+60h]
		and	edx, 0FFFFFFFEh
		mov	[eax+60h], dl
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], offset sub_408E78
		mov	[esp+28h+var_28], eax
		call	assuan_set_io_monitor
		jmp	short loc_4091CF
; ---------------------------------------------------------------------------

loc_4091CE:				; CODE XREF: sub_40901E+20Cj
					; sub_40901E+22Aj
		nop

loc_4091CF:				; CODE XREF: sub_40901E+1AEj
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	assuan_accept
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4055E6
		cmp	eax, 3FFFh
		jz	short loc_40924A
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_40924A
		cmp	[ebp+var_C], 0
		jz	short loc_409218
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aAssuanAcceptPr ; "Assuan accept problem: %s\n"
		call	sub_435B53
		jmp	short loc_40924A
; ---------------------------------------------------------------------------

loc_409218:				; CODE XREF: sub_40901E+1DBj
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	assuan_process
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4091CE
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aAssuanProcessi ; "Assuan processing failed: %s\n"
		call	sub_435B53
		nop
		jmp	short loc_4091CE
; ---------------------------------------------------------------------------

loc_40924A:				; CODE XREF: sub_40901E+1CFj
					; sub_40901E+1D5j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41AA60
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40E5FA
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	assuan_release
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_409284
		mov	[esp+28h+var_28], 0
		call	sub_4032E4
; ---------------------------------------------------------------------------

loc_409284:				; CODE XREF: sub_40901E+258j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		leave
		retn
sub_40901E	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4092A0	proc near		; CODE XREF: sub_4092C7+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4092C0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4092C5
; ---------------------------------------------------------------------------

loc_4092C0:				; CODE XREF: sub_4092A0+7j
		mov	eax, 0

loc_4092C5:				; CODE XREF: sub_4092A0+1Ej
		pop	ebp
		retn
sub_4092A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4092C7	proc near		; CODE XREF: sub_4092EF+Ep
					; sub_409380+3Ap ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_4092A0
		leave
		retn
sub_4092C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4092E2	proc near		; CODE XREF: sub_40A173+69p
					; sub_40A4C0+A0p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_4092E2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4092EF	proc near		; CODE XREF: sub_409380+29p
					; sub_4093E0+28p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_4092C7
		leave
		retn
sub_4092EF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409304	proc near		; DATA XREF: sub_40D9FB+C5o
					; sub_40E084+DFo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_409327
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_realloc
		mov	[ebp+var_C], eax
		jmp	short loc_409335
; ---------------------------------------------------------------------------

loc_409327:				; CODE XREF: sub_409304+Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	gcry_malloc_secure
		mov	[ebp+var_C], eax

loc_409335:				; CODE XREF: sub_409304+21j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409304	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40933A(void *, size_t)
sub_40933A	proc near		; CODE XREF: sub_40ACF4+42Cp
					; sub_40B1B3+82p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+28h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40937B
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+arg_4]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		add	eax, edx
		mov	byte ptr [eax],	0

loc_40937B:				; CODE XREF: sub_40933A+1Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40933A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409380	proc near		; CODE XREF: .text:0040D6BBp

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429B36
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_4093CA
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429531
		test	eax, eax
		jz	short loc_4093B3
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_4093C2
; ---------------------------------------------------------------------------

loc_4093B3:				; CODE XREF: sub_409380+27j
		mov	[esp+28h+var_28], 3FFFh
		call	sub_4092C7
		mov	[ebp+var_C], eax

loc_4093C2:				; CODE XREF: sub_409380+31j
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		jmp	short loc_4093DB
; ---------------------------------------------------------------------------

loc_4093CA:				; CODE XREF: sub_409380+18j
		mov	eax, [ebp+var_10]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], dl
		mov	[ebp+var_C], 0

loc_4093DB:				; CODE XREF: sub_409380+48j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409380	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4093E0	proc near		; CODE XREF: .text:0040C72Ap
					; .text:0040C778p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= byte ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], al
		movzx	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_429C0A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_409412
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_409419
; ---------------------------------------------------------------------------

loc_409412:				; CODE XREF: sub_4093E0+26j
		mov	[ebp+var_C], 0

loc_409419:				; CODE XREF: sub_4093E0+30j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4093E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40941E	proc near		; CODE XREF: sub_4095C1+21p
					; .text:0040CE01p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [ebp+var_18]
		lea	edx, [ebp+var_1C]
		mov	[esp+38h+var_2C], edx
		mov	[esp+38h+var_30], 4
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_429D9A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_409458
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_4094B0
; ---------------------------------------------------------------------------

loc_409458:				; CODE XREF: sub_40941E+2Ej
		mov	eax, [ebp+var_1C]
		cmp	eax, 4
		jz	short loc_409471
		mov	[esp+38h+var_38], 3FFFh
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_4094B0
; ---------------------------------------------------------------------------

loc_409471:				; CODE XREF: sub_40941E+40j
		movzx	eax, [ebp+var_18]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 18h
		movzx	eax, [ebp+var_17]
		movzx	eax, al
		shl	eax, 10h
		or	edx, eax
		movzx	eax, [ebp+var_16]
		movzx	eax, al
		shl	eax, 8
		or	edx, eax
		movzx	eax, [ebp+var_15]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_4094B0:				; CODE XREF: sub_40941E+38j
					; sub_40941E+51j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40941E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4094B5	proc near		; CODE XREF: sub_4096C8+13p
					; sub_40A91E+98p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		shr	eax, 18h
		mov	[ebp+var_14], al
		mov	eax, [ebp+arg_4]
		shr	eax, 10h
		mov	[ebp+var_13], al
		mov	eax, [ebp+arg_4]
		shr	eax, 8
		mov	[ebp+var_12], al
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_11], al
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 4
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429E4F
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_409511
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_409518
; ---------------------------------------------------------------------------

loc_409511:				; CODE XREF: sub_4094B5+50j
		mov	[ebp+var_C], 0

loc_409518:				; CODE XREF: sub_4094B5+5Aj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4094B5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40951D	proc near		; CODE XREF: sub_4095C1+7Dp
					; sub_40990D+B7p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429D9A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_409556
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_409576
; ---------------------------------------------------------------------------

loc_409556:				; CODE XREF: sub_40951D+2Dj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jz	short loc_40956F
		mov	[esp+28h+var_28], 3FFFh
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_409576
; ---------------------------------------------------------------------------

loc_40956F:				; CODE XREF: sub_40951D+3Fj
		mov	[ebp+var_C], 0

loc_409576:				; CODE XREF: sub_40951D+37j
					; sub_40951D+50j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40951D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40957B	proc near		; CODE XREF: sub_4096C8+35p
					; sub_40BAC0+71p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], 0
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429E4F
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4095B5
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_4095BC
; ---------------------------------------------------------------------------

loc_4095B5:				; CODE XREF: sub_40957B+2Ej
		mov	[ebp+var_C], 0

loc_4095BC:				; CODE XREF: sub_40957B+38j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40957B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4095C1	proc near		; CODE XREF: sub_409687+23p
					; sub_409755+28p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40941E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40966D
		cmp	[ebp+arg_4], 0
		jz	short loc_409609
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+28h+var_28], eax
		call	gcry_malloc_secure
		mov	[ebp+var_10], eax
		jmp	short loc_40961A
; ---------------------------------------------------------------------------

loc_409609:				; CODE XREF: sub_4095C1+33j
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax

loc_40961A:				; CODE XREF: sub_4095C1+46j
		cmp	[ebp+var_10], 0
		jnz	short loc_40962A
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_409671
; ---------------------------------------------------------------------------

loc_40962A:				; CODE XREF: sub_4095C1+5Dj
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40951D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_409670
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		cmp	[ebp+arg_C], 0
		jz	short loc_409671
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		jmp	short loc_409671
; ---------------------------------------------------------------------------

loc_40966D:				; CODE XREF: sub_4095C1+2Dj
		nop
		jmp	short loc_409671
; ---------------------------------------------------------------------------

loc_409670:				; CODE XREF: sub_4095C1+89j
		nop

loc_409671:				; CODE XREF: sub_4095C1+67j
					; sub_4095C1+A0j ...
		cmp	[ebp+var_C], 0
		jz	short loc_409682
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free

loc_409682:				; CODE XREF: sub_4095C1+B4j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4095C1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409687	proc near		; CODE XREF: sub_40B3AB+39p
					; sub_40B3AB+1D4p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_1C], 0
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4095C1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4096C2
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		jmp	short loc_4096C3
; ---------------------------------------------------------------------------

loc_4096C2:				; CODE XREF: sub_409687+2Fj
		nop

loc_4096C3:				; CODE XREF: sub_409687+39j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409687	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4096C8	proc near		; CODE XREF: sub_40970D+37p
					; sub_40980A+4Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4094B5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_409707
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40957B
		mov	[ebp+var_C], eax
		jmp	short loc_409708
; ---------------------------------------------------------------------------

loc_409707:				; CODE XREF: sub_4096C8+1Fj
		nop

loc_409708:				; CODE XREF: sub_4096C8+3Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4096C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40970D	proc near		; CODE XREF: sub_40B6EE+C8p
					; sub_40B6EE+E7p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4096C8
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40970D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409755	proc near		; CODE XREF: sub_40A5C8+D7p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4095C1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4097F6
		mov	eax, [ebp+var_14]
		cmp	eax, 208h
		jbe	short loc_4097BA
		mov	[esp+38h+var_38], offset aSshKeysGreater ; "ssh	keys greater than %d bits are not s"...
		call	sub_435294
		mov	dword ptr [esp+38h+var_34], 1000h ; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_435B7D
		mov	[ebp+var_C], 43h
		jmp	short loc_4097FA
; ---------------------------------------------------------------------------

loc_4097BA:				; CODE XREF: sub_409755+3Ej
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], edx
		mov	[esp+38h+var_30], eax
		mov	dword ptr [esp+38h+var_34], 1
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	gcry_mpi_scan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4097F9
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		jmp	short loc_4097FA
; ---------------------------------------------------------------------------

loc_4097F6:				; CODE XREF: sub_409755+34j
		nop
		jmp	short loc_4097FA
; ---------------------------------------------------------------------------

loc_4097F9:				; CODE XREF: sub_409755+95j
		nop

loc_4097FA:				; CODE XREF: sub_409755+63j
					; sub_409755+9Fj ...
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409755	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40980A	proc near		; CODE XREF: sub_40B6EE+13Cp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 1
		call	gcry_mpi_aprint
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40985F
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4096C8
		mov	[ebp+var_C], eax
		jmp	short loc_409860
; ---------------------------------------------------------------------------

loc_40985F:				; CODE XREF: sub_40980A+35j
		nop

loc_409860:				; CODE XREF: sub_40980A+53j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40980A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409870	proc near		; CODE XREF: .text:0040C760p
					; sub_40D9FB+358p

var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= dword	ptr -21Ch
var_214		= dword	ptr -214h
var_210		= byte ptr -210h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 228h
		mov	[ebp+var_C], 0
		jmp	short loc_409883
; ---------------------------------------------------------------------------

loc_409882:				; CODE XREF: sub_409870+8Bj
		nop

loc_409883:				; CODE XREF: sub_409870+10j
		lea	eax, [ebp+var_210]
		lea	edx, [ebp+var_214]
		mov	[esp+228h+var_21C], edx
		mov	[esp+228h+var_220], 200h
		mov	[esp+228h+var_224], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+228h+var_228], eax
		call	sub_429D9A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4098BD
		mov	eax, [ebp+var_214]
		test	eax, eax
		jnz	short loc_4098CD

loc_4098BD:				; CODE XREF: sub_409870+41j
		cmp	[ebp+var_10], 0
		jz	short loc_409907
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_409907
; ---------------------------------------------------------------------------

loc_4098CD:				; CODE XREF: sub_409870+4Bj
		mov	edx, [ebp+var_214]
		lea	eax, [ebp+var_210]
		mov	[esp+228h+var_21C], 0
		mov	[esp+228h+var_220], edx
		mov	[esp+228h+var_224], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+228h+var_228], eax
		call	sub_429E4F
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_409882
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_409908
; ---------------------------------------------------------------------------

loc_409907:				; CODE XREF: sub_409870+51j
					; sub_409870+5Bj
		nop

loc_409908:				; CODE XREF: sub_409870+95j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409870	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40990D(char *, int, int)
sub_40990D	proc near		; CODE XREF: .text:0040C50Cp

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_48		= byte ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	eax, offset aRb	; "rb"
		mov	[esp+58h+var_54], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_4284E2
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40995D
		call	sub_4092EF
		mov	[ebp+var_10], eax
		jmp	loc_4099EA
; ---------------------------------------------------------------------------

loc_40995D:				; CODE XREF: sub_40990D+41j
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	sub_4293D1
		lea	edx, [ebp+var_48]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40998C
		call	sub_4092EF
		mov	[ebp+var_10], eax
		jmp	short loc_4099EA
; ---------------------------------------------------------------------------

loc_40998C:				; CODE XREF: sub_40990D+73j
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4099AD
		call	sub_4092EF
		mov	[ebp+var_10], eax
		jmp	short loc_4099EA
; ---------------------------------------------------------------------------

loc_4099AD:				; CODE XREF: sub_40990D+94j
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	sub_40951D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4099E9
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		jmp	short loc_4099EA
; ---------------------------------------------------------------------------

loc_4099E9:				; CODE XREF: sub_40990D+C3j
		nop

loc_4099EA:				; CODE XREF: sub_40990D+4Bj
					; sub_40990D+7Dj ...
		cmp	[ebp+var_14], 0
		jz	short loc_4099FB
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax ;	void *
		call	sub_4291C4

loc_4099FB:				; CODE XREF: sub_40990D+E1j
		cmp	[ebp+var_10], 0
		jz	short loc_409A0C
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gcry_free

loc_409A0C:				; CODE XREF: sub_40990D+F2j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40990D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409A11	proc near		; CODE XREF: sub_40A173+17p
					; sub_40A2BF+46p ...

Filename	= dword	ptr -28h
Mode		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	[esp+28h+Mode],	48h
		mov	[esp+28h+Filename], 1
		call	gcry_calloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_409A43
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_409BAE
; ---------------------------------------------------------------------------

loc_409A43:				; CODE XREF: sub_409A11+23j
		mov	eax, ds:dword_449DB4
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+Mode],	offset aSshcontrol ; "sshcontrol"
		mov	[esp+28h+Filename], eax
		call	sub_432697
		mov	edx, [ebp+var_10]
		mov	[edx], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_409A7B
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_409BAE
; ---------------------------------------------------------------------------

loc_409A7B:				; CODE XREF: sub_409A11+5Bj
		cmp	[ebp+arg_4], 0
		jz	short loc_409A88
		mov	eax, offset aA	; "a+"
		jmp	short loc_409A8D
; ---------------------------------------------------------------------------

loc_409A88:				; CODE XREF: sub_409A11+6Ej
		mov	eax, offset aR_0 ; "r"

loc_409A8D:				; CODE XREF: sub_409A11+75j
		mov	edx, [ebp+var_10]
		mov	edx, [edx]
		mov	[esp+28h+Mode],	eax ; Mode
		mov	[esp+28h+Filename], edx	; Filename
		call	fopen
		mov	edx, [ebp+var_10]
		mov	[edx+4], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_409B65
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2
		jnz	loc_409B65
		mov	edx, offset aWxModeRwR ; "wx,mode=-rw-r"
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+Mode],	edx ; int
		mov	[esp+28h+Filename], eax	; char *
		call	sub_4284E2
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_409B1E
		call	sub_4092EF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	eax, [ebp+var_10]
		mov	esi, [eax]
		mov	[esp+28h+Filename], offset aCanTCreateSS ; "can't create `%s': %s\n"
		call	sub_435294
		mov	[esp+28h+var_20], ebx
		mov	[esp+28h+Mode],	esi ; char
		mov	[esp+28h+Filename], eax	; char *
		call	sub_435B7D
		jmp	loc_409BAE
; ---------------------------------------------------------------------------

loc_409B1E:				; CODE XREF: sub_409A11+D0j
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Mode],	eax
		mov	[esp+28h+Filename], offset aListOfAllowedS ; "#	List of	allowed	ssh keys.  Only	keys "...
		call	sub_42A247
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Filename], eax	; void *
		call	sub_4291C4
		cmp	[ebp+arg_4], 0
		jz	short loc_409B49
		mov	eax, offset aA	; "a+"
		jmp	short loc_409B4E
; ---------------------------------------------------------------------------

loc_409B49:				; CODE XREF: sub_409A11+12Fj
		mov	eax, offset aR_0 ; "r"

loc_409B4E:				; CODE XREF: sub_409A11+136j
		mov	edx, [ebp+var_10]
		mov	edx, [edx]
		mov	[esp+28h+Mode],	eax ; Mode
		mov	[esp+28h+Filename], edx	; Filename
		call	fopen
		mov	edx, [ebp+var_10]
		mov	[edx+4], eax

loc_409B65:				; CODE XREF: sub_409A11+9Bj
					; sub_409A11+ADj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_409BA7
		call	sub_4092EF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	eax, [ebp+var_10]
		mov	esi, [eax]
		mov	[esp+28h+Filename], offset aCanTOpenSS ; "can't open `%s': %s\n"
		call	sub_435294
		mov	[esp+28h+var_20], ebx
		mov	[esp+28h+Mode],	esi ; char
		mov	[esp+28h+Filename], eax	; char *
		call	sub_435B7D
		jmp	short loc_409BAE
; ---------------------------------------------------------------------------

loc_409BA7:				; CODE XREF: sub_409A11+15Cj
		mov	[ebp+var_C], 0

loc_409BAE:				; CODE XREF: sub_409A11+2Dj
					; sub_409A11+65j ...
		cmp	[ebp+var_C], 0
		jz	short loc_409BEC
		cmp	[ebp+var_10], 0
		jz	short loc_409BEC
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_409BD2
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	[esp+28h+Filename], eax	; File
		call	fclose

loc_409BD2:				; CODE XREF: sub_409A11+1B1j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Filename], eax
		call	gcry_free
		jmp	short loc_409BF4
; ---------------------------------------------------------------------------

loc_409BEC:				; CODE XREF: sub_409A11+1A1j
					; sub_409A11+1A7j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_409BF4:				; CODE XREF: sub_409A11+1D9j
		mov	eax, [ebp+var_C]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_409A11	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409BFE	proc near		; CODE XREF: sub_40A07F+74p

File		= dword	ptr -18h
Offset		= dword	ptr -14h
Origin		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+Origin], 0 ; Origin
		mov	[esp+18h+Offset], 0 ; Offset
		mov	[esp+18h+File],	eax ; File
		call	fseek
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+File],	eax ; File
		call	clearerr
		leave
		retn
sub_409BFE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409C3C	proc near		; CODE XREF: sub_40A173+13Ap
					; sub_40A2BF+96p ...

File		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_409C70
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+18h+File],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+File],	eax
		call	gcry_free
		jmp	short locret_409C71
; ---------------------------------------------------------------------------

loc_409C70:				; CODE XREF: sub_409C3C+Aj
		nop

locret_409C71:				; CODE XREF: sub_409C3C+32j
		leave
		retn
sub_409C3C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409C73	proc near		; CODE XREF: sub_40A07F+A7p
					; sub_40A443+Cp ...

File		= dword	ptr -158h
MaxCount	= dword	ptr -154h
Size		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= dword	ptr -148h
var_12C		= dword	ptr -12Ch
Buf		= byte ptr -120h
EndPtr		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 154h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+158h+File], eax ; File
		call	clearerr

loc_409C9C:				; CODE XREF: sub_409C73+138j
					; sub_409C73+146j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+158h+Size], eax ; File
		mov	[esp+158h+MaxCount], 0FFh ; MaxCount
		lea	eax, [ebp+Buf]
		mov	[esp+158h+File], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	short loc_409CED
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+158h+File], eax ; File
		call	feof
		test	eax, eax
		jz	short loc_409CE3
		mov	[esp+158h+File], 3FFFh
		call	sub_4092C7
		jmp	loc_40A076
; ---------------------------------------------------------------------------

loc_409CE3:				; CODE XREF: sub_409C73+5Dj
		call	sub_4092EF
		jmp	loc_40A076
; ---------------------------------------------------------------------------

loc_409CED:				; CODE XREF: sub_409C73+4Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_409D3E
		lea	eax, [ebp+Buf]
		mov	[ebp+var_12C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_12C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		movzx	eax, [ebp+eax+Buf]
		cmp	al, 0Ah
		jz	short loc_409D80

loc_409D3E:				; CODE XREF: sub_409C73+92j
		nop

loc_409D3F:				; CODE XREF: sub_409C73+E7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+158h+File], eax ; File
		call	getc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_409D5C
		cmp	[ebp+var_1C], 0Ah
		jnz	short loc_409D3F

loc_409D5C:				; CODE XREF: sub_409C73+E1j
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_409D6E
		mov	eax, 61h
		jmp	short loc_409D73
; ---------------------------------------------------------------------------

loc_409D6E:				; CODE XREF: sub_409C73+F2j
		mov	eax, 4Bh

loc_409D73:				; CODE XREF: sub_409C73+F9j
		mov	[esp+158h+File], eax
		call	sub_4092C7
		jmp	loc_40A076
; ---------------------------------------------------------------------------

loc_409D80:				; CODE XREF: sub_409C73+C9j
		lea	eax, [ebp+Buf]
		mov	[ebp+Str], eax
		jmp	short loc_409D8F
; ---------------------------------------------------------------------------

loc_409D8B:				; CODE XREF: sub_409C73+124j
					; sub_409C73+12Ej
		add	[ebp+Str], 1

loc_409D8F:				; CODE XREF: sub_409C73+116j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_409D8B
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_409D8B
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_409C9C
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	loc_409C9C
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	loc_409C9C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 21h
		jnz	short loc_409E09
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 1
		add	[ebp+Str], 1
		jmp	short loc_409DF5
; ---------------------------------------------------------------------------

loc_409DF1:				; CODE XREF: sub_409C73+18Aj
					; sub_409C73+194j
		add	[ebp+Str], 1

loc_409DF5:				; CODE XREF: sub_409C73+17Cj
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_409DF1
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_409DF1

loc_409E09:				; CODE XREF: sub_409C73+16Cj
		mov	[ebp+var_C], 0
		jmp	short loc_409E41
; ---------------------------------------------------------------------------

loc_409E12:				; CODE XREF: sub_409C73+20Ej
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_409E27
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		jmp	short loc_409E2D
; ---------------------------------------------------------------------------

loc_409E27:				; CODE XREF: sub_409C73+1A7j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]

loc_409E2D:				; CODE XREF: sub_409C73+1B2j
		mov	edx, [ebp+arg_0]
		add	edx, [ebp+var_C]
		add	edx, 10h
		mov	[edx+0Ch], al
		add	[ebp+Str], 1
		add	[ebp+var_C], 1

loc_409E41:				; CODE XREF: sub_409C73+19Dj
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_409E55
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_409E7D

loc_409E55:				; CODE XREF: sub_409C73+1D6j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_409E69
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_409E7D

loc_409E69:				; CODE XREF: sub_409C73+1EAj
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_409E83
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_409E83

loc_409E7D:				; CODE XREF: sub_409C73+1E0j
					; sub_409C73+1F4j
		cmp	[ebp+var_C], 27h
		jle	short loc_409E12

loc_409E83:				; CODE XREF: sub_409C73+1FEj
					; sub_409C73+208j
		mov	eax, [ebp+arg_0]
		add	eax, [ebp+var_C]
		add	eax, 10h
		mov	byte ptr [eax+0Ch], 0
		cmp	[ebp+var_C], 28h
		jnz	short loc_409EB4
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_409EE4
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_409EE4
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_409EE4

loc_409EB4:				; CODE XREF: sub_409C73+221j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+158h+Size], edx
		mov	[esp+158h+MaxCount], eax ; char
		mov	[esp+158h+File], offset	aSDInvalidForma	; "%s:%d: invalid formatted line\n"
		call	sub_435B7D
		mov	[esp+158h+File], 59h
		call	sub_4092C7
		jmp	loc_40A076
; ---------------------------------------------------------------------------

loc_409EE4:				; CODE XREF: sub_409C73+22Bj
					; sub_409C73+235j ...
		mov	eax, [ebp+Str]
		mov	[esp+158h+Size], 0Ah ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+158h+MaxCount], edx ; EndPtr
		mov	[esp+158h+File], eax ; Str
		call	strtol
		mov	[ebp+var_14], eax
		mov	eax, [ebp+EndPtr]
		mov	[ebp+Str], eax
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_409F25
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_409F25
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_409F2B

loc_409F25:				; CODE XREF: sub_409C73+29Cj
					; sub_409C73+2A6j
		cmp	[ebp+var_14], 0FFFFFFFFh
		jge	short loc_409F54

loc_409F2B:				; CODE XREF: sub_409C73+2B0j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+158h+Size], edx
		mov	[esp+158h+MaxCount], eax ; char
		mov	[esp+158h+File], offset	aSDInvalidTtlVa	; "%s:%d: invalid TTL value; assuming 0\n"
		call	sub_435B7D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0

loc_409F54:				; CODE XREF: sub_409C73+2B6j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		jmp	loc_40A059
; ---------------------------------------------------------------------------

loc_409F6C:				; CODE XREF: sub_409C73+31Cj
		add	[ebp+Str], 1
		jmp	short loc_409F73
; ---------------------------------------------------------------------------

loc_409F72:				; CODE XREF: sub_409C73+3EEj
		nop

loc_409F73:				; CODE XREF: sub_409C73+2FDj
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_409F87
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_409F91

loc_409F87:				; CODE XREF: sub_409C73+308j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_409F6C

loc_409F91:				; CODE XREF: sub_409C73+312j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40A067
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	loc_40A067
		mov	[esp+158h+MaxCount], offset asc_442486 ; "= \t\n"
		mov	eax, [ebp+Str]
		mov	[esp+158h+File], eax ; Str
		call	strcspn
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		add	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_409FF5
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+158h+Size], edx
		mov	[esp+158h+MaxCount], eax ; char
		mov	[esp+158h+File], offset	aSDAssigningAVa	; "%s:%d: assigning a value to a flag is n"...
		call	sub_435B7D
		add	[ebp+Str], 1
		jmp	short loc_40A053
; ---------------------------------------------------------------------------

loc_409FF5:				; CODE XREF: sub_409C73+35Bj
		cmp	[ebp+var_18], 7
		jnz	short loc_40A026
		mov	[esp+158h+Size], 7 ; Size
		mov	[esp+158h+MaxCount], offset aConfirm ; "confirm"
		mov	eax, [ebp+Str]
		mov	[esp+158h+File], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_40A026
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 1
		jmp	short loc_40A053
; ---------------------------------------------------------------------------

loc_40A026:				; CODE XREF: sub_409C73+386j
					; sub_409C73+3A5j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	ecx, [ebp+Str]
		mov	[esp+158h+var_148], ecx
		mov	ecx, [ebp+var_18]
		mov	[esp+158h+var_14C], ecx
		mov	[esp+158h+Size], edx
		mov	[esp+158h+MaxCount], eax ; char
		mov	[esp+158h+File], offset	aSDInvalidFlag_	; "%s:%d: invalid flag '%.*s'; ignored\n"
		call	sub_435B7D

loc_40A053:				; CODE XREF: sub_409C73+380j
					; sub_409C73+3B1j
		mov	eax, [ebp+var_18]
		add	[ebp+Str], eax

loc_40A059:				; CODE XREF: sub_409C73+2F4j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_409F72

loc_40A067:				; CODE XREF: sub_409C73+326j
					; sub_409C73+334j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 1
		mov	eax, 0

loc_40A076:				; CODE XREF: sub_409C73+6Bj
					; sub_409C73+75j ...
		add	esp, 154h
		pop	edi
		pop	ebp
		retn
sub_409C73	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A07F(int, char *, int, int,	int)
sub_40A07F	proc near		; CODE XREF: sub_40A173+51p
					; sub_40A2BF+79p ...

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 28h
		jz	short loc_40A0C6
		mov	[esp+38h+var_30], 3A1h ; int
		mov	[esp+38h+Str2],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/agent/command-ssh.c"
		mov	[esp+38h+Str1],	offset aStrlenHexgrip4 ; "strlen (hexgrip) == 40"
		call	sub_43BB20

loc_40A0C6:				; CODE XREF: sub_40A07F+29j
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_40A0DE
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_40A0DE:				; CODE XREF: sub_40A07F+54j
		cmp	[ebp+arg_10], 0
		jz	short loc_40A0ED
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0

loc_40A0ED:				; CODE XREF: sub_40A07F+63j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_409BFE
		jmp	short loc_40A120
; ---------------------------------------------------------------------------

loc_40A0FA:				; CODE XREF: sub_40A07F+B3j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40A11F
		mov	eax, [ebp+arg_0]
		add	eax, 1Ch
		mov	[esp+38h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_40A136
		jmp	short loc_40A120
; ---------------------------------------------------------------------------

loc_40A11F:				; CODE XREF: sub_40A07F+83j
		nop

loc_40A120:				; CODE XREF: sub_40A07F+79j
					; sub_40A07F+9Ej
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_409C73
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40A0FA
		jmp	short loc_40A137
; ---------------------------------------------------------------------------

loc_40A136:				; CODE XREF: sub_40A07F+9Cj
		nop

loc_40A137:				; CODE XREF: sub_40A07F+B5j
		cmp	[ebp+var_C], 0
		jnz	short loc_40A16A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		cmp	[ebp+arg_C], 0
		jz	short loc_40A159
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_40A159:				; CODE XREF: sub_40A07F+CDj
		cmp	[ebp+arg_10], 0
		jz	short loc_40A16A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_40A16A:				; CODE XREF: sub_40A07F+BCj
					; sub_40A07F+DEj
		mov	eax, [ebp+var_C]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40A07F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A173(int, char *, int, int,	int)
sub_40A173	proc near		; CODE XREF: sub_40D199+34Cp

File		= dword	ptr -78h
Format		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	[esp+78h+Format], 1
		lea	eax, [ebp+var_24]
		mov	[esp+78h+File],	eax
		call	sub_409A11
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40A1A0
		mov	eax, [ebp+var_1C]
		jmp	loc_40A2B7
; ---------------------------------------------------------------------------

loc_40A1A0:				; CODE XREF: sub_40A173+23j
		mov	eax, [ebp+var_24]
		mov	[esp+78h+var_68], 0 ; int
		mov	[esp+78h+var_6C], 0 ; int
		lea	edx, [ebp+var_28]
		mov	[esp+78h+var_70], edx ;	int
		mov	edx, [ebp+arg_4]
		mov	[esp+78h+Format], edx ;	char *
		mov	[esp+78h+File],	eax ; int
		call	sub_40A07F
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_40A2A7
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+File],	eax
		call	sub_4092E2
		cmp	eax, 3FFFh
		jnz	loc_40A2A7
		mov	[esp+78h+File],	0
		call	sub_43BBF0
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+File],	eax
		call	sub_43C0E0
		mov	[ebp+var_20], eax
		cmp	[ebp+arg_10], 0
		jz	short loc_40A216
		mov	edx, offset aConfirm_0 ; " confirm"
		jmp	short loc_40A21B
; ---------------------------------------------------------------------------

loc_40A216:				; CODE XREF: sub_40A173+9Aj
		mov	edx, offset dword_44254C

loc_40A21B:				; CODE XREF: sub_40A173+A1j
		mov	eax, [ebp+var_20]
		mov	esi, [eax]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+4]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+14h]
		lea	edi, [eax+76Ch]
		mov	ebx, offset aKeyAddedOn04d0 ; "# Key added on: %04d-%02d-%02d %02d:%02"...
		mov	eax, [ebp+var_24]
		mov	ecx, [eax+4]
		mov	[esp+78h+var_4C], edx
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_54], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+78h+var_58], eax
		mov	[esp+78h+var_5C], esi
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+var_60], eax
		mov	eax, [ebp+var_40]
		mov	[esp+78h+var_64], eax
		mov	eax, [ebp+var_44]
		mov	[esp+78h+var_68], eax
		mov	eax, [ebp+var_48]
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+var_70], edi
		mov	[esp+78h+Format], ebx ;	Format
		mov	[esp+78h+File],	ecx ; File
		call	fprintf

loc_40A2A7:				; CODE XREF: sub_40A173+5Dj
					; sub_40A173+73j
		mov	eax, [ebp+var_24]
		mov	[esp+78h+File],	eax
		call	sub_409C3C
		mov	eax, 0

loc_40A2B7:				; CODE XREF: sub_40A173+28j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40A173	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A2BF(char *)
sub_40A2BF	proc near		; DATA XREF: sub_40C7DB+21Eo

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	[ebp+arg_0], 0
		jz	short loc_40A2F0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 28h
		jz	short loc_40A2F7

loc_40A2F0:				; CODE XREF: sub_40A2BF+Bj
		mov	eax, 0
		jmp	short loc_40A35D
; ---------------------------------------------------------------------------

loc_40A2F7:				; CODE XREF: sub_40A2BF+2Fj
		mov	[esp+48h+var_44], 0
		lea	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_409A11
		test	eax, eax
		jz	short loc_40A315
		mov	eax, 0
		jmp	short loc_40A35D
; ---------------------------------------------------------------------------

loc_40A315:				; CODE XREF: sub_40A2BF+4Dj
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_38], 0 ; int
		lea	edx, [ebp+var_14]
		mov	[esp+48h+var_3C], edx ;	int
		lea	edx, [ebp+var_10]
		mov	[esp+48h+var_40], edx ;	int
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_44], edx ;	char *
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40A07F
		test	eax, eax
		jnz	short loc_40A348
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_40A34F

loc_40A348:				; CODE XREF: sub_40A2BF+80j
		mov	[ebp+var_14], 0

loc_40A34F:				; CODE XREF: sub_40A2BF+87j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_409C3C
		mov	eax, [ebp+var_14]

loc_40A35D:				; CODE XREF: sub_40A2BF+36j
					; sub_40A2BF+54j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40A2BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A363(char *)
sub_40A363	proc near		; CODE XREF: sub_40C7DB+9Dp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	[ebp+arg_0], 0
		jz	short loc_40A394
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 28h
		jz	short loc_40A39B

loc_40A394:				; CODE XREF: sub_40A363+Bj
		mov	eax, 1
		jmp	short loc_40A401
; ---------------------------------------------------------------------------

loc_40A39B:				; CODE XREF: sub_40A363+2Fj
		mov	[esp+48h+var_44], 0
		lea	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_409A11
		test	eax, eax
		jz	short loc_40A3B9
		mov	eax, 1
		jmp	short loc_40A401
; ---------------------------------------------------------------------------

loc_40A3B9:				; CODE XREF: sub_40A363+4Dj
		mov	eax, [ebp+var_C]
		lea	edx, [ebp+var_14]
		mov	[esp+48h+var_38], edx ;	int
		mov	[esp+48h+var_3C], 0 ; int
		lea	edx, [ebp+var_10]
		mov	[esp+48h+var_40], edx ;	int
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_44], edx ;	char *
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40A07F
		test	eax, eax
		jnz	short loc_40A3EC
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_40A3F3

loc_40A3EC:				; CODE XREF: sub_40A363+80j
		mov	[ebp+var_14], 0

loc_40A3F3:				; CODE XREF: sub_40A363+87j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_409C3C
		mov	eax, [ebp+var_14]

loc_40A401:				; CODE XREF: sub_40A363+36j
					; sub_40A363+54j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40A363	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A407	proc near		; CODE XREF: sub_406F3A:loc_406FF3p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0
		lea	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_409A11
		test	eax, eax
		jz	short loc_40A42B
		mov	eax, 0
		jmp	short locret_40A42E
; ---------------------------------------------------------------------------

loc_40A42B:				; CODE XREF: sub_40A407+1Bj
		mov	eax, [ebp+var_C]

locret_40A42E:				; CODE XREF: sub_40A407+22j
		leave
		retn
sub_40A407	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A430	proc near		; CODE XREF: sub_406F3A+46Fp

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_409C3C
		leave
		retn
sub_40A430	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A443(int, char *, int, int,	int)
sub_40A443	proc near		; CODE XREF: sub_406F3A+16Bp

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h

loc_40A449:				; CODE XREF: sub_40A443+22j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dest],	eax
		call	sub_409C73
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40A467
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40A449

loc_40A467:				; CODE XREF: sub_40A443+18j
		cmp	[ebp+var_C], 0
		jnz	short loc_40A4BB
		cmp	[ebp+arg_4], 0
		jz	short loc_40A488
		mov	eax, [ebp+arg_0]
		add	eax, 1Ch
		mov	[esp+28h+Source], eax ;	Source
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Dest],	eax ; Dest
		call	strcpy

loc_40A488:				; CODE XREF: sub_40A443+2Ej
		cmp	[ebp+arg_8], 0
		jz	short loc_40A499
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_40A499:				; CODE XREF: sub_40A443+49j
		cmp	[ebp+arg_C], 0
		jz	short loc_40A4AA
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_40A4AA:				; CODE XREF: sub_40A443+5Aj
		cmp	[ebp+arg_10], 0
		jz	short loc_40A4BB
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_40A4BB:				; CODE XREF: sub_40A443+28j
					; sub_40A443+6Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40A443	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A4C0	proc near		; CODE XREF: sub_406F3A+2E1p
					; sub_406F3A+3EDp

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_3D		= byte ptr -3Dh
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	short loc_40A500
; ---------------------------------------------------------------------------

loc_40A4D5:				; CODE XREF: sub_40A4C0+4Ej
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40A4EA
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		and	eax, 0FFFFFFDFh
		jmp	short loc_40A4F0
; ---------------------------------------------------------------------------

loc_40A4EA:				; CODE XREF: sub_40A4C0+1Dj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]

loc_40A4F0:				; CODE XREF: sub_40A4C0+28j
		lea	edx, [ebp+var_3D]
		add	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_40A500:				; CODE XREF: sub_40A4C0+13j
		cmp	[ebp+var_10], 27h
		jg	short loc_40A510
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A4D5

loc_40A510:				; CODE XREF: sub_40A4C0+44j
		lea	eax, [ebp+var_3D]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		cmp	[ebp+var_10], 28h
		jz	short loc_40A530
		mov	[esp+68h+var_68], 8Bh
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_40A55A
; ---------------------------------------------------------------------------

loc_40A530:				; CODE XREF: sub_40A4C0+5Dj
		mov	eax, [ebp+arg_10]
		mov	[esp+68h+var_58], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+var_5C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+var_60], eax ;	int
		lea	eax, [ebp+var_3D]
		mov	[esp+68h+var_64], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax ;	int
		call	sub_40A07F
		mov	[ebp+var_C], eax

loc_40A55A:				; CODE XREF: sub_40A4C0+6Ej
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	sub_4092E2
		cmp	eax, 3FFFh
		jnz	short loc_40A57B
		mov	[esp+68h+var_68], 1Bh
		call	sub_4092C7
		mov	[ebp+var_C], eax

loc_40A57B:				; CODE XREF: sub_40A4C0+AAj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40A4C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A580	proc near		; CODE XREF: sub_40A5C8+111p
					; sub_40ACF4+4B0p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short locret_40A5C6
		mov	[ebp+var_C], 0
		jmp	short loc_40A5AC
; ---------------------------------------------------------------------------

loc_40A595:				; CODE XREF: sub_40A580+39j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	gcry_mpi_release
		add	[ebp+var_C], 1

loc_40A5AC:				; CODE XREF: sub_40A580+13j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40A595
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free

locret_40A5C6:				; CODE XREF: sub_40A580+Aj
		leave
		retn
sub_40A580	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A5C8	proc near		; CODE XREF: sub_40B3AB+1AFp

Str		= dword	ptr -48h
Val		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_34		= dword	ptr  3Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_40A5EB
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_C], eax
		jmp	short loc_40A5F1
; ---------------------------------------------------------------------------

loc_40A5EB:				; CODE XREF: sub_40A5C8+19j
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_C], eax

loc_40A5F1:				; CODE XREF: sub_40A5C8+21j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[esp+48h+Val], 4
		mov	[esp+48h+Str], eax
		call	gcry_calloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40A645
		call	sub_4092EF
		mov	[ebp+var_14], eax
		jmp	loc_40A6CD
; ---------------------------------------------------------------------------

loc_40A645:				; CODE XREF: sub_40A5C8+6Ej
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 0
		jmp	short loc_40A6B1
; ---------------------------------------------------------------------------

loc_40A655:				; CODE XREF: sub_40A5C8+EFj
		cmp	[ebp+arg_4], 0
		jz	short loc_40A683
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_C]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+48h+Val], eax ; Val
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_10], eax

loc_40A683:				; CODE XREF: sub_40A5C8+91j
		mov	eax, [ebp+var_18]
		shl	eax, 2
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	sub_409755
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40A6BB
		add	[ebp+var_18], 1

loc_40A6B1:				; CODE XREF: sub_40A5C8+8Bj
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_20]
		jb	short loc_40A655
		jmp	short loc_40A6BC
; ---------------------------------------------------------------------------

loc_40A6BB:				; CODE XREF: sub_40A5C8+E3j
		nop

loc_40A6BC:				; CODE XREF: sub_40A5C8+F1j
		cmp	[ebp+var_14], 0
		jnz	short loc_40A6CC
		mov	eax, [ebp+arg_34]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		jmp	short loc_40A6CD
; ---------------------------------------------------------------------------

loc_40A6CC:				; CODE XREF: sub_40A5C8+F8j
		nop

loc_40A6CD:				; CODE XREF: sub_40A5C8+78j
					; sub_40A5C8+102j
		cmp	[ebp+var_14], 0
		jz	short loc_40A6DE
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str], eax
		call	sub_40A580

loc_40A6DE:				; CODE XREF: sub_40A5C8+109j
		mov	eax, [ebp+var_14]
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40A5C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A6E7(char *, int)
sub_40A6E7	proc near		; DATA XREF: .data:0043D5F8o

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Str2],	offset aNedupq ; "nedupq"
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40A774
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str1],	eax
		call	gcry_mpi_cmp
		test	eax, eax
		jle	short loc_40A759
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+10h]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	[edx], eax
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_18]
		mov	[edx], eax
		jmp	short loc_40A775
; ---------------------------------------------------------------------------

loc_40A759:				; CODE XREF: sub_40A6E7+4Cj
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str1],	eax
		call	gcry_mpi_invm
		jmp	short loc_40A775
; ---------------------------------------------------------------------------

loc_40A774:				; CODE XREF: sub_40A6E7+1Bj
		nop

loc_40A775:				; CODE XREF: sub_40A6E7+70j
					; sub_40A6E7+8Bj
		mov	eax, 0
		leave
		retn
sub_40A6E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A77C	proc near		; DATA XREF: .data:0043D5FCo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_20], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 5
		call	gcry_mpi_aprint
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40A7DD
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_4096C8
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short loc_40A7DE
; ---------------------------------------------------------------------------

loc_40A7DD:				; CODE XREF: sub_40A77C+36j
		nop

loc_40A7DE:				; CODE XREF: sub_40A77C+5Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40A77C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A7E3	proc near		; DATA XREF: .data:0043D628o

Dst		= dword	ptr -68h
Val		= dword	ptr -64h
Size		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
Src		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	[ebp+Src], 0
		mov	[ebp+var_20], 0
		jmp	loc_40A8D5
; ---------------------------------------------------------------------------

loc_40A7FF:				; CODE XREF: sub_40A7E3+F6j
		mov	eax, [ebp+var_20]
		shl	eax, 2
		add	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_50]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+Src]
		mov	[esp+68h+Val], eax
		mov	[esp+68h+Dst], 5
		call	gcry_mpi_aprint
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_40A8E1
		mov	eax, [ebp+var_50]
		cmp	eax, 14h
		jbe	short loc_40A851
		mov	[esp+68h+Dst], 3Fh
		call	sub_4092C7
		mov	[ebp+var_1C], eax
		jmp	loc_40A8E2
; ---------------------------------------------------------------------------

loc_40A851:				; CODE XREF: sub_40A7E3+58j
		mov	eax, [ebp+var_50]
		mov	edx, 14h
		mov	ecx, edx
		sub	ecx, eax
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		lea	edx, [ebp+var_48]
		add	eax, edx
		mov	edx, ecx
		mov	[esp+68h+Size],	edx ; Size
		mov	[esp+68h+Val], 0 ; Val
		mov	[esp+68h+Dst], eax ; Dst
		call	memset
		mov	ecx, [ebp+var_50]
		mov	eax, [ebp+Src]
		mov	ebx, eax
		lea	esi, [ebp+var_48]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_50]
		mov	edi, edx
		sub	edi, eax
		mov	eax, edi
		add	eax, 14h
		add	eax, esi
		mov	edx, ebx
		mov	[esp+68h+Size],	ecx ; Size
		mov	[esp+68h+Val], edx ; Src
		mov	[esp+68h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+Src]
		mov	[esp+68h+Dst], eax
		call	gcry_free
		mov	[ebp+Src], 0
		add	[ebp+var_20], 1

loc_40A8D5:				; CODE XREF: sub_40A7E3+17j
		cmp	[ebp+var_20], 1
		jle	loc_40A7FF
		jmp	short loc_40A8E2
; ---------------------------------------------------------------------------

loc_40A8E1:				; CODE XREF: sub_40A7E3+4Cj
		nop

loc_40A8E2:				; CODE XREF: sub_40A7E3+69j
					; sub_40A7E3+FCj
		cmp	[ebp+var_1C], 0
		jnz	short loc_40A907
		mov	[esp+68h+Size],	28h
		lea	eax, [ebp+var_48]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Dst], eax
		call	sub_4096C8
		mov	[ebp+var_1C], eax
		jmp	short loc_40A908
; ---------------------------------------------------------------------------

loc_40A907:				; CODE XREF: sub_40A7E3+103j
		nop

loc_40A908:				; CODE XREF: sub_40A7E3+122j
		mov	eax, [ebp+Src]
		mov	[esp+68h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40A7E3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A91E	proc near		; DATA XREF: .data:0043D654o
					; .data:0043D680o ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		jmp	short loc_40A9A1
; ---------------------------------------------------------------------------

loc_40A943:				; CODE XREF: sub_40A91E+89j
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, [ebp+var_14]
		lea	ecx, ds:0[edx*4]
		lea	edx, [ebp+var_24]
		add	ecx, edx
		mov	edx, [ebp+var_14]
		lea	ebx, ds:0[edx*4]
		lea	edx, [ebp+var_1C]
		add	edx, ebx
		mov	[esp+38h+var_2C], eax
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], 1
		call	gcry_mpi_aprint
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40AA05
		mov	eax, [ebp+var_14]
		mov	eax, [ebp+eax*4+var_24]
		add	eax, [ebp+var_C]
		add	eax, 4
		mov	[ebp+var_C], eax
		add	[ebp+var_14], 1

loc_40A9A1:				; CODE XREF: sub_40A91E+23j
		mov	eax, [ebp+var_14]
		cmp	eax, 1
		jbe	short loc_40A943
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_4094B5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40AA08
		mov	[ebp+var_14], 0
		jmp	short loc_40A9FB
; ---------------------------------------------------------------------------

loc_40A9CD:				; CODE XREF: sub_40A91E+E3j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+eax*4+var_24]
		mov	eax, [ebp+var_14]
		mov	eax, [ebp+eax*4+var_1C]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_4096C8
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40AA0B
		add	[ebp+var_14], 1

loc_40A9FB:				; CODE XREF: sub_40A91E+ADj
		mov	eax, [ebp+var_14]
		cmp	eax, 1
		jbe	short loc_40A9CD
		jmp	short loc_40AA0C
; ---------------------------------------------------------------------------

loc_40AA05:				; CODE XREF: sub_40A91E+6Dj
		nop
		jmp	short loc_40AA0C
; ---------------------------------------------------------------------------

loc_40AA08:				; CODE XREF: sub_40A91E+A4j
		nop
		jmp	short loc_40AA0C
; ---------------------------------------------------------------------------

loc_40AA0B:				; CODE XREF: sub_40A91E+D7j
		nop

loc_40AA0C:				; CODE XREF: sub_40A91E+E5j
					; sub_40A91E+E8j ...
		mov	[ebp+var_14], 0
		jmp	short loc_40AA28
; ---------------------------------------------------------------------------

loc_40AA15:				; CODE XREF: sub_40A91E+110j
		mov	eax, [ebp+var_14]
		mov	eax, [ebp+eax*4+var_1C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		add	[ebp+var_14], 1

loc_40AA28:				; CODE XREF: sub_40A91E+F5j
		mov	eax, [ebp+var_14]
		cmp	eax, 1
		jbe	short loc_40AA15
		mov	eax, [ebp+var_10]
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_40A91E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AA39	proc near		; CODE XREF: sub_40B3AB+29Dp
					; sub_40BBF5+101p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_18		= dword	ptr  20h
arg_30		= dword	ptr  38h
arg_34		= dword	ptr  3Ch
arg_38		= dword	ptr  40h
arg_3C		= byte ptr  44h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_30], offset aPublicKey	; "public-key"
		mov	[ebp+var_2C], offset aPrivateKey ; "private-key"
		mov	[ebp+var_34], 0
		mov	[ebp+var_38], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_30], 0
		jz	short loc_40AA71
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		jmp	short loc_40AA77
; ---------------------------------------------------------------------------

loc_40AA71:				; CODE XREF: sub_40AA39+2Ej
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_1C], eax

loc_40AA77:				; CODE XREF: sub_40AA39+36j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, offset aAB	; "a+b"
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+var_58], 0
		call	sub_428707
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40AAC4
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_40ACCA
; ---------------------------------------------------------------------------

loc_40AAC4:				; CODE XREF: sub_40AA39+7Cj
		mov	eax, [ebp+var_28]
		add	eax, 5
		shl	eax, 2
		mov	[esp+58h+var_58], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40AAEB
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_40ACCA
; ---------------------------------------------------------------------------

loc_40AAEB:				; CODE XREF: sub_40AA39+A3j
		mov	[ebp+var_14], 0
		mov	eax, offset aSS_0 ; "(%s(%s"
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	sub_42A247
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+var_10]
		mov	edx, [ebp+arg_30]
		lea	ecx, ds:0[edx*4]
		lea	edx, [ebp+var_30]
		add	edx, ecx
		mov	[eax], edx
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+var_10]
		lea	edx, [ebp+arg_4]
		add	edx, 4
		mov	[eax], edx
		add	[ebp+var_14], 1
		mov	eax, [ebp+arg_34]
		test	eax, eax
		jz	short loc_40AB66
		mov	eax, offset aCurveS ; "(curve%s)"
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	sub_42A247
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+var_10]
		lea	edx, [ebp+arg_34]
		mov	[eax], edx
		add	[ebp+var_14], 1

loc_40AB66:				; CODE XREF: sub_40AA39+105j
		mov	[ebp+var_20], 0
		jmp	loc_40ABF2
; ---------------------------------------------------------------------------

loc_40AB72:				; CODE XREF: sub_40AA39+1BFj
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_1C]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, offset aCM	; "(%c%%m)"
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_42A8BF
		cmp	[ebp+arg_30], 0
		jz	short loc_40ABCD
		mov	[ebp+var_24], 0
		jmp	short loc_40ABC3
; ---------------------------------------------------------------------------

loc_40ABA7:				; CODE XREF: sub_40AA39+190j
		mov	eax, [ebp+arg_C]
		add	eax, [ebp+var_24]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+var_1C]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_40ABD5
		add	[ebp+var_24], 1

loc_40ABC3:				; CODE XREF: sub_40AA39+16Cj
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_28]
		jb	short loc_40ABA7
		jmp	short loc_40ABD6
; ---------------------------------------------------------------------------

loc_40ABCD:				; CODE XREF: sub_40AA39+163j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		jmp	short loc_40ABD6
; ---------------------------------------------------------------------------

loc_40ABD5:				; CODE XREF: sub_40AA39+184j
		nop

loc_40ABD6:				; CODE XREF: sub_40AA39+192j
					; sub_40AA39+19Aj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+var_10]
		mov	edx, [ebp+var_24]
		shl	edx, 2
		add	edx, [ebp+arg_38]
		mov	[eax], edx
		add	[ebp+var_14], 1
		add	[ebp+var_20], 1

loc_40ABF2:				; CODE XREF: sub_40AA39+134j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_28]
		jb	loc_40AB72
		mov	eax, offset aCommentS ;	")(comment%s))"
		mov	edx, [ebp+var_18]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	sub_42A247
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+var_10]
		lea	edx, [ebp+arg_3C]
		mov	[eax], edx
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+var_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+var_58], 0
		call	sub_429C0A
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_429531
		test	eax, eax
		jz	short loc_40AC5F
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_40ACCA
; ---------------------------------------------------------------------------

loc_40AC5F:				; CODE XREF: sub_40AA39+21Aj
		mov	[esp+58h+var_50], 0 ; int
		lea	eax, [ebp+var_38]
		mov	[esp+58h+var_54], eax ;	int
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax ;	void *
		call	sub_4291E5
		test	eax, eax
		jz	short loc_40AC87
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_40ACCA
; ---------------------------------------------------------------------------

loc_40AC87:				; CODE XREF: sub_40AA39+242j
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_10]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 0
		lea	eax, [ebp+var_34]
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_build_array
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40ACC9
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[ebp+var_C], 0
		jmp	short loc_40ACCA
; ---------------------------------------------------------------------------

loc_40ACC9:				; CODE XREF: sub_40AA39+27Dj
		nop

loc_40ACCA:				; CODE XREF: sub_40AA39+86j
					; sub_40AA39+ADj ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax ;	void *
		call	sub_4291C4
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_38]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_40AA39	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ACF4	proc near		; CODE XREF: sub_40B91A+DBp
					; sub_40BBF5+83p

Str1		= dword	ptr -68h
Str2		= dword	ptr -64h
var_60		= dword	ptr -60h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_2C		= dword	ptr  34h
arg_30		= dword	ptr  38h
arg_34		= dword	ptr  3Ch
arg_38		= dword	ptr  40h
arg_3C		= dword	ptr  44h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 60h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_30], 0
		mov	[ebp+var_34], 0
		lea	eax, [ebp+var_44]
		mov	[esp+68h+var_60], eax
		mov	[esp+68h+Str2],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_nth_data
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40AD64
		mov	[esp+68h+Str1],	53h
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	loc_40B161
; ---------------------------------------------------------------------------

loc_40AD64:				; CODE XREF: sub_40ACF4+5Aj
		mov	eax, [ebp+var_44]
		cmp	eax, 0Ah
		jnz	short loc_40AD94
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	eax, offset aPublicKey ; "public-key"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40ADF4

loc_40AD94:				; CODE XREF: sub_40ACF4+76j
		mov	eax, [ebp+var_44]
		cmp	eax, 15h
		jnz	short loc_40ADC4
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	eax, offset aProtectedPriva ; "protected-private-key"
		mov	ecx, 15h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40ADF4

loc_40ADC4:				; CODE XREF: sub_40ACF4+A6j
		mov	eax, [ebp+var_44]
		cmp	eax, 14h
		jnz	short loc_40AE03
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	eax, offset aShadowedPrivat ; "shadowed-private-key"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40AE03

loc_40ADF4:				; CODE XREF: sub_40ACF4+9Ej
					; sub_40ACF4+CEj
		mov	[ebp+var_28], 0
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_2C], eax
		jmp	short loc_40AE56
; ---------------------------------------------------------------------------

loc_40AE03:				; CODE XREF: sub_40ACF4+D6j
					; sub_40ACF4+FEj
		mov	eax, [ebp+var_44]
		cmp	eax, 0Bh
		jnz	short loc_40AE42
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	eax, offset aPrivateKey	; "private-key"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40AE42
		mov	[ebp+var_28], 1
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_2C], eax
		jmp	short loc_40AE56
; ---------------------------------------------------------------------------

loc_40AE42:				; CODE XREF: sub_40ACF4+115j
					; sub_40ACF4+13Dj
		mov	[esp+68h+Str1],	53h
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	loc_40B161
; ---------------------------------------------------------------------------

loc_40AE56:				; CODE XREF: sub_40ACF4+10Dj
					; sub_40ACF4+14Cj
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[esp+68h+Str2],	4
		mov	[esp+68h+Str1],	eax
		call	gcry_calloc
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_40AEA4
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_40B161
; ---------------------------------------------------------------------------

loc_40AEA4:				; CODE XREF: sub_40ACF4+1A1j
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_find_token
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40AEDB
		mov	[esp+68h+Str1],	53h
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	loc_40B161
; ---------------------------------------------------------------------------

loc_40AEDB:				; CODE XREF: sub_40ACF4+1D1j
		mov	[ebp+var_1C], 0
		jmp	loc_40AF79
; ---------------------------------------------------------------------------

loc_40AEE7:				; CODE XREF: sub_40ACF4+28Bj
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_2C]
		add	eax, edx
		mov	[esp+68h+var_60], 1
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_find_token
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40AF20
		mov	[esp+68h+Str1],	53h
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_40AF85
; ---------------------------------------------------------------------------

loc_40AF20:				; CODE XREF: sub_40ACF4+219j
		mov	[esp+68h+var_60], 1
		mov	[esp+68h+Str2],	1
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_nth_mpi
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jnz	short loc_40AF55
		mov	[esp+68h+Str1],	53h
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_40AF85
; ---------------------------------------------------------------------------

loc_40AF55:				; CODE XREF: sub_40ACF4+24Ej
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, [ebp+var_30]
		mov	edx, [ebp+var_40]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_release
		mov	[ebp+var_14], 0
		add	[ebp+var_1C], 1

loc_40AF79:				; CODE XREF: sub_40ACF4+1EEj
		mov	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jb	loc_40AEE7

loc_40AF85:				; CODE XREF: sub_40ACF4+22Aj
					; sub_40ACF4+25Fj
		cmp	[ebp+var_C], 0
		jnz	loc_40B160
		mov	eax, [ebp+arg_2C]
		and	eax, 2
		test	eax, eax
		jz	loc_40B0B0
		mov	[esp+68h+var_60], 5
		mov	[esp+68h+Str2],	offset aCurve ;	"curve"
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_find_token
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40AFD5
		mov	[esp+68h+Str1],	0BBh
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	loc_40B161
; ---------------------------------------------------------------------------

loc_40AFD5:				; CODE XREF: sub_40ACF4+2CBj
		mov	[esp+68h+Str2],	1
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_nth_string
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_40B005
		mov	[esp+68h+Str1],	0BBh
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	loc_40B161
; ---------------------------------------------------------------------------

loc_40B005:				; CODE XREF: sub_40ACF4+2FBj
		mov	[esp+68h+Str2],	offset aNistP256 ; "NIST P-256"
		mov	eax, [ebp+var_34]
		mov	[esp+68h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40B025
		mov	[ebp+var_38], offset aNistp256 ; "nistp256"
		jmp	short loc_40B06C
; ---------------------------------------------------------------------------

loc_40B025:				; CODE XREF: sub_40ACF4+326j
		mov	[esp+68h+Str2],	offset aNistP384 ; "NIST P-384"
		mov	eax, [ebp+var_34]
		mov	[esp+68h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40B045
		mov	[ebp+var_38], offset aNistp384 ; "nistp384"
		jmp	short loc_40B06C
; ---------------------------------------------------------------------------

loc_40B045:				; CODE XREF: sub_40ACF4+346j
		mov	[esp+68h+Str2],	offset aNistP521 ; "NIST P-521"
		mov	eax, [ebp+var_34]
		mov	[esp+68h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40B065
		mov	[ebp+var_38], offset aNistp521 ; "nistp521"
		jmp	short loc_40B06C
; ---------------------------------------------------------------------------

loc_40B065:				; CODE XREF: sub_40ACF4+366j
		mov	[ebp+var_38], 0

loc_40B06C:				; CODE XREF: sub_40ACF4+32Fj
					; sub_40ACF4+34Fj ...
		cmp	[ebp+var_38], 0
		jz	short loc_40B09E
		mov	eax, [ebp+var_34]
		mov	[esp+68h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_38]
		mov	[esp+68h+Str1],	eax
		call	gcry_strdup
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_40B09E
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_40B161
; ---------------------------------------------------------------------------

loc_40B09E:				; CODE XREF: sub_40ACF4+37Cj
					; sub_40ACF4+39Bj
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_release
		mov	[ebp+var_14], 0

loc_40B0B0:				; CODE XREF: sub_40ACF4+2A3j
		mov	[ebp+var_24], 0
		mov	[ebp+var_44], 0
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+Str2],	offset aComment	; "comment"
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_find_token
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40B0FF
		lea	eax, [ebp+var_44]
		mov	[esp+68h+var_60], eax
		mov	[esp+68h+Str2],	1
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_nth_data
		mov	[ebp+var_24], eax

loc_40B0FF:				; CODE XREF: sub_40ACF4+3ECj
		cmp	[ebp+var_24], 0
		jnz	short loc_40B113
		mov	[ebp+var_24], offset aNone_0 ; "(none)"
		mov	[ebp+var_44], 6

loc_40B113:				; CODE XREF: sub_40ACF4+40Fj
		mov	eax, [ebp+var_44]
		mov	[esp+68h+Str2],	eax ; size_t
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Str1],	eax ; void *
		call	sub_40933A
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40B138
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_40B161
; ---------------------------------------------------------------------------

loc_40B138:				; CODE XREF: sub_40ACF4+438j
		cmp	[ebp+arg_30], 0
		jz	short loc_40B146
		mov	eax, [ebp+arg_30]
		mov	edx, [ebp+var_28]
		mov	[eax], edx

loc_40B146:				; CODE XREF: sub_40ACF4+448j
		mov	eax, [ebp+arg_34]
		mov	edx, [ebp+var_30]
		mov	[eax], edx
		mov	eax, [ebp+arg_3C]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, [ebp+arg_38]
		mov	edx, [ebp+var_34]
		mov	[eax], edx
		jmp	short loc_40B161
; ---------------------------------------------------------------------------

loc_40B160:				; CODE XREF: sub_40ACF4+295j
		nop

loc_40B161:				; CODE XREF: sub_40ACF4+6Bj
					; sub_40ACF4+15Dj ...
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Str1],	eax
		call	gcry_sexp_release
		cmp	[ebp+var_C], 0
		jz	short loc_40B1A9
		mov	eax, [ebp+var_34]
		mov	[esp+68h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_30]
		mov	[esp+68h+Str1],	eax
		call	sub_40A580

loc_40B1A9:				; CODE XREF: sub_40ACF4+492j
		mov	eax, [ebp+var_C]
		add	esp, 60h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40ACF4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B1B3	proc near		; CODE XREF: sub_40B91A+32p
					; .text:0040C5A4p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_nth
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40B1F4
		mov	[esp+38h+var_38], 53h
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_40B261
; ---------------------------------------------------------------------------

loc_40B1F4:				; CODE XREF: sub_40B1B3+2Ej
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_nth_data
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40B228
		mov	[esp+38h+var_38], 53h
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_40B261
; ---------------------------------------------------------------------------

loc_40B228:				; CODE XREF: sub_40B1B3+62j
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax ;	size_t
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_40933A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40B259
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax
		call	gpg_err_code_from_errno
		mov	[ebp+var_C], eax
		jmp	short loc_40B261
; ---------------------------------------------------------------------------

loc_40B259:				; CODE XREF: sub_40B1B3+8Ej
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_40B261:				; CODE XREF: sub_40B1B3+3Fj
					; sub_40B1B3+73j ...
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40B1B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B271(char *, char *, int)
sub_40B271	proc near		; CODE XREF: sub_40B3AB+60p
					; sub_40B91A+59p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		jmp	short loc_40B2D1
; ---------------------------------------------------------------------------

loc_40B280:				; CODE XREF: sub_40B271+64j
		cmp	[ebp+arg_0], 0
		jz	short loc_40B2A6
		mov	eax, [ebp+var_10]
		imul	eax, 2Ch
		add	eax, offset off_43D5E0
		mov	eax, [eax]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_40B2D7

loc_40B2A6:				; CODE XREF: sub_40B271+13j
		cmp	[ebp+arg_4], 0
		jz	short loc_40B2CD
		mov	eax, [ebp+var_10]
		imul	eax, 2Ch
		add	eax, offset off_43D5E0
		mov	eax, [eax+4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_40B2D7

loc_40B2CD:				; CODE XREF: sub_40B271+39j
		add	[ebp+var_10], 1

loc_40B2D1:				; CODE XREF: sub_40B271+Dj
		cmp	[ebp+var_10], 4
		jbe	short loc_40B280

loc_40B2D7:				; CODE XREF: sub_40B271+33j
					; sub_40B271+5Aj
		cmp	[ebp+var_10], 5
		jnz	short loc_40B2EE
		mov	[esp+28h+Str1],	1Bh
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_40B344
; ---------------------------------------------------------------------------

loc_40B2EE:				; CODE XREF: sub_40B271+6Aj
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		imul	edx, 2Ch
		add	edx, offset off_43D5E0
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	ecx, [edx+24h]
		mov	[eax+24h], ecx
		mov	edx, [edx+28h]
		mov	[eax+28h], edx
		mov	[ebp+var_C], 0

loc_40B344:				; CODE XREF: sub_40B271+7Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40B271	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B349(char *)
sub_40B349	proc near		; CODE XREF: sub_40B6EE+99p

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_40B39C
; ---------------------------------------------------------------------------

loc_40B358:				; CODE XREF: sub_40B349+59j
		mov	eax, [ebp+var_C]
		imul	eax, 2Ch
		add	eax, offset dword_43D600
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40B398
		mov	eax, [ebp+var_C]
		imul	eax, 2Ch
		add	eax, offset dword_43D600
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Str2],	edx ; Str2
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40B398
		mov	eax, [ebp+var_C]
		imul	eax, 2Ch
		add	eax, offset off_43D5E0
		mov	eax, [eax]
		jmp	short locret_40B3A9
; ---------------------------------------------------------------------------

loc_40B398:				; CODE XREF: sub_40B349+1Ej
					; sub_40B349+3Ej
		add	[ebp+var_C], 1

loc_40B39C:				; CODE XREF: sub_40B349+Dj
		mov	eax, [ebp+var_C]
		cmp	eax, 4
		jbe	short loc_40B358
		mov	eax, 0

locret_40B3A9:				; CODE XREF: sub_40B349+4Dj
		leave
		retn
sub_40B349	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B3AB	proc near		; CODE XREF: sub_40BAC0+C7p
					; .text:0040D69Cp

Str1		= dword	ptr -98h
Str2		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_54], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_1C]
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_409687
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40B6AA
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_50]
		mov	[esp+98h+var_90], edx ;	int
		mov	[esp+98h+Str2],	0 ; char *
		mov	[esp+98h+Str1],	eax ; char *
		call	sub_40B271
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40B6AD
		mov	eax, [ebp+var_28]
		and	eax, 2
		test	eax, eax
		jz	loc_40B4F9
		mov	[esp+98h+var_8C], 0
		lea	eax, [ebp+var_58]
		mov	[esp+98h+var_90], eax
		mov	[esp+98h+Str2],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_4095C1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40B6B0
		mov	eax, [ebp+var_58]
		mov	[ebp+var_14], eax
		mov	[esp+98h+Str2],	offset aNistp256 ; "nistp256"
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40B480
		mov	[ebp+var_18], offset aNistP256 ; "NIST P-256"
		jmp	short loc_40B4C7
; ---------------------------------------------------------------------------

loc_40B480:				; CODE XREF: sub_40B3AB+CAj
		mov	[esp+98h+Str2],	offset aNistp384 ; "nistp384"
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40B4A0
		mov	[ebp+var_18], offset aNistP384 ; "NIST P-384"
		jmp	short loc_40B4C7
; ---------------------------------------------------------------------------

loc_40B4A0:				; CODE XREF: sub_40B3AB+EAj
		mov	[esp+98h+Str2],	offset aNistp521 ; "nistp521"
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40B4C0
		mov	[ebp+var_18], offset aNistP521 ; "NIST P-521"
		jmp	short loc_40B4C7
; ---------------------------------------------------------------------------

loc_40B4C0:				; CODE XREF: sub_40B3AB+10Aj
		mov	[ebp+var_18], 0

loc_40B4C7:				; CODE XREF: sub_40B3AB+D3j
					; sub_40B3AB+F3j ...
		cmp	[ebp+var_18], 0
		jz	short loc_40B4F9
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+98h+Str1],	eax
		call	gcry_strdup
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40B4F9
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_40B6BD
; ---------------------------------------------------------------------------

loc_40B4F9:				; CODE XREF: sub_40B3AB+7Aj
					; sub_40B3AB+120j ...
		lea	eax, [ebp+var_54]
		mov	[esp+98h+var_64], eax
		mov	eax, [ebp+var_50]
		mov	[esp+98h+var_90], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+98h+var_8C], eax
		mov	eax, [ebp+var_48]
		mov	[esp+98h+var_88], eax
		mov	eax, [ebp+var_44]
		mov	[esp+98h+var_84], eax
		mov	eax, [ebp+var_40]
		mov	[esp+98h+var_80], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+98h+var_7C], eax
		mov	eax, [ebp+var_38]
		mov	[esp+98h+var_78], eax
		mov	eax, [ebp+var_34]
		mov	[esp+98h+var_74], eax
		mov	eax, [ebp+var_30]
		mov	[esp+98h+var_70], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+98h+var_6C], eax
		mov	eax, [ebp+var_28]
		mov	[esp+98h+var_68], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_40A5C8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40B6B3
		cmp	[ebp+arg_C], 0
		jz	short loc_40B591
		lea	eax, [ebp+var_20]
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_409687
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40B6B6

loc_40B591:				; CODE XREF: sub_40B3AB+1C5j
		cmp	[ebp+arg_8], 0
		jz	short loc_40B59F
		mov	eax, [ebp+var_48]
		mov	[ebp+var_10], eax
		jmp	short loc_40B5A5
; ---------------------------------------------------------------------------

loc_40B59F:				; CODE XREF: sub_40B3AB+1EAj
		mov	eax, [ebp+var_44]
		mov	[ebp+var_10], eax

loc_40B5A5:				; CODE XREF: sub_40B3AB+1F2j
		mov	eax, [ebp+var_38]
		test	eax, eax
		jz	short loc_40B5CB
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_54]
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+98h+Str1],	eax
		call	edx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40B6B9

loc_40B5CB:				; CODE XREF: sub_40B3AB+1FFj
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_40B5D7
		mov	eax, [ebp+var_20]
		jmp	short loc_40B5DC
; ---------------------------------------------------------------------------

loc_40B5D7:				; CODE XREF: sub_40B3AB+225j
		mov	eax, offset dword_44254C

loc_40B5DC:				; CODE XREF: sub_40B3AB+22Aj
		mov	edx, [ebp+var_54]
		mov	[esp+98h+var_5C], eax
		mov	[esp+98h+var_60], edx
		mov	eax, [ebp+var_14]
		mov	[esp+98h+var_64], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+var_68], eax
		mov	eax, [ebp+var_50]
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+var_4C]
		mov	[esp+98h+var_90], eax
		mov	eax, [ebp+var_48]
		mov	[esp+98h+var_8C], eax
		mov	eax, [ebp+var_44]
		mov	[esp+98h+var_88], eax
		mov	eax, [ebp+var_40]
		mov	[esp+98h+var_84], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+98h+var_80], eax
		mov	eax, [ebp+var_38]
		mov	[esp+98h+var_7C], eax
		mov	eax, [ebp+var_34]
		mov	[esp+98h+var_78], eax
		mov	eax, [ebp+var_30]
		mov	[esp+98h+var_74], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+98h+var_70], eax
		mov	eax, [ebp+var_28]
		mov	[esp+98h+var_6C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+98h+Str1],	eax
		call	sub_40AA39
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40B6BC
		cmp	[ebp+arg_10], 0
		jz	short loc_40B6A0
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_50]
		mov	[eax], edx
		mov	edx, [ebp+var_4C]
		mov	[eax+4], edx
		mov	edx, [ebp+var_48]
		mov	[eax+8], edx
		mov	edx, [ebp+var_44]
		mov	[eax+0Ch], edx
		mov	edx, [ebp+var_40]
		mov	[eax+10h], edx
		mov	edx, [ebp+var_3C]
		mov	[eax+14h], edx
		mov	edx, [ebp+var_38]
		mov	[eax+18h], edx
		mov	edx, [ebp+var_34]
		mov	[eax+1Ch], edx
		mov	edx, [ebp+var_30]
		mov	[eax+20h], edx
		mov	edx, [ebp+var_2C]
		mov	[eax+24h], edx
		mov	edx, [ebp+var_28]
		mov	[eax+28h], edx

loc_40B6A0:				; CODE XREF: sub_40B3AB+2AFj
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		jmp	short loc_40B6BD
; ---------------------------------------------------------------------------

loc_40B6AA:				; CODE XREF: sub_40B3AB+45j
		nop
		jmp	short loc_40B6BD
; ---------------------------------------------------------------------------

loc_40B6AD:				; CODE XREF: sub_40B3AB+6Cj
		nop
		jmp	short loc_40B6BD
; ---------------------------------------------------------------------------

loc_40B6B0:				; CODE XREF: sub_40B3AB+A9j
		nop
		jmp	short loc_40B6BD
; ---------------------------------------------------------------------------

loc_40B6B3:				; CODE XREF: sub_40B3AB+1BBj
		nop
		jmp	short loc_40B6BD
; ---------------------------------------------------------------------------

loc_40B6B6:				; CODE XREF: sub_40B3AB+1E0j
		nop
		jmp	short loc_40B6BD
; ---------------------------------------------------------------------------

loc_40B6B9:				; CODE XREF: sub_40B3AB+21Aj
		nop
		jmp	short loc_40B6BD
; ---------------------------------------------------------------------------

loc_40B6BC:				; CODE XREF: sub_40B3AB+2A9j
		nop

loc_40B6BD:				; CODE XREF: sub_40B3AB+149j
					; sub_40B3AB+2FDj ...
		mov	eax, [ebp+var_54]
		mov	[esp+98h+Str1],	eax
		call	sub_40A580
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40B3AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B6EE(int, int, int,	char *,	int)
sub_40B6EE	proc near		; CODE XREF: sub_40B91A+10Bp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_10], 0
		mov	eax, offset aR_1 ; "r+"
		mov	[esp+48h+var_30], eax
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 1
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	[esp+48h+var_48], 0
		call	sub_4285F8
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40B76E
		call	sub_4092EF
		mov	[ebp+var_10], eax
		jmp	loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B76E:				; CODE XREF: sub_40B6EE+71j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+28h]
		and	eax, 2
		test	eax, eax
		jz	short loc_40B7E8
		cmp	[ebp+arg_C], 0
		jz	short loc_40B7E8
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_40B349
		mov	[ebp+var_1C], eax
		cmp	[ebp+arg_C], 0
		jnz	short loc_40B7A9
		mov	[esp+48h+var_48], 0BCh
		call	sub_4092C7
		mov	[ebp+var_10], eax
		jmp	loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B7A9:				; CODE XREF: sub_40B6EE+A5j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_40970D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40B8E6
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_40970D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40B80B
		jmp	loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B7E8:				; CODE XREF: sub_40B6EE+8Bj
					; sub_40B6EE+91j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_40970D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40B8E9
		jmp	short loc_40B80C
; ---------------------------------------------------------------------------

loc_40B80B:				; CODE XREF: sub_40B6EE+F3j
		nop

loc_40B80C:				; CODE XREF: sub_40B6EE+11Bj
		mov	[ebp+var_14], 0
		jmp	short loc_40B840
; ---------------------------------------------------------------------------

loc_40B815:				; CODE XREF: sub_40B6EE+15Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_40980A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40B8EC
		add	[ebp+var_14], 1

loc_40B840:				; CODE XREF: sub_40B6EE+125j
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40B815
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_4298BC
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_40B870
		call	sub_4092EF
		mov	[ebp+var_10], eax
		jmp	loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B870:				; CODE XREF: sub_40B6EE+173j
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_42975A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40B8EF
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40B8B2
		call	sub_4092EF
		mov	[ebp+var_10], eax
		jmp	short loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B8B2:				; CODE XREF: sub_40B6EE+1B8j
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_40951D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40B8F2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		jmp	short loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B8E6:				; CODE XREF: sub_40B6EE+D4j
		nop
		jmp	short loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B8E9:				; CODE XREF: sub_40B6EE+115j
		nop
		jmp	short loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B8EC:				; CODE XREF: sub_40B6EE+148j
		nop
		jmp	short loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B8EF:				; CODE XREF: sub_40B6EE+1A4j
		nop
		jmp	short loc_40B8F3
; ---------------------------------------------------------------------------

loc_40B8F2:				; CODE XREF: sub_40B6EE+1E4j
		nop

loc_40B8F3:				; CODE XREF: sub_40B6EE+7Bj
					; sub_40B6EE+B6j ...
		cmp	[ebp+var_18], 0
		jz	short loc_40B904
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_4291C4

loc_40B904:				; CODE XREF: sub_40B6EE+209j
		cmp	[ebp+var_10], 0
		jz	short loc_40B915
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_40B915:				; CODE XREF: sub_40B6EE+21Aj
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40B6EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B91A	proc near		; CODE XREF: .text:0040C37Cp
					; .text:0040C67Bp

var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	[ebp+var_3C], 0
		mov	[ebp+var_40], 0
		mov	[ebp+var_48], 0
		mov	[ebp+var_4C], 0
		lea	eax, [ebp+var_40]
		mov	[esp+98h+var_94], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+var_98], eax
		call	sub_40B1B3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40BA77
		mov	eax, [ebp+var_40]
		lea	edx, [ebp+var_38]
		mov	[esp+98h+var_90], edx ;	int
		mov	[esp+98h+var_94], eax ;	char *
		mov	[esp+98h+var_98], 0 ; char *
		call	sub_40B271
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40BA7A
		lea	eax, [ebp+var_48]
		mov	[esp+98h+var_5C], eax
		lea	eax, [ebp+var_44]
		mov	[esp+98h+var_60], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+98h+var_64], eax
		mov	[esp+98h+var_68], 0
		mov	eax, [ebp+var_38]
		mov	[esp+98h+var_94], eax
		mov	eax, [ebp+var_34]
		mov	[esp+98h+var_90], eax
		mov	eax, [ebp+var_30]
		mov	[esp+98h+var_8C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+98h+var_88], eax
		mov	eax, [ebp+var_28]
		mov	[esp+98h+var_84], eax
		mov	eax, [ebp+var_24]
		mov	[esp+98h+var_80], eax
		mov	eax, [ebp+var_20]
		mov	[esp+98h+var_7C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+98h+var_78], eax
		mov	eax, [ebp+var_18]
		mov	[esp+98h+var_74], eax
		mov	eax, [ebp+var_14]
		mov	[esp+98h+var_70], eax
		mov	eax, [ebp+var_10]
		mov	[esp+98h+var_6C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+var_98], eax
		call	sub_40ACF4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BA7D
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_44]
		mov	[esp+98h+var_88], edx ;	int
		mov	[esp+98h+var_8C], eax ;	char *
		lea	eax, [ebp+var_38]
		mov	[esp+98h+var_90], eax ;	int
		lea	eax, [ebp+var_50]
		mov	[esp+98h+var_94], eax ;	int
		lea	eax, [ebp+var_4C]
		mov	[esp+98h+var_98], eax ;	int
		call	sub_40B6EE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BA80
		mov	edx, [ebp+var_50]
		mov	eax, [ebp+var_4C]
		mov	[esp+98h+var_90], edx
		mov	[esp+98h+var_94], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+var_98], eax
		call	sub_4096C8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BA83
		cmp	[ebp+arg_8], 0
		jz	short loc_40BA60
		mov	eax, [ebp+arg_8]
		jmp	short loc_40BA63
; ---------------------------------------------------------------------------

loc_40BA60:				; CODE XREF: sub_40B91A+13Fj
		mov	eax, [ebp+var_48]

loc_40BA63:				; CODE XREF: sub_40B91A+144j
		mov	[esp+98h+var_94], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+var_98], eax
		call	sub_40970D
		mov	[ebp+var_C], eax
		jmp	short loc_40BA84
; ---------------------------------------------------------------------------

loc_40BA77:				; CODE XREF: sub_40B91A+3Ej
		nop
		jmp	short loc_40BA84
; ---------------------------------------------------------------------------

loc_40BA7A:				; CODE XREF: sub_40B91A+65j
		nop
		jmp	short loc_40BA84
; ---------------------------------------------------------------------------

loc_40BA7D:				; CODE XREF: sub_40B91A+E7j
		nop
		jmp	short loc_40BA84
; ---------------------------------------------------------------------------

loc_40BA80:				; CODE XREF: sub_40B91A+117j
		nop
		jmp	short loc_40BA84
; ---------------------------------------------------------------------------

loc_40BA83:				; CODE XREF: sub_40B91A+139j
		nop

loc_40BA84:				; CODE XREF: sub_40B91A+15Bj
					; sub_40B91A+15Ej ...
		mov	eax, [ebp+var_3C]
		mov	[esp+98h+var_98], eax
		call	sub_40A580
		mov	eax, [ebp+var_44]
		mov	[esp+98h+var_98], eax
		call	gcry_free
		mov	eax, [ebp+var_48]
		mov	[esp+98h+var_98], eax
		call	gcry_free
		mov	eax, [ebp+var_40]
		mov	[esp+98h+var_98], eax
		call	gcry_free
		mov	eax, [ebp+var_4C]
		mov	[esp+98h+var_98], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40B91A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BAC0	proc near		; CODE XREF: .text:0040CDABp
					; .text:0040D7F7p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0
		mov	eax, offset aR_1 ; "r+"
		mov	[esp+38h+var_20], eax
		mov	[esp+38h+var_24], 0
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 1
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], 0
		call	sub_4285F8
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40BB1D
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_40BB95
; ---------------------------------------------------------------------------

loc_40BB1D:				; CODE XREF: sub_40BAC0+51j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_40957B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BB91
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_42975A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BB94
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_28], eax
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_40B3AB
		mov	[ebp+var_C], eax
		jmp	short loc_40BB95
; ---------------------------------------------------------------------------

loc_40BB91:				; CODE XREF: sub_40BAC0+7Dj
		nop
		jmp	short loc_40BB95
; ---------------------------------------------------------------------------

loc_40BB94:				; CODE XREF: sub_40BAC0+A1j
		nop

loc_40BB95:				; CODE XREF: sub_40BAC0+5Bj
					; sub_40BAC0+CFj ...
		cmp	[ebp+var_10], 0
		jz	short loc_40BBA6
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_4291C4

loc_40BBA6:				; CODE XREF: sub_40BAC0+D9j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40BAC0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BBAB	proc near		; CODE XREF: sub_40BD27+28Fp
					; .text:0040CE94p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_pk_get_keygrip
		test	eax, eax
		jnz	short loc_40BBEE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_pk_testkey
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BBE9
		mov	[esp+28h+var_28], 3Fh
		call	sub_4092C7
		jmp	short loc_40BBEC
; ---------------------------------------------------------------------------

loc_40BBE9:				; CODE XREF: sub_40BBAB+2Ej
		mov	eax, [ebp+var_C]

loc_40BBEC:				; CODE XREF: sub_40BBAB+3Cj
		jmp	short locret_40BBF3
; ---------------------------------------------------------------------------

loc_40BBEE:				; CODE XREF: sub_40BBAB+1Aj
		mov	eax, 0

locret_40BBF3:				; CODE XREF: sub_40BBAB:loc_40BBECj
		leave
		retn
sub_40BBAB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BBF5	proc near		; CODE XREF: .text:0040C642p

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h
arg_2C		= dword	ptr  34h
arg_30		= dword	ptr  38h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		lea	eax, [ebp+var_14]
		mov	[esp+68h+var_2C], eax
		lea	eax, [ebp+var_10]
		mov	[esp+68h+var_30], eax
		lea	eax, [ebp+var_18]
		mov	[esp+68h+var_34], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+68h+var_38], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+var_5C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+68h+var_58], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+68h+var_54], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+68h+var_50], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+68h+var_4C], eax
		mov	eax, [ebp+arg_20]
		mov	[esp+68h+var_48], eax
		mov	eax, [ebp+arg_24]
		mov	[esp+68h+var_44], eax
		mov	eax, [ebp+arg_28]
		mov	[esp+68h+var_40], eax
		mov	eax, [ebp+arg_2C]
		mov	[esp+68h+var_3C], eax
		mov	eax, [ebp+arg_30]
		mov	[esp+68h+var_68], eax
		call	sub_40ACF4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BD00
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_2C], ecx
		mov	[esp+68h+var_30], edx
		mov	[esp+68h+var_34], eax
		mov	[esp+68h+var_38], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+var_64], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+var_5C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+68h+var_58], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+68h+var_54], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+68h+var_50], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+68h+var_4C], eax
		mov	eax, [ebp+arg_20]
		mov	[esp+68h+var_48], eax
		mov	eax, [ebp+arg_24]
		mov	[esp+68h+var_44], eax
		mov	eax, [ebp+arg_28]
		mov	[esp+68h+var_40], eax
		mov	eax, [ebp+arg_2C]
		mov	[esp+68h+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_40AA39
		mov	[ebp+var_C], eax
		jmp	short loc_40BD01
; ---------------------------------------------------------------------------

loc_40BD00:				; CODE XREF: sub_40BBF5+8Fj
		nop

loc_40BD01:				; CODE XREF: sub_40BBF5+109j
		mov	eax, [ebp+var_18]
		mov	[esp+68h+var_68], eax
		call	sub_40A580
		mov	eax, [ebp+var_14]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40BBF5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BD27	proc near		; CODE XREF: .text:0040C35Fp

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
Str		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	dword ptr [ebp+var_1C],	0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_8], 0
		jz	short loc_40BD4D
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_40BD4D:				; CODE XREF: sub_40BD27+1Bj
		lea	eax, [ebp+var_18]
		mov	[esp+58h+Size],	eax ; int
		mov	[esp+58h+var_54], offset aAuthkeyid ; "$AUTHKEYID"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_41BE04
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_4092E2
		cmp	eax, 6Eh
		jnz	loc_40BE07
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_41AF53
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40BDCF
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_40BDC7
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+58h+var_58], offset aErrorGettingSe ; "error getting serial number	of card: %s"...
		call	sub_435294
		mov	[esp+58h+var_54], ebx ;	char
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_435B53

loc_40BDC7:				; CODE XREF: sub_40BD27+79j
		mov	eax, [ebp+var_C]
		jmp	loc_40C2B4
; ---------------------------------------------------------------------------

loc_40BDCF:				; CODE XREF: sub_40BD27+70j
		mov	ebx, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], offset aDetectedCardWi ; "detected card with S/N: %s\n"
		call	sub_435294
		mov	[esp+58h+var_54], ebx ;	char
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_435B53
		lea	eax, [ebp+var_18]
		mov	[esp+58h+Size],	eax ; int
		mov	[esp+58h+var_54], offset aAuthkeyid ; "$AUTHKEYID"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_41BE04
		mov	[ebp+var_C], eax

loc_40BE07:				; CODE XREF: sub_40BD27+51j
		cmp	[ebp+var_C], 0
		jz	short loc_40BE45
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+58h+var_58], offset aErrorGettingDe ; "error getting default authentication ke"...
		call	sub_435294
		mov	[esp+58h+var_54], ebx ;	char
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_435B7D
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_40C2B4
; ---------------------------------------------------------------------------

loc_40BE45:				; CODE XREF: sub_40BD27+E4j
		mov	eax, dword ptr [ebp+var_1C]
		test	eax, eax
		jnz	short loc_40BEA7
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+Size],	eax ; int
		mov	[esp+58h+var_54], offset aSerialno ; "SERIALNO"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_41BE04
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40BEA7
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+58h+var_58], offset aErrorGettingSe ; "error getting serial number	of card: %s"...
		call	sub_435294
		mov	[esp+58h+var_54], ebx ;	char
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_435B7D
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_40C2B4
; ---------------------------------------------------------------------------

loc_40BEA7:				; CODE XREF: sub_40BD27+123j
					; sub_40BD27+146j
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+Str]
		mov	[esp+58h+Size],	edx
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_41BB7D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40BF15
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_40BEF7
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+58h+var_58], offset aNoSuitableCard ; "no suitable	card key found:	%s\n"
		call	sub_435294
		mov	[esp+58h+var_54], ebx ;	char
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_435B53

loc_40BEF7:				; CODE XREF: sub_40BD27+1A9j
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_40C2B4
; ---------------------------------------------------------------------------

loc_40BF15:				; CODE XREF: sub_40BD27+1A0j
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+var_54], 0
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_10], eax
		mov	eax, [ebp+Str]
		mov	edx, [ebp+var_10]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+Size],	eax
		mov	[esp+58h+var_54], 0
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40BFA9
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aFailedToBuildS ; "failed to build S-Exp from received	car"...
		call	sub_435B7D
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_40C2B4
; ---------------------------------------------------------------------------

loc_40BFA9:				; CODE XREF: sub_40BD27+23Cj
		mov	eax, [ebp+var_24]
		lea	edx, [ebp+var_38]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	sub_40BBAB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C013
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gcry_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aErrorComputing ; "error computing keygrip from received c"...
		call	sub_435C1A
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_release
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_40C2B4
; ---------------------------------------------------------------------------

loc_40C013:				; CODE XREF: sub_40BD27+29Bj
		lea	eax, [ebp+var_38]
		mov	[esp+58h+var_58], eax
		call	sub_413151
		test	eax, eax
		jz	loc_40C1DF
		mov	edx, [ebp+var_18]
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	sub_41738E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40C07D
		call	sub_4092EF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_release
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_40C2B4
; ---------------------------------------------------------------------------

loc_40C07D:				; CODE XREF: sub_40BD27+318j
		mov	eax, [ebp+Str]
		lea	edx, [ebp+var_3C]
		mov	[esp+58h+Size],	edx ; int
		mov	edx, [ebp+var_14]
		mov	[esp+58h+var_54], edx ;	void *
		mov	[esp+58h+var_58], eax ;	int
		call	sub_417585
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_40C103
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+58h+var_58], offset aShadowingTheKe ; "shadowing the key failed: %s\n"
		call	sub_435294
		mov	[esp+58h+var_54], ebx ;	char
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_435B7D
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_release
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_40C2B4
; ---------------------------------------------------------------------------

loc_40C103:				; CODE XREF: sub_40BD27+381j
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_3C]
		mov	[ebp+Str], eax
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+var_54], 0
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40C15C
		mov	[esp+58h+Size],	897h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/agent/command-ssh.c"
		mov	[esp+58h+var_58], offset aPkbuflen ; "pkbuflen"
		call	sub_43BB20

loc_40C15C:				; CODE XREF: sub_40BD27+417j
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_4C], 0 ; int
		mov	edx, [ebp+var_10]
		mov	[esp+58h+Size],	edx ; Size
		mov	[esp+58h+var_54], eax ;	Str
		lea	eax, [ebp+var_38]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_4118C7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C1DF
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+58h+var_58], offset aErrorWritingKe ; "error writing key: %s\n"
		call	sub_435294
		mov	[esp+58h+var_54], ebx ;	char
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_435B7D
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_release
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_40C2B4
; ---------------------------------------------------------------------------

loc_40C1DF:				; CODE XREF: sub_40BD27+2F9j
					; sub_40BD27+45Dj
		cmp	[ebp+arg_8], 0
		jz	loc_40C286
		lea	eax, [ebp+var_40]
		mov	[esp+58h+Size],	eax ; int
		mov	[esp+58h+var_54], offset aDispserialno ; "$DISPSERIALNO"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_41BE04
		test	eax, eax
		jnz	short loc_40C22C
		mov	eax, [ebp+var_40]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+var_58], offset aCardnoS ; "cardno:%s"
		call	sub_4256F5
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_40]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		jmp	short loc_40C244
; ---------------------------------------------------------------------------

loc_40C22C:				; CODE XREF: sub_40BD27+4DEj
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+var_58], offset aCardnoS ; "cardno:%s"
		call	sub_4256F5
		mov	edx, [ebp+arg_8]
		mov	[edx], eax

loc_40C244:				; CODE XREF: sub_40BD27+503j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40C286
		call	sub_4092EF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	gcry_sexp_release
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_40C2B4
; ---------------------------------------------------------------------------

loc_40C286:				; CODE XREF: sub_40BD27+4BCj
					; sub_40BD27+524j
		mov	eax, [ebp+Str]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

loc_40C2B4:				; CODE XREF: sub_40BD27+A3j
					; sub_40BD27+119j ...
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_40BD27	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-60h], 0
		mov	dword ptr [ebp-58h], 0
		mov	dword ptr [ebp-5Ch], 0
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-14h], 0
		mov	eax, offset aRB	; "r+b"
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 0
		call	sub_4285F8
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0
		jnz	short loc_40C342
		call	sub_4092EF
		mov	[ebp-14h], eax
		jmp	loc_40C700
; ---------------------------------------------------------------------------

loc_40C342:				; CODE XREF: .text:0040C333j
		mov	eax, ds:dword_449DD4
		test	eax, eax
		jnz	short loc_40C3AF
		lea	eax, [ebp-64h]
		mov	[esp+8], eax
		lea	eax, [ebp-5Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40BD27
		test	eax, eax
		jnz	short loc_40C3AF
		mov	edx, [ebp-64h]
		mov	eax, [ebp-5Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_40B91A
		mov	[ebp-14h], eax
		mov	eax, [ebp-5Ch]
		mov	[esp], eax
		call	gcry_sexp_release
		mov	dword ptr [ebp-5Ch], 0
		mov	eax, [ebp-64h]
		mov	[esp], eax
		call	gcry_free
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_40C6F0
		add	dword ptr [ebp-10h], 1

loc_40C3AF:				; CODE XREF: .text:0040C349j
					; .text:0040C366j
		mov	eax, ds:dword_449DB4
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aPrivateKeysV_1 ; "private-keys-v1.d"
		mov	[esp], eax
		call	sub_432667
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_40C3E2
		call	gpg_err_code_from_syserror
		mov	[ebp-14h], eax
		jmp	loc_40C700
; ---------------------------------------------------------------------------

loc_40C3E2:				; CODE XREF: .text:0040C3D3j
		mov	eax, [ebp-20h]
		mov	dword ptr [ebp-7Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-7Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 2Eh
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40C42D
		call	gpg_err_code_from_syserror
		mov	[ebp-14h], eax
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	gcry_free
		jmp	loc_40C700
; ---------------------------------------------------------------------------

loc_40C42D:				; CODE XREF: .text:0040C413j
		mov	eax, [ebp-20h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_433245
		mov	word ptr [eax],	2Fh
		add	eax, 1
		mov	[ebp-24h], eax
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	gcry_free
		mov	dword ptr [esp+4], 0
		lea	eax, [ebp-60h]
		mov	[esp], eax
		call	sub_409A11
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	loc_40C6A1
		jmp	loc_40C700
; ---------------------------------------------------------------------------

loc_40C47A:				; CODE XREF: .text:0040C6B5j
		mov	eax, [ebp-60h]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_40C6A4
		mov	eax, [ebp-60h]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	loc_40C6A7
		mov	eax, [ebp-60h]
		add	eax, 1Ch
		mov	dword ptr [ebp-7Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-7Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 28h
		jz	short loc_40C4D9
		mov	dword ptr [esp+8], 925h
		mov	dword ptr [esp+4], offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/agent/command-ssh.c"
		mov	dword ptr [esp], offset	aStrlenCfItem_h	; "strlen (cf->item.hexgrip) ==	40"
		call	sub_43BB20

loc_40C4D9:				; CODE XREF: .text:0040C4BBj
		mov	eax, [ebp-60h]
		add	eax, 1Ch
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	sub_433245
		mov	dword ptr [eax], 79656B2Eh
		mov	byte ptr [eax+4], 0
		lea	eax, [ebp-6Ch]
		mov	[esp+8], eax
		lea	eax, [ebp-68h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_40990D
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40C557
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gpg_strerror
		mov	edx, [ebp-60h]
		lea	ebx, [edx+1Ch]
		mov	edx, [ebp-60h]
		mov	ecx, [edx+8]
		mov	edx, [ebp-60h]
		mov	edx, [edx]
		mov	[esp+10h], eax
		mov	[esp+0Ch], ebx
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aSDKeySSkippedS	; "%s:%d: key '%s' skipped: %s\n"
		call	sub_435B7D
		jmp	loc_40C6A8
; ---------------------------------------------------------------------------

loc_40C557:				; CODE XREF: .text:0040C518j
		mov	edx, [ebp-6Ch]
		mov	eax, [ebp-68h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		lea	eax, [ebp-58h]
		mov	[esp], eax
		call	gcry_sexp_sscan
		mov	[ebp-14h], eax
		mov	eax, [ebp-68h]
		mov	[esp], eax
		call	gcry_free
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_40C6F3
		mov	dword ptr [ebp-70h], 0
		mov	eax, [ebp-58h]
		lea	edx, [ebp-70h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40B1B3
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_40C6F6
		mov	eax, [ebp-70h]
		lea	edx, [ebp-54h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_40B271
		mov	[ebp-14h], eax
		mov	eax, [ebp-70h]
		mov	[esp], eax
		call	gcry_free
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_40C6F9
		mov	eax, [ebp-58h]
		mov	[esp+30h], eax
		mov	eax, [ebp-54h]
		mov	[esp+4], eax
		mov	eax, [ebp-50h]
		mov	[esp+8], eax
		mov	eax, [ebp-4Ch]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-48h]
		mov	[esp+10h], eax
		mov	eax, [ebp-44h]
		mov	[esp+14h], eax
		mov	eax, [ebp-40h]
		mov	[esp+18h], eax
		mov	eax, [ebp-3Ch]
		mov	[esp+1Ch], eax
		mov	eax, [ebp-38h]
		mov	[esp+20h], eax
		mov	eax, [ebp-34h]
		mov	[esp+24h], eax
		mov	eax, [ebp-30h]
		mov	[esp+28h], eax
		mov	eax, [ebp-2Ch]
		mov	[esp+2Ch], eax
		lea	eax, [ebp-5Ch]
		mov	[esp], eax
		call	sub_40BBF5
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_40C6FC
		mov	eax, [ebp-58h]
		mov	[esp], eax
		call	gcry_sexp_release
		mov	dword ptr [ebp-58h], 0
		mov	eax, [ebp-5Ch]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_40B91A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_40C6FF
		mov	eax, [ebp-5Ch]
		mov	[esp], eax
		call	gcry_sexp_release
		mov	dword ptr [ebp-5Ch], 0
		add	dword ptr [ebp-10h], 1
		jmp	short loc_40C6A8
; ---------------------------------------------------------------------------

loc_40C6A1:				; CODE XREF: .text:0040C46Fj
		nop
		jmp	short loc_40C6A8
; ---------------------------------------------------------------------------

loc_40C6A4:				; CODE XREF: .text:0040C482j
		nop
		jmp	short loc_40C6A8
; ---------------------------------------------------------------------------

loc_40C6A7:				; CODE XREF: .text:0040C490j
		nop

loc_40C6A8:				; CODE XREF: .text:0040C552j
					; .text:0040C69Fj ...
		mov	eax, [ebp-60h]
		mov	[esp], eax
		call	sub_409C73
		test	eax, eax
		jz	loc_40C47A
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_42975A
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-28h], 0
		jz	short loc_40C700
		call	sub_4092EF
		mov	[ebp-14h], eax
		jmp	short loc_40C700
; ---------------------------------------------------------------------------

loc_40C6F0:				; CODE XREF: .text:0040C3A5j
		nop
		jmp	short loc_40C700
; ---------------------------------------------------------------------------

loc_40C6F3:				; CODE XREF: .text:0040C58Aj
		nop
		jmp	short loc_40C700
; ---------------------------------------------------------------------------

loc_40C6F6:				; CODE XREF: .text:0040C5B0j
		nop
		jmp	short loc_40C700
; ---------------------------------------------------------------------------

loc_40C6F9:				; CODE XREF: .text:0040C5E2j
		nop
		jmp	short loc_40C700
; ---------------------------------------------------------------------------

loc_40C6FC:				; CODE XREF: .text:0040C64Ej
		nop
		jmp	short loc_40C700
; ---------------------------------------------------------------------------

loc_40C6FF:				; CODE XREF: .text:0040C687j
		nop

loc_40C700:				; CODE XREF: .text:0040C33Dj
					; .text:0040C3DDj ...
		mov	eax, [ebp-58h]
		mov	[esp], eax
		call	gcry_sexp_release
		mov	eax, [ebp-5Ch]
		mov	[esp], eax
		call	gcry_sexp_release
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_40C76A
		mov	dword ptr [esp+4], 0Ch
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40C74D
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4094B5
		mov	[ebp-18h], eax

loc_40C74D:				; CODE XREF: .text:0040C736j
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40C780
		mov	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_409870
		mov	[ebp-18h], eax
		jmp	short loc_40C780
; ---------------------------------------------------------------------------

loc_40C76A:				; CODE XREF: .text:0040C71Aj
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-18h], eax

loc_40C780:				; CODE XREF: .text:0040C751j
					; .text:0040C768j
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_4291C4
		mov	eax, [ebp-60h]
		mov	[esp], eax
		call	sub_409C3C
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-18h]
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C7AE	proc near		; CODE XREF: .text:0040CE72p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_18], eax
		call	gcry_md_hash_buffer
		mov	eax, 0
		leave
		retn
sub_40C7AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C7DB	proc near		; CODE XREF: .text:0040CF50p

var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_9C		= dword	ptr -9Ch
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_81		= byte ptr -81h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0BCh
		mov	[ebp+var_58], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_3C], 0
		mov	[ebp+var_2C], 0
		mov	[ebp+var_40], 0
		mov	[ebp+var_34], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+78h]
		test	eax, eax
		jnz	short loc_40C84F
		mov	[esp+0C8h+var_C8], 11h
		call	sub_4092C7
		mov	[ebp+var_1C], eax
		jmp	loc_40CCCC
; ---------------------------------------------------------------------------

loc_40C84F:				; CODE XREF: sub_40C7DB+5Ej
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+64h]
		lea	eax, [ebp+var_81]
		mov	[esp+0C8h+var_C0], eax
		mov	[esp+0C8h+var_C4], 14h
		mov	[esp+0C8h+var_C8], edx
		call	sub_424BE8
		lea	eax, [ebp+var_81]
		mov	[esp+0C8h+var_C8], eax ; char *
		call	sub_40A363
		test	eax, eax
		jz	loc_40C9E3
		mov	[ebp+var_38], 0
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+64h]
		lea	eax, [ebp+var_88]
		mov	[esp+0C8h+var_C0], eax
		mov	[esp+0C8h+var_C4], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+var_C8], eax
		call	sub_4129BE
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_40CCB6
		mov	eax, [ebp+var_88]
		mov	[esp+0C8h+var_C0], 4
		lea	edx, [ebp+var_8C]
		mov	[esp+0C8h+var_C4], edx
		mov	[esp+0C8h+var_C8], eax
		call	sub_425664
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40C929
		mov	eax, [ebp+var_88]
		mov	[esp+0C8h+var_C0], 0
		mov	[esp+0C8h+var_C4], offset aComment ; "comment"
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jz	short loc_40C91E
		mov	[esp+0C8h+var_C4], 1
		mov	eax, [ebp+var_44]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_nth_string
		mov	[ebp+var_38], eax

loc_40C91E:				; CODE XREF: sub_40C7DB+12Bj
		mov	eax, [ebp+var_44]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_release

loc_40C929:				; CODE XREF: sub_40C7DB+104j
		mov	eax, [ebp+var_88]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_release
		cmp	[ebp+var_1C], 0
		jnz	loc_40CCB9
		cmp	[ebp+var_38], 0
		jz	short loc_40C94C
		mov	ebx, [ebp+var_38]
		jmp	short loc_40C951
; ---------------------------------------------------------------------------

loc_40C94C:				; CODE XREF: sub_40C7DB+16Aj
		mov	ebx, offset dword_44254C

loc_40C951:				; CODE XREF: sub_40C7DB+16Fj
		mov	esi, [ebp+var_8C]
		mov	[esp+0C8h+var_C8], offset aAnSshProcessRe ; "An	ssh process requested the use of key"...
		call	sub_435294
		mov	[esp+0C8h+var_C0], ebx
		mov	[esp+0C8h+var_C4], esi
		mov	[esp+0C8h+var_C8], eax
		call	sub_4256F5
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_8C]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_free
		mov	eax, [ebp+var_38]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_free
		mov	[esp+0C8h+var_C8], offset aDeny	; "Deny"
		call	sub_435294
		mov	ebx, eax
		mov	[esp+0C8h+var_C8], offset aAllow ; "Allow"
		call	sub_435294
		mov	[esp+0C8h+var_B8], 0
		mov	[esp+0C8h+var_BC], ebx
		mov	[esp+0C8h+var_C0], eax
		mov	eax, [ebp+var_48]
		mov	[esp+0C8h+var_C4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+var_C8], eax
		call	sub_4105B0
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_48]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jnz	loc_40CCBC

loc_40C9E3:				; CODE XREF: sub_40C7DB+A4j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+7Ch], 1
		mov	[esp+0C8h+var_C8], offset aPleaseEnterThe ; "Please enter the passphrase for the ssh"...
		call	sub_435294
		mov	[esp+0C8h+var_B8], offset sub_40A2BF
		mov	[esp+0C8h+var_BC], 4
		lea	edx, [ebp+var_58]
		mov	[esp+0C8h+var_C0], edx
		mov	[esp+0C8h+var_C4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+var_C8], eax
		call	sub_4136B7
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+7Ch], 0
		cmp	[ebp+var_1C], 0
		jnz	loc_40CCBF
		mov	eax, [ebp+var_58]
		mov	[esp+0C8h+var_C4], 1
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_nth
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40CA66
		mov	[esp+0C8h+var_C8], 53h
		call	sub_4092C7
		mov	[ebp+var_1C], eax
		jmp	loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CA66:				; CODE XREF: sub_40C7DB+275j
		mov	eax, offset aR_1 ; "r+"
		mov	[esp+0C8h+var_B0], eax
		mov	[esp+0C8h+var_B4], 0
		mov	[esp+0C8h+var_B8], 0
		mov	[esp+0C8h+var_BC], 1
		mov	[esp+0C8h+var_C0], 0
		mov	[esp+0C8h+var_C4], 0
		mov	[esp+0C8h+var_C8], 0
		call	sub_4285F8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40CAB9
		call	sub_4092EF
		mov	[ebp+var_1C], eax
		jmp	loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CAB9:				; CODE XREF: sub_40C7DB+2CFj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+0C8h+var_C4], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+var_C8], eax
		call	sub_40970D
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_40CCC2
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_9C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		add	eax, 1
		mov	[esp+0C8h+var_C4], 4
		mov	[esp+0C8h+var_C8], eax
		call	gcry_calloc
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_40CB37
		call	sub_4092EF
		mov	[ebp+var_1C], eax
		jmp	loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CB37:				; CODE XREF: sub_40C7DB+34Dj
		mov	[ebp+var_30], 0
		jmp	loc_40CBD6
; ---------------------------------------------------------------------------

loc_40CB43:				; CODE XREF: sub_40C7DB+401j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		add	eax, [ebp+var_30]
		mov	[esp+0C8h+var_C0], 1
		mov	[esp+0C8h+var_C4], eax
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_40CB7D
		mov	[esp+0C8h+var_C8], 53h
		call	sub_4092C7
		mov	[ebp+var_1C], eax
		jmp	short loc_40CBE2
; ---------------------------------------------------------------------------

loc_40CB7D:				; CODE XREF: sub_40C7DB+38Fj
		mov	[esp+0C8h+var_C0], 5
		mov	[esp+0C8h+var_C4], 1
		mov	eax, [ebp+var_28]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_nth_mpi
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jnz	short loc_40CBB2
		mov	[esp+0C8h+var_C8], 3Fh
		call	sub_4092C7
		mov	[ebp+var_1C], eax
		jmp	short loc_40CBE2
; ---------------------------------------------------------------------------

loc_40CBB2:				; CODE XREF: sub_40C7DB+3C4j
		mov	eax, [ebp+var_28]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_release
		mov	[ebp+var_28], 0
		mov	eax, [ebp+var_30]
		shl	eax, 2
		add	eax, [ebp+var_34]
		mov	edx, [ebp+var_3C]
		mov	[eax], edx
		add	[ebp+var_30], 1

loc_40CBD6:				; CODE XREF: sub_40C7DB+363j
		mov	eax, [ebp+var_30]
		cmp	eax, [ebp+var_50]
		jb	loc_40CB43

loc_40CBE2:				; CODE XREF: sub_40C7DB+3A0j
					; sub_40C7DB+3D5j
		cmp	[ebp+var_1C], 0
		jnz	loc_40CCC5
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+1Ch]
		mov	eax, [ebp+var_34]
		mov	[esp+0C8h+var_C0], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+var_C4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+var_C8], eax
		call	edx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_40CCC8
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+var_C8], eax
		call	sub_4298BC
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0FFFFFFFFh
		jnz	short loc_40CC36
		call	sub_4092EF
		mov	[ebp+var_1C], eax
		jmp	loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CC36:				; CODE XREF: sub_40C7DB+44Cj
		mov	eax, [ebp+var_40]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_malloc
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_40CC54
		call	sub_4092EF
		mov	[ebp+var_1C], eax
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CC54:				; CODE XREF: sub_40C7DB+46Dj
		mov	[esp+0C8h+var_C0], 0
		mov	[esp+0C8h+var_C4], 0
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+var_C8], eax
		call	sub_42975A
		mov	[ebp+var_54], eax
		cmp	[ebp+var_54], 0
		jz	short loc_40CC82
		call	sub_4092EF
		mov	[ebp+var_1C], eax
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CC82:				; CODE XREF: sub_40C7DB+49Bj
		mov	eax, [ebp+var_40]
		mov	[esp+0C8h+var_C0], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+0C8h+var_C4], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+var_C8], eax
		call	sub_40951D
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40CCCB
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_2C]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_40]
		mov	[eax], edx
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CCB6:				; CODE XREF: sub_40C7DB+D7j
		nop
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CCB9:				; CODE XREF: sub_40C7DB+160j
		nop
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CCBC:				; CODE XREF: sub_40C7DB+202j
		nop
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CCBF:				; CODE XREF: sub_40C7DB+255j
		nop
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CCC2:				; CODE XREF: sub_40C7DB+2F9j
		nop
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CCC5:				; CODE XREF: sub_40C7DB+40Bj
		nop
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CCC8:				; CODE XREF: sub_40C7DB+434j
		nop
		jmp	short loc_40CCCC
; ---------------------------------------------------------------------------

loc_40CCCB:				; CODE XREF: sub_40C7DB+4C7j
		nop

loc_40CCCC:				; CODE XREF: sub_40C7DB+6Fj
					; sub_40C7DB+286j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_40CCDD
		mov	eax, [ebp+var_2C]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_free

loc_40CCDD:				; CODE XREF: sub_40C7DB+4F5j
		cmp	[ebp+var_20], 0
		jz	short loc_40CCEE
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+var_C8], eax ; void *
		call	sub_4291C4

loc_40CCEE:				; CODE XREF: sub_40C7DB+506j
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_58]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_28]
		mov	[esp+0C8h+var_C8], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_34]
		mov	[esp+0C8h+var_C8], eax
		call	sub_40A580
		mov	eax, [ebp+var_1C]
		add	esp, 0BCh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40C7DB	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0C8h
		mov	dword ptr [ebp-0A0h], 0
		mov	dword ptr [ebp-0A8h], 0
		mov	dword ptr [ebp-0ACh], 0
		mov	dword ptr [ebp-1Ch], 0
		lea	eax, [ebp-0A4h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-0A0h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4095C1
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40CF5A
		mov	edx, [ebp-0A4h]
		mov	eax, [ebp-0A0h]
		lea	ecx, [ebp-48h]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp-1Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40BAC0
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40CF5D
		lea	eax, [ebp-0B4h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-0A8h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4095C1
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40CF60
		lea	eax, [ebp-0B8h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40941E
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40CF63
		mov	eax, [ebp-24h]
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_40CE26
		mov	dword ptr [ebp-14h], 2

loc_40CE26:				; CODE XREF: .text:0040CE1Dj
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_md_get_algo_dlen
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40CE4E
		mov	dword ptr [esp], 3Fh
		call	sub_4092C7
		mov	[ebp-0Ch], eax
		jmp	loc_40CF6A
; ---------------------------------------------------------------------------

loc_40CE4E:				; CODE XREF: .text:0040CE38j
		mov	edx, [ebp-0B4h]
		mov	eax, [ebp-0A8h]
		lea	ecx, [ebp-88h]
		mov	[esp+0Ch], ecx
		mov	ecx, [ebp-14h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40C7AE
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40CF66
		mov	eax, [ebp-1Ch]
		lea	edx, [ebp-9Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40BBAB
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40CF69
		mov	eax, [ebp+8]
		mov	edx, [ebp-14h]
		mov	[eax+18h], edx
		lea	edx, [ebp-88h]
		mov	eax, [ebp+8]
		add	eax, 1Ch
		mov	ecx, [ebp-18h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	edx, [ebp-18h]
		mov	eax, [ebp+8]
		mov	[eax+5Ch], edx
		mov	eax, [ebp-20h]
		and	eax, 1
		test	al, al
		jz	short loc_40CEF0
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax+60h]
		and	edx, 0FFFFFFFEh
		mov	[eax+60h], dl
		jmp	short loc_40CEFD
; ---------------------------------------------------------------------------

loc_40CEF0:				; CODE XREF: .text:0040CEDFj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax+60h]
		or	edx, 1
		mov	[eax+60h], dl

loc_40CEFD:				; CODE XREF: .text:0040CEEEj
		mov	eax, [ebp+8]
		mov	dword ptr [eax+78h], 1
		mov	eax, [ebp+8]
		lea	edx, [eax+64h]
		lea	eax, [ebp-9Ch]
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		mov	ecx, [eax+8]
		mov	[edx+8], ecx
		mov	ecx, [eax+0Ch]
		mov	[edx+0Ch], ecx
		mov	eax, [eax+10h]
		mov	[edx+10h], eax
		lea	eax, [ebp-0B0h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-0ACh]
		mov	[esp+8], eax
		lea	eax, [ebp-48h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40C7DB
		mov	[ebp-0Ch], eax
		jmp	short loc_40CF6A
; ---------------------------------------------------------------------------

loc_40CF5A:				; CODE XREF: .text:0040CD84j
		nop
		jmp	short loc_40CF6A
; ---------------------------------------------------------------------------

loc_40CF5D:				; CODE XREF: .text:0040CDB7j
		nop
		jmp	short loc_40CF6A
; ---------------------------------------------------------------------------

loc_40CF60:				; CODE XREF: .text:0040CDEBj
		nop
		jmp	short loc_40CF6A
; ---------------------------------------------------------------------------

loc_40CF63:				; CODE XREF: .text:0040CE0Dj
		nop
		jmp	short loc_40CF6A
; ---------------------------------------------------------------------------

loc_40CF66:				; CODE XREF: .text:0040CE7Ej
		nop
		jmp	short loc_40CF6A
; ---------------------------------------------------------------------------

loc_40CF69:				; CODE XREF: .text:0040CEA0j
		nop

loc_40CF6A:				; CODE XREF: .text:0040CE49j
					; .text:0040CF58j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40CFB4
		mov	dword ptr [esp+4], 0Eh
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40CFD0
		mov	edx, [ebp-0B0h]
		mov	eax, [ebp-0ACh]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4096C8
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jmp	short loc_40CFD1
; ---------------------------------------------------------------------------

loc_40CFB4:				; CODE XREF: .text:0040CF6Ej
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jmp	short loc_40CFD1
; ---------------------------------------------------------------------------

loc_40CFD0:				; CODE XREF: .text:0040CF8Aj
		nop

loc_40CFD1:				; CODE XREF: .text:0040CFB2j
					; .text:0040CFCEj
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	gcry_sexp_release
		mov	eax, [ebp-0A0h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-0A8h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-0ACh]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D00B	proc near		; CODE XREF: sub_40D199+B7p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], offset aComment ; "comment"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40D046
		mov	[esp+38h+var_38], 53h
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_40D0AE
; ---------------------------------------------------------------------------

loc_40D046:				; CODE XREF: sub_40D00B+28j
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_nth_data
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40D07A
		mov	[esp+38h+var_38], 53h
		call	sub_4092C7
		mov	[ebp+var_C], eax
		jmp	short loc_40D0AE
; ---------------------------------------------------------------------------

loc_40D07A:				; CODE XREF: sub_40D00B+5Cj
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax ;	size_t
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_40933A
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40D09F
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_40D0AE
; ---------------------------------------------------------------------------

loc_40D09F:				; CODE XREF: sub_40D00B+88j
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_40D0AE:				; CODE XREF: sub_40D00B+39j
					; sub_40D00B+6Dj ...
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D00B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D0BE	proc near		; CODE XREF: sub_40D199+27Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_malloc_secure
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40D10F
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	short loc_40D153
; ---------------------------------------------------------------------------

loc_40D10F:				; CODE XREF: sub_40D0BE+45j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_sprint
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_415A18
		mov	[ebp+var_C], eax

loc_40D153:				; CODE XREF: sub_40D0BE+4Fj
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D0BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D163	proc near		; DATA XREF: sub_40D199+193o

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		add	eax, 24h
		mov	[esp+28h+Str2],	eax ; Str2
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D192
		mov	eax, 0
		jmp	short locret_40D197
; ---------------------------------------------------------------------------

loc_40D192:				; CODE XREF: sub_40D163+26j
		mov	eax, 0FFFFFFFFh

locret_40D197:				; CODE XREF: sub_40D163+2Dj
		leave
		retn
sub_40D163	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D199	proc near		; CODE XREF: .text:0040D74Ep

Dest		= dword	ptr -0A8h
Format		= dword	ptr -0A4h
Size		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
Str		= dword	ptr -74h
Source		= byte ptr -6Dh
var_44		= dword	ptr -44h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 0A0h
		mov	[ebp+Str], 0
		mov	[ebp+var_7C], 0
		mov	[esp+0A8h+Dest], offset	aPleaseReEnte_0	; "Please re-enter this	passphrase"
		call	sub_435294
		mov	[ebp+var_30], eax
		mov	[ebp+var_80], 0
		mov	[ebp+var_84], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+Dest], eax
		call	sub_40BBAB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40D4EF
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+Dest], eax
		call	sub_413151
		test	eax, eax
		jz	loc_40D4F2
		mov	[esp+0A8h+Size], 4
		lea	eax, [ebp+var_84]
		mov	[esp+0A8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+Dest], eax
		call	sub_425664
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40D4F5
		lea	eax, [ebp+var_80]
		mov	[esp+0A8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+Dest], eax
		call	sub_40D00B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40D4F8
		mov	eax, [ebp+var_80]
		test	eax, eax
		jz	short loc_40D26E
		mov	ebx, [ebp+var_80]
		jmp	short loc_40D273
; ---------------------------------------------------------------------------

loc_40D26E:				; CODE XREF: sub_40D199+CEj
		mov	ebx, offset dword_44254C

loc_40D273:				; CODE XREF: sub_40D199+D3j
		mov	esi, [ebp+var_84]
		mov	[esp+0A8h+Dest], offset	aPleaseEnterAPa	; "Please enter	a passphrase to	protect	th"...
		call	sub_435294
		mov	[esp+0A8h+var_9C], ebx
		mov	[esp+0A8h+Size], esi
		mov	[esp+0A8h+Format], eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0A8h+Dest], eax
		call	sub_424454
		test	eax, eax
		jns	short loc_40D2AD
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_40D505
; ---------------------------------------------------------------------------

loc_40D2AD:				; CODE XREF: sub_40D199+105j
		mov	[esp+0A8h+Format], 8Dh
		mov	[esp+0A8h+Dest], 1
		call	gcry_calloc_secure
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40D2D7
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_40D505
; ---------------------------------------------------------------------------

loc_40D2D7:				; CODE XREF: sub_40D199+12Fj
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+20h], 65h
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 1
		mov	[esp+0A8h+Format], 8Dh
		mov	[esp+0A8h+Dest], 1
		call	gcry_calloc_secure
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40D315
		call	sub_4092EF
		mov	[ebp+var_C], eax
		jmp	loc_40D505
; ---------------------------------------------------------------------------

loc_40D315:				; CODE XREF: sub_40D199+16Dj
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax+20h], 65h
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax+8], 1
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax+14h], offset sub_40D163
		mov	eax, [ebp+var_18]
		lea	edx, [eax+24h]
		mov	eax, [ebp+var_1C]
		mov	[eax+18h], edx

loc_40D33F:				; CODE XREF: sub_40D199+258j
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+var_90], 0 ; int
		mov	[esp+0A8h+var_94], 0 ; int
		mov	edx, [ebp+var_18]
		mov	[esp+0A8h+var_98], edx ; int
		mov	edx, [ebp+var_10]
		mov	[esp+0A8h+var_9C], edx ; int
		mov	[esp+0A8h+Size], 0 ; char *
		mov	[esp+0A8h+Format], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Dest], eax ; int
		call	sub_40F902
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		cmp	[ebp+var_C], 0
		jnz	loc_40D4FB
		mov	eax, [ebp+var_18]
		add	eax, 24h
		test	eax, eax
		jz	short loc_40D3F6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax+24h]
		test	al, al
		jz	short loc_40D3F6
		mov	[esp+0A8h+var_90], 0 ; int
		mov	[esp+0A8h+var_94], 0 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+var_98], eax ; int
		mov	[esp+0A8h+var_9C], 0 ; int
		mov	[esp+0A8h+Size], 0 ; char *
		mov	eax, [ebp+var_30]
		mov	[esp+0A8h+Format], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Dest], eax ; int
		call	sub_40F902
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40D3F6
		mov	[esp+0A8h+Dest], offset	aDoesNotMatch_0	; "does	not match - try	again"
		call	sub_435294
		mov	[ebp+var_10], eax
		jmp	loc_40D33F
; ---------------------------------------------------------------------------

loc_40D3F6:				; CODE XREF: sub_40D199+1FAj
					; sub_40D199+205j ...
		mov	eax, [ebp+var_18]
		lea	edx, [eax+24h]
		lea	eax, [ebp+var_78]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+Str]
		mov	[esp+0A8h+Size], eax
		mov	[esp+0A8h+Format], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+Dest], eax
		call	sub_40D0BE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40D4FE
		mov	edx, [ebp+var_78]
		mov	eax, [ebp+Str]
		mov	[esp+0A8h+var_9C], 0 ; int
		mov	[esp+0A8h+Size], edx ; Size
		mov	[esp+0A8h+Format], eax ; Str
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+Dest], eax ; int
		call	sub_4118C7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40D501
		mov	[ebp+var_14], 0
		jmp	short loc_40D48D
; ---------------------------------------------------------------------------

loc_40D45D:				; CODE XREF: sub_40D199+2F8j
		lea	eax, [ebp+var_44]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x ; "%02X"
		mov	ecx, [ebp+var_14]
		lea	ebx, [ecx+ecx]
		lea	ecx, [ebp+Source]
		add	ecx, ebx
		mov	[esp+0A8h+Size], edx
		mov	[esp+0A8h+Format], eax ; Format
		mov	[esp+0A8h+Dest], ecx ; Dest
		call	sprintf
		add	[ebp+var_14], 1

loc_40D48D:				; CODE XREF: sub_40D199+2C2j
		cmp	[ebp+var_14], 13h
		jbe	short loc_40D45D
		mov	eax, [ebp+var_18]
		lea	edx, [eax+24h]
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_9C], eax ; int
		mov	[esp+0A8h+Size], edx ; void *
		mov	[esp+0A8h+Format], 4 ; int
		lea	eax, [ebp+Source]
		mov	[esp+0A8h+Dest], eax ; Source
		call	sub_411372
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40D504
		mov	eax, [ebp+var_84]
		mov	edx, [ebp+arg_C]
		mov	[esp+0A8h+var_98], edx ; int
		mov	edx, [ebp+arg_8]
		mov	[esp+0A8h+var_9C], edx ; int
		mov	[esp+0A8h+Size], eax ; int
		lea	eax, [ebp+Source]
		mov	[esp+0A8h+Format], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Dest], eax ; int
		call	sub_40A173
		mov	[ebp+var_C], eax
		jmp	short loc_40D505
; ---------------------------------------------------------------------------

loc_40D4EF:				; CODE XREF: sub_40D199+67j
		nop
		jmp	short loc_40D505
; ---------------------------------------------------------------------------

loc_40D4F2:				; CODE XREF: sub_40D199+7Aj
		nop
		jmp	short loc_40D505
; ---------------------------------------------------------------------------

loc_40D4F5:				; CODE XREF: sub_40D199+A4j
		nop
		jmp	short loc_40D505
; ---------------------------------------------------------------------------

loc_40D4F8:				; CODE XREF: sub_40D199+C3j
		nop
		jmp	short loc_40D505
; ---------------------------------------------------------------------------

loc_40D4FB:				; CODE XREF: sub_40D199+1ECj
		nop
		jmp	short loc_40D505
; ---------------------------------------------------------------------------

loc_40D4FE:				; CODE XREF: sub_40D199+287j
		nop
		jmp	short loc_40D505
; ---------------------------------------------------------------------------

loc_40D501:				; CODE XREF: sub_40D199+2B5j
		nop
		jmp	short loc_40D505
; ---------------------------------------------------------------------------

loc_40D504:				; CODE XREF: sub_40D199+325j
		nop

loc_40D505:				; CODE XREF: sub_40D199+10Fj
					; sub_40D199+139j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_40D53D
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_40D53D
		mov	eax, [ebp+var_1C]
		add	eax, 24h
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+20h]
		mov	[ebp+var_24], eax
		jmp	short loc_40D537
; ---------------------------------------------------------------------------

loc_40D529:				; CODE XREF: sub_40D199+3A2j
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0
		add	[ebp+var_20], 1
		sub	[ebp+var_24], 1

loc_40D537:				; CODE XREF: sub_40D199+38Ej
		cmp	[ebp+var_24], 0
		jnz	short loc_40D529

loc_40D53D:				; CODE XREF: sub_40D199+370j
					; sub_40D199+37Aj
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+Dest], eax
		call	gcry_free
		cmp	[ebp+var_18], 0
		jz	short loc_40D580
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_40D580
		mov	eax, [ebp+var_18]
		add	eax, 24h
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	[ebp+var_2C], eax
		jmp	short loc_40D57A
; ---------------------------------------------------------------------------

loc_40D56C:				; CODE XREF: sub_40D199+3E5j
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0
		add	[ebp+var_28], 1
		sub	[ebp+var_2C], 1

loc_40D57A:				; CODE XREF: sub_40D199+3D1j
		cmp	[ebp+var_2C], 0
		jnz	short loc_40D56C

loc_40D580:				; CODE XREF: sub_40D199+3B3j
					; sub_40D199+3BDj
		mov	eax, [ebp+var_18]
		mov	[esp+0A8h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+Str]
		mov	[esp+0A8h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+var_80]
		mov	[esp+0A8h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+var_84]
		mov	[esp+0A8h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		add	esp, 0A0h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40D199	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D5C7	proc near		; CODE XREF: .text:0040D80Bp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_21		= byte ptr -21h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		lea	eax, [ebp+var_21]
		mov	edx, 15h
		mov	ecx, 0
		mov	ebx, eax
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_40D5ED
		mov	[eax], cl
		add	eax, 1
		sub	edx, 1

loc_40D5ED:				; CODE XREF: sub_40D5C7+1Cj
		mov	ebx, eax
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_40D5FF
		mov	[eax], cx
		add	eax, 2
		sub	edx, 2

loc_40D5FF:				; CODE XREF: sub_40D5C7+2Dj
		mov	esi, edx
		and	esi, 0FFFFFFFCh
		mov	ebx, 0

loc_40D609:				; CODE XREF: sub_40D5C7+4Aj
		mov	[eax+ebx], ecx
		add	ebx, 4
		cmp	ebx, esi
		jb	short loc_40D609
		add	eax, ebx
		mov	ebx, edx
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_40D624
		mov	[eax], cx
		add	eax, 2

loc_40D624:				; CODE XREF: sub_40D5C7+55j
		and	edx, 1
		test	edx, edx
		jz	short loc_40D630
		mov	[eax], cl
		add	eax, 1

loc_40D630:				; CODE XREF: sub_40D5C7+62j
		lea	eax, [ebp+var_21]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40BBAB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40D651
		mov	[ebp+var_D], 0
		jmp	short loc_40D652
; ---------------------------------------------------------------------------

loc_40D651:				; CODE XREF: sub_40D5C7+82j
		nop

loc_40D652:				; CODE XREF: sub_40D5C7+88j
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40D5C7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40B3AB
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_40D758

loc_40D6AE:				; CODE XREF: .text:loc_40D72Ej
		lea	eax, [ebp-1Dh]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_409380
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4092E2
		cmp	eax, 3FFFh
		jnz	short loc_40D6E5
		mov	dword ptr [ebp-10h], 0
		nop
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40D733
		jmp	short loc_40D759
; ---------------------------------------------------------------------------

loc_40D6E5:				; CODE XREF: .text:0040D6D3j
		movzx	eax, byte ptr [ebp-1Dh]
		movzx	eax, al
		cmp	eax, 1
		jz	short loc_40D6F8
		cmp	eax, 2
		jz	short loc_40D722
		jmp	short loc_40D72B
; ---------------------------------------------------------------------------

loc_40D6F8:				; CODE XREF: .text:0040D6EFj
		mov	dword ptr [ebp-24h], 0
		lea	eax, [ebp-24h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40941E
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40D72D
		mov	eax, [ebp-24h]
		mov	[ebp-18h], eax
		jmp	short loc_40D72D
; ---------------------------------------------------------------------------

loc_40D722:				; CODE XREF: .text:0040D6F4j
		mov	dword ptr [ebp-14h], 1
		jmp	short loc_40D72E
; ---------------------------------------------------------------------------

loc_40D72B:				; CODE XREF: .text:0040D6F6j
		jmp	short loc_40D72E
; ---------------------------------------------------------------------------

loc_40D72D:				; CODE XREF: .text:0040D718j
					; .text:0040D720j
		nop

loc_40D72E:				; CODE XREF: .text:0040D729j
					; .text:loc_40D72Bj
		jmp	loc_40D6AE
; ---------------------------------------------------------------------------

loc_40D733:				; CODE XREF: .text:0040D6E1j
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40D199
		mov	[ebp-10h], eax
		jmp	short loc_40D759
; ---------------------------------------------------------------------------

loc_40D758:				; CODE XREF: .text:0040D6A8j
		nop

loc_40D759:				; CODE XREF: .text:0040D6E3j
					; .text:0040D756j
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	gcry_sexp_release
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40D782
		mov	dword ptr [esp+4], 6
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax
		jmp	short loc_40D798
; ---------------------------------------------------------------------------

loc_40D782:				; CODE XREF: .text:0040D768j
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax

loc_40D798:				; CODE XREF: .text:0040D780j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-1Ch], 0
		lea	eax, [ebp-18h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4095C1
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40D815
		mov	edx, [ebp-18h]
		mov	eax, [ebp-14h]
		mov	dword ptr [esp+0Ch], 0
		lea	ecx, [ebp-1Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40BAC0
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40D818
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_40D5C7
		mov	[ebp-10h], eax
		jmp	short loc_40D819
; ---------------------------------------------------------------------------

loc_40D815:				; CODE XREF: .text:0040D7D9j
		nop
		jmp	short loc_40D819
; ---------------------------------------------------------------------------

loc_40D818:				; CODE XREF: .text:0040D803j
		nop

loc_40D819:				; CODE XREF: .text:0040D813j
					; .text:0040D816j
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	gcry_sexp_release
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40D84D
		mov	dword ptr [esp+4], 6
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax
		jmp	short loc_40D863
; ---------------------------------------------------------------------------

loc_40D84D:				; CODE XREF: .text:0040D833j
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax

loc_40D863:				; CODE XREF: .text:0040D84Bj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D868	proc near		; CODE XREF: .text:0040D880p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40D868	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40D868
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40D8A6
		mov	dword ptr [esp+4], 6
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax
		jmp	short loc_40D8BC
; ---------------------------------------------------------------------------

loc_40D8A6:				; CODE XREF: .text:0040D88Cj
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax

loc_40D8BC:				; CODE XREF: .text:0040D8A4j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D8C1	proc near		; CODE XREF: .text:0040D903p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], offset aSshAgentSLockC ; "ssh-agent's lock command is not impleme"...
		call	sub_435B7D
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D8C1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D8DF	proc near		; CODE XREF: .text:0040D94Ap

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], offset aSshAgentSUnloc ; "ssh-agent's unlock command is not imple"...
		call	sub_435B7D
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D8DF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40D8C1
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40D929
		mov	dword ptr [esp+4], 6
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax
		jmp	short loc_40D93F
; ---------------------------------------------------------------------------

loc_40D929:				; CODE XREF: .text:0040D90Fj
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax

loc_40D93F:				; CODE XREF: .text:0040D927j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40D8DF
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40D970
		mov	dword ptr [esp+4], 6
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax
		jmp	short loc_40D986
; ---------------------------------------------------------------------------

loc_40D970:				; CODE XREF: .text:0040D956j
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4093E0
		mov	[ebp-0Ch], eax

loc_40D986:				; CODE XREF: .text:0040D96Ej
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D98B	proc near		; CODE XREF: sub_40D9FB+90p
					; sub_40E084+AAp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		jmp	short loc_40D9B4
; ---------------------------------------------------------------------------

loc_40D99A:				; CODE XREF: sub_40D98B+2Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, offset dword_43D560
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, dword ptr [ebp+arg_0]
		jz	short loc_40D9BC
		add	[ebp+var_10], 1

loc_40D9B4:				; CODE XREF: sub_40D98B+Dj
		cmp	[ebp+var_10], 7
		jbe	short loc_40D99A
		jmp	short loc_40D9BD
; ---------------------------------------------------------------------------

loc_40D9BC:				; CODE XREF: sub_40D98B+23j
		nop

loc_40D9BD:				; CODE XREF: sub_40D98B+2Fj
		cmp	[ebp+var_10], 8
		jnz	short loc_40D9E8
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_40D9DF
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aSshRequestUIsN ; "ssh	request	%u is not supported\n"
		call	sub_435B53

loc_40D9DF:				; CODE XREF: sub_40D98B+3Fj
		mov	[ebp+var_C], 0
		jmp	short loc_40D9F6
; ---------------------------------------------------------------------------

loc_40D9E8:				; CODE XREF: sub_40D98B+36j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, offset dword_43D560
		mov	[ebp+var_C], eax

loc_40D9F6:				; CODE XREF: sub_40D98B+5Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D98B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D9FB	proc near		; CODE XREF: sub_40DF58+FBp

var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_19		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_2C], 0
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 0
		lea	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], eax
		mov	dword ptr [esp+58h+var_54], 1
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_4095C1
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_40DD75
		mov	eax, ds:dword_449DA4
		cmp	eax, 1
		jle	short loc_40DA68
		mov	eax, dword ptr [ebp+var_30]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aReceivedSshReq ; "received ssh request of length %u\n"
		call	sub_435B53

loc_40DA68:				; CODE XREF: sub_40D9FB+58j
		mov	eax, dword ptr [ebp+var_30]
		test	eax, eax
		jnz	short loc_40DA7B
		mov	[ebp+var_18], 1
		jmp	loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DA7B:				; CODE XREF: sub_40D9FB+72j
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		mov	[ebp+var_19], al
		movzx	eax, [ebp+var_19]
		mov	[esp+58h+var_58], eax
		call	sub_40D98B
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40DAA5
		mov	[ebp+var_18], 1
		jmp	loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DAA5:				; CODE XREF: sub_40D9FB+9Cj
		mov	eax, [ebp+var_20]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40DAF1
		mov	eax, offset aR_1 ; "r+"
		mov	[esp+58h+var_40], eax
		mov	[esp+58h+var_44], offset gcry_free
		mov	[esp+58h+var_48], offset sub_409304
		mov	[esp+58h+var_4C], 1
		mov	[esp+58h+var_50], 0
		mov	dword ptr [esp+58h+var_54], 0
		mov	[esp+58h+var_58], 0
		call	sub_4285F8
		mov	[ebp+var_10], eax
		jmp	short loc_40DB31
; ---------------------------------------------------------------------------

loc_40DAF1:				; CODE XREF: sub_40D9FB+B2j
		mov	eax, offset aR_1 ; "r+"
		mov	[esp+58h+var_40], eax
		mov	[esp+58h+var_44], offset gcry_free
		mov	[esp+58h+var_48], offset gcry_realloc
		mov	[esp+58h+var_4C], 1
		mov	[esp+58h+var_50], 0
		mov	dword ptr [esp+58h+var_54], 0
		mov	[esp+58h+var_58], 0
		call	sub_4285F8
		mov	[ebp+var_10], eax

loc_40DB31:				; CODE XREF: sub_40D9FB+F4j
		cmp	[ebp+var_10], 0
		jnz	short loc_40DB44
		call	sub_4092EF
		mov	[ebp+var_14], eax
		jmp	loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DB44:				; CODE XREF: sub_40D9FB+13Aj
		mov	[esp+58h+var_4C], 0 ; size_t
		mov	[esp+58h+var_50], 4 ; int
		mov	dword ptr [esp+58h+var_54], 0 ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_42ACFF
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_40DB7D
		call	sub_4092EF
		mov	[ebp+var_14], eax
		jmp	loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DB7D:				; CODE XREF: sub_40D9FB+173j
		mov	eax, dword ptr [ebp+var_30]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_40957B
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_40DD78
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_4299EA
		mov	eax, offset aR_1 ; "r+"
		mov	[esp+58h+var_40], eax
		mov	[esp+58h+var_44], 0
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], 1
		mov	[esp+58h+var_50], 0
		mov	dword ptr [esp+58h+var_54], 0
		mov	[esp+58h+var_58], 0
		call	sub_4285F8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40DC07
		call	sub_4092EF
		mov	[ebp+var_14], eax
		jmp	loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DC07:				; CODE XREF: sub_40D9FB+1FDj
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_40DC33
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aSshRequestHand ; "ssh	request	handler	for %s (%u) started"...
		call	sub_435B53

loc_40DC33:				; CODE XREF: sub_40D9FB+213j
		mov	eax, [ebp+var_20]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	edx
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_40DCB8
		cmp	[ebp+var_14], 0
		jz	short loc_40DC95
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	edx, [ebp+var_20]
		movzx	edx, byte ptr [edx]
		movzx	ecx, dl
		mov	edx, [ebp+var_20]
		mov	edx, [edx+8]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], ecx
		mov	dword ptr [esp+58h+var_54], edx	; char
		mov	[esp+58h+var_58], offset aSshRequestHa_0 ; "ssh	request	handler	for %s (%u) failed:"...
		call	sub_435B53
		jmp	short loc_40DCB8
; ---------------------------------------------------------------------------

loc_40DC95:				; CODE XREF: sub_40D9FB+264j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aSshRequestHa_1 ; "ssh	request	handler	for %s (%u) ready\n"
		call	sub_435B53

loc_40DCB8:				; CODE XREF: sub_40D9FB+25Ej
					; sub_40D9FB+298j
		cmp	[ebp+var_14], 0
		jz	short loc_40DCCA
		mov	[ebp+var_18], 1
		jmp	loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DCCA:				; CODE XREF: sub_40D9FB+2C1j
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_4298BC
		mov	dword ptr [ebp+var_28],	eax
		mov	eax, ds:dword_449DA4
		cmp	eax, 1
		jle	short loc_40DCF5
		mov	eax, dword ptr [ebp+var_28]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aSendingSshResp ; "sending ssh	response of length %u\n"
		call	sub_435B53

loc_40DCF5:				; CODE XREF: sub_40D9FB+2E5j
		mov	[esp+58h+var_50], 0
		mov	dword ptr [esp+58h+var_54], 0
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_42975A
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40DD22
		mov	[ebp+var_18], 1
		jmp	short loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DD22:				; CODE XREF: sub_40D9FB+31Cj
		mov	eax, dword ptr [ebp+var_28]
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_4094B5
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40DD46
		mov	[ebp+var_18], 1
		jmp	short loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DD46:				; CODE XREF: sub_40D9FB+340j
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_409870
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40DD7B
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_4296A3
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jmp	short loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DD75:				; CODE XREF: sub_40D9FB+4Aj
		nop
		jmp	short loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DD78:				; CODE XREF: sub_40D9FB+1A8j
		nop
		jmp	short loc_40DD7C
; ---------------------------------------------------------------------------

loc_40DD7B:				; CODE XREF: sub_40D9FB+364j
		nop

loc_40DD7C:				; CODE XREF: sub_40D9FB+7Bj
					; sub_40D9FB+A5j ...
		cmp	[ebp+var_14], 0
		jz	short loc_40DDAC
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_429481
		test	eax, eax
		jz	short loc_40DDAC
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aErrorOccuredWh ; "error occured while	processing request:"...
		call	sub_435B7D

loc_40DDAC:				; CODE XREF: sub_40D9FB+385j
					; sub_40D9FB+394j
		cmp	[ebp+var_18], 0
		jz	short loc_40DE01
		mov	eax, ds:dword_449DA4
		cmp	eax, 1
		jle	short loc_40DDC8
		mov	[esp+58h+var_58], offset aSendingSshErro ; "sending ssh	error response\n"
		call	sub_435B53

loc_40DDC8:				; CODE XREF: sub_40D9FB+3BFj
		mov	dword ptr [esp+58h+var_54], 1
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_4094B5
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40DE00
		mov	dword ptr [esp+58h+var_54], 5
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_4093E0
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jmp	short loc_40DE01
; ---------------------------------------------------------------------------

loc_40DE00:				; CODE XREF: sub_40D9FB+3E7j
		nop

loc_40DE01:				; CODE XREF: sub_40D9FB+3B5j
					; sub_40D9FB+403j
		cmp	[ebp+var_10], 0
		jz	short loc_40DE12
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax ;	void *
		call	sub_4291C4

loc_40DE12:				; CODE XREF: sub_40D9FB+40Aj
		cmp	[ebp+var_C], 0
		jz	short loc_40DE23
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax ;	void *
		call	sub_4291C4

loc_40DE23:				; CODE XREF: sub_40D9FB+41Bj
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		cmp	[ebp+var_14], 0
		setnz	al
		movzx	eax, al
		leave
		retn
sub_40D9FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DE3A	proc near		; CODE XREF: sub_40DF58+14p
					; sub_40E084+1Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_40DE9E
; ---------------------------------------------------------------------------

loc_40DE50:				; CODE XREF: sub_40DE3A+76j
		mov	eax, [ebp+var_10]
		mov	edx, off_43D6BC[eax*4]
		mov	eax, ds:dword_449DB8
		mov	[esp+28h+var_24], edx ;	char *
		mov	[esp+28h+var_28], eax ;	int
		call	sub_420115
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40DE9A
		mov	eax, [ebp+var_10]
		mov	edx, off_43D6BC[eax*4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, [ebp+var_14]
		mov	[esp+28h+var_20], ecx ;	int
		mov	[esp+28h+var_24], edx ;	char *
		mov	[esp+28h+var_28], eax ;	int
		call	sub_42008C
		mov	[ebp+var_C], eax

loc_40DE9A:				; CODE XREF: sub_40DE3A+38j
		add	[ebp+var_10], 1

loc_40DE9E:				; CODE XREF: sub_40DE3A+14j
		cmp	[ebp+var_C], 0
		jnz	short loc_40DEB2
		mov	eax, [ebp+var_10]
		mov	eax, off_43D6BC[eax*4]
		test	eax, eax
		jnz	short loc_40DE50

loc_40DEB2:				; CODE XREF: sub_40DE3A+68j
		cmp	[ebp+var_C], 0
		jnz	short loc_40DEF2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40DEF2
		mov	eax, ds:dword_449DBC
		test	eax, eax
		jz	short loc_40DEF2
		mov	eax, ds:dword_449DBC
		mov	[esp+28h+var_28], eax
		call	gcry_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40DEF2
		call	sub_4092EF
		mov	[ebp+var_C], eax

loc_40DEF2:				; CODE XREF: sub_40DE3A+7Cj
					; sub_40DE3A+86j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_40DF32
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_40DF32
		mov	eax, ds:dword_449DC0
		test	eax, eax
		jz	short loc_40DF32
		mov	eax, ds:dword_449DC0
		mov	[esp+28h+var_28], eax
		call	gcry_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_40DF32
		call	sub_4092EF
		mov	[ebp+var_C], eax

loc_40DF32:				; CODE XREF: sub_40DE3A+BCj
					; sub_40DE3A+C6j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40DF53
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+var_28], offset aErrorSettingDe ; "error setting default session environme"...
		call	sub_435B7D

loc_40DF53:				; CODE XREF: sub_40DE3A+FCj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40DE3A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DF58	proc near		; CODE XREF: sub_40466D+7Cp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40DE3A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40E06C
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], offset aR_1	; "r+"
		mov	[esp+28h+var_28], eax
		call	sub_428A6C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40DFCC
		call	sub_4092EF
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+28h+var_28], offset aFailedToCreate ; "failed to create stream from socket: %s"...
		call	sub_435294
		mov	dword ptr [esp+28h+var_24], ebx	; char
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_435B7D
		jmp	loc_40E06D
; ---------------------------------------------------------------------------

loc_40DFCC:				; CODE XREF: sub_40DF58+40j
		mov	[esp+28h+var_1C], 0 ; size_t
		mov	[esp+28h+var_20], 4 ; int
		mov	dword ptr [esp+28h+var_24], 0 ;	int
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_42ACFF
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40E045
		call	sub_4092EF
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToDisabl ; "failed to disable buffering	on socket s"...
		call	sub_435B7D
		jmp	short loc_40E06D
; ---------------------------------------------------------------------------

loc_40E01D:				; CODE XREF: sub_40DF58+102j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_429B36
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jz	short loc_40E05E
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_429CE6
		jmp	short loc_40E046
; ---------------------------------------------------------------------------

loc_40E045:				; CODE XREF: sub_40DF58+9Ej
		nop

loc_40E046:				; CODE XREF: sub_40DF58+EBj
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40D9FB
		test	eax, eax
		jz	short loc_40E01D
		jmp	short loc_40E05F
; ---------------------------------------------------------------------------

loc_40E05E:				; CODE XREF: sub_40DF58+D7j
		nop

loc_40E05F:				; CODE XREF: sub_40DF58+104j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41AA60
		jmp	short loc_40E06D
; ---------------------------------------------------------------------------

loc_40E06C:				; CODE XREF: sub_40DF58+20j
		nop

loc_40E06D:				; CODE XREF: sub_40DF58+6Fj
					; sub_40DF58+C3j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40E07E
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_4291C4

loc_40E07E:				; CODE XREF: sub_40DF58+119j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_40DF58	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E084	proc near		; CODE XREF: sub_403FC2+3A0p

Dst		= dword	ptr -58h
Src		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dst], eax
		call	sub_40DE3A
		test	eax, eax
		jnz	loc_40E458
		cmp	[ebp+arg_8], 4
		jbe	loc_40E45B
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		or	edx, eax
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	dword ptr [ebp+var_18],	eax
		cmp	dword ptr [ebp+var_18],	0
		jz	short loc_40E107
		mov	eax, [ebp+arg_8]
		sub	eax, 4
		cmp	eax, dword ptr [ebp+var_18]
		jnb	short loc_40E11F

loc_40E107:				; CODE XREF: sub_40E084+76j
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+58h+Src], eax ; char
		mov	[esp+58h+Dst], offset aSshMessageLenU ;	"ssh message len (%u) out of range"
		call	sub_435B7D
		jmp	loc_40E45F
; ---------------------------------------------------------------------------

loc_40E11F:				; CODE XREF: sub_40E084+81j
		mov	eax, [ebp+arg_4]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+58h+Dst], eax
		call	sub_40D98B
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40E148
		mov	[ebp+var_C], 1
		jmp	loc_40E45F
; ---------------------------------------------------------------------------

loc_40E148:				; CODE XREF: sub_40E084+B6j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40E194
		mov	eax, offset aR_1 ; "r+"
		mov	[esp+58h+var_40], eax
		mov	[esp+58h+var_44], offset gcry_free
		mov	[esp+58h+var_48], offset sub_409304
		mov	[esp+58h+var_4C], 1
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 0
		mov	[esp+58h+Dst], 0
		call	sub_4285F8
		mov	[ebp+var_14], eax
		jmp	short loc_40E1D4
; ---------------------------------------------------------------------------

loc_40E194:				; CODE XREF: sub_40E084+CCj
		mov	eax, offset aR_1 ; "r+"
		mov	[esp+58h+var_40], eax
		mov	[esp+58h+var_44], offset gcry_free
		mov	[esp+58h+var_48], offset gcry_realloc
		mov	[esp+58h+var_4C], 1
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 0
		mov	[esp+58h+Dst], 0
		call	sub_4285F8
		mov	[ebp+var_14], eax

loc_40E1D4:				; CODE XREF: sub_40E084+10Ej
		cmp	[ebp+var_14], 0
		jnz	short loc_40E1E7
		call	sub_4092EF
		mov	[ebp+var_20], eax
		jmp	loc_40E45F
; ---------------------------------------------------------------------------

loc_40E1E7:				; CODE XREF: sub_40E084+154j
		mov	[esp+58h+var_4C], 0 ; size_t
		mov	[esp+58h+Size],	4 ; int
		mov	[esp+58h+Src], 0 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax ; int
		call	sub_42ACFF
		test	eax, eax
		jz	short loc_40E21B
		call	sub_4092EF
		mov	[ebp+var_20], eax
		jmp	loc_40E45F
; ---------------------------------------------------------------------------

loc_40E21B:				; CODE XREF: sub_40E084+188j
		mov	eax, dword ptr [ebp+var_18]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_4]
		add	eax, 5
		mov	[esp+58h+Size],	edx
		mov	[esp+58h+Src], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	sub_40957B
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	loc_40E45E
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	sub_4299EA
		mov	eax, offset aRB	; "r+b"
		mov	[esp+58h+Src], eax
		mov	[esp+58h+Dst], 0
		call	sub_428707
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40E27D
		call	sub_4092EF
		mov	[ebp+var_20], eax
		jmp	loc_40E45F
; ---------------------------------------------------------------------------

loc_40E27D:				; CODE XREF: sub_40E084+1EAj
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_40E2A9
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+8]
		mov	[esp+58h+Size],	edx
		mov	[esp+58h+Src], eax ; char
		mov	[esp+58h+Dst], offset aSshRequestHand ;	"ssh request handler for %s (%u) started"...
		call	sub_435B53

loc_40E2A9:				; CODE XREF: sub_40E084+200j
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Size],	eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dst], eax
		call	edx
		mov	[ebp+var_20], eax
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_40E32E
		cmp	[ebp+var_20], 0
		jz	short loc_40E30B
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dst], eax
		call	gpg_strerror
		mov	edx, [ebp+var_1C]
		movzx	edx, byte ptr [edx]
		movzx	ecx, dl
		mov	edx, [ebp+var_1C]
		mov	edx, [edx+8]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+Size],	ecx
		mov	[esp+58h+Src], edx ; char
		mov	[esp+58h+Dst], offset aSshRequestHa_0 ;	"ssh request handler for %s (%u) failed:"...
		call	sub_435B53
		jmp	short loc_40E32E
; ---------------------------------------------------------------------------

loc_40E30B:				; CODE XREF: sub_40E084+251j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+8]
		mov	[esp+58h+Size],	edx
		mov	[esp+58h+Src], eax ; char
		mov	[esp+58h+Dst], offset aSshRequestHa_1 ;	"ssh request handler for %s (%u) ready\n"
		call	sub_435B53

loc_40E32E:				; CODE XREF: sub_40E084+24Bj
					; sub_40E084+285j
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax ; void *
		call	sub_4291C4
		mov	[ebp+var_14], 0
		cmp	[ebp+var_20], 0
		jz	short loc_40E352
		mov	[ebp+var_C], 1
		jmp	loc_40E45F
; ---------------------------------------------------------------------------

loc_40E352:				; CODE XREF: sub_40E084+2C0j
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	eax ; int
		lea	eax, [ebp+var_28]
		mov	[esp+58h+Src], eax ; int
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Dst], eax ; void *
		call	sub_4291E5
		test	eax, eax
		jz	short loc_40E398
		call	sub_4092EF
		mov	[esp+58h+Dst], eax
		call	gpg_strerror
		mov	[esp+58h+Src], eax ; char
		mov	[esp+58h+Dst], offset aSnatchingSshRe ;	"snatching ssh response	failed:	%s"
		call	sub_435B7D
		mov	[ebp+var_C], 1
		jmp	loc_40E45F
; ---------------------------------------------------------------------------

loc_40E398:				; CODE XREF: sub_40E084+2E9j
		mov	eax, ds:dword_449DA4
		cmp	eax, 1
		jle	short loc_40E3B5
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Src], eax ; char
		mov	[esp+58h+Dst], offset aSendingSshResp ;	"sending ssh response of length	%u\n"
		call	sub_435B53

loc_40E3B5:				; CODE XREF: sub_40E084+31Cj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax-4]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jnb	short loc_40E3F2
		mov	[esp+58h+Dst], 3Fh
		call	gpg_strerror
		mov	[esp+58h+Src], eax ; char
		mov	[esp+58h+Dst], offset aInvalidLengt_1 ;	"invalid length	of the ssh response: %s"
		call	sub_435B7D
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dst], eax ; void *
		call	sub_42A7C1
		mov	[ebp+var_C], 1
		jmp	short loc_40E45F
; ---------------------------------------------------------------------------

loc_40E3F2:				; CODE XREF: sub_40E084+33Cj
		mov	eax, [ebp+var_2C]
		shr	eax, 18h
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], dl
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_2C]
		shr	eax, 10h
		mov	[edx], al
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+2]
		mov	eax, [ebp+var_2C]
		shr	eax, 8
		mov	[edx], al
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+3]
		mov	eax, [ebp+var_2C]
		mov	[edx], al
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dst], eax ; void *
		call	sub_42A7C1
		mov	[ebp+var_10], 1
		jmp	short loc_40E45F
; ---------------------------------------------------------------------------

loc_40E458:				; CODE XREF: sub_40E084+21j
		nop
		jmp	short loc_40E45F
; ---------------------------------------------------------------------------

loc_40E45B:				; CODE XREF: sub_40E084+2Bj
		nop
		jmp	short loc_40E45F
; ---------------------------------------------------------------------------

loc_40E45E:				; CODE XREF: sub_40E084+1BDj
		nop

loc_40E45F:				; CODE XREF: sub_40E084+96j
					; sub_40E084+BFj ...
		cmp	[ebp+var_C], 0
		jz	short loc_40E496
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_4]
		add	eax, 2
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_4]
		add	eax, 3
		mov	byte ptr [eax],	1
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	byte ptr [eax],	5
		mov	[ebp+var_10], 1

loc_40E496:				; CODE XREF: sub_40E084+3DFj
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dst], eax
		call	sub_41AA60
		cmp	[ebp+var_10], 0
		jz	short loc_40E4AE
		mov	eax, 0
		jmp	short locret_40E4B3
; ---------------------------------------------------------------------------

loc_40E4AE:				; CODE XREF: sub_40E084+421j
		mov	eax, 0FFFFFFFFh

locret_40E4B3:				; CODE XREF: sub_40E084+428j
		leave
		retn
sub_40E084	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E4B8	proc near		; CODE XREF: sub_40E4DF+14p
					; sub_40F902+59Fp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40E4D8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40E4DD
; ---------------------------------------------------------------------------

loc_40E4D8:				; CODE XREF: sub_40E4B8+7j
		mov	eax, 0

loc_40E4DD:				; CODE XREF: sub_40E4B8+1Ej
		pop	ebp
		retn
sub_40E4B8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E4DF	proc near		; CODE XREF: sub_40E515+Ep
					; sub_40E629+41p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_40E4B8
		leave
		retn
sub_40E4DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E4FA	proc near		; CODE XREF: sub_40E7CF+6D2p
					; sub_40E7CF+959p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_40E4FA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E507	proc near		; CODE XREF: sub_40F902+56Ep
					; sub_40F902+58Fp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		and	eax, 7Fh
		pop	ebp
		retn
sub_40E507	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E515	proc near		; CODE XREF: sub_40E52A+6p
					; sub_40F547+80p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40E4DF
		leave
		retn
sub_40E515	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E52A	proc near		; CODE XREF: sub_40E7CF+3EEp
					; sub_40E7CF+4A9p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_40E515
		leave
		retn
sub_40E52A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E537	proc near		; CODE XREF: sub_40E7CF+220p
					; sub_40E7CF+245p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jns	short loc_40E54A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40E557
; ---------------------------------------------------------------------------

loc_40E54A:				; CODE XREF: sub_40E537+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

locret_40E557:				; CODE XREF: sub_40E537+11j
		leave
		retn
sub_40E537	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E559	proc near		; CODE XREF: sub_402066:loc_402C90p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4490A8
		test	eax, eax
		jnz	short locret_40E582
		mov	[esp+18h+var_18], offset dword_44909C
		call	pth_mutex_init
		test	eax, eax
		jz	short locret_40E582
		mov	ds:dword_4490A8, 1

locret_40E582:				; CODE XREF: sub_40E559+Dj
					; sub_40E559+1Dj
		leave
		retn
sub_40E559	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E584	proc near		; CODE XREF: .text:0040E5B2p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aUnknownUnderW3 ; "unknown under W32"
		call	sub_435C44
		leave
		retn
sub_40E584	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	dword ptr [esp], offset	aAgent_query_du	; "agent_query_dump_state: entry_lock="
		call	sub_435B53
		mov	dword ptr [esp], offset	dword_44909C
		call	sub_40E584
		mov	dword ptr [esp], offset	asc_442C78 ; "\n"
		call	sub_435C44
		mov	ebx, ds:dword_4490A0
		mov	eax, ds:dword_449094
		mov	[esp], eax
		call	assuan_get_pid
		mov	edx, ds:dword_449094
		mov	[esp+0Ch], ebx
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aAgent_query__0	; "agent_query_dump_state: entry_ctx=%p	pi"...
		call	sub_435B53
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E5FA	proc near		; CODE XREF: sub_40901E+23Dp

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449094
		test	eax, eax
		jz	short locret_40E627
		mov	eax, ds:dword_4490A0
		test	eax, eax
		jz	short locret_40E627
		mov	eax, ds:dword_449098
		cmp	eax, [ebp+arg_0]
		jnz	short locret_40E627
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_410E05

locret_40E627:				; CODE XREF: sub_40E5FA+Dj
					; sub_40E5FA+16j ...
		leave
		retn
sub_40E5FA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E629	proc near		; CODE XREF: sub_40E7CF+311p
					; sub_40E7CF+3A3p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449094
		mov	[ebp+var_C], eax
		mov	ds:dword_449094, 0
		mov	[esp+28h+var_28], offset dword_44909C
		call	pth_mutex_release
		test	eax, eax
		jnz	short loc_40E672
		mov	[esp+28h+var_28], offset aFailedToReleas ; "failed to release the entry	lock\n"
		call	sub_435B7D
		cmp	[ebp+arg_0], 0
		jnz	short loc_40E672
		mov	[esp+28h+var_28], 3Fh
		call	sub_40E4DF
		mov	[ebp+arg_0], eax

loc_40E672:				; CODE XREF: sub_40E629+26j
					; sub_40E629+38j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	assuan_release
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_40E629	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E682	proc near		; DATA XREF: sub_40E7CF+2B1o

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jnz	loc_40E760
		mov	[ebp+var_18], 0
		mov	[esp+38h+var_38], 19h
		call	gcry_control
		jmp	loc_40E741
; ---------------------------------------------------------------------------

loc_40E6B2:				; CODE XREF: sub_40E682+D8j
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_40E709
		mov	eax, [ebp+var_10]
		mov	edx, eax
		mov	eax, offset aXauthority_2 ; "XAUTHORITY"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40E709
		mov	eax, [ebp+var_10]
		mov	edx, eax
		mov	eax, offset aPinentry_use_1 ; "PINENTRY_USER_DATA"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40E741

loc_40E709:				; CODE XREF: sub_40E682+35j
					; sub_40E682+5Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+var_34], edx ;	char *
		mov	[esp+38h+var_38], eax ;	int
		call	sub_420115
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40E741
		mov	[esp+38h+var_30], 1 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax ;	void *
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_439D3A

loc_40E741:				; CODE XREF: sub_40E682+2Bj
					; sub_40E682+85j ...
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	sub_41FB0D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40E6B2

loc_40E760:				; CODE XREF: sub_40E682+12j
		add	esp, 30h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40E682	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E767(int, char *, size_t)
sub_40E767	proc near		; DATA XREF: sub_40E7CF+8ECo

Dest		= dword	ptr -58h
Source		= dword	ptr -54h
Count		= dword	ptr -50h
Str		= byte ptr -3Eh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_8], 31h
		jbe	short loc_40E780
		mov	[ebp+arg_8], 31h

loc_40E780:				; CODE XREF: sub_40E767+10j
		cmp	[ebp+arg_8], 0
		jz	short loc_40E7C8
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+Count], edx ; Count
		mov	[esp+58h+Source], eax ;	Source
		lea	eax, [ebp+Str]
		mov	[esp+58h+Dest],	eax ; Dest
		call	strncpy
		lea	eax, [ebp+Str]
		add	eax, [ebp+arg_8]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+Str]
		mov	[esp+58h+Count], 0Ah ; Radix
		mov	[esp+58h+Source], 0 ; EndPtr
		mov	[esp+58h+Dest],	eax ; Str
		call	strtoul
		mov	edx, [ebp+var_C]
		mov	[edx], eax

loc_40E7C8:				; CODE XREF: sub_40E767+1Dj
		mov	eax, 0
		leave
		retn
sub_40E767	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E7CF	proc near		; CODE XREF: sub_40F902+DBp
					; sub_4100EE+32p ...

File		= dword	ptr -0A8h
Val		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 9Ch
		mov	[esp+0A8h+Val],	0
		mov	[esp+0A8h+File], 3Ch
		call	pth_timeout
		mov	[esp+0A8h+Val],	eax
		mov	[esp+0A8h+var_A0], edx
		mov	[esp+0A8h+File], 10h
		call	pth_event
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+var_A0], eax
		mov	[esp+0A8h+Val],	0
		mov	[esp+0A8h+File], offset	dword_44909C
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short loc_40E894
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+File], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_40E845
		mov	[esp+0A8h+File], 3Eh
		call	sub_40E4DF
		mov	[ebp+var_1C], eax
		jmp	short loc_40E854
; ---------------------------------------------------------------------------

loc_40E845:				; CODE XREF: sub_40E7CF+63j
		mov	[esp+0A8h+File], 3Fh
		call	sub_40E4DF
		mov	[ebp+var_1C], eax

loc_40E854:				; CODE XREF: sub_40E7CF+74j
		mov	[esp+0A8h+Val],	0
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+File], eax
		call	pth_event_free
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+0A8h+File], offset	aFailedToAcquir	; "failed to acquire the pinentry lock:	%s"...
		call	sub_435294
		mov	[esp+0A8h+Val],	ebx ; char
		mov	[esp+0A8h+File], eax ; char *
		call	sub_435B7D
		mov	eax, [ebp+var_1C]
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40E894:				; CODE XREF: sub_40E7CF+54j
		mov	[esp+0A8h+Val],	0 ; char
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+File], eax
		call	pth_event_free
		mov	eax, [ebp+arg_0]
		mov	ds:dword_449098, eax
		mov	eax, ds:dword_449094
		test	eax, eax
		jz	short loc_40E8C2
		mov	eax, 0
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40E8C2:				; CODE XREF: sub_40E7CF+E7j
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_40E8D7
		mov	[esp+0A8h+File], offset	aStartingANewPi	; "starting a new PIN Entry\n"
		call	sub_435B53

loc_40E8D7:				; CODE XREF: sub_40E7CF+FAj
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+0A8h+File], eax ; File
		call	fflush
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+0A8h+File], eax ; File
		call	fflush
		mov	[esp+0A8h+File], 0 ; File
		call	fflush
		test	eax, eax
		jz	short loc_40E928
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0A8h+File], eax ; int
		call	strerror
		mov	[esp+0A8h+Val],	eax ; char
		mov	[esp+0A8h+File], offset	aErrorFlushingP	; "error flushing pending output: %s\n"
		call	sub_435B7D

loc_40E928:				; CODE XREF: sub_40E7CF+136j
		mov	eax, ds:dword_449DCC
		test	eax, eax
		jz	short loc_40E93D
		mov	eax, ds:dword_449DCC
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40E94E

loc_40E93D:				; CODE XREF: sub_40E7CF+160j
		mov	[esp+0A8h+File], 2
		call	sub_41F46E
		mov	ds:dword_449DCC, eax

loc_40E94E:				; CODE XREF: sub_40E7CF+16Cj
		mov	eax, ds:dword_449DCC
		mov	[ebp+var_20], eax
		mov	eax, ds:dword_449DCC
		mov	[esp+0A8h+Val],	2Fh ; Ch
		mov	[esp+0A8h+File], eax ; Str
		call	strrchr
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40E97E
		mov	eax, ds:dword_449DCC
		mov	[ebp+var_20], eax
		jmp	short loc_40E982
; ---------------------------------------------------------------------------

loc_40E97E:				; CODE XREF: sub_40E7CF+1A3j
		add	[ebp+var_20], 1

loc_40E982:				; CODE XREF: sub_40E7CF+1ADj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_54], eax
		mov	eax, ds:dword_449E20
		test	eax, eax
		jnz	short loc_40E9C6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+0A8h+Val],	offset aDisplay_2 ; "DISPLAY"
		mov	[esp+0A8h+File], eax ; int
		call	sub_420115
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_40E9C6
		mov	[ebp+var_50], offset aDisplay_3	; "--display"
		mov	eax, [ebp+var_38]
		mov	[ebp+var_4C], eax
		mov	[ebp+var_48], 0
		jmp	short loc_40E9CD
; ---------------------------------------------------------------------------

loc_40E9C6:				; CODE XREF: sub_40E7CF+1C0j
					; sub_40E7CF+1DFj
		mov	[ebp+var_50], 0

loc_40E9CD:				; CODE XREF: sub_40E7CF+1F5j
		mov	[ebp+var_24], 0
		mov	eax, ds:dword_449E08
		test	eax, eax
		jnz	short loc_40EA26
		call	sub_435741
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40EA01
		call	sub_435741
		mov	[esp+0A8h+File], eax
		call	sub_40E537
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[ebp+eax*4+var_60], edx
		add	[ebp+var_24], 1

loc_40EA01:				; CODE XREF: sub_40E7CF+216j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+0A8h+File], eax ; File
		call	_fileno
		mov	[esp+0A8h+File], eax
		call	sub_40E537
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[ebp+eax*4+var_60], edx
		add	[ebp+var_24], 1

loc_40EA26:				; CODE XREF: sub_40E7CF+20Cj
		mov	eax, [ebp+var_24]
		mov	[ebp+eax*4+var_60], 0FFFFFFFFh
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+File], eax
		call	assuan_new
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40EA68
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	gpg_strerror
		mov	[esp+0A8h+Val],	eax ; char
		mov	[esp+0A8h+File], offset	aCanTAllocate_0	; "can't allocate assuan context: %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_1C]
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EA68:				; CODE XREF: sub_40E7CF+274j
		mov	edx, ds:dword_449DCC
		mov	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], 80h
		mov	ecx, [ebp+arg_0]
		mov	[esp+0A8h+var_94], ecx
		mov	[esp+0A8h+var_98], offset sub_40E682
		lea	ecx, [ebp+var_60]
		mov	[esp+0A8h+var_9C], ecx
		lea	ecx, [ebp+var_54]
		mov	[esp+0A8h+var_A0], ecx
		mov	[esp+0A8h+Val],	edx ; char
		mov	[esp+0A8h+File], eax
		call	assuan_pipe_connect
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40EAEA
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	gpg_strerror
		mov	[esp+0A8h+Val],	eax ; char
		mov	[esp+0A8h+File], offset	aCanTConnectT_0	; "can't connect to the PIN entry module: "...
		call	sub_435B7D
		mov	eax, [ebp+var_40]
		mov	[esp+0A8h+File], eax
		call	assuan_release
		mov	[esp+0A8h+File], 55h
		call	sub_40E4DF
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EAEA:				; CODE XREF: sub_40E7CF+2DAj
		mov	eax, [ebp+var_40]
		mov	ds:dword_449094, eax
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_40EB0C
		mov	[esp+0A8h+File], offset	aConnectionToPi	; "connection to PIN entry established\n"
		call	sub_435C1A

loc_40EB0C:				; CODE XREF: sub_40E7CF+32Fj
		mov	eax, ds:dword_449DD8
		test	eax, eax
		jz	short loc_40EB1C
		mov	eax, offset aOptionNoGrab ; "OPTION no-grab"
		jmp	short loc_40EB21
; ---------------------------------------------------------------------------

loc_40EB1C:				; CODE XREF: sub_40E7CF+344j
		mov	eax, offset aOptionGrab	; "OPTION grab"

loc_40EB21:				; CODE XREF: sub_40E7CF+34Bj
		mov	edx, ds:dword_449094
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], 0
		mov	[esp+0A8h+var_98], 0
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+var_A0], 0
		mov	[esp+0A8h+Val],	eax
		mov	[esp+0A8h+File], edx
		call	assuan_transact
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40EB7C
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EB7C:				; CODE XREF: sub_40E7CF+39Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+0A8h+Val],	offset aGpg_tty_1 ; "GPG_TTY"
		mov	[esp+0A8h+File], eax ; int
		call	sub_420115
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	loc_40EC37
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+var_A0], eax
		mov	[esp+0A8h+Val],	offset aOptionTtynameS ; "OPTION ttyname=%s"
		lea	eax, [ebp+var_68]
		mov	[esp+0A8h+File], eax
		call	sub_424454
		test	eax, eax
		jns	short loc_40EBCF
		call	sub_40E52A
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EBCF:				; CODE XREF: sub_40E7CF+3ECj
		mov	edx, [ebp+var_68]
		mov	eax, ds:dword_449094
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], 0
		mov	[esp+0A8h+var_98], 0
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+var_A0], 0
		mov	[esp+0A8h+Val],	edx
		mov	[esp+0A8h+File], eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_68]
		mov	[esp+0A8h+File], eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jz	short loc_40EC37
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EC37:				; CODE XREF: sub_40E7CF+3CAj
					; sub_40E7CF+456j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+0A8h+Val],	offset aTerm_1 ; "TERM"
		mov	[esp+0A8h+File], eax ; int
		call	sub_420115
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	loc_40ECF2
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+var_A0], eax
		mov	[esp+0A8h+Val],	offset aOptionTtytypeS ; "OPTION ttytype=%s"
		lea	eax, [ebp+var_6C]
		mov	[esp+0A8h+File], eax
		call	sub_424454
		test	eax, eax
		jns	short loc_40EC8A
		call	sub_40E52A
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EC8A:				; CODE XREF: sub_40E7CF+4A7j
		mov	edx, [ebp+var_6C]
		mov	eax, ds:dword_449094
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], 0
		mov	[esp+0A8h+var_98], 0
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+var_A0], 0
		mov	[esp+0A8h+Val],	edx
		mov	[esp+0A8h+File], eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_6C]
		mov	[esp+0A8h+File], eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jz	short loc_40ECF2
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40ECF2:				; CODE XREF: sub_40E7CF+485j
					; sub_40E7CF+511j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	loc_40ED9B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+0A8h+var_A0], eax
		mov	[esp+0A8h+Val],	offset aOptionLcCtypeS ; "OPTION lc-ctype=%s"
		lea	eax, [ebp+var_70]
		mov	[esp+0A8h+File], eax
		call	sub_424454
		test	eax, eax
		jns	short loc_40ED33
		call	sub_40E52A
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40ED33:				; CODE XREF: sub_40E7CF+550j
		mov	edx, [ebp+var_70]
		mov	eax, ds:dword_449094
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], 0
		mov	[esp+0A8h+var_98], 0
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+var_A0], 0
		mov	[esp+0A8h+Val],	edx
		mov	[esp+0A8h+File], eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_70]
		mov	[esp+0A8h+File], eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jz	short loc_40ED9B
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40ED9B:				; CODE XREF: sub_40E7CF+52Bj
					; sub_40E7CF+5BAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	loc_40EE44
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+0A8h+var_A0], eax
		mov	[esp+0A8h+Val],	offset aOptionLcMessag ; "OPTION lc-messages=%s"
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+File], eax
		call	sub_424454
		test	eax, eax
		jns	short loc_40EDDC
		call	sub_40E52A
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EDDC:				; CODE XREF: sub_40E7CF+5F9j
		mov	edx, [ebp+var_74]
		mov	eax, ds:dword_449094
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], 0
		mov	[esp+0A8h+var_98], 0
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+var_A0], 0
		mov	[esp+0A8h+Val],	edx
		mov	[esp+0A8h+File], eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_74]
		mov	[esp+0A8h+File], eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jz	short loc_40EE44
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EE44:				; CODE XREF: sub_40E7CF+5D4j
					; sub_40E7CF+663j
		mov	eax, ds:dword_449E18
		test	eax, eax
		jz	short loc_40EEBD
		mov	eax, ds:dword_449094
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], 0
		mov	[esp+0A8h+var_98], 0
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+var_A0], 0
		mov	[esp+0A8h+Val],	offset aOptionAllowExt ; "OPTION allow-external-password-cache"
		mov	[esp+0A8h+File], eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40EEBD
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	sub_40E4FA
		cmp	eax, 0AEh
		jz	short loc_40EEBD
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EEBD:				; CODE XREF: sub_40E7CF+67Cj
					; sub_40E7CF+6CAj ...
		mov	[ebp+var_2C], 0
		jmp	loc_40EFB4
; ---------------------------------------------------------------------------

loc_40EEC9:				; CODE XREF: sub_40E7CF+7FAj
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D6E0
		mov	eax, [eax+4]
		mov	[esp+0A8h+File], eax ; char *
		call	sub_435294
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_40EF1A
		mov	eax, [ebp+var_30]
		add	eax, 1
		mov	[esp+0A8h+Val],	7Ch ; Val
		mov	[esp+0A8h+File], eax ; Str
		call	strchr
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_40EF1A
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_30], eax

loc_40EF1A:				; CODE XREF: sub_40E7CF+721j
					; sub_40E7CF+740j
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D6E0
		mov	eax, [eax]
		mov	edx, [ebp+var_30]
		mov	[esp+0A8h+var_9C], edx
		mov	[esp+0A8h+var_A0], eax
		mov	[esp+0A8h+Val],	offset aOptionDefaultS ; "OPTION default-%s=%s"
		lea	eax, [ebp+var_78]
		mov	[esp+0A8h+File], eax
		call	sub_424454
		test	eax, eax
		jns	short loc_40EF61
		call	sub_40E52A
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	loc_40F154
; ---------------------------------------------------------------------------

loc_40EF61:				; CODE XREF: sub_40E7CF+77Ej
		mov	edx, [ebp+var_78]
		mov	eax, ds:dword_449094
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], 0
		mov	[esp+0A8h+var_98], 0
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+var_A0], 0
		mov	[esp+0A8h+Val],	edx
		mov	[esp+0A8h+File], eax
		call	assuan_transact
		mov	eax, [ebp+var_78]
		mov	[esp+0A8h+File], eax
		call	gcry_free
		add	[ebp+var_2C], 1

loc_40EFB4:				; CODE XREF: sub_40E7CF+6F5j
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D6E0
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40EEC9
		mov	eax, ds:dword_449DDC
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_40F00E
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, offset aDevNull ; "/dev/null"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40F00E
		mov	[ebp+var_28], 0
		jmp	short loc_40F01C
; ---------------------------------------------------------------------------

loc_40F00E:				; CODE XREF: sub_40E7CF+80Cj
					; sub_40E7CF+834j
		cmp	[ebp+var_28], 0
		jnz	short loc_40F01C
		call	sub_403610
		mov	[ebp+var_28], eax

loc_40F01C:				; CODE XREF: sub_40E7CF+83Dj
					; sub_40E7CF+843j
		cmp	[ebp+var_28], 0
		jz	short loc_40F08F
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+var_A0], eax
		mov	[esp+0A8h+Val],	offset aOptionTouchFil ; "OPTION touch-file=%s"
		lea	eax, [ebp+var_7C]
		mov	[esp+0A8h+File], eax
		call	sub_424454
		test	eax, eax
		js	short loc_40F08F
		mov	edx, [ebp+var_7C]
		mov	eax, ds:dword_449094
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], 0
		mov	[esp+0A8h+var_98], 0
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+var_A0], 0
		mov	[esp+0A8h+Val],	edx
		mov	[esp+0A8h+File], eax
		call	assuan_transact
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+File], eax
		call	gcry_free

loc_40F08F:				; CODE XREF: sub_40E7CF+851j
					; sub_40E7CF+86Fj
		mov	eax, ds:dword_449094
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], 0
		mov	[esp+0A8h+var_98], 0
		lea	edx, [ebp+var_64]
		mov	[esp+0A8h+var_9C], edx
		mov	[esp+0A8h+var_A0], offset sub_40E767
		mov	[esp+0A8h+Val],	offset aGetinfoPid_0 ; "GETINFO	pid"
		mov	[esp+0A8h+File], eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40F0F1
		mov	[esp+0A8h+File], offset	aYouMayWantToUp	; "You may want	to update to a newer pinen"...
		call	sub_435B53
		mov	[ebp+var_1C], 0
		jmp	short loc_40F14F
; ---------------------------------------------------------------------------

loc_40F0F1:				; CODE XREF: sub_40E7CF+90Bj
		cmp	[ebp+var_1C], 0
		jnz	short loc_40F10D
		mov	eax, [ebp+var_64]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40F10D
		mov	[esp+0A8h+File], offset	aPinentryDidNot	; "pinentry did	not return a PID\n"
		call	sub_435B7D
		jmp	short loc_40F14F
; ---------------------------------------------------------------------------

loc_40F10D:				; CODE XREF: sub_40E7CF+926j
					; sub_40E7CF+92Ej
		mov	eax, [ebp+var_64]
		mov	[esp+0A8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+File], eax
		call	sub_405C88
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+File], eax
		call	sub_40E4FA
		cmp	eax, 63h
		jnz	short loc_40F148
		mov	[esp+0A8h+File], 63h
		call	sub_40E4DF
		mov	[esp+0A8h+File], eax
		call	sub_40E629
		jmp	short loc_40F154
; ---------------------------------------------------------------------------

loc_40F148:				; CODE XREF: sub_40E7CF+961j
		mov	[ebp+var_1C], 0

loc_40F14F:				; CODE XREF: sub_40E7CF+920j
					; sub_40E7CF+93Cj
		mov	eax, 0

loc_40F154:				; CODE XREF: sub_40E7CF+C0j
					; sub_40E7CF+EEj ...
		add	esp, 9Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40E7CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F15F	proc near		; CODE XREF: sub_41202E+C1p
					; sub_41202E+D8p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jle	loc_40F214
		mov	dword ptr [esp+28h+var_24], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	pth_timeout
		mov	dword ptr [esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], 10h
		call	pth_event
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_44909C
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short loc_40F1FF
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_40F1D8
		mov	[esp+28h+var_28], 3Eh
		call	sub_40E4DF
		mov	[ebp+var_C], eax
		jmp	short loc_40F1E7
; ---------------------------------------------------------------------------

loc_40F1D8:				; CODE XREF: sub_40F15F+66j
		mov	[esp+28h+var_28], 3Fh
		call	sub_40E4DF
		mov	[ebp+var_C], eax

loc_40F1E7:				; CODE XREF: sub_40F15F+77j
		mov	dword ptr [esp+28h+var_24], 0
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_event_free
		mov	eax, [ebp+var_C]
		jmp	short locret_40F26B
; ---------------------------------------------------------------------------

loc_40F1FF:				; CODE XREF: sub_40F15F+57j
		mov	dword ptr [esp+28h+var_24], 0
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	pth_event_free
		jmp	short loc_40F242
; ---------------------------------------------------------------------------

loc_40F214:				; CODE XREF: sub_40F15F+Aj
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 1
		mov	[esp+28h+var_28], offset dword_44909C
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short loc_40F242
		mov	[esp+28h+var_28], 0ADh
		call	sub_40E4DF
		jmp	short locret_40F26B
; ---------------------------------------------------------------------------

loc_40F242:				; CODE XREF: sub_40F15F+B3j
					; sub_40F15F+D3j
		mov	[esp+28h+var_28], offset dword_44909C
		call	pth_mutex_release
		test	eax, eax
		jnz	short loc_40F266
		mov	dword ptr [esp+28h+var_24], 21Bh ; char
		mov	[esp+28h+var_28], offset aFailedToRele_0 ; "failed to release the entry	lock at	%d\"...
		call	sub_435B7D

loc_40F266:				; CODE XREF: sub_40F15F+F1j
		mov	eax, 0

locret_40F26B:				; CODE XREF: sub_40F15F+9Ej
					; sub_40F15F+E1j
		leave
		retn
sub_40F15F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F26D(int, void *, size_t)
sub_40F26D	proc near		; DATA XREF: sub_40F902+52Bo
					; sub_4100EE+418o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_40F286
		mov	eax, 0
		jmp	short locret_40F2E2
; ---------------------------------------------------------------------------

loc_40F286:				; CODE XREF: sub_40F26D+10j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F29A
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_8]
		ja	short loc_40F2A8

loc_40F29A:				; CODE XREF: sub_40F26D+20j
		mov	[esp+28h+Dst], 111h
		call	sub_40E4DF
		jmp	short locret_40F2E2
; ---------------------------------------------------------------------------

loc_40F2A8:				; CODE XREF: sub_40F26D+2Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, [ebp+arg_8]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0

locret_40F2E2:				; CODE XREF: sub_40F26D+17j
					; sub_40F26D+39j
		leave
		retn
sub_40F26D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F2E4	proc near		; CODE XREF: sub_40F902+614p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		jmp	short loc_40F2ED
; ---------------------------------------------------------------------------

loc_40F2E9:				; CODE XREF: sub_40F2E4+25j
		add	[ebp+arg_0], 1

loc_40F2ED:				; CODE XREF: sub_40F2E4+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F30B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40F30B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40F2E9

loc_40F30B:				; CODE XREF: sub_40F2E4+11j
					; sub_40F2E4+1Bj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		setz	al
		movzx	eax, al
		pop	ebp
		retn
sub_40F2E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F31B	proc near		; CODE XREF: sub_40F547+72p

var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+var_38], eax
		call	gcry_malloc_secure
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40F47C
		mov	eax, 0
		jmp	loc_40F4A8
; ---------------------------------------------------------------------------

loc_40F369:				; CODE XREF: sub_40F31B+17Ej
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_40F44B
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40F44B
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40F44B
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_40F3BA
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40F3E6
; ---------------------------------------------------------------------------

loc_40F3BA:				; CODE XREF: sub_40F31B+8Aj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_40F3D5
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40F3E4
; ---------------------------------------------------------------------------

loc_40F3D5:				; CODE XREF: sub_40F31B+A7j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40F3E4:				; CODE XREF: sub_40F31B+B8j
		mov	edx, eax

loc_40F3E6:				; CODE XREF: sub_40F31B+9Dj
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_40F401
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_40F428
; ---------------------------------------------------------------------------

loc_40F401:				; CODE XREF: sub_40F31B+D6j
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_40F41C
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_40F428
; ---------------------------------------------------------------------------

loc_40F41C:				; CODE XREF: sub_40F31B+F1j
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_40F428:				; CODE XREF: sub_40F31B+E4j
					; sub_40F31B+FFj
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40F441
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0FFh

loc_40F441:				; CODE XREF: sub_40F31B+11Ej
		add	[ebp+var_C], 1
		add	[ebp+arg_0], 2
		jmp	short loc_40F47D
; ---------------------------------------------------------------------------

loc_40F44B:				; CODE XREF: sub_40F31B+56j
					; sub_40F31B+67j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_40F465
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	20h
		add	[ebp+var_C], 1
		add	[ebp+arg_0], 1
		jmp	short loc_40F47D
; ---------------------------------------------------------------------------

loc_40F465:				; CODE XREF: sub_40F31B+138j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		add	[ebp+arg_0], 1
		jmp	short loc_40F47D
; ---------------------------------------------------------------------------

loc_40F47C:				; CODE XREF: sub_40F31B+3Ej
		nop

loc_40F47D:				; CODE XREF: sub_40F31B+12Ej
					; sub_40F31B+148j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F49F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40F49F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	loc_40F369

loc_40F49F:				; CODE XREF: sub_40F31B+16Aj
					; sub_40F31B+174j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_10]

loc_40F4A8:				; CODE XREF: sub_40F31B+49j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40F31B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F4AE	proc near		; CODE XREF: sub_40F547+93p

var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	ecx, ds:dword_449DF4
		mov	eax, ds:dword_449DF4
		mov	[ebp+var_14], eax
		mov	edx, 0AAAAAAABh
		mov	eax, [ebp+var_14]
		mul	edx
		mov	eax, edx
		shr	eax, 1
		add	eax, ecx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jg	short loc_40F4E2
		mov	eax, 0
		jmp	short locret_40F545
; ---------------------------------------------------------------------------

loc_40F4E2:				; CODE XREF: sub_40F4AE+2Bj
		mov	[ebp+var_4], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		jmp	short loc_40F50D
; ---------------------------------------------------------------------------

loc_40F4F1:				; CODE XREF: sub_40F4AE+67j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40F509
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_40F509
		add	[ebp+var_4], 1

loc_40F509:				; CODE XREF: sub_40F4AE+4Bj
					; sub_40F4AE+55j
		add	[ebp+var_8], 1

loc_40F50D:				; CODE XREF: sub_40F4AE+41j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40F4F1
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+var_C]
		jle	short loc_40F526
		mov	eax, 64h
		jmp	short locret_40F545
; ---------------------------------------------------------------------------

loc_40F526:				; CODE XREF: sub_40F4AE+6Fj
		mov	edx, [ebp+var_4]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		sar	edx, 1Fh
		idiv	[ebp+var_C]
		mov	edx, eax
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax

locret_40F545:				; CODE XREF: sub_40F4AE+32j
					; sub_40F4AE+76j
		leave
		retn
sub_40F4AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F547	proc near		; DATA XREF: sub_40F902+519o
					; sub_4100EE+406o

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= byte ptr -2Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 50h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aQuality ; "QUALITY"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_40F66B
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40F59F
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40F66B

loc_40F59F:				; CODE XREF: sub_40F547+45j
		add	dword ptr [ebp+arg_4], 7
		jmp	short loc_40F5A9
; ---------------------------------------------------------------------------

loc_40F5A5:				; CODE XREF: sub_40F547+6Aj
		add	dword ptr [ebp+arg_4], 1

loc_40F5A9:				; CODE XREF: sub_40F547+5Cj
		mov	eax, dword ptr [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40F5A5
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_40F31B
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40F5D4
		call	sub_40E515
		mov	[ebp+var_C], eax
		jmp	loc_40F68D
; ---------------------------------------------------------------------------

loc_40F5D4:				; CODE XREF: sub_40F547+7Ej
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_40F4AE
		mov	[ebp+var_10], eax
		mov	[esp+58h+var_50], 1 ; int
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_54], eax ;	void *
		mov	[esp+58h+var_58], 0 ; int
		call	sub_414492
		test	eax, eax
		jz	short loc_40F604
		neg	[ebp+var_10]

loc_40F604:				; CODE XREF: sub_40F547+B8j
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset aD ; "%d"
		mov	[esp+58h+var_54], 14h
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	sub_4241F9
		lea	eax, [ebp+var_2C]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+58h+var_50], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		jmp	short loc_40F68D
; ---------------------------------------------------------------------------

loc_40F66B:				; CODE XREF: sub_40F547+34j
					; sub_40F547+52j
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aUnsupportedInq ; "unsupported	inquiry	`%s' from pinentry\"...
		call	sub_435B7D
		mov	[esp+58h+var_58], 119h
		call	sub_40E4DF
		mov	[ebp+var_C], eax

loc_40F68D:				; CODE XREF: sub_40F547+88j
					; sub_40F547+122j
		mov	eax, [ebp+var_C]
		add	esp, 50h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40F547	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F697	proc near		; CODE XREF: sub_40F902+322p
					; sub_4100EE+2BAp

var_428		= dword	ptr -428h
var_424		= dword	ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_402		= byte ptr -402h
var_19		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 420h
		mov	[esp+428h+var_428], offset aQuality_0 ;	"Quality:"
		call	sub_435294
		mov	[esp+428h+var_424], offset byte_442F79 ; char *
		mov	[esp+428h+var_428], eax	; int
		call	sub_4335B0
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40F6CC
		mov	eax, [ebp+var_10]
		jmp	short loc_40F6D1
; ---------------------------------------------------------------------------

loc_40F6CC:				; CODE XREF: sub_40F697+2Ej
		mov	eax, offset byte_442F7F

loc_40F6D1:				; CODE XREF: sub_40F697+33j
		mov	[esp+428h+var_41C], eax
		mov	[esp+428h+var_420], offset aSetqualitybarS ; "SETQUALITYBAR %s"
		mov	[esp+428h+var_424], 3E9h
		lea	eax, [ebp+var_402]
		mov	[esp+428h+var_428], eax
		call	sub_4241F9
		mov	[ebp+var_19], 0
		mov	eax, [ebp+var_10]
		mov	[esp+428h+var_428], eax
		call	gcry_free
		mov	eax, ds:dword_449094
		mov	[esp+428h+var_40C], 0
		mov	[esp+428h+var_410], 0
		mov	[esp+428h+var_414], 0
		mov	[esp+428h+var_418], 0
		mov	[esp+428h+var_41C], 0
		mov	[esp+428h+var_420], 0
		lea	edx, [ebp+var_402]
		mov	[esp+428h+var_424], edx
		mov	[esp+428h+var_428], eax
		call	assuan_transact
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 67h
		jz	short loc_40F772
		mov	eax, [ebp+var_14]
		mov	[esp+428h+var_428], eax
		call	sub_40E4FA
		cmp	eax, 113h
		jz	short loc_40F772
		cmp	[ebp+var_14], 0
		jz	short loc_40F772
		mov	eax, [ebp+var_14]
		jmp	loc_40F8A7
; ---------------------------------------------------------------------------

loc_40F772:				; CODE XREF: sub_40F697+B9j
					; sub_40F697+CBj ...
		mov	[esp+428h+var_424], 0 ;	int
		mov	[esp+428h+var_428], offset aPinentry_quali ; "pinentry.qualitybar.tooltip"
		call	sub_42BFF3
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40F797
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		jmp	short loc_40F7D3
; ---------------------------------------------------------------------------

loc_40F797:				; CODE XREF: sub_40F697+F6j
		mov	[esp+428h+var_428], offset aPinentry_quali ; "pinentry.qualitybar.tooltip"
		call	sub_435294
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, offset aPinentry_quali ; "pinentry.qualitybar.tooltip"
		mov	ecx, 1Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40F7D3
		mov	[ebp+var_C], offset aTheQualityOfTh ; "The quality of the text entered above.\"...

loc_40F7D3:				; CODE XREF: sub_40F697+FEj
					; sub_40F697+133j
		mov	[esp+428h+var_424], offset byte_442F79 ; char *
		mov	eax, [ebp+var_C]
		mov	[esp+428h+var_428], eax	; int
		call	sub_4335B0
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		mov	[esp+428h+var_428], eax
		call	gcry_free
		cmp	[ebp+var_10], 0
		jz	short loc_40F7FF
		mov	eax, [ebp+var_10]
		jmp	short loc_40F804
; ---------------------------------------------------------------------------

loc_40F7FF:				; CODE XREF: sub_40F697+161j
		mov	eax, offset byte_442F7F

loc_40F804:				; CODE XREF: sub_40F697+166j
		mov	[esp+428h+var_41C], eax
		mov	[esp+428h+var_420], offset aSetqualitybar_ ; "SETQUALITYBAR_TT %s"
		mov	[esp+428h+var_424], 3E9h
		lea	eax, [ebp+var_402]
		mov	[esp+428h+var_428], eax
		call	sub_4241F9
		mov	[ebp+var_19], 0
		mov	eax, [ebp+var_10]
		mov	[esp+428h+var_428], eax
		call	gcry_free
		mov	eax, ds:dword_449094
		mov	[esp+428h+var_40C], 0
		mov	[esp+428h+var_410], 0
		mov	[esp+428h+var_414], 0
		mov	[esp+428h+var_418], 0
		mov	[esp+428h+var_41C], 0
		mov	[esp+428h+var_420], 0
		lea	edx, [ebp+var_402]
		mov	[esp+428h+var_424], edx
		mov	[esp+428h+var_428], eax
		call	assuan_transact
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 67h
		jz	short loc_40F8A2
		mov	eax, [ebp+var_14]
		mov	[esp+428h+var_428], eax
		call	sub_40E4FA
		cmp	eax, 113h
		jz	short loc_40F8A2
		cmp	[ebp+var_14], 0
		jz	short loc_40F8A2
		mov	eax, [ebp+var_14]
		jmp	short loc_40F8A7
; ---------------------------------------------------------------------------

loc_40F8A2:				; CODE XREF: sub_40F697+1ECj
					; sub_40F697+1FEj ...
		mov	eax, 0

loc_40F8A7:				; CODE XREF: sub_40F697+D6j
					; sub_40F697+209j
		add	esp, 420h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40F697	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F8B1	proc near		; DATA XREF: sub_40F902+50Do

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aPassword_from_ ; "PASSWORD_FROM_CACHE"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40F8F6
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 2
		mov	eax, [ebp+var_C]
		mov	[eax], edx

loc_40F8F6:				; CODE XREF: sub_40F8B1+34j
		mov	eax, 0
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40F8B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F902(int, char *, char *, int, int,	int, int)
sub_40F902	proc near		; CODE XREF: sub_40D199+1D9p
					; sub_40D199+23Bp ...

Str		= dword	ptr -458h
SubStr		= dword	ptr -454h
var_450		= dword	ptr -450h
var_44C		= dword	ptr -44Ch
var_448		= dword	ptr -448h
var_444		= dword	ptr -444h
var_440		= dword	ptr -440h
var_43C		= dword	ptr -43Ch
var_42C		= dword	ptr -42Ch
var_424		= dword	ptr -424h
var_420		= byte ptr -420h
var_41C		= dword	ptr -41Ch
var_418		= dword	ptr -418h
var_412		= byte ptr -412h
var_29		= byte ptr -29h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 44Ch
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	eax, ds:dword_449DB0
		test	eax, eax
		jz	short loc_40F92F
		mov	eax, 0
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40F92F:				; CODE XREF: sub_40F902+21j
		cmp	[ebp+arg_10], 0
		jz	short loc_40F93F
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_40F950

loc_40F93F:				; CODE XREF: sub_40F902+31j
		mov	[esp+458h+Str],	37h
		call	sub_40E4DF
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40F950:				; CODE XREF: sub_40F902+3Bj
		cmp	[ebp+arg_4], 0
		jnz	short loc_40F970
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40F970
		mov	[esp+458h+Str],	offset aPleaseEnterYou ; "Please enter your PIN, so that the secr"...
		call	sub_435294
		mov	[ebp+arg_4], eax
		jmp	short loc_40F985
; ---------------------------------------------------------------------------

loc_40F970:				; CODE XREF: sub_40F902+52j
					; sub_40F902+5Bj
		cmp	[ebp+arg_4], 0
		jnz	short loc_40F985
		mov	[esp+458h+Str],	offset aPleaseEnterY_0 ; "Please enter your passphrase,	so that	t"...
		call	sub_435294
		mov	[ebp+arg_4], eax

loc_40F985:				; CODE XREF: sub_40F902+6Cj
					; sub_40F902+72j
		cmp	[ebp+arg_8], 0
		jz	short loc_40F9AB
		mov	[esp+458h+SubStr], offset SubStr ; "PIN"
		mov	eax, [ebp+arg_8]
		mov	[esp+458h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_24], eax
		jmp	short loc_40F9D7
; ---------------------------------------------------------------------------

loc_40F9AB:				; CODE XREF: sub_40F902+87j
		cmp	[ebp+arg_4], 0
		jz	short loc_40F9CF
		mov	[esp+458h+SubStr], offset SubStr ; "PIN"
		mov	eax, [ebp+arg_4]
		mov	[esp+458h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jz	short loc_40F9CF
		mov	eax, 1
		jmp	short loc_40F9D4
; ---------------------------------------------------------------------------

loc_40F9CF:				; CODE XREF: sub_40F902+ADj
					; sub_40F902+C4j
		mov	eax, 0

loc_40F9D4:				; CODE XREF: sub_40F902+CBj
		mov	[ebp+var_24], eax

loc_40F9D7:				; CODE XREF: sub_40F902+A7j
		mov	eax, [ebp+arg_0]
		mov	[esp+458h+Str],	eax
		call	sub_40E7CF
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40F9F3
		mov	eax, [ebp+var_1C]
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40F9F3:				; CODE XREF: sub_40F902+E7j
		cmp	[ebp+arg_14], 0
		jz	short loc_40FA55
		cmp	[ebp+arg_18], 2
		jz	short loc_40FA0B
		cmp	[ebp+arg_18], 3
		jz	short loc_40FA0B
		cmp	[ebp+arg_18], 4
		jnz	short loc_40FA55

loc_40FA0B:				; CODE XREF: sub_40F902+FBj
					; sub_40F902+101j
		cmp	[ebp+arg_18], 3
		jz	short loc_40FA25
		cmp	[ebp+arg_18], 4
		jnz	short loc_40FA1E
		mov	eax, 73h
		jmp	short loc_40FA23
; ---------------------------------------------------------------------------

loc_40FA1E:				; CODE XREF: sub_40F902+113j
		mov	eax, 6Eh

loc_40FA23:				; CODE XREF: sub_40F902+11Aj
		jmp	short loc_40FA2A
; ---------------------------------------------------------------------------

loc_40FA25:				; CODE XREF: sub_40F902+10Dj
		mov	eax, 75h

loc_40FA2A:				; CODE XREF: sub_40F902:loc_40FA23j
		mov	edx, [ebp+arg_14]
		mov	[esp+458h+var_448], edx
		mov	[esp+458h+var_44C], eax
		mov	[esp+458h+var_450], offset aSetkeyinfoCS ; "SETKEYINFO %c/%s"
		mov	[esp+458h+SubStr], 3E9h
		lea	eax, [ebp+var_412]
		mov	[esp+458h+Str],	eax
		call	sub_4241F9
		jmp	short loc_40FA73
; ---------------------------------------------------------------------------

loc_40FA55:				; CODE XREF: sub_40F902+F5j
					; sub_40F902+107j
		mov	[esp+458h+var_450], offset aSetkeyinfoClea ; "SETKEYINFO --clear"
		mov	[esp+458h+SubStr], 3E9h
		lea	eax, [ebp+var_412]
		mov	[esp+458h+Str],	eax
		call	sub_4241F9

loc_40FA73:				; CODE XREF: sub_40F902+151j
		mov	eax, ds:dword_449094
		mov	[esp+458h+var_43C], 0
		mov	[esp+458h+var_440], 0
		mov	[esp+458h+var_444], 0
		mov	[esp+458h+var_448], 0
		mov	[esp+458h+var_44C], 0
		mov	[esp+458h+var_450], 0
		lea	edx, [ebp+var_412]
		mov	[esp+458h+SubStr], edx
		mov	[esp+458h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40FAE5
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E4FA
		cmp	eax, 113h
		jz	short loc_40FAE5
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E629
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40FAE5:				; CODE XREF: sub_40F902+1BFj
					; sub_40F902+1D1j
		mov	eax, [ebp+arg_4]
		mov	[esp+458h+var_44C], eax
		mov	[esp+458h+var_450], offset aSetdescS ; "SETDESC	%s"
		mov	[esp+458h+SubStr], 3E9h
		lea	eax, [ebp+var_412]
		mov	[esp+458h+Str],	eax
		call	sub_4241F9
		mov	[ebp+var_29], 0
		mov	eax, ds:dword_449094
		mov	[esp+458h+var_43C], 0
		mov	[esp+458h+var_440], 0
		mov	[esp+458h+var_444], 0
		mov	[esp+458h+var_448], 0
		mov	[esp+458h+var_44C], 0
		mov	[esp+458h+var_450], 0
		lea	edx, [ebp+var_412]
		mov	[esp+458h+SubStr], edx
		mov	[esp+458h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40FB6E
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E629
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40FB6E:				; CODE XREF: sub_40F902+25Aj
		cmp	[ebp+arg_8], 0
		jnz	short loc_40FB88
		cmp	[ebp+var_24], 0
		jz	short loc_40FB81
		mov	eax, offset aPin_0 ; "PIN:"
		jmp	short loc_40FB86
; ---------------------------------------------------------------------------

loc_40FB81:				; CODE XREF: sub_40F902+276j
		mov	eax, offset aPassphrase	; "Passphrase:"

loc_40FB86:				; CODE XREF: sub_40F902+27Dj
		jmp	short loc_40FB8B
; ---------------------------------------------------------------------------

loc_40FB88:				; CODE XREF: sub_40F902+270j
		mov	eax, [ebp+arg_8]

loc_40FB8B:				; CODE XREF: sub_40F902:loc_40FB86j
		mov	[esp+458h+var_44C], eax
		mov	[esp+458h+var_450], offset aSetpromptS ; "SETPROMPT %s"
		mov	[esp+458h+SubStr], 3E9h
		lea	eax, [ebp+var_412]
		mov	[esp+458h+Str],	eax
		call	sub_4241F9
		mov	[ebp+var_29], 0
		mov	eax, ds:dword_449094
		mov	[esp+458h+var_43C], 0
		mov	[esp+458h+var_440], 0
		mov	[esp+458h+var_444], 0
		mov	[esp+458h+var_448], 0
		mov	[esp+458h+var_44C], 0
		mov	[esp+458h+var_450], 0
		lea	edx, [ebp+var_412]
		mov	[esp+458h+SubStr], edx
		mov	[esp+458h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40FC11
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E629
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40FC11:				; CODE XREF: sub_40F902+2FDj
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40FC42
		mov	eax, ds:dword_449DF4
		test	eax, eax
		jz	short loc_40FC42
		call	sub_40F697
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40FC42
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E629
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40FC42:				; CODE XREF: sub_40F902+317j
					; sub_40F902+320j ...
		cmp	[ebp+arg_C], 0
		jz	loc_4100A9
		mov	eax, [ebp+arg_C]
		mov	[esp+458h+var_44C], eax
		mov	[esp+458h+var_450], offset aSeterrorS ;	"SETERROR %s"
		mov	[esp+458h+SubStr], 3E9h
		lea	eax, [ebp+var_412]
		mov	[esp+458h+Str],	eax
		call	sub_4241F9
		mov	[ebp+var_29], 0
		mov	eax, ds:dword_449094
		mov	[esp+458h+var_43C], 0
		mov	[esp+458h+var_440], 0
		mov	[esp+458h+var_444], 0
		mov	[esp+458h+var_448], 0
		mov	[esp+458h+var_44C], 0
		mov	[esp+458h+var_450], 0
		lea	edx, [ebp+var_412]
		mov	[esp+458h+SubStr], edx
		mov	[esp+458h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_4100A9
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E629
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40FCD9:				; CODE XREF: sub_40F902+7B6j
		lea	eax, [ebp+var_420]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+20h]
		mov	[ebp+var_41C], eax
		mov	eax, [ebp+arg_10]
		mov	byte ptr [eax+24h], 0
		mov	eax, [ebp+arg_10]
		add	eax, 24h
		mov	[ebp+var_418], eax
		cmp	[ebp+var_20], 0
		jz	loc_40FDCB
		mov	eax, [ebp+arg_10]
		mov	ebx, [eax+8]
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+0Ch]
		lea	esi, [eax+1]
		mov	[esp+458h+Str],	offset aSeterrorSTryDO ; "SETERROR %s (try %d of %d)"
		call	sub_435294
		mov	[esp+458h+var_444], ebx
		mov	[esp+458h+var_448], esi
		mov	edx, [ebp+var_20]
		mov	[esp+458h+var_44C], edx
		mov	[esp+458h+var_450], eax
		mov	[esp+458h+SubStr], 3E9h
		lea	eax, [ebp+var_412]
		mov	[esp+458h+Str],	eax
		call	sub_4241F9
		mov	[ebp+var_29], 0
		mov	eax, ds:dword_449094
		mov	[esp+458h+var_43C], 0
		mov	[esp+458h+var_440], 0
		mov	[esp+458h+var_444], 0
		mov	[esp+458h+var_448], 0
		mov	[esp+458h+var_44C], 0
		mov	[esp+458h+var_450], 0
		lea	edx, [ebp+var_412]
		mov	[esp+458h+SubStr], edx
		mov	[esp+458h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40FDC4
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E629
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40FDC4:				; CODE XREF: sub_40F902+4B0j
		mov	[ebp+var_20], 0

loc_40FDCB:				; CODE XREF: sub_40F902+414j
		mov	eax, ds:dword_449094
		mov	[esp+458h+SubStr], 2
		mov	[esp+458h+Str],	eax
		call	assuan_get_flag
		mov	[ebp+var_28], eax
		mov	eax, ds:dword_449094
		mov	[esp+458h+Str],	eax
		call	assuan_begin_confidential
		mov	[ebp+var_424], 0
		mov	edx, ds:dword_449094
		mov	eax, ds:dword_449094
		lea	ecx, [ebp+var_424]
		mov	[esp+458h+var_43C], ecx
		mov	[esp+458h+var_440], offset sub_40F8B1
		mov	[esp+458h+var_444], edx
		mov	[esp+458h+var_448], offset sub_40F547
		lea	edx, [ebp+var_420]
		mov	[esp+458h+var_44C], edx
		mov	[esp+458h+var_450], offset sub_40F26D
		mov	[esp+458h+SubStr], offset aGetpin ; "GETPIN"
		mov	[esp+458h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_449094
		mov	edx, [ebp+var_28]
		mov	[esp+458h+var_450], edx
		mov	[esp+458h+SubStr], 2
		mov	[esp+458h+Str],	eax
		call	assuan_set_flag
		cmp	[ebp+var_1C], 0
		jz	short loc_40FEA9
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E507
		test	eax, eax
		jz	short loc_40FEA9
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E4FA
		cmp	eax, 115h
		jnz	short loc_40FEA9
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E507
		mov	[esp+458h+SubStr], 63h
		mov	[esp+458h+Str],	eax
		call	sub_40E4B8
		mov	[ebp+var_1C], eax

loc_40FEA9:				; CODE XREF: sub_40F902+566j
					; sub_40F902+575j ...
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E4FA
		cmp	eax, 111h
		jnz	short loc_40FEE0
		cmp	[ebp+var_24], 0
		jz	short loc_40FECF
		mov	[esp+458h+Str],	offset aPinTooLong ; "PIN too long"
		call	sub_435294
		jmp	short loc_40FEDB
; ---------------------------------------------------------------------------

loc_40FECF:				; CODE XREF: sub_40F902+5BDj
		mov	[esp+458h+Str],	offset aPassphraseTooL ; "Passphrase too long"
		call	sub_435294

loc_40FEDB:				; CODE XREF: sub_40F902+5CBj
		mov	[ebp+var_20], eax
		jmp	short loc_40FEF6
; ---------------------------------------------------------------------------

loc_40FEE0:				; CODE XREF: sub_40F902+5B7j
		cmp	[ebp+var_1C], 0
		jz	short loc_40FEF6
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E629
		jmp	loc_4100E3
; ---------------------------------------------------------------------------

loc_40FEF6:				; CODE XREF: sub_40F902+5DCj
					; sub_40F902+5E2j
		cmp	[ebp+var_20], 0
		jnz	loc_40FFC0
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_40FFC0
		mov	eax, [ebp+arg_10]
		add	eax, 24h
		mov	[esp+458h+Str],	eax
		call	sub_40F2E4
		test	eax, eax
		jnz	short loc_40FF33
		mov	[esp+458h+Str],	offset aInvalidCharact ; "Invalid characters in	PIN"
		call	sub_435294
		mov	[ebp+var_20], eax
		jmp	loc_40FFC0
; ---------------------------------------------------------------------------

loc_40FF33:				; CODE XREF: sub_40F902+61Bj
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40FF80
		mov	eax, [ebp+arg_10]
		add	eax, 24h
		mov	[ebp+var_42C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_42C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		cmp	edx, eax
		jbe	short loc_40FF80
		mov	[esp+458h+Str],	offset aPinTooLong ; "PIN too long"
		call	sub_435294
		mov	[ebp+var_20], eax
		jmp	short loc_40FFC0
; ---------------------------------------------------------------------------

loc_40FF80:				; CODE XREF: sub_40F902+639j
					; sub_40F902+66Bj
		mov	eax, [ebp+arg_10]
		add	eax, 24h
		mov	[ebp+var_42C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_42C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		cmp	edx, eax
		jnb	short loc_40FFC0
		mov	[esp+458h+Str],	offset aPinTooShort ; "PIN too short"
		call	sub_435294
		mov	[ebp+var_20], eax

loc_40FFC0:				; CODE XREF: sub_40F902+5F8j
					; sub_40F902+605j ...
		cmp	[ebp+var_20], 0
		jnz	loc_410066
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	loc_410066
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_10]
		mov	edx, [eax+14h]
		mov	eax, [ebp+arg_10]
		mov	[esp+458h+Str],	eax
		call	edx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_41000E
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_41000E
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_20], eax
		jmp	short loc_410066
; ---------------------------------------------------------------------------

loc_41000E:				; CODE XREF: sub_40F902+6F5j
					; sub_40F902+6FFj
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E4FA
		cmp	eax, 0Bh
		jz	short loc_41002E
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E4FA
		cmp	eax, 57h
		jnz	short loc_410053

loc_41002E:				; CODE XREF: sub_40F902+71Aj
		cmp	[ebp+var_24], 0
		jz	short loc_410042
		mov	[esp+458h+Str],	offset aBadPin ; "Bad PIN"
		call	sub_435294
		jmp	short loc_41004E
; ---------------------------------------------------------------------------

loc_410042:				; CODE XREF: sub_40F902+730j
		mov	[esp+458h+Str],	offset aBadPassphrase ;	"Bad Passphrase"
		call	sub_435294

loc_41004E:				; CODE XREF: sub_40F902+73Ej
		mov	[ebp+var_20], eax
		jmp	short loc_410066
; ---------------------------------------------------------------------------

loc_410053:				; CODE XREF: sub_40F902+72Aj
		cmp	[ebp+var_1C], 0
		jz	short loc_410066
		mov	eax, [ebp+var_1C]
		mov	[esp+458h+Str],	eax
		call	sub_40E629
		jmp	short loc_4100E3
; ---------------------------------------------------------------------------

loc_410066:				; CODE XREF: sub_40F902+6C2j
					; sub_40F902+6D0j ...
		cmp	[ebp+var_20], 0
		jnz	short loc_41007A
		mov	[esp+458h+Str],	0
		call	sub_40E629
		jmp	short loc_4100E3
; ---------------------------------------------------------------------------

loc_41007A:				; CODE XREF: sub_40F902+768j
		mov	eax, [ebp+var_424]
		and	eax, 200h
		test	eax, eax
		jz	short loc_410098
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+0Ch]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_10]
		mov	[eax+0Ch], edx

loc_410098:				; CODE XREF: sub_40F902+785j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+0Ch]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_10]
		mov	[eax+0Ch], edx
		jmp	short loc_4100AA
; ---------------------------------------------------------------------------

loc_4100A9:				; CODE XREF: sub_40F902+344j
					; sub_40F902+3C1j
		nop

loc_4100AA:				; CODE XREF: sub_40F902+7A5j
		mov	eax, [ebp+arg_10]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		cmp	edx, eax
		jl	loc_40FCD9
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4100CE
		mov	eax, 57h
		jmp	short loc_4100D3
; ---------------------------------------------------------------------------

loc_4100CE:				; CODE XREF: sub_40F902+7C3j
		mov	eax, 0Bh

loc_4100D3:				; CODE XREF: sub_40F902+7CAj
		mov	[esp+458h+Str],	eax
		call	sub_40E4DF
		mov	[esp+458h+Str],	eax
		call	sub_40E629

loc_4100E3:				; CODE XREF: sub_40F902+28j
					; sub_40F902+49j ...
		add	esp, 44Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40F902	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4100EE(int, int, char	*, int,	int, int, int, int)
sub_4100EE	proc near		; CODE XREF: sub_4074BA+414p
					; sub_4074BA+4B1p

Str		= dword	ptr -428h
SubStr		= dword	ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= byte ptr -408h
var_404		= dword	ptr -404h
var_400		= dword	ptr -400h
var_3FA		= byte ptr -3FAh
var_11		= byte ptr -11h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 428h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_449DB0
		test	eax, eax
		jz	short loc_41011A
		mov	[esp+428h+Str],	0Bh
		call	sub_40E4DF
		jmp	locret_4105AE
; ---------------------------------------------------------------------------

loc_41011A:				; CODE XREF: sub_4100EE+19j
		mov	eax, [ebp+arg_0]
		mov	[esp+428h+Str],	eax
		call	sub_40E7CF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410136
		mov	eax, [ebp+var_C]
		jmp	locret_4105AE
; ---------------------------------------------------------------------------

loc_410136:				; CODE XREF: sub_4100EE+3Ej
		cmp	[ebp+arg_C], 0
		jnz	short loc_41016F
		cmp	[ebp+arg_8], 0
		jz	short loc_410159
		mov	[esp+428h+SubStr], offset SubStr ; "PIN"
		mov	eax, [ebp+arg_8]
		mov	[esp+428h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jnz	short loc_410167

loc_410159:				; CODE XREF: sub_4100EE+52j
		mov	[esp+428h+Str],	offset aPassphrase_0 ; "Passphrase"
		call	sub_435294
		jmp	short loc_41016C
; ---------------------------------------------------------------------------

loc_410167:				; CODE XREF: sub_4100EE+69j
		mov	eax, offset SubStr ; "PIN"

loc_41016C:				; CODE XREF: sub_4100EE+77j
		mov	[ebp+arg_C], eax

loc_41016F:				; CODE XREF: sub_4100EE+4Cj
		cmp	[ebp+arg_18], 0
		jz	short loc_4101D1
		cmp	[ebp+arg_1C], 2
		jz	short loc_410187
		cmp	[ebp+arg_1C], 3
		jz	short loc_410187
		cmp	[ebp+arg_1C], 4
		jnz	short loc_4101D1

loc_410187:				; CODE XREF: sub_4100EE+8Bj
					; sub_4100EE+91j
		cmp	[ebp+arg_1C], 3
		jz	short loc_4101A1
		cmp	[ebp+arg_1C], 4
		jnz	short loc_41019A
		mov	eax, 73h
		jmp	short loc_41019F
; ---------------------------------------------------------------------------

loc_41019A:				; CODE XREF: sub_4100EE+A3j
		mov	eax, 6Eh

loc_41019F:				; CODE XREF: sub_4100EE+AAj
		jmp	short loc_4101A6
; ---------------------------------------------------------------------------

loc_4101A1:				; CODE XREF: sub_4100EE+9Dj
		mov	eax, 75h

loc_4101A6:				; CODE XREF: sub_4100EE:loc_41019Fj
		mov	edx, [ebp+arg_18]
		mov	[esp+428h+var_418], edx
		mov	[esp+428h+var_41C], eax
		mov	[esp+428h+var_420], offset aSetkeyinfoCS ; "SETKEYINFO %c/%s"
		mov	[esp+428h+SubStr], 3E9h
		lea	eax, [ebp+var_3FA]
		mov	[esp+428h+Str],	eax
		call	sub_4241F9
		jmp	short loc_4101EF
; ---------------------------------------------------------------------------

loc_4101D1:				; CODE XREF: sub_4100EE+85j
					; sub_4100EE+97j
		mov	[esp+428h+var_420], offset aSetkeyinfoClea ; "SETKEYINFO --clear"
		mov	[esp+428h+SubStr], 3E9h
		lea	eax, [ebp+var_3FA]
		mov	[esp+428h+Str],	eax
		call	sub_4241F9

loc_4101EF:				; CODE XREF: sub_4100EE+E1j
		mov	eax, ds:dword_449094
		mov	[esp+428h+var_40C], 0
		mov	[esp+428h+var_410], 0
		mov	[esp+428h+var_414], 0
		mov	[esp+428h+var_418], 0
		mov	[esp+428h+var_41C], 0
		mov	[esp+428h+var_420], 0
		lea	edx, [ebp+var_3FA]
		mov	[esp+428h+SubStr], edx
		mov	[esp+428h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410261
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E4FA
		cmp	eax, 113h
		jz	short loc_410261
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E629
		jmp	locret_4105AE
; ---------------------------------------------------------------------------

loc_410261:				; CODE XREF: sub_4100EE+14Fj
					; sub_4100EE+161j
		cmp	[ebp+arg_8], 0
		jz	short loc_41028E
		mov	eax, [ebp+arg_8]
		mov	[esp+428h+var_41C], eax
		mov	[esp+428h+var_420], offset aSetdescS ; "SETDESC	%s"
		mov	[esp+428h+SubStr], 3E9h
		lea	eax, [ebp+var_3FA]
		mov	[esp+428h+Str],	eax
		call	sub_4241F9
		jmp	short loc_4102AC
; ---------------------------------------------------------------------------

loc_41028E:				; CODE XREF: sub_4100EE+177j
		mov	[esp+428h+var_420], offset aReset ; "RESET"
		mov	[esp+428h+SubStr], 3E9h
		lea	eax, [ebp+var_3FA]
		mov	[esp+428h+Str],	eax
		call	sub_4241F9

loc_4102AC:				; CODE XREF: sub_4100EE+19Ej
		mov	[ebp+var_11], 0
		mov	eax, ds:dword_449094
		mov	[esp+428h+var_40C], 0
		mov	[esp+428h+var_410], 0
		mov	[esp+428h+var_414], 0
		mov	[esp+428h+var_418], 0
		mov	[esp+428h+var_41C], 0
		mov	[esp+428h+var_420], 0
		lea	edx, [ebp+var_3FA]
		mov	[esp+428h+SubStr], edx
		mov	[esp+428h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410310
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E629
		jmp	locret_4105AE
; ---------------------------------------------------------------------------

loc_410310:				; CODE XREF: sub_4100EE+210j
		mov	eax, [ebp+arg_C]
		mov	[esp+428h+var_41C], eax
		mov	[esp+428h+var_420], offset aSetpromptS ; "SETPROMPT %s"
		mov	[esp+428h+SubStr], 3E9h
		lea	eax, [ebp+var_3FA]
		mov	[esp+428h+Str],	eax
		call	sub_4241F9
		mov	[ebp+var_11], 0
		mov	eax, ds:dword_449094
		mov	[esp+428h+var_40C], 0
		mov	[esp+428h+var_410], 0
		mov	[esp+428h+var_414], 0
		mov	[esp+428h+var_418], 0
		mov	[esp+428h+var_41C], 0
		mov	[esp+428h+var_420], 0
		lea	edx, [ebp+var_3FA]
		mov	[esp+428h+SubStr], edx
		mov	[esp+428h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410399
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E629
		jmp	locret_4105AE
; ---------------------------------------------------------------------------

loc_410399:				; CODE XREF: sub_4100EE+299j
		cmp	[ebp+arg_14], 0
		jz	short loc_4103C6
		mov	eax, ds:dword_449DF4
		test	eax, eax
		jz	short loc_4103C6
		call	sub_40F697
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4103C6
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E629
		jmp	locret_4105AE
; ---------------------------------------------------------------------------

loc_4103C6:				; CODE XREF: sub_4100EE+2AFj
					; sub_4100EE+2B8j ...
		cmp	[ebp+arg_10], 0
		jz	loc_410459
		mov	eax, [ebp+arg_10]
		mov	[esp+428h+var_41C], eax
		mov	[esp+428h+var_420], offset aSeterrorS ;	"SETERROR %s"
		mov	[esp+428h+SubStr], 3E9h
		lea	eax, [ebp+var_3FA]
		mov	[esp+428h+Str],	eax
		call	sub_4241F9
		mov	[ebp+var_11], 0
		mov	eax, ds:dword_449094
		mov	[esp+428h+var_40C], 0
		mov	[esp+428h+var_410], 0
		mov	[esp+428h+var_414], 0
		mov	[esp+428h+var_418], 0
		mov	[esp+428h+var_41C], 0
		mov	[esp+428h+var_420], 0
		lea	edx, [ebp+var_3FA]
		mov	[esp+428h+SubStr], edx
		mov	[esp+428h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410459
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E629
		jmp	locret_4105AE
; ---------------------------------------------------------------------------

loc_410459:				; CODE XREF: sub_4100EE+2DCj
					; sub_4100EE+359j
		lea	eax, [ebp+var_408]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_404], 1F0h
		mov	eax, [ebp+var_404]
		add	eax, 0Ah
		mov	[esp+428h+Str],	eax
		call	gcry_malloc_secure
		mov	[ebp+var_400], eax
		mov	eax, [ebp+var_400]
		test	eax, eax
		jnz	short loc_4104B0
		call	sub_40E52A
		mov	[esp+428h+Str],	eax
		call	sub_40E629
		jmp	locret_4105AE
; ---------------------------------------------------------------------------

loc_4104B0:				; CODE XREF: sub_4100EE+3AEj
		mov	eax, ds:dword_449094
		mov	[esp+428h+SubStr], 2
		mov	[esp+428h+Str],	eax
		call	assuan_get_flag
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_449094
		mov	[esp+428h+Str],	eax
		call	assuan_begin_confidential
		mov	edx, ds:dword_449094
		mov	eax, ds:dword_449094
		mov	[esp+428h+var_40C], 0
		mov	[esp+428h+var_410], 0
		mov	[esp+428h+var_414], edx
		mov	[esp+428h+var_418], offset sub_40F547
		lea	edx, [ebp+var_408]
		mov	[esp+428h+var_41C], edx
		mov	[esp+428h+var_420], offset sub_40F26D
		mov	[esp+428h+SubStr], offset aGetpin ; "GETPIN"
		mov	[esp+428h+Str],	eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449094
		mov	edx, [ebp+var_10]
		mov	[esp+428h+var_420], edx
		mov	[esp+428h+SubStr], 2
		mov	[esp+428h+Str],	eax
		call	assuan_set_flag
		cmp	[ebp+var_C], 0
		jz	short loc_410582
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E507
		test	eax, eax
		jz	short loc_410582
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E4FA
		cmp	eax, 115h
		jnz	short loc_410582
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E507
		mov	[esp+428h+SubStr], 63h
		mov	[esp+428h+Str],	eax
		call	sub_40E4B8
		mov	[ebp+var_C], eax

loc_410582:				; CODE XREF: sub_4100EE+453j
					; sub_4100EE+462j ...
		cmp	[ebp+var_C], 0
		jz	short loc_410598
		mov	eax, [ebp+var_400]
		mov	[esp+428h+Str],	eax
		call	gcry_free
		jmp	short loc_4105A3
; ---------------------------------------------------------------------------

loc_410598:				; CODE XREF: sub_4100EE+498j
		mov	edx, [ebp+var_400]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_4105A3:				; CODE XREF: sub_4100EE+4A8j
		mov	eax, [ebp+var_C]
		mov	[esp+428h+Str],	eax
		call	sub_40E629

locret_4105AE:				; CODE XREF: sub_4100EE+27j
					; sub_4100EE+43j ...
		leave
		retn
sub_4100EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4105B0	proc near		; CODE XREF: sub_407B71+E5p
					; sub_40C7DB+1EBp ...

var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= dword	ptr -404h
var_400		= dword	ptr -400h
var_3FC		= dword	ptr -3FCh
var_3F6		= byte ptr -3F6h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 418h
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+var_418], eax
		call	sub_40E7CF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4105D5
		mov	eax, [ebp+var_C]
		jmp	locret_41091B
; ---------------------------------------------------------------------------

loc_4105D5:				; CODE XREF: sub_4105B0+1Bj
		cmp	[ebp+arg_4], 0
		jz	short loc_410602
		mov	eax, [ebp+arg_4]
		mov	[esp+418h+var_40C], eax
		mov	[esp+418h+var_410], offset aSetdescS ; "SETDESC	%s"
		mov	[esp+418h+var_414], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+418h+var_418], eax
		call	sub_4241F9
		jmp	short loc_410620
; ---------------------------------------------------------------------------

loc_410602:				; CODE XREF: sub_4105B0+29j
		mov	[esp+418h+var_410], offset aReset ; "RESET"
		mov	[esp+418h+var_414], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+418h+var_418], eax
		call	sub_4241F9

loc_410620:				; CODE XREF: sub_4105B0+50j
		mov	[ebp+var_D], 0
		mov	eax, ds:dword_449094
		mov	[esp+418h+var_3FC], 0
		mov	[esp+418h+var_400], 0
		mov	[esp+418h+var_404], 0
		mov	[esp+418h+var_408], 0
		mov	[esp+418h+var_40C], 0
		mov	[esp+418h+var_410], 0
		lea	edx, [ebp+var_3F6]
		mov	[esp+418h+var_414], edx
		mov	[esp+418h+var_418], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4106B3
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E507
		test	eax, eax
		jz	short loc_4106B3
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E4FA
		cmp	eax, 115h
		jnz	short loc_4106B3
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E507
		mov	[esp+418h+var_414], 63h
		mov	[esp+418h+var_418], eax
		call	sub_40E4B8
		mov	[ebp+var_C], eax

loc_4106B3:				; CODE XREF: sub_4105B0+C2j
					; sub_4105B0+D1j ...
		cmp	[ebp+var_C], 0
		jz	short loc_4106C9
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E629
		jmp	locret_41091B
; ---------------------------------------------------------------------------

loc_4106C9:				; CODE XREF: sub_4105B0+107j
		cmp	[ebp+arg_8], 0
		jz	loc_41075C
		mov	eax, [ebp+arg_8]
		mov	[esp+418h+var_40C], eax
		mov	[esp+418h+var_410], offset aSetokS ; "SETOK %s"
		mov	[esp+418h+var_414], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+418h+var_418], eax
		call	sub_4241F9
		mov	[ebp+var_D], 0
		mov	eax, ds:dword_449094
		mov	[esp+418h+var_3FC], 0
		mov	[esp+418h+var_400], 0
		mov	[esp+418h+var_404], 0
		mov	[esp+418h+var_408], 0
		mov	[esp+418h+var_40C], 0
		mov	[esp+418h+var_410], 0
		lea	edx, [ebp+var_3F6]
		mov	[esp+418h+var_414], edx
		mov	[esp+418h+var_418], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41075C
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E629
		jmp	locret_41091B
; ---------------------------------------------------------------------------

loc_41075C:				; CODE XREF: sub_4105B0+11Dj
					; sub_4105B0+19Aj
		cmp	[ebp+arg_C], 0
		jz	loc_410883
		cmp	[ebp+arg_10], 0
		jz	short loc_4107E1
		mov	eax, [ebp+arg_C]
		mov	[esp+418h+var_40C], eax
		mov	[esp+418h+var_410], offset aSetnotokS ;	"SETNOTOK %s"
		mov	[esp+418h+var_414], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+418h+var_418], eax
		call	sub_4241F9
		mov	[ebp+var_D], 0
		mov	eax, ds:dword_449094
		mov	[esp+418h+var_3FC], 0
		mov	[esp+418h+var_400], 0
		mov	[esp+418h+var_404], 0
		mov	[esp+418h+var_408], 0
		mov	[esp+418h+var_40C], 0
		mov	[esp+418h+var_410], 0
		lea	edx, [ebp+var_3F6]
		mov	[esp+418h+var_414], edx
		mov	[esp+418h+var_418], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		jmp	short loc_4107E8
; ---------------------------------------------------------------------------

loc_4107E1:				; CODE XREF: sub_4105B0+1BAj
		mov	[ebp+var_C], 113h

loc_4107E8:				; CODE XREF: sub_4105B0+22Fj
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E4FA
		cmp	eax, 113h
		jnz	short loc_41086D
		mov	eax, [ebp+arg_C]
		mov	[esp+418h+var_40C], eax
		mov	[esp+418h+var_410], offset aSetcancelS ; "SETCANCEL %s"
		mov	[esp+418h+var_414], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+418h+var_418], eax
		call	sub_4241F9
		mov	[ebp+var_D], 0
		mov	eax, ds:dword_449094
		mov	[esp+418h+var_3FC], 0
		mov	[esp+418h+var_400], 0
		mov	[esp+418h+var_404], 0
		mov	[esp+418h+var_408], 0
		mov	[esp+418h+var_40C], 0
		mov	[esp+418h+var_410], 0
		lea	edx, [ebp+var_3F6]
		mov	[esp+418h+var_414], edx
		mov	[esp+418h+var_418], eax
		call	assuan_transact
		mov	[ebp+var_C], eax

loc_41086D:				; CODE XREF: sub_4105B0+248j
		cmp	[ebp+var_C], 0
		jz	short loc_410883
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E629
		jmp	locret_41091B
; ---------------------------------------------------------------------------

loc_410883:				; CODE XREF: sub_4105B0+1B0j
					; sub_4105B0+2C1j
		mov	eax, ds:dword_449094
		mov	[esp+418h+var_3FC], 0
		mov	[esp+418h+var_400], 0
		mov	[esp+418h+var_404], 0
		mov	[esp+418h+var_408], 0
		mov	[esp+418h+var_40C], 0
		mov	[esp+418h+var_410], 0
		mov	[esp+418h+var_414], offset aConfirm_1 ;	"CONFIRM"
		mov	[esp+418h+var_418], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410910
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E507
		test	eax, eax
		jz	short loc_410910
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E4FA
		cmp	eax, 115h
		jnz	short loc_410910
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E507
		mov	[esp+418h+var_414], 63h
		mov	[esp+418h+var_418], eax
		call	sub_40E4B8
		mov	[ebp+var_C], eax

loc_410910:				; CODE XREF: sub_4105B0+31Fj
					; sub_4105B0+32Ej ...
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E629

locret_41091B:				; CODE XREF: sub_4105B0+20j
					; sub_4105B0+114j ...
		leave
		retn
sub_4105B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41091D	proc near		; CODE XREF: sub_4143E4+2Cp

var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= dword	ptr -404h
var_400		= dword	ptr -400h
var_3FC		= dword	ptr -3FCh
var_3F6		= byte ptr -3F6h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 418h
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+var_418], eax
		call	sub_40E7CF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410942
		mov	eax, [ebp+var_C]
		jmp	locret_410B61
; ---------------------------------------------------------------------------

loc_410942:				; CODE XREF: sub_41091D+1Bj
		cmp	[ebp+arg_4], 0
		jz	short loc_41096F
		mov	eax, [ebp+arg_4]
		mov	[esp+418h+var_40C], eax
		mov	[esp+418h+var_410], offset aSetdescS ; "SETDESC	%s"
		mov	[esp+418h+var_414], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+418h+var_418], eax
		call	sub_4241F9
		jmp	short loc_41098D
; ---------------------------------------------------------------------------

loc_41096F:				; CODE XREF: sub_41091D+29j
		mov	[esp+418h+var_410], offset aReset ; "RESET"
		mov	[esp+418h+var_414], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+418h+var_418], eax
		call	sub_4241F9

loc_41098D:				; CODE XREF: sub_41091D+50j
		mov	[ebp+var_D], 0
		mov	eax, ds:dword_449094
		mov	[esp+418h+var_3FC], 0
		mov	[esp+418h+var_400], 0
		mov	[esp+418h+var_404], 0
		mov	[esp+418h+var_408], 0
		mov	[esp+418h+var_40C], 0
		mov	[esp+418h+var_410], 0
		lea	edx, [ebp+var_3F6]
		mov	[esp+418h+var_414], edx
		mov	[esp+418h+var_418], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410A20
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E507
		test	eax, eax
		jz	short loc_410A20
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E4FA
		cmp	eax, 115h
		jnz	short loc_410A20
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E507
		mov	[esp+418h+var_414], 63h
		mov	[esp+418h+var_418], eax
		call	sub_40E4B8
		mov	[ebp+var_C], eax

loc_410A20:				; CODE XREF: sub_41091D+C2j
					; sub_41091D+D1j ...
		cmp	[ebp+var_C], 0
		jz	short loc_410A36
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E629
		jmp	locret_410B61
; ---------------------------------------------------------------------------

loc_410A36:				; CODE XREF: sub_41091D+107j
		cmp	[ebp+arg_8], 0
		jz	loc_410AC9
		mov	eax, [ebp+arg_8]
		mov	[esp+418h+var_40C], eax
		mov	[esp+418h+var_410], offset aSetokS ; "SETOK %s"
		mov	[esp+418h+var_414], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+418h+var_418], eax
		call	sub_4241F9
		mov	[ebp+var_D], 0
		mov	eax, ds:dword_449094
		mov	[esp+418h+var_3FC], 0
		mov	[esp+418h+var_400], 0
		mov	[esp+418h+var_404], 0
		mov	[esp+418h+var_408], 0
		mov	[esp+418h+var_40C], 0
		mov	[esp+418h+var_410], 0
		lea	edx, [ebp+var_3F6]
		mov	[esp+418h+var_414], edx
		mov	[esp+418h+var_418], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410AC9
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E629
		jmp	locret_410B61
; ---------------------------------------------------------------------------

loc_410AC9:				; CODE XREF: sub_41091D+11Dj
					; sub_41091D+19Aj
		mov	eax, ds:dword_449094
		mov	[esp+418h+var_3FC], 0
		mov	[esp+418h+var_400], 0
		mov	[esp+418h+var_404], 0
		mov	[esp+418h+var_408], 0
		mov	[esp+418h+var_40C], 0
		mov	[esp+418h+var_410], 0
		mov	[esp+418h+var_414], offset aConfirmOneButt ; "CONFIRM --one-button"
		mov	[esp+418h+var_418], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410B56
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E507
		test	eax, eax
		jz	short loc_410B56
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E4FA
		cmp	eax, 115h
		jnz	short loc_410B56
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E507
		mov	[esp+418h+var_414], 63h
		mov	[esp+418h+var_418], eax
		call	sub_40E4B8
		mov	[ebp+var_C], eax

loc_410B56:				; CODE XREF: sub_41091D+1F8j
					; sub_41091D+207j ...
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E629

locret_410B61:				; CODE XREF: sub_41091D+20j
					; sub_41091D+114j ...
		leave
		retn
sub_41091D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B63	proc near		; DATA XREF: sub_410BBF+1D2o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449094
		mov	[esp+28h+var_C], 0
		mov	[esp+28h+var_10], 0
		mov	[esp+28h+var_14], 0
		mov	[esp+28h+var_18], 0
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset aConfirmOneButt ; "CONFIRM --one-button"
		mov	[esp+28h+var_28], eax
		call	assuan_transact
		mov	ds:dword_4490A4, 1
		mov	eax, 0
		leave
		retn
sub_410B63	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410BBF	proc near		; CODE XREF: sub_4196E6+1C2p
					; sub_4196E6+1EDp

var_428		= dword	ptr -428h
var_424		= byte ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_3FA		= byte ptr -3FAh
var_11		= byte ptr -11h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 428h
		mov	eax, [ebp+arg_0]
		mov	[esp+428h+var_428], eax
		call	sub_40E7CF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410BE4
		mov	eax, [ebp+var_C]
		jmp	locret_410E03
; ---------------------------------------------------------------------------

loc_410BE4:				; CODE XREF: sub_410BBF+1Bj
		cmp	[ebp+arg_4], 0
		jz	short loc_410C11
		mov	eax, [ebp+arg_4]
		mov	[esp+428h+var_41C], eax
		mov	[esp+428h+var_420], offset aSetdescS ; "SETDESC	%s"
		mov	dword ptr [esp+428h+var_424], 3E9h
		lea	eax, [ebp+var_3FA]
		mov	[esp+428h+var_428], eax
		call	sub_4241F9
		jmp	short loc_410C2F
; ---------------------------------------------------------------------------

loc_410C11:				; CODE XREF: sub_410BBF+29j
		mov	[esp+428h+var_420], offset aReset ; "RESET"
		mov	dword ptr [esp+428h+var_424], 3E9h
		lea	eax, [ebp+var_3FA]
		mov	[esp+428h+var_428], eax
		call	sub_4241F9

loc_410C2F:				; CODE XREF: sub_410BBF+50j
		mov	[ebp+var_11], 0
		mov	eax, ds:dword_449094
		mov	[esp+428h+var_40C], 0
		mov	[esp+428h+var_410], 0
		mov	[esp+428h+var_414], 0
		mov	[esp+428h+var_418], 0
		mov	[esp+428h+var_41C], 0
		mov	[esp+428h+var_420], 0
		lea	edx, [ebp+var_3FA]
		mov	dword ptr [esp+428h+var_424], edx
		mov	[esp+428h+var_428], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410C93
		mov	eax, [ebp+var_C]
		mov	[esp+428h+var_428], eax
		call	sub_40E629
		jmp	locret_410E03
; ---------------------------------------------------------------------------

loc_410C93:				; CODE XREF: sub_410BBF+C2j
		cmp	[ebp+arg_8], 0
		jz	loc_410D26
		mov	eax, [ebp+arg_8]
		mov	[esp+428h+var_41C], eax
		mov	[esp+428h+var_420], offset aSetokS ; "SETOK %s"
		mov	dword ptr [esp+428h+var_424], 3E9h
		lea	eax, [ebp+var_3FA]
		mov	[esp+428h+var_428], eax
		call	sub_4241F9
		mov	[ebp+var_11], 0
		mov	eax, ds:dword_449094
		mov	[esp+428h+var_40C], 0
		mov	[esp+428h+var_410], 0
		mov	[esp+428h+var_414], 0
		mov	[esp+428h+var_418], 0
		mov	[esp+428h+var_41C], 0
		mov	[esp+428h+var_420], 0
		lea	edx, [ebp+var_3FA]
		mov	dword ptr [esp+428h+var_424], edx
		mov	[esp+428h+var_428], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410D26
		mov	eax, [ebp+var_C]
		mov	[esp+428h+var_428], eax
		call	sub_40E629
		jmp	locret_410E03
; ---------------------------------------------------------------------------

loc_410D26:				; CODE XREF: sub_410BBF+D8j
					; sub_410BBF+155j
		call	pth_attr_new
		mov	[ebp+var_10], eax
		mov	[esp+428h+var_420], 1
		mov	dword ptr [esp+428h+var_424], 2
		mov	eax, [ebp+var_10]
		mov	[esp+428h+var_428], eax
		call	pth_attr_set
		mov	[esp+428h+var_420], 40000h
		mov	dword ptr [esp+428h+var_424], 4
		mov	eax, [ebp+var_10]
		mov	[esp+428h+var_428], eax
		call	pth_attr_set
		mov	[esp+428h+var_420], offset aPopupMessage ; "popup-message"
		mov	dword ptr [esp+428h+var_424], 1
		mov	eax, [ebp+var_10]
		mov	[esp+428h+var_428], eax
		call	pth_attr_set
		mov	ds:dword_4490A4, 0
		mov	[esp+428h+var_420], 0
		mov	dword ptr [esp+428h+var_424], offset sub_410B63
		mov	eax, [ebp+var_10]
		mov	[esp+428h+var_428], eax
		call	pth_spawn
		mov	ds:dword_4490A0, eax
		mov	eax, ds:dword_4490A0
		test	eax, eax
		jnz	short loc_410DF3
		call	sub_40E515
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+428h+var_428], eax	; int
		call	strerror
		mov	dword ptr [esp+428h+var_424], eax ; char
		mov	[esp+428h+var_428], offset aErrorSpawnin_1 ; "error spawning popup message handler: %"...
		call	sub_435B7D
		mov	eax, [ebp+var_10]
		mov	[esp+428h+var_428], eax
		call	pth_attr_destroy
		mov	eax, [ebp+var_C]
		mov	[esp+428h+var_428], eax
		call	sub_40E629
		jmp	short locret_410E03
; ---------------------------------------------------------------------------

loc_410DF3:				; CODE XREF: sub_410BBF+1F1j
		mov	eax, [ebp+var_10]
		mov	[esp+428h+var_428], eax
		call	pth_attr_destroy
		mov	eax, 0

locret_410E03:				; CODE XREF: sub_410BBF+20j
					; sub_410BBF+CFj ...
		leave
		retn
sub_410BBF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410E05	proc near		; CODE XREF: sub_40E5FA+28p
					; sub_4196E6+15Cp

hProcess	= dword	ptr -28h
uExitCode	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_4490A0
		test	eax, eax
		jz	short loc_410E1D
		mov	eax, ds:dword_449094
		test	eax, eax
		jnz	short loc_410E2E

loc_410E1D:				; CODE XREF: sub_410E05+Dj
		mov	[esp+28h+hProcess], offset aAgent_popup_me ; "agent_popup_message_stop called with no"...
		call	sub_435C1A
		jmp	locret_410ED6
; ---------------------------------------------------------------------------

loc_410E2E:				; CODE XREF: sub_410E05+16j
		mov	eax, ds:dword_449094
		mov	[esp+28h+hProcess], eax
		call	assuan_get_pid
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_410E77
		mov	eax, ds:dword_4490A4
		test	eax, eax
		jnz	short loc_410E77
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_410E77
		cmp	[ebp+var_C], 0
		jz	short loc_410E77
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		mov	[esp+28h+uExitCode], 1 ; uExitCode
		mov	eax, [ebp+var_10]
		mov	[esp+28h+hProcess], eax	; hProcess
		mov	eax, ds:TerminateProcess
		call	eax ; TerminateProcess
		sub	esp, 8

loc_410E77:				; CODE XREF: sub_410E05+3Dj
					; sub_410E05+46j ...
		mov	eax, ds:dword_4490A0
		mov	[esp+28h+uExitCode], 0
		mov	[esp+28h+hProcess], eax
		call	pth_join
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_410EB6
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+hProcess], eax	; int
		call	strerror
		mov	[esp+28h+uExitCode], eax ; char
		mov	[esp+28h+hProcess], offset aAgent_popup__0 ; "agent_popup_message_stop:	pth_join fail"...
		call	sub_435C1A

loc_410EB6:				; CODE XREF: sub_410E05+8Ej
		mov	ds:dword_4490A0, 0
		mov	ds:dword_449098, 0
		mov	[esp+28h+hProcess], 0
		call	sub_40E629

locret_410ED6:				; CODE XREF: sub_410E05+24j
		leave
		retn
sub_410E05	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410ED8	proc near		; CODE XREF: sub_407A76+EBp

var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= dword	ptr -404h
var_400		= dword	ptr -400h
var_3FC		= dword	ptr -3FCh
var_3F6		= byte ptr -3F6h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 418h
		cmp	[ebp+arg_4], 0
		jz	short loc_410EF9
		cmp	[ebp+arg_8], 2
		jz	short loc_410F0A
		cmp	[ebp+arg_8], 3
		jz	short loc_410F0A
		cmp	[ebp+arg_8], 4
		jz	short loc_410F0A

loc_410EF9:				; CODE XREF: sub_410ED8+Dj
		mov	[esp+418h+var_418], 3Ch
		call	sub_40E4DF
		jmp	locret_410FC3
; ---------------------------------------------------------------------------

loc_410F0A:				; CODE XREF: sub_410ED8+13j
					; sub_410ED8+19j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+418h+var_418], eax
		call	sub_40E7CF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410F26
		mov	eax, [ebp+var_C]
		jmp	locret_410FC3
; ---------------------------------------------------------------------------

loc_410F26:				; CODE XREF: sub_410ED8+44j
		cmp	[ebp+arg_8], 3
		jz	short loc_410F40
		cmp	[ebp+arg_8], 4
		jnz	short loc_410F39
		mov	eax, 73h
		jmp	short loc_410F3E
; ---------------------------------------------------------------------------

loc_410F39:				; CODE XREF: sub_410ED8+58j
		mov	eax, 6Eh

loc_410F3E:				; CODE XREF: sub_410ED8+5Fj
		jmp	short loc_410F45
; ---------------------------------------------------------------------------

loc_410F40:				; CODE XREF: sub_410ED8+52j
		mov	eax, 75h

loc_410F45:				; CODE XREF: sub_410ED8:loc_410F3Ej
		mov	edx, [ebp+arg_4]
		mov	[esp+418h+var_408], edx
		mov	[esp+418h+var_40C], eax
		mov	[esp+418h+var_410], offset aClearpassphras ; "CLEARPASSPHRASE %c/%s"
		mov	[esp+418h+var_414], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+418h+var_418], eax
		call	sub_4241F9
		mov	eax, ds:dword_449094
		mov	[esp+418h+var_3FC], 0
		mov	[esp+418h+var_400], 0
		mov	[esp+418h+var_404], 0
		mov	[esp+418h+var_408], 0
		mov	[esp+418h+var_40C], 0
		mov	[esp+418h+var_410], 0
		lea	edx, [ebp+var_3F6]
		mov	[esp+418h+var_414], edx
		mov	[esp+418h+var_418], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+418h+var_418], eax
		call	sub_40E629

locret_410FC3:				; CODE XREF: sub_410ED8+2Dj
					; sub_410ED8+49j
		leave
		retn
sub_410ED8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410FC8	proc near		; CODE XREF: sub_411036+81p
					; sub_411036+130p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		leave
		retn
sub_410FC8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410FDB(void *, size_t)
sub_410FDB	proc near		; CODE XREF: sub_411372+139p
					; sub_411372+223p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFFFE0h
		add	eax, 20h
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 0Bh
		mov	[esp+28h+Dst], eax
		call	gcry_malloc_secure
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_411031
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy

loc_411031:				; CODE XREF: sub_410FDB+27j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_410FDB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411036	proc near		; CODE XREF: sub_411372:loc_4113A6p
					; sub_4115E1:loc_411616p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		call	sub_4204C6
		mov	[ebp+var_18], eax
		mov	eax, ds:dword_4490AC
		mov	[ebp+var_C], eax
		jmp	loc_4110D7
; ---------------------------------------------------------------------------

loc_411051:				; CODE XREF: sub_411036+A5j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_4110CF
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_4110CF
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		js	short loc_4110CF
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		add	eax, edx
		cmp	eax, [ebp+var_18]
		jge	short loc_4110CF
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_4110AE
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_C]
		add	edx, 1Ch
		mov	[esp+38h+var_30], eax
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], offset aExpiredSDsAfte ; "  expired `%s' (%ds after last access)\"...
		call	sub_435C1A

loc_4110AE:				; CODE XREF: sub_411036+56j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		mov	[esp+38h+var_38], eax
		call	sub_410FC8
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx

loc_4110CF:				; CODE XREF: sub_411036+23j
					; sub_411036+2Dj ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4110D7:				; CODE XREF: sub_411036+16j
		cmp	[ebp+var_C], 0
		jnz	loc_411051
		mov	eax, ds:dword_4490AC
		mov	[ebp+var_C], eax
		jmp	loc_411186
; ---------------------------------------------------------------------------

loc_4110EE:				; CODE XREF: sub_411036+154j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+18h]
		cmp	eax, 4
		jnz	short loc_411103
		mov	eax, ds:dword_449DEC
		mov	[ebp+var_14], eax
		jmp	short loc_41110C
; ---------------------------------------------------------------------------

loc_411103:				; CODE XREF: sub_411036+C1j
		mov	eax, ds:dword_449DE8
		mov	[ebp+var_14], eax
		nop

loc_41110C:				; CODE XREF: sub_411036+CBj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41117E
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_41117E
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jnb	short loc_41117E
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_41115D
		mov	eax, ds:dword_449DE8
		mov	edx, [ebp+var_C]
		add	edx, 1Ch
		mov	[esp+38h+var_30], eax
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], offset aExpiredSLusAft ; "  expired `%s' (%lus after creation)\n"
		call	sub_435C1A

loc_41115D:				; CODE XREF: sub_411036+106j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		mov	[esp+38h+var_38], eax
		call	sub_410FC8
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx

loc_41117E:				; CODE XREF: sub_411036+DEj
					; sub_411036+E8j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_411186:				; CODE XREF: sub_411036+B3j
		cmp	[ebp+var_C], 0
		jnz	loc_4110EE
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_4490AC
		mov	[ebp+var_C], eax
		jmp	loc_411283
; ---------------------------------------------------------------------------

loc_4111A4:				; CODE XREF: sub_411036+251j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	loc_411275
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		js	loc_411275
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, 708h
		cmp	eax, [ebp+var_18]
		jge	loc_411275
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_411220
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_C]
		add	edx, 1Ch
		mov	[esp+38h+var_30], eax
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], offset aCanTRemoveUnus ; "can't remove unused cache entry `%s' du"...
		call	sub_435B7D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		lea	edx, [eax+258h]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_411283
; ---------------------------------------------------------------------------

loc_411220:				; CODE XREF: sub_411036+1A6j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_41124A
		mov	eax, [ebp+var_C]
		add	eax, 1Ch
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aRemovedSSlotNo ; "  removed `%s' (slot not used for 30m)\"...
		call	sub_435C1A

loc_41124A:				; CODE XREF: sub_411036+1FCj
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		cmp	[ebp+var_10], 0
		jnz	short loc_411265
		mov	eax, [ebp+var_1C]
		mov	ds:dword_4490AC, eax
		jmp	short loc_41126D
; ---------------------------------------------------------------------------

loc_411265:				; CODE XREF: sub_411036+223j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx

loc_41126D:				; CODE XREF: sub_411036+22Dj
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_411283
; ---------------------------------------------------------------------------

loc_411275:				; CODE XREF: sub_411036+176j
					; sub_411036+184j ...
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_411283:				; CODE XREF: sub_411036+169j
					; sub_411036+1E8j ...
		cmp	[ebp+var_C], 0
		jnz	loc_4111A4
		leave
		retn
sub_411036	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41128F	proc near		; CODE XREF: sub_403EE1+12p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_4112AD
		mov	[esp+28h+var_28], offset aAgent_flush_ca ; "agent_flush_cache\n"
		call	sub_435C1A

loc_4112AD:				; CODE XREF: sub_41128F+10j
		mov	eax, ds:dword_4490AC
		mov	[ebp+var_C], eax
		jmp	loc_411366
; ---------------------------------------------------------------------------

loc_4112BA:				; CODE XREF: sub_41128F+DBj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_411314
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_411314
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_4112F0
		mov	eax, [ebp+var_C]
		add	eax, 1Ch
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFlushingS ; "	 flushing `%s'\n"
		call	sub_435C1A

loc_4112F0:				; CODE XREF: sub_41128F+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		mov	[esp+28h+var_28], eax
		call	sub_410FC8
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+8], 0
		jmp	short loc_41135E
; ---------------------------------------------------------------------------

loc_411314:				; CODE XREF: sub_41128F+33j
					; sub_41128F+3Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_41135E
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_41135E
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_41134A
		mov	eax, [ebp+var_C]
		add	eax, 1Ch
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aMarkedSForFlus ; "	marked `%s' for flushing\n"
		call	sub_435C1A

loc_41134A:				; CODE XREF: sub_41128F+A3j
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0Ch], 0

loc_41135E:				; CODE XREF: sub_41128F+83j
					; sub_41128F+8Dj ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_411366:				; CODE XREF: sub_41128F+26j
		cmp	[ebp+var_C], 0
		jnz	loc_4112BA
		leave
		retn
sub_41128F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411372(char *Source, int, void *, int)
sub_411372	proc near		; CODE XREF: sub_4074BA+565p
					; sub_407A76+D1p ...

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
Source		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_4113A6
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+Source]
		mov	[esp+38h+Str2],	eax ; char
		mov	[esp+38h+Str1],	offset aAgent_put_cach ; "agent_put_cache `%s' requested ttl=%d m"...
		call	sub_435C1A

loc_4113A6:				; CODE XREF: sub_411372+11j
		call	sub_411036
		cmp	[ebp+arg_C], 0
		jnz	short loc_4113CC
		mov	eax, [ebp+arg_4]
		cmp	eax, 4
		jnz	short loc_4113C3
		mov	eax, ds:dword_449DE4
		mov	[ebp+arg_C], eax
		jmp	short loc_4113CC
; ---------------------------------------------------------------------------

loc_4113C3:				; CODE XREF: sub_411372+45j
		mov	eax, ds:dword_449DE0
		mov	[ebp+arg_C], eax
		nop

loc_4113CC:				; CODE XREF: sub_411372+3Dj
					; sub_411372+4Fj
		cmp	[ebp+arg_C], 0
		jz	short loc_4113D8
		cmp	[ebp+arg_4], 0
		jnz	short loc_4113E2

loc_4113D8:				; CODE XREF: sub_411372+5Ej
		mov	eax, 0
		jmp	loc_4115DB
; ---------------------------------------------------------------------------

loc_4113E2:				; CODE XREF: sub_411372+64j
		mov	eax, ds:dword_4490AC
		mov	[ebp+var_C], eax
		jmp	short loc_411417
; ---------------------------------------------------------------------------

loc_4113EC:				; CODE XREF: sub_411372+A9j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41140F
		mov	eax, [ebp+var_C]
		lea	edx, [eax+1Ch]
		mov	eax, [ebp+Source]
		mov	[esp+38h+Str2],	eax ; Str2
		mov	[esp+38h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_41141F

loc_41140F:				; CODE XREF: sub_411372+82j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_411417:				; CODE XREF: sub_411372+78j
		cmp	[ebp+var_C], 0
		jnz	short loc_4113EC
		jmp	short loc_411420
; ---------------------------------------------------------------------------

loc_41141F:				; CODE XREF: sub_411372+9Bj
		nop

loc_411420:				; CODE XREF: sub_411372+ABj
		cmp	[ebp+var_C], 0
		jz	loc_4114D5
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_41144C
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		mov	[esp+38h+Str1],	eax
		call	sub_410FC8
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+14h], 0

loc_41144C:				; CODE XREF: sub_411372+C0j
		cmp	[ebp+arg_8], 0
		jz	loc_4115D6
		call	sub_4204C6
		mov	edx, [ebp+var_C]
		mov	[edx+8], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_C]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Str2],	eax ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Str1],	eax ; void *
		call	sub_410FDB
		mov	edx, [ebp+var_C]
		mov	[edx+14h], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	loc_4115D6
		mov	[esp+38h+Str1],	offset aOutOfCoreWhile ; "out of core while allocating new cache "...
		call	sub_435B7D
		jmp	loc_4115D6
; ---------------------------------------------------------------------------

loc_4114D5:				; CODE XREF: sub_411372+B2j
		cmp	[ebp+arg_8], 0
		jz	loc_4115D6
		mov	eax, [ebp+Source]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 20h
		mov	[esp+38h+Str2],	eax ; char
		mov	[esp+38h+Str1],	1
		call	gcry_calloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41152B
		mov	[esp+38h+Str1],	offset aOutOfCoreWhi_0 ; "out of core while allocating new cache "...
		call	sub_435B7D
		jmp	loc_4115D6
; ---------------------------------------------------------------------------

loc_41152B:				; CODE XREF: sub_411372+1A6j
		mov	eax, [ebp+var_C]
		lea	edx, [eax+1Ch]
		mov	eax, [ebp+Source]
		mov	[esp+38h+Str2],	eax ; Source
		mov	[esp+38h+Str1],	edx ; Dest
		call	strcpy
		call	sub_4204C6
		mov	edx, [ebp+var_C]
		mov	[edx+8], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_C]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Str2],	eax ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Str1],	eax ; void *
		call	sub_410FDB
		mov	edx, [ebp+var_C]
		mov	[edx+14h], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_4115C3
		mov	[esp+38h+Str1],	offset aOutOfCoreWhile ; "out of core while allocating new cache "...
		call	sub_435B7D
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str1],	eax
		call	gcry_free
		jmp	short loc_4115D6
; ---------------------------------------------------------------------------

loc_4115C3:				; CODE XREF: sub_411372+236j
		mov	edx, ds:dword_4490AC
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	ds:dword_4490AC, eax

loc_4115D6:				; CODE XREF: sub_411372+DEj
					; sub_411372+14Cj ...
		mov	eax, 0

loc_4115DB:				; CODE XREF: sub_411372+6Bj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_411372	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4115E1(char *, int, int)
sub_4115E1	proc near		; CODE XREF: sub_4074BA+340p
					; sub_41202E+41p

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_4115F7
		mov	eax, 0
		jmp	locret_411752
; ---------------------------------------------------------------------------

loc_4115F7:				; CODE XREF: sub_4115E1+Aj
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_411616
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str2],	eax ; char
		mov	[esp+28h+Str1],	offset aAgent_get_cach ; "agent_get_cache `%s'...\n"
		call	sub_435C1A

loc_411616:				; CODE XREF: sub_4115E1+20j
		call	sub_411036
		mov	eax, ds:dword_4490AC
		mov	[ebp+var_C], eax
		jmp	short loc_4116A2
; ---------------------------------------------------------------------------

loc_411625:				; CODE XREF: sub_4115E1+C5j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41169A
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_41169A
		mov	eax, [ebp+var_C]
		lea	edx, [eax+1Ch]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str2],	eax ; char
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41169A
		call	sub_4204C6
		mov	edx, [ebp+var_C]
		mov	[edx+8], eax
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_411675
		mov	[esp+28h+Str1],	offset a___Hit ; "... hit\n"
		call	sub_435C1A

loc_411675:				; CODE XREF: sub_4115E1+86j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		add	eax, 8
		jmp	locret_411752
; ---------------------------------------------------------------------------

loc_41169A:				; CODE XREF: sub_4115E1+4Cj
					; sub_4115E1+56j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4116A2:				; CODE XREF: sub_4115E1+42j
		cmp	[ebp+var_C], 0
		jnz	loc_411625
		mov	eax, ds:dword_4490AC
		mov	[ebp+var_C], eax
		jmp	short loc_411726
; ---------------------------------------------------------------------------

loc_4116B6:				; CODE XREF: sub_4115E1+149j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_41171E
		mov	eax, [ebp+var_C]
		lea	edx, [eax+1Ch]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str2],	eax ; char
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41171E
		call	sub_4204C6
		mov	edx, [ebp+var_C]
		mov	[edx+8], eax
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_4116FC
		mov	[esp+28h+Str1],	offset a___HitLocked ; "... hit	(locked)\n"
		call	sub_435C1A

loc_4116FC:				; CODE XREF: sub_4115E1+10Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+14h]
		add	eax, 8
		jmp	short locret_411752
; ---------------------------------------------------------------------------

loc_41171E:				; CODE XREF: sub_4115E1+DDj
					; sub_4115E1+F6j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_411726:				; CODE XREF: sub_4115E1+D3j
		cmp	[ebp+var_C], 0
		jnz	short loc_4116B6
		mov	eax, ds:dword_449DA0
		and	eax, 40h
		test	eax, eax
		jz	short loc_411744
		mov	[esp+28h+Str1],	offset a___Miss	; "... miss\n"
		call	sub_435C1A

loc_411744:				; CODE XREF: sub_4115E1+155j
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, 0

locret_411752:				; CODE XREF: sub_4115E1+11j
					; sub_4115E1+B4j ...
		leave
		retn
sub_4115E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411754	proc near		; CODE XREF: sub_4074BA+377p
					; sub_41202E+82p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_4490AC
		mov	[ebp+var_C], eax
		jmp	short loc_4117A9
; ---------------------------------------------------------------------------

loc_411764:				; CODE XREF: sub_411754+59j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, [ebp+var_C]
		jnz	short loc_4117A1
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_411790
		mov	eax, [ebp+var_C]
		add	eax, 1Ch
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aTryingToUnlock ; "trying to unlock non-locked	cache entry"...
		call	sub_435B7D
		jmp	short locret_4117AF
; ---------------------------------------------------------------------------

loc_411790:				; CODE XREF: sub_411754+22j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx
		jmp	short locret_4117AF
; ---------------------------------------------------------------------------

loc_4117A1:				; CODE XREF: sub_411754+18j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4117A9:				; CODE XREF: sub_411754+Ej
		cmp	[ebp+var_C], 0
		jnz	short loc_411764

locret_4117AF:				; CODE XREF: sub_411754+3Aj
					; sub_411754+4Bj
		leave
		retn
sub_411754	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4117BC	proc near		; CODE XREF: sub_4117E3+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4117DC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4117E1
; ---------------------------------------------------------------------------

loc_4117DC:				; CODE XREF: sub_4117BC+7j
		mov	eax, 0

loc_4117E1:				; CODE XREF: sub_4117BC+1Ej
		pop	ebp
		retn
sub_4117BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4117E3	proc near		; CODE XREF: sub_41180B+Ep
					; sub_4118C7+9Fp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_4117BC
		leave
		retn
sub_4117E3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4117FE	proc near		; CODE XREF: sub_411B5F+22Cp
					; sub_4123C2+9Dp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_4117FE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41180B	proc near		; CODE XREF: sub_411820+6p
					; sub_411B5F+D3p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_4117E3
		leave
		retn
sub_41180B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411820	proc near		; CODE XREF: sub_412630+221p
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_41180B
		leave
		retn
sub_411820	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41182D	proc near		; CODE XREF: sub_411B5F+F5p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4118BB
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Fh
		jnz	short loc_41186F
		mov	eax, [ebp+arg_4]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_41188B

loc_41186F:				; CODE XREF: sub_41182D+33j
		mov	[esp+28h+var_20], offset aGnupg_copy_tim ; "gnupg_copy_time"
		mov	[esp+28h+var_24], 85h
		mov	[esp+28h+var_28], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/agent/../common/uti"...
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_41188B:				; CODE XREF: sub_41182D+40j
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	ecx, word ptr [edx+0Ch]
		mov	[eax+0Ch], cx
		movzx	edx, byte ptr [edx+0Eh]
		mov	[eax+0Eh], dl
		mov	eax, [ebp+arg_0]
		add	eax, 0Fh
		mov	byte ptr [eax],	0
		jmp	short loc_4118C1
; ---------------------------------------------------------------------------

loc_4118BB:				; CODE XREF: sub_41182D+Fj
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0

loc_4118C1:				; CODE XREF: sub_41182D+8Cj
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_41182D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4118C7(int, void *Str, size_t	Size, int)
sub_4118C7	proc near		; CODE XREF: sub_40BD27+451p
					; sub_40D199+2A9p ...

FileHandle	= dword	ptr -68h
Format		= dword	ptr -64h
Count		= dword	ptr -60h
File		= dword	ptr -5Ch
var_51		= byte ptr -51h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Filename	= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		lea	eax, [ebp+var_51]
		mov	[esp+68h+Count], eax
		mov	[esp+68h+Format], 14h
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+FileHandle], eax
		call	sub_424BE8
		mov	eax, offset a_key_0 ; ".key"
		lea	edx, [ebp+var_51]
		add	edx, 28h
		mov	ecx, [eax]
		mov	[edx], ecx
		movzx	eax, byte ptr [eax+4]
		mov	[edx+4], al
		mov	eax, ds:dword_449DB4
		mov	[esp+68h+File],	0
		lea	edx, [ebp+var_51]
		mov	[esp+68h+Count], edx
		mov	[esp+68h+Format], offset aPrivateKeysV_2 ; "private-keys-v1.d"
		mov	[esp+68h+FileHandle], eax
		call	sub_432667
		mov	[ebp+Filename],	eax
		cmp	[ebp+arg_C], 0
		jnz	short loc_411970
		mov	[esp+68h+Format], 0
		mov	eax, [ebp+Filename]
		mov	[esp+68h+FileHandle], eax
		call	_access
		test	eax, eax
		jnz	short loc_411970
		mov	eax, [ebp+Filename]
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+FileHandle], offset aSecretKeyFileS ; "secret key file	`%s' already exists\n"
		call	sub_435B7D
		mov	eax, [ebp+Filename]
		mov	[esp+68h+FileHandle], eax
		call	gcry_free
		mov	[esp+68h+FileHandle], 1
		call	sub_4117E3
		jmp	locret_411B5D
; ---------------------------------------------------------------------------

loc_411970:				; CODE XREF: sub_4118C7+61j
					; sub_4118C7+78j
		cmp	[ebp+arg_C], 0
		jz	short loc_41197D
		mov	eax, 8301h
		jmp	short loc_411982
; ---------------------------------------------------------------------------

loc_41197D:				; CODE XREF: sub_4118C7+ADj
		mov	eax, 8501h

loc_411982:				; CODE XREF: sub_4118C7+B4j
		mov	[esp+68h+Count], 180h
		mov	[esp+68h+Format], eax
		mov	eax, [ebp+Filename]
		mov	[esp+68h+FileHandle], eax
		call	_open
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jns	short loc_4119AB
		mov	[ebp+var_C], 0
		jmp	short loc_4119EA
; ---------------------------------------------------------------------------

loc_4119AB:				; CODE XREF: sub_4118C7+D9j
		mov	[esp+68h+Format], offset aWb ; "wb"
		mov	eax, [ebp+var_14]
		mov	[esp+68h+FileHandle], eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4119EA
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	[esp+68h+FileHandle], eax
		call	_close
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_18]
		mov	[eax], edx

loc_4119EA:				; CODE XREF: sub_4118C7+E2j
					; sub_4118C7+FEj
		cmp	[ebp+var_C], 0
		jnz	short loc_411A47
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+FileHandle], eax
		call	gpg_err_code_from_errno
		mov	[esp+68h+FileHandle], eax
		call	sub_4117E3
		mov	[ebp+var_1C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+FileHandle], eax ; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+Filename]
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+FileHandle], offset aCanTCreateSS_0 ; "can't create `%s': %s\n"
		call	sub_435B7D
		mov	eax, [ebp+Filename]
		mov	[esp+68h+FileHandle], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		jmp	locret_411B5D
; ---------------------------------------------------------------------------

loc_411A47:				; CODE XREF: sub_4118C7+127j
		mov	eax, [ebp+var_C]
		mov	[esp+68h+File],	eax ; File
		mov	[esp+68h+Count], 1 ; Count
		mov	eax, [ebp+Size]
		mov	[esp+68h+Format], eax ;	Size
		mov	eax, [ebp+Str]
		mov	[esp+68h+FileHandle], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_411ADA
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+FileHandle], eax
		call	gpg_err_code_from_errno
		mov	[esp+68h+FileHandle], eax
		call	sub_4117E3
		mov	[ebp+var_20], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+FileHandle], eax ; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+Filename]
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+FileHandle], offset aErrorWritingSS ; "error writing `%s': %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_C]
		mov	[esp+68h+FileHandle], eax ; File
		call	fclose
		mov	eax, [ebp+Filename]
		mov	[esp+68h+FileHandle], eax ; Filename
		call	remove
		mov	eax, [ebp+Filename]
		mov	[esp+68h+FileHandle], eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		jmp	locret_411B5D
; ---------------------------------------------------------------------------

loc_411ADA:				; CODE XREF: sub_4118C7+1A4j
		mov	eax, [ebp+var_C]
		mov	[esp+68h+FileHandle], eax ; File
		call	fclose
		test	eax, eax
		jz	short loc_411B48
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+FileHandle], eax
		call	gpg_err_code_from_errno
		mov	[esp+68h+FileHandle], eax
		call	sub_4117E3
		mov	[ebp+var_24], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+FileHandle], eax ; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+Filename]
		mov	[esp+68h+Format], eax ;	char
		mov	[esp+68h+FileHandle], offset aErrorClosingSS ; "error closing `%s': %s\n"
		call	sub_435B7D
		mov	eax, [ebp+Filename]
		mov	[esp+68h+FileHandle], eax ; Filename
		call	remove
		mov	eax, [ebp+Filename]
		mov	[esp+68h+FileHandle], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		jmp	short locret_411B5D
; ---------------------------------------------------------------------------

loc_411B48:				; CODE XREF: sub_4118C7+220j
		call	sub_405DBA
		mov	eax, [ebp+Filename]
		mov	[esp+68h+FileHandle], eax
		call	gcry_free
		mov	eax, 0

locret_411B5D:				; CODE XREF: sub_4118C7+A4j
					; sub_4118C7+17Bj ...
		leave
		retn
sub_4118C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411B5F	proc near		; DATA XREF: sub_41202E+143o

Str1		= dword	ptr -68h
Str2		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_48		= byte ptr -48h
var_38		= byte ptr -38h
var_28		= byte ptr -28h
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 64h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_411B9C
		mov	[esp+68h+var_60], 90h ;	int
		mov	[esp+68h+Str2],	offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+68h+Str1],	offset aArgUnprotected ; "!arg->unprotected_key"
		call	sub_43BB20

loc_411B9C:				; CODE XREF: sub_411B5F+1Fj
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		lea	ebx, [eax+8]
		mov	eax, [ebp+arg_0]
		lea	ecx, [eax+24h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_18]
		mov	[esp+68h+var_58], edx
		mov	[esp+68h+var_5C], ebx
		lea	edx, [ebp+var_38]
		mov	[esp+68h+var_60], edx
		mov	[esp+68h+Str2],	ecx
		mov	[esp+68h+Str1],	eax
		call	sub_4168AC
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_411BE7
		mov	eax, [ebp+var_14]
		jmp	loc_411DAC
; ---------------------------------------------------------------------------

loc_411BE7:				; CODE XREF: sub_411B5F+7Ej
		mov	eax, ds:dword_449E00
		test	eax, eax
		jz	short loc_411BFF
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	eax, [eax+80h]
		test	eax, eax
		jz	short loc_411C09

loc_411BFF:				; CODE XREF: sub_411B5F+8Fj
		mov	eax, 0
		jmp	loc_411DAC
; ---------------------------------------------------------------------------

loc_411C09:				; CODE XREF: sub_411B5F+9Ej
		movzx	eax, [ebp+var_38]
		test	al, al
		jnz	short loc_411C3C
		mov	[esp+68h+Str1],	offset aNoteThisPassph ; "Note:	This passphrase	has never been ch"...
		call	sub_435294
		mov	[esp+68h+Str1],	eax
		call	gcry_strdup
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_411CD6
		call	sub_41180B
		jmp	loc_411DAC
; ---------------------------------------------------------------------------

loc_411C3C:				; CODE XREF: sub_411B5F+B0j
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Str1],	eax
		call	sub_420520
		lea	eax, [ebp+var_38]
		mov	[esp+68h+Str2],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+68h+Str1],	eax
		call	sub_41182D
		mov	eax, ds:dword_449E00
		mov	[esp+68h+Str2],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+68h+Str1],	eax
		call	sub_42172A
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_411C7E
		mov	eax, [ebp+var_14]
		jmp	loc_411DAC
; ---------------------------------------------------------------------------

loc_411C7E:				; CODE XREF: sub_411B5F+115j
		lea	eax, [ebp+var_48]
		mov	[esp+68h+Str2],	eax ; Str2
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jle	short loc_411CD6
		mov	[esp+68h+Str1],	offset aThisPassphrase ; "This passphrase has not been changed%%0"...
		call	sub_435294
		lea	edx, [ebp+var_38]
		add	edx, 6
		mov	[esp+68h+var_5C], edx
		lea	edx, [ebp+var_38]
		add	edx, 4
		mov	[esp+68h+var_60], edx
		lea	edx, [ebp+var_38]
		mov	[esp+68h+Str2],	edx
		mov	[esp+68h+Str1],	eax
		call	sub_4256F5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_411CD6
		call	sub_41180B
		jmp	loc_411DAC
; ---------------------------------------------------------------------------

loc_411CD6:				; CODE XREF: sub_411B5F+CDj
					; sub_411B5F+133j ...
		cmp	[ebp+var_C], 0
		jz	loc_411DA7
		mov	eax, ds:dword_449DF0
		test	eax, eax
		jz	short loc_411D32
		mov	[esp+68h+Str1],	offset aChangePassphra ; "Change passphrase"
		call	sub_435294
		mov	edx, [ebp+var_10]
		mov	edx, [edx]
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Str2],	eax
		mov	[esp+68h+Str1],	edx
		call	sub_4105B0
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_411D9C
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 1
		jmp	short loc_411D9C
; ---------------------------------------------------------------------------

loc_411D32:				; CODE XREF: sub_411B5F+188j
		mov	[esp+68h+Str1],	offset aILlChangeItLat ; "I'll change it later"
		call	sub_435294
		mov	ebx, eax
		mov	[esp+68h+Str1],	offset aChangePassphra ; "Change passphrase"
		call	sub_435294
		mov	edx, [ebp+var_10]
		mov	edx, [edx]
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], ebx
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Str2],	eax
		mov	[esp+68h+Str1],	edx
		call	sub_4105B0
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_411D85
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 1
		jmp	short loc_411D9C
; ---------------------------------------------------------------------------

loc_411D85:				; CODE XREF: sub_411B5F+218j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str1],	eax
		call	sub_4117FE
		cmp	eax, 63h
		jnz	short loc_411D9C
		mov	[ebp+var_14], 0

loc_411D9C:				; CODE XREF: sub_411B5F+1C5j
					; sub_411B5F+1D1j ...
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Str1],	eax
		call	gcry_free

loc_411DA7:				; CODE XREF: sub_411B5F+17Bj
		mov	eax, 0

loc_411DAC:				; CODE XREF: sub_411B5F+83j
					; sub_411B5F+A5j ...
		add	esp, 64h
		pop	ebx
		pop	ebp
		retn
sub_411B5F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411DB2(int, void *, int, int)
sub_411DB2	proc near		; CODE XREF: sub_412630+11Ap

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_28], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_24], eax
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		mov	[ebp+var_1C], 0
		jmp	loc_411FDF
; ---------------------------------------------------------------------------

loc_411E1E:				; CODE XREF: sub_411DB2+231j
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		jmp	loc_411F98
; ---------------------------------------------------------------------------

loc_411E31:				; CODE XREF: sub_411DB2+1ECj
		cmp	[ebp+var_18], 0
		jz	loc_411F59
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 46h
		jz	short loc_411EB6
		cmp	eax, 63h
		jz	short loc_411E81
		cmp	eax, 25h
		jnz	loc_411F2D
		cmp	[ebp+var_10], 0
		jz	short loc_411E78
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	25h
		add	[ebp+var_10], 1
		jmp	loc_411F94
; ---------------------------------------------------------------------------

loc_411E78:				; CODE XREF: sub_411DB2+B5j
		add	[ebp+var_C], 1
		jmp	loc_411F94
; ---------------------------------------------------------------------------

loc_411E81:				; CODE XREF: sub_411DB2+A6j
		cmp	[ebp+var_10], 0
		jz	short loc_411EAB
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	ecx, [ebp+var_20]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_20]
		add	[ebp+var_10], eax
		jmp	loc_411F94
; ---------------------------------------------------------------------------

loc_411EAB:				; CODE XREF: sub_411DB2+D3j
		mov	eax, [ebp+var_20]
		add	[ebp+var_C], eax
		jmp	loc_411F94
; ---------------------------------------------------------------------------

loc_411EB6:				; CODE XREF: sub_411DB2+A1j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jnz	short loc_411EDD
		cmp	[ebp+arg_8], 0
		jz	short loc_411EDD
		mov	[esp+48h+Size],	4
		lea	eax, [ebp+var_28]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_425664

loc_411EDD:				; CODE XREF: sub_411DB2+109j
					; sub_411DB2+10Fj
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	loc_411F93
		cmp	[ebp+var_10], 0
		jz	short loc_411F08
		mov	eax, [ebp+var_28]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dst], eax
		call	sub_433245
		mov	[ebp+var_10], eax
		jmp	loc_411F93
; ---------------------------------------------------------------------------

loc_411F08:				; CODE XREF: sub_411DB2+13Aj
		mov	eax, [ebp+var_28]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_C], eax
		nop
		jmp	short loc_411F93
; ---------------------------------------------------------------------------

loc_411F2D:				; CODE XREF: sub_411DB2+ABj
		cmp	[ebp+var_10], 0
		jz	short loc_411F53
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	25h
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	short loc_411F94
; ---------------------------------------------------------------------------

loc_411F53:				; CODE XREF: sub_411DB2+17Fj
		add	[ebp+var_C], 2
		jmp	short loc_411F94
; ---------------------------------------------------------------------------

loc_411F59:				; CODE XREF: sub_411DB2+83j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_411F71
		mov	[ebp+var_18], 1
		jmp	short loc_411F94
; ---------------------------------------------------------------------------

loc_411F71:				; CODE XREF: sub_411DB2+1B4j
		cmp	[ebp+var_10], 0
		jz	short loc_411F8D
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	short loc_411F94
; ---------------------------------------------------------------------------

loc_411F8D:				; CODE XREF: sub_411DB2+1C3j
		add	[ebp+var_C], 1
		jmp	short loc_411F94
; ---------------------------------------------------------------------------

loc_411F93:				; CODE XREF: sub_411DB2+130j
					; sub_411DB2+151j ...
		nop

loc_411F94:				; CODE XREF: sub_411DB2+C1j
					; sub_411DB2+CAj ...
		add	[ebp+var_14], 1

loc_411F98:				; CODE XREF: sub_411DB2+7Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_24]
		jb	loc_411E31
		cmp	[ebp+var_1C], 0
		jnz	short loc_411FDB
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		cmp	[ebp+var_10], 0
		jnz	short loc_411FDB
		mov	eax, [ebp+var_28]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		call	sub_41180B
		jmp	short loc_412028
; ---------------------------------------------------------------------------

loc_411FDB:				; CODE XREF: sub_411DB2+1F6j
					; sub_411DB2+215j
		add	[ebp+var_1C], 1

loc_411FDF:				; CODE XREF: sub_411DB2+67j
		cmp	[ebp+var_1C], 1
		jle	loc_411E1E
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		add	eax, [ebp+var_C]
		cmp	eax, [ebp+var_10]
		jz	short loc_412018
		mov	[esp+48h+Size],	136h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+48h+Dst], offset aResultOut_lenO ;	"*result + out_len == out"
		call	sub_43BB20

loc_412018:				; CODE XREF: sub_411DB2+248j
		mov	eax, [ebp+var_28]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		mov	eax, 0

loc_412028:				; CODE XREF: sub_411DB2+227j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_411DB2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41202E(int, char *, int, int,	int, int)
sub_41202E	proc near		; CODE XREF: sub_412630+15Cp

Source		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_78		= dword	ptr -78h
var_74		= byte ptr -74h
var_70		= dword	ptr -70h
var_69		= byte ptr -69h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		lea	eax, [ebp+var_69]
		mov	[esp+98h+var_90], eax
		mov	[esp+98h+var_94], 14h
		mov	eax, [ebp+arg_C]
		mov	[esp+98h+Source], eax
		call	sub_424BE8
		cmp	[ebp+arg_10], 0
		jz	loc_412120

loc_41205B:				; CODE XREF: sub_41202E+EDj
		lea	eax, [ebp+var_70]
		mov	[esp+98h+var_90], eax ;	int
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+var_94], eax ;	int
		lea	eax, [ebp+var_69]
		mov	[esp+98h+Source], eax ;	char *
		call	sub_4115E1
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4120E1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [ebp+var_40]
		mov	[esp+98h+var_88], edx
		lea	edx, [ebp+var_3C]
		mov	[esp+98h+var_8C], edx
		mov	[esp+98h+var_90], 0
		mov	edx, [ebp+var_20]
		mov	[esp+98h+var_94], edx
		mov	[esp+98h+Source], eax
		call	sub_4168AC
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_70]
		mov	[esp+98h+Source], eax
		call	sub_411754
		cmp	[ebp+var_C], 0
		jnz	short loc_4120DA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+98h+Source], eax
		call	gcry_free
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_4123C0
; ---------------------------------------------------------------------------

loc_4120DA:				; CODE XREF: sub_41202E+8Bj
		mov	[ebp+var_C], 0

loc_4120E1:				; CODE XREF: sub_41202E+4Dj
		mov	[esp+98h+var_94], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Source], eax
		call	sub_40F15F
		test	eax, eax
		jz	short loc_412120
		mov	[esp+98h+var_94], 3Ch
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Source], eax
		call	sub_40F15F
		test	eax, eax
		jnz	short loc_412120
		mov	[esp+98h+Source], 1
		call	pth_sleep
		jmp	loc_41205B
; ---------------------------------------------------------------------------

loc_412120:				; CODE XREF: sub_41202E+27j
					; sub_41202E+C8j ...
		mov	[esp+98h+var_94], 8Ch
		mov	[esp+98h+Source], 1
		call	gcry_calloc_secure
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_412147
		call	sub_41180B
		jmp	locret_4123C0
; ---------------------------------------------------------------------------

loc_412147:				; CODE XREF: sub_41202E+10Dj
		mov	eax, [ebp+var_24]
		mov	dword ptr [eax+20h], 64h
		mov	eax, [ebp+var_24]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_24]
		mov	dword ptr [eax+4], 10h
		mov	eax, [ebp+var_24]
		mov	dword ptr [eax+8], 3
		mov	eax, [ebp+var_24]
		mov	dword ptr [eax+14h], offset sub_411B5F
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_34], eax
		mov	[ebp+var_30], 0
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_24]
		lea	edx, [ebp+var_38]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+var_80], eax ;	int
		lea	eax, [ebp+var_69]
		mov	[esp+98h+var_84], eax ;	int
		mov	eax, [ebp+var_24]
		mov	[esp+98h+var_88], eax ;	int
		mov	[esp+98h+var_8C], 0 ; int
		mov	[esp+98h+var_90], 0 ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+var_94], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Source], eax ;	int
		call	sub_40F902
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_4123B2
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_412204
		mov	[esp+98h+var_90], 18Fh ; int
		mov	[esp+98h+var_94], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+98h+Source], offset aArg_unprotecte ; "arg.unprotected_key"
		call	sub_43BB20

loc_412204:				; CODE XREF: sub_41202E+1B8j
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	loc_412365
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_412232
		mov	[esp+98h+var_90], 195h ; int
		mov	[esp+98h+var_94], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+98h+Source], offset aArg_unprotecte ; "arg.unprotected_key"
		call	sub_43BB20

loc_412232:				; CODE XREF: sub_41202E+1E6j
		mov	eax, [ebp+var_30]
		mov	[esp+98h+var_8C], 0
		mov	[esp+98h+var_90], 0
		mov	[esp+98h+var_94], 0
		mov	[esp+98h+Source], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_28]
		mov	[esp+98h+var_8C], edx
		mov	[esp+98h+var_90], eax
		lea	eax, [ebp+var_74]
		mov	[esp+98h+var_94], eax
		lea	eax, [ebp+var_78]
		mov	[esp+98h+Source], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4122E3
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Source], eax
		call	gpg_strerror
		mov	edx, dword ptr [ebp+var_74]
		mov	[esp+98h+var_90], eax
		mov	[esp+98h+var_94], edx ;	char
		mov	[esp+98h+Source], offset aFailedToBuil_0 ; "failed to build S-Exp (off=%u): %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_30]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	short loc_4122BF
; ---------------------------------------------------------------------------

loc_4122B1:				; CODE XREF: sub_41202E+295j
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		sub	[ebp+var_14], 1

loc_4122BF:				; CODE XREF: sub_41202E+281j
		cmp	[ebp+var_14], 0
		jnz	short loc_4122B1
		mov	eax, [ebp+var_30]
		mov	[esp+98h+Source], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+98h+Source], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	locret_4123C0
; ---------------------------------------------------------------------------

loc_4122E3:				; CODE XREF: sub_41202E+251j
		mov	eax, [ebp+var_78]
		mov	[esp+98h+var_94], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Source], eax
		call	sub_414C0D
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_78]
		mov	[esp+98h+Source], eax
		call	gcry_sexp_release
		cmp	[ebp+var_C], 0
		jz	loc_41239D
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Source], eax
		call	gpg_strerror
		mov	[esp+98h+var_94], eax ;	char
		mov	[esp+98h+Source], offset aChangingThePas ; "changing the passphrase failed: %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_1C], eax
		jmp	short loc_412344
; ---------------------------------------------------------------------------

loc_412336:				; CODE XREF: sub_41202E+31Aj
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		add	[ebp+var_18], 1
		sub	[ebp+var_1C], 1

loc_412344:				; CODE XREF: sub_41202E+306j
		cmp	[ebp+var_1C], 0
		jnz	short loc_412336
		mov	eax, [ebp+var_30]
		mov	[esp+98h+Source], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+98h+Source], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short locret_4123C0
; ---------------------------------------------------------------------------

loc_412365:				; CODE XREF: sub_41202E+1DBj
		cmp	[ebp+arg_14], 0
		jz	short loc_412378
		lea	eax, [ebp+var_69]
		mov	[esp+98h+Source], eax
		mov	eax, [ebp+arg_14]
		call	eax
		jmp	short loc_41237D
; ---------------------------------------------------------------------------

loc_412378:				; CODE XREF: sub_41202E+33Bj
		mov	eax, 0

loc_41237D:				; CODE XREF: sub_41202E+348j
		mov	edx, [ebp+var_24]
		add	edx, 24h
		mov	[esp+98h+var_8C], eax ;	int
		mov	[esp+98h+var_90], edx ;	void *
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+var_94], eax ;	int
		lea	eax, [ebp+var_69]
		mov	[esp+98h+Source], eax ;	Source
		call	sub_411372

loc_41239D:				; CODE XREF: sub_41202E+2D9j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+98h+Source], eax
		call	gcry_free
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_4123B2:				; CODE XREF: sub_41202E+1ADj
		mov	eax, [ebp+var_24]
		mov	[esp+98h+Source], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

locret_4123C0:				; CODE XREF: sub_41202E+A7j
					; sub_41202E+114j ...
		leave
		retn
sub_41202E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4123C2	proc near		; CODE XREF: sub_412630+32p
					; sub_4129BE+1Cp ...

Filename	= dword	ptr -98h
Mode		= dword	ptr -94h
Count		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_85		= byte ptr -85h
var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= byte ptr -50h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
DstBuf		= dword	ptr -1Ch
ElementSize	= dword	ptr -18h
var_14		= dword	ptr -14h
File		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_85]
		mov	[esp+98h+Count], eax
		mov	[esp+98h+Mode],	14h
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Filename], eax
		call	sub_424BE8
		mov	eax, offset a_key_0 ; ".key"
		lea	edx, [ebp+var_85]
		add	edx, 28h
		mov	ecx, [eax]
		mov	[edx], ecx
		movzx	eax, byte ptr [eax+4]
		mov	[edx+4], al
		mov	eax, ds:dword_449DB4
		mov	[esp+98h+var_8C], 0
		lea	edx, [ebp+var_85]
		mov	[esp+98h+Count], edx
		mov	[esp+98h+Mode],	offset aPrivateKeysV_2 ; "private-keys-v1.d"
		mov	[esp+98h+Filename], eax
		call	sub_432667
		mov	[ebp+var_C], eax
		mov	edx, offset aRb_0 ; "rb"
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Mode],	edx ; Mode
		mov	[esp+98h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_4124A6
		call	sub_41180B
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Filename], eax
		call	sub_4117FE
		cmp	eax, 8051h
		jz	short loc_412493
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+98h+Filename], eax	; int
		call	strerror
		mov	[esp+98h+Count], eax
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Mode],	eax ; char
		mov	[esp+98h+Filename], offset aCanTOpenSS_0 ; "can't open `%s': %s\n"
		call	sub_435B7D

loc_412493:				; CODE XREF: sub_4123C2+A7j
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	locret_41262E
; ---------------------------------------------------------------------------

loc_4124A6:				; CODE XREF: sub_4123C2+8Dj
		mov	eax, [ebp+File]
		mov	[esp+98h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_50]
		mov	[esp+98h+Mode],	edx
		mov	[esp+98h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jz	short loc_412514
		call	sub_41180B
		mov	[ebp+var_14], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+98h+Filename], eax	; int
		call	strerror
		mov	[esp+98h+Count], eax
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Mode],	eax ; char
		mov	[esp+98h+Filename], offset aCanTStatSS ; "can't stat `%s': %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+File]
		mov	[esp+98h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		jmp	locret_41262E
; ---------------------------------------------------------------------------

loc_412514:				; CODE XREF: sub_4123C2+102j
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_34]
		mov	[ebp+ElementSize], eax
		mov	eax, [ebp+ElementSize]
		add	eax, 1
		mov	[esp+98h+Filename], eax
		call	gcry_malloc
		mov	[ebp+DstBuf], eax
		cmp	[ebp+DstBuf], 0
		jz	short loc_41255A
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+98h+var_8C], edx ;	File
		mov	[esp+98h+Count], 1 ; Count
		mov	edx, [ebp+ElementSize]
		mov	[esp+98h+Mode],	edx ; ElementSize
		mov	[esp+98h+Filename], eax	; DstBuf
		call	fread
		cmp	eax, 1
		jz	short loc_4125B0

loc_41255A:				; CODE XREF: sub_4123C2+170j
		call	sub_41180B
		mov	[ebp+var_14], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+98h+Filename], eax	; int
		call	strerror
		mov	[esp+98h+Count], eax
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Mode],	eax ; char
		mov	[esp+98h+Filename], offset aErrorReadingSS ; "error reading `%s': %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+File]
		mov	[esp+98h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+DstBuf]
		mov	[esp+98h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	short locret_41262E
; ---------------------------------------------------------------------------

loc_4125B0:				; CODE XREF: sub_4123C2+196j
		mov	eax, [ebp+ElementSize]
		mov	[esp+98h+var_8C], eax
		mov	eax, [ebp+DstBuf]
		mov	[esp+98h+Count], eax
		lea	eax, [ebp+var_54]
		mov	[esp+98h+Mode],	eax
		lea	eax, [ebp+var_58]
		mov	[esp+98h+Filename], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+File]
		mov	[esp+98h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+DstBuf]
		mov	[esp+98h+Filename], eax
		call	gcry_free
		cmp	[ebp+var_14], 0
		jz	short loc_412621
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Filename], eax
		call	gpg_strerror
		mov	edx, dword ptr [ebp+var_54]
		mov	[esp+98h+Count], eax
		mov	[esp+98h+Mode],	edx ; char
		mov	[esp+98h+Filename], offset aFailedToBuil_0 ; "failed to	build S-Exp (off=%u): %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_14]
		jmp	short locret_41262E
; ---------------------------------------------------------------------------

loc_412621:				; CODE XREF: sub_4123C2+236j
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

locret_41262E:				; CODE XREF: sub_4123C2+DFj
					; sub_4123C2+14Dj ...
		leave
		retn
sub_4123C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412630	proc near		; CODE XREF: sub_407CF1+95p
					; sub_4136B7+72p ...

Dst		= dword	ptr -68h
Src		= dword	ptr -64h
Size		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= byte ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_412655
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_412655:				; CODE XREF: sub_412630+1Aj
		lea	eax, [ebp+var_38]
		mov	[esp+68h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+Dst], eax
		call	sub_4123C2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_412678
		mov	eax, [ebp+var_C]
		jmp	locret_4129BC
; ---------------------------------------------------------------------------

loc_412678:				; CODE XREF: sub_412630+3Ej
		mov	eax, [ebp+var_38]
		lea	edx, [ebp+var_30]
		mov	[esp+68h+Size],	edx
		lea	edx, [ebp+var_2C]
		mov	[esp+68h+Src], edx ; char
		mov	[esp+68h+Dst], eax
		call	sub_42C3B5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4126A2
		mov	eax, [ebp+var_C]
		jmp	locret_4129BC
; ---------------------------------------------------------------------------

loc_4126A2:				; CODE XREF: sub_412630+68j
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+68h+Dst], eax
		call	sub_416FFD
		cmp	eax, 2
		jz	short loc_4126C9
		cmp	eax, 3
		jz	loc_4127C5
		cmp	eax, 1
		jz	loc_4128D7
		jmp	loc_4128BA
; ---------------------------------------------------------------------------

loc_4126C9:				; CODE XREF: sub_412630+80j
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_38]
		mov	[esp+68h+Size],	0
		mov	[esp+68h+Src], offset aComment_0 ; "comment"
		mov	[esp+68h+Dst], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41270A
		mov	[esp+68h+Src], 1
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	gcry_sexp_nth_string
		mov	[ebp+var_14], eax

loc_41270A:				; CODE XREF: sub_412630+C2j
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	gcry_sexp_release
		mov	[ebp+var_3C], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_412752
		mov	edx, [ebp+var_38]
		cmp	[ebp+var_14], 0
		jz	short loc_412730
		mov	eax, [ebp+var_14]
		jmp	short loc_412735
; ---------------------------------------------------------------------------

loc_412730:				; CODE XREF: sub_412630+F9j
		mov	eax, offset byte_443895

loc_412735:				; CODE XREF: sub_412630+FEj
		lea	ecx, [ebp+var_3C]
		mov	[esp+68h+var_5C], ecx ;	int
		mov	[esp+68h+Size],	edx ; int
		mov	[esp+68h+Src], eax ; void *
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Dst], eax ; int
		call	sub_411DB2
		mov	[ebp+var_C], eax

loc_412752:				; CODE XREF: sub_412630+F0j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Dst], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_4127B5
		mov	eax, [ebp+var_3C]
		mov	edx, [ebp+arg_14]
		mov	[esp+68h+var_54], edx ;	int
		mov	edx, [ebp+arg_10]
		mov	[esp+68h+var_58], edx ;	int
		mov	edx, [ebp+arg_8]
		mov	[esp+68h+var_5C], edx ;	int
		lea	edx, [ebp+var_2C]
		mov	[esp+68h+Size],	edx ; int
		mov	[esp+68h+Src], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Dst], eax ; int
		call	sub_41202E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4127B5
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Dst], eax
		call	gpg_strerror
		mov	[esp+68h+Src], eax ; char
		mov	[esp+68h+Dst], offset aFailedToUnprot ;	"failed	to unprotect the secret	key: %s\"...
		call	sub_435B7D

loc_4127B5:				; CODE XREF: sub_412630+131j
					; sub_412630+168j
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Dst], eax
		call	gcry_free
		jmp	loc_4128DB
; ---------------------------------------------------------------------------

loc_4127C5:				; CODE XREF: sub_412630+85j
		cmp	[ebp+arg_C], 0
		jz	loc_4128A9
		mov	eax, dword ptr [ebp+var_2C]
		lea	edx, [ebp+var_40]
		mov	[esp+68h+Src], edx
		mov	[esp+68h+Dst], eax
		call	sub_417904
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_412886
		mov	eax, [ebp+var_40]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Size],	0
		mov	[esp+68h+Src], 0
		mov	[esp+68h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_412836
		mov	[esp+68h+Size],	253h ; int
		mov	[esp+68h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+68h+Dst], offset aN ; "n"
		call	sub_43BB20

loc_412836:				; CODE XREF: sub_412630+1E8j
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Dst], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41285B
		call	sub_411820
		mov	[ebp+var_C], eax
		jmp	short loc_412886
; ---------------------------------------------------------------------------

loc_41285B:				; CODE XREF: sub_412630+21Fj
		mov	eax, [ebp+var_40]
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	ecx, [ebp+var_24]
		mov	[esp+68h+Size],	ecx ; Size
		mov	[esp+68h+Src], edx ; Src
		mov	[esp+68h+Dst], eax ; Dst
		call	memcpy
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 1

loc_412886:				; CODE XREF: sub_412630+1B8j
					; sub_412630+229j
		cmp	[ebp+var_C], 0
		jz	short loc_4128DA
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Dst], eax
		call	gpg_strerror
		mov	[esp+68h+Src], eax ; char
		mov	[esp+68h+Dst], offset aGet_shadow_inf ;	"get_shadow_info failed: %s\n"
		call	sub_435B7D
		jmp	short loc_4128DA
; ---------------------------------------------------------------------------

loc_4128A9:				; CODE XREF: sub_412630+199j
		mov	[esp+68h+Dst], 36h
		call	sub_4117E3
		mov	[ebp+var_C], eax
		jmp	short loc_4128DA
; ---------------------------------------------------------------------------

loc_4128BA:				; CODE XREF: sub_412630+94j
		mov	[esp+68h+Dst], offset aInvalidPrivate ;	"invalid private key format\n"
		call	sub_435B7D
		mov	[esp+68h+Dst], 7
		call	sub_4117E3
		mov	[ebp+var_C], eax
		jmp	short loc_4128DB
; ---------------------------------------------------------------------------

loc_4128D7:				; CODE XREF: sub_412630+8Ej
		nop
		jmp	short loc_4128DB
; ---------------------------------------------------------------------------

loc_4128DA:				; CODE XREF: sub_412630+25Aj
					; sub_412630+277j ...
		nop

loc_4128DB:				; CODE XREF: sub_412630+190j
					; sub_412630+2A5j ...
		mov	eax, [ebp+var_38]
		mov	[esp+68h+Dst], eax
		call	gcry_sexp_release
		mov	[ebp+var_38], 0
		cmp	[ebp+var_C], 0
		jnz	short loc_4128F9
		cmp	[ebp+var_10], 0
		jz	short loc_41290C

loc_4128F9:				; CODE XREF: sub_412630+2C1j
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+68h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	locret_4129BC
; ---------------------------------------------------------------------------

loc_41290C:				; CODE XREF: sub_412630+2C7j
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Size],	0
		mov	[esp+68h+Src], 0
		mov	[esp+68h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_28], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [ebp+var_28]
		mov	[esp+68h+var_5C], edx
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_34]
		mov	[esp+68h+Src], eax
		lea	eax, [ebp+var_38]
		mov	[esp+68h+Dst], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_1C], eax
		jmp	short loc_412971
; ---------------------------------------------------------------------------

loc_412963:				; CODE XREF: sub_412630+345j
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		add	[ebp+var_18], 1
		sub	[ebp+var_1C], 1

loc_412971:				; CODE XREF: sub_412630+331j
		cmp	[ebp+var_1C], 0
		jnz	short loc_412963
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+68h+Dst], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_4129AF
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Dst], eax
		call	gpg_strerror
		mov	edx, dword ptr [ebp+var_34]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Src], edx ; char
		mov	[esp+68h+Dst], offset aFailedToBuil_0 ;	"failed	to build S-Exp (off=%u): %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_C]
		jmp	short locret_4129BC
; ---------------------------------------------------------------------------

loc_4129AF:				; CODE XREF: sub_412630+356j
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+arg_18]
		mov	[eax], edx
		mov	eax, 0

locret_4129BC:				; CODE XREF: sub_412630+43j
					; sub_412630+6Dj ...
		leave
		retn
sub_412630	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4129BE	proc near		; CODE XREF: sub_406B69+1E5p
					; sub_40C7DB+CBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_4123C2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4129F0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_4129F0:				; CODE XREF: sub_4129BE+28j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4129BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4129F5	proc near		; CODE XREF: sub_4069FA+59p

Buf1		= dword	ptr -0A8h
Buf2		= dword	ptr -0A4h
Size		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_8C		= dword	ptr -8Ch
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0A0h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+Buf2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+Buf1], eax
		call	sub_4123C2
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_412A2C
		mov	eax, [ebp+var_28]
		jmp	loc_413147
; ---------------------------------------------------------------------------

loc_412A2C:				; CODE XREF: sub_4129F5+2Dj
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Size], 0
		mov	[esp+0A8h+Buf2], offset	aShadowedPriv_0	; "shadowed-private-key"
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_7C], eax
		mov	eax, [ebp+var_7C]
		test	eax, eax
		jnz	short loc_412A6F
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Size], 0
		mov	[esp+0A8h+Buf2], offset	aProtectedPri_0	; "protected-private-key"
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_7C], eax

loc_412A6F:				; CODE XREF: sub_4129F5+5Aj
		mov	eax, [ebp+var_7C]
		test	eax, eax
		jnz	short loc_412A94
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Size], 0
		mov	[esp+0A8h+Buf2], offset	aPrivateKey_0 ;	"private-key"
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_7C], eax

loc_412A94:				; CODE XREF: sub_4129F5+7Fj
		mov	eax, [ebp+var_7C]
		test	eax, eax
		jnz	short loc_412AC3
		mov	[esp+0A8h+Buf1], offset	aInvalidPrivate	; "invalid private key format\n"
		call	sub_435B7D
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	[esp+0A8h+Buf1], 7
		call	sub_4117E3
		jmp	loc_413147
; ---------------------------------------------------------------------------

loc_412AC3:				; CODE XREF: sub_4129F5+A4j
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_cadr
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_7C], eax
		mov	eax, [ebp+var_7C]
		lea	edx, [ebp+var_80]
		mov	[esp+0A8h+Size], edx
		mov	[esp+0A8h+Buf2], 0 ; char
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_nth_data
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_80]
		cmp	eax, 3
		jnz	short loc_412B39
		mov	[esp+0A8h+Size], 3 ; Size
		mov	[esp+0A8h+Buf2], offset	aRsa ; "rsa"
		mov	eax, [ebp+var_30]
		mov	[esp+0A8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_412B39
		mov	[ebp+var_14], offset aRsa ; "rsa"
		mov	[ebp+var_24], offset aNe ; "ne"
		jmp	loc_412BDA
; ---------------------------------------------------------------------------

loc_412B39:				; CODE XREF: sub_4129F5+110j
					; sub_4129F5+12Fj
		mov	eax, [ebp+var_80]
		cmp	eax, 3
		jnz	short loc_412B70
		mov	[esp+0A8h+Size], 3 ; Size
		mov	[esp+0A8h+Buf2], offset	aDsa ; "dsa"
		mov	eax, [ebp+var_30]
		mov	[esp+0A8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_412B70
		mov	[ebp+var_14], offset aDsa ; "dsa"
		mov	[ebp+var_24], offset aPqgy ; "pqgy"
		jmp	short loc_412BDA
; ---------------------------------------------------------------------------

loc_412B70:				; CODE XREF: sub_4129F5+14Aj
					; sub_4129F5+169j
		mov	eax, [ebp+var_80]
		cmp	eax, 3
		jnz	short loc_412BA7
		mov	[esp+0A8h+Size], 3 ; Size
		mov	[esp+0A8h+Buf2], offset	aElg ; "elg"
		mov	eax, [ebp+var_30]
		mov	[esp+0A8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_412BA7
		mov	[ebp+var_14], offset aElg ; "elg"
		mov	[ebp+var_24], offset aPgy ; "pgy"
		jmp	short loc_412BDA
; ---------------------------------------------------------------------------

loc_412BA7:				; CODE XREF: sub_4129F5+181j
					; sub_4129F5+1A0j
		mov	[esp+0A8h+Buf1], offset	aUnknownPrivate	; "unknown private key algorithm\n"
		call	sub_435B7D
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	[esp+0A8h+Buf1], 7
		call	sub_4117E3
		jmp	loc_413147
; ---------------------------------------------------------------------------

loc_412BDA:				; CODE XREF: sub_4129F5+13Fj
					; sub_4129F5+179j ...
		mov	eax, [ebp+var_24]
		mov	[ebp+var_8C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_8C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+0A8h+Buf2], 4
		mov	[esp+0A8h+Buf1], eax
		call	gcry_calloc
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_412C41
		call	sub_41180B
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_28]
		jmp	loc_413147
; ---------------------------------------------------------------------------

loc_412C41:				; CODE XREF: sub_4129F5+224j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_412D74
; ---------------------------------------------------------------------------

loc_412C53:				; CODE XREF: sub_4129F5+387j
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+Size], 1
		mov	edx, [ebp+var_20]
		mov	[esp+0A8h+Buf2], edx
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_412CD0
		mov	[ebp+var_C], 0
		jmp	short loc_412C96
; ---------------------------------------------------------------------------

loc_412C7F:				; CODE XREF: sub_4129F5+2A7j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_34]
		mov	eax, [eax]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_mpi_release
		add	[ebp+var_C], 1

loc_412C96:				; CODE XREF: sub_4129F5+288j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_10]
		jl	short loc_412C7F
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	[esp+0A8h+Buf1], 7
		call	sub_4117E3
		jmp	loc_413147
; ---------------------------------------------------------------------------

loc_412CD0:				; CODE XREF: sub_4129F5+27Fj
		mov	eax, [ebp+var_10]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp+var_34]
		mov	[esp+0A8h+Size], 5
		mov	[esp+0A8h+Buf2], 1
		mov	eax, [ebp+var_2C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_nth_mpi
		mov	[ebx], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_34]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412D6C
		mov	[ebp+var_C], 0
		jmp	short loc_412D32
; ---------------------------------------------------------------------------

loc_412D1B:				; CODE XREF: sub_4129F5+343j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_34]
		mov	eax, [eax]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_mpi_release
		add	[ebp+var_C], 1

loc_412D32:				; CODE XREF: sub_4129F5+324j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_10]
		jl	short loc_412D1B
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	[esp+0A8h+Buf1], 7
		call	sub_4117E3
		jmp	loc_413147
; ---------------------------------------------------------------------------

loc_412D6C:				; CODE XREF: sub_4129F5+31Bj
		add	[ebp+var_20], 1
		add	[ebp+var_10], 1

loc_412D74:				; CODE XREF: sub_4129F5+259j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_412C53
		mov	eax, [ebp+var_7C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	[ebp+var_7C], 0
		mov	[ebp+var_48], 0
		mov	[ebp+var_50], 0
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Size], 0
		mov	[esp+0A8h+Buf2], offset	aUri ; "uri"
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_412DE3
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+Size], eax
		mov	[esp+0A8h+Buf2], 1
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_nth_data
		mov	[ebp+var_48], eax

loc_412DE3:				; CODE XREF: sub_4129F5+3CFj
		mov	[ebp+var_4C], 0
		mov	[ebp+var_54], 0
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Size], 0
		mov	[esp+0A8h+Buf2], offset	aComment_0 ; "comment"
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_412E32
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Size], eax
		mov	[esp+0A8h+Buf2], 1
		mov	eax, [ebp+var_3C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_nth_data
		mov	[ebp+var_4C], eax

loc_412E32:				; CODE XREF: sub_4129F5+41Ej
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	[ebp+var_44], 0
		mov	eax, [ebp+var_24]
		mov	[ebp+var_8C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_8C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, edx
		shl	eax, 3
		sub	eax, edx
		add	eax, 2Ah
		mov	[esp+0A8h+Buf1], eax
		call	gcry_malloc
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jnz	short loc_412EE4
		call	sub_41180B
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 0
		jmp	short loc_412EAC
; ---------------------------------------------------------------------------

loc_412E95:				; CODE XREF: sub_4129F5+4C4j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_34]
		mov	eax, [eax]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_mpi_release
		add	[ebp+var_C], 1

loc_412EAC:				; CODE XREF: sub_4129F5+49Ej
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_34]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412E95
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_3C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_28]
		jmp	loc_413147
; ---------------------------------------------------------------------------

loc_412EE4:				; CODE XREF: sub_4129F5+48Dj
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_40]
		mov	dword ptr [eax], 62757028h
		mov	dword ptr [eax+4], 2D63696Ch
		mov	dword ptr [eax+8], 2879656Bh
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [ebp+var_40]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+var_14]
		mov	[esp+0A8h+Buf2], eax
		mov	[esp+0A8h+Buf1], edx
		call	sub_433245
		mov	[ebp+var_18], eax
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	short loc_412F99
; ---------------------------------------------------------------------------

loc_412F2D:				; CODE XREF: sub_4129F5+5ACj
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	28h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_20]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax], 296D2520h
		mov	byte ptr [eax+4], 0
		add	[ebp+var_18], 4
		mov	eax, [ebp+var_1C]
		cmp	eax, 8
		jbe	short loc_412F7B
		mov	[esp+0A8h+Size], 333h ;	int
		mov	[esp+0A8h+Buf2], offset	a____Gnupg22__3	; "../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+0A8h+Buf1], offset	aArgidxDimArgs ; "argidx < DIM (args)"
		call	sub_43BB20

loc_412F7B:				; CODE XREF: sub_4129F5+568j
		mov	eax, [ebp+var_10]
		shl	eax, 2
		mov	edx, eax
		add	edx, [ebp+var_34]
		mov	eax, [ebp+var_1C]
		mov	[ebp+eax*4+var_78], edx
		add	[ebp+var_1C], 1
		add	[ebp+var_20], 1
		add	[ebp+var_10], 1

loc_412F99:				; CODE XREF: sub_4129F5+536j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412F2D
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	29h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_48]
		test	eax, eax
		jz	short loc_41300F
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax], 69727528h
		mov	dword ptr [eax+4], 29622520h
		mov	byte ptr [eax+8], 0
		add	[ebp+var_18], 8
		mov	eax, [ebp+var_1C]
		add	eax, 1
		cmp	eax, 8
		jbe	short loc_412FF3
		mov	[esp+0A8h+Size], 33Ah ;	int
		mov	[esp+0A8h+Buf2], offset	a____Gnupg22__3	; "../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+0A8h+Buf1], offset	aArgidx1DimArgs	; "argidx+1 < DIM (args)"
		call	sub_43BB20

loc_412FF3:				; CODE XREF: sub_4129F5+5E0j
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_50]
		mov	[ebp+eax*4+var_78], edx
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_48]
		mov	[ebp+eax*4+var_78], edx
		add	[ebp+var_1C], 1

loc_41300F:				; CODE XREF: sub_4129F5+5BDj
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_413078
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax], 6D6F6328h
		mov	dword ptr [eax+4], 746E656Dh
		mov	dword ptr [eax+8], 29622520h
		mov	byte ptr [eax+0Ch], 0
		add	[ebp+var_18], 0Ch
		mov	eax, [ebp+var_1C]
		add	eax, 1
		cmp	eax, 8
		jbe	short loc_41305C
		mov	[esp+0A8h+Size], 341h ;	int
		mov	[esp+0A8h+Buf2], offset	a____Gnupg22__3	; "../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+0A8h+Buf1], offset	aArgidx1DimArgs	; "argidx+1 < DIM (args)"
		call	sub_43BB20

loc_41305C:				; CODE XREF: sub_4129F5+649j
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_54]
		mov	[ebp+eax*4+var_78], edx
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_4C]
		mov	[ebp+eax*4+var_78], edx
		add	[ebp+var_1C], 1

loc_413078:				; CODE XREF: sub_4129F5+61Fj
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	29h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_1C]
		cmp	eax, 8
		jbe	short loc_4130AC
		mov	[esp+0A8h+Size], 347h ;	int
		mov	[esp+0A8h+Buf2], offset	a____Gnupg22__3	; "../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+0A8h+Buf1], offset	aArgidxDimArgs ; "argidx < DIM (args)"
		call	sub_43BB20

loc_4130AC:				; CODE XREF: sub_4129F5+699j
		mov	eax, [ebp+var_1C]
		mov	[ebp+eax*4+var_78], 0
		lea	eax, [ebp+var_78]
		mov	[esp+0A8h+var_9C], eax
		mov	eax, [ebp+var_40]
		mov	[esp+0A8h+Size], eax
		mov	[esp+0A8h+Buf2], 0
		lea	eax, [ebp+var_7C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_build_array
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_40]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	[ebp+var_C], 0
		jmp	short loc_413106
; ---------------------------------------------------------------------------

loc_4130EF:				; CODE XREF: sub_4129F5+71Ej
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_34]
		mov	eax, [eax]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_mpi_release
		add	[ebp+var_C], 1

loc_413106:				; CODE XREF: sub_4129F5+6F8j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_34]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4130EF
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_3C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_sexp_release
		cmp	[ebp+var_28], 0
		jnz	short loc_413144
		mov	edx, [ebp+var_7C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_413144:				; CODE XREF: sub_4129F5+745j
		mov	eax, [ebp+var_28]

loc_413147:				; CODE XREF: sub_4129F5+32j
					; sub_4129F5+C9j ...
		add	esp, 0A0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4129F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413151	proc near		; CODE XREF: sub_4061AF+33p
					; sub_40BD27+2F2p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3D		= byte ptr -3Dh
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		lea	eax, [ebp+var_3D]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 14h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_424BE8
		mov	eax, offset a_key_0 ; ".key"
		lea	edx, [ebp+var_3D]
		add	edx, 28h
		mov	ecx, [eax]
		mov	[edx], ecx
		movzx	eax, byte ptr [eax+4]
		mov	[edx+4], al
		mov	eax, ds:dword_449DB4
		mov	[esp+58h+var_4C], 0
		lea	edx, [ebp+var_3D]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], offset aPrivateKeysV_2 ; "private-keys-v1.d"
		mov	[esp+58h+var_58], eax
		call	sub_432667
		mov	[ebp+var_C], eax
		mov	[esp+58h+var_54], 4
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	_access
		test	eax, eax
		jnz	short loc_4131CC
		mov	eax, 0
		jmp	short loc_4131D1
; ---------------------------------------------------------------------------

loc_4131CC:				; CODE XREF: sub_413151+72j
		mov	eax, 0FFFFFFFFh

loc_4131D1:				; CODE XREF: sub_413151+79j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		leave
		retn
sub_413151	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4131E4	proc near		; CODE XREF: sub_406B69+49p

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_8], 0
		jz	short loc_4131F9
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_4131F9:				; CODE XREF: sub_4131E4+Aj
		cmp	[ebp+arg_C], 0
		jz	short loc_413208
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_413208:				; CODE XREF: sub_4131E4+19j
		lea	eax, [ebp+var_20]
		mov	[esp+38h+Src], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Dst], eax
		call	sub_4123C2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41324E
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Dst], eax
		call	sub_4117FE
		cmp	eax, 8051h
		jnz	short loc_413246
		mov	[esp+38h+Dst], 1Bh
		call	sub_4117E3
		jmp	locret_41339F
; ---------------------------------------------------------------------------

loc_413246:				; CODE XREF: sub_4131E4+4Fj
		mov	eax, [ebp+var_C]
		jmp	locret_41339F
; ---------------------------------------------------------------------------

loc_41324E:				; CODE XREF: sub_4131E4+3Dj
		mov	eax, [ebp+var_20]
		lea	edx, [ebp+var_1C]
		mov	[esp+38h+Size],	edx
		lea	edx, [ebp+var_18]
		mov	[esp+38h+Src], edx
		mov	[esp+38h+Dst], eax
		call	sub_42C3B5
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax
		call	gcry_sexp_release
		cmp	[ebp+var_C], 0
		jz	short loc_413283
		mov	eax, [ebp+var_C]
		jmp	locret_41339F
; ---------------------------------------------------------------------------

loc_413283:				; CODE XREF: sub_4131E4+95j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax
		call	sub_416FFD
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, 2
		jz	loc_413376
		cmp	eax, 3
		jz	short loc_4132B0
		cmp	eax, 1
		jz	loc_413379
		jmp	loc_413365
; ---------------------------------------------------------------------------

loc_4132B0:				; CODE XREF: sub_4131E4+BCj
		cmp	[ebp+arg_C], 0
		jz	loc_41337C
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+var_24]
		mov	[esp+38h+Src], edx
		mov	[esp+38h+Dst], eax
		call	sub_417904
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41337C
		mov	eax, [ebp+var_24]
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	0
		mov	[esp+38h+Src], 0
		mov	[esp+38h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_413321
		mov	[esp+38h+Size],	3A5h ; int
		mov	[esp+38h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/agent/findkey.c"
		mov	[esp+38h+Dst], offset aN ; "n"
		call	sub_43BB20

loc_413321:				; CODE XREF: sub_4131E4+11Fj
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_413346
		call	sub_41180B
		mov	[ebp+var_C], eax
		jmp	short loc_41337C
; ---------------------------------------------------------------------------

loc_413346:				; CODE XREF: sub_4131E4+156j
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	ecx, [ebp+var_14]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		jmp	short loc_41337C
; ---------------------------------------------------------------------------

loc_413365:				; CODE XREF: sub_4131E4+C7j
		mov	[esp+38h+Dst], 7
		call	sub_4117E3
		mov	[ebp+var_C], eax
		jmp	short loc_41337D
; ---------------------------------------------------------------------------

loc_413376:				; CODE XREF: sub_4131E4+B3j
		nop
		jmp	short loc_41337D
; ---------------------------------------------------------------------------

loc_413379:				; CODE XREF: sub_4131E4+C1j
		nop
		jmp	short loc_41337D
; ---------------------------------------------------------------------------

loc_41337C:				; CODE XREF: sub_4131E4+D0j
					; sub_4131E4+EFj ...
		nop

loc_41337D:				; CODE XREF: sub_4131E4+190j
					; sub_4131E4+193j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_413391
		cmp	[ebp+arg_8], 0
		jz	short loc_413391
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_413391:				; CODE XREF: sub_4131E4+19Dj
					; sub_4131E4+1A3j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

locret_41339F:				; CODE XREF: sub_4131E4+5Dj
					; sub_4131E4+65j ...
		leave
		retn
sub_4131E4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4133A4	proc near		; CODE XREF: sub_4133CB+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4133C4
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4133C9
; ---------------------------------------------------------------------------

loc_4133C4:				; CODE XREF: sub_4133A4+7j
		mov	eax, 0

loc_4133C9:				; CODE XREF: sub_4133A4+1Ej
		pop	ebp
		retn
sub_4133A4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4133CB	proc near		; CODE XREF: sub_4133E6+Ep
					; sub_41354E+2Ap ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_4133A4
		leave
		retn
sub_4133CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4133E6	proc near		; CODE XREF: sub_41354E+48p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_4133CB
		leave
		retn
sub_4133E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4133FB	proc near		; CODE XREF: sub_4136B7+22Ap

C		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_29		= byte ptr -29h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		cmp	[ebp+arg_10], 0
		jnz	loc_4134DA
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+C], eax
		call	gcry_md_algo_name
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_4134A5
		mov	eax, [ebp+var_14]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Fh
		ja	short loc_4134A5
		mov	[ebp+var_10], 0
		jmp	short loc_413476
; ---------------------------------------------------------------------------

loc_413452:				; CODE XREF: sub_4133FB+9Fj
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+68h+C], eax ; C
		mov	eax, ds:tolower
		call	eax ; tolower
		mov	edx, eax
		lea	eax, [ebp+var_29]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1

loc_413476:				; CODE XREF: sub_4133FB+55j
		mov	ebx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jb	short loc_413452
		lea	eax, [ebp+var_29]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0

loc_4134A5:				; CODE XREF: sub_4133FB+24j
					; sub_4133FB+4Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		mov	[esp+68h+var_54], edx
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_29]
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], offset aDataFlagsPkcs1 ; "(data (flags pkcs1)	(hash %s %b))"
		mov	[esp+68h+var_64], 0
		lea	eax, [ebp+var_18]
		mov	[esp+68h+C], eax
		call	gcry_sexp_build
		mov	[ebp+var_C], eax
		jmp	short loc_41353C
; ---------------------------------------------------------------------------

loc_4134DA:				; CODE XREF: sub_4133FB+Cj
		mov	[esp+68h+var_58], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+var_5C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_60], eax
		mov	[esp+68h+var_64], 5
		lea	eax, [ebp+var_30]
		mov	[esp+68h+C], eax
		call	gcry_mpi_scan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41353C
		mov	eax, [ebp+var_30]
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], offset aDataFlagsRawVa ; "(data (flags raw) (value %m))"
		mov	[esp+68h+var_64], 0
		lea	eax, [ebp+var_18]
		mov	[esp+68h+C], eax
		call	gcry_sexp_build
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+C], eax
		call	gcry_mpi_release

loc_41353C:				; CODE XREF: sub_4133FB+DDj
					; sub_4133FB+10Fj
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4133FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41354E(void *Src, size_t, int, int)
sub_41354E	proc near		; CODE XREF: sub_4136B7+1E8p

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Src		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_8]
		add	eax, 7
		shr	eax, 3
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_413571
		mov	eax, [ebp+arg_4]
		add	eax, 0Ch
		cmp	eax, [ebp+var_C]
		jbe	short loc_413582

loc_413571:				; CODE XREF: sub_41354E+16j
		mov	[esp+48h+Dst], 42h
		call	sub_4133CB
		jmp	locret_4136B5
; ---------------------------------------------------------------------------

loc_413582:				; CODE XREF: sub_41354E+21j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4135A0
		call	sub_4133E6
		jmp	locret_4136B5
; ---------------------------------------------------------------------------

loc_4135A0:				; CODE XREF: sub_41354E+46j
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	byte ptr [eax],	1
		add	[ebp+var_14], 1
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		sub	eax, 3
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 7
		ja	short loc_4135F9
		mov	[esp+48h+Size],	6Bh ; int
		mov	[esp+48h+Val], offset a____Gnupg22__4 ;	"../../gnupg2-2.0.30/agent/pksign.c"
		mov	[esp+48h+Dst], offset aI8 ; "i >= 8"
		call	sub_43BB20

loc_4135F9:				; CODE XREF: sub_41354E+8Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Size],	eax ; Size
		mov	[esp+48h+Val], 0FFh ; Val
		mov	[esp+48h+Dst], edx ; Dst
		call	memset
		mov	eax, [ebp+var_18]
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_14]
		mov	ecx, [ebp+arg_4]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Val], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_C]
		jz	short loc_413673
		mov	[esp+48h+Size],	71h ; int
		mov	[esp+48h+Val], offset a____Gnupg22__4 ;	"../../gnupg2-2.0.30/agent/pksign.c"
		mov	[esp+48h+Dst], offset aNNframe ; "n == nframe"
		call	sub_43BB20

loc_413673:				; CODE XREF: sub_41354E+107j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+Size],	offset aDataFlagsRaw_0 ; "(data	(flags raw) (value %b))"
		mov	[esp+48h+Val], 0
		lea	eax, [ebp+var_20]
		mov	[esp+48h+Dst], eax
		call	gcry_sexp_build
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]

locret_4136B5:				; CODE XREF: sub_41354E+2Fj
					; sub_41354E+4Dj
		leave
		retn
sub_41354E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4136B7	proc near		; CODE XREF: sub_40C7DB+23Fp
					; sub_4139AE+45p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+78h]
		test	eax, eax
		jnz	short loc_4136F6
		mov	[esp+48h+var_48], 11h
		call	sub_4133CB
		jmp	loc_4139A7
; ---------------------------------------------------------------------------

loc_4136F6:				; CODE XREF: sub_4136B7+2Cj
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+64h]
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_38], eax
		lea	eax, [ebp+var_1C]
		mov	dword ptr [esp+48h+var_3C], eax
		mov	[esp+48h+var_40], edx
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+48h+var_44], eax ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_412630
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413748
		mov	[esp+48h+var_48], offset aFailedToReadTh ; "failed to read the secret key\n"
		call	sub_435B7D
		jmp	loc_413986
; ---------------------------------------------------------------------------

loc_413748:				; CODE XREF: sub_4136B7+7Ej
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	loc_413862
		mov	[ebp+var_20], 0
		mov	[ebp+var_10], 0
		mov	ecx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		mov	ebx, [ebp+arg_0]
		lea	esi, [ebx+1Ch]
		lea	ebx, [ebp+var_20]
		mov	[esp+48h+var_34], ebx ;	int
		mov	[esp+48h+var_38], ecx ;	int
		mov	dword ptr [esp+48h+var_3C], edx	; char
		mov	[esp+48h+var_40], eax ;	size_t
		mov	[esp+48h+var_44], esi ;	void *
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_419BE2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4137C1
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aSmartcardSigni ; "smartcard signing failed: %s\n"
		call	sub_435B7D
		jmp	loc_413986
; ---------------------------------------------------------------------------

loc_4137C1:				; CODE XREF: sub_4136B7+E8j
		mov	eax, [ebp+var_20]
		mov	dword ptr [esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_413809
		mov	[esp+48h+var_40], 0A9h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__4 ; "../../gnupg2-2.0.30/agent/pksign.c"
		mov	[esp+48h+var_48], offset aLen_0	; "len"
		call	sub_43BB20

loc_413809:				; CODE XREF: sub_4136B7+134j
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_10]
		mov	dword ptr [esp+48h+var_3C], edx
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], 0
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	loc_413986
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aFailedToConver ; "failed to convert sigbuf returned by di"...
		call	sub_435B7D
		jmp	loc_413986
; ---------------------------------------------------------------------------

loc_413862:				; CODE XREF: sub_4136B7+96j
		mov	dword ptr [ebp+var_24],	0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		cmp	eax, 401h
		jnz	short loc_4138A9
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_pk_get_nbits
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+5Ch]
		mov	ecx, [ebp+arg_0]
		lea	ebx, [ecx+1Ch]
		lea	ecx, [ebp+var_24]
		mov	dword ptr [esp+48h+var_3C], ecx	; int
		mov	[esp+48h+var_40], eax ;	int
		mov	[esp+48h+var_44], edx ;	size_t
		mov	[esp+48h+var_48], ebx ;	Src
		call	sub_41354E
		mov	[ebp+var_C], eax
		jmp	short loc_4138E9
; ---------------------------------------------------------------------------

loc_4138A9:				; CODE XREF: sub_4136B7+1BDj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+60h]
		shl	eax, 7
		sar	al, 7
		movsx	ecx, al
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		mov	ebx, [ebp+arg_0]
		add	ebx, 1Ch
		mov	[esp+48h+var_38], ecx
		lea	ecx, [ebp+var_24]
		mov	dword ptr [esp+48h+var_3C], ecx
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], ebx
		call	sub_4133FB
		mov	[ebp+var_C], eax

loc_4138E9:				; CODE XREF: sub_4136B7+1F0j
		cmp	[ebp+var_C], 0
		jnz	loc_413985
		mov	eax, ds:dword_449DA0
		and	eax, 4
		test	eax, eax
		jz	short loc_413916
		mov	[esp+48h+var_48], offset aSkey ; "skey:	"
		call	sub_435C1A
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_dump

loc_413916:				; CODE XREF: sub_4136B7+246j
		mov	edx, [ebp+var_14]
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax ;	char
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_pk_sign
		mov	[ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_release
		cmp	[ebp+var_C], 0
		jz	short loc_413960
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aSigningFailedS ; "signing failed: %s\n"
		call	sub_435B7D
		jmp	short loc_413986
; ---------------------------------------------------------------------------

loc_413960:				; CODE XREF: sub_4136B7+28Aj
		mov	eax, ds:dword_449DA0
		and	eax, 4
		test	eax, eax
		jz	short loc_413986
		mov	[esp+48h+var_48], offset aResult ; "result: "
		call	sub_435C1A
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_dump
		jmp	short loc_413986
; ---------------------------------------------------------------------------

loc_413985:				; CODE XREF: sub_4136B7+236j
		nop

loc_413986:				; CODE XREF: sub_4136B7+8Cj
					; sub_4136B7+105j ...
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_4139A7:				; CODE XREF: sub_4136B7+3Aj
		add	esp, 40h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4136B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4139AE	proc near		; CODE XREF: sub_406727+75p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[esp+38h+var_28], 0
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4136B7
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_413ABC
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 1
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_413A4D
		mov	[esp+38h+var_30], 0F9h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__4 ; "../../gnupg2-2.0.30/agent/pksign.c"
		mov	[esp+38h+var_38], offset aLen_0	; "len"
		call	sub_43BB20

loc_413A4D:				; CODE XREF: sub_4139AE+81j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_xmalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+var_2C], edx
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+var_34], 1
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_413AA1
		mov	[esp+38h+var_30], 0FCh ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__4 ; "../../gnupg2-2.0.30/agent/pksign.c"
		mov	[esp+38h+var_38], offset aLen_0	; "len"
		call	sub_43BB20

loc_413AA1:				; CODE XREF: sub_4139AE+D5j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax ;	size_t
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_34], eax ;	void *
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_424524
		jmp	short loc_413ABD
; ---------------------------------------------------------------------------

loc_413ABC:				; CODE XREF: sub_4139AE+51j
		nop

loc_413ABD:				; CODE XREF: sub_4139AE+10Cj
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		leave
		retn
sub_4139AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413AD8	proc near		; CODE XREF: sub_413AFF+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_413AF8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_413AFD
; ---------------------------------------------------------------------------

loc_413AF8:				; CODE XREF: sub_413AD8+7j
		mov	eax, 0

loc_413AFD:				; CODE XREF: sub_413AD8+1Ej
		pop	ebp
		retn
sub_413AD8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413AFF	proc near		; CODE XREF: sub_413B27+4Ap
					; sub_413B27+A3p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_413AD8
		leave
		retn
sub_413AFF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413B1A	proc near		; CODE XREF: sub_413B27+13Dp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_413B1A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413B27	proc near		; CODE XREF: sub_406810+8Ap

Dest		= dword	ptr -98h
Format		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_6C		= dword	ptr -6Ch
var_60		= byte ptr -60h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 94h
		mov	[ebp+var_10], 0
		mov	dword ptr [ebp+var_14],	0
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+78h]
		test	eax, eax
		jnz	short loc_413B7E
		mov	[esp+98h+Dest],	offset aSpeculativeDec ; "speculative decryption not yet supporte"...
		call	sub_435B7D
		mov	[esp+98h+Dest],	11h
		call	sub_413AFF
		mov	[ebp+var_C], eax
		jmp	loc_413F2A
; ---------------------------------------------------------------------------

loc_413B7E:				; CODE XREF: sub_413B27+35j
		mov	eax, [ebp+arg_C]
		mov	[esp+98h+var_8C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+var_90], eax
		mov	[esp+98h+Format], 0
		lea	eax, [ebp+var_14]
		mov	[esp+98h+Dest],	eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413BD7
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Dest],	eax
		call	gpg_strerror
		mov	[esp+98h+Format], eax ;	char
		mov	[esp+98h+Dest],	offset aFailedToConv_0 ; "failed to convert ciphertext:	%s\n"
		call	sub_435B7D
		mov	[esp+98h+Dest],	4Fh
		call	sub_413AFF
		mov	[ebp+var_C], eax
		jmp	loc_413F2A
; ---------------------------------------------------------------------------

loc_413BD7:				; CODE XREF: sub_413B27+7Fj
		mov	eax, ds:dword_449DA0
		and	eax, 4
		test	eax, eax
		jz	short loc_413C1B
		mov	eax, [ebp+arg_0]
		add	eax, 64h
		mov	[esp+98h+var_90], 14h
		mov	[esp+98h+Format], eax
		mov	[esp+98h+Dest],	offset aKeygrip	; "keygrip:"
		call	sub_435C74
		mov	eax, [ebp+arg_C]
		mov	[esp+98h+var_90], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Format], eax
		mov	[esp+98h+Dest],	offset aCipher ; "cipher: "
		call	sub_435C74

loc_413C1B:				; CODE XREF: sub_413B27+BAj
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+64h]
		lea	eax, [ebp+var_10]
		mov	[esp+98h+var_80], eax
		mov	[esp+98h+var_84], 0
		mov	[esp+98h+var_88], 2
		lea	eax, [ebp+var_1C]
		mov	[esp+98h+var_8C], eax
		mov	[esp+98h+var_90], edx
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+98h+Format], eax ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Dest],	eax
		call	sub_412630
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413C95
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Dest],	eax
		call	sub_413B1A
		cmp	eax, 8051h
		jnz	short loc_413C84
		mov	[esp+98h+Dest],	11h
		call	sub_413AFF
		mov	[ebp+var_C], eax
		jmp	loc_413F2A
; ---------------------------------------------------------------------------

loc_413C84:				; CODE XREF: sub_413B27+147j
		mov	[esp+98h+Dest],	offset aFailedToRead_0 ; "failed to read the secret key\n"
		call	sub_435B7D
		jmp	loc_413F2A
; ---------------------------------------------------------------------------

loc_413C95:				; CODE XREF: sub_413B27+135j
		mov	eax, [ebp+var_10]
		test	eax, eax
		jnz	loc_413DB3
		mov	[esp+98h+var_8C], 0
		mov	[esp+98h+var_90], 0
		mov	eax, [ebp+arg_C]
		mov	[esp+98h+Format], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Dest],	eax
		call	gcry_sexp_canon_len
		test	eax, eax
		jnz	short loc_413CDA
		mov	[esp+98h+Dest],	53h
		call	sub_413AFF
		mov	[ebp+var_C], eax
		jmp	loc_413F2A
; ---------------------------------------------------------------------------

loc_413CDA:				; CODE XREF: sub_413B27+19Dj
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_24]
		mov	[esp+98h+var_88], edx
		lea	edx, [ebp+var_20]
		mov	[esp+98h+var_8C], edx
		mov	[esp+98h+var_90], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Dest],	eax
		call	sub_419D1E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413D2A
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Dest],	eax
		call	gpg_strerror
		mov	[esp+98h+Format], eax ;	char
		mov	[esp+98h+Dest],	offset aSmartcardDecry ; "smartcard decryption failed: %s\n"
		call	sub_435B7D
		jmp	loc_413F2A
; ---------------------------------------------------------------------------

loc_413D2A:				; CODE XREF: sub_413B27+1E1j
		mov	edx, [ebp+var_24]
		mov	eax, offset a5ValueU ; "(5:value%u:"
		mov	[esp+98h+var_90], edx
		mov	[esp+98h+Format], eax ;	Format
		lea	eax, [ebp+var_60]
		mov	[esp+98h+Dest],	eax ; Dest
		call	sprintf
		lea	eax, [ebp+var_60]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+98h+var_90], eax ;	size_t
		lea	eax, [ebp+var_60]
		mov	[esp+98h+Format], eax ;	void *
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+Dest],	eax ; int
		call	sub_424524
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	[esp+98h+var_90], edx ;	size_t
		mov	[esp+98h+Format], eax ;	void *
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+Dest],	eax ; int
		call	sub_424524
		mov	[esp+98h+var_90], 2 ; size_t
		mov	[esp+98h+Format], offset asc_443B99 ; ")"
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+Dest],	eax ; int
		call	sub_424524
		jmp	loc_413F2A
; ---------------------------------------------------------------------------

loc_413DB3:				; CODE XREF: sub_413B27+173j
		mov	edx, [ebp+var_10]
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+98h+var_90], edx
		mov	[esp+98h+Format], eax ;	char
		lea	eax, [ebp+var_18]
		mov	[esp+98h+Dest],	eax
		call	gcry_pk_decrypt
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413DF5
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Dest],	eax
		call	gpg_strerror
		mov	[esp+98h+Format], eax ;	char
		mov	[esp+98h+Dest],	offset aDecryptionFail ; "decryption failed: %s\n"
		call	sub_435B7D
		jmp	loc_413F2A
; ---------------------------------------------------------------------------

loc_413DF5:				; CODE XREF: sub_413B27+2ACj
		mov	eax, ds:dword_449DA0
		and	eax, 4
		test	eax, eax
		jz	short loc_413E18
		mov	[esp+98h+Dest],	offset aPlain ;	"plain:	"
		call	sub_435C1A
		mov	eax, [ebp+var_18]
		mov	[esp+98h+Dest],	eax
		call	gcry_sexp_dump

loc_413E18:				; CODE XREF: sub_413B27+2D8j
		mov	eax, [ebp+var_18]
		mov	[esp+98h+var_8C], 0
		mov	[esp+98h+var_90], 0
		mov	[esp+98h+Format], 1
		mov	[esp+98h+Dest],	eax
		call	gcry_sexp_sprint
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		test	eax, eax
		jnz	short loc_413E61
		mov	[esp+98h+var_90], 7Dh ;	int
		mov	[esp+98h+Format], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/agent/pkdecrypt.c"
		mov	[esp+98h+Dest],	offset aLen_1 ;	"len"
		call	sub_43BB20

loc_413E61:				; CODE XREF: sub_413B27+31Cj
		mov	eax, [ebp+var_24]
		mov	[esp+98h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_24]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_18]
		mov	[esp+98h+var_8C], ecx
		mov	[esp+98h+var_90], edx
		mov	[esp+98h+Format], 1
		mov	[esp+98h+Dest],	eax
		call	gcry_sexp_sprint
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		test	eax, eax
		jnz	short loc_413EB6
		mov	[esp+98h+var_90], 80h ;	int
		mov	[esp+98h+Format], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/agent/pkdecrypt.c"
		mov	[esp+98h+Dest],	offset aLen_1 ;	"len"
		call	sub_43BB20

loc_413EB6:				; CODE XREF: sub_413B27+371j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_413EDB
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	[esp+98h+var_90], edx ;	size_t
		mov	[esp+98h+Format], eax ;	void *
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+Dest],	eax ; int
		call	sub_424524
		jmp	short loc_413F2A
; ---------------------------------------------------------------------------

loc_413EDB:				; CODE XREF: sub_413B27+397j
		mov	[esp+98h+var_90], 8 ; size_t
		mov	[esp+98h+Format], offset a5Value ; "(5:value"
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+Dest],	eax ; int
		call	sub_424524
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	[esp+98h+var_90], edx ;	size_t
		mov	[esp+98h+Format], eax ;	void *
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+Dest],	eax ; int
		call	sub_424524
		mov	[esp+98h+var_90], 2 ; size_t
		mov	[esp+98h+Format], offset asc_443B99 ; ")"
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+Dest],	eax ; int
		call	sub_424524

loc_413F2A:				; CODE XREF: sub_413B27+52j
					; sub_413B27+ABj ...
		mov	eax, [ebp+var_10]
		mov	[esp+98h+Dest],	eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_18]
		mov	[esp+98h+Dest],	eax
		call	gcry_sexp_release
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+98h+Dest],	eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_20]
		mov	[esp+98h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		mov	[esp+98h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		add	esp, 94h
		pop	edi
		pop	ebp
		retn
sub_413B27	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413F70	proc near		; CODE XREF: sub_413F97+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_413F90
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_413F95
; ---------------------------------------------------------------------------

loc_413F90:				; CODE XREF: sub_413F70+7j
		mov	eax, 0

loc_413F95:				; CODE XREF: sub_413F70+1Ej
		pop	ebp
		retn
sub_413F70	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413F97	proc near		; CODE XREF: sub_413FB2+Ep
					; sub_413FD4+2Fp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_413F70
		leave
		retn
sub_413F97	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413FB2	proc near		; CODE XREF: sub_413FC7+6p
					; sub_414196+2Cp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_413F97
		leave
		retn
sub_413FB2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413FC7	proc near		; CODE XREF: sub_413FD4+96p
					; sub_414701+46Dp
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_413FB2
		leave
		retn
sub_413FC7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413FD4	proc near		; CODE XREF: sub_414701+3B7p
					; sub_414C0D+206p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_44], eax ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	gcry_pk_get_keygrip
		test	eax, eax
		jnz	short loc_41400D
		mov	[esp+48h+var_48], offset aCanTCalculateK ; "can't calculate keygrip\n"
		call	sub_435B7D
		mov	[esp+48h+var_48], 1
		call	sub_413F97
		jmp	locret_41413C
; ---------------------------------------------------------------------------

loc_41400D:				; CODE XREF: sub_413FD4+1Aj
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+Size],	0
		mov	[esp+48h+var_44], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_414056
		mov	[esp+48h+Size],	30h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__6 ; "../../gnupg2-2.0.30/agent/genkey.c"
		mov	[esp+48h+var_48], offset aLen_2	; "len"
		call	sub_43BB20

loc_414056:				; CODE XREF: sub_413FD4+64j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc_secure
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_414074
		call	sub_413FC7
		jmp	locret_41413C
; ---------------------------------------------------------------------------

loc_414074:				; CODE XREF: sub_413FD4+94j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+Str]
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+var_44], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_4140BB
		mov	[esp+48h+Size],	35h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__6 ; "../../gnupg2-2.0.30/agent/genkey.c"
		mov	[esp+48h+var_48], offset aLen_2	; "len"
		call	sub_43BB20

loc_4140BB:				; CODE XREF: sub_413FD4+C9j
		cmp	[ebp+arg_4], 0
		jz	short loc_41410B
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+Str]
		mov	[esp+48h+var_48], eax
		call	sub_415A18
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4140FA
		mov	eax, [ebp+Str]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		jmp	short locret_41413C
; ---------------------------------------------------------------------------

loc_4140FA:				; CODE XREF: sub_413FD4+114j
		mov	eax, [ebp+Str]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_2C]
		mov	[ebp+Str], eax

loc_41410B:				; CODE XREF: sub_413FD4+EBj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_3C], edx ;	int
		mov	[esp+48h+Size],	eax ; Size
		mov	eax, [ebp+Str]
		mov	[esp+48h+var_44], eax ;	Str
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_4118C7
		mov	[ebp+var_10], eax
		mov	eax, [ebp+Str]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_10]

locret_41413C:				; CODE XREF: sub_413FD4+34j
					; sub_413FD4+9Bj ...
		leave
		retn
sub_413FD4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41413E	proc near		; CODE XREF: sub_414492+BFp

C		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_414187
; ---------------------------------------------------------------------------

loc_41414D:				; CODE XREF: sub_41413E+51j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_414183
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		cmp	eax, 9
		jbe	short loc_41417F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:ispunct
		call	eax ; ispunct
		test	eax, eax
		jz	short loc_414183

loc_41417F:				; CODE XREF: sub_41413E+28j
		add	[ebp+var_C], 1

loc_414183:				; CODE XREF: sub_41413E+17j
					; sub_41413E+3Fj
		add	[ebp+arg_0], 1

loc_414187:				; CODE XREF: sub_41413E+Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41414D
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41413E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414196(int, void *)
sub_414196	proc near		; CODE XREF: sub_414492+16Fp

Str		= dword	ptr -78h
Size		= dword	ptr -74h
Count		= dword	ptr -70h
File		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_1C		= dword	ptr -1Ch
lpApplicationName= dword ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 70h
		mov	[ebp+var_14], 0
		mov	[esp+78h+Str], 6
		call	sub_41F46E
		mov	[ebp+lpApplicationName], eax
		call	sub_41E537
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4141F9
		call	sub_413FB2
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+78h+Str], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+78h+Str], offset aErrorCreatingT ;	"error creating	temporary file:	%s\n"
		call	sub_435294
		mov	[esp+78h+Size],	ebx ; char
		mov	[esp+78h+Str], eax ; char *
		call	sub_435B7D
		mov	eax, 1
		jmp	loc_4143DD
; ---------------------------------------------------------------------------

loc_4141F9:				; CODE XREF: sub_414196+2Aj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_50], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_50]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_1C]
		mov	[esp+78h+File],	edx ; File
		mov	[esp+78h+Count], 1 ; Count
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Str], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_41427D
		call	sub_413FB2
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+78h+Str], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+78h+Str], offset aErrorWritingTo ;	"error writing to temporary file: %s\n"
		call	sub_435294
		mov	[esp+78h+Size],	ebx ; char
		mov	[esp+78h+Str], eax ; char *
		call	sub_435B7D
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+Str], eax ; File
		call	fclose
		mov	eax, 1
		jmp	loc_4143DD
; ---------------------------------------------------------------------------

loc_41427D:				; CODE XREF: sub_414196+A3j
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+Str], eax ; File
		call	rewind
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+eax*4+var_44], offset aNull ; "--null"
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+eax*4+var_44], offset asc_443C84 ;	"--"
		add	[ebp+var_10], 1
		mov	edx, ds:dword_449DFC
		mov	eax, [ebp+var_10]
		mov	[ebp+eax*4+var_44], edx
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+eax*4+var_44], 0
		mov	eax, [ebp+var_10]
		cmp	eax, 27h
		jbe	short loc_4142ED
		mov	[esp+78h+Count], 7Fh ; int
		mov	[esp+78h+Size],	offset a____Gnupg22__6 ; "../../gnupg2-2.0.30/agent/genkey.c"
		mov	[esp+78h+Str], offset aISizeofArgv ; "i	< sizeof argv"
		call	sub_43BB20

loc_4142ED:				; CODE XREF: sub_414196+139j
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+Str], eax ; File
		call	_fileno
		lea	edx, [ebp+var_48]
		mov	[esp+78h+var_64], edx ;	int
		mov	[esp+78h+var_68], 0FFFFFFFFh ; int
		mov	[esp+78h+File],	0FFFFFFFFh ; int
		mov	[esp+78h+Count], eax ; int
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Size],	eax ; int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+78h+Str], eax ; lpApplicationName
		call	sub_41D8C8
		test	eax, eax
		jz	short loc_414332
		mov	[ebp+var_C], 1
		jmp	short loc_414360
; ---------------------------------------------------------------------------

loc_414332:				; CODE XREF: sub_414196+191j
		mov	eax, [ebp+var_48]
		mov	[esp+78h+Count], 0
		mov	[esp+78h+Size],	eax
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+78h+Str], eax
		call	sub_41DB37
		test	eax, eax
		jz	short loc_414359
		mov	[ebp+var_C], 1
		jmp	short loc_414360
; ---------------------------------------------------------------------------

loc_414359:				; CODE XREF: sub_414196+1B8j
		mov	[ebp+var_C], 0

loc_414360:				; CODE XREF: sub_414196+19Aj
					; sub_414196+1C1j
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+Str], eax ; File
		call	rewind
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_50], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_50]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 63h
		mov	[ebp+var_4C], eax
		mov	edx, 51EB851Fh
		mov	eax, [ebp+var_4C]
		mul	edx
		mov	eax, edx
		shr	eax, 5
		imul	eax, 64h
		mov	[ebp+var_10], eax
		jmp	short loc_4143BE
; ---------------------------------------------------------------------------

loc_4143A7:				; CODE XREF: sub_414196+22Cj
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+Size],	eax ; File
		mov	[esp+78h+Str], 0FFFFFFFFh ; Ch
		call	putc
		sub	[ebp+var_10], 1

loc_4143BE:				; CODE XREF: sub_414196+20Fj
		cmp	[ebp+var_10], 0
		jg	short loc_4143A7
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+Str], eax ; File
		call	fflush
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+Str], eax ; File
		call	fclose
		mov	eax, [ebp+var_C]

loc_4143DD:				; CODE XREF: sub_414196+5Ej
					; sub_414196+E2j
		add	esp, 70h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_414196	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4143E4	proc near		; CODE XREF: sub_414468+23p
					; sub_414492+21Fp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_449DF0
		test	eax, eax
		jz	short loc_41442F
		mov	[esp+38h+var_38], offset aEnterNewPassph ; "Enter new passphrase"
		call	sub_435294
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41091D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_414463
		mov	[esp+38h+var_38], 63h
		call	sub_413F97
		mov	[ebp+var_C], eax
		jmp	short loc_414463
; ---------------------------------------------------------------------------

loc_41442F:				; CODE XREF: sub_4143E4+Dj
		mov	[esp+38h+var_38], offset aEnterNewPassph ; "Enter new passphrase"
		call	sub_435294
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4105B0
		mov	[ebp+var_C], eax

loc_414463:				; CODE XREF: sub_4143E4+38j
					; sub_4143E4+49j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4143E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414468	proc near		; CODE XREF: sub_414492+98p
					; sub_414492+12Ep ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aTakeThisOneAny ; "Take this one anyway"
		call	sub_435294
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4143E4
		leave
		retn
sub_414468	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414492(int, void *, int)
sub_414492	proc near		; CODE XREF: sub_4074BA+453p
					; sub_40F547+B1p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_449DF4
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449DF8
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_4144B5
		mov	[ebp+arg_4], offset byte_443CC1

loc_4144B5:				; CODE XREF: sub_414492+1Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_432E67
		cmp	eax, [ebp+var_C]
		jnb	loc_41454B
		cmp	[ebp+arg_8], 0
		jz	short loc_4144E0
		mov	[esp+38h+var_38], 1Fh
		call	sub_413F97
		jmp	locret_4146C9
; ---------------------------------------------------------------------------

loc_4144E0:				; CODE XREF: sub_414492+3Bj
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax ;	int
		mov	[esp+38h+var_34], offset aWarningYouHave ; "Warning: You have entered an insecure p"...
		mov	[esp+38h+var_38], offset aWarningYouHa_0 ; "Warning: You have entered an insecure p"...
		call	sub_4352DA
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_4256F5
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41451D
		call	sub_413FB2
		jmp	locret_4146C9
; ---------------------------------------------------------------------------

loc_41451D:				; CODE XREF: sub_414492+7Fj
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_414468
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		cmp	[ebp+var_18], 0
		jz	short loc_41454B
		mov	eax, [ebp+var_18]
		jmp	locret_4146C9
; ---------------------------------------------------------------------------

loc_41454B:				; CODE XREF: sub_414492+31j
					; sub_414492+AFj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_41413E
		cmp	eax, [ebp+var_10]
		jnb	loc_4145E1
		cmp	[ebp+arg_8], 0
		jz	short loc_414576
		mov	[esp+38h+var_38], 1Fh
		call	sub_413F97
		jmp	locret_4146C9
; ---------------------------------------------------------------------------

loc_414576:				; CODE XREF: sub_414492+D1j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax ;	int
		mov	[esp+38h+var_34], offset aWarningYouHa_1 ; "Warning: You have entered an insecure p"...
		mov	[esp+38h+var_38], offset aWarningYouHa_2 ; "Warning: You have entered an insecure p"...
		call	sub_4352DA
		mov	edx, [ebp+var_10]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_4256F5
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4145B3
		call	sub_413FB2
		jmp	locret_4146C9
; ---------------------------------------------------------------------------

loc_4145B3:				; CODE XREF: sub_414492+115j
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_414468
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		cmp	[ebp+var_18], 0
		jz	short loc_4145E1
		mov	eax, [ebp+var_18]
		jmp	locret_4146C9
; ---------------------------------------------------------------------------

loc_4145E1:				; CODE XREF: sub_414492+C7j
					; sub_414492+145j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_414650
		mov	eax, ds:dword_449DFC
		test	eax, eax
		jz	short loc_414650
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax ;	void *
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_414196
		test	eax, eax
		jz	short loc_414650
		mov	[esp+38h+var_38], offset aWarningYouHa_3 ; "Warning: You have entered an insecure p"...
		call	sub_435294
		mov	[ebp+var_20], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_414630
		mov	[esp+38h+var_38], 1Fh
		call	sub_413F97
		jmp	locret_4146C9
; ---------------------------------------------------------------------------

loc_414630:				; CODE XREF: sub_414492+18Bj
		mov	eax, [ebp+var_20]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_414468
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_414650
		mov	eax, [ebp+var_18]
		jmp	short locret_4146C9
; ---------------------------------------------------------------------------

loc_414650:				; CODE XREF: sub_414492+157j
					; sub_414492+160j ...
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4146C4
		mov	eax, ds:dword_449DF0
		test	eax, eax
		jz	short loc_414671
		mov	[esp+38h+var_38], offset aYouHaveNotEnte ; "You	have not entered a passphrase!%0AAn"...
		call	sub_435294
		jmp	short loc_41467D
; ---------------------------------------------------------------------------

loc_414671:				; CODE XREF: sub_414492+1CFj
		mov	[esp+38h+var_38], offset aYouHaveNotEn_0 ; "You	have not entered a passphrase -	thi"...
		call	sub_435294

loc_41467D:				; CODE XREF: sub_414492+1DDj
		mov	[ebp+var_24], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_414694
		mov	[esp+38h+var_38], 1Fh
		call	sub_413F97
		jmp	short locret_4146C9
; ---------------------------------------------------------------------------

loc_414694:				; CODE XREF: sub_414492+1F2j
		mov	[esp+38h+var_38], offset aYesProtectionI ; "Yes, protection is not needed"
		call	sub_435294
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_24]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4143E4
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4146C4
		mov	eax, [ebp+var_18]
		jmp	short locret_4146C9
; ---------------------------------------------------------------------------

loc_4146C4:				; CODE XREF: sub_414492+1C6j
					; sub_414492+22Bj
		mov	eax, 0

locret_4146C9:				; CODE XREF: sub_414492+49j
					; sub_414492+86j ...
		leave
		retn
sub_414492	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4146CB	proc near		; DATA XREF: sub_414701+E4o
					; sub_414C0D+8Eo

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		add	eax, 24h
		mov	[esp+28h+Str2],	eax ; Str2
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4146FA
		mov	eax, 0
		jmp	short locret_4146FF
; ---------------------------------------------------------------------------

loc_4146FA:				; CODE XREF: sub_4146CB+26j
		mov	eax, 0FFFFFFFFh

locret_4146FF:				; CODE XREF: sub_4146CB+2Dj
		leave
		retn
sub_4146CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414701	proc near		; CODE XREF: sub_40691D+7Cp

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+var_5C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+var_60], eax
		mov	[esp+68h+var_64], 0
		lea	eax, [ebp+var_38]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41475D
		mov	eax, [ebp+var_14]
		mov	[esp+68h+var_68], eax
		call	gpg_strerror
		mov	[esp+68h+var_64], eax ;	char
		mov	[esp+68h+var_68], offset aFailedToConv_1 ; "failed to convert keyparam:	%s\n"
		call	sub_435B7D
		mov	[esp+68h+var_68], 4Fh
		call	sub_413F97
		jmp	locret_414C0B
; ---------------------------------------------------------------------------

loc_41475D:				; CODE XREF: sub_414701+2Ej
		mov	[esp+68h+var_68], offset aPleaseEnterT_0 ; "Please enter the passphrase	to%0Aprotec"...
		call	sub_435294
		mov	[ebp+var_1C], eax
		mov	[esp+68h+var_68], offset aPleaseReEnte_1 ; "Please re-enter this passphrase"
		call	sub_435294
		mov	[ebp+var_20], eax
		mov	[ebp+var_18], 0
		mov	[esp+68h+var_64], 8Dh
		mov	[esp+68h+var_68], 1
		call	gcry_calloc_secure
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+20h], 65h
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+8], 3
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+10h], 1
		mov	[esp+68h+var_64], 8Dh
		mov	[esp+68h+var_68], 1
		call	gcry_calloc_secure
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+20h], 65h
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], 3
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+14h], offset sub_4146CB
		mov	eax, [ebp+var_C]
		lea	edx, [eax+24h]
		mov	eax, [ebp+var_10]
		mov	[eax+18h], edx

loc_4147F8:				; CODE XREF: sub_414701+178j
					; sub_414701+1E3j
		mov	[esp+68h+var_50], 0 ; int
		mov	[esp+68h+var_54], 0 ; int
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_58], eax ;	int
		mov	eax, [ebp+var_18]
		mov	[esp+68h+var_5C], eax ;	int
		mov	[esp+68h+var_60], 0 ; char *
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+var_64], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax ;	int
		call	sub_40F902
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+var_14], 0
		jnz	loc_4148E9
		mov	eax, [ebp+var_C]
		add	eax, 24h
		mov	[esp+68h+var_60], 0 ; int
		mov	[esp+68h+var_64], eax ;	void *
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax ;	int
		call	sub_414492
		test	eax, eax
		jz	short loc_41487E
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 0
		jmp	loc_4147F8
; ---------------------------------------------------------------------------

loc_41487E:				; CODE XREF: sub_414701+162j
		mov	eax, [ebp+var_C]
		add	eax, 24h
		test	eax, eax
		jz	short loc_4148E9
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+24h]
		test	al, al
		jz	short loc_4148E9
		mov	[esp+68h+var_50], 0 ; int
		mov	[esp+68h+var_54], 0 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_58], eax ;	int
		mov	[esp+68h+var_5C], 0 ; int
		mov	[esp+68h+var_60], 0 ; char *
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_64], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax ;	int
		call	sub_40F902
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0FFFFFFFFh
		jnz	short loc_4148E9
		mov	[esp+68h+var_68], offset aDoesNotMatch_1 ; "does not match - try again"
		call	sub_435294
		mov	[ebp+var_18], eax
		jmp	loc_4147F8
; ---------------------------------------------------------------------------

loc_4148E9:				; CODE XREF: sub_414701+13Dj
					; sub_414701+185j ...
		cmp	[ebp+var_14], 0
		jz	short loc_41490D
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	locret_414C0B
; ---------------------------------------------------------------------------

loc_41490D:				; CODE XREF: sub_414701+1ECj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+24h]
		test	al, al
		jnz	short loc_41493B
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_41493B:				; CODE XREF: sub_414701+215j
		mov	eax, [ebp+var_38]
		mov	[esp+68h+var_64], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+var_68], eax
		call	gcry_pk_genkey
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_38]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		cmp	[ebp+var_14], 0
		jz	short loc_41499A
		mov	eax, [ebp+var_14]
		mov	[esp+68h+var_68], eax
		call	gpg_strerror
		mov	[esp+68h+var_64], eax ;	char
		mov	[esp+68h+var_68], offset aKeyGenerationF ; "key	generation failed: %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	locret_414C0B
; ---------------------------------------------------------------------------

loc_41499A:				; CODE XREF: sub_414701+25Ej
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+var_64], offset aPrivateKey_1 ; "private-key"
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_4149FC
		mov	[esp+68h+var_68], offset aKeyGeneratio_0 ; "key	generation failed: invalid return v"...
		call	sub_435B7D
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	[esp+68h+var_68], 4Fh
		call	sub_413F97
		jmp	locret_414C0B
; ---------------------------------------------------------------------------

loc_4149FC:				; CODE XREF: sub_414701+2BBj
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+var_64], offset aPublicKey_0 ;	"public-key"
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_414A69
		mov	[esp+68h+var_68], offset aKeyGeneratio_0 ; "key	generation failed: invalid return v"...
		call	sub_435B7D
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	[esp+68h+var_68], 4Fh
		call	sub_413F97
		jmp	locret_414C0B
; ---------------------------------------------------------------------------

loc_414A69:				; CODE XREF: sub_414701+31Dj
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		mov	[ebp+var_3C], 0
		mov	eax, ds:dword_449DA0
		and	eax, 4
		test	eax, eax
		jz	short loc_414A93
		mov	[esp+68h+var_68], offset aStoringPrivate ; "storing private key\n"
		call	sub_435C1A

loc_414A93:				; CODE XREF: sub_414701+384j
		cmp	[ebp+var_C], 0
		jz	short loc_414AA1
		mov	eax, [ebp+var_C]
		add	eax, 24h
		jmp	short loc_414AA6
; ---------------------------------------------------------------------------

loc_414AA1:				; CODE XREF: sub_414701+396j
		mov	eax, 0

loc_414AA6:				; CODE XREF: sub_414701+39Ej
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+var_64], eax ;	char
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_68], eax
		call	sub_413FD4
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		cmp	[ebp+var_14], 0
		jz	short loc_414AFA
		mov	eax, [ebp+var_28]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_14]
		jmp	locret_414C0B
; ---------------------------------------------------------------------------

loc_414AFA:				; CODE XREF: sub_414701+3E4j
		mov	eax, ds:dword_449DA0
		and	eax, 4
		test	eax, eax
		jz	short loc_414B12
		mov	[esp+68h+var_68], offset aReturningPubli ; "returning public key\n"
		call	sub_435C1A

loc_414B12:				; CODE XREF: sub_414701+403j
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+var_64], 1
		mov	eax, [ebp+var_28]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_414B5A
		mov	[esp+68h+var_60], 199h ; int
		mov	[esp+68h+var_64], offset a____Gnupg22__6 ; "../../gnupg2-2.0.30/agent/genkey.c"
		mov	[esp+68h+var_68], offset aLen_2	; "len"
		call	sub_43BB20

loc_414B5A:				; CODE XREF: sub_414701+43Bj
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+var_68], eax
		call	gcry_malloc
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_414B91
		call	sub_413FC7
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_28]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_34]
		jmp	short locret_414C0B
; ---------------------------------------------------------------------------

loc_414B91:				; CODE XREF: sub_414701+46Bj
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+var_5C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+var_60], eax
		mov	[esp+68h+var_64], 1
		mov	eax, [ebp+var_28]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_414BD7
		mov	[esp+68h+var_60], 1A3h ; int
		mov	[esp+68h+var_64], offset a____Gnupg22__6 ; "../../gnupg2-2.0.30/agent/genkey.c"
		mov	[esp+68h+var_68], offset aLen_2	; "len"
		call	sub_43BB20

loc_414BD7:				; CODE XREF: sub_414701+4B8j
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+var_60], eax ;	size_t
		mov	eax, [ebp+var_30]
		mov	[esp+68h+var_64], eax ;	void *
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+var_68], eax ;	int
		call	sub_424524
		mov	eax, [ebp+var_28]
		mov	[esp+68h+var_68], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_30]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, 0

locret_414C0B:				; CODE XREF: sub_414701+57j
					; sub_414701+207j ...
		leave
		retn
sub_414701	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414C0D	proc near		; CODE XREF: sub_407CF1+D4p
					; sub_41202E+2C2p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[esp+48h+var_48], offset aPleaseEnterT_1 ; "Please enter the new passphrase"
		call	sub_435294
		mov	[ebp+var_1C], eax
		mov	[esp+48h+var_48], offset aPleaseReEnte_1 ; "Please re-enter this passphrase"
		call	sub_435294
		mov	[ebp+var_20], eax
		mov	[ebp+var_18], 0
		mov	[esp+48h+var_44], 8Dh
		mov	[esp+48h+var_48], 1
		call	gcry_calloc_secure
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+20h], 65h
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+8], 3
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+10h], 1
		mov	[esp+48h+var_44], 8Dh
		mov	[esp+48h+var_48], 1
		call	gcry_calloc_secure
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+20h], 65h
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], 3
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+14h], offset sub_4146CB
		mov	eax, [ebp+var_C]
		lea	edx, [eax+24h]
		mov	eax, [ebp+var_10]
		mov	[eax+18h], edx

loc_414CAE:				; CODE XREF: sub_414C0D+122j
					; sub_414C0D+18Dj
		mov	[esp+48h+var_30], 0 ; int
		mov	[esp+48h+var_34], 0 ; int
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_38], eax ;	int
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_3C], eax ;	int
		mov	[esp+48h+var_40], 0 ; char *
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40F902
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+var_14], 0
		jnz	loc_414D9F
		mov	eax, [ebp+var_C]
		add	eax, 24h
		mov	[esp+48h+var_40], 0 ; int
		mov	[esp+48h+var_44], eax ;	void *
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_414492
		test	eax, eax
		jz	short loc_414D34
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 0
		jmp	loc_414CAE
; ---------------------------------------------------------------------------

loc_414D34:				; CODE XREF: sub_414C0D+10Cj
		mov	eax, [ebp+var_C]
		add	eax, 24h
		test	eax, eax
		jz	short loc_414D9F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+24h]
		test	al, al
		jz	short loc_414D9F
		mov	[esp+48h+var_30], 0 ; int
		mov	[esp+48h+var_34], 0 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_38], eax ;	int
		mov	[esp+48h+var_3C], 0 ; int
		mov	[esp+48h+var_40], 0 ; char *
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40F902
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0FFFFFFFFh
		jnz	short loc_414D9F
		mov	[esp+48h+var_48], offset aDoesNotMatch_1 ; "does not match - try again"
		call	sub_435294
		mov	[ebp+var_18], eax
		jmp	loc_414CAE
; ---------------------------------------------------------------------------

loc_414D9F:				; CODE XREF: sub_414C0D+E7j
					; sub_414C0D+12Fj ...
		cmp	[ebp+var_14], 0
		jz	short loc_414DC0
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	short locret_414E34
; ---------------------------------------------------------------------------

loc_414DC0:				; CODE XREF: sub_414C0D+196j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax+24h]
		test	al, al
		jnz	short loc_414DEE
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_414DEE:				; CODE XREF: sub_414C0D+1BCj
		cmp	[ebp+var_C], 0
		jz	short loc_414DFC
		mov	eax, [ebp+var_C]
		add	eax, 24h
		jmp	short loc_414E01
; ---------------------------------------------------------------------------

loc_414DFC:				; CODE XREF: sub_414C0D+1E5j
		mov	eax, 0

loc_414E01:				; CODE XREF: sub_414C0D+1EDj
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_413FD4
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_14]

locret_414E34:				; CODE XREF: sub_414C0D+1B1j
		leave
		retn
sub_414C0D	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414E38	proc near		; CODE XREF: sub_414E5F+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_414E58
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_414E5D
; ---------------------------------------------------------------------------

loc_414E58:				; CODE XREF: sub_414E38+7j
		mov	eax, 0

loc_414E5D:				; CODE XREF: sub_414E38+1Ej
		pop	ebp
		retn
sub_414E38	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414E5F	proc near		; CODE XREF: sub_414E7A+Ep
					; sub_414F25+57p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_414E38
		leave
		retn
sub_414E5F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414E7A	proc near		; CODE XREF: sub_414E8F+6p
					; sub_417B49+A1p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_414E5F
		leave
		retn
sub_414E7A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414E8F	proc near		; CODE XREF: sub_41557A+A7p
					; sub_41557A+137p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_414E7A
		leave
		retn
sub_414E8F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414E9C	proc near		; CODE XREF: sub_414F25+64p
					; sub_4153AD+36p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		mov	[ebp+var_8], 0
		jmp	short loc_414ED6
; ---------------------------------------------------------------------------

loc_414EB3:				; CODE XREF: sub_414E9C+60j
		mov	edx, [ebp+var_8]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_8], eax
		add	[ebp+var_4], 1

loc_414ED6:				; CODE XREF: sub_414E9C+15j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_414EFE
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_414EFE
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_414EFE
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_414EB3

loc_414EFE:				; CODE XREF: sub_414E9C+42j
					; sub_414E9C+4Cj ...
		cmp	[ebp+var_8], 0
		jz	short loc_414F0E
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_414F15

loc_414F0E:				; CODE XREF: sub_414E9C+66j
		mov	eax, 0
		jmp	short locret_414F23
; ---------------------------------------------------------------------------

loc_414F15:				; CODE XREF: sub_414E9C+70j
		mov	eax, [ebp+var_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_8]

locret_414F23:				; CODE XREF: sub_414E9C+77j
		leave
		retn
sub_414E9C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414F25	proc near		; CODE XREF: sub_415A18+411p
					; sub_416382+341p ...

var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		jmp	short loc_414FAE
; ---------------------------------------------------------------------------

loc_414F3D:				; CODE XREF: sub_414F25+8Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_414F56
		add	[ebp+var_4], 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_414FAE
; ---------------------------------------------------------------------------

loc_414F56:				; CODE XREF: sub_414F25+20j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_414F6F
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_414FAE
; ---------------------------------------------------------------------------

loc_414F6F:				; CODE XREF: sub_414F25+39j
		cmp	[ebp+var_4], 0
		jnz	short loc_414F83
		mov	[esp+14h+var_14], 53h
		call	sub_414E5F
		jmp	short locret_414FC9
; ---------------------------------------------------------------------------

loc_414F83:				; CODE XREF: sub_414F25+4Ej
		lea	eax, [ebp+var_C]
		mov	[esp+14h+var_14], eax
		call	sub_414E9C
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jnz	short loc_414FA5
		mov	[esp+14h+var_14], 53h
		call	sub_414E5F
		jmp	short locret_414FC9
; ---------------------------------------------------------------------------

loc_414FA5:				; CODE XREF: sub_414F25+70j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_8]
		mov	[ebp+var_C], eax

loc_414FAE:				; CODE XREF: sub_414F25+16j
					; sub_414F25+2Fj ...
		cmp	[ebp+var_4], 0
		jg	short loc_414F3D
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, 0

locret_414FC9:				; CODE XREF: sub_414F25+5Cj
					; sub_414F25+7Ej
		leave
		retn
sub_414F25	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414FCB(int, int, void	*)
sub_414FCB	proc near		; CODE XREF: sub_4153AD+6Ap
					; sub_415A18+C6p ...

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+var_C]
		jnz	short loc_41501B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Size],	edx ; Size
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Buf2],	edx ; Buf2
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_415022

loc_41501B:				; CODE XREF: sub_414FCB+2Fj
		mov	eax, 0
		jmp	short loc_415036
; ---------------------------------------------------------------------------

loc_415022:				; CODE XREF: sub_414FCB+4Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 1

loc_415036:				; CODE XREF: sub_414FCB+55j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_414FCB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41503C	proc near		; CODE XREF: sub_41738E+A2p
					; sub_41738E+1B2p

var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_4], 2
		jbe	short loc_4150B9
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	0
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	3Ah

loc_415067:				; CODE XREF: sub_41503C+7Bj
		sub	[ebp+var_4], 1
		mov	ecx, [ebp+arg_8]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	ecx, [ebp+arg_8]
		mov	[ebp+var_14], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_14]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+arg_8], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_4150B9
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+arg_0]
		ja	short loc_415067

loc_4150B9:				; CODE XREF: sub_41503C+15j
					; sub_41503C+73j
		cmp	[ebp+arg_C], 0
		jz	short loc_4150D9
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_4150D9:				; CODE XREF: sub_41503C+81j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_41503C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4150DE(LPFILETIME)
sub_4150DE	proc near		; CODE XREF: sub_41512E+Dp
					; sub_415212+Cp

hProcess	= dword	ptr -48h
lpCreationTime	= dword	ptr -44h
lpExitTime	= dword	ptr -40h
lpKernelTime	= dword	ptr -3Ch
lpUserTime	= dword	ptr -38h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, [ebp+arg_0]
		add	eax, 18h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		lea	edi, [eax+10h]
		mov	eax, [ebp+arg_0]
		lea	esi, [eax+8]
		mov	ebx, [ebp+arg_0]
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+lpUserTime], edx ; lpUserTime
		mov	[esp+48h+lpKernelTime],	edi ; lpKernelTime
		mov	[esp+48h+lpExitTime], esi ; lpExitTime
		mov	[esp+48h+lpCreationTime], ebx ;	lpCreationTime
		mov	[esp+48h+hProcess], eax	; hProcess
		mov	eax, ds:GetProcessTimes
		call	eax ; GetProcessTimes
		sub	esp, 14h
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4150DE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41512E	proc near		; CODE XREF: sub_415212+76p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= _FILETIME ptr	-38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		lea	eax, [ebp+var_38]
		mov	[esp+48h+var_48], eax ;	LPFILETIME
		call	sub_4150DE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		add	[ebp+var_10], eax
		adc	[ebp+var_C], edx
		mov	eax, [ebp+var_24]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+var_28]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_1C]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+var_20]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		add	[ebp+var_18], eax
		adc	[ebp+var_14], edx
		mov	ecx, [ebp+var_10]
		mov	ebx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		sub	eax, ecx
		sbb	edx, ebx
		mov	[esp+48h+var_40], 2710h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_48], eax
		mov	[esp+48h+var_44], edx
		call	sub_43B640
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_41512E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415212	proc near		; CODE XREF: sub_41528F+15p
					; sub_41528F+CAp

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_3C		= _FILETIME ptr	-3Ch
var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+var_68], eax ;	LPFILETIME
		call	sub_4150DE
		mov	[esp+68h+var_50], 10h
		lea	eax, [ebp+var_1C]
		mov	[esp+68h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_58], eax
		mov	[esp+68h+var_5C], offset aSaltsalt ; "saltsalt"
		mov	[esp+68h+var_60], 3
		mov	[esp+68h+var_64], 2
		mov	[esp+68h+var_68], offset a123456789abcde ; "123456789abcdef0"
		call	sub_4170B7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_415282
		mov	[esp+68h+var_60], offset aCalibrate_s2k_ ; "calibrate_s2k_count_one"
		mov	[esp+68h+var_64], 8Ch
		mov	[esp+68h+var_68], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/agent/protect.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_415282:				; CODE XREF: sub_415212+52j
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+var_68], eax
		call	sub_41512E
		leave
		retn
sub_415212	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41528F	proc near		; CODE XREF: sub_415380+Fp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_24		= word ptr -24h
var_22		= word ptr -22h
var_20		= qword	ptr -20h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	dword ptr [ebp+var_C], 10000h
		jmp	short loc_4152D9
; ---------------------------------------------------------------------------

loc_41529E:				; CODE XREF: sub_41528F+4Ej
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_415212
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_449DA4
		cmp	eax, 1
		jle	short loc_4152D0
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aS2kCalibration ; "S2K	calibration: %lu -> %lums\n"
		call	sub_435B53

loc_4152D0:				; CODE XREF: sub_41528F+25j
		cmp	[ebp+var_10], 64h
		ja	short loc_4152E1
		shl	dword ptr [ebp+var_C], 1

loc_4152D9:				; CODE XREF: sub_41528F+Dj
		cmp	dword ptr [ebp+var_C], 0
		jnz	short loc_41529E
		jmp	short loc_4152E2
; ---------------------------------------------------------------------------

loc_4152E1:				; CODE XREF: sub_41528F+45j
		nop

loc_4152E2:				; CODE XREF: sub_41528F+50j
		mov	eax, dword ptr [ebp+var_C]
		mov	edx, 0
		mov	dword ptr [ebp+var_20],	eax
		mov	dword ptr [ebp+var_20+4], edx
		fild	[ebp+var_20]
		mov	eax, [ebp+var_10]
		mov	edx, 0
		mov	dword ptr [ebp+var_20],	eax
		mov	dword ptr [ebp+var_20+4], edx
		fild	[ebp+var_20]
		fdivp	st(1), st
		fld	ds:dbl_4443A0
		fmulp	st(1), st
		fnstcw	[ebp+var_22]
		movzx	eax, [ebp+var_22]
		mov	ah, 0Ch
		mov	[ebp+var_24], ax
		fldcw	[ebp+var_24]
		fistp	[ebp+var_20]
		fldcw	[ebp+var_22]
		mov	eax, dword ptr [ebp+var_20]
		mov	edx, dword ptr [ebp+var_20+4]
		mov	dword ptr [ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_C]
		shr	eax, 0Ah
		mov	dword ptr [ebp+var_C], eax
		shl	dword ptr [ebp+var_C], 0Ah
		cmp	dword ptr [ebp+var_C], 0FFFFh
		ja	short loc_41534A
		mov	dword ptr [ebp+var_C], 10000h

loc_41534A:				; CODE XREF: sub_41528F+B2j
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_41537B
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_415212
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aS2kCalibrati_0 ; "S2K	calibration: %lu iterations for	%lu"...
		call	sub_435B53

loc_41537B:				; CODE XREF: sub_41528F+C2j
		mov	eax, dword ptr [ebp+var_C]
		leave
		retn
sub_41528F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415380	proc near		; CODE XREF: sub_408650+22Ep
					; sub_41557A:loc_4156BBp ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:dword_4490B0
		test	eax, eax
		jnz	short loc_415399
		call	sub_41528F
		mov	ds:dword_4490B0, eax

loc_415399:				; CODE XREF: sub_415380+Dj
		mov	eax, ds:dword_4490B0
		mov	edx, 10000h
		cmp	eax, 10000h
		cmovb	eax, edx
		leave
		retn
sub_415380	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4153AD	proc near		; CODE XREF: sub_4168AC+656p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4153D4
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_415578
; ---------------------------------------------------------------------------

loc_4153D4:				; CODE XREF: sub_4153AD+14j
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_415402
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_415578
; ---------------------------------------------------------------------------

loc_415402:				; CODE XREF: sub_4153AD+42j
		mov	[esp+28h+var_20], offset aPrivateKey_2 ; "private-key"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_414FCB
		test	eax, eax
		jnz	short loc_415431
		mov	[esp+28h+var_28], 68h
		call	sub_414E5F
		jmp	locret_415578
; ---------------------------------------------------------------------------

loc_415431:				; CODE XREF: sub_4153AD+71j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_41544C
		mov	[esp+28h+var_28], 68h
		call	sub_414E5F
		jmp	locret_415578
; ---------------------------------------------------------------------------

loc_41544C:				; CODE XREF: sub_4153AD+8Cj
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_415480
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_415578
; ---------------------------------------------------------------------------

loc_415480:				; CODE XREF: sub_4153AD+C0j
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		jmp	loc_415514
; ---------------------------------------------------------------------------

loc_41548E:				; CODE XREF: sub_4153AD+16Fj
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4154BC
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_415578
; ---------------------------------------------------------------------------

loc_4154BC:				; CODE XREF: sub_4153AD+FCj
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4154EA
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_415578
; ---------------------------------------------------------------------------

loc_4154EA:				; CODE XREF: sub_4153AD+12Aj
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_41550B
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	short locret_415578
; ---------------------------------------------------------------------------

loc_41550B:				; CODE XREF: sub_4153AD+14Ej
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax

loc_415514:				; CODE XREF: sub_4153AD+DCj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	loc_41548E
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_41553A
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	short locret_415578
; ---------------------------------------------------------------------------

loc_41553A:				; CODE XREF: sub_4153AD+17Dj
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 2
		call	gcry_md_hash_buffer
		mov	eax, 0

locret_415578:				; CODE XREF: sub_4153AD+22j
					; sub_4153AD+50j ...
		leave
		retn
sub_4153AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41557A(void *, size_t, int, int, int,	int)
sub_41557A	proc near		; CODE XREF: sub_415A18+563p

Dst		= dword	ptr -0B8h
Src		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_6C		= dword	ptr -6Ch
var_67		= byte ptr -67h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	[ebp+var_14], offset aOpenpgpS2k3Sha ; "openpgp-s2k3-sha1-aes-cbc"
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	[esp+0B8h+var_AC], 1
		mov	[esp+0B8h+Size], 3
		mov	[esp+0B8h+Src],	7
		lea	eax, [ebp+var_38]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4155E0
		mov	eax, [ebp+var_10]
		jmp	loc_415A0E
; ---------------------------------------------------------------------------

loc_4155E0:				; CODE XREF: sub_41557A+5Cj
		mov	[esp+0B8h+Dst],	7
		call	gcry_cipher_get_algo_blklen
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_4]
		add	eax, 29h
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	edx, eax
		sar	edx, 1Fh
		idiv	[ebp+var_1C]
		imul	eax, [ebp+var_1C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc_secure
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_415629
		call	sub_414E8F
		mov	[ebp+var_10], eax

loc_415629:				; CODE XREF: sub_41557A+A5j
		cmp	[ebp+var_10], 0
		jnz	short loc_41568C
		mov	eax, [ebp+var_1C]
		add	eax, 4
		add	eax, eax
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_415659
		mov	[esp+0B8h+Dst],	8056h
		call	sub_414E5F
		mov	[ebp+var_10], eax
		jmp	short loc_41568C
; ---------------------------------------------------------------------------

loc_415659:				; CODE XREF: sub_41557A+CCj
		mov	eax, [ebp+var_1C]
		add	eax, 4
		add	eax, eax
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_create_nonce
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_38]
		mov	[esp+0B8h+Size], edx
		mov	edx, [ebp+var_C]
		mov	[esp+0B8h+Src],	edx
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_setiv
		mov	[ebp+var_10], eax

loc_41568C:				; CODE XREF: sub_41557A+B3j
					; sub_41557A+DDj
		cmp	[ebp+var_10], 0
		jnz	loc_415729
		mov	[ebp+var_28], 10h
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc_secure
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_4156BB
		call	sub_414E8F
		mov	[ebp+var_10], eax
		jmp	short loc_415729
; ---------------------------------------------------------------------------

loc_4156BB:				; CODE XREF: sub_41557A+135j
		call	sub_415380
		mov	edx, [ebp+var_1C]
		add	edx, edx
		add	edx, [ebp+var_C]
		mov	ecx, [ebp+var_28]
		mov	[esp+0B8h+var_A0], ecx
		mov	ecx, [ebp+var_2C]
		mov	[esp+0B8h+var_A4], ecx
		mov	[esp+0B8h+var_A8], eax
		mov	[esp+0B8h+var_AC], edx
		mov	[esp+0B8h+Size], 3
		mov	[esp+0B8h+Src],	2
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+Dst],	eax
		call	sub_4170B7
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41571E
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_28]
		mov	[esp+0B8h+Size], edx
		mov	edx, [ebp+var_2C]
		mov	[esp+0B8h+Src],	edx
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_setkey
		mov	[ebp+var_10], eax

loc_41571E:				; CODE XREF: sub_41557A+186j
		mov	eax, [ebp+var_2C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free

loc_415729:				; CODE XREF: sub_41557A+116j
					; sub_41557A+13Fj
		cmp	[ebp+var_10], 0
		jnz	loc_41584C
		mov	eax, [ebp+var_18]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	28h
		add	[ebp+var_30], 1
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	28h
		add	[ebp+var_30], 1
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_30]
		mov	ecx, [ebp+arg_4]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		add	[ebp+var_30], eax
		mov	edx, offset a4Hash4Sha120 ; ")(4:hash4:sha120:"
		mov	eax, [ebp+var_30]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		movzx	edx, byte ptr [edx+10h]
		mov	[eax+10h], dl
		add	[ebp+var_30], 11h
		mov	edx, [ebp+arg_C]
		mov	eax, [ebp+var_30]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [edx+10h]
		mov	[eax+10h], edx
		add	[ebp+var_30], 14h
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	29h
		add	[ebp+var_30], 1
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	29h
		add	[ebp+var_30], 1
		mov	ecx, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_1C]
		add	edx, eax
		mov	eax, [ebp+var_30]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_1C]
		add	[ebp+var_30], eax
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_18]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_20]
		jz	short loc_415820
		mov	[esp+0B8h+Size], 15Fh ;	int
		mov	[esp+0B8h+Src],	offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+0B8h+Dst],	offset aPOutbufOutlen ;	"p - outbuf == outlen"
		call	sub_43BB20

loc_415820:				; CODE XREF: sub_41557A+288j
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_38]
		mov	[esp+0B8h+var_A8], 0
		mov	[esp+0B8h+var_AC], 0
		mov	[esp+0B8h+Size], edx
		mov	edx, [ebp+var_18]
		mov	[esp+0B8h+Src],	edx
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_encrypt
		mov	[ebp+var_10], eax

loc_41584C:				; CODE XREF: sub_41557A+1B3j
		mov	eax, [ebp+var_38]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_close
		cmp	[ebp+var_10], 0
		jz	short loc_41587B
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		jmp	loc_415A0E
; ---------------------------------------------------------------------------

loc_41587B:				; CODE XREF: sub_41557A+2E1j
		call	sub_415380
		mov	[esp+0B8h+var_AC], eax
		mov	[esp+0B8h+Size], offset	aLu_0 ;	"%lu"
		mov	[esp+0B8h+Src],	23h
		lea	eax, [ebp+var_67]
		mov	[esp+0B8h+Dst],	eax
		call	sub_4241F9
		lea	eax, [ebp+var_67]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+0B8h+var_84], offset dword_444258
		mov	edx, [ebp+var_24]
		mov	[esp+0B8h+var_88], edx
		lea	edx, [ebp+var_44]
		mov	[esp+0B8h+var_8C], edx
		mov	edx, [ebp+var_24]
		mov	[esp+0B8h+var_90], edx
		mov	[esp+0B8h+var_94], offset dword_444258
		mov	edx, [ebp+var_1C]
		mov	[esp+0B8h+var_98], edx
		lea	edx, [ebp+var_40]
		mov	[esp+0B8h+var_9C], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+0B8h+var_A0], edx
		lea	edx, [ebp+var_67]
		mov	[esp+0B8h+var_A4], edx
		mov	[esp+0B8h+var_A8], ebx
		lea	edx, [ebp+var_3C]
		mov	[esp+0B8h+var_AC], edx
		mov	edx, [ebp+var_14]
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Src],	eax
		mov	[esp+0B8h+Dst],	offset a9ProtectedDS4S ; "(9:protected%d:%s((4:sha18:%n_8bytes_%u"...
		call	sub_4256F5
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_41596F
		call	sub_414E8F
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_34]
		jmp	loc_415A0E
; ---------------------------------------------------------------------------

loc_41596F:				; CODE XREF: sub_41557A+3CDj
		mov	eax, [ebp+var_30]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_30]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_1C]
		add	eax, eax
		add	edx, eax
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+var_3C]
		add	eax, ecx
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	edx, [edx+4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	ebx, [ebp+var_30]
		mov	eax, [ebp+var_40]
		add	eax, ebx
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	ecx, [ebp+var_24]
		mov	edx, [ebp+var_18]
		mov	ebx, [ebp+var_30]
		mov	eax, [ebp+var_44]
		add	eax, ebx
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, 0

loc_415A0E:				; CODE XREF: sub_41557A+61j
					; sub_41557A+2FCj ...
		add	esp, 0B0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41557A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415A18	proc near		; CODE XREF: sub_40D0BE+8Dp
					; sub_413FD4+108p

Buf1		= dword	ptr -0B8h
Buf2		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
Src		= dword	ptr -84h
var_7F		= byte ptr -7Fh
var_5D		= byte ptr -5Dh
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
Dst		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0B4h
		mov	[ebp+var_8C], 0
		mov	edx, offset a12ProtectedAt1 ; "(12:protected-at15:"
		lea	eax, [ebp+var_7F]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		movzx	ecx, word ptr [edx+10h]
		mov	[eax+10h], cx
		movzx	edx, byte ptr [edx+12h]
		mov	[eax+12h], dl
		lea	eax, [ebp+var_7F]
		add	eax, 13h
		mov	[esp+0B8h+Buf1], eax
		call	sub_420520
		mov	[ebp+var_5D], 29h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_415A8C
		mov	[esp+0B8h+Buf1], 53h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415A8C:				; CODE XREF: sub_415A18+61j
		mov	eax, [ebp+var_8C]
		add	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_415AC9
		mov	[esp+0B8h+Buf1], 53h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415AC9:				; CODE XREF: sub_415A18+9Ej
		mov	[esp+0B8h+Size], offset	aPrivateKey_2 ;	"private-key"
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Buf2], eax ; int
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax ; int
		call	sub_414FCB
		test	eax, eax
		jnz	short loc_415AF8
		mov	[esp+0B8h+Buf1], 68h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415AF8:				; CODE XREF: sub_415A18+CDj
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_415B13
		mov	[esp+0B8h+Buf1], 68h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415B13:				; CODE XREF: sub_415A18+E8j
		mov	eax, [ebp+var_8C]
		add	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_415B56
		mov	[esp+0B8h+Buf1], 53h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415B56:				; CODE XREF: sub_415A18+12Bj
		mov	[ebp+var_20], 0
		jmp	short loc_415B63
; ---------------------------------------------------------------------------

loc_415B5F:				; CODE XREF: sub_415A18+18Fj
		add	[ebp+var_20], 1

loc_415B63:				; CODE XREF: sub_415A18+145j
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D760
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_415BA9
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D760
		mov	eax, [eax]
		mov	[esp+0B8h+Size], eax ; void *
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Buf2], eax ; int
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax ; int
		call	sub_414FCB
		test	eax, eax
		jz	short loc_415B5F

loc_415BA9:				; CODE XREF: sub_415A18+161j
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D760
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_415BD2
		mov	[esp+0B8h+Buf1], 54h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415BD2:				; CODE XREF: sub_415A18+1A7j
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D760
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D760
		mov	eax, [eax+8]
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D760
		mov	eax, [eax+0Ch]
		mov	[ebp+var_14], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_18], eax
		mov	[ebp+var_24], 0
		jmp	loc_415D94
; ---------------------------------------------------------------------------

loc_415C33:				; CODE XREF: sub_415A18+38Fj
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_10]
		jnz	short loc_415C41
		mov	eax, [ebp+var_48]
		mov	[ebp+var_18], eax

loc_415C41:				; CODE XREF: sub_415A18+221j
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_415C5C
		mov	[esp+0B8h+Buf1], 53h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415C5C:				; CODE XREF: sub_415A18+231j
		mov	eax, [ebp+var_8C]
		add	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_415C99
		mov	[esp+0B8h+Buf1], 53h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415C99:				; CODE XREF: sub_415A18+26Ej
		cmp	[ebp+var_28], 1
		jnz	short loc_415CAD
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+var_30]
		jz	short loc_415D18

loc_415CAD:				; CODE XREF: sub_415A18+285j
		cmp	[ebp+var_28], 5
		jnz	short loc_415D07
		mov	eax, [ebp+var_48]
		mov	[esp+0B8h+Size], 5 ; Size
		mov	[esp+0B8h+Buf2], offset	aCurve_0 ; "curve"
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_415D07
		cmp	[ebp+var_24], 0
		jnz	short loc_415D07
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_43D770
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_415D07
		mov	[ebp+var_C], offset a?qd ; "?qd"
		mov	[ebp+var_10], 2
		mov	[ebp+var_14], 2
		jmp	short loc_415D18
; ---------------------------------------------------------------------------

loc_415D07:				; CODE XREF: sub_415A18+299j
					; sub_415A18+2B8j ...
		mov	[esp+0B8h+Buf1], 53h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415D18:				; CODE XREF: sub_415A18+293j
					; sub_415A18+2EDj
		mov	eax, [ebp+var_48]
		add	eax, [ebp+var_28]
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_415D46
		mov	[esp+0B8h+Buf1], 53h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415D46:				; CODE XREF: sub_415A18+31Bj
		mov	eax, [ebp+var_48]
		add	eax, [ebp+var_28]
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_415D6A
		mov	[esp+0B8h+Buf1], 53h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415D6A:				; CODE XREF: sub_415A18+33Fj
		mov	eax, [ebp+var_8C]
		sub	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		jnz	short loc_415D87
		mov	eax, [ebp+var_48]
		mov	[ebp+var_1C], eax

loc_415D87:				; CODE XREF: sub_415A18+367j
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		add	[ebp+var_24], 1

loc_415D94:				; CODE XREF: sub_415A18+216j
		mov	eax, [ebp+var_24]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	loc_415C33
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_415DC3
		cmp	[ebp+var_18], 0
		jz	short loc_415DC3
		cmp	[ebp+var_1C], 0
		jnz	short loc_415DD4

loc_415DC3:				; CODE XREF: sub_415A18+39Dj
					; sub_415A18+3A3j
		mov	[esp+0B8h+Buf1], 53h
		call	sub_414E5F
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415DD4:				; CODE XREF: sub_415A18+3A9j
		mov	eax, [ebp+var_8C]
		sub	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_8C]
		cmp	eax, 1
		jz	short loc_415E19
		mov	[esp+0B8h+Size], 1F6h ;	int
		mov	[esp+0B8h+Buf2], offset	a____Gnupg22__7	; "../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+0B8h+Buf1], offset	aDepth1	; "depth == 1"
		call	sub_43BB20

loc_415E19:				; CODE XREF: sub_415A18+3E3j
		lea	eax, [ebp+var_8C]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_414F25
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_415E3F
		mov	eax, [ebp+var_38]
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415E3F:				; CODE XREF: sub_415A18+41Dj
		mov	eax, [ebp+var_8C]
		test	eax, eax
		jz	short loc_415E65
		mov	[esp+0B8h+Size], 1FAh ;	int
		mov	[esp+0B8h+Buf2], offset	a____Gnupg22__7	; "../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+0B8h+Buf1], offset	aDepth ; "!depth"
		call	sub_43BB20

loc_415E65:				; CODE XREF: sub_415A18+42Fj
		mov	eax, [ebp+var_48]
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	[esp+0B8h+Size], 0
		mov	[esp+0B8h+Buf2], 2
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_415E9D
		mov	eax, [ebp+var_38]
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415E9D:				; CODE XREF: sub_415A18+47Bj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Size], edx
		mov	edx, [ebp+var_2C]
		mov	[esp+0B8h+Buf2], edx
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_write
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Size], 23h
		lea	edx, [ebp+var_7F]
		mov	[esp+0B8h+Buf2], edx
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_write
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Size], 1
		mov	[esp+0B8h+Buf2], offset	asc_4442CA ; ")"
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_write
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Buf2], 2
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_read
		mov	edx, [eax]
		mov	[ebp+var_5C], edx
		mov	edx, [eax+4]
		mov	[ebp+var_58], edx
		mov	edx, [eax+8]
		mov	[ebp+var_54], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_50], edx
		mov	eax, [eax+10h]
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_close
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		add	eax, 1
		lea	edx, [ebp+var_88]
		mov	[esp+0B8h+var_A4], edx ; int
		lea	edx, [ebp+Src]
		mov	[esp+0B8h+var_A8], edx ; int
		lea	edx, [ebp+var_5C]
		mov	[esp+0B8h+var_AC], edx ; int
		mov	edx, [ebp+arg_4]
		mov	[esp+0B8h+Size], edx ; int
		mov	[esp+0B8h+Buf2], eax ; size_t
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Buf1], eax ; void *
		call	sub_41557A
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_415F91
		mov	eax, [ebp+var_38]
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415F91:				; CODE XREF: sub_415A18+56Fj
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_88]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_1C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		add	eax, ecx
		lea	edx, [eax+2Dh]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_malloc
		mov	[ebp+Dst], eax
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+Dst]
		mov	[eax], edx
		cmp	[ebp+Dst], 0
		jnz	short loc_415FFA
		call	sub_414E8F
		mov	[ebp+var_44], eax
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_44]
		jmp	loc_416149
; ---------------------------------------------------------------------------

loc_415FFA:				; CODE XREF: sub_415A18+5C2j
		mov	edx, offset a21Protected ; "(21:protected-"
		mov	eax, [ebp+Dst]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	[ebp+Dst], 0Eh
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		sub	eax, 4
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+4]
		mov	eax, [ebp+Dst]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Buf2], edx ; Src
		mov	[esp+0B8h+Buf1], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		sub	eax, 4
		add	[ebp+Dst], eax
		mov	ecx, [ebp+var_88]
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Buf2], edx ; Src
		mov	[esp+0B8h+Buf1], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_88]
		add	[ebp+Dst], eax
		mov	eax, [ebp+Dst]
		lea	edx, [ebp+var_7F]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		movzx	ecx, word ptr [edx+20h]
		mov	[eax+20h], cx
		movzx	edx, byte ptr [edx+22h]
		mov	[eax+22h], dl
		add	[ebp+Dst], 23h
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+1]
		mov	eax, [ebp+Dst]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Buf2], edx ; Src
		mov	[esp+0B8h+Buf1], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_1C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		add	[ebp+Dst], eax
		mov	edx, [ebp+Dst]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		cmp	edx, eax
		jz	short loc_416136
		mov	[esp+0B8h+Size], 22Bh ;	int
		mov	[esp+0B8h+Buf2], offset	a____Gnupg22__7	; "../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+0B8h+Buf1], offset	aPResultResultl	; "p - *result == *resultlen"
		call	sub_43BB20

loc_416136:				; CODE XREF: sub_415A18+700j
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		mov	eax, 0

loc_416149:				; CODE XREF: sub_415A18+6Fj
					; sub_415A18+ACj ...
		add	esp, 0B4h
		pop	ebx
		pop	ebp
		retn
sub_415A18	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416152	proc near		; CODE XREF: sub_4168AC+5B0p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_C], 0
		mov	[esp+48h+var_48], 7
		call	gcry_cipher_get_algo_blklen
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 3
		jbe	short loc_416187
		mov	ecx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		test	eax, eax
		jz	short loc_416198

loc_416187:				; CODE XREF: sub_416152+20j
		mov	[esp+48h+var_48], 6Ah
		call	sub_414E5F
		jmp	locret_416380
; ---------------------------------------------------------------------------

loc_416198:				; CODE XREF: sub_416152+33j
		mov	[esp+48h+var_3C], 1
		mov	[esp+48h+var_40], 3
		mov	[esp+48h+var_44], 7
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_open
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4161CC
		mov	eax, [ebp+var_C]
		jmp	locret_416380
; ---------------------------------------------------------------------------

loc_4161CC:				; CODE XREF: sub_416152+70j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc_secure
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4161E8
		call	sub_414E8F
		mov	[ebp+var_C], eax

loc_4161E8:				; CODE XREF: sub_416152+8Cj
		cmp	[ebp+var_C], 0
		jnz	short loc_41620A
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+arg_18]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+arg_14]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_setiv
		mov	[ebp+var_C], eax

loc_41620A:				; CODE XREF: sub_416152+9Aj
		cmp	[ebp+var_C], 0
		jnz	loc_4162A0
		mov	[ebp+var_18], 10h
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc_secure
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_416239
		call	sub_414E8F
		mov	[ebp+var_C], eax
		jmp	short loc_4162A0
; ---------------------------------------------------------------------------

loc_416239:				; CODE XREF: sub_416152+DBj
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], 3
		mov	[esp+48h+var_44], 2
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		call	sub_4170B7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_416295
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_setkey
		mov	[ebp+var_C], eax

loc_416295:				; CODE XREF: sub_416152+125j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_4162A0:				; CODE XREF: sub_416152+BCj
					; sub_416152+E5j
		cmp	[ebp+var_C], 0
		jnz	short loc_4162D0
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_decrypt
		mov	[ebp+var_C], eax

loc_4162D0:				; CODE XREF: sub_416152+152j
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_close
		cmp	[ebp+var_C], 0
		jz	short loc_4162F4
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	locret_416380
; ---------------------------------------------------------------------------

loc_4162F4:				; CODE XREF: sub_416152+18Dj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_416324
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_416324
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], 0Bh
		call	sub_414E5F
		jmp	short locret_416380
; ---------------------------------------------------------------------------

loc_416324:				; CODE XREF: sub_416152+1AAj
					; sub_416152+1B7j
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41635A
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_20]
		cmp	eax, [ebp+arg_4]
		jnb	short loc_416373

loc_41635A:				; CODE XREF: sub_416152+1FBj
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], 0Bh
		call	sub_414E5F
		jmp	short locret_416380
; ---------------------------------------------------------------------------

loc_416373:				; CODE XREF: sub_416152+206j
		mov	eax, [ebp+arg_1C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0

locret_416380:				; CODE XREF: sub_416152+41j
					; sub_416152+75j ...
		leave
		retn
sub_416152	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416382	proc near		; CODE XREF: sub_4168AC+606p

Dst		= dword	ptr -58h
Src		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 19h
		ja	short loc_4163C3
		mov	[esp+58h+Dst], 3Bh
		call	sub_414E5F
		jmp	locret_4168AA
; ---------------------------------------------------------------------------

loc_4163C3:				; CODE XREF: sub_416382+2Ej
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_416400
		mov	[esp+58h+Dst], 3Bh
		call	sub_414E5F
		jmp	locret_4168AA
; ---------------------------------------------------------------------------

loc_416400:				; CODE XREF: sub_416382+6Bj
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_41643D
		mov	[esp+58h+Dst], 3Bh
		call	sub_414E5F
		jmp	locret_4168AA
; ---------------------------------------------------------------------------

loc_41643D:				; CODE XREF: sub_416382+A8j
		mov	eax, [ebp+var_24]
		add	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dst], eax
		call	gcry_malloc_secure
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416461
		call	sub_414E8F
		jmp	locret_4168AA
; ---------------------------------------------------------------------------

loc_416461:				; CODE XREF: sub_416382+D3j
		mov	edx, offset a11PrivateKey ; "(11:private-key"
		mov	eax, [ebp+var_28]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_28]
		add	eax, 0Fh
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_4]
		lea	ecx, [eax-19h]
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+19h]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		sub	eax, 19h
		add	[ebp+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4164DE
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4164DE
		mov	[esp+58h+Dst], 3Bh
		call	sub_414E5F
		jmp	locret_4168AA
; ---------------------------------------------------------------------------

loc_4164DE:				; CODE XREF: sub_416382+13Cj
					; sub_416382+149j
		mov	eax, [ebp+var_3C]
		add	eax, 2
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_30], eax
		jmp	short loc_416551
; ---------------------------------------------------------------------------

loc_4164EF:				; CODE XREF: sub_416382+1D7j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	loc_416858
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_24]
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	loc_41685B
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_24]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	loc_41685E
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax

loc_416551:				; CODE XREF: sub_416382+16Bj
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4164EF
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	loc_416861
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	loc_416864
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_24], eax
		mov	[esp+58h+Size],	offset aHash_0 ; "hash"
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Src], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax ; int
		call	sub_414FCB
		test	eax, eax
		jz	loc_416867
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_24], eax
		mov	[esp+58h+Size],	offset aSha1 ; "sha1"
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Src], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax ; int
		call	sub_414FCB
		test	eax, eax
		jz	loc_41686A
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 14h
		jnz	loc_41686D
		mov	eax, [ebp+var_3C]
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [edx+10h]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_24]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	loc_416870
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4166A6
		mov	[esp+58h+Size],	2DCh ; int
		mov	[esp+58h+Src], offset a____Gnupg22__7 ;	"../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+58h+Dst], offset aS_0 ; "*s == '('"
		call	sub_43BB20

loc_4166A6:				; CODE XREF: sub_416382+306j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		mov	[ebp+var_40], 1
		lea	eax, [ebp+var_40]
		mov	[esp+58h+Src], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_414F25
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41681F
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_41675B
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_24], eax
		mov	[esp+58h+Size],	offset aProtectedAt ; "protected-at"
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Src], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax ; int
		call	sub_414FCB
		test	eax, eax
		jz	short loc_416755
		mov	[ebp+var_40], 1
		lea	eax, [ebp+var_40]
		mov	[esp+58h+Src], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_414F25
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_416822
		mov	eax, [ebp+var_3C]
		mov	edx, eax
		mov	eax, [ebp+var_38]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_416755:				; CODE XREF: sub_416382+396j
		mov	eax, [ebp+var_38]
		mov	[ebp+var_3C], eax

loc_41675B:				; CODE XREF: sub_416382+35Bj
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	[ebp+var_40], 2
		lea	eax, [ebp+var_40]
		mov	[esp+58h+Src], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_414F25
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_416825
		mov	eax, [ebp+var_3C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_4167B0
		mov	[esp+58h+Size],	2F7h ; int
		mov	[esp+58h+Src], offset a____Gnupg22__7 ;	"../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+58h+Dst], offset aS1 ; "s[-1] == ')'"
		call	sub_43BB20

loc_4167B0:				; CODE XREF: sub_416382+410j
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4167D2
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_18]
		mov	[eax], edx

loc_4167D2:				; CODE XREF: sub_416382+43Bj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_2C], eax
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_28]
		mov	[eax], edx
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_4168AA
; ---------------------------------------------------------------------------

loc_41681F:				; CODE XREF: sub_416382+34Dj
		nop
		jmp	short loc_416826
; ---------------------------------------------------------------------------

loc_416822:				; CODE XREF: sub_416382+3B8j
		nop
		jmp	short loc_416826
; ---------------------------------------------------------------------------

loc_416825:				; CODE XREF: sub_416382+3FFj
		nop

loc_416826:				; CODE XREF: sub_416382+49Ej
					; sub_416382+4A1j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		jmp	short loc_416842
; ---------------------------------------------------------------------------

loc_416834:				; CODE XREF: sub_416382+4C4j
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		sub	[ebp+var_14], 1

loc_416842:				; CODE XREF: sub_416382+4B0j
		cmp	[ebp+var_14], 0
		jnz	short loc_416834
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short locret_4168AA
; ---------------------------------------------------------------------------

loc_416858:				; CODE XREF: sub_416382+188j
		nop
		jmp	short loc_416871
; ---------------------------------------------------------------------------

loc_41685B:				; CODE XREF: sub_416382+1A9j
		nop
		jmp	short loc_416871
; ---------------------------------------------------------------------------

loc_41685E:				; CODE XREF: sub_416382+1C0j
		nop
		jmp	short loc_416871
; ---------------------------------------------------------------------------

loc_416861:				; CODE XREF: sub_416382+1E1j
		nop
		jmp	short loc_416871
; ---------------------------------------------------------------------------

loc_416864:				; CODE XREF: sub_416382+1FEj
		nop
		jmp	short loc_416871
; ---------------------------------------------------------------------------

loc_416867:				; CODE XREF: sub_416382+237j
		nop
		jmp	short loc_416871
; ---------------------------------------------------------------------------

loc_41686A:				; CODE XREF: sub_416382+267j
		nop
		jmp	short loc_416871
; ---------------------------------------------------------------------------

loc_41686D:				; CODE XREF: sub_416382+27Fj
		nop
		jmp	short loc_416871
; ---------------------------------------------------------------------------

loc_416870:				; CODE XREF: sub_416382+2BAj
		nop

loc_416871:				; CODE XREF: sub_416382+4D7j
					; sub_416382+4DAj ...
		mov	eax, [ebp+var_28]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_1C], eax
		jmp	short loc_41688D
; ---------------------------------------------------------------------------

loc_41687F:				; CODE XREF: sub_416382+50Fj
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		add	[ebp+var_18], 1
		sub	[ebp+var_1C], 1

loc_41688D:				; CODE XREF: sub_416382+4FBj
		cmp	[ebp+var_1C], 0
		jnz	short loc_41687F
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		mov	[esp+58h+Dst], 53h
		call	sub_414E5F

locret_4168AA:				; CODE XREF: sub_416382+3Cj
					; sub_416382+79j ...
		leave
		retn
sub_416382	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4168AC	proc near		; CODE XREF: sub_411B5F+72p
					; sub_41202E+74p

Str		= dword	ptr -0A8h
EndPtr		= dword	ptr -0A4h
Radix		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
Buf2		= byte ptr -68h
Buf1		= byte ptr -54h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	[ebp+var_6C], 0
		cmp	[ebp+arg_8], 0
		jz	short loc_4168C9
		mov	eax, [ebp+arg_8]
		mov	byte ptr [eax],	0

loc_4168C9:				; CODE XREF: sub_4168AC+15j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4168EA
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_4168EA:				; CODE XREF: sub_4168AC+2Bj
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416918
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416918:				; CODE XREF: sub_4168AC+59j
		mov	[esp+0A8h+Radix], offset aProtectedPri_1 ; "protected-private-key"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_414FCB
		test	eax, eax
		jnz	short loc_416947
		mov	[esp+0A8h+Str],	68h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416947:				; CODE XREF: sub_4168AC+88j
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_416962
		mov	[esp+0A8h+Str],	68h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416962:				; CODE XREF: sub_4168AC+A3j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416990
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416990:				; CODE XREF: sub_4168AC+D1j
		mov	[ebp+var_10], 0
		jmp	short loc_41699D
; ---------------------------------------------------------------------------

loc_416999:				; CODE XREF: sub_4168AC+135j
		add	[ebp+var_10], 1

loc_41699D:				; CODE XREF: sub_4168AC+EBj
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D760
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4169E3
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D760
		mov	eax, [eax]
		mov	[esp+0A8h+Radix], eax ;	void *
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_414FCB
		test	eax, eax
		jz	short loc_416999

loc_4169E3:				; CODE XREF: sub_4168AC+107j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_43D760
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_416A0C
		mov	[esp+0A8h+Str],	54h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416A0C:				; CODE XREF: sub_4168AC+14Dj
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_2C], eax
		cmp	[ebp+arg_8], 0
		jz	loc_416B22
		jmp	loc_416B14
; ---------------------------------------------------------------------------

loc_416A21:				; CODE XREF: sub_4168AC+270j
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416A55
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416A55:				; CODE XREF: sub_4168AC+196j
		mov	[esp+0A8h+Radix], offset aProtectedAt ;	"protected-at"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_414FCB
		test	eax, eax
		jz	short loc_416AE1
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416A98
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416A98:				; CODE XREF: sub_4168AC+1D9j
		cmp	[ebp+var_28], 0Fh
		jz	short loc_416AAF
		mov	[esp+0A8h+Str],	68h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416AAF:				; CODE XREF: sub_4168AC+1F0j
		mov	eax, [ebp+var_3C]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	ecx, word ptr [edx+0Ch]
		mov	[eax+0Ch], cx
		movzx	edx, byte ptr [edx+0Eh]
		mov	[eax+0Eh], dl
		mov	eax, [ebp+arg_8]
		add	eax, 0Fh
		mov	byte ptr [eax],	0
		jmp	short loc_416B22
; ---------------------------------------------------------------------------

loc_416AE1:				; CODE XREF: sub_4168AC+1C5j
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	[ebp+var_40], 1
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+EndPtr], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414F25
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_416B14
		mov	eax, [ebp+var_C]
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416B14:				; CODE XREF: sub_4168AC+170j
					; sub_4168AC+25Ej
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	loc_416A21

loc_416B22:				; CODE XREF: sub_4168AC+16Aj
					; sub_4168AC+233j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_3C], eax
		jmp	short loc_416B2B
; ---------------------------------------------------------------------------

loc_416B2A:				; CODE XREF: sub_4168AC+315j
		nop

loc_416B2B:				; CODE XREF: sub_4168AC+27Cj
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_416B46
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416B46:				; CODE XREF: sub_4168AC+287j
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416B7A
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416B7A:				; CODE XREF: sub_4168AC+2BBj
		mov	[esp+0A8h+Radix], offset aProtected ; "protected"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_414FCB
		test	eax, eax
		jnz	short loc_416BCF
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	[ebp+var_40], 1
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+EndPtr], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414F25
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_416B2A
		mov	eax, [ebp+var_C]
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416BCF:				; CODE XREF: sub_4168AC+2EAj
		nop
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416BF5
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416BF5:				; CODE XREF: sub_4168AC+336j
		mov	[esp+0A8h+Radix], offset aOpenpgpS2k3Sha ; "openpgp-s2k3-sha1-aes-cbc"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_414FCB
		test	eax, eax
		jnz	short loc_416C24
		mov	[esp+0A8h+Str],	69h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416C24:				; CODE XREF: sub_4168AC+365j
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_416C3B
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_416C4C

loc_416C3B:				; CODE XREF: sub_4168AC+380j
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416C4C:				; CODE XREF: sub_4168AC+38Dj
		mov	eax, [ebp+var_3C]
		add	eax, 2
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416C7A
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416C7A:				; CODE XREF: sub_4168AC+3BBj
		mov	[esp+0A8h+Radix], offset aSha1 ; "sha1"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_414FCB
		test	eax, eax
		jnz	short loc_416CA9
		mov	[esp+0A8h+Str],	69h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416CA9:				; CODE XREF: sub_4168AC+3EAj
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 8
		jz	short loc_416CCE
		mov	[esp+0A8h+Str],	6Ah
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416CCE:				; CODE XREF: sub_4168AC+40Fj
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416D02
		mov	[esp+0A8h+Str],	6Ah
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416D02:				; CODE XREF: sub_4168AC+443j
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_416D20
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416D20:				; CODE XREF: sub_4168AC+461j
		mov	eax, [ebp+var_3C]
		mov	[esp+0A8h+Radix], 0Ah ;	Radix
		mov	[esp+0A8h+EndPtr], 0 ; EndPtr
		mov	[esp+0A8h+Str],	eax ; Str
		call	strtoul
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_416D55
		mov	[esp+0A8h+Str],	6Ah
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416D55:				; CODE XREF: sub_4168AC+496j
		cmp	[ebp+var_14], 0FFh
		ja	short loc_416D7B
		mov	eax, [ebp+var_14]
		and	eax, 0Fh
		lea	edx, [eax+10h]
		mov	eax, [ebp+var_14]
		shr	eax, 4
		add	eax, 6
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	[ebp+var_14], eax

loc_416D7B:				; CODE XREF: sub_4168AC+4B0j
		cmp	[ebp+var_14], 0FFFFh
		ja	short loc_416D95
		mov	[esp+0A8h+Str],	6Ah
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416D95:				; CODE XREF: sub_4168AC+4D6j
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 10h
		jz	short loc_416DCC
		mov	[esp+0A8h+Str],	6Ah
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416DCC:				; CODE XREF: sub_4168AC+50Dj
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_416DF6
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416DF6:				; CODE XREF: sub_4168AC+537j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_414E9C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416E24
		mov	[esp+0A8h+Str],	53h
		call	sub_414E5F
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416E24:				; CODE XREF: sub_4168AC+565j
		mov	eax, [ebp+var_3C]
		lea	edx, [ebp+var_6C]
		mov	[esp+0A8h+var_8C], edx
		mov	[esp+0A8h+var_90], 10h
		mov	edx, [ebp+var_38]
		mov	[esp+0A8h+var_94], edx
		mov	edx, [ebp+var_14]
		mov	[esp+0A8h+var_98], edx
		mov	edx, [ebp+var_34]
		mov	[esp+0A8h+var_9C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+0A8h+Radix], edx
		mov	edx, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], edx
		mov	[esp+0A8h+Str],	eax
		call	sub_416152
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_416E72
		mov	eax, [ebp+var_C]
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416E72:				; CODE XREF: sub_4168AC+5BCj
		mov	edx, [ebp+var_6C]
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+arg_0]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		lea	ecx, [ebp+var_7C]
		mov	[esp+0A8h+var_8C], ecx
		lea	ecx, [ebp+var_78]
		mov	[esp+0A8h+var_90], ecx
		lea	ecx, [ebp+var_74]
		mov	[esp+0A8h+var_94], ecx
		lea	ecx, [ebp+var_70]
		mov	[esp+0A8h+var_98], ecx
		lea	ecx, [ebp+Buf1]
		mov	[esp+0A8h+var_9C], ecx
		mov	[esp+0A8h+Radix], edx
		mov	[esp+0A8h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Str],	eax
		call	sub_416382
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_1C], eax
		jmp	short loc_416ED6
; ---------------------------------------------------------------------------

loc_416EC8:				; CODE XREF: sub_4168AC+62Ej
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		add	[ebp+var_18], 1
		sub	[ebp+var_1C], 1

loc_416ED6:				; CODE XREF: sub_4168AC+61Aj
		cmp	[ebp+var_1C], 0
		jnz	short loc_416EC8
		mov	eax, [ebp+var_6C]
		mov	[esp+0A8h+Str],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_416EF5
		mov	eax, [ebp+var_C]
		jmp	loc_416FF4
; ---------------------------------------------------------------------------

loc_416EF5:				; CODE XREF: sub_4168AC+63Fj
		mov	eax, [ebp+var_70]
		lea	edx, [ebp+Buf2]
		mov	[esp+0A8h+EndPtr], edx
		mov	[esp+0A8h+Str],	eax
		call	sub_4153AD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_416F3D
		mov	[esp+0A8h+Radix], 14h ;	Size
		lea	eax, [ebp+Buf2]
		mov	[esp+0A8h+EndPtr], eax ; Buf2
		lea	eax, [ebp+Buf1]
		mov	[esp+0A8h+Str],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_416F3D
		mov	[esp+0A8h+Str],	6Ah
		call	sub_414E5F
		mov	[ebp+var_C], eax

loc_416F3D:				; CODE XREF: sub_4168AC+662j
					; sub_4168AC+680j
		cmp	[ebp+var_C], 0
		jz	short loc_416F75
		mov	eax, [ebp+var_70]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_74]
		mov	[ebp+var_24], eax
		jmp	short loc_416F5F
; ---------------------------------------------------------------------------

loc_416F51:				; CODE XREF: sub_4168AC+6B7j
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0
		add	[ebp+var_20], 1
		sub	[ebp+var_24], 1

loc_416F5F:				; CODE XREF: sub_4168AC+6A3j
		cmp	[ebp+var_24], 0
		jnz	short loc_416F51
		mov	eax, [ebp+var_70]
		mov	[esp+0A8h+Str],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_416FF4
; ---------------------------------------------------------------------------

loc_416F75:				; CODE XREF: sub_4168AC+695j
		mov	eax, [ebp+var_7C]
		test	eax, eax
		jz	short loc_416FBF
		mov	edx, [ebp+var_74]
		mov	eax, [ebp+var_78]
		sub	edx, eax
		mov	eax, [ebp+var_7C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_70]
		mov	ebx, [ebp+var_78]
		mov	edx, [ebp+var_7C]
		add	edx, ebx
		add	edx, eax
		mov	ebx, [ebp+var_70]
		mov	eax, [ebp+var_78]
		add	eax, ebx
		mov	[esp+0A8h+Radix], ecx ;	Size
		mov	[esp+0A8h+EndPtr], edx ; Src
		mov	[esp+0A8h+Str],	eax ; Dst
		call	memmove
		mov	edx, [ebp+var_74]
		mov	eax, [ebp+var_7C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_74], eax

loc_416FBF:				; CODE XREF: sub_4168AC+6CEj
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_70]
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+Radix], 0
		mov	[esp+0A8h+EndPtr], 0
		mov	[esp+0A8h+Str],	eax
		call	gcry_sexp_canon_len
		mov	edx, [ebp+arg_10]
		mov	[edx], eax
		mov	eax, 0

loc_416FF4:				; CODE XREF: sub_4168AC+39j
					; sub_4168AC+67j ...
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_4168AC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416FFD	proc near		; CODE XREF: sub_412630+78p
					; sub_4131E4+A5p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_41701D
		mov	eax, 0
		jmp	locret_4170B5
; ---------------------------------------------------------------------------

loc_41701D:				; CODE XREF: sub_416FFD+14j
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_417041
		mov	eax, 0
		jmp	short locret_4170B5
; ---------------------------------------------------------------------------

loc_417041:				; CODE XREF: sub_416FFD+3Bj
		mov	[esp+28h+var_20], offset aProtectedPri_1 ; "protected-private-key"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_414FCB
		test	eax, eax
		jz	short loc_417066
		mov	eax, 2
		jmp	short locret_4170B5
; ---------------------------------------------------------------------------

loc_417066:				; CODE XREF: sub_416FFD+60j
		mov	[esp+28h+var_20], offset aShadowedPriv_1 ; "shadowed-private-key"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_414FCB
		test	eax, eax
		jz	short loc_41708B
		mov	eax, 3
		jmp	short locret_4170B5
; ---------------------------------------------------------------------------

loc_41708B:				; CODE XREF: sub_416FFD+85j
		mov	[esp+28h+var_20], offset aPrivateKey_2 ; "private-key"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_414FCB
		test	eax, eax
		jz	short loc_4170B0
		mov	eax, 1
		jmp	short locret_4170B5
; ---------------------------------------------------------------------------

loc_4170B0:				; CODE XREF: sub_416FFD+AAj
		mov	eax, 0

locret_4170B5:				; CODE XREF: sub_416FFD+1Bj
					; sub_416FFD+42j ...
		leave
		retn
sub_416FFD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4170B7	proc near		; CODE XREF: sub_415212+46p
					; sub_41557A+17Ap ...

Dst		= dword	ptr -58h
Src		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_4170FA
		cmp	[ebp+arg_8], 1
		jz	short loc_4170FA
		cmp	[ebp+arg_8], 3
		jnz	short loc_417112

loc_4170FA:				; CODE XREF: sub_4170B7+35j
					; sub_4170B7+3Bj
		cmp	[ebp+arg_4], 0
		jz	short loc_417112
		cmp	[ebp+arg_18], 0
		jz	short loc_417112
		cmp	[ebp+arg_14], 0
		jz	short loc_417112
		cmp	[ebp+arg_0], 0
		jnz	short loc_417123

loc_417112:				; CODE XREF: sub_4170B7+41j
					; sub_4170B7+47j ...
		mov	[esp+58h+Dst], 37h
		call	sub_414E5F
		jmp	loc_417387
; ---------------------------------------------------------------------------

loc_417123:				; CODE XREF: sub_4170B7+59j
		cmp	[ebp+arg_8], 1
		jz	short loc_41712F
		cmp	[ebp+arg_8], 3
		jnz	short loc_417146

loc_41712F:				; CODE XREF: sub_4170B7+70j
		cmp	[ebp+arg_C], 0
		jnz	short loc_417146
		mov	[esp+58h+Dst], 37h
		call	sub_414E5F
		jmp	loc_417387
; ---------------------------------------------------------------------------

loc_417146:				; CODE XREF: sub_4170B7+76j
					; sub_4170B7+7Cj
		mov	[esp+58h+Size],	1
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Src], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+Dst], eax
		call	gcry_md_open
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_417171
		mov	eax, [ebp+var_20]
		jmp	loc_417387
; ---------------------------------------------------------------------------

loc_417171:				; CODE XREF: sub_4170B7+B0j
		mov	[ebp+var_C], 0
		jmp	loc_41736B
; ---------------------------------------------------------------------------

loc_41717D:				; CODE XREF: sub_4170B7+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_4171EB
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Dst], eax
		call	gcry_md_reset
		mov	[ebp+var_10], 0
		jmp	short loc_4171E3
; ---------------------------------------------------------------------------

loc_417197:				; CODE XREF: sub_4170B7+132j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_24]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_4171C8
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 0
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Dst], eax
		call	gcry_md_write

loc_4171C8:				; CODE XREF: sub_4170B7+F4j
		mov	eax, [ebp+var_24]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_24]
		mov	byte ptr [edx+eax+0Ch],	0
		lea	edx, [eax+1]
		mov	eax, [ebp+var_24]
		mov	[eax+4], edx
		add	[ebp+var_10], 1

loc_4171E3:				; CODE XREF: sub_4170B7+DEj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jl	short loc_417197

loc_4171EB:				; CODE XREF: sub_4170B7+CAj
		cmp	[ebp+arg_8], 1
		jz	short loc_4171FB
		cmp	[ebp+arg_8], 3
		jnz	loc_4172C4

loc_4171FB:				; CODE XREF: sub_4170B7+138j
		mov	eax, [ebp+var_1C]
		add	eax, 8
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_8], 3
		jnz	short loc_417261
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_18]
		jbe	short loc_417261
		mov	eax, [ebp+var_28]
		mov	[ebp+var_18], eax
		jmp	short loc_417261
; ---------------------------------------------------------------------------

loc_417226:				; CODE XREF: sub_4170B7+1B1j
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	8
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		mov	eax, [ebp+var_28]
		sub	[ebp+var_18], eax
		jmp	short loc_417262
; ---------------------------------------------------------------------------

loc_417261:				; CODE XREF: sub_4170B7+157j
					; sub_4170B7+165j ...
		nop

loc_417262:				; CODE XREF: sub_4170B7+1A8j
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_18]
		jb	short loc_417226
		cmp	[ebp+var_18], 7
		ja	short loc_41728B
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_18]
		mov	[esp+58h+Size],	edx
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		jmp	short loc_4172DD
; ---------------------------------------------------------------------------

loc_41728B:				; CODE XREF: sub_4170B7+1B7j
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	8
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		sub	[ebp+var_18], 8
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_18]
		mov	[esp+58h+Size],	edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		jmp	short loc_4172DD
; ---------------------------------------------------------------------------

loc_4172C4:				; CODE XREF: sub_4170B7+13Ej
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write

loc_4172DD:				; CODE XREF: sub_4170B7+1D2j
					; sub_4170B7+20Bj
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 5
		mov	[esp+58h+Dst], eax
		call	gcry_md_ctl
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Dst], eax
		call	gcry_md_get_algo_dlen
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+arg_18]
		mov	ebx, ecx
		sub	ebx, edx
		mov	edx, ebx
		cmp	eax, edx
		jbe	short loc_417330
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_18]
		mov	edi, edx
		sub	edi, eax
		mov	eax, edi
		mov	[ebp+var_10], eax

loc_417330:				; CODE XREF: sub_4170B7+268j
		mov	ebx, [ebp+var_10]
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+arg_4]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_read
		mov	edx, eax
		mov	ecx, [ebp+arg_14]
		mov	eax, [ebp+var_14]
		add	eax, ecx
		mov	ecx, ebx
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		add	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_41736B:				; CODE XREF: sub_4170B7+C1j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_18]
		jb	loc_41717D
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Dst], eax
		call	gcry_md_close
		mov	eax, 0

loc_417387:				; CODE XREF: sub_4170B7+67j
					; sub_4170B7+8Aj ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4170B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41738E	proc near		; CODE XREF: sub_40BD27+30Cp
					; sub_41C8BC+3B5p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= byte ptr -2Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4173AC
; ---------------------------------------------------------------------------

loc_4173A4:				; CODE XREF: sub_41738E+33j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 2

loc_4173AC:				; CODE XREF: sub_41738E+14j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4173C3
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4173A4

loc_4173C3:				; CODE XREF: sub_41738E+26j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_14]
		add	eax, 2Bh
		mov	[esp+58h+var_58], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_417409
		mov	eax, 0
		jmp	loc_41757F
; ---------------------------------------------------------------------------

loc_417409:				; CODE XREF: sub_41738E+6Fj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	28h
		add	[ebp+var_10], 1
		mov	[esp+58h+var_4C], 0
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 14h
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	sub_41503C
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_433245
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	loc_4174EC
; ---------------------------------------------------------------------------

loc_417452:				; CODE XREF: sub_41738E+173j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41746F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41749B
; ---------------------------------------------------------------------------

loc_41746F:				; CODE XREF: sub_41738E+CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41748A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_417499
; ---------------------------------------------------------------------------

loc_41748A:				; CODE XREF: sub_41738E+E9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_417499:				; CODE XREF: sub_41738E+FAj
		mov	edx, eax

loc_41749B:				; CODE XREF: sub_41738E+DFj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4174B6
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_4174DD
; ---------------------------------------------------------------------------

loc_4174B6:				; CODE XREF: sub_41738E+118j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4174D1
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_4174DD
; ---------------------------------------------------------------------------

loc_4174D1:				; CODE XREF: sub_41738E+133j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_4174DD:				; CODE XREF: sub_41738E+126j
					; sub_41738E+141j
		add	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_C], 2

loc_4174EC:				; CODE XREF: sub_41738E+BFj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_417507
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_417452

loc_417507:				; CODE XREF: sub_41738E+166j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 14h
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_58], eax
		call	sub_41503C
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_433245
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_433245
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	29h
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]

loc_41757F:				; CODE XREF: sub_41738E+76j
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_41738E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_417585(int, void *, int)
sub_417585	proc near		; CODE XREF: sub_40BD27+36Ap
					; sub_41C8BC+3F6p

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	0
		mov	[esp+38h+Src], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_10], eax
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	0
		mov	[esp+38h+Src], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_14], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4175EA
		cmp	[ebp+var_14], 0
		jnz	short loc_4175FB

loc_4175EA:				; CODE XREF: sub_417585+5Dj
		mov	[esp+38h+Dst], 37h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_4175FB:				; CODE XREF: sub_417585+63j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_41761C
		mov	[esp+38h+Dst], 53h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_41761C:				; CODE XREF: sub_417585+84j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41764E
		mov	[esp+38h+Dst], 53h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_41764E:				; CODE XREF: sub_417585+B6j
		mov	[esp+38h+Size],	offset aPublicKey_1 ; "public-key"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Src], eax ; int
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax ; int
		call	sub_414FCB
		test	eax, eax
		jnz	short loc_41767D
		mov	[esp+38h+Dst], 68h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_41767D:				; CODE XREF: sub_417585+E5j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_417698
		mov	[esp+38h+Dst], 68h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_417698:				; CODE XREF: sub_417585+100j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4176CA
		mov	[esp+38h+Dst], 53h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_4176CA:				; CODE XREF: sub_417585+132j
		mov	eax, [ebp+var_24]
		add	eax, [ebp+var_18]
		mov	[ebp+var_24], eax
		jmp	loc_417784
; ---------------------------------------------------------------------------

loc_4176D8:				; CODE XREF: sub_417585+207j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4176F3
		mov	[esp+38h+Dst], 53h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_4176F3:				; CODE XREF: sub_417585+15Bj
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_417725
		mov	[esp+38h+Dst], 53h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_417725:				; CODE XREF: sub_417585+18Dj
		mov	eax, [ebp+var_24]
		add	eax, [ebp+var_18]
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_417753
		mov	[esp+38h+Dst], 53h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_417753:				; CODE XREF: sub_417585+1BBj
		mov	eax, [ebp+var_24]
		add	eax, [ebp+var_18]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_417777
		mov	[esp+38h+Dst], 53h
		call	sub_414E5F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_417777:				; CODE XREF: sub_417585+1DFj
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax

loc_417784:				; CODE XREF: sub_417585+14Ej
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	loc_4176D8
		mov	eax, [ebp+var_24]
		mov	[ebp+var_1C], eax
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		cmp	[ebp+var_C], 1
		jz	short loc_4177C7
		mov	[esp+38h+Size],	4A7h ; int
		mov	[esp+38h+Src], offset a____Gnupg22__7 ;	"../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+38h+Dst], offset aDepth1 ;	"depth == 1"
		call	sub_43BB20

loc_4177C7:				; CODE XREF: sub_417585+224j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	eax, edx
		add	eax, 20h
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4177FF
		call	sub_414E8F
		jmp	locret_417902
; ---------------------------------------------------------------------------

loc_4177FF:				; CODE XREF: sub_417585+26Ej
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax], 3A303228h
		mov	dword ptr [eax+4], 64616873h
		mov	dword ptr [eax+8], 6465776Fh
		mov	dword ptr [eax+0Ch], 6972702Dh
		mov	dword ptr [eax+10h], 65746176h
		mov	dword ptr [eax+14h], 79656B2Dh
		mov	byte ptr [eax+18h], 0
		add	[ebp+var_20], 18h
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		add	eax, 0Eh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+0Eh]
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		add	eax, 0Eh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax], 733A3828h
		mov	dword ptr [eax+4], 6F646168h
		mov	dword ptr [eax+8], 35646577h
		mov	dword ptr [eax+0Ch], 2D31743Ah
		mov	word ptr [eax+10h], 3176h
		mov	byte ptr [eax+12h], 0
		add	[ebp+var_20], 12h
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+var_14]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_14]
		add	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	29h
		add	[ebp+var_20], 1
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		add	ecx, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp+var_10]
		add	[ebp+var_20], eax
		mov	eax, 0

locret_417902:				; CODE XREF: sub_417585+71j
					; sub_417585+92j ...
		leave
		retn
sub_417585	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417904	proc near		; CODE XREF: sub_412630+1ACp
					; sub_4131E4+E3p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_417932
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_417932:				; CODE XREF: sub_417904+1Bj
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_417964
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_417964:				; CODE XREF: sub_417904+4Dj
		mov	[esp+28h+var_20], offset aShadowedPriv_1 ; "shadowed-private-key"
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_414FCB
		test	eax, eax
		jnz	short loc_417993
		mov	[esp+28h+var_28], 68h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_417993:				; CODE XREF: sub_417904+7Cj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4179AE
		mov	[esp+28h+var_28], 68h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_4179AE:				; CODE XREF: sub_417904+97j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4179E0
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_4179E0:				; CODE XREF: sub_417904+C9j
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_10]
		mov	[ebp+var_14], eax

loc_4179E9:				; CODE XREF: sub_417904+1CAj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_417A04
		mov	[esp+28h+var_28], 68h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_417A04:				; CODE XREF: sub_417904+EDj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_417A1F
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_417A1F:				; CODE XREF: sub_417904+108j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_417A51
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_417A51:				; CODE XREF: sub_417904+13Aj
		mov	[esp+28h+var_20], offset aShadowed ; "shadowed"
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_414FCB
		test	eax, eax
		jnz	short loc_417AD3
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_417A9D
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_417A9D:				; CODE XREF: sub_417904+186j
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_417AC1
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	locret_417B47
; ---------------------------------------------------------------------------

loc_417AC1:				; CODE XREF: sub_417904+1AAj
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		jmp	loc_4179E9
; ---------------------------------------------------------------------------

loc_417AD3:				; CODE XREF: sub_417904+169j
		nop
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_414E9C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_417AF6
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	short locret_417B47
; ---------------------------------------------------------------------------

loc_417AF6:				; CODE XREF: sub_417904+1E2j
		mov	[esp+28h+var_20], offset aT1V1 ; "t1-v1"
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_414FCB
		test	eax, eax
		jz	short loc_417B3B
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_417B2C
		mov	[esp+28h+var_28], 53h
		call	sub_414E5F
		jmp	short locret_417B47
; ---------------------------------------------------------------------------

loc_417B2C:				; CODE XREF: sub_417904+218j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_417B47
; ---------------------------------------------------------------------------

loc_417B3B:				; CODE XREF: sub_417904+20Ej
		mov	[esp+28h+var_28], 79h
		call	sub_414E5F

locret_417B47:				; CODE XREF: sub_417904+29j
					; sub_417904+5Bj ...
		leave
		retn
sub_417904	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417B49	proc near		; CODE XREF: sub_406B69+22Ep
					; sub_4193A7+2Cp

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jz	short loc_417B5E
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_417B5E:				; CODE XREF: sub_417B49+Aj
		cmp	[ebp+arg_8], 0
		jz	short loc_417B6D
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_417B6D:				; CODE XREF: sub_417B49+19j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_417B8E
		mov	[esp+28h+Dst], 53h
		call	sub_414E5F
		jmp	locret_417CAF
; ---------------------------------------------------------------------------

loc_417B8E:				; CODE XREF: sub_417B49+32j
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		lea	eax, [ebp+var_10]
		mov	[esp+28h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_417BBC
		mov	[esp+28h+Dst], 53h
		call	sub_414E5F
		jmp	locret_417CAF
; ---------------------------------------------------------------------------

loc_417BBC:				; CODE XREF: sub_417B49+60j
		cmp	[ebp+arg_4], 0
		jz	short loc_417BF4
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Size],	0
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Src], edx
		mov	[esp+28h+Dst], eax
		call	sub_424BE8
		mov	edx, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_417BF4
		call	sub_414E7A
		jmp	locret_417CAF
; ---------------------------------------------------------------------------

loc_417BF4:				; CODE XREF: sub_417B49+77j
					; sub_417B49+9Fj
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		lea	eax, [ebp+var_10]
		mov	[esp+28h+Dst], eax
		call	sub_414E9C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_417C3B
		cmp	[ebp+arg_4], 0
		jz	short loc_417C2D
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+28h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_417C2D:				; CODE XREF: sub_417B49+CCj
		mov	[esp+28h+Dst], 53h
		call	sub_414E5F
		jmp	short locret_417CAF
; ---------------------------------------------------------------------------

loc_417C3B:				; CODE XREF: sub_417B49+C6j
		cmp	[ebp+arg_8], 0
		jz	short loc_417CAA
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Dst], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_417C82
		cmp	[ebp+arg_4], 0
		jz	short loc_417C7B
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+28h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_417C7B:				; CODE XREF: sub_417B49+11Aj
		call	sub_414E7A
		jmp	short locret_417CAF
; ---------------------------------------------------------------------------

loc_417C82:				; CODE XREF: sub_417B49+114j
		mov	eax, [ebp+var_10]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		add	eax, [ebp+var_C]
		mov	byte ptr [eax],	0

loc_417CAA:				; CODE XREF: sub_417B49+F6j
		mov	eax, 0

locret_417CAF:				; CODE XREF: sub_417B49+40j
					; sub_417B49+6Ej ...
		leave
		retn
sub_417B49	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417CB4	proc near		; CODE XREF: sub_417CDB+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_417CD4
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_417CD9
; ---------------------------------------------------------------------------

loc_417CD4:				; CODE XREF: sub_417CB4+7j
		mov	eax, 0

loc_417CD9:				; CODE XREF: sub_417CB4+1Ej
		pop	ebp
		retn
sub_417CB4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417CDB	proc near		; CODE XREF: sub_417D03+Ep
					; sub_417DD9+10Fp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_417CB4
		leave
		retn
sub_417CDB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417CF6	proc near		; CODE XREF: sub_41854D+13Ap
					; sub_418C2D+192p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_417CF6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417D03	proc near		; CODE XREF: sub_417D18+6p
					; sub_417DD9+5Cp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_417CDB
		leave
		retn
sub_417D03	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417D18	proc near		; CODE XREF: sub_418C2D+129p
					; sub_418C2D+1D7p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_417D03
		leave
		retn
sub_417D18	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417D25	proc near		; CODE XREF: sub_402066+C34p

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4490C0
		test	eax, eax
		jnz	short locret_417D6F
		mov	[esp+18h+var_18], offset dword_4490BC
		call	pth_mutex_init
		test	eax, eax
		jnz	short loc_417D65
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aErrorInitializ ; "error initializing mutex: %s\n"
		call	sub_435BC0
; ---------------------------------------------------------------------------

loc_417D65:				; CODE XREF: sub_417D25+1Dj
		mov	ds:dword_4490C0, 1

locret_417D6F:				; CODE XREF: sub_417D25+Dj
		leave
		retn
sub_417D25	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417D71	proc near		; CODE XREF: sub_41854D+146p
					; sub_41854D:loc_418716p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0
		mov	dword ptr [esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset dword_4490BC
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short locret_417DAB
		mov	dword ptr [esp+18h+var_14], offset a____Gnupg22__8 ; "../../gnupg2-2.0.30/agent/trustlist.c"
		mov	[esp+18h+var_18], offset aFailedToAcqu_0 ; "failed to acquire mutex in %s\n"
		call	sub_435BC0
; ---------------------------------------------------------------------------

locret_417DAB:				; CODE XREF: sub_417D71+24j
		leave
		retn
sub_417D71	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417DAD	proc near		; CODE XREF: sub_41854D+16Cp
					; sub_41854D+1EBp ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset dword_4490BC
		call	pth_mutex_release
		test	eax, eax
		jnz	short locret_417DD7
		mov	dword ptr [esp+18h+var_14], offset a____Gnupg22__8 ; "../../gnupg2-2.0.30/agent/trustlist.c"
		mov	[esp+18h+var_18], offset aFailedToRele_1 ; "failed to release mutex in %s\n"
		call	sub_435BC0
; ---------------------------------------------------------------------------

locret_417DD7:				; CODE XREF: sub_417DAD+14j
		leave
		retn
sub_417DAD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_417DD9(char *Str2, int, int, int, int)
sub_417DD9	proc near		; CODE XREF: sub_417DD9+320p
					; sub_41854D+110p

Filename	= dword	ptr -188h
Mode		= dword	ptr -184h
Size		= dword	ptr -180h
var_17C		= dword	ptr -17Ch
var_178		= dword	ptr -178h
var_15C		= dword	ptr -15Ch
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= dword	ptr -148h
Buf		= byte ptr -144h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
Str1		= dword	ptr -2Ch
File		= dword	ptr -28h
var_24		= dword	ptr -24h
Str		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Str2		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 17Ch
		mov	[ebp+var_1C], 0
		mov	[ebp+var_24], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_148], eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[ebp+var_150], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_14C], eax
		mov	eax, offset aR_2 ; "r"
		mov	[esp+188h+Mode], eax ; Mode
		mov	eax, [ebp+Str2]
		mov	[esp+188h+Filename], eax ; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	loc_418494
		call	sub_417D03
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+188h+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+188h+Filename], offset aErrorOpeningSS ; "error opening `%s': %s\n"
		call	sub_435294
		mov	[esp+188h+Size], ebx
		mov	edx, [ebp+Str2]
		mov	[esp+188h+Mode], edx ; char
		mov	[esp+188h+Filename], eax ; char	*
		call	sub_435B7D
		jmp	loc_41850D
; ---------------------------------------------------------------------------

loc_417E6E:				; CODE XREF: sub_417DD9+6DEj
		add	[ebp+var_24], 1
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_417EB4
		lea	eax, [ebp+Buf]
		mov	[ebp+var_15C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_15C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		movzx	eax, [ebp+eax+Buf]
		cmp	al, 0Ah
		jz	short loc_417F28

loc_417EB4:				; CODE XREF: sub_417DD9+A2j
					; sub_417DD9+F3j
		mov	eax, [ebp+File]
		mov	[esp+188h+Filename], eax ; File
		call	getc
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0FFFFFFFFh
		jz	short loc_417ECE
		cmp	[ebp+var_44], 0Ah
		jnz	short loc_417EB4

loc_417ECE:				; CODE XREF: sub_417DD9+EDj
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_417EE0
		mov	eax, 61h
		jmp	short loc_417EE5
; ---------------------------------------------------------------------------

loc_417EE0:				; CODE XREF: sub_417DD9+FEj
		mov	eax, 4Bh

loc_417EE5:				; CODE XREF: sub_417DD9+105j
		mov	[esp+188h+Filename], eax
		call	sub_417CDB
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+188h+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+188h+Filename], offset aFileSLineDS ; "file `%s', line %d: %s\n"
		call	sub_435294
		mov	[esp+188h+var_17C], ebx
		mov	edx, [ebp+var_24]
		mov	[esp+188h+Size], edx
		mov	edx, [ebp+Str2]
		mov	[esp+188h+Mode], edx ; char
		mov	[esp+188h+Filename], eax ; char	*
		call	sub_435B7D
		jmp	loc_418498
; ---------------------------------------------------------------------------

loc_417F28:				; CODE XREF: sub_417DD9+D9j
		lea	eax, [ebp+Buf]
		mov	[ebp+var_15C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_15C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		mov	[ebp+eax+Buf], 0
		lea	eax, [ebp+Buf]
		mov	[ebp+Str], eax
		jmp	short loc_417F6A
; ---------------------------------------------------------------------------

loc_417F66:				; CODE XREF: sub_417DD9+199j
					; sub_417DD9+1A3j
		add	[ebp+Str], 1

loc_417F6A:				; CODE XREF: sub_417DD9+18Bj
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_417F66
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_417F66
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_418497
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	loc_418497
		mov	eax, [ebp+Str]
		mov	edx, eax
		mov	eax, offset aIncludeDefault ; "include-default"
		mov	ecx, 0Fh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_41811D
		mov	eax, [ebp+Str]
		add	eax, 0Fh
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_417FF1
		mov	eax, [ebp+Str]
		add	eax, 0Fh
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_417FF1
		mov	eax, [ebp+Str]
		add	eax, 0Fh
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	loc_41811D

loc_417FF1:				; CODE XREF: sub_417DD9+1F8j
					; sub_417DD9+205j
		cmp	[ebp+arg_4], 0
		jnz	short loc_418026
		mov	[esp+188h+Filename], offset aStatementSIgno ; "statement \"%s\"	ignored	in `%s', line "...
		call	sub_435294
		mov	edx, [ebp+var_24]
		mov	[esp+188h+var_17C], edx
		mov	edx, [ebp+Str2]
		mov	[esp+188h+Size], edx
		mov	[esp+188h+Mode], offset	aIncludeDefault	; "include-default"
		mov	[esp+188h+Filename], eax ; char	*
		call	sub_435B7D
		jmp	loc_418498
; ---------------------------------------------------------------------------

loc_418026:				; CODE XREF: sub_417DD9+21Cj
		call	sub_41F080
		mov	[esp+188h+Size], 0
		mov	[esp+188h+Mode], offset	aTrustlist_txt ; "trustlist.txt"
		mov	[esp+188h+Filename], eax
		call	sub_432667
		mov	[ebp+Str1], eax
		mov	eax, [ebp+Str2]
		mov	[esp+188h+Mode], eax ; Str2
		mov	eax, [ebp+Str1]
		mov	[esp+188h+Filename], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41808B
		mov	[esp+188h+Filename], offset aStatementSIgno ; "statement \"%s\"	ignored	in `%s', line "...
		call	sub_435294
		mov	edx, [ebp+var_24]
		mov	[esp+188h+var_17C], edx
		mov	edx, [ebp+Str2]
		mov	[esp+188h+Size], edx
		mov	[esp+188h+Mode], offset	aIncludeDefault	; "include-default"
		mov	[esp+188h+Filename], eax ; char	*
		call	sub_435B53
		jmp	loc_41810D
; ---------------------------------------------------------------------------

loc_41808B:				; CODE XREF: sub_417DD9+281j
		mov	[esp+188h+Mode], 0
		mov	eax, [ebp+Str1]
		mov	[esp+188h+Filename], eax
		call	_access
		test	eax, eax
		jz	short loc_4180CD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_4180CD
		mov	[esp+188h+Filename], offset aSystemTrustlis ; "system trustlist	`%s' not available\n"
		call	sub_435294
		mov	edx, [ebp+Str1]
		mov	[esp+188h+Mode], edx ; char
		mov	[esp+188h+Filename], eax ; char	*
		call	sub_435B53
		jmp	short loc_41810D
; ---------------------------------------------------------------------------

loc_4180CD:				; CODE XREF: sub_417DD9+2C7j
					; sub_417DD9+2D5j
		lea	eax, [ebp+var_14C]
		mov	[esp+188h+var_178], eax	; int
		lea	eax, [ebp+var_150]
		mov	[esp+188h+var_17C], eax	; int
		lea	eax, [ebp+var_148]
		mov	[esp+188h+Size], eax ; int
		mov	[esp+188h+Mode], 0 ; int
		mov	eax, [ebp+Str1]
		mov	[esp+188h+Filename], eax ; Str2
		call	sub_417DD9
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	short loc_41810D
		mov	eax, [ebp+var_30]
		mov	[ebp+var_1C], eax

loc_41810D:				; CODE XREF: sub_417DD9+2ADj
					; sub_417DD9+2F2j ...
		mov	eax, [ebp+Str1]
		mov	[esp+188h+Filename], eax
		call	gcry_free
		jmp	loc_418498
; ---------------------------------------------------------------------------

loc_41811D:				; CODE XREF: sub_417DD9+1E7j
					; sub_417DD9+212j
		mov	eax, [ebp+var_14C]
		mov	edx, eax
		mov	eax, [ebp+var_150]
		cmp	edx, eax
		jnz	short loc_418183
		mov	eax, [ebp+var_150]
		add	eax, 14h
		mov	[ebp+var_34], eax
		mov	edx, [ebp+var_34]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, eax
		mov	eax, [ebp+var_148]
		mov	[esp+188h+Mode], edx
		mov	[esp+188h+Filename], eax
		call	gcry_realloc
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jnz	short loc_418171
		call	sub_417D03
		mov	[ebp+var_1C], eax
		jmp	loc_41850D
; ---------------------------------------------------------------------------

loc_418171:				; CODE XREF: sub_417DD9+389j
		mov	eax, [ebp+var_38]
		mov	[ebp+var_148], eax
		mov	eax, [ebp+var_34]
		mov	[ebp+var_150], eax

loc_418183:				; CODE XREF: sub_417DD9+354j
		mov	ecx, [ebp+var_148]
		mov	eax, [ebp+var_14C]
		mov	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 21h
		jnz	short loc_4181DB
		mov	eax, [ebp+var_3C]
		movzx	edx, byte ptr [eax]
		or	edx, 1
		mov	[eax], dl
		add	[ebp+Str], 1
		jmp	short loc_4181C7
; ---------------------------------------------------------------------------

loc_4181C3:				; CODE XREF: sub_417DD9+3F6j
					; sub_417DD9+400j
		add	[ebp+Str], 1

loc_4181C7:				; CODE XREF: sub_417DD9+3E8j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4181C3
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4181C3

loc_4181DB:				; CODE XREF: sub_417DD9+3D7j
		mov	eax, [ebp+var_3C]
		add	eax, 4
		mov	[esp+188h+Size], 14h
		mov	[esp+188h+Mode], eax
		mov	eax, [ebp+Str]
		mov	[esp+188h+Filename], eax
		call	sub_4248AC
		mov	dword ptr [ebp+var_40],	eax
		cmp	dword ptr [ebp+var_40],	0
		jns	short loc_418237
		mov	[esp+188h+Filename], offset aBadFingerprint ; "bad fingerprint in `%s', line %d\n"
		call	sub_435294
		mov	edx, [ebp+var_24]
		mov	[esp+188h+Size], edx
		mov	edx, [ebp+Str2]
		mov	[esp+188h+Mode], edx ; char
		mov	[esp+188h+Filename], eax ; char	*
		call	sub_435B7D
		mov	[esp+188h+Filename], 59h
		call	sub_417CDB
		mov	[ebp+var_1C], eax
		jmp	loc_418498
; ---------------------------------------------------------------------------

loc_418237:				; CODE XREF: sub_417DD9+426j
		mov	eax, dword ptr [ebp+var_40]
		add	[ebp+Str], eax
		jmp	short loc_418243
; ---------------------------------------------------------------------------

loc_41823F:				; CODE XREF: sub_417DD9+472j
					; sub_417DD9+47Cj
		add	[ebp+Str], 1

loc_418243:				; CODE XREF: sub_417DD9+464j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41823F
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41823F
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41826B
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_418283

loc_41826B:				; CODE XREF: sub_417DD9+486j
		mov	eax, [ebp+var_3C]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl
		mov	eax, [ebp+var_3C]
		movzx	edx, byte ptr [eax]
		or	edx, 2
		mov	[eax], dl
		jmp	short loc_4182FB
; ---------------------------------------------------------------------------

loc_418283:				; CODE XREF: sub_417DD9+490j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 50h
		jz	short loc_418297
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 70h
		jnz	short loc_4182A4

loc_418297:				; CODE XREF: sub_417DD9+4B2j
		mov	eax, [ebp+var_3C]
		movzx	edx, byte ptr [eax]
		or	edx, 2
		mov	[eax], dl
		jmp	short loc_4182FB
; ---------------------------------------------------------------------------

loc_4182A4:				; CODE XREF: sub_417DD9+4BCj
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 53h
		jz	short loc_4182B8
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 73h
		jnz	short loc_4182C5

loc_4182B8:				; CODE XREF: sub_417DD9+4D3j
		mov	eax, [ebp+var_3C]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl
		jmp	short loc_4182FB
; ---------------------------------------------------------------------------

loc_4182C5:				; CODE XREF: sub_417DD9+4DDj
		mov	[esp+188h+Filename], offset aInvalidKeyflag ; "invalid keyflag in `%s', line %d\n"
		call	sub_435294
		mov	edx, [ebp+var_24]
		mov	[esp+188h+Size], edx
		mov	edx, [ebp+Str2]
		mov	[esp+188h+Mode], edx ; char
		mov	[esp+188h+Filename], eax ; char	*
		call	sub_435B7D
		mov	[esp+188h+Filename], 59h
		call	sub_417CDB
		mov	[ebp+var_1C], eax
		jmp	loc_418498
; ---------------------------------------------------------------------------

loc_4182FB:				; CODE XREF: sub_417DD9+4A8j
					; sub_417DD9+4C9j ...
		add	[ebp+Str], 1
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_418471
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	loc_418471
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	loc_418471
		mov	[esp+188h+Filename], offset aInvalidKeyflag ; "invalid keyflag in `%s', line %d\n"
		call	sub_435294
		mov	edx, [ebp+var_24]
		mov	[esp+188h+Size], edx
		mov	edx, [ebp+Str2]
		mov	[esp+188h+Mode], edx ; char
		mov	[esp+188h+Filename], eax ; char	*
		call	sub_435B7D
		mov	[esp+188h+Filename], 59h
		call	sub_417CDB
		mov	[ebp+var_1C], eax
		jmp	loc_418498
; ---------------------------------------------------------------------------

loc_41835F:				; CODE XREF: sub_417DD9+595j
					; sub_417DD9+59Fj
		add	[ebp+Str], 1
		jmp	short loc_418366
; ---------------------------------------------------------------------------

loc_418365:				; CODE XREF: sub_417DD9+6A1j
		nop

loc_418366:				; CODE XREF: sub_417DD9+58Aj
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41835F
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41835F
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_418482
		mov	[esp+188h+Mode], offset	asc_4447E2 ; "=	\t"
		mov	eax, [ebp+Str]
		mov	[esp+188h+Filename], eax ; Str
		call	strcspn
		mov	dword ptr [ebp+var_40],	eax
		mov	eax, dword ptr [ebp+var_40]
		add	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_4183DD
		mov	eax, [ebp+var_24]
		mov	[esp+188h+Size], eax
		mov	eax, [ebp+Str2]
		mov	[esp+188h+Mode], eax ; char
		mov	[esp+188h+Filename], offset aAssigningAValu ; "assigning a value to a flag is not yet "...
		call	sub_435B7D
		mov	[esp+188h+Filename], 59h
		call	sub_417CDB
		mov	[ebp+var_1C], eax
		add	[ebp+Str], 1
		jmp	loc_418469
; ---------------------------------------------------------------------------

loc_4183DD:				; CODE XREF: sub_417DD9+5D0j
		cmp	dword ptr [ebp+var_40],	5
		jnz	short loc_41840F
		mov	[esp+188h+Size], 5 ; Size
		mov	[esp+188h+Mode], offset	aRelax ; "relax"
		mov	eax, [ebp+Str]
		mov	[esp+188h+Filename], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_41840F
		mov	eax, [ebp+var_3C]
		movzx	edx, byte ptr [eax]
		or	edx, 8
		mov	[eax], dl
		jmp	short loc_418469
; ---------------------------------------------------------------------------

loc_41840F:				; CODE XREF: sub_417DD9+608j
					; sub_417DD9+627j
		cmp	dword ptr [ebp+var_40],	2
		jnz	short loc_418441
		mov	[esp+188h+Size], 2 ; Size
		mov	[esp+188h+Mode], offset	aCm ; "cm"
		mov	eax, [ebp+Str]
		mov	[esp+188h+Filename], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_418441
		mov	eax, [ebp+var_3C]
		movzx	edx, byte ptr [eax]
		or	edx, 10h
		mov	[eax], dl
		jmp	short loc_418469
; ---------------------------------------------------------------------------

loc_418441:				; CODE XREF: sub_417DD9+63Aj
					; sub_417DD9+659j
		mov	eax, [ebp+var_24]
		mov	[esp+188h+var_178], eax
		mov	eax, [ebp+Str2]
		mov	[esp+188h+var_17C], eax
		mov	eax, [ebp+Str]
		mov	[esp+188h+Size], eax
		mov	eax, dword ptr [ebp+var_40]
		mov	[esp+188h+Mode], eax ; char
		mov	[esp+188h+Filename], offset aFlag_SInSLineD ; "flag `%.*s' in `%s', line %d ignored\n"
		call	sub_435B7D

loc_418469:				; CODE XREF: sub_417DD9+5FFj
					; sub_417DD9+634j ...
		mov	eax, dword ptr [ebp+var_40]
		add	[ebp+Str], eax
		jmp	short loc_418472
; ---------------------------------------------------------------------------

loc_418471:				; CODE XREF: sub_417DD9+52Ej
					; sub_417DD9+53Cj ...
		nop

loc_418472:				; CODE XREF: sub_417DD9+696j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_418365
		jmp	short loc_418483
; ---------------------------------------------------------------------------

loc_418482:				; CODE XREF: sub_417DD9+5A9j
		nop

loc_418483:				; CODE XREF: sub_417DD9+6A7j
		mov	eax, [ebp+var_14C]
		add	eax, 1
		mov	[ebp+var_14C], eax
		jmp	short loc_418498
; ---------------------------------------------------------------------------

loc_418494:				; CODE XREF: sub_417DD9+56j
		nop
		jmp	short loc_418498
; ---------------------------------------------------------------------------

loc_418497:				; CODE XREF: sub_417DD9+1ADj
					; sub_417DD9+1BBj
		nop

loc_418498:				; CODE XREF: sub_417DD9+14Aj
					; sub_417DD9+248j ...
		mov	eax, [ebp+File]
		mov	[esp+188h+Size], eax ; File
		mov	[esp+188h+Mode], 0FFh ;	MaxCount
		lea	eax, [ebp+Buf]
		mov	[esp+188h+Filename], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_417E6E
		cmp	[ebp+var_1C], 0
		jnz	short loc_41850D
		mov	eax, [ebp+File]
		mov	[esp+188h+Filename], eax ; File
		call	feof
		test	eax, eax
		jnz	short loc_41850D
		call	sub_417D03
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+188h+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+188h+Filename], offset aErrorReadingSL ; "error reading `%s', line %d: %s\n"
		call	sub_435294
		mov	[esp+188h+var_17C], ebx
		mov	edx, [ebp+var_24]
		mov	[esp+188h+Size], edx
		mov	edx, [ebp+Str2]
		mov	[esp+188h+Mode], edx ; char
		mov	[esp+188h+Filename], eax ; char	*
		call	sub_435B7D

loc_41850D:				; CODE XREF: sub_417DD9+90j
					; sub_417DD9+393j ...
		cmp	[ebp+File], 0
		jz	short loc_41851E
		mov	eax, [ebp+File]
		mov	[esp+188h+Filename], eax ; File
		call	fclose

loc_41851E:				; CODE XREF: sub_417DD9+738j
		mov	edx, [ebp+var_148]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	edx, [ebp+var_150]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	edx, [ebp+var_14C]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		add	esp, 17Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_417DD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41854D	proc near		; CODE XREF: sub_418748+4Dp
					; sub_4188E0+Fp

Str2		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	[ebp+var_14], 1
		mov	[ebp+var_24], 14h
		mov	eax, [ebp+var_24]
		mov	dword ptr [esp+48h+var_44], 18h
		mov	[esp+48h+Str2],	eax
		call	gcry_calloc
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jnz	short loc_418589
		call	sub_417D03
		jmp	loc_418742
; ---------------------------------------------------------------------------

loc_418589:				; CODE XREF: sub_41854D+30j
		mov	[ebp+var_20], 0
		mov	eax, ds:dword_449DB4
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], offset aTrustlist_txt ; "trustlist.txt"
		mov	[esp+48h+Str2],	eax
		call	sub_432667
		mov	[ebp+var_10], eax
		mov	dword ptr [esp+48h+var_44], 0
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str2],	eax
		call	_access
		test	eax, eax
		jz	short loc_41863B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_418609
		call	sub_417D03
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str2],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+Str2],	offset aErrorOpeningSS ; "error	opening	`%s': %s\n"
		call	sub_435294
		mov	[esp+48h+var_40], ebx
		mov	edx, [ebp+var_10]
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+Str2],	eax ; char *
		call	sub_435B7D

loc_418609:				; CODE XREF: sub_41854D+86j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str2],	eax
		call	gcry_free
		call	sub_41F080
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], offset aTrustlist_txt ; "trustlist.txt"
		mov	[esp+48h+Str2],	eax
		call	sub_432667
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0

loc_41863B:				; CODE XREF: sub_41854D+78j
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_38], eax ;	int
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_3C], eax ;	int
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax ;	int
		mov	eax, [ebp+var_14]
		mov	dword ptr [esp+48h+var_44], eax	; int
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str2],	eax ; Str2
		call	sub_417DD9
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str2],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_4186CA
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str2],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str2],	eax
		call	sub_417CF6
		cmp	eax, 8051h
		jnz	short loc_4186C5
		call	sub_417D71
		mov	eax, ds:dword_4490B4
		mov	[esp+48h+Str2],	eax
		call	gcry_free
		mov	ds:dword_4490B4, 0
		mov	ds:dword_4490B8, 0
		call	sub_417DAD
		mov	[ebp+var_C], 0

loc_4186C5:				; CODE XREF: sub_41854D+144j
		mov	eax, [ebp+var_C]
		jmp	short loc_418742
; ---------------------------------------------------------------------------

loc_4186CA:				; CODE XREF: sub_41854D+127j
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_4186E1
		mov	eax, [ebp+var_20]
		mov	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		jmp	short loc_4186E6
; ---------------------------------------------------------------------------

loc_4186E1:				; CODE XREF: sub_41854D+182j
		mov	eax, 18h

loc_4186E6:				; CODE XREF: sub_41854D+192j
		mov	edx, [ebp+var_1C]
		mov	dword ptr [esp+48h+var_44], eax
		mov	[esp+48h+Str2],	edx
		call	gcry_realloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_418716
		call	sub_417D03
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str2],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_418742
; ---------------------------------------------------------------------------

loc_418716:				; CODE XREF: sub_41854D+1AFj
		call	sub_417D71
		mov	eax, ds:dword_4490B4
		mov	[esp+48h+Str2],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	ds:dword_4490B4, eax
		mov	eax, [ebp+var_20]
		mov	ds:dword_4490B8, eax
		call	sub_417DAD
		mov	eax, 0

loc_418742:				; CODE XREF: sub_41854D+37j
					; sub_41854D+17Bj ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_41854D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418748	proc near		; CODE XREF: sub_405DF8+126p
					; sub_418C2D+8Fp ...

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_8], 0
		jz	short loc_41875D
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_41875D:				; CODE XREF: sub_418748+Aj
		mov	[esp+38h+Size],	14h
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Buf2],	eax ; char
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Buf1],	eax
		call	sub_4248AC
		test	eax, eax
		jns	short loc_41878C
		mov	[esp+38h+Buf1],	37h
		call	sub_417CDB
		jmp	locret_4188DE
; ---------------------------------------------------------------------------

loc_41878C:				; CODE XREF: sub_418748+31j
		mov	eax, ds:dword_4490B4
		test	eax, eax
		jnz	short loc_4187BF
		call	sub_41854D
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4187BF
		mov	[esp+38h+Buf1],	offset aErrorReadingLi ; "error	reading	list of	trusted	root cert"...
		call	sub_435294
		mov	[esp+38h+Buf1],	eax ; char *
		call	sub_435B7D
		mov	eax, [ebp+var_14]
		jmp	locret_4188DE
; ---------------------------------------------------------------------------

loc_4187BF:				; CODE XREF: sub_418748+4Bj
					; sub_418748+59j
		mov	eax, ds:dword_4490B4
		test	eax, eax
		jz	loc_4188D2
		mov	eax, ds:dword_4490B4
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_4490B8
		mov	[ebp+var_10], eax
		jmp	loc_4188C8
; ---------------------------------------------------------------------------

loc_4187E1:				; CODE XREF: sub_418748+184j
		mov	eax, [ebp+var_C]
		lea	edx, [eax+4]
		mov	[esp+38h+Size],	14h ; Size
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Buf2],	eax ; Buf2
		mov	[esp+38h+Buf1],	edx ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_4188C0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 1
		test	al, al
		jz	short loc_418822
		cmp	[ebp+arg_8], 0
		jz	short loc_418822
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1

loc_418822:				; CODE XREF: sub_418748+C9j
					; sub_418748+CFj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 8
		test	al, al
		jz	short loc_418860
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	offset aRelax ;	"relax"
		mov	[esp+38h+Buf2],	offset aTrustlistflag ;	"TRUSTLISTFLAG"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Buf1],	eax
		call	sub_405B8B
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41889E
		mov	eax, [ebp+var_14]
		jmp	short locret_4188DE
; ---------------------------------------------------------------------------

loc_418860:				; CODE XREF: sub_418748+E5j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 10h
		test	al, al
		jz	short loc_41889E
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	offset aCm ; "cm"
		mov	[esp+38h+Buf2],	offset aTrustlistflag ;	"TRUSTLISTFLAG"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Buf1],	eax
		call	sub_405B8B
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41889E
		mov	eax, [ebp+var_14]
		jmp	short locret_4188DE
; ---------------------------------------------------------------------------

loc_41889E:				; CODE XREF: sub_418748+111j
					; sub_418748+123j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 1
		test	al, al
		jz	short loc_4188B9
		mov	[esp+38h+Buf1],	62h
		call	sub_417CDB
		jmp	short loc_4188BE
; ---------------------------------------------------------------------------

loc_4188B9:				; CODE XREF: sub_418748+161j
		mov	eax, 0

loc_4188BE:				; CODE XREF: sub_418748+16Fj
		jmp	short locret_4188DE
; ---------------------------------------------------------------------------

loc_4188C0:				; CODE XREF: sub_418748+B8j
		add	[ebp+var_C], 18h
		sub	[ebp+var_10], 1

loc_4188C8:				; CODE XREF: sub_418748+94j
		cmp	[ebp+var_10], 0
		jnz	loc_4187E1

loc_4188D2:				; CODE XREF: sub_418748+7Ej
		mov	[esp+38h+Buf1],	62h
		call	sub_417CDB

locret_4188DE:				; CODE XREF: sub_418748+3Fj
					; sub_418748+72j ...
		leave
		retn
sub_418748	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4188E0	proc near		; CODE XREF: sub_405F87+Cp

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_47		= byte ptr -47h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, ds:dword_4490B4
		test	eax, eax
		jnz	short loc_418919
		call	sub_41854D
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_418919
		mov	[esp+58h+var_58], offset aErrorReadingLi ; "error reading list of trusted root cert"...
		call	sub_435294
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_435B7D
		mov	eax, [ebp+var_14]
		jmp	locret_418A1B
; ---------------------------------------------------------------------------

loc_418919:				; CODE XREF: sub_4188E0+Dj
					; sub_4188E0+1Bj
		mov	eax, ds:dword_4490B4
		test	eax, eax
		jz	loc_418A16
		call	sub_417D71
		mov	eax, ds:dword_4490B4
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_4490B8
		mov	[ebp+var_10], eax
		jmp	loc_418A07
; ---------------------------------------------------------------------------

loc_418940:				; CODE XREF: sub_4188E0+12Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 1
		test	al, al
		jnz	loc_4189FE
		mov	eax, [ebp+var_C]
		lea	edx, [eax+4]
		lea	eax, [ebp+var_47]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 14h
		mov	[esp+58h+var_58], edx
		call	sub_424BE8
		mov	[ebp+var_1F], 20h
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 4
		test	al, al
		jz	short loc_41898C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jnz	short loc_4189BB

loc_41898C:				; CODE XREF: sub_4188E0+9Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 4
		test	al, al
		jnz	short loc_4189B4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jz	short loc_4189AD
		mov	eax, 50h
		jmp	short loc_4189B2
; ---------------------------------------------------------------------------

loc_4189AD:				; CODE XREF: sub_4188E0+C4j
		mov	eax, 20h

loc_4189B2:				; CODE XREF: sub_4188E0+CBj
		jmp	short loc_4189B9
; ---------------------------------------------------------------------------

loc_4189B4:				; CODE XREF: sub_4188E0+B7j
		mov	eax, 53h

loc_4189B9:				; CODE XREF: sub_4188E0:loc_4189B2j
		jmp	short loc_4189C0
; ---------------------------------------------------------------------------

loc_4189BB:				; CODE XREF: sub_4188E0+AAj
		mov	eax, 2Ah

loc_4189C0:				; CODE XREF: sub_4188E0:loc_4189B9j
		mov	[ebp+var_1E], al
		mov	[ebp+var_1D], 0Ah
		mov	[esp+58h+var_50], 2Bh
		lea	eax, [ebp+var_47]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	assuan_send_data
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	assuan_send_data
		jmp	short loc_4189FF
; ---------------------------------------------------------------------------

loc_4189FE:				; CODE XREF: sub_4188E0+6Bj
		nop

loc_4189FF:				; CODE XREF: sub_4188E0+11Cj
		add	[ebp+var_C], 18h
		sub	[ebp+var_10], 1

loc_418A07:				; CODE XREF: sub_4188E0+5Bj
		cmp	[ebp+var_10], 0
		jnz	loc_418940
		call	sub_417DAD

loc_418A16:				; CODE XREF: sub_4188E0+40j
		mov	eax, 0

locret_418A1B:				; CODE XREF: sub_4188E0+34j
		leave
		retn
sub_4188E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418A1D	proc near		; CODE XREF: sub_418C2D+1BEp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	eax, 1
		shr	eax, 1
		add	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+38h+var_38], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_418AC1
		mov	eax, 0
		jmp	loc_418B15
; ---------------------------------------------------------------------------

loc_418A7B:				; CODE XREF: sub_418A1D+ADj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_418AC2
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_418AC2
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	3Ah
		add	[ebp+var_C], 1
		jmp	short loc_418AC2
; ---------------------------------------------------------------------------

loc_418AC1:				; CODE XREF: sub_418A1D+52j
		nop

loc_418AC2:				; CODE XREF: sub_418A1D+79j
					; sub_418A1D+96j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_418A7B
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, [ebp+var_14]
		jbe	short loc_418B12
		mov	[esp+38h+var_30], 1F7h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__8 ; "../../gnupg2-2.0.30/agent/trustlist.c"
		mov	[esp+38h+var_38], offset aStrlenBufferNn ; "strlen (buffer) <= nnew"
		call	sub_43BB20

loc_418B12:				; CODE XREF: sub_418A1D+D7j
		mov	eax, [ebp+var_18]

loc_418B15:				; CODE XREF: sub_418A1D+59j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_418A1D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418B1B	proc near		; CODE XREF: sub_418C2D+E2p
					; sub_418C2D+4A7p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_418B5E
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	gcry_strdup
		jmp	loc_418C27
; ---------------------------------------------------------------------------

loc_418B5E:				; CODE XREF: sub_418B1B+31j
		mov	eax, [ebp+arg_0]
		add	eax, 1
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_418B82
; ---------------------------------------------------------------------------

loc_418B70:				; CODE XREF: sub_418B1B+6Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_418B7E
		add	[ebp+var_14], 1

loc_418B7E:				; CODE XREF: sub_418B1B+5Dj
		add	[ebp+var_C], 1

loc_418B82:				; CODE XREF: sub_418B1B+53j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_418B70
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		imul	eax, [ebp+var_18]
		add	eax, edx
		add	eax, 1
		mov	[esp+48h+var_48], eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_418BCF
		mov	eax, 0
		jmp	short loc_418C27
; ---------------------------------------------------------------------------

loc_418BCF:				; CODE XREF: sub_418B1B+ABj
		mov	eax, [ebp+arg_0]
		add	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax
		jmp	short loc_418C14
; ---------------------------------------------------------------------------

loc_418BE0:				; CODE XREF: sub_418B1B+101j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_418C01
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_433245
		mov	[ebp+var_10], eax
		jmp	short loc_418C10
; ---------------------------------------------------------------------------

loc_418C01:				; CODE XREF: sub_418B1B+CDj
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1

loc_418C10:				; CODE XREF: sub_418B1B+E4j
		add	[ebp+var_C], 1

loc_418C14:				; CODE XREF: sub_418B1B+C3j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_418BE0
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_1C]

loc_418C27:				; CODE XREF: sub_418B1B+3Ej
					; sub_418B1B+B2j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_418B1B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418C2D(int, char *, int, int)
sub_418C2D	proc near		; CODE XREF: sub_405FC1+1C0p

Str		= dword	ptr -58h
Val		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	[ebp+var_C], 0
		mov	eax, ds:dword_449DB4
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+Val], offset aTrustlist_txt ; "trustlist.txt"
		mov	[esp+58h+Str], eax
		call	sub_432667
		mov	[ebp+var_14], eax
		mov	[esp+58h+Val], 2
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Str], eax
		call	_access
		test	eax, eax
		jz	short loc_418C9D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_418C9D
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	[esp+58h+Str], 806Bh
		call	sub_417CDB
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418C9D:				; CODE XREF: sub_418C2D+44j
					; sub_418C2D+52j
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Str], eax
		call	gcry_free
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	sub_418748
		test	eax, eax
		jnz	short loc_418CCF
		mov	eax, 0
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418CCF:				; CODE XREF: sub_418C2D+96j
		mov	eax, ds:dword_449E10
		test	eax, eax
		jnz	short loc_418CE9
		mov	[esp+58h+Str], 3Ch
		call	sub_417CDB
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418CE9:				; CODE XREF: sub_418C2D+A9j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_418D01
		mov	[esp+58h+Str], 62h
		call	sub_417CDB
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418D01:				; CODE XREF: sub_418C2D+C1j
		mov	[esp+58h+Val], offset a0a ; "%0A   "
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax
		call	sub_418B1B
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_418D27
		call	sub_417D03
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418D27:				; CODE XREF: sub_418C2D+EEj
		mov	[esp+58h+Str], offset aDoYouUltimatel ;	"Do you	ultimately trust%%0A  \"%s\"%%0A"...
		call	sub_435294
		mov	edx, [ebp+var_18]
		mov	[esp+58h+Val], edx
		mov	[esp+58h+Str], eax
		call	sub_4256F5
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_418D60
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		call	sub_417D18
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418D60:				; CODE XREF: sub_418C2D+11Cj
		mov	[esp+58h+Str], offset aNo ; "No"
		call	sub_435294
		mov	ebx, eax
		mov	[esp+58h+Str], offset aYes ; "Yes"
		call	sub_435294
		mov	[esp+58h+var_48], 1
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	sub_4105B0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_418DB9
		mov	[ebp+var_10], 1
		jmp	short loc_418DE5
; ---------------------------------------------------------------------------

loc_418DB9:				; CODE XREF: sub_418C2D+181j
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str], eax
		call	sub_417CF6
		cmp	eax, 72h
		jnz	short loc_418DD2
		mov	[ebp+var_10], 0
		jmp	short loc_418DE5
; ---------------------------------------------------------------------------

loc_418DD2:				; CODE XREF: sub_418C2D+19Aj
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418DE5:				; CODE XREF: sub_418C2D+18Aj
					; sub_418C2D+1A3j
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Str], eax
		call	sub_418A1D
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_418E0E
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		call	sub_417D18
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418E0E:				; CODE XREF: sub_418C2D+1CAj
		cmp	[ebp+var_10], 0
		jz	loc_418EEA
		mov	[esp+58h+Str], offset aPleaseVerifyTh ;	"Please	verify that the	certificate iden"...
		call	sub_435294
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_50], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+Val], edx
		mov	[esp+58h+Str], eax
		call	sub_4256F5
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_418E63
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		call	sub_417D18
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418E63:				; CODE XREF: sub_418C2D+214j
		mov	[esp+58h+Str], offset aWrong ; "Wrong"
		call	sub_435294
		mov	ebx, eax
		mov	[esp+58h+Str], offset aCorrect ; "Correct"
		call	sub_435294
		mov	[esp+58h+var_48], 1
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	sub_4105B0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str], eax
		call	sub_417CF6
		cmp	eax, 72h
		jnz	short loc_418EC6
		mov	[ebp+var_10], 0
		jmp	short loc_418EEA
; ---------------------------------------------------------------------------

loc_418EC6:				; CODE XREF: sub_418C2D+28Ej
		cmp	[ebp+var_C], 0
		jz	short loc_418EEA
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418EEA:				; CODE XREF: sub_418C2D+1E5j
					; sub_418C2D+297j ...
		call	sub_417D71
		call	sub_419203
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	sub_418748
		test	eax, eax
		jz	short loc_418F18
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_418F52

loc_418F18:				; CODE XREF: sub_418C2D+2E2j
		call	sub_417DAD
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_418F48
		mov	[esp+58h+Str], 62h
		call	sub_417CDB
		jmp	short loc_418F4D
; ---------------------------------------------------------------------------

loc_418F48:				; CODE XREF: sub_418C2D+30Bj
		mov	eax, 0

loc_418F4D:				; CODE XREF: sub_418C2D+319j
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_418F52:				; CODE XREF: sub_418C2D+2E9j
		mov	eax, ds:dword_449DB4
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+Val], offset aTrustlist_txt ; "trustlist.txt"
		mov	[esp+58h+Str], eax
		call	sub_432667
		mov	[ebp+var_14], eax
		mov	[esp+58h+Val], 0
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Str], eax
		call	_access
		test	eax, eax
		jz	loc_419032
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2
		jnz	loc_419032
		mov	edx, offset aWx	; "wx"
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Val], edx ; int
		mov	[esp+58h+Str], eax ; char *
		call	sub_4284E2
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_419014
		call	sub_417D03
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str], eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Val], eax ; char
		mov	[esp+58h+Str], offset aCanTCreateSS_1 ;	"can't create `%s': %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Str], eax
		call	gcry_free
		call	sub_417DAD
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_419014:				; CODE XREF: sub_418C2D+38Dj
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Val], eax
		mov	[esp+58h+Str], offset aThisIsTheListO ;	"# This	is the list of trusted keys.  Co"...
		call	sub_42A247
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax ; void *
		call	sub_4291C4

loc_419032:				; CODE XREF: sub_418C2D+35Aj
					; sub_418C2D+36Cj
		mov	edx, offset aA_0 ; "a+"
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Val], edx ; int
		mov	[esp+58h+Str], eax ; char *
		call	sub_4284E2
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_4190A7
		call	sub_417D03
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str], eax
		call	gpg_strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Val], eax ; char
		mov	[esp+58h+Str], offset aCanTOpenSS_1 ; "can't open `%s': %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Str], eax
		call	gcry_free
		call	sub_417DAD
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_4191FC
; ---------------------------------------------------------------------------

loc_4190A7:				; CODE XREF: sub_418C2D+420j
		mov	eax, offset asc_4449D4 ; "\n# "
		mov	edx, [ebp+var_24]
		mov	[esp+58h+Val], edx
		mov	[esp+58h+Str], eax
		call	sub_42A247
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	[esp+58h+Val], offset asc_4449D4 ; "\n#	"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax
		call	sub_418B1B
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4190F9
		mov	[esp+58h+Val], 0Ah ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_419140

loc_4190F9:				; CODE XREF: sub_418C2D+4B3j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_48], 0 ; int
		mov	[esp+58h+var_4C], 0 ; char *
		mov	[esp+58h+var_50], edx ;	int
		mov	[esp+58h+Val], eax ; int
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax ; int
		call	sub_42B219
		jmp	short loc_419152
; ---------------------------------------------------------------------------

loc_419140:				; CODE XREF: sub_418C2D+4CAj
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_24]
		mov	[esp+58h+Val], edx
		mov	[esp+58h+Str], eax
		call	sub_42A247

loc_419152:				; CODE XREF: sub_418C2D+511j
		cmp	[ebp+arg_C], 53h
		jnz	short loc_41915F
		mov	edx, offset aRelax_0 ; " relax"
		jmp	short loc_419164
; ---------------------------------------------------------------------------

loc_41915F:				; CODE XREF: sub_418C2D+529j
		mov	edx, offset byte_4449DF

loc_419164:				; CODE XREF: sub_418C2D+530j
		cmp	[ebp+var_10], 0
		jz	short loc_419171
		mov	eax, offset byte_4449DF
		jmp	short loc_419176
; ---------------------------------------------------------------------------

loc_419171:				; CODE XREF: sub_418C2D+53Bj
		mov	eax, offset asc_4449E0 ; "!"

loc_419176:				; CODE XREF: sub_418C2D+542j
		mov	ecx, offset aSSCS ; "\n%s%s %c%s\n"
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Val], ecx
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax
		call	sub_42A8BF
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax
		call	sub_429531
		test	eax, eax
		jz	short loc_4191B7
		call	sub_417D03
		mov	[ebp+var_C], eax

loc_4191B7:				; CODE XREF: sub_418C2D+580j
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax ; void *
		call	sub_4291C4
		test	eax, eax
		jz	short loc_4191CE
		call	sub_417D03
		mov	[ebp+var_C], eax

loc_4191CE:				; CODE XREF: sub_418C2D+597j
		call	sub_419203
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Str], eax
		call	gcry_free
		call	sub_417DAD
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_4191FC:				; CODE XREF: sub_418C2D+6Bj
					; sub_418C2D+9Dj ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_418C2D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419203	proc near		; CODE XREF: sub_403EE1+1Cp
					; sub_418C2D+2C2p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_417D71
		mov	eax, ds:dword_4490B4
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	ds:dword_4490B4, 0
		mov	ds:dword_4490B8, 0
		call	sub_417DAD
		call	sub_405DBA
		leave
		retn
sub_419203	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41923C	proc near		; CODE XREF: sub_419263+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41925C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_419261
; ---------------------------------------------------------------------------

loc_41925C:				; CODE XREF: sub_41923C+7j
		mov	eax, 0

loc_419261:				; CODE XREF: sub_41923C+1Ej
		pop	ebp
		retn
sub_41923C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419263	proc near		; CODE XREF: sub_41928B+Ep
					; sub_4195A3+56p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_41923C
		leave
		retn
sub_419263	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41927E	proc near		; CODE XREF: sub_4193A7+FCp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_41927E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41928B	proc near		; CODE XREF: sub_4192A0+6p
					; sub_4196E6+1A3p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_419263
		leave
		retn
sub_41928B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4192A0	proc near		; CODE XREF: sub_4193A7+190p
					; sub_4195A3+C0p
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_41928B
		leave
		retn
sub_4192A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4192AD	proc near		; CODE XREF: sub_419D1E+36p
					; sub_419D1E+AEp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		mov	[ebp+var_8], 0
		jmp	short loc_4192E7
; ---------------------------------------------------------------------------

loc_4192C4:				; CODE XREF: sub_4192AD+60j
		mov	edx, [ebp+var_8]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_8], eax
		add	[ebp+var_4], 1

loc_4192E7:				; CODE XREF: sub_4192AD+15j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41930F
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_41930F
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_41930F
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_4192C4

loc_41930F:				; CODE XREF: sub_4192AD+42j
					; sub_4192AD+4Cj ...
		cmp	[ebp+var_8], 0
		jz	short loc_41931F
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_419326

loc_41931F:				; CODE XREF: sub_4192AD+66j
		mov	eax, 0
		jmp	short locret_419334
; ---------------------------------------------------------------------------

loc_419326:				; CODE XREF: sub_4192AD+70j
		mov	eax, [ebp+var_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_8]

locret_419334:				; CODE XREF: sub_4192AD+77j
		leave
		retn
sub_4192AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419336(int, int, void	*)
sub_419336	proc near		; CODE XREF: sub_419D1E+6Ap
					; sub_419D1E+E2p ...

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+var_C]
		jnz	short loc_419386
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Size],	edx ; Size
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Buf2],	edx ; Buf2
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41938D

loc_419386:				; CODE XREF: sub_419336+2Fj
		mov	eax, 0
		jmp	short loc_4193A1
; ---------------------------------------------------------------------------

loc_41938D:				; CODE XREF: sub_419336+4Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 1

loc_4193A1:				; CODE XREF: sub_419336+55j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_419336	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4193A7	proc near		; CODE XREF: sub_419BE2+22p
					; sub_419D1E+1B9p

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_50], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str1],	eax
		call	sub_417B49
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4193E9
		mov	eax, [ebp+var_C]
		jmp	loc_41959C
; ---------------------------------------------------------------------------

loc_4193E9:				; CODE XREF: sub_4193A7+38j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 14h
		jnz	short loc_419425
		mov	eax, [ebp+var_24]
		add	eax, 13h
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_419425
		sub	[ebp+var_14], 1
		jmp	short loc_419425
; ---------------------------------------------------------------------------

loc_419424:				; CODE XREF: sub_4193A7+1D6j
		nop

loc_419425:				; CODE XREF: sub_4193A7+68j
					; sub_4193A7+75j ...
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+Str2],	eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_41AF53
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41949D
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str2],	eax ; char
		mov	[esp+58h+Str1],	offset aDetectedCard_0 ; "detected card	with S/N %s\n"
		call	sub_435C1A
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str2],	edx ; Str2
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		mov	[ebp+var_1C], 0
		cmp	[ebp+var_18], 0
		jnz	short loc_4194E4
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_41959C
; ---------------------------------------------------------------------------

loc_41949D:				; CODE XREF: sub_4193A7+97j
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str1],	eax
		call	sub_41927E
		cmp	eax, 70h
		jnz	short loc_4194C9
		mov	[esp+58h+Str1],	offset aNoCardPresent ;	"no card present\n"
		call	sub_435C1A
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 1
		jmp	short loc_4194E4
; ---------------------------------------------------------------------------

loc_4194C9:				; CODE XREF: sub_4193A7+104j
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str1],	eax
		call	gpg_strerror
		mov	[esp+58h+Str2],	eax ; char
		mov	[esp+58h+Str1],	offset aErrorAccessing ; "error	accessing card:	%s\n"
		call	sub_435B7D

loc_4194E4:				; CODE XREF: sub_4193A7+D7j
					; sub_4193A7+120j
		cmp	[ebp+var_C], 0
		jnz	loc_419579
		mov	ebx, [ebp+var_24]
		cmp	[ebp+var_10], 0
		jz	short loc_419505
		mov	[esp+58h+Str1],	offset aPleaseInsertTh ; "Please insert	the card with serial numb"...
		call	sub_435294
		jmp	short loc_419511
; ---------------------------------------------------------------------------

loc_419505:				; CODE XREF: sub_4193A7+14Ej
		mov	[esp+58h+Str1],	offset aPleaseRemoveTh ; "Please remove	the current card and inse"...
		call	sub_435294

loc_419511:				; CODE XREF: sub_4193A7+15Cj
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_14]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Str2],	offset aS0a0a_S	; "%s:%%0A%%0A	\"%.*s\""
		lea	eax, [ebp+var_20]
		mov	[esp+58h+Str1],	eax
		call	sub_424454
		test	eax, eax
		jns	short loc_419541
		call	sub_4192A0
		mov	[ebp+var_C], eax
		jmp	short loc_419579
; ---------------------------------------------------------------------------

loc_419541:				; CODE XREF: sub_4193A7+18Ej
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_4105B0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str1],	eax
		call	gcry_free

loc_419579:				; CODE XREF: sub_4193A7+141j
					; sub_4193A7+198j
		cmp	[ebp+var_C], 0
		jz	loc_419424
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_41959C:				; CODE XREF: sub_4193A7+3Dj
					; sub_4193A7+F1j
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4193A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4195A3(void *, size_t, char, int, int)
sub_4195A3	proc near		; CODE XREF: sub_419BE2+C1p

Dst		= dword	ptr -88h
Src		= dword	ptr -84h
Size		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_74		= dword	ptr -74h
var_70		= byte ptr -70h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 88h
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	[ebp+var_74], 64h
		cmp	dword ptr [ebp+arg_8], 0
		jz	short loc_4195F2
		mov	[esp+88h+var_7C], 0
		mov	[esp+88h+Size],	0
		mov	[esp+88h+Src], 8
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+88h+Dst], eax
		call	gcry_md_algo_info
		test	eax, eax
		jz	short loc_419603

loc_4195F2:				; CODE XREF: sub_4195A3+26j
		mov	[esp+88h+Dst], 5
		call	sub_419263
		jmp	locret_4196E4
; ---------------------------------------------------------------------------

loc_419603:				; CODE XREF: sub_4195A3+4Dj
		lea	eax, [ebp+var_74]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_70]
		mov	[esp+88h+Size],	eax
		mov	[esp+88h+Src], 0Ah
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+88h+Dst], eax
		call	gcry_md_algo_info
		test	eax, eax
		jz	short loc_41964C
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+88h+Src], eax ; char
		mov	[esp+88h+Dst], offset aNoObjectIdenti ;	"no object identifier for algo %d\n"
		call	sub_435B7D
		mov	[esp+88h+Dst], 3Fh
		call	sub_419263
		jmp	locret_4196E4
; ---------------------------------------------------------------------------

loc_41964C:				; CODE XREF: sub_4195A3+83j
		mov	eax, [ebp+var_74]
		add	eax, [ebp+arg_4]
		mov	[esp+88h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41966A
		call	sub_4192A0
		jmp	short locret_4196E4
; ---------------------------------------------------------------------------

loc_41966A:				; CODE XREF: sub_4195A3+BEj
		mov	ecx, [ebp+var_74]
		lea	edx, [ebp+var_70]
		mov	eax, [ebp+var_C]
		mov	[esp+88h+Size],	ecx ; Size
		mov	[esp+88h+Src], edx ; Src
		mov	[esp+88h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+var_C]
		mov	eax, [ebp+var_74]
		add	eax, ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+88h+Size],	ecx ; Size
		mov	[esp+88h+Src], edx ; Src
		mov	[esp+88h+Dst], eax ; Dst
		call	memcpy
		mov	eax, ds:dword_449DA0
		and	eax, 4
		test	eax, eax
		jz	short loc_4196CA
		mov	eax, [ebp+var_74]
		add	eax, [ebp+arg_4]
		mov	[esp+88h+Size],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+88h+Src], eax
		mov	[esp+88h+Dst], offset aEncodedHash ; "encoded hash:"
		call	sub_435C74

loc_4196CA:				; CODE XREF: sub_4195A3+108j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_74]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, 0

locret_4196E4:				; CODE XREF: sub_4195A3+5Bj
					; sub_4195A3+A4j ...
		leave
		retn
sub_4195A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4196E6(int, char *, char *Dest, int)
sub_4196E6	proc near		; DATA XREF: sub_419BE2+7Ao
					; sub_419BE2+F5o ...

Str		= dword	ptr -78h
Val		= dword	ptr -74h
Count		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
Dest		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], eax
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_2C], 0
		mov	[ebp+var_30], 0
		mov	[ebp+var_34], 0
		mov	[ebp+var_38], offset aPin_1 ; "PIN"
		cmp	[ebp+Dest], 0
		jz	short loc_41973C
		cmp	[ebp+arg_C], 1
		ja	short loc_41973C
		mov	[esp+78h+Str], 37h
		call	sub_419263
		jmp	loc_419BDA
; ---------------------------------------------------------------------------

loc_41973C:				; CODE XREF: sub_4196E6+3Dj
					; sub_4196E6+43j
		cmp	[ebp+arg_4], 0
		jz	loc_419810
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	loc_419810
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+78h+Val], 7Ch ; Val
		mov	[esp+78h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	loc_419810
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[ebp+var_20], eax
		jmp	short loc_4197F6
; ---------------------------------------------------------------------------

loc_419782:				; CODE XREF: sub_4196E6+116j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 41h
		jnz	short loc_41979D
		mov	[esp+78h+Str], offset aAdminPin	; "Admin PIN"
		call	sub_435294
		mov	[ebp+var_38], eax
		jmp	short loc_4197F2
; ---------------------------------------------------------------------------

loc_41979D:				; CODE XREF: sub_4196E6+A4j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 50h
		jnz	short loc_4197BF
		mov	[esp+78h+Str], offset aPuk ; "PUK"
		call	sub_435294
		mov	[ebp+var_38], eax
		mov	[ebp+var_30], 1
		jmp	short loc_4197F2
; ---------------------------------------------------------------------------

loc_4197BF:				; CODE XREF: sub_4196E6+BFj
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jnz	short loc_4197D2
		mov	[ebp+var_28], 1
		jmp	short loc_4197F2
; ---------------------------------------------------------------------------

loc_4197D2:				; CODE XREF: sub_4196E6+E1j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 52h
		jnz	short loc_4197F2
		mov	[esp+78h+Str], offset aResetCode ; "Reset Code"
		call	sub_435294
		mov	[ebp+var_38], eax
		mov	[ebp+var_2C], 1

loc_4197F2:				; CODE XREF: sub_4196E6+B5j
					; sub_4196E6+D7j ...
		add	[ebp+var_20], 1

loc_4197F6:				; CODE XREF: sub_4196E6+9Aj
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_40]
		jb	short loc_419782
		mov	eax, [ebp+var_40]
		add	eax, 1
		mov	[ebp+arg_4], eax
		mov	[ebp+var_24], 1
		jmp	short loc_41982C
; ---------------------------------------------------------------------------

loc_419810:				; CODE XREF: sub_4196E6+5Aj
					; sub_4196E6+68j ...
		cmp	[ebp+arg_4], 0
		jz	short loc_41982C
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41982C
		mov	[esp+78h+Str], offset aPin_cbCalledWi ;	"pin_cb	called without proper PIN info h"...
		call	sub_435C1A

loc_41982C:				; CODE XREF: sub_4196E6+128j
					; sub_4196E6+12Ej ...
		cmp	[ebp+Dest], 0
		jnz	loc_4198F4
		cmp	[ebp+arg_C], 0
		jnz	short loc_419853
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+Str], eax
		call	sub_410E05
		mov	[ebp+var_1C], 0
		jmp	loc_4198EC
; ---------------------------------------------------------------------------

loc_419853:				; CODE XREF: sub_4196E6+154j
		cmp	[ebp+arg_C], 1
		jnz	loc_4198DD
		cmp	[ebp+arg_4], 0
		jz	short loc_4198BD
		mov	[esp+78h+Str], offset aS0a0auseTheRea ;	"%s%%0A%%0AUse the reader's pinpad for i"...
		call	sub_435294
		mov	edx, [ebp+arg_4]
		mov	[esp+78h+Count], edx
		mov	[esp+78h+Val], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+78h+Str], eax
		call	sub_424454
		test	eax, eax
		jns	short loc_419893
		call	sub_41928B
		mov	[ebp+var_1C], eax
		jmp	short loc_4198EC
; ---------------------------------------------------------------------------

loc_419893:				; CODE XREF: sub_4196E6+1A1j
		mov	eax, [ebp+var_4C]
		mov	[esp+78h+Count], 0
		mov	[esp+78h+Val], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+Str], eax
		call	sub_410BBF
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+78h+Str], eax
		call	gcry_free
		jmp	short loc_4198EC
; ---------------------------------------------------------------------------

loc_4198BD:				; CODE XREF: sub_4196E6+17Bj
		mov	[esp+78h+Count], 0
		mov	[esp+78h+Val], 0
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+Str], eax
		call	sub_410BBF
		mov	[ebp+var_1C], eax
		jmp	short loc_4198EC
; ---------------------------------------------------------------------------

loc_4198DD:				; CODE XREF: sub_4196E6+171j
		mov	[esp+78h+Str], 37h
		call	sub_419263
		mov	[ebp+var_1C], eax

loc_4198EC:				; CODE XREF: sub_4196E6+168j
					; sub_4196E6+1ABj ...
		mov	eax, [ebp+var_1C]
		jmp	loc_419BDA
; ---------------------------------------------------------------------------

loc_4198F4:				; CODE XREF: sub_4196E6+14Aj
					; sub_4196E6+3E8j
		mov	eax, [ebp+arg_C]
		add	eax, 32h
		mov	[esp+78h+Val], eax
		mov	[esp+78h+Str], 1
		call	gcry_calloc_secure
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jnz	short loc_41991D
		call	sub_41928B
		jmp	loc_419BDA
; ---------------------------------------------------------------------------

loc_41991D:				; CODE XREF: sub_4196E6+22Bj
		mov	eax, [ebp+arg_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_44]
		mov	[eax+20h], edx
		mov	eax, [ebp+var_44]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_44]
		mov	dword ptr [eax+4], 10h
		mov	eax, [ebp+var_44]
		mov	dword ptr [eax+8], 3
		cmp	[ebp+var_24], 0
		jz	loc_419AE3
		mov	[esp+78h+var_60], 0 ; int
		mov	[esp+78h+var_64], 0 ; int
		mov	eax, [ebp+var_44]
		mov	[esp+78h+var_68], eax ;	int
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], eax ;	int
		mov	eax, [ebp+var_38]
		mov	[esp+78h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+Val], eax ; char *
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+Str], eax ; int
		call	sub_40F902
		mov	[ebp+var_1C], eax
		mov	[ebp+var_34], 0
		cmp	[ebp+var_1C], 0
		jnz	loc_419B9B
		cmp	[ebp+var_28], 0
		jz	loc_419B9B
		mov	eax, [ebp+arg_C]
		add	eax, 32h
		mov	[esp+78h+Val], eax
		mov	[esp+78h+Str], 1
		call	gcry_calloc_secure
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jnz	short loc_4199DF
		call	sub_41928B
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		jmp	loc_419BDA
; ---------------------------------------------------------------------------

loc_4199DF:				; CODE XREF: sub_4196E6+2DCj
		mov	eax, [ebp+arg_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_48]
		mov	[eax+20h], edx
		mov	eax, [ebp+var_48]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_48]
		mov	dword ptr [eax+4], 10h
		mov	eax, [ebp+var_48]
		mov	dword ptr [eax+8], 1
		cmp	[ebp+var_2C], 0
		jz	short loc_419A1C
		mov	[esp+78h+Str], offset aRepeatThisRese ;	"Repeat	this Reset Code"
		call	sub_435294
		jmp	short loc_419A3C
; ---------------------------------------------------------------------------

loc_419A1C:				; CODE XREF: sub_4196E6+326j
		cmp	[ebp+var_30], 0
		jz	short loc_419A30
		mov	[esp+78h+Str], offset aRepeatThisPuk ; "Repeat this PUK"
		call	sub_435294
		jmp	short loc_419A3C
; ---------------------------------------------------------------------------

loc_419A30:				; CODE XREF: sub_4196E6+33Aj
		mov	[esp+78h+Str], offset aRepeatThisPin ; "Repeat this PIN"
		call	sub_435294

loc_419A3C:				; CODE XREF: sub_4196E6+334j
					; sub_4196E6+348j
		mov	[esp+78h+var_60], 0 ; int
		mov	[esp+78h+var_64], 0 ; int
		mov	edx, [ebp+var_48]
		mov	[esp+78h+var_68], edx ;	int
		mov	[esp+78h+var_6C], 0 ; int
		mov	edx, [ebp+var_38]
		mov	[esp+78h+Count], edx ; char *
		mov	[esp+78h+Val], eax ; char *
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+Str], eax ; int
		call	sub_40F902
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_419AD3
		mov	eax, [ebp+var_48]
		lea	edx, [eax+24h]
		mov	eax, [ebp+var_44]
		add	eax, 24h
		mov	[esp+78h+Val], edx ; Str2
		mov	[esp+78h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_419AD3
		cmp	[ebp+var_2C], 0
		jnz	short loc_419AB0
		cmp	[ebp+var_30], 0
		jz	short loc_419AA9
		mov	eax, offset aPukNotCorrectl ; "PUK not correctly repeated; try again"
		jmp	short loc_419AAE
; ---------------------------------------------------------------------------

loc_419AA9:				; CODE XREF: sub_4196E6+3BAj
		mov	eax, offset aPinNotCorrectl ; "PIN not correctly repeated; try again"

loc_419AAE:				; CODE XREF: sub_4196E6+3C1j
		jmp	short loc_419AB5
; ---------------------------------------------------------------------------

loc_419AB0:				; CODE XREF: sub_4196E6+3B4j
		mov	eax, offset aResetCodeNotCo ; "Reset Code not correctly	repeated; try "...

loc_419AB5:				; CODE XREF: sub_4196E6:loc_419AAEj
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_48]
		mov	[esp+78h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Str], eax
		call	gcry_free
		jmp	loc_4198F4
; ---------------------------------------------------------------------------

loc_419AD3:				; CODE XREF: sub_4196E6+392j
					; sub_4196E6+3AEj
		mov	eax, [ebp+var_48]
		mov	[esp+78h+Str], eax
		call	gcry_free
		jmp	loc_419B9B
; ---------------------------------------------------------------------------

loc_419AE3:				; CODE XREF: sub_4196E6+264j
		cmp	[ebp+arg_4], 0
		jz	short loc_419AF0
		mov	edi, offset asc_444C2D ; "')"
		jmp	short loc_419AF5
; ---------------------------------------------------------------------------

loc_419AF0:				; CODE XREF: sub_4196E6+401j
		mov	edi, offset byte_444C30

loc_419AF5:				; CODE XREF: sub_4196E6+408j
		cmp	[ebp+arg_4], 0
		jz	short loc_419B00
		mov	esi, [ebp+arg_4]
		jmp	short loc_419B05
; ---------------------------------------------------------------------------

loc_419B00:				; CODE XREF: sub_4196E6+413j
		mov	esi, offset byte_444C30

loc_419B05:				; CODE XREF: sub_4196E6+418j
		cmp	[ebp+arg_4], 0
		jz	short loc_419B12
		mov	ebx, offset asc_444C31 ; " (`"
		jmp	short loc_419B17
; ---------------------------------------------------------------------------

loc_419B12:				; CODE XREF: sub_4196E6+423j
		mov	ebx, offset byte_444C30

loc_419B17:				; CODE XREF: sub_4196E6+42Aj
		mov	[esp+78h+Str], offset aPleaseEnterT_2 ;	"Please	enter the PIN%s%s%s to unlock th"...
		call	sub_435294
		mov	[esp+78h+var_68], edi
		mov	[esp+78h+var_6C], esi
		mov	[esp+78h+Count], ebx
		mov	[esp+78h+Val], eax
		lea	eax, [ebp+var_50]
		mov	[esp+78h+Str], eax
		call	sub_424454
		test	eax, eax
		jns	short loc_419B49
		mov	[ebp+var_50], 0

loc_419B49:				; CODE XREF: sub_4196E6+45Aj
		mov	eax, [ebp+var_50]
		test	eax, eax
		jz	short loc_419B55
		mov	eax, [ebp+var_50]
		jmp	short loc_419B58
; ---------------------------------------------------------------------------

loc_419B55:				; CODE XREF: sub_4196E6+468j
		mov	eax, [ebp+arg_4]

loc_419B58:				; CODE XREF: sub_4196E6+46Dj
		mov	[esp+78h+var_60], 0 ; int
		mov	[esp+78h+var_64], 0 ; int
		mov	edx, [ebp+var_44]
		mov	[esp+78h+var_68], edx ;	int
		mov	[esp+78h+var_6C], 0 ; int
		mov	edx, [ebp+var_38]
		mov	[esp+78h+Count], edx ; char *
		mov	[esp+78h+Val], eax ; char *
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+Str], eax ; int
		call	sub_40F902
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_50]
		mov	[esp+78h+Str], eax
		call	gcry_free

loc_419B9B:				; CODE XREF: sub_4196E6+2AFj
					; sub_4196E6+2B9j ...
		cmp	[ebp+var_1C], 0
		jnz	short loc_419BCC
		mov	eax, [ebp+arg_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_44]
		add	eax, 24h
		mov	[esp+78h+Count], edx ; Count
		mov	[esp+78h+Val], eax ; Source
		mov	eax, [ebp+Dest]
		mov	[esp+78h+Str], eax ; Dest
		call	strncpy
		mov	eax, [ebp+arg_C]
		sub	eax, 1
		add	eax, [ebp+Dest]
		mov	byte ptr [eax],	0

loc_419BCC:				; CODE XREF: sub_4196E6+4B9j
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]

loc_419BDA:				; CODE XREF: sub_4196E6+51j
					; sub_4196E6+209j ...
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4196E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419BE2(int, void *, size_t, char, int, int)
sub_419BE2	proc near		; CODE XREF: sub_4136B7+DCp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	[ebp+var_1C], 0
		lea	eax, [ebp+var_14]
		mov	dword ptr [esp+48h+var_40], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_4193A7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_419C1A
		mov	eax, [ebp+var_C]
		jmp	loc_419D18
; ---------------------------------------------------------------------------

loc_419C1A:				; CODE XREF: sub_419BE2+2Ej
		cmp	dword ptr [ebp+arg_C], 401h
		jnz	short loc_419C81
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+7Ch]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+7Ch], 1
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_2C], edx
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_30], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_3C], edx
		mov	dword ptr [esp+48h+var_40], offset sub_4196E6
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41B3B9
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+7Ch], edx
		jmp	short loc_419CFC
; ---------------------------------------------------------------------------

loc_419C81:				; CODE XREF: sub_419BE2+3Fj
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_38], eax ;	int
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_3C], eax ;	int
		mov	eax, dword ptr [ebp+arg_C]
		mov	dword ptr [esp+48h+var_40], eax	; char
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_44], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_4195A3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_419CFC
		mov	ecx, [ebp+var_24]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_14]
		lea	ebx, [ebp+var_18]
		mov	[esp+48h+var_2C], ebx
		lea	ebx, [ebp+var_1C]
		mov	[esp+48h+var_30], ebx
		mov	[esp+48h+var_34], ecx
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_3C], edx
		mov	dword ptr [esp+48h+var_40], offset sub_4196E6
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41B3B9
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_419CFC:				; CODE XREF: sub_419BE2+9Dj
					; sub_419BE2+CDj
		cmp	[ebp+var_C], 0
		jnz	short loc_419D0A
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx

loc_419D0A:				; CODE XREF: sub_419BE2+11Ej
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_419D18:				; CODE XREF: sub_419BE2+33j
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_419BE2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419D1E	proc near		; CODE XREF: sub_413B27+1D5p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_419D45
		mov	[esp+48h+var_48], 53h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419D45:				; CODE XREF: sub_419D1E+14j
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	sub_4192AD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_419D73
		mov	[esp+48h+var_48], 53h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419D73:				; CODE XREF: sub_419D1E+42j
		mov	[esp+48h+var_40], offset aEncVal ; "enc-val"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax ;	int
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_419336
		test	eax, eax
		jnz	short loc_419DA2
		mov	[esp+48h+var_48], 68h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419DA2:				; CODE XREF: sub_419D1E+71j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_419DBD
		mov	[esp+48h+var_48], 68h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419DBD:				; CODE XREF: sub_419D1E+8Cj
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	sub_4192AD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_419DEB
		mov	[esp+48h+var_48], 53h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419DEB:				; CODE XREF: sub_419D1E+BAj
		mov	[esp+48h+var_40], offset aRsa_0	; "rsa"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax ;	int
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_419336
		test	eax, eax
		jnz	short loc_419E1A
		mov	[esp+48h+var_48], 54h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419E1A:				; CODE XREF: sub_419D1E+E9j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_419E35
		mov	[esp+48h+var_48], 68h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419E35:				; CODE XREF: sub_419D1E+104j
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	sub_4192AD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_419E63
		mov	[esp+48h+var_48], 53h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419E63:				; CODE XREF: sub_419D1E+132j
		mov	[esp+48h+var_40], offset aA_1 ;	"a"
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax ;	int
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_419336
		test	eax, eax
		jnz	short loc_419E92
		mov	[esp+48h+var_48], 68h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419E92:				; CODE XREF: sub_419D1E+161j
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	sub_4192AD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_419EB7
		mov	[esp+48h+var_48], 68h
		call	sub_419263
		jmp	locret_419F4E
; ---------------------------------------------------------------------------

loc_419EB7:				; CODE XREF: sub_419D1E+186j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_4193A7
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_419EEA
		mov	eax, [ebp+var_18]
		jmp	short locret_419F4E
; ---------------------------------------------------------------------------

loc_419EEA:				; CODE XREF: sub_419D1E+1C5j
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_28]
		mov	[esp+48h+var_2C], edx
		lea	edx, [ebp+var_24]
		mov	[esp+48h+var_30], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset sub_4196E6
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41B78A
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_419F40
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_419F40:				; CODE XREF: sub_419D1E+210j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_18]

locret_419F4E:				; CODE XREF: sub_419D1E+22j
					; sub_419D1E+50j ...
		leave
		retn
sub_419D1E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419F50	proc near		; CODE XREF: sub_408079+28p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset sub_4196E6
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41C0B8
		leave
		retn
sub_419F50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419F80	proc near		; CODE XREF: sub_419FA7+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_419FA0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_419FA5
; ---------------------------------------------------------------------------

loc_419FA0:				; CODE XREF: sub_419F80+7j
		mov	eax, 0

loc_419FA5:				; CODE XREF: sub_419F80+1Ej
		pop	ebp
		retn
sub_419F80	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419FA7	proc near		; CODE XREF: sub_419FDD+14p
					; sub_419FF8+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_419F80
		leave
		retn
sub_419FA7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419FC2	proc near		; CODE XREF: sub_41A11C+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_419FC2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419FCF	proc near		; CODE XREF: sub_41A11C+1Ep

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		and	eax, 7Fh
		pop	ebp
		retn
sub_419FCF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419FDD	proc near		; CODE XREF: sub_41BE04+165p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_419FA7
		leave
		retn
sub_419FDD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419FF8	proc near		; CODE XREF: sub_41A00D+6p
					; sub_41A1F1+61p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_419FA7
		leave
		retn
sub_419FF8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A00D	proc near		; CODE XREF: sub_41ADCC+151p
					; sub_41B03B+87p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_419FF8
		leave
		retn
sub_41A00D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A01A	proc near		; CODE XREF: sub_41A1F1+344p
					; sub_41A1F1+369p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jns	short loc_41A02D
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41A03A
; ---------------------------------------------------------------------------

loc_41A02D:				; CODE XREF: sub_41A01A+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

locret_41A03A:				; CODE XREF: sub_41A01A+11j
		leave
		retn
sub_41A01A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A03C	proc near		; CODE XREF: sub_402066+C2Fp

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4490D8
		test	eax, eax
		jnz	short locret_41A086
		mov	[esp+18h+var_18], offset dword_4490C8
		call	pth_mutex_init
		test	eax, eax
		jnz	short loc_41A07C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aErrorInitial_0 ; "error initializing mutex: %s\n"
		call	sub_435BC0
; ---------------------------------------------------------------------------

loc_41A07C:				; CODE XREF: sub_41A03C+1Dj
		mov	ds:dword_4490D8, 1

locret_41A086:				; CODE XREF: sub_41A03C+Dj
		leave
		retn
sub_41A03C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A088	proc near		; CODE XREF: .text:0041A0B6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aUnknownUnder_0 ; "unknown under W32"
		call	sub_435C44
		leave
		retn
sub_41A088	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	dword ptr [esp], offset	aAgent_scd_dump	; "agent_scd_dump_state: scd_lock="
		call	sub_435B53
		mov	dword ptr [esp], offset	dword_4490C8
		call	sub_41A088
		mov	dword ptr [esp], offset	asc_444CC4 ; "\n"
		call	sub_435C44
		mov	ebx, ds:dword_4490D4
		mov	eax, ds:dword_4490D0
		mov	[esp], eax
		call	assuan_get_pid
		mov	edx, ds:dword_4490D0
		mov	[esp+0Ch], ebx
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aAgent_scd_du_0	; "agent_scd_dump_state: primary_scd_ctx=%"...
		call	sub_435B53
		mov	eax, ds:Dst
		test	eax, eax
		jz	short loc_41A116
		mov	eax, ds:Dst
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aAgent_scd_du_1	; "agent_scd_dump_state: socket=`%s'\n"
		call	sub_435B53

loc_41A116:				; CODE XREF: .text:0041A0FFj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A11C	proc near		; CODE XREF: sub_41A1F1+5FCp
					; sub_41ACE2+CAp ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_419FC2
		cmp	eax, 0B0h
		jnz	short loc_41A189
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_419FCF
		cmp	eax, 6
		jnz	short loc_41A189
		mov	eax, ds:dword_4490D0
		mov	[esp+28h+var_C], 0
		mov	[esp+28h+var_10], 0
		mov	[esp+28h+var_14], 0
		mov	[esp+28h+var_18], 0
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], offset aBye	; "BYE"
		mov	[esp+28h+var_28], eax
		call	assuan_transact

loc_41A189:				; CODE XREF: sub_41A11C+16j
					; sub_41A11C+26j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_41A1C5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+0Ch]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aUnlock_scdInva ; "unlock_scd:	invalid	lock count (%d)\n"
		call	sub_435B7D
		cmp	[ebp+arg_4], 0
		jnz	short loc_41A1C5
		mov	[esp+28h+var_28], 3Fh
		call	sub_419FA7
		mov	[ebp+arg_4], eax

loc_41A1C5:				; CODE XREF: sub_41A11C+79j
					; sub_41A11C+98j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_4]
		leave
		retn
sub_41A11C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A1D7	proc near		; DATA XREF: sub_41A1F1+39Fo

var_18		= dword	ptr -18h
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_4], 0
		jnz	short locret_41A1EF
		mov	[esp+18h+var_18], 19h
		call	gcry_control

locret_41A1EF:				; CODE XREF: sub_41A1D7+Aj
		leave
		retn
sub_41A1D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A1F1	proc near		; CODE XREF: sub_41ACE2+Dp
					; sub_41AF53+13p ...

File		= dword	ptr -0D8h
Src		= dword	ptr -0D4h
Size		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B0		= byte ptr -0B0h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0D8h
		mov	[ebp+var_C], 0
		mov	[ebp+var_20], 0
		mov	eax, ds:dword_449DD4
		test	eax, eax
		jz	short loc_41A222
		mov	[esp+0D8h+File], 3Ch
		call	sub_419FA7
		jmp	locret_41A846
; ---------------------------------------------------------------------------

loc_41A222:				; CODE XREF: sub_41A1F1+1Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_41A281
		mov	[esp+0D8h+Src],	10h
		mov	[esp+0D8h+File], 1
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_41A25C
		call	sub_419FF8
		jmp	locret_41A846
; ---------------------------------------------------------------------------

loc_41A25C:				; CODE XREF: sub_41A1F1+5Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, ds:dword_4490C4
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	ds:dword_4490C4, eax

loc_41A281:				; CODE XREF: sub_41A1F1+39j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_41A2B8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+0Ch]
		mov	[esp+0D8h+Src],	eax ; char
		mov	[esp+0D8h+File], offset	aStart_scdInval	; "start_scd: invalid lock count (%d)\n"
		call	sub_435B7D
		mov	[esp+0D8h+File], 3Fh
		call	sub_419FA7
		jmp	locret_41A846
; ---------------------------------------------------------------------------

loc_41A2B8:				; CODE XREF: sub_41A1F1+9Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [eax+0Ch]
		add	edx, 1
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41A2DE
		mov	eax, 0
		jmp	locret_41A846
; ---------------------------------------------------------------------------

loc_41A2DE:				; CODE XREF: sub_41A1F1+E1j
		mov	[esp+0D8h+Size], 0
		mov	[esp+0D8h+Src],	0 ; char
		mov	[esp+0D8h+File], offset	dword_4490C8
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short loc_41A330
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0D8h+File], eax ; int
		call	strerror
		mov	[esp+0D8h+Src],	eax ; char
		mov	[esp+0D8h+File], offset	aFailedToAcqu_1	; "failed to acquire the start_scd lock: %"...
		call	sub_435B7D
		mov	[esp+0D8h+File], 3Fh
		call	sub_419FA7
		jmp	locret_41A846
; ---------------------------------------------------------------------------

loc_41A330:				; CODE XREF: sub_41A1F1+10Bj
		mov	eax, ds:dword_4490D0
		test	eax, eax
		jz	short loc_41A372
		mov	eax, ds:dword_4490D4
		test	eax, eax
		jz	short loc_41A372
		mov	eax, ds:dword_4490D0
		mov	[ebp+var_20], eax
		mov	ds:dword_4490D4, 0
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	loc_41A7D6
		mov	[esp+0D8h+File], offset	aNewConnectionT	; "new connection to SCdaemon established "...
		call	sub_435B53
		jmp	loc_41A7D6
; ---------------------------------------------------------------------------

loc_41A372:				; CODE XREF: sub_41A1F1+146j
					; sub_41A1F1+14Fj
		lea	eax, [ebp+var_20]
		mov	[esp+0D8h+File], eax
		call	assuan_new
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41A3AC
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+File], eax
		call	gpg_strerror
		mov	[esp+0D8h+Src],	eax ; char
		mov	[esp+0D8h+File], offset	aCanTAllocate_1	; "can't allocate assuan context: %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		jmp	loc_41A7DA
; ---------------------------------------------------------------------------

loc_41A3AC:				; CODE XREF: sub_41A1F1+193j
		mov	eax, ds:Dst
		test	eax, eax
		jz	loc_41A43E
		mov	edx, ds:Dst
		mov	eax, [ebp+var_20]
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+Size], 0
		mov	[esp+0D8h+Src],	edx ; char
		mov	[esp+0D8h+File], eax
		call	assuan_socket_connect
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41A420
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+File], eax
		call	gpg_strerror
		mov	edx, ds:Dst
		mov	[esp+0D8h+Size], eax
		mov	[esp+0D8h+Src],	edx ; char
		mov	[esp+0D8h+File], offset	aCanTConnectToS	; "can't connect to socket `%s': %s\n"
		call	sub_435B7D
		mov	[esp+0D8h+File], 77h
		call	sub_419FA7
		mov	[ebp+var_C], eax
		jmp	loc_41A7DA
; ---------------------------------------------------------------------------

loc_41A420:				; CODE XREF: sub_41A1F1+1F4j
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	loc_41A7D9
		mov	[esp+0D8h+File], offset	aNewConnectio_0	; "new connection to SCdaemon established\"...
		call	sub_435B53
		jmp	loc_41A7D9
; ---------------------------------------------------------------------------

loc_41A43E:				; CODE XREF: sub_41A1F1+1C2j
		mov	eax, ds:dword_4490D0
		test	eax, eax
		jz	short loc_41A467
		mov	[esp+0D8h+File], offset	aScdaemonIsRunn	; "SCdaemon is running but won't accept fu"...
		call	sub_435B53
		mov	[esp+0D8h+File], 77h
		call	sub_419FA7
		mov	[ebp+var_C], eax
		jmp	loc_41A7DA
; ---------------------------------------------------------------------------

loc_41A467:				; CODE XREF: sub_41A1F1+254j
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_41A47C
		mov	[esp+0D8h+File], offset	aNoRunningScdae	; "no running SCdaemon - starting it\n"
		call	sub_435B53

loc_41A47C:				; CODE XREF: sub_41A1F1+27Dj
		mov	[esp+0D8h+File], 0 ; File
		call	fflush
		test	eax, eax
		jz	short loc_41A4AD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0D8h+File], eax ; int
		call	strerror
		mov	[esp+0D8h+Src],	eax ; char
		mov	[esp+0D8h+File], offset	aErrorFlushin_0	; "error flushing pending output: %s\n"
		call	sub_435B7D

loc_41A4AD:				; CODE XREF: sub_41A1F1+299j
		mov	eax, ds:dword_449DD0
		test	eax, eax
		jz	short loc_41A4C2
		mov	eax, ds:dword_449DD0
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41A4D3

loc_41A4C2:				; CODE XREF: sub_41A1F1+2C3j
		mov	[esp+0D8h+File], 3
		call	sub_41F46E
		mov	ds:dword_449DD0, eax

loc_41A4D3:				; CODE XREF: sub_41A1F1+2CFj
		mov	eax, ds:dword_449DD0
		mov	[esp+0D8h+Src],	2Fh ; Ch
		mov	[esp+0D8h+File], eax ; Str
		call	strrchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41A4FB
		mov	eax, ds:dword_449DD0
		mov	[ebp+var_10], eax
		jmp	short loc_41A4FF
; ---------------------------------------------------------------------------

loc_41A4FB:				; CODE XREF: sub_41A1F1+2FEj
		add	[ebp+var_10], 1

loc_41A4FF:				; CODE XREF: sub_41A1F1+308j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], offset aMultiServer ; "--multi-server"
		mov	[ebp+var_24], 0
		mov	[ebp+var_14], 0
		mov	eax, ds:dword_449E08
		test	eax, eax
		jnz	short loc_41A56C
		call	sub_435741
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41A547
		call	sub_435741
		mov	[esp+0D8h+File], eax
		call	sub_41A01A
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_38], edx
		add	[ebp+var_14], 1

loc_41A547:				; CODE XREF: sub_41A1F1+33Aj
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+0D8h+File], eax ; File
		call	_fileno
		mov	[esp+0D8h+File], eax
		call	sub_41A01A
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_38], edx
		add	[ebp+var_14], 1

loc_41A56C:				; CODE XREF: sub_41A1F1+330j
		mov	eax, [ebp+var_14]
		mov	[ebp+eax*4+var_38], 0FFFFFFFFh
		mov	edx, ds:dword_449DD0
		mov	eax, [ebp+var_20]
		mov	[esp+0D8h+var_C0], 80h
		mov	[esp+0D8h+var_C4], 0
		mov	[esp+0D8h+var_C8], offset sub_41A1D7
		lea	ecx, [ebp+var_38]
		mov	[esp+0D8h+var_CC], ecx
		lea	ecx, [ebp+var_2C]
		mov	[esp+0D8h+Size], ecx
		mov	[esp+0D8h+Src],	edx ; char
		mov	[esp+0D8h+File], eax
		call	assuan_pipe_connect
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41A5EA
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+File], eax
		call	gpg_strerror
		mov	[esp+0D8h+Src],	eax ; char
		mov	[esp+0D8h+File], offset	aCanTConnectT_1	; "can't connect to the SCdaemon: %s\n"
		call	sub_435B7D
		mov	[esp+0D8h+File], 77h
		call	sub_419FA7
		mov	[ebp+var_C], eax
		jmp	loc_41A7DA
; ---------------------------------------------------------------------------

loc_41A5EA:				; CODE XREF: sub_41A1F1+3C8j
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_41A5FF
		mov	[esp+0D8h+File], offset	aFirstConnectio	; "first connection to SCdaemon	establishe"...
		call	sub_435C1A

loc_41A5FF:				; CODE XREF: sub_41A1F1+400j
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_41A621
		call	sub_435769
		mov	edx, [ebp+var_20]
		mov	[esp+0D8h+Src],	eax
		mov	[esp+0D8h+File], edx
		call	assuan_set_log_stream

loc_41A621:				; CODE XREF: sub_41A1F1+41Aj
		mov	eax, ds:Dst
		mov	[esp+0D8h+File], eax
		call	gcry_free
		mov	ds:Dst,	0
		mov	[esp+0D8h+Src],	100h
		lea	eax, [ebp+var_48]
		mov	[esp+0D8h+File], eax
		call	sub_424484
		mov	eax, [ebp+var_20]
		mov	[esp+0D8h+var_BC], 0
		mov	[esp+0D8h+var_C0], 0
		mov	[esp+0D8h+var_C4], 0
		mov	[esp+0D8h+var_C8], 0
		lea	edx, [ebp+var_48]
		mov	[esp+0D8h+var_CC], edx
		mov	[esp+0D8h+Size], offset	sub_41B009
		mov	[esp+0D8h+Src],	offset aGetinfoSocket_ ; "GETINFO socket_name"
		mov	[esp+0D8h+File], eax
		call	assuan_transact
		lea	eax, [ebp+var_4C]
		mov	[esp+0D8h+Src],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+0D8h+File], eax
		call	sub_424656
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_41A742
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	loc_41A742
		mov	eax, [ebp+var_4C]
		add	eax, 1
		mov	[esp+0D8h+File], eax
		call	gcry_malloc
		mov	ds:Dst,	eax
		mov	eax, ds:Dst
		test	eax, eax
		jnz	short loc_41A6F6
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0D8h+File], eax ; int
		call	strerror
		mov	[esp+0D8h+Src],	eax ; char
		mov	[esp+0D8h+File], offset	aWarningCanTSto	; "warning: can't store socket name: %s\n"
		call	sub_435B7D
		jmp	short loc_41A742
; ---------------------------------------------------------------------------

loc_41A6F6:				; CODE XREF: sub_41A1F1+4E0j
		mov	ecx, [ebp+var_4C]
		mov	edx, [ebp+var_1C]
		mov	eax, ds:Dst
		mov	[esp+0D8h+Size], ecx ; Size
		mov	[esp+0D8h+Src],	edx ; Src
		mov	[esp+0D8h+File], eax ; Dst
		call	memcpy
		mov	edx, ds:Dst
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, ds:dword_449DA0
		and	eax, 400h
		test	eax, eax
		jz	short loc_41A742
		mov	eax, ds:Dst
		mov	[esp+0D8h+Src],	eax ; char
		mov	[esp+0D8h+File], offset	aAdditionalConn	; "additional connections at `%s'\n"
		call	sub_435C1A

loc_41A742:				; CODE XREF: sub_41A1F1+4B5j
					; sub_41A1F1+4C0j ...
		mov	eax, [ebp+var_1C]
		mov	[esp+0D8h+File], eax
		call	gcry_free
		mov	eax, ds:dword_449DC8
		test	eax, eax
		jz	short loc_41A7C2
		call	sub_403664
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+Size], offset	aOptionEventSig	; "OPTION event-signal=%lx"
		mov	[esp+0D8h+Src],	64h
		lea	eax, [ebp+var_B0]
		mov	[esp+0D8h+File], eax
		call	sub_4241F9
		mov	eax, [ebp+var_20]
		mov	[esp+0D8h+var_BC], 0
		mov	[esp+0D8h+var_C0], 0
		mov	[esp+0D8h+var_C4], 0
		mov	[esp+0D8h+var_C8], 0
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+Size], 0
		lea	edx, [ebp+var_B0]
		mov	[esp+0D8h+Src],	edx
		mov	[esp+0D8h+File], eax
		call	assuan_transact

loc_41A7C2:				; CODE XREF: sub_41A1F1+563j
		mov	eax, [ebp+var_20]
		mov	ds:dword_4490D0, eax
		mov	ds:dword_4490D4, 0
		jmp	short loc_41A7DA
; ---------------------------------------------------------------------------

loc_41A7D6:				; CODE XREF: sub_41A1F1+16Aj
					; sub_41A1F1+17Cj
		nop
		jmp	short loc_41A7DA
; ---------------------------------------------------------------------------

loc_41A7D9:				; CODE XREF: sub_41A1F1+236j
					; sub_41A1F1+248j
		nop

loc_41A7DA:				; CODE XREF: sub_41A1F1+1B6j
					; sub_41A1F1+22Aj ...
		cmp	[ebp+var_C], 0
		jz	short loc_41A806
		mov	eax, [ebp+var_C]
		mov	[esp+0D8h+Src],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+File], eax
		call	sub_41A11C
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_41A812
		mov	eax, [ebp+var_20]
		mov	[esp+0D8h+File], eax
		call	assuan_release
		jmp	short loc_41A812
; ---------------------------------------------------------------------------

loc_41A806:				; CODE XREF: sub_41A1F1+5EDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_20]
		mov	[eax+8], edx

loc_41A812:				; CODE XREF: sub_41A1F1+606j
					; sub_41A1F1+613j
		mov	[esp+0D8h+File], offset	dword_4490C8
		call	pth_mutex_release
		test	eax, eax
		jnz	short loc_41A843
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0D8h+File], eax ; int
		call	strerror
		mov	[esp+0D8h+Src],	eax ; char
		mov	[esp+0D8h+File], offset	aFailedToRele_2	; "failed to release the start_scd lock: %"...
		call	sub_435B7D

loc_41A843:				; CODE XREF: sub_41A1F1+62Fj
		mov	eax, [ebp+var_C]

locret_41A846:				; CODE XREF: sub_41A1F1+2Cj
					; sub_41A1F1+66j ...
		leave
		retn
sub_41A1F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A848	proc near		; CODE XREF: sub_408650+1F3p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4490D0
		test	eax, eax
		setnz	al
		movzx	eax, al
		pop	ebp
		retn
sub_41A848	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A85A	proc near		; CODE XREF: sub_403E87:loc_403EA8p

hProcess	= dword	ptr -28h
lpExitCode	= dword	ptr -24h
var_20		= dword	ptr -20h
ExitCode	= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_4490D0
		test	eax, eax
		jz	loc_41AA5D
		mov	[esp+28h+lpExitCode], 0
		mov	[esp+28h+hProcess], 1
		call	pth_timeout
		mov	[esp+28h+lpExitCode], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+hProcess], 10h
		call	pth_event
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+lpExitCode], 0
		mov	[esp+28h+hProcess], offset dword_4490C8
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short loc_41A91F
		mov	eax, [ebp+var_10]
		mov	[esp+28h+hProcess], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_41A8E6
		mov	eax, ds:dword_449DA4
		cmp	eax, 1
		jle	short loc_41A907
		mov	[esp+28h+lpExitCode], offset aTimeout ;	"timeout"
		mov	[esp+28h+hProcess], offset aFailedToAcqu_2 ; "failed to	acquire	the start_scd lock wh"...
		call	sub_435B53
		jmp	short loc_41A907
; ---------------------------------------------------------------------------

loc_41A8E6:				; CODE XREF: sub_41A85A+6Aj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+hProcess], eax	; int
		call	strerror
		mov	[esp+28h+lpExitCode], eax ; char
		mov	[esp+28h+hProcess], offset aFailedToAcqu_2 ; "failed to	acquire	the start_scd lock wh"...
		call	sub_435B7D

loc_41A907:				; CODE XREF: sub_41A85A+74j
					; sub_41A85A+8Aj
		mov	[esp+28h+lpExitCode], 0
		mov	eax, [ebp+var_10]
		mov	[esp+28h+hProcess], eax
		call	pth_event_free
		jmp	locret_41AA5E
; ---------------------------------------------------------------------------

loc_41A91F:				; CODE XREF: sub_41A85A+5Bj
		mov	[esp+28h+lpExitCode], 0
		mov	eax, [ebp+var_10]
		mov	[esp+28h+hProcess], eax
		call	pth_event_free
		mov	eax, ds:dword_4490D0
		test	eax, eax
		jz	loc_41AA2A
		mov	eax, ds:dword_4490D0
		mov	[esp+28h+hProcess], eax
		call	assuan_get_pid
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0FFFFFFFFh
		jz	loc_41AA2A
		cmp	[ebp+var_14], 0
		jz	loc_41AA2A
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+ExitCode]
		mov	[esp+28h+lpExitCode], edx ; lpExitCode
		mov	[esp+28h+hProcess], eax	; hProcess
		mov	eax, ds:GetExitCodeProcess
		call	eax ; GetExitCodeProcess
		sub	esp, 8
		test	eax, eax
		jz	short loc_41A98C
		mov	eax, [ebp+ExitCode]
		cmp	eax, 103h
		jz	loc_41AA2A

loc_41A98C:				; CODE XREF: sub_41A85A+122j
		mov	eax, ds:dword_4490D0
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+lpExitCode], 1
		mov	[esp+28h+hProcess], eax
		call	assuan_set_flag
		mov	eax, ds:dword_4490D0
		mov	[esp+28h+hProcess], eax
		call	assuan_release
		mov	eax, ds:dword_4490C4
		mov	[ebp+var_C], eax
		jmp	short loc_41A9F9
; ---------------------------------------------------------------------------

loc_41A9C0:				; CODE XREF: sub_41A85A+1A3j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41A9F1
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, ds:dword_4490D0
		cmp	edx, eax
		jz	short loc_41A9E7
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+hProcess], eax
		call	assuan_release

loc_41A9E7:				; CODE XREF: sub_41A85A+17Dj
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+8], 0

loc_41A9F1:				; CODE XREF: sub_41A85A+16Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41A9F9:				; CODE XREF: sub_41A85A+164j
		cmp	[ebp+var_C], 0
		jnz	short loc_41A9C0
		mov	ds:dword_4490D0, 0
		mov	ds:dword_4490D4, 0
		mov	eax, ds:Dst
		mov	[esp+28h+hProcess], eax
		call	gcry_free
		mov	ds:Dst,	0

loc_41AA2A:				; CODE XREF: sub_41A85A+DFj
					; sub_41A85A+F9j ...
		mov	[esp+28h+hProcess], offset dword_4490C8
		call	pth_mutex_release
		test	eax, eax
		jnz	short locret_41AA5E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+hProcess], eax	; int
		call	strerror
		mov	[esp+28h+lpExitCode], eax ; char
		mov	[esp+28h+hProcess], offset aFailedToRele_3 ; "failed to	release	the start_scd lock wh"...
		call	sub_435B7D
		jmp	short locret_41AA5E
; ---------------------------------------------------------------------------

loc_41AA5D:				; CODE XREF: sub_41A85A+Dj
		nop

locret_41AA5E:				; CODE XREF: sub_41A85A+C0j
					; sub_41A85A+1DEj ...
		leave
		retn
sub_41A85A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AA60	proc near		; CODE XREF: sub_40901E+232p
					; sub_40DF58+10Dp ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_41ABC0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_41AB06
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [eax+8]
		mov	eax, ds:dword_4490D0
		cmp	edx, eax
		jnz	short loc_41AAE8
		mov	eax, ds:dword_4490D0
		mov	[esp+38h+var_1C], 0
		mov	[esp+38h+var_20], 0
		mov	[esp+38h+var_24], 0
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], offset aRestart ; "RESTART"
		mov	[esp+38h+var_38], eax
		call	assuan_transact
		mov	ds:dword_4490D4, 1
		jmp	short loc_41AAF9
; ---------------------------------------------------------------------------

loc_41AAE8:				; CODE XREF: sub_41AA60+35j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[esp+38h+var_38], eax
		call	assuan_release

loc_41AAF9:				; CODE XREF: sub_41AA60+86j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	dword ptr [eax+8], 0

loc_41AB06:				; CODE XREF: sub_41AA60+1Fj
		mov	eax, ds:dword_4490C4
		test	eax, eax
		jnz	short loc_41AB2B
		mov	[esp+38h+var_30], offset aAgent_reset_sc ; "agent_reset_scd"
		mov	[esp+38h+var_34], 23Eh
		mov	[esp+38h+var_38], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/agent/call-scd.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_41AB2B:				; CODE XREF: sub_41AA60+ADj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, ds:dword_4490C4
		cmp	edx, eax
		jnz	short loc_41AB49
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax]
		mov	ds:dword_4490C4, eax
		jmp	short loc_41ABA8
; ---------------------------------------------------------------------------

loc_41AB49:				; CODE XREF: sub_41AA60+D8j
		mov	eax, ds:dword_4490C4
		mov	[ebp+var_C], eax
		jmp	short loc_41AB6A
; ---------------------------------------------------------------------------

loc_41AB53:				; CODE XREF: sub_41AA60+111j
		mov	eax, [ebp+var_C]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jz	short loc_41AB75
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41AB6A:				; CODE XREF: sub_41AA60+F1j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41AB53
		jmp	short loc_41AB76
; ---------------------------------------------------------------------------

loc_41AB75:				; CODE XREF: sub_41AA60+100j
		nop

loc_41AB76:				; CODE XREF: sub_41AA60+113j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41AB9B
		mov	[esp+38h+var_30], offset aAgent_reset_sc ; "agent_reset_scd"
		mov	[esp+38h+var_34], 249h
		mov	[esp+38h+var_38], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/agent/call-scd.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_41AB9B:				; CODE XREF: sub_41AA60+11Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], edx

loc_41ABA8:				; CODE XREF: sub_41AA60+E7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0

loc_41ABC0:				; CODE XREF: sub_41AA60+Ej
		mov	eax, 0
		leave
		retn
sub_41AA60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41ABC7	proc near		; DATA XREF: sub_41ACE2+7Co

Buf1		= dword	ptr -28h
Buf2		= dword	ptr -24h
Size		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41ABEB
; ---------------------------------------------------------------------------

loc_41ABE3:				; CODE XREF: sub_41ABC7+40j
		add	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_41ABEB:				; CODE XREF: sub_41ABC7+1Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41AC11
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41AC11
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_41ABE3
		jmp	short loc_41AC11
; ---------------------------------------------------------------------------

loc_41AC0B:				; CODE XREF: sub_41ABC7+53j
					; sub_41ABC7+5Dj
		add	[ebp+arg_4], 1
		jmp	short loc_41AC12
; ---------------------------------------------------------------------------

loc_41AC11:				; CODE XREF: sub_41ABC7+2Cj
					; sub_41ABC7+36j ...
		nop

loc_41AC12:				; CODE XREF: sub_41ABC7+48j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41AC0B
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41AC0B
		cmp	[ebp+var_C], 8
		jnz	short loc_41AC64
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Size],	eax ; Size
		mov	[esp+28h+Buf2],	offset aCertinfo ; "CERTINFO"
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_41AC64
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+Buf2],	edx
		mov	[esp+28h+Buf1],	eax
		call	ecx
		jmp	short loc_41ACD7
; ---------------------------------------------------------------------------

loc_41AC64:				; CODE XREF: sub_41ABC7+63j
					; sub_41ABC7+81j
		cmp	[ebp+var_C], 0Bh
		jnz	short loc_41ACA1
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Size],	eax ; Size
		mov	[esp+28h+Buf2],	offset aKeypairinfo ; "KEYPAIRINFO"
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_41ACA1
		mov	eax, [ebp+var_10]
		mov	ecx, [eax]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+Buf2],	edx
		mov	[esp+28h+Buf1],	eax
		call	ecx
		jmp	short loc_41ACD7
; ---------------------------------------------------------------------------

loc_41ACA1:				; CODE XREF: sub_41ABC7+A1j
					; sub_41ABC7+BFj
		cmp	[ebp+var_C], 0
		jz	short loc_41ACD7
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41ACD7
		mov	eax, [ebp+var_10]
		mov	ebx, [eax+10h]
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		mov	ecx, [ebp+arg_4]
		mov	[esp+28h+var_1C], ecx
		mov	[esp+28h+Size],	edx
		mov	edx, [ebp+var_14]
		mov	[esp+28h+Buf2],	edx
		mov	[esp+28h+Buf1],	eax
		call	ebx

loc_41ACD7:				; CODE XREF: sub_41ABC7+9Bj
					; sub_41ABC7+D8j ...
		mov	eax, 0
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_41ABC7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41ACE2	proc near		; CODE XREF: sub_41C8BC+ACp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41A1F1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AD05
		mov	eax, [ebp+var_C]
		jmp	loc_41ADC6
; ---------------------------------------------------------------------------

loc_41AD05:				; CODE XREF: sub_41ACE2+19j
		lea	eax, [ebp+var_24]
		mov	edx, eax
		mov	ecx, 0
		mov	eax, 18h
		mov	ebx, eax
		and	ebx, 0FFFFFFFCh
		mov	eax, 0

loc_41AD1E:				; CODE XREF: sub_41ACE2+44j
		mov	[edx+eax], ecx
		add	eax, 4
		cmp	eax, ebx
		jb	short loc_41AD1E
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		lea	edx, [ebp+var_24]
		mov	[esp+48h+var_2C], edx
		mov	[esp+48h+var_30], offset sub_41ABC7
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], offset aLearnForce ; "LEARN --force"
		mov	[esp+48h+var_48], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41ADB3
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41A11C
		jmp	short loc_41ADC6
; ---------------------------------------------------------------------------

loc_41ADB3:				; CODE XREF: sub_41ACE2+BBj
		mov	[esp+48h+var_44], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41A11C

loc_41ADC6:				; CODE XREF: sub_41ACE2+1Ej
					; sub_41ACE2+CFj
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_41ACE2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41ADCC(int, void *Src)
sub_41ADCC	proc near		; DATA XREF: sub_41AF53+39o

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+Src]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_41ADEF
; ---------------------------------------------------------------------------

loc_41ADE7:				; CODE XREF: sub_41ADCC+3Fj
		add	[ebp+Src], 1
		add	[ebp+var_10], 1

loc_41ADEF:				; CODE XREF: sub_41ADCC+19j
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41AE15
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41AE15
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_41ADE7
		jmp	short loc_41AE15
; ---------------------------------------------------------------------------

loc_41AE0F:				; CODE XREF: sub_41ADCC+52j
					; sub_41ADCC+5Cj
		add	[ebp+Src], 1
		jmp	short loc_41AE16
; ---------------------------------------------------------------------------

loc_41AE15:				; CODE XREF: sub_41ADCC+2Bj
					; sub_41ADCC+35j ...
		nop

loc_41AE16:				; CODE XREF: sub_41ADCC+47j
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41AE0F
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41AE0F
		cmp	[ebp+var_10], 8
		jnz	loc_41AF4C
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	eax ; Size
		mov	[esp+38h+Buf2],	offset aSerialno_0 ; "SERIALNO"
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_41AF4C
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41AE70
		mov	[esp+38h+Buf1],	46h
		call	sub_419FA7
		jmp	locret_41AF51
; ---------------------------------------------------------------------------

loc_41AE70:				; CODE XREF: sub_41ADCC+91j
		mov	[ebp+var_14], 0
		mov	eax, [ebp+Src]
		mov	[ebp+var_C], eax
		jmp	short loc_41AE87
; ---------------------------------------------------------------------------

loc_41AE7F:				; CODE XREF: sub_41ADCC+CDj
					; sub_41ADCC+E1j ...
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_41AE87:				; CODE XREF: sub_41ADCC+B1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41AE9B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41AE7F

loc_41AE9B:				; CODE XREF: sub_41ADCC+C3j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41AEAF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41AE7F

loc_41AEAF:				; CODE XREF: sub_41ADCC+D7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41AEC3
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_41AE7F

loc_41AEC3:				; CODE XREF: sub_41ADCC+EBj
		cmp	[ebp+var_14], 0
		jz	short loc_41AEF1
		mov	eax, [ebp+var_14]
		and	eax, 1
		test	al, al
		jnz	short loc_41AEF1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41AEFF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41AEFF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41AEFF

loc_41AEF1:				; CODE XREF: sub_41ADCC+FBj
					; sub_41ADCC+105j
		mov	[esp+38h+Buf1],	118h
		call	sub_419FA7
		jmp	short locret_41AF51
; ---------------------------------------------------------------------------

loc_41AEFF:				; CODE XREF: sub_41ADCC+10Fj
					; sub_41ADCC+119j ...
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+38h+Buf1],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41AF24
		call	sub_41A00D
		jmp	short locret_41AF51
; ---------------------------------------------------------------------------

loc_41AF24:				; CODE XREF: sub_41ADCC+14Fj
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Buf2],	edx ; Src
		mov	[esp+38h+Buf1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_18]
		mov	edx, [eax]
		mov	eax, [ebp+var_14]
		add	eax, edx
		mov	byte ptr [eax],	0

loc_41AF4C:				; CODE XREF: sub_41ADCC+62j
					; sub_41ADCC+84j
		mov	eax, 0

locret_41AF51:				; CODE XREF: sub_41ADCC+9Fj
					; sub_41ADCC+131j ...
		leave
		retn
sub_41ADCC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AF53	proc near		; CODE XREF: sub_40BD27+64p
					; sub_4193A7+8Bp ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41A1F1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AF7C
		mov	eax, [ebp+var_C]
		jmp	locret_41B007
; ---------------------------------------------------------------------------

loc_41AF7C:				; CODE XREF: sub_41AF53+1Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		lea	edx, [ebp+var_10]
		mov	[esp+38h+var_1C], edx
		mov	[esp+38h+var_20], offset sub_41ADCC
		mov	[esp+38h+var_24], 0
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], offset aSerialno_0 ; "SERIALNO"
		mov	[esp+38h+var_38], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AFEC
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41A11C
		jmp	short locret_41B007
; ---------------------------------------------------------------------------

loc_41AFEC:				; CODE XREF: sub_41AF53+78j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41A11C

locret_41B007:				; CODE XREF: sub_41AF53+24j
					; sub_41AF53+97j
		leave
		retn
sub_41AF53	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B009(int, void *, size_t)
sub_41B009	proc near		; DATA XREF: sub_41A1F1+484o
					; sub_41B3B9+206o ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_41B034
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_424524

loc_41B034:				; CODE XREF: sub_41B009+10j
		mov	eax, 0
		leave
		retn
sub_41B009	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B03B	proc near		; DATA XREF: sub_41B3B9+1F4o
					; sub_41B78A+1E2o ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 40h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNeedpin ; "NEEDPIN"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_41B129
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41B093
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_41B129

loc_41B093:				; CODE XREF: sub_41B03B+45j
		add	dword ptr [ebp+arg_4], 7
		jmp	short loc_41B09D
; ---------------------------------------------------------------------------

loc_41B099:				; CODE XREF: sub_41B03B+6Aj
		add	dword ptr [ebp+arg_4], 1

loc_41B09D:				; CODE XREF: sub_41B03B+5Cj
		mov	eax, dword ptr [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41B099
		mov	[ebp+var_14], 5Ah
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc_secure
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41B0CC
		call	sub_41A00D
		jmp	loc_41B3B2
; ---------------------------------------------------------------------------

loc_41B0CC:				; CODE XREF: sub_41B03B+85j
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	ecx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41B119
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_18]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax

loc_41B119:				; CODE XREF: sub_41B03B+BEj
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		jmp	loc_41B3AF
; ---------------------------------------------------------------------------

loc_41B129:				; CODE XREF: sub_41B03B+34j
					; sub_41B03B+52j
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aPopuppinpadpro ; "POPUPPINPADPROMPT"
		mov	ecx, 11h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41B1AF
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 11h
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41B16B
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 11h
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41B1AF

loc_41B16B:				; CODE XREF: sub_41B03B+121j
		add	dword ptr [ebp+arg_4], 11h
		jmp	short loc_41B175
; ---------------------------------------------------------------------------

loc_41B171:				; CODE XREF: sub_41B03B+142j
		add	dword ptr [ebp+arg_4], 1

loc_41B175:				; CODE XREF: sub_41B03B+134j
		mov	eax, dword ptr [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41B171
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+48h+var_3C], 1
		mov	[esp+48h+var_40], 0
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	ecx
		mov	[ebp+var_C], eax
		jmp	loc_41B3AF
; ---------------------------------------------------------------------------

loc_41B1AF:				; CODE XREF: sub_41B03B+114j
					; sub_41B03B+12Ej
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDismisspinpadp ; "DISMISSPINPADPROMPT"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41B222
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 13h
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41B1F1
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 13h
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41B222

loc_41B1F1:				; CODE XREF: sub_41B03B+1A7j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], offset byte_4450F7
		mov	[esp+48h+var_48], eax
		call	edx
		mov	[ebp+var_C], eax
		jmp	loc_41B3AF
; ---------------------------------------------------------------------------

loc_41B222:				; CODE XREF: sub_41B03B+19Aj
					; sub_41B03B+1B4j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_41B38D
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aKeydata ; "KEYDATA"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41B286
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	dword ptr [esp+48h+var_44], 2
		mov	[esp+48h+var_48], eax
		call	assuan_get_flag
		test	eax, eax
		jnz	short loc_41B286
		mov	eax, 1
		jmp	short loc_41B28B
; ---------------------------------------------------------------------------

loc_41B286:				; CODE XREF: sub_41B03B+228j
					; sub_41B03B+242j
		mov	eax, 0

loc_41B28B:				; CODE XREF: sub_41B03B+249j
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41B2A2
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_48], eax
		call	assuan_begin_confidential

loc_41B2A2:				; CODE XREF: sub_41B03B+257j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_38], 1FA0h
		lea	edx, [ebp+var_28]
		mov	[esp+48h+var_3C], edx
		lea	edx, [ebp+var_24]
		mov	[esp+48h+var_40], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41B2E4
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_48], eax
		call	assuan_end_confidential

loc_41B2E4:				; CODE XREF: sub_41B03B+299j
		cmp	[ebp+var_C], 0
		jnz	short loc_41B369
		cmp	[ebp+var_1C], 0
		jz	short loc_41B310
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	dword ptr [esp+48h+var_44], 2
		mov	[esp+48h+var_48], eax
		call	assuan_get_flag
		test	eax, eax
		jnz	short loc_41B310
		mov	eax, 1
		jmp	short loc_41B315
; ---------------------------------------------------------------------------

loc_41B310:				; CODE XREF: sub_41B03B+2B3j
					; sub_41B03B+2CCj
		mov	eax, 0

loc_41B315:				; CODE XREF: sub_41B03B+2D3j
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41B32B
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax
		call	assuan_begin_confidential

loc_41B32B:				; CODE XREF: sub_41B03B+2E1j
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41B35C
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax
		call	assuan_end_confidential

loc_41B35C:				; CODE XREF: sub_41B03B+312j
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		jmp	short loc_41B3AF
; ---------------------------------------------------------------------------

loc_41B369:				; CODE XREF: sub_41B03B+2ADj
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_40], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aErrorForwardin ; "error forwarding inquiry `%s': %s\n"
		call	sub_435B7D
		jmp	short loc_41B3AF
; ---------------------------------------------------------------------------

loc_41B38D:				; CODE XREF: sub_41B03B+1EFj
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aUnsupportedI_0 ; "unsupported	inquiry	`%s'\n"
		call	sub_435B7D
		mov	[esp+48h+var_48], 119h
		call	sub_419FA7
		mov	[ebp+var_C], eax

loc_41B3AF:				; CODE XREF: sub_41B03B+E9j
					; sub_41B03B+16Fj ...
		mov	eax, [ebp+var_C]

loc_41B3B2:				; CODE XREF: sub_41B03B+8Cj
		add	esp, 40h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41B03B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B3B9	proc near		; CODE XREF: sub_419BE2+8Cp
					; sub_419BE2+107p

Dest		= dword	ptr -468h
Format		= dword	ptr -464h
Size		= dword	ptr -460h
var_45C		= dword	ptr -45Ch
var_458		= dword	ptr -458h
var_454		= dword	ptr -454h
var_450		= dword	ptr -450h
var_44C		= dword	ptr -44Ch
var_43C		= dword	ptr -43Ch
var_42C		= dword	ptr -42Ch
var_428		= byte ptr -428h
var_424		= dword	ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_418		= dword	ptr -418h
var_414		= byte ptr -414h
var_402		= byte ptr -402h
var_19		= byte ptr -19h
Src		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 464h
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+468h+Dest], eax
		call	sub_41A1F1
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41B3E8
		mov	eax, [ebp+var_14]
		jmp	loc_41B781
; ---------------------------------------------------------------------------

loc_41B3E8:				; CODE XREF: sub_41B3B9+25j
		mov	eax, [ebp+arg_14]
		add	eax, 19h
		add	eax, eax
		cmp	eax, 3EAh
		jbe	short loc_41B417
		mov	[esp+468h+Dest], 1
		call	sub_419FA7
		mov	[esp+468h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+468h+Dest], eax
		call	sub_41A11C
		jmp	loc_41B781
; ---------------------------------------------------------------------------

loc_41B417:				; CODE XREF: sub_41B3B9+3Cj
		mov	edx, offset aSetdata ; "SETDATA	"
		lea	eax, [ebp+var_402]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		lea	eax, [ebp+var_402]
		mov	[ebp+var_43C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_43C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+var_402]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41B49B
; ---------------------------------------------------------------------------

loc_41B46F:				; CODE XREF: sub_41B3B9+E8j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x_0 ; "%02X"
		mov	[esp+468h+Size], edx
		mov	[esp+468h+Format], eax ; Format
		mov	eax, [ebp+var_10]
		mov	[esp+468h+Dest], eax ; Dest
		call	sprintf
		add	[ebp+var_C], 1
		add	[ebp+var_10], 2

loc_41B49B:				; CODE XREF: sub_41B3B9+B4j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_14]
		jb	short loc_41B46F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[esp+468h+var_44C], 0
		mov	[esp+468h+var_450], 0
		mov	[esp+468h+var_454], 0
		mov	[esp+468h+var_458], 0
		mov	[esp+468h+var_45C], 0
		mov	[esp+468h+Size], 0
		lea	edx, [ebp+var_402]
		mov	[esp+468h+Format], edx
		mov	[esp+468h+Dest], eax
		call	assuan_transact
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41B50E
		mov	eax, [ebp+var_14]
		mov	[esp+468h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+468h+Dest], eax
		call	sub_41A11C
		jmp	loc_41B781
; ---------------------------------------------------------------------------

loc_41B50E:				; CODE XREF: sub_41B3B9+13Cj
		mov	[esp+468h+Format], 400h
		lea	eax, [ebp+var_414]
		mov	[esp+468h+Dest], eax
		call	sub_424484
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[ebp+var_424], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_420], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_41C], eax
		mov	[ebp+var_418], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+7Ch]
		test	eax, eax
		jz	short loc_41B560
		mov	eax, offset aPkauthS ; "PKAUTH %s"
		jmp	short loc_41B565
; ---------------------------------------------------------------------------

loc_41B560:				; CODE XREF: sub_41B3B9+19Ej
		mov	eax, offset aPksignS ; "PKSIGN %s"

loc_41B565:				; CODE XREF: sub_41B3B9+1A5j
		mov	edx, [ebp+arg_4]
		mov	[esp+468h+var_45C], edx
		mov	[esp+468h+Size], eax
		mov	[esp+468h+Format], 3E9h
		lea	eax, [ebp+var_402]
		mov	[esp+468h+Dest], eax
		call	sub_4241F9
		mov	[ebp+var_19], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[esp+468h+var_44C], 0
		mov	[esp+468h+var_450], 0
		lea	edx, [ebp+var_424]
		mov	[esp+468h+var_454], edx
		mov	[esp+468h+var_458], offset sub_41B03B
		lea	edx, [ebp+var_414]
		mov	[esp+468h+var_45C], edx
		mov	[esp+468h+Size], offset	sub_41B009
		lea	edx, [ebp+var_402]
		mov	[esp+468h+Format], edx
		mov	[esp+468h+Dest], eax
		call	assuan_transact
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41B619
		lea	eax, [ebp+var_428]
		mov	[esp+468h+Format], eax
		lea	eax, [ebp+var_414]
		mov	[esp+468h+Dest], eax
		call	sub_424656
		mov	[esp+468h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[esp+468h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+468h+Dest], eax
		call	sub_41A11C
		jmp	loc_41B781
; ---------------------------------------------------------------------------

loc_41B619:				; CODE XREF: sub_41B3B9+227j
		lea	eax, [ebp+var_42C]
		mov	[esp+468h+Format], eax
		lea	eax, [ebp+var_414]
		mov	[esp+468h+Dest], eax
		call	sub_424656
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_42C]
		lea	edx, [eax+24h]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	[esp+468h+Dest], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_18]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		cmp	[ebp+var_10], 0
		jnz	short loc_41B679
		call	sub_41A00D
		mov	[esp+468h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+468h+Dest], eax
		call	sub_41A11C
		jmp	loc_41B781
; ---------------------------------------------------------------------------

loc_41B679:				; CODE XREF: sub_41B3B9+2A5j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 733A3728h
		mov	dword ptr [eax+4], 762D6769h
		mov	dword ptr [eax+8], 33286C61h
		mov	dword ptr [eax+0Ch], 6173723Ah
		mov	dword ptr [eax+10h], 733A3128h
		mov	byte ptr [eax+14h], 0
		add	[ebp+var_10], 14h
		mov	edx, [ebp+var_42C]
		mov	eax, offset aU	; "%u:"
		mov	[esp+468h+Size], edx
		mov	[esp+468h+Format], eax ; Format
		mov	eax, [ebp+var_10]
		mov	[esp+468h+Dest], eax ; Dest
		call	sprintf
		mov	eax, [ebp+var_10]
		mov	[ebp+var_43C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_43C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		mov	ecx, [ebp+var_42C]
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_10]
		mov	[esp+468h+Size], ecx ; Size
		mov	[esp+468h+Format], edx ; Src
		mov	[esp+468h+Dest], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_42C]
		add	[ebp+var_10], eax
		mov	edx, offset asc_445163 ; ")))"
		mov	eax, [ebp+var_10]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+Src]
		mov	[esp+468h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	eax, [ebp+arg_18]
		mov	eax, [eax]
		mov	[esp+468h+var_45C], 0
		mov	[esp+468h+Size], 0
		mov	[esp+468h+Format], edx
		mov	[esp+468h+Dest], eax
		call	gcry_sexp_canon_len
		test	eax, eax
		jnz	short loc_41B76E
		mov	[esp+468h+Size], 36Ch ;	int
		mov	[esp+468h+Format], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/agent/call-scd.c"
		mov	[esp+468h+Dest], offset	aGcry_sexp_cano	; "gcry_sexp_canon_len (*r_buf,	*r_buflen,"...
		call	sub_43BB20

loc_41B76E:				; CODE XREF: sub_41B3B9+397j
		mov	[esp+468h+Format], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+468h+Dest], eax
		call	sub_41A11C

loc_41B781:				; CODE XREF: sub_41B3B9+2Aj
					; sub_41B3B9+59j ...
		add	esp, 464h
		pop	edi
		pop	ebp
		retn
sub_41B3B9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B78A	proc near		; CODE XREF: sub_419D1E+204p

Dest		= dword	ptr -458h
Format		= dword	ptr -454h
var_450		= dword	ptr -450h
var_44C		= dword	ptr -44Ch
var_448		= dword	ptr -448h
var_444		= dword	ptr -444h
var_440		= dword	ptr -440h
var_43C		= dword	ptr -43Ch
var_42C		= dword	ptr -42Ch
var_424		= byte ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= byte ptr -410h
var_3FE		= byte ptr -3FEh
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 454h
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+458h+Dest], eax
		call	sub_41A1F1
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41B7B9
		mov	eax, [ebp+var_14]
		jmp	loc_41BA28
; ---------------------------------------------------------------------------

loc_41B7B9:				; CODE XREF: sub_41B78A+25j
		mov	eax, [ebp+arg_14]
		add	eax, 19h
		add	eax, eax
		cmp	eax, 3EAh
		jbe	short loc_41B7E8
		mov	[esp+458h+Dest], 1
		call	sub_419FA7
		mov	[esp+458h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+458h+Dest], eax
		call	sub_41A11C
		jmp	loc_41BA28
; ---------------------------------------------------------------------------

loc_41B7E8:				; CODE XREF: sub_41B78A+3Cj
		mov	edx, offset aSetdata ; "SETDATA	"
		lea	eax, [ebp+var_3FE]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		lea	eax, [ebp+var_3FE]
		mov	[ebp+var_42C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_42C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+var_3FE]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41B86C
; ---------------------------------------------------------------------------

loc_41B840:				; CODE XREF: sub_41B78A+E8j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x_0 ; "%02X"
		mov	[esp+458h+var_450], edx
		mov	[esp+458h+Format], eax ; Format
		mov	eax, [ebp+var_10]
		mov	[esp+458h+Dest], eax ; Dest
		call	sprintf
		add	[ebp+var_C], 1
		add	[ebp+var_10], 2

loc_41B86C:				; CODE XREF: sub_41B78A+B4j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_14]
		jb	short loc_41B840
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[esp+458h+var_43C], 0
		mov	[esp+458h+var_440], 0
		mov	[esp+458h+var_444], 0
		mov	[esp+458h+var_448], 0
		mov	[esp+458h+var_44C], 0
		mov	[esp+458h+var_450], 0
		lea	edx, [ebp+var_3FE]
		mov	[esp+458h+Format], edx
		mov	[esp+458h+Dest], eax
		call	assuan_transact
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41B8DF
		mov	eax, [ebp+var_14]
		mov	[esp+458h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+458h+Dest], eax
		call	sub_41A11C
		jmp	loc_41BA28
; ---------------------------------------------------------------------------

loc_41B8DF:				; CODE XREF: sub_41B78A+13Cj
		mov	[esp+458h+Format], 400h
		lea	eax, [ebp+var_410]
		mov	[esp+458h+Dest], eax
		call	sub_424484
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[ebp+var_420], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_41C], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_418], eax
		mov	[ebp+var_414], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+458h+var_44C], eax
		mov	[esp+458h+var_450], offset aPkdecryptS ; "PKDECRYPT %s"
		mov	[esp+458h+Format], 3E9h
		lea	eax, [ebp+var_3FE]
		mov	[esp+458h+Dest], eax
		call	sub_4241F9
		mov	[ebp+var_15], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[esp+458h+var_43C], 0
		mov	[esp+458h+var_440], 0
		lea	edx, [ebp+var_420]
		mov	[esp+458h+var_444], edx
		mov	[esp+458h+var_448], offset sub_41B03B
		lea	edx, [ebp+var_410]
		mov	[esp+458h+var_44C], edx
		mov	[esp+458h+var_450], offset sub_41B009
		lea	edx, [ebp+var_3FE]
		mov	[esp+458h+Format], edx
		mov	[esp+458h+Dest], eax
		call	assuan_transact
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41B9D5
		lea	eax, [ebp+var_424]
		mov	[esp+458h+Format], eax
		lea	eax, [ebp+var_410]
		mov	[esp+458h+Dest], eax
		call	sub_424656
		mov	[esp+458h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[esp+458h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+458h+Dest], eax
		call	sub_41A11C
		jmp	short loc_41BA28
; ---------------------------------------------------------------------------

loc_41B9D5:				; CODE XREF: sub_41B78A+215j
		mov	eax, [ebp+arg_1C]
		mov	[esp+458h+Format], eax
		lea	eax, [ebp+var_410]
		mov	[esp+458h+Dest], eax
		call	sub_424656
		mov	edx, [ebp+arg_18]
		mov	[edx], eax
		mov	eax, [ebp+arg_18]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41BA15
		mov	[esp+458h+Dest], 8056h
		call	sub_419FA7
		mov	[esp+458h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+458h+Dest], eax
		call	sub_41A11C
		jmp	short loc_41BA28
; ---------------------------------------------------------------------------

loc_41BA15:				; CODE XREF: sub_41B78A+26Cj
		mov	[esp+458h+Format], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+458h+Dest], eax
		call	sub_41A11C

loc_41BA28:				; CODE XREF: sub_41B78A+2Aj
					; sub_41B78A+59j ...
		add	esp, 454h
		pop	edi
		pop	ebp
		retn
sub_41B78A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BA31	proc near		; CODE XREF: sub_41C76B+21p

var_438		= dword	ptr -438h
var_434		= dword	ptr -434h
var_430		= dword	ptr -430h
var_42C		= dword	ptr -42Ch
var_428		= dword	ptr -428h
var_424		= dword	ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_40C		= byte ptr -40Ch
var_408		= byte ptr -408h
var_3F6		= byte ptr -3F6h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 438h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+var_438], eax
		call	sub_41A1F1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41BA5F
		mov	eax, [ebp+var_C]
		jmp	locret_41BB7B
; ---------------------------------------------------------------------------

loc_41BA5F:				; CODE XREF: sub_41BA31+24j
		mov	[esp+438h+var_434], 400h
		lea	eax, [ebp+var_408]
		mov	[esp+438h+var_438], eax
		call	sub_424484
		mov	eax, [ebp+arg_4]
		mov	[esp+438h+var_42C], eax
		mov	[esp+438h+var_430], offset aReadcertS ;	"READCERT %s"
		mov	[esp+438h+var_434], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+438h+var_438], eax
		call	sub_4241F9
		mov	[ebp+var_D], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[esp+438h+var_41C], 0
		mov	[esp+438h+var_420], 0
		mov	[esp+438h+var_424], 0
		mov	[esp+438h+var_428], 0
		lea	edx, [ebp+var_408]
		mov	[esp+438h+var_42C], edx
		mov	[esp+438h+var_430], offset sub_41B009
		lea	edx, [ebp+var_3F6]
		mov	[esp+438h+var_434], edx
		mov	[esp+438h+var_438], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41BB28
		lea	eax, [ebp+var_40C]
		mov	[esp+438h+var_434], eax
		lea	eax, [ebp+var_408]
		mov	[esp+438h+var_438], eax
		call	sub_424656
		mov	[esp+438h+var_438], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+438h+var_434], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+var_438], eax
		call	sub_41A11C
		jmp	short locret_41BB7B
; ---------------------------------------------------------------------------

loc_41BB28:				; CODE XREF: sub_41BA31+C1j
		mov	eax, [ebp+arg_C]
		mov	[esp+438h+var_434], eax
		lea	eax, [ebp+var_408]
		mov	[esp+438h+var_438], eax
		call	sub_424656
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41BB68
		mov	[esp+438h+var_438], 8056h
		call	sub_419FA7
		mov	[esp+438h+var_434], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+var_438], eax
		call	sub_41A11C
		jmp	short locret_41BB7B
; ---------------------------------------------------------------------------

loc_41BB68:				; CODE XREF: sub_41BA31+118j
		mov	[esp+438h+var_434], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+var_438], eax
		call	sub_41A11C

locret_41BB7B:				; CODE XREF: sub_41BA31+29j
					; sub_41BA31+F5j ...
		leave
		retn
sub_41BA31	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BB7D	proc near		; CODE XREF: sub_40BD27+194p
					; sub_41C8BC+377p

var_438		= dword	ptr -438h
var_434		= dword	ptr -434h
var_430		= dword	ptr -430h
var_42C		= dword	ptr -42Ch
var_428		= dword	ptr -428h
var_424		= dword	ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_410		= dword	ptr -410h
var_40C		= byte ptr -40Ch
var_408		= byte ptr -408h
var_3F6		= byte ptr -3F6h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 438h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+var_438], eax
		call	sub_41A1F1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41BBAB
		mov	eax, [ebp+var_C]
		jmp	locret_41BD2B
; ---------------------------------------------------------------------------

loc_41BBAB:				; CODE XREF: sub_41BB7D+24j
		mov	[esp+438h+var_434], 400h
		lea	eax, [ebp+var_408]
		mov	[esp+438h+var_438], eax
		call	sub_424484
		mov	eax, [ebp+arg_4]
		mov	[esp+438h+var_42C], eax
		mov	[esp+438h+var_430], offset aReadkeyS ; "READKEY	%s"
		mov	[esp+438h+var_434], 3E9h
		lea	eax, [ebp+var_3F6]
		mov	[esp+438h+var_438], eax
		call	sub_4241F9
		mov	[ebp+var_D], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[esp+438h+var_41C], 0
		mov	[esp+438h+var_420], 0
		mov	[esp+438h+var_424], 0
		mov	[esp+438h+var_428], 0
		lea	edx, [ebp+var_408]
		mov	[esp+438h+var_42C], edx
		mov	[esp+438h+var_430], offset sub_41B009
		lea	edx, [ebp+var_3F6]
		mov	[esp+438h+var_434], edx
		mov	[esp+438h+var_438], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41BC77
		lea	eax, [ebp+var_40C]
		mov	[esp+438h+var_434], eax
		lea	eax, [ebp+var_408]
		mov	[esp+438h+var_438], eax
		call	sub_424656
		mov	[esp+438h+var_438], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+438h+var_434], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+var_438], eax
		call	sub_41A11C
		jmp	locret_41BD2B
; ---------------------------------------------------------------------------

loc_41BC77:				; CODE XREF: sub_41BB7D+C1j
		lea	eax, [ebp+var_410]
		mov	[esp+438h+var_434], eax
		lea	eax, [ebp+var_408]
		mov	[esp+438h+var_438], eax
		call	sub_424656
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41BCBA
		mov	[esp+438h+var_438], 8056h
		call	sub_419FA7
		mov	[esp+438h+var_434], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+var_438], eax
		call	sub_41A11C
		jmp	short locret_41BD2B
; ---------------------------------------------------------------------------

loc_41BCBA:				; CODE XREF: sub_41BB7D+11Ej
		mov	edx, [ebp+var_410]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+438h+var_42C], 0
		mov	[esp+438h+var_430], 0
		mov	[esp+438h+var_434], edx
		mov	[esp+438h+var_438], eax
		call	gcry_sexp_canon_len
		test	eax, eax
		jnz	short loc_41BD18
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+438h+var_438], eax
		call	gcry_free
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[esp+438h+var_438], 37h
		call	sub_419FA7
		mov	[esp+438h+var_434], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+var_438], eax
		call	sub_41A11C
		jmp	short locret_41BD2B
; ---------------------------------------------------------------------------

loc_41BD18:				; CODE XREF: sub_41BB7D+166j
		mov	[esp+438h+var_434], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+var_438], eax
		call	sub_41A11C

locret_41BD2B:				; CODE XREF: sub_41BB7D+29j
					; sub_41BB7D+F5j ...
		leave
		retn
sub_41BB7D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BD2D	proc near		; DATA XREF: sub_41BE04+115o

Buf1		= dword	ptr -28h
Buf2		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41BD53
		mov	eax, 0
		jmp	locret_41BE02
; ---------------------------------------------------------------------------

loc_41BD53:				; CODE XREF: sub_41BD2D+1Aj
		mov	[ebp+var_C], 0
		jmp	short loc_41BD64
; ---------------------------------------------------------------------------

loc_41BD5C:				; CODE XREF: sub_41BD2D+53j
		add	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_41BD64:				; CODE XREF: sub_41BD2D+2Dj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41BD8A
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41BD8A
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_41BD5C
		jmp	short loc_41BD8A
; ---------------------------------------------------------------------------

loc_41BD84:				; CODE XREF: sub_41BD2D+66j
					; sub_41BD2D+70j
		add	[ebp+arg_4], 1
		jmp	short loc_41BD8B
; ---------------------------------------------------------------------------

loc_41BD8A:				; CODE XREF: sub_41BD2D+3Fj
					; sub_41BD2D+49j ...
		nop

loc_41BD8B:				; CODE XREF: sub_41BD2D+5Bj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41BD84
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41BD84
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_41BDFD
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Buf2],	eax ; Buf2
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_41BDFD
		mov	[esp+28h+Buf2],	0FFh
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Buf1],	eax
		call	sub_425A59
		mov	edx, [ebp+var_10]
		mov	[edx+8], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_41BDFD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_41BDFD:				; CODE XREF: sub_41BD2D+7Dj
					; sub_41BD2D+9Cj ...
		mov	eax, 0

locret_41BE02:				; CODE XREF: sub_41BD2D+21j
		leave
		retn
sub_41BD2D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41BE04(int, char *, int)
sub_41BE04	proc near		; CODE XREF: sub_40BD27+3Bp
					; sub_40BD27+D8p ...

Dest		= dword	ptr -438h
Source		= dword	ptr -434h
var_430		= dword	ptr -430h
var_42C		= dword	ptr -42Ch
var_428		= dword	ptr -428h
var_424		= dword	ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_40C		= dword	ptr -40Ch
var_406		= byte ptr -406h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 434h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41BE32
		mov	[esp+438h+Dest], 37h
		call	sub_419FA7
		jmp	loc_41BFBA
; ---------------------------------------------------------------------------

loc_41BE32:				; CODE XREF: sub_41BE04+1Bj
		lea	eax, [ebp+var_1C]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_40C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_40C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_40C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_40C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 8
		cmp	eax, 3E9h
		jbe	short loc_41BEBE
		mov	[esp+438h+Dest], 43h
		call	sub_419FA7
		jmp	loc_41BFBA
; ---------------------------------------------------------------------------

loc_41BEBE:				; CODE XREF: sub_41BE04+A7j
		lea	eax, [ebp+var_406]
		mov	dword ptr [eax], 41544547h
		mov	dword ptr [eax+4], 20525454h
		mov	byte ptr [eax+8], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+438h+Source], eax ; Source
		lea	eax, [ebp+var_406]
		add	eax, 8
		mov	[esp+438h+Dest], eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_41A1F1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41BF09
		mov	eax, [ebp+var_C]
		jmp	loc_41BFBA
; ---------------------------------------------------------------------------

loc_41BF09:				; CODE XREF: sub_41BE04+FBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		lea	edx, [ebp+var_1C]
		mov	[esp+438h+var_41C], edx
		mov	[esp+438h+var_420], offset sub_41BD2D
		mov	[esp+438h+var_424], 0
		mov	[esp+438h+var_428], 0
		mov	[esp+438h+var_42C], 0
		mov	[esp+438h+var_430], 0
		lea	edx, [ebp+var_406]
		mov	[esp+438h+Source], edx
		mov	[esp+438h+Dest], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41BF71
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_41BF71
		mov	eax, [ebp+var_10]
		mov	[esp+438h+Dest], eax
		call	sub_419FDD
		mov	[ebp+var_C], eax

loc_41BF71:				; CODE XREF: sub_41BE04+156j
					; sub_41BE04+15Dj
		cmp	[ebp+var_C], 0
		jnz	short loc_41BF8D
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_41BF8D
		mov	[esp+438h+Dest], 3Ah
		call	sub_419FA7
		mov	[ebp+var_C], eax

loc_41BF8D:				; CODE XREF: sub_41BE04+171j
					; sub_41BE04+178j
		cmp	[ebp+var_C], 0
		jnz	short loc_41BF9D
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		jmp	short loc_41BFA8
; ---------------------------------------------------------------------------

loc_41BF9D:				; CODE XREF: sub_41BE04+18Dj
		mov	eax, [ebp+var_14]
		mov	[esp+438h+Dest], eax
		call	gcry_free

loc_41BFA8:				; CODE XREF: sub_41BE04+197j
		mov	eax, [ebp+var_C]
		mov	[esp+438h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+438h+Dest], eax
		call	sub_41A11C

loc_41BFBA:				; CODE XREF: sub_41BE04+29j
					; sub_41BE04+B5j ...
		add	esp, 434h
		pop	edi
		pop	ebp
		retn
sub_41BE04	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BFC3	proc near		; DATA XREF: sub_41C0B8+8Do

var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_D8		= byte ptr -0D8h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0E8h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41BFF4
; ---------------------------------------------------------------------------

loc_41BFDB:				; CODE XREF: sub_41BFC3+57j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_D8]
		add	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_41BFF4:				; CODE XREF: sub_41BFC3+16j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41C01C
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41C01C
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41C01C
		mov	eax, [ebp+var_C]
		cmp	eax, 0C6h
		jbe	short loc_41BFDB

loc_41C01C:				; CODE XREF: sub_41BFC3+39j
					; sub_41BFC3+43j ...
		lea	eax, [ebp+var_D8]
		add	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		jmp	short loc_41C02E
; ---------------------------------------------------------------------------

loc_41C02A:				; CODE XREF: sub_41BFC3+87j
		add	[ebp+arg_4], 1

loc_41C02E:				; CODE XREF: sub_41BFC3+65j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41C054
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41C054
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_41C02A
		jmp	short loc_41C054
; ---------------------------------------------------------------------------

loc_41C04E:				; CODE XREF: sub_41BFC3+9Aj
					; sub_41BFC3+A4j
		add	[ebp+arg_4], 1
		jmp	short loc_41C055
; ---------------------------------------------------------------------------

loc_41C054:				; CODE XREF: sub_41BFC3+73j
					; sub_41BFC3+7Dj ...
		nop

loc_41C055:				; CODE XREF: sub_41BFC3+8Fj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41C04E
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41C04E
		mov	eax, [ebp+arg_4]
		mov	[esp+0E8h+var_E0], eax
		lea	eax, [ebp+var_D8]
		mov	[esp+0E8h+var_E4], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0E8h+var_E8], eax
		call	assuan_write_status
		mov	eax, 0
		leave
		retn
sub_41BFC3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C08C	proc near		; DATA XREF: sub_41C0B8+ABo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	eax, 0
		leave
		retn
sub_41C08C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C0B8	proc near		; CODE XREF: sub_419F50+29p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41A1F1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41C0DA
		mov	eax, [ebp+var_C]
		jmp	locret_41C1CA
; ---------------------------------------------------------------------------

loc_41C0DA:				; CODE XREF: sub_41C0B8+18j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 4
		mov	[esp+48h+var_48], eax
		call	assuan_get_flag
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+var_44], 4
		mov	[esp+48h+var_48], eax
		call	assuan_set_flag
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	edx, [ebp+arg_10]
		mov	[esp+48h+var_2C], edx
		mov	[esp+48h+var_30], offset sub_41BFC3
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_34], edx
		mov	[esp+48h+var_38], offset sub_41B03B
		mov	edx, [ebp+arg_10]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset sub_41C08C
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 4
		mov	[esp+48h+var_48], eax
		call	assuan_set_flag
		cmp	[ebp+var_C], 0
		jz	short loc_41C1B7
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41A11C
		jmp	short locret_41C1CA
; ---------------------------------------------------------------------------

loc_41C1B7:				; CODE XREF: sub_41C0B8+E9j
		mov	[esp+48h+var_44], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41A11C

locret_41C1CA:				; CODE XREF: sub_41C0B8+1Dj
					; sub_41C0B8+FDj
		leave
		retn
sub_41C0B8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C1CC	proc near		; CODE XREF: sub_41C1F3+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41C1EC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_41C1F1
; ---------------------------------------------------------------------------

loc_41C1EC:				; CODE XREF: sub_41C1CC+7j
		mov	eax, 0

loc_41C1F1:				; CODE XREF: sub_41C1CC+1Ej
		pop	ebp
		retn
sub_41C1CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C1F3	proc near		; CODE XREF: sub_41C21B+Ep
					; sub_41C2B8+189p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_41C1CC
		leave
		retn
sub_41C1F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C20E	proc near		; CODE XREF: sub_41C76B+39p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_41C20E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C21B	proc near		; CODE XREF: sub_41C230+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_41C1F3
		leave
		retn
sub_41C21B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C230	proc near		; CODE XREF: sub_41C2B8+A9p
					; sub_41C501+140p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_41C21B
		leave
		retn
sub_41C230	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C23D	proc near		; CODE XREF: sub_41C8BC+584p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_41C25E
; ---------------------------------------------------------------------------

loc_41C245:				; CODE XREF: sub_41C23D+25j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax

loc_41C25E:				; CODE XREF: sub_41C23D+6j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41C245
		leave
		retn
sub_41C23D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C266	proc near		; CODE XREF: sub_41C8BC+58Fp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_41C287
; ---------------------------------------------------------------------------

loc_41C26E:				; CODE XREF: sub_41C266+25j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax

loc_41C287:				; CODE XREF: sub_41C266+6j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41C26E
		leave
		retn
sub_41C266	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C28F	proc near		; CODE XREF: sub_41C8BC+59Ap

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_41C2B0
; ---------------------------------------------------------------------------

loc_41C297:				; CODE XREF: sub_41C28F+25j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax

loc_41C2B0:				; CODE XREF: sub_41C28F+6j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41C297
		leave
		retn
sub_41C28F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C2B8(int, char *)
sub_41C2B8	proc near		; DATA XREF: sub_41C8BC+9Eo

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_41C4F7
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+48h+var_30], 0
		mov	[esp+48h+var_34], offset a0 ; "0"
		mov	[esp+48h+var_38], offset a0 ; "0"
		mov	[esp+48h+var_3C], offset aK ; "k"
		mov	[esp+48h+var_40], offset aLearncard ; "learncard"
		mov	[esp+48h+Source], offset aProgress ; "PROGRESS"
		mov	[esp+48h+Dest],	eax
		call	sub_405B8B
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_41C4FA
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 10h
		mov	[esp+48h+Source], eax
		mov	[esp+48h+Dest],	1
		call	gcry_calloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41C373
		call	sub_41C230
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		jmp	loc_41C4FB
; ---------------------------------------------------------------------------

loc_41C373:				; CODE XREF: sub_41C2B8+A7j
		mov	eax, [ebp+var_14]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Source], eax ;	Source
		mov	[esp+48h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_14]
		add	eax, 0Ch
		mov	[ebp+var_C], eax
		jmp	short loc_41C397
; ---------------------------------------------------------------------------

loc_41C393:				; CODE XREF: sub_41C2B8+F1j
					; sub_41C2B8+105j ...
		add	[ebp+var_C], 1

loc_41C397:				; CODE XREF: sub_41C2B8+D9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41C3AB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41C393

loc_41C3AB:				; CODE XREF: sub_41C2B8+E7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41C3BF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41C393

loc_41C3BF:				; CODE XREF: sub_41C2B8+FBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41C3D3
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_41C393

loc_41C3D3:				; CODE XREF: sub_41C2B8+10Fj
		mov	eax, [ebp+var_14]
		add	eax, 0Ch
		cmp	eax, [ebp+var_C]
		jnz	short loc_41C412
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 58h
		jnz	short loc_41C412
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41C402
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_41C412

loc_41C402:				; CODE XREF: sub_41C2B8+13Bj
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+4], 1
		add	[ebp+var_C], 1
		jmp	short loc_41C45E
; ---------------------------------------------------------------------------

loc_41C412:				; CODE XREF: sub_41C2B8+124j
					; sub_41C2B8+12Ej ...
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		add	eax, 0Ch
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 28h
		jnz	short loc_41C43A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41C45E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41C45E

loc_41C43A:				; CODE XREF: sub_41C2B8+16Cj
		mov	[esp+48h+Dest],	4Ch
		call	sub_41C1F3
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		jmp	loc_41C4FB
; ---------------------------------------------------------------------------

loc_41C45E:				; CODE XREF: sub_41C2B8+158j
					; sub_41C2B8+176j ...
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		jmp	short loc_41C46E
; ---------------------------------------------------------------------------

loc_41C46A:				; CODE XREF: sub_41C2B8+1BEj
					; sub_41C2B8+1C8j
		add	[ebp+var_C], 1

loc_41C46E:				; CODE XREF: sub_41C2B8+1B0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41C46A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41C46A
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		jmp	short loc_41C491
; ---------------------------------------------------------------------------

loc_41C48D:				; CODE XREF: sub_41C2B8+1F5j
		add	[ebp+var_C], 1

loc_41C491:				; CODE XREF: sub_41C2B8+1D3j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41C4AF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41C4AF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_41C48D

loc_41C4AF:				; CODE XREF: sub_41C2B8+1E1j
					; sub_41C2B8+1EBj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_41C4DB
		mov	[esp+48h+Dest],	4Ch
		call	sub_41C1F3
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		jmp	short loc_41C4FB
; ---------------------------------------------------------------------------

loc_41C4DB:				; CODE XREF: sub_41C2B8+200j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+8], edx
		jmp	short loc_41C4FB
; ---------------------------------------------------------------------------

loc_41C4F7:				; CODE XREF: sub_41C2B8+15j
		nop
		jmp	short loc_41C4FB
; ---------------------------------------------------------------------------

loc_41C4FA:				; CODE XREF: sub_41C2B8+68j
		nop

loc_41C4FB:				; CODE XREF: sub_41C2B8+B6j
					; sub_41C2B8+1A1j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_41C2B8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C501(int, char *)
sub_41C501	proc near		; DATA XREF: sub_41C8BC+8Fo

Str		= dword	ptr -58h
EndPtr		= dword	ptr -54h
Radix		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
Source		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_41C684
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+58h+var_40], 0
		mov	[esp+58h+var_44], offset a0 ; "0"
		mov	[esp+58h+var_48], offset a0 ; "0"
		mov	[esp+58h+var_4C], offset aC ; "c"
		mov	[esp+58h+Radix], offset	aLearncard ; "learncard"
		mov	[esp+58h+EndPtr], offset aProgress ; "PROGRESS"
		mov	[esp+58h+Str], eax
		call	sub_405B8B
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_41C687
		mov	[esp+58h+Radix], 0Ah ; Radix
		lea	eax, [ebp+Source]
		mov	[esp+58h+EndPtr], eax ;	EndPtr
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_14], eax
		jmp	short loc_41C597
; ---------------------------------------------------------------------------

loc_41C58E:				; CODE XREF: sub_41C501+9Ej
					; sub_41C501+A8j
		mov	eax, [ebp+Source]
		add	eax, 1
		mov	[ebp+Source], eax

loc_41C597:				; CODE XREF: sub_41C501+8Bj
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41C58E
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_41C58E
		mov	eax, [ebp+Source]
		mov	[ebp+var_C], eax
		jmp	short loc_41C5B7
; ---------------------------------------------------------------------------

loc_41C5B3:				; CODE XREF: sub_41C501+D2j
		add	[ebp+var_C], 1

loc_41C5B7:				; CODE XREF: sub_41C501+B0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41C5D5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_41C5D5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_41C5B3

loc_41C5D5:				; CODE XREF: sub_41C501+BEj
					; sub_41C501+C8j
		mov	eax, [ebp+Source]
		cmp	eax, [ebp+var_C]
		jz	short loc_41C5E7
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41C600

loc_41C5E7:				; CODE XREF: sub_41C501+DAj
		mov	[esp+58h+Str], 4Ch
		call	sub_41C1F3
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		jmp	loc_41C688
; ---------------------------------------------------------------------------

loc_41C600:				; CODE XREF: sub_41C501+E4j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Source]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 10h
		mov	[esp+58h+EndPtr], eax
		mov	[esp+58h+Str], 1
		call	gcry_calloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41C650
		call	sub_41C230
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		jmp	short loc_41C688
; ---------------------------------------------------------------------------

loc_41C650:				; CODE XREF: sub_41C501+13Ej
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax+4], edx
		mov	eax, [ebp+Source]
		mov	edx, [ebp+var_18]
		add	edx, 0Ch
		mov	[esp+58h+EndPtr], eax ;	Source
		mov	[esp+58h+Str], edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx
		jmp	short loc_41C688
; ---------------------------------------------------------------------------

loc_41C684:				; CODE XREF: sub_41C501+15j
		nop
		jmp	short loc_41C688
; ---------------------------------------------------------------------------

loc_41C687:				; CODE XREF: sub_41C501+68j
		nop

loc_41C688:				; CODE XREF: sub_41C501+FAj
					; sub_41C501+14Dj ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_41C501	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C68E(int, void *, size_t, char *Source)
sub_41C68E	proc near		; DATA XREF: sub_41C8BC+80o

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
Source		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41C764
		mov	eax, [ebp+Source]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+arg_8]
		add	eax, 0Dh
		mov	[esp+38h+Src], eax
		mov	[esp+38h+Dst], 1
		call	gcry_calloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41C6F4
		call	sub_41C230
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		jmp	short loc_41C765
; ---------------------------------------------------------------------------

loc_41C6F4:				; CODE XREF: sub_41C68E+56j
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	ecx, [ebp+arg_8]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+Source]
		mov	[esp+38h+Src], edx ; Source
		mov	[esp+38h+Dst], eax ; Dest
		call	strcpy
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+4], edx
		jmp	short loc_41C765
; ---------------------------------------------------------------------------

loc_41C764:				; CODE XREF: sub_41C68E+14j
		nop

loc_41C765:				; CODE XREF: sub_41C68E+64j
					; sub_41C68E+D4j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_41C68E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C76B	proc near		; CODE XREF: sub_41C8BC+1D2p
					; sub_41C8BC+544p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41BA31
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_41C828
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_41C20E
		cmp	eax, 1Bh
		jz	short loc_41C7B3
		cmp	eax, 76h
		jnz	short loc_41C7BC

loc_41C7B3:				; CODE XREF: sub_41C76B+41j
		mov	[ebp+var_10], offset aIgnored ;	" - ignored"
		jmp	short loc_41C7C4
; ---------------------------------------------------------------------------

loc_41C7BC:				; CODE XREF: sub_41C76B+46j
		mov	[ebp+var_10], offset byte_4451F4
		nop

loc_41C7C4:				; CODE XREF: sub_41C76B+4Fj
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jnz	short loc_41C7D7
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41C80F

loc_41C7D7:				; CODE XREF: sub_41C76B+60j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	edx, eax
		cmp	dword ptr [ebp+arg_4], 0
		jz	short loc_41C7EF
		mov	eax, dword ptr [ebp+arg_4]
		jmp	short loc_41C7F4
; ---------------------------------------------------------------------------

loc_41C7EF:				; CODE XREF: sub_41C76B+7Dj
		mov	eax, offset a?	; "?"

loc_41C7F4:				; CODE XREF: sub_41C76B+82j
		mov	ecx, [ebp+var_10]
		mov	[esp+28h+var_1C], ecx
		mov	[esp+28h+var_20], edx
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorReadingCe ; "error reading certificate `%s': %s%s\n"
		call	sub_435B53

loc_41C80F:				; CODE XREF: sub_41C76B+6Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41C81E
		mov	eax, [ebp+var_C]
		jmp	short loc_41C823
; ---------------------------------------------------------------------------

loc_41C81E:				; CODE XREF: sub_41C76B+ACj
		mov	eax, 0

loc_41C823:				; CODE XREF: sub_41C76B+B1j
		jmp	locret_41C8BA
; ---------------------------------------------------------------------------

loc_41C828:				; CODE XREF: sub_41C76B+2Dj
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], edx
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_41C873
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax

loc_41C873:				; CODE XREF: sub_41C76B+E8j
		cmp	[ebp+var_C], 0
		jnz	short loc_41C88F
		mov	dword ptr [esp+28h+var_24], offset off_44521E
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	assuan_write_line
		mov	[ebp+var_C], eax

loc_41C88F:				; CODE XREF: sub_41C76B+10Cj
		cmp	[ebp+var_C], 0
		jz	short loc_41C8B5
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aSendingCertifi ; "sending certificate	failed:	%s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_C]
		jmp	short locret_41C8BA
; ---------------------------------------------------------------------------

loc_41C8B5:				; CODE XREF: sub_41C76B+128j
		mov	eax, 0

locret_41C8BA:				; CODE XREF: sub_41C76B:loc_41C823j
					; sub_41C76B+148j
		leave
		retn
sub_41C76B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C8BC	proc near		; CODE XREF: sub_407C84+3Fp

Str1		= dword	ptr -98h
Str2		= dword	ptr -94h
Size		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
Str		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	dword ptr [ebp+var_50],	0
		lea	eax, [ebp+var_38]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		lea	eax, [ebp+var_44]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		lea	eax, [ebp+var_4C]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_44], eax
		lea	eax, [ebp+var_50]
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_41AF53
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41CE28
		lea	eax, [ebp+var_4C]
		mov	[esp+98h+var_80], eax
		mov	[esp+98h+var_84], offset sub_41C68E
		lea	eax, [ebp+var_44]
		mov	[esp+98h+var_88], eax
		mov	[esp+98h+var_8C], offset sub_41C501
		lea	eax, [ebp+var_38]
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+Str2],	offset sub_41C2B8
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_41ACE2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41C9A9
		mov	eax, [ebp+var_34]
		test	eax, eax
		jnz	short loc_41C98B
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_41C98B
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_41C9A9

loc_41C98B:				; CODE XREF: sub_41C8BC+BFj
					; sub_41C8BC+C6j
		mov	eax, [ebp+var_34]
		test	eax, eax
		jz	short loc_41C997
		mov	eax, [ebp+var_34]
		jmp	short loc_41C9A6
; ---------------------------------------------------------------------------

loc_41C997:				; CODE XREF: sub_41C8BC+D4j
		mov	eax, [ebp+var_40]
		test	eax, eax
		jz	short loc_41C9A3
		mov	eax, [ebp+var_40]
		jmp	short loc_41C9A6
; ---------------------------------------------------------------------------

loc_41C9A3:				; CODE XREF: sub_41C8BC+E0j
		mov	eax, [ebp+var_4C]

loc_41C9A6:				; CODE XREF: sub_41C8BC+D9j
					; sub_41C8BC+E5j
		mov	[ebp+var_C], eax

loc_41C9A9:				; CODE XREF: sub_41C8BC+B8j
					; sub_41C8BC+CDj
		cmp	[ebp+var_C], 0
		jz	short loc_41C9CF
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Str1],	eax
		call	gpg_strerror
		mov	[esp+98h+Str2],	eax ; char
		mov	[esp+98h+Str1],	offset aAgent_card_lea ; "agent_card_learn failed: %s\n"
		call	sub_435C1A
		jmp	loc_41CE2F
; ---------------------------------------------------------------------------

loc_41C9CF:				; CODE XREF: sub_41C8BC+F1j
		mov	eax, dword ptr [ebp+var_50]
		mov	[esp+98h+Str2],	eax ; char
		mov	[esp+98h+Str1],	offset aCardHasSNS ; "card has S/N: %s\n"
		call	sub_435B53
		cmp	[ebp+arg_4], 0
		jz	short loc_41CA1D
		mov	eax, [ebp+var_48]
		mov	[ebp+var_14], eax
		jmp	short loc_41CA17
; ---------------------------------------------------------------------------

loc_41C9F0:				; CODE XREF: sub_41C8BC+15Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		add	edx, 8
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+Str2],	edx
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+Str1],	eax
		call	assuan_write_status
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_41CA17:				; CODE XREF: sub_41C8BC+132j
		cmp	[ebp+var_14], 0
		jnz	short loc_41C9F0

loc_41CA1D:				; CODE XREF: sub_41C8BC+12Aj
		mov	[ebp+var_1C], 0
		jmp	loc_41CAC3
; ---------------------------------------------------------------------------

loc_41CA29:				; CODE XREF: sub_41C8BC+214j
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_20], eax
		jmp	loc_41CAB5
; ---------------------------------------------------------------------------

loc_41CA34:				; CODE XREF: sub_41C8BC+1FDj
		mov	eax, [ebp+var_1C]
		mov	edx, dword_43D800[eax*4]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_41CAAC
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_41CA71
		mov	eax, [ebp+var_20]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_20]
		add	edx, 0Ch
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+Str2],	edx ; char
		mov	[esp+98h+Str1],	offset aIdSTypeD ; "	      id: %s	(type=%d)\n"
		call	sub_435B53

loc_41CA71:				; CODE XREF: sub_41C8BC+193j
		cmp	[ebp+arg_4], 0
		jz	short loc_41CAAD
		mov	eax, [ebp+var_20]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+Str2],	edx
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_41C76B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41CE2B
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+8], 1
		jmp	short loc_41CAAD
; ---------------------------------------------------------------------------

loc_41CAAC:				; CODE XREF: sub_41C8BC+18Aj
		nop

loc_41CAAD:				; CODE XREF: sub_41C8BC+1B9j
					; sub_41C8BC+1EEj
		mov	eax, [ebp+var_20]
		mov	eax, [eax]
		mov	[ebp+var_20], eax

loc_41CAB5:				; CODE XREF: sub_41C8BC+173j
		cmp	[ebp+var_20], 0
		jnz	loc_41CA34
		add	[ebp+var_1C], 1

loc_41CAC3:				; CODE XREF: sub_41C8BC+168j
		mov	eax, [ebp+var_1C]
		mov	eax, dword_43D800[eax*4]
		cmp	eax, 0FFFFFFFFh
		jnz	loc_41CA29
		mov	eax, [ebp+var_30]
		mov	[ebp+var_10], eax
		jmp	loc_41CE1C
; ---------------------------------------------------------------------------

loc_41CAE1:				; CODE XREF: sub_41C8BC+564j
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_41CB0A
		mov	eax, [ebp+var_10]
		lea	edx, [eax+0Ch]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+98h+Size],	edx
		mov	[esp+98h+Str2],	eax ; char
		mov	[esp+98h+Str1],	offset aIdSGripS ; "	      id: %s	(grip=%s)\n"
		call	sub_435B53

loc_41CB0A:				; CODE XREF: sub_41C8BC+22Cj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_41CE10
		cmp	[ebp+arg_4], 0
		jz	short loc_41CB4D
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_10]
		add	edx, 0Ch
		mov	[esp+98h+var_88], 0
		mov	[esp+98h+var_8C], eax
		mov	[esp+98h+Size],	edx
		mov	[esp+98h+Str2],	offset aKeypairinfo_0 ;	"KEYPAIRINFO"
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_405B8B

loc_41CB4D:				; CODE XREF: sub_41C8BC+260j
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[ebp+var_18], eax
		mov	[ebp+var_1C], 0
		jmp	loc_41CBFF
; ---------------------------------------------------------------------------

loc_41CB62:				; CODE XREF: sub_41C8BC+347j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41CB7F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41CBAB
; ---------------------------------------------------------------------------

loc_41CB7F:				; CODE XREF: sub_41C8BC+2AEj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41CB9A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41CBA9
; ---------------------------------------------------------------------------

loc_41CB9A:				; CODE XREF: sub_41C8BC+2CBj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41CBA9:				; CODE XREF: sub_41C8BC+2DCj
		mov	edx, eax

loc_41CBAB:				; CODE XREF: sub_41C8BC+2C1j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41CBC6
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_41CBED
; ---------------------------------------------------------------------------

loc_41CBC6:				; CODE XREF: sub_41C8BC+2FAj
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41CBE1
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_41CBED
; ---------------------------------------------------------------------------

loc_41CBE1:				; CODE XREF: sub_41C8BC+315j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_41CBED:				; CODE XREF: sub_41C8BC+308j
					; sub_41C8BC+323j
		add	edx, eax
		lea	eax, [ebp+var_64]
		add	eax, [ebp+var_1C]
		mov	[eax], dl
		add	[ebp+var_18], 2
		add	[ebp+var_1C], 1

loc_41CBFF:				; CODE XREF: sub_41C8BC+2A1j
		cmp	[ebp+var_1C], 13h
		jle	loc_41CB62
		lea	eax, [ebp+var_64]
		mov	[esp+98h+Str1],	eax
		call	sub_413151
		test	eax, eax
		jz	loc_41CE13
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		lea	edx, [ebp+var_68]
		mov	[esp+98h+Size],	edx
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_41BB7D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41CC61
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Str1],	eax
		call	gpg_strerror
		mov	[esp+98h+Str2],	eax ; char
		mov	[esp+98h+Str1],	offset aAgent_card_rea ; "agent_card_readkey failed: %s\n"
		call	sub_435C1A
		jmp	loc_41CE2F
; ---------------------------------------------------------------------------

loc_41CC61:				; CODE XREF: sub_41C8BC+383j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, dword ptr [ebp+var_50]
		mov	[esp+98h+Str2],	edx
		mov	[esp+98h+Str1],	eax
		call	sub_41738E
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_41CC9E
		mov	[esp+98h+Str1],	8056h
		call	sub_41C1F3
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_68]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		jmp	loc_41CE2F
; ---------------------------------------------------------------------------

loc_41CC9E:				; CODE XREF: sub_41C8BC+3C1j
		mov	eax, [ebp+var_68]
		lea	edx, [ebp+Str]
		mov	[esp+98h+Size],	edx ; int
		mov	edx, [ebp+var_28]
		mov	[esp+98h+Str2],	edx ; void *
		mov	[esp+98h+Str1],	eax ; int
		call	sub_417585
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_28]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_68]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_41CCF6
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Str1],	eax
		call	gpg_strerror
		mov	[esp+98h+Str2],	eax ; char
		mov	[esp+98h+Str1],	offset aShadowingThe_0 ; "shadowing the	key failed: %s\n"
		call	sub_435B7D
		jmp	loc_41CE2F
; ---------------------------------------------------------------------------

loc_41CCF6:				; CODE XREF: sub_41C8BC+418j
		mov	eax, [ebp+Str]
		mov	[esp+98h+var_8C], 0
		mov	[esp+98h+Size],	0
		mov	[esp+98h+Str2],	0
		mov	[esp+98h+Str1],	eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_41CD3E
		mov	[esp+98h+Size],	1AFh ; int
		mov	[esp+98h+Str2],	offset a____Gnupg22_10 ; "../../gnupg2-2.0.30/agent/learncard.c"
		mov	[esp+98h+Str1],	offset aN_0 ; "n"
		call	sub_43BB20

loc_41CD3E:				; CODE XREF: sub_41C8BC+464j
		mov	eax, [ebp+Str]
		mov	[esp+98h+var_8C], 0 ; int
		mov	edx, [ebp+var_2C]
		mov	[esp+98h+Size],	edx ; Size
		mov	[esp+98h+Str2],	eax ; char
		lea	eax, [ebp+var_64]
		mov	[esp+98h+Str1],	eax ; int
		call	sub_4118C7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+Str]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_41CD93
		mov	eax, [ebp+var_C]
		mov	[esp+98h+Str1],	eax
		call	gpg_strerror
		mov	[esp+98h+Str2],	eax ; char
		mov	[esp+98h+Str1],	offset aErrorWriting_0 ; "error	writing	key: %s\n"
		call	sub_435B7D
		jmp	loc_41CE2F
; ---------------------------------------------------------------------------

loc_41CD93:				; CODE XREF: sub_41C8BC+4B5j
		mov	eax, ds:dword_449DA4
		test	eax, eax
		jz	short loc_41CDA8
		mov	[esp+98h+Str1],	offset aStored ; "stored\n"
		call	sub_435B53

loc_41CDA8:				; CODE XREF: sub_41C8BC+4DEj
		cmp	[ebp+arg_4], 0
		jz	short loc_41CE14
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_24], eax
		jmp	short loc_41CDDA
; ---------------------------------------------------------------------------

loc_41CDB6:				; CODE XREF: sub_41C8BC+522j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_24]
		add	edx, 0Ch
		mov	[esp+98h+Str2],	eax ; Str2
		mov	[esp+98h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_41CDE2
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		mov	[ebp+var_24], eax

loc_41CDDA:				; CODE XREF: sub_41C8BC+4F8j
		cmp	[ebp+var_24], 0
		jnz	short loc_41CDB6
		jmp	short loc_41CDE3
; ---------------------------------------------------------------------------

loc_41CDE2:				; CODE XREF: sub_41C8BC+514j
		nop

loc_41CDE3:				; CODE XREF: sub_41C8BC+524j
		cmp	[ebp+var_24], 0
		jnz	short loc_41CE14
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+arg_4]
		mov	[esp+98h+Size],	edx
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_41C76B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41CE2E
		jmp	short loc_41CE14
; ---------------------------------------------------------------------------

loc_41CE10:				; CODE XREF: sub_41C8BC+256j
		nop
		jmp	short loc_41CE14
; ---------------------------------------------------------------------------

loc_41CE13:				; CODE XREF: sub_41C8BC+35Aj
		nop

loc_41CE14:				; CODE XREF: sub_41C8BC+4F0j
					; sub_41C8BC+52Bj ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_41CE1C:				; CODE XREF: sub_41C8BC+220j
		cmp	[ebp+var_10], 0
		jnz	loc_41CAE1
		jmp	short loc_41CE2F
; ---------------------------------------------------------------------------

loc_41CE28:				; CODE XREF: sub_41C8BC+73j
		nop
		jmp	short loc_41CE2F
; ---------------------------------------------------------------------------

loc_41CE2B:				; CODE XREF: sub_41C8BC+1DEj
		nop
		jmp	short loc_41CE2F
; ---------------------------------------------------------------------------

loc_41CE2E:				; CODE XREF: sub_41C8BC+550j
		nop

loc_41CE2F:				; CODE XREF: sub_41C8BC+10Ej
					; sub_41C8BC+3A0j ...
		mov	eax, dword ptr [ebp+var_50]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_30]
		mov	[esp+98h+Str1],	eax
		call	sub_41C23D
		mov	eax, [ebp+var_3C]
		mov	[esp+98h+Str1],	eax
		call	sub_41C266
		mov	eax, [ebp+var_48]
		mov	[esp+98h+Str1],	eax
		call	sub_41C28F
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41C8BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41CE60	proc near		; CODE XREF: sub_41CE87+14p
					; sub_41DB37+185p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41CE80
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_41CE85
; ---------------------------------------------------------------------------

loc_41CE80:				; CODE XREF: sub_41CE60+7j
		mov	eax, 0

loc_41CE85:				; CODE XREF: sub_41CE60+1Ej
		pop	ebp
		retn
sub_41CE60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41CE87	proc near		; CODE XREF: sub_41CEA2+Ep
					; .text:0041D47Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_41CE60
		leave
		retn
sub_41CE87	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41CEA2	proc near		; CODE XREF: sub_41D153+ECp
					; .text:0041D870p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_41CE87
		leave
		retn
sub_41CEA2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41CEB7	proc near		; CODE XREF: .text:0041CEECp
					; sub_41CF97+6p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0FFFFFFFFh
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_41CED1
		mov	[ebp+var_4], 100h

loc_41CED1:				; CODE XREF: sub_41CEB7+11j
		cmp	[ebp+var_4], 7FFFFFFFh
		jnz	short loc_41CEE1
		mov	[ebp+var_4], 100h

loc_41CEE1:				; CODE XREF: sub_41CEB7+21j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_41CEB7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_41CEB7
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_41CF69
		mov	dword ptr [ebp-14h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_41CF5F
; ---------------------------------------------------------------------------

loc_41CF09:				; CODE XREF: .text:0041CF65j
		mov	eax, [ebp-14h]
		mov	[ebp-10h], eax
		jmp	short loc_41CF30
; ---------------------------------------------------------------------------

loc_41CF11:				; CODE XREF: .text:0041CF3Ej
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, [ebp-0Ch]
		jnz	short loc_41CF2C
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-14h], eax
		jmp	short loc_41CF40
; ---------------------------------------------------------------------------

loc_41CF2C:				; CODE XREF: .text:0041CF1Fj
		add	dword ptr [ebp-10h], 1

loc_41CF30:				; CODE XREF: .text:0041CF0Fj
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41CF11

loc_41CF40:				; CODE XREF: .text:0041CF2Aj
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41CF5B
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	_close

loc_41CF5B:				; CODE XREF: .text:0041CF4Ej
		add	dword ptr [ebp-0Ch], 1

loc_41CF5F:				; CODE XREF: .text:0041CF07j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp-18h]
		jl	short loc_41CF09
		jmp	short loc_41CF88
; ---------------------------------------------------------------------------

loc_41CF69:				; CODE XREF: .text:0041CEF8j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_41CF80
; ---------------------------------------------------------------------------

loc_41CF71:				; CODE XREF: .text:0041CF86j
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	_close
		add	dword ptr [ebp-0Ch], 1

loc_41CF80:				; CODE XREF: .text:0041CF6Fj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp-18h]
		jl	short loc_41CF71

loc_41CF88:				; CODE XREF: .text:0041CF67j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41CF97	proc near		; CODE XREF: sub_402066+AEp

NumOfElements	= dword	ptr -68h
SizeOfElements	= dword	ptr -64h
var_50		= byte ptr -50h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		call	sub_41CEB7
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 20h
		mov	[esp+68h+SizeOfElements], 4 ; SizeOfElements
		mov	eax, [ebp+var_10]
		mov	[esp+68h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_41CFD2
		mov	eax, 0
		jmp	locret_41D099
; ---------------------------------------------------------------------------

loc_41CFD2:				; CODE XREF: sub_41CF97+2Fj
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		jmp	loc_41D07B
; ---------------------------------------------------------------------------

loc_41CFE5:				; CODE XREF: sub_41CF97+EAj
		lea	eax, [ebp+var_50]
		mov	[esp+68h+SizeOfElements], eax
		mov	eax, [ebp+var_14]
		mov	[esp+68h+NumOfElements], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41D00C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 9
		jz	short loc_41D077

loc_41D00C:				; CODE XREF: sub_41CF97+65j
		mov	eax, [ebp+var_18]
		add	eax, 1
		cmp	eax, [ebp+var_10]
		jb	short loc_41D065
		cmp	[ebp+var_10], 0FFh
		ja	short loc_41D027
		mov	eax, 20h
		jmp	short loc_41D02C
; ---------------------------------------------------------------------------

loc_41D027:				; CODE XREF: sub_41CF97+87j
		mov	eax, 100h

loc_41D02C:				; CODE XREF: sub_41CF97+8Ej
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		shl	eax, 2
		mov	[esp+68h+SizeOfElements], eax ;	NewSize
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	realloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_41D05F
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free
		mov	eax, 0
		jmp	short locret_41D099
; ---------------------------------------------------------------------------

loc_41D05F:				; CODE XREF: sub_41CF97+B4j
		mov	eax, [ebp+var_20]
		mov	[ebp+Memory], eax

loc_41D065:				; CODE XREF: sub_41CF97+7Ej
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, [ebp+Memory]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		add	[ebp+var_18], 1

loc_41D077:				; CODE XREF: sub_41CF97+73j
		add	[ebp+var_14], 1

loc_41D07B:				; CODE XREF: sub_41CF97+49j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_1C]
		jl	loc_41CFE5
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+Memory]

locret_41D099:				; CODE XREF: sub_41CF97+36j
					; sub_41CF97+C6j
		leave
		retn
sub_41CF97	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D09B(int, char *)
sub_41D09B	proc near		; CODE XREF: sub_41D153+100p
					; sub_41D153+130p

Str		= dword	ptr -28h
Control		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D0C6
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	2222h
		mov	byte ptr [eax+2], 0
		add	[ebp+var_C], 2
		jmp	loc_41D14E
; ---------------------------------------------------------------------------

loc_41D0C6:				; CODE XREF: sub_41D09B+14j
		mov	[esp+28h+Control], offset asc_445348 ; " \t\n\v"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strpbrk
		test	eax, eax
		jz	short loc_41D139
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_41D11D
; ---------------------------------------------------------------------------

loc_41D0F1:				; CODE XREF: sub_41D09B+8Aj
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_41D119
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_41D119:				; CODE XREF: sub_41D09B+6Dj
		add	[ebp+var_10], 1

loc_41D11D:				; CODE XREF: sub_41D09B+54j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D0F1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		jmp	short loc_41D14E
; ---------------------------------------------------------------------------

loc_41D139:				; CODE XREF: sub_41D09B+40j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Control], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_433245
		mov	[ebp+var_C], eax

loc_41D14E:				; CODE XREF: sub_41D09B+26j
					; sub_41D09B+9Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41D09B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D153(char *, int, int)
sub_41D153	proc near		; CODE XREF: .text:0041D626p
					; sub_41D8C8+69p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_41D1AE
; ---------------------------------------------------------------------------

loc_41D19C:				; CODE XREF: sub_41D153+63j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_41D1AA
		add	[ebp+var_10], 1

loc_41D1AA:				; CODE XREF: sub_41D153+51j
		add	[ebp+var_14], 1

loc_41D1AE:				; CODE XREF: sub_41D153+47j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D19C
		mov	[ebp+var_C], 0
		jmp	short loc_41D20D
; ---------------------------------------------------------------------------

loc_41D1C1:				; CODE XREF: sub_41D153+CCj
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_41D1FF
; ---------------------------------------------------------------------------

loc_41D1ED:				; CODE XREF: sub_41D153+B4j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_41D1FB
		add	[ebp+var_10], 1

loc_41D1FB:				; CODE XREF: sub_41D153+A2j
		add	[ebp+var_14], 1

loc_41D1FF:				; CODE XREF: sub_41D153+98j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D1ED
		add	[ebp+var_C], 1

loc_41D20D:				; CODE XREF: sub_41D153+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41D1C1
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_41D246
		call	sub_41CEA2
		jmp	short loc_41D2AB
; ---------------------------------------------------------------------------

loc_41D246:				; CODE XREF: sub_41D153+EAj
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_41D09B
		mov	[ebp+var_18], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41D28F
; ---------------------------------------------------------------------------

loc_41D264:				; CODE XREF: sub_41D153+149j
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	20h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_41D09B
		mov	[ebp+var_18], eax
		add	[ebp+var_C], 1

loc_41D28F:				; CODE XREF: sub_41D153+10Fj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D264
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, 0

loc_41D2AB:				; CODE XREF: sub_41D153+F1j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_41D153	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D2B1	proc near		; CODE XREF: .text:0041D48Cp
					; .text:0041D645p

hReadPipe	= dword	ptr -48h
hWritePipe	= dword	ptr -44h
lpPipeAttributes= dword	ptr -40h
nSize		= dword	ptr -3Ch
dwDesiredAccess	= dword	ptr -38h
bInheritHandle	= dword	ptr -34h
dwOptions	= dword	ptr -30h
PipeAttributes	= _SECURITY_ATTRIBUTES ptr -20h
TargetHandle	= dword	ptr -14h
hSourceHandle	= dword	ptr -10h
hObject		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 40h
		lea	eax, [ebp+PipeAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+PipeAttributes.nLength], 0Ch
		mov	[ebp+PipeAttributes.bInheritHandle], 0
		mov	[esp+48h+nSize], 0 ; nSize
		lea	eax, [ebp+PipeAttributes]
		mov	[esp+48h+lpPipeAttributes], eax	; lpPipeAttributes
		lea	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hWritePipe], eax ; hWritePipe
		lea	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hReadPipe
		mov	eax, ds:CreatePipe
		call	eax ; CreatePipe
		sub	esp, 10h
		test	eax, eax
		jnz	short loc_41D312
		mov	eax, 0FFFFFFFFh
		jmp	loc_41D3D0
; ---------------------------------------------------------------------------

loc_41D312:				; CODE XREF: sub_41D2B1+55j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	esi, [ebp+hSourceHandle]
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+48h+dwOptions], 2 ; dwOptions
		mov	[esp+48h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+48h+dwDesiredAccess], 0 ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+48h+nSize], edx ; lpTargetHandle
		mov	[esp+48h+lpPipeAttributes], ebx	; hTargetProcessHandle
		mov	[esp+48h+hWritePipe], esi ; hSourceHandle
		mov	[esp+48h+hReadPipe], eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_41D3A0
		mov	[esp+48h+hReadPipe], 0FFFFFFFFh	; DWORD
		call	sub_432EA2
		mov	[esp+48h+hWritePipe], eax ; char
		mov	[esp+48h+hReadPipe], offset aDuplicatehandl ; "DuplicateHandle failed: %s\n"
		call	sub_435B7D
		mov	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41D3D0
; ---------------------------------------------------------------------------

loc_41D3A0:				; CODE XREF: sub_41D2B1+AAj
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+TargetHandle]
		mov	[ebp+hSourceHandle], eax
		mov	eax, [ebp+hObject]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+4]
		mov	eax, [ebp+hSourceHandle]
		mov	[edx], eax
		mov	eax, 0

loc_41D3D0:				; CODE XREF: sub_41D2B1+5Cj
					; sub_41D2B1+EDj
		lea	esp, [ebp-8]
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_41D2B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D3D7	proc near		; CODE XREF: sub_41D8C8+B5p
					; sub_41D8C8+D1p ...

lpFileName	= dword	ptr -38h
dwDesiredAccess	= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_41D3EA
		mov	eax, 40000000h
		jmp	short loc_41D3EF
; ---------------------------------------------------------------------------

loc_41D3EA:				; CODE XREF: sub_41D3D7+Aj
		mov	eax, 80000000h

loc_41D3EF:				; CODE XREF: sub_41D3D7+11j
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	0 ; dwFlagsAndAttributes
		mov	[esp+38h+dwCreationDisposition], 3 ; dwCreationDisposition
		mov	[esp+38h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	[esp+38h+dwShareMode], 3 ; dwShareMode
		mov	[esp+38h+dwDesiredAccess], eax ; dwDesiredAccess
		mov	[esp+38h+lpFileName], offset FileName ;	"nul"
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41D451
		mov	[esp+38h+lpFileName], 0FFFFFFFFh ; DWORD
		call	sub_432EA2
		mov	[esp+38h+dwDesiredAccess], eax ; char
		mov	[esp+38h+lpFileName], offset aCanTOpenNulS ; "can't open `nul': %s\n"
		call	sub_435C1A

loc_41D451:				; CODE XREF: sub_41D3D7+5Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41D3D7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		add	eax, 4
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	dword ptr [esp], 1
		call	sub_41CE87
		mov	[ebp-0Ch], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_41D2B1
		test	eax, eax
		jnz	loc_41D54E
		mov	eax, [ebp-14h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	edx, [ebp+8]
		mov	[edx], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41D4E2
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTransl	; "failed to translate osfhandle %p\n"
		call	sub_435B7D
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_41D54E
; ---------------------------------------------------------------------------

loc_41D4E2:				; CODE XREF: .text:0041D4BBj
		mov	eax, [ebp+8]
		lea	ebx, [eax+4]
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebx], eax
		mov	eax, [ebp+8]
		add	eax, 4
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41D547
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTransl	; "failed to translate osfhandle %p\n"
		call	sub_435B7D
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp], eax
		call	_close
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_41D54E
; ---------------------------------------------------------------------------

loc_41D547:				; CODE XREF: .text:0041D50Aj
		mov	dword ptr [ebp-0Ch], 0

loc_41D54E:				; CODE XREF: .text:0041D493j
					; .text:0041D4E0j ...
		mov	eax, [ebp-0Ch]
		mov	ebx, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	dword ptr [ebp-38h], 0
		mov	dword ptr [ebp-34h], 0
		mov	dword ptr [ebp-30h], 0
		mov	dword ptr [ebp-2Ch], 0
		mov	eax, [ebp+20h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+24h]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	fflush
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	rewind
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	_fileno
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	_fileno
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_41D5E1
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_41D5ED

loc_41D5E1:				; CODE XREF: .text:0041D5D9j
		mov	dword ptr [esp], offset	aNoFileDescript	; "no file descriptor for file passed to g"...
		call	sub_435BC0
; ---------------------------------------------------------------------------

loc_41D5ED:				; CODE XREF: .text:0041D5DFj
		lea	eax, [ebp-28h]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-28h], 0Ch
		mov	dword ptr [ebp-20h], 0
		lea	eax, [ebp-80h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41D153
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_41D63C
		mov	eax, [ebp-14h]
		jmp	loc_41D8C1
; ---------------------------------------------------------------------------

loc_41D63C:				; CODE XREF: .text:0041D632j
		lea	eax, [ebp-88h]
		mov	[esp], eax
		call	sub_41D2B1
		test	eax, eax
		jz	short loc_41D695
		mov	dword ptr [esp], 1
		call	sub_41CE87
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	dword ptr [esp], offset	aErrorCreatingA	; "error creating a pipe: %s\n"
		call	sub_435294
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_435B7D
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-14h]
		jmp	loc_41D8C1
; ---------------------------------------------------------------------------

loc_41D695:				; CODE XREF: .text:0041D64Cj
		lea	eax, [ebp-7Ch]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	dword ptr [ebp-7Ch], 44h
		mov	dword ptr [ebp-50h], 101h
		mov	word ptr [ebp-4Ch], 5
		mov	eax, [ebp-0Ch]
		mov	[ebp-44h], eax
		mov	eax, [ebp-10h]
		mov	[ebp-40h], eax
		mov	eax, [ebp-84h]
		mov	[ebp-3Ch], eax
		mov	eax, [ebp+1Ch]
		and	eax, 80h
		test	eax, eax
		jz	short loc_41D6E6
		mov	ebx, 4000008h
		jmp	short loc_41D6EB
; ---------------------------------------------------------------------------

loc_41D6E6:				; CODE XREF: .text:0041D6DDj
		mov	ebx, 4000000h

loc_41D6EB:				; CODE XREF: .text:0041D6E4j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp], eax
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, ebx
		or	eax, 4
		mov	[ebp-18h], eax
		mov	edx, [ebp-18h]
		mov	eax, [ebp-80h]
		lea	ecx, [ebp-38h]
		mov	[esp+24h], ecx
		lea	ecx, [ebp-7Ch]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 0
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 1
		lea	edx, [ebp-28h]
		mov	[esp+0Ch], edx
		lea	edx, [ebp-28h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_41D7BB
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_432EA2
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCreateprocessF	; "CreateProcess failed: %s\n"
		call	sub_435B7D
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-88h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-84h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	dword ptr [esp], 1
		call	sub_41CE87
		jmp	loc_41D8C1
; ---------------------------------------------------------------------------

loc_41D7BB:				; CODE XREF: .text:0041D75Bj
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	gcry_free
		mov	dword ptr [ebp-80h], 0
		mov	eax, [ebp-84h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+1Ch]
		and	eax, 40h
		test	eax, eax
		jz	short loc_41D7F6
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_41E7E4

loc_41D7F6:				; CODE XREF: .text:0041D7E8j
		mov	eax, [ebp-34h]
		mov	[esp], eax
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp-34h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-88h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jnz	short loc_41D84F
		mov	eax, [ebp-88h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTransl	; "failed to translate osfhandle %p\n"
		call	sub_435B7D
		jmp	short loc_41D867
; ---------------------------------------------------------------------------

loc_41D84F:				; CODE XREF: .text:0041D835j
		mov	dword ptr [esp+4], offset aR_3 ; "r"
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	_fdopen
		mov	edx, [ebp+20h]
		mov	[edx], eax

loc_41D867:				; CODE XREF: .text:0041D84Dj
		mov	eax, [ebp+20h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D8B2
		call	sub_41CEA2
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	dword ptr [esp], offset	aCanTFdopenPipe	; "can't fdopen pipe for reading: %s\n"
		call	sub_435294
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_435B7D
		mov	eax, [ebp-38h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-14h]
		jmp	short loc_41D8C1
; ---------------------------------------------------------------------------

loc_41D8B2:				; CODE XREF: .text:0041D86Ej
		mov	eax, [ebp-38h]
		mov	edx, eax
		mov	eax, [ebp+24h]
		mov	[eax], edx
		mov	eax, 0

loc_41D8C1:				; CODE XREF: .text:0041D637j
					; .text:0041D690j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D8C8(LPCSTR	lpApplicationName, int,	int, int, int, int)
sub_41D8C8	proc near		; CODE XREF: sub_414196+18Ap

hProcess	= dword	ptr -0B8h
lpCommandLine	= dword	ptr -0B4h
lpProcessAttributes= dword ptr -0B0h
lpThreadAttributes= dword ptr -0ACh
bInheritHandles	= dword	ptr -0A8h
dwCreationFlags	= dword	ptr -0A4h
lpEnvironment	= dword	ptr -0A0h
lpCurrentDirectory= dword ptr -9Ch
lpStartupInfo	= dword	ptr -98h
lpProcessInformation= dword ptr	-94h
hObject		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
StartupInfo	= _STARTUPINFOA	ptr -70h
ProcessInformation= _PROCESS_INFORMATION ptr -2Ch
ProcessAttributes= _SECURITY_ATTRIBUTES	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpApplicationName= dword ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	[ebp+ProcessInformation.hProcess], 0
		mov	[ebp+ProcessInformation.hThread], 0
		mov	[ebp+ProcessInformation.dwProcessId], 0
		mov	[ebp+ProcessInformation.dwThreadId], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0FFFFFFFFh
		lea	eax, [ebp+ProcessAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+ProcessAttributes.nLength], 0Ch
		mov	[ebp+ProcessAttributes.bInheritHandle],	0
		lea	eax, [ebp+var_74]
		mov	[esp+0B8h+lpProcessAttributes],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+lpCommandLine], eax ;	int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0B8h+hProcess], eax ; char	*
		call	sub_41D153
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41D947
		mov	eax, [ebp+var_C]
		jmp	loc_41DB30
; ---------------------------------------------------------------------------

loc_41D947:				; CODE XREF: sub_41D8C8+75j
		lea	eax, [ebp+StartupInfo]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+StartupInfo.cb], 44h
		mov	[ebp+StartupInfo.dwFlags], 101h
		mov	[ebp+StartupInfo.wShowWindow], 5
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jnz	short loc_41D984
		mov	[esp+0B8h+hProcess], 0
		call	sub_41D3D7
		jmp	short loc_41D989
; ---------------------------------------------------------------------------

loc_41D984:				; CODE XREF: sub_41D8C8+ACj
		mov	eax, 0FFFFFFFFh

loc_41D989:				; CODE XREF: sub_41D8C8+BAj
		mov	[ebp+hObject], eax
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_41D9A0
		mov	[esp+0B8h+hProcess], 1
		call	sub_41D3D7
		jmp	short loc_41D9A5
; ---------------------------------------------------------------------------

loc_41D9A0:				; CODE XREF: sub_41D8C8+C8j
		mov	eax, 0FFFFFFFFh

loc_41D9A5:				; CODE XREF: sub_41D8C8+D6j
		mov	[ebp+var_7C], eax
		cmp	[ebp+arg_10], 0FFFFFFFFh
		jnz	short loc_41D9BC
		mov	[esp+0B8h+hProcess], 1
		call	sub_41D3D7
		jmp	short loc_41D9C1
; ---------------------------------------------------------------------------

loc_41D9BC:				; CODE XREF: sub_41D8C8+E4j
		mov	eax, 0FFFFFFFFh

loc_41D9C1:				; CODE XREF: sub_41D8C8+F2j
		mov	[ebp+var_78], eax
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jnz	short loc_41D9CF
		mov	eax, [ebp+hObject]
		jmp	short loc_41D9DC
; ---------------------------------------------------------------------------

loc_41D9CF:				; CODE XREF: sub_41D8C8+100j
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+hProcess], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_41D9DC:				; CODE XREF: sub_41D8C8+105j
		mov	[ebp+StartupInfo.hStdInput], eax
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_41D9EA
		mov	eax, [ebp+var_7C]
		jmp	short loc_41D9F7
; ---------------------------------------------------------------------------

loc_41D9EA:				; CODE XREF: sub_41D8C8+11Bj
		mov	eax, [ebp+arg_C]
		mov	[esp+0B8h+hProcess], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_41D9F7:				; CODE XREF: sub_41D8C8+120j
		mov	[ebp+StartupInfo.hStdOutput], eax
		cmp	[ebp+arg_10], 0FFFFFFFFh
		jnz	short loc_41DA05
		mov	eax, [ebp+var_78]
		jmp	short loc_41DA12
; ---------------------------------------------------------------------------

loc_41DA05:				; CODE XREF: sub_41D8C8+136j
		mov	eax, [ebp+arg_10]
		mov	[esp+0B8h+hProcess], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_41DA12:				; CODE XREF: sub_41D8C8+13Bj
		mov	[ebp+StartupInfo.hStdError], eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+0B8h+hProcess], eax ; hProcess
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		mov	ecx, eax
		or	ecx, 400000Ch
		mov	eax, [ebp+var_74]
		lea	edx, [ebp+ProcessInformation]
		mov	[esp+0B8h+lpProcessInformation], edx ; lpProcessInformation
		lea	edx, [ebp+StartupInfo]
		mov	[esp+0B8h+lpStartupInfo], edx ;	lpStartupInfo
		mov	[esp+0B8h+lpCurrentDirectory], 0 ; lpCurrentDirectory
		mov	[esp+0B8h+lpEnvironment], 0 ; lpEnvironment
		mov	[esp+0B8h+dwCreationFlags], ecx	; dwCreationFlags
		mov	[esp+0B8h+bInheritHandles], 1 ;	bInheritHandles
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0B8h+lpThreadAttributes], edx ; lpThreadAttributes
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0B8h+lpProcessAttributes],	edx ; lpProcessAttributes
		mov	[esp+0B8h+lpCommandLine], eax ;	lpCommandLine
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0B8h+hProcess], eax ; lpApplicationName
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_41DAB1
		mov	[esp+0B8h+hProcess], 0FFFFFFFFh	; DWORD
		call	sub_432EA2
		mov	[esp+0B8h+lpCommandLine], eax ;	char
		mov	[esp+0B8h+hProcess], offset aCreateprocessF ; "CreateProcess failed: %s\n"
		call	sub_435B7D
		mov	[esp+0B8h+hProcess], 1
		call	sub_41CE87
		mov	[ebp+var_C], eax
		jmp	short loc_41DAB8
; ---------------------------------------------------------------------------

loc_41DAB1:				; CODE XREF: sub_41D8C8+1BAj
		mov	[ebp+var_C], 0

loc_41DAB8:				; CODE XREF: sub_41D8C8+1E7j
		mov	eax, [ebp+var_74]
		mov	[esp+0B8h+hProcess], eax
		call	gcry_free
		mov	[ebp+var_10], 0
		jmp	short loc_41DAF0
; ---------------------------------------------------------------------------

loc_41DACC:				; CODE XREF: sub_41D8C8+22Cj
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+hObject]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41DAEC
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+hObject]
		mov	[esp+0B8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_41DAEC:				; CODE XREF: sub_41D8C8+20Ej
		add	[ebp+var_10], 1

loc_41DAF0:				; CODE XREF: sub_41D8C8+202j
		cmp	[ebp+var_10], 2
		jle	short loc_41DACC
		cmp	[ebp+var_C], 0
		jz	short loc_41DB01
		mov	eax, [ebp+var_C]
		jmp	short loc_41DB30
; ---------------------------------------------------------------------------

loc_41DB01:				; CODE XREF: sub_41D8C8+232j
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0B8h+hProcess], eax ; hThread
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0B8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hProcess]
		mov	edx, eax
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, 0

loc_41DB30:				; CODE XREF: sub_41D8C8+7Aj
					; sub_41D8C8+237j
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41D8C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DB37	proc near		; CODE XREF: sub_414196+1B1p

hHandle		= dword	ptr -28h
dwMilliseconds	= dword	ptr -24h
var_20		= dword	ptr -20h
ExitCode	= dword	ptr -18h
var_14		= byte ptr -14h
hProcess	= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= byte ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, dword ptr [ebp+arg_4]
		mov	[ebp+hProcess],	eax
		cmp	[ebp+arg_8], 0
		jz	short loc_41DB53
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0FFFFFFFFh

loc_41DB53:				; CODE XREF: sub_41DB37+11j
		cmp	dword ptr [ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_41DB6A
		mov	[esp+28h+hHandle], 37h
		call	sub_41CE87
		jmp	loc_41DCC1
; ---------------------------------------------------------------------------

loc_41DB6A:				; CODE XREF: sub_41DB37+20j
		mov	[esp+28h+dwMilliseconds], 0FFFFFFFFh ; dwMilliseconds
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	dword ptr [ebp+var_14],	eax
		mov	eax, dword ptr [ebp+var_14]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41DB96
		test	eax, eax
		jz	short loc_41DBCF
		jmp	loc_41DC8C
; ---------------------------------------------------------------------------

loc_41DB96:				; CODE XREF: sub_41DB37+54j
		mov	[esp+28h+hHandle], 0FFFFFFFFh ;	DWORD
		call	sub_432EA2
		mov	ebx, eax
		mov	[esp+28h+hHandle], offset aWaitingForProc ; "waiting for process %d to terminate fai"...
		call	sub_435294
		mov	[esp+28h+var_20], ebx
		mov	edx, dword ptr [ebp+arg_4]
		mov	[esp+28h+dwMilliseconds], edx ;	char
		mov	[esp+28h+hHandle], eax ; char *
		call	sub_435B7D
		mov	[ebp+var_C], 1
		jmp	loc_41DCAE
; ---------------------------------------------------------------------------

loc_41DBCF:				; CODE XREF: sub_41DB37+58j
		lea	eax, [ebp+ExitCode]
		mov	[esp+28h+dwMilliseconds], eax ;	lpExitCode
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hProcess
		mov	eax, ds:GetExitCodeProcess
		call	eax ; GetExitCodeProcess
		sub	esp, 8
		test	eax, eax
		jnz	short loc_41DC20
		mov	[esp+28h+hHandle], 0FFFFFFFFh ;	DWORD
		call	sub_432EA2
		mov	ebx, eax
		mov	[esp+28h+hHandle], offset aErrorGettingEx ; "error getting exit	code of	process	%d: "...
		call	sub_435294
		mov	[esp+28h+var_20], ebx
		mov	edx, dword ptr [ebp+arg_4]
		mov	[esp+28h+dwMilliseconds], edx ;	char
		mov	[esp+28h+hHandle], eax ; char *
		call	sub_435B7D
		mov	[ebp+var_C], 1
		jmp	short loc_41DC7A
; ---------------------------------------------------------------------------

loc_41DC20:				; CODE XREF: sub_41DB37+B1j
		mov	eax, [ebp+ExitCode]
		test	eax, eax
		jz	short loc_41DC64
		mov	eax, [ebp+ExitCode]
		mov	ebx, eax
		mov	[esp+28h+hHandle], offset aErrorRunningSE ; "error running `%s': exit status %d\n"
		call	sub_435294
		mov	[esp+28h+var_20], ebx
		mov	edx, dword ptr [ebp+arg_0]
		mov	[esp+28h+dwMilliseconds], edx ;	char
		mov	[esp+28h+hHandle], eax ; char *
		call	sub_435B7D
		cmp	[ebp+arg_8], 0
		jz	short loc_41DC5B
		mov	eax, [ebp+ExitCode]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_41DC5B:				; CODE XREF: sub_41DB37+118j
		mov	[ebp+var_C], 1
		jmp	short loc_41DC7A
; ---------------------------------------------------------------------------

loc_41DC64:				; CODE XREF: sub_41DB37+EEj
		cmp	[ebp+arg_8], 0
		jz	short loc_41DC73
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_41DC73:				; CODE XREF: sub_41DB37+131j
		mov	[ebp+var_C], 0

loc_41DC7A:				; CODE XREF: sub_41DB37+E7j
					; sub_41DB37+12Bj
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_41DCAE
; ---------------------------------------------------------------------------

loc_41DC8C:				; CODE XREF: sub_41DB37+5Aj
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+28h+dwMilliseconds], eax ;	char
		mov	[esp+28h+hHandle], offset aWaitforsingleo ; "WaitForSingleObject returned unexpected"...
		call	sub_435B7D
		mov	[ebp+var_C], 1
		nop

loc_41DCAE:				; CODE XREF: sub_41DB37+93j
					; sub_41DB37+153j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+dwMilliseconds], eax
		mov	[esp+28h+hHandle], 0
		call	sub_41CE60

loc_41DCC1:				; CODE XREF: sub_41DB37+2Ej
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_41DB37	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0A0h
		mov	dword ptr [ebp-2Ch], 0
		mov	dword ptr [ebp-28h], 0
		mov	dword ptr [ebp-24h], 0
		mov	dword ptr [ebp-20h], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_access
		test	eax, eax
		jz	short loc_41DD0E
		call	sub_41CEA2
		jmp	loc_41DE54
; ---------------------------------------------------------------------------

loc_41DD0E:				; CODE XREF: .text:0041DD02j
		lea	eax, [ebp-1Ch]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-1Ch], 0Ch
		mov	dword ptr [ebp-14h], 0
		lea	eax, [ebp-74h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41D153
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41DD5D
		mov	eax, [ebp-0Ch]
		jmp	loc_41DE54
; ---------------------------------------------------------------------------

loc_41DD5D:				; CODE XREF: .text:0041DD53j
		lea	eax, [ebp-70h]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	dword ptr [ebp-70h], 44h
		mov	dword ptr [ebp-44h], 1
		mov	word ptr [ebp-40h], 5
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp], eax
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, 4000208h
		mov	[ebp-10h], eax
		mov	edx, [ebp-10h]
		mov	eax, [ebp-74h]
		lea	ecx, [ebp-2Ch]
		mov	[esp+24h], ecx
		lea	ecx, [ebp-70h]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 0
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 0
		lea	edx, [ebp-1Ch]
		mov	[esp+0Ch], edx
		lea	edx, [ebp-1Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_41DE2D
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_432EA2
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCreateprocessD	; "CreateProcess(detached) failed: %s\n"
		call	sub_435B7D
		mov	eax, [ebp-74h]
		mov	[esp], eax
		call	gcry_free
		mov	dword ptr [esp], 1
		call	sub_41CE87
		jmp	short loc_41DE54
; ---------------------------------------------------------------------------

loc_41DE2D:				; CODE XREF: .text:0041DDF6j
		mov	eax, [ebp-74h]
		mov	[esp], eax
		call	gcry_free
		mov	dword ptr [ebp-74h], 0
		mov	eax, [ebp-28h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0

loc_41DE54:				; CODE XREF: .text:0041DD09j
					; .text:0041DD58j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DE5C	proc near		; CODE XREF: sub_402066+E4p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_41F2C2
		mov	[esp+18h+var_14], eax ;	char *
		mov	[esp+18h+var_18], offset aGnupg2 ; "gnupg2"
		call	sub_4349AE
		leave
		retn
sub_41DE5C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DE79	proc near		; CODE XREF: .text:0041DEACp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 1
		call	sub_435322
		mov	eax, 0
		leave
		retn
sub_41DE79	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DE92	proc near		; CODE XREF: .text:0041DEC8p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_435322
		leave
		retn
sub_41DE92	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_41DE79
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_435294
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_41DE92
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DED4	proc near		; CODE XREF: sub_402066+E9p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_43802F
		call	pth_init
		call	sub_4284CF
		leave
		retn
sub_41DED4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DEF4	proc near		; CODE XREF: sub_41DF1B+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41DF14
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_41DF19
; ---------------------------------------------------------------------------

loc_41DF14:				; CODE XREF: sub_41DEF4+7j
		mov	eax, 0

loc_41DF19:				; CODE XREF: sub_41DEF4+1Ej
		pop	ebp
		retn
sub_41DEF4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DF1B	proc near		; CODE XREF: sub_41DF36+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_41DEF4
		leave
		retn
sub_41DF1B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DF36	proc near		; CODE XREF: .text:0041E2D6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_41DF1B
		leave
		retn
sub_41DF36	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41DF4B(int, int, char	*, va_list)
sub_41DF4B	proc near		; DATA XREF: sub_41E06D+Eo

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		cmp	eax, 1Eh
		jz	short loc_41DF9A
		cmp	eax, 1Eh
		jg	short loc_41DF6E
		cmp	eax, 0Ah
		jz	short loc_41DF88
		cmp	eax, 14h
		jz	short loc_41DF91
		test	eax, eax
		jz	short loc_41DF7F
		jmp	short loc_41DFBE
; ---------------------------------------------------------------------------

loc_41DF6E:				; CODE XREF: sub_41DF4B+11j
		cmp	eax, 32h
		jz	short loc_41DFAC
		cmp	eax, 64h
		jz	short loc_41DFB5
		cmp	eax, 28h
		jz	short loc_41DFA3
		jmp	short loc_41DFBE
; ---------------------------------------------------------------------------

loc_41DF7F:				; CODE XREF: sub_41DF4B+1Fj
		mov	[ebp+arg_4], 1
		jmp	short loc_41DFC6
; ---------------------------------------------------------------------------

loc_41DF88:				; CODE XREF: sub_41DF4B+16j
		mov	[ebp+arg_4], 2
		jmp	short loc_41DFC6
; ---------------------------------------------------------------------------

loc_41DF91:				; CODE XREF: sub_41DF4B+1Bj
		mov	[ebp+arg_4], 3
		jmp	short loc_41DFC6
; ---------------------------------------------------------------------------

loc_41DF9A:				; CODE XREF: sub_41DF4B+Cj
		mov	[ebp+arg_4], 4
		jmp	short loc_41DFC6
; ---------------------------------------------------------------------------

loc_41DFA3:				; CODE XREF: sub_41DF4B+30j
		mov	[ebp+arg_4], 5
		jmp	short loc_41DFC6
; ---------------------------------------------------------------------------

loc_41DFAC:				; CODE XREF: sub_41DF4B+26j
		mov	[ebp+arg_4], 6
		jmp	short loc_41DFC6
; ---------------------------------------------------------------------------

loc_41DFB5:				; CODE XREF: sub_41DF4B+2Bj
		mov	[ebp+arg_4], 7
		jmp	short loc_41DFC6
; ---------------------------------------------------------------------------

loc_41DFBE:				; CODE XREF: sub_41DF4B+21j
					; sub_41DF4B+32j
		mov	[ebp+arg_4], 4
		nop

loc_41DFC6:				; CODE XREF: sub_41DF4B+3Bj
					; sub_41DF4B+44j ...
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_10], eax ;	va_list
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_435B32
		leave
		retn
sub_41DF4B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_41DFE1	proc near		; DATA XREF: sub_41E06D+22o

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_8], 0
		jnz	short loc_41DFFA
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	gpg_strerror
		jmp	short loc_41DFFD
; ---------------------------------------------------------------------------

loc_41DFFA:				; CODE XREF: sub_41DFE1+Aj
		mov	eax, [ebp+arg_8]

loc_41DFFD:				; CODE XREF: sub_41DFE1+17j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aLibgcryptProbl ; "libgcrypt problem: %s\n"
		call	sub_435BC0
sub_41DFE1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E00D	proc near		; DATA XREF: sub_41E06D+36o

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4490DC
		test	eax, eax
		jnz	short loc_41E066
		mov	ds:dword_4490DC, 1
		mov	eax, [ebp+arg_8]
		and	eax, 1
		test	al, al
		jz	short loc_41E04B
		mov	[esp+18h+var_18], offset aOutOfCoreInSec ; "out	of core	in secure memory while allo"...
		call	sub_435294
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_435BC0
; ---------------------------------------------------------------------------

loc_41E04B:				; CODE XREF: sub_41E00D+21j
		mov	[esp+18h+var_18], offset aOutOfCoreWhi_1 ; "out	of core	while allocating %lu bytes"
		call	sub_435294
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_435BC0
; ---------------------------------------------------------------------------

loc_41E066:				; CODE XREF: sub_41E00D+Dj
		mov	eax, 0
		leave
		retn
sub_41E00D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E06D	proc near		; CODE XREF: sub_402066+189p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset sub_41DF4B
		call	gcry_set_log_handler
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset sub_41DFE1
		call	gcry_set_fatalerror_handler
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset sub_41E00D
		call	gcry_set_outofcore_handler
		leave
		retn
sub_41E06D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_41E0D1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_41E0D8
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41E0D8

loc_41E0D1:				; CODE XREF: .text:0041E0B8j
		mov	eax, offset aStdout ; "[stdout]"
		jmp	short loc_41E0DB
; ---------------------------------------------------------------------------

loc_41E0D8:				; CODE XREF: .text:0041E0C2j
					; .text:0041E0CFj
		mov	eax, [ebp+8]

loc_41E0DB:				; CODE XREF: .text:0041E0D6j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_41E0FD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_41E104
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41E104

loc_41E0FD:				; CODE XREF: .text:0041E0E4j
		mov	eax, offset aStdin ; "[stdin]"
		jmp	short loc_41E107
; ---------------------------------------------------------------------------

loc_41E104:				; CODE XREF: .text:0041E0EEj
					; .text:0041E0FBj
		mov	eax, [ebp+8]

loc_41E107:				; CODE XREF: .text:0041E102j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432A70
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E131	proc near		; CODE XREF: .text:0041E17Bp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_C], eax ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	FILE *
		call	sub_432AA0
		leave
		retn
sub_41E131	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41E131
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_41E224
; ---------------------------------------------------------------------------

loc_41E193:				; CODE XREF: .text:0041E228j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_41E1BB
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_41E1CD
; ---------------------------------------------------------------------------

loc_41E1BB:				; CODE XREF: .text:0041E1A5j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_41E1CD:				; CODE XREF: .text:0041E1B9j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	putc
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_41E1FE
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_41E20D
; ---------------------------------------------------------------------------

loc_41E1FE:				; CODE XREF: .text:0041E1EBj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_41E20D:				; CODE XREF: .text:0041E1FCj
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	putc
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_41E224:				; CODE XREF: .text:0041E18Ej
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_41E193
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432C6B
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-34h], 3
		mov	byte ptr [ebp-30h], 42h
		mov	byte ptr [ebp-2Fh], 5Ah
		mov	byte ptr [ebp-2Eh], 68h
		mov	byte ptr [ebp-2Dh], 0
		mov	dword ptr [ebp-2Ch], 3
		mov	byte ptr [ebp-28h], 1Fh
		mov	byte ptr [ebp-27h], 8Bh
		mov	byte ptr [ebp-26h], 8
		mov	byte ptr [ebp-25h], 0
		mov	dword ptr [ebp-24h], 4
		mov	byte ptr [ebp-20h], 50h
		mov	byte ptr [ebp-1Fh], 4Bh
		mov	byte ptr [ebp-1Eh], 3
		mov	byte ptr [ebp-1Dh], 4
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42ED5E
		test	eax, eax
		jnz	short loc_41E2B8
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_41E2C2

loc_41E2B8:				; CODE XREF: .text:0041E2B0j
		mov	eax, 0
		jmp	locret_41E3AA
; ---------------------------------------------------------------------------

loc_41E2C2:				; CODE XREF: .text:0041E2B6j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42EDF1
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_41E2EC
		call	sub_41DF36
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_41E3AA
; ---------------------------------------------------------------------------

loc_41E2EC:				; CODE XREF: .text:0041E2D4j
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_430C9C
		test	edx, edx
		jg	short loc_41E31D
		test	edx, edx
		js	short loc_41E30B
		cmp	eax, 3
		ja	short loc_41E31D

loc_41E30B:				; CODE XREF: .text:0041E304j
		mov	eax, [ebp-1Ch]
		test	eax, eax
		jnz	short loc_41E31D
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		jmp	short loc_41E39C
; ---------------------------------------------------------------------------

loc_41E31D:				; CODE XREF: .text:0041E300j
					; .text:0041E309j ...
		mov	dword ptr [esp+8], 4
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_43070F
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41E349
		mov	eax, [ebp-14h]
		mov	edx, [eax+3Ch]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_41E39C
; ---------------------------------------------------------------------------

loc_41E349:				; CODE XREF: .text:0041E33Aj
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_41E394
; ---------------------------------------------------------------------------

loc_41E352:				; CODE XREF: .text:0041E39Aj
		mov	eax, [ebp-0Ch]
		mov	eax, [ebp+eax*8-34h]
		lea	edx, [ebp-34h]
		mov	ecx, [ebp-0Ch]
		shl	ecx, 3
		add	edx, ecx
		add	edx, 4
		mov	[esp+8], eax
		mov	[esp+4], edx
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	memcmp
		test	eax, eax
		jnz	short loc_41E390
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		mov	dword ptr [ebp-10h], 1
		jmp	short loc_41E39C
; ---------------------------------------------------------------------------

loc_41E390:				; CODE XREF: .text:0041E37Cj
		add	dword ptr [ebp-0Ch], 1

loc_41E394:				; CODE XREF: .text:0041E350j
		mov	eax, [ebp-0Ch]
		cmp	eax, 2
		jbe	short loc_41E352

loc_41E39C:				; CODE XREF: .text:0041E31Bj
					; .text:0041E347j ...
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_42E9D9
		mov	eax, [ebp-10h]

locret_41E3AA:				; CODE XREF: .text:0041E2BDj
					; .text:0041E2E7j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h

loc_41E3B2:				; CODE XREF: .text:0041E410j
		mov	dword ptr [esp+4], offset asc_4455B4 ; "|"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strcspn
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41E414
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_41E3F4
		mov	eax, 1
		jmp	short locret_41E41A
; ---------------------------------------------------------------------------

loc_41E3F4:				; CODE XREF: .text:0041E3EBj
		mov	eax, [ebp-0Ch]
		add	[ebp+8], eax
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41E408
		add	dword ptr [ebp+8], 1

loc_41E408:				; CODE XREF: .text:0041E402j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41E3B2
		jmp	short loc_41E415
; ---------------------------------------------------------------------------

loc_41E414:				; CODE XREF: .text:0041E3CCj
		nop

loc_41E415:				; CODE XREF: .text:0041E412j
		mov	eax, 0

locret_41E41A:				; CODE XREF: .text:0041E3F2j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E421	proc near		; CODE XREF: sub_402066+19Ap
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_41E421	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_4490E0
		test	eax, eax
		jnz	short loc_41E489
		mov	ds:dword_4490E0, 1
		call	_getpid
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		xor	eax, edx
		mov	[ebp-14h], eax
		mov	dword ptr [esp], 0
		call	sub_43BBF0
		mov	edx, eax
		mov	eax, [ebp-10h]
		xor	eax, edx
		mov	[ebp-18h], eax
		lea	eax, [ebp-14h]
		mov	eax, [eax]
		mov	ds:dword_4490E4, eax
		mov	eax, offset dword_4490E8
		lea	edx, [ebp-18h]
		mov	edx, [edx]
		mov	[eax], edx

loc_41E489:				; CODE XREF: .text:0041E442j
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 8
		mov	eax, offset dword_4490E4
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E499	proc near		; CODE XREF: sub_402066+C71p

dwMilliseconds	= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_41E4B6
		mov	[esp+18h+dwMilliseconds], 0 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4

loc_41E4B6:				; CODE XREF: sub_41E499+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+dwMilliseconds], eax
		call	pth_sleep
		leave
		retn
sub_41E499	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E4C3	proc near		; CODE XREF: .text:0041E530p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_41E4D6
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41E510
; ---------------------------------------------------------------------------

loc_41E4D6:				; CODE XREF: sub_41E4C3+Aj
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	edx, al
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41E50D
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToTran_0 ; "failed to translate	osfhandle %p\n"
		call	sub_435B7D

loc_41E50D:				; CODE XREF: sub_41E4C3+35j
		mov	eax, [ebp+var_C]

locret_41E510:				; CODE XREF: sub_41E4C3+11j
		leave
		retn
sub_41E4C3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 2
		jg	short loc_41E523
		mov	eax, [ebp+8]
		jmp	short locret_41E535
; ---------------------------------------------------------------------------

loc_41E523:				; CODE XREF: .text:0041E51Cj
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_41E4C3

locret_41E535:				; CODE XREF: .text:0041E521j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E537	proc near		; CODE XREF: sub_414196+1Ep

nBufferLength	= dword	ptr -188h
lpBuffer	= dword	ptr -184h
dwShareMode	= dword	ptr -180h
lpSecurityAttributes= dword ptr	-17Ch
dwCreationDisposition= dword ptr -178h
dwFlagsAndAttributes= dword ptr	-174h
hTemplateFile	= dword	ptr -170h
var_15C		= dword	ptr -15Ch
SecurityAttributes= _SECURITY_ATTRIBUTES ptr -158h
Buffer		= byte ptr -14Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
FileHandle	= dword	ptr -2Ch
hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 184h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+SecurityAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+SecurityAttributes.nLength], 0Ch
		mov	[ebp+SecurityAttributes.bInheritHandle], 1
		lea	eax, [ebp+Buffer]
		mov	[esp+188h+lpBuffer], eax ; lpBuffer
		mov	[esp+188h+nBufferLength], 105h ; nBufferLength
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41E5D5
		cmp	[ebp+var_20], 104h
		jg	short loc_41E5D5
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_15C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_15C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_41E5EC

loc_41E5D5:				; CODE XREF: sub_41E537+64j
					; sub_41E537+6Dj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0
		jmp	loc_41E7DA
; ---------------------------------------------------------------------------

loc_41E5EC:				; CODE XREF: sub_41E537+9Cj
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_15C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_15C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Buffer]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 756E675Fh
		mov	word ptr [eax+4], 6770h
		mov	byte ptr [eax+6], 0
		add	[ebp+var_10], 6
		mov	[esp+188h+lpBuffer], 0 ; lpSecurityAttributes
		lea	eax, [ebp+Buffer]
		mov	[esp+188h+nBufferLength], eax ;	lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], eax
		mov	[ebp+var_C], 0
		jmp	loc_41E7BE
; ---------------------------------------------------------------------------

loc_41E66D:				; CODE XREF: sub_41E537+28Bj
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp+var_1C]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_41E6BE
; ---------------------------------------------------------------------------

loc_41E68E:				; CODE XREF: sub_41E537+18Bj
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_41E6A4
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_41E6AD
; ---------------------------------------------------------------------------

loc_41E6A4:				; CODE XREF: sub_41E537+160j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 37h

loc_41E6AD:				; CODE XREF: sub_41E537+16Bj
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		shl	[ebp+var_14], 4
		add	[ebp+var_18], 1

loc_41E6BE:				; CODE XREF: sub_41E537+155j
		cmp	[ebp+var_18], 7
		jle	short loc_41E68E
		mov	edx, offset a_tmp ; ".tmp"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	[esp+188h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+188h+dwFlagsAndAttributes], 4000100h ; dwFlagsAndAttributes
		mov	[esp+188h+dwCreationDisposition], 1 ; dwCreationDisposition
		lea	eax, [ebp+SecurityAttributes]
		mov	[esp+188h+lpSecurityAttributes], eax ; lpSecurityAttributes
		mov	[esp+188h+dwShareMode],	0 ; dwShareMode
		mov	[esp+188h+lpBuffer], 0C0000000h	; dwDesiredAccess
		lea	eax, [ebp+Buffer]
		mov	[esp+188h+nBufferLength], eax ;	lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	loc_41E7A9
		mov	eax, [ebp+hObject]
		mov	[esp+188h+lpBuffer], 0
		mov	[esp+188h+nBufferLength], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+FileHandle], eax
		cmp	[ebp+FileHandle], 0FFFFFFFFh
		jnz	short loc_41E75E
		mov	eax, [ebp+hObject]
		mov	[esp+188h+nBufferLength], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short loc_41E7DA
; ---------------------------------------------------------------------------

loc_41E75E:				; CODE XREF: sub_41E537+20Ej
		mov	[esp+188h+lpBuffer], offset aWB	; "w+b"
		mov	eax, [ebp+FileHandle]
		mov	[esp+188h+nBufferLength], eax ;	FileHandle
		call	_fdopen
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_41E7A4
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+188h+nBufferLength], eax
		call	_close
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_34]
		mov	[eax], edx
		mov	eax, 0
		jmp	short loc_41E7DA
; ---------------------------------------------------------------------------

loc_41E7A4:				; CODE XREF: sub_41E537+241j
		mov	eax, [ebp+var_30]
		jmp	short loc_41E7DA
; ---------------------------------------------------------------------------

loc_41E7A9:				; CODE XREF: sub_41E537+1ECj
		mov	[esp+188h+nBufferLength], 1 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	[ebp+var_C], 1

loc_41E7BE:				; CODE XREF: sub_41E537+131j
		cmp	[ebp+var_C], 9
		jle	loc_41E66D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0

loc_41E7DA:				; CODE XREF: sub_41E537+B0j
					; sub_41E537+225j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_41E537	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41E7E4(DWORD)
sub_41E7E4	proc near		; CODE XREF: .text:0041D7F1p

dwProcessId	= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_41E80D
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], offset aGnupg_allow_se ; "gnupg_allow_set_foregound_window"
		mov	[esp+18h+dwProcessId], offset aSCalledWithInv ;	"%s called with	invalid	pid %lu\n"
		call	sub_435B53
		jmp	short locret_41E851
; ---------------------------------------------------------------------------

loc_41E80D:				; CODE XREF: sub_41E7E4+Aj
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	short loc_41E818
		mov	eax, [ebp+arg_0]
		jmp	short loc_41E81D
; ---------------------------------------------------------------------------

loc_41E818:				; CODE XREF: sub_41E7E4+2Dj
		mov	eax, 0FFFFFFFFh

loc_41E81D:				; CODE XREF: sub_41E7E4+32j
		mov	[esp+18h+dwProcessId], eax ; dwProcessId
		mov	eax, ds:AllowSetForegroundWindow
		call	eax ; AllowSetForegroundWindow
		sub	esp, 4
		test	eax, eax
		jnz	short locret_41E851
		mov	[esp+18h+dwProcessId], 0FFFFFFFFh ; DWORD
		call	sub_432EA2
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+dwProcessId], offset aAllowsetforegr ;	"AllowSetForegroundWindow(%lu) failed: %"...
		call	sub_435B53

locret_41E851:				; CODE XREF: sub_41E7E4+27j
					; sub_41E7E4+48j
		leave
		retn
sub_41E7E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E853	proc near		; CODE XREF: sub_403FC2+140p

dwDesiredAccess	= dword	ptr -48h
bInheritHandle	= dword	ptr -44h
dwProcessId	= dword	ptr -40h
TokenInformationLength=	dword ptr -3Ch
ReturnLength	= dword	ptr -38h
var_24		= dword	ptr -24h
TokenHandle	= dword	ptr -20h
nDestinationSidLength= dword ptr -1Ch
ProcessHandle	= dword	ptr -18h
pDestinationSid	= dword	ptr -14h
TokenInformation= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_C], 0
		mov	[ebp+ProcessHandle], 0
		mov	[ebp+TokenHandle], 0
		mov	[ebp+TokenInformation],	0
		mov	[ebp+pDestinationSid], 0
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[esp+48h+dwProcessId], eax ; dwProcessId
		mov	[esp+48h+bInheritHandle], 0 ; bInheritHandle
		mov	[esp+48h+dwDesiredAccess], 400h	; dwDesiredAccess
		mov	eax, ds:OpenProcess
		call	eax ; OpenProcess
		sub	esp, 0Ch
		mov	[ebp+ProcessHandle], eax
		cmp	[ebp+ProcessHandle], 0
		jz	loc_41E9CC
		lea	eax, [ebp+TokenHandle]
		mov	[esp+48h+dwProcessId], eax ; TokenHandle
		mov	[esp+48h+bInheritHandle], 8 ; DesiredAccess
		mov	eax, [ebp+ProcessHandle]
		mov	[esp+48h+dwDesiredAccess], eax ; ProcessHandle
		mov	eax, ds:OpenProcessToken
		call	eax ; OpenProcessToken
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_41E9CF
		mov	eax, [ebp+TokenHandle]
		lea	edx, [ebp+var_24]
		mov	[esp+48h+ReturnLength],	edx ; ReturnLength
		mov	[esp+48h+TokenInformationLength], 0 ; TokenInformationLength
		mov	[esp+48h+dwProcessId], 0 ; TokenInformation
		mov	[esp+48h+bInheritHandle], 1 ; TokenInformationClass
		mov	[esp+48h+dwDesiredAccess], eax ; TokenHandle
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_41E917
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		cmp	eax, 7Ah
		jnz	loc_41E9D2

loc_41E917:				; CODE XREF: sub_41E853+B2j
		mov	eax, [ebp+var_24]
		mov	[esp+48h+dwDesiredAccess], eax
		call	gcry_malloc
		mov	[ebp+TokenInformation],	eax
		cmp	[ebp+TokenInformation],	0
		jz	loc_41E9D5
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+TokenHandle]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+ReturnLength],	ecx ; ReturnLength
		mov	[esp+48h+TokenInformationLength], edx ;	TokenInformationLength
		mov	edx, [ebp+TokenInformation]
		mov	[esp+48h+dwProcessId], edx ; TokenInformation
		mov	[esp+48h+bInheritHandle], 1 ; TokenInformationClass
		mov	[esp+48h+dwDesiredAccess], eax ; TokenHandle
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jz	short loc_41E9D8
		mov	eax, [ebp+TokenInformation]
		mov	eax, [eax]
		mov	[esp+48h+dwDesiredAccess], eax ; pSid
		mov	eax, ds:IsValidSid
		call	eax ; IsValidSid
		sub	esp, 4
		test	eax, eax
		jz	short loc_41E9DB
		mov	eax, [ebp+TokenInformation]
		mov	eax, [eax]
		mov	[esp+48h+dwDesiredAccess], eax ; pSid
		mov	eax, ds:GetLengthSid
		call	eax ; GetLengthSid
		sub	esp, 4
		mov	[ebp+nDestinationSidLength], eax
		mov	eax, [ebp+nDestinationSidLength]
		mov	[esp+48h+dwDesiredAccess], eax
		call	gcry_malloc
		mov	[ebp+pDestinationSid], eax
		cmp	[ebp+pDestinationSid], 0
		jz	short loc_41E9DE
		mov	eax, [ebp+TokenInformation]
		mov	eax, [eax]
		mov	[esp+48h+dwProcessId], eax ; pSourceSid
		mov	eax, [ebp+pDestinationSid]
		mov	[esp+48h+bInheritHandle], eax ;	pDestinationSid
		mov	eax, [ebp+nDestinationSidLength]
		mov	[esp+48h+dwDesiredAccess], eax ; nDestinationSidLength
		mov	eax, ds:CopySid
		call	eax ; CopySid
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_41E9E1
		mov	[ebp+var_C], 1
		jmp	short loc_41E9E2
; ---------------------------------------------------------------------------

loc_41E9CC:				; CODE XREF: sub_41E853+54j
		nop
		jmp	short loc_41E9E2
; ---------------------------------------------------------------------------

loc_41E9CF:				; CODE XREF: sub_41E853+7Bj
		nop
		jmp	short loc_41E9E2
; ---------------------------------------------------------------------------

loc_41E9D2:				; CODE XREF: sub_41E853+BEj
		nop
		jmp	short loc_41E9E2
; ---------------------------------------------------------------------------

loc_41E9D5:				; CODE XREF: sub_41E853+D6j
		nop
		jmp	short loc_41E9E2
; ---------------------------------------------------------------------------

loc_41E9D8:				; CODE XREF: sub_41E853+10Bj
		nop
		jmp	short loc_41E9E2
; ---------------------------------------------------------------------------

loc_41E9DB:				; CODE XREF: sub_41E853+121j
		nop
		jmp	short loc_41E9E2
; ---------------------------------------------------------------------------

loc_41E9DE:				; CODE XREF: sub_41E853+14Aj
		nop
		jmp	short loc_41E9E2
; ---------------------------------------------------------------------------

loc_41E9E1:				; CODE XREF: sub_41E853+16Ej
		nop

loc_41E9E2:				; CODE XREF: sub_41E853+177j
					; sub_41E853+17Aj ...
		mov	eax, [ebp+TokenInformation]
		mov	[esp+48h+dwDesiredAccess], eax
		call	gcry_free
		mov	eax, [ebp+TokenHandle]
		test	eax, eax
		jz	short loc_41EA04
		mov	eax, [ebp+TokenHandle]
		mov	[esp+48h+dwDesiredAccess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_41EA04:				; CODE XREF: sub_41E853+19Fj
		cmp	[ebp+ProcessHandle], 0
		jz	short loc_41EA1A
		mov	eax, [ebp+ProcessHandle]
		mov	[esp+48h+dwDesiredAccess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_41EA1A:				; CODE XREF: sub_41E853+1B5j
		cmp	[ebp+var_C], 0
		jnz	short loc_41EA32
		mov	eax, [ebp+pDestinationSid]
		mov	[esp+48h+dwDesiredAccess], eax
		call	gcry_free
		mov	[ebp+pDestinationSid], 0

loc_41EA32:				; CODE XREF: sub_41E853+1CBj
		mov	eax, [ebp+pDestinationSid]
		leave
		retn
sub_41E853	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41EA38(LPCSTR)
sub_41EA38	proc near		; CODE XREF: sub_41EAC5+42p

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41EA38	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41EA56(HMODULE, LPCSTR)
sub_41EA56	proc near		; CODE XREF: sub_41EAC5+5Ep

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_41EA94
		cmp	[ebp+arg_4], 0
		jz	short loc_41EA94
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41EA8F
		mov	eax, 0
		jmp	short locret_41EA99
; ---------------------------------------------------------------------------

loc_41EA8F:				; CODE XREF: sub_41EA56+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_41EA99
; ---------------------------------------------------------------------------

loc_41EA94:				; CODE XREF: sub_41EA56+Aj
					; sub_41EA56+10j
		mov	eax, 0

locret_41EA99:				; CODE XREF: sub_41EA56+37j
					; sub_41EA56+3Cj
		leave
		retn
sub_41EA56	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41EA9B(HANDLE)
sub_41EA9B	proc near		; CODE XREF: sub_41EAC5+77p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_41EABE
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_41EAC3
; ---------------------------------------------------------------------------

loc_41EABE:				; CODE XREF: sub_41EA9B+Aj
		mov	eax, 0FFFFFFFFh

locret_41EAC3:				; CODE XREF: sub_41EA9B+21j
		leave
		retn
sub_41EA9B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41EAC5	proc near		; CODE XREF: sub_41EB9F+77p
					; sub_41EF99+5Ap ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_449274
		test	eax, eax
		jnz	loc_41EB60
		mov	ds:dword_449274, 1
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_41EB4C
; ---------------------------------------------------------------------------

loc_41EAF2:				; CODE XREF: sub_41EAC5+99j
		mov	eax, [ebp+var_10]
		mov	eax, off_43D814[eax*4]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax ;	LPCSTR
		call	sub_41EA38
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41EB48
		mov	[esp+38h+var_34], offset aShgetfolderpat ; "SHGetFolderPathA"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_41EA56
		mov	ds:dword_449278, eax
		mov	eax, ds:dword_449278
		test	eax, eax
		jnz	short loc_41EB48
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HANDLE
		call	sub_41EA9B
		mov	[ebp+var_C], 0

loc_41EB48:				; CODE XREF: sub_41EAC5+4Ej
					; sub_41EAC5+6Fj
		add	[ebp+var_10], 1

loc_41EB4C:				; CODE XREF: sub_41EAC5+2Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_41EB60
		mov	eax, [ebp+var_10]
		mov	eax, off_43D814[eax*4]
		test	eax, eax
		jnz	short loc_41EAF2

loc_41EB60:				; CODE XREF: sub_41EAC5+Dj
					; sub_41EAC5+8Bj
		mov	eax, ds:dword_449278
		test	eax, eax
		jz	short loc_41EB98
		mov	edx, ds:dword_449278
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx ; dword_449278
		sub	esp, 14h
		jmp	short locret_41EB9D
; ---------------------------------------------------------------------------

loc_41EB98:				; CODE XREF: sub_41EAC5+A2j
		mov	eax, 0FFFFFFFFh

locret_41EB9D:				; CODE XREF: sub_41EAC5+D1j
		leave
		retn
sub_41EAC5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41EB9F	proc near		; CODE XREF: sub_403D1A+7p
					; sub_41ECD9+14p ...

lpPathName	= dword	ptr -148h
lpSecurityAttributes= dword ptr	-144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:lpPathName
		test	eax, eax
		jnz	loc_41ECCD
		call	sub_41EE6C
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449100
		test	eax, eax
		jz	short loc_41EBED
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], offset	aHome ;	"\\home"
		mov	eax, [ebp+var_C]
		mov	[esp+148h+lpPathName], eax
		call	sub_43372E
		mov	ds:lpPathName, eax
		jmp	loc_41ECCD
; ---------------------------------------------------------------------------

loc_41EBED:				; CODE XREF: sub_41EB9F+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], 801Ah
		mov	[esp+148h+lpPathName], 0
		call	sub_41EAC5
		test	eax, eax
		js	loc_41ECC3
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 7
		mov	[esp+148h+lpPathName], eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnupg ; "\\gnupg"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+lpPathName], eax
		call	sub_433245
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, word ptr [ebx+4]
		mov	[eax+4], dx
		movzx	edx, byte ptr [ebx+6]
		mov	[eax+6], dl
		mov	eax, [ebp+var_10]
		mov	ds:lpPathName, eax
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0
		mov	[esp+148h+lpPathName], eax
		call	_access
		test	eax, eax
		jz	short loc_41ECCD
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+148h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		jmp	short loc_41ECCD
; ---------------------------------------------------------------------------

loc_41ECC3:				; CODE XREF: sub_41EB9F+7Ej
		mov	ds:lpPathName, offset aCGnupg ;	"c:/gnupg"

loc_41ECCD:				; CODE XREF: sub_41EB9F+12j
					; sub_41EB9F+49j ...
		mov	eax, ds:lpPathName
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41EB9F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41ECD9	proc near		; CODE XREF: sub_402066:loc_4022B8p

VarName		= dword	ptr -28h
var_24		= dword	ptr -24h
lpValueName	= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_41EE6C
		mov	eax, ds:dword_449100
		test	eax, eax
		jz	short loc_41ECF7
		call	sub_41EB9F
		jmp	locret_41EDB7
; ---------------------------------------------------------------------------

loc_41ECF7:				; CODE XREF: sub_41ECD9+12j
		mov	[esp+28h+VarName], offset aGnupghome ; "GNUPGHOME"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41ED1A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_41ED9D

loc_41ED1A:				; CODE XREF: sub_41ECD9+31j
		mov	eax, ds:dword_44926C
		test	eax, eax
		jnz	short loc_41ED95
		cmp	[ebp+var_C], 0
		jz	short loc_41ED33
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41ED82

loc_41ED33:				; CODE XREF: sub_41ECD9+4Ej
		mov	[esp+28h+lpValueName], offset ValueName	; "HomeDir"
		mov	[esp+28h+var_24], offset aSoftwareGnuGnu ; "Software\\GNU\\GnuPG"
		mov	[esp+28h+VarName], 0 ; int
		call	sub_438F46
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41ED74
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41ED74
		mov	eax, [ebp+var_10]
		mov	[esp+28h+VarName], eax
		call	gcry_free
		mov	[ebp+var_10], 0

loc_41ED74:				; CODE XREF: sub_41ECD9+7Dj
					; sub_41ECD9+87j
		cmp	[ebp+var_10], 0
		jz	short loc_41ED82
		mov	eax, [ebp+var_10]
		mov	ds:dword_44926C, eax

loc_41ED82:				; CODE XREF: sub_41ECD9+58j
					; sub_41ECD9+9Fj
		mov	eax, ds:dword_44926C
		test	eax, eax
		jnz	short loc_41ED95
		call	sub_41EB9F
		mov	ds:dword_44926C, eax

loc_41ED95:				; CODE XREF: sub_41ECD9+48j
					; sub_41ECD9+B0j
		mov	eax, ds:dword_44926C
		mov	[ebp+var_C], eax

loc_41ED9D:				; CODE XREF: sub_41ECD9+3Bj
		cmp	[ebp+var_C], 0
		jz	short loc_41EDAD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41EDB4

loc_41EDAD:				; CODE XREF: sub_41ECD9+C8j
		mov	[ebp+var_C], offset aCGnupg ; "c:/gnupg"

loc_41EDB4:				; CODE XREF: sub_41ECD9+D2j
		mov	eax, [ebp+var_C]

locret_41EDB7:				; CODE XREF: sub_41ECD9+19j
		leave
		retn
sub_41ECD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41EDB9	proc near		; CODE XREF: sub_41EE6C+91p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	[esp+38h+var_30], 0
		mov	dword ptr [esp+38h+var_34], offset aGpgconf_exe	; "\\gpgconf.exe"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_43372E
		mov	dword ptr [ebp+var_C], eax
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jz	short loc_41EE0B
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aRequiredBinary ; "required binary '%s' is not installed\n"
		call	sub_435B7D
		jmp	short loc_41EE5A
; ---------------------------------------------------------------------------

loc_41EE0B:				; CODE XREF: sub_41EDB9+3Bj
		mov	ebx, offset aCtl ; "ctl"
		mov	eax, dword ptr [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 3
		add	eax, dword ptr [ebp+var_C]
		mov	edx, [ebx]
		mov	[eax], edx
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jnz	short loc_41EE5A
		mov	ds:dword_449100, 1

loc_41EE5A:				; CODE XREF: sub_41EDB9+50j
					; sub_41EDB9+95j
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41EDB9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41EE6C	proc near		; CODE XREF: sub_41EB9F+18p
					; sub_41ECD9+6p ...

hModule		= dword	ptr -28h
lpFilename	= dword	ptr -24h
nSize		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_44914C
		test	eax, eax
		jnz	loc_41EF7B
		mov	[esp+28h+nSize], 104h ;	nSize
		mov	[esp+28h+lpFilename], offset byte_449160 ; lpFilename
		mov	[esp+28h+hModule], 0 ; hModule
		mov	eax, ds:GetModuleFileNameA
		call	eax ; GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_41EEC9
		mov	[esp+28h+hModule], 0 ; DWORD
		call	sub_432EA2
		mov	[esp+28h+lpFilename], eax ; char
		mov	[esp+28h+hModule], offset aGetmodulefilen ; "GetModuleFileName failed: %s\n"
		call	sub_435C1A
		mov	ds:byte_449160,	0

loc_41EEC9:				; CODE XREF: sub_41EE6C+38j
		mov	ds:dword_44914C, 1
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset byte_449160 ;	Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41EF5A
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	[esp+28h+hModule], offset byte_449160
		call	sub_41EDB9
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset byte_449160 ;	Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41EF5A
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	edx, eax
		mov	eax, offset aBin ; "bin"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41EF5A
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	ds:dword_449104, 1

loc_41EF5A:				; CODE XREF: sub_41EE6C+82j
					; sub_41EE6C+B1j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_41EF7B
		mov	[esp+28h+lpFilename], offset byte_449160 ; char
		mov	[esp+28h+hModule], offset aBadFilenameSRe ; "bad filename `%s' returned for this pro"...
		call	sub_435C1A
		mov	ds:byte_449160,	0

loc_41EF7B:				; CODE XREF: sub_41EE6C+Fj
					; sub_41EE6C+F2j
		movzx	eax, ds:byte_449160
		test	al, al
		jz	short loc_41EF8D
		mov	eax, offset byte_449160
		jmp	short loc_41EF92
; ---------------------------------------------------------------------------

loc_41EF8D:				; CODE XREF: sub_41EE6C+118j
		mov	eax, offset aCGnupg_0 ;	"c:\\gnupg"

loc_41EF92:				; CODE XREF: sub_41EE6C+11Fj
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41EE6C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41EF99	proc near		; CODE XREF: sub_41F080+15p

var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_449148
		test	eax, eax
		jnz	loc_41F071
		call	sub_41EE6C
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449100
		test	eax, eax
		jz	short loc_41EFCA
		mov	eax, [ebp+var_C]
		jmp	loc_41F076
; ---------------------------------------------------------------------------

loc_41EFCA:				; CODE XREF: sub_41EF99+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+var_144], 23h
		mov	[esp+148h+var_148], 0
		call	sub_41EAC5
		test	eax, eax
		js	short loc_41F061
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+148h+var_148], eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnu ; "\\GNU"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_144], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+var_148], eax
		call	sub_433245
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_10]
		mov	ds:dword_449148, eax
		jmp	short loc_41F071
; ---------------------------------------------------------------------------

loc_41F061:				; CODE XREF: sub_41EF99+61j
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_148], eax
		call	gcry_xstrdup
		mov	ds:dword_449148, eax

loc_41F071:				; CODE XREF: sub_41EF99+12j
					; sub_41EF99+C6j
		mov	eax, ds:dword_449148

loc_41F076:				; CODE XREF: sub_41EF99+2Cj
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41EF99	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F080	proc near		; CODE XREF: sub_417DD9:loc_418026p
					; sub_41854D+C7p ...

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_449144
		test	eax, eax
		jnz	loc_41F117
		call	sub_41EF99
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aEtcGnupg ; "\\etc\\gnupg"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449144, eax
		mov	eax, ds:dword_449144
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F117:				; CODE XREF: sub_41F080+Fj
		mov	eax, ds:dword_449144
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41F080	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F123	proc near		; CODE XREF: sub_41F16F+6p
					; sub_41F46E+2Ep ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_41EE6C
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449104
		test	eax, eax
		jz	short loc_41F16A
		mov	eax, ds:dword_449140
		test	eax, eax
		jnz	short loc_41F163
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset aBin_0	; "\\bin"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_43372E
		mov	ds:dword_449140, eax

loc_41F163:				; CODE XREF: sub_41F123+1Ej
		mov	eax, ds:dword_449140
		jmp	short locret_41F16D
; ---------------------------------------------------------------------------

loc_41F16A:				; CODE XREF: sub_41F123+15j
		mov	eax, [ebp+var_C]

locret_41F16D:				; CODE XREF: sub_41F123+45j
		leave
		retn
sub_41F123	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F16F	proc near		; CODE XREF: sub_41F46E+160p
					; sub_41F46E+292p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_41F123
		leave
		retn
sub_41F16F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_44913C
		test	eax, eax
		jnz	loc_41F213
		call	sub_41EE6C
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aLibGnupg ;	"\\lib\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_44913C, eax
		mov	eax, ds:dword_44913C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_433245
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_41F213:				; CODE XREF: .text:0041F18Bj
		mov	eax, ds:dword_44913C
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F21F	proc near		; CODE XREF: sub_42BFF3+EAp

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_449138
		test	eax, eax
		jnz	loc_41F2B6
		call	sub_41EE6C
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aShareGnupg ; "\\share\\gnupg"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449138, eax
		mov	eax, ds:dword_449138
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F2B6:				; CODE XREF: sub_41F21F+Fj
		mov	eax, ds:dword_449138
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41F21F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F2C2	proc near		; CODE XREF: sub_41DE5C+6p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_449134
		test	eax, eax
		jnz	loc_41F359
		call	sub_41EE6C
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aShareLocale ; "\\share\\locale"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449134, eax
		mov	eax, ds:dword_449134
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F359:				; CODE XREF: sub_41F2C2+Fj
		mov	eax, ds:dword_449134
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41F2C2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_449130
		test	eax, eax
		jnz	loc_41F45F
		lea	eax, [ebp-110h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 24h
		mov	dword ptr [esp], 0
		call	sub_41EAC5
		test	eax, eax
		jns	short loc_41F3D3
		mov	edx, offset aCWindows ;	"C:\\WINDOWS"
		lea	eax, [ebp-110h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	ecx, word ptr [edx+8]
		mov	[eax+8], cx
		movzx	edx, byte ptr [edx+0Ah]
		mov	[eax+0Ah], dl

loc_41F3D3:				; CODE XREF: .text:0041F3ADj
		mov	dword ptr [ebp-0Ch], offset aS_dirmngr ; "\\S.dirmngr"
		lea	eax, [ebp-110h]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_449130, eax
		mov	eax, ds:dword_449130
		lea	edx, [ebp-110h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_433245
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_41F45F:				; CODE XREF: .text:0041F377j
		mov	eax, ds:dword_449130
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F46E	proc near		; CODE XREF: sub_40E7CF+175p
					; sub_414196+16p ...

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		cmp	[ebp+arg_0], 0Ah ; switch 11 cases
		ja	loc_41FA86	; jumptable 0041F48D default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_445840
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41F48F:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_449108 ; jumptable 0041F48D case 1
		test	eax, eax
		jnz	loc_41F51E
		call	sub_41F123
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgAgent_exe ; "\\gpg-agent.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449108, eax
		mov	eax, ds:dword_449108
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F51E:				; CODE XREF: sub_41F46E+28j
		mov	eax, ds:dword_449108
		jmp	loc_41FAA2
; ---------------------------------------------------------------------------

loc_41F528:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_44910C ; jumptable 0041F48D case 2
		test	eax, eax
		jnz	loc_41F5B7
		call	sub_41F123
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aPinentry_exe ; "\\pinentry.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_44910C, eax
		mov	eax, ds:dword_44910C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F5B7:				; CODE XREF: sub_41F46E+C1j
		mov	eax, ds:dword_44910C
		jmp	loc_41FAA2
; ---------------------------------------------------------------------------

loc_41F5C1:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_449110 ; jumptable 0041F48D case 3
		test	eax, eax
		jnz	loc_41F650
		call	sub_41F16F
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aScdaemon_exe ; "\\scdaemon.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449110, eax
		mov	eax, ds:dword_449110
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F650:				; CODE XREF: sub_41F46E+15Aj
		mov	eax, ds:dword_449110
		jmp	loc_41FAA2
; ---------------------------------------------------------------------------

loc_41F65A:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_449114 ; jumptable 0041F48D case 4
		test	eax, eax
		jnz	loc_41F6E9
		call	sub_41F123
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aDirmngr_exe ; "\\dirmngr.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449114, eax
		mov	eax, ds:dword_449114
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F6E9:				; CODE XREF: sub_41F46E+1F3j
		mov	eax, ds:dword_449114
		jmp	loc_41FAA2
; ---------------------------------------------------------------------------

loc_41F6F3:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_449118 ; jumptable 0041F48D case 5
		test	eax, eax
		jnz	loc_41F782
		call	sub_41F16F
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgProtectTool ; "\\gpg-protect-tool.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449118, eax
		mov	eax, ds:dword_449118
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F782:				; CODE XREF: sub_41F46E+28Cj
		mov	eax, ds:dword_449118
		jmp	loc_41FAA2
; ---------------------------------------------------------------------------

loc_41F78C:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_44911C ; jumptable 0041F48D case 6
		test	eax, eax
		jnz	loc_41F81B
		call	sub_41F16F
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgCheckPatter ; "\\gpg-check-pattern.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_44911C, eax
		mov	eax, ds:dword_44911C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F81B:				; CODE XREF: sub_41F46E+325j
		mov	eax, ds:dword_44911C
		jmp	loc_41FAA2
; ---------------------------------------------------------------------------

loc_41F825:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_449120 ; jumptable 0041F48D case 7
		test	eax, eax
		jnz	loc_41F8B4
		call	sub_41F123
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgsm_exe	; "\\gpgsm.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449120, eax
		mov	eax, ds:dword_449120
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F8B4:				; CODE XREF: sub_41F46E+3BEj
		mov	eax, ds:dword_449120
		jmp	loc_41FAA2
; ---------------------------------------------------------------------------

loc_41F8BE:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_449124 ; jumptable 0041F48D case 8
		test	eax, eax
		jnz	loc_41F94D
		call	sub_41F123
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpg2_exe ; "\\gpg2.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449124, eax
		mov	eax, ds:dword_449124
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F94D:				; CODE XREF: sub_41F46E+457j
		mov	eax, ds:dword_449124
		jmp	loc_41FAA2
; ---------------------------------------------------------------------------

loc_41F957:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_449128 ; jumptable 0041F48D case 9
		test	eax, eax
		jnz	loc_41F9E6
		call	sub_41F123
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgConnectAgen ; "\\gpg-connect-agent.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_449128, eax
		mov	eax, ds:dword_449128
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41F9E6:				; CODE XREF: sub_41F46E+4F0j
		mov	eax, ds:dword_449128
		jmp	loc_41FAA2
; ---------------------------------------------------------------------------

loc_41F9F0:				; CODE XREF: sub_41F46E+1Fj
					; DATA XREF: .rdata:off_445840o
		mov	eax, ds:dword_44912C ; jumptable 0041F48D case 10
		test	eax, eax
		jnz	loc_41FA7F
		call	sub_41F123
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgconf_exe ; "\\gpgconf.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_44912C, eax
		mov	eax, ds:dword_44912C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_433245
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_41FA7F:				; CODE XREF: sub_41F46E+589j
		mov	eax, ds:dword_44912C
		jmp	short loc_41FAA2
; ---------------------------------------------------------------------------

loc_41FA86:				; CODE XREF: sub_41F46E+Cj
					; sub_41F46E+1Fj
					; DATA XREF: ...
		mov	[esp+38h+var_30], offset aGnupg_module_n ; jumptable 0041F48D default case
		mov	[esp+38h+Source], 229h
		mov	[esp+38h+Dest],	offset a____Gnupg22_11 ; "../../gnupg2-2.0.30/common/homedir.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_41FAA2:				; CODE XREF: sub_41F46E+B5j
					; sub_41F46E+14Ej ...
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41F46E	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FAAC	proc near		; CODE XREF: sub_41FAD3+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41FACC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_41FAD1
; ---------------------------------------------------------------------------

loc_41FACC:				; CODE XREF: sub_41FAAC+7j
		mov	eax, 0

loc_41FAD1:				; CODE XREF: sub_41FAAC+1Ej
		pop	ebp
		retn
sub_41FAAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FAD3	proc near		; CODE XREF: sub_41FAEE+Ep
					; sub_41FFEE+1Dp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_41FAAC
		leave
		retn
sub_41FAD3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FAEE	proc near		; CODE XREF: sub_41FD04+1BFp
					; sub_41FD04+24Bp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_41FAD3
		leave
		retn
sub_41FAEE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FB03	proc near		; CODE XREF: sub_4201C8+107p
					; sub_4201C8+117p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_41FB03	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FB0D	proc near		; CODE XREF: sub_408650+3ABp
					; sub_40E682+CCp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		js	short loc_41FB29
		mov	eax, [ebp+var_4]
		cmp	eax, 7
		jbe	short loc_41FB30

loc_41FB29:				; CODE XREF: sub_41FB0D+12j
		mov	eax, 0
		jmp	short locret_41FB5A
; ---------------------------------------------------------------------------

loc_41FB30:				; CODE XREF: sub_41FB0D+1Aj
		mov	eax, [ebp+var_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		cmp	[ebp+arg_4], 0
		jz	short loc_41FB50
		mov	eax, [ebp+var_4]
		mov	edx, off_43D824[eax*8]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_41FB50:				; CODE XREF: sub_41FB0D+32j
		mov	eax, [ebp+var_4]
		mov	eax, off_43D820[eax*8]

locret_41FB5A:				; CODE XREF: sub_41FB0D+21j
		leave
		retn
sub_41FB0D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FB5C	proc near		; CODE XREF: sub_402066+267p
					; sub_402066:loc_4030D4p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0Ch
		mov	[esp+28h+var_28], 1
		call	gcry_calloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41FBD2
		mov	eax, ds:dword_449280
		test	eax, eax
		jz	short loc_41FB8F
		mov	eax, ds:dword_449280
		jmp	short loc_41FB94
; ---------------------------------------------------------------------------

loc_41FB8F:				; CODE XREF: sub_41FB5C+2Aj
		mov	eax, 8

loc_41FB94:				; CODE XREF: sub_41FB5C+31j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_24], 4
		mov	[esp+28h+var_28], eax
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_41FBD2
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	[ebp+var_C], 0

loc_41FBD2:				; CODE XREF: sub_41FB5C+21j
					; sub_41FB5C+62j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41FB5C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FBD7	proc near		; CODE XREF: sub_4034A8+Fp
					; sub_40846E+112p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	loc_41FC74
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 8
		jbe	short loc_41FC13
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3Ah
		ja	short loc_41FC13
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, ds:dword_449280
		cmp	edx, eax
		jbe	short loc_41FC13
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	ds:dword_449280, eax

loc_41FC13:				; CODE XREF: sub_41FBD7+18j
					; sub_41FBD7+22j ...
		mov	[ebp+var_C], 0
		jmp	short loc_41FC4C
; ---------------------------------------------------------------------------

loc_41FC1C:				; CODE XREF: sub_41FBD7+80j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41FC48
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	gcry_free

loc_41FC48:				; CODE XREF: sub_41FBD7+57j
		add	[ebp+var_C], 1

loc_41FC4C:				; CODE XREF: sub_41FBD7+43j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_41FC1C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short locret_41FC75
; ---------------------------------------------------------------------------

loc_41FC74:				; CODE XREF: sub_41FBD7+Aj
		nop

locret_41FC75:				; CODE XREF: sub_41FBD7+9Bj
		leave
		retn
sub_41FBD7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41FC77(int, char *)
sub_41FC77	proc near		; CODE XREF: sub_41FFEE+63p
					; sub_42008C+38p

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_41FCF0
; ---------------------------------------------------------------------------

loc_41FC86:				; CODE XREF: sub_41FC77+84j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41FCEC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41FCEC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+28h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 0

loc_41FCEC:				; CODE XREF: sub_41FC77+21j
					; sub_41FC77+47j
		add	[ebp+var_C], 1

loc_41FCF0:				; CODE XREF: sub_41FC77+Dj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_41FC86
		mov	eax, 0
		leave
		retn
sub_41FC77	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41FD04(int, char *, size_t, int, int)
sub_41FD04	proc near		; CODE XREF: sub_41FFEE+97p
					; sub_42008C+7Ep ...

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
MaxCount	= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Size		= dword	ptr -18h
Src		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_10], 0FFFFFFFFh
		cmp	[ebp+arg_C], 0
		jz	short loc_41FD20
		mov	eax, [ebp+arg_C]
		mov	[ebp+Src], eax
		jmp	short loc_41FD2C
; ---------------------------------------------------------------------------

loc_41FD20:				; CODE XREF: sub_41FD04+12j
		mov	eax, [ebp+arg_8]
		add	eax, 1
		add	eax, [ebp+arg_4]
		mov	[ebp+Src], eax

loc_41FD2C:				; CODE XREF: sub_41FD04+1Aj
		mov	eax, [ebp+Src]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+Size], eax
		mov	[ebp+var_C], 0
		jmp	loc_41FE6E
; ---------------------------------------------------------------------------

loc_41FD5A:				; CODE XREF: sub_41FD04+175j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41FD79
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	loc_41FE6A
; ---------------------------------------------------------------------------

loc_41FD79:				; CODE XREF: sub_41FD04+68j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+MaxCount], eax	; MaxCount
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strncmp
		test	eax, eax
		jnz	loc_41FE6A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		add	eax, 8
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, [ebp+arg_8]
		jnz	loc_41FE6A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, [ebp+Size]
		jnz	short loc_41FE64
		mov	edx, [ebp+Src]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [ebp+var_C]
		shl	ecx, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	eax, [eax]
		mov	ecx, [ebp+Size]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	[ebp+arg_10], 0
		setnz	dl
		movzx	edx, dl
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_41FFE8
; ---------------------------------------------------------------------------

loc_41FE64:				; CODE XREF: sub_41FD04+10Fj
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax

loc_41FE6A:				; CODE XREF: sub_41FD04+70j
					; sub_41FD04+A0j ...
		add	[ebp+var_C], 1

loc_41FE6E:				; CODE XREF: sub_41FD04+51j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_41FD5A
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	loc_41FF33
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	edx, eax
		jnz	loc_41FF21
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		add	eax, 0Ah
		mov	[ebp+var_1C], eax
		mov	[esp+48h+Str2],	4
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str1],	eax
		call	gcry_calloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_41FECD
		call	sub_41FAEE
		jmp	loc_41FFE8
; ---------------------------------------------------------------------------

loc_41FECD:				; CODE XREF: sub_41FD04+1BDj
		mov	[ebp+var_C], 0
		jmp	short loc_41FEF5
; ---------------------------------------------------------------------------

loc_41FED6:				; CODE XREF: sub_41FD04+1FCj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_20]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	ecx, [ebp+var_C]
		shl	ecx, 2
		add	edx, ecx
		mov	edx, [edx]
		mov	[eax], edx
		add	[ebp+var_C], 1

loc_41FEF5:				; CODE XREF: sub_41FD04+1D0j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_41FED6
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+8], edx

loc_41FF21:				; CODE XREF: sub_41FD04+192j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx

loc_41FF33:				; CODE XREF: sub_41FD04+17Fj
		mov	eax, [ebp+Size]
		mov	edx, [ebp+arg_8]
		add	eax, edx
		add	eax, 0Dh
		mov	[esp+48h+Str1],	eax
		call	gcry_malloc
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_41FF59
		call	sub_41FAEE
		jmp	loc_41FFE8
; ---------------------------------------------------------------------------

loc_41FF59:				; CODE XREF: sub_41FD04+249j
		cmp	[ebp+arg_10], 0
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_24]
		mov	[eax+4], edx
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_24]
		add	eax, 8
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_8]
		add	eax, edx
		mov	byte ptr [eax+8], 0
		mov	eax, [ebp+var_24]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_8]
		add	eax, 1
		add	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], edx
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		mov	edx, [ebp+Src]
		mov	[esp+48h+Str2],	edx ; Source
		mov	[esp+48h+Str1],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_24]
		mov	[edx], eax
		mov	eax, 0

loc_41FFE8:				; CODE XREF: sub_41FD04+15Bj
					; sub_41FD04+1C4j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_41FD04	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41FFEE(int, char *)
sub_41FFEE	proc near		; CODE XREF: sub_408B92+43p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_4], 0
		jz	short loc_420004
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_420012

loc_420004:				; CODE XREF: sub_41FFEE+Aj
		mov	[esp+38h+Str], 37h
		call	sub_41FAD3
		jmp	short locret_42008A
; ---------------------------------------------------------------------------

loc_420012:				; CODE XREF: sub_41FFEE+14j
		mov	[esp+38h+Val], 3Dh ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_42003E
		mov	[esp+38h+Str], 37h
		call	sub_41FAD3
		jmp	short locret_42008A
; ---------------------------------------------------------------------------

loc_42003E:				; CODE XREF: sub_41FFEE+40j
		cmp	[ebp+var_C], 0
		jnz	short loc_420058
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_41FC77
		jmp	short locret_42008A
; ---------------------------------------------------------------------------

loc_420058:				; CODE XREF: sub_41FFEE+54j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+38h+var_28], 0 ; int
		mov	[esp+38h+var_2C], 0 ; int
		mov	[esp+38h+var_30], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_41FD04

locret_42008A:				; CODE XREF: sub_41FFEE+22j
					; sub_41FFEE+4Ej ...
		leave
		retn
sub_41FFEE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42008C(int, char *, int)
sub_42008C	proc near		; CODE XREF: sub_402066+2DFp
					; sub_402066+351p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_4], 0
		jz	short loc_4200A3
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4200B1

loc_4200A3:				; CODE XREF: sub_42008C+Bj
		mov	[esp+38h+var_38], 37h
		call	sub_41FAD3
		jmp	short loc_42010F
; ---------------------------------------------------------------------------

loc_4200B1:				; CODE XREF: sub_42008C+15j
		cmp	[ebp+arg_8], 0
		jnz	short loc_4200CB
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_41FC77
		jmp	short loc_42010F
; ---------------------------------------------------------------------------

loc_4200CB:				; CODE XREF: sub_42008C+29j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+38h+var_28], 0 ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax ;	int
		mov	[esp+38h+var_30], edx ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_41FD04

loc_42010F:				; CODE XREF: sub_42008C+23j
					; sub_42008C+3Dj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_42008C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_420115(int, char *)
sub_420115	proc near		; CODE XREF: sub_40846E+5Fp
					; sub_40DE3A+2Cp ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_420131
		cmp	[ebp+arg_4], 0
		jz	short loc_420131
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42013B

loc_420131:				; CODE XREF: sub_420115+Aj
					; sub_420115+10j
		mov	eax, 0
		jmp	locret_4201C6
; ---------------------------------------------------------------------------

loc_42013B:				; CODE XREF: sub_420115+1Aj
		mov	[ebp+var_C], 0
		jmp	short loc_4201B4
; ---------------------------------------------------------------------------

loc_420144:				; CODE XREF: sub_420115+AAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4201B0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4201B0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_4201A9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		jmp	short loc_4201AE
; ---------------------------------------------------------------------------

loc_4201A9:				; CODE XREF: sub_420115+7Ej
		mov	eax, 0

loc_4201AE:				; CODE XREF: sub_420115+92j
		jmp	short locret_4201C6
; ---------------------------------------------------------------------------

loc_4201B0:				; CODE XREF: sub_420115+41j
					; sub_420115+67j
		add	[ebp+var_C], 1

loc_4201B4:				; CODE XREF: sub_420115+2Dj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_420144
		mov	eax, 0

locret_4201C6:				; CODE XREF: sub_420115+21j
					; sub_420115:loc_4201AEj
		leave
		retn
sub_420115	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4201C8(int, char *VarName, int)
sub_4201C8	proc near		; CODE XREF: sub_408650+2F9p

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
VarName		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	[ebp+arg_8], 0
		jz	short loc_4201DE
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_4201DE:				; CODE XREF: sub_4201C8+Bj
		cmp	[ebp+arg_0], 0
		jz	short loc_4201F4
		cmp	[ebp+VarName], 0
		jz	short loc_4201F4
		mov	eax, [ebp+VarName]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4201FE

loc_4201F4:				; CODE XREF: sub_4201C8+1Aj
					; sub_4201C8+20j
		mov	eax, 0
		jmp	loc_4203CC
; ---------------------------------------------------------------------------

loc_4201FE:				; CODE XREF: sub_4201C8+2Aj
		mov	[ebp+var_C], 0
		jmp	short loc_420282
; ---------------------------------------------------------------------------

loc_420207:				; CODE XREF: sub_4201C8+C5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42027E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_42027E
		cmp	[ebp+arg_8], 0
		jz	short loc_420267
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_420267
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1

loc_420267:				; CODE XREF: sub_4201C8+7Dj
					; sub_4201C8+94j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		jmp	loc_4203CC
; ---------------------------------------------------------------------------

loc_42027E:				; CODE XREF: sub_4201C8+51j
					; sub_4201C8+77j
		add	[ebp+var_C], 1

loc_420282:				; CODE XREF: sub_4201C8+3Dj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_420207
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str1],	eax ; VarName
		call	getenv
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4202B1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4202E7

loc_4202B1:				; CODE XREF: sub_4201C8+DDj
		mov	[esp+48h+Str2],	offset aGpg_tty_2 ; "GPG_TTY"
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4202E7
		mov	[esp+48h+Str1],	0
		call	sub_41FB03
		test	eax, eax
		jz	short loc_4202E7
		mov	[esp+48h+Str1],	0
		call	sub_41FB03
		mov	[ebp+var_10], eax

loc_4202E7:				; CODE XREF: sub_4201C8+E7j
					; sub_4201C8+FEj ...
		cmp	[ebp+var_10], 0
		jz	loc_4203C7
		mov	eax, [ebp+VarName]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+48h+var_38], 1 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_3C], eax ;	int
		mov	[esp+48h+var_40], edx ;	size_t
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str2],	eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str1],	eax ; int
		call	sub_41FD04
		mov	[ebp+var_C], 0
		jmp	short loc_4203B6
; ---------------------------------------------------------------------------

loc_42033E:				; CODE XREF: sub_4201C8+1F9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4203B2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4203B2
		cmp	[ebp+arg_8], 0
		jz	short loc_42039E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_42039E
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1

loc_42039E:				; CODE XREF: sub_4201C8+1B4j
					; sub_4201C8+1CBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		jmp	short loc_4203CC
; ---------------------------------------------------------------------------

loc_4203B2:				; CODE XREF: sub_4201C8+188j
					; sub_4201C8+1AEj
		add	[ebp+var_C], 1

loc_4203B6:				; CODE XREF: sub_4201C8+174j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_42033E

loc_4203C7:				; CODE XREF: sub_4201C8+123j
		mov	eax, 0

loc_4203CC:				; CODE XREF: sub_4201C8+31j
					; sub_4201C8+B1j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_4201C8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-4], eax
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4203EC
		cmp	dword ptr [ebp-4], 0
		jns	short loc_42046B

loc_4203EC:				; CODE XREF: .text:004203E4j
		mov	eax, 0
		jmp	locret_420482
; ---------------------------------------------------------------------------

loc_4203F6:				; CODE XREF: .text:00420477j
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_420465
		mov	eax, [ebp-4]
		lea	edx, [eax+1]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_420433
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	edx, [eax+4]
		mov	eax, [ebp+14h]
		mov	[eax], edx

loc_420433:				; CODE XREF: .text:00420419j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_420450
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	edx, [eax]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_420450:				; CODE XREF: .text:00420437j
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		add	eax, 8
		jmp	short locret_420482
; ---------------------------------------------------------------------------

loc_420465:				; CODE XREF: .text:00420408j
		add	dword ptr [ebp-4], 1
		jmp	short loc_42046C
; ---------------------------------------------------------------------------

loc_42046B:				; CODE XREF: .text:004203EAj
		nop

loc_42046C:				; CODE XREF: .text:00420469j
		mov	edx, [ebp-4]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_4203F6
		mov	eax, 0

locret_420482:				; CODE XREF: .text:004203F1j
					; .text:00420463j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_420484	proc near		; CODE XREF: sub_4204AB+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4204A4
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4204A9
; ---------------------------------------------------------------------------

loc_4204A4:				; CODE XREF: sub_420484+7j
		mov	eax, 0

loc_4204A9:				; CODE XREF: sub_420484+1Ej
		pop	ebp
		retn
sub_420484	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4204AB	proc near		; CODE XREF: sub_421291+17p
					; sub_421291+4Bp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_420484
		leave
		retn
sub_4204AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4204C6	proc near		; CODE XREF: sub_411036+6p
					; sub_411372+E4p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0
		call	sub_43BBF0
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_4492A4
		test	eax, eax
		jnz	short loc_4204E9
		mov	eax, [ebp+var_C]
		jmp	short locret_42051E
; ---------------------------------------------------------------------------

loc_4204E9:				; CODE XREF: sub_4204C6+1Cj
		mov	eax, ds:dword_4492A4
		cmp	eax, 1
		jnz	short loc_4204FA
		mov	eax, ds:dword_4492A0
		jmp	short locret_42051E
; ---------------------------------------------------------------------------

loc_4204FA:				; CODE XREF: sub_4204C6+2Bj
		mov	eax, ds:dword_4492A4
		cmp	eax, 2
		jnz	short loc_420510
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_4492A0
		add	eax, edx
		jmp	short locret_42051E
; ---------------------------------------------------------------------------

loc_420510:				; CODE XREF: sub_4204C6+3Cj
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_4492A0
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_42051E:				; CODE XREF: sub_4204C6+21j
					; sub_4204C6+32j ...
		leave
		retn
sub_4204C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_420520	proc near		; CODE XREF: sub_411B5F+E3p
					; sub_415A18+4Ap

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		call	sub_4204C6
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		test	eax, eax
		jns	short loc_420540
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		jmp	short loc_4205AD
; ---------------------------------------------------------------------------

loc_420540:				; CODE XREF: sub_420520+16j
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_43C0F0
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax]
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0Ch]
		mov	esi, [ebp+var_1C]
		mov	esi, [esi+10h]
		lea	edi, [esi+1]
		mov	esi, [ebp+var_1C]
		mov	esi, [esi+14h]
		add	esi, 76Ch
		mov	[esp+58h+var_38], ebx
		mov	[esp+58h+var_3C], ecx
		mov	[esp+58h+var_40], edx
		mov	[esp+58h+var_44], eax
		mov	[esp+58h+var_48], edi
		mov	[esp+58h+var_4C], esi
		mov	[esp+58h+var_50], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	[esp+58h+var_54], 10h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4241F9

loc_4205AD:				; CODE XREF: sub_420520+1Ej
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_420520	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4205B5	proc near		; CODE XREF: sub_402066+9F7p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0
		call	sub_43BBF0
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	short loc_4205D8
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_4205EE

loc_4205D8:				; CODE XREF: sub_4205B5+19j
		mov	ds:dword_4492A4, 0
		mov	ds:dword_4492A0, 0
		jmp	short locret_420648
; ---------------------------------------------------------------------------

loc_4205EE:				; CODE XREF: sub_4205B5+21j
		cmp	[ebp+arg_4], 0
		jz	short loc_420608
		mov	ds:dword_4492A4, 1
		mov	eax, [ebp+var_C]
		mov	ds:dword_4492A0, eax
		jmp	short locret_420648
; ---------------------------------------------------------------------------

loc_420608:				; CODE XREF: sub_4205B5+3Dj
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_C]
		jle	short loc_42062D
		mov	ds:dword_4492A4, 2
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_4492A0, eax
		jmp	short locret_420648
; ---------------------------------------------------------------------------

loc_42062D:				; CODE XREF: sub_4205B5+59j
		mov	ds:dword_4492A4, 3
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_4492A0, eax

locret_420648:				; CODE XREF: sub_4205B5+37j
					; sub_4205B5+51j ...
		leave
		retn
sub_4205B5	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4492A4
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_4204C6
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_420674
		mov	dword ptr [esp], offset	aGnupg_get_time	; "gnupg_get_time() failed\n"
		call	sub_435BC0
; ---------------------------------------------------------------------------

loc_420674:				; CODE XREF: .text:00420666j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-4Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-4Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Ah
		jnz	short loc_4206BF
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4206BF
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_4206C9

loc_4206BF:				; CODE XREF: .text:004206A3j
					; .text:004206B0j
		mov	eax, 0
		jmp	loc_420828
; ---------------------------------------------------------------------------

loc_4206C9:				; CODE XREF: .text:004206BDj
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4206FA
; ---------------------------------------------------------------------------

loc_4206D2:				; CODE XREF: .text:004206FEj
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4206EC
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4206F6

loc_4206EC:				; CODE XREF: .text:004206DDj
		mov	eax, 0
		jmp	loc_420828
; ---------------------------------------------------------------------------

loc_4206F6:				; CODE XREF: .text:004206EAj
		add	dword ptr [ebp-0Ch], 1

loc_4206FA:				; CODE XREF: .text:004206D0j
		cmp	dword ptr [ebp-0Ch], 3
		jle	short loc_4206D2
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_420734
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_420734
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_420734
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42073E

loc_420734:				; CODE XREF: .text:0042070Bj
					; .text:00420718j ...
		mov	eax, 0
		jmp	loc_420828
; ---------------------------------------------------------------------------

loc_42073E:				; CODE XREF: .text:00420732j
		mov	eax, [ebp+8]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_420772
		mov	eax, [ebp+8]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_420772
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_420772
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42077C

loc_420772:				; CODE XREF: .text:00420749j
					; .text:00420756j ...
		mov	eax, 0
		jmp	loc_420828
; ---------------------------------------------------------------------------

loc_42077C:				; CODE XREF: .text:00420770j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	atoi
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 5
		mov	[esp], eax
		call	atoi
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 8
		mov	[esp], eax
		call	atoi
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-10h], 7B1h
		jle	short loc_4207CD
		cmp	dword ptr [ebp-14h], 0
		jle	short loc_4207CD
		cmp	dword ptr [ebp-14h], 0Ch
		jg	short loc_4207CD
		cmp	dword ptr [ebp-18h], 0
		jle	short loc_4207CD
		cmp	dword ptr [ebp-18h], 1Fh
		jle	short loc_4207D4

loc_4207CD:				; CODE XREF: .text:004207B3j
					; .text:004207B9j ...
		mov	eax, 0
		jmp	short loc_420828
; ---------------------------------------------------------------------------

loc_4207D4:				; CODE XREF: .text:004207CBj
		lea	eax, [ebp-40h]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 9
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp-18h]
		mov	[ebp-34h], eax
		mov	eax, [ebp-14h]
		sub	eax, 1
		mov	[ebp-30h], eax
		mov	eax, [ebp-10h]
		sub	eax, 76Ch
		mov	[ebp-2Ch], eax
		mov	dword ptr [ebp-20h], 0FFFFFFFFh
		lea	eax, [ebp-40h]
		mov	[esp], eax
		call	sub_43C100
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jnz	short loc_420825
		mov	eax, 0
		jmp	short loc_420828
; ---------------------------------------------------------------------------

loc_420825:				; CODE XREF: .text:0042081Cj
		mov	eax, [ebp-1Ch]

loc_420828:				; CODE XREF: .text:004206C4j
					; .text:004206F1j ...
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42082F	proc near		; CODE XREF: sub_402066+9ACp

C		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42084B
		mov	eax, 0FFFFFFFFh
		jmp	loc_420AF1
; ---------------------------------------------------------------------------

loc_42084B:				; CODE XREF: sub_42082F+10j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_420880
; ---------------------------------------------------------------------------

loc_42085A:				; CODE XREF: sub_42082F+55j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42086E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_420878

loc_42086E:				; CODE XREF: sub_42082F+33j
		mov	eax, 0FFFFFFFFh
		jmp	loc_420AF1
; ---------------------------------------------------------------------------

loc_420878:				; CODE XREF: sub_42082F+3Dj
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_420880:				; CODE XREF: sub_42082F+29j
		cmp	[ebp+var_10], 7
		jle	short loc_42085A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_42089A
		mov	eax, 0FFFFFFFFh
		jmp	loc_420AF1
; ---------------------------------------------------------------------------

loc_42089A:				; CODE XREF: sub_42082F+5Fj
		add	[ebp+var_C], 1
		mov	[ebp+var_10], 9
		jmp	short loc_4208CD
; ---------------------------------------------------------------------------

loc_4208A7:				; CODE XREF: sub_42082F+A2j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4208BB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4208C5

loc_4208BB:				; CODE XREF: sub_42082F+80j
		mov	eax, 0FFFFFFFFh
		jmp	loc_420AF1
; ---------------------------------------------------------------------------

loc_4208C5:				; CODE XREF: sub_42082F+8Aj
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_4208CD:				; CODE XREF: sub_42082F+76j
		cmp	[ebp+var_10], 0Eh
		jle	short loc_4208A7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42091C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_4208FE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+68h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_42091C

loc_4208FE:				; CODE XREF: sub_42082F+B6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42091C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ch
		jz	short loc_42091C
		mov	eax, 0FFFFFFFFh
		jmp	loc_420AF1
; ---------------------------------------------------------------------------

loc_42091C:				; CODE XREF: sub_42082F+ACj
					; sub_42082F+CDj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_28], eax
		cmp	[ebp+var_14], 7B1h
		jle	short loc_420A97
		cmp	[ebp+var_18], 0
		jle	short loc_420A97
		cmp	[ebp+var_18], 0Ch
		jg	short loc_420A97
		cmp	[ebp+var_1C], 0
		jle	short loc_420A97
		cmp	[ebp+var_1C], 1Fh
		jg	short loc_420A97
		cmp	[ebp+var_20], 17h
		jg	short loc_420A97
		cmp	[ebp+var_24], 3Bh
		jg	short loc_420A97
		cmp	[ebp+var_28], 3Dh
		jle	short loc_420A9E

loc_420A97:				; CODE XREF: sub_42082F+23Cj
					; sub_42082F+242j ...
		mov	eax, 0FFFFFFFFh
		jmp	short loc_420AF1
; ---------------------------------------------------------------------------

loc_420A9E:				; CODE XREF: sub_42082F+266j
		lea	eax, [ebp+var_4C]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 9
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp+var_28]
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_14]
		sub	eax, 76Ch
		mov	[ebp+var_38], eax
		mov	[ebp+var_2C], 0FFFFFFFFh
		lea	eax, [ebp+var_4C]
		mov	[esp+68h+C], eax
		call	sub_4393C2

loc_420AF1:				; CODE XREF: sub_42082F+17j
					; sub_42082F+44j ...
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42082F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+0Ch]
		test	eax, eax
		jns	short loc_420B10
		mov	eax, [ebp+8]
		mov	byte ptr [eax],	0
		jmp	short loc_420B7D
; ---------------------------------------------------------------------------

loc_420B10:				; CODE XREF: .text:00420B06j
		lea	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_43C0F0
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	ebx, [eax]
		mov	eax, [ebp-1Ch]
		mov	ecx, [eax+4]
		mov	eax, [ebp-1Ch]
		mov	edx, [eax+8]
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+0Ch]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+10h]
		lea	edi, [esi+1]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+14h]
		add	esi, 76Ch
		mov	[esp+20h], ebx
		mov	[esp+1Ch], ecx
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	[esp+10h], edi
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4241F9

loc_420B7D:				; CODE XREF: .text:00420B0Ej
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+0Ch]
		mov	[ebp-4], ax
		movzx	eax, word ptr [ebp-4]
		imul	eax, 15180h
		add	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+8]
		mov	[ebp-1Ch], eax
		mov	edx, 88888889h
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 5
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 88888889h
		mov	eax, ecx
		mul	edx
		mov	eax, edx
		shr	eax, 5
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-0Ch], eax
		mov	edx, [ebp+8]
		mov	[ebp-1Ch], edx
		mov	edx, 88888889h
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 5
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 0AAAAAAABh
		mov	eax, ecx
		mul	edx
		shr	edx, 4
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	[ebp-1Ch], eax
		mov	edx, 0AAAAAAABh
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 4
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 6719F361h
		mov	eax, ecx
		mul	edx
		mov	eax, ecx
		sub	eax, edx
		shr	eax, 1
		add	eax, edx
		shr	eax, 8
		imul	eax, 16Dh
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-14h], eax
		mov	ecx, [ebp+8]
		mov	edx, 6719F361h
		mov	eax, ecx
		mul	edx
		mov	eax, ecx
		sub	eax, edx
		shr	eax, 1
		add	eax, edx
		shr	eax, 8
		mov	[ebp+8], eax
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, offset aUyUdUhUm ;	"%uy%ud%uh%um"
		mov	edx, [ebp-0Ch]
		mov	[esp+14h], edx
		mov	edx, [ebp-10h]
		mov	[esp+10h], edx
		mov	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_449320
		call	sprintf
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_420CB6
		mov	eax, offset dword_449320
		jmp	short locret_420CEC
; ---------------------------------------------------------------------------

loc_420CB6:				; CODE XREF: .text:00420CADj
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_420CD5
		mov	dword ptr [esp+4], 79h
		mov	dword ptr [esp], offset	dword_449320
		call	strchr
		add	eax, 1
		jmp	short locret_420CEC
; ---------------------------------------------------------------------------

loc_420CD5:				; CODE XREF: .text:00420CBAj
		mov	dword ptr [esp+4], 64h
		mov	dword ptr [esp], offset	dword_449320
		call	strchr
		add	eax, 1

locret_420CEC:				; CODE XREF: .text:00420CB4j
					; .text:00420CD3j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jns	short loc_420D2E
		mov	eax, offset a???????? ;	"????-??-??"
		mov	edx, [eax]
		mov	ds:dword_449310, edx
		mov	edx, [eax+4]
		mov	ds:dword_449314, edx
		movzx	edx, word ptr [eax+8]
		mov	ds:word_449318,	dx
		movzx	eax, byte ptr [eax+0Ah]
		mov	ds:byte_44931A,	al
		jmp	short loc_420D78
; ---------------------------------------------------------------------------

loc_420D2E:				; CODE XREF: .text:00420D00j
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_43C0F0
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+10h]
		lea	ebx, [eax+1]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+14h]
		lea	ecx, [eax+76Ch]
		mov	eax, offset a04d02d02d ; "%04d-%02d-%02d"
		mov	[esp+10h], edx
		mov	[esp+0Ch], ebx
		mov	[esp+8], ecx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_449310
		call	sprintf

loc_420D78:				; CODE XREF: .text:00420D2Cj
		mov	eax, offset dword_449310
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+8]
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		test	eax, eax
		jns	short loc_420DCB
		mov	eax, offset a?????????????? ; "????-??-?? ??:??:??"
		mov	edx, [eax]
		mov	ds:dword_4492F2, edx
		mov	edx, [eax+4]
		mov	ds:dword_4492F6, edx
		mov	edx, [eax+8]
		mov	ds:dword_4492FA, edx
		mov	edx, [eax+0Ch]
		mov	ds:dword_4492FE, edx
		mov	eax, [eax+10h]
		mov	ds:dword_449302, eax
		jmp	short loc_420E38
; ---------------------------------------------------------------------------

loc_420DCB:				; CODE XREF: .text:00420D97j
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_43C0F0
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	esi, [eax]
		mov	eax, [ebp-1Ch]
		mov	ebx, [eax+4]
		mov	eax, [ebp-1Ch]
		mov	ecx, [eax+8]
		mov	eax, [ebp-1Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp-2Ch], eax
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+14h]
		lea	edi, [eax+76Ch]
		mov	eax, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d"
		mov	[esp+1Ch], esi
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	edx, [ebp-2Ch]
		mov	[esp+0Ch], edx
		mov	[esp+8], edi
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4492F2
		call	sprintf

loc_420E38:				; CODE XREF: .text:00420DC9j
		mov	eax, offset dword_4492F2
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jns	short loc_420E89
		mov	eax, offset a???????? ;	"????-??-??"
		mov	edx, [eax]
		mov	ds:dword_4492C0, edx
		mov	edx, [eax+4]
		mov	ds:dword_4492C4, edx
		movzx	edx, word ptr [eax+8]
		mov	ds:word_4492C8,	dx
		movzx	eax, byte ptr [eax+0Ah]
		mov	ds:byte_4492CA,	al
		mov	eax, offset dword_4492C0
		jmp	short locret_420EC7
; ---------------------------------------------------------------------------

loc_420E89:				; CODE XREF: .text:00420E56j
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_43C0E0
		mov	[ebp-0Ch], eax
		mov	edx, [ebp-0Ch]
		mov	eax, offset aCZ	; "%c %Z"
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 31h
		mov	dword ptr [esp], offset	dword_4492C0
		call	strftime
		mov	ds:byte_4492F1,	0
		mov	eax, offset dword_4492C0

locret_420EC7:				; CODE XREF: .text:00420E87j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_420EC9	proc near		; CODE XREF: sub_4210F3+8Dp

var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_420F39
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_420F39
		mov	[ebp+var_8], 0

loc_420F39:				; CODE XREF: sub_420EC9+3Dj
					; sub_420EC9+67j
		cmp	[ebp+var_8], 0
		jz	short loc_420F46
		mov	eax, 16Eh
		jmp	short loc_420F4B
; ---------------------------------------------------------------------------

loc_420F46:				; CODE XREF: sub_420EC9+74j
		mov	eax, 16Dh

loc_420F4B:				; CODE XREF: sub_420EC9+7Bj
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_420EC9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_420F51	proc near		; CODE XREF: sub_4210F3+105p
					; sub_4210F3+125p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	[ebp+arg_4], 0Ch
		ja	loc_421028
		mov	eax, [ebp+arg_4]
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		and	edx, 15AAh
		test	edx, edx
		jnz	short loc_420F9A
		mov	edx, eax
		and	edx, 0A50h
		test	edx, edx
		jnz	loc_421021
		and	eax, 4
		test	eax, eax
		jnz	short loc_420FA4
		jmp	loc_421028
; ---------------------------------------------------------------------------

loc_420F9A:				; CODE XREF: sub_420F51+2Bj
		mov	eax, 1Fh
		jmp	loc_421044
; ---------------------------------------------------------------------------

loc_420FA4:				; CODE XREF: sub_420F51+42j
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_42100D
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_42100D
		mov	[ebp+var_C], 0

loc_42100D:				; CODE XREF: sub_420F51+89j
					; sub_420F51+B3j
		cmp	[ebp+var_C], 0
		jz	short loc_42101A
		mov	eax, 1Dh
		jmp	short loc_42101F
; ---------------------------------------------------------------------------

loc_42101A:				; CODE XREF: sub_420F51+C0j
		mov	eax, 1Ch

loc_42101F:				; CODE XREF: sub_420F51+C7j
		jmp	short loc_421044
; ---------------------------------------------------------------------------

loc_421021:				; CODE XREF: sub_420F51+37j
		mov	eax, 1Eh
		jmp	short loc_421044
; ---------------------------------------------------------------------------

loc_421028:				; CODE XREF: sub_420F51+Bj
					; sub_420F51+44j
		mov	[esp+28h+var_20], offset aDays_per_month ; "days_per_month"
		mov	[esp+28h+var_24], 191h
		mov	[esp+28h+var_28], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/gettime.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_421044:				; CODE XREF: sub_420F51+4Ej
					; sub_420F51:loc_42101Fj ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_420F51	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42104A	proc near		; CODE XREF: sub_4210F3+76p
					; sub_4210F3+E7p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		imul	ecx, eax, 16Dh
		mov	eax, [ebp+arg_4]
		lea	edx, [eax-1]
		mov	eax, edx
		shl	eax, 5
		sub	eax, edx
		add	eax, ecx
		add	eax, [ebp+arg_8]
		add	eax, 1A42E4h
		mov	[ebp+var_8], eax
		cmp	[ebp+arg_4], 2
		jg	short loc_421080
		sub	[ebp+arg_0], 1
		jmp	short loc_4210A3
; ---------------------------------------------------------------------------

loc_421080:				; CODE XREF: sub_42104A+2Ej
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		lea	ecx, [eax+17h]
		mov	edx, 66666667h
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		sub	[ebp+var_8], eax

loc_4210A3:				; CODE XREF: sub_42104A+34j
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	ebx, eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		lea	edx, [eax+1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		add	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_42104A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4210F3	proc near		; CODE XREF: .text:00421698p
					; sub_42172A+1E2p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jnz	short loc_421109
		mov	eax, 0
		jmp	locret_42128F
; ---------------------------------------------------------------------------

loc_421109:				; CODE XREF: sub_4210F3+Aj
		cmp	[ebp+arg_0], 1A4450h
		jbe	short loc_42111B
		cmp	[ebp+arg_0], 2B61CDh
		jbe	short loc_421125

loc_42111B:				; CODE XREF: sub_4210F3+1Dj
		mov	eax, 0
		jmp	locret_42128F
; ---------------------------------------------------------------------------

loc_421125:				; CODE XREF: sub_4210F3+26j
		mov	eax, [ebp+arg_0]
		sub	eax, 1A42E4h
		mov	[ebp+var_1C], eax
		mov	edx, 0B30F6353h
		mov	eax, [ebp+var_1C]
		mul	edx
		mov	eax, edx
		shr	eax, 8
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_421155
; ---------------------------------------------------------------------------

loc_421151:				; CODE XREF: sub_4210F3+95j
		add	[ebp+var_C], 1

loc_421155:				; CODE XREF: sub_4210F3+5Cj
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_42104A
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_420EC9
		cmp	[ebp+var_18], eax
		jg	short loc_421151
		mov	ecx, [ebp+var_18]
		mov	edx, 84210843h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 4
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4211C6
; ---------------------------------------------------------------------------

loc_4211B1:				; CODE XREF: sub_4210F3+10Dj
		add	[ebp+var_10], 1
		cmp	[ebp+var_10], 0Ch
		jle	short loc_4211C6
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_4211C6:				; CODE XREF: sub_4210F3+BCj
					; sub_4210F3+C6j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_42104A
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_420F51
		cmp	[ebp+var_18], eax
		jg	short loc_4211B1
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_420F51
		cmp	eax, [ebp+var_14]
		jge	short loc_42122D
		mov	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_42122D:				; CODE XREF: sub_4210F3+12Dj
		cmp	[ebp+var_10], 0Ch
		jle	short loc_42123E
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_42123E:				; CODE XREF: sub_4210F3+13Ej
		cmp	[ebp+arg_4], 0
		jz	short loc_42124C
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_42124C:				; CODE XREF: sub_4210F3+14Fj
		cmp	[ebp+arg_8], 0
		jz	short loc_42125A
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_42125A:				; CODE XREF: sub_4210F3+15Dj
		cmp	[ebp+arg_C], 0
		jz	short loc_421268
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx

loc_421268:				; CODE XREF: sub_4210F3+16Bj
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_42104A
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1

locret_42128F:				; CODE XREF: sub_4210F3+11j
					; sub_4210F3+2Dj
		leave
		retn
sub_4210F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421291	proc near		; CODE XREF: .text:004213D4p
					; sub_42172A+Dp

var_14		= dword	ptr -14h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4212B2
		mov	[esp+14h+var_14], 1Ah
		call	sub_4204AB
		jmp	locret_42134B
; ---------------------------------------------------------------------------

loc_4212B2:				; CODE XREF: sub_421291+Ej
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_4212EB
; ---------------------------------------------------------------------------

loc_4212C1:				; CODE XREF: sub_421291+5Ej
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4212D5
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4212E3

loc_4212D5:				; CODE XREF: sub_421291+38j
		mov	[esp+14h+var_14], 0A1h
		call	sub_4204AB
		jmp	short locret_42134B
; ---------------------------------------------------------------------------

loc_4212E3:				; CODE XREF: sub_421291+42j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_4212EB:				; CODE XREF: sub_421291+2Ej
		cmp	[ebp+var_4], 7
		jle	short loc_4212C1
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_421309
		mov	[esp+14h+var_14], 0A1h
		call	sub_4204AB
		jmp	short locret_42134B
; ---------------------------------------------------------------------------

loc_421309:				; CODE XREF: sub_421291+68j
		add	[ebp+var_8], 1
		mov	[ebp+var_4], 9
		jmp	short loc_421340
; ---------------------------------------------------------------------------

loc_421316:				; CODE XREF: sub_421291+B3j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42132A
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_421338

loc_42132A:				; CODE XREF: sub_421291+8Dj
		mov	[esp+14h+var_14], 0A1h
		call	sub_4204AB
		jmp	short locret_42134B
; ---------------------------------------------------------------------------

loc_421338:				; CODE XREF: sub_421291+97j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_421340:				; CODE XREF: sub_421291+83j
		cmp	[ebp+var_4], 0Eh
		jle	short loc_421316
		mov	eax, 0

locret_42134B:				; CODE XREF: sub_421291+1Cj
					; sub_421291+50j ...
		leave
		retn
sub_421291	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_421365
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42137B

loc_421365:				; CODE XREF: .text:00421359j
		mov	dword ptr [esp], offset	aNone_1	; "[none]"
		call	sub_435294
		mov	[esp], eax
		call	sub_435C44
		jmp	short loc_4213C0
; ---------------------------------------------------------------------------

loc_42137B:				; CODE XREF: .text:00421363j
		mov	eax, [ebp+8]
		lea	esi, [eax+0Dh]
		mov	eax, [ebp+8]
		lea	ebx, [eax+0Bh]
		mov	eax, [ebp+8]
		lea	ecx, [eax+9]
		mov	eax, [ebp+8]
		lea	edx, [eax+6]
		mov	eax, [ebp+8]
		add	eax, 4
		mov	[esp+18h], esi
		mov	[esp+14h], ebx
		mov	[esp+10h], ecx
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a_4s_2s_2s_2s_2	; "%.4s-%.2s-%.2s %.2s:%.2s:%s"
		call	sub_435C44

loc_4213C0:				; CODE XREF: .text:00421379j
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 64h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_421291
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4213EA
		mov	eax, [ebp-0Ch]
		jmp	loc_421724
; ---------------------------------------------------------------------------

loc_4213EA:				; CODE XREF: .text:004213E0j
		cmp	dword ptr [ebp+0Ch], 0
		js	short loc_4213F9
		cmp	dword ptr [ebp+0Ch], 7FFFFFC1h
		jle	short loc_42140A

loc_4213F9:				; CODE XREF: .text:004213EEj
		mov	dword ptr [esp], 37h
		call	sub_4204AB
		jmp	loc_421724
; ---------------------------------------------------------------------------

loc_42140A:				; CODE XREF: .text:004213F7j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp-24h], eax
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-28h], eax
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-2Ch], eax
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-18h], eax
		mov	eax, [ebp-24h]
		cmp	eax, 62Eh
		jg	short loc_42156D
		mov	dword ptr [esp], 37h
		call	sub_4204AB
		jmp	loc_421724
; ---------------------------------------------------------------------------

loc_42156D:				; CODE XREF: .text:0042155Aj
		mov	eax, [ebp+0Ch]
		add	[ebp-18h], eax
		mov	ecx, [ebp-18h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp-14h], eax
		mov	ecx, [ebp-18h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-18h], eax
		mov	ecx, [ebp-14h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp-10h], eax
		mov	ecx, [ebp-14h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-14h], eax
		mov	ecx, [ebp-10h]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-1Ch], eax
		mov	ecx, [ebp-10h]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-10h], eax
		mov	ecx, [ebp-2Ch]
		mov	edx, [ebp-28h]
		mov	eax, [ebp-24h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_42104A
		mov	edx, [ebp-1Ch]
		add	eax, edx
		mov	[ebp-20h], eax
		lea	eax, [ebp-2Ch]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-28h]
		mov	[esp+8], eax
		lea	eax, [ebp-24h]
		mov	[esp+4], eax
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_4210F3
		mov	eax, [ebp-24h]
		cmp	eax, 270Fh
		jg	short loc_4216CC
		mov	eax, [ebp-28h]
		cmp	eax, 0Ch
		jg	short loc_4216CC
		mov	eax, [ebp-2Ch]
		cmp	eax, 1Fh
		jg	short loc_4216CC
		mov	eax, [ebp-24h]
		test	eax, eax
		js	short loc_4216CC
		mov	eax, [ebp-28h]
		test	eax, eax
		jle	short loc_4216CC
		mov	eax, [ebp-2Ch]
		test	eax, eax
		jg	short loc_4216DA

loc_4216CC:				; CODE XREF: .text:004216A5j
					; .text:004216ADj ...
		mov	dword ptr [esp], 37h
		call	sub_4204AB
		jmp	short loc_421724
; ---------------------------------------------------------------------------

loc_4216DA:				; CODE XREF: .text:004216CAj
		mov	ecx, [ebp-2Ch]
		mov	edx, [ebp-28h]
		mov	eax, [ebp-24h]
		mov	ebx, [ebp-18h]
		mov	[esp+20h], ebx
		mov	ebx, [ebp-14h]
		mov	[esp+1Ch], ebx
		mov	ebx, [ebp-10h]
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4241F9
		mov	eax, 0

loc_421724:				; CODE XREF: .text:004213E5j
					; .text:00421405j ...
		add	esp, 64h
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42172A	proc near		; CODE XREF: sub_411B5F+109p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_421291
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42174D
		mov	eax, [ebp+var_C]
		jmp	loc_421998
; ---------------------------------------------------------------------------

loc_42174D:				; CODE XREF: sub_42172A+19j
		cmp	[ebp+arg_4], 0
		js	short loc_42175C
		cmp	[ebp+arg_4], 37D771h
		jle	short loc_42176D

loc_42175C:				; CODE XREF: sub_42172A+27j
		mov	[esp+58h+var_58], 37h
		call	sub_4204AB
		jmp	loc_421998
; ---------------------------------------------------------------------------

loc_42176D:				; CODE XREF: sub_42172A+30j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_0]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_0]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_20]
		cmp	eax, 62Eh
		jg	short loc_4218D0
		mov	[esp+58h+var_58], 37h
		call	sub_4204AB
		jmp	loc_421998
; ---------------------------------------------------------------------------

loc_4218D0:				; CODE XREF: sub_42172A+193j
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_50], ecx
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	sub_42104A
		mov	edx, [ebp+arg_4]
		add	eax, edx
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_4C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_50], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_4210F3
		mov	eax, [ebp+var_20]
		cmp	eax, 270Fh
		jg	short loc_421940
		mov	eax, [ebp+var_24]
		cmp	eax, 0Ch
		jg	short loc_421940
		mov	eax, [ebp+var_28]
		cmp	eax, 1Fh
		jg	short loc_421940
		mov	eax, [ebp+var_20]
		test	eax, eax
		js	short loc_421940
		mov	eax, [ebp+var_24]
		test	eax, eax
		jle	short loc_421940
		mov	eax, [ebp+var_28]
		test	eax, eax
		jg	short loc_42194E

loc_421940:				; CODE XREF: sub_42172A+1EFj
					; sub_42172A+1F7j ...
		mov	[esp+58h+var_58], 37h
		call	sub_4204AB
		jmp	short loc_421998
; ---------------------------------------------------------------------------

loc_42194E:				; CODE XREF: sub_42172A+214j
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ebx, [ebp+var_18]
		mov	[esp+58h+var_38], ebx
		mov	ebx, [ebp+var_14]
		mov	[esp+58h+var_3C], ebx
		mov	ebx, [ebp+var_10]
		mov	[esp+58h+var_40], ebx
		mov	[esp+58h+var_44], ecx
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	[esp+58h+var_54], 10h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4241F9
		mov	eax, 0

loc_421998:				; CODE XREF: sub_42172A+1Ej
					; sub_42172A+3Ej ...
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_42172A	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4219A0	proc near		; CODE XREF: sub_421BA1+6E9p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_421B9F	; jumptable 004219B9 default case
		mov	eax, ds:off_445A14[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4219BB:				; CODE XREF: sub_4219A0+19j
					; DATA XREF: .rdata:off_445A14o
		mov	eax, [ebp+arg_0] ; jumptable 004219B9 case 0
		mov	dword ptr [eax+24h], 0
		jmp	loc_421B9F	; jumptable 004219B9 default case
; ---------------------------------------------------------------------------

loc_4219CA:				; CODE XREF: sub_4219A0+19j
					; DATA XREF: .rdata:off_445A14o
		mov	eax, [ebp+arg_0] ; jumptable 004219B9 case 1
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_421A32 ; jumptable 004219DC default case
		mov	eax, ds:off_445A60[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4219DE:				; CODE XREF: sub_4219A0+3Cj
					; DATA XREF: .rdata:off_445A60o
		mov	eax, [ebp+arg_0] ; jumptable 004219DC case 1
		mov	dword ptr [eax+24h], 2
		jmp	short loc_421A3D
; ---------------------------------------------------------------------------

loc_4219EA:				; CODE XREF: sub_4219A0+3Cj
					; DATA XREF: .rdata:off_445A60o
		mov	eax, [ebp+arg_0] ; jumptable 004219DC case 2
		mov	dword ptr [eax+24h], 4
		jmp	short loc_421A3D
; ---------------------------------------------------------------------------

loc_4219F6:				; CODE XREF: sub_4219A0+3Cj
					; DATA XREF: .rdata:off_445A60o
		mov	eax, [ebp+arg_0] ; jumptable 004219DC case 3
		mov	dword ptr [eax+24h], 8
		jmp	short loc_421A3D
; ---------------------------------------------------------------------------

loc_421A02:				; CODE XREF: sub_4219A0+3Cj
					; DATA XREF: .rdata:off_445A60o
		mov	eax, [ebp+arg_0] ; jumptable 004219DC case 4
		mov	dword ptr [eax+24h], 0Ah
		jmp	short loc_421A3D
; ---------------------------------------------------------------------------

loc_421A0E:				; CODE XREF: sub_4219A0+3Cj
					; DATA XREF: .rdata:off_445A60o
		mov	eax, [ebp+arg_0] ; jumptable 004219DC case 5
		mov	dword ptr [eax+24h], 0Fh
		jmp	short loc_421A3D
; ---------------------------------------------------------------------------

loc_421A1A:				; CODE XREF: sub_4219A0+3Cj
					; DATA XREF: .rdata:off_445A60o
		mov	eax, [ebp+arg_0] ; jumptable 004219DC case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_421A3D
; ---------------------------------------------------------------------------

loc_421A26:				; CODE XREF: sub_4219A0+3Cj
					; DATA XREF: .rdata:off_445A60o
		mov	eax, [ebp+arg_0] ; jumptable 004219DC case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_421A3D
; ---------------------------------------------------------------------------

loc_421A32:				; CODE XREF: sub_4219A0+33j
					; sub_4219A0+3Cj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 004219DC default case
		mov	dword ptr [eax+24h], 6
		nop

loc_421A3D:				; CODE XREF: sub_4219A0+48j
					; sub_4219A0+54j ...
		jmp	loc_421B9F	; jumptable 004219B9 default case
; ---------------------------------------------------------------------------

loc_421A42:				; CODE XREF: sub_4219A0+19j
					; DATA XREF: .rdata:off_445A14o
		mov	eax, [ebp+arg_0] ; jumptable 004219B9 cases 2-5
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_421AAA ; jumptable 00421A54 default case
		mov	eax, ds:off_445A80[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_421A56:				; CODE XREF: sub_4219A0+B4j
					; DATA XREF: .rdata:off_445A80o
		mov	eax, [ebp+arg_0] ; jumptable 00421A54 case 1
		mov	dword ptr [eax+24h], 3
		jmp	short loc_421AB5
; ---------------------------------------------------------------------------

loc_421A62:				; CODE XREF: sub_4219A0+B4j
					; DATA XREF: .rdata:off_445A80o
		mov	eax, [ebp+arg_0] ; jumptable 00421A54 case 2
		mov	dword ptr [eax+24h], 5
		jmp	short loc_421AB5
; ---------------------------------------------------------------------------

loc_421A6E:				; CODE XREF: sub_4219A0+B4j
					; DATA XREF: .rdata:off_445A80o
		mov	eax, [ebp+arg_0] ; jumptable 00421A54 case 3
		mov	dword ptr [eax+24h], 9
		jmp	short loc_421AB5
; ---------------------------------------------------------------------------

loc_421A7A:				; CODE XREF: sub_4219A0+B4j
					; DATA XREF: .rdata:off_445A80o
		mov	eax, [ebp+arg_0] ; jumptable 00421A54 case 4
		mov	dword ptr [eax+24h], 0Bh
		jmp	short loc_421AB5
; ---------------------------------------------------------------------------

loc_421A86:				; CODE XREF: sub_4219A0+B4j
					; DATA XREF: .rdata:off_445A80o
		mov	eax, [ebp+arg_0] ; jumptable 00421A54 case 5
		mov	dword ptr [eax+24h], 10h
		jmp	short loc_421AB5
; ---------------------------------------------------------------------------

loc_421A92:				; CODE XREF: sub_4219A0+B4j
					; DATA XREF: .rdata:off_445A80o
		mov	eax, [ebp+arg_0] ; jumptable 00421A54 case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_421AB5
; ---------------------------------------------------------------------------

loc_421A9E:				; CODE XREF: sub_4219A0+B4j
					; DATA XREF: .rdata:off_445A80o
		mov	eax, [ebp+arg_0] ; jumptable 00421A54 case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_421AB5
; ---------------------------------------------------------------------------

loc_421AAA:				; CODE XREF: sub_4219A0+ABj
					; sub_4219A0+B4j
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00421A54 default case
		mov	dword ptr [eax+24h], 7
		nop

loc_421AB5:				; CODE XREF: sub_4219A0+C0j
					; sub_4219A0+CCj ...
		jmp	loc_421B9F	; jumptable 004219B9 default case
; ---------------------------------------------------------------------------

loc_421ABA:				; CODE XREF: sub_4219A0+19j
					; DATA XREF: .rdata:off_445A14o
		mov	eax, [ebp+arg_0] ; jumptable 004219B9 cases 6-13
		mov	eax, [eax+10h]
		cmp	eax, 3
		jz	short loc_421AD6
		cmp	eax, 8
		jnz	short loc_421AE2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Dh
		jmp	short loc_421AED
; ---------------------------------------------------------------------------

loc_421AD6:				; CODE XREF: sub_4219A0+123j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		jmp	short loc_421AED
; ---------------------------------------------------------------------------

loc_421AE2:				; CODE XREF: sub_4219A0+128j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		nop

loc_421AED:				; CODE XREF: sub_4219A0+134j
					; sub_4219A0+140j
		jmp	loc_421B9F	; jumptable 004219B9 default case
; ---------------------------------------------------------------------------

loc_421AF2:				; CODE XREF: sub_4219A0+19j
					; DATA XREF: .rdata:off_445A14o
		mov	eax, [ebp+arg_0] ; jumptable 004219B9 case 14
		mov	dword ptr [eax+24h], 6
		jmp	loc_421B9F	; jumptable 004219B9 default case
; ---------------------------------------------------------------------------

loc_421B01:				; CODE XREF: sub_4219A0+19j
					; DATA XREF: .rdata:off_445A14o
		mov	eax, [ebp+arg_0] ; jumptable 004219B9 case 15
		mov	dword ptr [eax+24h], 0Eh
		jmp	loc_421B9F	; jumptable 004219B9 default case
; ---------------------------------------------------------------------------

loc_421B10:				; CODE XREF: sub_4219A0+19j
					; DATA XREF: .rdata:off_445A14o
		mov	eax, [ebp+arg_0] ; jumptable 004219B9 case 16
		mov	dword ptr [eax+24h], 13h
		jmp	loc_421B9F	; jumptable 004219B9 default case
; ---------------------------------------------------------------------------

loc_421B1F:				; CODE XREF: sub_4219A0+19j
					; DATA XREF: .rdata:off_445A14o
		mov	eax, [ebp+arg_0] ; jumptable 004219B9 case 17
		mov	dword ptr [eax+24h], 0Eh
		jmp	short loc_421B9F ; jumptable 004219B9 default case
; ---------------------------------------------------------------------------

loc_421B2B:				; CODE XREF: sub_4219A0+19j
					; DATA XREF: .rdata:off_445A14o
		mov	eax, [ebp+arg_0] ; jumptable 004219B9 case 18
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_421B93 ; jumptable 00421B3D default case
		mov	eax, ds:off_445AA0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_421B3F:				; CODE XREF: sub_4219A0+19Dj
					; DATA XREF: .rdata:off_445AA0o
		mov	eax, [ebp+arg_0] ; jumptable 00421B3D case 1
		mov	dword ptr [eax+24h], 15h
		jmp	short loc_421B9E
; ---------------------------------------------------------------------------

loc_421B4B:				; CODE XREF: sub_4219A0+19Dj
					; DATA XREF: .rdata:off_445AA0o
		mov	eax, [ebp+arg_0] ; jumptable 00421B3D case 2
		mov	dword ptr [eax+24h], 16h
		jmp	short loc_421B9E
; ---------------------------------------------------------------------------

loc_421B57:				; CODE XREF: sub_4219A0+19Dj
					; DATA XREF: .rdata:off_445AA0o
		mov	eax, [ebp+arg_0] ; jumptable 00421B3D case 3
		mov	dword ptr [eax+24h], 18h
		jmp	short loc_421B9E
; ---------------------------------------------------------------------------

loc_421B63:				; CODE XREF: sub_4219A0+19Dj
					; DATA XREF: .rdata:off_445AA0o
		mov	eax, [ebp+arg_0] ; jumptable 00421B3D case 4
		mov	dword ptr [eax+24h], 19h
		jmp	short loc_421B9E
; ---------------------------------------------------------------------------

loc_421B6F:				; CODE XREF: sub_4219A0+19Dj
					; DATA XREF: .rdata:off_445AA0o
		mov	eax, [ebp+arg_0] ; jumptable 00421B3D case 5
		mov	dword ptr [eax+24h], 1Ah
		jmp	short loc_421B9E
; ---------------------------------------------------------------------------

loc_421B7B:				; CODE XREF: sub_4219A0+19Dj
					; DATA XREF: .rdata:off_445AA0o
		mov	eax, [ebp+arg_0] ; jumptable 00421B3D case 6
		mov	dword ptr [eax+24h], 1Bh
		jmp	short loc_421B9E
; ---------------------------------------------------------------------------

loc_421B87:				; CODE XREF: sub_4219A0+19Dj
					; DATA XREF: .rdata:off_445AA0o
		mov	eax, [ebp+arg_0] ; jumptable 00421B3D case 7
		mov	dword ptr [eax+24h], 1Ch
		jmp	short loc_421B9E
; ---------------------------------------------------------------------------

loc_421B93:				; CODE XREF: sub_4219A0+194j
					; sub_4219A0+19Dj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00421B3D default case
		mov	dword ptr [eax+24h], 17h
		nop

loc_421B9E:				; CODE XREF: sub_4219A0+1A9j
					; sub_4219A0+1B5j ...
		nop

loc_421B9F:				; CODE XREF: sub_4219A0+Cj
					; sub_4219A0+25j ...
		pop	ebp		; jumptable 004219B9 default case
		retn
sub_4219A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421BA1	proc near		; CODE XREF: sub_4239EB+58p

NumOfElements	= dword	ptr -68h
SizeOfElements	= dword	ptr -64h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Memory		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+Memory], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_0], 0
		jnz	loc_4222A5
		jmp	loc_4222E4
; ---------------------------------------------------------------------------

loc_421BC5:				; CODE XREF: sub_421BA1+70Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_42229B
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4222CB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	loc_42229E
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_421C91
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_421C91
		mov	eax, [ebp+var_C]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1
		jmp	short loc_421C56
; ---------------------------------------------------------------------------

loc_421C33:				; CODE XREF: sub_421BA1+C7j
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1

loc_421C56:				; CODE XREF: sub_421BA1+90j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_421C6A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_421C33

loc_421C6A:				; CODE XREF: sub_421BA1+BDj
		cmp	[ebp+var_2C], 0
		js	loc_4222CE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	short loc_421C84
		add	[ebp+var_C], 1
		jmp	short loc_421C91
; ---------------------------------------------------------------------------

loc_421C84:				; CODE XREF: sub_421BA1+DBj
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_C], eax

loc_421C91:				; CODE XREF: sub_421BA1+67j
					; sub_421BA1+75j ...
		mov	[ebp+var_18], 0
		jmp	short loc_421CDB
; ---------------------------------------------------------------------------

loc_421C9A:				; CODE XREF: sub_421BA1+142j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 20h	; switch 17 cases
		cmp	eax, 10h
		ja	short loc_421CE7 ; jumptable 00421CB2 default case
		mov	eax, ds:off_445AC0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_421CB4:				; CODE XREF: sub_421BA1+111j
					; DATA XREF: .rdata:off_445AC0o
		or	[ebp+var_18], 1	; jumptable 00421CB2 case 39
		jmp	short loc_421CD7
; ---------------------------------------------------------------------------

loc_421CBA:				; CODE XREF: sub_421BA1+111j
					; DATA XREF: .rdata:off_445AC0o
		or	[ebp+var_18], 2	; jumptable 00421CB2 case 45
		jmp	short loc_421CD7
; ---------------------------------------------------------------------------

loc_421CC0:				; CODE XREF: sub_421BA1+111j
					; DATA XREF: .rdata:off_445AC0o
		or	[ebp+var_18], 4	; jumptable 00421CB2 case 43
		jmp	short loc_421CD7
; ---------------------------------------------------------------------------

loc_421CC6:				; CODE XREF: sub_421BA1+111j
					; DATA XREF: .rdata:off_445AC0o
		or	[ebp+var_18], 8	; jumptable 00421CB2 case 32
		jmp	short loc_421CD7
; ---------------------------------------------------------------------------

loc_421CCC:				; CODE XREF: sub_421BA1+111j
					; DATA XREF: .rdata:off_445AC0o
		or	[ebp+var_18], 10h ; jumptable 00421CB2 case 35
		jmp	short loc_421CD7
; ---------------------------------------------------------------------------

loc_421CD2:				; CODE XREF: sub_421BA1+111j
					; DATA XREF: .rdata:off_445AC0o
		or	[ebp+var_18], 20h ; jumptable 00421CB2 case 48
		nop

loc_421CD7:				; CODE XREF: sub_421BA1+117j
					; sub_421BA1+11Dj ...
		add	[ebp+var_C], 1

loc_421CDB:				; CODE XREF: sub_421BA1+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421C9A
		jmp	short loc_421CE8
; ---------------------------------------------------------------------------

loc_421CE7:				; CODE XREF: sub_421BA1+108j
					; sub_421BA1+111j
					; DATA XREF: ...
		nop			; jumptable 00421CB2 default case

loc_421CE8:				; CODE XREF: sub_421BA1+144j
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_421D9B
		mov	[ebp+var_1C], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_421E21
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_421E21
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_421E21
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1
		jmp	short loc_421D66
; ---------------------------------------------------------------------------

loc_421D43:				; CODE XREF: sub_421BA1+1D7j
		mov	edx, [ebp+var_30]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1

loc_421D66:				; CODE XREF: sub_421BA1+1A0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_421D7A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_421D43

loc_421D7A:				; CODE XREF: sub_421BA1+1CDj
		cmp	[ebp+var_30], 0
		jle	loc_4222D1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_4222D4
		add	[ebp+var_C], 1
		jmp	loc_421E21
; ---------------------------------------------------------------------------

loc_421D9B:				; CODE XREF: sub_421BA1+156j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_421E1A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_421E1A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1
		jmp	short loc_421DFB
; ---------------------------------------------------------------------------

loc_421DC4:				; CODE XREF: sub_421BA1+26Cj
		cmp	[ebp+var_1C], 0
		jnz	short loc_421DD8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_4222D7

loc_421DD8:				; CODE XREF: sub_421BA1+227j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1

loc_421DFB:				; CODE XREF: sub_421BA1+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_421E0F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_421DC4

loc_421E0F:				; CODE XREF: sub_421BA1+262j
		cmp	[ebp+var_1C], 0
		jns	short loc_421E21
		jmp	loc_4222E4
; ---------------------------------------------------------------------------

loc_421E1A:				; CODE XREF: sub_421BA1+202j
					; sub_421BA1+20Cj
		mov	[ebp+var_1C], 0FFFFFFFFh

loc_421E21:				; CODE XREF: sub_421BA1+16Bj
					; sub_421BA1+179j ...
		mov	[ebp+var_34], 0
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	loc_421F94
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		setz	al
		movzx	eax, al
		mov	[ebp+var_40], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_421F01
		mov	[ebp+var_20], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_421F87
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_421F87
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_421F87
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1
		jmp	short loc_421ECC
; ---------------------------------------------------------------------------

loc_421EA9:				; CODE XREF: sub_421BA1+33Dj
		mov	edx, [ebp+var_34]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1

loc_421ECC:				; CODE XREF: sub_421BA1+306j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_421EE0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_421EA9

loc_421EE0:				; CODE XREF: sub_421BA1+333j
		cmp	[ebp+var_34], 0
		jle	loc_4222DA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_4222DD
		add	[ebp+var_C], 1
		jmp	loc_421F87
; ---------------------------------------------------------------------------

loc_421F01:				; CODE XREF: sub_421BA1+2BCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_421F80
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_421F80
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1
		jmp	short loc_421F61
; ---------------------------------------------------------------------------

loc_421F2A:				; CODE XREF: sub_421BA1+3D2j
		cmp	[ebp+var_20], 0
		jnz	short loc_421F3E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_4222E0

loc_421F3E:				; CODE XREF: sub_421BA1+38Dj
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1

loc_421F61:				; CODE XREF: sub_421BA1+387j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_421F75
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_421F2A

loc_421F75:				; CODE XREF: sub_421BA1+3C8j
		cmp	[ebp+var_20], 0
		jns	short loc_421F87
		jmp	loc_4222E4
; ---------------------------------------------------------------------------

loc_421F80:				; CODE XREF: sub_421BA1+368j
					; sub_421BA1+372j
		mov	[ebp+var_20], 0

loc_421F87:				; CODE XREF: sub_421BA1+2D1j
					; sub_421BA1+2DFj ...
		cmp	[ebp+var_40], 0
		jz	short loc_421F94
		mov	[ebp+var_20], 0FFFFFFFFh

loc_421F94:				; CODE XREF: sub_421BA1+296j
					; sub_421BA1+3EAj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 4Ch	; switch 47 cases
		cmp	eax, 2Eh
		ja	loc_422034	; jumptable 00421FB0 default case
		mov	eax, ds:off_445B04[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_421FB2:				; CODE XREF: sub_421BA1+40Fj
					; DATA XREF: .rdata:off_445B04o
		mov	eax, [ebp+var_C] ; jumptable 00421FB0 case 104
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jnz	short loc_421FCC
		mov	[ebp+var_24], 1
		add	[ebp+var_C], 1
		jmp	short loc_421FD3
; ---------------------------------------------------------------------------

loc_421FCC:				; CODE XREF: sub_421BA1+41Cj
		mov	[ebp+var_24], 2

loc_421FD3:				; CODE XREF: sub_421BA1+429j
		add	[ebp+var_C], 1
		jmp	short loc_42203C
; ---------------------------------------------------------------------------

loc_421FD9:				; CODE XREF: sub_421BA1+40Fj
					; DATA XREF: .rdata:off_445B04o
		mov	eax, [ebp+var_C] ; jumptable 00421FB0 case 108
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 6Ch
		jnz	short loc_421FF3
		mov	[ebp+var_24], 4
		add	[ebp+var_C], 1
		jmp	short loc_421FFA
; ---------------------------------------------------------------------------

loc_421FF3:				; CODE XREF: sub_421BA1+443j
		mov	[ebp+var_24], 3

loc_421FFA:				; CODE XREF: sub_421BA1+450j
		add	[ebp+var_C], 1
		jmp	short loc_42203C
; ---------------------------------------------------------------------------

loc_422000:				; CODE XREF: sub_421BA1+40Fj
					; DATA XREF: .rdata:off_445B04o
		mov	[ebp+var_24], 5	; jumptable 00421FB0 case 106
		add	[ebp+var_C], 1
		jmp	short loc_42203C
; ---------------------------------------------------------------------------

loc_42200D:				; CODE XREF: sub_421BA1+40Fj
					; DATA XREF: .rdata:off_445B04o
		mov	[ebp+var_24], 6	; jumptable 00421FB0 case 122
		add	[ebp+var_C], 1
		jmp	short loc_42203C
; ---------------------------------------------------------------------------

loc_42201A:				; CODE XREF: sub_421BA1+40Fj
					; DATA XREF: .rdata:off_445B04o
		mov	[ebp+var_24], 7	; jumptable 00421FB0 case 116
		add	[ebp+var_C], 1
		jmp	short loc_42203C
; ---------------------------------------------------------------------------

loc_422027:				; CODE XREF: sub_421BA1+40Fj
					; DATA XREF: .rdata:off_445B04o
		mov	[ebp+var_24], 8	; jumptable 00421FB0 case 76
		add	[ebp+var_C], 1
		jmp	short loc_42203C
; ---------------------------------------------------------------------------

loc_422034:				; CODE XREF: sub_421BA1+402j
					; sub_421BA1+40Fj
					; DATA XREF: ...
		mov	[ebp+var_24], 0	; jumptable 00421FB0 default case
		nop

loc_42203C:				; CODE XREF: sub_421BA1+436j
					; sub_421BA1+45Dj ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 41h	; switch 56 cases
		cmp	eax, 37h
		ja	loc_42213B	; jumptable 00422058 default case
		mov	eax, ds:off_445BC0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_42205A:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 1	; jumptable 00422058 cases 100,105
		jmp	loc_422142
; ---------------------------------------------------------------------------

loc_422066:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 2	; jumptable 00422058 case 111
		jmp	loc_422142
; ---------------------------------------------------------------------------

loc_422072:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 3	; jumptable 00422058 case 117
		jmp	loc_422142
; ---------------------------------------------------------------------------

loc_42207E:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 4	; jumptable 00422058 case 120
		jmp	loc_422142
; ---------------------------------------------------------------------------

loc_42208A:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 5	; jumptable 00422058 case 88
		jmp	loc_422142
; ---------------------------------------------------------------------------

loc_422096:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 6	; jumptable 00422058 case 102
		jmp	loc_422142
; ---------------------------------------------------------------------------

loc_4220A2:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 7	; jumptable 00422058 case 70
		jmp	loc_422142
; ---------------------------------------------------------------------------

loc_4220AE:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 8	; jumptable 00422058 case 101
		jmp	loc_422142
; ---------------------------------------------------------------------------

loc_4220BA:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 9	; jumptable 00422058 case 69
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_4220C3:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 0Ah ; jumptable 00422058 case 103
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_4220CC:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 0Bh ; jumptable 00422058 case 71
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_4220D5:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 0Ch ; jumptable 00422058 case 97
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_4220DE:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 0Dh ; jumptable 00422058 case 65
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_4220E7:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 0Eh ; jumptable 00422058 case 99
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_4220F0:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 0Fh ; jumptable 00422058 case 115
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_4220F9:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 10h ; jumptable 00422058 case 112
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_422102:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 12h ; jumptable 00422058 case 110
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_42210B:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 0Eh ; jumptable 00422058 case 67
		mov	[ebp+var_24], 3
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_42211B:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 0Fh ; jumptable 00422058 case 83
		mov	[ebp+var_24], 3
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_42212B:				; CODE XREF: sub_421BA1+4B7j
					; DATA XREF: .rdata:off_445BC0o
		mov	[ebp+var_28], 11h ; jumptable 00422058 case 109
		mov	[ebp+var_2C], 0FFFFFFFFh
		jmp	short loc_422142
; ---------------------------------------------------------------------------

loc_42213B:				; CODE XREF: sub_421BA1+4AAj
					; sub_421BA1+4B7j
					; DATA XREF: ...
		mov	[ebp+var_28], 0	; jumptable 00422058 default case

loc_422142:				; CODE XREF: sub_421BA1+4C0j
					; sub_421BA1+4CCj ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jb	loc_422213
		mov	eax, [ebp+arg_8]
		add	eax, 0Ah
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		cmp	eax, [ebp+arg_8]
		jbe	loc_4222E3
		mov	[esp+68h+SizeOfElements], 28h ;	SizeOfElements
		mov	eax, [ebp+var_44]
		mov	[esp+68h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jz	loc_4222F3
		mov	[ebp+var_38], 0
		jmp	short loc_4221EA
; ---------------------------------------------------------------------------

loc_42218C:				; CODE XREF: sub_421BA1+64Fj
		mov	edx, [ebp+var_38]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+var_48]
		mov	ecx, [ebp+var_38]
		mov	edx, ecx
		shl	edx, 2
		add	edx, ecx
		shl	edx, 3
		add	edx, [ebp+Memory]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	edx, [edx+24h]
		mov	[eax+24h], edx
		add	[ebp+var_38], 1

loc_4221EA:				; CODE XREF: sub_421BA1+5E9j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_14]
		jb	short loc_42218C
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_422207
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_422207:				; CODE XREF: sub_421BA1+659j
		mov	eax, [ebp+var_48]
		mov	[ebp+Memory], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+arg_8], eax

loc_422213:				; CODE XREF: sub_421BA1+5A7j
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	[ebp+var_4C], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_4C]
		mov	[eax], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_1C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_24]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_2C]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_30]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_34]
		mov	[eax+20h], edx
		mov	eax, [ebp+var_4C]
		mov	[esp+68h+NumOfElements], eax
		call	sub_4219A0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax
		jmp	short loc_42229F
; ---------------------------------------------------------------------------

loc_42229B:				; CODE XREF: sub_421BA1+2Cj
		nop
		jmp	short loc_42229F
; ---------------------------------------------------------------------------

loc_42229E:				; CODE XREF: sub_421BA1+52j
		nop

loc_42229F:				; CODE XREF: sub_421BA1+6F8j
					; sub_421BA1+6FBj
		add	[ebp+arg_0], 1
		jmp	short loc_4222A6
; ---------------------------------------------------------------------------

loc_4222A5:				; CODE XREF: sub_421BA1+19j
		nop

loc_4222A6:				; CODE XREF: sub_421BA1+702j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_421BC5
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+Memory]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_422317
; ---------------------------------------------------------------------------

loc_4222CB:				; CODE XREF: sub_421BA1+44j
		nop
		jmp	short loc_4222E4
; ---------------------------------------------------------------------------

loc_4222CE:				; CODE XREF: sub_421BA1+CDj
		nop
		jmp	short loc_4222E4
; ---------------------------------------------------------------------------

loc_4222D1:				; CODE XREF: sub_421BA1+1DDj
		nop
		jmp	short loc_4222E4
; ---------------------------------------------------------------------------

loc_4222D4:				; CODE XREF: sub_421BA1+1EBj
		nop
		jmp	short loc_4222E4
; ---------------------------------------------------------------------------

loc_4222D7:				; CODE XREF: sub_421BA1+231j
		nop
		jmp	short loc_4222E4
; ---------------------------------------------------------------------------

loc_4222DA:				; CODE XREF: sub_421BA1+343j
		nop
		jmp	short loc_4222E4
; ---------------------------------------------------------------------------

loc_4222DD:				; CODE XREF: sub_421BA1+351j
		nop
		jmp	short loc_4222E4
; ---------------------------------------------------------------------------

loc_4222E0:				; CODE XREF: sub_421BA1+397j
		nop
		jmp	short loc_4222E4
; ---------------------------------------------------------------------------

loc_4222E3:				; CODE XREF: sub_421BA1+5BCj
		nop

loc_4222E4:				; CODE XREF: sub_421BA1+1Fj
					; sub_421BA1+274j ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		jmp	short loc_4222F4
; ---------------------------------------------------------------------------

loc_4222F3:				; CODE XREF: sub_421BA1+5DCj
		nop

loc_4222F4:				; CODE XREF: sub_421BA1+750j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_422309
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_422309:				; CODE XREF: sub_421BA1+75Bj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh

locret_422317:				; CODE XREF: sub_421BA1+728j
		leave
		retn
sub_421BA1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422319	proc near		; CODE XREF: sub_4239EB+502p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	[ebp+var_C], 0
		jmp	loc_4225E0
; ---------------------------------------------------------------------------

loc_42232C:				; CODE XREF: sub_422319+2CDj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		add	eax, 8
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 1Ch ; switch 29 cases
		ja	loc_4225D5	; jumptable 0042236C default case
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, offset off_445CA0
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_42236E:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 1
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_422385:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 20
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_42239A:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 2
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_4223B1:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 21
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_4223C6:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 3
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_4223DD:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 4
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_4223F5:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 5
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_42240D:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 22
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_422422:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 6
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_422437:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 23
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_42244C:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 7
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_422461:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 8
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_422476:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 9
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_42248B:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 24
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_4224A0:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 10
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_4224BB:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 11
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_4224D6:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 25
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_4224EB:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 12
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		fld	qword ptr [eax]
		mov	eax, [ebp+var_10]
		fstp	qword ptr [eax]
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_422500:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 13
		lea	edx, [eax+0Ch]
		mov	[ebp+arg_8], edx
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ebx, [ebp+var_10]
		mov	[ebx], eax
		mov	[ebx+4], edx
		mov	[ebx+8], ecx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_422521:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 14
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_422536:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 19
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_4225DC
; ---------------------------------------------------------------------------

loc_42254B:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 15
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_4225DC
; ---------------------------------------------------------------------------

loc_422563:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 26
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4225DC
; ---------------------------------------------------------------------------

loc_422575:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 16
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_4225DC
; ---------------------------------------------------------------------------

loc_42258D:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 17
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4225DC
; ---------------------------------------------------------------------------

loc_42259F:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 27
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4225DC
; ---------------------------------------------------------------------------

loc_4225B1:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 18
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4225DC
; ---------------------------------------------------------------------------

loc_4225C3:				; CODE XREF: sub_422319+53j
					; DATA XREF: .rdata:off_445CA0o
		mov	eax, [ebp+arg_8] ; jumptable 0042236C case 28
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4225DC
; ---------------------------------------------------------------------------

loc_4225D5:				; CODE XREF: sub_422319+40j
					; sub_422319+53j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 0042236C default case
		jmp	short loc_4225F1
; ---------------------------------------------------------------------------

loc_4225DC:				; CODE XREF: sub_422319+67j
					; sub_422319+7Cj ...
		add	[ebp+var_C], 1

loc_4225E0:				; CODE XREF: sub_422319+Ej
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_42232C
		mov	eax, 0

loc_4225F1:				; CODE XREF: sub_422319+2C1j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_422319	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4225F7	proc near		; CODE XREF: sub_422675+4C6p
					; sub_422675+5BAp ...

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_30		= byte ptr -30h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		jmp	short loc_422668
; ---------------------------------------------------------------------------

loc_4225FF:				; CODE XREF: sub_4225F7+75j
		mov	eax, [ebp+arg_C]
		mov	edx, 20h
		cmp	eax, 20h
		cmova	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax ; Size
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Val], eax ; Val
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Dst], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_422650
		mov	eax, [ebp+var_10]
		jmp	short locret_422673
; ---------------------------------------------------------------------------

loc_422650:				; CODE XREF: sub_4225F7+52j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		sub	eax, [ebp+var_C]
		mov	[ebp+arg_C], eax

loc_422668:				; CODE XREF: sub_4225F7+6j
		cmp	[ebp+arg_C], 0
		jg	short loc_4225FF
		mov	eax, 0

locret_422673:				; CODE XREF: sub_4225F7+57j
		leave
		retn
sub_4225F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422675	proc near		; CODE XREF: sub_42350B+317p

var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A5		= byte ptr -0A5h
var_A4		= byte ptr -0A4h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0D4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_B8], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_B4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_B0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_AC], eax
		mov	[ebp+var_A5], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jnz	loc_42279C
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 4		; switch 15 cases
		cmp	eax, 0Eh
		ja	loc_42275C	; jumptable 004226D2 default case
		mov	eax, ds:off_445D40[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4226D4:				; CODE XREF: sub_422675+5Dj
					; DATA XREF: .rdata:off_445D40o
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 004226D2	case 4
		cwde
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_422766
; ---------------------------------------------------------------------------

loc_4226E9:				; CODE XREF: sub_422675+5Dj
					; DATA XREF: .rdata:off_445D40o
		mov	eax, [ebp+var_B8] ; jumptable 004226D2 case 6
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_422766
; ---------------------------------------------------------------------------

loc_4226FC:				; CODE XREF: sub_422675+5Dj
					; DATA XREF: .rdata:off_445D40o
		mov	eax, [ebp+var_B8] ; jumptable 004226D2 case 8
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_422766
; ---------------------------------------------------------------------------

loc_42270F:				; CODE XREF: sub_422675+5Dj
					; DATA XREF: .rdata:off_445D40o
		mov	eax, [ebp+var_B8] ; jumptable 004226D2 case 10
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_422766
; ---------------------------------------------------------------------------

loc_422723:				; CODE XREF: sub_422675+5Dj
					; DATA XREF: .rdata:off_445D40o
		mov	eax, [ebp+var_B8] ; jumptable 004226D2 case 17
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], 0
		jmp	short loc_422766
; ---------------------------------------------------------------------------

loc_422735:				; CODE XREF: sub_422675+5Dj
					; DATA XREF: .rdata:off_445D40o
		mov	eax, [ebp+var_B8] ; jumptable 004226D2 case 15
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_422766
; ---------------------------------------------------------------------------

loc_422749:				; CODE XREF: sub_422675+5Dj
					; DATA XREF: .rdata:off_445D40o
		mov	eax, [ebp+var_B8] ; jumptable 004226D2 case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_422766
; ---------------------------------------------------------------------------

loc_42275C:				; CODE XREF: sub_422675+50j
					; sub_422675+5Dj
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 004226D2 default case
		jmp	loc_422CFF
; ---------------------------------------------------------------------------

loc_422766:				; CODE XREF: sub_422675+72j
					; sub_422675+85j ...
		cmp	[ebp+var_24], 0
		jns	short loc_42278B
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		neg	eax
		adc	edx, 0
		neg	edx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	[ebp+var_A5], 2Dh
		jmp	loc_422848
; ---------------------------------------------------------------------------

loc_42278B:				; CODE XREF: sub_422675+F5j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	loc_422848
; ---------------------------------------------------------------------------

loc_42279C:				; CODE XREF: sub_422675+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 5		; switch 14 cases
		cmp	eax, 0Dh
		ja	loc_42283E	; jumptable 004227B5 default case
		mov	eax, ds:off_445D7C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4227B7:				; CODE XREF: sub_422675+140j
					; DATA XREF: .rdata:off_445D7Co
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 004227B5	case 5
		movzx	eax, ax
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_422848
; ---------------------------------------------------------------------------

loc_4227CD:				; CODE XREF: sub_422675+140j
					; DATA XREF: .rdata:off_445D7Co
		mov	eax, [ebp+var_B8] ; jumptable 004227B5 case 7
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_422848
; ---------------------------------------------------------------------------

loc_4227DF:				; CODE XREF: sub_422675+140j
					; DATA XREF: .rdata:off_445D7Co
		mov	eax, [ebp+var_B8] ; jumptable 004227B5 case 9
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_422848
; ---------------------------------------------------------------------------

loc_4227F1:				; CODE XREF: sub_422675+140j
					; DATA XREF: .rdata:off_445D7Co
		mov	eax, [ebp+var_B8] ; jumptable 004227B5 case 11
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_422848
; ---------------------------------------------------------------------------

loc_422805:				; CODE XREF: sub_422675+140j
					; DATA XREF: .rdata:off_445D7Co
		mov	eax, [ebp+var_B8] ; jumptable 004227B5 case 17
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_422848
; ---------------------------------------------------------------------------

loc_422817:				; CODE XREF: sub_422675+140j
					; DATA XREF: .rdata:off_445D7Co
		mov	eax, [ebp+var_B8] ; jumptable 004227B5 case 16
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_422848
; ---------------------------------------------------------------------------

loc_42282B:				; CODE XREF: sub_422675+140j
					; DATA XREF: .rdata:off_445D7Co
		mov	eax, [ebp+var_B8] ; jumptable 004227B5 case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_422848
; ---------------------------------------------------------------------------

loc_42283E:				; CODE XREF: sub_422675+133j
					; sub_422675+140j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 004227B5 default case
		jmp	loc_422CFF
; ---------------------------------------------------------------------------

loc_422848:				; CODE XREF: sub_422675+111j
					; sub_422675+122j ...
		movzx	eax, [ebp+var_A5]
		cmp	al, 2Dh
		jz	short loc_42287D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_422869
		mov	[ebp+var_A5], 2Bh
		jmp	short loc_42287D
; ---------------------------------------------------------------------------

loc_422869:				; CODE XREF: sub_422675+1E9j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_42287D
		mov	[ebp+var_A5], 20h

loc_42287D:				; CODE XREF: sub_422675+1DCj
					; sub_422675+1F2j ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_A4]
		add	eax, 64h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_4228BB
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_422A47

loc_4228BB:				; CODE XREF: sub_422675+236j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jz	short loc_4228D5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	loc_422987

loc_4228D5:				; CODE XREF: sub_422675+24Fj
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	[ebp+var_38], offset byte_445D14

loc_4228E3:				; CODE XREF: sub_422675+307j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 1
		test	al, al
		jz	short loc_42291A
		add	[ebp+var_2C], 1
		cmp	[ebp+var_2C], 3
		jnz	short loc_42291A
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42291A
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	[ebp+var_2C], 0

loc_42291A:				; CODE XREF: sub_422675+279j
					; sub_422675+283j ...
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_43B740
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_43B640
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	loc_4228E3
		jmp	loc_422A47
; ---------------------------------------------------------------------------

loc_422987:				; CODE XREF: sub_422675+25Aj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 2
		jnz	short loc_4229E8

loc_422992:				; CODE XREF: sub_422675+34Ej
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 7
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 3
		shr	edx, 3
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_422992
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_422A47
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_422A47
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		jmp	short loc_422A47
; ---------------------------------------------------------------------------

loc_4229E8:				; CODE XREF: sub_422675+31Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_4229FA
		mov	eax, offset a0123456789abcd ; "0123456789abcdef"
		jmp	short loc_4229FF
; ---------------------------------------------------------------------------

loc_4229FA:				; CODE XREF: sub_422675+37Cj
		mov	eax, offset a0123456789ab_0 ; "0123456789ABCDEF"

loc_4229FF:				; CODE XREF: sub_422675+383j
		mov	[ebp+var_34], eax

loc_422A02:				; CODE XREF: sub_422675+3BFj
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 0Fh
		add	eax, [ebp+var_34]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 4
		shr	edx, 4
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_422A02
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_422A47
		add	[ebp+var_1C], 2

loc_422A47:				; CODE XREF: sub_422675+240j
					; sub_422675+30Dj ...
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_422AA0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_422AA0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_422AA0
		cmp	[ebp+var_3C], 0
		jz	short loc_422AA0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_422AA0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_422ACA
; ---------------------------------------------------------------------------

loc_422AA0:				; CODE XREF: sub_422675+3ECj
					; sub_422675+3F7j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jle	short loc_422AC3
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_422AC3
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_422ACA
; ---------------------------------------------------------------------------

loc_422AC3:				; CODE XREF: sub_422675+433j
					; sub_422675+43Ej
		mov	[ebp+var_18], 0

loc_422ACA:				; CODE XREF: sub_422675+429j
					; sub_422675+44Cj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_422B51
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_422B51
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_422B51
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jb	short loc_422B51
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_4225F7
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_422B51
		mov	eax, [ebp+var_40]
		jmp	loc_422CFF
; ---------------------------------------------------------------------------

loc_422B51:				; CODE XREF: sub_422675+460j
					; sub_422675+46Aj ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		jz	short loc_422B97
		mov	[esp+0D8h+var_D0], 1
		lea	eax, [ebp+var_A5]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_422B8A
		mov	eax, [ebp+var_40]
		jmp	loc_422CFF
; ---------------------------------------------------------------------------

loc_422B8A:				; CODE XREF: sub_422675+50Bj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_422B97:				; CODE XREF: sub_422675+4E5j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_422C06
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jz	short loc_422BBA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 5
		jnz	short loc_422C06

loc_422BBA:				; CODE XREF: sub_422675+538j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_422BCC
		mov	eax, offset a0x	; "0x"
		jmp	short loc_422BD1
; ---------------------------------------------------------------------------

loc_422BCC:				; CODE XREF: sub_422675+54Ej
		mov	eax, offset a0x_0 ; "0X"

loc_422BD1:				; CODE XREF: sub_422675+555j
		mov	[esp+0D8h+var_D0], 2
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_422BF9
		mov	eax, [ebp+var_40]
		jmp	loc_422CFF
; ---------------------------------------------------------------------------

loc_422BF9:				; CODE XREF: sub_422675+57Aj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_422C06:				; CODE XREF: sub_422675+52Dj
					; sub_422675+543j
		cmp	[ebp+var_18], 0
		jz	short loc_422C45
		mov	eax, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 30h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_4225F7
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_422C45
		mov	eax, [ebp+var_40]
		jmp	loc_422CFF
; ---------------------------------------------------------------------------

loc_422C45:				; CODE XREF: sub_422675+595j
					; sub_422675+5C6j
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+0D8h+var_D0], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_422C78
		mov	eax, [ebp+var_40]
		jmp	loc_422CFF
; ---------------------------------------------------------------------------

loc_422C78:				; CODE XREF: sub_422675+5F9j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_422CFA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_422CFA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_422CFA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		sub	eax, [ebp+var_3C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_4225F7
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_422CFA
		mov	eax, [ebp+var_40]
		jmp	short loc_422CFF
; ---------------------------------------------------------------------------

loc_422CFA:				; CODE XREF: sub_422675+626j
					; sub_422675+630j ...
		mov	eax, 0

loc_422CFF:				; CODE XREF: sub_422675+ECj
					; sub_422675+1CEj ...
		add	esp, 0D4h
		pop	ebx
		pop	ebp
		retn
sub_422675	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422D08	proc near		; CODE XREF: sub_42350B+35Bp

Dest		= dword	ptr -1F8h
Format		= dword	ptr -1F4h
var_1F0		= qword	ptr -1F0h
var_1E8		= dword	ptr -1E8h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1C8		= qword	ptr -1C8h
var_1C0		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_1AF		= byte ptr -1AFh
var_1AE		= byte ptr -1AEh
var_19A		= byte ptr -19Ah
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= qword	ptr -28h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1F0h
		mov	eax, [ebp+arg_C]
		mov	dword ptr [ebp+var_1C8], eax
		mov	eax, [ebp+arg_10]
		mov	dword ptr [ebp+var_1C8+4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_1C0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1BC], eax
		mov	eax, 0
		mov	edx, 0
		mov	ecx, 0
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 0
		mov	[ebp+var_1AF], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Ch
		jz	short loc_422D6F
		cmp	eax, 0Dh
		jz	short loc_422D7A
		jmp	short loc_422DA3
; ---------------------------------------------------------------------------

loc_422D6F:				; CODE XREF: sub_422D08+5Ej
		fld	[ebp+var_1C8]
		fstp	[ebp+var_28]
		jmp	short loc_422DAD
; ---------------------------------------------------------------------------

loc_422D7A:				; CODE XREF: sub_422D08+63j
		fldz
		fstp	[ebp+var_28]
		mov	eax, dword ptr [ebp+var_1C8]
		mov	edx, dword ptr [ebp+var_1C8+4]
		mov	ecx, [ebp+var_1C0]
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 1
		jmp	short loc_422DAD
; ---------------------------------------------------------------------------

loc_422DA3:				; CODE XREF: sub_422D08+65j
		mov	eax, 0FFFFFFFFh
		jmp	loc_423133
; ---------------------------------------------------------------------------

loc_422DAD:				; CODE XREF: sub_422D08+70j
					; sub_422D08+99j
		lea	eax, [ebp+var_1AE]
		add	eax, 14h
		mov	[ebp+var_2C], eax
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		sub	eax, 6		; switch 8 cases
		cmp	eax, 7
		ja	short loc_422E3A ; jumptable 00422DD8 default case
		mov	eax, ds:off_445DB4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_422DDA:				; CODE XREF: sub_422D08+D0j
					; DATA XREF: .rdata:off_445DB4o
		sub	[ebp+var_2C], 1	; jumptable 00422DD8 case 6
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	66h
		jmp	short loc_422E44
; ---------------------------------------------------------------------------

loc_422DE6:				; CODE XREF: sub_422D08+D0j
					; DATA XREF: .rdata:off_445DB4o
		sub	[ebp+var_2C], 1	; jumptable 00422DD8 case 7
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	46h
		jmp	short loc_422E44
; ---------------------------------------------------------------------------

loc_422DF2:				; CODE XREF: sub_422D08+D0j
					; DATA XREF: .rdata:off_445DB4o
		sub	[ebp+var_2C], 1	; jumptable 00422DD8 case 8
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	65h
		jmp	short loc_422E44
; ---------------------------------------------------------------------------

loc_422DFE:				; CODE XREF: sub_422D08+D0j
					; DATA XREF: .rdata:off_445DB4o
		sub	[ebp+var_2C], 1	; jumptable 00422DD8 case 9
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	45h
		jmp	short loc_422E44
; ---------------------------------------------------------------------------

loc_422E0A:				; CODE XREF: sub_422D08+D0j
					; DATA XREF: .rdata:off_445DB4o
		sub	[ebp+var_2C], 1	; jumptable 00422DD8 case 10
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	67h
		jmp	short loc_422E44
; ---------------------------------------------------------------------------

loc_422E16:				; CODE XREF: sub_422D08+D0j
					; DATA XREF: .rdata:off_445DB4o
		sub	[ebp+var_2C], 1	; jumptable 00422DD8 case 11
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	47h
		jmp	short loc_422E44
; ---------------------------------------------------------------------------

loc_422E22:				; CODE XREF: sub_422D08+D0j
					; DATA XREF: .rdata:off_445DB4o
		sub	[ebp+var_2C], 1	; jumptable 00422DD8 case 12
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	61h
		jmp	short loc_422E44
; ---------------------------------------------------------------------------

loc_422E2E:				; CODE XREF: sub_422D08+D0j
					; DATA XREF: .rdata:off_445DB4o
		sub	[ebp+var_2C], 1	; jumptable 00422DD8 case 13
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	41h
		jmp	short loc_422E44
; ---------------------------------------------------------------------------

loc_422E3A:				; CODE XREF: sub_422D08+C7j
		mov	eax, 0FFFFFFFFh	; jumptable 00422DD8 default case
		jmp	loc_423133
; ---------------------------------------------------------------------------

loc_422E44:				; CODE XREF: sub_422D08+DCj
					; sub_422D08+E8j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_422E54
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	4Ch

loc_422E54:				; CODE XREF: sub_422D08+140j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_422ECD
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	edx, 64h
		cmp	eax, 64h
		cmovg	eax, edx
		mov	[ebp+var_30], eax

loc_422E73:				; CODE XREF: sub_422D08+1B9j
		sub	[ebp+var_2C], 1
		mov	ecx, [ebp+var_30]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax], dl
		mov	ecx, [ebp+var_30]
		mov	[ebp+var_1CC], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_1CC]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_422E73
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Eh

loc_422ECD:				; CODE XREF: sub_422D08+155j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_422EE4
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	23h

loc_422EE4:				; CODE XREF: sub_422D08+1D0j
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	25h
		cmp	[ebp+var_1C], 0
		jz	short loc_422F20
		mov	ebx, [ebp+var_2C]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+var_10]
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	dword ptr [esp+1F8h+var_1F0+4],	edx
		mov	[esp+1F8h+var_1E8], ecx
		mov	[esp+1F8h+Format], ebx ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf
		jmp	short loc_422F3C
; ---------------------------------------------------------------------------

loc_422F20:				; CODE XREF: sub_422D08+1EAj
		mov	eax, [ebp+var_2C]
		fld	[ebp+var_28]
		fstp	[esp+1F8h+var_1F0]
		mov	[esp+1F8h+Format], eax ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf

loc_422F3C:				; CODE XREF: sub_422D08+216j
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_1D0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1D0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		add	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_422F96
		mov	[ebp+var_1AF], 2Dh
		add	[ebp+var_2C], 1
		sub	[ebp+var_30], 1
		jmp	short loc_422FC0
; ---------------------------------------------------------------------------

loc_422F96:				; CODE XREF: sub_422D08+27Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_422FAC
		mov	[ebp+var_1AF], 2Bh
		jmp	short loc_422FC0
; ---------------------------------------------------------------------------

loc_422FAC:				; CODE XREF: sub_422D08+299j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_422FC0
		mov	[ebp+var_1AF], 20h

loc_422FC0:				; CODE XREF: sub_422D08+28Cj
					; sub_422D08+2A2j ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_423039
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_423039
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_423039
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_4225F7
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_423039
		mov	eax, [ebp+var_3C]
		jmp	loc_423133
; ---------------------------------------------------------------------------

loc_423039:				; CODE XREF: sub_422D08+2D5j
					; sub_422D08+2DFj ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		jz	short loc_42307F
		mov	dword ptr [esp+1F8h+var_1F0], 1
		lea	eax, [ebp+var_1AF]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_423072
		mov	eax, [ebp+var_3C]
		jmp	loc_423133
; ---------------------------------------------------------------------------

loc_423072:				; CODE XREF: sub_422D08+360j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_42307F:				; CODE XREF: sub_422D08+33Aj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_4230B2
		mov	eax, [ebp+var_3C]
		jmp	loc_423133
; ---------------------------------------------------------------------------

loc_4230B2:				; CODE XREF: sub_422D08+3A0j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_42312E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_42312E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_42312E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_4225F7
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_42312E
		mov	eax, [ebp+var_3C]
		jmp	short loc_423133
; ---------------------------------------------------------------------------

loc_42312E:				; CODE XREF: sub_422D08+3CDj
					; sub_422D08+3D7j ...
		mov	eax, 0

loc_423133:				; CODE XREF: sub_422D08+A0j
					; sub_422D08+137j ...
		add	esp, 1F0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_422D08	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42313D	proc near		; CODE XREF: sub_42350B+39Fp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 6
		jz	short loc_42316D
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4231AD
; ---------------------------------------------------------------------------

loc_42316D:				; CODE XREF: sub_42313D+27j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_D], al
		mov	[esp+38h+var_30], 1
		lea	eax, [ebp+var_D]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42319B
		mov	eax, [ebp+var_C]
		jmp	short locret_4231AD
; ---------------------------------------------------------------------------

loc_42319B:				; CODE XREF: sub_42313D+57j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

locret_4231AD:				; CODE XREF: sub_42313D+2Ej
					; sub_42313D+5Cj
		leave
		retn
sub_42313D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4231AF	proc near		; CODE XREF: sub_42350B+3E3p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Eh
		jz	short loc_4231E3
		mov	eax, 0FFFFFFFFh
		jmp	loc_42334A
; ---------------------------------------------------------------------------

loc_4231E3:				; CODE XREF: sub_4231AF+28j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4231F6
		mov	[ebp+var_10], offset aNull_0 ; "(null)"

loc_4231F6:				; CODE XREF: sub_4231AF+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		js	short loc_42322E
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_423217
; ---------------------------------------------------------------------------

loc_42320F:				; CODE XREF: sub_4231AF+7Bj
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_423217:				; CODE XREF: sub_4231AF+5Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jbe	short loc_423250
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42320F
		jmp	short loc_423250
; ---------------------------------------------------------------------------

loc_42322E:				; CODE XREF: sub_4231AF+4Fj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax

loc_423250:				; CODE XREF: sub_4231AF+71j
					; sub_4231AF+7Dj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_4232B1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_4232B1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4232B1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4225F7
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4232B1
		mov	eax, [ebp+var_18]
		jmp	loc_42334A
; ---------------------------------------------------------------------------

loc_4232B1:				; CODE XREF: sub_4231AF+ACj
					; sub_4231AF+B6j ...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4232D8
		mov	eax, [ebp+var_18]
		jmp	short loc_42334A
; ---------------------------------------------------------------------------

loc_4232D8:				; CODE XREF: sub_4231AF+122j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_423345
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_423345
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_423345
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4225F7
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_423345
		mov	eax, [ebp+var_18]
		jmp	short loc_42334A
; ---------------------------------------------------------------------------

loc_423345:				; CODE XREF: sub_4231AF+143j
					; sub_4231AF+14Dj ...
		mov	eax, 0

loc_42334A:				; CODE XREF: sub_4231AF+2Fj
					; sub_4231AF+FDj ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_4231AF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_423350	proc near		; CODE XREF: sub_42350B+427p

var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= byte ptr -7Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_98], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_94], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 13h
		jz	short loc_423393
		mov	eax, 0FFFFFFFFh
		jmp	loc_42344E
; ---------------------------------------------------------------------------

loc_423393:				; CODE XREF: sub_423350+37j
		mov	eax, [ebp+var_98]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_7C]
		add	eax, 64h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_4233AB:				; CODE XREF: sub_423350+7Ej
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		and	eax, 0Fh
		movzx	edx, ds:byte_445DDB[eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		shr	eax, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4233AB
		jmp	short loc_4233DC
; ---------------------------------------------------------------------------

loc_4233D2:				; CODE XREF: sub_423350+9Bj
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h

loc_4233DC:				; CODE XREF: sub_423350+80j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 7
		jbe	short loc_4233D2
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	78h
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_423431
		mov	eax, [ebp+var_18]
		jmp	short loc_42344E
; ---------------------------------------------------------------------------

loc_423431:				; CODE XREF: sub_423350+DAj
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

loc_42344E:				; CODE XREF: sub_423350+3Ej
					; sub_423350+DFj
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_423350	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_423457	proc near		; CODE XREF: sub_42350B+468p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 15h	; switch 8 cases
		cmp	eax, 7
		ja	short loc_4234FD ; jumptable 0042348A default case
		mov	eax, ds:off_445DF0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_42348C:				; CODE XREF: sub_423457+33j
					; DATA XREF: .rdata:off_445DF0o
		mov	eax, [ebp+var_10] ; jumptable 0042348A case 21
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dl
		jmp	short loc_423504
; ---------------------------------------------------------------------------

loc_423498:				; CODE XREF: sub_423457+33j
					; DATA XREF: .rdata:off_445DF0o
		mov	eax, [ebp+var_10] ; jumptable 0042348A case 22
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dx
		jmp	short loc_423504
; ---------------------------------------------------------------------------

loc_4234A5:				; CODE XREF: sub_423457+33j
					; DATA XREF: .rdata:off_445DF0o
		mov	eax, [ebp+var_10] ; jumptable 0042348A case 24
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_423504
; ---------------------------------------------------------------------------

loc_4234B1:				; CODE XREF: sub_423457+33j
					; DATA XREF: .rdata:off_445DF0o
		mov	ecx, [ebp+var_10] ; jumptable 0042348A case 25
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_423504
; ---------------------------------------------------------------------------

loc_4234C5:				; CODE XREF: sub_423457+33j
					; DATA XREF: .rdata:off_445DF0o
		mov	ecx, [ebp+var_10] ; jumptable 0042348A case 26
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_423504
; ---------------------------------------------------------------------------

loc_4234D9:				; CODE XREF: sub_423457+33j
					; DATA XREF: .rdata:off_445DF0o
		mov	eax, [ebp+var_10] ; jumptable 0042348A case 27
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_423504
; ---------------------------------------------------------------------------

loc_4234E5:				; CODE XREF: sub_423457+33j
					; DATA XREF: .rdata:off_445DF0o
		mov	eax, [ebp+var_10] ; jumptable 0042348A case 28
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_423504
; ---------------------------------------------------------------------------

loc_4234F1:				; CODE XREF: sub_423457+33j
					; DATA XREF: .rdata:off_445DF0o
		mov	eax, [ebp+var_10] ; jumptable 0042348A case 23
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_423504
; ---------------------------------------------------------------------------

loc_4234FD:				; CODE XREF: sub_423457+2Aj
		mov	eax, 0FFFFFFFFh	; jumptable 0042348A default case
		jmp	short locret_423509
; ---------------------------------------------------------------------------

loc_423504:				; CODE XREF: sub_423457+3Fj
					; sub_423457+4Cj ...
		mov	eax, 0

locret_423509:				; CODE XREF: sub_423457+ABj
		leave
		retn
sub_423457	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42350B	proc near		; CODE XREF: sub_4239EB+550p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_42398B
; ---------------------------------------------------------------------------

loc_423530:				; CODE XREF: sub_42350B+488j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_423543
		add	[ebp+var_10], 1
		jmp	loc_42398B
; ---------------------------------------------------------------------------

loc_423543:				; CODE XREF: sub_42350B+2Dj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jz	short loc_423593
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_423584
		mov	eax, [ebp+var_C]
		jmp	locret_4239E9
; ---------------------------------------------------------------------------

loc_423584:				; CODE XREF: sub_42350B+6Fj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_423593:				; CODE XREF: sub_42350B+3Ej
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_4235E7
		mov	[esp+58h+var_50], 1
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4235CB
		mov	eax, [ebp+var_C]
		jmp	locret_4239E9
; ---------------------------------------------------------------------------

loc_4235CB:				; CODE XREF: sub_42350B+B6j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		add	[ebp+var_10], 2
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		jmp	loc_42398B
; ---------------------------------------------------------------------------

loc_4235E7:				; CODE XREF: sub_42350B+93j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_10]
		jb	short loc_423619
		mov	[esp+58h+var_50], 52Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22_13 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgidxArgspecs ; "argidx < argspecs_len"
		call	sub_43BB20

loc_423619:				; CODE XREF: sub_42350B+F0j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	loc_4236AD
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_423664
		mov	[esp+58h+var_50], 533h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22_13 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgW ; "valuetable[arg->width_pos-1].vt == VALT"...
		call	sub_43BB20

loc_423664:				; CODE XREF: sub_42350B+13Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		test	eax, eax
		jns	short loc_4236AD
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+var_14]
		mov	[eax+4], edx

loc_4236AD:				; CODE XREF: sub_42350B+11Bj
					; sub_42350B+17Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_423722
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_4236F0
		mov	[esp+58h+var_50], 53Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22_13 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgP ; "valuetable[arg->precision_pos-1].vt	== "...
		call	sub_43BB20

loc_4236F0:				; CODE XREF: sub_42350B+1C7j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jns	short loc_423722
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_423722:				; CODE XREF: sub_42350B+1ABj
					; sub_42350B+20Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_423748
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 11h
		jnz	short loc_423748
		mov	eax, [ebp+arg_18]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	[ebp+var_30], eax
		jmp	short loc_4237B2
; ---------------------------------------------------------------------------

loc_423748:				; CODE XREF: sub_42350B+220j
					; sub_42350B+22Bj
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	ecx, eax
		jz	short loc_423785
		mov	[esp+58h+var_50], 547h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22_13 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgVtValuetabl ; "arg->vt == valuetable[arg->arg_pos-1].v"...
		call	sub_43BB20

loc_423785:				; CODE XREF: sub_42350B+25Cj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	[ebp+var_30], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_2C], edx
		mov	edx, [eax+10h]
		mov	[ebp+var_28], edx
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax

loc_4237B2:				; CODE XREF: sub_42350B+23Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_42397C	; jumptable 004237C8 default case
		mov	eax, ds:off_445EE8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4237CA:				; CODE XREF: sub_42350B+2BDj
					; DATA XREF: .rdata:off_445EE8o
		mov	[esp+58h+var_50], 54Dh ; jumptable 004237C8 case 0
		mov	[esp+58h+var_54], offset a____Gnupg22_13 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aBug ;	"!\"bug\""
		call	sub_43BB20
		jmp	loc_42397C	; jumptable 004237C8 default case
; ---------------------------------------------------------------------------

loc_4237EB:				; CODE XREF: sub_42350B+2BDj
					; DATA XREF: .rdata:off_445EE8o
		mov	eax, [ebp+arg_1C] ; jumptable 004237C8 cases 1-5
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_422675
		mov	[ebp+var_C], eax
		jmp	loc_42397C	; jumptable 004237C8 default case
; ---------------------------------------------------------------------------

loc_42382F:				; CODE XREF: sub_42350B+2BDj
					; DATA XREF: .rdata:off_445EE8o
		mov	eax, [ebp+arg_1C] ; jumptable 004237C8 cases 6-13
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_422D08
		mov	[ebp+var_C], eax
		jmp	loc_42397C	; jumptable 004237C8 default case
; ---------------------------------------------------------------------------

loc_423873:				; CODE XREF: sub_42350B+2BDj
					; DATA XREF: .rdata:off_445EE8o
		mov	eax, [ebp+arg_1C] ; jumptable 004237C8 case 14
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_42313D
		mov	[ebp+var_C], eax
		jmp	loc_42397C	; jumptable 004237C8 default case
; ---------------------------------------------------------------------------

loc_4238B7:				; CODE XREF: sub_42350B+2BDj
					; DATA XREF: .rdata:off_445EE8o
		mov	eax, [ebp+arg_1C] ; jumptable 004237C8 cases 15,17
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4231AF
		mov	[ebp+var_C], eax
		jmp	loc_42397C	; jumptable 004237C8 default case
; ---------------------------------------------------------------------------

loc_4238FB:				; CODE XREF: sub_42350B+2BDj
					; DATA XREF: .rdata:off_445EE8o
		mov	eax, [ebp+arg_1C] ; jumptable 004237C8 case 16
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_423350
		mov	[ebp+var_C], eax
		jmp	short loc_42397C ; jumptable 004237C8 default case
; ---------------------------------------------------------------------------

loc_42393C:				; CODE XREF: sub_42350B+2BDj
					; DATA XREF: .rdata:off_445EE8o
		mov	eax, [ebp+arg_1C] ; jumptable 004237C8 case 18
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_423457
		mov	[ebp+var_C], eax
		nop

loc_42397C:				; CODE XREF: sub_42350B+2B0j
					; sub_42350B+2DBj ...
		cmp	[ebp+var_C], 0	; jumptable 004237C8 default case
		jz	short loc_423987
		mov	eax, [ebp+var_C]
		jmp	short locret_4239E9
; ---------------------------------------------------------------------------

loc_423987:				; CODE XREF: sub_42350B+475j
		add	[ebp+var_14], 28h

loc_42398B:				; CODE XREF: sub_42350B+20j
					; sub_42350B+33j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_423530
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4239C9
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		jmp	short loc_4239CE
; ---------------------------------------------------------------------------

loc_4239C9:				; CODE XREF: sub_42350B+4A1j
		mov	eax, 0

loc_4239CE:				; CODE XREF: sub_42350B+4BCj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4239E6
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_4239E6:				; CODE XREF: sub_42350B+4CAj
		mov	eax, [ebp+var_C]

locret_4239E9:				; CODE XREF: sub_42350B+74j
					; sub_42350B+BBj ...
		leave
		retn
sub_42350B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4239EB	proc near		; CODE XREF: .text:00424017p
					; .text:0042404Ep ...

NumOfElements	= dword	ptr -1E8h
SizeOfElements	= dword	ptr -1E4h
var_1E0		= dword	ptr -1E0h
var_1DC		= dword	ptr -1DCh
var_1D8		= dword	ptr -1D8h
var_1D4		= dword	ptr -1D4h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1BC		= dword	ptr -1BCh
var_1B4		= dword	ptr -1B4h
var_1B0		= byte ptr -1B0h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= byte ptr -0E8h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1E0h
		lea	eax, [ebp+var_E8]
		mov	[ebp+var_EC], eax
		lea	eax, [ebp+var_1B0]
		mov	[ebp+Memory], eax
		mov	[ebp+var_1B4], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_F0]
		mov	[esp+1E8h+var_1DC], eax
		mov	[esp+1E8h+var_1E0], 5
		lea	eax, [ebp+var_EC]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_421BA1
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_423F65
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 0
		jmp	loc_423B31
; ---------------------------------------------------------------------------

loc_423A68:				; CODE XREF: sub_4239EB+14Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_423ABD
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_423ABD
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		mov	[ebp+var_1C], eax

loc_423ABD:				; CODE XREF: sub_4239EB+98j
					; sub_4239EB+B5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		cmp	eax, [ebp+var_1C]
		jle	short loc_423AF5
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], eax

loc_423AF5:				; CODE XREF: sub_4239EB+EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_423B2D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		mov	[ebp+var_1C], eax

loc_423B2D:				; CODE XREF: sub_4239EB+125j
		add	[ebp+var_14], 1

loc_423B31:				; CODE XREF: sub_4239EB+78j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_423A68
		cmp	[ebp+var_1C], 0
		jnz	loc_423C25
		mov	[ebp+var_14], 0
		jmp	loc_423C11
; ---------------------------------------------------------------------------

loc_423B56:				; CODE XREF: sub_4239EB+22Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_423B93
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+1Ch], eax

loc_423B93:				; CODE XREF: sub_4239EB+186j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_423BD0
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+20h], eax

loc_423BD0:				; CODE XREF: sub_4239EB+1C3j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_423C0D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+18h], eax

loc_423C0D:				; CODE XREF: sub_4239EB+200j
		add	[ebp+var_14], 1

loc_423C11:				; CODE XREF: sub_4239EB+166j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_423B56
		jmp	loc_423CDE
; ---------------------------------------------------------------------------

loc_423C25:				; CODE XREF: sub_4239EB+159j
		mov	[ebp+var_14], 0
		jmp	loc_423CCF
; ---------------------------------------------------------------------------

loc_423C31:				; CODE XREF: sub_4239EB+2EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_423F4F
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_423C8E
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_423F4F

loc_423C8E:				; CODE XREF: sub_4239EB+281j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_423CCB
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_423F4F

loc_423CCB:				; CODE XREF: sub_4239EB+2BEj
		add	[ebp+var_14], 1

loc_423CCF:				; CODE XREF: sub_4239EB+241j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_423C31

loc_423CDE:				; CODE XREF: sub_4239EB+235j
		cmp	[ebp+var_1C], 0
		js	loc_423F4F
		mov	ebx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1BC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1BC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jnb	loc_423F4F
		mov	eax, [ebp+var_1C]
		cmp	eax, 8
		jbe	short loc_423D41
		mov	eax, [ebp+var_1C]
		mov	[esp+1E8h+SizeOfElements], 18h ; SizeOfElements
		mov	[esp+1E8h+NumOfElements], eax ;	NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_423D69
		jmp	loc_423F5C
; ---------------------------------------------------------------------------

loc_423D41:				; CODE XREF: sub_4239EB+333j
		mov	[ebp+var_18], 0
		jmp	short loc_423D63
; ---------------------------------------------------------------------------

loc_423D4A:				; CODE XREF: sub_4239EB+37Cj
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		add	[ebp+var_18], 1

loc_423D63:				; CODE XREF: sub_4239EB+35Dj
		cmp	[ebp+var_18], 7
		jbe	short loc_423D4A

loc_423D69:				; CODE XREF: sub_4239EB+34Fj
		mov	[ebp+var_14], 0
		jmp	loc_423ECA
; ---------------------------------------------------------------------------

loc_423D75:				; CODE XREF: sub_4239EB+4E8j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_423DF4
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_423F45
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	ecx, eax
		add	ecx, [ebp+Memory]
		mov	ebx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ebx
		mov	eax, [eax+24h]
		mov	[ecx], eax

loc_423DF4:				; CODE XREF: sub_4239EB+3A5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_423E5D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_423F48
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_423E5D:				; CODE XREF: sub_4239EB+424j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_423EC6
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_423F4B
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_423EC6:				; CODE XREF: sub_4239EB+48Dj
		add	[ebp+var_14], 1

loc_423ECA:				; CODE XREF: sub_4239EB+385j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_423D75
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_C]
		mov	[esp+1E8h+var_1E0], edx
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_422319
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_423F4E
		mov	edx, [ebp+var_F0]
		mov	eax, [ebp+var_EC]
		lea	ecx, [ebp+var_1B4]
		mov	[esp+1E8h+var_1CC], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+1E8h+var_1D0], ecx
		mov	ecx, [ebp+Memory]
		mov	[esp+1E8h+var_1D4], ecx
		mov	[esp+1E8h+var_1D8], edx
		mov	[esp+1E8h+var_1DC], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+var_1E0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_42350B
		mov	[ebp+var_10], eax
		jmp	short loc_423F66
; ---------------------------------------------------------------------------

loc_423F45:				; CODE XREF: sub_4239EB+3D8j
		nop
		jmp	short loc_423F4F
; ---------------------------------------------------------------------------

loc_423F48:				; CODE XREF: sub_4239EB+457j
		nop
		jmp	short loc_423F4F
; ---------------------------------------------------------------------------

loc_423F4B:				; CODE XREF: sub_4239EB+4C0j
		nop
		jmp	short loc_423F4F
; ---------------------------------------------------------------------------

loc_423F4E:				; CODE XREF: sub_4239EB+50Ej
		nop

loc_423F4F:				; CODE XREF: sub_4239EB+260j
					; sub_4239EB+29Dj ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h

loc_423F5C:				; CODE XREF: sub_4239EB+351j
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_423F66
; ---------------------------------------------------------------------------

loc_423F65:				; CODE XREF: sub_4239EB+64j
		nop

loc_423F66:				; CODE XREF: sub_4239EB+558j
					; sub_4239EB+578j
		lea	eax, [ebp+var_1B0]
		cmp	[ebp+Memory], eax
		jz	short loc_423F7C
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_423F7C:				; CODE XREF: sub_4239EB+584j
		mov	edx, [ebp+var_EC]
		lea	eax, [ebp+var_E8]
		cmp	edx, eax
		jz	short loc_423F9A
		mov	eax, [ebp+var_EC]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_423F9A:				; CODE XREF: sub_4239EB+59Fj
		mov	eax, [ebp+var_10]
		add	esp, 1E0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4239EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_423FA7(int, void *, size_t)
sub_423FA7	proc near		; DATA XREF: .text:00424010o
					; .text:00424047o ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 1 ; Count
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_423FE0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_423FE5
; ---------------------------------------------------------------------------

loc_423FE0:				; CODE XREF: sub_423FA7+30j
		mov	eax, 0

locret_423FE5:				; CODE XREF: sub_423FA7+37j
		leave
		retn
sub_423FA7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	sub_423FA7
		call	sub_4239EB
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_423FA7
		call	sub_4239EB
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_423FA7
		call	sub_4239EB
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_424084(int, void *, size_t)
sub_424084	proc near		; CODE XREF: sub_424140+6Dp
					; DATA XREF: sub_424140+42o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_424139
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jnb	short loc_424124
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		jmp	short loc_424139
; ---------------------------------------------------------------------------

loc_4240FC:				; CODE XREF: sub_424084+B3j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		add	[ebp+arg_4], 1
		sub	[ebp+arg_8], 1

loc_424124:				; CODE XREF: sub_424084+3Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_424139
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jb	short loc_4240FC

loc_424139:				; CODE XREF: sub_424084+25j
					; sub_424084+76j ...
		mov	eax, 0
		leave
		retn
sub_424084	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424140	proc near		; CODE XREF: sub_4241F9+29p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_424165
		mov	eax, [ebp+arg_0]
		jmp	short loc_42416A
; ---------------------------------------------------------------------------

loc_424165:				; CODE XREF: sub_424140+1Ej
		mov	eax, 0

loc_42416A:				; CODE XREF: sub_424140+23j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset sub_424084
		call	sub_4239EB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4241B5
		mov	[esp+38h+var_30], 1 ; size_t
		mov	[esp+38h+var_34], offset byte_445F34 ; void *
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_424084
		mov	[ebp+var_C], eax

loc_4241B5:				; CODE XREF: sub_424140+55j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_4241C2
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4241F7
; ---------------------------------------------------------------------------

loc_4241C2:				; CODE XREF: sub_424140+79j
		cmp	[ebp+arg_4], 0
		jz	short loc_4241EB
		cmp	[ebp+arg_0], 0
		jz	short loc_4241EB
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_4241EB
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jb	short loc_4241EB
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0

loc_4241EB:				; CODE XREF: sub_424140+86j
					; sub_424140+8Cj ...
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_4241F7:				; CODE XREF: sub_424140+80j
		leave
		retn
sub_424140	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4241F9	proc near		; CODE XREF: sub_404743+55Ep
					; sub_404743+744p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_C]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_424140
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4241F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42422F(int, void *Src, size_t)
sub_42422F	proc near		; CODE XREF: sub_42433B+83p
					; DATA XREF: sub_42433B+58o

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42425C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_C]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_424339
; ---------------------------------------------------------------------------

loc_42425C:				; CODE XREF: sub_42422F+13j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_4242FD
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+NewSize], edx ; NewSize
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4242F4
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4242C3
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		jmp	short loc_4242C8
; ---------------------------------------------------------------------------

loc_4242C3:				; CODE XREF: sub_42422F+87j
		mov	eax, 0Ch

loc_4242C8:				; CODE XREF: sub_42422F+92j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+NewSize], 0 ; Val
		mov	[esp+28h+Memory], eax ;	Dst
		call	memset
		mov	eax, 0FFFFFFFFh
		jmp	short locret_424339
; ---------------------------------------------------------------------------

loc_4242F4:				; CODE XREF: sub_42422F+7Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_4242FD:				; CODE XREF: sub_42422F+40j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+NewSize], edx ; Src
		mov	[esp+28h+Memory], eax ;	Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, 0

locret_424339:				; CODE XREF: sub_42422F+28j
					; sub_42422F+C3j
		leave
		retn
sub_42422F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42433B	proc near		; CODE XREF: sub_424454+22p
					; .text:004256C6p ...

Dst		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 200h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		test	eax, eax
		jnz	short loc_42437E
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	locret_424452
; ---------------------------------------------------------------------------

loc_42437E:				; CODE XREF: sub_42433B+2Ej
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Val], eax
		mov	[esp+38h+Dst], offset sub_42422F
		call	sub_4239EB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4243C6
		mov	[esp+38h+Size],	1 ; size_t
		mov	[esp+38h+Val], offset byte_445F34 ; Src
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Dst], eax ; int
		call	sub_42422F
		mov	[ebp+var_C], eax

loc_4243C6:				; CODE XREF: sub_42433B+6Bj
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_4243E6
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_4243E6
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_1C]
		mov	[eax], edx

loc_4243E6:				; CODE XREF: sub_42433B+8Fj
					; sub_42433B+96j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_424421
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_424452
; ---------------------------------------------------------------------------

loc_424421:				; CODE XREF: sub_42433B+AFj
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_424444
		mov	[esp+38h+Size],	6E9h ; int
		mov	[esp+38h+Val], offset a____Gnupg22_13 ;	"../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+38h+Dst], offset aParm_used ; "parm.used"
		call	sub_43BB20

loc_424444:				; CODE XREF: sub_42433B+EBj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		sub	eax, 1

locret_424452:				; CODE XREF: sub_42433B+3Ej
					; sub_42433B+E4j
		leave
		retn
sub_42433B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424454	proc near		; CODE XREF: sub_40D199+FEp
					; sub_40E7CF+3E5p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42433B
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_424454	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424484	proc near		; CODE XREF: sub_404FBD+AEp
					; sub_406727+4Fp ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_4244D2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx

locret_4244D2:				; CODE XREF: sub_424484+3Dj
		leave
		retn
sub_424484	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	edx, [ebp+0Ch]
		mov	eax, [ebp+8]
		mov	[eax+4], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	gcry_malloc_secure
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax+8], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_424522
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx

locret_424522:				; CODE XREF: .text:00424511j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_424524(int, void *, size_t)
sub_424524	proc near		; CODE XREF: sub_404F91+20p
					; sub_404FBD+10Ep ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	loc_424611
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_4245DB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+400h]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Src], edx
		mov	[esp+28h+Dst], eax
		call	gcry_realloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4245D2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42459E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		jmp	short loc_4245A3
; ---------------------------------------------------------------------------

loc_42459E:				; CODE XREF: sub_424524+6Dj
		mov	eax, 0Ch

loc_4245A3:				; CODE XREF: sub_424524+78j
		mov	edx, [ebp+arg_0]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_4245CA
; ---------------------------------------------------------------------------

loc_4245BC:				; CODE XREF: sub_424524+AAj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_4245CA:				; CODE XREF: sub_424524+96j
		cmp	[ebp+var_10], 0
		jnz	short loc_4245BC
		jmp	short locret_424612
; ---------------------------------------------------------------------------

loc_4245D2:				; CODE XREF: sub_424524+60j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+8], edx

loc_4245DB:				; CODE XREF: sub_424524+26j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		jmp	short locret_424612
; ---------------------------------------------------------------------------

loc_424611:				; CODE XREF: sub_424524+Ej
		nop

locret_424612:				; CODE XREF: sub_424524+ACj
					; sub_424524+EBj
		leave
		retn
sub_424524	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_424614(int, void *)
sub_424614	proc near		; CODE XREF: sub_42B9D7+342p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+28h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_424524
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_424614	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424656	proc near		; CODE XREF: sub_404FBD+121p
					; sub_405615+13p ...

var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4246C5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4246AF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_424691
; ---------------------------------------------------------------------------

loc_424683:				; CODE XREF: sub_424656+3Fj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_424691:				; CODE XREF: sub_424656+2Bj
		cmp	[ebp+var_10], 0
		jnz	short loc_424683
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0

loc_4246AF:				; CODE XREF: sub_424656+18j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+0Ch]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_4246F5
; ---------------------------------------------------------------------------

loc_4246C5:				; CODE XREF: sub_424656+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_4246DE
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_4246DE:				; CODE XREF: sub_424656+7Cj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0Ch
		mov	eax, [ebp+var_14]

locret_4246F5:				; CODE XREF: sub_424656+6Dj
		leave
		retn
sub_424656	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4246F8	proc near		; CODE XREF: sub_405AD8+7Ep
					; sub_406F3A+ECp ...

C		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	loc_424843
; ---------------------------------------------------------------------------

loc_424710:				; CODE XREF: sub_4246F8+151j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_424724
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42474C

loc_424724:				; CODE XREF: sub_4246F8+20j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_424738
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42474C

loc_424738:				; CODE XREF: sub_4246F8+34j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42479A
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_42479A

loc_42474C:				; CODE XREF: sub_4246F8+2Aj
					; sub_4246F8+3Ej
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_424766
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4247A4

loc_424766:				; CODE XREF: sub_4246F8+5Fj
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_424780
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_4247A4

loc_424780:				; CODE XREF: sub_4246F8+79j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42479A
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_4247A4

loc_42479A:				; CODE XREF: sub_4246F8+48j
					; sub_4246F8+52j ...
		mov	eax, 0FFFFFFFFh
		jmp	locret_4248AA
; ---------------------------------------------------------------------------

loc_4247A4:				; CODE XREF: sub_4246F8+6Cj
					; sub_4246F8+86j ...
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		add	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4247C9
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4247F5
; ---------------------------------------------------------------------------

loc_4247C9:				; CODE XREF: sub_4246F8+BCj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4247E4
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4247F3
; ---------------------------------------------------------------------------

loc_4247E4:				; CODE XREF: sub_4246F8+D9j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4247F3:				; CODE XREF: sub_4246F8+EAj
		mov	edx, eax

loc_4247F5:				; CODE XREF: sub_4246F8+CFj
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_424810
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_424837
; ---------------------------------------------------------------------------

loc_424810:				; CODE XREF: sub_4246F8+108j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42482B
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_424837
; ---------------------------------------------------------------------------

loc_42482B:				; CODE XREF: sub_4246F8+123j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_424837:				; CODE XREF: sub_4246F8+116j
					; sub_4246F8+131j
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_C], 1
		add	[ebp+var_10], 2

loc_424843:				; CODE XREF: sub_4246F8+13j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	loc_424710
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424881
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_42487A
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_424881

loc_42487A:				; CODE XREF: sub_4246F8+169j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4248AA
; ---------------------------------------------------------------------------

loc_424881:				; CODE XREF: sub_4246F8+15Fj
					; sub_4246F8+180j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jz	short loc_424890
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4248AA
; ---------------------------------------------------------------------------

loc_424890:				; CODE XREF: sub_4246F8+18Fj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42489E
		add	[ebp+var_10], 1

loc_42489E:				; CODE XREF: sub_4246F8+1A0j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_4248AA:				; CODE XREF: sub_4246F8+A7j
					; sub_4246F8+187j ...
		leave
		retn
sub_4246F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4248AC	proc near		; CODE XREF: sub_417DD9+41Ap
					; sub_418748+2Ap

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	loc_424A41
; ---------------------------------------------------------------------------

loc_4248CB:				; CODE XREF: sub_4248AC+19Bj
		cmp	[ebp+var_C], 1
		jnz	short loc_4248E8
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_4248E8
		mov	[ebp+var_14], 1
		add	[ebp+var_10], 1
		jmp	short loc_42490E
; ---------------------------------------------------------------------------

loc_4248E8:				; CODE XREF: sub_4248AC+23j
					; sub_4248AC+2Dj
		cmp	[ebp+var_14], 0
		jz	short loc_4248FE
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_4248FE
		add	[ebp+var_10], 1
		jmp	short loc_42490E
; ---------------------------------------------------------------------------

loc_4248FE:				; CODE XREF: sub_4248AC+40j
					; sub_4248AC+4Aj
		cmp	[ebp+var_14], 0
		jz	short loc_42490E
		mov	eax, 0FFFFFFFFh
		jmp	locret_424AB9
; ---------------------------------------------------------------------------

loc_42490E:				; CODE XREF: sub_4248AC+3Aj
					; sub_4248AC+50j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_424922
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42494A

loc_424922:				; CODE XREF: sub_4248AC+6Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_424936
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42494A

loc_424936:				; CODE XREF: sub_4248AC+7Ej
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_424998
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_424998

loc_42494A:				; CODE XREF: sub_4248AC+74j
					; sub_4248AC+88j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_424964
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4249A2

loc_424964:				; CODE XREF: sub_4248AC+A9j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42497E
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_4249A2

loc_42497E:				; CODE XREF: sub_4248AC+C3j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_424998
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_4249A2

loc_424998:				; CODE XREF: sub_4248AC+92j
					; sub_4248AC+9Cj ...
		mov	eax, 0FFFFFFFFh
		jmp	locret_424AB9
; ---------------------------------------------------------------------------

loc_4249A2:				; CODE XREF: sub_4248AC+B6j
					; sub_4248AC+D0j ...
		mov	eax, [ebp+var_C]
		mov	ecx, eax
		add	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4249C7
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4249F3
; ---------------------------------------------------------------------------

loc_4249C7:				; CODE XREF: sub_4248AC+106j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4249E2
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4249F1
; ---------------------------------------------------------------------------

loc_4249E2:				; CODE XREF: sub_4248AC+123j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4249F1:				; CODE XREF: sub_4248AC+134j
		mov	edx, eax

loc_4249F3:				; CODE XREF: sub_4248AC+119j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_424A0E
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_424A35
; ---------------------------------------------------------------------------

loc_424A0E:				; CODE XREF: sub_4248AC+152j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_424A29
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_424A35
; ---------------------------------------------------------------------------

loc_424A29:				; CODE XREF: sub_4248AC+16Dj
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_424A35:				; CODE XREF: sub_4248AC+160j
					; sub_4248AC+17Bj
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_C], 1
		add	[ebp+var_10], 2

loc_424A41:				; CODE XREF: sub_4248AC+1Aj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	loc_4248CB
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_424A5E
		mov	eax, 0FFFFFFFFh
		jmp	short locret_424AB9
; ---------------------------------------------------------------------------

loc_424A5E:				; CODE XREF: sub_4248AC+1A9j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424A90
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_424A89
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_424A90

loc_424A89:				; CODE XREF: sub_4248AC+1C4j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_424AB9
; ---------------------------------------------------------------------------

loc_424A90:				; CODE XREF: sub_4248AC+1BAj
					; sub_4248AC+1DBj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jz	short loc_424A9F
		mov	eax, 0FFFFFFFFh
		jmp	short locret_424AB9
; ---------------------------------------------------------------------------

loc_424A9F:				; CODE XREF: sub_4248AC+1EAj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424AAD
		add	[ebp+var_10], 1

loc_424AAD:				; CODE XREF: sub_4248AC+1FBj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_424AB9:				; CODE XREF: sub_4248AC+5Dj
					; sub_4248AC+F1j ...
		leave
		retn
sub_4248AC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424ABB	proc near		; CODE XREF: sub_424BE8+22p
					; sub_424C11+22p

var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jnz	short loc_424B37
		cmp	[ebp+arg_C], 0
		jz	short loc_424AD4
		mov	eax, 3
		jmp	short loc_424AD9
; ---------------------------------------------------------------------------

loc_424AD4:				; CODE XREF: sub_424ABB+10j
		mov	eax, 2

loc_424AD9:				; CODE XREF: sub_424ABB+17j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		imul	eax, [ebp+arg_4]
		add	eax, 1
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_424B19
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	edx, 0
		div	[ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jz	short loc_424B19
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	locret_424BE6
; ---------------------------------------------------------------------------

loc_424B19:				; CODE XREF: sub_424ABB+32j
					; sub_424ABB+45j
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+arg_8], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_424B37
		mov	eax, 0
		jmp	locret_424BE6
; ---------------------------------------------------------------------------

loc_424B37:				; CODE XREF: sub_424ABB+Aj
					; sub_424ABB+70j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_424BD3
; ---------------------------------------------------------------------------

loc_424B48:				; CODE XREF: sub_424ABB+11Cj
		cmp	[ebp+arg_C], 0
		jz	short loc_424B60
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jz	short loc_424B60
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	3Ah
		add	[ebp+var_10], 1

loc_424B60:				; CODE XREF: sub_424ABB+91j
					; sub_424ABB+99j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_424B82
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_424B8E
; ---------------------------------------------------------------------------

loc_424B82:				; CODE XREF: sub_424ABB+B7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 37h

loc_424B8E:				; CODE XREF: sub_424ABB+C5j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_424BB6
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_424BC2
; ---------------------------------------------------------------------------

loc_424BB6:				; CODE XREF: sub_424ABB+EBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 37h

loc_424BC2:				; CODE XREF: sub_424ABB+F9j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_424BD3:				; CODE XREF: sub_424ABB+88j
		cmp	[ebp+arg_4], 0
		jnz	loc_424B48
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]

locret_424BE6:				; CODE XREF: sub_424ABB+59j
					; sub_424ABB+77j
		leave
		retn
sub_424ABB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424BE8	proc near		; CODE XREF: sub_406B69+91p
					; sub_4073FD+8Fp ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_424ABB
		leave
		retn
sub_424BE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424C11	proc near		; CODE XREF: sub_424FF7+5A0p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 1
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_424ABB
		leave
		retn
sub_424C11	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424C3A	proc near		; CODE XREF: sub_407E3F+18Fp
					; .text:00424F1Ep ...

C		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_424C5C
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_424C5C:				; CODE XREF: sub_424C3A+17j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_424C73
; ---------------------------------------------------------------------------

loc_424C6B:				; CODE XREF: sub_424C3A+8Dj
					; sub_424C3A+A7j ...
		add	[ebp+var_C], 2
		add	[ebp+var_14], 1

loc_424C73:				; CODE XREF: sub_424C3A+2Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_424C87
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_424CAF

loc_424C87:				; CODE XREF: sub_424C3A+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_424C9B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_424CAF

loc_424C9B:				; CODE XREF: sub_424C3A+55j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_424D01
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_424D01

loc_424CAF:				; CODE XREF: sub_424C3A+4Bj
					; sub_424C3A+5Fj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_424CC9
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_424C6B

loc_424CC9:				; CODE XREF: sub_424C3A+80j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_424CE3
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_424C6B

loc_424CE3:				; CODE XREF: sub_424C3A+9Aj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_424D01
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_424C6B

loc_424D01:				; CODE XREF: sub_424C3A+69j
					; sub_424C3A+73j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424D36
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_424D2C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_424D36

loc_424D2C:				; CODE XREF: sub_424C3A+D9j
		mov	eax, 0
		jmp	locret_424EF9
; ---------------------------------------------------------------------------

loc_424D36:				; CODE XREF: sub_424C3A+CFj
					; sub_424C3A+F0j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jz	short loc_424D58
		mov	eax, [ebp+var_C]
		sub	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_424D58
		mov	eax, [ebp+var_C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_424D5F

loc_424D58:				; CODE XREF: sub_424C3A+102j
					; sub_424C3A+10Fj
		mov	eax, 1
		jmp	short loc_424D64
; ---------------------------------------------------------------------------

loc_424D5F:				; CODE XREF: sub_424C3A+11Cj
		mov	eax, 0

loc_424D64:				; CODE XREF: sub_424C3A+123j
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_424D71
		add	[ebp+var_14], 1

loc_424D71:				; CODE XREF: sub_424C3A+131j
		cmp	[ebp+arg_4], 0
		jz	loc_424EE3
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_424D8D
		mov	eax, 0
		jmp	locret_424EF9
; ---------------------------------------------------------------------------

loc_424D8D:				; CODE XREF: sub_424C3A+147j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_424E3E
; ---------------------------------------------------------------------------

loc_424D9F:				; CODE XREF: sub_424C3A+258j
					; sub_424C3A+276j ...
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		add	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_424DC4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_424DF0
; ---------------------------------------------------------------------------

loc_424DC4:				; CODE XREF: sub_424C3A+175j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_424DDF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_424DEE
; ---------------------------------------------------------------------------

loc_424DDF:				; CODE XREF: sub_424C3A+192j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_424DEE:				; CODE XREF: sub_424C3A+1A3j
		mov	edx, eax

loc_424DF0:				; CODE XREF: sub_424C3A+188j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_424E0B
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_424E32
; ---------------------------------------------------------------------------

loc_424E0B:				; CODE XREF: sub_424C3A+1C1j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_424E26
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_424E32
; ---------------------------------------------------------------------------

loc_424E26:				; CODE XREF: sub_424C3A+1DCj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_424E32:				; CODE XREF: sub_424C3A+1CFj
					; sub_424C3A+1EAj
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_10], 1
		add	[ebp+var_C], 2

loc_424E3E:				; CODE XREF: sub_424C3A+160j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_424E52
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_424E7A

loc_424E52:				; CODE XREF: sub_424C3A+20Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_424E66
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_424E7A

loc_424E66:				; CODE XREF: sub_424C3A+220j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_424ED4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_424ED4

loc_424E7A:				; CODE XREF: sub_424C3A+216j
					; sub_424C3A+22Aj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_424E98
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	loc_424D9F

loc_424E98:				; CODE XREF: sub_424C3A+24Bj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_424EB6
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	loc_424D9F

loc_424EB6:				; CODE XREF: sub_424C3A+269j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_424ED4
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_424D9F

loc_424ED4:				; CODE XREF: sub_424C3A+234j
					; sub_424C3A+23Ej ...
		cmp	[ebp+var_18], 0
		jz	short loc_424EE3
		mov	eax, [ebp+var_10]
		add	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0

loc_424EE3:				; CODE XREF: sub_424C3A+13Bj
					; sub_424C3A+29Ej
		cmp	[ebp+arg_C], 0
		jz	short loc_424EF6
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_424EF6:				; CODE XREF: sub_424C3A+2ADj
		mov	eax, [ebp+var_C]

locret_424EF9:				; CODE XREF: sub_424C3A+F7j
					; sub_424C3A+14Ej
		leave
		retn
sub_424C3A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_424C3A
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_424F4F
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_424F3B
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_424F3B:				; CODE XREF: .text:00424F30j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short locret_424FCD
; ---------------------------------------------------------------------------

loc_424F4F:				; CODE XREF: .text:00424F2Aj
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_424F68
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_424F68:				; CODE XREF: .text:00424F53j
		mov	eax, [ebp-14h]
		add	eax, 1
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_424F86
		mov	eax, 0
		jmp	short locret_424FCD
; ---------------------------------------------------------------------------

loc_424F86:				; CODE XREF: .text:00424F7Dj
		mov	eax, [ebp-14h]
		add	eax, 1
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], eax
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_424C3A
		test	eax, eax
		jnz	short loc_424FCA
		mov	dword ptr [esp+8], offset aHex2str_alloc ; "hex2str_alloc"
		mov	dword ptr [esp+4], 0F4h
		mov	dword ptr [esp], offset	a____Gnupg22_14	; "../../gnupg2-2.0.30/common/convert.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_424FCA:				; CODE XREF: .text:00424FACj
		mov	eax, [ebp-10h]

locret_424FCD:				; CODE XREF: .text:00424F4Dj
					; .text:00424F84j
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424FD0	proc near		; CODE XREF: sub_424FF7+D5p
					; sub_424FF7+132p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_424FF0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_424FF5
; ---------------------------------------------------------------------------

loc_424FF0:				; CODE XREF: sub_424FD0+7j
		mov	eax, 0

loc_424FF5:				; CODE XREF: sub_424FD0+1Ej
		pop	ebp
		retn
sub_424FD0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424FF7	proc near		; CODE XREF: .text:0042565Dp
					; sub_425664+29p

Str		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_2C], 0
		mov	[ebp+var_3C], 0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset aPublicKey_2 ;	"public-key"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_425070
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset aPrivateKey_3 ; "private-key"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_20], eax

loc_425070:				; CODE XREF: sub_424FF7+59j
		cmp	[ebp+var_20], 0
		jnz	short loc_425094
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset aProtectedPri_2 ; "protected-private-key"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_20], eax

loc_425094:				; CODE XREF: sub_424FF7+7Dj
		cmp	[ebp+var_20], 0
		jnz	short loc_4250B8
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset aShadowedPriv_2 ; "shadowed-private-key"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_20], eax

loc_4250B8:				; CODE XREF: sub_424FF7+A1j
		cmp	[ebp+var_20], 0
		jnz	short loc_4250D9
		mov	[esp+58h+var_54], 68h
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Str], eax
		call	sub_424FD0
		mov	[ebp+var_1C], eax
		jmp	loc_4255FD
; ---------------------------------------------------------------------------

loc_4250D9:				; CODE XREF: sub_424FF7+C5j
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_cadr
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		mov	[ebp+var_24], 0
		mov	[esp+58h+var_54], 0
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_nth_string
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_425136
		mov	[esp+58h+var_54], 53h
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Str], eax
		call	sub_424FD0
		mov	[ebp+var_1C], eax
		jmp	loc_4255FD
; ---------------------------------------------------------------------------

loc_425136:				; CODE XREF: sub_424FF7+122j
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], 1
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Str], eax
		call	gcry_md_open
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_4255F6
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Str], eax
		call	gcry_pk_map_name
		cmp	eax, 11h
		jz	short loc_4251B5
		cmp	eax, 11h
		jg	short loc_42517D
		cmp	eax, 1
		jz	short loc_42518E
		jmp	loc_4253E6
; ---------------------------------------------------------------------------

loc_42517D:				; CODE XREF: sub_424FF7+17Aj
		cmp	eax, 12h
		jz	short loc_4251DC
		cmp	eax, 12Dh
		jz	short loc_4251DC
		jmp	loc_4253E6
; ---------------------------------------------------------------------------

loc_42518E:				; CODE XREF: sub_424FF7+17Fj
		mov	[ebp+var_34], offset aEn ; "en"
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+var_50], 0Bh
		mov	[esp+58h+var_54], offset byte_445FB9
		mov	[esp+58h+Str], eax
		call	gcry_md_write
		jmp	loc_425406
; ---------------------------------------------------------------------------

loc_4251B5:				; CODE XREF: sub_424FF7+175j
		mov	[ebp+var_34], offset aPqgy_0 ; "pqgy"
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+var_50], 0Bh
		mov	[esp+58h+var_54], offset word_445FCA
		mov	[esp+58h+Str], eax
		call	gcry_md_write
		jmp	loc_425406
; ---------------------------------------------------------------------------

loc_4251DC:				; CODE XREF: sub_424FF7+189j
					; sub_424FF7+190j
		mov	[ebp+var_34], (offset aSq+2) ; "q"
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+var_50], 14h
		mov	[esp+58h+var_54], (offset aSq+4) ; ""
		mov	[esp+58h+Str], eax
		call	gcry_md_write
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], offset aCurve_1 ; "curve"
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_42522E
		mov	[ebp+var_34], offset byte_445FF3
		jmp	loc_4253C4
; ---------------------------------------------------------------------------

loc_42522E:				; CODE XREF: sub_424FF7+229j
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	[esp+58h+var_54], 1
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_nth_string
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_release
		mov	[ebp+var_24], 0
		cmp	[ebp+var_2C], 0
		jnz	short loc_425273
		mov	[ebp+var_34], offset byte_445FF3
		jmp	loc_4253C4
; ---------------------------------------------------------------------------

loc_425273:				; CODE XREF: sub_424FF7+26Ej
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		mov	eax, offset aNistP256_0	; "NIST	P-256"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4252C3
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		mov	eax, offset aNistp256_0	; "nistp256"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4252E3

loc_4252C3:				; CODE XREF: sub_424FF7+2A2j
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+var_50], 0Fh
		mov	[esp+58h+var_54], offset a256 ;	"256"
		mov	[esp+58h+Str], eax
		call	gcry_md_write
		jmp	loc_4253C4
; ---------------------------------------------------------------------------

loc_4252E3:				; CODE XREF: sub_424FF7+2CAj
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		mov	eax, offset aNistP384_0	; "NIST	P-384"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_425333
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		mov	eax, offset aNistp384_0	; "nistp384"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_425350

loc_425333:				; CODE XREF: sub_424FF7+312j
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+var_50], 0Fh
		mov	[esp+58h+var_54], offset a384 ;	"384"
		mov	[esp+58h+Str], eax
		call	gcry_md_write
		jmp	short loc_4253C4
; ---------------------------------------------------------------------------

loc_425350:				; CODE XREF: sub_424FF7+33Aj
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		mov	eax, offset aNistP521_0	; "NIST	P-521"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4253A0
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		mov	eax, offset aNistp521_0	; "nistp521"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4253BD

loc_4253A0:				; CODE XREF: sub_424FF7+37Fj
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+var_50], 0Fh
		mov	[esp+58h+var_54], offset a521 ;	"521"
		mov	[esp+58h+Str], eax
		call	gcry_md_write
		jmp	short loc_4253C4
; ---------------------------------------------------------------------------

loc_4253BD:				; CODE XREF: sub_424FF7+3A7j
		mov	[ebp+var_34], offset byte_445FF3

loc_4253C4:				; CODE XREF: sub_424FF7+232j
					; sub_424FF7+277j ...
		mov	eax, [ebp+var_34]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425405
		mov	[esp+58h+var_54], 0BCh
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Str], eax
		call	sub_424FD0
		mov	[ebp+var_1C], eax
		jmp	short loc_425405
; ---------------------------------------------------------------------------

loc_4253E6:				; CODE XREF: sub_424FF7+181j
					; sub_424FF7+192j
		mov	[ebp+var_34], offset byte_445FF3
		mov	[esp+58h+var_54], 4
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Str], eax
		call	sub_424FD0
		mov	[ebp+var_1C], eax
		jmp	short loc_425406
; ---------------------------------------------------------------------------

loc_425405:				; CODE XREF: sub_424FF7+3D5j
					; sub_424FF7+3EDj
		nop

loc_425406:				; CODE XREF: sub_424FF7+1B9j
					; sub_424FF7+1E0j ...
		cmp	[ebp+var_1C], 0
		jnz	loc_4255F9
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_34]
		mov	[ebp+var_28], eax
		jmp	loc_425516
; ---------------------------------------------------------------------------

loc_425422:				; CODE XREF: sub_424FF7+527j
		mov	[esp+58h+var_50], 1
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_find_token
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_425460
		mov	[esp+58h+var_54], 53h
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Str], eax
		call	sub_424FD0
		mov	[ebp+var_1C], eax
		jmp	loc_4255FD
; ---------------------------------------------------------------------------

loc_425460:				; CODE XREF: sub_424FF7+44Cj
		mov	[esp+58h+var_50], 5
		mov	[esp+58h+var_54], 1
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_nth_mpi
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_release
		mov	[ebp+var_24], 0
		cmp	[ebp+var_38], 0
		jnz	short loc_4254B1
		mov	[esp+58h+var_54], 53h
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Str], eax
		call	sub_424FD0
		mov	[ebp+var_1C], eax
		jmp	loc_4255FD
; ---------------------------------------------------------------------------

loc_4254B1:				; CODE XREF: sub_424FF7+49Dj
		mov	eax, [ebp+var_38]
		mov	[esp+58h+var_4C], eax
		lea	eax, [ebp+var_44]
		mov	[esp+58h+var_50], eax
		lea	eax, [ebp+var_40]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+Str], 3
		call	gcry_mpi_aprint
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_38]
		mov	[esp+58h+Str], eax
		call	gcry_mpi_release
		cmp	[ebp+var_1C], 0
		jnz	loc_4255FC
		mov	ecx, [ebp+var_44]
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+var_50], ecx
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+Str], eax
		call	gcry_md_write
		mov	eax, [ebp+var_40]
		mov	[esp+58h+Str], eax
		call	gcry_free
		add	[ebp+var_28], 1
		add	[ebp+var_30], 1

loc_425516:				; CODE XREF: sub_424FF7+426j
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_425422
		cmp	[ebp+arg_10], 0
		jz	short loc_425531
		mov	eax, 3Dh
		jmp	short loc_425536
; ---------------------------------------------------------------------------

loc_425531:				; CODE XREF: sub_424FF7+531j
		mov	eax, 14h

loc_425536:				; CODE XREF: sub_424FF7+538j
		mov	[esp+58h+Str], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42556A
		call	gpg_err_code_from_syserror
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Str], eax
		call	sub_424FD0
		mov	[ebp+var_1C], eax
		jmp	loc_4255FD
; ---------------------------------------------------------------------------

loc_42556A:				; CODE XREF: sub_424FF7+555j
		cmp	[ebp+arg_10], 0
		jz	short loc_4255B4
		mov	eax, [ebp+arg_4]
		mov	ebx, [eax]
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+var_54], 1
		mov	[esp+58h+Str], eax
		call	gcry_md_read
		mov	[esp+58h+var_50], ebx
		mov	[esp+58h+var_54], 10h
		mov	[esp+58h+Str], eax
		call	sub_424C11
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 31h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+58h+Str], eax ; Str
		call	_strlwr
		jmp	short loc_4255ED
; ---------------------------------------------------------------------------

loc_4255B4:				; CODE XREF: sub_424FF7+577j
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+var_54], 1
		mov	[esp+58h+Str], eax
		call	gcry_md_read
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 10h

loc_4255ED:				; CODE XREF: sub_424FF7+5BBj
		mov	[ebp+var_1C], 0
		jmp	short loc_4255FD
; ---------------------------------------------------------------------------

loc_4255F6:				; CODE XREF: sub_424FF7+161j
		nop
		jmp	short loc_4255FD
; ---------------------------------------------------------------------------

loc_4255F9:				; CODE XREF: sub_424FF7+413j
		nop
		jmp	short loc_4255FD
; ---------------------------------------------------------------------------

loc_4255FC:				; CODE XREF: sub_424FF7+4EDj
		nop

loc_4255FD:				; CODE XREF: sub_424FF7+DDj
					; sub_424FF7+13Aj ...
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+Str], eax
		call	gcry_md_close
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_424FF7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_424FF7
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425664	proc near		; CODE XREF: sub_406B69+203p
					; sub_40C7DB+F8p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+var_28], 1
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_424FF7
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		leave
		retn
sub_425664	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42433B
		test	eax, eax
		jns	short loc_4256F0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aEstream_asprin	; "estream_asprintf failed: %s\n"
		call	sub_435BC0
; ---------------------------------------------------------------------------

loc_4256F0:				; CODE XREF: .text:004256CDj
		mov	eax, [ebp-10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4256F5	proc near		; CODE XREF: sub_406B69+33Ap
					; sub_408650+320p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_42433B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_42572C
		mov	eax, 0
		jmp	short locret_42572F
; ---------------------------------------------------------------------------

loc_42572C:				; CODE XREF: sub_4256F5+2Ej
		mov	eax, [ebp+var_14]

locret_42572F:				; CODE XREF: sub_4256F5+35j
		leave
		retn
sub_4256F5	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 1
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		jmp	short loc_42577F
; ---------------------------------------------------------------------------

loc_425749:				; CODE XREF: .text:00425787j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jz	short loc_425771
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jz	short loc_425771
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_425771
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		ja	short loc_425777

loc_425771:				; CODE XREF: .text:00425751j
					; .text:0042575Bj ...
		add	dword ptr [ebp-14h], 3
		jmp	short loc_42577B
; ---------------------------------------------------------------------------

loc_425777:				; CODE XREF: .text:0042576Fj
		add	dword ptr [ebp-14h], 1

loc_42577B:				; CODE XREF: .text:00425775j
		add	dword ptr [ebp-10h], 1

loc_42577F:				; CODE XREF: .text:00425747j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425749
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_4257AD
		mov	eax, 0
		jmp	locret_42584B
; ---------------------------------------------------------------------------

loc_4257AD:				; CODE XREF: .text:004257A1j
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		jmp	short loc_425834
; ---------------------------------------------------------------------------

loc_4257B5:				; CODE XREF: .text:0042583Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jz	short loc_4257DD
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jz	short loc_4257DD
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_4257DD
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		ja	short loc_42580B

loc_4257DD:				; CODE XREF: .text:004257BDj
					; .text:004257C7j ...
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset a02x_1 ; "%%%02X"
		mov	dword ptr [esp+4], 4
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4241F9
		add	dword ptr [ebp-0Ch], 3
		jmp	short loc_425830
; ---------------------------------------------------------------------------

loc_42580B:				; CODE XREF: .text:004257DBj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_425821
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	2Bh
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_425830
; ---------------------------------------------------------------------------

loc_425821:				; CODE XREF: .text:00425813j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_425830:				; CODE XREF: .text:00425809j
					; .text:0042581Fj
		add	dword ptr [ebp-10h], 1

loc_425834:				; CODE XREF: .text:004257B3j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4257B5
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-18h]

locret_42584B:				; CODE XREF: .text:004257A8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42584D	proc near		; CODE XREF: sub_4259D7+46p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		jmp	loc_425969
; ---------------------------------------------------------------------------

loc_42585E:				; CODE XREF: sub_42584D+124j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_42593E
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_42593E
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_42593E
		add	[ebp+arg_4], 1
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_4258AF
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4258DB
; ---------------------------------------------------------------------------

loc_4258AF:				; CODE XREF: sub_42584D+4Dj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_4258CA
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4258D9
; ---------------------------------------------------------------------------

loc_4258CA:				; CODE XREF: sub_42584D+6Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4258D9:				; CODE XREF: sub_42584D+7Bj
		mov	edx, eax

loc_4258DB:				; CODE XREF: sub_42584D+60j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_4258F6
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42591D
; ---------------------------------------------------------------------------

loc_4258F6:				; CODE XREF: sub_42584D+99j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_425911
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42591D
; ---------------------------------------------------------------------------

loc_425911:				; CODE XREF: sub_42584D+B4j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42591D:				; CODE XREF: sub_42584D+A7j
					; sub_42584D+C2j
		add	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425938
		mov	eax, [ebp+arg_C]
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_425938:				; CODE XREF: sub_42584D+DFj
		add	[ebp+arg_4], 1
		jmp	short loc_425961
; ---------------------------------------------------------------------------

loc_42593E:				; CODE XREF: sub_42584D+19j
					; sub_42584D+2Aj ...
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_425956
		cmp	[ebp+arg_8], 0
		jz	short loc_425956
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	20h
		jmp	short loc_425961
; ---------------------------------------------------------------------------

loc_425956:				; CODE XREF: sub_42584D+F9j
					; sub_42584D+FFj
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_425961:				; CODE XREF: sub_42584D+EFj
					; sub_42584D+107j
		add	[ebp+var_4], 1
		add	[ebp+arg_4], 1

loc_425969:				; CODE XREF: sub_42584D+Cj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_42585E
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		leave
		retn
sub_42584D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425985	proc near		; CODE XREF: sub_4259D7+Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		jmp	short loc_4259C8
; ---------------------------------------------------------------------------

loc_425994:				; CODE XREF: sub_425985+4Bj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_4259C0
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4259C0
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4259C0
		add	[ebp+arg_0], 1
		add	[ebp+arg_0], 1

loc_4259C0:				; CODE XREF: sub_425985+17j
					; sub_425985+24j ...
		add	[ebp+arg_0], 1
		add	[ebp+var_4], 1

loc_4259C8:				; CODE XREF: sub_425985+Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425994
		mov	eax, [ebp+var_4]
		leave
		retn
sub_425985	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4259D7	proc near		; CODE XREF: sub_425A59+1Bp
					; .text:00425A96p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_425985
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_425A54
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_42584D
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_C]
		jz	short loc_425A49
		mov	[esp+28h+var_20], 92h ;	int
		mov	[esp+28h+var_24], offset a____Gnupg22_15 ; "../../gnupg2-2.0.30/common/percent.c"
		mov	[esp+28h+var_28], offset aNNbytes ; "n == nbytes"
		call	sub_43BB20

loc_425A49:				; CODE XREF: sub_4259D7+54j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	byte ptr [eax],	0

loc_425A54:				; CODE XREF: sub_4259D7+29j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4259D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425A59	proc near		; CODE XREF: sub_41BD2D+ACp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+var_14], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4259D7
		leave
		retn
sub_425A59	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4259D7
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425A9D	proc near		; CODE XREF: sub_425BDD+1Bp
					; .text:00425C1Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		mov	[ebp+var_4], eax
		jmp	loc_425BC1
; ---------------------------------------------------------------------------

loc_425AB4:				; CODE XREF: sub_425A9D+12Cj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_425B94
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_425B94
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_425B94
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_425B05
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_425B31
; ---------------------------------------------------------------------------

loc_425B05:				; CODE XREF: sub_425A9D+53j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_425B20
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_425B2F
; ---------------------------------------------------------------------------

loc_425B20:				; CODE XREF: sub_425A9D+70j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_425B2F:				; CODE XREF: sub_425A9D+81j
		mov	edx, eax

loc_425B31:				; CODE XREF: sub_425A9D+66j
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_425B4C
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_425B73
; ---------------------------------------------------------------------------

loc_425B4C:				; CODE XREF: sub_425A9D+9Fj
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_425B67
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_425B73
; ---------------------------------------------------------------------------

loc_425B67:				; CODE XREF: sub_425A9D+BAj
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_425B73:				; CODE XREF: sub_425A9D+ADj
					; sub_425A9D+C8j
		add	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425B8E
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_425B8E:				; CODE XREF: sub_425A9D+E5j
		add	[ebp+arg_0], 1
		jmp	short loc_425BB9
; ---------------------------------------------------------------------------

loc_425B94:				; CODE XREF: sub_425A9D+1Fj
					; sub_425A9D+30j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_425BAC
		cmp	[ebp+arg_4], 0
		jz	short loc_425BAC
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	20h
		jmp	short loc_425BB9
; ---------------------------------------------------------------------------

loc_425BAC:				; CODE XREF: sub_425A9D+FFj
					; sub_425A9D+105j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_425BB9:				; CODE XREF: sub_425A9D+F5j
					; sub_425A9D+10Dj
		add	[ebp+var_4], 1
		add	[ebp+arg_0], 1

loc_425BC1:				; CODE XREF: sub_425A9D+12j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_425AB4
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+var_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		leave
		retn
sub_425A9D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425BDD	proc near		; CODE XREF: sub_408218+B5p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+arg_4]
		mov	[esp+0Ch+var_4], eax
		mov	[esp+0Ch+var_8], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_425A9D
		leave
		retn
sub_425BDD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_425A9D
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425C24	proc near		; CODE XREF: sub_425C96+3Ep
					; sub_425D6A+1Dp ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_425C24	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425C29	proc near		; CODE XREF: sub_425C96+B5p
					; sub_425D6A+AEp ...
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_425C29	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_425C33(size_t)
sub_425C33	proc near		; CODE XREF: sub_425C50+12p
					; sub_425C96+Dp ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_425C43
		add	[ebp+arg_0], 1

loc_425C43:				; CODE XREF: sub_425C33+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_425C33	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_425C50(void *, size_t)
sub_425C50	proc near		; CODE XREF: .text:0042A404p
					; .text:0042A65Ep
					; DATA XREF: ...

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_425C69
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Memory], eax ;	size_t
		call	sub_425C33
		jmp	short locret_425C7B
; ---------------------------------------------------------------------------

loc_425C69:				; CODE XREF: sub_425C50+Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc

locret_425C7B:				; CODE XREF: sub_425C50+17j
		leave
		retn
sub_425C50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_425C7D(void *)
sub_425C7D	proc near		; CODE XREF: sub_425D6A+81p
					; sub_4266CF+29p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_425C94
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_425C94:				; CODE XREF: sub_425C7D+Aj
		leave
		retn
sub_425C7D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425C96	proc near		; CODE XREF: sub_4272AD+105p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0Ch ;	size_t
		call	sub_425C33
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_425CBD
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_425D65
; ---------------------------------------------------------------------------

loc_425CBD:				; CODE XREF: sub_425C96+19j
		cmp	[ebp+arg_4], 0
		jnz	short loc_425CF7
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_425CDB
		mov	eax, ds:dword_449348
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_425CF7
; ---------------------------------------------------------------------------

loc_425CDB:				; CODE XREF: sub_425C96+34j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_449348
		call	pth_mutex_acquire

loc_425CF7:				; CODE XREF: sub_425C96+2Bj
					; sub_425C96+43j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	edx, ds:dword_449344
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], offset dword_449344
		mov	eax, ds:dword_449344
		test	eax, eax
		jz	short loc_425D2C
		mov	eax, ds:dword_449344
		mov	edx, [ebp+var_10]
		add	edx, 4
		mov	[eax+8], edx

loc_425D2C:				; CODE XREF: sub_425C96+86j
		mov	eax, [ebp+var_10]
		mov	ds:dword_449344, eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_425D5E
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_425D52
		mov	eax, ds:dword_449348
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_425D5E
; ---------------------------------------------------------------------------

loc_425D52:				; CODE XREF: sub_425C96+ABj
		mov	[esp+28h+var_28], offset dword_449348
		call	pth_mutex_release

loc_425D5E:				; CODE XREF: sub_425C96+A2j
					; sub_425C96+BAj
		mov	[ebp+var_C], 0

loc_425D65:				; CODE XREF: sub_425C96+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_425C96	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425D6A	proc near		; CODE XREF: sub_4273F2+20p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_425DAA
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_425D8E
		mov	eax, ds:dword_449348
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_425DAA
; ---------------------------------------------------------------------------

loc_425D8E:				; CODE XREF: sub_425D6A+13j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_449348
		call	pth_mutex_acquire

loc_425DAA:				; CODE XREF: sub_425D6A+Aj
					; sub_425D6A+22j
		mov	eax, ds:dword_449344
		mov	[ebp+var_C], eax
		jmp	short loc_425DFB
; ---------------------------------------------------------------------------

loc_425DB4:				; CODE XREF: sub_425D6A+95j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_425DF2
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_425DE5
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+8]
		mov	[eax+8], edx

loc_425DE5:				; CODE XREF: sub_425D6A+6Aj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_425C7D
		jmp	short loc_425E01
; ---------------------------------------------------------------------------

loc_425DF2:				; CODE XREF: sub_425D6A+52j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_425DFB:				; CODE XREF: sub_425D6A+48j
		cmp	[ebp+var_C], 0
		jnz	short loc_425DB4

loc_425E01:				; CODE XREF: sub_425D6A+86j
		cmp	[ebp+arg_4], 0
		jnz	short locret_425E2B
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_425E1F
		mov	eax, ds:dword_449348
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short locret_425E2B
; ---------------------------------------------------------------------------

loc_425E1F:				; CODE XREF: sub_425D6A+A4j
		mov	[esp+28h+var_28], offset dword_449348
		call	pth_mutex_release

locret_425E2B:				; CODE XREF: sub_425D6A+9Bj
					; sub_425D6A+B3j
		leave
		retn
sub_425D6A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425E2D	proc near		; CODE XREF: sub_4296A3+9Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_425E52
		mov	eax, ds:dword_449348
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_425E6E
; ---------------------------------------------------------------------------

loc_425E52:				; CODE XREF: sub_425E2D+14j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_449348
		call	pth_mutex_acquire

loc_425E6E:				; CODE XREF: sub_425E2D+23j
		mov	eax, ds:dword_449344
		mov	[ebp+var_C], eax
		jmp	short loc_425E91
; ---------------------------------------------------------------------------

loc_425E78:				; CODE XREF: sub_425E2D+68j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+arg_0]
		call	eax
		or	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_425E91:				; CODE XREF: sub_425E2D+49j
		cmp	[ebp+var_C], 0
		jnz	short loc_425E78
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_425EAF
		mov	eax, ds:dword_449348
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_425EBB
; ---------------------------------------------------------------------------

loc_425EAF:				; CODE XREF: sub_425E2D+71j
		mov	[esp+28h+var_28], offset dword_449348
		call	pth_mutex_release

loc_425EBB:				; CODE XREF: sub_425E2D+80j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_425E2D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425EC0	proc near		; CODE XREF: sub_42676C+4Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_425EEA
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_read
		jmp	short locret_425F39
; ---------------------------------------------------------------------------

loc_425EEA:				; CODE XREF: sub_425EC0+Dj
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	pth_read
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_425F36
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_425F36
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_read
		mov	[ebp+var_C], eax

loc_425F36:				; CODE XREF: sub_425EC0+4Aj
					; sub_425EC0+58j
		mov	eax, [ebp+var_C]

locret_425F39:				; CODE XREF: sub_425EC0+28j
		leave
		retn
sub_425EC0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425F3B	proc near		; CODE XREF: sub_4267D7+49p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_425F65
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_write
		jmp	short locret_425FB4
; ---------------------------------------------------------------------------

loc_425F65:				; CODE XREF: sub_425F3B+Dj
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	pth_write
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_425FB1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_425FB1
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_write
		mov	[ebp+var_C], eax

loc_425FB1:				; CODE XREF: sub_425F3B+4Aj
					; sub_425F3B+58j
		mov	eax, [ebp+var_C]

locret_425FB4:				; CODE XREF: sub_425F3B+28j
		leave
		retn
sub_425F3B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_425FB6()
sub_425FB6	proc near		; DATA XREF: sub_425FED:loc_426049o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_4296A3
		leave
		retn
sub_425FB6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	pth_kill
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_425FE8
		mov	ds:dword_449340, 1

loc_425FE8:				; CODE XREF: .text:00425FDCj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425FED	proc near		; CODE XREF: sub_4284CF+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_44935C
		test	eax, eax
		jnz	short loc_426055
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_426011
		mov	ds:dword_44935C, 1
		jmp	short loc_426049
; ---------------------------------------------------------------------------

loc_426011:				; CODE XREF: sub_425FED+16j
		call	pth_init
		test	eax, eax
		jnz	short loc_42602F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_42602F
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42605A
; ---------------------------------------------------------------------------

loc_42602F:				; CODE XREF: sub_425FED+2Bj
					; sub_425FED+39j
		mov	[esp+18h+var_18], offset dword_449348
		call	pth_mutex_init
		test	eax, eax
		jz	short loc_426049
		mov	ds:dword_44935C, 1

loc_426049:				; CODE XREF: sub_425FED+22j
					; sub_425FED+50j
		mov	[esp+18h+var_18], offset sub_425FB6 ; _onexit_t
		call	sub_43A630

loc_426055:				; CODE XREF: sub_425FED+Dj
		mov	eax, 0

locret_42605A:				; CODE XREF: sub_425FED+40j
		leave
		retn
sub_425FED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42605C	proc near		; CODE XREF: sub_427E25+69p
					; sub_4285F8+81p ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_42608B
		cmp	[ebp+arg_8], 0
		jnz	short loc_426074
		cmp	[ebp+arg_C], 0
		jz	short loc_42608B

loc_426074:				; CODE XREF: sub_42605C+10j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_426144
; ---------------------------------------------------------------------------

loc_42608B:				; CODE XREF: sub_42605C+Aj
					; sub_42605C+16j
		mov	[esp+28h+var_28], 28h ;	size_t
		call	sub_425C33
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4260AC
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_426141
; ---------------------------------------------------------------------------

loc_4260AC:				; CODE XREF: sub_42605C+42j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_20]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_24]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_10]
		mov	[eax+18h], edx
		cmp	[ebp+arg_14], 0
		setnz	dl
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+1Ch], dl
		cmp	[ebp+arg_18], 0
		jz	short loc_426111
		mov	eax, [ebp+arg_18]
		jmp	short loc_426116
; ---------------------------------------------------------------------------

loc_426111:				; CODE XREF: sub_42605C+AEj
		mov	eax, offset sub_425C50

loc_426116:				; CODE XREF: sub_42605C+B3j
		mov	edx, [ebp+var_10]
		mov	[edx+20h], eax
		cmp	[ebp+arg_1C], 0
		jz	short loc_426127
		mov	eax, [ebp+arg_1C]
		jmp	short loc_42612C
; ---------------------------------------------------------------------------

loc_426127:				; CODE XREF: sub_42605C+C4j
		mov	eax, offset sub_425C7D

loc_42612C:				; CODE XREF: sub_42605C+C9j
		mov	edx, [ebp+var_10]
		mov	[edx+24h], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_426141:				; CODE XREF: sub_42605C+4Bj
		mov	eax, [ebp+var_C]

locret_426144:				; CODE XREF: sub_42605C+2Aj
		leave
		retn
sub_42605C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_426146(int, void *, size_t)
sub_426146	proc near		; DATA XREF: .data:off_43D860o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_42617E
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+arg_8], eax

loc_42617E:				; CODE XREF: sub_426146+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_4261BB
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx

loc_4261BB:				; CODE XREF: sub_426146+3Cj
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		leave
		retn
sub_426146	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4261C6(int, void *, size_t)
sub_4261C6	proc near		; DATA XREF: .data:off_43D864o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_4261E3
		mov	eax, 0
		jmp	loc_426444
; ---------------------------------------------------------------------------

loc_4261E3:				; CODE XREF: sub_4261C6+11j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		and	eax, 8
		test	eax, eax
		jz	short loc_4261FB
		mov	eax, [ebp+var_10]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx

loc_4261FB:				; CODE XREF: sub_4261C6+27j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_426227
		mov	[esp+48h+Size],	283h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_16 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_43BB20

loc_426227:				; CODE XREF: sub_4261C6+43j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_426258
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_426258
		mov	eax, [ebp+var_14]
		mov	[ebp+arg_8], eax

loc_426258:				; CODE XREF: sub_4261C6+82j
					; sub_4261C6+8Aj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	loc_4263DE
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_426276
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_42628D
; ---------------------------------------------------------------------------

loc_426276:				; CODE XREF: sub_4261C6+A6j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+arg_8]
		mov	ebx, ecx
		sub	ebx, edx
		mov	edx, ebx
		add	eax, edx
		mov	[ebp+var_C], eax

loc_42628D:				; CODE XREF: sub_4261C6+AEj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4262AF
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_426444
; ---------------------------------------------------------------------------

loc_4262AF:				; CODE XREF: sub_4261C6+D0j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_426310
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		add	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4262EA
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_426444
; ---------------------------------------------------------------------------

loc_4262EA:				; CODE XREF: sub_4261C6+10Bj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_C]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_C]
		imul	eax, edx
		mov	[ebp+var_C], eax

loc_426310:				; CODE XREF: sub_4261C6+F1j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_42633C
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jnb	short loc_42633C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_426444
; ---------------------------------------------------------------------------

loc_42633C:				; CODE XREF: sub_4261C6+152j
					; sub_4261C6+15Dj
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_426367
		mov	eax, 0FFFFFFFFh
		jmp	loc_426444
; ---------------------------------------------------------------------------

loc_426367:				; CODE XREF: sub_4261C6+195j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_4263A5
		mov	[esp+48h+Size],	2B6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_16 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_43BB20

loc_4263A5:				; CODE XREF: sub_4261C6+1C1j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_4263DE
		mov	[esp+48h+Size],	2B9h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_16 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aSizeNleft ; "size <= nleft"
		call	sub_43BB20

loc_4263DE:				; CODE XREF: sub_4261C6+98j
					; sub_4261C6+1FAj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		cmp	edx, eax
		jbe	short loc_42642A
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx

loc_42642A:				; CODE XREF: sub_4261C6+251j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]

loc_426444:				; CODE XREF: sub_4261C6+18j
					; sub_4261C6+E4j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_4261C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42644A	proc near		; DATA XREF: .data:off_43D868o

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, 1
		jz	short loc_426477
		cmp	eax, 2
		jz	short loc_4264A0
		test	eax, eax
		jnz	short loc_4264C9
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_4264E0
; ---------------------------------------------------------------------------

loc_426477:				; CODE XREF: sub_42644A+12j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+10h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4264E0
; ---------------------------------------------------------------------------

loc_4264A0:				; CODE XREF: sub_42644A+17j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4264E0
; ---------------------------------------------------------------------------

loc_4264C9:				; CODE XREF: sub_42644A+1Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_426665
; ---------------------------------------------------------------------------

loc_4264E0:				; CODE XREF: sub_42644A+2Bj
					; sub_42644A+54j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	loc_4265F5
		cmp	edx, [ebp+var_C]
		jl	short loc_426502
		cmp	eax, [ebp+var_10]
		jnb	loc_4265F5

loc_426502:				; CODE XREF: sub_42644A+ADj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_426527
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_426665
; ---------------------------------------------------------------------------

loc_426527:				; CODE XREF: sub_42644A+C4j
		mov	eax, [ebp+var_14]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		add	eax, edx
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_426566
		cmp	edx, [ebp+var_C]
		jl	short loc_42654F
		cmp	eax, [ebp+var_10]
		jnb	short loc_426566

loc_42654F:				; CODE XREF: sub_42644A+FEj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_426665
; ---------------------------------------------------------------------------

loc_426566:				; CODE XREF: sub_42644A+F9j
					; sub_42644A+103j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_18]
		imul	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4265B8
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_18]
		jnb	short loc_4265B8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_426665
; ---------------------------------------------------------------------------

loc_4265B8:				; CODE XREF: sub_42644A+14Aj
					; sub_42644A+155j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+Val], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4265E3
		mov	eax, 0FFFFFFFFh
		jmp	locret_426665
; ---------------------------------------------------------------------------

loc_4265E3:				; CODE XREF: sub_42644A+18Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx

loc_4265F5:				; CODE XREF: sub_42644A+A4j
					; sub_42644A+B2j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_426649
		cmp	edx, [ebp+var_C]
		jl	short loc_42660F
		cmp	eax, [ebp+var_10]
		jnb	short loc_426649

loc_42660F:				; CODE XREF: sub_42644A+1BEj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		add	eax, edx
		mov	edx, ecx
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Val], 0 ; Val
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx

loc_426649:				; CODE XREF: sub_42644A+1B9j
					; sub_42644A+1C3j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_426665:				; CODE XREF: sub_42644A+91j
					; sub_42644A+D8j ...
		leave
		retn
sub_42644A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426667	proc near		; DATA XREF: sub_428707+109o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 1
		jnz	short loc_4266B6
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	[ebp+var_C], 0
		jmp	short loc_4266CA
; ---------------------------------------------------------------------------

loc_4266B6:				; CODE XREF: sub_426667+10j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh

loc_4266CA:				; CODE XREF: sub_426667+4Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_426667	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4266CF	proc near		; CODE XREF: sub_427E25+33Fp
					; sub_4285F8+108p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_4266FD
		mov	eax, [ebp+var_C]
		mov	edx, [eax+24h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_425C7D

loc_4266FD:				; CODE XREF: sub_4266CF+10j
		mov	eax, 0
		leave
		retn
sub_4266CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426704	proc near		; CODE XREF: sub_42898B+55p
					; .text:0042AC5Ep

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_425C33
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_426728
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_426767
; ---------------------------------------------------------------------------

loc_426728:				; CODE XREF: sub_426704+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_426747
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_426747:				; CODE XREF: sub_426704+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_426767:				; CODE XREF: sub_426704+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_426704	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42676C	proc near		; DATA XREF: .data:off_43D870o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4267A0
		mov	eax, ds:dword_449340
		test	eax, eax
		jnz	short loc_426797
		mov	[esp+28h+var_28], 0
		call	pth_yield

loc_426797:				; CODE XREF: sub_42676C+1Dj
		mov	[ebp+var_C], 0
		jmp	short loc_4267D2
; ---------------------------------------------------------------------------

loc_4267A0:				; CODE XREF: sub_42676C+14j
					; sub_42676C+64j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_425EC0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_4267D2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_4267A0

loc_4267D2:				; CODE XREF: sub_42676C+32j
					; sub_42676C+56j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42676C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4267D7	proc near		; DATA XREF: .data:off_43D874o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42680A
		mov	eax, ds:dword_449340
		test	eax, eax
		jnz	short loc_426802
		mov	[esp+28h+var_28], 0
		call	pth_yield

loc_426802:				; CODE XREF: sub_4267D7+1Dj
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_42683C
; ---------------------------------------------------------------------------

loc_42680A:				; CODE XREF: sub_4267D7+14j
					; sub_4267D7+63j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_425F3B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_42683C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_42680A

loc_42683C:				; CODE XREF: sub_4267D7+31j
					; sub_4267D7+55j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4267D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426841	proc near		; DATA XREF: .data:off_43D878o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42686E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Dh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_4268CA
; ---------------------------------------------------------------------------

loc_42686E:				; CODE XREF: sub_426841+15j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx]
		mov	ebx, [ebp+arg_8]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], ecx
		call	j__lseeki64
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_14]
		mov	edx, eax
		xor	edx, 0FFFFFFFFh
		mov	eax, [ebp+var_18]
		xor	eax, 0FFFFFFFFh
		or	eax, edx
		test	eax, eax
		jnz	short loc_4268B5
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_4268CA
; ---------------------------------------------------------------------------

loc_4268B5:				; CODE XREF: sub_426841+69j
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	[ebp+var_C], 0

loc_4268CA:				; CODE XREF: sub_426841+2Bj
					; sub_426841+72j
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_426841	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4268D3	proc near		; CODE XREF: sub_4284E2+10Fp
					; sub_42898B+DAp ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_426926
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4268F8
		mov	[ebp+var_C], 0
		jmp	short loc_426919
; ---------------------------------------------------------------------------

loc_4268F8:				; CODE XREF: sub_4268D3+1Aj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_426911
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	_close
		jmp	short loc_426916
; ---------------------------------------------------------------------------

loc_426911:				; CODE XREF: sub_4268D3+2Dj
		mov	eax, 0

loc_426916:				; CODE XREF: sub_4268D3+3Cj
		mov	[ebp+var_C], eax

loc_426919:				; CODE XREF: sub_4268D3+23j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_425C7D
		jmp	short loc_42692D
; ---------------------------------------------------------------------------

loc_426926:				; CODE XREF: sub_4268D3+10j
		mov	[ebp+var_C], 0

loc_42692D:				; CODE XREF: sub_4268D3+51j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4268D3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_426932(int, FILE *, int, int)
sub_426932	proc near		; CODE XREF: sub_428AC0+67p

File		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+File],	8 ; size_t
		call	sub_425C33
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_426956
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_42699D
; ---------------------------------------------------------------------------

loc_426956:				; CODE XREF: sub_426932+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_42697D
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[esp+28h+var_24], 8000h
		mov	[esp+28h+File],	eax
		call	_setmode

loc_42697D:				; CODE XREF: sub_426932+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_42699D:				; CODE XREF: sub_426932+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_426932	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4269A2(int, void *, size_t)
sub_4269A2	proc near		; DATA XREF: .data:off_43D880o

DstBuf		= dword	ptr -28h
ElementSize	= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4269DF
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+ElementSize], 1 ; ElementSize
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_C], eax
		jmp	short loc_4269E6
; ---------------------------------------------------------------------------

loc_4269DF:				; CODE XREF: sub_4269A2+13j
		mov	[ebp+var_C], 0

loc_4269E6:				; CODE XREF: sub_4269A2+3Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_426A04
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_426A04
		mov	eax, 0FFFFFFFFh
		jmp	short locret_426A07
; ---------------------------------------------------------------------------

loc_426A04:				; CODE XREF: sub_4269A2+48j
					; sub_4269A2+59j
		mov	eax, [ebp+var_C]

locret_426A07:				; CODE XREF: sub_4269A2+60j
		leave
		retn
sub_4269A2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_426A09(int, void *, size_t)
sub_426A09	proc near		; DATA XREF: .data:off_43D884o

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_426A46
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_C], eax
		jmp	short loc_426A4C
; ---------------------------------------------------------------------------

loc_426A46:				; CODE XREF: sub_426A09+13j
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax

loc_426A4C:				; CODE XREF: sub_426A09+3Bj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jz	short loc_426A5B
		mov	eax, 0FFFFFFFFh
		jmp	short locret_426A5E
; ---------------------------------------------------------------------------

loc_426A5B:				; CODE XREF: sub_426A09+49j
		mov	eax, [ebp+var_C]

locret_426A5E:				; CODE XREF: sub_426A09+50j
		leave
		retn
sub_426A09	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426A60	proc near		; DATA XREF: .data:off_43D888o

File		= dword	ptr -28h
Offset		= dword	ptr -24h
Origin		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_426A89
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Dh
		mov	eax, 0FFFFFFFFh
		jmp	short locret_426AE8
; ---------------------------------------------------------------------------

loc_426A89:				; CODE XREF: sub_426A60+13j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Origin], ecx ;	Origin
		mov	[esp+28h+Offset], edx ;	Offset
		mov	[esp+28h+File],	eax ; File
		call	fseek
		test	eax, eax
		jz	short loc_426AB6
		mov	eax, 0FFFFFFFFh
		jmp	short locret_426AE8
; ---------------------------------------------------------------------------

loc_426AB6:				; CODE XREF: sub_426A60+4Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	ftell
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_426AD3
		mov	eax, 0FFFFFFFFh
		jmp	short locret_426AE8
; ---------------------------------------------------------------------------

loc_426AD3:				; CODE XREF: sub_426A60+6Aj
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_426AE8:				; CODE XREF: sub_426A60+27j
					; sub_426A60+54j ...
		leave
		retn
sub_426A60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426AEA	proc near		; CODE XREF: sub_428AC0+101p
					; DATA XREF: .data:off_43D88Co

File		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_426B49
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_426B35
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fflush
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_426B2B
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		jmp	short loc_426B30
; ---------------------------------------------------------------------------

loc_426B2B:				; CODE XREF: sub_426AEA+30j
		mov	eax, 0

loc_426B30:				; CODE XREF: sub_426AEA+3Fj
		mov	[ebp+var_C], eax
		jmp	short loc_426B3C
; ---------------------------------------------------------------------------

loc_426B35:				; CODE XREF: sub_426AEA+19j
		mov	[ebp+var_C], 0

loc_426B3C:				; CODE XREF: sub_426AEA+49j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+File],	eax ; void *
		call	sub_425C7D
		jmp	short loc_426B50
; ---------------------------------------------------------------------------

loc_426B49:				; CODE XREF: sub_426AEA+10j
		mov	[ebp+var_C], 0

loc_426B50:				; CODE XREF: sub_426AEA+5Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_426AEA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426B55	proc near		; CODE XREF: sub_4284E2+55p
					; .text:0042909Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_425C33
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_426B87
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_426BF4
; ---------------------------------------------------------------------------

loc_426B87:				; CODE XREF: sub_426B55+27j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_20], 180h
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_426BB3
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_426BF4
; ---------------------------------------------------------------------------

loc_426BB3:				; CODE XREF: sub_426B55+53j
		mov	eax, [ebp+arg_C]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_426BD2
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_426BD2:				; CODE XREF: sub_426B55+68j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_426BF4:				; CODE XREF: sub_426B55+30j
					; sub_426B55+5Cj
		cmp	[ebp+var_C], 0
		jz	short loc_426C05
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_425C7D

loc_426C05:				; CODE XREF: sub_426B55+A3j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_426B55	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426C0A	proc near		; CODE XREF: sub_4284E2+28p
					; sub_4285F8+28p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 72h
		jz	short loc_426C2A
		cmp	eax, 77h
		jz	short loc_426C3A
		cmp	eax, 61h
		jz	short loc_426C4A
		jmp	short loc_426C5A
; ---------------------------------------------------------------------------

loc_426C2A:				; CODE XREF: sub_426C0A+12j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_426C6E
; ---------------------------------------------------------------------------

loc_426C3A:				; CODE XREF: sub_426C0A+17j
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 300h
		jmp	short loc_426C6E
; ---------------------------------------------------------------------------

loc_426C4A:				; CODE XREF: sub_426C0A+1Cj
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 108h
		jmp	short loc_426C6E
; ---------------------------------------------------------------------------

loc_426C5A:				; CODE XREF: sub_426C0A+1Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_426CC8
; ---------------------------------------------------------------------------

loc_426C6E:				; CODE XREF: sub_426C0A+2Ej
					; sub_426C0A+3Ej ...
		add	[ebp+arg_0], 1
		jmp	short loc_426CAC
; ---------------------------------------------------------------------------

loc_426C74:				; CODE XREF: sub_426C0A+AAj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 62h
		jz	short loc_426C95
		cmp	eax, 78h
		jz	short loc_426C9E
		cmp	eax, 2Bh
		jnz	short loc_426CA7
		mov	[ebp+var_C], 2
		jmp	short loc_426CA8
; ---------------------------------------------------------------------------

loc_426C95:				; CODE XREF: sub_426C0A+76j
		or	[ebp+var_10], 8000h
		jmp	short loc_426CA8
; ---------------------------------------------------------------------------

loc_426C9E:				; CODE XREF: sub_426C0A+7Bj
		or	[ebp+var_10], 400h
		jmp	short loc_426CA8
; ---------------------------------------------------------------------------

loc_426CA7:				; CODE XREF: sub_426C0A+80j
		nop

loc_426CA8:				; CODE XREF: sub_426C0A+89j
					; sub_426C0A+92j ...
		add	[ebp+arg_0], 1

loc_426CAC:				; CODE XREF: sub_426C0A+68j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_426C74
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

locret_426CC8:				; CODE XREF: sub_426C0A+62j
		leave
		retn
sub_426C0A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426CCA	proc near		; CODE XREF: sub_427503+2Fp
					; sub_427D3B+4Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		test	eax, eax
		jnz	short loc_426CFF
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_426D5B
; ---------------------------------------------------------------------------

loc_426CFF:				; CODE XREF: sub_426CCA+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_426D4E
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_426D5B
; ---------------------------------------------------------------------------

loc_426D4E:				; CODE XREF: sub_426CCA+72j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0

loc_426D5B:				; CODE XREF: sub_426CCA+33j
					; sub_426CCA+82j
		cmp	[ebp+var_10], 0
		jz	short loc_426D79
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl
		jmp	short loc_426D95
; ---------------------------------------------------------------------------

loc_426D79:				; CODE XREF: sub_426CCA+95j
		cmp	[ebp+var_C], 0
		jnz	short loc_426D95
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl

loc_426D95:				; CODE XREF: sub_426CCA+ADj
					; sub_426CCA+B3j
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_426CCA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426DE5	proc near		; CODE XREF: sub_4271A9+7Cp
					; sub_42761A+35p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_426E26
		mov	[esp+38h+var_30], 4F3h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22_16 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+38h+var_38], offset aStreamFlags_wr ; "stream->flags.writing"
		call	sub_43BB20

loc_426E26:				; CODE XREF: sub_426DE5+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_426F51
		cmp	[ebp+var_18], 0
		jnz	short loc_426E46
		mov	[ebp+var_C], 28h
		jmp	loc_426F58
; ---------------------------------------------------------------------------

loc_426E46:				; CODE XREF: sub_426DE5+53j
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	short loc_426EB2
; ---------------------------------------------------------------------------

loc_426E56:				; CODE XREF: sub_426DE5+DEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		sub	ecx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_426EA0
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_426EA6
; ---------------------------------------------------------------------------

loc_426EA0:				; CODE XREF: sub_426DE5+A9j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax

loc_426EA6:				; CODE XREF: sub_426DE5+B9j
		mov	eax, [ebp+var_10]
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_426EC7

loc_426EB2:				; CODE XREF: sub_426DE5+6Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_14]
		test	eax, eax
		jle	short loc_426EC8
		cmp	[ebp+var_C], 0
		jz	short loc_426E56
		jmp	short loc_426EC8
; ---------------------------------------------------------------------------

loc_426EC7:				; CODE XREF: sub_426DE5+CBj
		nop

loc_426EC8:				; CODE XREF: sub_426DE5+D8j
					; sub_426DE5+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_14]
		jnz	short loc_426F58
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		jmp	short loc_426F58
; ---------------------------------------------------------------------------

loc_426F51:				; CODE XREF: sub_426DE5+49j
		mov	[ebp+var_C], 0

loc_426F58:				; CODE XREF: sub_426DE5+5Cj
					; sub_426DE5+FDj ...
		cmp	[ebp+var_C], 0
		jz	short loc_426F74
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_426F74:				; CODE XREF: sub_426DE5+177j
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_426DE5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426F7E	proc near		; CODE XREF: sub_42780D+116p
					; sub_4282F3+33p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_426FAE
		mov	[esp+18h+var_10], 536h ; int
		mov	[esp+18h+var_14], offset a____Gnupg22_16 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+18h+var_18], offset aStreamFlags__0 ; "!stream->flags.writing"
		call	sub_43BB20

loc_426FAE:				; CODE XREF: sub_426F7E+12j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		leave
		retn
sub_426F7E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426FCE	proc near		; CODE XREF: sub_4272AD+F3p
					; .text:004290F2p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+214h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+218h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+228h], 0
		mov	dword ptr [eax+22Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_C]
		mov	[eax+230h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_10]
		mov	[eax+234h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_14]
		mov	[eax+238h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_18]
		mov	[eax+240h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+244h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+248h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFEFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+254h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFDh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_1C]
		and	eax, 1
		test	al, al
		jnz	short loc_42718B
		mov	eax, [ebp+arg_1C]
		and	eax, 2
		test	eax, eax
		jz	short loc_42719A

loc_42718B:				; CODE XREF: sub_426FCE+1B1j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl
		jmp	short loc_4271A7
; ---------------------------------------------------------------------------

loc_42719A:				; CODE XREF: sub_426FCE+1BBj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_4271A7:				; CODE XREF: sub_426FCE+1CAj
		pop	ebp
		retn
sub_426FCE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4271A9	proc near		; CODE XREF: sub_4272AD+130p
					; sub_4273F2+2Bp ...

File		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		test	eax, eax
		jz	short loc_4271FB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_4271FB:				; CODE XREF: sub_4271A9+14j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+240h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42723F
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax
		call	sub_426DE5
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42723F
		cmp	[ebp+var_18], 0
		jz	short loc_42723F
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_42723F:				; CODE XREF: sub_4271A9+74j
					; sub_4271A9+88j ...
		cmp	[ebp+var_14], 0
		jz	short loc_42726E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+File],	eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42726E
		cmp	[ebp+var_18], 0
		jz	short loc_42726E
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_42726E:				; CODE XREF: sub_4271A9+9Aj
					; sub_4271A9+B7j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+File],	eax ; void *
		call	sub_425C7D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4271A9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4272AD	proc near		; CODE XREF: sub_427E25+C8p
					; sub_4284E2+B9p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[esp+38h+var_38], 28h ;	size_t
		call	sub_425C33
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4272E2
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_4273CB
; ---------------------------------------------------------------------------

loc_4272E2:				; CODE XREF: sub_4272AD+27j
		mov	[esp+38h+var_38], 260h ; size_t
		call	sub_425C33
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_427303
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_4273CB
; ---------------------------------------------------------------------------

loc_427303:				; CODE XREF: sub_4272AD+48j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 200h
		mov	eax, [ebp+var_14]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 10h
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+24h], edx
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_427356
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_425C29
		jmp	short loc_427369
; ---------------------------------------------------------------------------

loc_427356:				; CODE XREF: sub_4272AD+91j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_38], eax
		call	pth_mutex_init

loc_427369:				; CODE XREF: sub_4272AD+A7j
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_426FCE
		mov	eax, [ebp+arg_20]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_425C96
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4273CA
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4273CB
; ---------------------------------------------------------------------------

loc_4273CA:				; CODE XREF: sub_4272AD+111j
		nop

loc_4273CB:				; CODE XREF: sub_4272AD+30j
					; sub_4272AD+51j ...
		cmp	[ebp+var_C], 0
		jz	short loc_4273ED
		cmp	[ebp+var_10], 0
		jz	short loc_4273ED
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_4271A9
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_425C7D

loc_4273ED:				; CODE XREF: sub_4272AD+122j
					; sub_4272AD+128j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4272AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4273F2(void *, int)
sub_4273F2	proc near		; CODE XREF: sub_427E25+32Bp
					; .text:00429122p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_42743E
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_425D6A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4271A9
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_425C7D
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_425C7D

loc_42743E:				; CODE XREF: sub_4273F2+11j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4273F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427443	proc near		; CODE XREF: sub_42761A+DFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_4274B6
; ---------------------------------------------------------------------------

loc_42746A:				; CODE XREF: sub_427443+79j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_4274AA
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_4274C1
; ---------------------------------------------------------------------------

loc_4274AA:				; CODE XREF: sub_427443+5Cj
		cmp	[ebp+var_18], 0
		jz	short loc_4274C0
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_4274B6:				; CODE XREF: sub_427443+25j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_42746A
		jmp	short loc_4274C1
; ---------------------------------------------------------------------------

loc_4274C0:				; CODE XREF: sub_427443+6Bj
		nop

loc_4274C1:				; CODE XREF: sub_427443+65j
					; sub_427443+7Bj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_427443	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427503	proc near		; CODE XREF: sub_4275EC+21p
					; sub_42761A+141p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_4275CA
; ---------------------------------------------------------------------------

loc_42751C:				; CODE XREF: sub_427503+D3j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_42754E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_426CCA
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42754E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_4275DE

loc_42754E:				; CODE XREF: sub_427503+27j
					; sub_427503+3Bj
		cmp	[ebp+var_14], 0
		jnz	short loc_4275CA
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_427586
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_427586:				; CODE XREF: sub_427503+7Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_4275CA:				; CODE XREF: sub_427503+14j
					; sub_427503+4Fj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_4275DF
		cmp	[ebp+var_14], 0
		jz	loc_42751C
		jmp	short loc_4275DF
; ---------------------------------------------------------------------------

loc_4275DE:				; CODE XREF: sub_427503+45j
		nop

loc_4275DF:				; CODE XREF: sub_427503+CDj
					; sub_427503+D9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_427503	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4275EC	proc near		; CODE XREF: sub_42761A+110p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_427503
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4275EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42761A	proc near		; CODE XREF: sub_429AAC+22p
					; sub_429D9A+6Dp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4276A1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_426DE5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_427765
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl
		jmp	short loc_4276A1
; ---------------------------------------------------------------------------

loc_427670:				; CODE XREF: sub_42761A+97j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		sub	eax, 1
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		mov	[edx], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		add	[ebp+var_C], 1

loc_4276A1:				; CODE XREF: sub_42761A+2Dj
					; sub_42761A+54j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jz	short loc_4276B3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_427670

loc_4276B3:				; CODE XREF: sub_42761A+8Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_4276D2
		cmp	eax, 40h
		jz	short loc_427703
		test	eax, eax
		jz	short loc_427734
		jmp	loc_427766
; ---------------------------------------------------------------------------

loc_4276D2:				; CODE XREF: sub_42761A+A8j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_427443
		mov	[ebp+var_10], eax
		jmp	short loc_427766
; ---------------------------------------------------------------------------

loc_427703:				; CODE XREF: sub_42761A+ADj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4275EC
		mov	[ebp+var_10], eax
		jmp	short loc_427766
; ---------------------------------------------------------------------------

loc_427734:				; CODE XREF: sub_42761A+B1j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_427503
		mov	[ebp+var_10], eax
		jmp	short loc_427766
; ---------------------------------------------------------------------------

loc_427765:				; CODE XREF: sub_42761A+41j
		nop

loc_427766:				; CODE XREF: sub_42761A+B3j
					; sub_42761A+E7j ...
		cmp	[ebp+arg_C], 0
		jz	short loc_427779
		mov	eax, [ebp+var_18]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_427779:				; CODE XREF: sub_42761A+150j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42761A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42777E(int, void *, size_t, int)
sub_42777E	proc near		; CODE XREF: sub_429CE6+6Ap

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4277A7
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_8], eax

loc_4277A7:				; CODE XREF: sub_42777E+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_4277FC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		jmp	short loc_4277FD
; ---------------------------------------------------------------------------

loc_4277FC:				; CODE XREF: sub_42777E+2Dj
		nop

loc_4277FD:				; CODE XREF: sub_42777E+7Cj
		cmp	[ebp+arg_C], 0
		jz	short locret_42780B
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[eax], edx

locret_42780B:				; CODE XREF: sub_42777E+83j
		leave
		retn
sub_42777E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42780D	proc near		; CODE XREF: sub_427BFB+58p
					; sub_427E25+270p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_427850
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	loc_42796D
; ---------------------------------------------------------------------------

loc_427850:				; CODE XREF: sub_42780D+28j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_427883
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_426DE5
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_42796C
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_427883:				; CODE XREF: sub_42780D+4Fj
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		cmp	[ebp+arg_C], 1
		jnz	short loc_4278E2
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+8]
		mov	ebx, 0
		mov	esi, eax
		mov	edi, edx
		sub	esi, ecx
		sbb	edi, ebx
		mov	ecx, esi
		mov	ebx, edi
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	ebx, 0
		sub	eax, ecx
		sbb	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx

loc_4278E2:				; CODE XREF: sub_42780D+86j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_50], edx
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+var_20]
		call	eax
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	short loc_427916
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	short loc_42796D
; ---------------------------------------------------------------------------

loc_427916:				; CODE XREF: sub_42780D+FEj
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_426F7E
		cmp	[ebp+arg_10], 0
		jz	short loc_42793C
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_10]
		mov	[ecx], eax
		mov	[ecx+4], edx

loc_42793C:				; CODE XREF: sub_42780D+11Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ecx+228h], eax
		mov	[ecx+22Ch], edx
		jmp	short loc_42796D
; ---------------------------------------------------------------------------

loc_42796C:				; CODE XREF: sub_42780D+63j
		nop

loc_42796D:				; CODE XREF: sub_42780D+3Ej
					; sub_42780D+107j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_427989
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_427989:				; CODE XREF: sub_42780D+164j
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_42780D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427994	proc near		; CODE XREF: sub_427B35+79p
					; sub_427BFB+B6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_4279C3
		cmp	[ebp+var_14], 0
		jnz	short loc_4279C3
		mov	[ebp+var_10], 28h
		jmp	loc_427A59
; ---------------------------------------------------------------------------

loc_4279C3:				; CODE XREF: sub_427994+1Bj
					; sub_427994+21j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_427A19
; ---------------------------------------------------------------------------

loc_4279D3:				; CODE XREF: sub_427994+8Bj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_427A13
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_427A21
; ---------------------------------------------------------------------------

loc_427A13:				; CODE XREF: sub_427994+74j
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_427A19:				; CODE XREF: sub_427994+3Dj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_4279D3

loc_427A21:				; CODE XREF: sub_427994+7Dj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_427A59:				; CODE XREF: sub_427994+2Aj
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_427994	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427A63	proc near		; CODE XREF: sub_427B35+ACp
					; sub_427BFB+100p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_427B16
; ---------------------------------------------------------------------------

loc_427A7C:				; CODE XREF: sub_427A63+BFj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_427A9A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_426DE5
		mov	[ebp+var_14], eax

loc_427A9A:				; CODE XREF: sub_427A63+27j
		cmp	[ebp+var_14], 0
		jnz	short loc_427B16
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_427AD2
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_427AD2:				; CODE XREF: sub_427A63+67j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_427B16:				; CODE XREF: sub_427A63+14j
					; sub_427A63+3Bj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_427B28
		cmp	[ebp+var_14], 0
		jz	loc_427A7C

loc_427B28:				; CODE XREF: sub_427A63+B9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_427A63	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427B35	proc near		; CODE XREF: sub_427BFB+DBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0Ah
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_43333D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_427BB6
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_426DE5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_427BB6
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_427994
		mov	[ebp+var_C], eax

loc_427BB6:				; CODE XREF: sub_427B35+3Cj
					; sub_427B35+50j
		cmp	[ebp+var_C], 0
		jnz	short loc_427BE9
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		add	eax, [ebp+arg_4]
		lea	edx, [ebp+var_18]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_427A63
		mov	[ebp+var_C], eax

loc_427BE9:				; CODE XREF: sub_427B35+85j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		leave
		retn
sub_427B35	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427BFB	proc near		; CODE XREF: sub_42819E+2Ep
					; .text:00428888p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_427C7A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		test	eax, eax
		jz	short loc_427C7A
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 1
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_42780D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_427C7A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 1Dh
		jnz	loc_427D05
		mov	[ebp+var_C], 0

loc_427C7A:				; CODE XREF: sub_427BFB+20j
					; sub_427BFB+30j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_427C96
		cmp	eax, 40h
		jz	short loc_427CBB
		test	eax, eax
		jz	short loc_427CE0
		jmp	short loc_427D06
; ---------------------------------------------------------------------------

loc_427C96:				; CODE XREF: sub_427BFB+8Ej
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_427994
		mov	[ebp+var_C], eax
		jmp	short loc_427D06
; ---------------------------------------------------------------------------

loc_427CBB:				; CODE XREF: sub_427BFB+93j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_427B35
		mov	[ebp+var_C], eax
		jmp	short loc_427D06
; ---------------------------------------------------------------------------

loc_427CE0:				; CODE XREF: sub_427BFB+97j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_427A63
		mov	[ebp+var_C], eax
		jmp	short loc_427D06
; ---------------------------------------------------------------------------

loc_427D05:				; CODE XREF: sub_427BFB+72j
		nop

loc_427D06:				; CODE XREF: sub_427BFB+99j
					; sub_427BFB+BEj ...
		cmp	[ebp+arg_C], 0
		jz	short loc_427D14
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_427D14:				; CODE XREF: sub_427BFB+10Fj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_427D36
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_427D36
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl

loc_427D36:				; CODE XREF: sub_427BFB+11Ej
					; sub_427BFB+12Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_427BFB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427D3B	proc near		; CODE XREF: sub_427E25+10Ep

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_427D70
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_426DE5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_427DCE
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_427D70:				; CODE XREF: sub_427D3B+12j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_427D94
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_426CCA
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_427DD1

loc_427D94:				; CODE XREF: sub_427D3B+43j
		cmp	[ebp+arg_4], 0
		jz	short loc_427DAC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_427DAC:				; CODE XREF: sub_427D3B+5Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_427DC5
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_427DC5:				; CODE XREF: sub_427D3B+75j
		mov	[ebp+var_C], 0
		jmp	short loc_427DD2
; ---------------------------------------------------------------------------

loc_427DCE:				; CODE XREF: sub_427D3B+26j
		nop
		jmp	short loc_427DD2
; ---------------------------------------------------------------------------

loc_427DD1:				; CODE XREF: sub_427D3B+57j
		nop

loc_427DD2:				; CODE XREF: sub_427D3B+91j
					; sub_427D3B+94j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_427D3B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427DD7	proc near		; CODE XREF: sub_427E25+1BBp
					; sub_427E25+207p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jbe	short loc_427E08
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_427E20
; ---------------------------------------------------------------------------

loc_427E08:				; CODE XREF: sub_427DD7+19j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	[ebp+var_C], 0

loc_427E20:				; CODE XREF: sub_427DD7+2Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_427DD7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427E25	proc near		; CODE XREF: .text:0042A392p

Buf		= dword	ptr -68h
Val		= dword	ptr -64h
MaxCount	= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_14], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_44], 0
		mov	[esp+68h+var_48], 2
		mov	[esp+68h+var_4C], offset sub_425C7D
		mov	[esp+68h+var_50], offset sub_425C50
		mov	[esp+68h+var_54], 1
		mov	[esp+68h+var_58], 200h
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+Buf], eax
		call	sub_42605C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_42812E
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_48], 0
		mov	[esp+68h+var_4C], 2
		mov	edx, off_43D860
		mov	[esp+68h+var_5C], edx
		mov	edx, off_43D864
		mov	[esp+68h+var_58], edx
		mov	edx, off_43D868
		mov	[esp+68h+var_54], edx
		mov	edx, off_43D86C
		mov	[esp+68h+var_50], edx
		mov	[esp+68h+MaxCount], 0FFFFFFFFh
		mov	[esp+68h+Val], eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf], eax
		call	sub_4272AD
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_428131
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_427F0F
; ---------------------------------------------------------------------------

loc_427F0E:				; CODE XREF: sub_427E25+210j
		nop

loc_427F0F:				; CODE XREF: sub_427E25+E7j
		cmp	[ebp+arg_4], 0
		jz	short loc_427F1F
		cmp	[ebp+var_C], 1
		jz	loc_42803D

loc_427F1F:				; CODE XREF: sub_427E25+EEj
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+MaxCount], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_427D3B
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_42803E
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	loc_42803E
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jnb	short loc_427F66
		mov	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_2C], eax

loc_427F66:				; CODE XREF: sub_427E25+136j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	[esp+68h+MaxCount], edx	; MaxCount
		mov	[esp+68h+Val], 0Ah ; Val
		mov	[esp+68h+Buf], eax ; Buf
		call	memchr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_427FE7
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_429E4F
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_428031
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_427DD7
		jmp	short loc_42803E
; ---------------------------------------------------------------------------

loc_427FE7:				; CODE XREF: sub_427E25+162j
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_429E4F
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_428031
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_427DD7

loc_428031:				; CODE XREF: sub_427E25+1A0j
					; sub_427E25+1ECj
		cmp	[ebp+var_18], 0
		jz	loc_427F0E
		jmp	short loc_42803E
; ---------------------------------------------------------------------------

loc_42803D:				; CODE XREF: sub_427E25+F4j
		nop

loc_42803E:				; CODE XREF: sub_427E25+11Aj
					; sub_427E25+125j ...
		cmp	[ebp+var_18], 0
		jnz	loc_428134
		cmp	[ebp+arg_4], 1
		jbe	short loc_42806F
		cmp	[ebp+var_10], 0
		jnz	short loc_42806F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl
		jmp	loc_42813B
; ---------------------------------------------------------------------------

loc_42806F:				; CODE XREF: sub_427E25+227j
					; sub_427E25+22Dj
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Buf], eax
		call	sub_42780D
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_428137
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4280D0
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+Buf], eax ; size_t
		call	sub_425C33
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4280D8
		mov	[ebp+var_18], 0FFFFFFFFh
		jmp	short loc_42813B
; ---------------------------------------------------------------------------

loc_4280D0:				; CODE XREF: sub_427E25+289j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_4280D8:				; CODE XREF: sub_427E25+2A0j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	ecx, [ebp+var_10]
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_429D9A
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_42813A
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42811E
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_42811E:				; CODE XREF: sub_427E25+2EFj
		cmp	[ebp+arg_C], 0
		jz	short loc_42813B
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_42813B
; ---------------------------------------------------------------------------

loc_42812E:				; CODE XREF: sub_427E25+75j
		nop
		jmp	short loc_42813B
; ---------------------------------------------------------------------------

loc_428131:				; CODE XREF: sub_427E25+D4j
		nop
		jmp	short loc_42813B
; ---------------------------------------------------------------------------

loc_428134:				; CODE XREF: sub_427E25+21Dj
		nop
		jmp	short loc_42813B
; ---------------------------------------------------------------------------

loc_428137:				; CODE XREF: sub_427E25+27Cj
		nop
		jmp	short loc_42813B
; ---------------------------------------------------------------------------

loc_42813A:				; CODE XREF: sub_427E25+2DBj
		nop

loc_42813B:				; CODE XREF: sub_427E25+245j
					; sub_427E25+2A9j ...
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_428157
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Val], 0 ; int
		mov	[esp+68h+Buf], eax ; void *
		call	sub_4273F2
		jmp	short loc_428169
; ---------------------------------------------------------------------------

loc_428157:				; CODE XREF: sub_427E25+31Bj
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_428169
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Buf], eax
		call	sub_4266CF

loc_428169:				; CODE XREF: sub_427E25+330j
					; sub_427E25+337j
		cmp	[ebp+var_18], 0
		jz	short loc_428199
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_428183
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Buf], eax ; void *
		call	sub_425C7D

loc_428183:				; CODE XREF: sub_427E25+351j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_428199:				; CODE XREF: sub_427E25+348j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_427E25	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42819E	proc near		; DATA XREF: sub_4281F6+2Bo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_427BFB
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+24h]
		mov	ecx, [edx+258h]
		mov	edx, [ebp+var_14]
		add	edx, ecx
		mov	[eax+258h], edx
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42819E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4281F6	proc near		; CODE XREF: .text:0042A7EEp
					; .text:0042A851p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], offset sub_42819E
		call	sub_4239EB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42823D
		mov	eax, 0FFFFFFFFh
		jmp	short locret_428249
; ---------------------------------------------------------------------------

loc_42823D:				; CODE XREF: sub_4281F6+3Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+258h]

locret_428249:				; CODE XREF: sub_4281F6+45j
		leave
		retn
sub_4281F6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42824B	proc near		; CODE XREF: sub_4282F3+4Ep
					; .text:004288FEp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	short loc_428278
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_4], 0
		setnz	dl
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_428278:				; CODE XREF: sub_42824B+7j
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	short loc_4282A3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_8], 0
		setnz	dl
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_4282A3:				; CODE XREF: sub_42824B+31j
		pop	ebp
		retn
sub_42824B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4282A5	proc near		; CODE XREF: sub_42945E+1Cp
					; sub_42950E+1Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_4282D0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax
		jmp	short loc_4282EE
; ---------------------------------------------------------------------------

loc_4282D0:				; CODE XREF: sub_4282A5+11j
		cmp	[ebp+arg_8], 0
		jz	short loc_4282EE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax

loc_4282EE:				; CODE XREF: sub_4282A5+29j
					; sub_4282A5+2Fj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4282A5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4282F3(int, int, int,	size_t)
sub_4282F3	proc near		; CODE XREF: .text:00428F95p
					; sub_42ACFF+8Fp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_428320
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_426DE5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42832B
		jmp	loc_428413
; ---------------------------------------------------------------------------

loc_428320:				; CODE XREF: sub_4282F3+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_426F7E

loc_42832B:				; CODE XREF: sub_4282F3+26j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42824B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 1
		test	al, al
		jz	short loc_428386
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_425C7D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

loc_428386:				; CODE XREF: sub_4282F3+65j
		cmp	[ebp+arg_8], 4
		jnz	short loc_428398
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		jmp	short loc_4283FD
; ---------------------------------------------------------------------------

loc_428398:				; CODE XREF: sub_4282F3+97j
		cmp	[ebp+arg_4], 0
		jz	short loc_4283A6
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_4283D0
; ---------------------------------------------------------------------------

loc_4283A6:				; CODE XREF: sub_4282F3+A9j
		cmp	[ebp+arg_C], 0
		jnz	short loc_4283B3
		mov	[ebp+arg_C], 200h

loc_4283B3:				; CODE XREF: sub_4282F3+B7j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_425C33
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4283D0
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_428413
; ---------------------------------------------------------------------------

loc_4283D0:				; CODE XREF: sub_4282F3+B1j
					; sub_4282F3+D2j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		cmp	[ebp+arg_4], 0
		jnz	short loc_4283FD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 1
		mov	[eax+250h], dl

loc_4283FD:				; CODE XREF: sub_4282F3+A3j
					; sub_4282F3+F2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+244h], edx
		mov	[ebp+var_C], 0

loc_428413:				; CODE XREF: sub_4282F3+28j
					; sub_4282F3+DBj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4282F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_428418	proc near		; CODE XREF: sub_4298BC+4Ep
					; .text:004299A5p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jl	short loc_428470
		cmp	edx, [ebp+var_C]
		jg	short loc_428460
		cmp	eax, [ebp+var_10]
		jbe	short loc_428470

loc_428460:				; CODE XREF: sub_428418+41j
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_428481
; ---------------------------------------------------------------------------

loc_428470:				; CODE XREF: sub_428418+3Cj
					; sub_428418+46j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		sub	[ebp+var_10], eax
		sbb	[ebp+var_C], edx

loc_428481:				; CODE XREF: sub_428418+56j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_428418	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42848D	proc near		; CODE XREF: .text:0042AEECp
					; .text:0042AF82p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		jz	short loc_4284A7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+218h]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_4284A7:				; CODE XREF: sub_42848D+7j
		cmp	[ebp+arg_4], 0
		jz	short loc_4284BC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+218h], edx

loc_4284BC:				; CODE XREF: sub_42848D+1Ej
		pop	ebp
		retn
sub_42848D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4284BE	proc near		; CODE XREF: sub_4292DF+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+248h]
		pop	ebp
		retn
sub_4284BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4284CF	proc near		; CODE XREF: sub_41DED4+17p

var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_425FED
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4284CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4284E2(char *, int)
sub_4284E2	proc near		; CODE XREF: sub_40990D+35p
					; sub_409A11+C4p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_426C0A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_4285D2
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_50], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_426B55
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_4285D5
		mov	[ebp+var_C], 1
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_38], 0
		mov	[esp+58h+var_3C], ecx
		mov	ecx, off_43D870
		mov	[esp+58h+var_4C], ecx
		mov	ecx, off_43D874
		mov	[esp+58h+var_48], ecx
		mov	ecx, off_43D878
		mov	[esp+58h+var_44], ecx
		mov	ecx, off_43D87C
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_4272AD
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4285D8
		mov	eax, [ebp+var_18]
		test	eax, eax
		jz	short loc_4285D9
		cmp	[ebp+arg_0], 0
		jz	short loc_4285D9
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_50], 1 ; int
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_54], edx ;	char *
		mov	[esp+58h+var_58], eax ;	int
		call	sub_42AFBE
		jmp	short loc_4285D9
; ---------------------------------------------------------------------------

loc_4285D2:				; CODE XREF: sub_4284E2+34j
		nop
		jmp	short loc_4285D9
; ---------------------------------------------------------------------------

loc_4285D5:				; CODE XREF: sub_4284E2+61j
		nop
		jmp	short loc_4285D9
; ---------------------------------------------------------------------------

loc_4285D8:				; CODE XREF: sub_4284E2+C5j
		nop

loc_4285D9:				; CODE XREF: sub_4284E2+CCj
					; sub_4284E2+D2j ...
		cmp	[ebp+var_10], 0
		jz	short loc_4285F3
		cmp	[ebp+var_C], 0
		jz	short loc_4285F3
		mov	edx, off_43D87C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_4268D3

loc_4285F3:				; CODE XREF: sub_4284E2+FBj
					; sub_4284E2+101j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_4284E2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4285F8	proc near		; CODE XREF: sub_40B6EE+65p
					; sub_40BAC0+45p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+58h+var_58], eax
		call	sub_426C0A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_4286E4
		mov	edx, [ebp+var_14]
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_34], 0
		mov	[esp+58h+var_38], edx
		mov	edx, [ebp+arg_14]
		mov	[esp+58h+var_3C], edx
		mov	edx, [ebp+arg_10]
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_44], edx
		mov	[esp+58h+var_48], 200h
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+58h+var_50], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	sub_42605C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4286E7
		mov	[ebp+var_C], 1
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_38], 0
		mov	[esp+58h+var_3C], edx
		mov	edx, off_43D860
		mov	[esp+58h+var_4C], edx
		mov	edx, off_43D864
		mov	[esp+58h+var_48], edx
		mov	edx, off_43D868
		mov	[esp+58h+var_44], edx
		mov	edx, off_43D86C
		mov	[esp+58h+var_40], edx
		mov	[esp+58h+var_50], 0FFFFFFFFh
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_4272AD
		mov	[ebp+var_10], eax
		jmp	short loc_4286E8
; ---------------------------------------------------------------------------

loc_4286E4:				; CODE XREF: sub_4285F8+34j
		nop
		jmp	short loc_4286E8
; ---------------------------------------------------------------------------

loc_4286E7:				; CODE XREF: sub_4285F8+8Dj
		nop

loc_4286E8:				; CODE XREF: sub_4285F8+EAj
					; sub_4285F8+EDj
		cmp	[ebp+var_10], 0
		jz	short loc_428702
		cmp	[ebp+var_C], 0
		jz	short loc_428702
		mov	edx, off_43D86C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_4266CF

loc_428702:				; CODE XREF: sub_4285F8+F4j
					; sub_4285F8+FAj
		mov	eax, [ebp+var_18]
		leave
		retn
sub_4285F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_428707	proc near		; CODE XREF: sub_40AA39+70p
					; sub_40E084+1DEp ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_426C0A
		test	eax, eax
		jz	short loc_42873B
		mov	eax, 0
		jmp	locret_42881D
; ---------------------------------------------------------------------------

loc_42873B:				; CODE XREF: sub_428707+28j
		mov	eax, [ebp+var_C]
		or	eax, 2
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_14]
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_24], ecx
		mov	[esp+48h+var_28], edx
		mov	[esp+48h+var_2C], offset sub_425C7D
		mov	[esp+48h+var_30], offset sub_425C50
		mov	[esp+48h+var_34], 1
		mov	[esp+48h+var_38], 200h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	[esp+48h+var_48], eax
		call	sub_42605C
		test	eax, eax
		jz	short loc_4287A0
		mov	eax, 0
		jmp	short locret_42881D
; ---------------------------------------------------------------------------

loc_4287A0:				; CODE XREF: sub_428707+90j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_28], 0
		mov	[esp+48h+var_2C], edx
		mov	edx, off_43D860
		mov	[esp+48h+var_3C], edx
		mov	edx, off_43D864
		mov	[esp+48h+var_38], edx
		mov	edx, off_43D868
		mov	[esp+48h+var_34], edx
		mov	edx, off_43D86C
		mov	[esp+48h+var_30], edx
		mov	[esp+48h+var_40], 0FFFFFFFFh
		mov	[esp+48h+var_44], eax
		lea	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_4272AD
		test	eax, eax
		jz	short loc_428803
		mov	edx, off_43D86C
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	edx ; sub_4266CF

loc_428803:				; CODE XREF: sub_428707+ECj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_42881A
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], offset sub_426667

loc_42881A:				; CODE XREF: sub_428707+101j
		mov	eax, [ebp+var_10]

locret_42881D:				; CODE XREF: sub_428707+2Fj
					; sub_428707+97j
		leave
		retn
sub_428707	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_428839
		mov	eax, [ebp+8]
		cmp	eax, [ebp+14h]
		jnb	short loc_428839
		mov	eax, [ebp+14h]
		mov	[ebp+8], eax

loc_428839:				; CODE XREF: .text:00428829j
					; .text:00428831j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_428707
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	loc_428903
		cmp	dword ptr [ebp+10h], 0
		jz	loc_428903
		cmp	dword ptr [ebp+14h], 0
		jz	loc_428903
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_427BFB
		test	eax, eax
		jz	short loc_4288BD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4291C4
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-10h]
		mov	[eax], edx
		jmp	short loc_428903
; ---------------------------------------------------------------------------

loc_4288BD:				; CODE XREF: .text:0042888Fj
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_42780D
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_42824B

loc_428903:				; CODE XREF: .text:00428852j
					; .text:0042885Cj ...
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-10h], 0
		lea	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_426C0A
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_428985
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+18h]
		mov	[esp+14h], eax
		mov	eax, [ebp+1Ch]
		mov	[esp+18h], eax
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_4272AD
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jmp	short loc_428986
; ---------------------------------------------------------------------------

loc_428985:				; CODE XREF: .text:00428935j
		nop

loc_428986:				; CODE XREF: .text:00428983j
		mov	eax, [ebp-14h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42898B	proc near		; CODE XREF: sub_428A6C+23p
					; .text:00428AB9p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_426C0A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_428A49
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_426704
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_428A4C
		mov	[ebp+var_C], 1
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], edx
		mov	edx, off_43D870
		mov	[esp+58h+var_4C], edx
		mov	edx, off_43D874
		mov	[esp+58h+var_48], edx
		mov	edx, off_43D878
		mov	[esp+58h+var_44], edx
		mov	edx, off_43D87C
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_4272AD
		mov	[ebp+var_10], eax
		jmp	short loc_428A4D
; ---------------------------------------------------------------------------

loc_428A49:				; CODE XREF: sub_42898B+34j
		nop
		jmp	short loc_428A4D
; ---------------------------------------------------------------------------

loc_428A4C:				; CODE XREF: sub_42898B+61j
		nop

loc_428A4D:				; CODE XREF: sub_42898B+BCj
					; sub_42898B+BFj
		cmp	[ebp+var_10], 0
		jz	short loc_428A67
		cmp	[ebp+var_C], 0
		jz	short loc_428A67
		mov	edx, off_43D87C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_4268D3

loc_428A67:				; CODE XREF: sub_42898B+C6j
					; sub_42898B+CCj
		mov	eax, [ebp+var_18]
		leave
		retn
sub_42898B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_428A6C	proc near		; CODE XREF: sub_40DF58+34p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	[esp+18h+var_10], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_42898B
		leave
		retn
sub_428A6C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42898B
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_428AC0(FILE *, int, int, int)
sub_428AC0	proc near		; CODE XREF: .text:00428BEFp
					; .text:00428C19p ...

File		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+File],	eax
		call	sub_426C0A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_428BA5
		cmp	[ebp+arg_0], 0
		jz	short loc_428B0C
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	fflush

loc_428B0C:				; CODE XREF: sub_428AC0+3Fj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx ;	int
		mov	[esp+58h+var_50], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax ;	FILE *
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax ; int
		call	sub_426932
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_428BA8
		mov	[ebp+var_C], 1
		mov	ebx, [ebp+var_14]
		cmp	[ebp+arg_0], 0
		jz	short loc_428B52
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	_fileno
		jmp	short loc_428B57
; ---------------------------------------------------------------------------

loc_428B52:				; CODE XREF: sub_428AC0+83j
		mov	eax, 0FFFFFFFFh

loc_428B57:				; CODE XREF: sub_428AC0+90j
		mov	edx, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], ebx
		mov	ecx, off_43D880
		mov	[esp+58h+var_4C], ecx
		mov	ecx, off_43D884
		mov	[esp+58h+var_48], ecx
		mov	ecx, off_43D888
		mov	[esp+58h+var_44], ecx
		mov	ecx, off_43D88C
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], edx
		lea	eax, [ebp+var_18]
		mov	[esp+58h+File],	eax
		call	sub_4272AD
		mov	[ebp+var_10], eax
		jmp	short loc_428BA9
; ---------------------------------------------------------------------------

loc_428BA5:				; CODE XREF: sub_428AC0+35j
		nop
		jmp	short loc_428BA9
; ---------------------------------------------------------------------------

loc_428BA8:				; CODE XREF: sub_428AC0+73j
		nop

loc_428BA9:				; CODE XREF: sub_428AC0+E3j
					; sub_428AC0+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_428BC3
		cmp	[ebp+var_C], 0
		jz	short loc_428BC3
		mov	edx, off_43D88C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax
		call	edx ; sub_426AEA

loc_428BC3:				; CODE XREF: sub_428AC0+EDj
					; sub_428AC0+F3j
		mov	eax, [ebp+var_18]
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_428AC0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_428AC0
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_428AC0
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_428C3E
		mov	eax, ds:dword_449348
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_428C5A
; ---------------------------------------------------------------------------

loc_428C3E:				; CODE XREF: .text:00428C2Dj
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], offset	dword_449348
		call	pth_mutex_acquire

loc_428C5A:				; CODE XREF: .text:00428C3Cj
		cmp	dword ptr [ebp+8], 0
		js	short loc_428C8D
		cmp	dword ptr [ebp+8], 2
		jg	short loc_428C8D
		mov	eax, [ebp+8]
		add	eax, offset byte_449358
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_428C8D
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	ds:dword_44934C[eax*4],	edx
		mov	eax, [ebp+8]
		add	eax, offset byte_449358
		mov	byte ptr [eax],	1

loc_428C8D:				; CODE XREF: .text:00428C5Ej
					; .text:00428C64j ...
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_428CA5
		mov	eax, ds:dword_449348
		mov	[esp], eax
		call	sub_425C29
		jmp	short locret_428CB1
; ---------------------------------------------------------------------------

loc_428CA5:				; CODE XREF: .text:00428C94j
		mov	dword ptr [esp], offset	dword_449348
		call	pth_mutex_release

locret_428CB1:				; CODE XREF: .text:00428CA3j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	ecx, [ebp+8]
		mov	edx, 55555556h
		mov	eax, ecx
		imul	edx
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp+8], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_428CFA
		mov	eax, ds:dword_449348
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_428D16
; ---------------------------------------------------------------------------

loc_428CFA:				; CODE XREF: .text:00428CE9j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], offset	dword_449348
		call	pth_mutex_acquire

loc_428D16:				; CODE XREF: .text:00428CF8j
		mov	eax, ds:dword_449344
		mov	[ebp-0Ch], eax
		jmp	short loc_428D66
; ---------------------------------------------------------------------------

loc_428D20:				; CODE XREF: .text:00428D6Aj
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 2
		test	al, al
		jz	short loc_428D5D
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		shr	al, 2
		and	eax, 3
		movzx	eax, al
		cmp	eax, [ebp+8]
		jnz	short loc_428D5D
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		jmp	short loc_428D6C
; ---------------------------------------------------------------------------

loc_428D5D:				; CODE XREF: .text:00428D34j
					; .text:00428D51j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+4]
		mov	[ebp-0Ch], eax

loc_428D66:				; CODE XREF: .text:00428D1Ej
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_428D20

loc_428D6C:				; CODE XREF: .text:00428D5Bj
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_428FD0
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_428DB1
		movzx	eax, ds:byte_449358
		test	al, al
		jz	short loc_428DB1
		mov	eax, ds:dword_44934C
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR_4 ; "r"
		mov	[esp], eax
		call	sub_42898B
		mov	[ebp-10h], eax
		jmp	short loc_428E1F
; ---------------------------------------------------------------------------

loc_428DB1:				; CODE XREF: .text:00428D7Aj
					; .text:00428D85j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_428DEC
		movzx	eax, ds:byte_449359
		test	al, al
		jz	short loc_428DEC
		mov	eax, ds:dword_449350
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA_2 ; "a"
		mov	[esp], eax
		call	sub_42898B
		mov	[ebp-10h], eax
		jmp	short loc_428E1F
; ---------------------------------------------------------------------------

loc_428DEC:				; CODE XREF: .text:00428DB5j
					; .text:00428DC0j
		movzx	eax, ds:byte_44935A
		test	al, al
		jz	short loc_428E1F
		mov	eax, ds:dword_449354
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA_2 ; "a"
		mov	[esp], eax
		call	sub_42898B
		mov	[ebp-10h], eax

loc_428E1F:				; CODE XREF: .text:00428DAFj
					; .text:00428DEAj ...
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_428EB7
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_428E59
		mov	eax, ds:_iob
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR_4 ; "r"
		mov	[esp], eax
		call	sub_428AC0
		mov	[ebp-10h], eax
		jmp	short loc_428EB7
; ---------------------------------------------------------------------------

loc_428E59:				; CODE XREF: .text:00428E2Dj
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_428E8C
		mov	eax, ds:_iob
		add	eax, 20h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA_2 ; "a"
		mov	[esp], eax
		call	sub_428AC0
		mov	[ebp-10h], eax
		jmp	short loc_428EB7
; ---------------------------------------------------------------------------

loc_428E8C:				; CODE XREF: .text:00428E5Dj
		mov	eax, ds:_iob
		add	eax, 40h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA_2 ; "a"
		mov	[esp], eax
		call	sub_428AC0
		mov	[ebp-10h], eax

loc_428EB7:				; CODE XREF: .text:00428E23j
					; .text:00428E57j ...
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_428F33
		cmp	dword ptr [ebp+8], 0
		jz	short loc_428ECA
		mov	eax, offset aA_2 ; "a"
		jmp	short loc_428ECF
; ---------------------------------------------------------------------------

loc_428ECA:				; CODE XREF: .text:00428EC1j
		mov	eax, offset aR_4 ; "r"

loc_428ECF:				; CODE XREF: .text:00428EC8j
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_428AC0
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_428F33
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	edx, offset aFatalErrorCrea ; "fatal: error creating a dummy estream f"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], ecx
		call	fprintf
		call	abort
; ---------------------------------------------------------------------------

loc_428F33:				; CODE XREF: .text:00428EBBj
					; .text:00428EF6j
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 2
		mov	[eax+250h], dl
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		mov	edx, [ebp+8]
		and	edx, 3
		and	edx, 3
		lea	ecx, ds:0[edx*4]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		or	edx, ecx
		mov	[eax+250h], dl
		cmp	dword ptr [ebp+8], 2
		jnz	short loc_428F9A
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 40h
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4282F3

loc_428F9A:				; CODE XREF: .text:00428F75j
		cmp	dword ptr [ebp+8], 0
		jz	short loc_428FB4
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_428FAD
		mov	eax, offset aStdout_0 ;	"[stdout]"
		jmp	short loc_428FB2
; ---------------------------------------------------------------------------

loc_428FAD:				; CODE XREF: .text:00428FA4j
		mov	eax, offset aStderr ; "[stderr]"

loc_428FB2:				; CODE XREF: .text:00428FABj
		jmp	short loc_428FB9
; ---------------------------------------------------------------------------

loc_428FB4:				; CODE XREF: .text:00428F9Ej
		mov	eax, offset aStdin_0 ; "[stdin]"

loc_428FB9:				; CODE XREF: .text:loc_428FB2j
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42AFBE

loc_428FD0:				; CODE XREF: .text:00428D70j
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_428FE8
		mov	eax, ds:dword_449348
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_428FF4
; ---------------------------------------------------------------------------

loc_428FE8:				; CODE XREF: .text:00428FD7j
		mov	dword ptr [esp], offset	dword_449348
		call	pth_mutex_release

loc_428FF4:				; CODE XREF: .text:00428FE6j
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	dword ptr [ebp+8], 0
		jz	loc_42918D
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-10h], 0
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429036
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_429059
; ---------------------------------------------------------------------------

loc_429036:				; CODE XREF: .text:0042901Ej
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_429059:				; CODE XREF: .text:00429034j
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4271A9
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_426C0A
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4290F9
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_426B55
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4290FC
		mov	dword ptr [ebp-10h], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-18h]
		mov	[esp+1Ch], ecx
		mov	ecx, off_43D870
		mov	[esp+0Ch], ecx
		mov	ecx, off_43D874
		mov	[esp+10h], ecx
		mov	ecx, off_43D878
		mov	[esp+14h], ecx
		mov	ecx, off_43D87C
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_426FCE
		jmp	short loc_4290FD
; ---------------------------------------------------------------------------

loc_4290F9:				; CODE XREF: .text:0042907Dj
		nop
		jmp	short loc_4290FD
; ---------------------------------------------------------------------------

loc_4290FC:				; CODE XREF: .text:004290A6j
		nop

loc_4290FD:				; CODE XREF: .text:004290F7j
					; .text:004290FAj
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_429133
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_429114
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_4268D3

loc_429114:				; CODE XREF: .text:00429107j
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4273F2
		mov	dword ptr [ebp+10h], 0
		jmp	loc_4291BF
; ---------------------------------------------------------------------------

loc_429133:				; CODE XREF: .text:00429101j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_429159
		cmp	dword ptr [ebp+8], 0
		jz	short loc_429159
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_42AFBE

loc_429159:				; CODE XREF: .text:00429137j
					; .text:0042913Dj
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429178
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_4291BF
; ---------------------------------------------------------------------------

loc_429178:				; CODE XREF: .text:00429160j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		jmp	short loc_4291BF
; ---------------------------------------------------------------------------

loc_42918D:				; CODE XREF: .text:00429003j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4271A9
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4273F2
		mov	dword ptr [ebp+10h], 0

loc_4291BF:				; CODE XREF: .text:0042912Ej
					; .text:00429176j ...
		mov	eax, [ebp+10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4291C4(void *)
sub_4291C4	proc near		; CODE XREF: sub_40990D+E9p
					; sub_409A11+126p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_4273F2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4291C4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4291E5(void *, int, int)
sub_4291E5	proc near		; CODE XREF: sub_40AA39+23Bp
					; sub_40E084+2E2p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jz	loc_42929C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+23Ch]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		cmp	[ebp+var_10], 0
		jnz	short loc_42922C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_4292B8
; ---------------------------------------------------------------------------

loc_42922C:				; CODE XREF: sub_4291E5+2Cj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42925B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_426DE5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4292B4
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_42925B:				; CODE XREF: sub_4291E5+53j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], 1
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_10]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4292B7
		cmp	[ebp+arg_8], 0
		jz	short loc_42929C
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_42929C:				; CODE XREF: sub_4291E5+Aj
					; sub_4291E5+ADj
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_4273F2
		mov	[ebp+var_C], eax
		jmp	short loc_4292B8
; ---------------------------------------------------------------------------

loc_4292B4:				; CODE XREF: sub_4291E5+67j
		nop
		jmp	short loc_4292B8
; ---------------------------------------------------------------------------

loc_4292B7:				; CODE XREF: sub_4291E5+A7j
		nop

loc_4292B8:				; CODE XREF: sub_4291E5+42j
					; sub_4291E5+CDj ...
		cmp	[ebp+var_C], 0
		jz	short loc_4292DA
		cmp	[ebp+arg_4], 0
		jz	short loc_4292DA
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_425C7D
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_4292DA:				; CODE XREF: sub_4291E5+D7j
					; sub_4291E5+DDj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4291E5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4292DF	proc near		; CODE XREF: sub_4293D1+4Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	[esp+4+var_4], eax
		call	sub_4284BE
		leave
		retn
sub_4292DF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429317
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short locret_42933A
; ---------------------------------------------------------------------------

loc_429317:				; CODE XREF: .text:004292FFj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

locret_42933A:				; CODE XREF: .text:00429315j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429361
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short locret_429395
; ---------------------------------------------------------------------------

loc_429361:				; CODE XREF: .text:00429349j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	pth_mutex_acquire
		cmp	eax, 1
		jnz	short loc_429390
		mov	eax, 0
		jmp	short locret_429395
; ---------------------------------------------------------------------------

loc_429390:				; CODE XREF: .text:00429387j
		mov	eax, 0FFFFFFFFh

locret_429395:				; CODE XREF: .text:0042935Fj
					; .text:0042938Ej
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4293BC
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short locret_4293CF
; ---------------------------------------------------------------------------

loc_4293BC:				; CODE XREF: .text:004293A4j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_4293CF:				; CODE XREF: .text:004293BAj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4293D1	proc near		; CODE XREF: sub_40990D+56p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4293F6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_429419
; ---------------------------------------------------------------------------

loc_4293F6:				; CODE XREF: sub_4293D1+Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_429419:				; CODE XREF: sub_4293D1+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4292DF
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429446
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_429459
; ---------------------------------------------------------------------------

loc_429446:				; CODE XREF: sub_4293D1+5Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release

loc_429459:				; CODE XREF: sub_4293D1+73j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4293D1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42945E	proc near		; CODE XREF: sub_429481+4Ep

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 1
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4282A5
		leave
		retn
sub_42945E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429481	proc near		; CODE XREF: sub_40D9FB+38Dp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4294A6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_4294C9
; ---------------------------------------------------------------------------

loc_4294A6:				; CODE XREF: sub_429481+Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_4294C9:				; CODE XREF: sub_429481+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42945E
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4294F6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_429509
; ---------------------------------------------------------------------------

loc_4294F6:				; CODE XREF: sub_429481+5Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release

loc_429509:				; CODE XREF: sub_429481+73j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_429481	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42950E	proc near		; CODE XREF: sub_429531+4Ep
					; sub_42B219+3E5p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4282A5
		leave
		retn
sub_42950E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429531	proc near		; CODE XREF: sub_409380+20p
					; sub_40AA39+213p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429556
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_429579
; ---------------------------------------------------------------------------

loc_429556:				; CODE XREF: sub_429531+Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_429579:				; CODE XREF: sub_429531+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42950E
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4295A6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_4295B9
; ---------------------------------------------------------------------------

loc_4295A6:				; CODE XREF: sub_429531+5Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release

loc_4295B9:				; CODE XREF: sub_429531+73j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_429531	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4295BE	proc near		; CODE XREF: .text:0042962Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_42824B
		leave
		retn
sub_4295BE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429606
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_429629
; ---------------------------------------------------------------------------

loc_429606:				; CODE XREF: .text:004295EEj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_429629:				; CODE XREF: .text:00429604j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4295BE
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429653
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short locret_429666
; ---------------------------------------------------------------------------

loc_429653:				; CODE XREF: .text:0042963Bj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_429666:				; CODE XREF: .text:00429651j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429668	proc near		; CODE XREF: sub_4296A3+58p
					; DATA XREF: sub_4296A3:loc_429737o

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42968C
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_426DE5
		mov	[ebp+var_C], eax
		jmp	short loc_42969E
; ---------------------------------------------------------------------------

loc_42968C:				; CODE XREF: sub_429668+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_426F7E
		mov	[ebp+var_C], 0

loc_42969E:				; CODE XREF: sub_429668+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_429668	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4296A3	proc near		; CODE XREF: sub_40D9FB+36Cp
					; sub_425FB6+Dp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	loc_429737
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4296D2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_4296F5
; ---------------------------------------------------------------------------

loc_4296D2:				; CODE XREF: sub_4296A3+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_4296F5:				; CODE XREF: sub_4296A3+2Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429668
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429722
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_429746
; ---------------------------------------------------------------------------

loc_429722:				; CODE XREF: sub_4296A3+67j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_429746
; ---------------------------------------------------------------------------

loc_429737:				; CODE XREF: sub_4296A3+Aj
		mov	[esp+28h+var_28], offset sub_429668
		call	sub_425E2D
		mov	[ebp+var_C], eax

loc_429746:				; CODE XREF: sub_4296A3+7Dj
					; sub_4296A3+92j
		cmp	[ebp+var_C], 0
		jz	short loc_429753
		mov	eax, 0FFFFFFFFh
		jmp	short locret_429758
; ---------------------------------------------------------------------------

loc_429753:				; CODE XREF: sub_4296A3+A7j
		mov	eax, 0

locret_429758:				; CODE XREF: sub_4296A3+AEj
		leave
		retn
sub_4296A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42975A	proc near		; CODE XREF: sub_40B6EE+198p
					; sub_40BAC0+95p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42977F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_425C24
		jmp	short loc_4297A2
; ---------------------------------------------------------------------------

loc_42977F:				; CODE XREF: sub_42975A+Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		call	pth_mutex_acquire

loc_4297A2:				; CODE XREF: sub_42975A+23j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		sar	edx, 1Fh
		mov	[esp+38h+var_28], 0
		mov	ecx, [ebp+arg_8]
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_30], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_42780D
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4297EE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_425C29
		jmp	short loc_429801
; ---------------------------------------------------------------------------

loc_4297EE:				; CODE XREF: sub_42975A+7Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_38], eax
		call	pth_mutex_release

loc_429801:				; CODE XREF: sub_42975A+92j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42975A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429837
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42985A
; ---------------------------------------------------------------------------

loc_429837:				; CODE XREF: .text:0042981Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42985A:				; CODE XREF: .text:00429835j
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42780D
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4298A4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_4298B7
; ---------------------------------------------------------------------------

loc_4298A4:				; CODE XREF: .text:0042988Cj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4298B7:				; CODE XREF: .text:004298A2j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4298BC	proc near		; CODE XREF: sub_40B6EE+167p
					; sub_40C7DB+440p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4298E1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_429904
; ---------------------------------------------------------------------------

loc_4298E1:				; CODE XREF: sub_4298BC+Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_429904:				; CODE XREF: sub_4298BC+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_428418
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429931
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_429944
; ---------------------------------------------------------------------------

loc_429931:				; CODE XREF: sub_4298BC+5Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release

loc_429944:				; CODE XREF: sub_4298BC+73j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4298BC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42997C
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42999F
; ---------------------------------------------------------------------------

loc_42997C:				; CODE XREF: .text:00429964j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42999F:				; CODE XREF: .text:0042997Aj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_428418
		mov	[ebp-10h], eax
		mov	[ebp-0Ch], edx
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_4299CF
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_4299E2
; ---------------------------------------------------------------------------

loc_4299CF:				; CODE XREF: .text:004299B7j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4299E2:				; CODE XREF: .text:004299CDj
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4299EA	proc near		; CODE XREF: sub_40D9FB+1B4p
					; sub_40E084+1C9p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429A0F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_429A32
; ---------------------------------------------------------------------------

loc_429A0F:				; CODE XREF: sub_4299EA+Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_429A32:				; CODE XREF: sub_4299EA+23j
		mov	[esp+28h+var_18], 0
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42780D
		mov	[esp+28h+var_20], 0FFFFFFFFh
		mov	[esp+28h+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42824B
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429A97
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short locret_429AAA
; ---------------------------------------------------------------------------

loc_429A97:				; CODE XREF: sub_4299EA+95j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release

locret_429AAA:				; CODE XREF: sub_4299EA+ABj
		leave
		retn
sub_4299EA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429AAC	proc near		; CODE XREF: sub_429B36+95p
					; .text:0042A162p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_D]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42761A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_429AEC
		mov	eax, [ebp+var_14]
		test	eax, eax
		jz	short loc_429AEC
		movzx	eax, [ebp+var_D]
		movzx	eax, al
		jmp	short locret_429AF1
; ---------------------------------------------------------------------------

loc_429AEC:				; CODE XREF: sub_429AAC+2Ej
					; sub_429AAC+35j
		mov	eax, 0FFFFFFFFh

locret_429AF1:				; CODE XREF: sub_429AAC+3Ej
		leave
		retn
sub_429AAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429AF3	proc near		; CODE XREF: sub_429C0A+9Dp
					; sub_42B219+ECp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_D], al
		lea	eax, [ebp+var_D]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_427BFB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_429B2F
		mov	eax, [ebp+arg_0]
		jmp	short locret_429B34
; ---------------------------------------------------------------------------

loc_429B2F:				; CODE XREF: sub_429AF3+35j
		mov	eax, 0FFFFFFFFh

locret_429B34:				; CODE XREF: sub_429AF3+3Aj
		leave
		retn
sub_429AF3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429B36	proc near		; CODE XREF: sub_409380+Cp
					; sub_40DF58+CBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429B5B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_429B7E
; ---------------------------------------------------------------------------

loc_429B5B:				; CODE XREF: sub_429B36+Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_429B7E:				; CODE XREF: sub_429B36+23j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_429BC5
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_429BC5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_429BC5
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+0Ch], ecx
		jmp	short loc_429BD0
; ---------------------------------------------------------------------------

loc_429BC5:				; CODE XREF: sub_429B36+54j
					; sub_429B36+64j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429AAC

loc_429BD0:				; CODE XREF: sub_429B36+8Dj
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429BF2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_429C05
; ---------------------------------------------------------------------------

loc_429BF2:				; CODE XREF: sub_429B36+A4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release

loc_429C05:				; CODE XREF: sub_429B36+BAj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_429B36	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429C0A	proc near		; CODE XREF: sub_4093E0+1Ap
					; sub_40AA39+208p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429C2F
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_429C52
; ---------------------------------------------------------------------------

loc_429C2F:				; CODE XREF: sub_429C0A+Dj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_429C52:				; CODE XREF: sub_429C0A+23j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_429C9A
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_429C9A
		cmp	[ebp+arg_0], 0Ah
		jz	short loc_429C9A
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		mov	ecx, [ebp+arg_0]
		mov	[eax], cl
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_4]
		mov	[edx+0Ch], ecx
		jmp	short loc_429CAC
; ---------------------------------------------------------------------------

loc_429C9A:				; CODE XREF: sub_429C0A+54j
					; sub_429C0A+64j ...
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429AF3

loc_429CAC:				; CODE XREF: sub_429C0A+8Ej
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429CCE
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_429CE1
; ---------------------------------------------------------------------------

loc_429CCE:				; CODE XREF: sub_429C0A+ACj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release

loc_429CE1:				; CODE XREF: sub_429C0A+C2j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_429C0A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429CE6	proc near		; CODE XREF: sub_40DF58+E6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_9		= byte ptr -9
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_9], al
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429D11
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_429D34
; ---------------------------------------------------------------------------

loc_429D11:				; CODE XREF: sub_429CE6+13j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_429D34:				; CODE XREF: sub_429CE6+29j
		lea	eax, [ebp+var_9]
		lea	edx, [ebp+var_10]
		mov	[esp+28h+var_1C], edx ;	int
		mov	[esp+28h+var_20], 1 ; size_t
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_42777E
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429D74
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_429D87
; ---------------------------------------------------------------------------

loc_429D74:				; CODE XREF: sub_429CE6+76j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release

loc_429D87:				; CODE XREF: sub_429CE6+8Cj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_429D93
		mov	eax, [ebp+arg_0]
		jmp	short locret_429D98
; ---------------------------------------------------------------------------

loc_429D93:				; CODE XREF: sub_429CE6+A6j
		mov	eax, 0FFFFFFFFh

locret_429D98:				; CODE XREF: sub_429CE6+ABj
		leave
		retn
sub_429CE6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429D9A	proc near		; CODE XREF: sub_40941E+22p
					; sub_40951D+21p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	loc_429E43
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429DC9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_429DEC
; ---------------------------------------------------------------------------

loc_429DC9:				; CODE XREF: sub_429D9A+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_429DEC:				; CODE XREF: sub_429D9A+2Dj
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42761A
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429E2E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_429E4A
; ---------------------------------------------------------------------------

loc_429E2E:				; CODE XREF: sub_429D9A+7Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_429E4A
; ---------------------------------------------------------------------------

loc_429E43:				; CODE XREF: sub_429D9A+Aj
		mov	[ebp+var_C], 0

loc_429E4A:				; CODE XREF: sub_429D9A+92j
					; sub_429D9A+A7j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_429D9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429E4F	proc near		; CODE XREF: sub_4094B5+44p
					; sub_40957B+22p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	loc_429EF8
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429E7E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_429EA1
; ---------------------------------------------------------------------------

loc_429E7E:				; CODE XREF: sub_429E4F+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_429EA1:				; CODE XREF: sub_429E4F+2Dj
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_427BFB
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429EE3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_429EFF
; ---------------------------------------------------------------------------

loc_429EE3:				; CODE XREF: sub_429E4F+7Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_429EFF
; ---------------------------------------------------------------------------

loc_429EF8:				; CODE XREF: sub_429E4F+Aj
		mov	[ebp+var_C], 0

loc_429EFF:				; CODE XREF: sub_429E4F+92j
					; sub_429E4F+A7j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_429E4F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jz	loc_429FC1
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429F38
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_429F5B
; ---------------------------------------------------------------------------

loc_429F38:				; CODE XREF: .text:00429F20j
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_429F5B:				; CODE XREF: .text:00429F36j
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_42761A
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_429F9E
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_429FB1
; ---------------------------------------------------------------------------

loc_429F9E:				; CODE XREF: .text:00429F86j
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_429FB1:				; CODE XREF: .text:00429F9Cj
		mov	eax, [ebp-10h]
		mov	edx, 0
		div	dword ptr [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_429FC8
; ---------------------------------------------------------------------------

loc_429FC1:				; CODE XREF: .text:00429F13j
		mov	dword ptr [ebp-0Ch], 0

loc_429FC8:				; CODE XREF: .text:00429FBFj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jz	loc_42A08A
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A001
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42A024
; ---------------------------------------------------------------------------

loc_42A001:				; CODE XREF: .text:00429FE9j
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42A024:				; CODE XREF: .text:00429FFFj
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_427BFB
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A067
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_42A07A
; ---------------------------------------------------------------------------

loc_42A067:				; CODE XREF: .text:0042A04Fj
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_42A07A:				; CODE XREF: .text:0042A065j
		mov	eax, [ebp-10h]
		mov	edx, 0
		div	dword ptr [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_42A091
; ---------------------------------------------------------------------------

loc_42A08A:				; CODE XREF: .text:00429FDCj
		mov	dword ptr [ebp-0Ch], 0

loc_42A091:				; CODE XREF: .text:0042A088j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_42A0B2
		mov	eax, 0
		jmp	locret_42A1E0
; ---------------------------------------------------------------------------

loc_42A0B2:				; CODE XREF: .text:0042A0A6j
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A0D8
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42A10F
; ---------------------------------------------------------------------------

loc_42A0D8:				; CODE XREF: .text:0042A0C0j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		jmp	short loc_42A10F
; ---------------------------------------------------------------------------

loc_42A0FD:				; CODE XREF: .text:0042A174j
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+0Ch], 1

loc_42A10F:				; CODE XREF: .text:0042A0D6j
					; .text:0042A0FBj
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_42A176
		mov	eax, [ebp+10h]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_42A15C
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+10h]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_42A15C
		mov	eax, [ebp+10h]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_42A15C
		mov	eax, [ebp+10h]
		mov	ecx, [eax]
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+10h]
		mov	[edx+0Ch], ecx
		jmp	short loc_42A167
; ---------------------------------------------------------------------------

loc_42A15C:				; CODE XREF: .text:0042A121j
					; .text:0042A131j ...
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_429AAC

loc_42A167:				; CODE XREF: .text:0042A15Aj
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_42A176
		cmp	dword ptr [ebp-10h], 0Ah
		jnz	short loc_42A0FD

loc_42A176:				; CODE XREF: .text:0042A113j
					; .text:0042A16Ej
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A195
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_42A1A8
; ---------------------------------------------------------------------------

loc_42A195:				; CODE XREF: .text:0042A17Dj
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_42A1A8:				; CODE XREF: .text:0042A193j
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_42A1BD
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_42A1BD
		mov	eax, 0
		jmp	short locret_42A1E0
; ---------------------------------------------------------------------------

loc_42A1BD:				; CODE XREF: .text:0042A1ACj
					; .text:0042A1B4j
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_42A1D7
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_42A1D7
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_42A1D7:				; CODE XREF: .text:0042A1C1j
					; .text:0042A1C7j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]

locret_42A1E0:				; CODE XREF: .text:0042A0ADj
					; .text:0042A1BBj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_427BFB
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_42A23C
		mov	eax, 0FFFFFFFFh
		jmp	short loc_42A241
; ---------------------------------------------------------------------------

loc_42A23C:				; CODE XREF: .text:0042A233j
		mov	eax, 0

loc_42A241:				; CODE XREF: .text:0042A23Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A247	proc near		; CODE XREF: sub_409A11+11Bp
					; sub_40AA39+C8p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A28F
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_425C24
		jmp	short loc_42A2B2
; ---------------------------------------------------------------------------

loc_42A28F:				; CODE XREF: sub_42A247+30j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		call	pth_mutex_acquire

loc_42A2B2:				; CODE XREF: sub_42A247+46j
		mov	[esp+38h+var_2C], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_427BFB
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A2F5
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_425C29
		jmp	short loc_42A308
; ---------------------------------------------------------------------------

loc_42A2F5:				; CODE XREF: sub_42A247+96j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_38], eax
		call	pth_mutex_release

loc_42A308:				; CODE XREF: sub_42A247+ACj
		cmp	[ebp+var_10], 0
		jz	short loc_42A315
		mov	eax, 0FFFFFFFFh
		jmp	short loc_42A31A
; ---------------------------------------------------------------------------

loc_42A315:				; CODE XREF: sub_42A247+C5j
		mov	eax, 0

loc_42A31A:				; CODE XREF: sub_42A247+CCj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_42A247	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A353
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42A376
; ---------------------------------------------------------------------------

loc_42A353:				; CODE XREF: .text:0042A33Bj
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42A376:				; CODE XREF: .text:0042A351j
		lea	eax, [ebp-14h]
		lea	edx, [ebp-18h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_427E25
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A3B9
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_42A3CC
; ---------------------------------------------------------------------------

loc_42A3B9:				; CODE XREF: .text:0042A3A1j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_42A3CC:				; CODE XREF: .text:0042A3B7j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_42A488
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_42A474
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	edx, [ebp-18h]
		add	edx, 1
		cmp	eax, edx
		jnb	short loc_42A42D
		mov	eax, [ebp-18h]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_425C50
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42A41B
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	short loc_42A42D
; ---------------------------------------------------------------------------

loc_42A41B:				; CODE XREF: .text:0042A410j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, [ebp-10h]
		jz	short loc_42A42D
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_42A42D:				; CODE XREF: .text:0042A3F0j
					; .text:0042A419j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42A467
		mov	eax, [ebp-18h]
		lea	ecx, [eax+1]
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+0Ch]
		mov	edx, [eax]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jz	short loc_42A467
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_42A467:				; CODE XREF: .text:0042A431j
					; .text:0042A45Dj
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_425C7D
		jmp	short loc_42A489
; ---------------------------------------------------------------------------

loc_42A474:				; CODE XREF: .text:0042A3DDj
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_42A489
; ---------------------------------------------------------------------------

loc_42A488:				; CODE XREF: .text:0042A3D0j
		nop

loc_42A489:				; CODE XREF: .text:0042A472j
					; .text:0042A486j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42A494
		mov	eax, [ebp-18h]
		jmp	short locret_42A497
; ---------------------------------------------------------------------------

loc_42A494:				; CODE XREF: .text:0042A48Dj
		mov	eax, [ebp-0Ch]

locret_42A497:				; CODE XREF: .text:0042A492j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_42A4C3
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		jmp	short loc_42A4C8
; ---------------------------------------------------------------------------

loc_42A4C3:				; CODE XREF: .text:0042A4BAj
		mov	eax, 0

loc_42A4C8:				; CODE XREF: .text:0042A4C1j
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42A51E
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_425C33
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42A516
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_42A50C
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_42A50C:				; CODE XREF: .text:0042A501j
		mov	eax, 0FFFFFFFFh
		jmp	locret_42A7BF
; ---------------------------------------------------------------------------

loc_42A516:				; CODE XREF: .text:0042A4F2j
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_42A51E:				; CODE XREF: .text:0042A4CFj
		cmp	dword ptr [ebp-14h], 3
		ja	short loc_42A53B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_42A7BF
; ---------------------------------------------------------------------------

loc_42A53B:				; CODE XREF: .text:0042A522j
		sub	dword ptr [ebp-14h], 3
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A55E
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42A581
; ---------------------------------------------------------------------------

loc_42A55E:				; CODE XREF: .text:0042A546j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42A581:				; CODE XREF: .text:0042A55Cj
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_42A71F
; ---------------------------------------------------------------------------

loc_42A58C:				; CODE XREF: .text:0042A778j
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_42A707
		cmp	dword ptr [ebp-20h], 0
		jz	loc_42A635
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_42A635

loc_42A5AE:				; CODE XREF: .text:0042A60Dj
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_42A60F
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_42A5FB
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_42A5FB
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_42A5FB
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_42A606
; ---------------------------------------------------------------------------

loc_42A5FB:				; CODE XREF: .text:0042A5C0j
					; .text:0042A5D0j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_429AAC

loc_42A606:				; CODE XREF: .text:0042A5F9j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_42A5AE

loc_42A60F:				; CODE XREF: .text:0042A5B2j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp+14h], 0
		jz	loc_42A780
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_42A780
; ---------------------------------------------------------------------------

loc_42A635:				; CODE XREF: .text:0042A59Cj
					; .text:0042A5A8j
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_42A649
		mov	eax, 100h
		jmp	short loc_42A64E
; ---------------------------------------------------------------------------

loc_42A649:				; CODE XREF: .text:0042A640j
		mov	eax, 400h

loc_42A64E:				; CODE XREF: .text:0042A647j
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_425C50
		mov	edx, [ebp+0Ch]
		mov	[edx], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42A6E8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-24h], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_425C7D
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_42A6A0
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_42A6A0:				; CODE XREF: .text:0042A695j
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A6BF
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_42A6D2
; ---------------------------------------------------------------------------

loc_42A6BF:				; CODE XREF: .text:0042A6A7j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_42A6D2:				; CODE XREF: .text:0042A6BDj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-24h]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_42A7BF
; ---------------------------------------------------------------------------

loc_42A6E8:				; CODE XREF: .text:0042A66Fj
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_42A707:				; CODE XREF: .text:0042A592j
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_42A783

loc_42A71F:				; CODE XREF: .text:0042A587j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_42A766
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_42A766
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_42A766
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_42A771
; ---------------------------------------------------------------------------

loc_42A766:				; CODE XREF: .text:0042A72Bj
					; .text:0042A73Bj ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_429AAC

loc_42A771:				; CODE XREF: .text:0042A764j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_42A58C
		jmp	short loc_42A784
; ---------------------------------------------------------------------------

loc_42A780:				; CODE XREF: .text:0042A621j
					; .text:0042A630j
		nop
		jmp	short loc_42A784
; ---------------------------------------------------------------------------

loc_42A783:				; CODE XREF: .text:0042A71Dj
		nop

loc_42A784:				; CODE XREF: .text:0042A77Ej
					; .text:0042A781j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A7A9
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_42A7BC
; ---------------------------------------------------------------------------

loc_42A7A9:				; CODE XREF: .text:0042A791j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_42A7BC:				; CODE XREF: .text:0042A7A7j
		mov	eax, [ebp-18h]

locret_42A7BF:				; CODE XREF: .text:0042A511j
					; .text:0042A536j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42A7C1(void *)
sub_42A7C1	proc near		; CODE XREF: sub_40E084+360p
					; sub_40E084+3C6p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	void *
		call	sub_425C7D
		leave
		retn
sub_42A7C1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4281F6
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A81A
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42A83D
; ---------------------------------------------------------------------------

loc_42A81A:				; CODE XREF: .text:0042A802j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42A83D:				; CODE XREF: .text:0042A818j
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4281F6
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A878
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_42A88B
; ---------------------------------------------------------------------------

loc_42A878:				; CODE XREF: .text:0042A860j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_42A88B:				; CODE XREF: .text:0042A876j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A890	proc near		; CODE XREF: sub_42B219+34Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4281F6
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42A890	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A8BF	proc near		; CODE XREF: sub_40AA39+15Ap
					; sub_418C2D+56Ep

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A8EC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_42A90F
; ---------------------------------------------------------------------------

loc_42A8EC:				; CODE XREF: sub_42A8BF+15j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_42A90F:				; CODE XREF: sub_42A8BF+2Bj
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4281F6
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42A94A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_42A95D
; ---------------------------------------------------------------------------

loc_42A94A:				; CODE XREF: sub_42A8BF+73j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release

loc_42A95D:				; CODE XREF: sub_42A8BF+89j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42A8BF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_42433B
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_42A999
		mov	eax, 0
		jmp	short locret_42A99C
; ---------------------------------------------------------------------------

loc_42A999:				; CODE XREF: .text:0042A990j
		mov	eax, [ebp-14h]

locret_42A99C:				; CODE XREF: .text:0042A997j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42433B
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_42A9CD
		mov	eax, 0
		jmp	short locret_42A9D0
; ---------------------------------------------------------------------------

loc_42A9CD:				; CODE XREF: .text:0042A9C4j
		mov	eax, [ebp-10h]

locret_42A9D0:				; CODE XREF: .text:0042A9CBj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A9D2	proc near		; CODE XREF: .text:0042AC28p

nBufferLength	= dword	ptr -178h
lpBuffer	= dword	ptr -174h
dwShareMode	= dword	ptr -170h
lpSecurityAttributes= dword ptr	-16Ch
dwCreationDisposition= dword ptr -168h
dwFlagsAndAttributes= dword ptr	-164h
hTemplateFile	= dword	ptr -160h
var_14C		= dword	ptr -14Ch
Buffer		= byte ptr -146h
var_2C		= dword	ptr -2Ch
hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 174h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+lpBuffer], eax ; lpBuffer
		mov	[esp+178h+nBufferLength], 105h ; nBufferLength
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_42AA42
		cmp	[ebp+var_20], 104h
		jg	short loc_42AA42
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_42AA59

loc_42AA42:				; CODE XREF: sub_42A9D2+36j
					; sub_42A9D2+3Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	loc_42AC01
; ---------------------------------------------------------------------------

loc_42AA59:				; CODE XREF: sub_42A9D2+6Ej
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Buffer]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	edx, offset a_estream ;	"_estream"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		add	[ebp+var_10], 8
		mov	[esp+178h+lpBuffer], 0 ; lpSecurityAttributes
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], eax
		mov	[ebp+var_C], 0
		jmp	loc_42ABE5
; ---------------------------------------------------------------------------

loc_42AAE0:				; CODE XREF: sub_42A9D2+217j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp+var_1C]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_42AB31
; ---------------------------------------------------------------------------

loc_42AB01:				; CODE XREF: sub_42A9D2+163j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_42AB17
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_42AB20
; ---------------------------------------------------------------------------

loc_42AB17:				; CODE XREF: sub_42A9D2+138j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 37h

loc_42AB20:				; CODE XREF: sub_42A9D2+143j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		shl	[ebp+var_14], 4
		add	[ebp+var_18], 1

loc_42AB31:				; CODE XREF: sub_42A9D2+12Dj
		cmp	[ebp+var_18], 7
		jle	short loc_42AB01
		mov	edx, offset a_tmp_0 ; ".tmp"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	[esp+178h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+178h+dwFlagsAndAttributes], 4000100h ; dwFlagsAndAttributes
		mov	[esp+178h+dwCreationDisposition], 1 ; dwCreationDisposition
		mov	[esp+178h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+178h+dwShareMode],	0 ; dwShareMode
		mov	[esp+178h+lpBuffer], 0C0000000h	; dwDesiredAccess
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_42ABD0
		mov	eax, [ebp+hObject]
		mov	[esp+178h+lpBuffer], 0
		mov	[esp+178h+nBufferLength], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0FFFFFFFFh
		jnz	short loc_42ABCB
		mov	eax, [ebp+hObject]
		mov	[esp+178h+nBufferLength], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_42AC01
; ---------------------------------------------------------------------------

loc_42ABCB:				; CODE XREF: sub_42A9D2+1E0j
		mov	eax, [ebp+var_2C]
		jmp	short loc_42AC01
; ---------------------------------------------------------------------------

loc_42ABD0:				; CODE XREF: sub_42A9D2+1C2j
		mov	[esp+178h+nBufferLength], 1 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	[ebp+var_C], 1

loc_42ABE5:				; CODE XREF: sub_42A9D2+109j
		cmp	[ebp+var_C], 9
		jle	loc_42AAE0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh

loc_42AC01:				; CODE XREF: sub_42A9D2+82j
					; sub_42A9D2+1F7j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_42A9D2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-14h], 302h
		mov	dword ptr [ebp-20h], 0
		call	sub_42A9D2
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_42AC42
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		jmp	loc_42ACC9
; ---------------------------------------------------------------------------

loc_42AC42:				; CODE XREF: .text:0042AC34j
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_426704
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42ACC8
		mov	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-20h]
		mov	dword ptr [esp+20h], 0
		mov	edx, [ebp-14h]
		mov	[esp+1Ch], edx
		mov	edx, off_43D870
		mov	[esp+0Ch], edx
		mov	edx, off_43D874
		mov	[esp+10h], edx
		mov	edx, off_43D878
		mov	[esp+14h], edx
		mov	edx, off_43D87C
		mov	[esp+18h], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_4272AD
		mov	[ebp-10h], eax
		jmp	short loc_42ACC9
; ---------------------------------------------------------------------------

loc_42ACC8:				; CODE XREF: .text:0042AC6Aj
		nop

loc_42ACC9:				; CODE XREF: .text:0042AC3Dj
					; .text:0042ACC6j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_42ACFA
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42ACE2
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_4268D3
		jmp	short loc_42ACF3
; ---------------------------------------------------------------------------

loc_42ACE2:				; CODE XREF: .text:0042ACD3j
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jz	short loc_42ACF3
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	_close

loc_42ACF3:				; CODE XREF: .text:0042ACE0j
					; .text:0042ACE6j
		mov	dword ptr [ebp-1Ch], 0

loc_42ACFA:				; CODE XREF: .text:0042ACCDj
		mov	eax, [ebp-1Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42ACFF(int, int, int,	size_t)
sub_42ACFF	proc near		; CODE XREF: sub_40D9FB+167p
					; sub_40DF58+92p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_42AD1B
		cmp	[ebp+arg_8], 40h
		jz	short loc_42AD1B
		cmp	[ebp+arg_8], 4
		jnz	loc_42ADCA

loc_42AD1B:				; CODE XREF: sub_42ACFF+Aj
					; sub_42ACFF+10j
		cmp	[ebp+arg_4], 0
		jz	short loc_42AD31
		cmp	[ebp+arg_C], 0
		jnz	short loc_42AD31
		cmp	[ebp+arg_8], 4
		jnz	loc_42ADCA

loc_42AD31:				; CODE XREF: sub_42ACFF+20j
					; sub_42ACFF+26j
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42AD50
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C24
		jmp	short loc_42AD73
; ---------------------------------------------------------------------------

loc_42AD50:				; CODE XREF: sub_42ACFF+39j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_42AD73:				; CODE XREF: sub_42ACFF+4Fj
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	size_t
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4282F3
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42ADB5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_425C29
		jmp	short loc_42ADDE
; ---------------------------------------------------------------------------

loc_42ADB5:				; CODE XREF: sub_42ACFF+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_42ADDE
; ---------------------------------------------------------------------------

loc_42ADCA:				; CODE XREF: sub_42ACFF+16j
					; sub_42ACFF+2Cj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh

loc_42ADDE:				; CODE XREF: sub_42ACFF+B4j
					; sub_42ACFF+C9j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42ACFF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42AE08
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42AE2B
; ---------------------------------------------------------------------------

loc_42AE08:				; CODE XREF: .text:0042ADF0j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42AE2B:				; CODE XREF: .text:0042AE06j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42AE38
		mov	eax, 0
		jmp	short loc_42AE3D
; ---------------------------------------------------------------------------

loc_42AE38:				; CODE XREF: .text:0042AE2Fj
		mov	eax, 4

loc_42AE3D:				; CODE XREF: .text:0042AE36j
		mov	dword ptr [esp+0Ch], 200h
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4282F3
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42AE7A
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short locret_42AE8D
; ---------------------------------------------------------------------------

loc_42AE7A:				; CODE XREF: .text:0042AE62j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_42AE8D:				; CODE XREF: .text:0042AE78j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42AEB4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42AED7
; ---------------------------------------------------------------------------

loc_42AEB4:				; CODE XREF: .text:0042AE9Cj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42AED7:				; CODE XREF: .text:0042AEB2j
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42848D
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42AF10
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short locret_42AF23
; ---------------------------------------------------------------------------

loc_42AF10:				; CODE XREF: .text:0042AEF8j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_42AF23:				; CODE XREF: .text:0042AF0Ej
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42AF4A
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42AF6D
; ---------------------------------------------------------------------------

loc_42AF4A:				; CODE XREF: .text:0042AF32j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42AF6D:				; CODE XREF: .text:0042AF48j
		lea	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42848D
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42AFA6
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_42AFB9
; ---------------------------------------------------------------------------

loc_42AFA6:				; CODE XREF: .text:0042AF8Ej
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_42AFB9:				; CODE XREF: .text:0042AFA4j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42AFBE(int, char *, int)
sub_42AFBE	proc near		; CODE XREF: sub_4284E2+E9p
					; .text:00428FCBp ...

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jz	short loc_42B00E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 20h
		test	al, al
		jnz	short loc_42B00E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+Dest],	eax ; void *
		call	sub_425C7D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0

loc_42B00E:				; CODE XREF: sub_42AFBE+16j
					; sub_42AFBE+2Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jnz	loc_42B0BA
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jz	short loc_42B035
		mov	[ebp+arg_8], 0
		jmp	short loc_42B042
; ---------------------------------------------------------------------------

loc_42B035:				; CODE XREF: sub_42AFBE+6Cj
		cmp	[ebp+arg_8], 0
		setnz	al
		movzx	eax, al
		mov	[ebp+arg_8], eax

loc_42B042:				; CODE XREF: sub_42AFBE+75j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+24h]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_8]
		add	eax, edx
		add	eax, 1
		mov	[esp+28h+Dest],	eax ; size_t
		call	sub_425C33
		mov	[ebx+220h], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_42B0BB
		cmp	[ebp+arg_8], 0
		jz	short loc_42B098
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	byte ptr [eax],	5Ch

loc_42B098:				; CODE XREF: sub_42AFBE+C9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+220h]
		mov	eax, [ebp+arg_8]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	[esp+28h+Dest],	edx ; Dest
		call	strcpy
		jmp	short loc_42B0BB
; ---------------------------------------------------------------------------

loc_42B0BA:				; CODE XREF: sub_42AFBE+5Ej
		nop

loc_42B0BB:				; CODE XREF: sub_42AFBE+C3j
					; sub_42AFBE+FAj
		add	esp, 20h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42AFBE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+0Ch], 0
		jz	locret_42B160
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42B0F1
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42B114
; ---------------------------------------------------------------------------

loc_42B0F1:				; CODE XREF: .text:0042B0D9j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42B114:				; CODE XREF: .text:0042B0EFj
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42AFBE
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42B14D
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short locret_42B160
; ---------------------------------------------------------------------------

loc_42B14D:				; CODE XREF: .text:0042B135j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_42B160:				; CODE XREF: .text:0042B0CCj
					; .text:0042B14Bj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42B187
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42B1AA
; ---------------------------------------------------------------------------

loc_42B187:				; CODE XREF: .text:0042B16Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42B1AA:				; CODE XREF: .text:0042B185j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42B1D5
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 20h
		mov	[eax+250h], dl

loc_42B1D5:				; CODE XREF: .text:0042B1BDj
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42B1F4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_42B207
; ---------------------------------------------------------------------------

loc_42B1F4:				; CODE XREF: .text:0042B1DCj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_42B207:				; CODE XREF: .text:0042B1F2j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42B214
		mov	dword ptr [ebp-0Ch], offset a?_0 ; "[?]"

loc_42B214:				; CODE XREF: .text:0042B20Bj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42B219(int, int, int,	char *,	int)
sub_42B219	proc near		; CODE XREF: sub_418C2D+50Cp
					; .text:0042B975p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42B24E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_425C24
		jmp	loc_42B5E0
; ---------------------------------------------------------------------------

loc_42B24E:				; CODE XREF: sub_42B219+1Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+Val], 0
		mov	[esp+28h+Str], eax
		call	pth_mutex_acquire
		jmp	loc_42B5E0
; ---------------------------------------------------------------------------

loc_42B276:				; CODE XREF: sub_42B219+3CBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_42B2BE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_42B2BE
		cmp	[ebp+arg_C], 0
		jz	loc_42B56F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jnz	short loc_42B2BE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_42B56F

loc_42B2BE:				; CODE XREF: sub_42B219+65j
					; sub_42B219+6Fj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B2F7
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B2F7
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	5Ch
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_42B30A
; ---------------------------------------------------------------------------

loc_42B2F7:				; CODE XREF: sub_42B219+B1j
					; sub_42B219+C1j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 5Ch
		call	sub_429AF3

loc_42B30A:				; CODE XREF: sub_42B219+DCj
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_42B36D
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B351
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B351
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	6Eh
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_42B364
; ---------------------------------------------------------------------------

loc_42B351:				; CODE XREF: sub_42B219+10Bj
					; sub_42B219+11Bj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 6Eh
		call	sub_429AF3

loc_42B364:				; CODE XREF: sub_42B219+136j
		add	[ebp+var_10], 1
		jmp	loc_42B5D4
; ---------------------------------------------------------------------------

loc_42B36D:				; CODE XREF: sub_42B219+FDj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_42B3CC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B3B0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B3B0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	72h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_42B3C3
; ---------------------------------------------------------------------------

loc_42B3B0:				; CODE XREF: sub_42B219+16Aj
					; sub_42B219+17Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 72h
		call	sub_429AF3

loc_42B3C3:				; CODE XREF: sub_42B219+195j
		add	[ebp+var_10], 1
		jmp	loc_42B5D4
; ---------------------------------------------------------------------------

loc_42B3CC:				; CODE XREF: sub_42B219+15Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_42B42B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B40F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B40F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	66h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_42B422
; ---------------------------------------------------------------------------

loc_42B40F:				; CODE XREF: sub_42B219+1C9j
					; sub_42B219+1D9j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 66h
		call	sub_429AF3

loc_42B422:				; CODE XREF: sub_42B219+1F4j
		add	[ebp+var_10], 1
		jmp	loc_42B5D4
; ---------------------------------------------------------------------------

loc_42B42B:				; CODE XREF: sub_42B219+1BBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_42B48A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B46E
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B46E
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	76h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_42B481
; ---------------------------------------------------------------------------

loc_42B46E:				; CODE XREF: sub_42B219+228j
					; sub_42B219+238j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 76h
		call	sub_429AF3

loc_42B481:				; CODE XREF: sub_42B219+253j
		add	[ebp+var_10], 1
		jmp	loc_42B5D4
; ---------------------------------------------------------------------------

loc_42B48A:				; CODE XREF: sub_42B219+21Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_42B4E9
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B4CD
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B4CD
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	62h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_42B4E0
; ---------------------------------------------------------------------------

loc_42B4CD:				; CODE XREF: sub_42B219+287j
					; sub_42B219+297j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 62h
		call	sub_429AF3

loc_42B4E0:				; CODE XREF: sub_42B219+2B2j
		add	[ebp+var_10], 1
		jmp	loc_42B5D4
; ---------------------------------------------------------------------------

loc_42B4E9:				; CODE XREF: sub_42B219+279j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42B548
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B52C
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B52C
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	30h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_42B53F
; ---------------------------------------------------------------------------

loc_42B52C:				; CODE XREF: sub_42B219+2E6j
					; sub_42B219+2F6j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 30h
		call	sub_429AF3

loc_42B53F:				; CODE XREF: sub_42B219+311j
		add	[ebp+var_10], 1
		jmp	loc_42B5D4
; ---------------------------------------------------------------------------

loc_42B548:				; CODE XREF: sub_42B219+2D8j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_42A890
		add	[ebp+var_10], 3
		jmp	short loc_42B5D4
; ---------------------------------------------------------------------------

loc_42B56F:				; CODE XREF: sub_42B219+75j
					; sub_42B219+9Fj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B5B8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B5B8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_42B5B8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_C]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_42B5D0
; ---------------------------------------------------------------------------

loc_42B5B8:				; CODE XREF: sub_42B219+362j
					; sub_42B219+372j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Val], edx
		mov	[esp+28h+Str], eax
		call	sub_429AF3

loc_42B5D0:				; CODE XREF: sub_42B219+39Dj
		add	[ebp+var_10], 1

loc_42B5D4:				; CODE XREF: sub_42B219+14Fj
					; sub_42B219+1AEj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_42B5E0:				; CODE XREF: sub_42B219+30j
					; sub_42B219+58j
		cmp	[ebp+arg_8], 0
		jnz	loc_42B276
		cmp	[ebp+arg_10], 0
		jz	short loc_42B5F8
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_42B5F8:				; CODE XREF: sub_42B219+3D5j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_42950E
		test	eax, eax
		jz	short loc_42B60E
		mov	eax, 0FFFFFFFFh
		jmp	short loc_42B613
; ---------------------------------------------------------------------------

loc_42B60E:				; CODE XREF: sub_42B219+3ECj
		mov	eax, 0

loc_42B613:				; CODE XREF: sub_42B219+3F3j
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42B635
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_425C29
		jmp	short loc_42B648
; ---------------------------------------------------------------------------

loc_42B635:				; CODE XREF: sub_42B219+404j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+Str], eax
		call	pth_mutex_release

loc_42B648:				; CODE XREF: sub_42B219+41Aj
		mov	eax, [ebp+var_14]
		leave
		retn
sub_42B219	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_42B66A
		mov	eax, 0
		jmp	locret_42B882
; ---------------------------------------------------------------------------

loc_42B66A:				; CODE XREF: .text:0042B65Ej
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42B689
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C24
		jmp	short loc_42B6AC
; ---------------------------------------------------------------------------

loc_42B689:				; CODE XREF: .text:0042B671j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_42B6AC:				; CODE XREF: .text:0042B687j
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_42B817
; ---------------------------------------------------------------------------

loc_42B6B7:				; CODE XREF: .text:0042B81Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B71E
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B71E
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_42B705
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 30h
		jmp	short loc_42B711
; ---------------------------------------------------------------------------

loc_42B705:				; CODE XREF: .text:0042B6F5j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 37h

loc_42B711:				; CODE XREF: .text:0042B703j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_42B767
; ---------------------------------------------------------------------------

loc_42B71E:				; CODE XREF: .text:0042B6C3j
					; .text:0042B6D3j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_42B746
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_42B758
; ---------------------------------------------------------------------------

loc_42B746:				; CODE XREF: .text:0042B730j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_42B758:				; CODE XREF: .text:0042B744j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_429AF3

loc_42B767:				; CODE XREF: .text:0042B71Cj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42B7CB
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_42B7CB
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_42B7B2
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 30h
		jmp	short loc_42B7BE
; ---------------------------------------------------------------------------

loc_42B7B2:				; CODE XREF: .text:0042B7A2j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 37h

loc_42B7BE:				; CODE XREF: .text:0042B7B0j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_42B80B
; ---------------------------------------------------------------------------

loc_42B7CB:				; CODE XREF: .text:0042B773j
					; .text:0042B783j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_42B7ED
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_42B7FC
; ---------------------------------------------------------------------------

loc_42B7ED:				; CODE XREF: .text:0042B7DAj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_42B7FC:				; CODE XREF: .text:0042B7EBj
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_429AF3

loc_42B80B:				; CODE XREF: .text:0042B7C9j
		add	dword ptr [ebp-10h], 2
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_42B817:				; CODE XREF: .text:0042B6B2j
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_42B6B7
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_42B82F
		mov	eax, [ebp+18h]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_42B82F:				; CODE XREF: .text:0042B825j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42950E
		test	eax, eax
		jz	short loc_42B845
		mov	eax, 0FFFFFFFFh
		jmp	short loc_42B84A
; ---------------------------------------------------------------------------

loc_42B845:				; CODE XREF: .text:0042B83Cj
		mov	eax, 0

loc_42B84A:				; CODE XREF: .text:0042B843j
		mov	[ebp-14h], eax
		mov	eax, ds:dword_449340
		test	eax, eax
		jz	short loc_42B86C
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_425C29
		jmp	short loc_42B87F
; ---------------------------------------------------------------------------

loc_42B86C:				; CODE XREF: .text:0042B854j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_42B87F:				; CODE XREF: .text:0042B86Aj
		mov	eax, [ebp-14h]

locret_42B882:				; CODE XREF: .text:0042B665j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_42B8AD
; ---------------------------------------------------------------------------

loc_42B89A:				; CODE XREF: .text:0042B8B3j
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_42B8B7
		add	dword ptr [ebp-0Ch], 1

loc_42B8AD:				; CODE XREF: .text:0042B898j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	short loc_42B89A
		jmp	short loc_42B8B8
; ---------------------------------------------------------------------------

loc_42B8B7:				; CODE XREF: .text:0042B8A7j
		nop

loc_42B8B8:				; CODE XREF: .text:0042B8B5j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	loc_42B953
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_42B8D5
		mov	eax, [ebp+14h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		jmp	short loc_42B8DA
; ---------------------------------------------------------------------------

loc_42B8D5:				; CODE XREF: .text:0042B8C8j
		mov	eax, 0

loc_42B8DA:				; CODE XREF: .text:0042B8D3j
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_438D63
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_42B923
		mov	eax, [ebp-18h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+18h]
		mov	[eax], edx

loc_42B923:				; CODE XREF: .text:0042B8FDj
		mov	eax, [ebp-18h]
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_42A247
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jz	short loc_42B94E
		mov	eax, [ebp-0Ch]
		jmp	short loc_42B951
; ---------------------------------------------------------------------------

loc_42B94E:				; CODE XREF: .text:0042B947j
		mov	eax, [ebp-1Ch]

loc_42B951:				; CODE XREF: .text:0042B94Cj
		jmp	short loc_42B97A
; ---------------------------------------------------------------------------

loc_42B953:				; CODE XREF: .text:0042B8BEj
		mov	eax, [ebp-10h]
		mov	edx, [ebp+18h]
		mov	[esp+10h], edx
		mov	edx, [ebp+14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+10h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42B219

loc_42B97A:				; CODE XREF: .text:loc_42B951j
		add	esp, 54h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42B980	proc near		; CODE XREF: sub_42B9A7+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_42B9A0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_42B9A5
; ---------------------------------------------------------------------------

loc_42B9A0:				; CODE XREF: sub_42B980+7j
		mov	eax, 0

loc_42B9A5:				; CODE XREF: sub_42B980+1Ej
		pop	ebp
		retn
sub_42B980	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42B9A7	proc near		; CODE XREF: sub_42B9C2+Ep
					; sub_42B9D7+12Fp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_42B980
		leave
		retn
sub_42B9A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42B9C2	proc near		; CODE XREF: sub_42B9D7+77p
					; sub_42B9D7+3ABp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_42B9A7
		leave
		retn
sub_42B9C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42B9D7(char *Str2, char *)
sub_42B9D7	proc near		; CODE XREF: sub_42BE4C+D4p
					; sub_42BE4C+14Ap ...

Filename	= dword	ptr -158h
Mode		= dword	ptr -154h
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_13C		= dword	ptr -13Ch
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
Buf		= byte ptr -120h
var_11F		= byte ptr -11Fh
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Str2		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 150h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_130], 0
		mov	[ebp+var_12C], 0
		mov	[ebp+var_128], 0
		mov	[ebp+var_124], 0
		mov	eax, offset aR_5 ; "r"
		mov	[esp+158h+Mode], eax ; Mode
		mov	eax, [ebp+arg_4]
		mov	[esp+158h+Filename], eax ; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	loc_42BD3E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_42BA82
		call	sub_42B9C2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+158h+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+158h+Filename], offset aCanTOpenSS_2 ; "can't open `%s': %s\n"
		call	sub_435294
		mov	[esp+158h+var_150], ebx
		mov	edx, [ebp+arg_4]
		mov	[esp+158h+Mode], edx ; char
		mov	[esp+158h+Filename], eax ; char	*
		call	sub_435B7D

loc_42BA82:				; CODE XREF: sub_42B9D7+75j
		mov	eax, 0
		jmp	loc_42BE42
; ---------------------------------------------------------------------------

loc_42BA8C:				; CODE XREF: sub_42B9D7+390j
		add	[ebp+var_10], 1
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_42BAD2
		lea	eax, [ebp+Buf]
		mov	[ebp+var_13C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_13C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		movzx	eax, [ebp+eax+Buf]
		cmp	al, 0Ah
		jz	short loc_42BB43

loc_42BAD2:				; CODE XREF: sub_42B9D7+C2j
					; sub_42B9D7+113j
		mov	eax, [ebp+File]
		mov	[esp+158h+Filename], eax ; File
		call	getc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jz	short loc_42BAEC
		cmp	[ebp+var_20], 0Ah
		jnz	short loc_42BAD2

loc_42BAEC:				; CODE XREF: sub_42B9D7+10Dj
		movzx	eax, [ebp+Buf]
		test	al, al
		jz	short loc_42BAFE
		mov	eax, 61h
		jmp	short loc_42BB03
; ---------------------------------------------------------------------------

loc_42BAFE:				; CODE XREF: sub_42B9D7+11Ej
		mov	eax, 4Bh

loc_42BB03:				; CODE XREF: sub_42B9D7+125j
		mov	[esp+158h+Filename], eax
		call	sub_42B9A7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+158h+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+158h+Filename], offset aFileSLineDS_0 ; "file `%s', line %d: %s\n"
		call	sub_435294
		mov	[esp+158h+var_14C], ebx
		mov	edx, [ebp+var_10]
		mov	[esp+158h+var_150], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+158h+Mode], edx ; char
		mov	[esp+158h+Filename], eax ; char	*
		call	sub_435B7D
		jmp	short loc_42BB79
; ---------------------------------------------------------------------------

loc_42BB43:				; CODE XREF: sub_42B9D7+F9j
		lea	eax, [ebp+Buf]
		mov	[ebp+var_13C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_13C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		mov	[ebp+eax+Buf], 0
		jmp	short loc_42BB79
; ---------------------------------------------------------------------------

loc_42BB78:				; CODE XREF: sub_42B9D7+30Dj
		nop

loc_42BB79:				; CODE XREF: sub_42B9D7+16Aj
					; sub_42B9D7+19Fj
		cmp	[ebp+var_18], 0
		jnz	loc_42BC6C
		lea	eax, [ebp+Buf]
		mov	[ebp+var_14], eax
		jmp	short loc_42BB92
; ---------------------------------------------------------------------------

loc_42BB8E:				; CODE XREF: sub_42B9D7+1C3j
					; sub_42B9D7+1CDj
		add	[ebp+var_14], 1

loc_42BB92:				; CODE XREF: sub_42B9D7+1B5j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_42BB8E
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_42BB8E
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_42BD41
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	loc_42BD41
		movzx	eax, [ebp+Buf]
		cmp	al, 2Eh
		jnz	short loc_42BBE3
		movzx	eax, [ebp+var_11F]
		cmp	al, 20h
		jz	short loc_42BBE3
		movzx	eax, [ebp+var_11F]
		cmp	al, 9
		jnz	short loc_42BC1C

loc_42BBE3:				; CODE XREF: sub_42B9D7+1F4j
					; sub_42B9D7+1FFj
		mov	[esp+158h+Filename], offset aIgnoringGarbag ; "ignoring	garbage	line"
		call	sub_435294
		mov	ebx, eax
		mov	[esp+158h+Filename], offset aFileSLineDS_0 ; "file `%s', line %d: %s\n"
		call	sub_435294
		mov	[esp+158h+var_14C], ebx
		mov	edx, [ebp+var_10]
		mov	[esp+158h+var_150], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+158h+Mode], edx ; char
		mov	[esp+158h+Filename], eax ; char	*
		call	sub_435B53
		jmp	loc_42BD48
; ---------------------------------------------------------------------------

loc_42BC1C:				; CODE XREF: sub_42B9D7+20Aj
		lea	eax, [ebp+Buf]
		mov	[esp+158h+Filename], eax
		call	sub_432034
		mov	[ebp+var_18], 1
		mov	eax, [ebp+Str2]
		mov	[esp+158h+Mode], eax ; Str2
		lea	eax, [ebp+Buf]
		add	eax, 1
		mov	[esp+158h+Filename], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_42BD44
		mov	[esp+158h+Mode], 400h
		lea	eax, [ebp+var_130]
		mov	[esp+158h+Filename], eax
		call	sub_424484
		jmp	loc_42BD44
; ---------------------------------------------------------------------------

loc_42BC6C:				; CODE XREF: sub_42B9D7+1A6j
		movzx	eax, [ebp+Buf]
		cmp	al, 23h
		jz	loc_42BD47
		movzx	eax, [ebp+Buf]
		cmp	al, 2Eh
		jnz	short loc_42BCEC
		movzx	eax, [ebp+var_11F]
		cmp	al, 20h
		jz	short loc_42BC9C
		movzx	eax, [ebp+var_11F]
		cmp	al, 9
		jnz	short loc_42BCAA

loc_42BC9C:				; CODE XREF: sub_42B9D7+2B8j
		lea	eax, [ebp+Buf]
		add	eax, 2
		mov	[ebp+var_14], eax
		jmp	short loc_42BCF5
; ---------------------------------------------------------------------------

loc_42BCAA:				; CODE XREF: sub_42B9D7+2C3j
		lea	eax, [ebp+Buf]
		mov	[esp+158h+Filename], eax
		call	sub_432034
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_128]
		test	eax, eax
		jnz	loc_42BD6D
		mov	eax, [ebp+var_124]
		test	eax, eax
		jnz	loc_42BD6D
		movzx	eax, [ebp+var_11F]
		test	al, al
		jnz	loc_42BB78
		jmp	short loc_42BD48
; ---------------------------------------------------------------------------

loc_42BCEC:				; CODE XREF: sub_42B9D7+2ADj
		lea	eax, [ebp+Buf]
		mov	[ebp+var_14], eax

loc_42BCF5:				; CODE XREF: sub_42B9D7+2D1j
		mov	eax, [ebp+var_128]
		test	eax, eax
		jnz	short loc_42BD09
		mov	eax, [ebp+var_124]
		test	eax, eax
		jz	short loc_42BD48

loc_42BD09:				; CODE XREF: sub_42B9D7+326j
		mov	eax, [ebp+var_14]
		mov	[esp+158h+Mode], eax ; void *
		lea	eax, [ebp+var_130]
		mov	[esp+158h+Filename], eax ; int
		call	sub_424614
		mov	[esp+158h+var_150], 1 ;	size_t
		mov	[esp+158h+Mode], offset	asc_4461FD ; "\n"
		lea	eax, [ebp+var_130]
		mov	[esp+158h+Filename], eax ; int
		call	sub_424524
		jmp	short loc_42BD48
; ---------------------------------------------------------------------------

loc_42BD3E:				; CODE XREF: sub_42B9D7+63j
		nop
		jmp	short loc_42BD48
; ---------------------------------------------------------------------------

loc_42BD41:				; CODE XREF: sub_42B9D7+1D7j
					; sub_42B9D7+1E5j
		nop
		jmp	short loc_42BD48
; ---------------------------------------------------------------------------

loc_42BD44:				; CODE XREF: sub_42B9D7+274j
					; sub_42B9D7+290j
		nop
		jmp	short loc_42BD48
; ---------------------------------------------------------------------------

loc_42BD47:				; CODE XREF: sub_42B9D7+29Ej
		nop

loc_42BD48:				; CODE XREF: sub_42B9D7+240j
					; sub_42B9D7+313j ...
		mov	eax, [ebp+File]
		mov	[esp+158h+var_150], eax	; File
		mov	[esp+158h+Mode], 0FFh ;	MaxCount
		lea	eax, [ebp+Buf]
		mov	[esp+158h+Filename], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_42BA8C

loc_42BD6D:				; CODE XREF: sub_42B9D7+2F0j
					; sub_42B9D7+2FEj
		cmp	[ebp+var_C], 0
		jnz	short loc_42BDBD
		mov	eax, [ebp+File]
		mov	[esp+158h+Filename], eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_42BDBD
		call	sub_42B9C2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+158h+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+158h+Filename], offset aErrorReading_0 ; "error reading `%s', line %d: %s\n"
		call	sub_435294
		mov	[esp+158h+var_14C], ebx
		mov	edx, [ebp+var_10]
		mov	[esp+158h+var_150], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+158h+Mode], edx ; char
		mov	[esp+158h+Filename], eax ; char	*
		call	sub_435B7D

loc_42BDBD:				; CODE XREF: sub_42B9D7+39Aj
					; sub_42B9D7+3A9j
		mov	eax, [ebp+File]
		mov	[esp+158h+Filename], eax ; File
		call	fclose
		mov	eax, [ebp+var_128]
		test	eax, eax
		jnz	short loc_42BDDC
		mov	eax, [ebp+var_124]
		test	eax, eax
		jz	short loc_42BE3D

loc_42BDDC:				; CODE XREF: sub_42B9D7+3F9j
		cmp	[ebp+var_C], 0
		jz	short loc_42BE07
		mov	[esp+158h+Mode], 0
		lea	eax, [ebp+var_130]
		mov	[esp+158h+Filename], eax
		call	sub_424656
		mov	[esp+158h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_42BE42
; ---------------------------------------------------------------------------

loc_42BE07:				; CODE XREF: sub_42B9D7+409j
		mov	[esp+158h+var_150], 1 ;	size_t
		mov	[esp+158h+Mode], offset	byte_446221 ; void *
		lea	eax, [ebp+var_130]
		mov	[esp+158h+Filename], eax ; int
		call	sub_424524
		mov	[esp+158h+Mode], 0
		lea	eax, [ebp+var_130]
		mov	[esp+158h+Filename], eax
		call	sub_424656
		jmp	short loc_42BE42
; ---------------------------------------------------------------------------

loc_42BE3D:				; CODE XREF: sub_42B9D7+403j
		mov	eax, 0

loc_42BE42:				; CODE XREF: sub_42B9D7+B0j
					; sub_42B9D7+42Ej ...
		add	esp, 150h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42B9D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42BE4C(char *Str2, char *, int, int)
sub_42BE4C	proc near		; CODE XREF: sub_42BFF3+DCp
					; sub_42BFF3+10Ap

Str		= dword	ptr -48h
Val		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Str2		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 0Bh
		mov	[esp+48h+Str], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_42BEB2
		mov	eax, 0
		jmp	loc_42BFEC
; ---------------------------------------------------------------------------

loc_42BEB2:				; CODE XREF: sub_42BE4C+5Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax
		call	sub_433245
		mov	dword ptr [eax], 6C65682Fh
		mov	word ptr [eax+4], 2E70h
		mov	byte ptr [eax+6], 0
		add	eax, 6
		mov	[ebp+var_1C], eax
		mov	[esp+48h+Val], 5Fh ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_42BF2A
		mov	ebx, offset a_txt ; ".txt"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str], eax
		call	sub_433245
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Val], eax ; char *
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Str], eax ; Str2
		call	sub_42B9D7
		mov	[ebp+var_14], eax
		jmp	short loc_42BF31
; ---------------------------------------------------------------------------

loc_42BF2A:				; CODE XREF: sub_42BE4C+A3j
		mov	[ebp+var_14], 0

loc_42BF31:				; CODE XREF: sub_42BE4C+DCj
		cmp	[ebp+var_14], 0
		jnz	short loc_42BFA7
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42BFA0
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_42BF62
; ---------------------------------------------------------------------------

loc_42BF4F:				; CODE XREF: sub_42BE4C+128j
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_42BF62:				; CODE XREF: sub_42BE4C+101j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42BF76
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_42BF4F

loc_42BF76:				; CODE XREF: sub_42BE4C+11Ej
		mov	edx, offset a_txt ; ".txt"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Val], eax ; char *
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Str], eax ; Str2
		call	sub_42B9D7
		mov	[ebp+var_14], eax
		jmp	short loc_42BFA7
; ---------------------------------------------------------------------------

loc_42BFA0:				; CODE XREF: sub_42BE4C+F3j
		mov	[ebp+var_14], 0

loc_42BFA7:				; CODE XREF: sub_42BE4C+E9j
					; sub_42BE4C+152j
		cmp	[ebp+var_14], 0
		jnz	short loc_42BFDE
		cmp	[ebp+arg_8], 0
		jz	short loc_42BFBD
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42BFDE

loc_42BFBD:				; CODE XREF: sub_42BE4C+165j
		mov	edx, offset aTxt ; "txt"
		mov	eax, [ebp+var_1C]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Val], eax ; char *
		mov	eax, [ebp+Str2]
		mov	[esp+48h+Str], eax ; Str2
		call	sub_42B9D7
		mov	[ebp+var_14], eax

loc_42BFDE:				; CODE XREF: sub_42BE4C+15Fj
					; sub_42BE4C+16Fj
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_14]

loc_42BFEC:				; CODE XREF: sub_42BE4C+61j
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42BE4C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42BFF3(char *, int)
sub_42BFF3	proc near		; CODE XREF: sub_40F697+EAp

Str2		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_449360
		test	eax, eax
		jnz	loc_42C098
		mov	[ebp+var_14], 0
		call	sub_4315D4
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str2],	eax
		call	gcry_strdup
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_42C035
		mov	ds:dword_449360, offset	byte_446221
		jmp	short loc_42C098
; ---------------------------------------------------------------------------

loc_42C035:				; CODE XREF: sub_42BFF3+34j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax
		jmp	short loc_42C086
; ---------------------------------------------------------------------------

loc_42C03D:				; CODE XREF: sub_42BFF3+9Bj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jz	short loc_42C05B
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_42C05B
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_42C063

loc_42C05B:				; CODE XREF: sub_42BFF3+52j
					; sub_42BFF3+5Cj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		jmp	short loc_42C082
; ---------------------------------------------------------------------------

loc_42C063:				; CODE XREF: sub_42BFF3+66j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_42C082
		cmp	[ebp+var_14], 0
		setnz	al
		add	[ebp+var_14], 1
		test	al, al
		jz	short loc_42C082
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0

loc_42C082:				; CODE XREF: sub_42BFF3+6Ej
					; sub_42BFF3+78j ...
		add	[ebp+var_10], 1

loc_42C086:				; CODE XREF: sub_42BFF3+48j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42C03D
		mov	eax, [ebp+var_1C]
		mov	ds:dword_449360, eax

loc_42C098:				; CODE XREF: sub_42BFF3+Dj
					; sub_42BFF3+40j
		cmp	[ebp+arg_0], 0
		jz	short loc_42C0A8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42C0AF

loc_42C0A8:				; CODE XREF: sub_42BFF3+A9j
		mov	eax, 0
		jmp	short locret_42C119
; ---------------------------------------------------------------------------

loc_42C0AF:				; CODE XREF: sub_42BFF3+B3j
		call	sub_41F080
		mov	edx, ds:dword_449360
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_30], eax ;	int
		mov	[esp+38h+var_34], edx ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str2],	eax ; Str2
		call	sub_42BE4C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42C105
		call	sub_41F21F
		mov	edx, ds:dword_449360
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_30], eax ;	int
		mov	[esp+38h+var_34], edx ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str2],	eax ; Str2
		call	sub_42BE4C
		mov	[ebp+var_C], eax

loc_42C105:				; CODE XREF: sub_42BFF3+E8j
		cmp	[ebp+var_C], 0
		jz	short loc_42C116
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str2],	eax
		call	sub_432034

loc_42C116:				; CODE XREF: sub_42BFF3+116j
		mov	eax, [ebp+var_C]

locret_42C119:				; CODE XREF: sub_42BFF3+BAj
		leave
		retn
sub_42BFF3	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C11C	proc near		; CODE XREF: sub_42C143+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_42C13C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_42C141
; ---------------------------------------------------------------------------

loc_42C13C:				; CODE XREF: sub_42C11C+7j
		mov	eax, 0

loc_42C141:				; CODE XREF: sub_42C11C+1Ej
		pop	ebp
		retn
sub_42C11C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C143	proc near		; CODE XREF: sub_42C15E+Ep
					; sub_42C1FC+57p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_42C11C
		leave
		retn
sub_42C143	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C15E	proc near		; CODE XREF: sub_42C3B5+6Cp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_42C143
		leave
		retn
sub_42C15E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C173	proc near		; CODE XREF: sub_42C1FC+64p
					; .text:0042C84Bp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		mov	[ebp+var_8], 0
		jmp	short loc_42C1AD
; ---------------------------------------------------------------------------

loc_42C18A:				; CODE XREF: sub_42C173+60j
		mov	edx, [ebp+var_8]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_8], eax
		add	[ebp+var_4], 1

loc_42C1AD:				; CODE XREF: sub_42C173+15j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42C1D5
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42C1D5
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_42C1D5
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_42C18A

loc_42C1D5:				; CODE XREF: sub_42C173+42j
					; sub_42C173+4Cj ...
		cmp	[ebp+var_8], 0
		jz	short loc_42C1E5
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42C1EC

loc_42C1E5:				; CODE XREF: sub_42C173+66j
		mov	eax, 0
		jmp	short locret_42C1FA
; ---------------------------------------------------------------------------

loc_42C1EC:				; CODE XREF: sub_42C173+70j
		mov	eax, [ebp+var_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_8]

locret_42C1FA:				; CODE XREF: sub_42C173+77j
		leave
		retn
sub_42C173	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C1FC	proc near		; CODE XREF: .text:0042C8BCp

var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		jmp	short loc_42C285
; ---------------------------------------------------------------------------

loc_42C214:				; CODE XREF: sub_42C1FC+8Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_42C22D
		add	[ebp+var_4], 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_42C285
; ---------------------------------------------------------------------------

loc_42C22D:				; CODE XREF: sub_42C1FC+20j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_42C246
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_42C285
; ---------------------------------------------------------------------------

loc_42C246:				; CODE XREF: sub_42C1FC+39j
		cmp	[ebp+var_4], 0
		jnz	short loc_42C25A
		mov	[esp+14h+var_14], 53h
		call	sub_42C143
		jmp	short locret_42C2A0
; ---------------------------------------------------------------------------

loc_42C25A:				; CODE XREF: sub_42C1FC+4Ej
		lea	eax, [ebp+var_C]
		mov	[esp+14h+var_14], eax
		call	sub_42C173
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jnz	short loc_42C27C
		mov	[esp+14h+var_14], 53h
		call	sub_42C143
		jmp	short locret_42C2A0
; ---------------------------------------------------------------------------

loc_42C27C:				; CODE XREF: sub_42C1FC+70j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_8]
		mov	[ebp+var_C], eax

loc_42C285:				; CODE XREF: sub_42C1FC+16j
					; sub_42C1FC+2Fj ...
		cmp	[ebp+var_4], 0
		jg	short loc_42C214
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, 0

locret_42C2A0:				; CODE XREF: sub_42C1FC+5Cj
					; sub_42C1FC+7Ej
		leave
		retn
sub_42C1FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42C2A2(int, int, void	*)
sub_42C2A2	proc near		; CODE XREF: .text:0042C878p
					; .text:0042C923p

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+var_C]
		jnz	short loc_42C2F2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Size],	edx ; Size
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Buf2],	edx ; Buf2
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_42C2F9

loc_42C2F2:				; CODE XREF: sub_42C2A2+2Fj
		mov	eax, 0
		jmp	short loc_42C30D
; ---------------------------------------------------------------------------

loc_42C2F9:				; CODE XREF: sub_42C2A2+4Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 1

loc_42C30D:				; CODE XREF: sub_42C2A2+55j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_42C2A2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C313	proc near		; CODE XREF: .text:0042C6B1p

var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_4], 2
		jbe	short loc_42C390
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	0
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	3Ah

loc_42C33E:				; CODE XREF: sub_42C313+7Bj
		sub	[ebp+var_4], 1
		mov	ecx, [ebp+arg_8]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	ecx, [ebp+arg_8]
		mov	[ebp+var_14], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_14]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+arg_8], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_42C390
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+arg_0]
		ja	short loc_42C33E

loc_42C390:				; CODE XREF: sub_42C313+15j
					; sub_42C313+73j
		cmp	[ebp+arg_C], 0
		jz	short loc_42C3B0
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_42C3B0:				; CODE XREF: sub_42C313+81j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_42C313	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C3B5	proc near		; CODE XREF: sub_412630+5Cp
					; sub_4131E4+7Ep

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_8], 0
		jz	short loc_42C3D3
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_42C3D3:				; CODE XREF: sub_42C3B5+13j
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42C40D
		mov	[esp+28h+var_28], 3Bh
		call	sub_42C143
		jmp	short locret_42C47B
; ---------------------------------------------------------------------------

loc_42C40D:				; CODE XREF: sub_42C3B5+48j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_42C428
		call	sub_42C15E
		jmp	short locret_42C47B
; ---------------------------------------------------------------------------

loc_42C428:				; CODE XREF: sub_42C3B5+6Aj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42C460
		mov	[esp+28h+var_28], 3Bh
		call	sub_42C143
		jmp	short locret_42C47B
; ---------------------------------------------------------------------------

loc_42C460:				; CODE XREF: sub_42C3B5+9Bj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		cmp	[ebp+arg_8], 0
		jz	short loc_42C476
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_42C476:				; CODE XREF: sub_42C3B5+B7j
		mov	eax, 0

locret_42C47B:				; CODE XREF: sub_42C3B5+56j
					; sub_42C3B5+71j ...
		leave
		retn
sub_42C3B5	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_42C497
		mov	dword ptr [esp], 37h
		call	sub_42C143
		jmp	short locret_42C4F9
; ---------------------------------------------------------------------------

loc_42C497:				; CODE XREF: .text:0042C487j
		mov	eax, [ebp+0Ch]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_sexp_sscan
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42C4C6
		mov	eax, [ebp-0Ch]
		jmp	short locret_42C4F9
; ---------------------------------------------------------------------------

loc_42C4C6:				; CODE XREF: .text:0042C4BFj
		mov	eax, [ebp-10h]
		mov	edx, [ebp+10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	gcry_pk_get_keygrip
		test	eax, eax
		jnz	short loc_42C4EB
		mov	dword ptr [esp], 3Fh
		call	sub_42C143
		mov	[ebp-0Ch], eax

loc_42C4EB:				; CODE XREF: .text:0042C4DAj
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_sexp_release
		mov	eax, [ebp-0Ch]

locret_42C4F9:				; CODE XREF: .text:0042C495j
					; .text:0042C4C4j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42C523
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42C523
		mov	eax, 0
		jmp	locret_42C60E
; ---------------------------------------------------------------------------

loc_42C523:				; CODE XREF: .text:0042C511j
					; .text:0042C517j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42C52F
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42C539

loc_42C52F:				; CODE XREF: .text:0042C527j
		mov	eax, 1
		jmp	locret_42C60E
; ---------------------------------------------------------------------------

loc_42C539:				; CODE XREF: .text:0042C52Dj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_42C54D
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_42C559

loc_42C54D:				; CODE XREF: .text:0042C541j
		mov	dword ptr [esp], offset	aInvalidSExpInC	; "invalid S-exp in cmp_simple_canon_sexp\"...
		call	sub_435BED
; ---------------------------------------------------------------------------

loc_42C559:				; CODE XREF: .text:0042C54Bj
		add	dword ptr [ebp-0Ch], 1
		mov	dword ptr [esp+8], 0Ah
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strtoul
		mov	[ebp-14h], eax
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [esp+8], 0Ah
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strtoul
		mov	[ebp-18h], eax
		mov	eax, [ebp-1Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_42C5BB
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42C5C7

loc_42C5BB:				; CODE XREF: .text:0042C5AFj
		mov	dword ptr [esp], offset	aInvalidSExpInC	; "invalid S-exp in cmp_simple_canon_sexp\"...
		call	sub_435BED
; ---------------------------------------------------------------------------

loc_42C5C7:				; CODE XREF: .text:0042C5B9j
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-18h]
		jz	short loc_42C5D6
		mov	eax, 1
		jmp	short locret_42C60E
; ---------------------------------------------------------------------------

loc_42C5D6:				; CODE XREF: .text:0042C5CDj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_42C603
; ---------------------------------------------------------------------------

loc_42C5E0:				; CODE XREF: .text:0042C607j
		mov	eax, [ebp-0Ch]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_42C5F7
		mov	eax, 1
		jmp	short locret_42C60E
; ---------------------------------------------------------------------------

loc_42C5F7:				; CODE XREF: .text:0042C5EEj
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1

loc_42C603:				; CODE XREF: .text:0042C5DEj
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_42C5E0
		mov	eax, 0

locret_42C60E:				; CODE XREF: .text:0042C51Ej
					; .text:0042C534j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		jmp	short loc_42C62D
; ---------------------------------------------------------------------------

loc_42C625:				; CODE XREF: .text:0042C63Fj
					; .text:0042C653j ...
		add	dword ptr [ebp-10h], 1
		add	dword ptr [ebp-0Ch], 1

loc_42C62D:				; CODE XREF: .text:0042C623j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42C641
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42C625

loc_42C641:				; CODE XREF: .text:0042C635j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42C655
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42C625

loc_42C655:				; CODE XREF: .text:0042C649j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42C669
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_42C625

loc_42C669:				; CODE XREF: .text:0042C65Dj
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42C677
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx

loc_42C677:				; CODE XREF: .text:0042C66Dj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42C687
		mov	eax, 0
		jmp	locret_42C813
; ---------------------------------------------------------------------------

loc_42C687:				; CODE XREF: .text:0042C67Bj
		mov	eax, [ebp-0Ch]
		add	eax, 1
		and	eax, 0FFFFFFFEh
		shr	eax, 1
		mov	[ebp-18h], eax
		lea	eax, [ebp-58h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-18h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 32h
		lea	eax, [ebp-52h]
		mov	[esp], eax
		call	sub_42C313
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-58h]
		add	eax, [ebp-18h]
		add	eax, 3
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_42C6DD
		mov	eax, 0
		jmp	locret_42C813
; ---------------------------------------------------------------------------

loc_42C6DD:				; CODE XREF: .text:0042C6D1j
		mov	eax, [ebp-20h]
		mov	byte ptr [eax],	28h
		mov	eax, [ebp-20h]
		lea	edx, [eax+1]
		mov	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp], edx
		call	sub_433245
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		and	eax, 1
		test	al, al
		jz	loc_42C7F6
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42C724
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42C742
; ---------------------------------------------------------------------------

loc_42C724:				; CODE XREF: .text:0042C717j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42C739
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42C742
; ---------------------------------------------------------------------------

loc_42C739:				; CODE XREF: .text:0042C72Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42C742:				; CODE XREF: .text:0042C722j
					; .text:0042C737j
		mov	edx, [ebp-14h]
		mov	[edx], al
		add	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-0Ch], 1
		jmp	loc_42C7F6
; ---------------------------------------------------------------------------

loc_42C758:				; CODE XREF: .text:0042C7FAj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42C775
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_42C7A1
; ---------------------------------------------------------------------------

loc_42C775:				; CODE XREF: .text:0042C760j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42C790
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_42C79F
; ---------------------------------------------------------------------------

loc_42C790:				; CODE XREF: .text:0042C77Dj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_42C79F:				; CODE XREF: .text:0042C78Ej
		mov	edx, eax

loc_42C7A1:				; CODE XREF: .text:0042C773j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42C7BC
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42C7E3
; ---------------------------------------------------------------------------

loc_42C7BC:				; CODE XREF: .text:0042C7ACj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42C7D7
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42C7E3
; ---------------------------------------------------------------------------

loc_42C7D7:				; CODE XREF: .text:0042C7C7j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42C7E3:				; CODE XREF: .text:0042C7BAj
					; .text:0042C7D5j
		add	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1
		sub	dword ptr [ebp-0Ch], 2
		add	dword ptr [ebp-10h], 2

loc_42C7F6:				; CODE XREF: .text:0042C709j
					; .text:0042C753j
		cmp	dword ptr [ebp-0Ch], 1
		ja	loc_42C758
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	29h
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]

locret_42C813:				; CODE XREF: .text:0042C682j
					; .text:0042C6D8j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jz	short loc_42C832
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_42C83C

loc_42C832:				; CODE XREF: .text:0042C826j
		mov	eax, 0
		jmp	locret_42C988
; ---------------------------------------------------------------------------

loc_42C83C:				; CODE XREF: .text:0042C830j
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-10h], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42C173
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42C863
		mov	eax, 0
		jmp	locret_42C988
; ---------------------------------------------------------------------------

loc_42C863:				; CODE XREF: .text:0042C857j
		mov	dword ptr [esp+8], offset aSigVal ; "sig-val"
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42C2A2
		test	eax, eax
		jnz	short loc_42C88B
		mov	eax, 0
		jmp	locret_42C988
; ---------------------------------------------------------------------------

loc_42C88B:				; CODE XREF: .text:0042C87Fj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_42C89F
		mov	eax, 0
		jmp	locret_42C988
; ---------------------------------------------------------------------------

loc_42C89F:				; CODE XREF: .text:0042C893j
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-14h], 1
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42C1FC
		test	eax, eax
		jnz	short loc_42C8CC
		mov	eax, [ebp-14h]
		test	eax, eax
		jz	short loc_42C8D6

loc_42C8CC:				; CODE XREF: .text:0042C8C3j
		mov	eax, 0
		jmp	locret_42C988
; ---------------------------------------------------------------------------

loc_42C8D6:				; CODE XREF: .text:0042C8CAj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_42C8EA
		mov	eax, 0
		jmp	locret_42C988
; ---------------------------------------------------------------------------

loc_42C8EA:				; CODE XREF: .text:0042C8DEj
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-10h], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42C173
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42C90E
		mov	eax, 0
		jmp	short locret_42C988
; ---------------------------------------------------------------------------

loc_42C90E:				; CODE XREF: .text:0042C905j
		mov	dword ptr [esp+8], offset aHash_1 ; "hash"
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42C2A2
		test	eax, eax
		jnz	short loc_42C933
		mov	eax, 0
		jmp	short locret_42C988
; ---------------------------------------------------------------------------

loc_42C933:				; CODE XREF: .text:0042C92Aj
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42C173
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42C952
		mov	eax, [ebp-0Ch]
		add	eax, 1
		cmp	eax, 31h
		jbe	short loc_42C959

loc_42C952:				; CODE XREF: .text:0042C945j
		mov	eax, 0
		jmp	short locret_42C988
; ---------------------------------------------------------------------------

loc_42C959:				; CODE XREF: .text:0042C950j
		mov	eax, [ebp-10h]
		mov	edx, eax
		lea	eax, [ebp-46h]
		mov	ecx, [ebp-0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		lea	eax, [ebp-46h]
		add	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		lea	eax, [ebp-46h]
		mov	[esp], eax
		call	gcry_md_map_name

locret_42C988:				; CODE XREF: .text:0042C837j
					; .text:0042C85Ej ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-7Fh], 3A303128h
		mov	dword ptr [ebp-7Bh], 6C627570h
		mov	dword ptr [ebp-77h], 6B2D6369h
		mov	dword ptr [ebp-73h], 33287965h
		mov	dword ptr [ebp-6Fh], 6173723Ah
		mov	dword ptr [ebp-6Bh], 6E3A3128h
		mov	byte ptr [ebp-67h], 0
		mov	dword ptr [ebp-85h], 3A312829h
		mov	word ptr [ebp-81h], 65h
		mov	dword ptr [ebp-89h], 292929h
		jmp	short loc_42CA04
; ---------------------------------------------------------------------------

loc_42C9FC:				; CODE XREF: .text:0042CA12j
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_42CA04:				; CODE XREF: .text:0042C9FAj
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42CA1E
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42C9FC
		jmp	short loc_42CA1E
; ---------------------------------------------------------------------------

loc_42CA16:				; CODE XREF: .text:0042CA2Cj
		sub	dword ptr [ebp+14h], 1
		add	dword ptr [ebp-10h], 1

loc_42CA1E:				; CODE XREF: .text:0042CA08j
					; .text:0042CA14j
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_42CA2E
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42CA16

loc_42CA2E:				; CODE XREF: .text:0042CA22j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42CA3E
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_42CA45

loc_42CA3E:				; CODE XREF: .text:0042CA32j
		mov	dword ptr [ebp-14h], 1

loc_42CA45:				; CODE XREF: .text:0042CA3Cj
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_42CA55
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_42CA5C

loc_42CA55:				; CODE XREF: .text:0042CA49j
		mov	dword ptr [ebp-18h], 1

loc_42CA5C:				; CODE XREF: .text:0042CA53j
		mov	eax, [ebp-14h]
		add	eax, [ebp+0Ch]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aU_0 ; "%u:"
		mov	dword ptr [esp+4], 23h
		lea	eax, [ebp-43h]
		mov	[esp], eax
		call	sub_4241F9
		mov	eax, [ebp-18h]
		add	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aU_0 ; "%u:"
		mov	dword ptr [esp+4], 23h
		lea	eax, [ebp-66h]
		mov	[esp], eax
		call	sub_4241F9
		lea	eax, [ebp-43h]
		mov	dword ptr [ebp-9Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-9Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	edx, eax
		add	edx, [ebp+0Ch]
		mov	eax, [ebp-14h]
		lea	ebx, [edx+eax]
		lea	eax, [ebp-66h]
		mov	dword ptr [ebp-9Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-9Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		mov	edx, eax
		add	edx, [ebp+14h]
		mov	eax, [ebp-18h]
		add	eax, edx
		add	eax, 21h
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_42CB25
		mov	eax, 0
		jmp	loc_42CC2C
; ---------------------------------------------------------------------------

loc_42CB25:				; CODE XREF: .text:0042CB19j
		mov	eax, [ebp-20h]
		lea	edx, [ebp-7Fh]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		movzx	edx, byte ptr [edx+18h]
		mov	[eax+18h], dl
		add	eax, 18h
		mov	[ebp-1Ch], eax
		lea	eax, [ebp-43h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_433245
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42CB7F
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-1Ch], 1

loc_42CB7F:				; CODE XREF: .text:0042CB73j
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp-1Ch]
		mov	ecx, [ebp+0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+0Ch]
		add	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		lea	edx, [ebp-85h]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, word ptr [edx+4]
		mov	[eax+4], dx
		add	eax, 5
		mov	[ebp-1Ch], eax
		lea	eax, [ebp-66h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_433245
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_42CBDE
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-1Ch], 1

loc_42CBDE:				; CODE XREF: .text:0042CBD2j
		mov	edx, [ebp-10h]
		mov	eax, [ebp-1Ch]
		mov	ecx, [ebp+14h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+14h]
		add	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		lea	edx, [ebp-89h]
		mov	edx, [edx]
		mov	[eax], edx
		add	eax, 3
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_42CC29
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-20h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+18h]
		mov	[eax], edx

loc_42CC29:				; CODE XREF: .text:0042CC14j
		mov	eax, [ebp-20h]

loc_42CC2C:				; CODE XREF: .text:0042CB20j
		add	esp, 0B0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	dword ptr [ebp-34h], 0
		mov	dword ptr [ebp-38h], 0
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+18h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+1Ch]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+8]
		mov	[ebp-20h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-28h], eax
		mov	dword ptr [ebp-30h], 0
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-2Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-24h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-30h]
		mov	[esp+8], eax
		lea	eax, [ebp-28h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42CCC1
		mov	eax, [ebp-14h]
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CCC1:				; CODE XREF: .text:0042CCB7j
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-2Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-24h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-30h]
		mov	[esp+8], eax
		lea	eax, [ebp-28h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42CD01
		mov	eax, [ebp-14h]
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CD01:				; CODE XREF: .text:0042CCF7j
		mov	eax, [ebp-24h]
		test	eax, eax
		jz	short loc_42CD2E
		mov	eax, [ebp-2Ch]
		cmp	eax, 0Ah
		jnz	short loc_42CD2E
		mov	edx, [ebp-2Ch]
		mov	eax, [ebp-24h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aPublicKey_3 ; "public-key"
		call	memcmp
		test	eax, eax
		jz	short loc_42CD3F

loc_42CD2E:				; CODE XREF: .text:0042CD06j
					; .text:0042CD0Ej
		mov	dword ptr [esp], 6
		call	sub_42C143
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CD3F:				; CODE XREF: .text:0042CD2Cj
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-2Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-24h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-30h]
		mov	[esp+8], eax
		lea	eax, [ebp-28h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42CD7F
		mov	eax, [ebp-14h]
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CD7F:				; CODE XREF: .text:0042CD75j
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-2Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-24h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-30h]
		mov	[esp+8], eax
		lea	eax, [ebp-28h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42CDBF
		mov	eax, [ebp-14h]
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CDBF:				; CODE XREF: .text:0042CDB5j
		mov	eax, [ebp-24h]
		test	eax, eax
		jz	short loc_42CDEC
		mov	eax, [ebp-2Ch]
		cmp	eax, 3
		jnz	short loc_42CDEC
		mov	edx, [ebp-2Ch]
		mov	eax, [ebp-24h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aRsa_1 ; "rsa"
		call	memcmp
		test	eax, eax
		jz	short loc_42CDFD

loc_42CDEC:				; CODE XREF: .text:0042CDC4j
					; .text:0042CDCCj
		mov	dword ptr [esp], 29h
		call	sub_42C143
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CDFD:				; CODE XREF: .text:0042CDEAj
		mov	eax, [ebp-30h]
		mov	[ebp-18h], eax
		jmp	loc_42CFB2
; ---------------------------------------------------------------------------

loc_42CE08:				; CODE XREF: .text:0042CFF7j
		mov	eax, [ebp-24h]
		test	eax, eax
		jz	short loc_42CE20
		mov	dword ptr [esp], 68h
		call	sub_42C143
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CE20:				; CODE XREF: .text:0042CE0Dj
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-2Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-24h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-30h]
		mov	[esp+8], eax
		lea	eax, [ebp-28h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42CE60
		mov	eax, [ebp-14h]
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CE60:				; CODE XREF: .text:0042CE56j
		mov	eax, [ebp-24h]
		test	eax, eax
		jz	loc_42CF57
		mov	eax, [ebp-2Ch]
		cmp	eax, 1
		jnz	loc_42CF57
		mov	eax, [ebp-24h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 65h
		jz	short loc_42CE98
		cmp	eax, 6Eh
		jnz	short loc_42CEA6
		lea	eax, [ebp-34h]
		mov	[ebp-0Ch], eax
		lea	eax, [ebp-3Ch]
		mov	[ebp-10h], eax
		jmp	short loc_42CEB5
; ---------------------------------------------------------------------------

loc_42CE98:				; CODE XREF: .text:0042CE83j
		lea	eax, [ebp-38h]
		mov	[ebp-0Ch], eax
		lea	eax, [ebp-40h]
		mov	[ebp-10h], eax
		jmp	short loc_42CEB5
; ---------------------------------------------------------------------------

loc_42CEA6:				; CODE XREF: .text:0042CE88j
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-10h], 0
		nop

loc_42CEB5:				; CODE XREF: .text:0042CE96j
					; .text:0042CEA4j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42CED5
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42CED5
		mov	dword ptr [esp], 9Dh
		call	sub_42C143
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CED5:				; CODE XREF: .text:0042CEB9j
					; .text:0042CEC2j
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-2Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-24h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-30h]
		mov	[esp+8], eax
		lea	eax, [ebp-28h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42CF15
		mov	eax, [ebp-14h]
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CF15:				; CODE XREF: .text:0042CF0Bj
		mov	eax, [ebp-24h]
		test	eax, eax
		jz	short loc_42CF57
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42CF57
		jmp	short loc_42CF36
; ---------------------------------------------------------------------------

loc_42CF24:				; CODE XREF: .text:0042CF45j
		mov	eax, [ebp-2Ch]
		sub	eax, 1
		mov	[ebp-2Ch], eax
		mov	eax, [ebp-24h]
		add	eax, 1
		mov	[ebp-24h], eax

loc_42CF36:				; CODE XREF: .text:0042CF22j
		mov	eax, [ebp-2Ch]
		test	eax, eax
		jz	short loc_42CF47
		mov	eax, [ebp-24h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42CF24

loc_42CF47:				; CODE XREF: .text:0042CF3Bj
		mov	edx, [ebp-24h]
		mov	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	edx, [ebp-2Ch]
		mov	eax, [ebp-10h]
		mov	[eax], edx

loc_42CF57:				; CODE XREF: .text:0042CE65j
					; .text:0042CE71j ...
		mov	eax, [ebp-30h]
		mov	[ebp-1Ch], eax

loc_42CF5D:				; CODE XREF: .text:0042CFA2j
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-2Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-24h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-30h]
		mov	[esp+8], eax
		lea	eax, [ebp-28h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_42CFA4
		mov	eax, [ebp-30h]
		test	eax, eax
		jz	short loc_42CFA4
		mov	eax, [ebp-30h]
		cmp	eax, [ebp-1Ch]
		jge	short loc_42CF5D

loc_42CFA4:				; CODE XREF: .text:0042CF93j
					; .text:0042CF9Aj
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42CFB2
		mov	eax, [ebp-14h]
		jmp	locret_42D057
; ---------------------------------------------------------------------------

loc_42CFB2:				; CODE XREF: .text:0042CE03j
					; .text:0042CFA8j
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-2Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-24h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-30h]
		mov	[esp+8], eax
		lea	eax, [ebp-28h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_42CFFD
		mov	eax, [ebp-30h]
		test	eax, eax
		jz	short loc_42CFFD
		mov	eax, [ebp-30h]
		cmp	eax, [ebp-18h]
		jge	loc_42CE08

loc_42CFFD:				; CODE XREF: .text:0042CFE8j
					; .text:0042CFEFj
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42D008
		mov	eax, [ebp-14h]
		jmp	short locret_42D057
; ---------------------------------------------------------------------------

loc_42D008:				; CODE XREF: .text:0042D001j
		mov	eax, [ebp-34h]
		test	eax, eax
		jz	short loc_42D024
		mov	eax, [ebp-3Ch]
		test	eax, eax
		jz	short loc_42D024
		mov	eax, [ebp-38h]
		test	eax, eax
		jz	short loc_42D024
		mov	eax, [ebp-40h]
		test	eax, eax
		jnz	short loc_42D032

loc_42D024:				; CODE XREF: .text:0042D00Dj
					; .text:0042D014j ...
		mov	dword ptr [esp], 6
		call	sub_42C143
		jmp	short locret_42D057
; ---------------------------------------------------------------------------

loc_42D032:				; CODE XREF: .text:0042D022j
		mov	edx, [ebp-34h]
		mov	eax, [ebp+10h]
		mov	[eax], edx
		mov	edx, [ebp-3Ch]
		mov	eax, [ebp+14h]
		mov	[eax], edx
		mov	edx, [ebp-38h]
		mov	eax, [ebp+18h]
		mov	[eax], edx
		mov	edx, [ebp-40h]
		mov	eax, [ebp+1Ch]
		mov	[eax], edx
		mov	eax, 0

locret_42D057:				; CODE XREF: .text:0042CCBCj
					; .text:0042CCFCj ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	dword ptr [ebp-20h], 0
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-1Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42D0BB
		mov	eax, [ebp-0Ch]
		jmp	locret_42D2AB
; ---------------------------------------------------------------------------

loc_42D0BB:				; CODE XREF: .text:0042D0B1j
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-1Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42D0FB
		mov	eax, [ebp-0Ch]
		jmp	locret_42D2AB
; ---------------------------------------------------------------------------

loc_42D0FB:				; CODE XREF: .text:0042D0F1j
		mov	eax, [ebp-14h]
		test	eax, eax
		jz	short loc_42D128
		mov	eax, [ebp-1Ch]
		cmp	eax, 0Ah
		jnz	short loc_42D128
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aPublicKey_3 ; "public-key"
		call	memcmp
		test	eax, eax
		jz	short loc_42D139

loc_42D128:				; CODE XREF: .text:0042D100j
					; .text:0042D108j
		mov	dword ptr [esp], 6
		call	sub_42C143
		jmp	locret_42D2AB
; ---------------------------------------------------------------------------

loc_42D139:				; CODE XREF: .text:0042D126j
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-1Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42D179
		mov	eax, [ebp-0Ch]
		jmp	locret_42D2AB
; ---------------------------------------------------------------------------

loc_42D179:				; CODE XREF: .text:0042D16Fj
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-1Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_431B5A
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42D1B9
		mov	eax, [ebp-0Ch]
		jmp	locret_42D2AB
; ---------------------------------------------------------------------------

loc_42D1B9:				; CODE XREF: .text:0042D1AFj
		mov	eax, [ebp-14h]
		test	eax, eax
		jnz	short loc_42D1D1
		mov	dword ptr [esp], 6
		call	sub_42C143
		jmp	locret_42D2AB
; ---------------------------------------------------------------------------

loc_42D1D1:				; CODE XREF: .text:0042D1BEj
		mov	eax, [ebp-1Ch]
		cmp	eax, 3
		jnz	short loc_42D205
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aRsa_1 ; "rsa"
		call	memcmp
		test	eax, eax
		jnz	short loc_42D205
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 1
		jmp	loc_42D2A6
; ---------------------------------------------------------------------------

loc_42D205:				; CODE XREF: .text:0042D1D7j
					; .text:0042D1F5j
		mov	eax, [ebp-1Ch]
		cmp	eax, 3
		jnz	short loc_42D236
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aDsa_0 ; "dsa"
		call	memcmp
		test	eax, eax
		jnz	short loc_42D236
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 11h
		jmp	short loc_42D2A6
; ---------------------------------------------------------------------------

loc_42D236:				; CODE XREF: .text:0042D20Bj
					; .text:0042D229j
		mov	eax, [ebp-1Ch]
		cmp	eax, 3
		jnz	short loc_42D267
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aElg_0 ; "elg"
		call	memcmp
		test	eax, eax
		jnz	short loc_42D267
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 14h
		jmp	short loc_42D2A6
; ---------------------------------------------------------------------------

loc_42D267:				; CODE XREF: .text:0042D23Cj
					; .text:0042D25Aj
		mov	eax, [ebp-1Ch]
		cmp	eax, 5
		jnz	short loc_42D298
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aEcdsa ; "ecdsa"
		call	memcmp
		test	eax, eax
		jnz	short loc_42D298
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 12Dh
		jmp	short loc_42D2A6
; ---------------------------------------------------------------------------

loc_42D298:				; CODE XREF: .text:0042D26Dj
					; .text:0042D28Bj
		mov	dword ptr [esp], 4
		call	sub_42C143
		jmp	short locret_42D2AB
; ---------------------------------------------------------------------------

loc_42D2A6:				; CODE XREF: .text:0042D200j
					; .text:0042D234j ...
		mov	eax, 0

locret_42D2AB:				; CODE XREF: .text:0042D0B6j
					; .text:0042D0F6j ...
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D2B0	proc near		; CODE XREF: sub_42D2D7+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_42D2D0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_42D2D5
; ---------------------------------------------------------------------------

loc_42D2D0:				; CODE XREF: sub_42D2B0+7j
		mov	eax, 0

loc_42D2D5:				; CODE XREF: sub_42D2B0+1Ej
		pop	ebp
		retn
sub_42D2B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D2D7	proc near		; CODE XREF: sub_42D2F2+14p
					; sub_42D30D+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_42D2B0
		leave
		retn
sub_42D2D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D2F2	proc near		; CODE XREF: sub_42D880+C3p
					; sub_42D880+17Ep ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_42D2D7
		leave
		retn
sub_42D2F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D30D	proc near		; CODE XREF: sub_42DD35+73Cp
					; sub_42DD35+78Bp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_42D2D7
		leave
		retn
sub_42D30D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42D322(LPCSTR)
sub_42D322	proc near		; CODE XREF: sub_430C9C+CFp

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42D322	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42D340(HMODULE, LPCSTR)
sub_42D340	proc near		; CODE XREF: sub_430C9C+EBp

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_42D37E
		cmp	[ebp+arg_4], 0
		jz	short loc_42D37E
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42D379
		mov	eax, 0
		jmp	short locret_42D383
; ---------------------------------------------------------------------------

loc_42D379:				; CODE XREF: sub_42D340+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_42D383
; ---------------------------------------------------------------------------

loc_42D37E:				; CODE XREF: sub_42D340+Aj
					; sub_42D340+10j
		mov	eax, 0

locret_42D383:				; CODE XREF: sub_42D340+37j
					; sub_42D340+3Cj
		leave
		retn
sub_42D340	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42D385(HANDLE)
sub_42D385	proc near		; CODE XREF: sub_430C9C+104p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_42D3A8
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_42D3AD
; ---------------------------------------------------------------------------

loc_42D3A8:				; CODE XREF: sub_42D385+Aj
		mov	eax, 0FFFFFFFFh

locret_42D3AD:				; CODE XREF: sub_42D385+21j
		leave
		retn
sub_42D385	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D3AF	proc near		; CODE XREF: sub_42D422+70p
					; sub_42D5F2+93p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_42D3F4
; ---------------------------------------------------------------------------

loc_42D3B4:				; CODE XREF: sub_42D3AF+57j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_42D3EC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_42D3D8
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_42D3EC

loc_42D3D8:				; CODE XREF: sub_42D3AF+1Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_42D408
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_42D408

loc_42D3EC:				; CODE XREF: sub_42D3AF+13j
					; sub_42D3AF+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_42D3F4:				; CODE XREF: sub_42D3AF+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42D408
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42D3B4

loc_42D408:				; CODE XREF: sub_42D3AF+31j
					; sub_42D3AF+3Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		pop	ebp
		retn
sub_42D3AF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D422	proc near		; CODE XREF: sub_42D507+23p
					; sub_42D507+6Ap ...

hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_42D451
		mov	[esp+28h+var_20], 0E2h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hObject], offset aFname ; "fname"
		call	sub_43BB20

loc_42D451:				; CODE XREF: sub_42D422+11j
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42D46D
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aFd_cache_inval ; "fd_cache_invalidate (%s)\n"
		call	sub_435C1A

loc_42D46D:				; CODE XREF: sub_42D422+36j
		mov	eax, ds:dword_449364
		mov	[ebp+var_C], eax
		jmp	short loc_42D4EA
; ---------------------------------------------------------------------------

loc_42D477:				; CODE XREF: sub_42D422+CCj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_42D4E2
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+hObject], edx
		call	sub_42D3AF
		test	eax, eax
		jnz	short loc_42D4E2
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42D4BA
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aDidS	; "		   did (%s)\n"
		call	sub_435C1A

loc_42D4BA:				; CODE XREF: sub_42D422+80j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		test	eax, eax
		jnz	short loc_42D4D8
		mov	[ebp+var_10], 0FFFFFFFFh

loc_42D4D8:				; CODE XREF: sub_42D422+ADj
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh

loc_42D4E2:				; CODE XREF: sub_42D422+5Ej
					; sub_42D422+77j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_42D4EA:				; CODE XREF: sub_42D422+53j
		cmp	[ebp+var_C], 0
		jnz	short loc_42D477
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42D422	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D4F5	proc near		; CODE XREF: sub_42F5AC+2A2p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_42D4F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42D507(LPCSTR	lpFileName, char *)
sub_42D507	proc near		; CODE XREF: sub_42D757+122p
					; .text:0042F2F5p ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
dwDesiredAccess	= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Val], 2Bh ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_42D554
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_42D422
		test	eax, eax
		jz	short loc_42D53D
		mov	eax, 0FFFFFFFFh
		jmp	locret_42D5F0
; ---------------------------------------------------------------------------

loc_42D53D:				; CODE XREF: sub_42D507+2Aj
		mov	[ebp+dwDesiredAccess], 0C0000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 3
		jmp	short loc_42D5AD
; ---------------------------------------------------------------------------

loc_42D554:				; CODE XREF: sub_42D507+1Bj
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_42D598
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_42D422
		test	eax, eax
		jz	short loc_42D581
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42D5F0
; ---------------------------------------------------------------------------

loc_42D581:				; CODE XREF: sub_42D507+71j
		mov	[ebp+dwDesiredAccess], 40000000h
		mov	[ebp+var_10], 2
		mov	[ebp+var_14], 2
		jmp	short loc_42D5AD
; ---------------------------------------------------------------------------

loc_42D598:				; CODE XREF: sub_42D507+62j
		mov	[ebp+dwDesiredAccess], 80000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 1

loc_42D5AD:				; CODE XREF: sub_42D507+4Bj
					; sub_42D507+8Fj
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	80h ; dwFlagsAndAttributes
		mov	eax, [ebp+var_10]
		mov	[esp+38h+dwCreationDisposition], eax ; dwCreationDisposition
		mov	[esp+38h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	eax, [ebp+var_14]
		mov	[esp+38h+dwShareMode], eax ; dwShareMode
		mov	eax, [ebp+dwDesiredAccess]
		mov	[esp+38h+Val], eax ; dwDesiredAccess
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax ; lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_42D5F0:				; CODE XREF: sub_42D507+31j
					; sub_42D507+78j
		leave
		retn
sub_42D507	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42D5F2(char *, HANDLE)
sub_42D5F2	proc near		; CODE XREF: sub_42D880+297p

hObject		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_4], 0
		jnz	short loc_42D61B
		mov	[esp+38h+var_30], 174h ; int
		mov	[esp+38h+Source], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+38h+hObject], offset aFp ;	"fp"
		call	sub_43BB20

loc_42D61B:				; CODE XREF: sub_42D5F2+Bj
		cmp	[ebp+arg_0], 0
		jz	short loc_42D62B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42D660

loc_42D62B:				; CODE XREF: sub_42D5F2+2Dj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	loc_42D74E
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_close ; "fd_cache_close (%d) real\n"
		call	sub_435C1A
		jmp	loc_42D74E
; ---------------------------------------------------------------------------

loc_42D660:				; CODE XREF: sub_42D5F2+37j
		mov	eax, ds:dword_449364
		mov	[ebp+var_C], eax
		jmp	short loc_42D6C4
; ---------------------------------------------------------------------------

loc_42D66A:				; CODE XREF: sub_42D5F2+D6j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42D6BC
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax
		mov	[esp+38h+hObject], edx
		call	sub_42D3AF
		test	eax, eax
		jnz	short loc_42D6BC
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	loc_42D751
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_0 ; "fd_cache_close (%s) used existing slot\"...
		call	sub_435C1A
		jmp	loc_42D751
; ---------------------------------------------------------------------------

loc_42D6BC:				; CODE XREF: sub_42D5F2+81j
					; sub_42D5F2+9Aj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_42D6C4:				; CODE XREF: sub_42D5F2+76j
		cmp	[ebp+var_C], 0
		jnz	short loc_42D66A
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42D6E6
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_1 ; "fd_cache_close (%s) new slot created\n"
		call	sub_435C1A

loc_42D6E6:				; CODE XREF: sub_42D5F2+DFj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Source], eax
		mov	[esp+38h+hObject], 1
		call	gcry_xcalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+hObject], edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	edx, ds:dword_449364
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	ds:dword_449364, eax
		jmp	short loc_42D752
; ---------------------------------------------------------------------------

loc_42D74E:				; CODE XREF: sub_42D5F2+50j
					; sub_42D5F2+69j
		nop
		jmp	short loc_42D752
; ---------------------------------------------------------------------------

loc_42D751:				; CODE XREF: sub_42D5F2+ACj
					; sub_42D5F2+C5j
		nop

loc_42D752:				; CODE XREF: sub_42D5F2+15Aj
					; sub_42D5F2+15Dj
		mov	edi, [ebp+var_4]
		leave
		retn
sub_42D5F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42D757(LPCSTR	lpFileName, char *)
sub_42D757	proc near		; CODE XREF: sub_42EDF1+A0p

hFile		= dword	ptr -28h
lDistanceToMove	= dword	ptr -24h
lpDistanceToMoveHigh= dword ptr	-20h
dwMoveMethod	= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+lpFileName], 0
		jnz	short loc_42D77F
		mov	[esp+28h+lpDistanceToMoveHigh],	19Dh ; int
		mov	[esp+28h+lDistanceToMove], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hFile], offset	aFname ; "fname"
		call	sub_43BB20

loc_42D77F:				; CODE XREF: sub_42D757+Aj
		mov	eax, ds:dword_449364
		mov	[ebp+var_C], eax
		jmp	loc_42D846
; ---------------------------------------------------------------------------

loc_42D78C:				; CODE XREF: sub_42D757+F3j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	loc_42D83E
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax
		mov	[esp+28h+hFile], edx
		call	sub_42D3AF
		test	eax, eax
		jnz	loc_42D83E
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42D7E7
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_openS	; "fd_cache_open (%s) using cached fp\n"
		call	sub_435C1A

loc_42D7E7:				; CODE XREF: sub_42D757+7Bj
		mov	[esp+28h+dwMoveMethod],	0 ; dwMoveMethod
		mov	[esp+28h+lpDistanceToMoveHigh],	0 ; lpDistanceToMoveHigh
		mov	[esp+28h+lDistanceToMove], 0 ; lDistanceToMove
		mov	eax, [ebp+var_10]
		mov	[esp+28h+hFile], eax ; hFile
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42D839
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+lpDistanceToMoveHigh],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aRewindFileFail	; "rewind file failed on handle	%p: ec=%d\"...
		call	sub_435B7D
		mov	[ebp+var_10], 0FFFFFFFFh

loc_42D839:				; CODE XREF: sub_42D757+BBj
		mov	eax, [ebp+var_10]
		jmp	short locret_42D87E
; ---------------------------------------------------------------------------

loc_42D83E:				; CODE XREF: sub_42D757+3Ej
					; sub_42D757+5Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_42D846:				; CODE XREF: sub_42D757+30j
		cmp	[ebp+var_C], 0
		jnz	loc_42D78C
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42D86C
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_ope_0	; "fd_cache_open (%s) not cached\n"
		call	sub_435C1A

loc_42D86C:				; CODE XREF: sub_42D757+100j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lDistanceToMove], eax ; char *
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+hFile], eax ; lpFileName
		call	sub_42D507

locret_42D87E:				; CODE XREF: sub_42D757+E5j
		leave
		retn
sub_42D757	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42D880(int, int, int,	LPVOID,	int)
sub_42D880	proc near		; CODE XREF: sub_42EDF1+175p
					; sub_42EDF1+19Fp ...

hFile		= dword	ptr -58h
lpBuffer	= dword	ptr -54h
nNumberOfBytesToRead= dword ptr	-50h
lpNumberOfBytesRead= dword ptr -4Ch
lpOverlapped	= dword	ptr -48h
NumberOfBytesWritten= dword ptr	-30h
NumberOfBytesRead= dword ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
nNumberOfBytesToWrite= dword ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_42D997
		cmp	[ebp+var_20], 0
		jnz	short loc_42D8D6
		mov	[esp+58h+nNumberOfBytesToRead],	226h ; int
		mov	[esp+58h+lpBuffer], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+hFile], offset	aSize ;	"size"
		call	sub_43BB20

loc_42D8D6:				; CODE XREF: sub_42D880+38j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_42D8F5
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_42DB27
; ---------------------------------------------------------------------------

loc_42D8F5:				; CODE XREF: sub_42D880+5Ej
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesRead]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesRead
		mov	eax, [ebp+var_20]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToRead
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:ReadFile
		call	eax ; ReadFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_42D96A
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 6Dh
		jz	short loc_42D98A
		mov	eax, [ebp+var_24]
		mov	[esp+58h+hFile], eax
		call	sub_42D2F2
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_24]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSReadErrorEcD ; "%s: read error: ec=%d\n"
		call	sub_435B7D
		jmp	short loc_42D98A
; ---------------------------------------------------------------------------

loc_42D96A:				; CODE XREF: sub_42D880+ABj
		mov	eax, [ebp+NumberOfBytesRead]
		test	eax, eax
		jnz	short loc_42D984
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_42D98A
; ---------------------------------------------------------------------------

loc_42D984:				; CODE XREF: sub_42D880+EFj
		mov	eax, [ebp+NumberOfBytesRead]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_42D98A:				; CODE XREF: sub_42D880+BBj
					; sub_42D880+E8j ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_42DB27
; ---------------------------------------------------------------------------

loc_42D997:				; CODE XREF: sub_42D880+2Ej
		cmp	[ebp+arg_4], 4
		jnz	loc_42DA53
		cmp	[ebp+var_20], 0
		jz	loc_42DA46
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_42D9B7:				; CODE XREF: sub_42D880+1B5j
		cmp	[ebp+var_20], 0
		jz	short loc_42DA25
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesWritten
		mov	eax, [ebp+nNumberOfBytesToWrite]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToWrite
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:WriteFile
		call	eax ; WriteFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_42DA25
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+hFile], eax
		call	sub_42D2F2
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_28]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSWriteErrorEcD	; "%s: write error: ec=%d\n"
		call	sub_435B7D
		jmp	short loc_42DA37
; ---------------------------------------------------------------------------

loc_42DA25:				; CODE XREF: sub_42D880+13Bj
					; sub_42D880+16Cj
		mov	eax, [ebp+NumberOfBytesWritten]
		add	[ebp+var_14], eax
		mov	eax, [ebp+NumberOfBytesWritten]
		sub	[ebp+nNumberOfBytesToWrite], eax
		cmp	[ebp+nNumberOfBytesToWrite], 0
		jnz	short loc_42D9B7

loc_42DA37:				; CODE XREF: sub_42D880+1A3j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_42DA46:				; CODE XREF: sub_42D880+125j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_42DB27
; ---------------------------------------------------------------------------

loc_42DA53:				; CODE XREF: sub_42D880+11Bj
		cmp	[ebp+arg_4], 1
		jnz	short loc_42DA7C
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	loc_42DB27
; ---------------------------------------------------------------------------

loc_42DA7C:				; CODE XREF: sub_42D880+1D7j
		cmp	[ebp+arg_4], 5
		jnz	short loc_42DA90
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aFile_filterFd ; "file_filter(fd)"
		jmp	loc_42DB27
; ---------------------------------------------------------------------------

loc_42DA90:				; CODE XREF: sub_42D880+200j
		cmp	[ebp+arg_4], 2
		jnz	loc_42DB27
		mov	[esp+58h+hFile], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_42DB1C
		mov	[esp+58h+hFile], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_42DB1C
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42DAEC
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSCloseHandleP ; "%s: close handle %p\n"
		call	sub_435C1A

loc_42DAEC:				; CODE XREF: sub_42D880+24Dj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_42DB1C
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_42DB08
		mov	eax, [ebp+var_18]
		add	eax, 14h
		jmp	short loc_42DB0D
; ---------------------------------------------------------------------------

loc_42DB08:				; CODE XREF: sub_42D880+27Ej
		mov	eax, 0

loc_42DB0D:				; CODE XREF: sub_42D880+286j
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+lpBuffer], edx	; HANDLE
		mov	[esp+58h+hFile], eax ; char *
		call	sub_42D5F2

loc_42DB1C:				; CODE XREF: sub_42D880+22Ej
					; sub_42D880+244j ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hFile], eax
		call	gcry_free

loc_42DB27:				; CODE XREF: sub_42D880+70j
					; sub_42D880+112j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42D880	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42DB2C(int, int, int,	char *,	int)
sub_42DB2C	proc near		; CODE XREF: .text:0042F1D2p
					; .text:0042F1FCp
					; DATA XREF: ...

s		= dword	ptr -48h
buf		= dword	ptr -44h
len		= dword	ptr -40h
flags		= dword	ptr -3Ch
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_42DC23
		cmp	[ebp+var_1C], 0
		jnz	short loc_42DB7A
		mov	[esp+48h+len], 2CEh ; int
		mov	[esp+48h+buf], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+s], offset aSize ; "size"
		call	sub_43BB20

loc_42DB7A:				; CODE XREF: sub_42DB2C+30j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_42DB99
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_42DD30
; ---------------------------------------------------------------------------

loc_42DB99:				; CODE XREF: sub_42DB2C+56j
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+arg_C]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:recv
		call	eax ; recv
		sub	esp, 10h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_42DBF7
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_24],	eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+s], eax
		call	sub_42D2F2
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketReadErro ; "socket read error: ec=%d\n"
		call	sub_435B7D
		jmp	short loc_42DC16
; ---------------------------------------------------------------------------

loc_42DBF7:				; CODE XREF: sub_42DB2C+9Cj
		cmp	[ebp+var_20], 0
		jnz	short loc_42DC10
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_42DC16
; ---------------------------------------------------------------------------

loc_42DC10:				; CODE XREF: sub_42DB2C+CFj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax

loc_42DC16:				; CODE XREF: sub_42DB2C+C9j
					; sub_42DB2C+E2j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	loc_42DD30
; ---------------------------------------------------------------------------

loc_42DC23:				; CODE XREF: sub_42DB2C+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_42DCCC
		cmp	[ebp+var_1C], 0
		jz	loc_42DCC2
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax

loc_42DC43:				; CODE XREF: sub_42DB2C+185j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+var_14]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0FFFFFFFFh
		jnz	short loc_42DCA1
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_2C],	eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+s], eax
		call	sub_42D2F2
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketWriteErr ; "socket write error: ec=%d\n"
		call	sub_435B7D
		jmp	short loc_42DCB3
; ---------------------------------------------------------------------------

loc_42DCA1:				; CODE XREF: sub_42DB2C+146j
		mov	eax, [ebp+var_28]
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_28]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42DC43

loc_42DCB3:				; CODE XREF: sub_42DB2C+173j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax

loc_42DCC2:				; CODE XREF: sub_42DB2C+105j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	short loc_42DD30
; ---------------------------------------------------------------------------

loc_42DCCC:				; CODE XREF: sub_42DB2C+FBj
		cmp	[ebp+arg_4], 1
		jnz	short loc_42DCF2
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	short loc_42DD30
; ---------------------------------------------------------------------------

loc_42DCF2:				; CODE XREF: sub_42DB2C+1A4j
		cmp	[ebp+arg_4], 5
		jnz	short loc_42DD03
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aSock_filter ; "sock_filter"
		jmp	short loc_42DD30
; ---------------------------------------------------------------------------

loc_42DD03:				; CODE XREF: sub_42DB2C+1CAj
		cmp	[ebp+arg_4], 2
		jnz	short loc_42DD30
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_42DD25
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_42DD25:				; CODE XREF: sub_42DB2C+1E5j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+s], eax
		call	gcry_free

loc_42DD30:				; CODE XREF: sub_42DB2C+68j
					; sub_42DB2C+F2j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42DB2C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42DD35	proc near		; DATA XREF: .text:004311F1o
					; .text:0043122Ao

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [ebp+var_2C],	eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_42E301
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42DD90
		mov	[esp+48h+Size],	32Dh ; int
		mov	[esp+48h+Src], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aSize ; "size"
		call	sub_43BB20

loc_42DD90:				; CODE XREF: sub_42DD35+3Dj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_42E2D8
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_42E2D8
; ---------------------------------------------------------------------------

loc_42DDAA:				; CODE XREF: sub_42DD35+5ADj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_42E2BE
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		cmp	eax, 2
		jnz	short loc_42DDE3
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_42E2EA
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_42E2EA
; ---------------------------------------------------------------------------

loc_42DDE3:				; CODE XREF: sub_42DD35+8Cj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_42E208
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_42DE10
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+18h]
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+18h], 0
		jmp	short loc_42DE8E
; ---------------------------------------------------------------------------

loc_42DE10:				; CODE XREF: sub_42DD35+C4j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_42DE2A
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_42DE37

loc_42DE2A:				; CODE XREF: sub_42DD35+E3j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_430666
		jmp	short loc_42DE6D
; ---------------------------------------------------------------------------

loc_42DE37:				; CODE XREF: sub_42DD35+F3j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_42DE6D:				; CODE XREF: sub_42DD35+100j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_42DE8E
		mov	[esp+48h+Dst], offset aBlock_filter1s ;	"block_filter: 1st length byte missing\n"
		call	sub_435B7D
		mov	[ebp+var_14], 59h
		jmp	loc_42E2F4
; ---------------------------------------------------------------------------

loc_42DE8E:				; CODE XREF: sub_42DD35+D9j
					; sub_42DD35+13Fj
		cmp	[ebp+var_10], 0BFh
		jg	short loc_42DED8
		mov	edx, [ebp+var_10]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_42E2BE
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_42E2ED
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_42E2ED
; ---------------------------------------------------------------------------

loc_42DED8:				; CODE XREF: sub_42DD35+160j
		cmp	[ebp+var_10], 0DFh
		jg	loc_42DFC5
		mov	eax, [ebp+var_10]
		sub	eax, 0C0h
		shl	eax, 8
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_42DF12
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_42DF1F

loc_42DF12:				; CODE XREF: sub_42DD35+1CBj
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_430666
		jmp	short loc_42DF55
; ---------------------------------------------------------------------------

loc_42DF1F:				; CODE XREF: sub_42DD35+1DBj
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_42DF55:				; CODE XREF: sub_42DD35+1E8j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_42DF76
		mov	[esp+48h+Dst], offset aBlock_filter2n ;	"block_filter: 2nd length byte missing\n"
		call	sub_435B7D
		mov	[ebp+var_14], 59h
		jmp	loc_42E2F4
; ---------------------------------------------------------------------------

loc_42DF76:				; CODE XREF: sub_42DD35+227j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	eax, edx
		lea	edx, [eax+0C0h]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_42E2BE
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_42E2F0
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_42E2F0
; ---------------------------------------------------------------------------

loc_42DFC5:				; CODE XREF: sub_42DD35+1AAj
		cmp	[ebp+var_10], 0FFh
		jnz	loc_42E1E8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_42DFEC
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_42DFFC

loc_42DFEC:				; CODE XREF: sub_42DD35+2A5j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_430666
		shl	eax, 18h
		jmp	short loc_42E035
; ---------------------------------------------------------------------------

loc_42DFFC:				; CODE XREF: sub_42DD35+2B5j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 18h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_42E035:				; CODE XREF: sub_42DD35+2C5j
		mov	edx, dword ptr [ebp+var_2C]
		mov	[edx+4], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_42E05B
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_42E06B

loc_42E05B:				; CODE XREF: sub_42DD35+314j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_430666
		shl	eax, 10h
		jmp	short loc_42E0A4
; ---------------------------------------------------------------------------

loc_42E06B:				; CODE XREF: sub_42DD35+324j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_42E0A4:				; CODE XREF: sub_42DD35+334j
		mov	edx, ebx
		or	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_42E0CE
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_42E0DE

loc_42E0CE:				; CODE XREF: sub_42DD35+387j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_430666
		shl	eax, 8
		jmp	short loc_42E117
; ---------------------------------------------------------------------------

loc_42E0DE:				; CODE XREF: sub_42DD35+397j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_42E117:				; CODE XREF: sub_42DD35+3A7j
		mov	edx, ebx
		or	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_42E13B
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_42E148

loc_42E13B:				; CODE XREF: sub_42DD35+3F4j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_430666
		jmp	short loc_42E17E
; ---------------------------------------------------------------------------

loc_42E148:				; CODE XREF: sub_42DD35+404j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_42E17E:				; CODE XREF: sub_42DD35+411j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_42E19F
		mov	[esp+48h+Dst], offset aBlock_filterIn ;	"block_filter: invalid 4 byte length\n"
		call	sub_435B7D
		mov	[ebp+var_14], 59h
		jmp	loc_42E2F4
; ---------------------------------------------------------------------------

loc_42E19F:				; CODE XREF: sub_42DD35+450j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		or	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_42E2BE
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_42E2F3
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_42E2F3
; ---------------------------------------------------------------------------

loc_42E1E8:				; CODE XREF: sub_42DD35+297j
		mov	eax, [ebp+var_10]
		and	eax, 1Fh
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		jmp	loc_42E2BE
; ---------------------------------------------------------------------------

loc_42E208:				; CODE XREF: sub_42DD35+B6j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 386h
		mov	[esp+48h+Dst], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_42E224:				; CODE XREF: sub_42DD35+59Dj
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		cmovbe	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43070F
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_34]
		jge	short loc_42E29B
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_42E266
		mov	[ebp+var_10], 0

loc_42E266:				; CODE XREF: sub_42DD35+528j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	edx, eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_C]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Size],	eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterPR ;	"block_filter %p: read error (size=%lu,a"...
		call	sub_435B7D
		mov	[ebp+var_14], 59h
		jmp	short loc_42E2BE
; ---------------------------------------------------------------------------

loc_42E29B:				; CODE XREF: sub_42DD35+522j
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		sub	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_1C], eax

loc_42E2BE:				; CODE XREF: sub_42DD35+7Dj
					; sub_42DD35+17Dj ...
		cmp	[ebp+var_14], 0
		jnz	short loc_42E2D8
		cmp	[ebp+var_C], 0
		jz	short loc_42E2D8
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_42E224

loc_42E2D8:				; CODE XREF: sub_42DD35+63j
					; sub_42DD35+70j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_42E2F4
		cmp	[ebp+var_C], 0
		jnz	loc_42DDAA
		jmp	short loc_42E2F4
; ---------------------------------------------------------------------------

loc_42E2EA:				; CODE XREF: sub_42DD35+9Cj
					; sub_42DD35+A9j
		nop
		jmp	short loc_42E2F4
; ---------------------------------------------------------------------------

loc_42E2ED:				; CODE XREF: sub_42DD35+191j
					; sub_42DD35+19Ej
		nop
		jmp	short loc_42E2F4
; ---------------------------------------------------------------------------

loc_42E2F0:				; CODE XREF: sub_42DD35+27Ej
					; sub_42DD35+28Bj
		nop
		jmp	short loc_42E2F4
; ---------------------------------------------------------------------------

loc_42E2F3:				; CODE XREF: sub_42DD35+4A1j
					; sub_42DD35+4AEj
		nop

loc_42E2F4:				; CODE XREF: sub_42DD35+154j
					; sub_42DD35+23Cj ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		jmp	loc_42E867
; ---------------------------------------------------------------------------

loc_42E301:				; CODE XREF: sub_42DD35+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_42E5AA
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_42E58E
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, [ebp+var_C]
		mov	[ebp+var_28], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		cmp	eax, 200h
		jbe	short loc_42E34E
		mov	[esp+48h+Size],	3A7h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflenOp_min_ ;	"a->buflen <= OP_MIN_PARTIAL_CHUNK"
		call	sub_43BB20

loc_42E34E:				; CODE XREF: sub_42DD35+5FBj
		cmp	[ebp+var_28], 1FFh
		ja	short loc_42E3B1
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_42E375
		mov	[esp+48h+Dst], 200h
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+10h], edx

loc_42E375:				; CODE XREF: sub_42DD35+62Aj
		mov	edx, [ebp+var_30]
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+14h], edx
		jmp	loc_42E867
; ---------------------------------------------------------------------------

loc_42E3B1:				; CODE XREF: sub_42DD35+620j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax

loc_42E3B7:				; CODE XREF: sub_42DD35+7ACj
		mov	[ebp+var_20], 400h
		mov	[ebp+var_10], 0Ah
		jmp	short loc_42E3CE
; ---------------------------------------------------------------------------

loc_42E3C7:				; CODE XREF: sub_42DD35+69Fj
		shl	[ebp+var_20], 1
		add	[ebp+var_10], 1

loc_42E3CE:				; CODE XREF: sub_42DD35+690j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_28]
		jbe	short loc_42E3C7
		mov	eax, [ebp+var_20]
		shr	eax, 1
		mov	[ebp+var_20], eax
		sub	[ebp+var_10], 1
		cmp	[ebp+var_10], 1Fh
		jle	short loc_42E404
		mov	[esp+48h+Size],	3BFh ; int
		mov	[esp+48h+Src], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aC0x1f ; "c <= 0x1f"
		call	sub_43BB20

loc_42E404:				; CODE XREF: sub_42DD35+6B1j
		or	[ebp+var_10], 0E0h
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43098D
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_42E489
		cmp	[ebp+var_24], 200h
		jz	short loc_42E451
		mov	[esp+48h+Size],	3C4h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNOp_min_partia ;	"n == OP_MIN_PARTIAL_CHUNK"
		call	sub_43BB20

loc_42E451:				; CODE XREF: sub_42DD35+6FEj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_430A32
		test	eax, eax
		jz	short loc_42E479
		call	sub_42D30D
		mov	[ebp+var_14], eax

loc_42E479:				; CODE XREF: sub_42DD35+73Aj
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax

loc_42E489:				; CODE XREF: sub_42DD35+6F5j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_20]
		jbe	short loc_42E49D
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax

loc_42E49D:				; CODE XREF: sub_42DD35+760j
		cmp	[ebp+var_24], 0
		jz	short loc_42E4C8
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_430A32
		test	eax, eax
		jz	short loc_42E4C8
		call	sub_42D30D
		mov	[ebp+var_14], eax

loc_42E4C8:				; CODE XREF: sub_42DD35+76Cj
					; sub_42DD35+789j
		mov	eax, [ebp+var_24]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42E4E7
		cmp	[ebp+var_28], 1FFh
		ja	loc_42E3B7

loc_42E4E7:				; CODE XREF: sub_42DD35+7A3j
		cmp	[ebp+var_14], 0
		jnz	loc_42E867
		cmp	[ebp+var_28], 0
		jz	loc_42E867
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_42E521
		mov	[esp+48h+Size],	3D5h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflen ; "!a->buflen"
		call	sub_43BB20

loc_42E521:				; CODE XREF: sub_42DD35+7CEj
		cmp	[ebp+var_28], 1FFh
		jbe	short loc_42E546
		mov	[esp+48h+Size],	3D6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNbytesOp_min_p ;	"nbytes	< OP_MIN_PARTIAL_CHUNK"
		call	sub_43BB20

loc_42E546:				; CODE XREF: sub_42DD35+7F3j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_42E564
		mov	[esp+48h+Dst], 200h
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+10h], edx

loc_42E564:				; CODE XREF: sub_42DD35+819j
		mov	edx, [ebp+var_18]
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+var_28]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		jmp	loc_42E867
; ---------------------------------------------------------------------------

loc_42E58E:				; CODE XREF: sub_42DD35+5DEj
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 3DFh
		mov	[esp+48h+Dst], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_42E5AA:				; CODE XREF: sub_42DD35+5D0j
		cmp	[ebp+arg_4], 1
		jnz	loc_42E637
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42E5D0
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aInitBlock_filt ;	"init block_filter %p\n"
		call	sub_435C1A

loc_42E5D0:				; CODE XREF: sub_42DD35+886j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_42E5E6
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+8], 0
		jmp	short loc_42E614
; ---------------------------------------------------------------------------

loc_42E5E6:				; CODE XREF: sub_42DD35+8A3j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_42E608
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+4], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+8], edx
		jmp	short loc_42E614
; ---------------------------------------------------------------------------

loc_42E608:				; CODE XREF: sub_42DD35+8B9j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+8], edx

loc_42E614:				; CODE XREF: sub_42DD35+8AFj
					; sub_42DD35+8D1j
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_42E867
; ---------------------------------------------------------------------------

loc_42E637:				; CODE XREF: sub_42DD35+879j
		cmp	[ebp+arg_4], 5
		jnz	short loc_42E64B
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax], offset	aBlock_filter_0	; "block_filter"
		jmp	loc_42E867
; ---------------------------------------------------------------------------

loc_42E64B:				; CODE XREF: sub_42DD35+906j
		cmp	[ebp+arg_4], 2
		jnz	loc_42E867
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	loc_42E82A
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_42E80E
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0BFh
		ja	short loc_42E69D
		mov	eax, [ebp+var_38]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43098D
		mov	[ebp+var_14], eax
		jmp	loc_42E790
; ---------------------------------------------------------------------------

loc_42E69D:				; CODE XREF: sub_42DD35+94Cj
		cmp	[ebp+var_38], 20BFh
		ja	short loc_42E6F6
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		shr	eax, 8
		add	eax, 0C0h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43098D
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_42E790
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43098D
		mov	[ebp+var_14], eax
		jmp	loc_42E790
; ---------------------------------------------------------------------------

loc_42E6F6:				; CODE XREF: sub_42DD35+96Fj
		mov	[esp+48h+Src], 0FFh
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43098D
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42E790
		mov	eax, [ebp+var_38]
		shr	eax, 18h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43098D
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42E790
		mov	eax, [ebp+var_38]
		shr	eax, 10h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43098D
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42E790
		mov	eax, [ebp+var_38]
		shr	eax, 8
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43098D
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42E790
		mov	eax, [ebp+var_38]
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43098D
		mov	[ebp+var_14], eax

loc_42E790:				; CODE XREF: sub_42DD35+963j
					; sub_42DD35+997j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_42E7BB
		cmp	[ebp+var_38], 0
		jz	short loc_42E7BB
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_38]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_430A32
		mov	[ebp+var_14], eax

loc_42E7BB:				; CODE XREF: sub_42DD35+A5Fj
					; sub_42DD35+A65j
		cmp	[ebp+var_14], 0
		jz	short loc_42E7EA
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dst], eax ; int
		call	strerror
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterWr ;	"block_filter: write error: %s\n"
		call	sub_435B7D
		call	sub_42D30D
		mov	[ebp+var_14], eax

loc_42E7EA:				; CODE XREF: sub_42DD35+A8Aj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_42E840
; ---------------------------------------------------------------------------

loc_42E80E:				; CODE XREF: sub_42DD35+936j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 423h
		mov	[esp+48h+Dst], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_42E82A:				; CODE XREF: sub_42DD35+928j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_42E840
		mov	[esp+48h+Dst], offset aBlock_filterPe ;	"block_filter: pending bytes!\n"
		call	sub_435B7D

loc_42E840:				; CODE XREF: sub_42DD35+AD7j
					; sub_42DD35+AFDj
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42E85C
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aFreeBlock_filt ;	"free block_filter %p\n"
		call	sub_435C1A

loc_42E85C:				; CODE XREF: sub_42DD35+B12j
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Dst], eax
		call	gcry_free

loc_42E867:				; CODE XREF: sub_42DD35+5C7j
					; sub_42DD35+677j ...
		mov	eax, [ebp+var_14]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_42DD35	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42E870	proc near		; CODE XREF: .text:0042E950p
					; sub_42F889+2CBp ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, ds:dword_449E34
		test	eax, eax
		jnz	loc_42E932
		jmp	loc_42E93C
; ---------------------------------------------------------------------------

loc_42E88B:				; CODE XREF: sub_42E870+C6j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], offset aNone_2 ; "[none]"
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_42E8D2
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_38], edx
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	[esp+48h+var_48], eax
		call	ecx

loc_42E8D2:				; CODE XREF: sub_42E870+31j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edi, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	esi, eax
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+38h]
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_42E8F4
		mov	eax, [ebp+var_20]
		jmp	short loc_42E8F9
; ---------------------------------------------------------------------------

loc_42E8F4:				; CODE XREF: sub_42E870+7Dj
		mov	eax, offset a?_1 ; "?"

loc_42E8F9:				; CODE XREF: sub_42E870+82j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_30], edi
		mov	[esp+48h+var_34], esi
		mov	[esp+48h+var_38], ebx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufChainD_DS ; "iobuf chain: %d.%d `%s' filter_eof=%d s"...
		call	sub_435C1A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_42E932:				; CODE XREF: sub_42E870+10j
		cmp	[ebp+arg_0], 0
		jnz	loc_42E88B

loc_42E93C:				; CODE XREF: sub_42E870+16j
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_42E870	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42E870
		mov	eax, 0
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42E95C	proc near		; CODE XREF: .text:0042EC86p
					; .text:0042ECA7p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 68h
		mov	[esp+28h+var_28], 1
		call	gcry_xcalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+28h], edx
		mov	eax, ds:dword_449374
		add	eax, 1
		mov	ds:dword_449374, eax
		mov	edx, ds:dword_449374
		mov	eax, [ebp+var_C]
		mov	[eax+54h], edx
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+58h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+60h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4Ch], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42E95C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42E9D9	proc near		; CODE XREF: .text:0041E3A2p
					; .text:0042EC44p

File		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	loc_42EB88
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_42EB88
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42EA41
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_closeP ; "iobuf_close -> %p\n"
		call	sub_435C1A

loc_42EA41:				; CODE XREF: sub_42E9D9+50j
		mov	eax, 0
		jmp	loc_42EB9B
; ---------------------------------------------------------------------------

loc_42EA4B:				; CODE XREF: sub_42E9D9+1B9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_42EA8D
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax
		call	sub_4304F8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42EA8D
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_flushFai ; "iobuf_flush failed on	close: %s\n"
		call	sub_435B7D

loc_42EA8D:				; CODE XREF: sub_42E9D9+83j
					; sub_42E9D9+97j
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42EAD1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_42EAA8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_42EAAD
; ---------------------------------------------------------------------------

loc_42EAA8:				; CODE XREF: sub_42E9D9+C5j
		mov	eax, offset a?_1 ; "?"

loc_42EAAD:				; CODE XREF: sub_42E9D9+CDj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+38h+var_2C], eax
		mov	[esp+38h+Size],	ecx
		mov	[esp+38h+Val], edx ; char
		mov	[esp+38h+File],	offset aIobufD_DCloseS ; "iobuf-%d.%d: close `%s'\n"
		call	sub_435C1A

loc_42EAD1:				; CODE XREF: sub_42E9D9+BBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_42EB31
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_14]
		mov	[esp+38h+var_28], ecx
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Val], 2
		mov	[esp+38h+File],	eax
		call	ebx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42EB31
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobufctrl_free ; "IOBUFCTRL_FREE failed	on close: %s\n"
		call	sub_435B7D

loc_42EB31:				; CODE XREF: sub_42E9D9+100j
					; sub_42E9D9+13Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		test	eax, eax
		jz	short loc_42EB77
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+File],	eax ; Dst
		call	memset
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+File],	eax
		call	gcry_free

loc_42EB77:				; CODE XREF: sub_42E9D9+16Ej
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax

loc_42EB88:				; CODE XREF: sub_42E9D9+19j
					; sub_42E9D9+27j
		cmp	[ebp+arg_0], 0
		jz	short loc_42EB98
		cmp	[ebp+var_C], 0
		jz	loc_42EA4B

loc_42EB98:				; CODE XREF: sub_42E9D9+1B3j
		mov	eax, [ebp+var_C]

loc_42EB9B:				; CODE XREF: sub_42E9D9+6Dj
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_42E9D9	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_42EBEB
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_42EBEB
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4310C6
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42EBEB
		mov	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42EBEB
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_xstrdup
		mov	[ebp-10h], eax

loc_42EBEB:				; CODE XREF: .text:0042EBB3j
					; .text:0042EBBDj ...
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_42EC38
; ---------------------------------------------------------------------------

loc_42EBF3:				; CODE XREF: .text:0042EC3Cj
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_42EC2F
		mov	eax, [ebp-0Ch]
		mov	ebx, [eax+40h]
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+50h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+44h]
		lea	ecx, [ebp-1Ch]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 6
		mov	[esp], eax
		call	ebx

loc_42EC2F:				; CODE XREF: .text:0042EBFBj
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+50h]
		mov	[ebp-0Ch], eax

loc_42EC38:				; CODE XREF: .text:0042EBF1j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42EBF3
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42E9D9
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_42EC68
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	remove
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_42EC68:				; CODE XREF: .text:0042EC50j
		mov	eax, [ebp-18h]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 3
		call	sub_42E95C
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	sub_42E95C
		mov	[ebp-0Ch], eax
		mov	edx, [ebp+8]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp+0Ch]
		mov	[eax+30h], edx
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_449368, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42ECE6(char *)
sub_42ECE6	proc near		; CODE XREF: sub_42ED5E+30p
					; sub_42EDF1+5Cp ...

Str		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449368
		test	eax, eax
		jz	short loc_42ED57
		cmp	[ebp+arg_0], 0
		jz	short loc_42ED57
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_42ED57
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 26h
		jnz	short loc_42ED57
		add	[ebp+arg_0], 2
		mov	[ebp+var_C], 0
		jmp	short loc_42ED23
; ---------------------------------------------------------------------------

loc_42ED1F:				; CODE XREF: sub_42ECE6+55j
		add	[ebp+var_C], 1

loc_42ED23:				; CODE XREF: sub_42ECE6+37j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42ED3D
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42ED1F

loc_42ED3D:				; CODE XREF: sub_42ECE6+48j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42ED57
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	atoi
		jmp	short locret_42ED5C
; ---------------------------------------------------------------------------

loc_42ED57:				; CODE XREF: sub_42ECE6+Dj
					; sub_42ECE6+13j ...
		mov	eax, 0FFFFFFFFh

locret_42ED5C:				; CODE XREF: sub_42ECE6+6Fj
		leave
		retn
sub_42ECE6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42ED5E(char *)
sub_42ED5E	proc near		; CODE XREF: .text:0041E2A9p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_42ED81
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_42ED88
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42ED88

loc_42ED81:				; CODE XREF: sub_42ED5E+Aj
		mov	eax, 1
		jmp	short locret_42ED9C
; ---------------------------------------------------------------------------

loc_42ED88:				; CODE XREF: sub_42ED5E+14j
					; sub_42ED5E+21j
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_42ECE6
		cmp	eax, 0FFFFFFFFh
		setnz	al
		movzx	eax, al

locret_42ED9C:				; CODE XREF: sub_42ED5E+28j
		leave
		retn
sub_42ED5E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jnz	short loc_42EDBA
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_42EDF1
		mov	[ebp-0Ch], eax
		jmp	short loc_42EDEC
; ---------------------------------------------------------------------------

loc_42EDBA:				; CODE XREF: .text:0042EDA8j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_dup
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_42EDD7
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_42EDEC
; ---------------------------------------------------------------------------

loc_42EDD7:				; CODE XREF: .text:0042EDCCj
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42EFD8
		mov	[ebp-0Ch], eax

loc_42EDEC:				; CODE XREF: .text:0042EDB8j
					; .text:0042EDD5j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42EDF1(LPCSTR	lpFileName)
sub_42EDF1	proc near		; CODE XREF: .text:0041E2C8p
					; .text:0042EDB0p

nStdHandle	= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_20], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+lpFileName], 0
		jz	short loc_42EE23
		mov	eax, [ebp+lpFileName]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_42EE47
		mov	eax, [ebp+lpFileName]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42EE47

loc_42EE23:				; CODE XREF: sub_42EDF1+19j
		mov	[esp+58h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	[ebp+lpFileName], offset aStdin_1 ; "[stdin]"
		mov	[ebp+var_10], 1
		jmp	short loc_42EEA9
; ---------------------------------------------------------------------------

loc_42EE47:				; CODE XREF: sub_42EDF1+23j
					; sub_42EDF1+30j
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; char *
		call	sub_42ECE6
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0FFFFFFFFh
		jz	short loc_42EE83
		mov	[esp+58h+Source], 0
		mov	eax, [ebp+var_14]
		mov	[esp+58h+nStdHandle], eax
		call	sub_43141E
		mov	[esp+58h+Source], offset aRb_1 ; "rb"
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_42EFD8
		jmp	loc_42EFD3
; ---------------------------------------------------------------------------

loc_42EE83:				; CODE XREF: sub_42EDF1+68j
		mov	[esp+58h+Source], offset aRb_1 ; "rb"
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; lpFileName
		call	sub_42D757
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_42EEA9
		mov	eax, 0
		jmp	loc_42EFD3
; ---------------------------------------------------------------------------

loc_42EEA9:				; CODE XREF: sub_42EDF1+54j
					; sub_42EDF1+ACj
		mov	[esp+58h+Source], 2000h
		mov	[esp+58h+nStdHandle], 1
		call	sub_42E95C
		mov	[ebp+var_18], eax
		mov	eax, [ebp+lpFileName]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp+58h+nStdHandle], eax
		call	gcry_xmalloc
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+14h]
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+Source], eax ;	Source
		mov	[esp+58h+nStdHandle], edx ; Dest
		call	strcpy
		cmp	[ebp+var_10], 0
		jnz	short loc_42EF2C
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4Ch], edx

loc_42EF2C:				; CODE XREF: sub_42EDF1+126j
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+40h], offset sub_42D880
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_18]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], edx ;	LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 5 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_42D880
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], 0 ; LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 1 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_42D880
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42EFD0
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	ecx, eax
		mov	eax, [ebp+var_18]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+54h]
		mov	[esp+58h+var_48], ecx
		mov	ecx, [ebp+lpFileName]
		mov	[esp+58h+var_4C], ecx
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+nStdHandle], offset aIobufD_DOpenSF ; "iobuf-%d.%d: open `%s' fd=%d\n"
		call	sub_435C1A

loc_42EFD0:				; CODE XREF: sub_42EDF1+1ABj
		mov	eax, [ebp+var_18]

loc_42EFD3:				; CODE XREF: sub_42EDF1+8Dj
					; sub_42EDF1+B3j
		mov	edi, [ebp+var_4]
		leave
		retn
sub_42EDF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42EFD8(int, char *)
sub_42EFD8	proc near		; CODE XREF: .text:0042EDE4p
					; sub_42EDF1+88p ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_42F002
		mov	eax, 2
		jmp	short loc_42F007
; ---------------------------------------------------------------------------

loc_42F002:				; CODE XREF: sub_42EFD8+21j
		mov	eax, 1

loc_42F007:				; CODE XREF: sub_42EFD8+28j
		mov	[esp+38h+Val], 2000h
		mov	[esp+38h+Str], eax
		call	sub_42E95C
		mov	[ebp+var_10], eax
		mov	[esp+38h+Str], 2Ch
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aFdD ; "[fd	%d]"
		mov	edx, [ebp+var_14]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; Format
		mov	[esp+38h+Str], ecx ; Dest
		call	sprintf
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+40h], offset sub_42D880
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_10]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], edx ;	LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 5 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_42D880
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 0 ; LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 1 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_42D880
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42F0F5
		mov	eax, [ebp+var_14]
		lea	ecx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+54h]
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aIobufD_DFdopen ;	"iobuf-%d.%d: fdopen `%s'\n"
		call	sub_435C1A

loc_42F0F5:				; CODE XREF: sub_42EFD8+F1j
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+Val], 3
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_42F5AC
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42EFD8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	dword ptr [esp+4], 77h
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_42F141
		mov	eax, 2
		jmp	short loc_42F146
; ---------------------------------------------------------------------------

loc_42F141:				; CODE XREF: .text:0042F138j
		mov	eax, 1

loc_42F146:				; CODE XREF: .text:0042F13Fj
		mov	dword ptr [esp+4], 2000h
		mov	[esp], eax
		call	sub_42E95C
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp], 31h
		call	gcry_xmalloc
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp+8]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aSockD ; "[sock %d]"
		mov	edx, [ebp-10h]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+8]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	sprintf
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+40h], offset sub_42DB2C
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		mov	[eax+44h], edx
		mov	eax, [ebp-0Ch]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-14h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42DB2C
		lea	eax, [ebp-14h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42DB2C
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42F234
		mov	eax, [ebp-10h]
		lea	ecx, [eax+14h]
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+58h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+54h]
		mov	[esp+0Ch], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aIobufD_DSockop	; "iobuf-%d.%d:	sockopen `%s'\n"
		call	sub_435C1A

loc_42F234:				; CODE XREF: .text:0042F208j
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_42F5AC
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_42F287
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_42F2AB
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42F2AB

loc_42F287:				; CODE XREF: .text:0042F26Ej
		mov	dword ptr [esp], 0FFFFFFF5h
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp+8], offset aStdout_1 ; "[stdout]"
		mov	dword ptr [ebp-10h], 1
		jmp	short loc_42F30D
; ---------------------------------------------------------------------------

loc_42F2AB:				; CODE XREF: .text:0042F278j
					; .text:0042F285j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42ECE6
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0FFFFFFFFh
		jz	short loc_42F2E7
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_43141E
		mov	dword ptr [esp+4], offset aWb_0	; "wb"
		mov	[esp], eax
		call	sub_42EFD8
		jmp	loc_42F440
; ---------------------------------------------------------------------------

loc_42F2E7:				; CODE XREF: .text:0042F2BDj
		mov	dword ptr [esp+4], offset aWb_0	; "wb"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42D507
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_42F30D
		mov	eax, 0
		jmp	loc_42F440
; ---------------------------------------------------------------------------

loc_42F30D:				; CODE XREF: .text:0042F2A9j
					; .text:0042F301j
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_42E95C
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-10h]
		mov	[eax+10h], edx
		mov	eax, [ebp-1Ch]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42F390
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp-18h]
		mov	[eax+4Ch], edx

loc_42F390:				; CODE XREF: .text:0042F37Bj
		mov	eax, [ebp-18h]
		mov	dword ptr [eax+40h], offset sub_42D880
		mov	eax, [ebp-18h]
		mov	edx, [ebp-1Ch]
		mov	[eax+44h], edx
		mov	eax, [ebp-18h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_42D880
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_42D880
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42F43D
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_42F414
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		jmp	short loc_42F419
; ---------------------------------------------------------------------------

loc_42F414:				; CODE XREF: .text:0042F40Aj
		mov	eax, offset a?_1 ; "?"

loc_42F419:				; CODE XREF: .text:0042F412j
		mov	edx, [ebp-18h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-18h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DCreate	; "iobuf-%d.%d:	create `%s'\n"
		call	sub_435C1A

loc_42F43D:				; CODE XREF: .text:0042F400j
		mov	eax, [ebp-18h]

loc_42F440:				; CODE XREF: .text:0042F2E2j
					; .text:0042F308j
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_42F45C
		mov	eax, 0
		jmp	loc_42F5A6
; ---------------------------------------------------------------------------

loc_42F45C:				; CODE XREF: .text:0042F450j
		mov	dword ptr [esp+4], offset aRB_0	; "r+b"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42D507
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_42F482
		mov	eax, 0
		jmp	loc_42F5A6
; ---------------------------------------------------------------------------

loc_42F482:				; CODE XREF: .text:0042F476j
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_42E95C
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-14h]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp-10h]
		mov	[eax+4Ch], edx
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+40h], offset sub_42D880
		mov	eax, [ebp-10h]
		mov	edx, [ebp-14h]
		mov	[eax+44h], edx
		mov	eax, [ebp-10h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_42D880
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_42D880
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42F5A3
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_42F57A
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		jmp	short loc_42F57F
; ---------------------------------------------------------------------------

loc_42F57A:				; CODE XREF: .text:0042F570j
		mov	eax, offset a?_1 ; "?"

loc_42F57F:				; CODE XREF: .text:0042F578j
		mov	edx, [ebp-10h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-10h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DOpenrw	; "iobuf-%d.%d:	openrw `%s'\n"
		call	sub_435C1A

loc_42F5A3:				; CODE XREF: .text:0042F566j
		mov	eax, [ebp-10h]

loc_42F5A6:				; CODE XREF: .text:0042F457j
					; .text:0042F47Dj
		add	esp, 44h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F5AC	proc near		; CODE XREF: sub_42EFD8+13Bp
					; .text:0042F252p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		cmp	[ebp+arg_4], 1
		jnz	loc_42F6A8
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	loc_42F69D
		cmp	[ebp+arg_0], 0
		jz	short loc_42F5E2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_42F5E2
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_42F5E7
; ---------------------------------------------------------------------------

loc_42F5E2:				; CODE XREF: sub_42F5AC+22j
					; sub_42F5AC+2Cj
		mov	ecx, offset a?_1 ; "?"

loc_42F5E7:				; CODE XREF: sub_42F5AC+34j
		cmp	[ebp+arg_0], 0
		jz	short loc_42F5F5
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_42F5FA
; ---------------------------------------------------------------------------

loc_42F5F5:				; CODE XREF: sub_42F5AC+3Fj
		mov	edx, 0FFFFFFFFh

loc_42F5FA:				; CODE XREF: sub_42F5AC+47j
		cmp	[ebp+arg_0], 0
		jz	short loc_42F608
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_42F60D
; ---------------------------------------------------------------------------

loc_42F608:				; CODE XREF: sub_42F5AC+52j
		mov	eax, 0FFFFFFFFh

loc_42F60D:				; CODE XREF: sub_42F5AC+5Aj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoctlS ; "iobuf-%d.%d: ioctl `%s' keep=%d\n"
		call	sub_435C1A
		jmp	short loc_42F69D
; ---------------------------------------------------------------------------

loc_42F62E:				; CODE XREF: sub_42F5AC+F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_42F661
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_42D880
		jnz	short loc_42F661
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_42F85A
; ---------------------------------------------------------------------------

loc_42F661:				; CODE XREF: sub_42F5AC+8Aj
					; sub_42F5AC+97j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_42F694
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_42DB2C
		jnz	short loc_42F694
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_42F85A
; ---------------------------------------------------------------------------

loc_42F694:				; CODE XREF: sub_42F5AC+BDj
					; sub_42F5AC+CAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_42F69D:				; CODE XREF: sub_42F5AC+18j
					; sub_42F5AC+80j
		cmp	[ebp+arg_0], 0
		jnz	short loc_42F62E
		jmp	loc_42F855
; ---------------------------------------------------------------------------

loc_42F6A8:				; CODE XREF: sub_42F5AC+Bj
		cmp	[ebp+arg_4], 2
		jnz	short loc_42F718
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42F6D7
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_42F6C2
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_42F6C7
; ---------------------------------------------------------------------------

loc_42F6C2:				; CODE XREF: sub_42F5AC+10Fj
		mov	eax, offset a?_1 ; "?"

loc_42F6C7:				; CODE XREF: sub_42F5AC+114j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSIn ; "iobuf-*.*: ioctl `%s' invalidate\n"
		call	sub_435C1A

loc_42F6D7:				; CODE XREF: sub_42F5AC+109j
		cmp	[ebp+arg_0], 0
		jnz	loc_42F855
		cmp	[ebp+arg_8], 0
		jnz	loc_42F855
		cmp	dword ptr [ebp+arg_C], 0
		jz	loc_42F855
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_42D422
		test	eax, eax
		jz	short loc_42F70E
		mov	eax, 0FFFFFFFFh
		jmp	loc_42F85A
; ---------------------------------------------------------------------------

loc_42F70E:				; CODE XREF: sub_42F5AC+156j
		mov	eax, 0
		jmp	loc_42F85A
; ---------------------------------------------------------------------------

loc_42F718:				; CODE XREF: sub_42F5AC+100j
		cmp	[ebp+arg_4], 3
		jnz	loc_42F807
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	loc_42F7FF
		cmp	[ebp+arg_0], 0
		jz	short loc_42F747
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_42F747
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_42F74C
; ---------------------------------------------------------------------------

loc_42F747:				; CODE XREF: sub_42F5AC+187j
					; sub_42F5AC+191j
		mov	ecx, offset a?_1 ; "?"

loc_42F74C:				; CODE XREF: sub_42F5AC+199j
		cmp	[ebp+arg_0], 0
		jz	short loc_42F75A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_42F75F
; ---------------------------------------------------------------------------

loc_42F75A:				; CODE XREF: sub_42F5AC+1A4j
		mov	edx, 0FFFFFFFFh

loc_42F75F:				; CODE XREF: sub_42F5AC+1ACj
		cmp	[ebp+arg_0], 0
		jz	short loc_42F76D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_42F772
; ---------------------------------------------------------------------------

loc_42F76D:				; CODE XREF: sub_42F5AC+1B7j
		mov	eax, 0FFFFFFFFh

loc_42F772:				; CODE XREF: sub_42F5AC+1BFj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoct_0 ; "iobuf-%d.%d: ioctl `%s' no_cache=%d\n"
		call	sub_435C1A
		jmp	short loc_42F7FF
; ---------------------------------------------------------------------------

loc_42F793:				; CODE XREF: sub_42F5AC+257j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_42F7C6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_42D880
		jnz	short loc_42F7C6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	loc_42F85A
; ---------------------------------------------------------------------------

loc_42F7C6:				; CODE XREF: sub_42F5AC+1EFj
					; sub_42F5AC+1FCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_42F7F6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_42DB2C
		jnz	short loc_42F7F6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	short loc_42F85A
; ---------------------------------------------------------------------------

loc_42F7F6:				; CODE XREF: sub_42F5AC+222j
					; sub_42F5AC+22Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_42F7FF:				; CODE XREF: sub_42F5AC+17Dj
					; sub_42F5AC+1E5j
		cmp	[ebp+arg_0], 0
		jnz	short loc_42F793
		jmp	short loc_42F855
; ---------------------------------------------------------------------------

loc_42F807:				; CODE XREF: sub_42F5AC+170j
		cmp	[ebp+arg_4], 4
		jnz	short loc_42F855
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42F836
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_42F821
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_42F826
; ---------------------------------------------------------------------------

loc_42F821:				; CODE XREF: sub_42F5AC+26Ej
		mov	eax, offset aNull_1 ; "<null>"

loc_42F826:				; CODE XREF: sub_42F5AC+273j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSFs ; "iobuf-*.*: ioctl `%s' fsync\n"
		call	sub_435C1A

loc_42F836:				; CODE XREF: sub_42F5AC+268j
		cmp	[ebp+arg_0], 0
		jnz	short loc_42F855
		cmp	[ebp+arg_8], 0
		jnz	short loc_42F855
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_42F855
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_42D4F5
		jmp	short loc_42F85A
; ---------------------------------------------------------------------------

loc_42F855:				; CODE XREF: sub_42F5AC+F7j
					; sub_42F5AC+12Fj ...
		mov	eax, 0FFFFFFFFh

loc_42F85A:				; CODE XREF: sub_42F5AC+B0j
					; sub_42F5AC+E3j ...
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_42F5AC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F860	proc near		; CODE XREF: .text:00431238p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_42F889
		leave
		retn
sub_42F860	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F889	proc near		; CODE XREF: sub_42F860+22p

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_42F8C6
		mov	[esp+48h+var_40], offset aIobuf_push_fil ; "iobuf_push_filter2"
		mov	dword ptr [esp+48h+var_44], 653h
		mov	[esp+48h+var_48], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_42F8C6:				; CODE XREF: sub_42F889+1Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_42F8EC
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_4304F8
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_42F8EC
		mov	eax, [ebp+var_1C]
		jmp	loc_42FBBC
; ---------------------------------------------------------------------------

loc_42F8EC:				; CODE XREF: sub_42F889+45j
					; sub_42F889+59j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	eax, 3Fh
		jle	short loc_42F90D
		mov	[esp+48h+var_48], offset aIOFilterTooDee ; "i/o	filter too deeply nested - corrupte"...
		call	sub_435B7D
		mov	eax, 59h
		jmp	loc_42FBBC
; ---------------------------------------------------------------------------

loc_42F90D:				; CODE XREF: sub_42F889+6Cj
		mov	[esp+48h+var_48], 68h
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_20]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_42F93E
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_42F93E:				; CODE XREF: sub_42F889+A5j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_42F956
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_42F956:				; CODE XREF: sub_42F889+BCj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_42F97E
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_42F97E:				; CODE XREF: sub_42F889+E8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_42F98C
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_42F98C:				; CODE XREF: sub_42F889+FAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_42F9A6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_xstrdup
		jmp	short loc_42F9AB
; ---------------------------------------------------------------------------

loc_42F9A6:				; CODE XREF: sub_42F889+10Bj
		mov	eax, 0

loc_42F9AB:				; CODE XREF: sub_42F889+11Bj
		mov	edx, [ebp+var_20]
		mov	[edx+4Ch], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+48h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_42F9EC
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 2

loc_42F9EC:				; CODE XREF: sub_42F889+158j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_42FA22
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+2Ch], 0
		jmp	short loc_42FA4C
; ---------------------------------------------------------------------------

loc_42FA22:				; CODE XREF: sub_42F889+16Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0

loc_42FA4C:				; CODE XREF: sub_42F889+197j
		mov	eax, [ebp+var_20]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+var_20]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+arg_0]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+50h], edx
		mov	eax, [ebp+var_20]
		mov	edx, [eax+60h]
		mov	eax, [ebp+arg_0]
		mov	[eax+60h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+40h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+44h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+48h], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+58h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+58h], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42FB59
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_42FB25
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_42FB2A
; ---------------------------------------------------------------------------

loc_42FB25:				; CODE XREF: sub_42F889+292j
		mov	eax, offset a?_1 ; "?"

loc_42FB2A:				; CODE XREF: sub_42F889+29Aj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufD_DPushS	; "iobuf-%d.%d:	push `%s'\n"
		call	sub_435C1A
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_42E870

loc_42FB59:				; CODE XREF: sub_42F889+288j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_42FBB9
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_42FBB9
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aIobufctrl_init ; "IOBUFCTRL_INIT failed: %s\n"
		call	sub_435B7D

loc_42FBB9:				; CODE XREF: sub_42F889+2D8j
					; sub_42F889+313j
		mov	eax, [ebp+var_1C]

loc_42FBBC:				; CODE XREF: sub_42F889+5Ej
					; sub_42F889+7Fj
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_42F889	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FBC4	proc near		; CODE XREF: .text:00430B73p
					; .text:00430C03p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_42FC01
		mov	[esp+48h+var_40], offset aPop_filter ; "pop_filter"
		mov	[esp+48h+var_44], 6AAh
		mov	[esp+48h+var_48], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_42FC01:				; CODE XREF: sub_42FBC4+1Fj
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42FC45
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_42FC1C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_42FC21
; ---------------------------------------------------------------------------

loc_42FC1C:				; CODE XREF: sub_42FBC4+4Ej
		mov	eax, offset a?_1 ; "?"

loc_42FC21:				; CODE XREF: sub_42FBC4+56j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	[esp+48h+var_44], edx ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopS ; "iobuf-%d.%d: pop `%s'\n"
		call	sub_435C1A

loc_42FC45:				; CODE XREF: sub_42FBC4+44j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	loc_42FD1F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_42FC7E
		mov	[esp+48h+var_40], 6B2h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+var_48], offset aB ; "b"
		call	sub_43BB20

loc_42FC7E:				; CODE XREF: sub_42FBC4+9Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_42FCBC
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_42FCBC:				; CODE XREF: sub_42FBC4+E8j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_42FCD4
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_42FCD4:				; CODE XREF: sub_42FBC4+FFj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_42FCFC
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_42FCFC:				; CODE XREF: sub_42FBC4+12Bj
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_42FD0A
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_42FD0A:				; CODE XREF: sub_42FBC4+13Dj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_42FF53
; ---------------------------------------------------------------------------

loc_42FD1F:				; CODE XREF: sub_42FBC4+89j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		jmp	short loc_42FD4C
; ---------------------------------------------------------------------------

loc_42FD27:				; CODE XREF: sub_42FBC4+18Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_42FD43
		cmp	[ebp+arg_8], 0
		jz	short loc_42FD52
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		cmp	eax, [ebp+arg_8]
		jz	short loc_42FD52

loc_42FD43:				; CODE XREF: sub_42FBC4+16Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax

loc_42FD4C:				; CODE XREF: sub_42FBC4+161j
		cmp	[ebp+var_1C], 0
		jnz	short loc_42FD27

loc_42FD52:				; CODE XREF: sub_42FBC4+172j
					; sub_42FBC4+17Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_42FD64
		mov	[esp+48h+var_48], offset aPop_filterFilt ; "pop_filter(): filter function not found"...
		call	sub_435BED
; ---------------------------------------------------------------------------

loc_42FD64:				; CODE XREF: sub_42FBC4+192j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_42FDA5
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_4304F8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_42FDA5
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobuf_flushF_0 ; "iobuf_flush	failed in pop_filter: %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_20]
		jmp	loc_42FF53
; ---------------------------------------------------------------------------

loc_42FDA5:				; CODE XREF: sub_42FBC4+1A8j
					; sub_42FBC4+1BCj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_42FE0D
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+50h]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 2
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_42FE0D
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_435B7D
		mov	eax, [ebp+var_20]
		jmp	loc_42FF53
; ---------------------------------------------------------------------------

loc_42FE0D:				; CODE XREF: sub_42FBC4+1E9j
					; sub_42FBC4+224j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_42FE39
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_42FE39
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax+44h], 0

loc_42FE39:				; CODE XREF: sub_42FBC4+251j
					; sub_42FBC4+25Bj
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	short loc_42FE57
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_42FE57
		mov	[esp+48h+var_48], offset aCanTRemoveTheL ; "can't remove the last filter from the c"...
		call	sub_435BED
; ---------------------------------------------------------------------------

loc_42FE57:				; CODE XREF: sub_42FBC4+27Bj
					; sub_42FBC4+285j
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	loc_42FF2E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_42FEAA
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_42FEAA:				; CODE XREF: sub_42FBC4+2D6j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_42FEC2
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_42FEC2:				; CODE XREF: sub_42FBC4+2EDj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_42FEEA
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_42FEEA:				; CODE XREF: sub_42FBC4+319j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_42FEF8
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_42FEF8:				; CODE XREF: sub_42FBC4+32Bj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_42FF50
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopped ; "iobuf-%d.%d: popped	filter\n"
		call	sub_435C1A
		jmp	short loc_42FF50
; ---------------------------------------------------------------------------

loc_42FF2E:				; CODE XREF: sub_42FBC4+299j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_42FF44
		mov	[esp+48h+var_48], offset aOhhJeeeTryingT ; "Ohh	jeee, trying to	remove a head filte"...
		call	sub_435BED
; ---------------------------------------------------------------------------

loc_42FF44:				; CODE XREF: sub_42FBC4+372j
		mov	[esp+48h+var_48], offset aOhhJeeeTryin_0 ; "Ohh	jeee, trying to	remove an intermedi"...
		call	sub_435BED
; ---------------------------------------------------------------------------

loc_42FF50:				; CODE XREF: sub_42FBC4+346j
					; sub_42FBC4+368j
		mov	eax, [ebp+var_20]

loc_42FF53:				; CODE XREF: sub_42FBC4+156j
					; sub_42FBC4+1DCj ...
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_42FBC4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FF5B	proc near		; CODE XREF: sub_430666+73p
					; sub_43070F+136p ...

DstBuf		= dword	ptr -58h
ElementSize	= dword	ptr -54h
Count		= dword	ptr -50h
File		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jz	short loc_42FF90
		mov	[esp+58h+Count], 6FAh ;	int
		mov	[esp+58h+ElementSize], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+DstBuf], offset aAD_startAD_len ; "a->d.start == a->d.len"
		call	sub_43BB20

loc_42FF90:				; CODE XREF: sub_42FF5B+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_42FFA4
		mov	eax, 0FFFFFFFFh
		jmp	loc_4304F0
; ---------------------------------------------------------------------------

loc_42FFA4:				; CODE XREF: sub_42FF5B+3Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	loc_4300EE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_4300B1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_43000D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_42FFE4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_42FFE9
; ---------------------------------------------------------------------------

loc_42FFE4:				; CODE XREF: sub_42FF5B+7Fj
		mov	eax, offset a?_1 ; "?"

loc_42FFE9:				; CODE XREF: sub_42FF5B+87j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+58h+File],	eax
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+ElementSize], edx ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopSIn ; "iobuf-%d.%d: pop `%s' in underflow\n"
		call	sub_435C1A

loc_43000D:				; CODE XREF: sub_42FF5B+75j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_43004B
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_43004B:				; CODE XREF: sub_42FF5B+E0j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_430063
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_430063:				; CODE XREF: sub_42FF5B+F7j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_43008B
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_43008B:				; CODE XREF: sub_42FF5B+123j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_430099
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_430099:				; CODE XREF: sub_42FF5B+135j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_42E870
		jmp	short loc_4300BB
; ---------------------------------------------------------------------------

loc_4300B1:				; CODE XREF: sub_42FF5B+5Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0

loc_4300BB:				; CODE XREF: sub_42FF5B+154j
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_4300E4
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnderf ; "iobuf-%d.%d: underflow: eof	(due to	fil"...
		call	sub_435C1A

loc_4300E4:				; CODE XREF: sub_42FF5B+167j
		mov	eax, 0FFFFFFFFh
		jmp	loc_4304F0
; ---------------------------------------------------------------------------

loc_4300EE:				; CODE XREF: sub_42FF5B+51j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		test	eax, eax
		jz	short loc_43012B
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_430121
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DError	; "iobuf-%d.%d:	error\n"
		call	sub_435C1A

loc_430121:				; CODE XREF: sub_42FF5B+1A4j
		mov	eax, 0FFFFFFFFh
		jmp	loc_4304F0
; ---------------------------------------------------------------------------

loc_43012B:				; CODE XREF: sub_42FF5B+19Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_4301D9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], edx ; Count
		mov	[esp+58h+ElementSize], 1 ; ElementSize
		mov	[esp+58h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jbe	short loc_430195
		mov	eax, [ebp+var_20]
		mov	[esp+58h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_430195
		call	sub_42D30D
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+3Ch], edx

loc_430195:				; CODE XREF: sub_42FF5B+21Cj
					; sub_42FF5B+22Bj
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_4301CF
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_4301D4
; ---------------------------------------------------------------------------

loc_4301CF:				; CODE XREF: sub_42FF5B+252j
		mov	eax, 0FFFFFFFFh

loc_4301D4:				; CODE XREF: sub_42FF5B+272j
		jmp	loc_4304F0
; ---------------------------------------------------------------------------

loc_4301D9:				; CODE XREF: sub_42FF5B+1D8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	loc_4304C2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[ebp+var_2C], eax
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_430220
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_0 ; "iobuf-%d.%d: underflow: req=%lu\n"
		call	sub_435C1A

loc_430220:				; CODE XREF: sub_42FF5B+29Cj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_2C]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 3
		mov	[esp+58h+DstBuf], eax
		call	esi
		mov	[ebp+var_24], eax
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_43028E
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	ebx, [ebp+var_24]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_1 ; "iobuf-%d.%d: underflow: got=%lu rc=%d\n"
		call	sub_435C1A

loc_43028E:				; CODE XREF: sub_42FF5B+303j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	loc_430446
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	loc_430446
		mov	[ebp+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_30]
		mov	[esp+58h+var_48], ecx
		mov	[esp+58h+File],	0
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 2
		mov	[esp+58h+DstBuf], eax
		call	ebx
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_430303
		mov	eax, [ebp+var_24]
		mov	[esp+58h+DstBuf], eax
		call	gpg_strerror
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_435B7D

loc_430303:				; CODE XREF: sub_42FF5B+38Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_43032F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_43032F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0

loc_43032F:				; CODE XREF: sub_42FF5B+3B0j
					; sub_42FF5B+3BAj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+5Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 1
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	loc_430457
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_430457
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_28], eax
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_4303A2
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopInU ; "iobuf-%d.%d: pop in	underflow (!len)\n"
		call	sub_435C1A

loc_4303A2:				; CODE XREF: sub_42FF5B+425j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_4303E0
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_4303E0:				; CODE XREF: sub_42FF5B+475j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_4303F8
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_4303F8:				; CODE XREF: sub_42FF5B+48Cj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_430420
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_430420:				; CODE XREF: sub_42FF5B+4B8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_43042E
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_43042E:				; CODE XREF: sub_42FF5B+4CAj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_42E870
		jmp	short loc_430457
; ---------------------------------------------------------------------------

loc_430446:				; CODE XREF: sub_42FF5B+33Bj
					; sub_42FF5B+345j
		cmp	[ebp+var_24], 0
		jz	short loc_430458
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_24]
		mov	[eax+3Ch], edx
		jmp	short loc_430458
; ---------------------------------------------------------------------------

loc_430457:				; CODE XREF: sub_42FF5B+401j
					; sub_42FF5B+40Fj ...
		nop

loc_430458:				; CODE XREF: sub_42FF5B+4EFj
					; sub_42FF5B+4FAj
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_43048F
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_430488
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_2 ; "iobuf-%d.%d: underflow: eof\n"
		call	sub_435C1A

loc_430488:				; CODE XREF: sub_42FF5B+50Bj
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4304F0
; ---------------------------------------------------------------------------

loc_43048F:				; CODE XREF: sub_42FF5B+502j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_4304F0
; ---------------------------------------------------------------------------

loc_4304C2:				; CODE XREF: sub_42FF5B+286j
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_4304EB
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_3 ; "iobuf-%d.%d: underflow: eof	(no filter)"...
		call	sub_435C1A

loc_4304EB:				; CODE XREF: sub_42FF5B+56Ej
		mov	eax, 0FFFFFFFFh

loc_4304F0:				; CODE XREF: sub_42FF5B+44j
					; sub_42FF5B+18Ej ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_42FF5B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4304F8	proc near		; CODE XREF: sub_42E9D9+8Bp
					; sub_42F889+4Dp ...

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_430514
		mov	eax, 0
		jmp	loc_43065F
; ---------------------------------------------------------------------------

loc_430514:				; CODE XREF: sub_4304F8+10j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	loc_4305AF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		add	eax, 2000h
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_449E34
		test	eax, eax
		jz	short loc_430556
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], eax ; char
		mov	[esp+38h+Dst], offset aIncreasingTemp ;	"increasing temp iobuf from %lu	to %lu\n"
		call	sub_435C1A

loc_430556:				; CODE XREF: sub_4304F8+3Fj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+28h], edx
		mov	eax, 0
		jmp	loc_43065F
; ---------------------------------------------------------------------------

loc_4305AF:				; CODE XREF: sub_4304F8+24j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_4305C5
		mov	[esp+38h+Dst], offset aFlushOnNonOutp ;	"flush on non-output iobuf\n"
		call	sub_435BED
; ---------------------------------------------------------------------------

loc_4305C5:				; CODE XREF: sub_4304F8+BFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	short loc_4305DB
		mov	[esp+38h+Dst], offset aIobuf_flushNoF ;	"iobuf_flush: no filter\n"
		call	sub_435BED
; ---------------------------------------------------------------------------

loc_4305DB:				; CODE XREF: sub_4304F8+D5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_18]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], 4 ; char
		mov	[esp+38h+Dst], eax
		call	esi
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_430643
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jz	short loc_430643
		mov	[esp+38h+Dst], offset aIobuf_flushDid ;	"iobuf_flush did not write all!\n"
		call	sub_435B53
		mov	[ebp+var_C], 3Fh
		jmp	short loc_430652
; ---------------------------------------------------------------------------

loc_430643:				; CODE XREF: sub_4304F8+127j
					; sub_4304F8+134j
		cmp	[ebp+var_C], 0
		jz	short loc_430652
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+3Ch], edx

loc_430652:				; CODE XREF: sub_4304F8+149j
					; sub_4304F8+14Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_C]

loc_43065F:				; CODE XREF: sub_4304F8+17j
					; sub_4304F8+B2j
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4304F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430666	proc near		; CODE XREF: sub_42DD35+FBp
					; sub_42DD35+1E3p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_4306A1
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		cmp	ebx, edx
		jl	short loc_4306A1
		cmp	ebx, edx
		jg	short loc_43069A
		cmp	ecx, eax
		jb	short loc_4306A1

loc_43069A:				; CODE XREF: sub_430666+2Ej
		mov	eax, 0FFFFFFFFh
		jmp	short loc_430709
; ---------------------------------------------------------------------------

loc_4306A1:				; CODE XREF: sub_430666+14j
					; sub_430666+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	short loc_4306D3
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		mov	[ebp+var_C], edx
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		jmp	short loc_4306EE
; ---------------------------------------------------------------------------

loc_4306D3:				; CODE XREF: sub_430666+49j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42FF5B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_4306EE
		mov	eax, 0FFFFFFFFh
		jmp	short loc_430709
; ---------------------------------------------------------------------------

loc_4306EE:				; CODE XREF: sub_430666+6Bj
					; sub_430666+7Fj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_C]

loc_430709:				; CODE XREF: sub_430666+39j
					; sub_430666+86j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_430666	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43070F	proc near		; CODE XREF: .text:0041E332p
					; sub_42DD35+514p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_430789
		mov	[ebp+var_10], 0
		jmp	short loc_430776
; ---------------------------------------------------------------------------

loc_430734:				; CODE XREF: sub_43070F+6Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_430666
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_430758
		cmp	[ebp+var_10], 0
		jnz	short loc_430780
		mov	eax, 0FFFFFFFFh
		jmp	loc_4308C8
; ---------------------------------------------------------------------------

loc_430758:				; CODE XREF: sub_43070F+37j
		cmp	[ebp+var_C], 0
		jz	short loc_430768
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl

loc_430768:				; CODE XREF: sub_43070F+4Dj
		cmp	[ebp+var_C], 0
		jz	short loc_430772
		add	[ebp+var_C], 1

loc_430772:				; CODE XREF: sub_43070F+5Dj
		add	[ebp+var_10], 1

loc_430776:				; CODE XREF: sub_43070F+23j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	short loc_430734
		jmp	short loc_430781
; ---------------------------------------------------------------------------

loc_430780:				; CODE XREF: sub_43070F+3Dj
		nop

loc_430781:				; CODE XREF: sub_43070F+6Fj
		mov	eax, [ebp+var_10]
		jmp	loc_4308C8
; ---------------------------------------------------------------------------

loc_430789:				; CODE XREF: sub_43070F+1Aj
		mov	[ebp+var_10], 0

loc_430790:				; CODE XREF: sub_43070F+192j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	loc_430837
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	loc_430837
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_14]
		jnb	short loc_4307E5
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax

loc_4307E5:				; CODE XREF: sub_43070F+C5j
		cmp	[ebp+var_C], 0
		jz	short loc_430811
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_14]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy

loc_430811:				; CODE XREF: sub_43070F+DAj
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		cmp	[ebp+var_C], 0
		jz	short loc_430837
		mov	eax, [ebp+var_14]
		add	[ebp+var_C], eax

loc_430837:				; CODE XREF: sub_43070F+87j
					; sub_43070F+9Bj ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_43089B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_42FF5B
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_430883
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		cmp	[ebp+var_10], 0
		jz	short loc_43087C
		mov	eax, [ebp+var_10]
		jmp	short loc_430881
; ---------------------------------------------------------------------------

loc_43087C:				; CODE XREF: sub_43070F+166j
		mov	eax, 0FFFFFFFFh

loc_430881:				; CODE XREF: sub_43070F+16Bj
		jmp	short loc_4308C8
; ---------------------------------------------------------------------------

loc_430883:				; CODE XREF: sub_43070F+142j
		cmp	[ebp+var_C], 0
		jz	short loc_430897
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_430897:				; CODE XREF: sub_43070F+178j
		add	[ebp+var_10], 1

loc_43089B:				; CODE XREF: sub_43070F+12Ej
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	loc_430790
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_10]

loc_4308C8:				; CODE XREF: sub_43070F+44j
					; sub_43070F+75j ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_43070F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_4308EF
		mov	eax, 0FFFFFFFFh
		jmp	locret_43098B
; ---------------------------------------------------------------------------

loc_4308EF:				; CODE XREF: .text:004308E3j
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_430947
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42FF5B
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_430916
		mov	eax, 0FFFFFFFFh
		jmp	short locret_43098B
; ---------------------------------------------------------------------------

loc_430916:				; CODE XREF: .text:0043090Dj
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		cmp	eax, 1
		jz	short loc_43093D
		mov	dword ptr [esp+8], 7FCh
		mov	dword ptr [esp+4], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAD_start1 ; "a->d.start == 1"
		call	sub_43BB20

loc_43093D:				; CODE XREF: .text:0043091Fj
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0

loc_430947:				; CODE XREF: .text:004308FDj
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_43096B
; ---------------------------------------------------------------------------

loc_430950:				; CODE XREF: .text:00430986j
		mov	eax, [ebp+8]
		mov	edx, [eax+34h]
		mov	eax, [ebp-0Ch]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp+0Ch], 1

loc_43096B:				; CODE XREF: .text:0043094Ej
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	short loc_430988
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp-0Ch]
		add	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_430950

loc_430988:				; CODE XREF: .text:00430971j
		mov	eax, [ebp-0Ch]

locret_43098B:				; CODE XREF: .text:004308EAj
					; .text:00430914j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43098D	proc near		; CODE XREF: sub_42DD35+6E3p
					; sub_42DD35+95Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4309B9
		mov	[esp+28h+var_20], offset aIobuf_writebyt ; "iobuf_writebyte"
		mov	[esp+28h+var_24], 80Eh
		mov	[esp+28h+var_28], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_4309B9:				; CODE XREF: sub_43098D+Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnz	short loc_4309E2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4304F8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4309E2
		mov	eax, [ebp+var_C]
		jmp	short locret_430A30
; ---------------------------------------------------------------------------

loc_4309E2:				; CODE XREF: sub_43098D+3Aj
					; sub_43098D+4Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jb	short loc_430A0E
		mov	[esp+28h+var_20], 814h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+var_28], offset aAD_lenAD_size	; "a->d.len < a->d.size"
		call	sub_43BB20

loc_430A0E:				; CODE XREF: sub_43098D+63j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, 0

locret_430A30:				; CODE XREF: sub_43098D+53j
		leave
		retn
sub_43098D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430A32	proc near		; CODE XREF: sub_42DD35+733p
					; sub_42DD35+782p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_430A64
		mov	[esp+28h+Size],	offset aIobuf_write ; "iobuf_write"
		mov	[esp+28h+Src], 821h
		mov	[esp+28h+Dst], offset a____Gnupg22_17 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_430A64:				; CODE XREF: sub_430A32+14j
					; sub_430A32+D1j
		cmp	[ebp+arg_8], 0
		jz	short loc_430AE0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnb	short loc_430AE0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_430A9D
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax

loc_430A9D:				; CODE XREF: sub_430A32+63j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		add	eax, ecx
		mov	ecx, [ebp+var_10]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx

loc_430AE0:				; CODE XREF: sub_430A32+36j
					; sub_430A32+46j
		cmp	[ebp+arg_8], 0
		jz	short loc_430AFF
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_4304F8
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_430AFF
		mov	eax, [ebp+var_14]
		jmp	short locret_430B0E
; ---------------------------------------------------------------------------

loc_430AFF:				; CODE XREF: sub_430A32+B2j
					; sub_430A32+C6j
		cmp	[ebp+arg_8], 0
		jnz	loc_430A64
		mov	eax, 0

locret_430B0E:				; CODE XREF: sub_430A32+CBj
		leave
		retn
sub_430A32	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_430B42
; ---------------------------------------------------------------------------

loc_430B18:				; CODE XREF: .text:00430B4Aj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43098D
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_430B3E
		mov	eax, [ebp-0Ch]
		jmp	short locret_430B51
; ---------------------------------------------------------------------------

loc_430B3E:				; CODE XREF: .text:00430B37j
		add	dword ptr [ebp+0Ch], 1

loc_430B42:				; CODE XREF: .text:00430B16j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_430B18
		mov	eax, 0

locret_430B51:				; CODE XREF: .text:00430B3Cj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_430B78
; ---------------------------------------------------------------------------

loc_430B5B:				; CODE XREF: .text:00430B80j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_42FBC4

loc_430B78:				; CODE XREF: .text:00430B59j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_430B5B
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+30h]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+34h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_430A32
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jbe	short loc_430BC0
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax

loc_430BC0:				; CODE XREF: .text:00430BB8j
		mov	eax, [ebp+8]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	ecx, [ebp-0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_430C08
; ---------------------------------------------------------------------------

loc_430BEB:				; CODE XREF: .text:00430C10j
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42FBC4

loc_430C08:				; CODE XREF: .text:00430BE9j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_430BEB
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0Ch
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		or	eax, edx
		test	eax, eax
		jz	short loc_430C46
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		jmp	short loc_430C57
; ---------------------------------------------------------------------------

loc_430C46:				; CODE XREF: .text:00430C31j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx

loc_430C57:				; CODE XREF: .text:00430C44j
		mov	ecx, [ebp+8]
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		add	esp, 0Ch
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430C9C	proc near		; CODE XREF: .text:0041E2F9p

File		= dword	ptr -68h
lpFileSizeHigh	= dword	ptr -64h
var_60		= dword	ptr -60h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
hFile		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		cmp	[ebp+arg_4], 0
		jz	short loc_430CB1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_430CB1:				; CODE XREF: sub_430C9C+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_430E5C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+File],	eax ; File
		call	_fileno
		lea	edx, [ebp+var_50]
		mov	[esp+68h+lpFileSizeHigh], edx
		mov	[esp+68h+File],	eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_430CF3
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_34]
		jmp	locret_430E70
; ---------------------------------------------------------------------------

loc_430CF3:				; CODE XREF: sub_430C9C+4Aj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+File],	eax ; int
		call	strerror
		mov	[esp+68h+lpFileSizeHigh], eax ;	char
		mov	[esp+68h+File],	offset aFstatFailedS ; "fstat()	failed:	%s\n"
		call	sub_435B7D
		mov	eax, 0
		mov	edx, 0
		jmp	locret_430E70
; ---------------------------------------------------------------------------

loc_430D23:				; CODE XREF: sub_430C9C+1C4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	loc_430E53
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_42D880
		jnz	loc_430E53
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+hFile], eax
		mov	eax, ds:dword_44936C
		test	eax, eax
		jnz	short loc_430DAF
		mov	[esp+68h+lpFileSizeHigh], 0
		mov	[esp+68h+File],	offset aKernel32_dll ; "kernel32.dll"
		call	sub_42D322
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_430DA5
		mov	[esp+68h+lpFileSizeHigh], offset aGetfilesizeex	; "GetFileSizeEx"
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; HMODULE
		call	sub_42D340
		mov	ds:dword_449370, eax
		mov	eax, ds:dword_449370
		test	eax, eax
		jnz	short loc_430DA5
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; HANDLE
		call	sub_42D385

loc_430DA5:				; CODE XREF: sub_430C9C+DBj
					; sub_430C9C+FCj
		mov	ds:dword_44936C, 1

loc_430DAF:				; CODE XREF: sub_430C9C+BEj
		mov	eax, ds:dword_449370
		test	eax, eax
		jz	short loc_430E03
		mov	edx, ds:dword_449370
		lea	eax, [ebp+var_58]
		mov	[esp+68h+lpFileSizeHigh], eax
		mov	eax, [ebp+hFile]
		mov	[esp+68h+File],	eax
		call	edx ; dword_449370
		sub	esp, 8
		test	eax, eax
		jz	short loc_430E2E
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_430DE8
		mov	eax, [ebp+var_58]
		mov	edx, 0
		jmp	locret_430E70
; ---------------------------------------------------------------------------

loc_430DE8:				; CODE XREF: sub_430C9C+13Dj
		cmp	[ebp+arg_4], 0
		jz	short loc_430DF7
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1

loc_430DF7:				; CODE XREF: sub_430C9C+150j
		mov	eax, 0
		mov	edx, 0
		jmp	short locret_430E70
; ---------------------------------------------------------------------------

loc_430E03:				; CODE XREF: sub_430C9C+11Aj
		mov	[esp+68h+lpFileSizeHigh], 0 ; lpFileSizeHigh
		mov	eax, [ebp+hFile]
		mov	[esp+68h+File],	eax ; hFile
		mov	eax, ds:GetFileSize
		call	eax ; GetFileSize
		sub	esp, 8
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_430E2E
		mov	eax, [ebp+var_1C]
		mov	edx, 0
		jmp	short locret_430E70
; ---------------------------------------------------------------------------

loc_430E2E:				; CODE XREF: sub_430C9C+136j
					; sub_430C9C+186j
		mov	[esp+68h+File],	0 ; DWORD
		call	sub_432EA2
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+hFile]
		mov	[esp+68h+lpFileSizeHigh], eax ;	char
		mov	[esp+68h+File],	offset aGetfilesizeFor ; "GetFileSize for handle %p failed: %s\n"
		call	sub_435B7D
		jmp	short loc_430E66
; ---------------------------------------------------------------------------

loc_430E53:				; CODE XREF: sub_430C9C+8Fj
					; sub_430C9C+A0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_430E5C:				; CODE XREF: sub_430C9C+1Dj
		cmp	[ebp+arg_0], 0
		jnz	loc_430D23

loc_430E66:				; CODE XREF: sub_430C9C+1B5j
		mov	eax, 0
		mov	edx, 0

locret_430E70:				; CODE XREF: sub_430C9C+52j
					; sub_430C9C+82j ...
		leave
		retn
sub_430C9C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_430EC8
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[esp], eax
		call	_fileno
		jmp	short locret_430ED3
; ---------------------------------------------------------------------------

loc_430E92:				; CODE XREF: .text:00430ECCj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_430EBF
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_42D880
		jnz	short loc_430EBF
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		jmp	short locret_430ED3
; ---------------------------------------------------------------------------

loc_430EBF:				; CODE XREF: .text:00430E9Aj
					; .text:00430EA7j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_430EC8:				; CODE XREF: .text:00430E80j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_430E92
		mov	eax, 0FFFFFFFFh

locret_430ED3:				; CODE XREF: .text:00430E90j
					; .text:00430EBDj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_430FAD
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[ebp-10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_43C1F0
		test	eax, eax
		jz	short loc_430F72
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCanTSeekS ; "can't seek: %s\n"
		call	sub_435B7D
		mov	eax, 0FFFFFFFFh
		jmp	locret_4310C4
; ---------------------------------------------------------------------------

loc_430F72:				; CODE XREF: .text:00430F45j
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	clearerr
		jmp	loc_43101D
; ---------------------------------------------------------------------------

loc_430F82:				; CODE XREF: .text:00430FB1j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_430FA4
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_42D880
		jnz	short loc_430FA4
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		jmp	short loc_430FB3
; ---------------------------------------------------------------------------

loc_430FA4:				; CODE XREF: .text:00430F8Aj
					; .text:00430F97j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_430FAD:				; CODE XREF: .text:00430F13j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_430F82

loc_430FB3:				; CODE XREF: .text:00430FA2j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_430FC3
		mov	eax, 0FFFFFFFFh
		jmp	locret_4310C4
; ---------------------------------------------------------------------------

loc_430FC3:				; CODE XREF: .text:00430FB7j
		mov	edx, [ebp-20h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_43101D
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aSetfilepointer	; "SetFilePointer failed on handle %p: ec="...
		call	sub_435B7D
		mov	eax, 0FFFFFFFFh
		jmp	locret_4310C4
; ---------------------------------------------------------------------------

loc_43101D:				; CODE XREF: .text:00430F7Dj
					; .text:00430FEFj
		mov	eax, [ebp+8]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		mov	ecx, [ebp+8]
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+3Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	short loc_4310B4
		mov	dword ptr [esp], offset	aPop_filterCall	; "pop_filter called in	iobuf_seek - pleas"...
		call	sub_435C1A
		jmp	short loc_4310B4
; ---------------------------------------------------------------------------

loc_431095:				; CODE XREF: .text:004310BDj
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42FBC4
		jmp	short loc_4310B5
; ---------------------------------------------------------------------------

loc_4310B4:				; CODE XREF: .text:00431085j
					; .text:00431093j
		nop

loc_4310B5:				; CODE XREF: .text:004310B2j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_431095
		mov	eax, 0

locret_4310C4:				; CODE XREF: .text:00430F6Dj
					; .text:00430FBEj ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4310C6	proc near		; CODE XREF: .text:0042EBC5p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_431120
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		jmp	short locret_43112B
; ---------------------------------------------------------------------------

loc_4310DE:				; CODE XREF: sub_4310C6+5Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_431117
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_42D880
		jnz	short loc_431117
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_431110
		mov	eax, [ebp+var_4]
		add	eax, 14h
		jmp	short loc_431115
; ---------------------------------------------------------------------------

loc_431110:				; CODE XREF: sub_4310C6+40j
		mov	eax, 0

loc_431115:				; CODE XREF: sub_4310C6+48j
		jmp	short locret_43112B
; ---------------------------------------------------------------------------

loc_431117:				; CODE XREF: sub_4310C6+20j
					; sub_4310C6+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_431120:				; CODE XREF: sub_4310C6+Ej
		cmp	[ebp+arg_0], 0
		jnz	short loc_4310DE
		mov	eax, 0

locret_43112B:				; CODE XREF: sub_4310C6+16j
					; sub_4310C6:loc_431115j
		leave
		retn
sub_4310C6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		jmp	short loc_431166
; ---------------------------------------------------------------------------

loc_431135:				; CODE XREF: .text:0043116Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_43115D
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_42D880
		jnz	short loc_43115D
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-4], eax
		mov	eax, [ebp-4]
		add	eax, 14h
		jmp	short locret_431171
; ---------------------------------------------------------------------------

loc_43115D:				; CODE XREF: .text:0043113Dj
					; .text:0043114Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_431166:				; CODE XREF: .text:00431133j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_431135
		mov	eax, 0

locret_431171:				; CODE XREF: .text:0043115Bj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 20h
		mov	dword ptr [esp], 1
		call	gcry_xcalloc
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_4311C2
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_4311C2
		mov	dword ptr [esp+8], 98Ch
		mov	dword ptr [esp+4], offset a____Gnupg22_17 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAUse1AUse2 ; "a->use == 1 || a->use ==	2"
		call	sub_43BB20
		jmp	short loc_4311C3
; ---------------------------------------------------------------------------

loc_4311C2:				; CODE XREF: .text:00431198j
					; .text:004311A2j
		nop

loc_4311C3:				; CODE XREF: .text:004311C0j
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], edx
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_431206
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_4311E9
		mov	dword ptr [esp], offset	aPop_filterCa_0	; "pop_filter called in	set_partial_block_"...
		call	sub_435C1A

loc_4311E9:				; CODE XREF: .text:004311DBj
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset sub_42DD35
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42FBC4
		jmp	short locret_43123D
; ---------------------------------------------------------------------------

loc_431206:				; CODE XREF: .text:004311D1j
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+4], 0
		mov	edx, [ebp+0Ch]
		mov	eax, [ebp-0Ch]
		mov	[eax+18h], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset sub_42DD35
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42F860

locret_43123D:				; CODE XREF: .text:00431204j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_43128F
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_43128F:				; CODE XREF: .text:00431268j
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_4313A6
; ---------------------------------------------------------------------------

loc_43129E:				; CODE XREF: .text:0043140Aj
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_43138E
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_43133E

loc_4312B6:				; CODE XREF: .text:00431320j
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_431322
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4312D6
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4312E3

loc_4312D6:				; CODE XREF: .text:004312C4j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_430666
		jmp	short loc_431319
; ---------------------------------------------------------------------------

loc_4312E3:				; CODE XREF: .text:004312D4j
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+2Ch], ecx

loc_431319:				; CODE XREF: .text:004312E1j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_4312B6

loc_431322:				; CODE XREF: .text:004312BAj
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_431413
; ---------------------------------------------------------------------------

loc_43133E:				; CODE XREF: .text:004312B0j
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_431352
		mov	eax, 100h
		jmp	short loc_431357
; ---------------------------------------------------------------------------

loc_431352:				; CODE XREF: .text:00431349j
		mov	eax, 400h

loc_431357:				; CODE XREF: .text:00431350j
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_xrealloc
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_43138E:				; CODE XREF: .text:004312A4j
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_431412

loc_4313A6:				; CODE XREF: .text:00431299j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4313C0
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4313CD

loc_4313C0:				; CODE XREF: .text:004313AEj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_430666
		jmp	short loc_431403
; ---------------------------------------------------------------------------

loc_4313CD:				; CODE XREF: .text:004313BEj
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+2Ch], ecx

loc_431403:				; CODE XREF: .text:004313CBj
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_43129E
		jmp	short loc_431413
; ---------------------------------------------------------------------------

loc_431412:				; CODE XREF: .text:004313A4j
		nop

loc_431413:				; CODE XREF: .text:00431339j
					; .text:00431410j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-18h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43141E	proc near		; CODE XREF: sub_42EDF1+78p
					; .text:0042F2CDp

nStdHandle	= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_431440
		mov	[esp+28h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_43147E
; ---------------------------------------------------------------------------

loc_431440:				; CODE XREF: sub_43141E+Aj
		cmp	dword ptr [ebp+arg_0], 1
		jnz	short loc_43145C
		mov	[esp+28h+nStdHandle], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_43147E
; ---------------------------------------------------------------------------

loc_43145C:				; CODE XREF: sub_43141E+26j
		cmp	dword ptr [ebp+arg_0], 2
		jnz	short loc_431478
		mov	[esp+28h+nStdHandle], 0FFFFFFF4h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_43147E
; ---------------------------------------------------------------------------

loc_431478:				; CODE XREF: sub_43141E+42j
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_C], eax

loc_43147E:				; CODE XREF: sub_43141E+20j
					; sub_43141E+3Cj ...
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_4314A2
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+nStdHandle], offset aGetstdhandleDF ; "GetStdHandle(%d) failed: ec=%d\n"
		call	sub_435C1A

loc_4314A2:				; CODE XREF: sub_43141E+64j
		mov	eax, [ebp+var_C]
		mov	dword ptr [ebp+arg_0], eax
		mov	eax, dword ptr [ebp+arg_0]
		leave
		retn
sub_43141E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_43152C

loc_4314BA:				; CODE XREF: .text:00431528j
					; .text:loc_43152Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4314D4
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4314E9

loc_4314D4:				; CODE XREF: .text:004314C2j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_430666
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_43152A
		jmp	loc_4315CC
; ---------------------------------------------------------------------------

loc_4314E9:				; CODE XREF: .text:004314D2j
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-14h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		jmp	short loc_4314BA
; ---------------------------------------------------------------------------

loc_43152A:				; CODE XREF: .text:004314E2j
		jmp	short loc_4314BA
; ---------------------------------------------------------------------------

loc_43152C:				; CODE XREF: .text:004314B8j
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_4315BF
; ---------------------------------------------------------------------------

loc_431537:				; CODE XREF: .text:004315C3j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_431551
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_431567

loc_431551:				; CODE XREF: .text:0043153Fj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_430666
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4315CB
		sub	dword ptr [ebp-0Ch], 1
		jmp	short loc_4315BF
; ---------------------------------------------------------------------------

loc_431567:				; CODE XREF: .text:0043154Fj
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		cmp	eax, [ebp-0Ch]
		jbe	short loc_43158A
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax

loc_43158A:				; CODE XREF: .text:00431582j
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-10h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		mov	eax, [ebp-10h]
		sub	[ebp-0Ch], eax

loc_4315BF:				; CODE XREF: .text:00431532j
					; .text:00431565j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_431537
		jmp	short loc_4315CC
; ---------------------------------------------------------------------------

loc_4315CB:				; CODE XREF: .text:0043155Fj
		nop

loc_4315CC:				; CODE XREF: .text:004314E4j
					; .text:004315C9j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4315D4	proc near		; CODE XREF: sub_42BFF3+1Ap

var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		call	sub_4352FB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4315F3
		mov	[ebp+var_C], offset byte_446CEC
		jmp	short loc_43164A
; ---------------------------------------------------------------------------

loc_4315F3:				; CODE XREF: sub_4315D4+14j
		mov	eax, [ebp+var_C]
		mov	edx, eax
		mov	eax, offset aC_0 ; "C"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_431643
		mov	eax, [ebp+var_C]
		mov	edx, eax
		mov	eax, offset aPosix ; "POSIX"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_43164A

loc_431643:				; CODE XREF: sub_4315D4+45j
		mov	[ebp+var_C], offset byte_446CEC

loc_43164A:				; CODE XREF: sub_4315D4+1Dj
					; sub_4315D4+6Dj
		mov	eax, [ebp+var_C]
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4315D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_431654	proc near		; CODE XREF: .text:0043193Dp
					; .text:004319BBp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_431674
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_431679
; ---------------------------------------------------------------------------

loc_431674:				; CODE XREF: sub_431654+7j
		mov	eax, 0

loc_431679:				; CODE XREF: sub_431654+1Ej
		pop	ebp
		retn
sub_431654	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43167B	proc near		; CODE XREF: sub_43167B+19Bp
					; .text:00431892p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax

loc_43168D:				; CODE XREF: sub_43167B+45j
					; sub_43167B+1E6j
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax
		cmp	[ebp+var_10], 1
		ja	short loc_4316A3
		mov	eax, 0
		jmp	locret_431866
; ---------------------------------------------------------------------------

loc_4316A3:				; CODE XREF: sub_43167B+1Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4316B7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	short loc_4316C2

loc_4316B7:				; CODE XREF: sub_43167B+30j
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1
		nop
		jmp	short loc_43168D
; ---------------------------------------------------------------------------

loc_4316C2:				; CODE XREF: sub_43167B+3Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 20h
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		cmp	eax, 1Fh
		jnz	short loc_431741
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1
		cmp	[ebp+var_10], 1
		ja	short loc_431702
		mov	eax, 0
		jmp	locret_431866
; ---------------------------------------------------------------------------

loc_431702:				; CODE XREF: sub_43167B+7Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		cmp	eax, 1Fh
		jnz	short loc_43171D
		mov	eax, 0
		jmp	locret_431866
; ---------------------------------------------------------------------------

loc_43171D:				; CODE XREF: sub_43167B+96j
		mov	eax, [ebp+var_C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7Fh
		or	eax, edx
		mov	[ebp+var_18], eax
		jmp	short loc_43174D
; ---------------------------------------------------------------------------

loc_431741:				; CODE XREF: sub_43167B+6Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax

loc_43174D:				; CODE XREF: sub_43167B+C4j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 2
		sub	[ebp+var_10], 2
		cmp	[ebp+var_14], 7Fh
		jbe	short loc_4317E5
		cmp	[ebp+var_14], 81h
		jnz	short loc_431799
		cmp	[ebp+var_10], 0
		jnz	short loc_431783
		mov	eax, 0
		jmp	locret_431866
; ---------------------------------------------------------------------------

loc_431783:				; CODE XREF: sub_43167B+FCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1
		jmp	short loc_4317E5
; ---------------------------------------------------------------------------

loc_431799:				; CODE XREF: sub_43167B+F6j
		cmp	[ebp+var_14], 82h
		jnz	short loc_4317DB
		cmp	[ebp+var_10], 1
		ja	short loc_4317B2
		mov	eax, 0
		jmp	locret_431866
; ---------------------------------------------------------------------------

loc_4317B2:				; CODE XREF: sub_43167B+12Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 2
		sub	[ebp+var_10], 2
		jmp	short loc_4317E5
; ---------------------------------------------------------------------------

loc_4317DB:				; CODE XREF: sub_43167B+125j
		mov	eax, 0
		jmp	locret_431866
; ---------------------------------------------------------------------------

loc_4317E5:				; CODE XREF: sub_43167B+EDj
					; sub_43167B+11Cj ...
		cmp	[ebp+var_1C], 0
		jz	short loc_431831
		cmp	[ebp+arg_10], 63h
		jg	short loc_431831
		mov	eax, [ebp+arg_10]
		add	eax, 1
		mov	[esp+48h+var_38], eax
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_43167B
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_431831
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		jmp	short locret_431866
; ---------------------------------------------------------------------------

loc_431831:				; CODE XREF: sub_43167B+16Ej
					; sub_43167B+174j ...
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_8]
		jnz	short loc_431846
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		jmp	short locret_431866
; ---------------------------------------------------------------------------

loc_431846:				; CODE XREF: sub_43167B+1BCj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jbe	short loc_431855
		mov	eax, 0
		jmp	short locret_431866
; ---------------------------------------------------------------------------

loc_431855:				; CODE XREF: sub_43167B+1D1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		sub	[ebp+var_10], eax
		jmp	loc_43168D
; ---------------------------------------------------------------------------

locret_431866:				; CODE XREF: sub_43167B+23j
					; sub_43167B+82j ...
		leave
		retn
sub_43167B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43167B
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4318BF
		mov	eax, [ebp+14h]
		mov	edx, [eax]
		mov	ecx, [ebp+8]
		mov	eax, [ebp-0Ch]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	eax, [ebp+0Ch]
		cmp	edx, eax
		jbe	short loc_4318BF
		mov	dword ptr [ebp-0Ch], 0

loc_4318BF:				; CODE XREF: .text:0043189Ej
					; .text:004318B6j
		mov	eax, [ebp-0Ch]
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43167B
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-8], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+1Ch]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+20h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+24h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_431947
		mov	dword ptr [esp+4], 3FFFh
		mov	eax, [ebp+28h]
		mov	[esp], eax
		call	sub_431654
		jmp	locret_431B58
; ---------------------------------------------------------------------------

loc_431947:				; CODE XREF: .text:0043192Dj
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp-18h], eax
		add	dword ptr [ebp-8], 1
		sub	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+24h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+24h]
		mov	[eax], edx
		mov	eax, [ebp-18h]
		and	eax, 0C0h
		mov	edx, eax
		sar	edx, 6
		mov	eax, [ebp+10h]
		mov	[eax], edx
		mov	eax, [ebp-18h]
		and	eax, 20h
		test	eax, eax
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+18h]
		mov	[eax], edx
		mov	eax, [ebp-18h]
		and	eax, 1Fh
		mov	[ebp-4], eax
		cmp	dword ptr [ebp-4], 1Fh
		jnz	short loc_4319FB
		mov	dword ptr [ebp-4], 0

loc_4319A3:				; CODE XREF: .text:004319F9j
		shl	dword ptr [ebp-4], 7
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4319C5
		mov	dword ptr [esp+4], 3FFFh
		mov	eax, [ebp+28h]
		mov	[esp], eax
		call	sub_431654
		jmp	locret_431B58
; ---------------------------------------------------------------------------

loc_4319C5:				; CODE XREF: .text:004319ABj
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp-18h], eax
		add	dword ptr [ebp-8], 1
		sub	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+24h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+24h]
		mov	[eax], edx
		mov	eax, [ebp-18h]
		and	eax, 7Fh
		or	[ebp-4], eax
		mov	eax, [ebp-18h]
		and	eax, 80h
		test	eax, eax
		jnz	short loc_4319A3

loc_4319FB:				; CODE XREF: .text:0043199Aj
		mov	edx, [ebp-4]
		mov	eax, [ebp+14h]
		mov	[eax], edx
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_431A21
		mov	dword ptr [esp+4], 3FFFh
		mov	eax, [ebp+28h]
		mov	[esp], eax
		call	sub_431654
		jmp	locret_431B58
; ---------------------------------------------------------------------------

loc_431A21:				; CODE XREF: .text:00431A07j
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp-18h], eax
		add	dword ptr [ebp-8], 1
		sub	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+24h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+24h]
		mov	[eax], edx
		mov	eax, [ebp-18h]
		and	eax, 80h
		test	eax, eax
		jnz	short loc_431A5B
		mov	edx, [ebp-18h]
		mov	eax, [ebp+20h]
		mov	[eax], edx
		jmp	loc_431B28
; ---------------------------------------------------------------------------

loc_431A5B:				; CODE XREF: .text:00431A4Cj
		cmp	dword ptr [ebp-18h], 80h
		jnz	short loc_431A72
		mov	eax, [ebp+1Ch]
		mov	dword ptr [eax], 1
		jmp	loc_431B28
; ---------------------------------------------------------------------------

loc_431A72:				; CODE XREF: .text:00431A62j
		cmp	dword ptr [ebp-18h], 0FFh
		jnz	short loc_431A93
		mov	dword ptr [esp+4], 86h
		mov	eax, [ebp+28h]
		mov	[esp], eax
		call	sub_431654
		jmp	locret_431B58
; ---------------------------------------------------------------------------

loc_431A93:				; CODE XREF: .text:00431A79j
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-18h]
		and	eax, 7Fh
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		cmp	eax, 4
		ja	short loc_431AB3
		mov	eax, [ebp-14h]
		cmp	eax, 4
		jbe	short loc_431B1A

loc_431AB3:				; CODE XREF: .text:00431AA9j
		mov	dword ptr [esp+4], 86h
		mov	eax, [ebp+28h]
		mov	[esp], eax
		call	sub_431654
		jmp	locret_431B58
; ---------------------------------------------------------------------------

loc_431ACB:				; CODE XREF: .text:00431B1Ej
		shl	dword ptr [ebp-10h], 8
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_431AEA
		mov	dword ptr [esp+4], 3FFFh
		mov	eax, [ebp+28h]
		mov	[esp], eax
		call	sub_431654
		jmp	short locret_431B58
; ---------------------------------------------------------------------------

loc_431AEA:				; CODE XREF: .text:00431AD3j
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp-18h], eax
		add	dword ptr [ebp-8], 1
		sub	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+24h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+24h]
		mov	[eax], edx
		mov	eax, [ebp-18h]
		and	eax, 0FFh
		or	[ebp-10h], eax
		sub	dword ptr [ebp-14h], 1

loc_431B1A:				; CODE XREF: .text:00431AB1j
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_431ACB
		mov	eax, [ebp+20h]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_431B28:				; CODE XREF: .text:00431A56j
					; .text:00431A6Dj
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_431B43
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_431B43
		mov	eax, [ebp+20h]
		mov	dword ptr [eax], 0

loc_431B43:				; CODE XREF: .text:00431B2Fj
					; .text:00431B38j
		mov	eax, [ebp+8]
		mov	edx, [ebp-8]
		mov	[eax], edx
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, 0

locret_431B58:				; CODE XREF: .text:00431942j
					; .text:004319C0j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_431B5A	proc near		; CODE XREF: .text:0042CCABp
					; .text:0042CCEBp ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		cmp	[ebp+var_8], 0
		jnz	short loc_431BB0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_431BA6
		mov	[esp+18h+var_14], 53h
		mov	eax, [ebp+arg_14]
		mov	[esp+18h+var_18], eax
		call	sub_431654
		jmp	short loc_431BAB
; ---------------------------------------------------------------------------

loc_431BA6:				; CODE XREF: sub_431B5A+35j
		mov	eax, 0

loc_431BAB:				; CODE XREF: sub_431B5A+4Aj
		jmp	locret_431D25
; ---------------------------------------------------------------------------

loc_431BB0:				; CODE XREF: sub_431B5A+2Cj
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_431BE9
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_8]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_431D25
; ---------------------------------------------------------------------------

loc_431BE9:				; CODE XREF: sub_431B5A+5Ej
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_431C4C
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_431C14
		mov	[esp+18h+var_14], 53h
		mov	eax, [ebp+arg_14]
		mov	[esp+18h+var_18], eax
		call	sub_431654
		jmp	locret_431D25
; ---------------------------------------------------------------------------

loc_431C14:				; CODE XREF: sub_431B5A+A0j
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_8]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_431D25
; ---------------------------------------------------------------------------

loc_431C4C:				; CODE XREF: sub_431B5A+97j
		mov	[ebp+var_C], 0
		jmp	short loc_431C7C
; ---------------------------------------------------------------------------

loc_431C55:				; CODE XREF: sub_431B5A+14Ej
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		add	eax, edx
		sub	eax, 30h
		mov	[ebp+var_C], eax
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1

loc_431C7C:				; CODE XREF: sub_431B5A+F9j
		cmp	[ebp+var_8], 0
		jz	short loc_431CAA
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_431CAA
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_431CAA
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_431CAA
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_431C55

loc_431CAA:				; CODE XREF: sub_431B5A+126j
					; sub_431B5A+130j ...
		cmp	[ebp+var_8], 0
		jz	short loc_431CBA
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_431CCF

loc_431CBA:				; CODE XREF: sub_431B5A+154j
		mov	[esp+18h+var_14], 53h
		mov	eax, [ebp+arg_14]
		mov	[esp+18h+var_18], eax
		call	sub_431654
		jmp	short locret_431D25
; ---------------------------------------------------------------------------

loc_431CCF:				; CODE XREF: sub_431B5A+15Ej
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_8]
		jbe	short loc_431CF4
		mov	[esp+18h+var_14], 53h
		mov	eax, [ebp+arg_14]
		mov	[esp+18h+var_18], eax
		call	sub_431654
		jmp	short locret_431D25
; ---------------------------------------------------------------------------

loc_431CF4:				; CODE XREF: sub_431B5A+183j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		sub	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_8]
		mov	[eax], edx
		mov	eax, 0

locret_431D25:				; CODE XREF: sub_431B5A:loc_431BABj
					; sub_431B5A+8Aj ...
		leave
		retn
sub_431B5A	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_431D28(char *)
sub_431D28	proc near		; CODE XREF: sub_432302+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_431D6B
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_431D61
; ---------------------------------------------------------------------------

loc_431D4D:				; CODE XREF: sub_431D28+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_431D5D
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_431D5D:				; CODE XREF: sub_431D28+2Dj
		add	[ebp+var_C], 1

loc_431D61:				; CODE XREF: sub_431D28+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_431D4D

loc_431D6B:				; CODE XREF: sub_431D28+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_431D28	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_431E41
; ---------------------------------------------------------------------------

loc_431D94:				; CODE XREF: .text:00431E45j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_431E39
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_431DE6
; ---------------------------------------------------------------------------

loc_431DDA:				; CODE XREF: .text:00431E16j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_431DE6:				; CODE XREF: .text:00431DD8j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_431E18
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_431DDA

loc_431E18:				; CODE XREF: .text:00431DEAj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_431E27
		mov	eax, [ebp-18h]
		jmp	short loc_431E50
; ---------------------------------------------------------------------------

loc_431E27:				; CODE XREF: .text:00431E20j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_431E39:				; CODE XREF: .text:00431DBEj
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_431E41:				; CODE XREF: .text:00431D8Fj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_431D94
		mov	eax, 0

loc_431E50:				; CODE XREF: .text:00431E25j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_431F1F
; ---------------------------------------------------------------------------

loc_431E7A:				; CODE XREF: .text:00431F23j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_432F39
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_432F39
		cmp	ebx, eax
		jnz	short loc_431F17
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_431EC8
; ---------------------------------------------------------------------------

loc_431EBC:				; CODE XREF: .text:00431EF4j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_431EC8:				; CODE XREF: .text:00431EBAj
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_431EF6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_432F39
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_432F39
		cmp	ebx, eax
		jz	short loc_431EBC

loc_431EF6:				; CODE XREF: .text:00431ECCj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_431F05
		mov	eax, [ebp-18h]
		jmp	short loc_431F2E
; ---------------------------------------------------------------------------

loc_431F05:				; CODE XREF: .text:00431EFEj
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_431F17:				; CODE XREF: .text:00431EA0j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_431F1F:				; CODE XREF: .text:00431E75j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_431E7A
		mov	eax, 0

loc_431F2E:				; CODE XREF: .text:00431F03j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_431F93
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_431F54
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp+8], eax

loc_431F54:				; CODE XREF: .text:00431F44j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_431F7D
; ---------------------------------------------------------------------------

loc_431F66:				; CODE XREF: .text:00431F8Bj
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_431F7D:				; CODE XREF: .text:00431F64j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_431F8D
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_431F66

loc_431F8D:				; CODE XREF: .text:00431F81j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_431F93:				; CODE XREF: .text:00431F3Ej
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_431F98	proc near		; CODE XREF: sub_4362AA+2FFp
					; sub_4362AA+3BCp

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_431FB0
; ---------------------------------------------------------------------------

loc_431FAC:				; CODE XREF: sub_431F98+37j
		add	[ebp+var_10], 1

loc_431FB0:				; CODE XREF: sub_431F98+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_431FD1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_431FAC

loc_431FD1:				; CODE XREF: sub_431F98+20j
		mov	[ebp+var_14], 0
		jmp	short loc_43200E
; ---------------------------------------------------------------------------

loc_431FDA:				; CODE XREF: sub_431F98+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_431FFF
		cmp	[ebp+var_14], 0
		jnz	short loc_432006
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_432006
; ---------------------------------------------------------------------------

loc_431FFF:				; CODE XREF: sub_431F98+57j
		mov	[ebp+var_14], 0

loc_432006:				; CODE XREF: sub_431F98+5Dj
					; sub_431F98+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_43200E:				; CODE XREF: sub_431F98+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_431FDA
		cmp	[ebp+var_14], 0
		jz	short loc_43202F
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_43202F:				; CODE XREF: sub_431F98+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_431F98	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432034	proc near		; CODE XREF: sub_42B9D7+24Ep
					; sub_42B9D7+2DCp ...

C		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_432079
; ---------------------------------------------------------------------------

loc_432049:				; CODE XREF: sub_432034+4Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_43206E
		cmp	[ebp+var_10], 0
		jnz	short loc_432075
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_432075
; ---------------------------------------------------------------------------

loc_43206E:				; CODE XREF: sub_432034+2Aj
		mov	[ebp+var_10], 0

loc_432075:				; CODE XREF: sub_432034+30j
					; sub_432034+38j
		add	[ebp+var_C], 1

loc_432079:				; CODE XREF: sub_432034+13j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_432049
		cmp	[ebp+var_10], 0
		jz	short loc_43208F
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0

loc_43208F:				; CODE XREF: sub_432034+53j
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_432034	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_432094(int, int, char	*)
sub_432094	proc near		; CODE XREF: .text:0043212Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4320E9
; ---------------------------------------------------------------------------

loc_4320B0:				; CODE XREF: sub_432094+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4320DA
		cmp	[ebp+var_10], 0
		jnz	short loc_4320E1
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_4320E1
; ---------------------------------------------------------------------------

loc_4320DA:				; CODE XREF: sub_432094+36j
		mov	[ebp+var_10], 0

loc_4320E1:				; CODE XREF: sub_432094+3Cj
					; sub_432094+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_4320E9:				; CODE XREF: sub_432094+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_4320B0
		cmp	[ebp+var_10], 0
		jz	short loc_43210B
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_43210E
; ---------------------------------------------------------------------------

loc_43210B:				; CODE XREF: sub_432094+61j
		mov	eax, [ebp+arg_4]

locret_43210E:				; CODE XREF: sub_432094+75j
		leave
		retn
sub_432094	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_446CF8 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432094
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_432132(int, int, char	*)
sub_432132	proc near		; CODE XREF: .text:004321C3p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_432187
; ---------------------------------------------------------------------------

loc_43214E:				; CODE XREF: sub_432132+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_432178
		cmp	[ebp+var_10], 0
		jnz	short loc_43217F
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_43217F
; ---------------------------------------------------------------------------

loc_432178:				; CODE XREF: sub_432132+36j
		mov	[ebp+var_10], 0

loc_43217F:				; CODE XREF: sub_432132+3Cj
					; sub_432132+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_432187:				; CODE XREF: sub_432132+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_43214E
		cmp	[ebp+var_10], 0
		jz	short loc_4321A3
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_4321A6
; ---------------------------------------------------------------------------

loc_4321A3:				; CODE XREF: sub_432132+61j
		mov	eax, [ebp+arg_4]

locret_4321A6:				; CODE XREF: sub_432132+6Fj
		leave
		retn
sub_432132	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_446CF8 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432132
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_432231
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_432231
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_432231
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		jmp	short locret_43223F
; ---------------------------------------------------------------------------

loc_432231:				; CODE XREF: .text:004321EAj
					; .text:00432206j ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xstrdup

locret_43223F:				; CODE XREF: .text:0043222Fj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4322A9
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4322A9
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4322A9
		mov	dword ptr [esp], offset	a_ ; "."
		call	gcry_xstrdup
		jmp	short locret_4322EE
; ---------------------------------------------------------------------------

loc_4322A9:				; CODE XREF: .text:00432261j
					; .text:0043227Dj ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_4322EE:				; CODE XREF: .text:004322A7j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4322F0	proc near		; CODE XREF: sub_432302+144p
					; sub_432302+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4322F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432302	proc near		; CODE XREF: sub_432667+23p
					; sub_432697+23p

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4323C9
; ---------------------------------------------------------------------------

loc_43234F:				; CODE XREF: sub_432302+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_4323C5
		cmp	[ebp+arg_0], 0
		jz	short loc_4323AE
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22_18 ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_4323AE:				; CODE XREF: sub_432302+8Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_43265D
; ---------------------------------------------------------------------------

loc_4323C5:				; CODE XREF: sub_432302+88j
		add	[ebp+var_C], 1

loc_4323C9:				; CODE XREF: sub_432302+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_43234F
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_432580
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_432423
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_432499

loc_432423:				; CODE XREF: sub_432302+112j
		mov	[esp+0C8h+VarName], offset aHome_0 ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_432454
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_4322F0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_432454:				; CODE XREF: sub_432302+134j
		cmp	[ebp+var_20], 0
		jz	loc_43257F
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_43257F
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_43257F
; ---------------------------------------------------------------------------

loc_432499:				; CODE XREF: sub_432302+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_4324B2
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax
		call	gcry_xstrdup
		mov	[ebp+Str], eax
		jmp	short loc_4324D3
; ---------------------------------------------------------------------------

loc_4324B2:				; CODE XREF: sub_432302+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax
		call	gcry_strdup
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_4324D3
		mov	eax, 0
		jmp	loc_43265D
; ---------------------------------------------------------------------------

loc_4324D3:				; CODE XREF: sub_432302+1AEj
					; sub_432302+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_4324F5
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_4324F5:				; CODE XREF: sub_432302+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_4322F0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		cmp	[ebp+var_20], 0
		jz	short loc_432576
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_432580
; ---------------------------------------------------------------------------

loc_432576:				; CODE XREF: sub_432302+248j
		mov	[ebp+var_14], 1
		jmp	short loc_432580
; ---------------------------------------------------------------------------

loc_43257F:				; CODE XREF: sub_432302+156j
					; sub_432302+164j ...
		nop

loc_432580:				; CODE XREF: sub_432302+101j
					; sub_432302+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_432596
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax
		call	gcry_xmalloc
		mov	[ebp+var_1C], eax
		jmp	short loc_4325BF
; ---------------------------------------------------------------------------

loc_432596:				; CODE XREF: sub_432302+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4325BF
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_43265D
; ---------------------------------------------------------------------------

loc_4325BF:				; CODE XREF: sub_432302+292j
					; sub_432302+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_4325F0
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_433245
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_433245
		mov	[ebp+var_24], eax
		jmp	short loc_432605
; ---------------------------------------------------------------------------

loc_4325F0:				; CODE XREF: sub_432302+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_433245
		mov	[ebp+var_24], eax

loc_432605:				; CODE XREF: sub_432302+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		mov	[ebp+var_C], 0
		jmp	short loc_432644
; ---------------------------------------------------------------------------

loc_432619:				; CODE XREF: sub_432302+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_433245
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_432644:				; CODE XREF: sub_432302+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_432619
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_431D28

loc_43265D:				; CODE XREF: sub_432302+BEj
					; sub_432302+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_432302	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432667	proc near		; CODE XREF: sub_402066+4CEp
					; sub_402066+A62p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 1
		call	sub_432302
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_432667	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432697	proc near		; CODE XREF: sub_406F3A+1A6p
					; sub_409A11+4Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 0
		call	sub_432302
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_432697	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4326C7	proc near		; CODE XREF: sub_403D1A+62p
					; .text:0043927Ep

C		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_43273C
; ---------------------------------------------------------------------------

loc_4326D0:				; CODE XREF: sub_4326C7+87j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_432734
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_432734
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_432720
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_432734

loc_432720:				; CODE XREF: sub_4326C7+4Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_432750
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_432750

loc_432734:				; CODE XREF: sub_4326C7+17j
					; sub_4326C7+43j ...
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_43273C:				; CODE XREF: sub_4326C7+7j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_432750
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4326D0

loc_432750:				; CODE XREF: sub_4326C7+61j
					; sub_4326C7+6Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_432764
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_432778

loc_432764:				; CODE XREF: sub_4326C7+91j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_43277F
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_43277F

loc_432778:				; CODE XREF: sub_4326C7+9Bj
		mov	eax, 0
		jmp	short loc_4327AD
; ---------------------------------------------------------------------------

loc_43277F:				; CODE XREF: sub_4326C7+A5j
					; sub_4326C7+AFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_4327AD:				; CODE XREF: sub_4326C7+B6j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_4326C7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4327E1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4327E1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_432838
; ---------------------------------------------------------------------------

loc_4327E1:				; CODE XREF: .text:004327C1j
					; .text:004327CBj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_432809
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_432809
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_432838
; ---------------------------------------------------------------------------

loc_432809:				; CODE XREF: .text:004327E9j
					; .text:004327F3j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_432831
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_432831
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_432838
; ---------------------------------------------------------------------------

loc_432831:				; CODE XREF: .text:00432811j
					; .text:0043281Bj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4328B5
; ---------------------------------------------------------------------------

loc_432838:				; CODE XREF: .text:004327DFj
					; .text:00432807j ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_432861
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_432861
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_4328B2
; ---------------------------------------------------------------------------

loc_432861:				; CODE XREF: .text:00432844j
					; .text:0043284Ej
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_432886
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_432886
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_4328B2
; ---------------------------------------------------------------------------

loc_432886:				; CODE XREF: .text:00432869j
					; .text:00432873j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4328AB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4328AB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_4328B2
; ---------------------------------------------------------------------------

loc_4328AB:				; CODE XREF: .text:0043288Ej
					; .text:00432898j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4328B5
; ---------------------------------------------------------------------------

loc_4328B2:				; CODE XREF: .text:0043285Fj
					; .text:00432884j ...
		mov	eax, [ebp-4]

locret_4328B5:				; CODE XREF: .text:00432836j
					; .text:004328B0j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4328B7(FILE *, int, int, int,	int)
sub_4328B7	proc near		; CODE XREF: sub_432A70+29p
					; .text:00432BADp

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_432A61
; ---------------------------------------------------------------------------

loc_4328CF:				; CODE XREF: sub_4328B7+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_43291D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_43291D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_43291D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_43291D
		cmp	[ebp+arg_C], 0
		jnz	short loc_43290F
		cmp	[ebp+arg_10], 0
		jz	loc_432A39

loc_43290F:				; CODE XREF: sub_4328B7+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_432A39

loc_43291D:				; CODE XREF: sub_4328B7+20j
					; sub_4328B7+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_43295A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_432A55
; ---------------------------------------------------------------------------

loc_43295A:				; CODE XREF: sub_4328B7+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_432980
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_432A55
; ---------------------------------------------------------------------------

loc_432980:				; CODE XREF: sub_4328B7+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_4329A6
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_432A55
; ---------------------------------------------------------------------------

loc_4329A6:				; CODE XREF: sub_4328B7+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_4329CC
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_432A55
; ---------------------------------------------------------------------------

loc_4329CC:				; CODE XREF: sub_4328B7+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_4329EF
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_432A55
; ---------------------------------------------------------------------------

loc_4329EF:				; CODE XREF: sub_4328B7+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_432A12
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_432A55
; ---------------------------------------------------------------------------

loc_432A12:				; CODE XREF: sub_4328B7+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_432A55
; ---------------------------------------------------------------------------

loc_432A39:				; CODE XREF: sub_4328B7+52j
					; sub_4328B7+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_432A55:				; CODE XREF: sub_4328B7+9Ej
					; sub_4328B7+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_432A61:				; CODE XREF: sub_4328B7+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_4328CF
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4328B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_432A70(FILE *, int, int, int)
sub_432A70	proc near		; CODE XREF: .text:0041E12Ap
					; sub_432AA0+B7p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_4328B7
		leave
		retn
sub_432A70	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_432AA0(FILE *, int, int, int)
sub_432AA0	proc near		; CODE XREF: sub_41E131+21p
					; .text:00432C59p

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_432AC9
; ---------------------------------------------------------------------------

loc_432AB6:				; CODE XREF: sub_432AA0+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_432AD3
		add	[ebp+var_C], 1

loc_432AC9:				; CODE XREF: sub_432AA0+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_432AB6
		jmp	short loc_432AD4
; ---------------------------------------------------------------------------

loc_432AD3:				; CODE XREF: sub_432AA0+23j
		nop

loc_432AD4:				; CODE XREF: sub_432AA0+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_432B3C
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_438D63
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_432B5C
; ---------------------------------------------------------------------------

loc_432B3C:				; CODE XREF: sub_432AA0+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_432A70

loc_432B5C:				; CODE XREF: sub_432AA0+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_432AA0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_432BB4
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4328B7
		jmp	short loc_432BB9
; ---------------------------------------------------------------------------

loc_432BB4:				; CODE XREF: .text:00432B6Dj
		mov	eax, 0

loc_432BB9:				; CODE XREF: .text:00432BB2j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_432C0A
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432A70
		jmp	short loc_432C0F
; ---------------------------------------------------------------------------

loc_432C0A:				; CODE XREF: .text:00432BCAj
		mov	eax, 0

loc_432C0F:				; CODE XREF: .text:00432C08j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_432C60
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432AA0
		jmp	short loc_432C65
; ---------------------------------------------------------------------------

loc_432C60:				; CODE XREF: .text:00432C20j
		mov	eax, 0

loc_432C65:				; CODE XREF: .text:00432C5Ej
		add	esp, 24h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432C6B	proc near		; CODE XREF: .text:0041E24Ap

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 1
		jmp	loc_432D15
; ---------------------------------------------------------------------------

loc_432C8F:				; CODE XREF: sub_432C6B+AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_432CC1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_432CC1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_432CC1
		cmp	[ebp+arg_8], 0
		jz	short loc_432D09
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_432D09

loc_432CC1:				; CODE XREF: sub_432C6B+2Cj
					; sub_432C6B+36j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_432CFD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_432CFD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_432CFD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_432CFD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_432CFD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_432D03

loc_432CFD:				; CODE XREF: sub_432C6B+5Ej
					; sub_432C6B+68j ...
		add	[ebp+var_10], 2
		jmp	short loc_432D0D
; ---------------------------------------------------------------------------

loc_432D03:				; CODE XREF: sub_432C6B+90j
		add	[ebp+var_10], 5
		jmp	short loc_432D0D
; ---------------------------------------------------------------------------

loc_432D09:				; CODE XREF: sub_432C6B+4Aj
					; sub_432C6B+54j
		add	[ebp+var_10], 1

loc_432D0D:				; CODE XREF: sub_432C6B+96j
					; sub_432C6B+9Cj
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_432D15:				; CODE XREF: sub_432C6B+1Fj
		cmp	[ebp+arg_4], 0
		jnz	loc_432C8F
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		jmp	loc_432E52
; ---------------------------------------------------------------------------

loc_432D44:				; CODE XREF: sub_432C6B+1EBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_432D7E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_432D7E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_432D7E
		cmp	[ebp+arg_8], 0
		jz	loc_432E39
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_432E39

loc_432D7E:				; CODE XREF: sub_432C6B+E1j
					; sub_432C6B+EBj ...
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_432DA1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_14], 1
		jmp	loc_432E4A
; ---------------------------------------------------------------------------

loc_432DA1:				; CODE XREF: sub_432C6B+125j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_432DBA
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	72h
		add	[ebp+var_14], 1
		jmp	loc_432E4A
; ---------------------------------------------------------------------------

loc_432DBA:				; CODE XREF: sub_432C6B+13Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_432DD0
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	66h
		add	[ebp+var_14], 1
		jmp	short loc_432E4A
; ---------------------------------------------------------------------------

loc_432DD0:				; CODE XREF: sub_432C6B+157j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_432DE6
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	76h
		add	[ebp+var_14], 1
		jmp	short loc_432E4A
; ---------------------------------------------------------------------------

loc_432DE6:				; CODE XREF: sub_432C6B+16Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_432DFC
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	62h
		add	[ebp+var_14], 1
		jmp	short loc_432E4A
; ---------------------------------------------------------------------------

loc_432DFC:				; CODE XREF: sub_432C6B+183j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_432E12
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		add	[ebp+var_14], 1
		jmp	short loc_432E4A
; ---------------------------------------------------------------------------

loc_432E12:				; CODE XREF: sub_432C6B+199j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_14], 3
		jmp	short loc_432E4A
; ---------------------------------------------------------------------------

loc_432E39:				; CODE XREF: sub_432C6B+FFj
					; sub_432C6B+10Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1

loc_432E4A:				; CODE XREF: sub_432C6B+131j
					; sub_432C6B+14Aj ...
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_432E52:				; CODE XREF: sub_432C6B+D4j
		cmp	[ebp+arg_4], 0
		jnz	loc_432D44
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		leave
		retn
sub_432C6B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432E67	proc near		; CODE XREF: sub_414492+29p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		jmp	short loc_432E93
; ---------------------------------------------------------------------------

loc_432E76:				; CODE XREF: sub_432E67+34j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_432E8F
		add	[ebp+var_4], 1

loc_432E8F:				; CODE XREF: sub_432E67+22j
		add	[ebp+arg_0], 1

loc_432E93:				; CODE XREF: sub_432E67+Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_432E76
		mov	eax, [ebp+var_4]
		leave
		retn
sub_432E67	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_432EA2(DWORD)
sub_432EA2	proc near		; CODE XREF: sub_403664+61p
					; sub_403664+CDp ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_432EB8
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_432EB8:				; CODE XREF: sub_432EA2+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_432EA2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_432F15
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_432F15
		mov	eax, 1
		jmp	short loc_432F1A
; ---------------------------------------------------------------------------

loc_432F15:				; CODE XREF: .text:00432F06j
					; .text:00432F0Cj
		mov	eax, 0

loc_432F1A:				; CODE XREF: .text:00432F13j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_432F32
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_432F32
		mov	eax, 1
		jmp	short loc_432F37
; ---------------------------------------------------------------------------

loc_432F32:				; CODE XREF: .text:00432F23j
					; .text:00432F29j
		mov	eax, 0

loc_432F37:				; CODE XREF: .text:00432F30j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432F39	proc near		; CODE XREF: .text:00431E86p
					; .text:00431E99p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_432F4C
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_432F4C
		and	[ebp+arg_0], 0FFFFFFDFh

loc_432F4C:				; CODE XREF: sub_432F39+7j
					; sub_432F39+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_432F39	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432F51	proc near		; CODE XREF: .text:00433056p
					; .text:0043306Ap

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_432F64
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_432F64
		or	[ebp+arg_0], 20h

loc_432F64:				; CODE XREF: sub_432F51+7j
					; sub_432F51+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_432F51	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432F69	proc near		; CODE XREF: sub_43802F+187p
					; sub_43802F+19Ep ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_432FC4
		mov	eax, 0
		jmp	loc_43301D
; ---------------------------------------------------------------------------

loc_432F82:				; CODE XREF: sub_432F69+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_432FBA
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_432F39
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_432F39
		cmp	ebx, eax
		jnz	short loc_432FDB

loc_432FBA:				; CODE XREF: sub_432F69+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_432FC5
; ---------------------------------------------------------------------------

loc_432FC4:				; CODE XREF: sub_432F69+Dj
		nop

loc_432FC5:				; CODE XREF: sub_432F69+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_432FDC
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_432F82
		jmp	short loc_432FDC
; ---------------------------------------------------------------------------

loc_432FDB:				; CODE XREF: sub_432F69+4Fj
		nop

loc_432FDC:				; CODE XREF: sub_432F69+64j
					; sub_432F69+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_433018
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_432F39
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_432F39
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_43301D
; ---------------------------------------------------------------------------

loc_433018:				; CODE XREF: sub_432F69+81j
		mov	eax, 0

loc_43301D:				; CODE XREF: sub_432F69+14j
					; sub_432F69+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_432F69	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_433043
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_43304A

loc_433043:				; CODE XREF: .text:0043303Bj
		mov	eax, 0
		jmp	short locret_4330A1
; ---------------------------------------------------------------------------

loc_43304A:				; CODE XREF: .text:00433041j
					; .text:00433091j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_432F51
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_432F51
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_433093
		cmp	byte ptr [ebp-9], 0
		jz	short loc_433093
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_43304A

loc_433093:				; CODE XREF: .text:0043307Aj
					; .text:00433080j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_4330A1:				; CODE XREF: .text:00433048j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4330A3	proc near		; CODE XREF: .text:00433224p
					; sub_43802F+14Ap

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_433153
		mov	eax, 0
		jmp	loc_433162
; ---------------------------------------------------------------------------

loc_4330CC:				; CODE XREF: sub_4330A3+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_433147
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_432F39
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_432F39
		cmp	ebx, eax
		jz	short loc_433147
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_433140
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_432F39
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_432F39
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_433145
; ---------------------------------------------------------------------------

loc_433140:				; CODE XREF: sub_4330A3+6Fj
		mov	eax, 0

loc_433145:				; CODE XREF: sub_4330A3+9Bj
		jmp	short loc_433162
; ---------------------------------------------------------------------------

loc_433147:				; CODE XREF: sub_4330A3+37j
					; sub_4330A3+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_433153:				; CODE XREF: sub_4330A3+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_4330CC
		mov	eax, 0

loc_433162:				; CODE XREF: sub_4330A3+24j
					; sub_4330A3:loc_433145j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_4330A3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_433194
		mov	eax, 0
		jmp	short loc_4331DB
; ---------------------------------------------------------------------------

loc_43317A:				; CODE XREF: .text:004331A7j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_4331AB
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_433195
; ---------------------------------------------------------------------------

loc_433194:				; CODE XREF: .text:00433171j
		nop

loc_433195:				; CODE XREF: .text:00433192j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4331AC
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43317A
		jmp	short loc_4331AC
; ---------------------------------------------------------------------------

loc_4331AB:				; CODE XREF: .text:00433188j
		nop

loc_4331AC:				; CODE XREF: .text:0043319Dj
					; .text:004331A9j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4331D6
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_4331DB
; ---------------------------------------------------------------------------

loc_4331D6:				; CODE XREF: .text:004331BAj
		mov	eax, 0

loc_4331DB:				; CODE XREF: .text:00433178j
					; .text:004331D4j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_4331EE
		mov	eax, [ebp+8]
		jmp	short locret_433243
; ---------------------------------------------------------------------------

loc_4331EE:				; CODE XREF: .text:004331E7j
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_43323E
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_433236
; ---------------------------------------------------------------------------

loc_433210:				; CODE XREF: .text:0043323Cj
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_4330A3
		test	eax, eax
		jnz	short loc_433232
		mov	eax, [ebp-4]
		jmp	short locret_433243
; ---------------------------------------------------------------------------

loc_433232:				; CODE XREF: .text:0043322Bj
		add	dword ptr [ebp-4], 1

loc_433236:				; CODE XREF: .text:0043320Ej
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_433210

loc_43323E:				; CODE XREF: .text:004331F4j
		mov	eax, 0

locret_433243:				; CODE XREF: .text:004331ECj
					; .text:00433230j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_433245	proc near		; CODE XREF: sub_401681+A1p
					; .text:0040C43Ap ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_43325D
; ---------------------------------------------------------------------------

loc_43324A:				; CODE XREF: sub_433245+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_43325D:				; CODE XREF: sub_433245+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43324A
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_433245	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_433290
		mov	eax, 0
		jmp	locret_43333B
; ---------------------------------------------------------------------------

loc_433290:				; CODE XREF: .text:00433284j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4332A7
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_433300

loc_4332A7:				; CODE XREF: .text:00433298j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_4332BF
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_433315
; ---------------------------------------------------------------------------

loc_4332BF:				; CODE XREF: .text:004332B4j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_4332D2
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_433315
; ---------------------------------------------------------------------------

loc_4332D2:				; CODE XREF: .text:004332C8j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4332E5
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_433315
; ---------------------------------------------------------------------------

loc_4332E5:				; CODE XREF: .text:004332DAj
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_433315
; ---------------------------------------------------------------------------

loc_433300:				; CODE XREF: .text:004332A5j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_433315:				; CODE XREF: .text:004332BDj
					; .text:004332D0j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_43332F
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_433338
; ---------------------------------------------------------------------------

loc_43332F:				; CODE XREF: .text:00433319j
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_433338:				; CODE XREF: .text:0043332Dj
		mov	eax, [ebp-10h]

locret_43333B:				; CODE XREF: .text:0043328Bj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43333D	proc near		; CODE XREF: sub_427B35+30p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		add	[ebp+var_4], eax
		jmp	short loc_43336C
; ---------------------------------------------------------------------------

loc_433351:				; CODE XREF: sub_43333D+33j
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_4]
		jnz	short loc_433368
		mov	eax, [ebp+var_4]
		jmp	short locret_433377
; ---------------------------------------------------------------------------

loc_433368:				; CODE XREF: sub_43333D+24j
		sub	[ebp+arg_8], 1

loc_43336C:				; CODE XREF: sub_43333D+12j
		cmp	[ebp+arg_8], 0
		jnz	short loc_433351
		mov	eax, 0

locret_433377:				; CODE XREF: sub_43333D+29j
		leave
		retn
sub_43333D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_433379(int, char *, int)
sub_433379	proc near		; CODE XREF: sub_43358E+1Bp
					; sub_4335B0+1Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_43338F
		mov	eax, 0
		jmp	locret_43358C
; ---------------------------------------------------------------------------

loc_43338F:				; CODE XREF: sub_433379+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_4333E5
; ---------------------------------------------------------------------------

loc_43339E:				; CODE XREF: sub_433379+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_4333DD
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_4333DD
		cmp	[ebp+arg_4], 0
		jz	short loc_4333E1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4333E1

loc_4333DD:				; CODE XREF: sub_433379+30j
					; sub_433379+3Dj
		add	[ebp+var_10], 1

loc_4333E1:				; CODE XREF: sub_433379+43j
					; sub_433379+62j
		add	[ebp+var_C], 1

loc_4333E5:				; CODE XREF: sub_433379+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43339E
		cmp	[ebp+arg_8], 0
		jz	short loc_433410
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		jmp	short loc_433436
; ---------------------------------------------------------------------------

loc_433410:				; CODE XREF: sub_433379+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_433436
		mov	eax, 0
		jmp	locret_43358C
; ---------------------------------------------------------------------------

loc_433436:				; CODE XREF: sub_433379+95j
					; sub_433379+B1j
		mov	[ebp+var_C], 0
		jmp	loc_433572
; ---------------------------------------------------------------------------

loc_433442:				; CODE XREF: sub_433379+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_433478
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_43356E
; ---------------------------------------------------------------------------

loc_433478:				; CODE XREF: sub_433379+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_4334AE
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_43356E
; ---------------------------------------------------------------------------

loc_4334AE:				; CODE XREF: sub_433379+107j
		cmp	[ebp+arg_4], 0
		jz	loc_43355C
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_43355C
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_43350F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_43351B
; ---------------------------------------------------------------------------

loc_43350F:				; CODE XREF: sub_433379+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_43351B:				; CODE XREF: sub_433379+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_433548
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_433554
; ---------------------------------------------------------------------------

loc_433548:				; CODE XREF: sub_433379+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_433554:				; CODE XREF: sub_433379+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_43356E
; ---------------------------------------------------------------------------

loc_43355C:				; CODE XREF: sub_433379+139j
					; sub_433379+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_43356E:				; CODE XREF: sub_433379+FAj
					; sub_433379+130j ...
		add	[ebp+arg_0], 1

loc_433572:				; CODE XREF: sub_433379+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_433442
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_43358C:				; CODE XREF: sub_433379+11j
					; sub_433379+B8j
		leave
		retn
sub_433379	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43358E(int, char *)
sub_43358E	proc near		; CODE XREF: sub_402066+CFBp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 1 ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_433379
		leave
		retn
sub_43358E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4335B0(int, char *)
sub_4335B0	proc near		; CODE XREF: sub_4074BA+502p
					; sub_40F697+22p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_433379
		leave
		retn
sub_4335B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4335D2	proc near		; CODE XREF: .text:00433721p
					; sub_43372E+32p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_43366B
; ---------------------------------------------------------------------------

loc_43361E:				; CODE XREF: sub_4335D2+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_433667
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_4336E6
; ---------------------------------------------------------------------------

loc_433667:				; CODE XREF: sub_4335D2+7Fj
		add	[ebp+var_C], 1

loc_43366B:				; CODE XREF: sub_4335D2+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_43361E
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4336E3
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4336D5
; ---------------------------------------------------------------------------

loc_4336B5:				; CODE XREF: sub_4335D2+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_433245
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_4336D5:				; CODE XREF: sub_4335D2+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_4336B5

loc_4336E3:				; CODE XREF: sub_4335D2+D2j
		mov	eax, [ebp+var_18]

loc_4336E6:				; CODE XREF: sub_4335D2+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_4335D2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_43370C
		mov	dword ptr [esp], offset	word_446D32
		call	gcry_strdup
		mov	[ebp-0Ch], eax
		jmp	short loc_433729
; ---------------------------------------------------------------------------

loc_43370C:				; CODE XREF: .text:004336F9j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4335D2
		mov	[ebp-0Ch], eax

loc_433729:				; CODE XREF: .text:0043370Aj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43372E	proc near		; CODE XREF: sub_41EB9F+3Fp
					; sub_41EDB9+1Ep ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_43374B
		mov	[esp+28h+Str], offset word_446D32
		call	gcry_xstrdup
		mov	[ebp+var_C], eax
		jmp	short loc_433768
; ---------------------------------------------------------------------------

loc_43374B:				; CODE XREF: sub_43372E+Aj
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_4335D2
		mov	[ebp+var_C], eax

loc_433768:				; CODE XREF: sub_43372E+1Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_4337DC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_4337A7
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 25h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_4337D0
; ---------------------------------------------------------------------------

loc_4337A7:				; CODE XREF: sub_43372E+4Cj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 16h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite

loc_4337D0:				; CODE XREF: sub_43372E+77j
		mov	[esp+28h+Str], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4337DC:				; CODE XREF: sub_43372E+3Ej
		mov	eax, [ebp+var_C]
		leave
		retn
sub_43372E	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4337E4(char *)
sub_4337E4	proc near		; CODE XREF: sub_4349AE+1Dp
					; sub_4352FB+Dp

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_433811
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_433811
		mov	eax, [ebp+var_C]
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433811:				; CODE XREF: sub_4337E4+19j
					; sub_4337E4+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_433837
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_433837
		mov	eax, [ebp+var_C]
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433837:				; CODE XREF: sub_4337E4+3Fj
					; sub_4337E4+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43385E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43385E
		mov	eax, [ebp+var_C]
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43385E:				; CODE XREF: sub_4337E4+66j
					; sub_4337E4+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_434324	; jumptable 004338A0 default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_4472EC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4338A2:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aAf_za ; jumptable 004338A0	case 54
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4338AC:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSq_al ; jumptable 004338A0	case 28
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4338B6:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aAm_et ; jumptable 004338A0	case 94
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4338C0:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		cmp	[ebp+var_1C], 10h ; jumptable 004338A0 case 1
		ja	loc_433979	; jumptable 004338D7 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_4474D4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4338D9:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_sa ; jumptable 004338D7	case 1
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4338E3:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_iq ; jumptable 004338D7	case 2
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4338ED:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_eg ; jumptable 004338D7	case 3
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4338F7:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_ly ; jumptable 004338D7	case 4
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433901:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_dz ; jumptable 004338D7	case 5
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43390B:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_ma ; jumptable 004338D7	case 6
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433915:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_tn ; jumptable 004338D7	case 7
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43391F:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_om ; jumptable 004338D7	case 8
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433929:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_ye ; jumptable 004338D7	case 9
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433933:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_sy ; jumptable 004338D7	case 10
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43393D:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_jo ; jumptable 004338D7	case 11
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433947:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_lb ; jumptable 004338D7	case 12
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433951:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_kw ; jumptable 004338D7	case 13
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43395B:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_ae ; jumptable 004338D7	case 14
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433965:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_bh ; jumptable 004338D7	case 15
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43396F:				; CODE XREF: sub_4337E4+F3j
					; DATA XREF: .rdata:off_4474D4o
		mov	eax, offset aAr_qa ; jumptable 004338D7	case 16
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433979:				; CODE XREF: sub_4337E4+E0j
					; sub_4337E4+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 004338D7 default case
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433983:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aHy_am ; jumptable 004338A0	case 43
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43398D:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aAs_in ; jumptable 004338A0	case 77
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433997:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 44
		cmp	eax, 1
		jz	short loc_4339A6
		cmp	eax, 2
		jz	short loc_4339B0
		jmp	short loc_4339BA
; ---------------------------------------------------------------------------

loc_4339A6:				; CODE XREF: sub_4337E4+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4339B0:				; CODE XREF: sub_4337E4+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4339BA:				; CODE XREF: sub_4337E4+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4339C4:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aEu	; jumptable 004338A0 case 45
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4339CE:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aBe_by ; jumptable 004338A0	case 35
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4339D8:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 69
		cmp	eax, 1
		jz	short loc_4339E7
		cmp	eax, 2
		jz	short loc_4339F1
		jmp	short loc_4339FB
; ---------------------------------------------------------------------------

loc_4339E7:				; CODE XREF: sub_4337E4+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4339F1:				; CODE XREF: sub_4337E4+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4339FB:				; CODE XREF: sub_4337E4+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A05:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aBg_bg ; jumptable 004338A0	case 2
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A0F:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aMy_mm ; jumptable 004338A0	case 85
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A19:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aKm_kh ; jumptable 004338A0	case 83
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A23:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aCa_es ; jumptable 004338A0	case 3
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A2D:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aChr_us ; jumptable	004338A0 case 92
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A37:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		cmp	[ebp+var_1C], 5	; jumptable 004338A0 case 4
		ja	short loc_433A7E ; jumptable 00433A4A default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_447518
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_433A4C:				; CODE XREF: sub_4337E4+266j
					; DATA XREF: .rdata:off_447518o
		mov	eax, offset aZh_tw ; jumptable 00433A4A	case 1
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A56:				; CODE XREF: sub_4337E4+266j
					; DATA XREF: .rdata:off_447518o
		mov	eax, offset aZh_cn ; jumptable 00433A4A	case 2
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A60:				; CODE XREF: sub_4337E4+266j
					; DATA XREF: .rdata:off_447518o
		mov	eax, offset aZh_hk ; jumptable 00433A4A	case 3
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A6A:				; CODE XREF: sub_4337E4+266j
					; DATA XREF: .rdata:off_447518o
		mov	eax, offset aZh_sg ; jumptable 00433A4A	case 4
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A74:				; CODE XREF: sub_4337E4+266j
					; DATA XREF: .rdata:off_447518o
		mov	eax, offset aZh_mo ; jumptable 00433A4A	case 5
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A7E:				; CODE XREF: sub_4337E4+257j
					; sub_4337E4+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 00433A4A default case
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433A88:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 26
		cmp	eax, 2
		jz	short loc_433AA4
		cmp	eax, 3
		jz	short loc_433AAE
		cmp	eax, 1
		jnz	short loc_433AB8
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433AA4:				; CODE XREF: sub_4337E4+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433AAE:				; CODE XREF: sub_4337E4+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433AB8:				; CODE XREF: sub_4337E4+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433AC2:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aCs_cz ; jumptable 004338A0	case 5
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433ACC:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aDa_dk ; jumptable 004338A0	case 6
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433AD6:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aDiv_mv ; jumptable	004338A0 case 101
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433AE0:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 19
		cmp	eax, 1
		jz	short loc_433AEF
		cmp	eax, 2
		jz	short loc_433AF9
		jmp	short loc_433B03
; ---------------------------------------------------------------------------

loc_433AEF:				; CODE XREF: sub_4337E4+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433AF9:				; CODE XREF: sub_4337E4+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B03:				; CODE XREF: sub_4337E4+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B0D:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aBin_ng ; jumptable	004338A0 case 102
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B17:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		cmp	[ebp+var_1C], 12h ; jumptable 004338A0 case 9
		ja	loc_433BE4	; jumptable 00433B2E default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_447530
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_433B30:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_us ; jumptable 00433B2E	case 1
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B3A:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_gb ; jumptable 00433B2E	case 2
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B44:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_au ; jumptable 00433B2E	case 3
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B4E:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_ca ; jumptable 00433B2E	case 4
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B58:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_nz ; jumptable 00433B2E	case 5
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B62:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_ie ; jumptable 00433B2E	case 6
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B6C:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_za ; jumptable 00433B2E	case 7
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B76:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_jm ; jumptable 00433B2E	case 8
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B80:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_gd ; jumptable 00433B2E	case 9
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B8A:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_bz ; jumptable 00433B2E	case 10
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B94:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_tt ; jumptable 00433B2E	case 11
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433B9E:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_zw ; jumptable 00433B2E	case 12
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433BA8:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_ph ; jumptable 00433B2E	case 13
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433BB2:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_id ; jumptable 00433B2E	case 14
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433BBC:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_hk ; jumptable 00433B2E	case 15
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433BC6:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_in ; jumptable 00433B2E	case 16
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433BD0:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_my ; jumptable 00433B2E	case 17
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433BDA:				; CODE XREF: sub_4337E4+34Aj
					; DATA XREF: .rdata:off_447530o
		mov	eax, offset aEn_sg ; jumptable 00433B2E	case 18
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433BE4:				; CODE XREF: sub_4337E4+337j
					; sub_4337E4+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn_0 ; jumptable 00433B2E default case
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433BEE:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aEt_ee ; jumptable 004338A0	case 37
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433BF8:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aFo_fo ; jumptable 004338A0	case 56
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C02:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aFa_ir ; jumptable 004338A0	case 41
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C0C:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aFi_fi ; jumptable 004338A0	case 11
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C16:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		cmp	[ebp+var_1C], 0Fh ; jumptable 004338A0 case 12
		ja	loc_433CC5	; jumptable 00433C2D default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_44757C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_433C2F:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_fr ; jumptable 00433C2D	case 1
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C39:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_be ; jumptable 00433C2D	case 2
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C43:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_ca ; jumptable 00433C2D	case 3
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C4D:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_ch ; jumptable 00433C2D	case 4
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C57:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_lu ; jumptable 00433C2D	case 5
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C61:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_mc ; jumptable 00433C2D	case 6
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C6B:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr	; jumptable 00433C2D case 7
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C75:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_re ; jumptable 00433C2D	case 8
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C7F:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_cg ; jumptable 00433C2D	case 9
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C89:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_sn ; jumptable 00433C2D	case 10
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C93:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_cm ; jumptable 00433C2D	case 11
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433C9D:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_ci ; jumptable 00433C2D	case 12
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433CA7:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_ml ; jumptable 00433C2D	case 13
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433CB1:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_ma ; jumptable 00433C2D	case 14
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433CBB:				; CODE XREF: sub_4337E4+449j
					; DATA XREF: .rdata:off_44757Co
		mov	eax, offset aFr_ht ; jumptable 00433C2D	case 15
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433CC5:				; CODE XREF: sub_4337E4+436j
					; sub_4337E4+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 00433C2D default case
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433CCF:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aFy_nl ; jumptable 004338A0	case 98
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433CD9:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aFul_ng ; jumptable	004338A0 case 103
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433CE3:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 60
		cmp	eax, 1
		jz	short loc_433CF2
		cmp	eax, 2
		jz	short loc_433CFC
		jmp	short loc_433D06
; ---------------------------------------------------------------------------

loc_433CF2:				; CODE XREF: sub_4337E4+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433CFC:				; CODE XREF: sub_4337E4+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D06:				; CODE XREF: sub_4337E4+50Cj
		mov	eax, offset aC_1 ; "C"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D10:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aGl_es ; jumptable 004338A0	case 86
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D1A:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aKa_ge ; jumptable 004338A0	case 55
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D24:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		cmp	[ebp+var_1C], 5	; jumptable 004338A0 case 7
		ja	short loc_433D6B ; jumptable 00433D37 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_4475BC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_433D39:				; CODE XREF: sub_4337E4+553j
					; DATA XREF: .rdata:off_4475BCo
		mov	eax, offset aDe_de ; jumptable 00433D37	case 1
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D43:				; CODE XREF: sub_4337E4+553j
					; DATA XREF: .rdata:off_4475BCo
		mov	eax, offset aDe_ch ; jumptable 00433D37	case 2
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D4D:				; CODE XREF: sub_4337E4+553j
					; DATA XREF: .rdata:off_4475BCo
		mov	eax, offset aDe_at ; jumptable 00433D37	case 3
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D57:				; CODE XREF: sub_4337E4+553j
					; DATA XREF: .rdata:off_4475BCo
		mov	eax, offset aDe_lu ; jumptable 00433D37	case 4
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D61:				; CODE XREF: sub_4337E4+553j
					; DATA XREF: .rdata:off_4475BCo
		mov	eax, offset aDe_li ; jumptable 00433D37	case 5
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D6B:				; CODE XREF: sub_4337E4+544j
					; sub_4337E4+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 00433D37 default case
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D75:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aEl_gr ; jumptable 004338A0	case 8
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D7F:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aGn_py ; jumptable 004338A0	case 116
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D89:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aGu_in ; jumptable 004338A0	case 71
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D93:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aHa_ng ; jumptable 004338A0	case 104
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433D9D:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aCpe_us ; jumptable	004338A0 case 117
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433DA7:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aHe_il ; jumptable 004338A0	case 13
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433DB1:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aHi_in ; jumptable 004338A0	case 57
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433DBB:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aHu_hu ; jumptable 004338A0	case 14
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433DC5:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aNic_ng ; jumptable	004338A0 case 105
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433DCF:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aIs_is ; jumptable 004338A0	case 15
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433DD9:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aIbo_ng ; jumptable	004338A0 case 112
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433DE3:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aId_id ; jumptable 004338A0	case 33
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433DED:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aIu_ca ; jumptable 004338A0	case 93
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433DF7:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 16
		cmp	eax, 1
		jz	short loc_433E06
		cmp	eax, 2
		jz	short loc_433E10
		jmp	short loc_433E1A
; ---------------------------------------------------------------------------

loc_433E06:				; CODE XREF: sub_4337E4+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E10:				; CODE XREF: sub_4337E4+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E1A:				; CODE XREF: sub_4337E4+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E24:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aJa_jp ; jumptable 004338A0	case 17
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E2E:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aKn_in ; jumptable 004338A0	case 75
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E38:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aKau_ng ; jumptable	004338A0 case 113
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E42:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 96
		cmp	eax, 1
		jz	short loc_433E51
		cmp	eax, 2
		jz	short loc_433E5B
		jmp	short loc_433E65
; ---------------------------------------------------------------------------

loc_433E51:				; CODE XREF: sub_4337E4+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E5B:				; CODE XREF: sub_4337E4+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E65:				; CODE XREF: sub_4337E4+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E6F:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aKk_kz ; jumptable 004338A0	case 63
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E79:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aKok_in ; jumptable	004338A0 case 87
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E83:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aKo_kr ; jumptable 004338A0	case 18
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E8D:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aKy_kg ; jumptable 004338A0	case 64
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433E97:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aLo_la ; jumptable 004338A0	case 84
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433EA1:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aLa_va ; jumptable 004338A0	case 118
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433EAB:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aLv_lv ; jumptable 004338A0	case 38
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433EB5:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aLt_lt ; jumptable 004338A0	case 39
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433EBF:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aMk_mk ; jumptable 004338A0	case 47
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433EC9:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 62
		cmp	eax, 1
		jz	short loc_433ED8
		cmp	eax, 2
		jz	short loc_433EE2
		jmp	short loc_433EEC
; ---------------------------------------------------------------------------

loc_433ED8:				; CODE XREF: sub_4337E4+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433EE2:				; CODE XREF: sub_4337E4+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433EEC:				; CODE XREF: sub_4337E4+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433EF6:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aMl_in ; jumptable 004338A0	case 76
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F00:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aMt_mt ; jumptable 004338A0	case 58
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F0A:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aMni_in ; jumptable	004338A0 case 88
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F14:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aMr_in ; jumptable 004338A0	case 78
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F1E:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aMn	; jumptable 004338A0 case 80
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F28:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 97
		cmp	eax, 1
		jz	short loc_433F37
		cmp	eax, 2
		jz	short loc_433F41
		jmp	short loc_433F4B
; ---------------------------------------------------------------------------

loc_433F37:				; CODE XREF: sub_4337E4+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F41:				; CODE XREF: sub_4337E4+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F4B:				; CODE XREF: sub_4337E4+751j
		mov	eax, offset aNe_0 ; "ne"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F55:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 20
		cmp	eax, 1
		jz	short loc_433F64
		cmp	eax, 2
		jz	short loc_433F6E
		jmp	short loc_433F78
; ---------------------------------------------------------------------------

loc_433F64:				; CODE XREF: sub_4337E4+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F6E:				; CODE XREF: sub_4337E4+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F78:				; CODE XREF: sub_4337E4+77Ej
		mov	eax, offset aNo_0 ; "no"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F82:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aOr_in ; jumptable 004338A0	case 72
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F8C:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aOm_et ; jumptable 004338A0	case 114
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433F96:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aPap_an ; jumptable	004338A0 case 121
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433FA0:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aPs	; jumptable 004338A0 case 99
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433FAA:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aPl_pl ; jumptable 004338A0	case 21
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433FB4:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 22
		cmp	eax, 1
		jz	short loc_433FCB
		cmp	eax, 2
		jnz	short loc_433FD5
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433FCB:				; CODE XREF: sub_4337E4+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433FD5:				; CODE XREF: sub_4337E4+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433FDF:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 70
		cmp	eax, 1
		jnz	short loc_433FF1
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433FF1:				; CODE XREF: sub_4337E4+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_433FFB:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aRm_ch ; jumptable 004338A0	case 23
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434005:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 24
		cmp	eax, 1
		jnz	short loc_434017
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434017:				; CODE XREF: sub_4337E4+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434021:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aRu	; jumptable 004338A0 case 25
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43402B:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSe_no ; jumptable 004338A0	case 59
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434035:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSa_in ; jumptable 004338A0	case 79
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43403F:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 89
		test	eax, eax
		jz	short loc_43404D
		cmp	eax, 1
		jz	short loc_434057
		jmp	short loc_434061
; ---------------------------------------------------------------------------

loc_43404D:				; CODE XREF: sub_4337E4+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434057:				; CODE XREF: sub_4337E4+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434061:				; CODE XREF: sub_4337E4+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43406B:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSi_lk ; jumptable 004338A0	case 91
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434075:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSk_sk ; jumptable 004338A0	case 27
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43407F:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSl_si ; jumptable 004338A0	case 36
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434089:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSo_so ; jumptable 004338A0	case 119
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434093:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aWen_de ; jumptable	004338A0 case 46
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43409D:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		cmp	[ebp+var_1C], 14h ; jumptable 004338A0 case 10
		ja	loc_43417E	; jumptable 004340B4 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_4475D4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4340B6:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_es ; jumptable 004340B4	case 1
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4340C0:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_mx ; jumptable 004340B4	case 2
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4340CA:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_es@modern ; jumptable 004340B4 case 3
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4340D4:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_gt ; jumptable 004340B4	case 4
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4340DE:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_cr ; jumptable 004340B4	case 5
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4340E8:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_pa ; jumptable 004340B4	case 6
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4340F2:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_do ; jumptable 004340B4	case 7
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4340FC:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_ve ; jumptable 004340B4	case 8
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434106:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_co ; jumptable 004340B4	case 9
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434110:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_pe ; jumptable 004340B4	case 10
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43411A:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_ar ; jumptable 004340B4	case 11
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434124:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_ec ; jumptable 004340B4	case 12
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43412E:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_cl ; jumptable 004340B4	case 13
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434138:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_uy ; jumptable 004340B4	case 14
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434142:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_py ; jumptable 004340B4	case 15
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43414C:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_bo ; jumptable 004340B4	case 16
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434156:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_sv ; jumptable 004340B4	case 17
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434160:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_hn ; jumptable 004340B4	case 18
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43416A:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_ni ; jumptable 004340B4	case 19
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434174:				; CODE XREF: sub_4337E4+8D0j
					; DATA XREF: .rdata:off_4475D4o
		mov	eax, offset aEs_pr ; jumptable 004340B4	case 20
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43417E:				; CODE XREF: sub_4337E4+8BDj
					; sub_4337E4+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 004340B4 default case
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434188:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aBnt_tz ; jumptable	004338A0 case 48
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434192:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSw_ke ; jumptable 004338A0	case 65
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43419C:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 29
		cmp	eax, 1
		jz	short loc_4341AB
		cmp	eax, 2
		jz	short loc_4341B5
		jmp	short loc_4341BF
; ---------------------------------------------------------------------------

loc_4341AB:				; CODE XREF: sub_4337E4+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4341B5:				; CODE XREF: sub_4337E4+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4341BF:				; CODE XREF: sub_4337E4+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4341C9:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSyr_tr ; jumptable	004338A0 case 90
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4341D3:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTl_ph ; jumptable 004338A0	case 100
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4341DD:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTg_tj ; jumptable 004338A0	case 40
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4341E7:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 95
		cmp	eax, 1
		jz	short loc_4341F6
		cmp	eax, 2
		jz	short loc_434200
		jmp	short loc_43420A
; ---------------------------------------------------------------------------

loc_4341F6:				; CODE XREF: sub_4337E4+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434200:				; CODE XREF: sub_4337E4+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43420A:				; CODE XREF: sub_4337E4+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434214:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTa	; jumptable 004338A0 case 73
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43421E:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTt_ru ; jumptable 004338A0	case 68
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434228:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTe_in ; jumptable 004338A0	case 74
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434232:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTh_th ; jumptable 004338A0	case 30
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43423C:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aBo_cn ; jumptable 004338A0	case 81
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434246:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 115
		test	eax, eax
		jz	short loc_434254
		cmp	eax, 1
		jz	short loc_43425E
		jmp	short loc_434268
; ---------------------------------------------------------------------------

loc_434254:				; CODE XREF: sub_4337E4+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43425E:				; CODE XREF: sub_4337E4+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434268:				; CODE XREF: sub_4337E4+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434272:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTs_za ; jumptable 004338A0	case 49
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43427C:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTn_bw ; jumptable 004338A0	case 50
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434286:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTr_tr ; jumptable 004338A0	case 31
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_434290:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aTk_tm ; jumptable 004338A0	case 66
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_43429A:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aUk_ua ; jumptable 004338A0	case 34
		jmp	locret_434329
; ---------------------------------------------------------------------------

loc_4342A4:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 32
		cmp	eax, 1
		jz	short loc_4342B3
		cmp	eax, 2
		jz	short loc_4342BA
		jmp	short loc_4342C1
; ---------------------------------------------------------------------------

loc_4342B3:				; CODE XREF: sub_4337E4+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_4342BA:				; CODE XREF: sub_4337E4+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_4342C1:				; CODE XREF: sub_4337E4+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_4342C8:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, [ebp+var_1C] ; jumptable 004338A0 case 67
		cmp	eax, 1
		jz	short loc_4342D7
		cmp	eax, 2
		jz	short loc_4342DE
		jmp	short loc_4342E5
; ---------------------------------------------------------------------------

loc_4342D7:				; CODE XREF: sub_4337E4+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_4342DE:				; CODE XREF: sub_4337E4+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_4342E5:				; CODE XREF: sub_4337E4+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_4342EC:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aVen_za ; jumptable	004338A0 case 51
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_4342F3:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aVi_vn ; jumptable 004338A0	case 42
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_4342FA:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aCy_gb ; jumptable 004338A0	case 82
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_434301:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aXh_za ; jumptable 004338A0	case 52
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_434308:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aSit_cn ; jumptable	004338A0 case 120
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_43430F:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aYi_il ; jumptable 004338A0	case 61
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_434316:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aYo_ng ; jumptable 004338A0	case 106
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_43431D:				; CODE XREF: sub_4337E4+BCj
					; DATA XREF: .rdata:off_4472ECo
		mov	eax, offset aZu_za ; jumptable 004338A0	case 53
		jmp	short locret_434329
; ---------------------------------------------------------------------------

loc_434324:				; CODE XREF: sub_4337E4+A9j
					; sub_4337E4+BCj
					; DATA XREF: ...
		mov	eax, offset aC_1 ; jumptable 004338A0 default case

locret_434329:				; CODE XREF: sub_4337E4+28j
					; sub_4337E4+4Ej ...
		leave
		retn
sub_4337E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43432B	proc near		; CODE XREF: sub_43440A+1EAp
					; sub_43440A+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_43432B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43435A	proc near		; CODE XREF: sub_434FD9+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_4343A3
; ---------------------------------------------------------------------------

loc_43436F:				; CODE XREF: sub_43435A+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4343A3
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_4343A3:				; CODE XREF: sub_43435A+13j
					; sub_43435A+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43436F
		mov	eax, [ebp+var_4]
		leave
		retn
sub_43435A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4343B2	proc near		; CODE XREF: sub_4349AE+243p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_4343F7
; ---------------------------------------------------------------------------

loc_4343DE:				; CODE XREF: sub_4343B2+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_4343F7:				; CODE XREF: sub_4343B2+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_4343DE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		leave
		retn
sub_4343B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43440A(char *)
sub_43440A	proc near		; CODE XREF: sub_4349AE+214p

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset aRb_2 ; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_434447
		mov	eax, 0
		jmp	loc_43473E
; ---------------------------------------------------------------------------

loc_434447:				; CODE XREF: sub_43440A+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_434490
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_434490
		cmp	[ebp+var_20], 1Bh
		ja	short loc_4344A5

loc_434490:				; CODE XREF: sub_43440A+5Bj
					; sub_43440A+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_43473E
; ---------------------------------------------------------------------------

loc_4344A5:				; CODE XREF: sub_43440A+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_4344BE
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax
		call	gcry_malloc
		jmp	short loc_4344C3
; ---------------------------------------------------------------------------

loc_4344BE:				; CODE XREF: sub_43440A+A3j
		mov	eax, 0

loc_4344C3:				; CODE XREF: sub_43440A+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4344E1
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_43473E
; ---------------------------------------------------------------------------

loc_4344E1:				; CODE XREF: sub_43440A+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_4344ED:				; CODE XREF: sub_43440A+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_434539
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_43473E
; ---------------------------------------------------------------------------

loc_434539:				; CODE XREF: sub_43440A+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4344ED
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_434583
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_434583
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_43473E
; ---------------------------------------------------------------------------

loc_434583:				; CODE XREF: sub_43440A+156j
					; sub_43440A+162j
		mov	[esp+68h+Mode],	28h
		mov	[esp+68h+Filename], 1
		call	gcry_calloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4345B5
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_43473E
; ---------------------------------------------------------------------------

loc_4345B5:				; CODE XREF: sub_43440A+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4345FB
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_43432B
		jmp	short loc_434601
; ---------------------------------------------------------------------------

loc_4345FB:				; CODE XREF: sub_43440A+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_434601:				; CODE XREF: sub_43440A+1EFj
		test	eax, eax
		jnz	loc_434701
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_434623
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_43432B
		jmp	short loc_434629
; ---------------------------------------------------------------------------

loc_434623:				; CODE XREF: sub_43440A+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_434629:				; CODE XREF: sub_43440A+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_434649
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_43432B
		jmp	short loc_43464F
; ---------------------------------------------------------------------------

loc_434649:				; CODE XREF: sub_43440A+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_43464F:				; CODE XREF: sub_43440A+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_434674
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_43432B
		jmp	short loc_43467A
; ---------------------------------------------------------------------------

loc_434674:				; CODE XREF: sub_43440A+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_43467A:				; CODE XREF: sub_43440A+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43469F
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_43432B
		jmp	short loc_4346A5
; ---------------------------------------------------------------------------

loc_43469F:				; CODE XREF: sub_43440A+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_4346A5:				; CODE XREF: sub_43440A+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4346C5
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_43432B
		jmp	short loc_4346CB
; ---------------------------------------------------------------------------

loc_4346C5:				; CODE XREF: sub_43440A+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_4346CB:				; CODE XREF: sub_43440A+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4
		mov	[esp+68h+Filename], eax
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_43473B
		jmp	short loc_43471E
; ---------------------------------------------------------------------------

loc_434701:				; CODE XREF: sub_43440A+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_43473E
; ---------------------------------------------------------------------------

loc_43471E:				; CODE XREF: sub_43440A+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_43473E
; ---------------------------------------------------------------------------

loc_43473B:				; CODE XREF: sub_43440A+2F3j
		mov	eax, [ebp+var_18]

loc_43473E:				; CODE XREF: sub_43440A+38j
					; sub_43440A+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_43440A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434745(LPCSTR, int, int)
sub_434745	proc near		; CODE XREF: sub_43493C+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_434795
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_43479F

loc_434795:				; CODE XREF: sub_434745+44j
		mov	eax, 0
		jmp	locret_434845
; ---------------------------------------------------------------------------

loc_43479F:				; CODE XREF: sub_434745+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_4347CF
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_434845
; ---------------------------------------------------------------------------

loc_4347CF:				; CODE XREF: sub_434745+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4347EA
		mov	eax, 0
		jmp	short locret_434845
; ---------------------------------------------------------------------------

loc_4347EA:				; CODE XREF: sub_434745+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_43483A
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax
		call	gcry_free
		mov	eax, 0
		jmp	short locret_434845
; ---------------------------------------------------------------------------

loc_43483A:				; CODE XREF: sub_434745+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_434845:				; CODE XREF: sub_434745+55j
					; sub_434745+88j ...
		leave
		retn
sub_434745	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434847(LPCWSTR, int, int)
sub_434847	proc near		; CODE XREF: sub_43493C+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_4348A7
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_4348B1

loc_4348A7:				; CODE XREF: sub_434847+54j
		mov	eax, 0
		jmp	locret_43493A
; ---------------------------------------------------------------------------

loc_4348B1:				; CODE XREF: sub_434847+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4348CF
		mov	eax, 0
		jmp	short locret_43493A
; ---------------------------------------------------------------------------

loc_4348CF:				; CODE XREF: sub_434847+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_43492F
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax
		call	gcry_free
		mov	eax, 0
		jmp	short locret_43493A
; ---------------------------------------------------------------------------

loc_43492F:				; CODE XREF: sub_434847+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_43493A:				; CODE XREF: sub_434847+65j
					; sub_434847+86j ...
		leave
		retn
sub_434847	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43493C(LPCSTR, int, int)
sub_43493C	proc near		; CODE XREF: sub_434C6E+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_434745
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43498D
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_434847
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short loc_434994
; ---------------------------------------------------------------------------

loc_43498D:				; CODE XREF: sub_43493C+26j
		mov	[ebp+var_C], 0

loc_434994:				; CODE XREF: sub_43493C+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_43499F
		mov	eax, [ebp+var_14]
		jmp	short loc_4349A4
; ---------------------------------------------------------------------------

loc_43499F:				; CODE XREF: sub_43493C+5Cj
		mov	eax, 0

loc_4349A4:				; CODE XREF: sub_43493C+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_43493C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4349AE(char *, char *)
sub_4349AE	proc near		; CODE XREF: sub_41DE5C+16p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_10], 0
		mov	[ebp+Str], 0
		mov	[esp+48h+Dest],	offset aLc_messages_0 ;	"LC_MESSAGES"
		call	sub_4337E4
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_434A40
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_434A40
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	[esp+48h+Source], 5Fh ;	Val
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Str
		call	strchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_434A40
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0

loc_434A40:				; CODE XREF: sub_4349AE+29j
					; sub_4349AE+5Cj ...
		cmp	[ebp+Str], 0
		jnz	short loc_434A50
		mov	eax, 0
		jmp	loc_434C01
; ---------------------------------------------------------------------------

loc_434A50:				; CODE XREF: sub_4349AE+96j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_434AE0
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_434C01
; ---------------------------------------------------------------------------

loc_434AE0:				; CODE XREF: sub_4349AE+11Bj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1
		mov	eax, [ebp+Str]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset aLc_messages_1 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp+var_24]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	[ebp+var_24], 0Dh
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp+var_24]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_43440A
		mov	[ebp+var_10], eax
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, ds:dword_449480
		test	eax, eax
		jz	short loc_434BF6
		mov	eax, ds:dword_449480
		mov	[esp+48h+Dest],	eax
		call	sub_4343B2

loc_434BF6:				; CODE XREF: sub_4349AE+239j
		mov	eax, [ebp+var_10]
		mov	ds:dword_449480, eax
		mov	eax, [ebp+arg_4]

loc_434C01:				; CODE XREF: sub_4349AE+9Dj
					; sub_4349AE+12Dj
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4349AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434C08(char *, int, int)
sub_434C08	proc near		; CODE XREF: sub_434C6E+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_434C63
; ---------------------------------------------------------------------------

loc_434C1D:				; CODE XREF: sub_434C08+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_434C4A
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_434C6C
; ---------------------------------------------------------------------------

loc_434C4A:				; CODE XREF: sub_434C08+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_434C63:				; CODE XREF: sub_434C08+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_434C1D
		mov	eax, [ebp+arg_0]

locret_434C6C:				; CODE XREF: sub_434C08+40j
		leave
		retn
sub_434C08	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_434C6E	proc near		; CODE XREF: sub_434FD9+158p
					; sub_434FD9+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_449484
		test	eax, eax
		jz	short loc_434CFA
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_434CA8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_43432B
		jmp	short loc_434CB9
; ---------------------------------------------------------------------------

loc_434CA8:				; CODE XREF: sub_434C6E+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_434CB9:				; CODE XREF: sub_434C6E+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_434CE2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_43432B
		jmp	short loc_434CF2
; ---------------------------------------------------------------------------

loc_434CE2:				; CODE XREF: sub_434C6E+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_434CF2:				; CODE XREF: sub_434C6E+72j
		mov	[ebp+var_14], eax
		jmp	loc_434FA9
; ---------------------------------------------------------------------------

loc_434CFA:				; CODE XREF: sub_434C6E+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_434EEF
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_434D3C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_43432B
		jmp	short loc_434D4D
; ---------------------------------------------------------------------------

loc_434D3C:				; CODE XREF: sub_434C6E+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_434D4D:				; CODE XREF: sub_434C6E+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_434D76
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_43432B
		jmp	short loc_434D86
; ---------------------------------------------------------------------------

loc_434D76:				; CODE XREF: sub_434C6E+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_434D86:				; CODE XREF: sub_434C6E+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_43493C
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_434DBE
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_434EDF
; ---------------------------------------------------------------------------

loc_434DBE:				; CODE XREF: sub_434C6E+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_434E50
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_434E50
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_434DFD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_43432B
		jmp	short loc_434E0E
; ---------------------------------------------------------------------------

loc_434DFD:				; CODE XREF: sub_434C6E+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_434E0E:				; CODE XREF: sub_434C6E+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_434EDF
; ---------------------------------------------------------------------------

loc_434E50:				; CODE XREF: sub_434C6E+156j
					; sub_434C6E+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_434ED1
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_434EDF
; ---------------------------------------------------------------------------

loc_434ED1:				; CODE XREF: sub_434C6E+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_434EDF:				; CODE XREF: sub_434C6E+14Bj
					; sub_434C6E+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		jmp	loc_434FA9
; ---------------------------------------------------------------------------

loc_434EEF:				; CODE XREF: sub_434C6E+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_434F55
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_434F22
; ---------------------------------------------------------------------------

loc_434F0F:				; CODE XREF: sub_434C6E+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_434F2A
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_434F22:				; CODE XREF: sub_434C6E+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_434F0F
		jmp	short loc_434F2B
; ---------------------------------------------------------------------------

loc_434F2A:				; CODE XREF: sub_434C6E+2AAj
		nop

loc_434F2B:				; CODE XREF: sub_434C6E+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_434F45
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_434FA9
; ---------------------------------------------------------------------------

loc_434F45:				; CODE XREF: sub_434C6E+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_434FA9
; ---------------------------------------------------------------------------

loc_434F55:				; CODE XREF: sub_434C6E+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_434F80
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_43432B
		jmp	short loc_434F91
; ---------------------------------------------------------------------------

loc_434F80:				; CODE XREF: sub_434C6E+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_434F91:				; CODE XREF: sub_434C6E+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_434FA9:				; CODE XREF: sub_434C6E+87j
					; sub_434C6E+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_434FD0
		cmp	[ebp+var_14], 0
		jz	short loc_434FD0
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_434C08
		jmp	short loc_434FD3
; ---------------------------------------------------------------------------

loc_434FD0:				; CODE XREF: sub_434C6E+33Fj
					; sub_434C6E+345j
		mov	eax, [ebp+var_10]

loc_434FD3:				; CODE XREF: sub_434C6E+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_434C6E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434FD9(char *, int, int)
sub_434FD9	proc near		; CODE XREF: sub_435294+1Cp
					; .text:004352D3p ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_449480
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_43526B
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_4351A4
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_4351A4
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_43435A
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_435163
; ---------------------------------------------------------------------------

loc_435073:				; CODE XREF: sub_434FD9+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_43513B
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4350AA
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_43432B
		jmp	short loc_4350BA
; ---------------------------------------------------------------------------

loc_4350AA:				; CODE XREF: sub_434FD9+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_4350BA:				; CODE XREF: sub_434FD9+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_43513B
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4350E9
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_43432B
		jmp	short loc_4350FA
; ---------------------------------------------------------------------------

loc_4350E9:				; CODE XREF: sub_434FD9+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_4350FA:				; CODE XREF: sub_434FD9+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_43513B
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_434C6E
		jmp	loc_435285
; ---------------------------------------------------------------------------

loc_43513B:				; CODE XREF: sub_434FD9+A7j
					; sub_434FD9+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_43515D
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_435163
; ---------------------------------------------------------------------------

loc_43515D:				; CODE XREF: sub_434FD9+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_435163:				; CODE XREF: sub_434FD9+95j
					; sub_434FD9+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_435187
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_43432B
		jmp	short loc_435197
; ---------------------------------------------------------------------------

loc_435187:				; CODE XREF: sub_434FD9+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_435197:				; CODE XREF: sub_434FD9+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_435073

loc_4351A4:				; CODE XREF: sub_434FD9+23j
					; sub_434FD9+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_43525D
; ---------------------------------------------------------------------------

loc_4351B9:				; CODE XREF: sub_434FD9+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4351F0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_43432B
		jmp	short loc_435201
; ---------------------------------------------------------------------------

loc_4351F0:				; CODE XREF: sub_434FD9+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_435201:				; CODE XREF: sub_434FD9+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_435223
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_43525D
; ---------------------------------------------------------------------------

loc_435223:				; CODE XREF: sub_434FD9+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_435234
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_43525D
; ---------------------------------------------------------------------------

loc_435234:				; CODE XREF: sub_434FD9+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_434C6E
		jmp	short loc_435285
; ---------------------------------------------------------------------------

loc_43525D:				; CODE XREF: sub_434FD9+1DBj
					; sub_434FD9+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_4351B9
		jmp	short loc_43526C
; ---------------------------------------------------------------------------

loc_43526B:				; CODE XREF: sub_434FD9+14j
		nop

loc_43526C:				; CODE XREF: sub_434FD9+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_435282
		cmp	[ebp+arg_8], 1
		jnz	short loc_43527D
		mov	eax, [ebp+arg_0]
		jmp	short loc_435280
; ---------------------------------------------------------------------------

loc_43527D:				; CODE XREF: sub_434FD9+29Dj
		mov	eax, [ebp+arg_4]

loc_435280:				; CODE XREF: sub_434FD9+2A2j
		jmp	short loc_435285
; ---------------------------------------------------------------------------

loc_435282:				; CODE XREF: sub_434FD9+297j
		mov	eax, [ebp+arg_0]

loc_435285:				; CODE XREF: sub_434FD9+15Dj
					; sub_434FD9+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_434FD9	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435294(char *)
sub_435294	proc near		; CODE XREF: sub_401748+41p
					; sub_401748+7Ep ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_434FD9
		leave
		retn
sub_435294	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_434FD9
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4352DA(char *, int, int)
sub_4352DA	proc near		; CODE XREF: sub_414492+64p
					; sub_414492+FAp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_434FD9
		leave
		retn
sub_4352DA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4352FB	proc near		; CODE XREF: sub_4315D4+8p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], offset aLc_messages_0	; "LC_MESSAGES"
		call	sub_4337E4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43531B
		mov	eax, [ebp+var_C]
		jmp	short locret_435320
; ---------------------------------------------------------------------------

loc_43531B:				; CODE XREF: sub_4352FB+19j
		mov	eax, offset byte_4476AB

locret_435320:				; CODE XREF: sub_4352FB+1Ej
		leave
		retn
sub_4352FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_435322	proc near		; CODE XREF: sub_41DE79+Dp
					; sub_41DE92+Dp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_449484, eax
		pop	ebp
		retn
sub_435322	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_435330	proc near		; CODE XREF: sub_402066+B4Cp
					; sub_4032E4+5Ap

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_44952C
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_43534E
		mov	ds:dword_44952C, 0

loc_43534E:				; CODE XREF: sub_435330+12j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_435330	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_44952C
		add	eax, 1
		mov	ds:dword_44952C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435365(char *Filename, int FileHandle)
sub_435365	proc near		; CODE XREF: sub_4355C4+21p
					; .text:00435600p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_4353AF
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_4353A5
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_4353A5
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_4353A5:				; CODE XREF: sub_435365+20j
					; sub_435365+31j
		mov	ds:File, 0

loc_4353AF:				; CODE XREF: sub_435365+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_4353F7
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_4476AC ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4353F7
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_4353F7:				; CODE XREF: sub_435365+4Ej
					; sub_435365+76j
		cmp	[ebp+Filename],	0
		jz	short loc_43544D
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_435439
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_435439
		mov	eax, 1
		jmp	short loc_43543E
; ---------------------------------------------------------------------------

loc_435439:				; CODE XREF: sub_435365+BEj
					; sub_435365+CBj
		mov	eax, 0

loc_43543E:				; CODE XREF: sub_435365+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_435454
		add	[ebp+Filename],	9
		jmp	short loc_435454
; ---------------------------------------------------------------------------

loc_43544D:				; CODE XREF: sub_435365+96j
		mov	[ebp+var_10], 0

loc_435454:				; CODE XREF: sub_435365+E0j
					; sub_435365+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_435490
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_4354EB
; ---------------------------------------------------------------------------

loc_435490:				; CODE XREF: sub_435365+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_4354AF
		mov	eax, offset aA_3 ; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_4354EB
; ---------------------------------------------------------------------------

loc_4354AF:				; CODE XREF: sub_435365+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_4354C2
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_4354EB
; ---------------------------------------------------------------------------

loc_4354C2:				; CODE XREF: sub_435365+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_4354D5
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_4354EB
; ---------------------------------------------------------------------------

loc_4354D5:				; CODE XREF: sub_435365+161j
		mov	[esp+28h+Size],	offset aA_3 ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_4354EB:				; CODE XREF: sub_435365+129j
					; sub_435365+148j ...
		mov	dword_43D890, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_435580
		cmp	[ebp+Filename],	0
		jz	short loc_43553D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_435573
; ---------------------------------------------------------------------------

loc_43553D:				; CODE XREF: sub_435365+19Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_435573:				; CODE XREF: sub_435365+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_4355A3
; ---------------------------------------------------------------------------

loc_435580:				; CODE XREF: sub_435365+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_4355A3:				; CODE XREF: sub_435365+219j
		mov	eax, [ebp+var_C]
		mov	ds:File, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_449524, eax
		mov	ds:dword_449528, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_435365	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4355C4(char *)
sub_4355C4	proc near		; CODE XREF: sub_401BF8+301p
					; sub_402066+F62p ...

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_4355D5
		mov	eax, [ebp+arg_0]
		jmp	short loc_4355DA
; ---------------------------------------------------------------------------

loc_4355D5:				; CODE XREF: sub_4355C4+Aj
		mov	eax, offset asc_4476AC ; "-"

loc_4355DA:				; CODE XREF: sub_4355C4+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_435365
		leave
		retn
sub_4355C4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_435365
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_44951C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435614(char *, int)
sub_435614	proc near		; CODE XREF: sub_402066+DFp
					; sub_402066+F29p ...

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_435642
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset Dest ; Dest
		call	strncpy
		mov	ds:byte_44950F,	0

loc_435642:				; CODE XREF: sub_435614+Aj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		mov	ds:dword_449514, eax
		mov	eax, [ebp+arg_4]
		and	eax, 2
		mov	ds:dword_449510, eax
		mov	eax, [ebp+arg_4]
		and	eax, 4
		mov	ds:dword_449518, eax
		mov	eax, [ebp+arg_4]
		and	eax, 100h
		mov	ds:dword_449520, eax
		leave
		retn
sub_435614	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_435672	proc near		; CODE XREF: sub_402066+15Fp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_4356E4
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_449514
		test	eax, eax
		jz	short loc_43569C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_43569C:				; CODE XREF: sub_435672+19j
		mov	eax, ds:dword_449510
		test	eax, eax
		jz	short loc_4356B4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_4356B4:				; CODE XREF: sub_435672+31j
		mov	eax, ds:dword_449518
		test	eax, eax
		jz	short loc_4356CC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_4356CC:				; CODE XREF: sub_435672+49j
		mov	eax, ds:dword_449520
		test	eax, eax
		jz	short loc_4356E4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_4356E4:				; CODE XREF: sub_435672+7j
					; sub_435672+61j
		mov	eax, offset Dest
		pop	ebp
		retn
sub_435672	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_43571F
		mov	eax, ds:File
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_43571F
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_43571F
		mov	eax, 1
		jmp	short locret_43573F
; ---------------------------------------------------------------------------

loc_43571F:				; CODE XREF: .text:004356F8j
					; .text:0043570Ej ...
		mov	eax, dword_43D890
		cmp	eax, 0FFFFFFFFh
		jz	short loc_43573A
		mov	eax, dword_43D890
		cmp	eax, [ebp+8]
		jnz	short loc_43573A
		mov	eax, 1
		jmp	short locret_43573F
; ---------------------------------------------------------------------------

loc_43573A:				; CODE XREF: .text:00435727j
					; .text:00435731j
		mov	eax, 0

locret_43573F:				; CODE XREF: .text:0043571Dj
					; .text:00435738j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_435741	proc near		; CODE XREF: sub_40E7CF+20Ep
					; sub_40E7CF+218p ...

File		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_43575A
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_43575F
; ---------------------------------------------------------------------------

loc_43575A:				; CODE XREF: sub_435741+Dj
		mov	eax, ds:File

loc_43575F:				; CODE XREF: sub_435741+17j
		mov	[esp+18h+File],	eax ; File
		call	_fileno
		leave
		retn
sub_435741	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_435769	proc near		; CODE XREF: sub_401BF8+314p
					; sub_402066+F9Dp ...
		push	ebp
		mov	ebp, esp
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_43577F
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_435784
; ---------------------------------------------------------------------------

loc_43577F:				; CODE XREF: sub_435769+Aj
		mov	eax, ds:File

loc_435784:				; CODE XREF: sub_435769+14j
		pop	ebp
		retn
sub_435769	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435786(int, char *Format, va_list ArgList)
sub_435786	proc near		; CODE XREF: sub_435B09+22p
					; sub_435B32+1Ap ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4357C9
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_4355C4
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4357C9
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22_19 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_43BB20

loc_4357C9:				; CODE XREF: sub_435786+10j
					; sub_435786+25j
		mov	eax, ds:dword_449528
		test	eax, eax
		jz	short loc_4357ED
		cmp	[ebp+arg_0], 1
		jz	short loc_4357ED
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_4357ED:				; CODE XREF: sub_435786+4Aj
					; sub_435786+50j
		mov	ds:dword_449528, 0
		cmp	[ebp+arg_0], 1
		jz	loc_435984
		mov	eax, ds:dword_449510
		test	eax, eax
		jz	loc_43589D
		mov	eax, ds:dword_449524
		test	eax, eax
		jnz	loc_43589D
		mov	[esp+58h+var_58], 0
		call	sub_43BBF0
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_43C0E0
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d_0 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:File
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_43589D:				; CODE XREF: sub_435786+82j
					; sub_435786+8Fj
		mov	eax, ds:dword_449514
		test	eax, eax
		jnz	short loc_4358AF
		mov	eax, ds:dword_449524
		test	eax, eax
		jz	short loc_4358C6

loc_4358AF:				; CODE XREF: sub_435786+11Ej
		mov	edx, ds:File
		mov	eax, offset Dest
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_4358C6:				; CODE XREF: sub_435786+127j
		mov	eax, ds:dword_449518
		test	eax, eax
		jnz	short loc_4358D8
		mov	eax, ds:dword_449524
		test	eax, eax
		jz	short loc_435932

loc_4358D8:				; CODE XREF: sub_435786+147j
		mov	eax, ds:dword_44951C
		test	eax, eax
		jz	short loc_435911
		mov	eax, ds:dword_44951C
		call	eax ; dword_44951C
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:File
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_435932
; ---------------------------------------------------------------------------

loc_435911:				; CODE XREF: sub_435786+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_1 ; "[%u]"
		mov	eax, ds:File
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_435932:				; CODE XREF: sub_435786+150j
					; sub_435786+189j
		mov	eax, ds:dword_449510
		test	eax, eax
		jz	short loc_435944
		mov	eax, ds:dword_449524
		test	eax, eax
		jz	short loc_435959

loc_435944:				; CODE XREF: sub_435786+1B3j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_435959:				; CODE XREF: sub_435786+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_43596F
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_43596F
		add	[ebp+Format], 1
		jmp	short loc_435984
; ---------------------------------------------------------------------------

loc_43596F:				; CODE XREF: sub_435786+1D7j
					; sub_435786+1E1j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_435984:				; CODE XREF: sub_435786+75j
					; sub_435786+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_435A18	; jumptable 0043599B default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_4477DC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43599D:				; CODE XREF: sub_435786+215j
					; DATA XREF: .rdata:off_4477DCo
		mov	edx, ds:File	; jumptable 0043599B case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_435A38
; ---------------------------------------------------------------------------

loc_4359C6:				; CODE XREF: sub_435786+215j
					; DATA XREF: .rdata:off_4477DCo
		mov	edx, ds:File	; jumptable 0043599B case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_435A38
; ---------------------------------------------------------------------------

loc_4359EF:				; CODE XREF: sub_435786+215j
					; DATA XREF: .rdata:off_4477DCo
		mov	edx, ds:File	; jumptable 0043599B case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_435A38
; ---------------------------------------------------------------------------

loc_435A18:				; CODE XREF: sub_435786+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	0043599B default case
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_435A38
; ---------------------------------------------------------------------------

loc_435A37:				; CODE XREF: sub_435786+215j
					; DATA XREF: .rdata:off_4477DCo
		nop			; jumptable 0043599B cases 0-4

loc_435A38:				; CODE XREF: sub_435786+23Ej
					; sub_435786+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_435AA8
		mov	eax, ds:File
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_435A9B
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_435A9B
		mov	ds:dword_449528, 1
		jmp	short loc_435AA8
; ---------------------------------------------------------------------------

loc_435A9B:				; CODE XREF: sub_435786+2DBj
					; sub_435786+307j
		mov	eax, ds:File
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_435AA8:				; CODE XREF: sub_435786+2B6j
					; sub_435786+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_435AD8
		mov	eax, ds:dword_449528
		test	eax, eax
		jz	short loc_435ACC
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_435ACC:				; CODE XREF: sub_435786+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_435AD8:				; CODE XREF: sub_435786+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_435B01
		mov	eax, ds:dword_449528
		test	eax, eax
		jz	short loc_435AFC
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_435AFC:				; CODE XREF: sub_435786+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_435B01:				; CODE XREF: sub_435786+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_435786	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435B09(int, char *, char)
sub_435B09	proc near		; CODE XREF: sub_435D0C+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_435786
		leave
		retn
sub_435B09	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435B32(int, char *, va_list)
sub_435B32	proc near		; CODE XREF: sub_41DF4B+8Fp

var_18		= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_435786
		leave
		retn
sub_435B32	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435B53(char *, char)
sub_435B53	proc near		; CODE XREF: sub_4017ED+380p
					; sub_402066+575p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_435786
		leave
		retn
sub_435B53	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435B7D(char *, char)
sub_435B7D	proc near		; CODE XREF: sub_4017ED+1DCp
					; sub_402066+5EBp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_435786
		mov	eax, ds:dword_44952C
		cmp	eax, 752Fh
		jg	short locret_435BBE
		mov	eax, ds:dword_44952C
		add	eax, 1
		mov	ds:dword_44952C, eax

locret_435BBE:				; CODE XREF: sub_435B7D+32j
		leave
		retn
sub_435B7D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_435BC0(char *, char)
sub_435BC0	proc near		; CODE XREF: sub_402066+12Fp
					; sub_402066+381p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 5 ; int
		call	sub_435786
		call	abort
sub_435BC0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_435BED(char *, char)
sub_435BED	proc near		; CODE XREF: .text:0042C554p
					; .text:0042C5C2p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_435786
		call	abort
sub_435BED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435C1A(char *, char)
sub_435C1A	proc near		; CODE XREF: sub_402066+C62p
					; sub_402066+C7Dp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_435786
		leave
		retn
sub_435C1A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435C44(char *, char)
sub_435C44	proc near		; CODE XREF: sub_40E584+Dp
					; .text:0040E5BEp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_435786
		leave
		retn
sub_435C44	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_435C74	proc near		; CODE XREF: sub_413B27+D5p
					; sub_413B27+EFp ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jz	short loc_435C9D
		mov	eax, dword ptr [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_435C9D
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset dword_4477FC ;	char *
		call	sub_435C1A

loc_435C9D:				; CODE XREF: sub_435C74+Aj
					; sub_435C74+14j
		cmp	[ebp+arg_8], 0
		jz	short loc_435CF8
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset a02x_2	; "%02X"
		call	sub_435C44
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		jmp	short loc_435CE9
; ---------------------------------------------------------------------------

loc_435CCC:				; CODE XREF: sub_435C74+82j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset a02x_3	; " %02X"
		call	sub_435C44
		add	[ebp+var_C], 1

loc_435CE9:				; CODE XREF: sub_435C74+56j
		cmp	[ebp+arg_8], 0
		setnz	al
		sub	[ebp+arg_8], 1
		test	al, al
		jnz	short loc_435CCC

loc_435CF8:				; CODE XREF: sub_435C74+2Dj
		cmp	dword ptr [ebp+arg_0], 0
		jz	short locret_435D0A
		mov	[esp+28h+var_28], offset asc_44780B ; "\n"
		call	sub_435C44

locret_435D0A:				; CODE XREF: sub_435C74+88j
		leave
		retn
sub_435C74	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_435D0C	proc near		; CODE XREF: sub_40378F+76p
					; sub_41182D+59p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_435B09
		call	abort
sub_435D0C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_435D40	proc near		; CODE XREF: sub_4362AA+57p
					; sub_436C8D+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_435DCD
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_435DCD
		mov	[esp+28h+Code],	offset aInvalidArgumen ; "invalid argument for arg_parsee\n"
		call	sub_435BED
; ---------------------------------------------------------------------------

loc_435DCD:				; CODE XREF: sub_435D40+13j
					; sub_435D40+7Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_436080
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_435F05
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_435E04
		mov	[esp+28h+Code],	offset aArgumentNotExp ; "argument not expected"
		call	sub_435294
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_435EDD
; ---------------------------------------------------------------------------

loc_435E04:				; CODE XREF: sub_435D40+AEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_435E23
		mov	[esp+28h+Code],	offset aReadError ; "read error"
		call	sub_435294
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_435EDD
; ---------------------------------------------------------------------------

loc_435E23:				; CODE XREF: sub_435D40+CDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_435E42
		mov	[esp+28h+Code],	offset aKeywordTooLong ; "keyword too long"
		call	sub_435294
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_435EDD
; ---------------------------------------------------------------------------

loc_435E42:				; CODE XREF: sub_435D40+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_435E5E
		mov	[esp+28h+Code],	offset aMissingArgumen ; "missing argument"
		call	sub_435294
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_435EDD
; ---------------------------------------------------------------------------

loc_435E5E:				; CODE XREF: sub_435D40+10Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_435E7A
		mov	[esp+28h+Code],	offset aInvalidArgum_0 ; "invalid argument"
		call	sub_435294
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_435EDD
; ---------------------------------------------------------------------------

loc_435E7A:				; CODE XREF: sub_435D40+127j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_435E96
		mov	[esp+28h+Code],	offset aInvalidCommand ; "invalid command"
		call	sub_435294
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_435EDD
; ---------------------------------------------------------------------------

loc_435E96:				; CODE XREF: sub_435D40+143j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_435EB2
		mov	[esp+28h+Code],	offset aInvalidAliasDe ; "invalid alias	definition"
		call	sub_435294
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_435EDD
; ---------------------------------------------------------------------------

loc_435EB2:				; CODE XREF: sub_435D40+15Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_435ECE
		mov	[esp+28h+Code],	offset aOutOfCore ; "out of core"
		call	sub_435294
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_435EDD
; ---------------------------------------------------------------------------

loc_435ECE:				; CODE XREF: sub_435D40+17Bj
		mov	[esp+28h+Code],	offset aInvalidOption ;	"invalid option"
		call	sub_435294
		mov	dword ptr [ebp+var_C], eax

loc_435EDD:				; CODE XREF: sub_435D40+BFj
					; sub_435D40+DEj ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_435B7D
		jmp	loc_43605F
; ---------------------------------------------------------------------------

loc_435F05:				; CODE XREF: sub_435D40+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_435F17
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_435F1C
; ---------------------------------------------------------------------------

loc_435F17:				; CODE XREF: sub_435D40+1CDj
		mov	eax, offset a??	; "[??]"

loc_435F1C:				; CODE XREF: sub_435D40+1D5j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_435F4A
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "missing argument for option \"%.50s\"\n"
		call	sub_435294
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_435B7D
		jmp	loc_43605F
; ---------------------------------------------------------------------------

loc_435F4A:				; CODE XREF: sub_435D40+1E8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_435F75
		mov	[esp+28h+Code],	offset aInvalidArgum_1 ; "invalid argument for option \"%.50s\"\n"
		call	sub_435294
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_435B7D
		jmp	loc_43605F
; ---------------------------------------------------------------------------

loc_435F75:				; CODE XREF: sub_435D40+213j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_435FA0
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "option \"%.50s\" does	not expect an arg"...
		call	sub_435294
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_435B7D
		jmp	loc_43605F
; ---------------------------------------------------------------------------

loc_435FA0:				; CODE XREF: sub_435D40+23Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_435FCB
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "invalid command \"%.50s\"\n"
		call	sub_435294
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_435B7D
		jmp	loc_43605F
; ---------------------------------------------------------------------------

loc_435FCB:				; CODE XREF: sub_435D40+269j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_435FF3
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "option \"%.50s\" is ambiguous\n"
		call	sub_435294
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_435B7D
		jmp	short loc_43605F
; ---------------------------------------------------------------------------

loc_435FF3:				; CODE XREF: sub_435D40+294j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_43601B
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "command \"%.50s\" is ambiguous\n"
		call	sub_435294
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_435B7D
		jmp	short loc_43605F
; ---------------------------------------------------------------------------

loc_43601B:				; CODE XREF: sub_435D40+2BCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_436044
		mov	[esp+28h+Code],	offset aOutOfCore_0 ; "out of core\n"
		call	sub_435294
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aS_1 ; "%s\n"
		call	sub_435B7D
		jmp	short loc_43605F
; ---------------------------------------------------------------------------

loc_436044:				; CODE XREF: sub_435D40+2E4j
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "invalid option \"%.50s\"\n"
		call	sub_435294
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_435B7D

loc_43605F:				; CODE XREF: sub_435D40+1C0j
					; sub_435D40+205j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_436076
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_436076:				; CODE XREF: sub_435D40+328j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_436080:				; CODE XREF: sub_435D40+95j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_435D40	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_436096	proc near		; CODE XREF: sub_4362AA+342p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_436096	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43609B(int, char *)
sub_43609B	proc near		; CODE XREF: sub_4360E1+11Cp
					; sub_4362AA+199p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_4360D4
; ---------------------------------------------------------------------------

loc_4360AC:				; CODE XREF: sub_43609B+3Dj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4360CC
		mov	eax, 1
		jmp	short locret_4360DF
; ---------------------------------------------------------------------------

loc_4360CC:				; CODE XREF: sub_43609B+28j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4360D4:				; CODE XREF: sub_43609B+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_4360AC
		mov	eax, 0

locret_4360DF:				; CODE XREF: sub_43609B+2Fj
		leave
		retn
sub_43609B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4360E1(int, FILE *)
sub_4360E1	proc near		; CODE XREF: sub_4362AA+643p

File		= dword	ptr -98h
Source		= dword	ptr -94h
var_80		= byte ptr -80h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		jmp	loc_43625D
; ---------------------------------------------------------------------------

loc_436104:				; CODE XREF: sub_4360E1+180j
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+File],	eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jnz	short loc_436121
		mov	[ebp+var_14], 1
		jmp	short loc_436135
; ---------------------------------------------------------------------------

loc_436121:				; CODE XREF: sub_4360E1+35j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_436135
		mov	[ebp+C], 0Ah
		mov	[ebp+var_14], 1

loc_436135:				; CODE XREF: sub_4360E1+3Ej
					; sub_4360E1+44j ...
		mov	eax, [ebp+var_18]
		cmp	eax, 1
		jz	short loc_436182
		cmp	eax, 1
		jb	short loc_436155
		cmp	eax, 2
		jz	short loc_4361C6
		cmp	eax, 3
		jz	loc_4361E7
		jmp	loc_43625D
; ---------------------------------------------------------------------------

loc_436155:				; CODE XREF: sub_4360E1+5Fj
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_436172
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_436259

loc_436172:				; CODE XREF: sub_4360E1+7Aj
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 1
		jmp	short loc_436135
; ---------------------------------------------------------------------------

loc_436182:				; CODE XREF: sub_4360E1+5Aj
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_43619C
		mov	[ebp+var_18], 3
		jmp	short loc_436135
; ---------------------------------------------------------------------------

loc_43619C:				; CODE XREF: sub_4360E1+B0j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_4361BA
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_43625D
; ---------------------------------------------------------------------------

loc_4361BA:				; CODE XREF: sub_4360E1+C1j
		mov	[ebp+var_18], 2
		jmp	loc_43625D
; ---------------------------------------------------------------------------

loc_4361C6:				; CODE XREF: sub_4360E1+64j
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_43625C
		mov	[ebp+var_18], 0
		jmp	loc_436135
; ---------------------------------------------------------------------------

loc_4361E7:				; CODE XREF: sub_4360E1+69j
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_80]
		mov	[esp+98h+Source], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+File],	eax ; int
		call	sub_43609B
		test	eax, eax
		jnz	short loc_43624D
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+98h+File],	eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_436224
		mov	eax, 1
		jmp	short locret_43626C
; ---------------------------------------------------------------------------

loc_436224:				; CODE XREF: sub_4360E1+13Aj
		lea	eax, [ebp+var_80]
		mov	edx, [ebp+var_1C]
		add	edx, 4
		mov	[esp+98h+Source], eax ;	Source
		mov	[esp+98h+File],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax+34h], edx

loc_43624D:				; CODE XREF: sub_4360E1+123j
		mov	[ebp+var_18], 0
		jmp	loc_436135
; ---------------------------------------------------------------------------

loc_436259:				; CODE XREF: sub_4360E1+8Bj
		nop
		jmp	short loc_43625D
; ---------------------------------------------------------------------------

loc_43625C:				; CODE XREF: sub_4360E1+F4j
		nop

loc_43625D:				; CODE XREF: sub_4360E1+1Ej
					; sub_4360E1+6Fj ...
		cmp	[ebp+var_14], 0
		jz	loc_436104
		mov	eax, 0

locret_43626C:				; CODE XREF: sub_4360E1+141j
		leave
		retn
sub_4360E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43626E	proc near		; CODE XREF: sub_4362AA+48Ap

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_436298
; ---------------------------------------------------------------------------

loc_43627F:				; CODE XREF: sub_43626E+2Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_436298:				; CODE XREF: sub_43626E+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_43627F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		leave
		retn
sub_43626E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4362AA(FILE *, int, int, int,	int)
sub_4362AA	proc near		; CODE XREF: sub_402066+AC3p
					; sub_4034EE+FEp

File		= dword	ptr -0C8h
Str2		= dword	ptr -0C4h
Size		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
Str1		= byte ptr -9Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Str		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0C4h
		mov	[ebp+var_14], 0
		mov	[ebp+Str], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_4362ED
		mov	eax, [ebp+arg_10]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_436C8D
		jmp	loc_436B2C
; ---------------------------------------------------------------------------

loc_4362ED:				; CODE XREF: sub_4362AA+2Aj
		mov	eax, [ebp+arg_8]
		mov	[esp+0C8h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_435D40
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_436316
; ---------------------------------------------------------------------------

loc_436315:				; CODE XREF: sub_4362AA+4D3j
					; sub_4362AA+518j ...
		nop

loc_436316:				; CODE XREF: sub_4362AA+69j
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+File], eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jz	short loc_436334
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	loc_436779

loc_436334:				; CODE XREF: sub_4362AA+7Ej
		cmp	[ebp+C], 0FFFFFFFFh
		jz	short loc_436347
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_436347:				; CODE XREF: sub_4362AA+8Ej
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_436B22
		cmp	[ebp+var_C], 2
		jnz	loc_4364DD
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_4363A6
; ---------------------------------------------------------------------------

loc_436370:				; CODE XREF: sub_4362AA+109j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4363A2
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0C8h+Str2], edx ; Str2
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_4363B7

loc_4363A2:				; CODE XREF: sub_4362AA+D4j
		add	[ebp+var_10], 1

loc_4363A6:				; CODE XREF: sub_4362AA+C4j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_436370
		jmp	short loc_4363B8
; ---------------------------------------------------------------------------

loc_4363B7:				; CODE XREF: sub_4362AA+F6j
		nop

loc_4363B8:				; CODE XREF: sub_4362AA+10Bj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_4363F4
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_4363F4:				; CODE XREF: sub_4362AA+136j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_43648A
		mov	[esp+0C8h+Str2], offset	aIgnoreInvalidO	; "ignore-invalid-option"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_436433
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_436433:				; CODE XREF: sub_4362AA+175j
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+Str2], eax ; char *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_43609B
		test	eax, eax
		jz	short loc_43645E
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_43645E:				; CODE XREF: sub_4362AA+1A0j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_43647A
		mov	eax, 0FFFFFFF9h
		jmp	short loc_43647F
; ---------------------------------------------------------------------------

loc_43647A:				; CODE XREF: sub_4362AA+1C7j
		mov	eax, 0FFFFFFFEh

loc_43647F:				; CODE XREF: sub_4362AA+1CEj
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_43648A:				; CODE XREF: sub_4362AA+157j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_4364AC
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_4364AC:				; CODE XREF: sub_4362AA+1F1j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4364CE
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_4364CE:				; CODE XREF: sub_4362AA+213j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_4364DD:				; CODE XREF: sub_4362AA+ABj
		cmp	[ebp+var_C], 3
		jnz	short loc_43654B
		cmp	[ebp+var_20], 0
		jz	short loc_4364F8
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_4364F8:				; CODE XREF: sub_4362AA+23Dj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_43651A
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_43651A:				; CODE XREF: sub_4362AA+25Fj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_43653C
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_43653C:				; CODE XREF: sub_4362AA+281j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_43654B:				; CODE XREF: sub_4362AA+237j
		cmp	[ebp+var_C], 4
		jnz	loc_436728
		cmp	[ebp+var_20], 0
		jz	loc_4365F6
		cmp	[ebp+Str], 0
		jnz	short loc_436574
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_436723
; ---------------------------------------------------------------------------

loc_436574:				; CODE XREF: sub_4362AA+2B9j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0
		mov	[esp+0C8h+Str2], offset	asc_447A07 ; " \t"
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; Str
		call	strpbrk
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_4365AE
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+File], eax
		call	sub_431F98

loc_4365AE:				; CODE XREF: sub_4362AA+2EDj
		cmp	[ebp+var_24], 0
		jz	short loc_4365BE
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4365D8

loc_4365BE:				; CODE XREF: sub_4362AA+308j
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_436B25
; ---------------------------------------------------------------------------

loc_4365D8:				; CODE XREF: sub_4362AA+312j
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+Size], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_436096
		jmp	loc_436723
; ---------------------------------------------------------------------------

loc_4365F6:				; CODE XREF: sub_4362AA+2AFj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_436618
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_436B25
; ---------------------------------------------------------------------------

loc_436618:				; CODE XREF: sub_4362AA+35Dj
		cmp	[ebp+Str], 0
		jnz	short loc_43664D
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax
		call	gcry_strdup
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_436656
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_436656
; ---------------------------------------------------------------------------

loc_43664D:				; CODE XREF: sub_4362AA+372j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0

loc_436656:				; CODE XREF: sub_4362AA+395j
					; sub_4362AA+3A1j
		cmp	[ebp+Str], 0
		jz	loc_436B25
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	sub_431F98
		mov	eax, [ebp+Str]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_4366E9
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4366E9
		mov	eax, [ebp+var_28]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_4366E9
		mov	eax, [ebp+var_28]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_4366E9:				; CODE XREF: sub_4362AA+3CFj
					; sub_4362AA+3DDj ...
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_28]
		mov	[esp+0C8h+Size], edx ; char *
		mov	[esp+0C8h+Str2], eax ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_437442
		test	eax, eax
		jnz	loc_436B25
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	gcry_free
		jmp	loc_436B25
; ---------------------------------------------------------------------------

loc_436723:				; CODE XREF: sub_4362AA+2C5j
					; sub_4362AA+347j
		jmp	loc_436B25
; ---------------------------------------------------------------------------

loc_436728:				; CODE XREF: sub_4362AA+2A5j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_436766
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_43626E
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+File], eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_436757
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_436757:				; CODE XREF: sub_4362AA+49Cj
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_436766:				; CODE XREF: sub_4362AA+482j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_436779:				; CODE XREF: sub_4362AA+84j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_436315
		cmp	[ebp+var_C], 0
		jnz	short loc_4367A6
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_4367A6
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_436B1D

loc_4367A6:				; CODE XREF: sub_4362AA+4DDj
					; sub_4362AA+4E5j
		cmp	[ebp+var_C], 0
		jnz	short loc_4367BE
		cmp	[ebp+C], 23h
		jnz	short loc_4367BE
		mov	[ebp+var_C], 1
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_4367BE:				; CODE XREF: sub_4362AA+500j
					; sub_4362AA+506j
		cmp	[ebp+var_C], 1
		jz	loc_436315
		cmp	[ebp+var_C], 2
		jnz	loc_436988
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	loc_436988
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_436988
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_43683E
; ---------------------------------------------------------------------------

loc_436808:				; CODE XREF: sub_4362AA+5A1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_43683A
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0C8h+Str2], edx ; Str2
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_43684F

loc_43683A:				; CODE XREF: sub_4362AA+56Cj
		add	[ebp+var_10], 1

loc_43683E:				; CODE XREF: sub_4362AA+55Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_436808
		jmp	short loc_436850
; ---------------------------------------------------------------------------

loc_43684F:				; CODE XREF: sub_4362AA+58Ej
		nop

loc_436850:				; CODE XREF: sub_4362AA+5A3j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_436886
		mov	[ebp+var_C], 1
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_436886:				; CODE XREF: sub_4362AA+5CEj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_43697C
		mov	[esp+0C8h+Str2], offset	aAlias ; "alias"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4368C6
		mov	[ebp+var_20], 1
		mov	[ebp+var_C], 3
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_4368C6:				; CODE XREF: sub_4362AA+607j
		mov	[esp+0C8h+Str2], offset	aIgnoreInvalidO	; "ignore-invalid-option"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_436924
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str2], eax ; FILE *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_4360E1
		test	eax, eax
		jz	short loc_436905
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_436905:				; CODE XREF: sub_4362AA+64Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_436924:				; CODE XREF: sub_4362AA+634j
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+Str2], eax ; char *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_43609B
		test	eax, eax
		jz	short loc_436949
		mov	[ebp+var_C], 1
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_436949:				; CODE XREF: sub_4362AA+691j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_436965
		mov	eax, 0FFFFFFF9h
		jmp	short loc_43696A
; ---------------------------------------------------------------------------

loc_436965:				; CODE XREF: sub_4362AA+6B2j
		mov	eax, 0FFFFFFFEh

loc_43696A:				; CODE XREF: sub_4362AA+6B9j
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_43697C:				; CODE XREF: sub_4362AA+5E9j
		mov	[ebp+var_C], 3
		jmp	loc_436B1D
; ---------------------------------------------------------------------------

loc_436988:				; CODE XREF: sub_4362AA+522j
					; sub_4362AA+52Ej ...
		cmp	[ebp+var_C], 3
		jnz	short loc_4369D2
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_4369AB
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_436315

loc_4369AB:				; CODE XREF: sub_4362AA+6EAj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 4
		jmp	loc_436315
; ---------------------------------------------------------------------------

loc_4369D2:				; CODE XREF: sub_4362AA+6E2j
		cmp	[ebp+var_C], 4
		jnz	loc_436ADF
		cmp	[ebp+Str], 0
		jz	short loc_436A61
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_436A03
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_436315
; ---------------------------------------------------------------------------

loc_436A03:				; CODE XREF: sub_4362AA+743j
		mov	eax, [ebp+var_1C]
		add	eax, 32h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	gcry_realloc
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_436A47
		mov	eax, [ebp+var_30]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_34]
		mov	[ebp+Str], eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_436315
; ---------------------------------------------------------------------------

loc_436A47:				; CODE XREF: sub_4362AA+77Bj
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_436B26
; ---------------------------------------------------------------------------

loc_436A61:				; CODE XREF: sub_4362AA+736j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_436A82
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_436315
; ---------------------------------------------------------------------------

loc_436A82:				; CODE XREF: sub_4362AA+7BDj
		mov	[ebp+var_38], 96h
		mov	eax, [ebp+var_38]
		mov	[esp+0C8h+File], eax
		call	gcry_malloc
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_436AD3
		mov	eax, [ebp+var_38]
		mov	[ebp+var_1C], eax
		mov	ecx, [ebp+var_10]
		lea	edx, [ebp+Str1]
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Size], ecx ; Size
		mov	[esp+0C8h+Str2], edx ; Src
		mov	[esp+0C8h+File], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_436315
; ---------------------------------------------------------------------------

loc_436AD3:				; CODE XREF: sub_4362AA+7F1j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_436B26
; ---------------------------------------------------------------------------

loc_436ADF:				; CODE XREF: sub_4362AA+72Cj
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		jbe	short loc_436AFD
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_436315
; ---------------------------------------------------------------------------

loc_436AFD:				; CODE XREF: sub_4362AA+83Bj
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 2
		jmp	loc_436315
; ---------------------------------------------------------------------------

loc_436B1D:				; CODE XREF: sub_4362AA+145j
					; sub_4362AA+184j ...
		jmp	loc_436315
; ---------------------------------------------------------------------------

loc_436B22:				; CODE XREF: sub_4362AA+A1j
		nop
		jmp	short loc_436B26
; ---------------------------------------------------------------------------

loc_436B25:				; CODE XREF: sub_4362AA+329j
					; sub_4362AA+369j ...
		nop

loc_436B26:				; CODE XREF: sub_4362AA+1DBj
					; sub_4362AA+1FDj ...
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+10h]

loc_436B2C:				; CODE XREF: sub_4362AA+3Ej
		add	esp, 0C4h
		pop	edi
		pop	ebp
		retn
sub_4362AA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_436B35(int, int, char	*)
sub_436B35	proc near		; CODE XREF: sub_436C8D+182p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_436B50
		mov	eax, 0FFFFFFFFh
		jmp	loc_436C87
; ---------------------------------------------------------------------------

loc_436B50:				; CODE XREF: sub_436B35+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_436B94
; ---------------------------------------------------------------------------

loc_436B59:				; CODE XREF: sub_436B35+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_436B90
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_436B90
		mov	eax, [ebp+var_C]
		jmp	loc_436C87
; ---------------------------------------------------------------------------

loc_436B90:				; CODE XREF: sub_436B35+32j
					; sub_436B35+51j
		add	[ebp+var_C], 1

loc_436B94:				; CODE XREF: sub_436B35+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_436B59
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_436C6F
; ---------------------------------------------------------------------------

loc_436BD1:				; CODE XREF: sub_436B35+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_436C6B
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_436C6B
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_436C57
; ---------------------------------------------------------------------------

loc_436C16:				; CODE XREF: sub_436B35+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_436C53
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_436C53
		mov	eax, 0FFFFFFFEh
		jmp	short loc_436C87
; ---------------------------------------------------------------------------

loc_436C53:				; CODE XREF: sub_436B35+EFj
					; sub_436B35+115j
		add	[ebp+var_10], 1

loc_436C57:				; CODE XREF: sub_436B35+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_436C16
		mov	eax, [ebp+var_C]
		jmp	short loc_436C87
; ---------------------------------------------------------------------------

loc_436C6B:				; CODE XREF: sub_436B35+AAj
					; sub_436B35+D4j
		add	[ebp+var_C], 1

loc_436C6F:				; CODE XREF: sub_436B35+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_436BD1
		mov	eax, 0FFFFFFFFh

loc_436C87:				; CODE XREF: sub_436B35+16j
					; sub_436B35+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_436B35	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_436C8D	proc near		; CODE XREF: sub_402066+47Dp
					; sub_4362AA+39p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_435D40
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_436CF1
		cmp	[ebp+var_10], 0
		jz	short loc_436CF1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_436CF1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_436CF1:				; CODE XREF: sub_436C8D+43j
					; sub_436C8D+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_436D06
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_43741C
; ---------------------------------------------------------------------------

loc_436D06:				; CODE XREF: sub_436C8D+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_436D5C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_436D5C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_43741C
; ---------------------------------------------------------------------------

loc_436D5C:				; CODE XREF: sub_436C8D+92j
					; sub_436C8D+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_436D75
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_43741C
; ---------------------------------------------------------------------------

loc_436D75:				; CODE XREF: sub_436C8D+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_4370F7
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_4370F7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_436DD3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_436DD3
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_436CF1
; ---------------------------------------------------------------------------

loc_436DD3:				; CODE XREF: sub_436C8D+11Cj
					; sub_436C8D+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], 3Dh ; Val
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_436DF8
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_436DF8:				; CODE XREF: sub_436C8D+163j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_436B35
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_436E23
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_436E23:				; CODE XREF: sub_436C8D+18Ej
		cmp	[ebp+var_20], 0
		jns	short loc_436E5D
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aHelp ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_436E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_437678
; ---------------------------------------------------------------------------
		jmp	loc_436F98
; ---------------------------------------------------------------------------

loc_436E5D:				; CODE XREF: sub_436C8D+19Aj
					; sub_436C8D+1B4j
		cmp	[ebp+var_20], 0
		jns	short loc_436E9F
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aVersion_0 ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_436E9F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_436F98
		call	sub_437BE3
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_436E9F:				; CODE XREF: sub_436C8D+1D4j
					; sub_436C8D+1EEj
		cmp	[ebp+var_20], 0
		jns	short loc_436EDF
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_436EDF
		mov	[esp+38h+Str], 10h
		call	sub_437E99
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_436EDF:				; CODE XREF: sub_436C8D+216j
					; sub_436C8D+230j
		cmp	[ebp+var_20], 0
		jns	loc_436F98
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	loc_436F98
		mov	[ebp+var_20], 0
		jmp	short loc_436F54
; ---------------------------------------------------------------------------

loc_436F10:				; CODE XREF: sub_436C8D+2D4j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_436F50
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	short loc_436F50
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, offset aS_2 ; "--%s\n"
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax ; Format
		call	printf

loc_436F50:				; CODE XREF: sub_436C8D+291j
					; sub_436C8D+2A4j
		add	[ebp+var_20], 1

loc_436F54:				; CODE XREF: sub_436C8D+281j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_436F10
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aDumpOptionsHel ; "--dump-options\n--help\n--version\n--wa"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Bh ; Count
		mov	[esp+38h+Val], 1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_436F98:				; CODE XREF: sub_436C8D+1CBj
					; sub_436C8D+1FBj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_436FAA
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_436FD9
; ---------------------------------------------------------------------------

loc_436FAA:				; CODE XREF: sub_436C8D+30Fj
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_436FC8
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_436FD9
; ---------------------------------------------------------------------------

loc_436FC8:				; CODE XREF: sub_436C8D+321j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_436FD9:				; CODE XREF: sub_436C8D+31Bj
					; sub_436C8D+339j
		cmp	[ebp+var_20], 0
		js	loc_4370E6
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_4370C7
		cmp	[ebp+var_28], 0
		jz	short loc_43701C
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_437025
		mov	[ebp+var_1C], 0
		jmp	short loc_437025
; ---------------------------------------------------------------------------

loc_43701C:				; CODE XREF: sub_436C8D+371j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_437025:				; CODE XREF: sub_436C8D+384j
					; sub_436C8D+38Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_43704D
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_43704D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4370E6
; ---------------------------------------------------------------------------

loc_43704D:				; CODE XREF: sub_436C8D+39Cj
					; sub_436C8D+3AFj
		cmp	[ebp+var_1C], 0
		jnz	short loc_437062
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_4370E5
; ---------------------------------------------------------------------------

loc_437062:				; CODE XREF: sub_436C8D+3C4j
		cmp	[ebp+var_28], 0
		jnz	short loc_437091
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_437091
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_437091
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_4370E6
; ---------------------------------------------------------------------------

loc_437091:				; CODE XREF: sub_436C8D+3D9j
					; sub_436C8D+3E3j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_437442
		cmp	[ebp+var_28], 0
		jnz	short loc_4370E5
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_4370E5
; ---------------------------------------------------------------------------

loc_4370C7:				; CODE XREF: sub_436C8D+367j
		cmp	[ebp+var_28], 0
		jz	short loc_4370D9
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_4370E6
; ---------------------------------------------------------------------------

loc_4370D9:				; CODE XREF: sub_436C8D+43Ej
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_4370E6
; ---------------------------------------------------------------------------

loc_4370E5:				; CODE XREF: sub_436C8D+3D0j
					; sub_436C8D+42Aj ...
		nop

loc_4370E6:				; CODE XREF: sub_436C8D+350j
					; sub_436C8D+3BBj ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_43741C
; ---------------------------------------------------------------------------

loc_4370F7:				; CODE XREF: sub_436C8D+F0j
					; sub_436C8D+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_43710E
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43711C

loc_43710E:				; CODE XREF: sub_436C8D+472j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_4373D4

loc_43711C:				; CODE XREF: sub_436C8D+47Fj
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4371A7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_4371A7
		mov	[ebp+var_20], 0
		jmp	short loc_437198
; ---------------------------------------------------------------------------

loc_437159:				; CODE XREF: sub_436C8D+518j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_437194
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+38h+Val], edx ; Str2
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_437194
		mov	[ebp+var_24], 1
		jmp	short loc_4371A7
; ---------------------------------------------------------------------------

loc_437194:				; CODE XREF: sub_436C8D+4DAj
					; sub_436C8D+4FCj
		add	[ebp+var_20], 1

loc_437198:				; CODE XREF: sub_436C8D+4CAj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_437159

loc_4371A7:				; CODE XREF: sub_436C8D+4A5j
					; sub_436C8D+4C1j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_4371ED
		mov	[ebp+var_20], 0
		jmp	short loc_4371DB
; ---------------------------------------------------------------------------

loc_4371BF:				; CODE XREF: sub_436C8D+55Bj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_4371EC
		add	[ebp+var_20], 1

loc_4371DB:				; CODE XREF: sub_436C8D+530j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4371BF
		jmp	short loc_4371ED
; ---------------------------------------------------------------------------

loc_4371EC:				; CODE XREF: sub_436C8D+548j
		nop

loc_4371ED:				; CODE XREF: sub_436C8D+527j
					; sub_436C8D+55Dj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_437225
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_437210
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_437225

loc_437210:				; CODE XREF: sub_436C8D+577j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_437678
; ---------------------------------------------------------------------------

loc_437225:				; CODE XREF: sub_436C8D+56Dj
					; sub_436C8D+581j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_437289
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_437261
		mov	eax, 0FFFFFFF9h
		jmp	short loc_437266
; ---------------------------------------------------------------------------

loc_437261:				; CODE XREF: sub_436C8D+5CBj
		mov	eax, 0FFFFFFFEh

loc_437266:				; CODE XREF: sub_436C8D+5D2j
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_4373A9
; ---------------------------------------------------------------------------

loc_437289:				; CODE XREF: sub_436C8D+5B6j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_437390
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4372E3
		cmp	[ebp+var_24], 0
		jnz	short loc_4372E3
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_437442
		jmp	loc_437387
; ---------------------------------------------------------------------------

loc_4372E3:				; CODE XREF: sub_436C8D+61Ej
					; sub_436C8D+624j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_437311
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_437311
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_437387
; ---------------------------------------------------------------------------

loc_437311:				; CODE XREF: sub_436C8D+663j
					; sub_436C8D+676j
		cmp	[ebp+var_1C], 0
		jnz	short loc_437323
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_437387
; ---------------------------------------------------------------------------

loc_437323:				; CODE XREF: sub_436C8D+688j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_437359
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_437359
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_437359
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_437387
; ---------------------------------------------------------------------------

loc_437359:				; CODE XREF: sub_436C8D+69Ej
					; sub_436C8D+6ABj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_437442
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_437387:				; CODE XREF: sub_436C8D+651j
					; sub_436C8D+682j ...
		mov	[ebp+var_18], offset asc_447A68	; "x"
		jmp	short loc_4373A9
; ---------------------------------------------------------------------------

loc_437390:				; CODE XREF: sub_436C8D+60Dj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_4373A9:				; CODE XREF: sub_436C8D+5F7j
					; sub_436C8D+701j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4373BC
		cmp	[ebp+var_24], 0
		jz	short loc_43741B

loc_4373BC:				; CODE XREF: sub_436C8D+727j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_43741B
; ---------------------------------------------------------------------------

loc_4373D4:				; CODE XREF: sub_436C8D+489j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_43740C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_43741C
; ---------------------------------------------------------------------------

loc_43740C:				; CODE XREF: sub_436C8D+752j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_436CF1
; ---------------------------------------------------------------------------

loc_43741B:				; CODE XREF: sub_436C8D+72Dj
					; sub_436C8D+745j
		nop

loc_43741C:				; CODE XREF: sub_436C8D+74j
					; sub_436C8D+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_436C8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_437442(int, int, char	*)
sub_437442	proc near		; CODE XREF: sub_4362AA+45Cp
					; sub_436C8D+421p ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_437459
		mov	eax, 0
		jmp	short loc_43745E
; ---------------------------------------------------------------------------

loc_437459:				; CODE XREF: sub_437442+Ej
		mov	eax, 0Ah

loc_43745E:				; CODE XREF: sub_437442+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_43748C
		cmp	eax, 4
		jz	loc_437519
		cmp	eax, 1
		jnz	loc_4375BE

loc_43748C:				; CODE XREF: sub_437442+36j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 80000000h
		jz	short loc_4374C8
		cmp	[ebp+var_10], 7FFFFFFFh
		jnz	short loc_4374EA

loc_4374C8:				; CODE XREF: sub_437442+7Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_4374EA
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	locret_4375CC
; ---------------------------------------------------------------------------

loc_4374EA:				; CODE XREF: sub_437442+84j
					; sub_437442+92j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	short loc_437500
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx
		jmp	short loc_437509
; ---------------------------------------------------------------------------

loc_437500:				; CODE XREF: sub_437442+B1j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx

loc_437509:				; CODE XREF: sub_437442+BCj
		mov	eax, 0
		jmp	locret_4375CC
; ---------------------------------------------------------------------------

loc_437513:				; CODE XREF: sub_437442+F7j
		add	[ebp+arg_8], 1
		jmp	short loc_43751A
; ---------------------------------------------------------------------------

loc_437519:				; CODE XREF: sub_437442+3Bj
		nop

loc_43751A:				; CODE XREF: sub_437442+D5j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_43753B
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Str], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_437513

loc_43753B:				; CODE XREF: sub_437442+E0j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_437560
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4375CC
; ---------------------------------------------------------------------------

loc_437560:				; CODE XREF: sub_437442+101j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4375B7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_4375B7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4375CC
; ---------------------------------------------------------------------------

loc_4375B7:				; CODE XREF: sub_437442+154j
					; sub_437442+162j
		mov	eax, 0
		jmp	short locret_4375CC
; ---------------------------------------------------------------------------

loc_4375BE:				; CODE XREF: sub_437442+44j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_4375CC:				; CODE XREF: sub_437442+A3j
					; sub_437442+CCj ...
		leave
		retn
sub_437442	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4375CE	proc near		; CODE XREF: sub_437678+8Ep

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_43766F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_43766F
		call	sub_43833B
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_43765A
		add	[ebp+var_C], 1
		jmp	short loc_43765A
; ---------------------------------------------------------------------------

loc_437635:				; CODE XREF: sub_4375CE+9Fj
		cmp	[ebp+var_14], 0
		jz	short loc_437654
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_437654
		add	[ebp+var_C], 1

loc_437654:				; CODE XREF: sub_4375CE+6Bj
					; sub_4375CE+80j
		add	[ebp+var_10], 1
		jmp	short loc_43765B
; ---------------------------------------------------------------------------

loc_43765A:				; CODE XREF: sub_4375CE+5Fj
					; sub_4375CE+65j
		nop

loc_43765B:				; CODE XREF: sub_4375CE+8Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43766F
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_437635

loc_43766F:				; CODE XREF: sub_4375CE+34j
					; sub_4375CE+41j ...
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_4375CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_437678	proc near		; CODE XREF: sub_436C8D+1C6p
					; sub_436C8D+593p

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		call	sub_437BE3
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Str], 29h
		call	sub_437E99
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_437AE0
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_437726
; ---------------------------------------------------------------------------

loc_4376C7:				; CODE XREF: sub_437678+BBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_437722
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4376FA
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_437722

loc_4376FA:				; CODE XREF: sub_437678+6Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_4375CE
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_437722
		cmp	[ebp+var_14], 22h
		jg	short loc_437722
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_437722:				; CODE XREF: sub_437678+5Dj
					; sub_437678+80j ...
		add	[ebp+var_10], 1

loc_437726:				; CODE XREF: sub_437678+4Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4376C7
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_437752
		mov	[esp+38h+Str], offset aOptions ; "Options:"
		call	puts

loc_437752:				; CODE XREF: sub_437678+CCj
		mov	[ebp+var_10], 0
		jmp	loc_437AB7
; ---------------------------------------------------------------------------

loc_43775E:				; CODE XREF: sub_437678+44Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+Str], eax ; char *
		call	sub_435294
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_437796
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_437796
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_437AB2

loc_437796:				; CODE XREF: sub_437678+101j
					; sub_437678+10Bj
		cmp	[ebp+var_C], 0
		jz	short loc_437801
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_437801
		add	[ebp+var_C], 1
		jmp	short loc_4377E6
; ---------------------------------------------------------------------------

loc_4377AC:				; CODE XREF: sub_437678+176j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_4377D1
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4377E2
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_4377E2
; ---------------------------------------------------------------------------

loc_4377D1:				; CODE XREF: sub_437678+13Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_4377E2:				; CODE XREF: sub_437678+149j
					; sub_437678+157j
		add	[ebp+var_C], 1

loc_4377E6:				; CODE XREF: sub_437678+132j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4377AC
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_437AB3
; ---------------------------------------------------------------------------

loc_437801:				; CODE XREF: sub_437678+122j
					; sub_437678+12Cj
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_4378B5
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset aC_2 ; " -%c"
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Str], eax ; Format
		call	printf
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_4378DE
		cmp	[ebp+var_C], 0
		jz	loc_4378DE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4378DE
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_437891
; ---------------------------------------------------------------------------

loc_437878:				; CODE XREF: sub_437678+22Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_437891:				; CODE XREF: sub_437678+1FEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4378A5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_437878

loc_4378A5:				; CODE XREF: sub_437678+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4378DE
		add	[ebp+var_C], 1
		jmp	short loc_4378DE
; ---------------------------------------------------------------------------

loc_4378B5:				; CODE XREF: sub_437678+1A0j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_447A78 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_4378DE:				; CODE XREF: sub_437678+1D0j
					; sub_437678+1DAj ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_4379E1
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_437917
		mov	eax, 2Ch
		jmp	short loc_43791C
; ---------------------------------------------------------------------------

loc_437917:				; CODE XREF: sub_437678+296j
		mov	eax, 20h

loc_43791C:				; CODE XREF: sub_437678+29Dj
		mov	edx, offset aCS	; "%c --%s"
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str], edx ; Format
		call	printf
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4379A2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4379A2
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_43797F
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		jmp	short loc_43797F
; ---------------------------------------------------------------------------

loc_437964:				; CODE XREF: sub_437678+31Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_437980
; ---------------------------------------------------------------------------

loc_43797F:				; CODE XREF: sub_437678+2D8j
					; sub_437678+2EAj
		nop

loc_437980:				; CODE XREF: sub_437678+305j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_437994
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_437964

loc_437994:				; CODE XREF: sub_437678+310j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4379A2
		add	[ebp+var_C], 1

loc_4379A2:				; CODE XREF: sub_437678+2C0j
					; sub_437678+2CAj ...
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_447A78 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_14], 3
		jmp	short loc_4379E1
; ---------------------------------------------------------------------------

loc_4379D1:				; CODE XREF: sub_437678+36Fj
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_4379E1:				; CODE XREF: sub_437678+274j
					; sub_437678+357j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_4379D1
		cmp	[ebp+var_C], 0
		jz	loc_437AA4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_437A99
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_437A99
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_437A32
; ---------------------------------------------------------------------------

loc_437A22:				; CODE XREF: sub_437678+3C0j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_437A32:				; CODE XREF: sub_437678+3A8j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_437A22
		jmp	short loc_437A99
; ---------------------------------------------------------------------------

loc_437A3C:				; CODE XREF: sub_437678+42Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_437A82
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_437A93
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_437A78
; ---------------------------------------------------------------------------

loc_437A68:				; CODE XREF: sub_437678+406j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_437A78:				; CODE XREF: sub_437678+3EEj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_437A68
		jmp	short loc_437A93
; ---------------------------------------------------------------------------

loc_437A82:				; CODE XREF: sub_437678+3CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_437A93:				; CODE XREF: sub_437678+3D9j
					; sub_437678+408j
		add	[ebp+var_C], 1
		jmp	short loc_437A9A
; ---------------------------------------------------------------------------

loc_437A99:				; CODE XREF: sub_437678+383j
					; sub_437678+38Fj ...
		nop

loc_437A9A:				; CODE XREF: sub_437678+41Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_437A3C

loc_437AA4:				; CODE XREF: sub_437678+375j
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_437AB3
; ---------------------------------------------------------------------------

loc_437AB2:				; CODE XREF: sub_437678+118j
		nop

loc_437AB3:				; CODE XREF: sub_437678+184j
					; sub_437678+438j
		add	[ebp+var_10], 1

loc_437AB7:				; CODE XREF: sub_437678+E1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_43775E
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_437AE0
		mov	[esp+38h+Str], offset aASingleDashMay ;	"\n(A single dash may be used instead of"...
		call	puts

loc_437AE0:				; CODE XREF: sub_437678+3Aj
					; sub_437678+45Aj
		mov	[esp+38h+Str], 13h
		call	sub_437E99
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_437BC7
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Size],	offset a@email@	; "@EMAIL@"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_437BB0
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jz	short loc_437B60
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	ecx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_437B60:				; CODE XREF: sub_437678+4B5j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aHttpBugs_gnupg ; "http://bugs.gnupg.org"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 15h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_1C], 7
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_437BC7
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		jmp	short loc_437BC7
; ---------------------------------------------------------------------------

loc_437BB0:				; CODE XREF: sub_437678+4A7j
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Size],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_437BC7:				; CODE XREF: sub_437678+47Bj
					; sub_437678+51Dj ...
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Str], eax ; File
		call	fflush
		mov	[esp+38h+Str], 0 ; Code
		call	exit
sub_437678	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_437BE3	proc near		; CODE XREF: sub_436C8D+201p
					; sub_437678+7p

Str		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	[esp+28h+Str], 0Bh
		call	sub_437E99
		mov	[esp+28h+File],	ebx ; File
		mov	[esp+28h+Str], eax ; Str
		call	fputs
		mov	[esp+28h+Str], 0Ch
		call	sub_437E99
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_437C33
		mov	eax, offset aS_3 ; " (%s)"
		mov	edx, [ebp+var_10]
		mov	[esp+28h+File],	edx
		mov	[esp+28h+Str], eax ; Format
		call	printf

loc_437C33:				; CODE XREF: sub_437BE3+3Aj
		mov	[esp+28h+Str], 0Dh
		call	sub_437E99
		mov	edx, offset aSS_1 ; " %s %s\n"
		mov	[esp+28h+var_20], offset aGpg4win2_3_1 ; "(Gpg4win 2.3.1)"
		mov	[esp+28h+File],	eax
		mov	[esp+28h+Str], edx ; Format
		call	printf
		mov	[ebp+var_C], 14h
		jmp	short loc_437C84
; ---------------------------------------------------------------------------

loc_437C61:				; CODE XREF: sub_437BE3+A5j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_437E99
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_437C80
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_437C80:				; CODE XREF: sub_437BE3+90j
		add	[ebp+var_C], 1

loc_437C84:				; CODE XREF: sub_437BE3+7Cj
		cmp	[ebp+var_C], 1Dh
		jle	short loc_437C61
		mov	[esp+28h+Str], 0Eh
		call	sub_437E99
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_437CAA
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_437CAA:				; CODE XREF: sub_437BE3+BAj
		mov	[esp+28h+Str], 0Ah
		call	sub_437E99
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_437CCA
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_437CCA:				; CODE XREF: sub_437BE3+DAj
		mov	[esp+28h+Str], 0Fh
		call	sub_437E99
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_437CF6
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_437CF6:				; CODE XREF: sub_437BE3+FAj
		mov	[esp+28h+Str], 12h
		call	sub_437E99
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_437D22
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_437D22:				; CODE XREF: sub_437BE3+126j
		mov	[ebp+var_C], 1Eh
		jmp	short loc_437D5A
; ---------------------------------------------------------------------------

loc_437D2B:				; CODE XREF: sub_437BE3+17Bj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_437E99
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_437D56
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_437D56:				; CODE XREF: sub_437BE3+15Aj
		add	[ebp+var_C], 1

loc_437D5A:				; CODE XREF: sub_437BE3+146j
		cmp	[ebp+var_C], 27h
		jle	short loc_437D2B
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_437BE3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_437DE8
		mov	dword ptr [esp], 0Eh
		call	sub_437E99
		mov	esi, eax
		mov	dword ptr [esp], 0Dh
		call	sub_437E99
		mov	ebx, eax
		mov	dword ptr [esp], 0Bh
		call	sub_437E99
		mov	edx, offset aSSS_0 ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+10h], esi
		mov	[esp+0Ch], ebx
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], ecx
		call	fprintf
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp], eax
		call	fflush
		jmp	loc_437E91
; ---------------------------------------------------------------------------

loc_437DE8:				; CODE XREF: .text:00437D83j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_437E6B
		mov	dword ptr [esp], 28h
		call	sub_437E99
		mov	[ebp-1Ch], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	fputs
		mov	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_437E5F
		mov	eax, [ebp-1Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_437E5F
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+4], eax
		mov	dword ptr [esp], 0Ah
		call	putc

loc_437E5F:				; CODE XREF: .text:00437E1Cj
					; .text:00437E45j
		mov	dword ptr [esp], 2
		call	exit
; ---------------------------------------------------------------------------

loc_437E6B:				; CODE XREF: .text:00437DECj
		cmp	dword ptr [ebp+8], 2
		jnz	short loc_437E91
		mov	dword ptr [esp], 29h
		call	sub_437E99
		mov	[esp], eax
		call	puts
		mov	dword ptr [esp], 0
		call	exit
; ---------------------------------------------------------------------------

loc_437E91:				; CODE XREF: .text:00437DE3j
					; .text:00437E6Fj
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_437E99	proc near		; CODE XREF: sub_402066+B87p
					; sub_402066+B95p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_449540
		test	eax, eax
		jz	short loc_437EB8
		mov	edx, ds:dword_449540
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_449540
		jmp	short loc_437EBD
; ---------------------------------------------------------------------------

loc_437EB8:				; CODE XREF: sub_437E99+Dj
		mov	eax, 0

loc_437EBD:				; CODE XREF: sub_437E99+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_437ECB
		mov	eax, [ebp+var_C]
		jmp	short locret_437F20
; ---------------------------------------------------------------------------

loc_437ECB:				; CODE XREF: sub_437E99+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_437F1D ; jumptable 00437EDD default case
		mov	eax, ds:off_447E64[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_437EDF:				; CODE XREF: sub_437E99+44j
					; DATA XREF: .rdata:off_447E64o
		mov	[ebp+var_C], offset aLicenseGplv3Gn ; jumptable	00437EDD case 10
		jmp	short loc_437F1D ; jumptable 00437EDD default case
; ---------------------------------------------------------------------------

loc_437EE8:				; CODE XREF: sub_437E99+44j
					; DATA XREF: .rdata:off_447E64o
		mov	[ebp+var_C], offset aFoo ; jumptable 00437EDD case 11
		jmp	short loc_437F1D ; jumptable 00437EDD default case
; ---------------------------------------------------------------------------

loc_437EF1:				; CODE XREF: sub_437E99+44j
					; DATA XREF: .rdata:off_447E64o
		mov	[ebp+var_C], offset a0_0 ; jumptable 00437EDD case 13
		jmp	short loc_437F1D ; jumptable 00437EDD default case
; ---------------------------------------------------------------------------

loc_437EFA:				; CODE XREF: sub_437E99+44j
					; DATA XREF: .rdata:off_447E64o
		mov	[ebp+var_C], offset aCopyrightC2015 ; jumptable	00437EDD case 14
		jmp	short loc_437F1D ; jumptable 00437EDD default case
; ---------------------------------------------------------------------------

loc_437F03:				; CODE XREF: sub_437E99+44j
					; DATA XREF: .rdata:off_447E64o
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	00437EDD case 15
		jmp	short loc_437F1D ; jumptable 00437EDD default case
; ---------------------------------------------------------------------------

loc_437F0C:				; CODE XREF: sub_437E99+44j
					; DATA XREF: .rdata:off_447E64o
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	00437EDD case 16
		jmp	short loc_437F1D ; jumptable 00437EDD default case
; ---------------------------------------------------------------------------

loc_437F15:				; CODE XREF: sub_437E99+44j
					; DATA XREF: .rdata:off_447E64o
		mov	[ebp+var_C], offset dword_447E60 ; jumptable 00437EDD cases 40,41
		nop

loc_437F1D:				; CODE XREF: sub_437E99+3Bj
					; sub_437E99+44j ...
		mov	eax, [ebp+var_C] ; jumptable 00437EDD default case

locret_437F20:				; CODE XREF: sub_437E99+30j
		leave
		retn
sub_437E99	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_437F22	proc near		; CODE XREF: sub_402066+BFp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_449540, eax
		pop	ebp
		retn
sub_437F22	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_437F30	proc near		; CODE XREF: sub_43802F+27Bp
					; sub_43802F+2C4p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_437FC5
		cmp	[ebp+arg_0], 0
		jz	short loc_437F89
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_437F89
		mov	eax, ds:dword_449574
		mov	[ebp+var_1C], eax
		mov	ds:dword_449574, 1
		jmp	short loc_437F9B
; ---------------------------------------------------------------------------

loc_437F89:				; CODE XREF: sub_437F30+1Bj
					; sub_437F30+43j
		mov	eax, ds:dword_449578
		mov	[ebp+var_1C], eax
		mov	ds:dword_449578, 1

loc_437F9B:				; CODE XREF: sub_437F30+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_438003
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_435294
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_435B53
		jmp	short loc_438003
; ---------------------------------------------------------------------------

loc_437FC5:				; CODE XREF: sub_437F30+15j
		mov	eax, ds:dword_44957C
		test	eax, eax
		jnz	short loc_437FF9
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_435294
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_435B53

loc_437FF9:				; CODE XREF: sub_437F30+9Cj
		mov	ds:dword_44957C, 1

loc_438003:				; CODE XREF: sub_437F30+6Fj
					; sub_437F30+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_438027
		mov	off_43D894, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_449544, 0
		mov	ds:dword_449548, 0

loc_438027:				; CODE XREF: sub_437F30+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_437F30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43802F	proc near		; CODE XREF: sub_41DED4+Dp

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str2		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 0
		jnz	loc_438139
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_43805A
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp+var_C], eax

loc_43805A:				; CODE XREF: sub_43802F+1Fj
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	[esp+38h+Dest],	offset byte_449554 ; Dest
		call	sprintf
		mov	[ebp+arg_0], offset byte_449554
		mov	[ebp+Str2], offset aCp936 ; "CP936"
		jmp	loc_43812B
; ---------------------------------------------------------------------------

loc_438089:				; CODE XREF: sub_43802F+104j
		mov	eax, [ebp+Str2]
		mov	[esp+38h+Format], eax ;	Str2
		mov	[esp+38h+Dest],	offset byte_449554 ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_4380B7
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_4380E1
		mov	eax, [ebp+Str2]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4380E1

loc_4380B7:				; CODE XREF: sub_43802F+6Fj
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp+Str2]
		mov	[ebp+arg_0], eax
		jmp	short loc_438139
; ---------------------------------------------------------------------------

loc_4380E1:				; CODE XREF: sub_43802F+79j
					; sub_43802F+86j
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax

loc_43812B:				; CODE XREF: sub_43802F+55j
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_438089

loc_438139:				; CODE XREF: sub_43802F+Bj
					; sub_43802F+B0j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_43819E
		mov	[esp+38h+var_30], 3
		mov	[esp+38h+Format], offset aIso ;	"iso"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_4330A3
		test	eax, eax
		jnz	short loc_43819E
		add	[ebp+arg_0], 3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_43819A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_43819E

loc_43819A:				; CODE XREF: sub_43802F+15Fj
		add	[ebp+arg_0], 1

loc_43819E:				; CODE XREF: sub_43802F+132j
					; sub_43802F+151j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_438204
		mov	[esp+38h+Format], offset a88591	; "8859-1"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_432F69
		test	eax, eax
		jz	short loc_438204
		mov	[esp+38h+Format], offset a646 ;	"646"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_432F69
		test	eax, eax
		jz	short loc_438204
		mov	[esp+38h+Format], offset aAscii	; "ASCII"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_432F69
		test	eax, eax
		jz	short loc_438204
		mov	[esp+38h+Format], offset aAnsi_x3_41968	; "ANSI_X3.4-1968"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_432F69
		test	eax, eax
		jnz	short loc_438227

loc_438204:				; CODE XREF: sub_43802F+177j
					; sub_43802F+18Ej ...
		mov	off_43D894, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_449544, 0
		mov	ds:dword_449548, 0
		jmp	loc_438326
; ---------------------------------------------------------------------------

loc_438227:				; CODE XREF: sub_43802F+1D3j
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_432F69
		test	eax, eax
		jz	short loc_438255
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_432F69
		test	eax, eax
		jnz	short loc_438278

loc_438255:				; CODE XREF: sub_43802F+20Dj
		mov	off_43D894, offset aUtf8 ; "utf-8"
		mov	ds:dword_449544, 1
		mov	ds:dword_449548, 0
		jmp	loc_438326
; ---------------------------------------------------------------------------

loc_438278:				; CODE XREF: sub_43802F+224j
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_4382B6
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	sub_437F30
		mov	eax, 0FFFFFFFFh
		jmp	short loc_43832B
; ---------------------------------------------------------------------------

loc_4382B6:				; CODE XREF: sub_43802F+263j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_4382FF
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_437F30
		mov	eax, 0FFFFFFFFh
		jmp	short loc_43832B
; ---------------------------------------------------------------------------

loc_4382FF:				; CODE XREF: sub_43802F+2ACj
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	off_43D894, eax
		mov	ds:dword_449544, 0
		mov	ds:dword_449548, 1

loc_438326:				; CODE XREF: sub_43802F+1F3j
					; sub_43802F+244j
		mov	eax, 0

loc_43832B:				; CODE XREF: sub_43802F+285j
					; sub_43802F+2CEj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_43802F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_43D894
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43833B	proc near		; CODE XREF: sub_4375CE+43p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_449544
		pop	ebp
		retn
sub_43833B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_438345	proc near		; CODE XREF: sub_438345+129p

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_449544
		test	eax, eax
		jz	short loc_438377
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax
		call	gcry_xstrdup
		mov	[ebp+var_20], eax
		jmp	loc_438586
; ---------------------------------------------------------------------------

loc_438377:				; CODE XREF: sub_438345+1Dj
		mov	eax, ds:dword_449548
		test	eax, eax
		jnz	loc_43842D
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_4383A2
; ---------------------------------------------------------------------------

loc_43838C:				; CODE XREF: sub_438345+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_43839E
		add	[ebp+var_28], 1

loc_43839E:				; CODE XREF: sub_438345+53j
		add	[ebp+var_1C], 1

loc_4383A2:				; CODE XREF: sub_438345+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43838C
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_438418
; ---------------------------------------------------------------------------

loc_4383CB:				; CODE XREF: sub_438345+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_438405
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_438414
; ---------------------------------------------------------------------------

loc_438405:				; CODE XREF: sub_438345+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_438414:				; CODE XREF: sub_438345+BEj
		add	[ebp+var_1C], 1

loc_438418:				; CODE XREF: sub_438345+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4383CB
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_438586
; ---------------------------------------------------------------------------

loc_43842D:				; CODE XREF: sub_438345+39j
		mov	eax, off_43D894
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_438478
		mov	eax, off_43D894
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_437F30
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax
		call	sub_438345
		jmp	loc_438589
; ---------------------------------------------------------------------------

loc_438478:				; CODE XREF: sub_438345+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_438496
; ---------------------------------------------------------------------------

loc_438480:				; CODE XREF: sub_438345+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_438492
		add	[ebp+var_28], 5

loc_438492:				; CODE XREF: sub_438345+147j
		add	[ebp+var_1C], 1

loc_438496:				; CODE XREF: sub_438345+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_438480
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_438575
		mov	eax, ds:dword_449550
		test	eax, eax
		jnz	short loc_438557
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_43D894
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_435294
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_435B53

loc_438557:				; CODE XREF: sub_438345+1D3j
		mov	ds:dword_449550, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_43857B
; ---------------------------------------------------------------------------

loc_438575:				; CODE XREF: sub_438345+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_43857B:				; CODE XREF: sub_438345+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_438586:				; CODE XREF: sub_438345+2Dj
					; sub_438345+E3j
		mov	eax, [ebp+var_20]

loc_438589:				; CODE XREF: sub_438345+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_438345	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_438591	proc near		; CODE XREF: sub_438591+797p
					; sub_438D63+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_4385B5:				; CODE XREF: sub_438591+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_438B57
; ---------------------------------------------------------------------------

loc_4385DA:				; CODE XREF: sub_438591+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_438639
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_438632
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_4385FE
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_438632

loc_4385FE:				; CODE XREF: sub_438591+61j
		cmp	[ebp+var_24], 0
		jz	short loc_438629
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_438629:				; CODE XREF: sub_438591+71j
		add	[ebp+var_1C], 4
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_438632:				; CODE XREF: sub_438591+57j
					; sub_438591+6Bj
		mov	[ebp+var_30], 0

loc_438639:				; CODE XREF: sub_438591+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_43896C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_4387C4
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_4387A4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_438695
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_438695
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_438695
		cmp	[ebp+arg_8], 0
		jz	loc_4387A4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4387A4

loc_438695:				; CODE XREF: sub_438591+D2j
					; sub_438591+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_4386A9
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_4386A9:				; CODE XREF: sub_438591+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_43875A	; jumptable 004386C2 default case
		mov	eax, ds:off_4480DC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4386C4:				; CODE XREF: sub_438591+131j
					; DATA XREF: .rdata:off_4480DCo
		add	[ebp+var_1C], 1	; jumptable 004386C2 case 10
		cmp	[ebp+var_24], 0
		jz	loc_43878B
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_43878B
; ---------------------------------------------------------------------------

loc_4386E1:				; CODE XREF: sub_438591+131j
					; DATA XREF: .rdata:off_4480DCo
		add	[ebp+var_1C], 1	; jumptable 004386C2 case 13
		cmp	[ebp+var_24], 0
		jz	loc_43878E
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_43878E
; ---------------------------------------------------------------------------

loc_4386FE:				; CODE XREF: sub_438591+131j
					; DATA XREF: .rdata:off_4480DCo
		add	[ebp+var_1C], 1	; jumptable 004386C2 case 12
		cmp	[ebp+var_24], 0
		jz	loc_438791
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_438791
; ---------------------------------------------------------------------------

loc_438718:				; CODE XREF: sub_438591+131j
					; DATA XREF: .rdata:off_4480DCo
		add	[ebp+var_1C], 1	; jumptable 004386C2 case 11
		cmp	[ebp+var_24], 0
		jz	short loc_438794
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_438794
; ---------------------------------------------------------------------------

loc_43872E:				; CODE XREF: sub_438591+131j
					; DATA XREF: .rdata:off_4480DCo
		add	[ebp+var_1C], 1	; jumptable 004386C2 case 8
		cmp	[ebp+var_24], 0
		jz	short loc_438797
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_438797
; ---------------------------------------------------------------------------

loc_438744:				; CODE XREF: sub_438591+131j
					; DATA XREF: .rdata:off_4480DCo
		add	[ebp+var_1C], 1	; jumptable 004386C2 case 0
		cmp	[ebp+var_24], 0
		jz	short loc_43879A
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_43879A
; ---------------------------------------------------------------------------

loc_43875A:				; CODE XREF: sub_438591+124j
					; sub_438591+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 004386C2 default case
		cmp	[ebp+var_24], 0
		jz	short loc_43879D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_43879D
; ---------------------------------------------------------------------------

loc_43878B:				; CODE XREF: sub_438591+13Bj
					; sub_438591+14Bj
		nop
		jmp	short loc_43879E
; ---------------------------------------------------------------------------

loc_43878E:				; CODE XREF: sub_438591+158j
					; sub_438591+168j
		nop
		jmp	short loc_43879E
; ---------------------------------------------------------------------------

loc_438791:				; CODE XREF: sub_438591+175j
					; sub_438591+185j
		nop
		jmp	short loc_43879E
; ---------------------------------------------------------------------------

loc_438794:				; CODE XREF: sub_438591+18Fj
					; sub_438591+19Bj
		nop
		jmp	short loc_43879E
; ---------------------------------------------------------------------------

loc_438797:				; CODE XREF: sub_438591+1A5j
					; sub_438591+1B1j
		nop
		jmp	short loc_43879E
; ---------------------------------------------------------------------------

loc_43879A:				; CODE XREF: sub_438591+1BBj
					; sub_438591+1C7j
		nop
		jmp	short loc_43879E
; ---------------------------------------------------------------------------

loc_43879D:				; CODE XREF: sub_438591+1D1j
					; sub_438591+1F8j
		nop

loc_43879E:				; CODE XREF: sub_438591+1FBj
					; sub_438591+1FEj ...
		nop
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_4387A4:				; CODE XREF: sub_438591+C4j
					; sub_438591+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_4387BB
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_4387BB:				; CODE XREF: sub_438591+217j
		add	[ebp+var_1C], 1
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_4387C4:				; CODE XREF: sub_438591+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_43880D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_43880D:				; CODE XREF: sub_438591+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_438856
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_438856:				; CODE XREF: sub_438591+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_43889F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_43889F:				; CODE XREF: sub_438591+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_4388E8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_4388E8:				; CODE XREF: sub_438591+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_438931
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_438931:				; CODE XREF: sub_438591+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_43895C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_43895C:				; CODE XREF: sub_438591+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_43896C:				; CODE XREF: sub_438591+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_438984
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_438A12

loc_438984:				; CODE XREF: sub_438591+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_4389EC
		mov	[ebp+var_10], 0
		jmp	short loc_4389BF
; ---------------------------------------------------------------------------

loc_438993:				; CODE XREF: sub_438591+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_4389BF:				; CODE XREF: sub_438591+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_438993
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_4389EC:				; CODE XREF: sub_438591+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_438A12:				; CODE XREF: sub_438591+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_438B4F
		mov	eax, ds:dword_449544
		test	eax, eax
		jz	short loc_438A8F
		cmp	[ebp+var_24], 0
		jz	short loc_438A7D
		mov	[ebp+var_10], 0
		jmp	short loc_438A75
; ---------------------------------------------------------------------------

loc_438A5D:				; CODE XREF: sub_438591+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_438A75:				; CODE XREF: sub_438591+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_438A5D

loc_438A7D:				; CODE XREF: sub_438591+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_438B4F
; ---------------------------------------------------------------------------

loc_438A8F:				; CODE XREF: sub_438591+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_438AD3
		cmp	[ebp+var_24], 0
		jz	short loc_438AC4
		mov	[ebp+var_10], 0
		jmp	short loc_438ABC
; ---------------------------------------------------------------------------

loc_438AA4:				; CODE XREF: sub_438591+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_438ABC:				; CODE XREF: sub_438591+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_438AA4

loc_438AC4:				; CODE XREF: sub_438591+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_438B4F
; ---------------------------------------------------------------------------

loc_438AD3:				; CODE XREF: sub_438591+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_438AFC
		cmp	[ebp+var_28], 0FFh
		ja	short loc_438AFC
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_438B4F
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_438B4F
; ---------------------------------------------------------------------------

loc_438AFC:				; CODE XREF: sub_438591+546j
					; sub_438591+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_438B3F
		mov	[ebp+var_10], 0
		jmp	short loc_438B37
; ---------------------------------------------------------------------------

loc_438B0B:				; CODE XREF: sub_438591+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_438B37:				; CODE XREF: sub_438591+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_438B0B

loc_438B3F:				; CODE XREF: sub_438591+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_438B4F:				; CODE XREF: sub_438591+9Cj
					; sub_438591+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_438B57:				; CODE XREF: sub_438591+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_4385DA
		cmp	[ebp+var_20], 0
		jnz	short loc_438B83
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_4385B5
; ---------------------------------------------------------------------------

loc_438B83:				; CODE XREF: sub_438591+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_438D53
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_43D894
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_438BF7
		mov	eax, off_43D894
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_437F30
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_438D63
		jmp	loc_438D5C
; ---------------------------------------------------------------------------

loc_438BF7:				; CODE XREF: sub_438591+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_438C5B
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22_20 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_435D0C
; ---------------------------------------------------------------------------

loc_438C5B:				; CODE XREF: sub_438591+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_438D32
		mov	eax, ds:dword_44954C
		test	eax, eax
		jnz	short loc_438CE5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_43D894
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_435294
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_435B53

loc_438CE5:				; CODE XREF: sub_438591+715j
		mov	ds:dword_44954C, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_438591
		mov	[ebp+var_34], eax
		jmp	short loc_438D43
; ---------------------------------------------------------------------------

loc_438D32:				; CODE XREF: sub_438591+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free

loc_438D43:				; CODE XREF: sub_438591+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_438D5C
; ---------------------------------------------------------------------------

loc_438D53:				; CODE XREF: sub_438591+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_438D5C:				; CODE XREF: sub_438591+661j
					; sub_438591+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_438591	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_438D63	proc near		; CODE XREF: .text:0042B8F1p
					; sub_432AA0+50p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_449548
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_438591
		leave
		retn
sub_438D63	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_open
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_close
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_438DEC	proc near		; CODE XREF: sub_438F46+14p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		cmp	[ebp+arg_0], 0
		jnz	short loc_438E06
		mov	[ebp+var_C], 80000001h
		jmp	loc_438F3C
; ---------------------------------------------------------------------------

loc_438E06:				; CODE XREF: sub_438DEC+Cj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_classes_r ; "HKEY_CLASSES_ROOT"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_438E3A
		mov	[ebp+var_C], 80000000h
		jmp	loc_438F3C
; ---------------------------------------------------------------------------

loc_438E3A:				; CODE XREF: sub_438DEC+40j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_438E6E
		mov	[ebp+var_C], 80000001h
		jmp	loc_438F3C
; ---------------------------------------------------------------------------

loc_438E6E:				; CODE XREF: sub_438DEC+74j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_438EA2
		mov	[ebp+var_C], 80000002h
		jmp	loc_438F3C
; ---------------------------------------------------------------------------

loc_438EA2:				; CODE XREF: sub_438DEC+A8j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_users	; "HKEY_USERS"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_438ED3
		mov	[ebp+var_C], 80000003h
		jmp	short loc_438F3C
; ---------------------------------------------------------------------------

loc_438ED3:				; CODE XREF: sub_438DEC+DCj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		mov	ecx, 16h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_438F04
		mov	[ebp+var_C], 80000004h
		jmp	short loc_438F3C
; ---------------------------------------------------------------------------

loc_438F04:				; CODE XREF: sub_438DEC+10Dj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_438F35
		mov	[ebp+var_C], 80000005h
		jmp	short loc_438F3C
; ---------------------------------------------------------------------------

loc_438F35:				; CODE XREF: sub_438DEC+13Ej
		mov	eax, 0
		jmp	short loc_438F3F
; ---------------------------------------------------------------------------

loc_438F3C:				; CODE XREF: sub_438DEC+15j
					; sub_438DEC+49j ...
		mov	eax, [ebp+var_C]

loc_438F3F:				; CODE XREF: sub_438DEC+14Ej
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_438DEC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_438F46(int, LPCSTR, LPCSTR lpValueName)
sub_438F46	proc near		; CODE XREF: sub_41ECD9+71p

hKey		= dword	ptr -58h
lpSubKey	= dword	ptr -54h
ulOptions	= dword	ptr -50h
samDesired	= dword	ptr -4Ch
phkResult	= dword	ptr -48h
lpcbData	= dword	ptr -44h
var_2C		= dword	ptr -2Ch
Type		= dword	ptr -24h
cbData		= dword	ptr -20h
nSize		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpDst		= dword	ptr -14h
var_10		= dword	ptr -10h
lpData		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpValueName	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+lpData], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+hKey],	eax
		call	sub_438DEC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_438F72
		mov	eax, 0
		jmp	loc_439262
; ---------------------------------------------------------------------------

loc_438F72:				; CODE XREF: sub_438F46+20j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	eax, [ebp+var_10]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_438FF1
		cmp	[ebp+arg_0], 0
		jz	short loc_438FB4
		mov	eax, 0
		jmp	loc_439262
; ---------------------------------------------------------------------------

loc_438FB4:				; CODE XREF: sub_438F46+62j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_438FF1
		mov	eax, 0
		jmp	loc_439262
; ---------------------------------------------------------------------------

loc_438FF1:				; CODE XREF: sub_438F46+5Cj
					; sub_438F46+9Fj
		mov	[ebp+cbData], 1
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jnz	loc_439245
		mov	eax, [ebp+cbData]
		add	eax, 1
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jz	loc_439248
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+nSize]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	edx, [ebp+lpData]
		mov	[esp+58h+phkResult], edx ; lpData
		lea	edx, [ebp+Type]
		mov	[esp+58h+samDesired], edx ; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	short loc_4390A6
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	[ebp+lpData], 0
		jmp	loc_43924F
; ---------------------------------------------------------------------------

loc_4390A6:				; CODE XREF: sub_438F46+147j
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpData]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Type]
		cmp	eax, 2
		jnz	loc_43924F
		mov	[esp+58h+lpSubKey], 25h	; Val
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_43924F
		mov	eax, [ebp+nSize]
		add	eax, 3E8h
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_43924B
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	loc_4391C3
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	loc_4391C3
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+cbData]
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_43924E
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_4391A4
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	short loc_4391A4
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	loc_43924F
; ---------------------------------------------------------------------------

loc_4391A4:				; CODE XREF: sub_438F46+242j
					; sub_438F46+24Cj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	loc_43924F
; ---------------------------------------------------------------------------

loc_4391C3:				; CODE XREF: sub_438F46+1DCj
					; sub_438F46+1EAj
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_439238
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+lpDst]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jnz	short loc_439219
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	short loc_43924F
; ---------------------------------------------------------------------------

loc_439219:				; CODE XREF: sub_438F46+2C9j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; Source
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	short loc_43924F
; ---------------------------------------------------------------------------

loc_439238:				; CODE XREF: sub_438F46+282j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	short loc_43924F
; ---------------------------------------------------------------------------

loc_439245:				; CODE XREF: sub_438F46+EAj
		nop
		jmp	short loc_43924F
; ---------------------------------------------------------------------------

loc_439248:				; CODE XREF: sub_438F46+10Bj
		nop
		jmp	short loc_43924F
; ---------------------------------------------------------------------------

loc_43924B:				; CODE XREF: sub_438F46+1B0j
		nop
		jmp	short loc_43924F
; ---------------------------------------------------------------------------

loc_43924E:				; CODE XREF: sub_438F46+216j
		nop

loc_43924F:				; CODE XREF: sub_438F46+15Bj
					; sub_438F46+16Fj ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		mov	eax, [ebp+lpData]

loc_439262:				; CODE XREF: sub_438F46+27j
					; sub_438F46+69j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_438F46	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 0A8h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4326C7
		test	eax, eax
		jnz	short loc_439293
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_4393BD
; ---------------------------------------------------------------------------

loc_439293:				; CODE XREF: .text:00439285j
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_4392E8
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_4393BD
; ---------------------------------------------------------------------------

loc_4392E8:				; CODE XREF: .text:004392DAj
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_43933A
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4393AD
; ---------------------------------------------------------------------------

loc_43933A:				; CODE XREF: .text:0043932Fj
		lea	eax, [ebp-7Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_439395
		lea	eax, [ebp-48h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_439395
		mov	edx, [ebp-60h]
		mov	eax, [ebp-2Ch]
		cmp	edx, eax
		jnz	short loc_439395
		mov	edx, [ebp-50h]
		mov	eax, [ebp-1Ch]
		cmp	edx, eax
		jnz	short loc_439395
		mov	edx, [ebp-4Ch]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jnz	short loc_439395
		mov	eax, 1
		jmp	short loc_43939A
; ---------------------------------------------------------------------------

loc_439395:				; CODE XREF: .text:00439353j
					; .text:0043936Ej ...
		mov	eax, 0

loc_43939A:				; CODE XREF: .text:00439393j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_4393AD:				; CODE XREF: .text:00439338j
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_4393BD:				; CODE XREF: .text:0043928Ej
					; .text:004392E3j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4393C2	proc near		; CODE XREF: sub_42082F+2BDp

VarName		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	[esp+38h+VarName], offset aTz ;	"TZ"
		call	getenv
		mov	[ebp+var_C], eax
		mov	[esp+38h+VarName], offset EnvString ; "TZ=UTC"
		call	_putenv
		call	_tzset
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax
		call	sub_43C100
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jz	short loc_439478
		mov	eax, ds:dword_449580
		test	eax, eax
		jnz	short loc_439460
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 4
		mov	[esp+38h+VarName], eax ; Size
		call	malloc
		mov	ds:dword_449580, eax
		mov	eax, ds:dword_449580
		test	eax, eax
		jz	short loc_439460
		mov	edx, offset aTz_0 ; "TZ="
		mov	eax, ds:dword_449580
		mov	edx, [edx]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_449580
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+VarName], eax ; Dest
		call	strcat

loc_439460:				; CODE XREF: sub_4393C2+42j
					; sub_4393C2+7Aj
		mov	eax, ds:dword_449580
		test	eax, eax
		jz	short loc_439484
		mov	eax, ds:dword_449580
		mov	[esp+38h+VarName], eax ; EnvString
		call	_putenv
		jmp	short loc_439484
; ---------------------------------------------------------------------------

loc_439478:				; CODE XREF: sub_4393C2+39j
		mov	[esp+38h+VarName], offset aTz ;	"TZ"
		call	_putenv

loc_439484:				; CODE XREF: sub_4393C2+A5j
					; sub_4393C2+B4j
		call	_tzset
		mov	eax, [ebp+var_10]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4393C2	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_439494	proc near		; CODE XREF: sub_439832+Cp

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_24], eax
		mov	[ebp+var_28], 3A2F8h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_54], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_54]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 5
		jle	short loc_43950D
		mov	eax, [ebp+var_2C]
		sub	eax, 6
		add	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aXxxxxx ; "XXXXXX"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_439524

loc_43950D:				; CODE XREF: sub_439494+49j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_43982A
; ---------------------------------------------------------------------------

loc_439524:				; CODE XREF: sub_439494+77j
		mov	eax, [ebp+var_2C]
		sub	eax, 6
		add	eax, [ebp+arg_0]
		mov	[ebp+var_30], eax
		mov	[esp+68h+var_64], 0
		lea	eax, [ebp+var_48]
		mov	[esp+68h+var_68], eax
		call	sub_43C850
		mov	eax, [ebp+var_44]
		mov	edx, eax
		sar	edx, 1Fh
		mov	ecx, eax
		mov	ebx, edx
		shld	ebx, ecx, 10h
		shl	ecx, 10h
		mov	eax, [ebp+var_48]
		mov	edx, eax
		sar	edx, 1Fh
		mov	esi, ecx
		xor	esi, eax
		mov	[ebp+var_38], esi
		mov	eax, ebx
		xor	eax, edx
		mov	[ebp+var_34], eax
		call	_getpid
		mov	edx, eax
		sar	edx, 1Fh
		mov	esi, [ebp+var_38]
		xor	esi, eax
		mov	[ebp+var_50], esi
		mov	edi, [ebp+var_34]
		xor	edi, edx
		mov	[ebp+var_4C], edi
		mov	eax, ds:dword_449588
		mov	edx, ds:dword_44958C
		add	eax, [ebp+var_50]
		adc	edx, [ebp+var_4C]
		mov	ds:dword_449588, eax
		mov	ds:dword_44958C, edx
		mov	[ebp+var_1C], 0
		jmp	loc_43980C
; ---------------------------------------------------------------------------

loc_4395AE:				; CODE XREF: sub_439494+37Ej
		mov	eax, ds:dword_449588
		mov	edx, ds:dword_44958C
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B740
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_30]
		mov	[eax], dl
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B640
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+1]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B740
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B640
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+2]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B740
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B640
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+3]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B740
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B640
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+4]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B740
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B640
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+5]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_43B740
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	_mkdir
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		js	short loc_4397D5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		jmp	short loc_43982A
; ---------------------------------------------------------------------------

loc_4397D5:				; CODE XREF: sub_439494+32Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 11h
		jz	short loc_4397EA
		mov	eax, 0FFFFFFFFh
		jmp	short loc_43982A
; ---------------------------------------------------------------------------

loc_4397EA:				; CODE XREF: sub_439494+34Dj
		mov	eax, ds:dword_449588
		mov	edx, ds:dword_44958C
		add	eax, 1E61h
		adc	edx, 0
		mov	ds:dword_449588, eax
		mov	ds:dword_44958C, edx
		add	[ebp+var_1C], 1

loc_43980C:				; CODE XREF: sub_439494+115j
		mov	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_28]
		jb	loc_4395AE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 11h
		mov	eax, 0FFFFFFFFh

loc_43982A:				; CODE XREF: sub_439494+8Bj
					; sub_439494+33Fj ...
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_439494	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_439832	proc near		; CODE XREF: sub_40378F+87p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_439494
		test	eax, eax
		jz	short loc_43984E
		mov	eax, 0
		jmp	short locret_439851
; ---------------------------------------------------------------------------

loc_43984E:				; CODE XREF: sub_439832+13j
		mov	eax, [ebp+arg_0]

locret_439851:				; CODE XREF: sub_439832+1Aj
		leave
		retn
sub_439832	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_439854(char *, void *Src, int, int)
sub_439854	proc near		; CODE XREF: sub_439D3A+22p

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
MaxCount	= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
Dst		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Size		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+Size], eax
		cmp	[ebp+Src], 0
		jz	short loc_4398A9
		mov	eax, [ebp+Src]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		jmp	short loc_4398AE
; ---------------------------------------------------------------------------

loc_4398A9:				; CODE XREF: sub_439854+2Fj
		mov	eax, 0

loc_4398AE:				; CODE XREF: sub_439854+53j
		mov	[ebp+var_24], eax
		mov	eax, ds:_environ
		mov	esi, [eax]
		mov	ebx, 0
		test	esi, esi
		jz	short loc_4398F7
		jmp	short loc_4398F1
; ---------------------------------------------------------------------------

loc_4398C3:				; CODE XREF: sub_439854+A1j
		mov	eax, [esi]
		mov	edx, [ebp+Size]
		mov	[esp+58h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+Str2],	edx ; Str2
		mov	[esp+58h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_4398EB
		mov	eax, [esi]
		add	eax, [ebp+Size]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_4398F7

loc_4398EB:				; CODE XREF: sub_439854+89j
		add	ebx, 1
		add	esi, 4

loc_4398F1:				; CODE XREF: sub_439854+6Dj
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_4398C3

loc_4398F7:				; CODE XREF: sub_439854+6Bj
					; sub_439854+95j
		test	esi, esi
		jz	short loc_439905
		mov	eax, [esi]
		test	eax, eax
		jnz	loc_439B87

loc_439905:				; CODE XREF: sub_439854+A5j
		mov	eax, ds:Memory
		test	eax, eax
		jnz	short loc_43991E
		lea	eax, [ebx+2]
		shl	eax, 2
		mov	[esp+58h+Str1],	eax ; Size
		call	malloc
		jmp	short loc_439939
; ---------------------------------------------------------------------------

loc_43991E:				; CODE XREF: sub_439854+B8j
		lea	eax, [ebx+2]
		lea	edx, ds:0[eax*4]
		mov	eax, ds:Memory
		mov	[esp+58h+Str2],	edx ; NewSize
		mov	[esp+58h+Str1],	eax ; Memory
		call	realloc

loc_439939:				; CODE XREF: sub_439854+C8j
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_43994C
		mov	eax, 0FFFFFFFFh
		jmp	loc_439D32
; ---------------------------------------------------------------------------

loc_43994C:				; CODE XREF: sub_439854+ECj
		cmp	[ebp+arg_8], 0
		jz	short loc_439966
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+var_30]
		mov	edx, [ebp+arg_8]
		mov	[eax], edx
		jmp	loc_439B2F
; ---------------------------------------------------------------------------

loc_439966:				; CODE XREF: sub_439854+FCj
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 1
		cmp	eax, 0FB7h
		ja	short loc_4399BB
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 9
		lea	edx, [eax+0Fh]
		mov	eax, 10h
		sub	eax, 1
		add	eax, edx
		mov	[ebp+var_40], 10h
		mov	edx, 0
		div	[ebp+var_40]
		imul	eax, 10h
		call	sub_43B610
		sub	esp, eax
		lea	eax, [esp+58h+var_4C]
		add	eax, 0Fh
		shr	eax, 4
		shl	eax, 4
		add	eax, 8
		jmp	short loc_4399CE
; ---------------------------------------------------------------------------

loc_4399BB:				; CODE XREF: sub_439854+122j
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 1
		mov	[esp+58h+Str1],	eax
		call	sub_439DB0

loc_4399CE:				; CODE XREF: sub_439854+165j
		mov	[ebp+Dst], eax
		cmp	[ebp+Dst], 0
		jnz	short loc_4399EE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_439D32
; ---------------------------------------------------------------------------

loc_4399EE:				; CODE XREF: sub_439854+181j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+Dst]
		mov	ecx, [ebp+Size]
		mov	[esp+58h+MaxCount], ecx	; Size
		mov	[esp+58h+Str2],	edx ; Src
		mov	[esp+58h+Str1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+Size]
		mov	edx, [ebp+Dst]
		add	eax, edx
		mov	byte ptr [eax],	3Dh
		mov	edx, [ebp+Src]
		mov	eax, [ebp+Size]
		add	eax, 1
		add	eax, [ebp+Dst]
		mov	ecx, [ebp+var_24]
		mov	[esp+58h+MaxCount], ecx	; Size
		mov	[esp+58h+Str2],	edx ; Src
		mov	[esp+58h+Str1],	eax ; Dst
		call	memcpy
		lea	eax, ds:0[ebx*4]
		mov	esi, eax
		add	esi, [ebp+var_30]
		mov	[esp+58h+MaxCount], offset strcmp
		mov	[esp+58h+Str2],	offset dword_449590
		mov	eax, [ebp+Dst]
		mov	[esp+58h+Str1],	eax
		call	sub_43C8F0
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_439A68
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		jmp	short loc_439A6D
; ---------------------------------------------------------------------------

loc_439A68:				; CODE XREF: sub_439854+20Bj
		mov	eax, 0

loc_439A6D:				; CODE XREF: sub_439854+212j
		mov	[esi], eax
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+var_30]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_439B24
		lea	eax, ds:0[ebx*4]
		mov	esi, eax
		add	esi, [ebp+var_30]
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 1
		mov	[esp+58h+Str1],	eax ; Size
		call	malloc
		mov	[esi], eax
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+var_30]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_439AD6
		mov	eax, [ebp+Dst]
		mov	[esp+58h+Str1],	eax
		call	sub_439E3D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_439D32
; ---------------------------------------------------------------------------

loc_439AD6:				; CODE XREF: sub_439854+25Ej
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		lea	ecx, [eax+1]
		mov	edx, [ebp+Dst]
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+var_30]
		mov	eax, [eax]
		mov	[esp+58h+MaxCount], ecx	; Size
		mov	[esp+58h+Str2],	edx ; Src
		mov	[esp+58h+Str1],	eax ; Dst
		call	memcpy
		lea	eax, ds:0[ebx*4]
		add	eax, [ebp+var_30]
		mov	eax, [eax]
		mov	[esp+58h+MaxCount], offset strcmp
		mov	[esp+58h+Str2],	offset dword_449590
		mov	[esp+58h+Str1],	eax
		call	sub_43C950

loc_439B24:				; CODE XREF: sub_439854+229j
		mov	eax, [ebp+Dst]
		mov	[esp+58h+Str1],	eax
		call	sub_439E3D

loc_439B2F:				; CODE XREF: sub_439854+10Dj
		mov	eax, ds:_environ
		mov	edx, [eax]
		mov	eax, ds:Memory
		cmp	edx, eax
		jz	short loc_439B62
		lea	ecx, ds:0[ebx*4]
		mov	eax, ds:_environ
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+MaxCount], ecx	; Size
		mov	[esp+58h+Str2],	edx ; Src
		mov	[esp+58h+Str1],	eax ; Dst
		call	memcpy

loc_439B62:				; CODE XREF: sub_439854+2E9j
		lea	eax, [ebx+1]
		shl	eax, 2
		add	eax, [ebp+var_30]
		mov	dword ptr [eax], 0
		mov	eax, ds:_environ
		mov	edx, [ebp+var_30]
		mov	[eax], edx
		mov	eax, [eax]
		mov	ds:Memory, eax
		jmp	loc_439D2D
; ---------------------------------------------------------------------------

loc_439B87:				; CODE XREF: sub_439854+ABj
		cmp	[ebp+arg_C], 0
		jz	loc_439D2D
		cmp	[ebp+arg_8], 0
		jz	short loc_439BA2
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], eax
		jmp	loc_439D28
; ---------------------------------------------------------------------------

loc_439BA2:				; CODE XREF: sub_439854+341j
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 1
		cmp	eax, 0FB7h
		ja	short loc_439BF7
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 9
		lea	edx, [eax+0Fh]
		mov	eax, 10h
		sub	eax, 1
		add	eax, edx
		mov	[ebp+var_40], 10h
		mov	edx, 0
		div	[ebp+var_40]
		imul	eax, 10h
		call	sub_43B610
		sub	esp, eax
		lea	eax, [esp+58h+var_4C]
		add	eax, 0Fh
		shr	eax, 4
		shl	eax, 4
		add	eax, 8
		jmp	short loc_439C0A
; ---------------------------------------------------------------------------

loc_439BF7:				; CODE XREF: sub_439854+35Ej
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 1
		mov	[esp+58h+Str1],	eax
		call	sub_439DB0

loc_439C0A:				; CODE XREF: sub_439854+3A1j
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_439C2A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_439D32
; ---------------------------------------------------------------------------

loc_439C2A:				; CODE XREF: sub_439854+3BDj
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_28]
		mov	ecx, [ebp+Size]
		mov	[esp+58h+MaxCount], ecx	; Size
		mov	[esp+58h+Str2],	edx ; Src
		mov	[esp+58h+Str1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+Size]
		mov	edx, [ebp+var_28]
		add	eax, edx
		mov	byte ptr [eax],	3Dh
		mov	edx, [ebp+Src]
		mov	eax, [ebp+Size]
		add	eax, 1
		add	eax, [ebp+var_28]
		mov	ecx, [ebp+var_24]
		mov	[esp+58h+MaxCount], ecx	; Size
		mov	[esp+58h+Str2],	edx ; Src
		mov	[esp+58h+Str1],	eax ; Dst
		call	memcpy
		mov	[esp+58h+MaxCount], offset strcmp
		mov	[esp+58h+Str2],	offset dword_449590
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	sub_43C8F0
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_439C98
		mov	eax, [ebp+var_2C]
		mov	eax, [eax]
		jmp	short loc_439C9D
; ---------------------------------------------------------------------------

loc_439C98:				; CODE XREF: sub_439854+43Bj
		mov	eax, 0

loc_439C9D:				; CODE XREF: sub_439854+442j
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_439D1D
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		add	eax, 1
		mov	[esp+58h+Str1],	eax ; Size
		call	malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_439CE1
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	sub_439E3D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0FFFFFFFFh
		jmp	short loc_439D32
; ---------------------------------------------------------------------------

loc_439CE1:				; CODE XREF: sub_439854+46Cj
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+Size]
		add	eax, edx
		lea	ecx, [eax+1]
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+MaxCount], ecx	; Size
		mov	[esp+58h+Str2],	edx ; Src
		mov	[esp+58h+Str1],	eax ; Dst
		call	memcpy
		mov	[esp+58h+MaxCount], offset strcmp
		mov	[esp+58h+Str2],	offset dword_449590
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str1],	eax
		call	sub_43C950

loc_439D1D:				; CODE XREF: sub_439854+450j
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str1],	eax
		call	sub_439E3D

loc_439D28:				; CODE XREF: sub_439854+349j
		mov	eax, [ebp+var_1C]
		mov	[esi], eax

loc_439D2D:				; CODE XREF: sub_439854+32Ej
					; sub_439854+337j
		mov	eax, 0

loc_439D32:				; CODE XREF: sub_439854+F3j
					; sub_439854+195j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_439854	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_439D3A(char *, void *, int)
sub_439D3A	proc near		; CODE XREF: sub_40E682+BAp

var_18		= dword	ptr -18h
Src		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_C], eax ; int
		mov	[esp+18h+var_10], 0 ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Src], eax ; Src
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_439854
		leave
		retn
sub_439D3A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:_environ
		mov	edx, [eax]
		mov	eax, ds:Memory
		cmp	edx, eax
		jnz	short loc_439D9D
		mov	eax, ds:_environ
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_439D9D
		mov	eax, ds:_environ
		mov	eax, [eax]
		mov	[esp], eax
		call	free
		mov	ds:Memory, 0

loc_439D9D:				; CODE XREF: .text:00439D77j
					; .text:00439D82j
		mov	eax, ds:_environ
		mov	dword ptr [eax], 0
		mov	eax, 0
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_439DB0	proc near		; CODE XREF: sub_439854+175p
					; sub_439854+3B1p

Size		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		add	eax, 8
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jb	short loc_439E36
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_439E36
		add	[ebp+var_10], 8
		mov	eax, [ebp+var_10]
		sub	eax, 4
		mov	dword ptr [eax], 1415FB4Ah
		mov	ecx, [ebp+var_10]
		mov	edx, 0FF00FF01h
		mov	eax, ecx
		mul	edx
		mov	eax, edx
		shr	eax, 8
		mov	[ebp+var_14], eax
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 8
		add	eax, edx
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		lea	edx, [eax-8]
		mov	eax, [ebp+var_14]
		mov	eax, ds:dword_4495A0[eax*4]
		mov	[edx], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	ds:dword_4495A0[eax*4],	edx
		mov	eax, [ebp+var_10]
		jmp	short locret_439E3B
; ---------------------------------------------------------------------------

loc_439E36:				; CODE XREF: sub_439DB0+15j
					; sub_439DB0+29j
		mov	eax, 0

locret_439E3B:				; CODE XREF: sub_439DB0+84j
		leave
		retn
sub_439DB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_439E3D	proc near		; CODE XREF: sub_439854+266p
					; sub_439854+2D6p ...

Memory		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	locret_439ED1
		mov	eax, [ebp+arg_0]
		sub	eax, 4
		mov	eax, [eax]
		cmp	eax, 1415FB4Ah
		jnz	short locret_439ED1
		mov	ecx, [ebp+arg_0]
		mov	edx, 0FF00FF01h
		mov	eax, ecx
		mul	edx
		mov	eax, edx
		shr	eax, 8
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 8
		add	eax, edx
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, offset dword_4495A0
		mov	[ebp+var_C], eax
		jmp	short loc_439EC8
; ---------------------------------------------------------------------------

loc_439E93:				; CODE XREF: sub_439E3D+92j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_439EBD
		mov	eax, [ebp+arg_0]
		sub	eax, 8
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free
		jmp	short locret_439ED1
; ---------------------------------------------------------------------------

loc_439EBD:				; CODE XREF: sub_439E3D+5Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		sub	eax, 8
		mov	[ebp+var_C], eax

loc_439EC8:				; CODE XREF: sub_439E3D+54j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_439E93

locret_439ED1:				; CODE XREF: sub_439E3D+Aj
					; sub_439E3D+1Dj ...
		leave
		retn
sub_439E3D	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_control]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xmalloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_check_version]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_malloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xstrdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_algo_info]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_sprint]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_malloc_secure]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xcalloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_scan]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_aprint]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_cmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_invm]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_build_array]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_nth_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_find_token]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_nth_mpi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_nth_string]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_nth]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_get_keygrip]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_testkey]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_canon_len]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_sscan]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_hash_buffer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_get_algo_dlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_calloc_secure]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_cadr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_algo_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_build]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_get_nbits]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_dump]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_sign]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_decrypt]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_genkey]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_get_algo_blklen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_create_nonce]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_setiv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_setkey]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_encrypt]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_decrypt]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_reset]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_ctl]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_log_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_fatalerror_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_outofcore_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_map_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_map_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xrealloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_syserror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_set_errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 4
		jmp	ds:__assuan_pipe
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_close
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_spawn
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_socketpair
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_socket
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_connect
; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_assuan_log_stream]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_malloc_hooks]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_assuan_log_prefix]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_gpg_err_source]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_system_hooks]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_bind]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_get_nonce]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_check_nonce]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_socket_connect]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_transact]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_send_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_get_pointer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_error]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_write_status]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_inquire]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_begin_confidential]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_okay_line]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_command]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_post_cmd_notify]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_reset_notify]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_option_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_init_pipe_server]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_init_socket_server]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_pointer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_io_monitor]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_accept]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_process]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_get_pid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_pipe_connect]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_get_flag]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_flag]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_log_stream]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_end_confidential]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_write_line]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __WSAFDIsSet]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_usleep]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_waitpid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_leave]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_enter]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_thread_id]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_attr_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_attr_set]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_spawn]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_sigmask]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_ctrl]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_timeout]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_concat]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_select_ev]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_isolate]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_occurred]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_sleep]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_accept]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_attr_destroy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_mutex_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_mutex_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_mutex_acquire]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_join]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_kill]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_yield]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:0044D024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_43A380
		cmp	eax, 3
		jz	short loc_43A380
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_43A380:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_43B570
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_44825Co ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_43A3F4
		cmp	dword_43D8A8, 2
		jz	short loc_43A3D6
		mov	dword_43D8A8, 2

loc_43A3D6:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_43A4E3
		cmp	eax, 1
		jz	loc_43A482

loc_43A3E8:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_43A3F4:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_449E40, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_43A513
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_449E3C, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_449E38, eax
		jz	loc_43A513
		mov	ecx, ds:dword_449E3C
		test	ecx, ecx
		jz	short loc_43A4A3
		test	eax, eax
		jz	short loc_43A4A3
		mov	dword_43D8A8, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_43A482:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_43B570
		jmp	loc_43A3E8
; ---------------------------------------------------------------------------

loc_43A4A3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_449E38, 0
		mov	ds:dword_449E3C, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_43A4C3:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_43D8A8, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_43A4E3:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_44D030
		cmp	ebx, offset dword_44D030
		jz	loc_43A3E8

loc_43A4F4:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_43A4FC
		call	eax

loc_43A4FC:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_44D030
		jnz	short loc_43A4F4
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_43A513:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_449E38, 0
		mov	ds:dword_449E3C, 0
		jmp	short loc_43A4C3
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43A540	proc near		; DATA XREF: .CRT:0044D014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_43A540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43A550	proc near		; CODE XREF: sub_43A570+10p
					; sub_43A570+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_43A550	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43A560	proc near		; CODE XREF: sub_401060+59p
					; sub_43A570+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_43A560	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_43A570(_onexit_t)
sub_43A570	proc near		; CODE XREF: sub_43A630+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_449E48
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_43A550
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_43A610
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_449E48
		mov	[esp+2Ch+Func],	eax
		call	sub_43A550
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_449E44
		mov	[esp+2Ch+Func],	eax
		call	sub_43A550
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_43A560
		mov	ds:dword_449E48, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_43A560
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_449E44, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43A610:				; CODE XREF: sub_43A570+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_43A570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_43A630(_onexit_t)
sub_43A630	proc near		; CODE XREF: sub_402066+C04p
					; sub_425FED+63p ...

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_43A570
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_43A630	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_43A6A7
		cmp	eax, 0C000008Dh
		jb	short loc_43A6D4

loc_43A66B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_43A670:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_43A7A0
		test	eax, eax
		jz	short loc_43A6BC
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_43A69F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_43A6A7:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_43A715
		cmp	eax, 0C0000096h
		jz	short loc_43A6E2
		cmp	eax, 0C0000093h
		jz	short loc_43A66B

loc_43A6BC:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_4499E8
		test	eax, eax
		jz	loc_43A793
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_43A6D4:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_43A720
		cmp	eax, 0C000001Dh
		jnz	short loc_43A6BC

loc_43A6E2:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_43A757
		test	eax, eax
		jz	short loc_43A6BC
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_43A715:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_43A670
; ---------------------------------------------------------------------------
		align 10h

loc_43A720:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_43A775
		test	eax, eax
		jz	loc_43A6BC
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_43A757:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_43A69F
; ---------------------------------------------------------------------------

loc_43A775:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_43A69F
; ---------------------------------------------------------------------------

loc_43A793:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_43A69F
; ---------------------------------------------------------------------------
		align 10h

loc_43A7A0:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_43A69F
		mov	[esp+2Ch+var_10], eax
		call	sub_43B1C0
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_43A69F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_4499EC
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_43A821
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_4499EC
		jmp	short loc_43A827
; ---------------------------------------------------------------------------

loc_43A821:				; CODE XREF: .text:0043A7F6j
		fstp	st
		fstp	st
		fstp	st

loc_43A827:				; CODE XREF: .text:0043A81Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43A830	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_4499EC, eax
		jmp	__setusermatherr
sub_43A830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43A840	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_43A85D
		mov	edx, ds:off_44837C[ecx*4]

loc_43A85D:				; CODE XREF: sub_43A840+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_43A840	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43A8A0	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_43A8A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_43A8B0(char *Format, char ArgList)
sub_43A8B0	proc near		; CODE XREF: sub_43A910+1DDp
					; sub_43A910+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_43A8B0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_43A910
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_43A910(size_t Size)
sub_43A910	proc near		; CODE XREF: .text:0043A901j
					; sub_43AB50+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_4499F8
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_43AAF2
		mov	eax, ds:dword_4499F4
		xor	esi, esi

loc_43A934:				; CODE XREF: sub_43A910+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_43A949
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_43AA20

loc_43A949:				; CODE XREF: sub_43A910+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_43A934

loc_43A953:				; CODE XREF: sub_43A910+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_43AF10
		test	eax, eax
		mov	edi, eax
		jz	loc_43AB19
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_4499F4
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_43AFF0
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_4499F4
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_43AAF9
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_43AAA1

loc_43A9CF:				; CODE XREF: sub_43A910+194j
					; sub_43A910+1C6j
		add	ds:dword_4499F8, 1

loc_43A9D6:				; CODE XREF: sub_43A910+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_43AB29
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_43AA28

loc_43A9FF:				; CODE XREF: sub_43A910+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_43AA13:				; CODE XREF: sub_43A910+162j
					; sub_43A910+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43AA20:				; CODE XREF: sub_43A910+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_43A9D6
; ---------------------------------------------------------------------------

loc_43AA28:				; CODE XREF: sub_43A910+EDj
		cmp	eax, 40h
		jz	short loc_43A9FF
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_43AA13
		cmp	eax, 4
		jz	short loc_43AA13
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_43AAA1:				; CODE XREF: sub_43A910+B9j
		cmp	eax, 40h
		jz	loc_43A9CF
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_4499F4
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_43A9CF
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_43A8B0
; ---------------------------------------------------------------------------

loc_43AAF2:				; CODE XREF: sub_43A910+17j
		xor	esi, esi
		jmp	loc_43A953
; ---------------------------------------------------------------------------

loc_43AAF9:				; CODE XREF: sub_43A910+ACj
		mov	eax, ds:dword_4499F4
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_43A8B0
; ---------------------------------------------------------------------------

loc_43AB19:				; CODE XREF: sub_43A910+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_43A8B0
; ---------------------------------------------------------------------------

loc_43AB29:				; CODE XREF: sub_43A910+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_43A8B0
sub_43A910	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43AB50	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_4499F0
		test	eax, eax
		jz	short loc_43AB70

loc_43AB62:				; CODE XREF: sub_43AB50+66j
					; sub_43AB50+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43AB70:				; CODE XREF: sub_43AB50+10j
		mov	ds:dword_4499F0, 1
		call	sub_43AF50
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_43B610
		mov	ds:dword_4499F8, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_4499F4, eax
		mov	eax, offset dword_4486A0
		sub	eax, offset dword_4486A0
		cmp	eax, 7
		jle	short loc_43AB62
		cmp	eax, 0Bh
		mov	ebx, offset dword_4486A0
		jle	loc_43ACB0
		mov	eax, ds:dword_4486A0
		test	eax, eax
		jnz	short loc_43ABE0
		mov	eax, ds:dword_4486A4
		test	eax, eax
		jz	loc_43AC9C
		lea	esi, [esi+0]

loc_43ABE0:				; CODE XREF: sub_43AB50+7Dj
					; sub_43AB50+164j ...
		cmp	ebx, offset dword_4486A0
		jnb	loc_43AB62
		mov	esi, 400000h

loc_43ABF1:				; CODE XREF: sub_43AB50+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_43A910
		cmp	ebx, offset dword_4486A0
		jb	short loc_43ABF1

loc_43AC15:				; CODE XREF: sub_43AB50+24Bj
		mov	ecx, ds:dword_4499F8
		test	ecx, ecx
		jle	loc_43AB62
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_43AC42
; ---------------------------------------------------------------------------
		align 10h

loc_43AC30:				; CODE XREF: sub_43AB50+FDj
					; sub_43AB50+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_4499F8
		jge	loc_43AB62

loc_43AC42:				; CODE XREF: sub_43AB50+DDj
		mov	eax, ds:dword_4499F4
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_43AC30
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_43ADC2
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_4499F4
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_43AC30
; ---------------------------------------------------------------------------

loc_43AC9C:				; CODE XREF: sub_43AB50+86j
		mov	eax, ds:dword_4486A8
		test	eax, eax
		jnz	short loc_43ACC5
		mov	ebx, offset dword_4486AC
		lea	esi, [esi+0]

loc_43ACB0:				; CODE XREF: sub_43AB50+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_43ABE0
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_43ABE0

loc_43ACC5:				; CODE XREF: sub_43AB50+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_43ADE5
		add	ebx, 0Ch
		cmp	ebx, offset dword_4486A0
		jnb	loc_43AB62

loc_43ACE0:				; CODE XREF: sub_43AB50+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_43AD3A
		cmp	edx, 20h
		jz	short loc_43AD70
		cmp	edx, 8
		jz	short loc_43AD1A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_43A8B0
; ---------------------------------------------------------------------------

loc_43AD1A:				; CODE XREF: sub_43AB50+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_43AD45
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_43AD61
; ---------------------------------------------------------------------------

loc_43AD3A:				; CODE XREF: sub_43AB50+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_43ADA0

loc_43AD45:				; CODE XREF: sub_43AB50+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_43ADB3
		cmp	edx, 20h
		jz	short loc_43AD7F
		cmp	edx, 8
		jnz	short loc_43AD8C

loc_43AD61:				; CODE XREF: sub_43AB50+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_43A910
		jmp	short loc_43AD8C
; ---------------------------------------------------------------------------

loc_43AD70:				; CODE XREF: sub_43AB50+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_43AD7F:				; CODE XREF: sub_43AB50+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_43A910

loc_43AD8C:				; CODE XREF: sub_43AB50+20Fj
					; sub_43AB50+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_4486A0
		jb	loc_43ACE0
		jmp	loc_43AC15
; ---------------------------------------------------------------------------

loc_43ADA0:				; CODE XREF: sub_43AB50+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_43ADB3:				; CODE XREF: sub_43AB50+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_43A910
		jmp	short loc_43AD8C
; ---------------------------------------------------------------------------

loc_43ADC2:				; CODE XREF: sub_43AB50+11Bj
		add	ebx, ds:dword_4499F4
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_43A8B0
; ---------------------------------------------------------------------------

loc_43ADE5:				; CODE XREF: sub_43AB50+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_43A8B0
sub_43AB50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43AE00	proc near		; CODE XREF: .text:0043AEA1p
					; sub_43AF10+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_43AE10

locret_43AE0D:				; CODE XREF: sub_43AE00+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_43AE10:				; CODE XREF: sub_43AE00+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_43AE0D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_43AE00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43AE30	proc near		; CODE XREF: sub_43AF10+2Bp
					; .text:0043B054p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_43AE6E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_43AE54:				; CODE XREF: sub_43AE30+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_43AE62
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_43AE6E

loc_43AE62:				; CODE XREF: sub_43AE30+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_43AE54
		xor	eax, eax

loc_43AE6E:				; CODE XREF: sub_43AE30+19j
					; sub_43AE30+30j
		pop	ebx
		pop	esi
		retn
sub_43AE30	endp

; ---------------------------------------------------------------------------
		jmp	short loc_43AE80
; ---------------------------------------------------------------------------
		align 10h

loc_43AE80:				; CODE XREF: .text:0043AE71j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_43AEF3
		mov	dword ptr [esp], 400000h
		call	sub_43AE00
		test	eax, eax
		jz	short loc_43AEF3
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_43AEF3
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_43AEDB
; ---------------------------------------------------------------------------

loc_43AED1:				; CODE XREF: .text:0043AEF1j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_43AF00

loc_43AEDB:				; CODE XREF: .text:0043AECFj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_43AED1

loc_43AEF3:				; CODE XREF: .text:0043AE98j
					; .text:0043AEA8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43AF00:				; CODE XREF: .text:0043AED9j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43AF10	proc near		; CODE XREF: sub_43A910+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_43AE00
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_43AF40
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_43AE30

loc_43AF40:				; CODE XREF: sub_43AF10+15j
		add	esp, 8
		retn
sub_43AF10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43AF50	proc near		; CODE XREF: sub_43AB50+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_43AE00
		xor	edx, edx
		test	eax, eax
		jz	short loc_43AF71
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_43AF71:				; CODE XREF: sub_43AF50+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_43AF50	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_43AE00
		xor	edx, edx
		test	eax, eax
		jz	short loc_43AFD9
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_43AFD9
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_43AFC0:				; CODE XREF: .text:0043AFD5j
		test	byte ptr [edx+27h], 20h
		jz	short loc_43AFCD
		test	ebx, ebx
		jz	short loc_43AFD9
		sub	ebx, 1

loc_43AFCD:				; CODE XREF: .text:0043AFC4j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_43AFC0
		xor	edx, edx

loc_43AFD9:				; CODE XREF: .text:0043AF99j
					; .text:0043AFB5j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_43AFF0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43AFF0	proc near		; CODE XREF: sub_43A910+70p
					; .text:0043AFE1j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_43AE00
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_43AFF0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_43B020
; ---------------------------------------------------------------------------
		align 10h

loc_43B020:				; CODE XREF: .text:0043B011j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_43AE00
		test	eax, eax
		jnz	short loc_43B040

loc_43B036:				; CODE XREF: .text:0043B05Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43B040:				; CODE XREF: .text:0043B034j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_43AE30
		test	eax, eax
		jz	short loc_43B036
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B070	proc near		; CODE XREF: sub_43B100+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_43AE00
		test	eax, eax
		jz	short loc_43B0E1
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_43B0E1
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_43AE30
		test	eax, eax
		jz	short loc_43B0E1
		add	esi, 400000h
		jnz	short loc_43B0C6
		jmp	short loc_43B0E1
; ---------------------------------------------------------------------------
		align 10h

loc_43B0C0:				; CODE XREF: sub_43B070+66j
		sub	ebx, 1
		add	esi, 14h

loc_43B0C6:				; CODE XREF: sub_43B070+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_43B0D4
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_43B0F0

loc_43B0D4:				; CODE XREF: sub_43B070+5Bj
		test	ebx, ebx
		jg	short loc_43B0C0
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_43B0E1:				; CODE XREF: sub_43B070+1Aj
					; sub_43B070+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43B0F0:				; CODE XREF: sub_43B070+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_43B070	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B100	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_4499FC
		test	eax, eax
		jz	short loc_43B112

loc_43B10D:				; CODE XREF: sub_43B100+97j
					; sub_43B100+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_43B112:				; CODE XREF: sub_43B100+Bj
		xor	eax, eax

loc_43B114:				; CODE XREF: sub_43B100+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_43B070
		test	eax, eax
		jz	short loc_43B1A0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_43B130
		cmp	dl, 6Dh
		jnz	short loc_43B180

loc_43B130:				; CODE XREF: sub_43B100+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_43B13E
		cmp	dl, 73h
		jnz	short loc_43B180

loc_43B13E:				; CODE XREF: sub_43B100+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_43B14C
		cmp	dl, 76h
		jnz	short loc_43B180

loc_43B14C:				; CODE XREF: sub_43B100+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_43B15A
		cmp	dl, 63h
		jnz	short loc_43B180

loc_43B15A:				; CODE XREF: sub_43B100+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_43B168
		cmp	dl, 72h
		jnz	short loc_43B180

loc_43B168:				; CODE XREF: sub_43B100+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_43B184
		cmp	dl, 74h
		jz	short loc_43B184
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_43B184
		xchg	ax, ax

loc_43B180:				; CODE XREF: sub_43B100+2Ej
					; sub_43B100+3Cj ...
		mov	eax, ebx
		jmp	short loc_43B114
; ---------------------------------------------------------------------------

loc_43B184:				; CODE XREF: sub_43B100+6Fj
					; sub_43B100+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_4499FC, eax
		jnz	loc_43B10D
		lea	esi, [esi+0]

loc_43B1A0:				; CODE XREF: sub_43B100+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_4499FC, eax
		jmp	loc_43B10D
sub_43B100	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B1C0	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_43B1C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_43B1D0()
sub_43B1D0	proc near		; DATA XREF: sub_43B250:loc_43B222o
		sub	esp, 0Ch
		mov	eax, off_43D8A4
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_43B1F7
		xchg	ax, ax

loc_43B1E0:				; CODE XREF: sub_43B1D0+25j
		call	eax
		mov	eax, off_43D8A4
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_43D8A4, edx
		test	eax, eax
		jnz	short loc_43B1E0

loc_43B1F7:				; CODE XREF: sub_43B1D0+Cj
		add	esp, 0Ch
		retn
sub_43B1D0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_43B250

loc_43B200:				; CODE XREF: sub_43B250+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_43CC90
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_43B233

loc_43B20F:				; CODE XREF: sub_43B250-9j
		test	ebx, ebx
		jz	short loc_43B222

loc_43B213:				; CODE XREF: sub_43B250-30j
		call	ds:dword_43CC90[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_43B213

loc_43B222:				; CODE XREF: sub_43B250-3Fj
		mov	[esp+1Ch+var_1C], offset sub_43B1D0 ; _onexit_t
		call	sub_43A630
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_43B233:				; CODE XREF: sub_43B250-43j
		xor	ebx, ebx
		jmp	short loc_43B239
; ---------------------------------------------------------------------------

loc_43B237:				; CODE XREF: sub_43B250-Bj
		mov	ebx, eax

loc_43B239:				; CODE XREF: sub_43B250-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_43CC90[eax*4]
		test	edx, edx
		jnz	short loc_43B237
		jmp	short loc_43B20F
; END OF FUNCTION CHUNK	FOR sub_43B250
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B250	proc near		; CODE XREF: sub_401180+239p
					; sub_402066+Fp

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 0043B200 SIZE 00000049 BYTES

		mov	ecx, ds:dword_449A00
		test	ecx, ecx
		jz	short loc_43B260
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_43B260:				; CODE XREF: sub_43B250+8j
		mov	ds:dword_449A00, 1
		jmp	short loc_43B200
sub_43B250	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B270	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_43D8B0
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_43B2C0
		not	eax
		mov	dword_43D8B4, eax

loc_43B2A6:				; CODE XREF: sub_43B270+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43B2C0:				; CODE XREF: sub_43B270+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_43B332

loc_43B322:				; CODE XREF: sub_43B270+CCj
		mov	dword_43D8B0, ebp
		mov	dword_43D8B4, eax
		jmp	loc_43B2A6
; ---------------------------------------------------------------------------

loc_43B332:				; CODE XREF: sub_43B270+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_43B322
sub_43B270	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_449AE4, edx
		mov	ds:dword_449D00, 0C0000409h
		mov	ds:dword_449D04, 1
		mov	ds:dword_449AD8, eax
		mov	ds:dword_449D0C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_449ACC, eax
		mov	eax, dword_43D8B0
		mov	[ebp-10h], eax
		mov	eax, dword_43D8B4
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_4484A4
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B3D0	proc near		; CODE XREF: sub_43B570+79p
					; sub_43B570:loc_43B602p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_449D7C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_43B425
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_43B400:				; CODE XREF: sub_43B3D0+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_43B41E
		test	esi, esi
		jz	short loc_43B41E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_43B41E:				; CODE XREF: sub_43B3D0+40j
					; sub_43B3D0+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_43B400

loc_43B425:				; CODE XREF: sub_43B3D0+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_43B3D0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_449D60
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_43B464

loc_43B456:				; CODE XREF: .text:0043B4CCj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_43B464:				; CODE XREF: .text:0043B454j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_43B4C7
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_449D7C
		mov	ds:dword_449D7C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_43B4C7:				; CODE XREF: .text:0043B47Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_43B456
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_449D60
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_43B4E8
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_43B4E8:				; CODE XREF: .text:0043B4DFj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_449D7C
		sub	esp, 4
		test	edx, edx
		jz	short loc_43B51F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_43B518
		jmp	short loc_43B556
; ---------------------------------------------------------------------------
		align 10h

loc_43B510:				; CODE XREF: .text:0043B51Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_43B536
		mov	edx, eax

loc_43B518:				; CODE XREF: .text:0043B506j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_43B510

loc_43B51F:				; CODE XREF: .text:0043B500j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_43B52F:				; CODE XREF: .text:0043B554j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_43B536:				; CODE XREF: .text:0043B514j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_43B53C:				; CODE XREF: .text:0043B560j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_43B52F
; ---------------------------------------------------------------------------

loc_43B556:				; CODE XREF: .text:0043B508j
		mov	eax, [edx+8]
		mov	ds:dword_449D7C, eax
		mov	eax, edx
		jmp	short loc_43B53C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B570	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_43B5C0
		jb	short loc_43B590
		cmp	eax, 3
		jz	short loc_43B5E0

loc_43B583:				; CODE XREF: sub_43B570+31j
					; sub_43B570+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43B590:				; CODE XREF: sub_43B570+Cj
		mov	eax, ds:dword_449D60
		test	eax, eax
		jnz	short loc_43B602

loc_43B599:				; CODE XREF: sub_43B570+97j
		mov	eax, ds:dword_449D60
		cmp	eax, 1
		jnz	short loc_43B583
		mov	ds:dword_449D60, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_43B583
; ---------------------------------------------------------------------------
		align 10h

loc_43B5C0:				; CODE XREF: sub_43B570+Aj
		mov	eax, ds:dword_449D60
		test	eax, eax
		jz	short loc_43B5F0

loc_43B5C9:				; CODE XREF: sub_43B570+90j
		mov	ds:dword_449D60, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43B5E0:				; CODE XREF: sub_43B570+11j
		mov	eax, ds:dword_449D60
		test	eax, eax
		jz	short loc_43B583
		call	sub_43B3D0
		jmp	short loc_43B583
; ---------------------------------------------------------------------------

loc_43B5F0:				; CODE XREF: sub_43B570+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_43B5C9
; ---------------------------------------------------------------------------

loc_43B602:				; CODE XREF: sub_43B570+27j
		call	sub_43B3D0
		jmp	short loc_43B599
sub_43B570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B610	proc near		; CODE XREF: sub_401180+19p
					; sub_439854+14Ep ...

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_43B632

loc_43B61D:				; CODE XREF: sub_43B610+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_43B61D

loc_43B632:				; CODE XREF: sub_43B610+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_43B610	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B640	proc near		; CODE XREF: sub_41512E+D9p
					; sub_422675+2F2p ...

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	edx, [esp+2Ch+arg_C]
		mov	[esp+2Ch+var_C], esi
		mov	ecx, [esp+2Ch+arg_8]
		mov	esi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, [esp+2Ch+arg_4]
		test	edx, edx
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+var_24], esi
		jnz	short loc_43B6A8
		cmp	ecx, ebx
		ja	short loc_43B6D0
		test	ecx, ecx
		jnz	short loc_43B680
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_43B680:				; CODE XREF: sub_43B640+33j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, esi
		div	ecx
		mov	ecx, ebx
		mov	esi, eax

loc_43B690:				; CODE XREF: sub_43B640+6Ej
					; sub_43B640+80j ...
		mov	eax, esi
		mov	edx, ecx
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_43B6A8:				; CODE XREF: sub_43B640+2Bj
		xor	ecx, ecx
		xor	esi, esi
		cmp	edx, ebx
		ja	short loc_43B690
		bsr	ebp, edx
		xor	ebp, 1Fh
		jnz	short loc_43B6E0
		cmp	edi, [esp+2Ch+var_24]
		jbe	short loc_43B6C2
		cmp	edx, ebx
		jnb	short loc_43B690

loc_43B6C2:				; CODE XREF: sub_43B640+7Cj
		xor	ecx, ecx
		mov	esi, 1
		jmp	short loc_43B690
; ---------------------------------------------------------------------------
		align 10h

loc_43B6D0:				; CODE XREF: sub_43B640+2Fj
		mov	eax, esi
		mov	edx, ebx
		div	ecx
		xor	ecx, ecx
		mov	esi, eax
		jmp	short loc_43B690
; ---------------------------------------------------------------------------
		align 10h

loc_43B6E0:				; CODE XREF: sub_43B640+76j
		mov	eax, 20h
		mov	ecx, ebp
		sub	eax, ebp
		mov	esi, edi
		shl	edx, cl
		mov	ecx, eax
		shr	esi, cl
		mov	ecx, ebp
		or	esi, edx
		mov	edx, ebx
		mov	[esp+2Ch+var_20], esi
		mov	esi, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, eax
		shr	edx, cl
		mov	ecx, ebp
		shl	ebx, cl
		mov	ecx, eax
		shr	esi, cl
		or	esi, ebx
		mov	eax, esi
		div	[esp+2Ch+var_20]
		mov	ebx, edx
		mov	esi, eax
		mul	edi
		cmp	ebx, edx
		jb	short loc_43B72F
		mov	edi, [esp+2Ch+var_24]
		mov	ecx, ebp
		shl	edi, cl
		cmp	edi, eax
		jnb	short loc_43B732
		cmp	ebx, edx
		jnz	short loc_43B732

loc_43B72F:				; CODE XREF: sub_43B640+DDj
		sub	esi, 1

loc_43B732:				; CODE XREF: sub_43B640+E9j
					; sub_43B640+EDj
		xor	ecx, ecx
		jmp	loc_43B690
sub_43B640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B740	proc near		; CODE XREF: sub_422675+2C6p
					; sub_439494+148p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, [esp+2Ch+arg_C]
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ecx, [esp+2Ch+arg_8]
		mov	ebx, [esp+2Ch+arg_4]
		test	ebp, ebp
		mov	[esp+2Ch+var_C], esi
		mov	esi, eax
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_24], eax
		mov	edx, ebx
		jnz	short loc_43B790
		cmp	ecx, ebx
		jbe	short loc_43B7B2
		div	ecx

loc_43B777:				; CODE XREF: sub_43B740+8Bj
		mov	eax, edx
		xor	edx, edx

loc_43B77B:				; CODE XREF: sub_43B740+70j
					; sub_43B740+92j ...
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43B790:				; CODE XREF: sub_43B740+2Fj
		cmp	ebp, ebx
		ja	short loc_43B7D0
		bsr	eax, ebp
		xor	eax, 1Fh
		mov	[esp+2Ch+var_28], eax
		jnz	short loc_43B7D4
		cmp	ecx, esi
		ja	loc_43B868

loc_43B7A8:				; CODE XREF: sub_43B740+12Aj
		mov	edx, ebx
		sub	esi, ecx
		sbb	edx, ebp
		mov	eax, esi
		jmp	short loc_43B77B
; ---------------------------------------------------------------------------

loc_43B7B2:				; CODE XREF: sub_43B740+33j
		test	ecx, ecx
		jnz	short loc_43B7C1
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_43B7C1:				; CODE XREF: sub_43B740+74j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	eax, esi
		div	ecx
		jmp	short loc_43B777
; ---------------------------------------------------------------------------
		align 10h

loc_43B7D0:				; CODE XREF: sub_43B740+52j
		mov	edx, ebx
		jmp	short loc_43B77B
; ---------------------------------------------------------------------------

loc_43B7D4:				; CODE XREF: sub_43B740+5Ej
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	esi, 20h
		mov	eax, ebp
		sub	esi, [esp+2Ch+var_28]
		mov	ebp, edi
		mov	edx, ebx
		shl	eax, cl
		mov	ecx, esi
		shr	ebp, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	ebp, eax
		mov	eax, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, esi
		shr	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	[esp+2Ch+var_20], edi
		shl	ebx, cl
		mov	ecx, esi
		shr	eax, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, ebx
		mov	ebx, [esp+2Ch+var_24]
		div	ebp
		shl	ebx, cl
		mov	[esp+2Ch+var_24], ebx
		mov	ebx, edx
		mul	edi
		cmp	ebx, edx
		mov	edi, eax
		mov	ecx, edx
		jb	short loc_43B85C
		cmp	[esp+2Ch+var_24], eax
		jb	short loc_43B858

loc_43B833:				; CODE XREF: sub_43B740+11Aj
					; sub_43B740+126j
		mov	eax, [esp+2Ch+var_24]
		sub	eax, edi
		sbb	ebx, ecx
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	edx, ebx
		shr	eax, cl
		mov	ecx, esi
		shl	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, edx
		mov	edx, ebx
		shr	edx, cl
		jmp	loc_43B77B
; ---------------------------------------------------------------------------

loc_43B858:				; CODE XREF: sub_43B740+F1j
		cmp	ebx, edx
		jnz	short loc_43B833

loc_43B85C:				; CODE XREF: sub_43B740+EBj
		mov	ecx, edx
		mov	edi, eax
		sub	edi, [esp+2Ch+var_20]
		sbb	ecx, ebp
		jmp	short loc_43B833
; ---------------------------------------------------------------------------

loc_43B868:				; CODE XREF: sub_43B740+62j
		cmp	ebp, ebx
		jb	loc_43B7A8
		mov	eax, esi
		jmp	loc_43B77B
sub_43B740	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _rmdir]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _access]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strlwr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _write]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _setmode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _dup]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _putenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _tzset]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _mkdir]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_43B920
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43B920	proc near		; CODE XREF: sub_401180+A7p
					; .text:0043B911j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_43B920	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_43B940	proc near		; CODE XREF: sub_43BB20+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_43B98C
		jmp	short loc_43B994
; ---------------------------------------------------------------------------
		align 10h

loc_43B980:				; CODE XREF: sub_43B940+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_43B994

loc_43B98C:				; CODE XREF: sub_43B940+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_43B980

loc_43B994:				; CODE XREF: sub_43B940+39j
					; sub_43B940+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_43B9BC
		jmp	short loc_43B9C4
; ---------------------------------------------------------------------------
		align 10h

loc_43B9B0:				; CODE XREF: sub_43B940+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_43B9C4

loc_43B9BC:				; CODE XREF: sub_43B940+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_43B9B0

loc_43B9C4:				; CODE XREF: sub_43B940+6Aj
					; sub_43B940+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_43BA80
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_43BAAE

loc_43B9E3:				; CODE XREF: sub_43B940+168j
					; sub_43B940+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_43BAC0

loc_43BA13:				; CODE XREF: sub_43B940+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_4499E0
		test	eax, eax
		jz	loc_43BAF9
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_43BAE1
		cmp	eax, 5
		jnz	short loc_43BADC
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_43BA80:				; CODE XREF: sub_43B940+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_43B9E3

loc_43BAAE:				; CODE XREF: sub_43B940+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_43B9E3
; ---------------------------------------------------------------------------
		align 10h

loc_43BAC0:				; CODE XREF: sub_43B940+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_43BA13
; ---------------------------------------------------------------------------

loc_43BADC:				; CODE XREF: sub_43B940+133j
		call	abort
; ---------------------------------------------------------------------------

loc_43BAE1:				; CODE XREF: sub_43B940+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_43BAF9:				; CODE XREF: sub_43B940+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_4 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_43B940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_43BB20(char *, char *, int)
sub_43BB20	proc near		; CODE XREF: sub_403366+27p
					; sub_4069FA+AEp ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_43BB86
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_43BB70:				; CODE XREF: sub_43BB20+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_43BB70
		add	edx, edx

loc_43BB86:				; CODE XREF: sub_43BB20+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_43BBAD
		xor	edi, edi

loc_43BB97:				; CODE XREF: sub_43BB20+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_43BB97
		add	edx, edx

loc_43BBAD:				; CODE XREF: sub_43BB20+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_43B940
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_43BB20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_43BBF0	proc near		; CODE XREF: sub_403E87+17p
					; sub_403E87+35p ...
		jmp	sub_43C9D0
sub_43BBF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_43BC00(LPCSTR)
sub_43BC00	proc near		; CODE XREF: sub_406F3A+1C7p

lpFileName	= dword	ptr -12Ch
Path		= dword	ptr -128h
SizeInBytes	= dword	ptr -124h
FullPath	= byte ptr -110h
arg_0		= dword	ptr  4

		push	edi
		push	esi
		push	ebx
		sub	esp, 120h
		mov	ebx, [esp+12Ch+arg_0]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	loc_43BE12
		cmp	byte ptr [ebx],	0
		jz	loc_43BDD0
		mov	[esp+12Ch+lpFileName], ebx ; lpFileName
		call	ds:GetFileAttributesA
		sub	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	loc_43BDF0
		test	al, 10h
		jz	loc_43BDD0
		lea	esi, [esp+12Ch+FullPath]
		mov	[esp+12Ch+SizeInBytes],	104h ; SizeInBytes
		mov	[esp+12Ch+Path], ebx ; Path
		mov	[esp+12Ch+lpFileName], esi ; FullPath
		call	_fullpath
		mov	edx, esi

loc_43BC63:				; CODE XREF: sub_43BC00+77j
		mov	ecx, [edx]
		add	edx, 4
		lea	eax, [ecx-1010101h]
		not	ecx
		and	eax, ecx
		and	eax, 80808080h
		jz	short loc_43BC63
		mov	ecx, eax
		shr	ecx, 10h
		test	eax, 8080h
		cmovz	eax, ecx
		lea	ecx, [edx+2]
		cmovz	edx, ecx
		add	al, al
		sbb	edx, 3
		sub	edx, esi
		add	edx, 233h
		mov	[esp+12Ch+lpFileName], edx ; Size
		call	malloc
		test	eax, eax
		mov	ebx, eax
		jz	loc_43BE02
		lea	edi, [eax+22Ch]
		mov	[esp+12Ch+Path], esi ; Source
		mov	[esp+12Ch+lpFileName], edi ; Dest
		call	strcpy
		mov	eax, edi
		cmp	byte ptr [ebx+22Ch], 0
		jnz	loc_43BD55

loc_43BCCC:				; CODE XREF: sub_43BC00+E1j
		mov	ecx, [eax]
		add	eax, 4
		lea	edx, [ecx-1010101h]
		not	ecx
		and	edx, ecx
		and	edx, 80808080h
		jz	short loc_43BCCC

loc_43BCE3:				; CODE XREF: sub_43BC00+1C4j
		mov	ecx, edx
		shr	ecx, 10h
		test	edx, 8080h
		cmovz	edx, ecx
		lea	ecx, [eax+2]
		cmovz	eax, ecx
		add	dl, dl
		sbb	eax, 3
		sub	eax, edi

loc_43BCFE:				; CODE XREF: sub_43BC00+192j
					; sub_43BC00+19Bj
		lea	edx, [ebx+120h]
		mov	ecx, 41h
		mov	word ptr [ebx+eax+22Ch], 2Ah
		mov	edi, edx
		xor	eax, eax
		rep stosd
		mov	dword ptr [ebx+224h], 0FFFFFFFFh
		mov	dword ptr [ebx+228h], 0
		mov	dword ptr [ebx+118h], 0
		mov	word ptr [ebx+11Ch], 0
		mov	word ptr [ebx+11Eh], 0

loc_43BD49:				; CODE XREF: sub_43BC00+1FDj
					; sub_43BC00+20Dj ...
		add	esp, 120h
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_43BD55:				; CODE XREF: sub_43BC00+C6j
					; sub_43BC00+16Aj
		mov	ecx, [eax]
		add	eax, 4
		lea	edx, [ecx-1010101h]
		not	ecx
		and	edx, ecx
		and	edx, 80808080h
		jz	short loc_43BD55
		mov	ecx, edx
		shr	ecx, 10h
		test	edx, 8080h
		cmovz	edx, ecx
		lea	ecx, [eax+2]
		cmovz	eax, ecx
		add	dl, dl
		sbb	eax, 3
		sub	eax, edi
		movzx	edx, byte ptr [ebx+eax+22Bh]
		cmp	dl, 2Fh
		jz	loc_43BCFE
		cmp	dl, 5Ch
		jz	loc_43BCFE
		mov	word ptr [ebx+eax+22Ch], 5Ch
		mov	eax, edi

loc_43BDAD:				; CODE XREF: sub_43BC00+1C2j
		mov	ecx, [eax]
		add	eax, 4
		lea	edx, [ecx-1010101h]
		not	ecx
		and	edx, ecx
		and	edx, 80808080h
		jz	short loc_43BDAD
		jmp	loc_43BCE3
; ---------------------------------------------------------------------------
		align 10h

loc_43BDD0:				; CODE XREF: sub_43BC00+26j
					; sub_43BC00+43j
		call	_errno
		xor	ebx, ebx
		mov	dword ptr [eax], 14h
		add	esp, 120h
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43BDF0:				; CODE XREF: sub_43BC00+3Bj
		call	_errno
		xor	ebx, ebx
		mov	dword ptr [eax], 2
		jmp	loc_43BD49
; ---------------------------------------------------------------------------

loc_43BE02:				; CODE XREF: sub_43BC00+A5j
		call	_errno
		mov	dword ptr [eax], 0Ch
		jmp	loc_43BD49
; ---------------------------------------------------------------------------

loc_43BE12:				; CODE XREF: sub_43BC00+1Dj
		call	_errno
		mov	dword ptr [eax], 0Eh
		jmp	loc_43BD49
sub_43BC00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43BE30	proc near		; CODE XREF: sub_406F3A+368p
					; .text:0043C075p

Str		= dword	ptr -1Ch
Source		= dword	ptr -18h
arg_0		= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, [esp+1Ch+arg_0]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	loc_43BF3D
		xor	esi, esi
		cmp	dword ptr [ebx+228h], 0
		jl	short loc_43BEAC
		mov	[esp+1Ch+Source], ebx
		jz	short loc_43BEB4
		mov	eax, [ebx+224h]
		mov	[esp+1Ch+Str], eax
		call	_findnext
		test	eax, eax
		jnz	short loc_43BEE0
		mov	eax, [ebx+228h]
		add	eax, 1
		test	eax, eax
		mov	[ebx+228h], eax
		jle	short loc_43BEAC

loc_43BE82:				; CODE XREF: sub_43BE30+A7j
		lea	esi, [ebx+14h]
		mov	[esp+1Ch+Str], esi ; Str
		call	strlen
		mov	[ebx+11Eh], ax
		lea	eax, [ebx+120h]
		mov	[esp+1Ch+Source], esi ;	Source
		lea	esi, [ebx+118h]
		mov	[esp+1Ch+Str], eax ; Dest
		call	strcpy

loc_43BEAC:				; CODE XREF: sub_43BE30+25j
					; sub_43BE30+50j ...
		add	esp, 14h
		mov	eax, esi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_43BEB4:				; CODE XREF: sub_43BE30+2Bj
		lea	eax, [ebx+22Ch]
		mov	[esp+1Ch+Str], eax
		call	_findfirst
		cmp	eax, 0FFFFFFFFh
		mov	[ebx+224h], eax
		jz	short loc_43BF17
		mov	dword ptr [ebx+228h], 1
		jmp	short loc_43BE82
; ---------------------------------------------------------------------------
		align 10h

loc_43BEE0:				; CODE XREF: sub_43BE30+3Dj
		call	ds:GetLastError
		cmp	eax, 12h
		jz	short loc_43BF30

loc_43BEEB:				; CODE XREF: sub_43BE30+10Bj
		mov	eax, [ebx+224h]
		xor	esi, esi
		mov	[esp+1Ch+Str], eax
		call	_findclose
		mov	eax, esi
		mov	dword ptr [ebx+224h], 0FFFFFFFFh
		mov	dword ptr [ebx+228h], 0FFFFFFFFh
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_43BF17:				; CODE XREF: sub_43BE30+9Bj
		mov	dword ptr [ebx+228h], 0FFFFFFFFh
		add	esp, 14h
		mov	eax, esi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43BF30:				; CODE XREF: sub_43BE30+B9j
		call	_errno
		mov	dword ptr [eax], 0
		jmp	short loc_43BEEB
; ---------------------------------------------------------------------------

loc_43BF3D:				; CODE XREF: sub_43BE30+16j
		call	_errno
		xor	esi, esi
		mov	dword ptr [eax], 0Eh
		jmp	loc_43BEAC
sub_43BE30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_43BF50(void *)
sub_43BF50	proc near		; CODE XREF: sub_406F3A+480p

Memory		= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	[esp+1Ch+var_8], ebx
		mov	ebx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_4], esi
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	short loc_43BF9B
		mov	eax, [ebx+224h]
		xor	esi, esi
		cmp	eax, 0FFFFFFFFh
		jz	short loc_43BF85
		mov	[esp+1Ch+Memory], eax
		call	_findclose
		mov	esi, eax

loc_43BF85:				; CODE XREF: sub_43BF50+29j
		mov	[esp+1Ch+Memory], ebx ;	Memory
		call	free

loc_43BF8D:				; CODE XREF: sub_43BF50+5Bj
		mov	eax, esi
		mov	ebx, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_43BF9B:				; CODE XREF: sub_43BF50+1Cj
		call	_errno
		mov	esi, 0FFFFFFFFh
		mov	dword ptr [eax], 0Eh
		jmp	short loc_43BF8D
sub_43BF50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43BFB0	proc near		; CODE XREF: .text:0043C066p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 18h
		mov	ebx, [esp+1Ch+arg_0]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	short loc_43BFF3
		mov	eax, [ebx+224h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_43BFDA
		mov	[esp+1Ch+var_1C], eax
		call	_findclose

loc_43BFDA:				; CODE XREF: sub_43BFB0+20j
		mov	dword ptr [ebx+224h], 0FFFFFFFFh
		mov	dword ptr [ebx+228h], 0

loc_43BFEE:				; CODE XREF: sub_43BFB0+4Ej
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_43BFF3:				; CODE XREF: sub_43BFB0+15j
		call	_errno
		mov	dword ptr [eax], 0Eh
		jmp	short loc_43BFEE
sub_43BFB0	endp

; ---------------------------------------------------------------------------
		push	ebx
		sub	esp, 8
		mov	ebx, [esp+10h]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	short loc_43C022
		mov	eax, [ebx+228h]

loc_43C01D:				; CODE XREF: .text:0043C032j
		add	esp, 8
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_43C022:				; CODE XREF: .text:0043C015j
		call	_errno
		mov	dword ptr [eax], 0Eh
		mov	eax, 0FFFFFFFFh
		jmp	short loc_43C01D
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, [esp+20h]
		mov	esi, [esp+24h]
		call	_errno
		test	ebx, ebx
		mov	dword ptr [eax], 0
		jz	short loc_43C0CD
		cmp	esi, 0FFFFFFFFh
		jl	short loc_43C0C0
		jz	short loc_43C090
		mov	[esp], ebx
		call	sub_43BFB0
		nop
		lea	esi, [esi+0]
		jmp	short loc_43C07E
; ---------------------------------------------------------------------------

loc_43C072:				; CODE XREF: .text:0043C084j
		mov	[esp], ebx
		call	sub_43BE30
		test	eax, eax
		jz	short loc_43C0B7

loc_43C07E:				; CODE XREF: .text:0043C070j
		cmp	esi, [ebx+228h]
		jg	short loc_43C072
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43C090:				; CODE XREF: .text:0043C061j
		mov	eax, [ebx+224h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_43C0A3
		mov	[esp], eax
		call	_findclose

loc_43C0A3:				; CODE XREF: .text:0043C099j
		mov	dword ptr [ebx+224h], 0FFFFFFFFh
		mov	dword ptr [ebx+228h], 0FFFFFFFFh

loc_43C0B7:				; CODE XREF: .text:0043C07Cj
					; .text:0043C0CBj ...
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43C0C0:				; CODE XREF: .text:0043C05Fj
		call	_errno
		mov	dword ptr [eax], 16h
		jmp	short loc_43C0B7
; ---------------------------------------------------------------------------

loc_43C0CD:				; CODE XREF: .text:0043C05Aj
		call	_errno
		mov	dword ptr [eax], 0Eh
		jmp	short loc_43C0B7
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_43C0E0	proc near		; CODE XREF: sub_40A173+8Ep
					; .text:00420E8Fp ...
		jmp	sub_43C9E0
sub_43C0E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_43C0F0	proc near		; CODE XREF: sub_420520+26p
					; .text:00420B16p ...
		jmp	sub_43C9F0
sub_43C0F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_43C100	proc near		; CODE XREF: .text:00420810p
					; sub_4393C2+2Dp
		jmp	sub_43CA00
sub_43C100	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000005 BYTES: COLLAPSED FUNCTION j__lseeki64]
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_43C120(FILE *)
sub_43C120	proc near		; CODE XREF: .text:0043C62Bp

File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	[esp+2Ch+var_C], ebx
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_8], esi
		mov	[esp+2Ch+var_4], edi
		mov	eax, [ebx+0Ch]
		mov	edx, eax
		and	edx, 3
		cmp	edx, 2
		jz	short loc_43C160

loc_43C140:				; CODE XREF: sub_43C120+94j
					; sub_43C120+9Cj
		mov	edi, [ebx+8]
		xor	eax, eax

loc_43C145:				; CODE XREF: sub_43C120+A7j
					; sub_43C120+BCj
		mov	[ebx], edi
		mov	esi, [esp+2Ch+var_8]
		mov	dword ptr [ebx+4], 0
		mov	edi, [esp+2Ch+var_4]
		mov	ebx, [esp+2Ch+var_C]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43C160:				; CODE XREF: sub_43C120+1Ej
		test	eax, 108h
		mov	edi, [ebx+8]
		jz	short loc_43C1C5
		mov	esi, [ebx]
		sub	esi, edi
		mov	eax, esi
		sar	eax, 1Fh
		mov	[esp+2Ch+var_10], eax
		cmp	[esp+2Ch+var_10], 0
		mov	[esp+2Ch+var_14], esi
		jl	short loc_43C1C5
		jle	short loc_43C1C0

loc_43C184:				; CODE XREF: sub_43C120+A3j
		mov	[esp+2Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+2Ch+var_24], esi
		mov	[esp+2Ch+var_28], edi
		mov	[esp+2Ch+File],	eax
		call	_write_0
		mov	ecx, eax
		mov	edx, eax
		mov	eax, [esp+2Ch+var_10]
		sar	edx, 1Fh
		xor	esi, ecx
		xor	eax, edx
		or	eax, esi
		jnz	short loc_43C1D0
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jz	short loc_43C140
		and	eax, 0FFFFFFFDh
		mov	[ebx+0Ch], eax
		jmp	short loc_43C140
; ---------------------------------------------------------------------------
		align 10h

loc_43C1C0:				; CODE XREF: sub_43C120+62j
		cmp	esi, 0
		ja	short loc_43C184

loc_43C1C5:				; CODE XREF: sub_43C120+48j
					; sub_43C120+60j
		xor	eax, eax
		jmp	loc_43C145
; ---------------------------------------------------------------------------
		align 10h

loc_43C1D0:				; CODE XREF: sub_43C120+8Dj
		or	dword ptr [ebx+0Ch], 20h
		mov	eax, 0FFFFFFFFh
		mov	edi, [ebx+8]
		jmp	loc_43C145
sub_43C120	endp

; ---------------------------------------------------------------------------
		jmp	short sub_43C1F0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_43C1F0(FILE *, int, int, int)
sub_43C1F0	proc near		; CODE XREF: .text:00430F3Ep
					; .text:0043C1E1j

File		= dword	ptr -3Ch
Pos		= dword	ptr -38h
var_24		= qword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 3Ch
		mov	eax, [esp+3Ch+arg_C]
		mov	[esp+3Ch+var_C], esi
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+var_8], edi
		mov	edi, [esp+3Ch+arg_8]
		mov	[esp+3Ch+var_4], ebp
		mov	ebp, [esp+3Ch+arg_0]
		cmp	eax, 1
		mov	[esp+3Ch+var_10], ebx
		jz	short loc_43C250
		cmp	eax, 2
		jz	short loc_43C275
		test	eax, eax
		jnz	short loc_43C2A0
		mov	dword ptr [esp+3Ch+var_24], esi
		lea	ebx, [esp+3Ch+var_24]
		mov	dword ptr [esp+3Ch+var_24+4], edi

loc_43C22D:				; CODE XREF: sub_43C1F0+83j
					; sub_43C1F0+ADj
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fsetpos

loc_43C239:				; CODE XREF: sub_43C1F0+79j
					; sub_43C1F0+C0j
		mov	ebx, [esp+3Ch+var_10]
		mov	esi, [esp+3Ch+var_C]
		mov	edi, [esp+3Ch+var_8]
		mov	ebp, [esp+3Ch+var_4]
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43C250:				; CODE XREF: sub_43C1F0+26j
		lea	ebx, [esp+3Ch+var_24]
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fgetpos
		mov	edx, eax
		mov	eax, 0FFFFFFFFh
		test	edx, edx
		jnz	short loc_43C239
		add	dword ptr [esp+3Ch+var_24], esi
		adc	dword ptr [esp+3Ch+var_24+4], edi
		jmp	short loc_43C22D
; ---------------------------------------------------------------------------

loc_43C275:				; CODE XREF: sub_43C1F0+2Bj
		mov	[esp+3Ch+File],	ebp ; File
		lea	ebx, [esp+3Ch+var_24]
		call	fflush
		mov	[esp+3Ch+File],	ebp ; File
		call	_fileno_0
		mov	[esp+3Ch+File],	eax
		call	_filelengthi64
		add	eax, esi
		adc	edx, edi
		mov	dword ptr [esp+3Ch+var_24], eax
		mov	dword ptr [esp+3Ch+var_24+4], edx
		jmp	short loc_43C22D
; ---------------------------------------------------------------------------
		align 10h

loc_43C2A0:				; CODE XREF: sub_43C1F0+2Fj
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_43C239
sub_43C1F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_43C2C0(FILE *)
sub_43C2C0	proc near		; CODE XREF: .text:0043C694p

File		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 5Ch
		mov	[esp+5Ch+var_10], ebx
		mov	ebx, [esp+5Ch+arg_0]
		mov	[esp+5Ch+var_C], esi
		mov	[esp+5Ch+var_8], edi
		mov	[esp+5Ch+var_4], ebp
		call	_errno
		mov	dword ptr [eax], 0
		mov	[esp+5Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+5Ch+var_3C], eax
		mov	eax, [ebx+4]
		test	eax, eax
		js	loc_43C480

loc_43C2F9:				; CODE XREF: sub_43C2C0+1C7j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_50], 1
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		test	edx, edx
		mov	esi, eax
		mov	edi, edx
		js	loc_43C4A4
		mov	ecx, [ebx+0Ch]
		test	ecx, 108h
		jz	loc_43C454
		mov	eax, [ebx]
		mov	[esp+5Ch+var_34], eax
		mov	eax, [ebx+8]
		mov	edx, [esp+5Ch+var_34]
		sub	edx, eax
		test	cl, 3
		mov	[esp+5Ch+var_28], edx
		jnz	loc_43C3E5
		test	cl, 80h
		jz	loc_43C5A0
		mov	ebp, [esp+5Ch+var_28]

loc_43C361:				; CODE XREF: sub_43C2C0+156j
					; sub_43C2C0+160j ...
		mov	eax, edi
		or	eax, esi
		jz	loc_43C490
		and	ecx, 1
		jz	loc_43C496
		mov	eax, [ebx+4]
		xor	edx, edx
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], 0
		mov	[esp+5Ch+var_30], 0
		test	eax, eax
		jz	short loc_43C3D8
		mov	ecx, [esp+5Ch+var_28]
		mov	edx, [esp+5Ch+var_3C]
		add	ecx, eax
		mov	eax, [esp+5Ch+var_3C]
		sar	edx, 5
		mov	[esp+5Ch+var_28], edx
		and	eax, 1Fh
		lea	eax, [eax+eax*4]
		shl	eax, 3
		mov	[esp+5Ch+var_34], eax
		mov	eax, ds:__pioinfo
		mov	eax, [eax+edx*4]
		mov	edx, [esp+5Ch+var_34]
		cmp	byte ptr [eax+edx+4], 0
		js	loc_43C4B0

loc_43C3C8:				; CODE XREF: sub_43C2C0+255j
		mov	[esp+5Ch+var_34], ecx
		mov	edx, ebp
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0

loc_43C3D8:				; CODE XREF: sub_43C2C0+CDj
					; sub_43C2C0+26Ej ...
		sub	esi, [esp+5Ch+var_34]
		sbb	edi, [esp+5Ch+var_30]
		jmp	loc_43C49A
; ---------------------------------------------------------------------------

loc_43C3E5:				; CODE XREF: sub_43C2C0+8Ej
		mov	edx, [esp+5Ch+var_3C]
		mov	ebp, [esp+5Ch+var_3C]
		and	edx, 1Fh
		lea	edx, [edx+edx*4]
		shl	edx, 3
		mov	[esp+5Ch+var_24], edx
		mov	edx, ds:__pioinfo
		sar	ebp, 5
		mov	edx, [edx+ebp*4]
		add	[esp+5Ch+var_24], edx
		mov	edx, [esp+5Ch+var_24]
		mov	ebp, [esp+5Ch+var_28]
		cmp	byte ptr [edx+4], 0
		jns	loc_43C361
		cmp	[esp+5Ch+var_34], eax
		jbe	loc_43C361
		mov	[esp+5Ch+var_24], esi
		mov	esi, ecx
		mov	ecx, [esp+5Ch+var_34]
		mov	[esp+5Ch+var_20], edi

loc_43C434:				; CODE XREF: sub_43C2C0+183j
		xor	edx, edx
		cmp	byte ptr [eax],	0Ah
		setz	dl
		add	eax, 1
		add	ebp, edx
		cmp	eax, ecx
		jnz	short loc_43C434
		mov	ecx, esi
		mov	edi, [esp+5Ch+var_20]
		mov	esi, [esp+5Ch+var_24]
		jmp	loc_43C361
; ---------------------------------------------------------------------------

loc_43C454:				; CODE XREF: sub_43C2C0+72j
		mov	eax, [ebx+4]
		mov	ecx, esi
		mov	ebx, edi
		mov	edx, eax
		sar	edx, 1Fh
		sub	ecx, eax
		sbb	ebx, edx
		mov	eax, ecx
		mov	edx, ebx

loc_43C468:				; CODE XREF: sub_43C2C0+1D4j
					; sub_43C2C0+1E2j ...
		mov	ebx, [esp+5Ch+var_10]
		mov	esi, [esp+5Ch+var_C]
		mov	edi, [esp+5Ch+var_8]
		mov	ebp, [esp+5Ch+var_4]
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43C480:				; CODE XREF: sub_43C2C0+33j
		mov	dword ptr [ebx+4], 0
		jmp	loc_43C2F9
; ---------------------------------------------------------------------------
		align 10h

loc_43C490:				; CODE XREF: sub_43C2C0+A5j
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_43C468
; ---------------------------------------------------------------------------

loc_43C496:				; CODE XREF: sub_43C2C0+AEj
		mov	edx, ebp
		xor	ecx, ecx

loc_43C49A:				; CODE XREF: sub_43C2C0+120j
		mov	eax, edx
		mov	edx, ecx
		add	eax, esi
		adc	edx, edi
		jmp	short loc_43C468
; ---------------------------------------------------------------------------

loc_43C4A4:				; CODE XREF: sub_43C2C0+63j
		mov	eax, 0FFFFFFFFh
		mov	edx, 0FFFFFFFFh
		jmp	short loc_43C468
; ---------------------------------------------------------------------------

loc_43C4B0:				; CODE XREF: sub_43C2C0+102j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 2
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		xor	edx, edi
		xor	eax, esi
		or	edx, eax
		jnz	short loc_43C533
		mov	edx, [ebx+8]
		lea	eax, [edx+ecx]
		cmp	edx, eax
		jnb	short loc_43C511
		mov	[esp+5Ch+var_3C], esi
		mov	esi, eax
		mov	[esp+5Ch+var_38], edi

loc_43C4F8:				; CODE XREF: sub_43C2C0+247j
		xor	eax, eax
		cmp	byte ptr [edx],	0Ah
		setz	al
		add	edx, 1
		add	ecx, eax
		cmp	edx, esi
		jnz	short loc_43C4F8
		mov	esi, [esp+5Ch+var_3C]
		mov	edi, [esp+5Ch+var_38]

loc_43C511:				; CODE XREF: sub_43C2C0+22Cj
		test	byte ptr [ebx+0Dh], 20h
		jz	loc_43C3C8
		lea	eax, [ecx+1]
		mov	edx, ebp
		mov	[esp+5Ch+var_34], eax
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0
		jmp	loc_43C3D8
; ---------------------------------------------------------------------------

loc_43C533:				; CODE XREF: sub_43C2C0+222j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 0
		mov	[esp+5Ch+var_58], esi
		mov	[esp+5Ch+var_54], edi
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		cmp	ecx, 200h
		ja	short loc_43C571
		mov	eax, [ebx+0Ch]
		mov	edx, 200h
		and	eax, 408h
		cmp	eax, 8
		jz	short loc_43C574

loc_43C571:				; CODE XREF: sub_43C2C0+29Dj
		mov	edx, [ebx+18h]

loc_43C574:				; CODE XREF: sub_43C2C0+2AFj
		mov	eax, ds:__pioinfo
		mov	ecx, [esp+5Ch+var_28]
		mov	ebx, [esp+5Ch+var_34]
		mov	eax, [eax+ecx*4]
		test	byte ptr [eax+ebx+4], 4
		jnz	short loc_43C5BA
		mov	[esp+5Ch+var_34], edx
		xor	ecx, ecx
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_43C3D8
; ---------------------------------------------------------------------------

loc_43C5A0:				; CODE XREF: sub_43C2C0+97j
		call	_errno
		mov	edx, 0FFFFFFFFh
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_43C468
; ---------------------------------------------------------------------------

loc_43C5BA:				; CODE XREF: sub_43C2C0+2C9j
		lea	eax, [edx+1]
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], eax
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_43C3D8
sub_43C2C0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 2Ch
		mov	[esp+1Ch], ebx
		mov	ebx, [esp+30h]
		mov	[esp+20h], esi
		mov	esi, [esp+3Ch]
		mov	[esp+24h], edi
		mov	edi, [esp+34h]
		mov	[esp+28h], ebp
		mov	ebp, [esp+38h]
		call	_errno
		cmp	esi, 2
		mov	dword ptr [eax], 0
		ja	loc_43C6A5
		test	ebx, ebx
		jz	loc_43C6A5
		and	dword ptr [ebx+0Ch], 0FFFFFFEFh
		cmp	esi, 1
		jz	short loc_43C691

loc_43C628:				; CODE XREF: .text:0043C6A0j
		mov	[esp], ebx
		call	sub_43C120
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jnz	short loc_43C680
		and	eax, 409h
		cmp	eax, 9
		jz	short loc_43C688

loc_43C641:				; CODE XREF: .text:0043C686j
					; .text:0043C68Fj
		mov	[esp], ebx
		call	_fileno_0
		mov	[esp+0Ch], esi
		mov	[esp+4], edi
		mov	[esp+8], ebp
		mov	[esp], eax
		call	_lseeki64
		and	eax, edx
		not	eax
		cmp	eax, 1
		sbb	eax, eax

loc_43C666:				; CODE XREF: .text:0043C6B5j
		mov	ebx, [esp+1Ch]
		mov	esi, [esp+20h]
		mov	edi, [esp+24h]
		mov	ebp, [esp+28h]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43C680:				; CODE XREF: .text:0043C635j
		and	eax, 0FFFFFFFCh
		mov	[ebx+0Ch], eax
		jmp	short loc_43C641
; ---------------------------------------------------------------------------

loc_43C688:				; CODE XREF: .text:0043C63Fj
		mov	dword ptr [ebx+18h], 200h
		jmp	short loc_43C641
; ---------------------------------------------------------------------------

loc_43C691:				; CODE XREF: .text:0043C626j
		mov	[esp], ebx
		call	sub_43C2C0
		add	edi, eax
		adc	ebp, edx
		xor	si, si
		jmp	loc_43C628
; ---------------------------------------------------------------------------

loc_43C6A5:				; CODE XREF: .text:0043C611j
					; .text:0043C619j
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_43C666
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 4
		mov	esi, [esp+10h]
		call	__doserrno
		mov	[eax], esi
		jmp	short loc_43C6E1
; ---------------------------------------------------------------------------

loc_43C6D4:				; CODE XREF: .text:0043C6E8j
		add	ebx, 1
		cmp	ds:dword_448524[ebx*8],	0FFFFFFFFh
		jz	short loc_43C700

loc_43C6E1:				; CODE XREF: .text:0043C6D2j
		cmp	ds:dword_448520[ebx*8],	esi
		jnz	short loc_43C6D4
		call	_errno
		mov	edx, ds:dword_448524[ebx*8]
		mov	[eax], edx
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_43C700:				; CODE XREF: .text:0043C6DFj
		lea	eax, [esi-13h]
		cmp	eax, 11h
		jbe	short loc_43C735
		sub	esi, 0BCh
		cmp	esi, 0Eh
		jbe	short loc_43C724
		call	_errno
		mov	dword ptr [eax], 16h
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_43C724:				; CODE XREF: .text:0043C711j
		call	_errno
		mov	dword ptr [eax], 8
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_43C735:				; CODE XREF: .text:0043C706j
		call	_errno
		mov	dword ptr [eax], 0Dh
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43C750	proc near		; CODE XREF: sub_43C850+17p
					; .text:0043C8B7p

lpTimeZoneInformation= dword ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
TimeZoneInformation= _TIME_ZONE_INFORMATION ptr	-0C0h
SystemTimeAsFileTime= _FILETIME	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0DCh
		mov	[esp+0DCh+var_8], esi
		mov	esi, [esp+0DCh+arg_4]
		mov	[esp+0DCh+var_C], ebx
		mov	ebx, [esp+0DCh+arg_0]
		mov	[esp+0DCh+var_4], edi
		test	esi, esi
		jz	short loc_43C7A8
		lea	eax, [esp+0DCh+TimeZoneInformation]
		mov	[esp+0DCh+lpTimeZoneInformation], eax ;	lpTimeZoneInformation
		call	ds:GetTimeZoneInformation
		sub	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	loc_43C837
		mov	edx, [esp+0DCh+TimeZoneInformation.Bias]
		cmp	eax, 2
		setz	al
		movzx	eax, al
		mov	[esi+4], eax
		mov	[esi], edx

loc_43C7A8:				; CODE XREF: sub_43C750+2Bj
					; sub_43C750+F4j
		test	ebx, ebx
		jz	short loc_43C819
		lea	eax, [esp+0DCh+SystemTimeAsFileTime]
		mov	[esp+0DCh+lpTimeZoneInformation], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	esi, [esp+0DCh+SystemTimeAsFileTime.dwLowDateTime]
		mov	edi, [esp+0DCh+SystemTimeAsFileTime.dwHighDateTime]
		mov	[esp+0DCh+var_D4], 989680h
		mov	[esp+0DCh+var_D0], 0
		add	esi, 2AC18000h
		adc	edi, 0FE624E21h
		mov	[esp+0DCh+lpTimeZoneInformation], esi
		mov	[esp+0DCh+var_D8], edi
		call	sub_43B640
		mov	[ebx], eax
		mov	[esp+0DCh+var_D4], 989680h
		mov	[esp+0DCh+var_D0], 0
		mov	[esp+0DCh+lpTimeZoneInformation], esi
		mov	[esp+0DCh+var_D8], edi
		call	sub_43B740
		imul	eax, 64h
		mov	[ebx+4], eax

loc_43C819:				; CODE XREF: sub_43C750+5Aj
		xor	eax, eax
		mov	ebx, [esp+0DCh+var_C]
		mov	esi, [esp+0DCh+var_8]
		mov	edi, [esp+0DCh+var_4]
		add	esp, 0DCh
		retn
; ---------------------------------------------------------------------------

loc_43C837:				; CODE XREF: sub_43C750+40j
		mov	dword ptr [esi], 0
		mov	dword ptr [esi+4], 0
		jmp	loc_43C7A8
sub_43C750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43C850	proc near		; CODE XREF: sub_439494+AAp

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		sub	esp, 28h
		mov	eax, [esp+2Ch+arg_4]
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_28], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_2C], eax
		call	sub_43C750
		mov	edx, 0FFFFFFFFh
		test	eax, eax
		jnz	short loc_43C895
		mov	eax, [esp+2Ch+var_14]
		mov	edx, 10624DD3h
		mov	ecx, [esp+2Ch+var_10]
		mov	[ebx], eax
		mov	eax, ecx
		imul	edx
		sar	ecx, 1Fh
		sar	edx, 6
		sub	edx, ecx
		mov	[ebx+4], edx
		xor	edx, edx

loc_43C895:				; CODE XREF: sub_43C850+23j
		add	esp, 28h
		mov	eax, edx
		pop	ebx
		retn
sub_43C850	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 28h
		mov	eax, [esp+34h]
		mov	ebx, [esp+30h]
		mov	[esp+4], eax
		lea	eax, [esp+18h]
		mov	[esp], eax
		call	sub_43C750
		mov	edx, 0FFFFFFFFh
		test	eax, eax
		jnz	short loc_43C8E5
		mov	eax, [esp+18h]
		mov	edx, 10624DD3h
		mov	ecx, [esp+1Ch]
		mov	[ebx], eax
		mov	eax, ecx
		imul	edx
		sar	ecx, 1Fh
		sar	edx, 6
		sub	edx, ecx
		mov	[ebx+4], edx
		xor	edx, edx

loc_43C8E5:				; CODE XREF: .text:0043C8C3j
		add	esp, 28h
		mov	eax, edx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43C8F0	proc near		; CODE XREF: sub_439854+1FFp
					; sub_439854+42Fp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, [esp+1Ch+arg_4]
		mov	esi, [esp+1Ch+arg_0]
		mov	edi, [esp+1Ch+arg_8]
		test	ebx, ebx
		jz	short loc_43C93E

loc_43C906:				; CODE XREF: sub_43C8F0+43j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_43C929

loc_43C90C:				; CODE XREF: sub_43C8F0+37j
		mov	eax, [eax]
		mov	[esp+1Ch+var_1C], esi
		mov	[esp+1Ch+var_18], eax
		call	edi
		cmp	eax, 0
		jz	short loc_43C935
		mov	ebx, [ebx]
		jl	short loc_43C930
		add	ebx, 8
		mov	eax, [ebx]
		test	eax, eax
		jnz	short loc_43C90C

loc_43C929:				; CODE XREF: sub_43C8F0+1Aj
					; sub_43C8F0+50j
		add	esp, 10h
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_43C930:				; CODE XREF: sub_43C8F0+2Ej
		add	ebx, 4
		jmp	short loc_43C906
; ---------------------------------------------------------------------------

loc_43C935:				; CODE XREF: sub_43C8F0+2Aj
		mov	eax, [ebx]
		add	esp, 10h
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_43C93E:				; CODE XREF: sub_43C8F0+14j
		xor	eax, eax
		jmp	short loc_43C929
sub_43C8F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43C950	proc near		; CODE XREF: sub_439854+2CBp
					; sub_439854+4C4p

Size		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, [esp+1Ch+arg_4]
		mov	esi, [esp+1Ch+arg_0]
		mov	edi, [esp+1Ch+arg_8]
		test	ebx, ebx
		jz	short loc_43C9C0

loc_43C966:				; CODE XREF: sub_43C950+65j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_43C989

loc_43C96C:				; CODE XREF: sub_43C950+37j
		mov	eax, [eax]
		mov	[esp+1Ch+Size],	esi
		mov	[esp+1Ch+var_18], eax
		call	edi
		cmp	eax, 0
		jz	short loc_43C9B7
		mov	ebx, [ebx]
		jl	short loc_43C9B2
		add	ebx, 8
		mov	eax, [ebx]
		test	eax, eax
		jnz	short loc_43C96C

loc_43C989:				; CODE XREF: sub_43C950+1Aj
		mov	[esp+1Ch+Size],	0Ch ; Size
		call	malloc
		test	eax, eax
		jz	short loc_43C9AB
		mov	[ebx], eax
		mov	[eax], esi
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+4], 0

loc_43C9AB:				; CODE XREF: sub_43C950+47j
					; sub_43C950+72j
		add	esp, 10h
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_43C9B2:				; CODE XREF: sub_43C950+2Ej
		add	ebx, 4
		jmp	short loc_43C966
; ---------------------------------------------------------------------------

loc_43C9B7:				; CODE XREF: sub_43C950+2Aj
		mov	eax, [ebx]
		add	esp, 10h
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_43C9C0:				; CODE XREF: sub_43C950+14j
		xor	eax, eax
		jmp	short loc_43C9AB
sub_43C950	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43C9D0	proc near		; CODE XREF: sub_43BBF0j
		mov	eax, ds:time
		jmp	eax
sub_43C9D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43C9E0	proc near		; CODE XREF: sub_43C0E0j
		mov	eax, ds:localtime
		jmp	eax
sub_43C9E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43C9F0	proc near		; CODE XREF: sub_43C0F0j
		mov	eax, ds:gmtime
		jmp	eax
sub_43C9F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_43CA00	proc near		; CODE XREF: sub_43C100j
		mov	eax, ds:mktime
		jmp	eax
sub_43CA00	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _errno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION remove]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strspn]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fseek]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION clearerr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fgets]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION feof]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcspn]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION rewind]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memmove]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strftime]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ftell]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fullpath]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _findnext]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _findfirst]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _findclose]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lseeki64]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fileno_0]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _write_0]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fsetpos]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fgetpos]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _filelengthi64]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __doserrno]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43CC70	proc near		; DATA XREF: .text:0043CC94o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_43A630
		leave
		retn
sub_43CC70	endp

; ---------------------------------------------------------------------------
		align 10h
dword_43CC90	dd 0FFFFFFFFh		; DATA XREF: sub_43B250-4Cr
					; sub_43B250:loc_43B213r ...
		dd offset sub_43CC70
		dd 0
		dd 0FFFFFFFFh
dword_43CCA0	dd 58h dup(0)		; DATA XREF: .data:off_43D8A4o
		dd 80h dup(?)
_text		ends

; Section 2. (virtual address 0003D000)
; Virtual size			: 000008BC (   2236.)
; Section size in file		: 00000A00 (   2560.)
; Offset to raw	data for section: 0003C200
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 43D000h
dword_43D000	dd 1F5h, 43E044h, 100h,	43E051h, 1F6h, 43E053h,	100h, 43E051h
					; DATA XREF: sub_402066:loc_4024D4o
					; sub_402066:loc_402AFCo ...
		dd 1F7h, 43E060h, 100h,	43E051h, 12Dh, 2 dup(0)
		dd offset a@options	; "@Options:\n "
		dd 204h, 43E082h, 0
		dd offset aRunInDaemonMod ; "run in daemon mode	(background)"
		dd 203h, 43E0ACh, 0
		dd offset aRunInServerMod ; "run in server mode	(foreground)"
		dd 76h,	43E0D4h, 0
		dd offset aVerbose	; "verbose"
		dd 71h,	43E0DCh, 0
		dd offset aBeSomewhatMore ; "be	somewhat more quiet"
		dd 73h,	43E0F9h, 0
		dd offset aShStyleCommand ; "sh-style command output"
		dd 63h,	43E114h, 0
		dd offset aCshStyleComman ; "csh-style command output"
		dd 1F8h, 43E131h, 2, 43E139h, 1F9h, 43E156h, 14h, 43E051h
		dd 1FAh, 43E15Ch, 0
		dd offset a@		; "@"
		dd 1FBh, 43E166h, 2, 43E051h, 1FCh, 43E172h, 1,	43E051h
		dd 200h, 43E17Dh, 0
		dd offset aDoNotDetachFro ; "do	not detach from	the console"
		dd 201h, 43E1A7h, 0
		dd offset aDoNotGrabKeybo ; "do	not grab keyboard and mouse"
		dd 202h, 43E1CFh, 2, 43E1D8h, 219h, 43E1F6h, 0
		dd offset aUseAStandardLo ; "use a standard location for the socket"
		dd 21Ah, 43E233h, 0
		dd offset a@		; "@"
		dd 206h, 43E24Ah, 2, 43E25Ch, 207h, 43E282h, 2,	43E051h
		dd 20Eh, 43E296h, 2, 43E2A8h, 225h, 43E2CDh, 0
		dd offset aDoNotUseTheScd ; "do	not use	the SCdaemon"
		dd 21Bh, 43E2F6h, 2, 43E051h, 205h, 43E308h, 0
		dd offset a@		; "@"
		dd 1FFh, 43E30Eh, 2, 43E051h, 208h, 43E316h, 2,	43E051h
		dd 209h, 43E31Eh, 2, 43E051h, 20Ah, 43E326h, 2,	43E051h
		dd 20Bh, 43E32Eh, 2, 43E051h, 20Ch, 43E337h, 2,	43E051h
		dd 20Dh, 43E343h, 2, 43E051h, 221h, 43E34Eh, 0
		dd offset aIgnoreRequests ; "ignore requests to	change the TTY"
		dd 222h, 43E37Ah, 0
		dd offset aIgnoreReques_0 ; "ignore requests to	change the X display"
		dd 20Fh, 43E3B0h, 4, 43E3C4h, 210h, 43E3EAh, 4,	43E051h
		dd 211h, 43E400h, 4, 43E051h, 212h, 43E40Eh, 4,	43E051h
		dd 213h, 43E420h, 0
		dd offset a@		; "@"
		dd 214h, 43E43Fh, 4, 43E051h, 215h, 43E452h, 4,	43E051h
		dd 216h, 43E46Ah, 2, 43E051h, 217h, 43E483h, 4,	43E051h
		dd 218h, 43E497h, 0
		dd offset a@		; "@"
		dd 21Ch, 43E4B1h, 0
		dd offset aDoNotUseThePin ; "do	not use	the PIN	cache when signing"
		dd 21Eh, 43E4F2h, 0
		dd offset aDisallowClient ; "disallow clients to mark keys as \"trus"...
		dd 21Dh, 43E533h, 0
		dd offset a@		; "@"
		dd 21Fh, 43E546h, 0
		dd offset aAllowPresettin ; "allow presetting passphrase"
		dd 223h, 43E57Ah, 0
		dd offset aEnableSshSuppo ; "enable ssh	support"
		dd 224h, 43E5A0h, 0
		dd offset aEnablePuttyS_0 ; "enable putty support"
		dd 220h, 43E5CAh, 0
		dd offset aDisallowTheUse ; "disallow the use of an external passwor"...
		dd 226h, 43E613h, 0Ah, 43E624h,	4 dup(0)
dword_43D360	dd 1			; DATA XREF: sub_401681+8r
					; sub_401681+2Dw ...
dword_43D364	dd 0FFFFFFFFh		; DATA XREF: sub_402066+11CBw
		align 20h
dword_43D380	dd 2, 4015CCh, 43A0DCh,	43A0E4h, 4015DFh, 401600h, 401621h
					; DATA XREF: sub_402066+178o
		dd 40163Ah, 43A0ECh, 401653h, 43A0F4h, 43A0FCh,	43A104h
; char *off_43D3B4
off_43D3B4	dd offset aDisplay	; DATA XREF: sub_402066+29Ar
					; sub_402066+2C1r ...
					; "DISPLAY"
		dd offset aTerm		; "TERM"
		dd offset aXauthority	; "XAUTHORITY"
		dd offset aPinentry_user_ ; "PINENTRY_USER_DATA"
		align 20h
off_43D3E0	dd offset aGeteventcounte ; DATA XREF: sub_408F4F+1Co
					; sub_408F4F+30o ...
					; "GETEVENTCOUNTER"
		dd offset sub_405D08
		dd offset aGeteventcoun_0 ; "GETEVENTCOUNTER\n\nReturn a a status li"...
		dd offset aIstrusted	; "ISTRUSTED"
		dd offset sub_405DF8
		dd offset aIstrustedHexst ; "ISTRUSTED <hexstring_with_fingerprint>\"...
		dd offset aHavekey	; "HAVEKEY"
		dd offset sub_4061AF
		dd offset aHavekeyHexstri ; "HAVEKEY <hexstring_with_keygrip>\n\nRet"...
		dd offset aKeyinfo	; "KEYINFO"
		dd offset sub_406F3A
		dd offset aKeyinfoSshList ; "KEYINFO [--[ssh-]list] [--data] [--ssh-"...
		dd offset aSigkey	; "SIGKEY"
		dd offset sub_406200
		dd offset aSigkeyHexstrin ; "SIGKEY <hexstring_with_keygrip>\nSETKEY"...
		dd offset aSetkey	; "SETKEY"
		dd offset sub_406200
		dd offset aSigkeyHexstrin ; "SIGKEY <hexstring_with_keygrip>\nSETKEY"...
		dd offset aSetkeydesc	; "SETKEYDESC"
		dd offset sub_40624F
		dd offset aSetkeydescPlus ; "SETKEYDESC	plus_percent_escaped_string\"...
		dd offset aSethash	; "SETHASH"
		dd offset sub_406326
		dd offset aSethashHashNam ; "SETHASH --hash=<name>|<algonumber>	<hex"...
		dd offset aPksign	; "PKSIGN"
		dd offset sub_406727
		dd offset aPksignOptionsP ; "PKSIGN [options]\n\nPerform the actual "...
		dd offset aPkdecrypt	; "PKDECRYPT"
		dd offset sub_406810
		dd offset aPkdecryptOptio ; "PKDECRYPT <options>\n\nPerform the	actu"...
		dd offset aGenkey	; "GENKEY"
		dd offset sub_40691D
		dd offset dword_43FFE0
		dd offset aReadkey	; "READKEY"
		dd offset sub_4069FA
		dd offset aReadkeyHexstri ; "READKEY <hexstring_with_keygrip>\n\nRet"...
		dd offset aGet_passphrase ; "GET_PASSPHRASE"
		dd offset sub_4074BA
		dd offset aGet_passphra_0 ; "GET_PASSPHRASE [--data] [--check] [--no"...
		dd offset aPreset_passphr ; "PRESET_PASSPHRASE"
		dd offset sub_407E3F
		dd offset aPreset_passp_0 ; "PRESET_PASSPHRASE <string_or_keygrip> <"...
		dd offset aClear_passphra ; "CLEAR_PASSPHRASE"
		dd offset sub_407A76
		dd offset aClear_passph_0 ; "CLEAR_PASSPHRASE <cache_id>\n\nmay	be u"...
		dd offset aGet_confirmati ; "GET_CONFIRMATION"
		dd offset sub_407B71
		dd offset aGet_confirma_0 ; "GET_CONFIRMATION <description>\n\nThis "...
		dd offset aListtrusted	; "LISTTRUSTED"
		dd offset sub_405F87
		dd offset aListtrustedLis ; "LISTTRUSTED\n\nList all entries from th"...
		dd offset aMarktrusted	; "MARKTRUSTED"
		dd offset sub_405FC1
		dd offset aMarktrustedHex ; "MARKTRUSTED <hexstring_with_fingerprint"...
		dd offset aLearn	; "LEARN"
		dd offset sub_407C84
		dd offset aLearnSendLearn ; "LEARN [--send]\n\nLearn something about"...
		dd offset aPasswd	; "PASSWD"
		dd offset sub_407CF1
		dd offset aPasswdHexstrin ; "PASSWD <hexstring_with_keygrip>\n\nChan"...
		dd offset aInput	; "INPUT"
		dd 2 dup(0)
		dd offset aOutput	; "OUTPUT"
		dd 2 dup(0)
		dd offset off_441FC3
		dd offset sub_408079
		dd offset aScdCommandsToP ; "SCD <commands to pass to the scdaemon>\"...
		dd offset aGetval	; "GETVAL"
		dd offset sub_4080AE
		dd offset aGetvalKeyRetur ; "GETVAL <key>\n\nReturn the	value for KE"...
		dd offset aPutval	; "PUTVAL"
		dd offset sub_408218
		dd offset aPutvalKeyPerce ; "PUTVAL <key> [<percent_escaped_value>]\"...
		dd offset aUpdatestartupt ; "UPDATESTARTUPTTY"
		dd offset sub_40846E
		dd offset aUpdatestartu_0 ; "UPDATESTARTUPTTY\n\nSet startup TTY and"...
		dd offset aKillagent	; "KILLAGENT"
		dd offset sub_4085E1
		dd offset aKillagentIfThe ; "KILLAGENT\n\nIf the agent has been	star"...
		dd offset aReloadagent	; "RELOADAGENT"
		dd offset sub_40863E
		dd offset aReloadagentThi ; "RELOADAGENT\n\nThis command is an alter"...
		dd offset aGetinfo	; "GETINFO"
		dd offset sub_408650
		dd offset aGetinfoWhatMul ; "GETINFO <what>\n\nMultipurpose function"...
		dd 3 dup(0)
; char *off_43D548
off_43D548	dd offset aGpg_tty_0	; DATA XREF: sub_40846E+4Br
					; sub_40846E+70r ...
					; "GPG_TTY"
		dd offset aDisplay_1	; "DISPLAY"
		dd offset aTerm_0	; "TERM"
		dd offset aXauthority_1	; "XAUTHORITY"
		dd offset aPinentry_use_0 ; "PINENTRY_USER_DATA"
		align 10h
dword_43D560	dd 0Bh,	40C2BAh, 4422C5h, 1, 0Dh, 40CD28h, 4422D8h, 0
					; DATA XREF: sub_40D98B+15o
					; sub_40D98B+63o
		dd 11h,	40D65Ch, 4422E5h, 1, 19h, 40D65Ch, 4422E5h, 1
		dd 12h,	40D79Dh, 4422F2h, 0
		dd 13h,	40D87Ah, 442302h, 0
		dd 16h,	40D8FDh, 442318h, 0
		dd 17h,	40D944h, 44231Dh, 0
off_43D5E0	dd offset aSshRsa	; DATA XREF: sub_40B271+1Bo
					; sub_40B271+41o ...
					; "ssh-rsa"
		dd offset aRsa_3	; "rsa"
		dd offset aNedupq	; "nedupq"
		dd offset aEn_1		; "en"
		dd offset aS_5		; "s"
		dd offset aNedpqu	; "nedpqu"
		dd offset sub_40A6E7
		dd offset sub_40A77C
dword_43D600	dd 2 dup(0)		; DATA XREF: sub_40B349+15o
					; sub_40B349+26o
		dd 1, 442343h, 44234Bh,	44234Fh, 442355h, 44235Ah, 44234Fh
		dd 0
		dd offset sub_40A7E3
		dd 3 dup(0)
		dd offset aEcdsaSha2Nistp ; "ecdsa-sha2-nistp256"
		dd offset aEcdsa_0	; "ecdsa"
		dd offset aQd		; "qd"
		dd offset aQ		; "q"
		dd offset aRs		; "rs"
		dd offset aQd		; "qd"
		dd 0
		dd offset sub_40A91E
		dd offset aNistp256	; "nistp256"
		dd 8, 2, 442385h, 442371h, 442377h, 44237Ah, 44235Ah, 442377h
		dd 0
		dd offset sub_40A91E
		dd offset aNistp384	; "nistp384"
		dd 9, 2, 4423A2h, 442371h, 442377h, 44237Ah, 44235Ah, 442377h
		dd 0
		dd offset sub_40A91E
		dd offset aNistp521	; "nistp521"
		dd 0Ah,	2
; char *off_43D6BC
off_43D6BC	dd offset aGpg_tty_3	; DATA XREF: sub_40DE3A+19r
					; sub_40DE3A+3Dr ...
					; "GPG_TTY"
		dd offset aDisplay_4	; "DISPLAY"
		dd offset aTerm_2	; "TERM"
		dd offset aXauthority_3	; "XAUTHORITY"
		dd offset aPinentry_use_2 ; "PINENTRY_USER_DATA"
		align 20h
off_43D6E0	dd offset aOk		; DATA XREF: sub_40E7CF+706o
					; sub_40E7CF+757o ...
					; "ok"
		dd offset aPinentryLabel_ ; "|pinentry-label|_OK"
		dd 0
		dd offset aCancel	; "cancel"
		dd offset aPinentryLabe_0 ; "|pinentry-label|_Cancel"
		align 8
		dd offset aYes_0	; "yes"
		dd offset aPinentryLabe_1 ; "|pinentry-label|_Yes"
		dd 0
		dd offset aNo_1		; "no"
		dd offset aPinentryLabe_2 ; "|pinentry-label|_No"
		align 10h
		dd offset aPrompt	; "prompt"
		dd offset aPinentryLabelP ; "|pinentry-label|PIN:"
		dd 0
		dd offset aPwmngr	; "pwmngr"
		dd offset aPinentryLabe_3 ; "|pinentry-label|_Save in password manag"...
		align 8
		dd offset aCfVisi	; "cf-visi"
		dd offset aDoYouReallyWan ; "Do	you really want	to make	your passphr"...
		dd 0
		dd offset aTtVisi	; "tt-visi"
		dd offset aPinentryTtMake ; "|pinentry-tt|Make passphrase visible"
		align 10h
		dd offset aTtHide	; "tt-hide"
		dd offset aPinentryTtHide ; "|pinentry-tt|Hide passphrase"
		align 20h
off_43D760	dd offset aRsa_2	; DATA XREF: sub_415A18+158o
					; sub_415A18+170o ...
					; "rsa"
		dd offset aNedpqu_0	; "nedpqu"
		dd 2, 5
dword_43D770	dd 0			; DATA XREF: sub_415A18+2CDo
		dd offset aDsa_1	; "dsa"
		dd offset aPqgyx	; "pqgyx"
		dd 2 dup(4), 0
		dd offset aElg_1	; "elg"
		dd offset aPgyx		; "pgyx"
		dd 2 dup(3), 0
		dd offset aEcdsa_1	; "ecdsa"
		dd offset aPabgnqd	; "pabgnqd"
		dd 2 dup(6), 1,	444174h, 44416Ch, 2 dup(6), 1, 444179h
		dd 44416Ch, 2 dup(6), 1, 0Ah dup(0)
dword_43D800	dd 6Fh			; DATA XREF: sub_41C8BC+17Br
					; sub_41C8BC+20Ar
		dd 65h,	66h, 64h, 0FFFFFFFFh
; LPCSTR off_43D814
off_43D814	dd offset aShell32_dll	; DATA XREF: sub_41EAC5+30r
					; sub_41EAC5+90r
					; "shell32.dll"
		dd offset aShfolder_dll	; "shfolder.dll"
		align 10h
off_43D820	dd offset aGpg_tty_2	; DATA XREF: sub_41FB0D+46r
					; "GPG_TTY"
off_43D824	dd offset aTtyname_0	; DATA XREF: sub_41FB0D+37r
					; "ttyname"
		dd offset aTerm_3	; "TERM"
		dd offset aTtytype_0	; "ttytype"
		dd offset aDisplay_5	; "DISPLAY"
		dd offset aDisplay_6	; "display"
		dd offset aXauthority_4	; "XAUTHORITY"
		dd offset aXauthority_5	; "xauthority"
		dd offset aXmodifiers	; "XMODIFIERS"
		align 8
		dd offset aGtk_im_module ; "GTK_IM_MODULE"
		align 10h
		dd offset aQt_im_module	; "QT_IM_MODULE"
		align 8
		dd offset aPinentry_use_3 ; "PINENTRY_USER_DATA"
		dd offset aPinentryUser_0 ; "pinentry-user-data"
off_43D860	dd offset sub_426146	; DATA XREF: sub_427E25+8Er
					; sub_4285F8+A8r ...
off_43D864	dd offset sub_4261C6	; DATA XREF: sub_427E25+98r
					; sub_4285F8+B2r ...
off_43D868	dd offset sub_42644A	; DATA XREF: sub_427E25+A2r
					; sub_4285F8+BCr ...
off_43D86C	dd offset sub_4266CF	; DATA XREF: sub_427E25+ACr
					; sub_4285F8+C6r ...
off_43D870	dd offset sub_42676C	; DATA XREF: sub_4284E2+83r
					; sub_42898B+7Br ...
off_43D874	dd offset sub_4267D7	; DATA XREF: sub_4284E2+8Dr
					; sub_42898B+85r ...
off_43D878	dd offset sub_426841	; DATA XREF: sub_4284E2+97r
					; sub_42898B+8Fr ...
off_43D87C	dd offset sub_4268D3	; DATA XREF: sub_4284E2+A1r
					; sub_4284E2+103r ...
off_43D880	dd offset sub_4269A2	; DATA XREF: sub_428AC0+A5r
off_43D884	dd offset sub_426A09	; DATA XREF: sub_428AC0+AFr
off_43D888	dd offset sub_426A60	; DATA XREF: sub_428AC0+B9r
off_43D88C	dd offset sub_426AEA	; DATA XREF: sub_428AC0+C3r
					; sub_428AC0+F5r
dword_43D890	dd 0FFFFFFFFh		; DATA XREF: sub_435365:loc_4354EBw
					; .text:loc_43571Fr ...
; char off_43D894[]
off_43D894	dd offset aIso88591	; DATA XREF: sub_437F30+D9w
					; sub_43802F:loc_438204w ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_43D8A4	dd offset dword_43CCA0	; DATA XREF: sub_43B1D0+3r
					; sub_43B1D0+12r ...
dword_43D8A8	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_43D8AC	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_43D8B0	dd 0BB40E64Eh		; DATA XREF: sub_43B270+3r
					; sub_43B270:loc_43B322w ...
dword_43D8B4	dd 44BF19B1h		; DATA XREF: sub_43B270+31w
					; sub_43B270+B8w ...
dword_43D8B8	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 800h
_data		ends

; Section 3. (virtual address 0003E000)
; Virtual size			: 0000A6A0 (  42656.)
; Section size in file		: 0000A800 (  43008.)
; Offset to raw	data for section: 0003CC00
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 43E000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
aGpgconfList	db 'gpgconf-list',0
a@		db '@',0                ; DATA XREF: .data:0043D0CCo
					; .data:0043D13Co ...
aGpgconfTest	db 'gpgconf-test',0
aUseStandardSoc	db 'use-standard-socket-p',0
a@options	db '@Options:',0Ah      ; DATA XREF: .data:0043D03Co
		db ' ',0
aDaemon		db 'daemon',0
		align 4
aRunInDaemonMod	db 'run in daemon mode (background)',0 ; DATA XREF: .data:0043D04Co
aServer		db 'server',0
		align 4
aRunInServerMod	db 'run in server mode (foreground)',0 ; DATA XREF: .data:0043D05Co
aVerbose	db 'verbose',0          ; DATA XREF: .data:0043D06Co
aQuiet		db 'quiet',0
aBeSomewhatMore	db 'be somewhat more quiet',0 ; DATA XREF: .data:0043D07Co
aSh		db 'sh',0
aShStyleCommand	db 'sh-style command output',0 ; DATA XREF: .data:0043D08Co
; char Str2[4]
Str2		db 'csh',0              ; DATA XREF: sub_402066+233o
aCshStyleComman	db 'csh-style command output',0 ; DATA XREF: .data:0043D09Co
aOptions_0	db 'options',0
aFileReadOption	db '|FILE|read options from FILE',0
aDebug		db 'debug',0
aDebugAll	db 'debug-all',0
aDebugLevel	db 'debug-level',0
aDebugWait	db 'debug-wait',0
aNoDetach	db 'no-detach',0
		align 4
aDoNotDetachFro	db 'do not detach from the console',0 ; DATA XREF: .data:0043D0FCo
aNoGrab		db 'no-grab',0
		align 10h
aDoNotGrabKeybo	db 'do not grab keyboard and mouse',0 ; DATA XREF: .data:0043D10Co
aLogFile	db 'log-file',0
aUseALogFileFor	db 'use a log file for the server',0
aUseStandardS_0	db 'use-standard-socket',0
		align 4
aUseAStandardLo	db 'use a standard location for the socket',0 ; DATA XREF: .data:0043D12Co
aNoUseStandar_0	db 'no-use-standard-socket',0
aPinentryProgra	db 'pinentry-program',0
		align 4
aPgmUsePgmAsThe	db '|PGM|use PGM as the PIN-Entry program',0
aPinentryTouchF	db 'pinentry-touch-file',0
aScdaemonProgra	db 'scdaemon-program',0
		align 4
aPgmUsePgmAsT_0	db '|PGM|use PGM as the SCdaemon program',0
aDisableScdae_0	db 'disable-scdaemon',0
aDoNotUseTheScd	db 'do not use the SCdaemon',0 ; DATA XREF: .data:0043D17Co
aFakedSystemTim	db 'faked-system-time',0
aBatch		db 'batch',0
aHomedir_0	db 'homedir',0
aDisplay_7	db 'display',0
aTtyname_1	db 'ttyname',0
aTtytype_1	db 'ttytype',0
aLcCtype_0	db 'lc-ctype',0
aLcMessages_0	db 'lc-messages',0
aXauthority_6	db 'xauthority',0
aKeepTty	db 'keep-tty',0
		align 4
aIgnoreRequests	db 'ignore requests to change the TTY',0 ; DATA XREF: .data:0043D21Co
aKeepDisplay	db 'keep-display',0
		align 4
aIgnoreReques_0	db 'ignore requests to change the X display',0 ; DATA XREF: .data:0043D22Co
aDefaultCache_1	db 'default-cache-ttl',0
		align 4
aNExpireCachedP	db '|N|expire cached PINs after N seconds',0
aDefaultCache_2	db 'default-cache-ttl-ssh',0
aMaxCacheTtl	db 'max-cache-ttl',0
aMaxCacheTtlS_0	db 'max-cache-ttl-ssh',0
aEnforcePassp_0	db 'enforce-passphrase-constraints',0
aMinPassphras_0	db 'min-passphrase-len',0
aMinPassphras_1	db 'min-passphrase-nonalpha',0
aCheckPassphr_0	db 'check-passphrase-pattern',0
aMaxPassphras_0	db 'max-passphrase-days',0
aEnablePassph_0	db 'enable-passphrase-history',0
aIgnoreCacheF_0	db 'ignore-cache-for-signing',0
		align 4
aDoNotUseThePin	db 'do not use the PIN cache when signing',0 ; DATA XREF: .data:0043D2DCo
aNoAllowMarkT_0	db 'no-allow-mark-trusted',0
aDisallowClient	db 'disallow clients to mark keys as "trusted"',0
					; DATA XREF: .data:0043D2ECo
aAllowMarkTrust	db 'allow-mark-trusted',0
aAllowPresetPas	db 'allow-preset-passphrase',0
aAllowPresettin	db 'allow presetting passphrase',0 ; DATA XREF: .data:0043D30Co
aEnableSshSup_0	db 'enable-ssh-support',0
aEnableSshSuppo	db 'enable ssh support',0 ; DATA XREF: .data:0043D31Co
aEnablePuttyS_1	db 'enable-putty-support',0
aEnablePuttyS_0	db 'enable putty support',0 ; DATA XREF: .data:0043D32Co
aNoAllowExter_0	db 'no-allow-external-cache',0
		align 4
aDisallowTheUse	db 'disallow the use of an external password cache',0
					; DATA XREF: .data:0043D33Co
aWriteEnvFile	db 'write-env-file',0
		align 4
aFileWriteEnvir	db '|FILE|write environment settings also to FILE',0
aGpgAgentGnupg	db 'gpg-agent (GnuPG)',0 ; DATA XREF: sub_401748:loc_401767o
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_401748:loc_401770o
aMingw32	db 'MingW32',0          ; DATA XREF: sub_401748:loc_401779o
		align 4
; char aPleaseReportBu[]
aPleaseReportBu	db 'Please report bugs to <@EMAIL@>.',0Ah,0
					; DATA XREF: sub_401748:loc_401782o
aLibgcrypt	db 'libgcrypt',0        ; DATA XREF: sub_401748+5Co
					; sub_402066+124o
; char aUsageGpgAgentO[]
aUsageGpgAgentO	db 'Usage: gpg-agent [options] (-h for help)',0
					; DATA XREF: sub_401748:loc_4017BFo
		align 4
; char aSyntaxGpgAgent[]
aSyntaxGpgAgent	db 'Syntax: gpg-agent [options] [command [args]]',0Ah
					; DATA XREF: sub_401748:loc_4017D0o
		db 'Secret key management for GnuPG',0Ah,0
		align 4
off_43E71C	dd offset loc_4017E1	; DATA XREF: sub_401748+16o
		dd offset loc_4017BF	; jump table for switch	statement
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_401767
		dd offset loc_4017E1
		dd offset loc_401770
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_401779
		dd offset loc_4017E1
		dd offset loc_401782
		dd offset loc_401793
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017E1
		dd offset loc_4017BF
		dd offset loc_4017D0
aNone		db 'none',0             ; DATA XREF: sub_4017ED+6Ao
aBasic		db 'basic',0            ; DATA XREF: sub_4017ED+AFo
aAdvanced	db 'advanced',0         ; DATA XREF: sub_4017ED+F4o
aExpert		db 'expert',0           ; DATA XREF: sub_4017ED+139o
aGuru		db 'guru',0             ; DATA XREF: sub_4017ED+17Bo
; char aInvalidDebugLe[]
aInvalidDebugLe	db 'invalid debug-level `%s',27h,' given',0Ah,0 ; DATA XREF: sub_4017ED+1C9o
aAssuan		db ' assuan',0          ; DATA XREF: sub_4017ED+293o
byte_43E80C	db 0			; DATA XREF: sub_4017ED:loc_401A87o
					; sub_4017ED:loc_401AA3o ...
aHashing	db ' hashing',0         ; DATA XREF: sub_4017ED+2ADo
aMemstat	db ' memstat',0         ; DATA XREF: sub_4017ED+2CBo
aCache		db ' cache',0           ; DATA XREF: sub_4017ED+2E7o
aMemory		db ' memory',0          ; DATA XREF: sub_4017ED+2FFo
aCrypto		db ' crypto',0          ; DATA XREF: sub_4017ED+317o
aMpi		db ' mpi',0             ; DATA XREF: sub_4017ED+32Fo
aCommand	db ' command',0         ; DATA XREF: sub_4017ED+347o
; char aEnabledDebugFl[]
aEnabledDebugFl	db 'enabled debug flags:%s%s%s%s%s%s%s%s',0Ah,0 ; DATA XREF: sub_4017ED+379o
; char aGpgAgent[]
aGpgAgent	db 'gpg-agent',0        ; DATA XREF: sub_402066+D8o
a1_5_0		db '1.5.0',0            ; DATA XREF: sub_402066+EEo
					; sub_402066+11Co
		align 4
; char aSIsTooOldNeedS[]
aSIsTooOldNeedS	db '%s is too old (need %s, have %s)',0Ah,0 ; DATA XREF: sub_402066+10Co
; char VarName[]
VarName		db 'SHELL',0            ; DATA XREF: sub_402066+1BDo
; char aGpg_tty[]
aGpg_tty	db 'GPG_TTY',0          ; DATA XREF: sub_402066+346o
					; sub_403366+5Co
; char aErrorRecording[]
aErrorRecording	db 'error recording startup environment: %s',0Ah,0
					; DATA XREF: sub_402066+37Ao
; char aLc_ctype[]
aLc_ctype	db 'LC_CTYPE',0         ; DATA XREF: sub_402066:loc_4023ECo
; char aLc_messages[]
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: sub_402066:loc_402418o
aGpgAgent_conf	db 'gpg-agent.conf',0   ; DATA XREF: sub_402066+4C3o
					; sub_402066+CD2o
; char Mode[]
Mode		db 'r',0                ; DATA XREF: sub_402066+51Ao
					; sub_4034EE+1Do
		align 4
; char aNoteNoDefaultO[]
aNoteNoDefaultO	db 'NOTE: no default option file `%s',27h,0Ah,0 ; DATA XREF: sub_402066+55Bo
; char aOptionFileSS[]
aOptionFileSS	db 'option file `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_402066+5CDo
					; sub_4034EE+55o
; char aReadingOptions[]
aReadingOptions	db 'reading options from `%s',27h,0Ah,0 ; DATA XREF: sub_402066+610o
a_gpgAgentInfo	db '~/.gpg-agent-info',0 ; DATA XREF: sub_402066+A5Bo
; char Format[]
Format		db '%s %s; %s',0Ah,0    ; DATA XREF: sub_402066+BA8o
; char aS[]
aS		db '%s',0Ah,0           ; DATA XREF: sub_402066+BDAo
; char aAtexitFailed[]
aAtexitFailed	db 'atexit failed',0Ah,0 ; DATA XREF: sub_402066+C0Do
; char aWaitingForDebu[]
aWaitingForDebu	db 'waiting for debugger - my pid is %u .....',0Ah,0
					; DATA XREF: sub_402066+C5Bo
; char a___Okay[]
a___Okay	db '... okay',0Ah,0     ; DATA XREF: sub_402066+C76o
		align 4
; char aGpgconfGpgAgen[]
aGpgconfGpgAgen	db 'gpgconf-gpg-agent.conf:%lu:"%s',0Ah,0 ; DATA XREF: sub_402066+D07o
; char aVerboseLuQuiet[]
aVerboseLuQuiet	db 'verbose:%lu:',0Ah   ; DATA XREF: sub_402066+D45o
		db 'quiet:%lu:',0Ah
		db 'debug-level:%lu:"none:',0Ah
		db 'log-file:%lu:',0Ah,0
; char aDefaultCacheTt[]
aDefaultCacheTt	db 'default-cache-ttl:%lu:%d:',0Ah,0 ; DATA XREF: sub_402066+D72o
		align 4
; char aDefaultCache_0[]
aDefaultCache_0	db 'default-cache-ttl-ssh:%lu:%d:',0Ah,0 ; DATA XREF: sub_402066+D8Fo
; char aMaxCacheTtlLuD[]
aMaxCacheTtlLuD	db 'max-cache-ttl:%lu:%d:',0Ah,0 ; DATA XREF: sub_402066+DACo
; char aMaxCacheTtlSsh[]
aMaxCacheTtlSsh	db 'max-cache-ttl-ssh:%lu:%d:',0Ah,0 ; DATA XREF: sub_402066+DC9o
		align 4
; char aEnforcePassphr[]
aEnforcePassphr	db 'enforce-passphrase-constraints:%lu:',0Ah,0 ; DATA XREF: sub_402066+DE6o
; char aMinPassphraseL[]
aMinPassphraseL	db 'min-passphrase-len:%lu:%d:',0Ah,0 ; DATA XREF: sub_402066+DFBo
		align 4
; char aMinPassphraseN[]
aMinPassphraseN	db 'min-passphrase-nonalpha:%lu:%d:',0Ah,0 ; DATA XREF: sub_402066+E18o
		align 10h
; char aCheckPassphras[]
aCheckPassphras	db 'check-passphrase-pattern:%lu:',0Ah,0 ; DATA XREF: sub_402066+E35o
; char aMaxPassphraseD[]
aMaxPassphraseD	db 'max-passphrase-days:%lu:%d:',0Ah,0 ; DATA XREF: sub_402066+E4Ao
; char aEnablePassphra[]
aEnablePassphra	db 'enable-passphrase-history:%lu:',0Ah,0 ; DATA XREF: sub_402066+E67o
; char aNoGrabLu[]
aNoGrabLu	db 'no-grab:%lu:',0Ah,0 ; DATA XREF: sub_402066+E7Co
		align 4
; char aIgnoreCacheFor[]
aIgnoreCacheFor	db 'ignore-cache-for-signing:%lu:',0Ah,0 ; DATA XREF: sub_402066+E91o
; char aNoAllowMarkTru[]
aNoAllowMarkTru	db 'no-allow-mark-trusted:%lu:',0Ah,0 ; DATA XREF: sub_402066+EA6o
; char aNoAllowExterna[]
aNoAllowExterna	db 'no-allow-external-cache:%lu:',0Ah,0 ; DATA XREF: sub_402066+EBBo
; char aDisableScdaemo[]
aDisableScdaemo	db 'disable-scdaemon:%lu:',0Ah,0 ; DATA XREF: sub_402066+ED0o
; char aEnablePuttySup[]
aEnablePuttySup	db 'enable-putty-support:%lu:',0Ah,0 ; DATA XREF: sub_402066+EE5o
; char aTerm[]
aTerm		db 'TERM',0             ; DATA XREF: sub_402066+FE5o
					; sub_402066+FF5o ...
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating connection control data: %s',0Ah,0
					; DATA XREF: sub_402066+1056o
					; sub_403FC2+33Ao ...
		align 4
; char aErrorAllocat_0[]
aErrorAllocat_0	db 'error allocating session environment block: %s',0Ah,0
					; DATA XREF: sub_402066+10A0o
					; sub_403FC2+372o ...
aTmpGpgXxxxxxS_	db '/tmp/gpg-XXXXXX/S.gpg-agent',0 ; DATA XREF: sub_402066+1126o
aS_gpgAgent	db 'S.gpg-agent',0      ; DATA XREF: sub_402066+112Eo
					; sub_4051ED+3Ao ...
aTmpGpgXxxxxx_0	db '/tmp/gpg-XXXXXX/S.gpg-agent.ssh',0 ; DATA XREF: sub_402066+1148o
aS_gpgAgent_ssh	db 'S.gpg-agent.ssh',0  ; DATA XREF: sub_402066+1150o
; char aSetGpg_agent_i[]
aSetGpg_agent_i	db 'set GPG_AGENT_INFO=%s;%lu;1',0Ah,0 ; DATA XREF: sub_402066+11F5o
; char aSSStarted[]
aSSStarted	db '%s %s started',0Ah,0 ; DATA XREF: sub_402066+122Co
; char a____Gnupg22_0_[]
a____Gnupg22_0_	db '../../gnupg2-2.0.30/agent/gpg-agent.c',0 ; DATA XREF: sub_403366+18o
					; sub_40378F+6Fo
; char aCtrlSession_en[]
aCtrlSession_en	db 'ctrl->session_env',0 ; DATA XREF: sub_403366+20o
; char aDisplay[]
aDisplay	db 'DISPLAY',0          ; DATA XREF: sub_403366+3Co
					; .data:off_43D3B4o
; char aXauthority[]
aXauthority	db 'XAUTHORITY',0       ; DATA XREF: sub_403366+9Co
					; .data:0043D3BCo
; char aPinentry_user_[]
aPinentry_user_	db 'PINENTRY_USER_DATA',0 ; DATA XREF: sub_403366+BAo
					; .data:0043D3C0o
		align 10h
; char aCanTCreateScdN[]
aCanTCreateScdN	db 'can',27h,'t create scd notify event: %s',0Ah,0
					; DATA XREF: sub_403664+6Ao
		align 4
; char aSettingSyncron[]
aSettingSyncron	db 'setting syncronize for scd notify event failed: %s',0Ah,0
					; DATA XREF: sub_403664+D6o
; char aReturningNotif[]
aReturningNotif	db 'returning notify handle %p',0Ah,0 ; DATA XREF: sub_403664+115o
; char aCanTCreateDire[]
aCanTCreateDire	db 'can',27h,'t create directory `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40378F+A3o
					; sub_403C50+75o ...
asc_43EDC5	db ';',0                ; DATA XREF: sub_40378F+EBo
		align 4
; char aSAreNotAllowed[]
aSAreNotAllowed	db '`%s',27h,' are not allowed in the socket name',0Ah,0
					; DATA XREF: sub_40378F+F3o
; char aNameOfSocketTo[]
aNameOfSocketTo	db 'name of socket too long',0Ah,0 ; DATA XREF: sub_40378F+132o
; char aCanTCreateSock[]
aCanTCreateSock	db 'can',27h,'t create socket: %s',0Ah,0 ; DATA XREF: sub_4038EB+41o
; char aSocketNameSIsT[]
aSocketNameSIsT	db 'socket name `%s',27h,' is too long',0Ah,0 ; DATA XREF: sub_4038EB+FDo
		align 4
; char aAGpgAgentIsAlr[]
aAGpgAgentIsAlr	db 'a gpg-agent is already running - not starting a new one',0Ah,0
					; DATA XREF: sub_4038EB+1C6o
		align 10h
; char aErrorGettingNo[]
aErrorGettingNo	db 'error getting nonce for the socket',0Ah,0 ; DATA XREF: sub_4038EB+257o
; char aErrorBindingSo[]
aErrorBindingSo	db 'error binding socket to `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_4038EB+292o
; char aListenFailedS[]
aListenFailedS	db 'listen() failed: %s',0Ah,0 ; DATA XREF: sub_4038EB+304o
; char aListeningOnSoc[]
aListeningOnSoc	db 'listening on socket `%s',27h,0Ah,0 ; DATA XREF: sub_4038EB+342o
aPrivateKeysV1_	db 'private-keys-v1.d',0 ; DATA XREF: sub_403C50+Fo
; char aDirectorySCrea[]
aDirectorySCrea	db 'directory `%s',27h,' created',0Ah,0 ; DATA XREF: sub_403C50+9Fo
					; sub_403D1A+C6o
; char aStatFailedForS[]
aStatFailedForS	db 'stat() failed for `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_403D1A+101o
		align 4
; char aCanTUseSAsHome[]
aCanTUseSAsHome	db 'can',27h,'t use `%s',27h,' as home directory',0Ah,0
					; DATA XREF: sub_403D1A+135o
		align 10h
; char aSighupReceived[]
aSighupReceived	db 'SIGHUP received - re-reading configuration and flushing cache',0Ah,0
					; DATA XREF: sub_403EE1+6o
		align 10h
; char aSigusr2Receive[]
aSigusr2Receive	db 'SIGUSR2 received - updating card event counter',0Ah,0
					; DATA XREF: sub_403F04+Fo
aSignalDReceive	db 'signal %d received - no action defined',0Ah,0
					; DATA XREF: .text:00403F33o
; char aErrorReadingNo[]
aErrorReadingNo	db 'error reading nonce on fd %d: %s',0Ah,0 ; DATA XREF: sub_403F41+3Ao
; char aSshMapFileS[]
aSshMapFileS	db 'ssh map file ',27h,'%s',27h,0 ; DATA XREF: sub_403FC2+C6o
; char aSshMapHandleP[]
aSshMapHandleP	db 'ssh map handle %p',0Ah,0 ; DATA XREF: sub_403FC2+114o
; char aErrorGettingMy[]
aErrorGettingMy	db 'error getting my sid',0Ah,0 ; DATA XREF: sub_403FC2+14Eo
		align 4
; char aErrorGettingSi[]
aErrorGettingSi	db 'error getting sid of ssh map file: rc=%d',0 ; DATA XREF: sub_403FC2+1B5o
aError		db '[error]',0          ; DATA XREF: sub_403FC2:loc_4041C8o
					; sub_403FC2:loc_40421Bo
; char aMySidS[]
aMySidS		db '          my sid: ',27h,'%s',27h,0 ; DATA XREF: sub_403FC2+20Fo
; char aSshMapFileSidS[]
aSshMapFileSidS	db 'ssh map file sid: ',27h,'%s',27h,0 ; DATA XREF: sub_403FC2+262o
		align 4
; char aSshMapFileHasA[]
aSshMapFileHasA	db 'ssh map file has a non-matching sid',0Ah,0 ; DATA XREF: sub_403FC2+299o
; char aSshIpcBufferAt[]
aSshIpcBufferAt	db 'ssh IPC buffer at %p',0Ah,0 ; DATA XREF: sub_403FC2+2F2o
; CHAR WindowName[]
WindowName	db 'Pageant',0          ; DATA XREF: sub_4043EA+48o
					; sub_4043EA+EAo ...
		align 4
; char aPuttyMessageLo[]
aPuttyMessageLo	db 'putty message loop thread 0x%lx started',0Ah,0
					; DATA XREF: sub_4043EA+61o
		align 4
; char aErrorRegisteri[]
aErrorRegisteri	db 'error registering Pageant window class',0 ; DATA XREF: sub_4043EA+8Co
; char aErrorCreatingP[]
aErrorCreatingP	db 'error creating Pageant window',0 ; DATA XREF: sub_4043EA+119o
		align 10h
; char aPuttyMessage_0[]
aPuttyMessage_0	db 'putty message loop thread 0x%lx stopped',0Ah,0
					; DATA XREF: sub_4043EA+192o
		align 4
; char aHandler0xLxFor[]
aHandler0xLxFor	db 'handler 0x%lx for fd %d started',0Ah,0 ; DATA XREF: sub_40458F+51o
		align 10h
; char aHandler0xLxF_0[]
aHandler0xLxF_0	db 'handler 0x%lx for fd %d terminated',0Ah,0 ; DATA XREF: sub_40458F+A0o
; char aSshHandler0xLx[]
aSshHandler0xLx	db 'ssh handler 0x%lx for fd %d started',0Ah,0 ; DATA XREF: sub_40466D+51o
		align 4
; char aSshHandler0x_0[]
aSshHandler0x_0	db 'ssh handler 0x%lx for fd %d terminated',0Ah,0
					; DATA XREF: sub_40466D+98o
aPuttyMessage_1	db 'putty message loop',0 ; DATA XREF: sub_404743+80o
		align 4
; char aErrorSpawningP[]
aErrorSpawningP	db 'error spawning putty message loop: %s',0Ah,0 ; DATA XREF: sub_404743+CFo
		align 10h
; char aPth_selectFail[]
aPth_selectFail	db 'pth_select failed: %s - waiting 1s',0Ah,0 ; DATA XREF: sub_404743+38Eo
; char aAcceptFailedS[]
aAcceptFailedS	db 'accept failed: %s',0Ah,0 ; DATA XREF: sub_404743+48Eo
aConnFdDGpg	db 'conn fd=%d (gpg)',0 ; DATA XREF: sub_404743+545o
; char aErrorSpawningC[]
aErrorSpawningC	db 'error spawning connection handler: %s',0Ah,0
					; DATA XREF: sub_404743+5C2o
; char aAcceptFailedFo[]
aAcceptFailedFo	db 'accept failed for ssh: %s',0Ah,0 ; DATA XREF: sub_404743+669o
aConnFdDSsh	db 'conn fd=%d (ssh)',0 ; DATA XREF: sub_404743+72Bo
		align 4
; char aErrorSpawningS[]
aErrorSpawningS	db 'error spawning ssh connection handler: %s',0Ah,0
					; DATA XREF: sub_404743+7A8o
; char aSSStopped[]
aSSStopped	db '%s %s stopped',0Ah,0 ; DATA XREF: sub_404743+82Ao
		align 4
; char aCanTAllocateAs[]
aCanTAllocateAs	db 'can',27h,'t allocate assuan context: %s',0Ah,0
					; DATA XREF: sub_404FBD+44o
		align 4
; char aCanTConnectMyO[]
aCanTConnectMyO	db 'can',27h,'t connect my own socket: %s',0Ah,0 ; DATA XREF: sub_404FBD+8Fo
aGetinfoPid	db 'GETINFO pid',0      ; DATA XREF: sub_404FBD+E5o
					; sub_404FBD+144o
		align 4
; char aSendingCommand[]
aSendingCommand	db 'sending command "%s" to my own socket failed: %s',0Ah,0
					; DATA XREF: sub_404FBD+14Co
		align 10h
; char aSocketIsNowSer[]
aSocketIsNowSer	db 'socket is now serviced by another server',0Ah,0
					; DATA XREF: sub_404FBD+187o
		align 4
; char aSocketIsStillS[]
aSocketIsStillS	db 'socket is still served by this server',0Ah,0
					; DATA XREF: sub_404FBD+1A6o
		align 4
; char aThisProcessIsU[]
aThisProcessIsU	db 'this process is useless - shutting down',0Ah,0
					; DATA XREF: sub_404FBD+20Co
aCheckOwnSocket	db 'check-own-socket',0 ; DATA XREF: sub_4051ED+95o
		align 10h
; char aErrorSpawnin_0[]
aErrorSpawnin_0	db 'error spawning check_own_socket_thread: %s',0Ah,0
					; DATA XREF: sub_4051ED+E3o
; char aGpg_agent_info[]
aGpg_agent_info	db 'GPG_AGENT_INFO',0   ; DATA XREF: sub_4052F2+17o
		align 4
; char aNoGpgAgentRunn[]
aNoGpgAgentRunn	db 'no gpg-agent running in this session',0Ah,0 ; DATA XREF: sub_4052F2+5Do
		align 4
; char aMalformedGpg_a[]
aMalformedGpg_a	db 'malformed GPG_AGENT_INFO environment variable',0Ah,0
					; DATA XREF: sub_4052F2+DFo
		align 4
; char aGpgAgentProtoc[]
aGpgAgentProtoc	db 'gpg-agent protocol version %d is not supported',0Ah,0
					; DATA XREF: sub_4052F2+168o
; char aCanTConnectToT[]
aCanTConnectToT	db 'can',27h,'t connect to the agent: %s',0Ah,0 ; DATA XREF: sub_4052F2+25Do
; char aGpgAgentRunnin[]
aGpgAgentRunnin	db 'gpg-agent running and available',0Ah,0 ; DATA XREF: sub_4052F2+291o
aCreate_socket_	db 'create_socket_name',0 ; DATA XREF: sub_40378F+5Fo
		align 10h
; char Control[]
Control		db ' ',0                ; DATA XREF: sub_40588B+A7o
aInvalidHexstri	db 'invalid hexstring',0 ; DATA XREF: sub_4059FE+83o
					; sub_407E3F+1A4o
aOddNumberOfDig	db 'odd number of digits',0 ; DATA XREF: sub_4059FE+B2o
aInvalidLengthO	db 'invalid length of keygrip',0 ; DATA XREF: sub_405AD8+50o
aHex2bin	db 'hex2bin',0          ; DATA XREF: sub_405AD8+93o
aPinentry_launc	db 'PINENTRY_LAUNCHED %lu',0 ; DATA XREF: sub_405C88+34o
		align 20h
aGeteventcoun_0	db 'GETEVENTCOUNTER',0Ah ; DATA XREF: .data:0043D3E8o
		db 0Ah
		db 'Return a a status line named EVENTCOUNTER with the current values'
		db 0Ah
		db 'of all event counters.  The values are decimal numbers in the ran'
		db 'ge',0Ah
		db '0 to UINT_MAX and wrapping around to 0.  The actual values should'
		db 0Ah
		db 'not be relied upon, they shall only be used to detect a change.',0Ah
		db 0Ah
		db 'The currently defined counters are:',0Ah
		db 0Ah
		db 'ANY  - Incremented with any change of any of the other counters.',0Ah
		db 'KEY  - Incremented for added or removed private keys.',0Ah
		db 'CARD - Incremented for changes of the card readers stati.',0
aU_2		db '%u',0               ; DATA XREF: sub_405D08+1Do
					; sub_405D08+41o ...
aEventcounter	db 'EVENTCOUNTER',0     ; DATA XREF: sub_405D08+9Do
aIstrustedHexst	db 'ISTRUSTED <hexstring_with_fingerprint>',0Ah ; DATA XREF: .data:0043D3F4o
		db 0Ah
		db 'Return OK when we have an entry with this fingerprint in our',0Ah
		db 'trustlist',0
aInvalidFingerp	db 'invalid fingerprint',0 ; DATA XREF: sub_405DF8+89o
					; sub_405FC1+93o
a00000000	db '00000000',0         ; DATA XREF: sub_405DF8+B2o
					; sub_405FC1+BCo
; char aCommandIs_trus[]
aCommandIs_trus	db 'command is_trusted failed: %s',0Ah,0 ; DATA XREF: sub_405DF8+17Eo
		align 20h
aListtrustedLis	db 'LISTTRUSTED',0Ah    ; DATA XREF: .data:0043D4A8o
		db 0Ah
		db 'List all entries from the trustlist.',0
		align 4
; char aCommandListtru[]
aCommandListtru	db 'command listtrusted failed: %s',0Ah,0 ; DATA XREF: sub_405F87+29o
		align 10h
aMarktrustedHex	db 'MARKTRUSTED <hexstring_with_fingerprint> <flag> <display_name>',0Ah
					; DATA XREF: .data:0043D4B4o
		db 0Ah
		db 'Store a new key in into the trustlist.',0
aInvalidFlagMus	db 'invalid flag - must be P or S',0 ; DATA XREF: sub_405FC1+171o
		align 4
; char aCommandMarktru[]
aCommandMarktru	db 'command marktrusted failed: %s',0Ah,0 ; DATA XREF: sub_405FC1+1DDo
		align 20h
aHavekeyHexstri	db 'HAVEKEY <hexstring_with_keygrip>',0Ah ; DATA XREF: .data:0043D400o
		db 0Ah
		db 'Return success when the secret key is available.',0
		align 10h
aSigkeyHexstrin	db 'SIGKEY <hexstring_with_keygrip>',0Ah ; DATA XREF: .data:0043D418o
					; .data:0043D424o
		db 'SETKEY <hexstring_with_keygrip>',0Ah
		db 0Ah
		db 'Set the  key used for a sign or decrypt operation.',0
		align 10h
aSetkeydescPlus	db 'SETKEYDESC plus_percent_escaped_string',0Ah ; DATA XREF: .data:0043D430o
		db 0Ah
		db 'Set a description to be used for the next PKSIGN or PKDECRYPT',0Ah
		db 'operation if this operation requires the entry of a passphrase.  '
		db 'If',0Ah
		db 'this command is not used a default text will be used.  Note, that'
		db 0Ah
		db 'this description implictly selects the label used for the entry',0Ah
		db 'box; if the string contains the string PIN (which in general will'
		db 0Ah
		db 'not be translated), "PIN" is used, otherwise the translation of',0Ah
		db '"passphrase" is used.  The description string should not contain',0Ah
		db 'blanks unless they are percent or ',27h,'+',27h,' escaped.',0Ah
		db 0Ah
		db 'The description is only valid for the next PKSIGN or PKDECRYPT',0Ah
		db 'operation.',0
aNoDescriptionG	db 'no description given',0 ; DATA XREF: sub_40624F+6Fo
					; sub_4074BA+24Do ...
		align 10h
aSethashHashNam	db 'SETHASH --hash=<name>|<algonumber> <hexstring>',0Ah
					; DATA XREF: .data:0043D43Co
		db 0Ah
		db 'The client can use this command to tell the server about the data'
		db 0Ah
		db '(which usually is a hash) to be signed.',0
; char aHash[]
aHash		db '--hash',0           ; DATA XREF: sub_406326+14o
; char aHashSha1[]
aHashSha1	db '--hash=sha1',0      ; DATA XREF: sub_406326+2Fo
; char aHashSha224[]
aHashSha224	db '--hash=sha224',0    ; DATA XREF: sub_406326:loc_406378o
; char aHashSha256[]
aHashSha256	db '--hash=sha256',0    ; DATA XREF: sub_406326:loc_40639Bo
; char aHashSha384[]
aHashSha384	db '--hash=sha384',0    ; DATA XREF: sub_406326:loc_4063BEo
; char aHashSha512[]
aHashSha512	db '--hash=sha512',0    ; DATA XREF: sub_406326:loc_4063E1o
; char aHashRmd160[]
aHashRmd160	db '--hash=rmd160',0    ; DATA XREF: sub_406326:loc_406404o
; char aHashMd5[]
aHashMd5	db '--hash=md5',0       ; DATA XREF: sub_406326:loc_406424o
; char aHashTlsMd5sha1[]
aHashTlsMd5sha1	db '--hash=tls-md5sha1',0 ; DATA XREF: sub_406326:loc_406444o
aInvalidHashAlg	db 'invalid hash algorithm',0 ; DATA XREF: sub_406326+14Ao
aUnsupportedLen	db 'unsupported length of hash',0 ; DATA XREF: sub_406326+2AEo
aHashValueToLon	db 'hash value to long',0 ; DATA XREF: sub_406326+2DEo
		align 10h
aPksignOptionsP	db 'PKSIGN [options]',0Ah ; DATA XREF: .data:0043D448o
		db 0Ah
		db 'Perform the actual sign operation.  Neither input nor output are',0Ah
		db 'sensitive to eavesdropping.',0
; char aCommandPksignF[]
aCommandPksignF	db 'command pksign failed: %s',0Ah,0 ; DATA XREF: sub_406727+BAo
		align 20h
aPkdecryptOptio	db 'PKDECRYPT <options>',0Ah ; DATA XREF: .data:0043D454o
		db 0Ah
		db 'Perform the actual decrypt operation.  Input is not',0Ah
		db 'sensitive to eavesdropping.',0
aCiphertext	db 'CIPHERTEXT',0       ; DATA XREF: sub_406810+2Bo
; char aCommandPkdecry[]
aCommandPkdecry	db 'command pkdecrypt failed: %s',0Ah,0 ; DATA XREF: sub_406810+DAo
		align 20h
dword_43FFE0	dd 4B4E4547h, 0A0A5945h, 656E6547h, 65746172h, 6E206120h
					; DATA XREF: .data:0043D460o
		dd 6B207765h, 202C7965h, 726F7473h, 68742065h, 65732065h
		dd 74657263h, 72617020h, 6E612074h, 65722064h, 6E727574h
		dd 65687420h, 62757020h, 0A63696Ch, 74726170h
		db 2Eh
aHereIsAnExampl	db '  Here is an example transaction:',0Ah ; DATA XREF: .rdata:off_4407DFo
		db 0Ah
		db '  C: GENKEY',0Ah
		db '  S: INQUIRE KEYPARAM',0Ah
		db '  C: D (genkey (rsa (nbits  1024)))',0Ah
		db '  C: END',0Ah
		db '  S: D (public-key',0Ah
		db '  S: D   (rsa (n 326487324683264) (e 10001)))',0Ah
		db '  S: OK key created',0Ah
		db 0Ah,0
aKeyparam	db 'KEYPARAM',0         ; DATA XREF: sub_40691D+2Ao
; char aCommandGenkeyF[]
aCommandGenkeyF	db 'command genkey failed: %s',0Ah,0 ; DATA XREF: sub_40691D+CCo
		align 10h
aReadkeyHexstri	db 'READKEY <hexstring_with_keygrip>',0Ah ; DATA XREF: .data:0043D46Co
		db 0Ah
		db 'Return the public key for the given keygrip.',0
		align 10h
; char a____Gnupg22__0[]
a____Gnupg22__0	db '../../gnupg2-2.0.30/agent/command.c',0 ; DATA XREF: sub_4069FA+9Fo
					; sub_4069FA+103o
; char aLen[]
aLen		db 'len',0              ; DATA XREF: sub_4069FA+A7o
					; sub_4069FA+10Bo
; char aCommandReadkey[]
aCommandReadkey	db 'command readkey failed: %s',0Ah,0 ; DATA XREF: sub_4069FA+15Eo
		align 10h
aKeyinfoSshList	db 'KEYINFO [--[ssh-]list] [--data] [--ssh-fpr] [--with-ssh] <keygrip'
					; DATA XREF: .data:0043D40Co
		db '>',0Ah
		db 0Ah
		db 'Return information about the key specified by the KEYGRIP.  If th'
		db 'e',0Ah
		db 'key is not available GPG_ERR_NOT_FOUND is returned.  If the optio'
		db 'n',0Ah
		db '--list is given the keygrip is ignored and information about all',0Ah
		db 'available keys are returned.  If --ssh-list is given information',0Ah
		db 'about all keys listed in the sshcontrol are returned.  With --wit'
		db 'h-ssh',0Ah
		db 'information from sshcontrol is always added to the info. Unless -'
		db '-data',0Ah
		db 'is given, the information is returned as a status line using the '
		db 'format:',0Ah
		db 0Ah
		db '  KEYINFO <keygrip> <type> <serialno> <idstr> - - <fpr> <ttl> <fl'
		db 'ags>',0Ah
		db 0Ah
		db 'KEYGRIP is the keygrip.',0Ah
		db 0Ah
		db 'TYPE describes the type of the key:',0Ah
		db '    ',27h,'D',27h,' - Regular key stored on disk,',0Ah
		db '    ',27h,'T',27h,' - Key is stored on a smartcard (token),',0Ah
		db '    ',27h,'X',27h,' - Unknown type,',0Ah
		db '    ',27h,'-',27h,' - Key is missing.',0Ah
		db 0Ah
		db 'SERIALNO is an ASCII string with the serial number of the',0Ah
		db '         smartcard.  If the serial number is not known a single',0Ah
		db '         dash ',27h,'-',27h,' is used instead.',0Ah
		db 0Ah
		db 'IDSTR is the IDSTR used to distinguish keys on a smartcard.  If i'
		db 't',0Ah
		db '      is not known a dash is used instead.',0Ah
		db 0Ah
		db 'FPR returns the formatted ssh-style fingerprint of the key.  It i'
		db 's only',0Ah
		db '    printed if the option --ssh-fpr has been used.  It defaults t'
		db 'o ',27h,'-',27h,'.',0Ah
		db 0Ah
		db 'TTL is the TTL in seconds for that key or ',27h,'-',27h,' if n/a.',0Ah
		db 0Ah
		db 'FLAGS is a word consisting of one-letter flags:',0Ah
		db '      ',27h,'D',27h,' - The key has been disabled,',0Ah
		db '      ',27h,'S',27h,' - The key is listed in sshcontrol (requires --wit'
		db 'h-ssh),',0Ah
		db '      ',27h,'c',27h,' - Use of the key needs to be confirmed,',0Ah
		db '      ',27h,'-',27h,' - No flags given.',0Ah
		db 0Ah
		db 'More information may be added in the future.',0
aD_0		db '%d',0               ; DATA XREF: sub_406B69+A3o
off_4407DF	dd offset aHereIsAnExampl ; DATA XREF: sub_406B69:loc_406C29o
					; sub_406B69+179o ...
					; "  Here is an	example	transaction:\n\n  "...
byte_4407E3	db 53h			; DATA XREF: sub_406B69+10Do
		db 0
byte_4407E5	db 63h,	0		; DATA XREF: sub_406B69+142o
byte_4407E7	db 54h			; DATA XREF: sub_406B69:loc_406D23o
		db 0
; char asc_4407E9[2]
asc_4407E9	db 'X',0                ; DATA XREF: sub_406B69:loc_406D2Co
					; sub_4074BA+26Eo ...
aKeyinfo	db 'KEYINFO',0          ; DATA XREF: sub_406B69+2BDo
					; .data:0043D404o
aSSSSSSS	db '%s %s %s %s - - %s %s %s',0Ah,0 ; DATA XREF: sub_406B69+333o
; char aSshList[]
aSshList	db '--ssh-list',0       ; DATA XREF: sub_406F3A+27o
; char aList[]
aList		db '--list',0           ; DATA XREF: sub_406F3A:loc_406F81o
; char aData[]
aData		db '--data',0           ; DATA XREF: sub_406F3A:loc_406F97o
					; sub_4074BA+4Fo
; char aSshFpr[]
aSshFpr		db '--ssh-fpr',0        ; DATA XREF: sub_406F3A+73o
; char aWithSsh[]
aWithSsh	db '--with-ssh',0       ; DATA XREF: sub_406F3A+89o
aPrivateKeysV_0	db 'private-keys-v1.d',0 ; DATA XREF: sub_406F3A+19Bo
a_key		db '.key',0             ; DATA XREF: sub_406F3A+236o
; char aCommandKeyinfo[]
aCommandKeyinfo	db 'command keyinfo failed: %s',0Ah,0 ; DATA XREF: sub_406F3A+4AAo
		align 20h
aGet_passphra_0	db 'GET_PASSPHRASE [--data] [--check] [--no-ask] [--repeat[=N]]',0Ah
					; DATA XREF: .data:0043D478o
		db '               [--qualitybar] <cache_id>',0Ah
		db '               [<error_message> <prompt> <description>]',0Ah
		db 0Ah
		db 'This function is usually used to ask for a passphrase to be used',0Ah
		db 'for conventional encryption, but may also be used by programs whi'
		db 'ch',0Ah
		db 'need specal handling of passphrases.  This command uses a syntax',0Ah
		db 'which helps clients to use the agent with minimum effort.  The',0Ah
		db 'agent either returns with an error or with a OK followed by the h'
		db 'ex',0Ah
		db 'encoded passphrase.  Note that the length of the strings is',0Ah
		db 'implicitly limited by the maximum length of a command.',0Ah
		db 0Ah
		db 'If the option "--data" is used the passphrase is returned by usua'
		db 'l',0Ah
		db 'data lines and not on the okay line.',0Ah
		db 0Ah
		db 'If the option "--check" is used the passphrase constraints checks'
		db ' as',0Ah
		db 'implemented by gpg-agent are applied.  A check is not done if the'
		db 0Ah
		db 'passphrase has been found in the cache.',0Ah
		db 0Ah
		db 'If the option "--no-ask" is used and the passphrase is not in the'
		db 0Ah
		db 'cache the user will not be asked to enter a passphrase but the er'
		db 'ror',0Ah
		db 'code GPG_ERR_NO_DATA is returned.  ',0Ah
		db 0Ah
		db 'If the option "--qualitybar" is used a visual indication of the',0Ah
		db 'entered passphrase quality is shown.  (Unless no minimum passphra'
		db 'se',0Ah
		db 'length has been configured.)',0
		align 4
; char aPleaseReEnterT[]
aPleaseReEnterT	db 'Please re-enter this passphrase',0 ; DATA XREF: sub_4074BA+32o
; char aCheck[]
aCheck		db '--check',0          ; DATA XREF: sub_4074BA+65o
; char aNoAsk[]
aNoAsk		db '--no-ask',0         ; DATA XREF: sub_4074BA+7Bo
; char aRepeat[]
aRepeat		db '--repeat',0         ; DATA XREF: sub_4074BA+91o
					; sub_4074BA+A8o
; char aQualitybar[]
aQualitybar	db '--qualitybar',0     ; DATA XREF: sub_4074BA:loc_407595o
aInvalidLengt_0	db 'invalid length of cacheID',0 ; DATA XREF: sub_4074BA+21Fo
					; sub_407A76+9Ao
; char aDoesNotMatchTr[]
aDoesNotMatchTr	db 'does not match - try again',0 ; DATA XREF: sub_4074BA+4EBo
; char aCommandGet_pas[]
aCommandGet_pas	db 'command get_passphrase failed: %s',0Ah,0 ; DATA XREF: sub_4074BA+5A6o
		align 20h
aClear_passph_0	db 'CLEAR_PASSPHRASE <cache_id>',0Ah ; DATA XREF: .data:0043D490o
		db 0Ah
		db 'may be used to invalidate the cache entry for a passphrase.  The',0Ah
		db 'function returns with OK even when there is no cached passphrase.'
		db 0
aGet_confirma_0	db 'GET_CONFIRMATION <description>',0Ah ; DATA XREF: .data:0043D49Co
		db 0Ah
		db 'This command may be used to ask for a simple confirmation.',0Ah
		db 'DESCRIPTION is displayed along with a Okay and Cancel button.  Th'
		db 'is',0Ah
		db 'command uses a syntax which helps clients to use the agent with',0Ah
		db 'minimum effort.  The agent either returns with an error or with a'
		db 0Ah
		db 'OK.  Note, that the length of DESCRIPTION is implicitly limited b'
		db 'y',0Ah
		db 'the maximum length of a command. DESCRIPTION should not contain',0Ah
		db 'any spaces, those must be encoded either percent escaped or simpl'
		db 'y',0Ah
		db 'as ',27h,'+',27h,'.',0
		align 10h
; char aCommandGet_con[]
aCommandGet_con	db 'command get_confirmation failed: %s',0Ah,0 ; DATA XREF: sub_407B71+102o
		align 10h
aLearnSendLearn	db 'LEARN [--send]',0Ah ; DATA XREF: .data:0043D4C0o
		db 0Ah
		db 'Learn something about the currently inserted smartcard.  With',0Ah
		db '--send the new certificates are send back.',0
; char aSend[]
aSend		db '--send',0           ; DATA XREF: sub_407C84+14o
; char aCommandLearnFa[]
aCommandLearnFa	db 'command learn failed: %s',0Ah,0 ; DATA XREF: sub_407C84+5Co
		align 10h
aPasswdHexstrin	db 'PASSWD <hexstring_with_keygrip>',0Ah ; DATA XREF: .data:0043D4CCo
		db 0Ah
		db 'Change the passphrase/PIN for the key identified by keygrip in LI'
		db 'NE.',0
		align 4
; char aChangingASmart[]
aChangingASmart	db 'changing a smartcard PIN is not yet supported',0Ah,0
					; DATA XREF: sub_407CF1+AAo
; char aCommandPasswdF[]
aCommandPasswdF	db 'command passwd failed: %s',0Ah,0 ; DATA XREF: sub_407CF1+13Do
		align 10h
aPreset_passp_0	db 'PRESET_PASSPHRASE <string_or_keygrip> <timeout> <hexstring>',0Ah
					; DATA XREF: .data:0043D484o
		db 0Ah
		db 'Set the cached passphrase/PIN for the key identified by the keygr'
		db 'ip',0Ah
		db 'to passwd for the given time, where -1 means infinite and 0 means'
		db 0Ah
		db 'the default (currently only a timeout of -1 is allowed, which mea'
		db 'ns',0Ah
		db 'to never expire it).  If passwd is not provided, ask for it via t'
		db 'he',0Ah
		db 'pinentry module.',0
aNoAllowPresetP	db 'no --allow-preset-passphrase',0 ; DATA XREF: sub_407E3F+2Ao
aPassphraseIsRe	db 'passphrase is required',0 ; DATA XREF: sub_407E3F+1CCo
; char aCommandPreset_[]
aCommandPreset_	db 'command preset_passphrase failed: %s',0Ah,0 ; DATA XREF: sub_407E3F+225o
		align 10h
aScdCommandsToP	db 'SCD <commands to pass to the scdaemon>',0Ah ; DATA XREF: .data:0043D4F0o
		db ' ',0Ah
		db 'This is a general quote command to redirect everything to the',0Ah
		db 'SCdaemon.',0
		align 10h
aGetvalKeyRetur	db 'GETVAL <key>',0Ah   ; DATA XREF: .data:0043D4FCo
		db 0Ah
		db 'Return the value for KEY from the special environment as created '
		db 'by',0Ah
		db 'PUTVAL.',0
aTooManyArgumen	db 'too many arguments',0 ; DATA XREF: sub_4080AE+7Co
aNoKeyGiven	db 'no key given',0     ; DATA XREF: sub_4080AE+B4o
					; sub_408218+D9o
; char aCommandGetvalF[]
aCommandGetvalF	db 'command getval failed: %s',0Ah,0 ; DATA XREF: sub_4080AE+159o
		align 10h
aPutvalKeyPerce	db 'PUTVAL <key> [<percent_escaped_value>]',0Ah ; DATA XREF: .data:0043D508o
		db 0Ah
		db 'The gpg-agent maintains a kind of environment which may be used t'
		db 'o',0Ah
		db 'store key/value pairs in it, so that they can be retrieved later.'
		db 0Ah
		db 'This may be used by helper daemons to daemonize themself on',0Ah
		db 'invocation and register them with gpg-agent.  Callers of the',0Ah
		db 'daemon',27h,'s service may now first try connect to get the informat'
		db 'ion',0Ah
		db 'for that service from gpg-agent through the GETVAL command and th'
		db 'en',0Ah
		db 'try to connect to that daemon.  Only if that fails they may start'
		db 0Ah
		db 'an own instance of the service daemon. ',0Ah
		db 0Ah
		db 'KEY is an an arbitrary symbol with the same syntax rules as keys',0Ah
		db 'for shell environment variables.  PERCENT_ESCAPED_VALUE is the',0Ah
		db 'corresponsing value; they should be similar to the values of',0Ah
		db 'envronment variables but gpg-agent does not enforce any',0Ah
		db 'restrictions.  If that value is not given any value under that KE'
		db 'Y',0Ah
		db 'is removed from this special environment.',0
; char aCommandPutvalF[]
aCommandPutvalF	db 'command putval failed: %s',0Ah,0 ; DATA XREF: sub_408218+241o
		align 10h
aUpdatestartu_0	db 'UPDATESTARTUPTTY',0Ah ; DATA XREF: .data:0043D514o
		db 0Ah
		db 'Set startup TTY and X11 DISPLAY variables to the values of this',0Ah
		db 'session.  This command is useful to pull future pinentries to',0Ah
		db 'another screen.  It is only required because there is no way in t'
		db 'he',0Ah
		db 'ssh-agent protocol to convey this information.',0
		align 20h
aKillagentIfThe	db 'KILLAGENT',0Ah      ; DATA XREF: .data:0043D520o
		db 0Ah
		db 'If the agent has been started using a standard socket',0Ah
		db 'we allow a client to stop the agent.',0
aNoUseStandardS	db 'no --use-standard-socket',0 ; DATA XREF: sub_4085E1+29o
		align 10h
aReloadagentThi	db 'RELOADAGENT',0Ah    ; DATA XREF: .data:0043D52Co
		db 0Ah
		db 'This command is an alternative to SIGHUP',0Ah
		db 'to reload the configuration.',0
		align 10h
aGetinfoWhatMul	db 'GETINFO <what>',0Ah ; DATA XREF: .data:0043D538o
		db 0Ah
		db 'Multipurpose function to return a variety of information.',0Ah
		db 'Supported values for WHAT are:',0Ah
		db 0Ah
		db '  version     - Return the version of the program.',0Ah
		db '  pid         - Return the process id of the server.',0Ah
		db '  socket_name - Return the name of the socket.',0Ah
		db '  ssh_socket_name - Return the name of the ssh socket.',0Ah
		db '  scd_running - Return OK if the SCdaemon is already running.',0Ah
		db '  std_session_env - List the standard session environment.',0Ah
		db '  std_startup_env - List the standard startup environment.',0Ah
		db '  cmd_has_option',0Ah
		db '              - Returns OK if the command CMD implements the opti'
		db 'on OPT.',0
; char aVersion[]
aVersion	db 'version',0          ; DATA XREF: sub_408650+1Do
a2_0_30_0	db '2.0.30',0           ; DATA XREF: sub_408650+34o
; char aPid[]
aPid		db 'pid',0              ; DATA XREF: sub_408650:loc_4086C8o
aLu		db '%lu',0              ; DATA XREF: sub_408650+98o
					; sub_408650+237o
; char aSocket_name[]
aSocket_name	db 'socket_name',0      ; DATA XREF: sub_408650:loc_408740o
; char aSsh_socket_nam[]
aSsh_socket_nam	db 'ssh_socket_name',0  ; DATA XREF: sub_408650:loc_4087B6o
; char aScd_running[]
aScd_running	db 'scd_running',0      ; DATA XREF: sub_408650:loc_40882Co
; char aS2k_count[]
aS2k_count	db 's2k_count',0        ; DATA XREF: sub_408650:loc_408867o
; char aStd_session_en[]
aStd_session_en	db 'std_session_env',0  ; DATA XREF: sub_408650:loc_4088DFo
; char aStd_startup_en[]
aStd_startup_en	db 'std_startup_env',0  ; DATA XREF: sub_408650+2A6o
aSS		db '%s=%s',0            ; DATA XREF: sub_408650+319o
aCmd_has_option	db 'cmd_has_option',0   ; DATA XREF: sub_408650+3CDo
aUnknownValueFo	db 'unknown value for WHAT',0 ; DATA XREF: sub_408650+51Bo
; char aPutenv[]
aPutenv		db 'putenv',0           ; DATA XREF: sub_408B92+1Co
; char aDisplay_0[]
aDisplay_0	db 'display',0          ; DATA XREF: sub_408B92:loc_408BE2o
; char aDisplay_1[]
aDisplay_1	db 'DISPLAY',0          ; DATA XREF: sub_408B92+74o
					; .data:0043D54Co
; char aTtyname[]
aTtyname	db 'ttyname',0          ; DATA XREF: sub_408B92:loc_408C1Eo
; char aGpg_tty_0[]
aGpg_tty_0	db 'GPG_TTY',0          ; DATA XREF: sub_408B92+BDo
					; .data:off_43D548o
; char aTtytype[]
aTtytype	db 'ttytype',0          ; DATA XREF: sub_408B92:loc_408C67o
; char aTerm_0[]
aTerm_0		db 'TERM',0             ; DATA XREF: sub_408B92+106o
					; .data:0043D550o
; char aLcCtype[]
aLcCtype	db 'lc-ctype',0         ; DATA XREF: sub_408B92:loc_408CB0o
; char aLcMessages[]
aLcMessages	db 'lc-messages',0      ; DATA XREF: sub_408B92:loc_408D0Ao
; char aXauthority_0[]
aXauthority_0	db 'xauthority',0       ; DATA XREF: sub_408B92:loc_408D64o
; char aXauthority_1[]
aXauthority_1	db 'XAUTHORITY',0       ; DATA XREF: sub_408B92+1F6o
					; .data:0043D554o
; char aPinentryUserDa[]
aPinentryUserDa	db 'pinentry-user-data',0 ; DATA XREF: sub_408B92:loc_408DA0o
; char aPinentry_use_0[]
aPinentry_use_0	db 'PINENTRY_USER_DATA',0 ; DATA XREF: sub_408B92+232o
					; .data:0043D558o
; char aUseCacheForSig[]
aUseCacheForSig	db 'use-cache-for-signing',0 ; DATA XREF: sub_408B92:loc_408DD9o
; char aAllowPinentryN[]
aAllowPinentryN	db 'allow-pinentry-notify',0 ; DATA XREF: sub_408B92:loc_408E17o
aGeteventcounte	db 'GETEVENTCOUNTER',0  ; DATA XREF: sub_408E78+2Do
					; .data:off_43D3E0o
; char aGet_passphrase[]
aGet_passphrase	db 'GET_PASSPHRASE',0   ; DATA XREF: sub_408F0D+6o
					; .data:0043D470o
; char aRepeat_0[]
aRepeat_0	db 'repeat',0           ; DATA XREF: sub_408F0D+1Do
		align 4
; char aFailedToAlloca[]
aFailedToAlloca	db 'failed to allocate assuan context: %s',0Ah,0 ; DATA XREF: sub_40901E+30o
		align 4
; char aFailedToInitia[]
aFailedToInitia	db 'failed to initialize the server: %s',0Ah,0 ; DATA XREF: sub_40901E+E0o
		align 4
; char aFailedToRegist[]
aFailedToRegist	db 'failed to register commands with Assuan: %s',0Ah,0
					; DATA XREF: sub_40901E+11Bo
; char aAssuanAcceptPr[]
aAssuanAcceptPr	db 'Assuan accept problem: %s',0Ah,0 ; DATA XREF: sub_40901E+1ECo
; char aAssuanProcessi[]
aAssuanProcessi	db 'Assuan processing failed: %s',0Ah,0 ; DATA XREF: sub_40901E+21Do
aIstrusted	db 'ISTRUSTED',0        ; DATA XREF: .data:0043D3ECo
aHavekey	db 'HAVEKEY',0          ; DATA XREF: .data:0043D3F8o
aSigkey		db 'SIGKEY',0           ; DATA XREF: .data:0043D410o
aSetkey		db 'SETKEY',0           ; DATA XREF: .data:0043D41Co
aSetkeydesc	db 'SETKEYDESC',0       ; DATA XREF: .data:0043D428o
aSethash	db 'SETHASH',0          ; DATA XREF: .data:0043D434o
aPksign		db 'PKSIGN',0           ; DATA XREF: .data:0043D440o
aPkdecrypt	db 'PKDECRYPT',0        ; DATA XREF: .data:0043D44Co
aGenkey		db 'GENKEY',0           ; DATA XREF: .data:0043D458o
aReadkey	db 'READKEY',0          ; DATA XREF: .data:0043D464o
aPreset_passphr	db 'PRESET_PASSPHRASE',0 ; DATA XREF: .data:0043D47Co
aClear_passphra	db 'CLEAR_PASSPHRASE',0 ; DATA XREF: .data:0043D488o
aGet_confirmati	db 'GET_CONFIRMATION',0 ; DATA XREF: .data:0043D494o
aListtrusted	db 'LISTTRUSTED',0      ; DATA XREF: .data:0043D4A0o
aMarktrusted	db 'MARKTRUSTED',0      ; DATA XREF: .data:0043D4ACo
aLearn		db 'LEARN',0            ; DATA XREF: .data:0043D4B8o
aPasswd		db 'PASSWD',0           ; DATA XREF: .data:0043D4C4o
aInput		db 'INPUT',0            ; DATA XREF: .data:0043D4D0o
aOutput		db 'OUTPUT',0           ; DATA XREF: .data:0043D4DCo
off_441FC3	dd offset aShadowedPriv_1 ; DATA XREF: .data:0043D4E8o
					; "shadowed-private-key"
aGetval		db 'GETVAL',0           ; DATA XREF: .data:0043D4F4o
aPutval		db 'PUTVAL',0           ; DATA XREF: .data:0043D500o
aUpdatestartupt	db 'UPDATESTARTUPTTY',0 ; DATA XREF: .data:0043D50Co
aKillagent	db 'KILLAGENT',0        ; DATA XREF: .data:0043D518o
aReloadagent	db 'RELOADAGENT',0      ; DATA XREF: .data:0043D524o
aGetinfo	db 'GETINFO',0          ; DATA XREF: .data:0043D530o
		align 20h
aListOfAllowedS	db '# List of allowed ssh keys.  Only keys present in this file are u'
					; DATA XREF: sub_409A11+114o
		db 'sed',0Ah
		db '# in the SSH protocol.  The ssh-add tool may add new entries to t'
		db 'his',0Ah
		db '# file to enable them; you may also add them manually.  Comment',0Ah
		db '# lines, like this one, as well as empty lines are ignored.  Line'
		db 's do',0Ah
		db '# have a certain length limit but this is not serious limitation '
		db 'as',0Ah
		db '# the format of the entries is fixed and checked by gpg-agent. A',0Ah
		db '# non-comment line starts with optional white spaces, followed by'
		db ' the',0Ah
		db '# keygrip of the key given as 40 hex digits, optionally followed '
		db 'by a',0Ah
		db '# caching TTL in seconds, and another optional field for arbitrar'
		db 'y',0Ah
		db '# flags.   Prepend the keygrip with an ',27h,'!',27h,' mark to disable '
		db 'it.',0Ah
		db 0Ah,0
aRequest_identi	db 'request_identities',0
aSign_request	db 'sign_request',0
aAdd_identity	db 'add_identity',0
aRemove_identit	db 'remove_identity',0
aRemove_all_ide	db 'remove_all_identities',0
aLock		db 'lock',0
aUnlock		db 'unlock',0
aSshRsa		db 'ssh-rsa',0          ; DATA XREF: .data:off_43D5E0o
aRsa_3		db 'rsa',0              ; DATA XREF: .data:0043D5E4o
; char aNedupq[]
aNedupq		db 'nedupq',0           ; DATA XREF: sub_40A6E7+6o
					; .data:0043D5E8o
aEn_1		db 'en',0               ; DATA XREF: .data:0043D5ECo
aS_5		db 's',0                ; DATA XREF: .data:0043D5F0o
aNedpqu		db 'nedpqu',0           ; DATA XREF: .data:0043D5F4o
aSshDss		db 'ssh-dss',0
aDsa_2		db 'dsa',0
aPqgyx_0	db 'pqgyx',0
aPqgy_1		db 'pqgy',0
aRs		db 'rs',0               ; DATA XREF: .data:0043D648o
aEcdsaSha2Nistp	db 'ecdsa-sha2-nistp256',0 ; DATA XREF: .data:0043D638o
aEcdsa_0	db 'ecdsa',0            ; DATA XREF: .data:0043D63Co
aQd		db 'qd',0               ; DATA XREF: .data:0043D640o
					; .data:0043D64Co
aQ		db 'q',0                ; DATA XREF: .data:0043D644o
; char aNistp256[]
aNistp256	db 'nistp256',0         ; DATA XREF: sub_40ACF4+328o
					; sub_40B3AB+B5o ...
aEcdsaSha2Nis_0	db 'ecdsa-sha2-nistp384',0
; char aNistp384[]
aNistp384	db 'nistp384',0         ; DATA XREF: sub_40ACF4+348o
					; sub_40B3AB:loc_40B480o ...
aEcdsaSha2Nis_1	db 'ecdsa-sha2-nistp521',0
; char aNistp521[]
aNistp521	db 'nistp521',0         ; DATA XREF: sub_40ACF4+368o
					; sub_40B3AB:loc_40B4A0o ...
		align 10h
; char aSshKeysGreater[]
aSshKeysGreater	db 'ssh keys greater than %d bits are not supported',0Ah,0
					; DATA XREF: sub_409755+40o
aRb		db 'rb',0               ; DATA XREF: sub_40990D+26o
aSshcontrol	db 'sshcontrol',0       ; DATA XREF: sub_409A11+3Fo
; char aA[]
aA		db 'a+',0               ; DATA XREF: sub_409A11+70o
					; sub_409A11+131o
aR_0		db 'r',0                ; DATA XREF: sub_409A11:loc_409A88o
					; sub_409A11:loc_409B49o
aWxModeRwR	db 'wx,mode=-rw-r',0    ; DATA XREF: sub_409A11+B3o
; char aCanTCreateSS[]
aCanTCreateSS	db 'can',27h,'t create `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_409A11+ECo
; char aCanTOpenSS[]
aCanTOpenSS	db 'can',27h,'t open `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_409A11+178o
		align 10h
; char aSDInvalidForma[]
aSDInvalidForma	db '%s:%d: invalid formatted line',0Ah,0 ; DATA XREF: sub_409C73+254o
		align 10h
; char aSDInvalidTtlVa[]
aSDInvalidTtlVa	db '%s:%d: invalid TTL value; assuming 0',0Ah,0 ; DATA XREF: sub_409C73+2CBo
; char asc_442486[]
asc_442486	db '= ',9,0Ah,0         ; DATA XREF: sub_409C73+33Ao
		align 4
; char aSDAssigningAVa[]
aSDAssigningAVa	db '%s:%d: assigning a value to a flag is not yet supported; flag ign'
					; DATA XREF: sub_409C73+370o
		db 'ored',0Ah,0
aConfirm	db 'confirm',0          ; DATA XREF: sub_409C73+390o
		align 4
; char aSDInvalidFlag_[]
aSDInvalidFlag_	db '%s:%d: invalid flag ',27h,'%.*s',27h,'; ignored',0Ah,0
					; DATA XREF: sub_409C73+3D4o
		align 4
; char a____Gnupg22__1[]
a____Gnupg22__1	db '../../gnupg2-2.0.30/agent/command-ssh.c',0 ; DATA XREF: sub_40A07F+33o
					; sub_40BD27+421o ...
; char aStrlenHexgrip4[]
aStrlenHexgrip4	db 'strlen (hexgrip) == 40',0 ; DATA XREF: sub_40A07F+3Bo
aConfirm_0	db ' confirm',0         ; DATA XREF: sub_40A173+9Co
dword_44254C	dd 0			; DATA XREF: sub_40A173:loc_40A216o
					; sub_40B3AB:loc_40B5D7o ...
; char aKeyAddedOn04d0[]
aKeyAddedOn04d0	db '# Key added on: %04d-%02d-%02d %02d:%02d:%02d',0Ah
					; DATA XREF: sub_40A173+E0o
		db '# Fingerprint:  %s',0Ah
		db '%s %d%s',0Ah,0
aPublicKey	db 'public-key',0       ; DATA XREF: sub_40AA39+7o
					; sub_40ACF4+7Do
aPrivateKey	db 'private-key',0      ; DATA XREF: sub_40AA39+Eo
					; sub_40ACF4+11Co
aAB		db 'a+b',0              ; DATA XREF: sub_40AA39+60o
aSS_0		db '(%s(%s',0           ; DATA XREF: sub_40AA39+B9o
aCurveS		db '(curve%s)',0        ; DATA XREF: sub_40AA39+107o
aCM		db '(%c%%m)',0          ; DATA XREF: sub_40AA39+147o
aCommentS	db ')(comment%s))',0    ; DATA XREF: sub_40AA39+1C5o
aProtectedPriva	db 'protected-private-key',0 ; DATA XREF: sub_40ACF4+ADo
aShadowedPrivat	db 'shadowed-private-key',0 ; DATA XREF: sub_40ACF4+DDo
aCurve		db 'curve',0            ; DATA XREF: sub_40ACF4+2B1o
; char aNistP256[]
aNistP256	db 'NIST P-256',0       ; DATA XREF: sub_40ACF4:loc_40B005o
					; sub_40B3AB+CCo
; char aNistP384[]
aNistP384	db 'NIST P-384',0       ; DATA XREF: sub_40ACF4:loc_40B025o
					; sub_40B3AB+ECo
; char aNistP521[]
aNistP521	db 'NIST P-521',0       ; DATA XREF: sub_40ACF4:loc_40B045o
					; sub_40B3AB+10Co
aComment	db 'comment',0          ; DATA XREF: sub_40ACF4+3D2o
					; sub_40C7DB+114o ...
aNone_0		db '(none)',0           ; DATA XREF: sub_40ACF4+411o
aR_1		db 'r+',0               ; DATA XREF: sub_40B6EE+2Do
					; sub_40BAC0+Do ...
; char aAuthkeyid[]
aAuthkeyid	db '$AUTHKEYID',0       ; DATA XREF: sub_40BD27+2Do
					; sub_40BD27+CAo
		align 4
; char aErrorGettingSe[]
aErrorGettingSe	db 'error getting serial number of card: %s',0Ah,0
					; DATA XREF: sub_40BD27+88o
					; sub_40BD27+155o
; char aDetectedCardWi[]
aDetectedCardWi	db 'detected card with S/N: %s',0Ah,0 ; DATA XREF: sub_40BD27+ABo
		align 4
; char aErrorGettingDe[]
aErrorGettingDe	db 'error getting default authentication keyID of card: %s',0Ah,0
					; DATA XREF: sub_40BD27+F3o
; char aSerialno[]
aSerialno	db 'SERIALNO',0         ; DATA XREF: sub_40BD27+12Co
		align 4
; char aNoSuitableCard[]
aNoSuitableCard	db 'no suitable card key found: %s',0Ah,0 ; DATA XREF: sub_40BD27+1B8o
; char aFailedToBuildS[]
aFailedToBuildS	db 'failed to build S-Exp from received card key: %s',0Ah,0
					; DATA XREF: sub_40BD27+24Do
		align 4
; char aErrorComputing[]
aErrorComputing	db 'error computing keygrip from received card key: %s',0Ah,0
					; DATA XREF: sub_40BD27+2ACo
; char aShadowingTheKe[]
aShadowingTheKe	db 'shadowing the key failed: %s',0Ah,0 ; DATA XREF: sub_40BD27+390o
; char aPkbuflen[]
aPkbuflen	db 'pkbuflen',0         ; DATA XREF: sub_40BD27+429o
; char aErrorWritingKe[]
aErrorWritingKe	db 'error writing key: %s',0Ah,0 ; DATA XREF: sub_40BD27+46Co
; char aDispserialno[]
aDispserialno	db '$DISPSERIALNO',0    ; DATA XREF: sub_40BD27+4C9o
aCardnoS	db 'cardno:%s',0        ; DATA XREF: sub_40BD27+4E7o
					; sub_40BD27+50Co
aRB		db 'r+b',0              ; DATA XREF: .text:0040C2EFo
					; sub_40E084+1CEo
aPrivateKeysV_1	db 'private-keys-v1.d',0 ; DATA XREF: .text:0040C3BCo
aStrlenCfItem_h	db 'strlen (cf->item.hexgrip) == 40',0 ; DATA XREF: .text:0040C4CDo
aSDKeySSkippedS	db '%s:%d: key ',27h,'%s',27h,' skipped: %s',0Ah,0
					; DATA XREF: .text:0040C546o
		align 4
; char aAnSshProcessRe[]
aAnSshProcessRe	db 'An ssh process requested the use of key%%0A  %s%%0A  (%s)%%0ADo y'
					; DATA XREF: sub_40C7DB+17Co
		db 'ou want to allow this?',0
; char aDeny[]
aDeny		db 'Deny',0             ; DATA XREF: sub_40C7DB+1B4o
; char aAllow[]
aAllow		db 'Allow',0            ; DATA XREF: sub_40C7DB+1C2o
		align 10h
; char aPleaseEnterThe[]
aPleaseEnterThe	db 'Please enter the passphrase for the ssh key%%0A  %F%%0A  (%c)',0
					; DATA XREF: sub_40C7DB+212o
		align 10h
; char aPleaseReEnte_0[]
aPleaseReEnte_0	db 'Please re-enter this passphrase',0 ; DATA XREF: sub_40D199+19o
; char aPleaseEnterAPa[]
aPleaseEnterAPa	db 'Please enter a passphrase to protect the received secret key%%0A '
					; DATA XREF: sub_40D199+E0o
		db '  %s%%0A   %s%%0Awithin gpg-agent',27h,'s key storage',0
; char aDoesNotMatch_0[]
aDoesNotMatch_0	db 'does not match - try again',0 ; DATA XREF: sub_40D199+249o
; char a02x[]
a02x		db '%02X',0             ; DATA XREF: sub_40D199+2D0o
		align 4
; char aSshAgentSLockC[]
aSshAgentSLockC	db 'ssh-agent',27h,'s lock command is not implemented',0Ah,0
					; DATA XREF: sub_40D8C1+6o
		align 4
; char aSshAgentSUnloc[]
aSshAgentSUnloc	db 'ssh-agent',27h,'s unlock command is not implemented',0Ah,0
					; DATA XREF: sub_40D8DF+6o
		align 4
; char aSshRequestUIsN[]
aSshRequestUIsN	db 'ssh request %u is not supported',0Ah,0 ; DATA XREF: sub_40D98B+48o
		align 4
; char aReceivedSshReq[]
aReceivedSshReq	db 'received ssh request of length %u',0Ah,0 ; DATA XREF: sub_40D9FB+61o
		align 4
; char aSshRequestHand[]
aSshRequestHand	db 'ssh request handler for %s (%u) started',0Ah,0
					; DATA XREF: sub_40D9FB+22Co
					; sub_40E084+219o
		align 4
; char aSshRequestHa_0[]
aSshRequestHa_0	db 'ssh request handler for %s (%u) failed: %s',0Ah,0
					; DATA XREF: sub_40D9FB+28Co
					; sub_40E084+279o
; char aSshRequestHa_1[]
aSshRequestHa_1	db 'ssh request handler for %s (%u) ready',0Ah,0
					; DATA XREF: sub_40D9FB+2B1o
					; sub_40E084+29Eo
		align 4
; char aSendingSshResp[]
aSendingSshResp	db 'sending ssh response of length %u',0Ah,0 ; DATA XREF: sub_40D9FB+2EEo
					; sub_40E084+325o
		align 10h
; char aErrorOccuredWh[]
aErrorOccuredWh	db 'error occured while processing request: %s',0Ah,0
					; DATA XREF: sub_40D9FB+3A5o
; char aSendingSshErro[]
aSendingSshErro	db 'sending ssh error response',0Ah,0 ; DATA XREF: sub_40D9FB+3C1o
; char aErrorSettingDe[]
aErrorSettingDe	db 'error setting default session environment: %s',0Ah,0
					; DATA XREF: sub_40DE3A+10Do
		align 4
; char aFailedToCreate[]
aFailedToCreate	db 'failed to create stream from socket: %s',0Ah,0
					; DATA XREF: sub_40DF58+57o
		align 4
; char aFailedToDisabl[]
aFailedToDisabl	db 'failed to disable buffering on socket stream: %s',0Ah,0
					; DATA XREF: sub_40DF58+B7o
		align 4
; char aSshMessageLenU[]
aSshMessageLenU	db 'ssh message len (%u) out of range',0 ; DATA XREF: sub_40E084+8Ao
		align 4
; char aSnatchingSshRe[]
aSnatchingSshRe	db 'snatching ssh response failed: %s',0 ; DATA XREF: sub_40E084+2FCo
		align 10h
; char aInvalidLengt_1[]
aInvalidLengt_1	db 'invalid length of the ssh response: %s',0 ; DATA XREF: sub_40E084+34Eo
aGpg_tty_3	db 'GPG_TTY',0          ; DATA XREF: .data:off_43D6BCo
aDisplay_4	db 'DISPLAY',0          ; DATA XREF: .data:0043D6C0o
aTerm_2		db 'TERM',0             ; DATA XREF: .data:0043D6C4o
aXauthority_3	db 'XAUTHORITY',0       ; DATA XREF: .data:0043D6C8o
aPinentry_use_2	db 'PINENTRY_USER_DATA',0 ; DATA XREF: .data:0043D6CCo
		align 20h
; char aUnknownUnderW3[]
aUnknownUnderW3	db 'unknown under W32',0 ; DATA XREF: sub_40E584+6o
		align 4
aAgent_query_du	db 'agent_query_dump_state: entry_lock=',0 ; DATA XREF: .text:0040E59Fo
asc_442C78	db 0Ah,0		; DATA XREF: .text:0040E5B7o
		align 4
aAgent_query__0	db 'agent_query_dump_state: entry_ctx=%p pid=%ld popup_tid=%p',0Ah,0
					; DATA XREF: .text:0040E5E8o
		align 4
; char aFailedToReleas[]
aFailedToReleas	db 'failed to release the entry lock',0Ah,0 ; DATA XREF: sub_40E629+28o
aXauthority_2	db 'XAUTHORITY',0       ; DATA XREF: sub_40E682+3Co
aPinentry_use_1	db 'PINENTRY_USER_DATA',0 ; DATA XREF: sub_40E682+64o
; char aFailedToAcquir[]
aFailedToAcquir	db 'failed to acquire the pinentry lock: %s',0Ah,0
					; DATA XREF: sub_40E7CF+A5o
; char aStartingANewPi[]
aStartingANewPi	db 'starting a new PIN Entry',0Ah,0 ; DATA XREF: sub_40E7CF+FCo
		align 4
; char aErrorFlushingP[]
aErrorFlushingP	db 'error flushing pending output: %s',0Ah,0 ; DATA XREF: sub_40E7CF+14Do
; char aDisplay_2[]
aDisplay_2	db 'DISPLAY',0          ; DATA XREF: sub_40E7CF+1C8o
aDisplay_3	db '--display',0        ; DATA XREF: sub_40E7CF+1E1o
		align 4
; char aCanTAllocate_0[]
aCanTAllocate_0	db 'can',27h,'t allocate assuan context: %s',0Ah,0
					; DATA XREF: sub_40E7CF+285o
		align 4
; char aCanTConnectT_0[]
aCanTConnectT_0	db 'can',27h,'t connect to the PIN entry module: %s',0Ah,0
					; DATA XREF: sub_40E7CF+2EBo
		align 4
; char aConnectionToPi[]
aConnectionToPi	db 'connection to PIN entry established',0Ah,0 ; DATA XREF: sub_40E7CF+331o
aOptionNoGrab	db 'OPTION no-grab',0   ; DATA XREF: sub_40E7CF+346o
aOptionGrab	db 'OPTION grab',0      ; DATA XREF: sub_40E7CF:loc_40EB1Co
; char aGpg_tty_1[]
aGpg_tty_1	db 'GPG_TTY',0          ; DATA XREF: sub_40E7CF+3B3o
aOptionTtynameS	db 'OPTION ttyname=%s',0 ; DATA XREF: sub_40E7CF+3D7o
; char aTerm_1[]
aTerm_1		db 'TERM',0             ; DATA XREF: sub_40E7CF+46Eo
aOptionTtytypeS	db 'OPTION ttytype=%s',0 ; DATA XREF: sub_40E7CF+492o
aOptionLcCtypeS	db 'OPTION lc-ctype=%s',0 ; DATA XREF: sub_40E7CF+53Bo
aOptionLcMessag	db 'OPTION lc-messages=%s',0 ; DATA XREF: sub_40E7CF+5E4o
		align 10h
aOptionAllowExt	db 'OPTION allow-external-password-cache',0 ; DATA XREF: sub_40E7CF+6B3o
aOptionDefaultS	db 'OPTION default-%s=%s',0 ; DATA XREF: sub_40E7CF+769o
aDevNull	db '/dev/null',0        ; DATA XREF: sub_40E7CF+813o
aOptionTouchFil	db 'OPTION touch-file=%s',0 ; DATA XREF: sub_40E7CF+85Ao
aGetinfoPid_0	db 'GETINFO pid',0      ; DATA XREF: sub_40E7CF+8F4o
		align 4
; char aYouMayWantToUp[]
aYouMayWantToUp	db 'You may want to update to a newer pinentry',0Ah,0
					; DATA XREF: sub_40E7CF+90Do
; char aPinentryDidNot[]
aPinentryDidNot	db 'pinentry did not return a PID',0Ah,0 ; DATA XREF: sub_40E7CF+930o
		align 4
; char aFailedToRele_0[]
aFailedToRele_0	db 'failed to release the entry lock at %d',0Ah,0
					; DATA XREF: sub_40F15F+FBo
aQuality	db 'QUALITY',0          ; DATA XREF: sub_40F547+13o
aD		db '%d',0               ; DATA XREF: sub_40F547+C4o
		align 4
; char aUnsupportedInq[]
aUnsupportedInq	db 'unsupported inquiry `%s',27h,' from pinentry',0Ah,0
					; DATA XREF: sub_40F547+12Bo
; char aQuality_0[]
aQuality_0	db 'Quality:',0         ; DATA XREF: sub_40F697+Bo
; char byte_442F79[]
byte_442F79	db 9, 0Dh, 0Ah		; DATA XREF: sub_40F697+17o
					; sub_40F697:loc_40F7D3o
		db 0Ch,	0Bh, 0
byte_442F7F	db 0			; DATA XREF: sub_40F697:loc_40F6CCo
					; sub_40F697:loc_40F7FFo
aSetqualitybarS	db 'SETQUALITYBAR %s',0 ; DATA XREF: sub_40F697+3Eo
; char aPinentry_quali[]
aPinentry_quali	db 'pinentry.qualitybar.tooltip',0 ; DATA XREF: sub_40F697+E3o
					; sub_40F697:loc_40F797o ...
		align 10h
aTheQualityOfTh	db 'The quality of the text entered above.',0Ah ; DATA XREF: sub_40F697+135o
		db 'Please ask your administrator for details about the criteria.',0
aSetqualitybar_	db 'SETQUALITYBAR_TT %s',0 ; DATA XREF: sub_40F697+171o
aPassword_from_	db 'PASSWORD_FROM_CACHE',0 ; DATA XREF: sub_40F8B1+13o
		align 10h
; char aPleaseEnterYou[]
aPleaseEnterYou	db 'Please enter your PIN, so that the secret key can be unlocked for'
					; DATA XREF: sub_40F902+5Do
		db ' this session',0
		align 10h
; char aPleaseEnterY_0[]
aPleaseEnterY_0	db 'Please enter your passphrase, so that the secret key can be unloc'
					; DATA XREF: sub_40F902+74o
		db 'ked for this session',0
; char SubStr[]
SubStr		db 'PIN',0              ; DATA XREF: sub_40F902+89o
					; sub_40F902+AFo ...
aSetkeyinfoCS	db 'SETKEYINFO %c/%s',0 ; DATA XREF: sub_40F902+133o
					; sub_4100EE+C3o
aSetkeyinfoClea	db 'SETKEYINFO --clear',0 ; DATA XREF: sub_40F902:loc_40FA55o
					; sub_4100EE:loc_4101D1o
aSetdescS	db 'SETDESC %s',0       ; DATA XREF: sub_40F902+1EAo
					; sub_4100EE+180o ...
aPin_0		db 'PIN:',0             ; DATA XREF: sub_40F902+278o
aPassphrase	db 'Passphrase:',0      ; DATA XREF: sub_40F902:loc_40FB81o
aSetpromptS	db 'SETPROMPT %s',0     ; DATA XREF: sub_40F902+28Do
					; sub_4100EE+229o
aSeterrorS	db 'SETERROR %s',0      ; DATA XREF: sub_40F902+351o
					; sub_4100EE+2E9o
; char aSeterrorSTryDO[]
aSeterrorSTryDO	db 'SETERROR %s (try %d of %d)',0 ; DATA XREF: sub_40F902+429o
aGetpin		db 'GETPIN',0           ; DATA XREF: sub_40F902+533o
					; sub_4100EE+420o
; char aPinTooLong[]
aPinTooLong	db 'PIN too long',0     ; DATA XREF: sub_40F902+5BFo
					; sub_40F902+66Do
; char aPassphraseTooL[]
aPassphraseTooL	db 'Passphrase too long',0 ; DATA XREF: sub_40F902:loc_40FECFo
; char aInvalidCharact[]
aInvalidCharact	db 'Invalid characters in PIN',0 ; DATA XREF: sub_40F902+61Do
; char aPinTooShort[]
aPinTooShort	db 'PIN too short',0    ; DATA XREF: sub_40F902+6AFo
; char aBadPin[]
aBadPin		db 'Bad PIN',0          ; DATA XREF: sub_40F902+732o
; char aBadPassphrase[]
aBadPassphrase	db 'Bad Passphrase',0   ; DATA XREF: sub_40F902:loc_410042o
; char aPassphrase_0[]
aPassphrase_0	db 'Passphrase',0       ; DATA XREF: sub_4100EE:loc_410159o
aReset		db 'RESET',0            ; DATA XREF: sub_4100EE:loc_41028Eo
					; sub_4105B0:loc_410602o ...
aSetokS		db 'SETOK %s',0         ; DATA XREF: sub_4105B0+12Ao
					; sub_41091D+12Ao ...
aSetnotokS	db 'SETNOTOK %s',0      ; DATA XREF: sub_4105B0+1C3o
aSetcancelS	db 'SETCANCEL %s',0     ; DATA XREF: sub_4105B0+251o
aConfirm_1	db 'CONFIRM',0          ; DATA XREF: sub_4105B0+308o
aConfirmOneButt	db 'CONFIRM --one-button',0 ; DATA XREF: sub_41091D+1E1o
					; sub_410B63+3Bo
aPopupMessage	db 'popup-message',0    ; DATA XREF: sub_410BBF+1A5o
		align 4
; char aErrorSpawnin_1[]
aErrorSpawnin_1	db 'error spawning popup message handler: %s',0Ah,0
					; DATA XREF: sub_410BBF+210o
		align 10h
; char aAgent_popup_me[]
aAgent_popup_me	db 'agent_popup_message_stop called with no active popup',0Ah,0
					; DATA XREF: sub_410E05:loc_410E1Do
		align 4
; char aAgent_popup__0[]
aAgent_popup__0	db 'agent_popup_message_stop: pth_join failed: %s',0Ah,0
					; DATA XREF: sub_410E05+A5o
aClearpassphras	db 'CLEARPASSPHRASE %c/%s',0 ; DATA XREF: sub_410ED8+78o
aOk		db 'ok',0               ; DATA XREF: .data:off_43D6E0o
aPinentryLabel_	db '|pinentry-label|_OK',0 ; DATA XREF: .data:0043D6E4o
aCancel		db 'cancel',0           ; DATA XREF: .data:0043D6ECo
aPinentryLabe_0	db '|pinentry-label|_Cancel',0 ; DATA XREF: .data:0043D6F0o
aYes_0		db 'yes',0              ; DATA XREF: .data:0043D6F8o
aPinentryLabe_1	db '|pinentry-label|_Yes',0 ; DATA XREF: .data:0043D6FCo
aNo_1		db 'no',0               ; DATA XREF: .data:0043D704o
aPinentryLabe_2	db '|pinentry-label|_No',0 ; DATA XREF: .data:0043D708o
aPrompt		db 'prompt',0           ; DATA XREF: .data:0043D710o
aPinentryLabelP	db '|pinentry-label|PIN:',0 ; DATA XREF: .data:0043D714o
aPwmngr		db 'pwmngr',0           ; DATA XREF: .data:0043D71Co
		align 4
aPinentryLabe_3	db '|pinentry-label|_Save in password manager',0
					; DATA XREF: .data:0043D720o
aCfVisi		db 'cf-visi',0          ; DATA XREF: .data:0043D728o
		align 4
aDoYouReallyWan	db 'Do you really want to make your passphrase visible on the screen?'
					; DATA XREF: .data:0043D72Co
		db 0
aTtVisi		db 'tt-visi',0          ; DATA XREF: .data:0043D734o
		align 4
aPinentryTtMake	db '|pinentry-tt|Make passphrase visible',0 ; DATA XREF: .data:0043D738o
aTtHide		db 'tt-hide',0          ; DATA XREF: .data:0043D740o
aPinentryTtHide	db '|pinentry-tt|Hide passphrase',0 ; DATA XREF: .data:0043D744o
		align 4
; char aExpiredSDsAfte[]
aExpiredSDsAfte	db '  expired `%s',27h,' (%ds after last access)',0Ah,0
					; DATA XREF: sub_411036+6Co
; char aExpiredSLusAft[]
aExpiredSLusAft	db '  expired `%s',27h,' (%lus after creation)',0Ah,0
					; DATA XREF: sub_411036+11Bo
		align 4
; char aCanTRemoveUnus[]
aCanTRemoveUnus	db 'can',27h,'t remove unused cache entry `%s',27h,' due to lockcount=%d',0Ah,0
					; DATA XREF: sub_411036+1BCo
		align 10h
; char aRemovedSSlotNo[]
aRemovedSSlotNo	db '  removed `%s',27h,' (slot not used for 30m)',0Ah,0
					; DATA XREF: sub_411036+208o
; char aAgent_flush_ca[]
aAgent_flush_ca	db 'agent_flush_cache',0Ah,0 ; DATA XREF: sub_41128F+12o
; char aFlushingS[]
aFlushingS	db '  flushing `%s',27h,0Ah,0 ; DATA XREF: sub_41128F+55o
; char aMarkedSForFlus[]
aMarkedSForFlus	db '    marked `%s',27h,' for flushing',0Ah,0 ; DATA XREF: sub_41128F+AFo
		align 4
; char aAgent_put_cach[]
aAgent_put_cach	db 'agent_put_cache `%s',27h,' requested ttl=%d mode=%d',0Ah,0
					; DATA XREF: sub_411372+28o
		align 4
; char aOutOfCoreWhile[]
aOutOfCoreWhile	db 'out of core while allocating new cache item',0Ah,0
					; DATA XREF: sub_411372+152o
					; sub_411372+238o
		align 4
; char aOutOfCoreWhi_0[]
aOutOfCoreWhi_0	db 'out of core while allocating new cache control',0Ah,0
					; DATA XREF: sub_411372+1A8o
; char aAgent_get_cach[]
aAgent_get_cach	db 'agent_get_cache `%s',27h,'...',0Ah,0 ; DATA XREF: sub_4115E1+29o
; char a___Hit[]
a___Hit		db '... hit',0Ah,0      ; DATA XREF: sub_4115E1+88o
; char a___HitLocked[]
a___HitLocked	db '... hit (locked)',0Ah,0 ; DATA XREF: sub_4115E1+10Fo
; char a___Miss[]
a___Miss	db '... miss',0Ah,0     ; DATA XREF: sub_4115E1+157o
		align 4
; char aTryingToUnlock[]
aTryingToUnlock	db 'trying to unlock non-locked cache entry `%s',27h,0Ah,0
					; DATA XREF: sub_411754+2Eo
		align 4
a____Gnupg22__2	db '../../gnupg2-2.0.30/agent/../common/util.h',0
					; DATA XREF: sub_41182D+52o
a_key_0		db '.key',0             ; DATA XREF: sub_4118C7+20o
					; sub_4123C2+2Fo ...
aPrivateKeysV_2	db 'private-keys-v1.d',0 ; DATA XREF: sub_4118C7+4Ao
					; sub_4123C2+5Fo ...
		align 10h
; char aSecretKeyFileS[]
aSecretKeyFileS	db 'secret key file `%s',27h,' already exists',0Ah,0
					; DATA XREF: sub_4118C7+81o
; char aWb[]
aWb		db 'wb',0               ; DATA XREF: sub_4118C7:loc_4119ABo
; char aCanTCreateSS_0[]
aCanTCreateSS_0	db 'can',27h,'t create `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4118C7+161o
; char aErrorWritingSS[]
aErrorWritingSS	db 'error writing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4118C7+1DEo
; char aErrorClosingSS[]
aErrorClosingSS	db 'error closing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4118C7+25Ao
		align 10h
; char a____Gnupg22__3[]
a____Gnupg22__3	db '../../gnupg2-2.0.30/agent/findkey.c',0 ; DATA XREF: sub_411B5F+29o
					; sub_411DB2+252o ...
; char aArgUnprotected[]
aArgUnprotected	db '!arg->unprotected_key',0 ; DATA XREF: sub_411B5F+31o
		align 4
; char aNoteThisPassph[]
aNoteThisPassph	db 'Note: This passphrase has never been changed.%0APlease change it '
					; DATA XREF: sub_411B5F+B2o
		db 'now.',0
		align 4
; char aThisPassphrase[]
aThisPassphrase	db 'This passphrase has not been changed%%0Asince %.4s-%.2s-%.2s.  Pl'
					; DATA XREF: sub_411B5F+135o
		db 'ease change it now.',0
; char aChangePassphra[]
aChangePassphra	db 'Change passphrase',0 ; DATA XREF: sub_411B5F+18Ao
					; sub_411B5F+1E1o
; char aILlChangeItLat[]
aILlChangeItLat	db 'I',27h,'ll change it later',0 ; DATA XREF: sub_411B5F:loc_411D32o
; char aResultOut_lenO[]
aResultOut_lenO	db '*result + out_len == out',0 ; DATA XREF: sub_411DB2+25Ao
; char aArg_unprotecte[]
aArg_unprotecte	db 'arg.unprotected_key',0 ; DATA XREF: sub_41202E+1CAo
					; sub_41202E+1F8o
		align 10h
; char aFailedToBuil_0[]
aFailedToBuil_0	db 'failed to build S-Exp (off=%u): %s',0Ah,0 ; DATA XREF: sub_41202E+269o
					; sub_4123C2+24Eo ...
; char aChangingThePas[]
aChangingThePas	db 'changing the passphrase failed: %s',0Ah,0 ; DATA XREF: sub_41202E+2EEo
; char aRb_0[]
aRb_0		db 'rb',0               ; DATA XREF: sub_4123C2+72o
; char aCanTOpenSS_0[]
aCanTOpenSS_0	db 'can',27h,'t open `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4123C2+C5o
; char aCanTStatSS[]
aCanTStatSS	db 'can',27h,'t stat `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4123C2+128o
; char aErrorReadingSS[]
aErrorReadingSS	db 'error reading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4123C2+1BCo
aComment_0	db 'comment',0          ; DATA XREF: sub_412630+ABo
					; sub_4129F5+407o
byte_443895	db 3 dup(0)		; DATA XREF: sub_412630:loc_412730o
; char aFailedToUnprot[]
aFailedToUnprot	db 'failed to unprotect the secret key: %s',0Ah,0
					; DATA XREF: sub_412630+179o
; char aN[]
aN		db 'n',0                ; DATA XREF: sub_412630+1FAo
					; sub_4131E4+131o
; char aGet_shadow_inf[]
aGet_shadow_inf	db 'get_shadow_info failed: %s',0Ah,0 ; DATA XREF: sub_412630+26Bo
; char aInvalidPrivate[]
aInvalidPrivate	db 'invalid private key format',0Ah,0 ; DATA XREF: sub_412630:loc_4128BAo
					; sub_4129F5+A6o
aShadowedPriv_0	db 'shadowed-private-key',0 ; DATA XREF: sub_4129F5+42o
aProtectedPri_0	db 'protected-private-key',0 ; DATA XREF: sub_4129F5+67o
aPrivateKey_0	db 'private-key',0      ; DATA XREF: sub_4129F5+8Co
aRsa		db 'rsa',0              ; DATA XREF: sub_4129F5+11Ao
					; sub_4129F5+131o
aNe		db 'ne',0               ; DATA XREF: sub_4129F5+138o
aDsa		db 'dsa',0              ; DATA XREF: sub_4129F5+154o
					; sub_4129F5+16Bo
aPqgy		db 'pqgy',0             ; DATA XREF: sub_4129F5+172o
aElg		db 'elg',0              ; DATA XREF: sub_4129F5+18Bo
					; sub_4129F5+1A2o
aPgy		db 'pgy',0              ; DATA XREF: sub_4129F5+1A9o
		align 4
; char aUnknownPrivate[]
aUnknownPrivate	db 'unknown private key algorithm',0Ah,0 ; DATA XREF: sub_4129F5:loc_412BA7o
aUri		db 'uri',0              ; DATA XREF: sub_4129F5+3B8o
; char aArgidxDimArgs[]
aArgidxDimArgs	db 'argidx < DIM (args)',0 ; DATA XREF: sub_4129F5+57Ao
					; sub_4129F5+6ABo
; char aArgidx1DimArgs[]
aArgidx1DimArgs	db 'argidx+1 < DIM (args)',0 ; DATA XREF: sub_4129F5+5F2o
					; sub_4129F5+65Bo
aGnupg_copy_tim	db 'gnupg_copy_time',0  ; DATA XREF: sub_41182D:loc_41186Fo
		align 4
aDataFlagsPkcs1	db '(data (flags pkcs1) (hash %s %b))',0 ; DATA XREF: sub_4133FB+BFo
aDataFlagsRawVa	db '(data (flags raw) (value %m))',0 ; DATA XREF: sub_4133FB+118o
; char a____Gnupg22__4[]
a____Gnupg22__4	db '../../gnupg2-2.0.30/agent/pksign.c',0 ; DATA XREF: sub_41354E+97o
					; sub_41354E+111o ...
; char aI8[]
aI8		db 'i >= 8',0           ; DATA XREF: sub_41354E+9Fo
; char aNNframe[]
aNNframe	db 'n == nframe',0      ; DATA XREF: sub_41354E+119o
aDataFlagsRaw_0	db '(data (flags raw) (value %b))',0 ; DATA XREF: sub_41354E+133o
; char aFailedToReadTh[]
aFailedToReadTh	db 'failed to read the secret key',0Ah,0 ; DATA XREF: sub_4136B7+80o
; char aSmartcardSigni[]
aSmartcardSigni	db 'smartcard signing failed: %s',0Ah,0 ; DATA XREF: sub_4136B7+F9o
; char aLen_0[]
aLen_0		db 'len',0              ; DATA XREF: sub_4136B7+146o
					; sub_4139AE+93o ...
		align 4
; char aFailedToConver[]
aFailedToConver	db 'failed to convert sigbuf returned by divert_pksign into S-Exp: %s'
					; DATA XREF: sub_4136B7+19Ao
		db 0
; char aSkey[]
aSkey		db 'skey: ',0           ; DATA XREF: sub_4136B7+248o
; char aSigningFailedS[]
aSigningFailedS	db 'signing failed: %s',0Ah,0 ; DATA XREF: sub_4136B7+29Bo
; char aResult[]
aResult		db 'result: ',0         ; DATA XREF: sub_4136B7+2B5o
		align 4
; char aSpeculativeDec[]
aSpeculativeDec	db 'speculative decryption not yet supported',0Ah,0
					; DATA XREF: sub_413B27+37o
		align 4
; char aFailedToConv_0[]
aFailedToConv_0	db 'failed to convert ciphertext: %s',0Ah,0 ; DATA XREF: sub_413B27+90o
aKeygrip	db 'keygrip:',0         ; DATA XREF: sub_413B27+CEo
aCipher		db 'cipher: ',0         ; DATA XREF: sub_413B27+E8o
; char aFailedToRead_0[]
aFailedToRead_0	db 'failed to read the secret key',0Ah,0 ; DATA XREF: sub_413B27:loc_413C84o
		align 4
; char aSmartcardDecry[]
aSmartcardDecry	db 'smartcard decryption failed: %s',0Ah,0 ; DATA XREF: sub_413B27+1F2o
; char a5ValueU[]
a5ValueU	db '(5:value%u:',0      ; DATA XREF: sub_413B27+206o
asc_443B99	db ')',0                ; DATA XREF: sub_413B27+274o
					; sub_413B27+3F0o
; char aDecryptionFail[]
aDecryptionFail	db 'decryption failed: %s',0Ah,0 ; DATA XREF: sub_413B27+2BDo
; char aPlain[]
aPlain		db 'plain: ',0          ; DATA XREF: sub_413B27+2DAo
		align 4
; char a____Gnupg22__5[]
a____Gnupg22__5	db '../../gnupg2-2.0.30/agent/pkdecrypt.c',0 ; DATA XREF: sub_413B27+326o
					; sub_413B27+37Bo
; char aLen_1[]
aLen_1		db 'len',0              ; DATA XREF: sub_413B27+32Eo
					; sub_413B27+383o
a5Value		db '(5:value',0         ; DATA XREF: sub_413B27+3BCo
		align 10h
; char aCanTCalculateK[]
aCanTCalculateK	db 'can',27h,'t calculate keygrip',0Ah,0 ; DATA XREF: sub_413FD4+1Co
		align 4
; char a____Gnupg22__6[]
a____Gnupg22__6	db '../../gnupg2-2.0.30/agent/genkey.c',0 ; DATA XREF: sub_413FD4+6Eo
					; sub_413FD4+D3o ...
; char aLen_2[]
aLen_2		db 'len',0              ; DATA XREF: sub_413FD4+76o
					; sub_413FD4+DBo ...
		align 4
; char aErrorCreatingT[]
aErrorCreatingT	db 'error creating temporary file: %s',0Ah,0 ; DATA XREF: sub_414196+41o
		align 4
; char aErrorWritingTo[]
aErrorWritingTo	db 'error writing to temporary file: %s',0Ah,0 ; DATA XREF: sub_414196+BAo
aNull		db '--null',0           ; DATA XREF: sub_414196+FCo
asc_443C84	db '--',0               ; DATA XREF: sub_414196+10Bo
; char aISizeofArgv[]
aISizeofArgv	db 'i < sizeof argv',0  ; DATA XREF: sub_414196+14Bo
; char aEnterNewPassph[]
aEnterNewPassph	db 'Enter new passphrase',0 ; DATA XREF: sub_4143E4+Fo
					; sub_4143E4:loc_41442Fo
; char aTakeThisOneAny[]
aTakeThisOneAny	db 'Take this one anyway',0 ; DATA XREF: sub_414468+6o
byte_443CC1	db 3 dup(0)		; DATA XREF: sub_414492+1Co
aWarningYouHave	db 'Warning: You have entered an insecure passphrase.%%0AA passphrase'
					; DATA XREF: sub_414492+55o
		db ' should be at least %u characters long.',0
		align 10h
; char aWarningYouHa_0[]
aWarningYouHa_0	db 'Warning: You have entered an insecure passphrase.%%0AA passphrase'
					; DATA XREF: sub_414492+5Do
		db ' should be at least %u character long.',0
aWarningYouHa_1	db 'Warning: You have entered an insecure passphrase.%%0AA passphrase'
					; DATA XREF: sub_414492+EBo
		db ' should contain at least %u digits or%%0Aspecial characters.',0
		align 4
; char aWarningYouHa_2[]
aWarningYouHa_2	db 'Warning: You have entered an insecure passphrase.%%0AA passphrase'
					; DATA XREF: sub_414492+F3o
		db ' should contain at least %u digit or%%0Aspecial character.',0
; char aWarningYouHa_3[]
aWarningYouHa_3	db 'Warning: You have entered an insecure passphrase.%%0AA passphrase'
					; DATA XREF: sub_414492+178o
		db ' may not be a known term or match%%0Acertain pattern.',0
		align 4
; char aYouHaveNotEnte[]
aYouHaveNotEnte	db 'You have not entered a passphrase!%0AAn empty passphrase is not a'
					; DATA XREF: sub_414492+1D1o
		db 'llowed.',0
		align 4
; char aYouHaveNotEn_0[]
aYouHaveNotEn_0	db 'You have not entered a passphrase - this is in general a bad idea'
					; DATA XREF: sub_414492:loc_414671o
		db '!%0APlease confirm that you do not want to have any protection on'
		db ' your key.',0
; char aYesProtectionI[]
aYesProtectionI	db 'Yes, protection is not needed',0 ; DATA XREF: sub_414492:loc_414694o
		align 4
; char aFailedToConv_1[]
aFailedToConv_1	db 'failed to convert keyparam: %s',0Ah,0 ; DATA XREF: sub_414701+3Fo
; char aPleaseEnterT_0[]
aPleaseEnterT_0	db 'Please enter the passphrase to%0Aprotect your new key',0
					; DATA XREF: sub_414701:loc_41475Do
		align 4
; char aPleaseReEnte_1[]
aPleaseReEnte_1	db 'Please re-enter this passphrase',0 ; DATA XREF: sub_414701+6Bo
					; sub_414C0D+15o
; char aDoesNotMatch_1[]
aDoesNotMatch_1	db 'does not match - try again',0 ; DATA XREF: sub_414701+1D4o
					; sub_414C0D+17Eo
; char aKeyGenerationF[]
aKeyGenerationF	db 'key generation failed: %s',0Ah,0 ; DATA XREF: sub_414701+26Fo
aPrivateKey_1	db 'private-key',0      ; DATA XREF: sub_414701+2A4o
		align 10h
; char aKeyGeneratio_0[]
aKeyGeneratio_0	db 'key generation failed: invalid return value',0Ah,0
					; DATA XREF: sub_414701+2BDo
					; sub_414701+31Fo
aPublicKey_0	db 'public-key',0       ; DATA XREF: sub_414701+306o
; char aStoringPrivate[]
aStoringPrivate	db 'storing private key',0Ah,0 ; DATA XREF: sub_414701+386o
; char aReturningPubli[]
aReturningPubli	db 'returning public key',0Ah,0 ; DATA XREF: sub_414701+405o
		align 4
; char aPleaseEnterT_1[]
aPleaseEnterT_1	db 'Please enter the new passphrase',0 ; DATA XREF: sub_414C0D+6o
		align 8
aRsa_2		db 'rsa',0              ; DATA XREF: .data:off_43D760o
aNedpqu_0	db 'nedpqu',0           ; DATA XREF: .data:0043D764o
aDsa_1		db 'dsa',0              ; DATA XREF: .data:0043D774o
aPqgyx		db 'pqgyx',0            ; DATA XREF: .data:0043D778o
aElg_1		db 'elg',0              ; DATA XREF: .data:0043D788o
aPgyx		db 'pgyx',0             ; DATA XREF: .data:0043D78Co
aEcdsa_1	db 'ecdsa',0            ; DATA XREF: .data:0043D79Co
aPabgnqd	db 'pabgnqd',0          ; DATA XREF: .data:0043D7A0o
aEcdh		db 'ecdh',0
aEcc		db 'ecc',0
aSaltsalt	db 'saltsalt',0         ; DATA XREF: sub_415212+27o
a123456789abcde	db '123456789abcdef0',0 ; DATA XREF: sub_415212+3Fo
		align 4
; char a____Gnupg22__7[]
a____Gnupg22__7	db '../../gnupg2-2.0.30/agent/protect.c',0 ; DATA XREF: sub_415212+64o
					; sub_41557A+292o ...
; char aS2kCalibration[]
aS2kCalibration	db 'S2K calibration: %lu -> %lums',0Ah,0 ; DATA XREF: sub_41528F+35o
		align 4
; char aS2kCalibrati_0[]
aS2kCalibrati_0	db 'S2K calibration: %lu iterations for %lums',0Ah,0
					; DATA XREF: sub_41528F+E0o
aPrivateKey_2	db 'private-key',0      ; DATA XREF: sub_4153AD:loc_415402o
					; sub_415A18:loc_415AC9o ...
aOpenpgpS2k3Sha	db 'openpgp-s2k3-sha1-aes-cbc',0 ; DATA XREF: sub_41557A+Bo
					; sub_4168AC:loc_416BF5o
a4Hash4Sha120	db ')(4:hash4:sha120:',0 ; DATA XREF: sub_41557A+1F2o
; char aPOutbufOutlen[]
aPOutbufOutlen	db 'p - outbuf == outlen',0 ; DATA XREF: sub_41557A+29Ao
aLu_0		db '%lu',0              ; DATA XREF: sub_41557A+30Ao
dword_444258	dd 0			; DATA XREF: sub_41557A+363o
					; sub_41557A+380o
a9ProtectedDS4S	db '(9:protected%d:%s((4:sha18:%n_8bytes_%u:%s)%d:%n%*s)%d:%n%*s)',0
					; DATA XREF: sub_41557A+3BAo
a12ProtectedAt1	db '(12:protected-at15:',0 ; DATA XREF: sub_415A18+14o
aCurve_0	db 'curve',0            ; DATA XREF: sub_415A18+2A6o
a?qd		db '?qd',0              ; DATA XREF: sub_415A18+2D8o
; char aDepth1[]
aDepth1		db 'depth == 1',0       ; DATA XREF: sub_415A18+3F5o
					; sub_417585+236o
; char aDepth[]
aDepth		db '!depth',0           ; DATA XREF: sub_415A18+441o
asc_4442CA	db ')',0                ; DATA XREF: sub_415A18+4D7o
a21Protected	db '(21:protected-',0   ; DATA XREF: sub_415A18:loc_415FFAo
; char aPResultResultl[]
aPResultResultl	db 'p - *result == *resultlen',0 ; DATA XREF: sub_415A18+712o
a11PrivateKey	db '(11:private-key',0  ; DATA XREF: sub_416382:loc_416461o
aHash_0		db 'hash',0             ; DATA XREF: sub_416382+21Bo
aSha1		db 'sha1',0             ; DATA XREF: sub_416382+24Bo
					; sub_4168AC:loc_416C7Ao
; char aS_0[]
aS_0		db '*s == ',27h,'(',27h,0 ; DATA XREF: sub_416382+318o
aProtectedAt	db 'protected-at',0     ; DATA XREF: sub_416382+37Ao
					; sub_4168AC:loc_416A55o
; char aS1[]
aS1		db 's[-1] == ',27h,')',27h,0 ; DATA XREF: sub_416382+422o
aProtectedPri_1	db 'protected-private-key',0 ; DATA XREF: sub_4168AC:loc_416918o
					; sub_416FFD:loc_417041o
aProtected	db 'protected',0        ; DATA XREF: sub_4168AC:loc_416B7Ao
aShadowedPriv_1	db 'shadowed-private-key',0 ; DATA XREF: sub_416FFD:loc_417066o
					; sub_417904:loc_417964o ...
aPublicKey_1	db 'public-key',0       ; DATA XREF: sub_417585:loc_41764Eo
aShadowed	db 'shadowed',0         ; DATA XREF: sub_417904:loc_417A51o
aT1V1		db 't1-v1',0            ; DATA XREF: sub_417904:loc_417AF6o
aCalibrate_s2k_	db 'calibrate_s2k_count_one',0 ; DATA XREF: sub_415212+54o
		align 10h
dbl_4443A0	dq 100.0		; DATA XREF: sub_41528F+77r
		align 20h
aThisIsTheListO	db '# This is the list of trusted keys.  Comment lines, like this one'
					; DATA XREF: sub_418C2D+3EEo
		db ', as',0Ah
		db '# well as empty lines are ignored.  Lines have a length limit but'
		db ' this',0Ah
		db '# is not a serious limitation as the format of the entries is fix'
		db 'ed and',0Ah
		db '# checked by gpg-agent.  A non-comment line starts with optional '
		db 'white',0Ah
		db '# space, followed by the SHA-1 fingerpint in hex, followed by a f'
		db 'lag',0Ah
		db '# which may be one of ',27h,'P',27h,', ',27h,'S',27h,' or ',27h,'*',27h,' and optio'
		db 'nally followed by a list of',0Ah
		db '# other flags.  The fingerprint may be prefixed with a ',27h,'!',27h,' '
		db 'to mark the',0Ah
		db '# key as not trusted.  You should give the gpg-agent a HUP or run'
		db ' the',0Ah
		db '# command "gpgconf --reload gpg-agent" after changing this file.',0Ah
		db 0Ah
		db 0Ah
		db '# Include the default trust list',0Ah
		db 'include-default',0Ah
		db 0Ah,0
; char aErrorInitializ[]
aErrorInitializ	db 'error initializing mutex: %s',0Ah,0 ; DATA XREF: sub_417D25+34o
		align 10h
; char a____Gnupg22__8[]
a____Gnupg22__8	db '../../gnupg2-2.0.30/agent/trustlist.c',0 ; DATA XREF: sub_417D71+26o
					; sub_417DAD+16o ...
		align 4
; char aFailedToAcqu_0[]
aFailedToAcqu_0	db 'failed to acquire mutex in %s',0Ah,0 ; DATA XREF: sub_417D71+2Eo
		align 4
; char aFailedToRele_1[]
aFailedToRele_1	db 'failed to release mutex in %s',0Ah,0 ; DATA XREF: sub_417DAD+1Eo
; char aR_2[]
aR_2		db 'r',0                ; DATA XREF: sub_417DD9+3Bo
; char aErrorOpeningSS[]
aErrorOpeningSS	db 'error opening `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_417DD9+71o
					; sub_41854D+9Do
; char aFileSLineDS[]
aFileSLineDS	db 'file `%s',27h,', line %d: %s',0Ah,0 ; DATA XREF: sub_417DD9+124o
aIncludeDefault	db 'include-default',0  ; DATA XREF: sub_417DD9+1C6o
					; sub_417DD9+238o ...
		align 4
; char aStatementSIgno[]
aStatementSIgno	db 'statement "%s" ignored in `%s',27h,', line %d',0Ah,0
					; DATA XREF: sub_417DD9+21Eo
					; sub_417DD9+283o
aTrustlist_txt	db 'trustlist.txt',0    ; DATA XREF: sub_417DD9+25Ao
					; sub_41854D+50o ...
		align 4
; char aSystemTrustlis[]
aSystemTrustlis	db 'system trustlist `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_417DD9+2D7o
		align 4
; char aBadFingerprint[]
aBadFingerprint	db 'bad fingerprint in `%s',27h,', line %d',0Ah,0
					; DATA XREF: sub_417DD9+428o
		align 10h
; char aInvalidKeyflag[]
aInvalidKeyflag	db 'invalid keyflag in `%s',27h,', line %d',0Ah,0
					; DATA XREF: sub_417DD9:loc_4182C5o
					; sub_417DD9+550o
; char asc_4447E2[]
asc_4447E2	db '= ',9,0             ; DATA XREF: sub_417DD9+5AFo
		align 4
; char aAssigningAValu[]
aAssigningAValu	db 'assigning a value to a flag is not yet supported; in `%s',27h,', lin'
					; DATA XREF: sub_417DD9+5E0o
		db 'e %d',0Ah,0
aRelax		db 'relax',0            ; DATA XREF: sub_417DD9+612o
					; sub_418748+EFo
aCm		db 'cm',0               ; DATA XREF: sub_417DD9+644o
					; sub_418748+12Do
		align 4
; char aFlag_SInSLineD[]
aFlag_SInSLineD	db 'flag `%.*s',27h,' in `%s',27h,', line %d ignored',0Ah,0
					; DATA XREF: sub_417DD9+684o
		align 10h
; char aErrorReadingSL[]
aErrorReadingSL	db 'error reading `%s',27h,', line %d: %s',0Ah,0
					; DATA XREF: sub_417DD9+70Eo
		align 4
; char aErrorReadingLi[]
aErrorReadingLi	db 'error reading list of trusted root certificates',0Ah,0
					; DATA XREF: sub_418748+5Bo
					; sub_4188E0+1Do
aTrustlistflag	db 'TRUSTLISTFLAG',0    ; DATA XREF: sub_418748+F7o
					; sub_418748+135o
; char aStrlenBufferNn[]
aStrlenBufferNn	db 'strlen (buffer) <= nnew',0 ; DATA XREF: sub_418A1D+E9o
a0a		db '%0A   ',0           ; DATA XREF: sub_418C2D:loc_418D01o
		align 4
; char aDoYouUltimatel[]
aDoYouUltimatel	db 'Do you ultimately trust%%0A  "%s"%%0Ato correctly certify user ce'
					; DATA XREF: sub_418C2D:loc_418D27o
		db 'rtificates?',0
; char aNo[]
aNo		db 'No',0               ; DATA XREF: sub_418C2D:loc_418D60o
; char aYes[]
aYes		db 'Yes',0              ; DATA XREF: sub_418C2D+141o
; char aPleaseVerifyTh[]
aPleaseVerifyTh	db 'Please verify that the certificate identified as:%%0A  "%s"%%0Aha'
					; DATA XREF: sub_418C2D+1EBo
		db 's the fingerprint:%%0A  %s',0
; char aWrong[]
aWrong		db 'Wrong',0            ; DATA XREF: sub_418C2D:loc_418E63o
; char aCorrect[]
aCorrect	db 'Correct',0          ; DATA XREF: sub_418C2D+244o
aWx		db 'wx',0               ; DATA XREF: sub_418C2D+372o
; char aCanTCreateSS_1[]
aCanTCreateSS_1	db 'can',27h,'t create `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_418C2D+3ADo
aA_0		db 'a+',0               ; DATA XREF: sub_418C2D:loc_419032o
; char aCanTOpenSS_1[]
aCanTOpenSS_1	db 'can',27h,'t open `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_418C2D+440o
asc_4449D4	db 0Ah			; DATA XREF: sub_418C2D:loc_4190A7o
					; sub_418C2D+499o
		db '# ',0
aRelax_0	db ' relax',0           ; DATA XREF: sub_418C2D+52Bo
byte_4449DF	db 0			; DATA XREF: sub_418C2D:loc_41915Fo
					; sub_418C2D+53Do
asc_4449E0	db '!',0                ; DATA XREF: sub_418C2D:loc_419171o
aSSCS		db 0Ah			; DATA XREF: sub_418C2D:loc_419176o
		db '%s%s %c%s',0Ah,0
		align 20h
; char aDetectedCard_0[]
aDetectedCard_0	db 'detected card with S/N %s',0Ah,0 ; DATA XREF: sub_4193A7+A0o
; char aNoCardPresent[]
aNoCardPresent	db 'no card present',0Ah,0 ; DATA XREF: sub_4193A7+106o
; char aErrorAccessing[]
aErrorAccessing	db 'error accessing card: %s',0Ah,0 ; DATA XREF: sub_4193A7+131o
		align 4
; char aPleaseInsertTh[]
aPleaseInsertTh	db 'Please insert the card with serial number',0
					; DATA XREF: sub_4193A7+150o
		align 4
; char aPleaseRemoveTh[]
aPleaseRemoveTh	db 'Please remove the current card and insert the one with serial num'
					; DATA XREF: sub_4193A7:loc_419505o
		db 'ber',0
aS0a0a_S	db '%s:%%0A%%0A  "%.*s"',0 ; DATA XREF: sub_4193A7+179o
		align 10h
; char aNoObjectIdenti[]
aNoObjectIdenti	db 'no object identifier for algo %d',0Ah,0 ; DATA XREF: sub_4195A3+8Co
aEncodedHash	db 'encoded hash:',0    ; DATA XREF: sub_4195A3+11Bo
aPin_1		db 'PIN',0              ; DATA XREF: sub_4196E6+32o
; char aAdminPin[]
aAdminPin	db 'Admin PIN',0        ; DATA XREF: sub_4196E6+A6o
; char aPuk[]
aPuk		db 'PUK',0              ; DATA XREF: sub_4196E6+C1o
; char aResetCode[]
aResetCode	db 'Reset Code',0       ; DATA XREF: sub_4196E6+F6o
		align 10h
; char aPin_cbCalledWi[]
aPin_cbCalledWi	db 'pin_cb called without proper PIN info hack',0Ah,0
					; DATA XREF: sub_4196E6+13Ao
; char aS0a0auseTheRea[]
aS0a0auseTheRea	db '%s%%0A%%0AUse the reader',27h,'s pinpad for input.',0
					; DATA XREF: sub_4196E6+17Do
; char aRepeatThisRese[]
aRepeatThisRese	db 'Repeat this Reset Code',0 ; DATA XREF: sub_4196E6+328o
; char aRepeatThisPuk[]
aRepeatThisPuk	db 'Repeat this PUK',0  ; DATA XREF: sub_4196E6+33Co
; char aRepeatThisPin[]
aRepeatThisPin	db 'Repeat this PIN',0  ; DATA XREF: sub_4196E6:loc_419A30o
aPukNotCorrectl	db 'PUK not correctly repeated; try again',0 ; DATA XREF: sub_4196E6+3BCo
		align 4
aPinNotCorrectl	db 'PIN not correctly repeated; try again',0
					; DATA XREF: sub_4196E6:loc_419AA9o
		align 10h
aResetCodeNotCo	db 'Reset Code not correctly repeated; try again',0
					; DATA XREF: sub_4196E6:loc_419AB0o
asc_444C2D	db 27h,')',0            ; DATA XREF: sub_4196E6+403o
byte_444C30	db 0			; DATA XREF: sub_4196E6:loc_419AF0o
					; sub_4196E6:loc_419B00o ...
asc_444C31	db ' (`',0              ; DATA XREF: sub_4196E6+425o
		align 4
; char aPleaseEnterT_2[]
aPleaseEnterT_2	db 'Please enter the PIN%s%s%s to unlock the card',0
					; DATA XREF: sub_4196E6:loc_419B17o
aEncVal		db 'enc-val',0          ; DATA XREF: sub_419D1E:loc_419D73o
aRsa_0		db 'rsa',0              ; DATA XREF: sub_419D1E:loc_419DEBo
aA_1		db 'a',0                ; DATA XREF: sub_419D1E:loc_419E63o
; char aErrorInitial_0[]
aErrorInitial_0	db 'error initializing mutex: %s',0Ah,0 ; DATA XREF: sub_41A03C+34o
; char aUnknownUnder_0[]
aUnknownUnder_0	db 'unknown under W32',0 ; DATA XREF: sub_41A088+6o
aAgent_scd_dump	db 'agent_scd_dump_state: scd_lock=',0 ; DATA XREF: .text:0041A0A3o
asc_444CC4	db 0Ah,0		; DATA XREF: .text:0041A0BBo
		align 4
aAgent_scd_du_0	db 'agent_scd_dump_state: primary_scd_ctx=%p pid=%ld reusable=%d',0Ah,0
					; DATA XREF: .text:0041A0ECo
		align 4
aAgent_scd_du_1	db 'agent_scd_dump_state: socket=`%s',27h,0Ah,0 ; DATA XREF: .text:0041A10Ao
aBye		db 'BYE',0              ; DATA XREF: sub_41A11C+5Do
		align 10h
; char aUnlock_scdInva[]
aUnlock_scdInva	db 'unlock_scd: invalid lock count (%d)',0Ah,0 ; DATA XREF: sub_41A11C+88o
		align 4
; char aStart_scdInval[]
aStart_scdInval	db 'start_scd: invalid lock count (%d)',0Ah,0 ; DATA XREF: sub_41A1F1+AAo
; char aFailedToAcqu_1[]
aFailedToAcqu_1	db 'failed to acquire the start_scd lock: %s',0Ah,0
					; DATA XREF: sub_41A1F1+122o
		align 4
; char aNewConnectionT[]
aNewConnectionT	db 'new connection to SCdaemon established (reusing)',0Ah,0
					; DATA XREF: sub_41A1F1+170o
		align 4
; char aCanTAllocate_1[]
aCanTAllocate_1	db 'can',27h,'t allocate assuan context: %s',0Ah,0
					; DATA XREF: sub_41A1F1+1A4o
		align 10h
; char aCanTConnectToS[]
aCanTConnectToS	db 'can',27h,'t connect to socket `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_41A1F1+20Fo
		align 4
; char aNewConnectio_0[]
aNewConnectio_0	db 'new connection to SCdaemon established',0Ah,0
					; DATA XREF: sub_41A1F1+23Co
; char aScdaemonIsRunn[]
aScdaemonIsRunn	db 'SCdaemon is running but won',27h,'t accept further connections',0Ah,0
					; DATA XREF: sub_41A1F1+256o
		align 4
; char aNoRunningScdae[]
aNoRunningScdae	db 'no running SCdaemon - starting it',0Ah,0 ; DATA XREF: sub_41A1F1+27Fo
		align 4
; char aErrorFlushin_0[]
aErrorFlushin_0	db 'error flushing pending output: %s',0Ah,0 ; DATA XREF: sub_41A1F1+2B0o
aMultiServer	db '--multi-server',0   ; DATA XREF: sub_41A1F1+314o
		align 10h
; char aCanTConnectT_1[]
aCanTConnectT_1	db 'can',27h,'t connect to the SCdaemon: %s',0Ah,0
					; DATA XREF: sub_41A1F1+3D9o
		align 4
; char aFirstConnectio[]
aFirstConnectio	db 'first connection to SCdaemon established',0Ah,0
					; DATA XREF: sub_41A1F1+402o
aGetinfoSocket_	db 'GETINFO socket_name',0 ; DATA XREF: sub_41A1F1+48Co
		align 4
; char aWarningCanTSto[]
aWarningCanTSto	db 'warning: can',27h,'t store socket name: %s',0Ah,0
					; DATA XREF: sub_41A1F1+4F7o
		align 4
; char aAdditionalConn[]
aAdditionalConn	db 'additional connections at `%s',27h,0Ah,0 ; DATA XREF: sub_41A1F1+545o
aOptionEventSig	db 'OPTION event-signal=%lx',0 ; DATA XREF: sub_41A1F1+56Eo
; char aFailedToRele_2[]
aFailedToRele_2	db 'failed to release the start_scd lock: %s',0Ah,0
					; DATA XREF: sub_41A1F1+646o
aTimeout	db 'timeout',0          ; DATA XREF: sub_41A85A+76o
		align 4
; char aFailedToAcqu_2[]
aFailedToAcqu_2	db 'failed to acquire the start_scd lock while doing an aliveness che'
					; DATA XREF: sub_41A85A+7Eo
					; sub_41A85A+A1o
		db 'ck: %s',0Ah,0
		align 4
; char aFailedToRele_3[]
aFailedToRele_3	db 'failed to release the start_scd lock while doing the aliveness ch'
					; DATA XREF: sub_41A85A+1F5o
		db 'eck: %s',0Ah,0
aRestart	db 'RESTART',0          ; DATA XREF: sub_41AA60+6Co
		align 4
; char a____Gnupg22__9[]
a____Gnupg22__9	db '../../gnupg2-2.0.30/agent/call-scd.c',0 ; DATA XREF: sub_41AA60+BFo
					; sub_41AA60+12Fo ...
aCertinfo	db 'CERTINFO',0         ; DATA XREF: sub_41ABC7+6Co
aKeypairinfo	db 'KEYPAIRINFO',0      ; DATA XREF: sub_41ABC7+AAo
aLearnForce	db 'LEARN --force',0    ; DATA XREF: sub_41ACE2+A4o
aSerialno_0	db 'SERIALNO',0         ; DATA XREF: sub_41ADCC+6Fo
					; sub_41AF53+61o
aNeedpin	db 'NEEDPIN',0          ; DATA XREF: sub_41B03B+13o
aPopuppinpadpro	db 'POPUPPINPADPROMPT',0 ; DATA XREF: sub_41B03B+F3o
aDismisspinpadp	db 'DISMISSPINPADPROMPT',0 ; DATA XREF: sub_41B03B+179o
byte_4450F7	db 0			; DATA XREF: sub_41B03B+1D2o
aKeydata	db 'KEYDATA',0          ; DATA XREF: sub_41B03B+1FAo
; char aErrorForwardin[]
aErrorForwardin	db 'error forwarding inquiry `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_41B03B+344o
; char aUnsupportedI_0[]
aUnsupportedI_0	db 'unsupported inquiry `%s',27h,0Ah,0 ; DATA XREF: sub_41B03B+359o
aSetdata	db 'SETDATA ',0         ; DATA XREF: sub_41B3B9:loc_41B417o
					; sub_41B78A:loc_41B7E8o
; char a02x_0[]
a02x_0		db '%02X',0             ; DATA XREF: sub_41B3B9+C2o
					; sub_41B78A+C2o
aPkauthS	db 'PKAUTH %s',0        ; DATA XREF: sub_41B3B9+1A0o
aPksignS	db 'PKSIGN %s',0        ; DATA XREF: sub_41B3B9:loc_41B560o
; char aU[]
aU		db '%u:',0              ; DATA XREF: sub_41B3B9+2F3o
asc_445163	db ')))',0              ; DATA XREF: sub_41B3B9+358o
		align 4
; char aGcry_sexp_cano[]
aGcry_sexp_cano	db 'gcry_sexp_canon_len (*r_buf, *r_buflen, NULL, NULL)',0
					; DATA XREF: sub_41B3B9+3A9o
aPkdecryptS	db 'PKDECRYPT %s',0     ; DATA XREF: sub_41B78A+19Do
aReadcertS	db 'READCERT %s',0      ; DATA XREF: sub_41BA31+4Bo
aReadkeyS	db 'READKEY %s',0       ; DATA XREF: sub_41BB7D+4Bo
aAgent_reset_sc	db 'agent_reset_scd',0  ; DATA XREF: sub_41AA60+AFo
					; sub_41AA60+11Fo
a0		db '0',0                ; DATA XREF: sub_41C2B8+28o
					; sub_41C2B8+30o ...
aK		db 'k',0                ; DATA XREF: sub_41C2B8+38o
aLearncard	db 'learncard',0        ; DATA XREF: sub_41C2B8+40o
					; sub_41C501+40o
aProgress	db 'PROGRESS',0         ; DATA XREF: sub_41C2B8+48o
					; sub_41C501+48o
aC		db 'c',0                ; DATA XREF: sub_41C501+38o
aIgnored	db ' - ignored',0       ; DATA XREF: sub_41C76B:loc_41C7B3o
byte_4451F4	db 0			; DATA XREF: sub_41C76B:loc_41C7BCo
a?		db '?',0                ; DATA XREF: sub_41C76B:loc_41C7EFo
		align 4
; char aErrorReadingCe[]
aErrorReadingCe	db 'error reading certificate `%s',27h,': %s%s',0Ah,0
					; DATA XREF: sub_41C76B+98o
off_44521E	dd offset aNewConnectio_0+21h ;	DATA XREF: sub_41C76B+10Eo
					; "ished\n"
		align 4
; char aSendingCertifi[]
aSendingCertifi	db 'sending certificate failed: %s',0Ah,0 ; DATA XREF: sub_41C76B+139o
; char aAgent_card_lea[]
aAgent_card_lea	db 'agent_card_learn failed: %s',0Ah,0 ; DATA XREF: sub_41C8BC+102o
; char aCardHasSNS[]
aCardHasSNS	db 'card has S/N: %s',0Ah,0 ; DATA XREF: sub_41C8BC+11Ao
		align 4
; char aIdSTypeD[]
aIdSTypeD	db '          id: %s    (type=%d)',0Ah,0 ; DATA XREF: sub_41C8BC+1A9o
		align 4
; char aIdSGripS[]
aIdSGripS	db '          id: %s    (grip=%s)',0Ah,0 ; DATA XREF: sub_41C8BC+242o
aKeypairinfo_0	db 'KEYPAIRINFO',0      ; DATA XREF: sub_41C8BC+27Eo
		align 10h
; char aAgent_card_rea[]
aAgent_card_rea	db 'agent_card_readkey failed: %s',0Ah,0 ; DATA XREF: sub_41C8BC+394o
; char aShadowingThe_0[]
aShadowingThe_0	db 'shadowing the key failed: %s',0Ah,0 ; DATA XREF: sub_41C8BC+429o
		align 10h
; char a____Gnupg22_10[]
a____Gnupg22_10	db '../../gnupg2-2.0.30/agent/learncard.c',0 ; DATA XREF: sub_41C8BC+46Eo
; char aN_0[]
aN_0		db 'n',0                ; DATA XREF: sub_41C8BC+476o
; char aErrorWriting_0[]
aErrorWriting_0	db 'error writing key: %s',0Ah,0 ; DATA XREF: sub_41C8BC+4C6o
; char aStored[]
aStored		db 'stored',0Ah,0       ; DATA XREF: sub_41C8BC+4E0o
		align 4
; char asc_445348[4]
asc_445348	db ' ',9,0Ah,0Bh        ; DATA XREF: sub_41D09B:loc_41D0C6o
		db 0Ch,	22h, 0
; char aDuplicatehandl[]
aDuplicatehandl	db 'DuplicateHandle failed: %s',0Ah,0 ; DATA XREF: sub_41D2B1+BCo
; CHAR FileName[]
FileName	db 'nul',0              ; DATA XREF: sub_41D3D7+44o
; char aCanTOpenNulS[]
aCanTOpenNulS	db 'can',27h,'t open `nul',27h,': %s',0Ah,0 ; DATA XREF: sub_41D3D7+6Eo
		align 4
aFailedToTransl	db 'failed to translate osfhandle %p',0Ah,0 ; DATA XREF: .text:0041D4C4o
					; .text:0041D513o ...
		align 4
aNoFileDescript	db 'no file descriptor for file passed to gnupg_spawn_process',0Ah,0
					; DATA XREF: .text:loc_41D5E1o
aErrorCreatingA	db 'error creating a pipe: %s',0Ah,0 ; DATA XREF: .text:0041D66Ao
; char aCreateprocessF[]
aCreateprocessF	db 'CreateProcess failed: %s',0Ah,0 ; DATA XREF: .text:0041D76Do
					; sub_41D8C8+1CCo
aR_3		db 'r',0                ; DATA XREF: .text:loc_41D84Fo
		align 10h
aCanTFdopenPipe	db 'can',27h,'t fdopen pipe for reading: %s',0Ah,0
					; DATA XREF: .text:0041D885o
		align 4
; char aWaitingForProc[]
aWaitingForProc	db 'waiting for process %d to terminate failed: %s',0Ah,0
					; DATA XREF: sub_41DB37+6Do
; char aErrorGettingEx[]
aErrorGettingEx	db 'error getting exit code of process %d: %s',0Ah,0
					; DATA XREF: sub_41DB37+C1o
		align 10h
; char aErrorRunningSE[]
aErrorRunningSE	db 'error running `%s',27h,': exit status %d',0Ah,0
					; DATA XREF: sub_41DB37+F5o
; char aWaitforsingleo[]
aWaitforsingleo	db 'WaitForSingleObject returned unexpected code %d for pid %d',0Ah,0
					; DATA XREF: sub_41DB37+163o
aCreateprocessD	db 'CreateProcess(detached) failed: %s',0Ah,0 ; DATA XREF: .text:0041DE08o
; char aGnupg2[]
aGnupg2		db 'gnupg2',0           ; DATA XREF: sub_41DE5C+Fo
		align 4
; char aLibgcryptProbl[]
aLibgcryptProbl	db 'libgcrypt problem: %s',0Ah,0 ; DATA XREF: sub_41DFE1+20o
		align 4
; char aOutOfCoreInSec[]
aOutOfCoreInSec	db 'out of core in secure memory while allocating %lu bytes',0
					; DATA XREF: sub_41E00D+23o
; char aOutOfCoreWhi_1[]
aOutOfCoreWhi_1	db 'out of core while allocating %lu bytes',0
					; DATA XREF: sub_41E00D:loc_41E04Bo
aStdout		db '[stdout]',0         ; DATA XREF: .text:loc_41E0D1o
aStdin		db '[stdin]',0          ; DATA XREF: .text:loc_41E0FDo
asc_4455B4	db '|',0                ; DATA XREF: .text:loc_41E3B2o
		align 4
; char aFailedToTran_0[]
aFailedToTran_0	db 'failed to translate osfhandle %p',0Ah,0 ; DATA XREF: sub_41E4C3+3Eo
a_tmp		db '.tmp',0             ; DATA XREF: sub_41E537+18Do
; char aWB[]
aWB		db 'w+b',0              ; DATA XREF: sub_41E537:loc_41E75Eo
		align 4
aGnupg_allow_se	db 'gnupg_allow_set_foregound_window',0 ; DATA XREF: sub_41E7E4+13o
		align 4
; char aSCalledWithInv[]
aSCalledWithInv	db '%s called with invalid pid %lu',0Ah,0 ; DATA XREF: sub_41E7E4+1Bo
; char aAllowsetforegr[]
aAllowsetforegr	db 'AllowSetForegroundWindow(%lu) failed: %s',0Ah,0
					; DATA XREF: sub_41E7E4+61o
		align 4
; CHAR aShgetfolderpat[]
aShgetfolderpat	db 'SHGetFolderPathA',0 ; DATA XREF: sub_41EAC5+50o
aHome		db '\home',0            ; DATA XREF: sub_41EB9F+31o
aGnupg		db '\gnupg',0           ; DATA XREF: sub_41EB9F+BAo
aCGnupg		db 'c:/gnupg',0         ; DATA XREF: sub_41EB9F:loc_41ECC3o
					; sub_41ECD9:loc_41EDADo
; char aGnupghome[]
aGnupghome	db 'GNUPGHOME',0        ; DATA XREF: sub_41ECD9:loc_41ECF7o
; CHAR ValueName[]
ValueName	db 'HomeDir',0          ; DATA XREF: sub_41ECD9:loc_41ED33o
; CHAR aSoftwareGnuGnu[]
aSoftwareGnuGnu	db 'Software\GNU\GnuPG',0 ; DATA XREF: sub_41ECD9+62o
aGpgconf_exe	db '\gpgconf.exe',0     ; DATA XREF: sub_41EDB9+10o
					; sub_41F46E+597o
		align 10h
; char aRequiredBinary[]
aRequiredBinary	db 'required binary ',27h,'%s',27h,' is not installed',0Ah,0
					; DATA XREF: sub_41EDB9+44o
aCtl		db 'ctl',0              ; DATA XREF: sub_41EDB9:loc_41EE0Bo
; char aGetmodulefilen[]
aGetmodulefilen	db 'GetModuleFileName failed: %s',0Ah,0 ; DATA XREF: sub_41EE6C+4Ao
aBin		db 'bin',0              ; DATA XREF: sub_41EE6C+BBo
		align 10h
; char aBadFilenameSRe[]
aBadFilenameSRe	db 'bad filename `%s',27h,' returned for this process',0Ah,0
					; DATA XREF: sub_41EE6C+FCo
aCGnupg_0	db 'c:\gnupg',0         ; DATA XREF: sub_41EE6C:loc_41EF8Do
aGnu		db '\GNU',0             ; DATA XREF: sub_41EF99+99o
aEtcGnupg	db '\etc\gnupg',0       ; DATA XREF: sub_41F080+1Do
aBin_0		db '\bin',0             ; DATA XREF: sub_41F123+28o
aLibGnupg	db '\lib\gnupg',0       ; DATA XREF: .text:0041F199o
aShareGnupg	db '\share\gnupg',0     ; DATA XREF: sub_41F21F+1Do
aShareLocale	db '\share\locale',0    ; DATA XREF: sub_41F2C2+1Do
aCWindows	db 'C:\WINDOWS',0       ; DATA XREF: .text:0041F3AFo
aS_dirmngr	db '\S.dirmngr',0       ; DATA XREF: .text:loc_41F3D3o
aGpgAgent_exe	db '\gpg-agent.exe',0   ; DATA XREF: sub_41F46E+36o
aPinentry_exe	db '\pinentry.exe',0    ; DATA XREF: sub_41F46E+CFo
aScdaemon_exe	db '\scdaemon.exe',0    ; DATA XREF: sub_41F46E+168o
aDirmngr_exe	db '\dirmngr.exe',0     ; DATA XREF: sub_41F46E+201o
aGpgProtectTool	db '\gpg-protect-tool.exe',0 ; DATA XREF: sub_41F46E+29Ao
aGpgCheckPatter	db '\gpg-check-pattern.exe',0 ; DATA XREF: sub_41F46E+333o
aGpgsm_exe	db '\gpgsm.exe',0       ; DATA XREF: sub_41F46E+3CCo
aGpg2_exe	db '\gpg2.exe',0        ; DATA XREF: sub_41F46E+465o
aGpgConnectAgen	db '\gpg-connect-agent.exe',0 ; DATA XREF: sub_41F46E+4FEo
a____Gnupg22_11	db '../../gnupg2-2.0.30/common/homedir.c',0 ; DATA XREF: sub_41F46E+628o
		align 10h
off_445840	dd offset loc_41FA86	; DATA XREF: sub_41F46E+18o
		dd offset loc_41F48F	; jump table for switch	statement
		dd offset loc_41F528
		dd offset loc_41F5C1
		dd offset loc_41F65A
		dd offset loc_41F6F3
		dd offset loc_41F78C
		dd offset loc_41F825
		dd offset loc_41F8BE
		dd offset loc_41F957
		dd offset loc_41F9F0
aGnupg_module_n	db 'gnupg_module_name',0 ; DATA XREF: sub_41F46E:loc_41FA86o
aShell32_dll	db 'shell32.dll',0      ; DATA XREF: .data:off_43D814o
aShfolder_dll	db 'shfolder.dll',0     ; DATA XREF: .data:0043D818o
		align 4
; char aGpg_tty_2[]
aGpg_tty_2	db 'GPG_TTY',0          ; DATA XREF: sub_4201C8:loc_4202B1o
					; .data:off_43D820o
aTtyname_0	db 'ttyname',0          ; DATA XREF: .data:off_43D824o
aTerm_3		db 'TERM',0             ; DATA XREF: .data:0043D828o
aTtytype_0	db 'ttytype',0          ; DATA XREF: .data:0043D82Co
aDisplay_5	db 'DISPLAY',0          ; DATA XREF: .data:0043D830o
aDisplay_6	db 'display',0          ; DATA XREF: .data:0043D834o
aXauthority_4	db 'XAUTHORITY',0       ; DATA XREF: .data:0043D838o
aXauthority_5	db 'xauthority',0       ; DATA XREF: .data:0043D83Co
aXmodifiers	db 'XMODIFIERS',0       ; DATA XREF: .data:0043D840o
aGtk_im_module	db 'GTK_IM_MODULE',0    ; DATA XREF: .data:0043D848o
aQt_im_module	db 'QT_IM_MODULE',0     ; DATA XREF: .data:0043D850o
aPinentry_use_3	db 'PINENTRY_USER_DATA',0 ; DATA XREF: .data:0043D858o
aPinentryUser_0	db 'pinentry-user-data',0 ; DATA XREF: .data:0043D85Co
		align 4
a04d02d02dt02d0	db '%04d%02d%02dT%02d%02d%02d',0 ; DATA XREF: sub_420520+72o
					; .text:00420B62o ...
aGnupg_get_time	db 'gnupg_get_time() failed',0Ah,0 ; DATA XREF: .text:00420668o
aUyUdUhUm	db '%uy%ud%uh%um',0     ; DATA XREF: .text:00420C78o
a????????	db '????-??-??',0       ; DATA XREF: .text:00420D02o
					; .text:00420E58o
a04d02d02d	db '%04d-%02d-%02d',0   ; DATA XREF: .text:00420D57o
a??????????????	db '????-??-?? ??:??:??',0 ; DATA XREF: .text:00420D99o
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d',0 ; DATA XREF: .text:00420E08o
aCZ		db '%c %Z',0            ; DATA XREF: .text:00420E9Ao
		align 4
a____Gnupg22_12	db '../../gnupg2-2.0.30/common/gettime.c',0 ; DATA XREF: sub_420F51+E7o
aNone_1		db '[none]',0           ; DATA XREF: .text:loc_421365o
a_4s_2s_2s_2s_2	db '%.4s-%.2s-%.2s %.2s:%.2s:%s',0 ; DATA XREF: .text:004213B4o
aDays_per_month	db 'days_per_month',0   ; DATA XREF: sub_420F51:loc_421028o
		align 4
off_445A14	dd offset loc_4219BB	; DATA XREF: sub_4219A0+12r
		dd offset loc_4219CA	; jump table for switch	statement
		dd offset loc_421A42
		dd offset loc_421A42
		dd offset loc_421A42
		dd offset loc_421A42
		dd offset loc_421ABA
		dd offset loc_421ABA
		dd offset loc_421ABA
		dd offset loc_421ABA
		dd offset loc_421ABA
		dd offset loc_421ABA
		dd offset loc_421ABA
		dd offset loc_421ABA
		dd offset loc_421AF2
		dd offset loc_421B01
		dd offset loc_421B10
		dd offset loc_421B1F
		dd offset loc_421B2B
off_445A60	dd offset loc_421A32	; DATA XREF: sub_4219A0+35r
		dd offset loc_4219DE	; jump table for switch	statement
		dd offset loc_4219EA
		dd offset loc_4219F6
		dd offset loc_421A02
		dd offset loc_421A0E
		dd offset loc_421A1A
		dd offset loc_421A26
off_445A80	dd offset loc_421AAA	; DATA XREF: sub_4219A0+ADr
		dd offset loc_421A56	; jump table for switch	statement
		dd offset loc_421A62
		dd offset loc_421A6E
		dd offset loc_421A7A
		dd offset loc_421A86
		dd offset loc_421A92
		dd offset loc_421A9E
off_445AA0	dd offset loc_421B93	; DATA XREF: sub_4219A0+196r
		dd offset loc_421B3F	; jump table for switch	statement
		dd offset loc_421B4B
		dd offset loc_421B57
		dd offset loc_421B63
		dd offset loc_421B6F
		dd offset loc_421B7B
		dd offset loc_421B87
off_445AC0	dd offset loc_421CC6	; DATA XREF: sub_421BA1+10Ar
		dd offset loc_421CE7	; jump table for switch	statement
		dd offset loc_421CE7
		dd offset loc_421CCC
		dd offset loc_421CE7
		dd offset loc_421CE7
		dd offset loc_421CE7
		dd offset loc_421CB4
		dd offset loc_421CE7
		dd offset loc_421CE7
		dd offset loc_421CE7
		dd offset loc_421CC0
		dd offset loc_421CE7
		dd offset loc_421CBA
		dd offset loc_421CE7
		dd offset loc_421CE7
		dd offset loc_421CD2
off_445B04	dd offset loc_422027	; DATA XREF: sub_421BA1+408r
		dd offset loc_422034	; jump table for switch	statement
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_421FB2
		dd offset loc_422034
		dd offset loc_422000
		dd offset loc_422034
		dd offset loc_421FD9
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_42201A
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_422034
		dd offset loc_42200D
off_445BC0	dd offset loc_4220DE, offset loc_42213B, offset	loc_42210B
					; DATA XREF: sub_421BA1+4B0r
		dd offset loc_42213B, offset loc_4220BA, offset	loc_4220A2 ; jump table	for switch statement
		dd offset loc_4220CC, offset loc_42213B, offset	loc_42213B
		dd offset loc_42213B, offset loc_42213B, offset	loc_42213B
		dd offset loc_42213B, offset loc_42213B, offset	loc_42213B
		dd offset loc_42213B, offset loc_42213B, offset	loc_42213B
		dd offset loc_42211B, offset loc_42213B, offset	loc_42213B
		dd offset loc_42213B, offset loc_42213B, offset	loc_42208A
		dd offset loc_42213B, offset loc_42213B, offset	loc_42213B
		dd offset loc_42213B, offset loc_42213B, offset	loc_42213B
		dd offset loc_42213B, offset loc_42213B, offset	loc_4220D5
		dd offset loc_42213B, offset loc_4220E7, offset	loc_42205A
		dd offset loc_4220AE, offset loc_422096, offset	loc_4220C3
		dd offset loc_42213B, offset loc_42205A, offset	loc_42213B
		dd offset loc_42213B, offset loc_42213B, offset	loc_42212B
		dd offset loc_422102, offset loc_422066, offset	loc_4220F9
		dd offset loc_42213B, offset loc_42213B, offset	loc_4220F0
		dd offset loc_42213B, offset loc_422072, offset	loc_42213B
		dd offset loc_42213B, offset loc_42207E
off_445CA0	dd offset loc_4225D5	; DATA XREF: sub_422319+4Co
		dd offset loc_42236E	; jump table for switch	statement
		dd offset loc_42239A
		dd offset loc_4223C6
		dd offset loc_4223DD
		dd offset loc_4223F5
		dd offset loc_422422
		dd offset loc_42244C
		dd offset loc_422461
		dd offset loc_422476
		dd offset loc_4224A0
		dd offset loc_4224BB
		dd offset loc_4224EB
		dd offset loc_422500
		dd offset loc_422521
		dd offset loc_42254B
		dd offset loc_422575
		dd offset loc_42258D
		dd offset loc_4225B1
		dd offset loc_422536
		dd offset loc_422385
		dd offset loc_4223B1
		dd offset loc_42240D
		dd offset loc_422437
		dd offset loc_42248B
		dd offset loc_4224D6
		dd offset loc_422563
		dd offset loc_42259F
		dd offset loc_4225C3
byte_445D14	db 27h,	0		; DATA XREF: sub_422675+267o
a0123456789abcd	db '0123456789abcdef',0 ; DATA XREF: sub_422675+37Eo
a0123456789ab_0	db '0123456789ABCDEF',0 ; DATA XREF: sub_422675:loc_4229FAo
a0x		db '0x',0               ; DATA XREF: sub_422675+550o
a0x_0		db '0X',0               ; DATA XREF: sub_422675:loc_422BCCo
		align 10h
off_445D40	dd offset loc_4226D4	; DATA XREF: sub_422675+56r
		dd offset loc_42275C	; jump table for switch	statement
		dd offset loc_4226E9
		dd offset loc_42275C
		dd offset loc_4226FC
		dd offset loc_42275C
		dd offset loc_42270F
		dd offset loc_42275C
		dd offset loc_42275C
		dd offset loc_42275C
		dd offset loc_42275C
		dd offset loc_422735
		dd offset loc_42275C
		dd offset loc_422723
		dd offset loc_422749
off_445D7C	dd offset loc_4227B7	; DATA XREF: sub_422675+139r
		dd offset loc_42283E	; jump table for switch	statement
		dd offset loc_4227CD
		dd offset loc_42283E
		dd offset loc_4227DF
		dd offset loc_42283E
		dd offset loc_4227F1
		dd offset loc_42283E
		dd offset loc_42283E
		dd offset loc_42283E
		dd offset loc_42283E
		dd offset loc_422817
		dd offset loc_422805
		dd offset loc_42282B
off_445DB4	dd offset loc_422DDA	; DATA XREF: sub_422D08+C9r
		dd offset loc_422DE6	; jump table for switch	statement
		dd offset loc_422DF2
		dd offset loc_422DFE
		dd offset loc_422E0A
		dd offset loc_422E16
		dd offset loc_422E22
		dd offset loc_422E2E
aNull_0		db '(null)',0           ; DATA XREF: sub_4231AF+40o
byte_445DDB	db 30h			; DATA XREF: sub_423350+65r
a123456789abc_0	db '123456789abcdefx',0
		align 10h
off_445DF0	dd offset loc_42348C	; DATA XREF: sub_423457+2Cr
		dd offset loc_423498	; jump table for switch	statement
		dd offset loc_4234F1
		dd offset loc_4234A5
		dd offset loc_4234B1
		dd offset loc_4234C5
		dd offset loc_4234D9
		dd offset loc_4234E5
; char a____Gnupg22_13[]
a____Gnupg22_13	db '../../gnupg2-2.0.30/common/estream-printf.c',0
					; DATA XREF: sub_42350B+FAo
					; sub_42350B+145o ...
; char aArgidxArgspecs[]
aArgidxArgspecs	db 'argidx < argspecs_len',0 ; DATA XREF: sub_42350B+102o
		align 4
; char aValuetableArgW[]
aValuetableArgW	db 'valuetable[arg->width_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_42350B+14Do
		align 4
; char aValuetableArgP[]
aValuetableArgP	db 'valuetable[arg->precision_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_42350B+1D9o
		align 4
; char aArgVtValuetabl[]
aArgVtValuetabl	db 'arg->vt == valuetable[arg->arg_pos-1].vt',0 ; DATA XREF: sub_42350B+26Eo
; char aBug[]
aBug		db '!"bug"',0           ; DATA XREF: sub_42350B+2CFo
off_445EE8	dd offset loc_4237CA	; DATA XREF: sub_42350B+2B6r
		dd offset loc_4237EB	; jump table for switch	statement
		dd offset loc_4237EB
		dd offset loc_4237EB
		dd offset loc_4237EB
		dd offset loc_4237EB
		dd offset loc_42382F
		dd offset loc_42382F
		dd offset loc_42382F
		dd offset loc_42382F
		dd offset loc_42382F
		dd offset loc_42382F
		dd offset loc_42382F
		dd offset loc_42382F
		dd offset loc_423873
		dd offset loc_4238B7
		dd offset loc_4238FB
		dd offset loc_4238B7
		dd offset loc_42393C
byte_445F34	db 0			; DATA XREF: sub_424140+5Fo
					; sub_42433B+75o
; char aParm_used[]
aParm_used	db 'parm.used',0        ; DATA XREF: sub_42433B+FDo
		align 10h
a____Gnupg22_14	db '../../gnupg2-2.0.30/common/convert.c',0 ; DATA XREF: .text:00424FBEo
aHex2str_alloc	db 'hex2str_alloc',0    ; DATA XREF: .text:00424FAEo
		align 4
aPublicKey_2	db 'public-key',0       ; DATA XREF: sub_424FF7+3Fo
aPrivateKey_3	db 'private-key',0      ; DATA XREF: sub_424FF7+63o
aProtectedPri_2	db 'protected-private-key',0 ; DATA XREF: sub_424FF7+87o
aShadowedPriv_2	db 'shadowed-private-key',0 ; DATA XREF: sub_424FF7+ABo
aEn		db 'en',0               ; DATA XREF: sub_424FF7:loc_42518Eo
byte_445FB9	db 3 dup(0)		; DATA XREF: sub_424FF7+1A9o
aSshRsa_0	db 7,'ssh-rsa',0
aPqgy_0		db 'pqgy',0             ; DATA XREF: sub_424FF7:loc_4251B5o
word_445FCA	dw 0			; DATA XREF: sub_424FF7+1D0o
		dd 73730700h, 73642D68h
aSq:					; DATA XREF: sub_424FF7:loc_4251DCo
					; sub_424FF7+1F7o
		unicode	0, <sq>,0
		dw 1300h
aEcdsaSha2Nis_2	db 'ecdsa-sha2-nistp',0
aCurve_1	db 'curve',0            ; DATA XREF: sub_424FF7+20Fo
byte_445FF3	db 0			; DATA XREF: sub_424FF7+22Bo
					; sub_424FF7+270o ...
aNistP256_0	db 'NIST P-256',0       ; DATA XREF: sub_424FF7+281o
aNistp256_0	db 'nistp256',0         ; DATA XREF: sub_424FF7+2A9o
a256		db '256',0              ; DATA XREF: sub_424FF7+2D7o
		dd 6E080000h, 70747369h, 363532h
aNistP384_0	db 'NIST P-384',0       ; DATA XREF: sub_424FF7+2F1o
aNistp384_0	db 'nistp384',0         ; DATA XREF: sub_424FF7+319o
a384		db '384',0              ; DATA XREF: sub_424FF7+347o
		dd 6E080000h, 70747369h, 343833h
aNistP521_0	db 'NIST P-521',0       ; DATA XREF: sub_424FF7+35Eo
aNistp521_0	db 'nistp521',0         ; DATA XREF: sub_424FF7+386o
a521		db '521',0              ; DATA XREF: sub_424FF7+3B4o
		dd 6E080000h, 70747369h, 313235h
aEstream_asprin	db 'estream_asprintf failed: %s',0Ah,0 ; DATA XREF: .text:004256E4o
		align 10h
a02x_1		db '%%%02X',0           ; DATA XREF: .text:004257EAo
		align 4
; char a____Gnupg22_15[]
a____Gnupg22_15	db '../../gnupg2-2.0.30/common/percent.c',0 ; DATA XREF: sub_4259D7+5Eo
; char aNNbytes[]
aNNbytes	db 'n == nbytes',0      ; DATA XREF: sub_4259D7+66o
		align 4
; char a____Gnupg22_16[]
a____Gnupg22_16	db '../../gnupg2-2.0.30/common/estream.c',0 ; DATA XREF: sub_4261C6+4Do
					; sub_4261C6+1CBo ...
		align 4
; char aMem_cookieMemo[]
aMem_cookieMemo	db 'mem_cookie->memory_size >= mem_cookie->offset',0
					; DATA XREF: sub_4261C6+55o
					; sub_4261C6+1D3o
; char aSizeNleft[]
aSizeNleft	db 'size <= nleft',0    ; DATA XREF: sub_4261C6+20Co
; char aStreamFlags_wr[]
aStreamFlags_wr	db 'stream->flags.writing',0 ; DATA XREF: sub_426DE5+35o
; char aStreamFlags__0[]
aStreamFlags__0	db '!stream->flags.writing',0 ; DATA XREF: sub_426F7E+24o
aR_4		db 'r',0                ; DATA XREF: .text:00428D9Co
					; .text:00428E44o ...
aA_2		db 'a',0                ; DATA XREF: .text:00428DD7o
					; .text:00428E0Co ...
		align 4
aFatalErrorCrea	db 'fatal: error creating a dummy estream for %d: %s',0Ah,0
					; DATA XREF: .text:00428F09o
aStdout_0	db '[stdout]',0         ; DATA XREF: .text:00428FA6o
aStderr		db '[stderr]',0         ; DATA XREF: .text:loc_428FADo
aStdin_0	db '[stdin]',0          ; DATA XREF: .text:loc_428FB4o
a_estream	db '_estream',0         ; DATA XREF: sub_42A9D2+BAo
a_tmp_0		db '.tmp',0             ; DATA XREF: sub_42A9D2+165o
a?_0		db '[?]',0              ; DATA XREF: .text:0042B20Do
aX02x		db 'x%02x',0            ; DATA XREF: sub_42B219+338o
; char aR_5[]
aR_5		db 'r',0                ; DATA XREF: sub_42B9D7+48o
; char aCanTOpenSS_2[]
aCanTOpenSS_2	db 'can',27h,'t open `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_42B9D7+8Co
; char aFileSLineDS_0[]
aFileSLineDS_0	db 'file `%s',27h,', line %d: %s',0Ah,0 ; DATA XREF: sub_42B9D7+144o
					; sub_42B9D7+21Ao
; char aIgnoringGarbag[]
aIgnoringGarbag	db 'ignoring garbage line',0 ; DATA XREF: sub_42B9D7:loc_42BBE3o
asc_4461FD	db 0Ah,0		; DATA XREF: sub_42B9D7+34Fo
		align 10h
; char aErrorReading_0[]
aErrorReading_0	db 'error reading `%s',27h,', line %d: %s',0Ah,0
					; DATA XREF: sub_42B9D7+3C0o
byte_446221	db 0			; DATA XREF: sub_42B9D7+438o
					; sub_42BFF3+36o
a_txt		db '.txt',0             ; DATA XREF: sub_42BE4C+A5o
					; sub_42BE4C:loc_42BF76o
aTxt		db 'txt',0              ; DATA XREF: sub_42BE4C:loc_42BFBDo
		align 4
aInvalidSExpInC	db 'invalid S-exp in cmp_simple_canon_sexp',0Ah,0
					; DATA XREF: .text:loc_42C54Do
					; .text:loc_42C5BBo
aSigVal		db 'sig-val',0          ; DATA XREF: .text:loc_42C863o
aHash_1		db 'hash',0             ; DATA XREF: .text:loc_42C90Eo
aU_0		db '%u:',0              ; DATA XREF: .text:0042CA66o
					; .text:0042CA8Bo
aPublicKey_3	db 'public-key',0       ; DATA XREF: .text:0042CD1Eo
					; .text:0042D118o
aRsa_1		db 'rsa',0              ; DATA XREF: .text:0042CDDCo
					; .text:0042D1E7o
aDsa_0		db 'dsa',0              ; DATA XREF: .text:0042D21Bo
aElg_0		db 'elg',0              ; DATA XREF: .text:0042D24Co
aEcdsa		db 'ecdsa',0            ; DATA XREF: .text:0042D27Do
		align 4
; char a____Gnupg22_17[]
a____Gnupg22_17	db '../../gnupg2-2.0.30/common/iobuf.c',0 ; DATA XREF: sub_42D422+1Bo
					; sub_42D5F2+15o ...
; char aFname[]
aFname		db 'fname',0            ; DATA XREF: sub_42D422+23o
					; sub_42D757+1Co
; char aFd_cache_inval[]
aFd_cache_inval	db 'fd_cache_invalidate (%s)',0Ah,0 ; DATA XREF: sub_42D422+3Fo
; char aDidS[]
aDidS		db '                did (%s)',0Ah,0 ; DATA XREF: sub_42D422+8Co
; char aFp[]
aFp		db 'fp',0               ; DATA XREF: sub_42D5F2+1Do
; char aFd_cache_close[]
aFd_cache_close	db 'fd_cache_close (%d) real',0Ah,0 ; DATA XREF: sub_42D5F2+5Do
		align 10h
; char aFd_cache_clo_0[]
aFd_cache_clo_0	db 'fd_cache_close (%s) used existing slot',0Ah,0
					; DATA XREF: sub_42D5F2+B9o
; char aFd_cache_clo_1[]
aFd_cache_clo_1	db 'fd_cache_close (%s) new slot created',0Ah,0 ; DATA XREF: sub_42D5F2+E8o
		align 10h
; char aFd_cache_openS[]
aFd_cache_openS	db 'fd_cache_open (%s) using cached fp',0Ah,0 ; DATA XREF: sub_42D757+84o
; char aRewindFileFail[]
aRewindFileFail	db 'rewind file failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: sub_42D757+CFo
; char aFd_cache_ope_0[]
aFd_cache_ope_0	db 'fd_cache_open (%s) not cached',0Ah,0 ; DATA XREF: sub_42D757+109o
; char aSize[]
aSize		db 'size',0             ; DATA XREF: sub_42D880+4Ao
					; sub_42DB2C+42o ...
; char aSReadErrorEcD[]
aSReadErrorEcD	db '%s: read error: ec=%d',0Ah,0 ; DATA XREF: sub_42D880+DCo
; char aSWriteErrorEcD[]
aSWriteErrorEcD	db '%s: write error: ec=%d',0Ah,0 ; DATA XREF: sub_42D880+197o
aFile_filterFd	db 'file_filter(fd)',0  ; DATA XREF: sub_42D880+205o
; char aSCloseHandleP[]
aSCloseHandleP	db '%s: close handle %p',0Ah,0 ; DATA XREF: sub_42D880+260o
; char aSocketReadErro[]
aSocketReadErro	db 'socket read error: ec=%d',0Ah,0 ; DATA XREF: sub_42DB2C+BDo
; char aSocketWriteErr[]
aSocketWriteErr	db 'socket write error: ec=%d',0Ah,0 ; DATA XREF: sub_42DB2C+167o
aSock_filter	db 'sock_filter',0      ; DATA XREF: sub_42DB2C+1CFo
		align 4
; char aBlock_filter1s[]
aBlock_filter1s	db 'block_filter: 1st length byte missing',0Ah,0
					; DATA XREF: sub_42DD35+141o
		align 10h
; char aBlock_filter2n[]
aBlock_filter2n	db 'block_filter: 2nd length byte missing',0Ah,0
					; DATA XREF: sub_42DD35+229o
		align 4
; char aBlock_filterIn[]
aBlock_filterIn	db 'block_filter: invalid 4 byte length',0Ah,0 ; DATA XREF: sub_42DD35+452o
		align 10h
; char aBlock_filterPR[]
aBlock_filterPR	db 'block_filter %p: read error (size=%lu,a->size=%lu)',0Ah,0
					; DATA XREF: sub_42DD35+551o
; char aABuflenOp_min_[]
aABuflenOp_min_	db 'a->buflen <= OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_42DD35+60Do
; char aC0x1f[]
aC0x1f		db 'c <= 0x1f',0        ; DATA XREF: sub_42DD35+6C3o
; char aNOp_min_partia[]
aNOp_min_partia	db 'n == OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_42DD35+710o
; char aABuflen[]
aABuflen	db '!a->buflen',0       ; DATA XREF: sub_42DD35+7E0o
; char aNbytesOp_min_p[]
aNbytesOp_min_p	db 'nbytes < OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_42DD35+805o
; char aInitBlock_filt[]
aInitBlock_filt	db 'init block_filter %p',0Ah,0 ; DATA XREF: sub_42DD35+88Fo
aBlock_filter_0	db 'block_filter',0     ; DATA XREF: sub_42DD35+90Bo
		align 4
; char aBlock_filterWr[]
aBlock_filterWr	db 'block_filter: write error: %s',0Ah,0 ; DATA XREF: sub_42DD35+AA1o
; char aBlock_filterPe[]
aBlock_filterPe	db 'block_filter: pending bytes!',0Ah,0 ; DATA XREF: sub_42DD35+AFFo
; char aFreeBlock_filt[]
aFreeBlock_filt	db 'free block_filter %p',0Ah,0 ; DATA XREF: sub_42DD35+B1Bo
aNone_2		db '[none]',0           ; DATA XREF: sub_42E870+22o
a?_1		db '?',0                ; DATA XREF: sub_42E870:loc_42E8F4o
					; sub_42E9D9:loc_42EAA8o ...
; char aIobufChainD_DS[]
aIobufChainD_DS	db 'iobuf chain: %d.%d `%s',27h,' filter_eof=%d start=%d len=%d',0Ah,0
					; DATA XREF: sub_42E870+ADo
; char aIobuf_closeP[]
aIobuf_closeP	db 'iobuf_close -> %p',0Ah,0 ; DATA XREF: sub_42E9D9+5Co
		align 10h
; char aIobuf_flushFai[]
aIobuf_flushFai	db 'iobuf_flush failed on close: %s',0Ah,0 ; DATA XREF: sub_42E9D9+A8o
; char aIobufD_DCloseS[]
aIobufD_DCloseS	db 'iobuf-%d.%d: close `%s',27h,0Ah,0 ; DATA XREF: sub_42E9D9+ECo
		align 4
; char aIobufctrl_free[]
aIobufctrl_free	db 'IOBUFCTRL_FREE failed on close: %s',0Ah,0 ; DATA XREF: sub_42E9D9+14Co
aStdin_1	db '[stdin]',0          ; DATA XREF: sub_42EDF1+46o
; char aRb_1[]
aRb_1		db 'rb',0               ; DATA XREF: sub_42EDF1+7Do
					; sub_42EDF1:loc_42EE83o
; char aIobufD_DOpenSF[]
aIobufD_DOpenSF	db 'iobuf-%d.%d: open `%s',27h,' fd=%d',0Ah,0 ; DATA XREF: sub_42EDF1+1D3o
; char aFdD[]
aFdD		db '[fd %d]',0          ; DATA XREF: sub_42EFD8+63o
; char aIobufD_DFdopen[]
aIobufD_DFdopen	db 'iobuf-%d.%d: fdopen `%s',27h,0Ah,0 ; DATA XREF: sub_42EFD8+111o
aSockD		db '[sock %d]',0        ; DATA XREF: .text:0042F17Ao
aIobufD_DSockop	db 'iobuf-%d.%d: sockopen `%s',27h,0Ah,0 ; DATA XREF: .text:0042F228o
aStdout_1	db '[stdout]',0         ; DATA XREF: .text:0042F29Bo
aWb_0		db 'wb',0               ; DATA XREF: .text:0042F2D2o
					; .text:loc_42F2E7o
aIobufD_DCreate	db 'iobuf-%d.%d: create `%s',27h,0Ah,0 ; DATA XREF: .text:0042F431o
aRB_0		db 'r+b',0              ; DATA XREF: .text:loc_42F45Co
aIobufD_DOpenrw	db 'iobuf-%d.%d: openrw `%s',27h,0Ah,0 ; DATA XREF: .text:0042F597o
		align 4
; char aIobufD_DIoctlS[]
aIobufD_DIoctlS	db 'iobuf-%d.%d: ioctl `%s',27h,' keep=%d',0Ah,0 ; DATA XREF: sub_42F5AC+74o
		align 4
; char aIobuf_IoctlSIn[]
aIobuf_IoctlSIn	db 'iobuf-*.*: ioctl `%s',27h,' invalidate',0Ah,0
					; DATA XREF: sub_42F5AC+11Fo
		align 10h
; char aIobufD_DIoct_0[]
aIobufD_DIoct_0	db 'iobuf-%d.%d: ioctl `%s',27h,' no_cache=%d',0Ah,0
					; DATA XREF: sub_42F5AC+1D9o
aNull_1		db '<null>',0           ; DATA XREF: sub_42F5AC:loc_42F821o
; char aIobuf_IoctlSFs[]
aIobuf_IoctlSFs	db 'iobuf-*.*: ioctl `%s',27h,' fsync',0Ah,0 ; DATA XREF: sub_42F5AC+27Eo
		align 4
; char aIOFilterTooDee[]
aIOFilterTooDee	db 'i/o filter too deeply nested - corrupted data?',0Ah,0
					; DATA XREF: sub_42F889+6Eo
; char aIobufD_DPushS[]
aIobufD_DPushS	db 'iobuf-%d.%d: push `%s',27h,0Ah,0 ; DATA XREF: sub_42F889+2B9o
; char aIobufctrl_init[]
aIobufctrl_init	db 'IOBUFCTRL_INIT failed: %s',0Ah,0 ; DATA XREF: sub_42F889+324o
; char aIobufD_DPopS[]
aIobufD_DPopS	db 'iobuf-%d.%d: pop `%s',27h,0Ah,0 ; DATA XREF: sub_42FBC4+75o
; char aB[]
aB		db 'b',0                ; DATA XREF: sub_42FBC4+AEo
; char aPop_filterFilt[]
aPop_filterFilt	db 'pop_filter(): filter function not found',0Ah,0
					; DATA XREF: sub_42FBC4+194o
		align 4
; char aIobuf_flushF_0[]
aIobuf_flushF_0	db 'iobuf_flush failed in pop_filter: %s',0Ah,0 ; DATA XREF: sub_42FBC4+1CDo
; char aIobufctrl_fr_0[]
aIobufctrl_fr_0	db 'IOBUFCTRL_FREE failed: %s',0Ah,0 ; DATA XREF: sub_42FBC4+235o
					; sub_42FF5B+39Co
		align 4
; char aCanTRemoveTheL[]
aCanTRemoveTheL	db 'can',27h,'t remove the last filter from the chain',0Ah,0
					; DATA XREF: sub_42FBC4+287o
; char aIobufD_DPopped[]
aIobufD_DPopped	db 'iobuf-%d.%d: popped filter',0Ah,0 ; DATA XREF: sub_42FBC4+35Co
		align 4
; char aOhhJeeeTryingT[]
aOhhJeeeTryingT	db 'Ohh jeee, trying to remove a head filter',0Ah,0
					; DATA XREF: sub_42FBC4+374o
		align 10h
; char aOhhJeeeTryin_0[]
aOhhJeeeTryin_0	db 'Ohh jeee, trying to remove an intermediate filter',0Ah,0
					; DATA XREF: sub_42FBC4:loc_42FF44o
; char aAD_startAD_len[]
aAD_startAD_len	db 'a->d.start == a->d.len',0 ; DATA XREF: sub_42FF5B+29o
		align 4
; char aIobufD_DPopSIn[]
aIobufD_DPopSIn	db 'iobuf-%d.%d: pop `%s',27h,' in underflow',0Ah,0
					; DATA XREF: sub_42FF5B+A6o
; char aIobufD_DUnderf[]
aIobufD_DUnderf	db 'iobuf-%d.%d: underflow: eof (due to filter eof)',0Ah,0
					; DATA XREF: sub_42FF5B+17Do
; char aIobufD_DError[]
aIobufD_DError	db 'iobuf-%d.%d: error',0Ah,0 ; DATA XREF: sub_42FF5B+1BAo
		align 4
; char aIobufD_DUnde_0[]
aIobufD_DUnde_0	db 'iobuf-%d.%d: underflow: req=%lu',0Ah,0 ; DATA XREF: sub_42FF5B+2B9o
		align 4
; char aIobufD_DUnde_1[]
aIobufD_DUnde_1	db 'iobuf-%d.%d: underflow: got=%lu rc=%d',0Ah,0
					; DATA XREF: sub_42FF5B+327o
		align 4
; char aIobufD_DPopInU[]
aIobufD_DPopInU	db 'iobuf-%d.%d: pop in underflow (!len)',0Ah,0 ; DATA XREF: sub_42FF5B+43Bo
; char aIobufD_DUnde_2[]
aIobufD_DUnde_2	db 'iobuf-%d.%d: underflow: eof',0Ah,0 ; DATA XREF: sub_42FF5B+521o
		align 4
; char aIobufD_DUnde_3[]
aIobufD_DUnde_3	db 'iobuf-%d.%d: underflow: eof (no filter)',0Ah,0
					; DATA XREF: sub_42FF5B+584o
		align 4
; char aIncreasingTemp[]
aIncreasingTemp	db 'increasing temp iobuf from %lu to %lu',0Ah,0 ; DATA XREF: sub_4304F8+52o
; char aFlushOnNonOutp[]
aFlushOnNonOutp	db 'flush on non-output iobuf',0Ah,0 ; DATA XREF: sub_4304F8+C1o
; char aIobuf_flushNoF[]
aIobuf_flushNoF	db 'iobuf_flush: no filter',0Ah,0 ; DATA XREF: sub_4304F8+D7o
		align 10h
; char aIobuf_flushDid[]
aIobuf_flushDid	db 'iobuf_flush did not write all!',0Ah,0 ; DATA XREF: sub_4304F8+136o
aAD_start1	db 'a->d.start == 1',0  ; DATA XREF: .text:00430931o
; char aAD_lenAD_size[]
aAD_lenAD_size	db 'a->d.len < a->d.size',0 ; DATA XREF: sub_43098D+75o
; char aFstatFailedS[]
aFstatFailedS	db 'fstat() failed: %s',0Ah,0 ; DATA XREF: sub_430C9C+6Co
; CHAR aKernel32_dll[]
aKernel32_dll	db 'kernel32.dll',0     ; DATA XREF: sub_430C9C+C8o
; CHAR aGetfilesizeex[]
aGetfilesizeex	db 'GetFileSizeEx',0    ; DATA XREF: sub_430C9C+DDo
; char aGetfilesizeFor[]
aGetfilesizeFor	db 'GetFileSize for handle %p failed: %s',0Ah,0 ; DATA XREF: sub_430C9C+1A9o
aCanTSeekS	db 'can',27h,'t seek: %s',0Ah,0 ; DATA XREF: .text:00430F5Co
		align 4
aSetfilepointer	db 'SetFilePointer failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: .text:00431007o
		align 4
aPop_filterCall	db 'pop_filter called in iobuf_seek - please report',0Ah,0
					; DATA XREF: .text:00431087o
aAUse1AUse2	db 'a->use == 1 || a->use == 2',0 ; DATA XREF: .text:004311B4o
aPop_filterCa_0	db 'pop_filter called in set_partial_block_mode - please report',0Ah,0
					; DATA XREF: .text:004311DDo
		align 4
; char aGetstdhandleDF[]
aGetstdhandleDF	db 'GetStdHandle(%d) failed: ec=%d',0Ah,0 ; DATA XREF: sub_43141E+78o
aIobuf_write	db 'iobuf_write',0      ; DATA XREF: sub_430A32+16o
aIobuf_writebyt	db 'iobuf_writebyte',0  ; DATA XREF: sub_43098D+10o
aPop_filter	db 'pop_filter',0       ; DATA XREF: sub_42FBC4+21o
aIobuf_push_fil	db 'iobuf_push_filter2',0 ; DATA XREF: sub_42F889+21o
aBlock_filter	db 'block_filter',0     ; DATA XREF: sub_42DD35:loc_42E208o
					; sub_42DD35:loc_42E58Eo ...
		align 4
byte_446CEC	db 0			; DATA XREF: sub_4315D4+16o
					; sub_4315D4:loc_431643o
aC_0		db 'C',0                ; DATA XREF: sub_4315D4+24o
aPosix		db 'POSIX',0            ; DATA XREF: sub_4315D4+4Co
		align 4
asc_446CF8	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:00432116o
					; .text:004321AEo
a_		db '.',0                ; DATA XREF: .text:0043229Bo
		align 10h
a____Gnupg22_18	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_432302+A0o
; char aHome_0[]
aHome_0		db 'HOME',0             ; DATA XREF: sub_432302:loc_432423o
; char aX02x_0[]
aX02x_0		db 'x%02x',0            ; DATA XREF: sub_4328B7+164o
					; sub_432C6B+1B0o
word_446D32	dw 0			; DATA XREF: .text:004336FBo
					; sub_43372E+Co
aFatalTooManyAr	db 0Ah			; DATA XREF: sub_43372E+56o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: sub_43372E+81o
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_432302+90o
		align 4
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: sub_4337E4+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_4337E4:loc_433837o
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_4337E4:loc_4338A2o
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_4337E4:loc_4338ACo
aAm_et		db 'am_ET',0            ; DATA XREF: sub_4337E4:loc_4338B6o
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_4337E4:loc_4338D9o
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_4337E4:loc_4338E3o
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_4337E4:loc_4338EDo
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_4337E4:loc_4338F7o
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_4337E4:loc_433901o
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_4337E4:loc_43390Bo
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_4337E4:loc_433915o
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_4337E4:loc_43391Fo
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_4337E4:loc_433929o
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_4337E4:loc_433933o
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_4337E4:loc_43393Do
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_4337E4:loc_433947o
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_4337E4:loc_433951o
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_4337E4:loc_43395Bo
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_4337E4:loc_433965o
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_4337E4:loc_43396Fo
aAr		db 'ar',0               ; DATA XREF: sub_4337E4:loc_433979o
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_4337E4:loc_433983o
aAs_in		db 'as_IN',0            ; DATA XREF: sub_4337E4:loc_43398Do
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_4337E4:loc_4339A6o
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_4337E4:loc_4339B0o
aAz		db 'az',0               ; DATA XREF: sub_4337E4:loc_4339BAo
aEu		db 'eu',0               ; DATA XREF: sub_4337E4:loc_4339C4o
aBe_by		db 'be_BY',0            ; DATA XREF: sub_4337E4:loc_4339CEo
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_4337E4:loc_4339E7o
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_4337E4:loc_4339F1o
aBn		db 'bn',0               ; DATA XREF: sub_4337E4:loc_4339FBo
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_4337E4:loc_433A05o
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_4337E4:loc_433A0Fo
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_4337E4:loc_433A19o
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_4337E4:loc_433A23o
aChr_us		db 'chr_US',0           ; DATA XREF: sub_4337E4:loc_433A2Do
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_4337E4:loc_433A4Co
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_4337E4:loc_433A56o
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_4337E4:loc_433A60o
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_4337E4:loc_433A6Ao
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_4337E4:loc_433A74o
aZh		db 'zh',0               ; DATA XREF: sub_4337E4:loc_433A7Eo
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_4337E4+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_4337E4:loc_433AA4o
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_4337E4:loc_433AAEo
aHr		db 'hr',0               ; DATA XREF: sub_4337E4:loc_433AB8o
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_4337E4:loc_433AC2o
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_4337E4:loc_433ACCo
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_4337E4:loc_433AD6o
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_4337E4:loc_433AEFo
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_4337E4:loc_433AF9o
aNl		db 'nl',0               ; DATA XREF: sub_4337E4:loc_433B03o
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_4337E4:loc_433B0Do
aEn_us		db 'en_US',0            ; DATA XREF: sub_4337E4:loc_433B30o
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_4337E4:loc_433B3Ao
aEn_au		db 'en_AU',0            ; DATA XREF: sub_4337E4:loc_433B44o
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_4337E4:loc_433B4Eo
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_4337E4:loc_433B58o
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_4337E4:loc_433B62o
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_4337E4:loc_433B6Co
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_4337E4:loc_433B76o
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_4337E4:loc_433B80o
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_4337E4:loc_433B8Ao
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_4337E4:loc_433B94o
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_4337E4:loc_433B9Eo
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_4337E4:loc_433BA8o
aEn_id		db 'en_ID',0            ; DATA XREF: sub_4337E4:loc_433BB2o
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_4337E4:loc_433BBCo
aEn_in		db 'en_IN',0            ; DATA XREF: sub_4337E4:loc_433BC6o
aEn_my		db 'en_MY',0            ; DATA XREF: sub_4337E4:loc_433BD0o
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_4337E4:loc_433BDAo
aEn_0		db 'en',0               ; DATA XREF: sub_4337E4:loc_433BE4o
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_4337E4:loc_433BEEo
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_4337E4:loc_433BF8o
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_4337E4:loc_433C02o
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_4337E4:loc_433C0Co
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_4337E4:loc_433C2Fo
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_4337E4:loc_433C39o
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_4337E4:loc_433C43o
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_4337E4:loc_433C4Do
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_4337E4:loc_433C57o
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_4337E4:loc_433C61o
aFr		db 'fr',0               ; DATA XREF: sub_4337E4:loc_433C6Bo
					; sub_4337E4:loc_433CC5o
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_4337E4:loc_433C75o
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_4337E4:loc_433C7Fo
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_4337E4:loc_433C89o
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_4337E4:loc_433C93o
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_4337E4:loc_433C9Do
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_4337E4:loc_433CA7o
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_4337E4:loc_433CB1o
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_4337E4:loc_433CBBo
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_4337E4:loc_433CCFo
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_4337E4:loc_433CD9o
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_4337E4:loc_433CF2o
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_4337E4:loc_433CFCo
aC_1		db 'C',0                ; DATA XREF: sub_4337E4:loc_433D06o
					; sub_4337E4:loc_434324o
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_4337E4:loc_433D10o
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_4337E4:loc_433D1Ao
aDe_de		db 'de_DE',0            ; DATA XREF: sub_4337E4:loc_433D39o
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_4337E4:loc_433D43o
aDe_at		db 'de_AT',0            ; DATA XREF: sub_4337E4:loc_433D4Do
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_4337E4:loc_433D57o
aDe_li		db 'de_LI',0            ; DATA XREF: sub_4337E4:loc_433D61o
aDe		db 'de',0               ; DATA XREF: sub_4337E4:loc_433D6Bo
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_4337E4:loc_433D75o
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_4337E4:loc_433D7Fo
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_4337E4:loc_433D89o
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_4337E4:loc_433D93o
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_4337E4:loc_433D9Do
aHe_il		db 'he_IL',0            ; DATA XREF: sub_4337E4:loc_433DA7o
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_4337E4:loc_433DB1o
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_4337E4:loc_433DBBo
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_4337E4:loc_433DC5o
aIs_is		db 'is_IS',0            ; DATA XREF: sub_4337E4:loc_433DCFo
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_4337E4:loc_433DD9o
aId_id		db 'id_ID',0            ; DATA XREF: sub_4337E4:loc_433DE3o
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_4337E4:loc_433DEDo
aIt_it		db 'it_IT',0            ; DATA XREF: sub_4337E4:loc_433E06o
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_4337E4:loc_433E10o
aIt		db 'it',0               ; DATA XREF: sub_4337E4:loc_433E1Ao
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_4337E4:loc_433E24o
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_4337E4:loc_433E2Eo
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_4337E4:loc_433E38o
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_4337E4:loc_433E51o
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_4337E4:loc_433E5Bo
aKs		db 'ks',0               ; DATA XREF: sub_4337E4:loc_433E65o
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_4337E4:loc_433E6Fo
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_4337E4:loc_433E79o
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_4337E4:loc_433E83o
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_4337E4:loc_433E8Do
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_4337E4:loc_433E97o
aLa_va		db 'la_VA',0            ; DATA XREF: sub_4337E4:loc_433EA1o
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_4337E4:loc_433EABo
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_4337E4:loc_433EB5o
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_4337E4:loc_433EBFo
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_4337E4:loc_433ED8o
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_4337E4:loc_433EE2o
aMs		db 'ms',0               ; DATA XREF: sub_4337E4:loc_433EECo
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_4337E4:loc_433EF6o
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_4337E4:loc_433F00o
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_4337E4:loc_433F0Ao
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_4337E4:loc_433F14o
aMn		db 'mn',0               ; DATA XREF: sub_4337E4:loc_433F1Eo
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_4337E4:loc_433F37o
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_4337E4:loc_433F41o
aNe_0		db 'ne',0               ; DATA XREF: sub_4337E4:loc_433F4Bo
aNo_no		db 'no_NO',0            ; DATA XREF: sub_4337E4:loc_433F64o
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_4337E4:loc_433F6Eo
aNo_0		db 'no',0               ; DATA XREF: sub_4337E4:loc_433F78o
aOr_in		db 'or_IN',0            ; DATA XREF: sub_4337E4:loc_433F82o
aOm_et		db 'om_ET',0            ; DATA XREF: sub_4337E4:loc_433F8Co
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_4337E4:loc_433F96o
aPs		db 'ps',0               ; DATA XREF: sub_4337E4:loc_433FA0o
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_4337E4:loc_433FAAo
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_4337E4+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_4337E4:loc_433FCBo
aPt		db 'pt',0               ; DATA XREF: sub_4337E4:loc_433FD5o
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_4337E4+803o
aPa		db 'pa',0               ; DATA XREF: sub_4337E4:loc_433FF1o
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_4337E4:loc_433FFBo
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_4337E4+829o
aRo		db 'ro',0               ; DATA XREF: sub_4337E4:loc_434017o
aRu		db 'ru',0               ; DATA XREF: sub_4337E4:loc_434021o
aSe_no		db 'se_NO',0            ; DATA XREF: sub_4337E4:loc_43402Bo
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_4337E4:loc_434035o
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_4337E4:loc_43404Do
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_4337E4:loc_434057o
aSd		db 'sd',0               ; DATA XREF: sub_4337E4:loc_434061o
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_4337E4:loc_43406Bo
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_4337E4:loc_434075o
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_4337E4:loc_43407Fo
aSo_so		db 'so_SO',0            ; DATA XREF: sub_4337E4:loc_434089o
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_4337E4:loc_434093o
aEs_es		db 'es_ES',0            ; DATA XREF: sub_4337E4:loc_4340B6o
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_4337E4:loc_4340C0o
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_4337E4:loc_4340CAo
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_4337E4:loc_4340D4o
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_4337E4:loc_4340DEo
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_4337E4:loc_4340E8o
aEs_do		db 'es_DO',0            ; DATA XREF: sub_4337E4:loc_4340F2o
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_4337E4:loc_4340FCo
aEs_co		db 'es_CO',0            ; DATA XREF: sub_4337E4:loc_434106o
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_4337E4:loc_434110o
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_4337E4:loc_43411Ao
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_4337E4:loc_434124o
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_4337E4:loc_43412Eo
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_4337E4:loc_434138o
aEs_py		db 'es_PY',0            ; DATA XREF: sub_4337E4:loc_434142o
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_4337E4:loc_43414Co
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_4337E4:loc_434156o
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_4337E4:loc_434160o
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_4337E4:loc_43416Ao
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_4337E4:loc_434174o
aEs		db 'es',0               ; DATA XREF: sub_4337E4:loc_43417Eo
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_4337E4:loc_434188o
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_4337E4:loc_434192o
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_4337E4:loc_4341ABo
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_4337E4:loc_4341B5o
aSv		db 'sv',0               ; DATA XREF: sub_4337E4:loc_4341BFo
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_4337E4:loc_4341C9o
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_4337E4:loc_4341D3o
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_4337E4:loc_4341DDo
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_4337E4:loc_4341F6o
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_4337E4:loc_434200o
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_4337E4:loc_43420Ao
aTa		db 'ta',0               ; DATA XREF: sub_4337E4:loc_434214o
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_4337E4:loc_43421Eo
aTe_in		db 'te_IN',0            ; DATA XREF: sub_4337E4:loc_434228o
aTh_th		db 'th_TH',0            ; DATA XREF: sub_4337E4:loc_434232o
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_4337E4:loc_43423Co
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_4337E4:loc_434254o
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_4337E4:loc_43425Eo
aTi		db 'ti',0               ; DATA XREF: sub_4337E4:loc_434268o
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_4337E4:loc_434272o
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_4337E4:loc_43427Co
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_4337E4:loc_434286o
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_4337E4:loc_434290o
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_4337E4:loc_43429Ao
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_4337E4:loc_4342B3o
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_4337E4:loc_4342BAo
aUr		db 'ur',0               ; DATA XREF: sub_4337E4:loc_4342C1o
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_4337E4:loc_4342D7o
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_4337E4:loc_4342DEo
aUz		db 'uz',0               ; DATA XREF: sub_4337E4:loc_4342E5o
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_4337E4:loc_4342ECo
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_4337E4:loc_4342F3o
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_4337E4:loc_4342FAo
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_4337E4:loc_434301o
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_4337E4:loc_434308o
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_4337E4:loc_43430Fo
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_4337E4:loc_434316o
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_4337E4:loc_43431Do
		align 4
off_4472EC	dd offset loc_434324, offset loc_4338C0, offset	loc_433A05
					; DATA XREF: sub_4337E4+B5o
		dd offset loc_433A23, offset loc_433A37, offset	loc_433AC2 ; jump table	for switch statement
		dd offset loc_433ACC, offset loc_433D24, offset	loc_433D75
		dd offset loc_433B17, offset loc_43409D, offset	loc_433C0C
		dd offset loc_433C16, offset loc_433DA7, offset	loc_433DBB
		dd offset loc_433DCF, offset loc_433DF7, offset	loc_433E24
		dd offset loc_433E83, offset loc_433AE0, offset	loc_433F55
		dd offset loc_433FAA, offset loc_433FB4, offset	loc_433FFB
		dd offset loc_434005, offset loc_434021, offset	loc_433A88
		dd offset loc_434075, offset loc_4338AC, offset	loc_43419C
		dd offset loc_434232, offset loc_434286, offset	loc_4342A4
		dd offset loc_433DE3, offset loc_43429A, offset	loc_4339CE
		dd offset loc_43407F, offset loc_433BEE, offset	loc_433EAB
		dd offset loc_433EB5, offset loc_4341DD, offset	loc_433C02
		dd offset loc_4342F3, offset loc_433983, offset	loc_433997
		dd offset loc_4339C4, offset loc_434093, offset	loc_433EBF
		dd offset loc_434188, offset loc_434272, offset	loc_43427C
		dd offset loc_4342EC, offset loc_434301, offset	loc_43431D
		dd offset loc_4338A2, offset loc_433D1A, offset	loc_433BF8
		dd offset loc_433DB1, offset loc_433F00, offset	loc_43402B
		dd offset loc_433CE3, offset loc_43430F, offset	loc_433EC9
		dd offset loc_433E6F, offset loc_433E8D, offset	loc_434192
		dd offset loc_434290, offset loc_4342C8, offset	loc_43421E
		dd offset loc_4339D8, offset loc_433FDF, offset	loc_433D89
		dd offset loc_433F82, offset loc_434214, offset	loc_434228
		dd offset loc_433E2E, offset loc_433EF6, offset	loc_43398D
		dd offset loc_433F14, offset loc_434035, offset	loc_433F1E
		dd offset loc_43423C, offset loc_4342FA, offset	loc_433A19
		dd offset loc_433E97, offset loc_433A0F, offset	loc_433D10
		dd offset loc_433E79, offset loc_433F0A, offset	loc_43403F
		dd offset loc_4341C9, offset loc_43406B, offset	loc_433A2D
		dd offset loc_433DED, offset loc_4338B6, offset	loc_4341E7
		dd offset loc_433E42, offset loc_433F28, offset	loc_433CCF
		dd offset loc_433FA0, offset loc_4341D3, offset	loc_433AD6
		dd offset loc_433B0D, offset loc_433CD9, offset	loc_433D93
		dd offset loc_433DC5, offset loc_434316, offset	loc_434324
		dd offset loc_434324, offset loc_434324, offset	loc_434324
		dd offset loc_434324, offset loc_433DD9, offset	loc_433E38
		dd offset loc_433F8C, offset loc_434246, offset	loc_433D7F
		dd offset loc_433D9D, offset loc_433EA1, offset	loc_434089
		dd offset loc_434308, offset loc_433F96
off_4474D4	dd offset loc_433979	; DATA XREF: sub_4337E4+ECo
		dd offset loc_4338D9	; jump table for switch	statement
		dd offset loc_4338E3
		dd offset loc_4338ED
		dd offset loc_4338F7
		dd offset loc_433901
		dd offset loc_43390B
		dd offset loc_433915
		dd offset loc_43391F
		dd offset loc_433929
		dd offset loc_433933
		dd offset loc_43393D
		dd offset loc_433947
		dd offset loc_433951
		dd offset loc_43395B
		dd offset loc_433965
		dd offset loc_43396F
off_447518	dd offset loc_433A7E	; DATA XREF: sub_4337E4+25Fo
		dd offset loc_433A4C	; jump table for switch	statement
		dd offset loc_433A56
		dd offset loc_433A60
		dd offset loc_433A6A
		dd offset loc_433A74
off_447530	dd offset loc_433BE4	; DATA XREF: sub_4337E4+343o
		dd offset loc_433B30	; jump table for switch	statement
		dd offset loc_433B3A
		dd offset loc_433B44
		dd offset loc_433B4E
		dd offset loc_433B58
		dd offset loc_433B62
		dd offset loc_433B6C
		dd offset loc_433B76
		dd offset loc_433B80
		dd offset loc_433B8A
		dd offset loc_433B94
		dd offset loc_433B9E
		dd offset loc_433BA8
		dd offset loc_433BB2
		dd offset loc_433BBC
		dd offset loc_433BC6
		dd offset loc_433BD0
		dd offset loc_433BDA
off_44757C	dd offset loc_433CC5	; DATA XREF: sub_4337E4+442o
		dd offset loc_433C2F	; jump table for switch	statement
		dd offset loc_433C39
		dd offset loc_433C43
		dd offset loc_433C4D
		dd offset loc_433C57
		dd offset loc_433C61
		dd offset loc_433C6B
		dd offset loc_433C75
		dd offset loc_433C7F
		dd offset loc_433C89
		dd offset loc_433C93
		dd offset loc_433C9D
		dd offset loc_433CA7
		dd offset loc_433CB1
		dd offset loc_433CBB
off_4475BC	dd offset loc_433D6B	; DATA XREF: sub_4337E4+54Co
		dd offset loc_433D39	; jump table for switch	statement
		dd offset loc_433D43
		dd offset loc_433D4D
		dd offset loc_433D57
		dd offset loc_433D61
off_4475D4	dd offset loc_43417E	; DATA XREF: sub_4337E4+8C9o
		dd offset loc_4340B6	; jump table for switch	statement
		dd offset loc_4340C0
		dd offset loc_4340CA
		dd offset loc_4340D4
		dd offset loc_4340DE
		dd offset loc_4340E8
		dd offset loc_4340F2
		dd offset loc_4340FC
		dd offset loc_434106
		dd offset loc_434110
		dd offset loc_43411A
		dd offset loc_434124
		dd offset loc_43412E
		dd offset loc_434138
		dd offset loc_434142
		dd offset loc_43414C
		dd offset loc_434156
		dd offset loc_434160
		dd offset loc_43416A
		dd offset loc_434174
; char aRb_2[3]
aRb_2		db 'rb',0               ; DATA XREF: sub_43440A+16o
; char aLc_messages_0[]
aLc_messages_0	db 'LC_MESSAGES',0      ; DATA XREF: sub_4349AE+16o
					; sub_4352FB+6o
aLc_messages_1	db '\LC_MESSAGES\',0    ; DATA XREF: sub_4349AE+1AAo
a_mo		db '.mo',0              ; DATA XREF: sub_4349AE+202o
		align 4
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_434C08+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_434C6E+13Do
					; sub_434C6E:loc_434ED1o
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_434C6E:loc_434F45o
byte_4476AB	db 0			; DATA XREF: sub_4352FB:loc_43531Bo
asc_4476AC	db '-',0                ; DATA XREF: sub_435365+55o
					; sub_4355C4:loc_4355D5o
aSocket		db 'socket://',0        ; DATA XREF: sub_435365+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_435365+FDo
; char aA_3[]
aA_3		db 'a',0                ; DATA XREF: sub_435365+131o
					; sub_435365:loc_4354D5o
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_435365+1B1o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_435365+1E9o
		align 4
; char a____Gnupg22_19[]
a____Gnupg22_19	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_435786+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_435786+37o
		align 4
; char a04d02d02d02d_0[]
a04d02d02d02d_0	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_435786+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_435786+16Bo
; char aU_1[]
aU_1		db '[%u]',0             ; DATA XREF: sub_435786+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_435786+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_435786+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_435786+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_435786:loc_435A18o
		align 4
off_4477DC	dd offset loc_435A37	; DATA XREF: sub_435786+20Eo
		dd offset loc_435A37	; jump table for switch	statement
		dd offset loc_435A37
		dd offset loc_435A37
		dd offset loc_435A37
		dd offset loc_43599D
		dd offset loc_4359C6
		dd offset loc_4359EF
; char dword_4477FC[]
dword_4477FC	dd 207325h		; DATA XREF: sub_435C74+1Do
; char a02x_2[]
a02x_2		db '%02X',0             ; DATA XREF: sub_435C74+42o
; char a02x_3[]
a02x_3		db ' %02X',0            ; DATA XREF: sub_435C74+65o
; char asc_44780B[]
asc_44780B	db 0Ah,0		; DATA XREF: sub_435C74+8Ao
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_435D0C+1Bo
		align 4
; char aInvalidArgumen[]
aInvalidArgumen	db 'invalid argument for arg_parsee',0Ah,0 ; DATA XREF: sub_435D40+81o
; char aArgumentNotExp[]
aArgumentNotExp	db 'argument not expected',0 ; DATA XREF: sub_435D40+B0o
; char aReadError[]
aReadError	db 'read error',0       ; DATA XREF: sub_435D40+CFo
; char aKeywordTooLong[]
aKeywordTooLong	db 'keyword too long',0 ; DATA XREF: sub_435D40+EEo
; char aMissingArgumen[]
aMissingArgumen	db 'missing argument',0 ; DATA XREF: sub_435D40+10Do
; char aInvalidArgum_0[]
aInvalidArgum_0	db 'invalid argument',0 ; DATA XREF: sub_435D40+129o
; char aInvalidCommand[]
aInvalidCommand	db 'invalid command',0  ; DATA XREF: sub_435D40+145o
; char aInvalidAliasDe[]
aInvalidAliasDe	db 'invalid alias definition',0 ; DATA XREF: sub_435D40+161o
; char aOutOfCore[]
aOutOfCore	db 'out of core',0      ; DATA XREF: sub_435D40+17Do
; char aInvalidOption[]
aInvalidOption	db 'invalid option',0   ; DATA XREF: sub_435D40:loc_435ECEo
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_435D40+1B4o
a??		db '[??]',0             ; DATA XREF: sub_435D40:loc_435F17o
		align 4
; char aMissingArgum_0[]
aMissingArgum_0	db 'missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_435D40+1EAo
		align 10h
; char aInvalidArgum_1[]
aInvalidArgum_1	db 'invalid argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_435D40+215o
		align 4
; char aOption_50sDoes[]
aOption_50sDoes	db 'option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_435D40+240o
; char aInvalidComma_0[]
aInvalidComma_0	db 'invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_435D40+26Bo
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_435D40+296o
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_435D40+2BEo
; char aOutOfCore_0[]
aOutOfCore_0	db 'out of core',0Ah,0  ; DATA XREF: sub_435D40+2E6o
; char aS_1[]
aS_1		db '%s',0Ah,0           ; DATA XREF: sub_435D40+2F6o
; char aInvalidOption_[]
aInvalidOption_	db 'invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_435D40:loc_436044o
; char aIgnoreInvalidO[]
aIgnoreInvalidO	db 'ignore-invalid-option',0 ; DATA XREF: sub_4362AA+15Do
					; sub_4362AA:loc_4368C6o
; char asc_447A07[]
asc_447A07	db ' ',9,0              ; DATA XREF: sub_4362AA+2D3o
; char aAlias[]
aAlias		db 'alias',0            ; DATA XREF: sub_4362AA+5EFo
; char aHelp[]
aHelp		db 'help',0             ; DATA XREF: sub_436C8D+1A6o
; char aVersion_0[]
aVersion_0	db 'version',0          ; DATA XREF: sub_436C8D+1E0o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_436C8D+222o
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_436C8D+266o
; char aS_2[]
aS_2		db '--%s',0Ah,0         ; DATA XREF: sub_436C8D+2B2o
		align 4
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_436C8D+2DEo
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_447A68	db 'x',0                ; DATA XREF: sub_436C8D:loc_437387o
; char aOptions[]
aOptions	db 'Options:',0         ; DATA XREF: sub_437678+CEo
; char aC_2[]
aC_2		db ' -%c',0             ; DATA XREF: sub_437678+1B1o
asc_447A78	db '   ',0              ; DATA XREF: sub_437678+245o
					; sub_437678+332o
; char aCS[]
aCS		db '%c --%s',0          ; DATA XREF: sub_437678:loc_43791Co
; char aASingleDashMay[]
aASingleDashMay	db 0Ah			; DATA XREF: sub_437678+45Co
		db '(A single dash may be used instead of the double ones)',0
; char a_email_[]
a@email@	db '@EMAIL@',0          ; DATA XREF: sub_437678+48Do
aHttpBugs_gnupg	db 'http://bugs.gnupg.org',0 ; DATA XREF: sub_437678+4F0o
; char aS_3[]
aS_3		db ' (%s)',0            ; DATA XREF: sub_437BE3+3Co
; char aSS_1[]
aSS_1		db ' %s %s',0Ah,0       ; DATA XREF: sub_437BE3+5Co
aGpg4win2_3_1	db '(Gpg4win 2.3.1)',0  ; DATA XREF: sub_437BE3+61o
aSSS_0		db '%s %s; %s',0Ah,0    ; DATA XREF: .text:00437DADo
		align 4
aLicenseGplv3Gn	db 'License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licens'
					; DATA XREF: sub_437E99:loc_437EDFo
		db 'es/gpl.html>',0
aFoo		db 'foo',0              ; DATA XREF: sub_437E99:loc_437EE8o
a0_0		db '0.0',0              ; DATA XREF: sub_437E99:loc_437EF1o
		align 4
aCopyrightC2015	db 'Copyright (C) 2015 Free Software Foundation, Inc.',0
					; DATA XREF: sub_437E99:loc_437EFAo
		align 10h
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_437E99:loc_437F03o
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 4
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_437E99:loc_437F0Co
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 3 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_447E60	dd 0			; DATA XREF: sub_437E99:loc_437F15o
off_447E64	dd offset loc_437EDF	; DATA XREF: sub_437E99+3Dr
		dd offset loc_437EE8	; jump table for switch	statement
		dd offset loc_437F1D
		dd offset loc_437EF1
		dd offset loc_437EFA
		dd offset loc_437F03
		dd offset loc_437F0C
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F1D
		dd offset loc_437F15
		dd offset loc_437F15
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_437F30+D9o
					; sub_43802F:loc_438204o ...
aUtf8		db 'utf-8',0            ; DATA XREF: sub_437F30+22o
					; sub_43802F+20Fo ...
		align 4
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_437F30+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_437F30+B1o
; char aCpU[]
aCpU		db 'CP%u',0             ; DATA XREF: sub_43802F:loc_43805Ao
aCp936		db 'CP936',0            ; DATA XREF: sub_43802F+4Eo
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: sub_43802F+13Co
a88591		db '8859-1',0           ; DATA XREF: sub_43802F+179o
a646		db '646',0              ; DATA XREF: sub_43802F+190o
aAscii		db 'ASCII',0            ; DATA XREF: sub_43802F+1A7o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: sub_43802F+1BEo
aUtf8_0		db 'utf8',0             ; DATA XREF: sub_43802F:loc_438227o
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_438345+1EEo
					; sub_438591+730o
; char aX02x_1[]
aX02x_1		db '\x%02x',0           ; DATA XREF: sub_438591+7Co
					; sub_438591+3AFo ...
; char aX02x_2[]
aX02x_2		db 'x%02x',0            ; DATA XREF: sub_438591+1DCo
		align 4
a____Gnupg22_20	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_438591+6BEo
		align 4
off_4480DC	dd offset loc_438744	; DATA XREF: sub_438591+12Ar
		dd offset loc_43875A	; jump table for switch	statement
		dd offset loc_43875A
		dd offset loc_43875A
		dd offset loc_43875A
		dd offset loc_43875A
		dd offset loc_43875A
		dd offset loc_43875A
		dd offset loc_43872E
		dd offset loc_43875A
		dd offset loc_4386C4
		dd offset loc_438718
		dd offset loc_4386FE
		dd offset loc_4386E1
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_438591+6AEo
		align 4
aHkey_classes_r	db 'HKEY_CLASSES_ROOT',0 ; DATA XREF: sub_438DEC+1Fo
aHkey_current_u	db 'HKEY_CURRENT_USER',0 ; DATA XREF: sub_438DEC+53o
aHkey_local_mac	db 'HKEY_LOCAL_MACHINE',0 ; DATA XREF: sub_438DEC+87o
aHkey_users	db 'HKEY_USERS',0       ; DATA XREF: sub_438DEC+BBo
aHkey_performan	db 'HKEY_PERFORMANCE_DATA',0 ; DATA XREF: sub_438DEC+ECo
aHkey_current_c	db 'HKEY_CURRENT_CONFIG',0 ; DATA XREF: sub_438DEC+11Do
; char aTz[]
aTz		db 'TZ',0               ; DATA XREF: sub_4393C2+7o
					; sub_4393C2:loc_439478o
; char EnvString[]
EnvString	db 'TZ=UTC',0           ; DATA XREF: sub_4393C2+16o
aTz_0		db 'TZ=',0              ; DATA XREF: sub_4393C2+7Co
		align 20h
aAbcdefghijklmn	db 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789',0
					; DATA XREF: sub_439494+14Do
					; sub_439494+1AAo ...
aXxxxxx		db 'XXXXXX',0           ; DATA XREF: sub_439494+56o
		align 20h
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_44825C	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_43A840+3o
		align 10h
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_43A840+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_44837Co
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:00448380o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:00448384o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:00448388o
		align 10h
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0044838Co
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:00448390o
		align 4
off_44837C	dd offset aArgumentDomain ; DATA XREF: sub_43A840+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_43A8B0+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_43A910+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_43A910+1F9o
					; sub_43A910+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_43A910+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_43AB50+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_43AB50+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_43B100:loc_43B1A0o
		unicode	0, <msvcrt.dll>,0
		align 4
off_4484A4	dd offset dword_449D00	; DATA XREF: .text:0043B398o
		dd offset dword_449A20
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_43B940+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_4[]
aS_4		db '%s',0Ah,0           ; DATA XREF: sub_43B940+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_43B940+10Fo
		align 20h
dword_448520	dd 1			; DATA XREF: .text:loc_43C6E1r
dword_448524	dd 16h			; DATA XREF: .text:0043C6D7r
					; .text:0043C6EFr
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch, 0
		dd 0FFFFFFFFh, 4 dup(0)
dword_4486A0	dd 0			; DATA XREF: sub_43AB50+59o
					; sub_43AB50+5Eo ...
dword_4486A4	dd 0			; DATA XREF: sub_43AB50+7Fr
dword_4486A8	dd 0			; DATA XREF: sub_43AB50:loc_43AC9Cr
dword_4486AC	dd 55h dup(0)		; DATA XREF: sub_43AB50+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00049000)
; Virtual size			: 00000E64 (   3684.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 449000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_449000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_449004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_449008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_44900C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_449010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_449014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_449018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_44901C	dd ?			; DATA XREF: sub_401010+3Aw
dword_449020	dd ?			; DATA XREF: sub_402066:loc_402A8Ew
					; sub_404743+77r
dword_449024	dd ?			; DATA XREF: sub_402066+B3w
dword_449028	dd ?			; DATA XREF: sub_404743+1DFr
					; sub_404743+41Ar ...
dword_44902C	dd ?			; DATA XREF: sub_404FBD+14r
					; sub_404FBD+1Cw ...
; char *dword_449030
dword_449030	dd ?			; DATA XREF: sub_401BD6+6r
					; sub_402066+113Aw ...
; char *dword_449034
dword_449034	dd ?			; DATA XREF: sub_401BD6+13r
					; sub_402066+115Cw ...
dword_449038	dd 5 dup(?)		; DATA XREF: sub_402066+1166o
					; sub_40458F+Eo
dword_44904C	dd 5 dup(?)		; DATA XREF: sub_402066+1193o
					; sub_40466D+Eo
; int dword_449060
dword_449060	dd ?			; DATA XREF: sub_402066+914w
					; sub_403366:loc_403392r
; int dword_449064
dword_449064	dd ?			; DATA XREF: sub_402066+92Aw
					; sub_402066:loc_403010r ...
; int dword_449068
dword_449068	dd ?			; DATA XREF: sub_402066+940w
					; sub_402066:loc_403042r ...
dword_44906C	dd ?			; DATA XREF: sub_402066+956w
					; sub_403366:loc_403448r ...
dword_449070	dd ?			; DATA XREF: sub_402066+96Cw
					; sub_403366:loc_403483r ...
; int dword_449074
dword_449074	dd ?			; DATA XREF: sub_402066+97Dw
					; sub_403366+8Cr
; char *Filename
Filename	dd ?			; DATA XREF: sub_402066:loc_4025E0r
					; sub_402066+58Ew ...
; char *Str
Str		dd ?			; DATA XREF: sub_4017ED+9r
					; sub_4017ED+12r ...
; char *Str1
Str1		dd ?			; DATA XREF: sub_401BF8:loc_401EBEr
					; sub_401BF8+2DFr ...
dword_449084	dd ?			; DATA XREF: sub_403E87+7r
					; sub_403E87+1Cw ...
; char dword_449088[]
dword_449088	dd ?			; DATA XREF: sub_403664+7r
					; sub_403664+107w ...
dword_44908C	dd ?			; DATA XREF: sub_401748:loc_401793r
					; sub_401748+68w ...
dword_449090	dd ?			; DATA XREF: sub_4080AE:loc_40817Er
					; sub_408218:loc_40830Dr ...
dword_449094	dd ?			; DATA XREF: .text:0040E5C9r
					; .text:0040E5D6r ...
dword_449098	dd ?			; DATA XREF: sub_40E5FA+18r
					; sub_40E7CF+DBw ...
dword_44909C	dd ?			; DATA XREF: sub_40E559+Fo
					; .text:0040E5ABo ...
dword_4490A0	dd ?			; DATA XREF: .text:0040E5C3r
					; sub_40E5FA+Fr ...
dword_4490A4	dd ?			; DATA XREF: sub_410B63+4Bw
					; sub_410BBF+1C0w ...
dword_4490A8	dd ?			; DATA XREF: sub_40E559+6r
					; sub_40E559+1Fw
dword_4490AC	dd ?			; DATA XREF: sub_411036+Er
					; sub_411036+ABr ...
dword_4490B0	dd ?			; DATA XREF: sub_415380+6r
					; sub_415380+14w ...
dword_4490B4	dd ?			; DATA XREF: sub_41854D+14Br
					; sub_41854D+158w ...
dword_4490B8	dd ?			; DATA XREF: sub_41854D+162w
					; sub_41854D+1E6w ...
dword_4490BC	dd ?			; DATA XREF: sub_417D25+Fo
					; sub_417D71+16o ...
dword_4490C0	dd ?			; DATA XREF: sub_417D25+6r
					; sub_417D25:loc_417D65w
dword_4490C4	dd ?			; DATA XREF: sub_41A1F1+7Dr
					; sub_41A1F1+8Bw ...
dword_4490C8	dd ?			; DATA XREF: sub_41A03C+Fo
					; .text:0041A0AFo ...
; void *Dst
Dst		dd ?			; DATA XREF: .text:0041A0F8r
					; .text:0041A101r ...
dword_4490D0	dd ?			; DATA XREF: .text:0041A0CDr
					; .text:0041A0DAr ...
dword_4490D4	dd ?			; DATA XREF: .text:0041A0C7r
					; sub_41A1F1+148r ...
dword_4490D8	dd ?			; DATA XREF: sub_41A03C+6r
					; sub_41A03C:loc_41A07Cw
dword_4490DC	dd ?			; DATA XREF: sub_41E00D+6r
					; sub_41E00D+Fw
dword_4490E0	dd ?			; DATA XREF: .text:0041E43Br
					; .text:0041E444w
dword_4490E4	dd ?			; DATA XREF: .text:0041E478w
					; .text:0041E492o
dword_4490E8	dd 6 dup(?)		; DATA XREF: .text:0041E47Do
dword_449100	dd ?			; DATA XREF: sub_41EB9F+20r
					; sub_41ECD9+Br ...
dword_449104	dd ?			; DATA XREF: sub_41EE6C+E4w
					; sub_41F123+Er
dword_449108	dd ?			; DATA XREF: sub_41F46E:loc_41F48Fr
					; sub_41F46E+88w ...
dword_44910C	dd ?			; DATA XREF: sub_41F46E:loc_41F528r
					; sub_41F46E+121w ...
dword_449110	dd ?			; DATA XREF: sub_41F46E:loc_41F5C1r
					; sub_41F46E+1BAw ...
dword_449114	dd ?			; DATA XREF: sub_41F46E:loc_41F65Ar
					; sub_41F46E+253w ...
dword_449118	dd ?			; DATA XREF: sub_41F46E:loc_41F6F3r
					; sub_41F46E+2ECw ...
dword_44911C	dd ?			; DATA XREF: sub_41F46E:loc_41F78Cr
					; sub_41F46E+385w ...
dword_449120	dd ?			; DATA XREF: sub_41F46E:loc_41F825r
					; sub_41F46E+41Ew ...
dword_449124	dd ?			; DATA XREF: sub_41F46E:loc_41F8BEr
					; sub_41F46E+4B7w ...
dword_449128	dd ?			; DATA XREF: sub_41F46E:loc_41F957r
					; sub_41F46E+550w ...
dword_44912C	dd ?			; DATA XREF: sub_41F46E:loc_41F9F0r
					; sub_41F46E+5E9w ...
dword_449130	dd ?			; DATA XREF: .text:0041F370r
					; .text:0041F434w ...
dword_449134	dd ?			; DATA XREF: sub_41F2C2+8r
					; sub_41F2C2+6Fw ...
dword_449138	dd ?			; DATA XREF: sub_41F21F+8r
					; sub_41F21F+6Fw ...
dword_44913C	dd ?			; DATA XREF: .text:0041F184r
					; .text:0041F1EBw ...
dword_449140	dd ?			; DATA XREF: sub_41F123+17r
					; sub_41F123+3Bw ...
dword_449144	dd ?			; DATA XREF: sub_41F080+8r
					; sub_41F080+6Fw ...
dword_449148	dd ?			; DATA XREF: sub_41EF99+Br
					; sub_41EF99+C1w ...
dword_44914C	dd ?			; DATA XREF: sub_41EE6C+8r
					; sub_41EE6C:loc_41EEC9w
		align 20h
; CHAR byte_449160
byte_449160	db ?			; DATA XREF: sub_41EE6C+1Do
					; sub_41EE6C+56w ...
		align 4
		dd 42h dup(?)
dword_44926C	dd ?			; DATA XREF: sub_41ECD9:loc_41ED1Ar
					; sub_41ECD9+A4w ...
; LPCSTR lpPathName
lpPathName	dd ?			; DATA XREF: sub_41EB9F+Br
					; sub_41EB9F+44w ...
dword_449274	dd ?			; DATA XREF: sub_41EAC5+6r
					; sub_41EAC5+13w
dword_449278	dd ?			; DATA XREF: sub_41EAC5+63w
					; sub_41EAC5+68r ...
		align 10h
dword_449280	dd ?			; DATA XREF: sub_41FB5C+23r
					; sub_41FB5C+2Cr ...
		align 20h
dword_4492A0	dd ?			; DATA XREF: sub_4204C6+2Dr
					; sub_4204C6+41r ...
dword_4492A4	dd ?			; DATA XREF: sub_4204C6+15r
					; sub_4204C6:loc_4204E9r ...
		align 20h
dword_4492C0	dd ?			; DATA XREF: .text:00420E5Fw
					; .text:00420E82o ...
dword_4492C4	dd ?			; DATA XREF: .text:00420E68w
word_4492C8	dw ?			; DATA XREF: .text:00420E72w
byte_4492CA	db ?			; DATA XREF: .text:00420E7Dw
		align 4
		dd 9 dup(?)
		db ?
byte_4492F1	db ?			; DATA XREF: .text:00420EBBw
dword_4492F2	dd ?			; DATA XREF: .text:00420DA0w
					; .text:00420E2Co ...
dword_4492F6	dd ?			; DATA XREF: .text:00420DA9w
dword_4492FA	dd ?			; DATA XREF: .text:00420DB2w
dword_4492FE	dd ?			; DATA XREF: .text:00420DBBw
dword_449302	dd ?			; DATA XREF: .text:00420DC4w
		align 10h
dword_449310	dd ?			; DATA XREF: .text:00420D09w
					; .text:00420D6Co ...
dword_449314	dd ?			; DATA XREF: .text:00420D12w
word_449318	dw ?			; DATA XREF: .text:00420D1Cw
byte_44931A	db ?			; DATA XREF: .text:00420D27w
		align 10h
dword_449320	dd 8 dup(?)		; DATA XREF: .text:00420C9Do
					; .text:00420CAFo ...
dword_449340	dd ?			; DATA XREF: sub_425C96+2Dr
					; sub_425C96+A4r ...
dword_449344	dd ?			; DATA XREF: sub_425C96+69r
					; sub_425C96+78o ...
dword_449348	dd ?			; DATA XREF: sub_425C96+36r
					; sub_425C96+55o ...
dword_44934C	dd ?			; DATA XREF: .text:00428C7Bw
					; .text:00428D87r
dword_449350	dd ?			; DATA XREF: .text:00428DC2r
dword_449354	dd ?			; DATA XREF: .text:00428DF7r
byte_449358	db ?			; DATA XREF: .text:00428C69o
					; .text:00428C85o ...
byte_449359	db ?			; DATA XREF: .text:00428DB7r
byte_44935A	db ?			; DATA XREF: .text:loc_428DECr
		align 4
dword_44935C	dd ?			; DATA XREF: sub_425FED+6r
					; sub_425FED+18w ...
; char *dword_449360
dword_449360	dd ?			; DATA XREF: sub_42BFF3+6r
					; sub_42BFF3+36w ...
dword_449364	dd ?			; DATA XREF: sub_42D422:loc_42D46Dr
					; sub_42D5F2:loc_42D660r ...
dword_449368	dd ?			; DATA XREF: .text:0042ECDFw
					; sub_42ECE6+6r
dword_44936C	dd ?			; DATA XREF: sub_430C9C+B7r
					; sub_430C9C:loc_430DA5w
dword_449370	dd ?			; DATA XREF: sub_430C9C+F0w
					; sub_430C9C+F5r ...
dword_449374	dd ?			; DATA XREF: sub_42E95C+41r
					; sub_42E95C+49w ...
		align 10h
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_432EA2+29o
					; sub_432EA2+56o
dword_449480	dd ?			; DATA XREF: sub_4349AE+232r
					; sub_4349AE+23Br ...
dword_449484	dd ?			; DATA XREF: sub_434C6E+7r
					; sub_435322+6w
		align 20h
; FILE *File
File		dd ?			; DATA XREF: sub_435365+8r
					; sub_435365+19r ...
		align 20h
; char Dest[79]
Dest		db 4Fh dup(?)		; DATA XREF: sub_435614+1Bo
					; sub_435672:loc_4356E4o ...
byte_44950F	db ?			; DATA XREF: sub_435614+27w
dword_449510	dd ?			; DATA XREF: sub_435614+3Fw
					; sub_435672:loc_43569Cr ...
dword_449514	dd ?			; DATA XREF: sub_435614+34w
					; sub_435672+12r ...
dword_449518	dd ?			; DATA XREF: sub_435614+4Aw
					; sub_435672:loc_4356B4r ...
dword_44951C	dd ?			; DATA XREF: .text:0043560Dw
					; sub_435786:loc_4358D8r ...
dword_449520	dd ?			; DATA XREF: sub_435614+57w
					; sub_435672:loc_4356CCr
dword_449524	dd ?			; DATA XREF: sub_435365+249w
					; sub_435786+88r ...
dword_449528	dd ?			; DATA XREF: sub_435365+24Ew
					; sub_435786:loc_4357C9r ...
dword_44952C	dd ?			; DATA XREF: sub_435330+6r
					; sub_435330+14w ...
		align 20h
dword_449540	dd ?			; DATA XREF: sub_437E99+6r
					; sub_437E99+Fr ...
dword_449544	dd ?			; DATA XREF: sub_437F30+E3w
					; sub_43802F+1DFw ...
dword_449548	dd ?			; DATA XREF: sub_437F30+EDw
					; sub_43802F+1E9w ...
dword_44954C	dd ?			; DATA XREF: sub_438591+70Er
					; sub_438591:loc_438CE5w
dword_449550	dd ?			; DATA XREF: sub_438345+1CCr
					; sub_438345:loc_438557w
; char byte_449554[32]
byte_449554	db 20h dup(?)		; DATA XREF: sub_43802F+3Bo
					; sub_43802F+47o ...
dword_449574	dd ?			; DATA XREF: sub_437F30+45r
					; sub_437F30+4Dw
dword_449578	dd ?			; DATA XREF: sub_437F30:loc_437F89r
					; sub_437F30+61w
dword_44957C	dd ?			; DATA XREF: sub_437F30:loc_437FC5r
					; sub_437F30:loc_437FF9w
; char *dword_449580
dword_449580	dd ?			; DATA XREF: sub_4393C2+3Br
					; sub_4393C2+6Ew ...
		align 8
dword_449588	dd ?			; DATA XREF: sub_439494+F2r
					; sub_439494+103w ...
dword_44958C	dd ?			; DATA XREF: sub_439494+F7r
					; sub_439494+108w ...
dword_449590	dd ?			; DATA XREF: sub_439854+1F1o
					; sub_439854+2C0o ...
; void *Memory
Memory		dd ?			; DATA XREF: sub_439854:loc_439905r
					; sub_439854+D4r ...
		align 10h
dword_4495A0	dd ?			; DATA XREF: sub_439DB0+6Br
					; sub_439DB0+7Aw ...
		dd 107h	dup(?)
dword_4499C0	dd ?			; DATA XREF: sub_401010+3r
dword_4499C4	dd ?			; DATA XREF: sub_401010+25r
dword_4499C8	dd ?			; DATA XREF: sub_401060+22w
dword_4499CC	dd ?			; DATA XREF: sub_401060+18w
dword_4499D0	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_4499DC	dd ?			; DATA XREF: sub_401060+2Cw
dword_4499E0	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_4499E4	dd ?			; DATA XREF: sub_401060+5Er
dword_4499E8	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_43A6BCr
dword_4499EC	dd ?			; DATA XREF: .text:0043A7E3r
					; sub_43A830+4w
dword_4499F0	dd ?			; DATA XREF: sub_43AB50+9r
					; sub_43AB50:loc_43AB70w
dword_4499F4	dd ?			; DATA XREF: sub_43A910+1Dr
					; sub_43A910+58r ...
dword_4499F8	dd ?			; DATA XREF: sub_43A910+Br
					; sub_43A910:loc_43A9CFw ...
dword_4499FC	dd ?			; DATA XREF: sub_43B100+4r
					; sub_43B100+92w ...
dword_449A00	dd ?			; DATA XREF: sub_43B250r
					; sub_43B250:loc_43B260w
		align 20h
dword_449A20	dd 2Bh dup(?)		; DATA XREF: .rdata:004484A8o
dword_449ACC	dd ?			; DATA XREF: .text:0043B37Aw
		dd 2 dup(?)
dword_449AD8	dd ?			; DATA XREF: .text:0043B366w
		dd 2 dup(?)
dword_449AE4	dd ?			; DATA XREF: .text:0043B34Cw
		dd 86h dup(?)
dword_449D00	dd ?			; DATA XREF: .text:0043B352w
					; .rdata:off_4484A4o
dword_449D04	dd ?			; DATA XREF: .text:0043B35Cw
		dd ?
dword_449D0C	dd ?			; DATA XREF: .text:0043B36Bw
		dd 14h dup(?)
dword_449D60	dd ?			; DATA XREF: .text:0043B443r
					; .text:0043B4D4r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_43B3D0+7o
					; sub_43B3D0:loc_43B425o ...
dword_449D7C	dd ?			; DATA XREF: sub_43B3D0+14r
					; .text:0043B498r ...
		dd ?
dword_449D84	dd ?			; DATA XREF: sub_401180+1A8w
dword_449D88	dd ?			; DATA XREF: sub_401180+1BFw
dword_449D8C	dd ?			; DATA XREF: sub_401180+1B2w
		align 20h
dword_449DA0	dd ?			; DATA XREF: sub_4017ED:loc_401886w
					; sub_4017ED:loc_4018CBw ...
dword_449DA4	dd ?			; DATA XREF: sub_4017ED+1F4r
					; sub_4017ED+1FDw ...
dword_449DA8	dd ?			; DATA XREF: sub_4017ED+210r
					; sub_4017ED+219w ...
		align 10h
dword_449DB0	dd ?			; DATA XREF: sub_402066:loc_40288Dw
					; sub_40F902+1Ar ...
dword_449DB4	dd ?			; DATA XREF: sub_402066+257w
					; sub_402066+469w ...
; int dword_449DB8
dword_449DB8	dd ?			; DATA XREF: sub_402066+26Cw
					; sub_402066+271r ...
dword_449DBC	dd ?			; DATA XREF: sub_402066+392w
					; sub_402066+397r ...
dword_449DC0	dd ?			; DATA XREF: sub_402066+3BEw
					; sub_402066+3C3r ...
dword_449DC4	dd ?			; DATA XREF: sub_402066+1B3w
					; sub_402066:loc_4029EDw ...
dword_449DC8	dd ?			; DATA XREF: sub_404743:loc_40481Ew
					; sub_41A1F1+55Cr
; char *dword_449DCC
dword_449DCC	dd ?			; DATA XREF: sub_401BF8+38w
					; sub_401BF8+35Bw ...
; char *dword_449DD0
dword_449DD0	dd ?			; DATA XREF: sub_401BF8+4Cw
					; sub_401BF8+37Bw ...
dword_449DD4	dd ?			; DATA XREF: sub_401BF8+CEw
					; sub_401BF8:loc_401F7Dw ...
dword_449DD8	dd ?			; DATA XREF: sub_401BF8+2Ew
					; sub_401BF8:loc_401F3Ew ...
dword_449DDC	dd ?			; DATA XREF: sub_401BF8+42w
					; sub_401BF8+36Bw ...
dword_449DE0	dd ?			; DATA XREF: sub_401BF8+56w
					; sub_401BF8+39Aw ...
dword_449DE4	dd ?			; DATA XREF: sub_401BF8+60w
					; sub_401BF8+3AAw ...
dword_449DE8	dd ?			; DATA XREF: sub_401BF8+6Aw
					; sub_401BF8+3BAw ...
dword_449DEC	dd ?			; DATA XREF: sub_401BF8+74w
					; sub_401BF8+3CAw ...
dword_449DF0	dd ?			; DATA XREF: sub_401BF8+7Ew
					; sub_401BF8:loc_401FCCw ...
dword_449DF4	dd ?			; DATA XREF: sub_401BF8+88w
					; sub_401BF8+3E9w ...
dword_449DF8	dd ?			; DATA XREF: sub_401BF8+92w
					; sub_401BF8+3F6w ...
dword_449DFC	dd ?			; DATA XREF: sub_401BF8+9Cw
					; sub_401BF8+403w ...
dword_449E00	dd ?			; DATA XREF: sub_401BF8+A6w
					; sub_401BF8+410w ...
dword_449E04	dd ?			; DATA XREF: sub_401BF8+B0w
					; sub_401BF8:loc_40200Fw
dword_449E08	dd ?			; DATA XREF: sub_40E7CF+205r
					; sub_41A1F1+329r
dword_449E0C	dd ?			; DATA XREF: sub_401BF8+BAw
					; sub_401BF8:loc_40201Bw ...
dword_449E10	dd ?			; DATA XREF: sub_401BF8+C4w
					; sub_401BF8:loc_402027w ...
dword_449E14	dd ?			; DATA XREF: sub_401BF8:loc_40203Fw
					; sub_407E3F+15r
dword_449E18	dd ?			; DATA XREF: sub_401BF8+D8w
					; sub_401BF8:loc_40204Bw ...
dword_449E1C	dd ?			; DATA XREF: sub_402066:loc_402A67w
					; sub_408B92+A3r ...
dword_449E20	dd ?			; DATA XREF: sub_402066:loc_402A76w
					; sub_40E7CF+1B9r
dword_449E24	dd ?			; DATA XREF: sub_402066:loc_402A82w
					; sub_402066+A32w ...
dword_449E28	dd ?			; DATA XREF: sub_405D08+14r
					; sub_405DBA+10r ...
dword_449E2C	dd ?			; DATA XREF: sub_405D08+38r
					; sub_405DBA+3r ...
dword_449E30	dd ?			; DATA XREF: sub_405D08+5Cr
					; sub_405DD9+3r ...
dword_449E34	dd ?			; DATA XREF: sub_42D422:loc_42D451r
					; sub_42D422+79r ...
dword_449E38	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_43A4A3w ...
dword_449E3C	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_449E40	dd ?			; DATA XREF: TlsCallback_0:loc_43A3F4w
dword_449E44	dd ?			; DATA XREF: sub_401060+64w
					; sub_43A570+3Fr ...
dword_449E48	dd ?			; DATA XREF: sub_401060+69w
					; sub_43A570+4r ...
dword_449E4C	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_449E50	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 200h
_bss		ends

;
; Imports from libassuan-0.dll
;
; Section 5. (virtual address 0004A000)
; Virtual size			: 000027C4 (  10180.)
; Section size in file		: 00002800 (  10240.)
; Offset to raw	data for section: 00047400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __assuan_close:dword ; DATA XREF:	.text:0043A0E4r
		extrn __assuan_connect:dword ; DATA XREF: .text:0043A104r
		extrn __assuan_pipe:dword ; DATA XREF: .text:0043A0DCr
		extrn __assuan_socket:dword ; DATA XREF: .text:0043A0FCr
		extrn __assuan_socketpair:dword	; DATA XREF: .text:0043A0F4r
		extrn __assuan_spawn:dword ; DATA XREF:	.text:0043A0ECr
		extrn __imp_assuan_accept:dword	; DATA XREF: assuan_acceptr
		extrn __imp_assuan_begin_confidential:dword
					; DATA XREF: assuan_begin_confidentialr
		extrn __imp_assuan_end_confidential:dword
					; DATA XREF: assuan_end_confidentialr
		extrn __imp_assuan_fdopen:dword	; DATA XREF: assuan_fdopenr
		extrn __imp_assuan_get_flag:dword ; DATA XREF: assuan_get_flagr
		extrn __imp_assuan_get_pid:dword ; DATA	XREF: assuan_get_pidr
		extrn __imp_assuan_get_pointer:dword ; DATA XREF: assuan_get_pointerr
		extrn __imp_assuan_init_pipe_server:dword
					; DATA XREF: assuan_init_pipe_serverr
		extrn __imp_assuan_init_socket_server:dword
					; DATA XREF: assuan_init_socket_serverr
		extrn __imp_assuan_inquire:dword ; DATA	XREF: assuan_inquirer
		extrn __imp_assuan_new:dword ; DATA XREF: assuan_newr
		extrn __imp_assuan_pipe_connect:dword ;	DATA XREF: assuan_pipe_connectr
		extrn __imp_assuan_process:dword ; DATA	XREF: assuan_processr
		extrn __imp_assuan_register_command:dword
					; DATA XREF: assuan_register_commandr
		extrn __imp_assuan_register_option_handler:dword
					; DATA XREF: assuan_register_option_handlerr
		extrn __imp_assuan_register_post_cmd_notify:dword
					; DATA XREF: assuan_register_post_cmd_notifyr
		extrn __imp_assuan_register_reset_notify:dword
					; DATA XREF: assuan_register_reset_notifyr
		extrn __imp_assuan_release:dword ; DATA	XREF: assuan_releaser
		extrn __imp_assuan_send_data:dword ; DATA XREF:	assuan_send_datar
		extrn __imp_assuan_set_assuan_log_prefix:dword
					; DATA XREF: assuan_set_assuan_log_prefixr
		extrn __imp_assuan_set_assuan_log_stream:dword
					; DATA XREF: assuan_set_assuan_log_streamr
		extrn __imp_assuan_set_error:dword ; DATA XREF:	assuan_set_errorr
		extrn __imp_assuan_set_flag:dword ; DATA XREF: assuan_set_flagr
		extrn __imp_assuan_set_gpg_err_source:dword
					; DATA XREF: assuan_set_gpg_err_sourcer
		extrn __imp_assuan_set_io_monitor:dword	; DATA XREF: assuan_set_io_monitorr
		extrn __imp_assuan_set_log_stream:dword	; DATA XREF: assuan_set_log_streamr
		extrn __imp_assuan_set_malloc_hooks:dword
					; DATA XREF: assuan_set_malloc_hooksr
		extrn __imp_assuan_set_okay_line:dword ; DATA XREF: assuan_set_okay_liner
		extrn __imp_assuan_set_pointer:dword ; DATA XREF: assuan_set_pointerr
		extrn __imp_assuan_set_system_hooks:dword
					; DATA XREF: assuan_set_system_hooksr
		extrn __imp_assuan_sock_bind:dword ; DATA XREF:	assuan_sock_bindr
		extrn __imp_assuan_sock_check_nonce:dword
					; DATA XREF: assuan_sock_check_noncer
		extrn __imp_assuan_sock_close:dword ; DATA XREF: assuan_sock_closer
		extrn __imp_assuan_sock_get_nonce:dword	; DATA XREF: assuan_sock_get_noncer
		extrn __imp_assuan_sock_init:dword ; DATA XREF:	assuan_sock_initr
		extrn __imp_assuan_sock_new:dword ; DATA XREF: assuan_sock_newr
		extrn __imp_assuan_socket_connect:dword	; DATA XREF: assuan_socket_connectr
		extrn __imp_assuan_transact:dword ; DATA XREF: assuan_transactr
		extrn __imp_assuan_write_line:dword ; DATA XREF: assuan_write_liner
		extrn __imp_assuan_write_status:dword ;	DATA XREF: assuan_write_statusr

;
; Imports from libgcrypt-20.dll
;
		extrn __imp_gcry_calloc:dword ;	DATA XREF: gcry_callocr
		extrn __imp_gcry_calloc_secure:dword ; DATA XREF: gcry_calloc_securer
		extrn __imp_gcry_check_version:dword ; DATA XREF: gcry_check_versionr
		extrn __imp_gcry_cipher_close:dword ; DATA XREF: gcry_cipher_closer
		extrn __imp_gcry_cipher_decrypt:dword ;	DATA XREF: gcry_cipher_decryptr
		extrn __imp_gcry_cipher_encrypt:dword ;	DATA XREF: gcry_cipher_encryptr
		extrn __imp_gcry_cipher_get_algo_blklen:dword
					; DATA XREF: gcry_cipher_get_algo_blklenr
		extrn __imp_gcry_cipher_open:dword ; DATA XREF:	gcry_cipher_openr
		extrn __imp_gcry_cipher_setiv:dword ; DATA XREF: gcry_cipher_setivr
		extrn __imp_gcry_cipher_setkey:dword ; DATA XREF: gcry_cipher_setkeyr
		extrn __imp_gcry_control:dword ; DATA XREF: gcry_controlr
		extrn __imp_gcry_create_nonce:dword ; DATA XREF: gcry_create_noncer
		extrn __imp_gcry_free:dword ; DATA XREF: gcry_freer
		extrn __imp_gcry_malloc:dword ;	DATA XREF: gcry_mallocr
		extrn __imp_gcry_malloc_secure:dword ; DATA XREF: gcry_malloc_securer
		extrn __imp_gcry_md_algo_info:dword ; DATA XREF: gcry_md_algo_infor
		extrn __imp_gcry_md_algo_name:dword ; DATA XREF: gcry_md_algo_namer
		extrn __imp_gcry_md_close:dword	; DATA XREF: gcry_md_closer
		extrn __imp_gcry_md_ctl:dword ;	DATA XREF: gcry_md_ctlr
		extrn __imp_gcry_md_get_algo_dlen:dword	; DATA XREF: gcry_md_get_algo_dlenr
		extrn __imp_gcry_md_hash_buffer:dword ;	DATA XREF: gcry_md_hash_bufferr
		extrn __imp_gcry_md_map_name:dword ; DATA XREF:	gcry_md_map_namer
		extrn __imp_gcry_md_open:dword ; DATA XREF: gcry_md_openr
		extrn __imp_gcry_md_read:dword ; DATA XREF: gcry_md_readr
		extrn __imp_gcry_md_reset:dword	; DATA XREF: gcry_md_resetr
		extrn __imp_gcry_md_write:dword	; DATA XREF: gcry_md_writer
		extrn __imp_gcry_mpi_aprint:dword ; DATA XREF: gcry_mpi_aprintr
		extrn __imp_gcry_mpi_cmp:dword ; DATA XREF: gcry_mpi_cmpr
		extrn __imp_gcry_mpi_invm:dword	; DATA XREF: gcry_mpi_invmr
		extrn __imp_gcry_mpi_release:dword ; DATA XREF:	gcry_mpi_releaser
		extrn __imp_gcry_mpi_scan:dword	; DATA XREF: gcry_mpi_scanr
		extrn __imp_gcry_pk_decrypt:dword ; DATA XREF: gcry_pk_decryptr
		extrn __imp_gcry_pk_genkey:dword ; DATA	XREF: gcry_pk_genkeyr
		extrn __imp_gcry_pk_get_keygrip:dword ;	DATA XREF: gcry_pk_get_keygripr
		extrn __imp_gcry_pk_get_nbits:dword ; DATA XREF: gcry_pk_get_nbitsr
		extrn __imp_gcry_pk_map_name:dword ; DATA XREF:	gcry_pk_map_namer
		extrn __imp_gcry_pk_sign:dword ; DATA XREF: gcry_pk_signr
		extrn __imp_gcry_pk_testkey:dword ; DATA XREF: gcry_pk_testkeyr
		extrn __imp_gcry_realloc:dword ; DATA XREF: gcry_reallocr
		extrn __imp_gcry_set_fatalerror_handler:dword
					; DATA XREF: gcry_set_fatalerror_handlerr
		extrn __imp_gcry_set_log_handler:dword ; DATA XREF: gcry_set_log_handlerr
		extrn __imp_gcry_set_outofcore_handler:dword
					; DATA XREF: gcry_set_outofcore_handlerr
		extrn __imp_gcry_sexp_build:dword ; DATA XREF: gcry_sexp_buildr
		extrn __imp_gcry_sexp_build_array:dword	; DATA XREF: gcry_sexp_build_arrayr
		extrn __imp_gcry_sexp_cadr:dword ; DATA	XREF: gcry_sexp_cadrr
		extrn __imp_gcry_sexp_canon_len:dword ;	DATA XREF: gcry_sexp_canon_lenr
		extrn __imp_gcry_sexp_dump:dword ; DATA	XREF: gcry_sexp_dumpr
		extrn __imp_gcry_sexp_find_token:dword ; DATA XREF: gcry_sexp_find_tokenr
		extrn __imp_gcry_sexp_nth:dword	; DATA XREF: gcry_sexp_nthr
		extrn __imp_gcry_sexp_nth_data:dword ; DATA XREF: gcry_sexp_nth_datar
		extrn __imp_gcry_sexp_nth_mpi:dword ; DATA XREF: gcry_sexp_nth_mpir
		extrn __imp_gcry_sexp_nth_string:dword ; DATA XREF: gcry_sexp_nth_stringr
		extrn __imp_gcry_sexp_release:dword ; DATA XREF: gcry_sexp_releaser
		extrn __imp_gcry_sexp_sprint:dword ; DATA XREF:	gcry_sexp_sprintr
		extrn __imp_gcry_sexp_sscan:dword ; DATA XREF: gcry_sexp_sscanr
		extrn __imp_gcry_strdup:dword ;	DATA XREF: gcry_strdupr
		extrn __imp_gcry_strerror:dword	; DATA XREF: gcry_strerrorr
		extrn __imp_gcry_xcalloc:dword ; DATA XREF: gcry_xcallocr
		extrn __imp_gcry_xmalloc:dword ; DATA XREF: gcry_xmallocr
		extrn __imp_gcry_xrealloc:dword	; DATA XREF: gcry_xreallocr
		extrn __imp_gcry_xstrdup:dword ; DATA XREF: gcry_xstrdupr

;
; Imports from libgpg-error-0.dll
;
		extrn __imp_gpg_err_code_from_errno:dword
					; DATA XREF: gpg_err_code_from_errnor
		extrn __imp_gpg_err_code_from_syserror:dword
					; DATA XREF: gpg_err_code_from_syserrorr
		extrn __imp_gpg_err_set_errno:dword ; DATA XREF: gpg_err_set_errnor
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr

;
; Imports from libiconv-2.dll
;
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from libw32pth-0.dll
;
		extrn __imp_pth_accept:dword ; DATA XREF: pth_acceptr
		extrn __imp_pth_attr_destroy:dword ; DATA XREF:	pth_attr_destroyr
		extrn __imp_pth_attr_new:dword ; DATA XREF: pth_attr_newr
		extrn __imp_pth_attr_set:dword ; DATA XREF: pth_attr_setr
		extrn __imp_pth_ctrl:dword ; DATA XREF:	pth_ctrlr
		extrn __imp_pth_enter:dword ; DATA XREF: pth_enterr
		extrn __imp_pth_event:dword ; DATA XREF: pth_eventr
		extrn __imp_pth_event_concat:dword ; DATA XREF:	pth_event_concatr
		extrn __imp_pth_event_free:dword ; DATA	XREF: pth_event_freer
		extrn __imp_pth_event_isolate:dword ; DATA XREF: pth_event_isolater
		extrn __imp_pth_event_occurred:dword ; DATA XREF: pth_event_occurredr
		extrn __imp_pth_init:dword ; DATA XREF:	pth_initr
		extrn __imp_pth_join:dword ; DATA XREF:	pth_joinr
		extrn __imp_pth_kill:dword ; DATA XREF:	pth_killr
		extrn __imp_pth_leave:dword ; DATA XREF: pth_leaver
		extrn __imp_pth_mutex_acquire:dword ; DATA XREF: pth_mutex_acquirer
		extrn __imp_pth_mutex_init:dword ; DATA	XREF: pth_mutex_initr
		extrn __imp_pth_mutex_release:dword ; DATA XREF: pth_mutex_releaser
		extrn __imp_pth_read:dword ; DATA XREF:	pth_readr
		extrn __imp_pth_select_ev:dword	; DATA XREF: pth_select_evr
		extrn __imp_pth_sigmask:dword ;	DATA XREF: pth_sigmaskr
		extrn __imp_pth_sleep:dword ; DATA XREF: pth_sleepr
		extrn __imp_pth_spawn:dword ; DATA XREF: pth_spawnr
		extrn __imp_pth_thread_id:dword	; DATA XREF: pth_thread_idr
		extrn __imp_pth_timeout:dword ;	DATA XREF: pth_timeoutr
		extrn __imp_pth_usleep:dword ; DATA XREF: pth_usleepr
		extrn __imp_pth_waitpid:dword ;	DATA XREF: pth_waitpidr
		extrn __imp_pth_write:dword ; DATA XREF: pth_writer
		extrn __imp_pth_yield:dword ; DATA XREF: pth_yieldr

;
; Imports from ADVAPI32.dll
;
; BOOL __stdcall ConvertSidToStringSidA(PSID Sid, LPSTR	*StringSid)
		extrn ConvertSidToStringSidA:dword ; CODE XREF:	sub_403FC2+1EAp
					; sub_403FC2+23Dp
					; DATA XREF: ...
; BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid)
		extrn CopySid:dword	; CODE XREF: sub_41E853+167p
					; DATA XREF: sub_41E853+162r
; BOOL __stdcall EqualSid(PSID pSid1, PSID pSid2)
		extrn EqualSid:dword	; CODE XREF: sub_403FC2+290p
					; DATA XREF: sub_403FC2+28Br
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn GetLengthSid:dword ; CODE	XREF: sub_41E853+130p
					; DATA XREF: sub_41E853+12Br
; DWORD	__stdcall GetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE	ObjectType, SECURITY_INFORMATION SecurityInfo, PSID *ppsidOwner, PSID *ppsidGroup, PACL	*ppDacl, PACL *ppSacl, PSECURITY_DESCRIPTOR *ppSecurityDescriptor)
		extrn GetSecurityInfo:dword ; CODE XREF: sub_403FC2+1A0p
					; DATA XREF: sub_403FC2+19Br
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn GetTokenInformation:dword	; CODE XREF: sub_41E853+ABp
					; sub_41E853+104p
					; DATA XREF: ...
; BOOL __stdcall IsValidSid(PSID pSid)
		extrn IsValidSid:dword	; CODE XREF: sub_41E853+11Ap
					; DATA XREF: sub_41E853+115r
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: sub_41E853+74p
					; DATA XREF: sub_41E853+6Fr
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_438F46+314p
					; DATA XREF: sub_438F46+30Fr
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_438F46+55p
					; sub_438F46+98p
					; DATA XREF: ...
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_438F46+E3p
					; sub_438F46+140p
					; DATA XREF: ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_403664+EDp
					; sub_403664+FFp ...
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: sub_403C50+5Ep
					; sub_403D1A+82p ...
; HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState,	LPCSTR lpName)
		extrn CreateEventA:dword ; CODE	XREF: sub_403664+4Cp
					; DATA XREF: sub_403664+47r
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_41D3D7+50p
					; sub_41E537+1E0p ...
; BOOL __stdcall CreatePipe(PHANDLE hReadPipe, PHANDLE hWritePipe, LPSECURITY_ATTRIBUTES lpPipeAttributes, DWORD nSize)
		extrn CreatePipe:dword	; CODE XREF: sub_41D2B1+4Ep
					; DATA XREF: sub_41D2B1+49r
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	.text:0041D754p
					; sub_41D8C8+1B3p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_43B570+44p
					; DATA XREF: sub_43B570+44r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: sub_403664+BDp
					; sub_41D2B1+A3p
					; DATA XREF: ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_43B3D0+Ep
					; .text:0043B492p ...
; DWORD	__stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR	lpDst, DWORD nSize)
		extrn ExpandEnvironmentStringsA:dword ;	CODE XREF: sub_438F46+1CFp
					; sub_438F46+235p
					; DATA XREF: ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_432EA2+51p
					; DATA XREF: sub_432EA2+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: sub_43802F+26p
					; DATA XREF: sub_43802F+21r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: sub_43802F+16p
					; DATA XREF: sub_43802F+11r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_403664+80p
					; sub_403664+89p ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_41E537+Fp
					; sub_41E853+2Ep ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_43B270+74p
					; DATA XREF: sub_43B270+74r
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: sub_41A85A+11Bp
					; sub_41DB37+AAp
					; DATA XREF: ...
; DWORD	__stdcall GetFileAttributesA(LPCSTR lpFileName)
		extrn GetFileAttributesA:dword ; CODE XREF: sub_43BC00+2Fp
					; DATA XREF: sub_43BC00+2Fr
; BOOL __stdcall GetFileInformationByHandle(HANDLE hFile, LPBY_HANDLE_FILE_INFORMATION lpFileInformation)
		extrn GetFileInformationByHandle:dword ; CODE XREF: .text:0043934Cp
					; .text:00439367p
					; DATA XREF: ...
; DWORD	__stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh)
		extrn GetFileSize:dword	; CODE XREF: sub_430C9C+17Ap
					; DATA XREF: sub_430C9C+175r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_41E853+B9p
					; sub_42D757+C2p ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_41EE6C+31p
					; sub_43B940+C2p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_43B100+87p
					; DATA XREF: ...
; DWORD	__stdcall GetPriorityClass(HANDLE hProcess)
		extrn GetPriorityClass:dword ; CODE XREF: .text:0041D6FAp
					; sub_41D8C8+15Cp ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; BOOL __stdcall GetProcessTimes(HANDLE	hProcess, LPFILETIME lpCreationTime, LPFILETIME	lpExitTime, LPFILETIME lpKernelTime, LPFILETIME	lpUserTime)
		extrn GetProcessTimes:dword ; CODE XREF: sub_4150DE+43p
					; DATA XREF: sub_4150DE+3Er
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: sub_42D880+226p
					; sub_42D880+23Cp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_43B270+57p
					; sub_43C750+66p
					; DATA XREF: ...
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: sub_41E537+58p
					; sub_42A9D2+2Ap
					; DATA XREF: ...
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_4337E4+7Fp
					; DATA XREF: sub_4337E4:loc_43385Er
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_41E537+141p
					; sub_42A9D2+119p ...
; DWORD	__stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)
		extrn GetTimeZoneInformation:dword ; CODE XREF:	sub_43C750+34p
					; DATA XREF: sub_43C750+34r
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_43B570+87p
					; DATA XREF: sub_43B570+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_43B3D0+5Cp
					; .text:0043B4B0p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_41EA38+11p
					; sub_42D322+11p ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_43B100+A7p
					; DATA XREF: sub_43B100+A7r
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
		extrn LocalFree:dword	; CODE XREF: sub_403FC2+226p
					; sub_403FC2+279p ...
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap)
		extrn MapViewOfFile:dword ; CODE XREF: sub_403FC2+2D5p
					; DATA XREF: sub_403FC2+2D0r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_434745+38p
					; sub_434745+D5p
					; DATA XREF: ...
; HANDLE __stdcall OpenFileMappingA(DWORD dwDesiredAccess, BOOL	bInheritHandle,	LPCSTR lpName)
		extrn OpenFileMappingA:dword ; CODE XREF: sub_403FC2+F2p
					; DATA XREF: sub_403FC2+EDr
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: sub_41E853+48p
					; DATA XREF: sub_41E853+43r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_43B270+8Bp
					; DATA XREF: sub_43B270+8Br
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: sub_42D880+A4p
					; DATA XREF: sub_42D880+9Fr
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword ; CODE	XREF: .text:0041D801p
					; sub_41D8C8+244p
					; DATA XREF: ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	sub_42D757+B3p
					; .text:00430FE7p
					; DATA XREF: ...
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0043B38Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; sub_41E499+18p ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: sub_410E05+6Dp
					; .text:0043B3B9p
					; DATA XREF: ...
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_43B3D0+35p
					; DATA XREF: sub_43B3D0+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0043B39Fp
					; DATA XREF: .text:0043B39Fr
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; CODE XREF: sub_403FC2+3DAp
					; DATA XREF: sub_403FC2+3D5r
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_43A910+142p
					; sub_43A910+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_43A910+A1p
					; sub_43A910+D9p ...
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: sub_41DB37+46p
					; DATA XREF: sub_41DB37+41r
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_434847+48p
					; sub_434847+C8p
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_42D880+165p
					; DATA XREF: sub_42D880+160r

;
; Imports from msvcrt.dll
;
		extrn __imp__access:dword ; DATA XREF: _accessr
		extrn __imp__close:dword ; DATA	XREF: _closer
		extrn __imp__dup:dword	; DATA XREF: _dupr
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
		extrn __imp__mkdir:dword ; DATA	XREF: _mkdirr
		extrn __imp__open:dword	; DATA XREF: _openr
; int __cdecl _putenv(const char *EnvString)
		extrn __imp__putenv:dword ; DATA XREF: _putenvr
		extrn __imp__read:dword	; DATA XREF: _readr
		extrn __imp__rmdir:dword ; DATA	XREF: _rmdirr
		extrn __imp__setmode:dword ; DATA XREF:	_setmoder
; char *__cdecl	_strlwr(char *Str)
		extrn __imp__strlwr:dword ; DATA XREF: _strlwrr
; void __cdecl _tzset()
		extrn __imp__tzset:dword ; DATA	XREF: _tzsetr
		extrn __imp__write:dword ; DATA	XREF: _writer

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
; unsigned __int32 *__cdecl __doserrno()
		extrn __imp___doserrno:dword ; DATA XREF: __doserrnor
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_43A540r
		extrn __pioinfo:dword	; DATA XREF: sub_43C2C0+F1r
					; sub_43C2C0+13Ar ...
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; char **environ
		extrn _environ:dword	; DATA XREF: sub_439854+5Dr
					; sub_439854:loc_439B2Fr ...
; int *__cdecl _errno()
		extrn __imp__errno:dword ; CODE	XREF: sub_402066+5BFp
					; sub_402066+1046p ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
		extrn __imp__filelengthi64:dword ; DATA	XREF: _filelengthi64r
; int __cdecl _fileno_0(FILE *File)
		extrn __imp__fileno_0:dword ; DATA XREF: _fileno_0r
		extrn __imp__findclose:dword ; DATA XREF: _findcloser
		extrn __imp__findfirst:dword ; DATA XREF: _findfirstr
		extrn __imp__findnext:dword ; DATA XREF: _findnextr
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: sub_40990D+6Ap
					; sub_4123C2+FEp ...
; char *__cdecl	_fullpath(char *FullPath, const	char *Path, size_t SizeInBytes)
		extrn __imp__fullpath:dword ; DATA XREF: _fullpathr
		extrn _get_osfhandle:dword ; CODE XREF:	sub_40E537+1Ep
					; sub_41A01A+1Ep ...
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_402066+BADr
					; sub_402066+BDFr ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__lseeki64:dword ; DATA XREF: _lseeki64r
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_43A570+A3p
					; DATA XREF: sub_43A570+A3r
		extrn _open_osfhandle:dword ; CODE XREF: .text:0041D4ACp
					; .text:0041D4FBp ...
		extrn _stati64:dword	; CODE XREF: sub_403C50+37p
					; sub_403D1A+39p
					; DATA XREF: ...
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: .text:0041E3E7p
					; DATA XREF: .text:0041E3E2r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
		extrn __imp__write_0:dword ; DATA XREF:	_write_0r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl clearerr(FILE *File)
		extrn __imp_clearerr:dword ; DATA XREF:	clearerrr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl feof(FILE	*File)
		extrn __imp_feof:dword	; DATA XREF: feofr
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; int __cdecl fgetpos(FILE *File, fpos_t *Pos)
		extrn __imp_fgetpos:dword ; DATA XREF: fgetposr
; char *__cdecl	fgets(char *Buf, int MaxCount, FILE *File)
		extrn __imp_fgets:dword	; DATA XREF: fgetsr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; int __cdecl fseek(FILE *File,	__int32	Offset,	int Origin)
		extrn __imp_fseek:dword	; DATA XREF: fseekr
; int __cdecl fsetpos(FILE *File, const	fpos_t *Pos)
		extrn __imp_fsetpos:dword ; DATA XREF: fsetposr
; __int32 __cdecl ftell(FILE *File)
		extrn __imp_ftell:dword	; DATA XREF: ftellr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; struct tm *__cdecl static gmtime(const time_t	*Time)
		extrn gmtime:dword	; DATA XREF: sub_43C9F0r
; int __cdecl ispunct(int C)
		extrn ispunct:dword	; CODE XREF: sub_41413E+3Bp
					; DATA XREF: sub_41413E+36r
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: sub_42082F+C9p
					; sub_4246F8+17Cp ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_43C9E0r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn __imp_memchr:dword ; DATA	XREF: memchrr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memmove(void *Dst, const void *Src, size_t Size)
		extrn __imp_memmove:dword ; DATA XREF: memmover
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; time_t __cdecl static	mktime(struct tm *Tm)
		extrn mktime:dword	; DATA XREF: sub_43CA00r
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl remove(const char	*Filename)
		extrn __imp_remove:dword ; DATA	XREF: remover
; void __cdecl rewind(FILE *File)
		extrn __imp_rewind:dword ; DATA	XREF: rewindr
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; size_t __cdecl strcspn(const char *Str, const	char *Control)
		extrn __imp_strcspn:dword ; DATA XREF: strcspnr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strftime(char *Buf, size_t SizeInBytes, const char *Format, const struct tm *Tm)
		extrn __imp_strftime:dword ; DATA XREF:	strftimer
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; size_t __cdecl strspn(const char *Str, const char *Control)
		extrn __imp_strspn:dword ; DATA	XREF: strspnr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_43C9D0r
; int __cdecl tolower(int C)
		extrn tolower:dword	; CODE XREF: sub_4133FB+6Bp
					; DATA XREF: sub_4133FB+66r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:00431DA5p
					; .text:00431DBAp ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; BOOL __stdcall AllowSetForegroundWindow(DWORD	dwProcessId)
		extrn AllowSetForegroundWindow:dword ; CODE XREF: sub_41E7E4+41p
					; DATA XREF: sub_41E7E4+3Cr
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
		extrn CreateWindowExA:dword ; CODE XREF: sub_4043EA+106p
					; DATA XREF: sub_4043EA+101r
; LRESULT __stdcall DefWindowProcA(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
		extrn DefWindowProcA:dword ; CODE XREF:	sub_403FC2+56p
					; DATA XREF: sub_403FC2+51r
; LRESULT __stdcall DispatchMessageA(const MSG *lpMsg)
		extrn DispatchMessageA:dword ; CODE XREF: sub_4043EA+147p
					; DATA XREF: sub_4043EA+142r
; BOOL __stdcall GetMessageA(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax)
		extrn GetMessageA:dword	; CODE XREF: sub_4043EA+172p
					; DATA XREF: sub_4043EA+16Dr
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_43B940+122p
					; DATA XREF: sub_43B940+122r
; ATOM __stdcall RegisterClassA(const WNDCLASSA	*lpWndClass)
		extrn RegisterClassA:dword ; CODE XREF:	sub_4043EA+7Dp
					; DATA XREF: sub_4043EA+78r
; BOOL __stdcall TranslateMessage(const	MSG *lpMsg)
		extrn TranslateMessage:dword ; CODE XREF: sub_4043EA+137p
					; DATA XREF: sub_4043EA+132r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAGetLastError()
		extrn WSAGetLastError:dword ; CODE XREF: sub_42DB2C+A3p
					; sub_42DB2C+14Dp
					; DATA XREF: ...
; int __stdcall	__WSAFDIsSet(SOCKET fd,	fd_set *)
		extrn __imp___WSAFDIsSet:dword ; DATA XREF: __WSAFDIsSetr
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; CODE XREF: sub_42DB2C+1F4p
					; DATA XREF: sub_42DB2C+1EFr
; int __stdcall	listen(SOCKET s, int backlog)
		extrn listen:dword	; CODE XREF: sub_4038EB+2E7p
					; DATA XREF: sub_4038EB+2E2r
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn recv:dword	; CODE XREF: sub_42DB2C+90p
					; DATA XREF: sub_42DB2C+8Br
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn send:dword	; CODE XREF: sub_42DB2C+13Ap
					; DATA XREF: sub_42DB2C+135r


; Section 6. (virtual address 0004D000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00049C00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 44D000h
dword_44D000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_44D008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_44D00C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_43A540
dword_44D018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_44D030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_43A4E3o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 0004E000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00049E00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 44E000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
