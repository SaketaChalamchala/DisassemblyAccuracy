;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	913138274FCF5848407420085BD575EA
; Input	CRC32 :	35FF1A32

; File Name   :	C:\compspace\compare\gpg\dlls\original\sha256sum.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00002B84 (  11140.)
; Section size in file		: 00002C00 (  11264.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00408004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_406034
		mov	[esp+2Ch+var_1C], offset dword_406018
		mov	[esp+2Ch+var_24], offset dword_40600C
		mov	[esp+2Ch+var_28], offset dword_406008
		mov	ds:dword_406018, eax
		mov	eax, ds:dword_406038
		mov	[esp+2Ch+var_2C], offset dword_406004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_40601C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00408010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_406044, 1
		mov	ds:dword_406040, 1
		mov	ds:dword_40603C, 1
		mov	ds:dword_406050, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_406014, eax
		mov	eax, ds:dword_406054
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_402640
		mov	edx, ds:dword_406058
		mov	ds:dword_4063FC, eax
		mov	ds:dword_406400, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_402980
		cmp	dword_404014, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_402920
		call	sub_402910
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_4036F0
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_406054
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_406404
		call	sub_403750
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_406408
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_406408
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_406000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_406408
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_406404

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_405238+344h
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0 ; jumptable	004023B6 case 209
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_402C30
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_40605C, eax
		call	sub_4031E0
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_4032A0
		mov	eax, ds:dword_406054
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_4063E4, eax
		mov	eax, 0Ah
		mov	ds:dword_4063EC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_4063E8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_406004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_406008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_406008, eax
		call	sub_403330
		mov	eax, ds:__initenv
		mov	edx, ds:dword_40600C
		mov	[eax], edx
		mov	eax, ds:dword_40600C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_406008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_406004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_4038E0
		mov	esi, ds:dword_406014
		test	esi, esi
		mov	ds:dword_406010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_406000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_406010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_406408
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_406408
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_408008
		mov	[esp+88h+dwMilliseconds], offset dword_408000
		call	_initterm
		mov	ds:dword_406408, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_406408, 1
		mov	[esp+88h+lpProcName], offset dword_408018
		mov	[esp+88h+dwMilliseconds], offset dword_40800C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_406054, 1
		call	sub_403350
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_406054, 0
		call	sub_403350
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_403B50+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_404020
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_404020
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_403B50+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401550	proc near		; CODE XREF: sub_401800+64p
					; sub_401800+A2p ...

var_178		= dword	ptr -178h
var_174		= dword	ptr -174h
var_170		= dword	ptr -170h
var_16C		= dword	ptr -16Ch
var_168		= dword	ptr -168h
var_164		= dword	ptr -164h
var_160		= dword	ptr -160h
var_15C		= dword	ptr -15Ch
var_158		= dword	ptr -158h
var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
var_118		= byte ptr -118h
var_58		= byte ptr -58h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 168h
		mov	esi, [eax]
		mov	[esp+178h+var_15C], eax
		mov	eax, [eax+4]
		mov	[esp+178h+var_174], eax
		mov	eax, [esp+178h+var_15C]
		mov	eax, [eax+8]
		mov	[esp+178h+var_168], eax
		mov	eax, [esp+178h+var_15C]
		mov	eax, [eax+0Ch]
		mov	[esp+178h+var_160], eax
		mov	eax, [esp+178h+var_15C]
		mov	eax, [eax+10h]
		mov	[esp+178h+var_158], eax
		mov	eax, [esp+178h+var_15C]
		mov	eax, [eax+14h]
		mov	[esp+178h+var_164], eax
		mov	eax, [esp+178h+var_15C]
		mov	eax, [eax+18h]
		mov	[esp+178h+var_170], eax
		mov	eax, [esp+178h+var_15C]
		mov	eax, [eax+1Ch]
		mov	[esp+178h+var_16C], eax
		mov	eax, ds:dword_406020
		test	eax, eax
		jz	loc_4017C2
		mov	eax, [edx]
		lea	ecx, [esp+178h+var_50]
		mov	[esp+178h+var_50], eax
		mov	eax, [edx+4]
		mov	[esp+178h+var_4C], eax
		mov	eax, [edx+8]
		mov	[esp+178h+var_48], eax
		mov	eax, [edx+0Ch]
		mov	[esp+178h+var_44], eax
		mov	eax, [edx+10h]
		mov	[esp+178h+var_40], eax
		mov	eax, [edx+14h]
		mov	[esp+178h+var_3C], eax
		mov	eax, [edx+18h]
		mov	[esp+178h+var_38], eax
		mov	eax, [edx+1Ch]
		mov	[esp+178h+var_34], eax
		mov	eax, [edx+20h]
		mov	[esp+178h+var_30], eax
		mov	eax, [edx+24h]
		mov	[esp+178h+var_2C], eax
		mov	eax, [edx+28h]
		mov	[esp+178h+var_28], eax
		mov	eax, [edx+2Ch]
		mov	[esp+178h+var_24], eax
		mov	eax, [edx+30h]
		mov	[esp+178h+var_20], eax
		mov	eax, [edx+34h]
		mov	[esp+178h+var_1C], eax
		mov	eax, [edx+38h]
		mov	[esp+178h+var_18], eax
		mov	eax, [edx+3Ch]
		mov	[esp+178h+var_14], eax

loc_40165C:				; CODE XREF: sub_401550+2A6j
		xor	eax, eax
		xchg	ax, ax

loc_401660:				; CODE XREF: sub_401550+11Dj
		mov	edx, [ecx+eax*4]
		mov	[esp+eax*4+178h+var_150], edx
		add	eax, 1
		cmp	eax, 10h
		jnz	short loc_401660
		lea	edx, [esp+178h+var_58]
		lea	eax, [esp+178h+var_118]
		mov	[esp+178h+var_178], edx
		mov	[esp+178h+var_154], esi

loc_401681:				; CODE XREF: sub_401550+174j
		mov	ebp, [eax]
		mov	ecx, 11h
		mov	esi, [eax-34h]
		mov	edx, [eax-34h]
		mov	edi, ebp
		mov	ebx, ebp
		ror	edi, cl
		mov	cl, 13h
		ror	ebx, cl
		mov	cl, 7
		xor	ebx, edi
		ror	esi, cl
		mov	cl, 12h
		ror	edx, cl
		mov	ecx, [eax-38h]
		shr	ebp, 0Ah
		xor	edx, esi
		add	ecx, [eax-14h]
		xor	ebx, ebp
		add	ebx, ecx
		mov	ecx, [eax-34h]
		shr	ecx, 3
		xor	edx, ecx
		add	ebx, edx
		mov	[eax+8], ebx
		add	eax, 4
		cmp	eax, [esp+178h+var_178]
		jnz	short loc_401681
		xor	edx, edx
		mov	esi, [esp+178h+var_154]
		mov	ebp, edx
		mov	edx, [esp+178h+var_158]
		jmp	short loc_401700
; ---------------------------------------------------------------------------

loc_4016D4:				; CODE XREF: sub_401550+22Ej
		mov	edi, [esp+178h+var_170]
		mov	[esp+178h+var_16C], edi
		mov	edi, [esp+178h+var_164]
		mov	[esp+178h+var_164], edx
		mov	edx, ebx
		mov	[esp+178h+var_170], edi
		mov	edi, [esp+178h+var_168]
		mov	[esp+178h+var_160], edi
		mov	edi, [esp+178h+var_174]
		mov	[esp+178h+var_174], esi
		mov	esi, eax
		mov	[esp+178h+var_168], edi

loc_401700:				; CODE XREF: sub_401550+182j
		mov	ecx, 6
		mov	edi, edx
		ror	edi, cl
		mov	cl, 0Bh
		mov	eax, edx
		mov	ebx, edx
		ror	eax, cl
		mov	cl, 19h
		xor	eax, edi
		ror	ebx, cl
		mov	ecx, [esp+178h+var_170]
		xor	eax, ebx
		mov	edi, esi
		xor	ecx, [esp+178h+var_164]
		mov	ebx, esi
		add	eax, ds:off_405238+208h[ebp*4]
		add	eax, [esp+178h+var_16C]
		and	ecx, edx
		add	eax, [esp+ebp*4+178h+var_150]
		add	ebp, 1
		xor	ecx, [esp+178h+var_170]
		add	ecx, eax
		mov	eax, esi
		mov	[esp+178h+var_178], ecx
		mov	ecx, 2
		ror	edi, cl
		mov	cl, 0Dh
		ror	eax, cl
		mov	cl, 16h
		ror	ebx, cl
		mov	ecx, [esp+178h+var_174]
		mov	[esp+178h+var_158], edi
		mov	edi, [esp+178h+var_174]
		xor	eax, [esp+178h+var_158]
		or	ecx, esi
		and	ecx, [esp+178h+var_168]
		and	edi, esi
		xor	eax, ebx
		mov	ebx, [esp+178h+var_178]
		add	ebx, [esp+178h+var_160]
		or	ecx, edi
		add	eax, ecx
		add	eax, [esp+178h+var_178]
		cmp	ebp, 40h
		jnz	loc_4016D4
		mov	[esp+178h+var_158], edx
		mov	edx, [esp+178h+var_15C]
		mov	edi, [esp+178h+var_174]
		add	[edx], eax
		add	[edx+8], edi
		mov	eax, [esp+178h+var_168]
		mov	edi, [esp+178h+var_158]
		add	[edx+0Ch], eax
		add	[edx+14h], edi
		mov	eax, [esp+178h+var_164]
		mov	edi, [esp+178h+var_170]
		add	[edx+4], esi
		add	[edx+10h], ebx
		add	[edx+18h], eax
		add	[edx+1Ch], edi
		add	esp, 168h
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4017C2:				; CODE XREF: sub_401550+60j
		lea	ecx, [esp+178h+var_50]
		lea	edi, [esp+178h+var_10]
		mov	eax, ecx

loc_4017D2:				; CODE XREF: sub_401550+2A4j
		movzx	ebx, byte ptr [edx]
		mov	[eax+3], bl
		movzx	ebx, byte ptr [edx+1]
		mov	[eax+2], bl
		movzx	ebx, byte ptr [edx+2]
		mov	[eax+1], bl
		movzx	ebx, byte ptr [edx+3]
		add	edx, 4
		mov	[eax], bl
		add	eax, 4
		cmp	eax, edi
		jnz	short loc_4017D2
		jmp	loc_40165C
sub_401550	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401800	proc near		; CODE XREF: sub_401800+86p
					; sub_401910+D0p ...

var_20		= dword	ptr -20h

		push	ebp
		mov	ebp, edx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 1Ch
		mov	eax, [eax+64h]
		mov	[esp+2Ch+var_20], ecx
		lea	esi, [ebx+24h]
		cmp	eax, 40h
		jz	short loc_401860

loc_40181A:				; CODE XREF: sub_401800+5Ej
		test	ebp, ebp
		jz	short loc_401878

loc_40181E:				; CODE XREF: sub_401800+76j
		mov	eax, [ebx+64h]
		test	eax, eax
		jz	short loc_40188B
		mov	edx, [esp+2Ch+var_20]
		test	edx, edx
		jz	short loc_401851
		cmp	eax, 3Fh
		jle	short loc_40183C
		jmp	short loc_401880
; ---------------------------------------------------------------------------

loc_401834:				; CODE XREF: sub_401800+4Fj
		add	ebp, 1
		cmp	eax, 40h
		jz	short loc_401880

loc_40183C:				; CODE XREF: sub_401800+30j
		movzx	edx, byte ptr [ebp+0]
		mov	[ebx+eax+24h], dl
		add	eax, 1
		sub	[esp+2Ch+var_20], 1
		mov	[ebx+64h], eax
		jnz	short loc_401834

loc_401851:				; CODE XREF: sub_401800+2Bj
		xor	ebp, ebp
		cmp	eax, 40h
		mov	[esp+2Ch+var_20], 0
		jnz	short loc_40181A

loc_401860:				; CODE XREF: sub_401800+18j
		mov	edx, esi
		mov	eax, ebx
		call	sub_401550
		add	dword ptr [ebx+20h], 1
		test	ebp, ebp
		mov	dword ptr [ebx+64h], 0
		jnz	short loc_40181E

loc_401878:				; CODE XREF: sub_401800+1Cj
					; sub_401800+CEj ...
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_401880:				; CODE XREF: sub_401800+32j
					; sub_401800+3Aj
		xor	ecx, ecx
		xor	edx, edx
		mov	eax, ebx
		call	sub_401800

loc_40188B:				; CODE XREF: sub_401800+23j
		mov	esi, [esp+2Ch+var_20]
		mov	edi, ebp
		cmp	esi, 3Fh
		mov	ecx, esi
		jbe	short loc_4018CC

loc_401898:				; CODE XREF: sub_401800+B5j
		mov	edx, edi
		mov	eax, ebx
		sub	esi, 40h
		add	edi, 40h
		call	sub_401550
		add	dword ptr [ebx+20h], 1
		cmp	esi, 3Fh
		mov	dword ptr [ebx+64h], 0
		ja	short loc_401898
		mov	eax, [esp+2Ch+var_20]
		mov	ecx, [esp+2Ch+var_20]
		sub	eax, 40h
		and	eax, 0FFFFFFC0h
		and	ecx, 3Fh
		lea	ebp, [ebp+eax+40h]

loc_4018CC:				; CODE XREF: sub_401800+96j
		test	ecx, ecx
		jz	short loc_401878
		mov	edx, [ebx+64h]
		cmp	edx, 3Fh
		jg	short loc_401878
		lea	eax, [edx+1]
		add	ecx, edx
		sub	ebp, edx
		jmp	short loc_4018E9
; ---------------------------------------------------------------------------

loc_4018E1:				; CODE XREF: sub_401800+F7j
		add	eax, 1
		cmp	eax, 41h
		jz	short loc_401878

loc_4018E9:				; CODE XREF: sub_401800+DFj
		movzx	edx, byte ptr [ebp+eax-1]
		cmp	eax, ecx
		mov	[ebx+eax+23h], dl
		mov	[ebx+64h], eax
		jnz	short loc_4018E1
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401800	endp

; ---------------------------------------------------------------------------
		jmp	short sub_401910
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401910	proc near		; CODE XREF: .text:00401901j
					; sub_401FE0+81p ...

Filename	= dword	ptr -14h
Mode		= dword	ptr -10h
Count		= dword	ptr -0Ch
File		= dword	ptr -8
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
Str2		= dword	ptr  18h
DstBuf		= byte ptr  24h
arg_1020	= dword	ptr  1024h
arg_1024	= dword	ptr  1028h
arg_1028	= dword	ptr  102Ch
arg_102C	= dword	ptr  1030h
arg_1030	= dword	ptr  1034h
arg_1034	= dword	ptr  1038h
arg_1038	= dword	ptr  103Ch
arg_103C	= dword	ptr  1040h
arg_1040	= dword	ptr  1044h
arg_1044	= byte ptr  1048h
arg_1045	= byte ptr  1049h
arg_1046	= byte ptr  104Ah
arg_1047	= byte ptr  104Bh
arg_1048	= byte ptr  104Ch
arg_1049	= byte ptr  104Dh
arg_104A	= byte ptr  104Eh
arg_104B	= byte ptr  104Fh
arg_104C	= byte ptr  1050h
arg_104D	= byte ptr  1051h
arg_104E	= byte ptr  1052h
arg_104F	= byte ptr  1053h
arg_1050	= byte ptr  1054h
arg_1051	= byte ptr  1055h
arg_1052	= byte ptr  1056h
arg_1053	= byte ptr  1057h
arg_1054	= byte ptr  1058h
arg_1055	= byte ptr  1059h
arg_1056	= byte ptr  105Ah
arg_1057	= byte ptr  105Bh
arg_1058	= byte ptr  105Ch
arg_1059	= byte ptr  105Dh
arg_105A	= byte ptr  105Eh
arg_105B	= byte ptr  105Fh
arg_105C	= byte ptr  1060h
arg_105D	= byte ptr  1061h
arg_105E	= byte ptr  1062h
arg_105F	= byte ptr  1063h
arg_1060	= byte ptr  1064h
arg_1061	= byte ptr  1065h
arg_1062	= byte ptr  1066h
arg_1063	= byte ptr  1067h
arg_107C	= byte ptr  1080h
arg_107D	= byte ptr  1081h
arg_107E	= byte ptr  1082h
arg_107F	= byte ptr  1083h
arg_1080	= byte ptr  1084h
arg_1081	= byte ptr  1085h
arg_1082	= byte ptr  1086h
arg_1083	= byte ptr  1087h
arg_1084	= dword	ptr  1088h
arg_1090	= dword	ptr  1094h

		push	ebp
		push	edi
		push	esi
		push	ebx
		push	eax
		mov	eax, 10A8h
		call	sub_4036F0
		sub	esp, eax
		mov	eax, [esp+14h+arg_1090]
		add	ds:dword_406028, 1
		test	edx, edx
		mov	[esp+14h+Str2],	edx
		mov	ebp, eax
		jz	loc_401E6B

loc_40193D:				; CODE XREF: sub_401910+55Ej
					; sub_401910+568j
		mov	[esp+14h+Mode],	offset Mode ; "rb"
		mov	[esp+14h+Filename], ebp	; Filename
		call	fopen
		mov	[esp+14h+arg_8], eax

loc_401951:				; CODE XREF: sub_401910+58Fj
		mov	edi, [esp+14h+arg_8]
		test	edi, edi
		jz	loc_401F5E
		mov	[esp+14h+arg_1020], 6A09E667h
		lea	ebx, [esp+14h+DstBuf]
		mov	esi, [esp+14h+arg_8]
		mov	[esp+14h+arg_1024], 0BB67AE85h
		mov	[esp+14h+arg_1028], 3C6EF372h
		mov	[esp+14h+arg_102C], 0A54FF53Ah
		mov	[esp+14h+arg_1030], 510E527Fh
		mov	[esp+14h+arg_1034], 9B05688Ch
		mov	[esp+14h+arg_1038], 1F83D9ABh
		mov	[esp+14h+arg_103C], 5BE0CD19h
		mov	[esp+14h+arg_1040], 0
		mov	[esp+14h+arg_1084], 0
		jmp	short loc_4019E5
; ---------------------------------------------------------------------------

loc_4019D5:				; CODE XREF: sub_401910+F3j
		mov	ecx, eax
		mov	edx, ebx
		lea	eax, [esp+14h+arg_1020]
		call	sub_401800

loc_4019E5:				; CODE XREF: sub_401910+C3j
		mov	[esp+14h+File],	esi ; File
		mov	[esp+14h+Count], 1000h ; Count
		mov	[esp+14h+Mode],	1 ; ElementSize
		mov	[esp+14h+Filename], ebx	; DstBuf
		call	fread
		test	eax, eax
		jnz	short loc_4019D5
		mov	eax, [esp+14h+arg_8]
		mov	[esp+14h+Filename], eax	; File
		call	ferror
		test	eax, eax
		jnz	loc_401ED4
		xor	ecx, ecx
		xor	edx, edx
		lea	eax, [esp+14h+arg_1020]
		call	sub_401800
		mov	ecx, [esp+14h+arg_1040]
		mov	eax, [esp+14h+arg_1084]
		mov	edx, ecx
		shl	edx, 6
		mov	esi, edx
		shr	ecx, 1Ah
		add	esi, eax
		adc	ecx, 0
		lea	edx, ds:0[esi*8]
		shl	ecx, 3
		mov	[esp+14h+arg_C], edx
		mov	edx, esi
		shr	edx, 1Dh
		mov	[esp+14h+arg_10], ecx
		or	[esp+14h+arg_10], edx
		cmp	eax, 37h
		lea	edx, [eax+1]
		mov	[esp+eax+14h+arg_1044],	80h
		mov	[esp+14h+arg_1084], edx
		jg	loc_401E00
		cmp	edx, 38h
		lea	esi, [esp+14h+arg_1044]
		jz	short loc_401AB2
		lea	eax, [esp+eax+14h+arg_1045]
		lea	edx, [esp+14h+arg_107C]

loc_401A96:				; CODE XREF: sub_401910+18Ej
		mov	byte ptr [eax],	0
		add	eax, 1
		cmp	eax, edx
		jnz	short loc_401A96
		mov	[esp+14h+arg_1084], 38h
		lea	esi, [esp+14h+arg_1044]

loc_401AB2:				; CODE XREF: sub_401910+176j
					; sub_401910+532j
		mov	eax, [esp+14h+arg_10]
		movzx	edx, byte ptr [esp+14h+arg_C]
		mov	[esp+14h+arg_107C], 0
		mov	[esp+14h+arg_107D], 0
		shr	eax, 8
		mov	[esp+14h+arg_107E], al
		movzx	eax, byte ptr [esp+14h+arg_10]
		mov	[esp+14h+arg_1083], dl
		mov	edx, esi
		mov	[esp+14h+arg_107F], al
		mov	eax, [esp+14h+arg_C]
		shr	eax, 18h
		mov	[esp+14h+arg_1080], al
		mov	eax, [esp+14h+arg_C]
		shr	eax, 10h
		mov	[esp+14h+arg_1081], al
		mov	eax, [esp+14h+arg_C]
		shr	eax, 8
		mov	[esp+14h+arg_1082], al
		lea	eax, [esp+14h+arg_1020]
		call	sub_401550
		mov	eax, [esp+14h+arg_1020]
		mov	edx, eax
		shr	edx, 18h
		mov	[esp+14h+arg_1044], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esp+14h+arg_1045], dl
		mov	edx, eax
		mov	[esp+14h+arg_1047], al
		mov	eax, [esp+14h+arg_1024]
		shr	edx, 8
		mov	[esp+14h+arg_1046], dl
		mov	edx, eax
		shr	edx, 18h
		mov	[esp+14h+arg_1048], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esp+14h+arg_1049], dl
		mov	edx, eax
		mov	[esp+14h+arg_104B], al
		mov	eax, [esp+14h+arg_1028]
		shr	edx, 8
		mov	[esp+14h+arg_104A], dl
		mov	edx, eax
		shr	edx, 18h
		mov	[esp+14h+arg_104C], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esp+14h+arg_104D], dl
		mov	edx, eax
		mov	[esp+14h+arg_104F], al
		mov	eax, [esp+14h+arg_102C]
		shr	edx, 8
		mov	[esp+14h+arg_104E], dl
		mov	edx, eax
		shr	edx, 18h
		mov	[esp+14h+arg_1050], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esp+14h+arg_1051], dl
		mov	edx, eax
		mov	[esp+14h+arg_1053], al
		mov	eax, [esp+14h+arg_1030]
		shr	edx, 8
		mov	[esp+14h+arg_1052], dl
		mov	edx, eax
		shr	edx, 18h
		mov	[esp+14h+arg_1054], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esp+14h+arg_1055], dl
		mov	edx, eax
		mov	[esp+14h+arg_1057], al
		mov	eax, [esp+14h+arg_1034]
		shr	edx, 8
		mov	[esp+14h+arg_1056], dl
		mov	edx, eax
		shr	edx, 18h
		mov	[esp+14h+arg_1058], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esp+14h+arg_1059], dl
		mov	edx, eax
		mov	[esp+14h+arg_105B], al
		mov	eax, [esp+14h+arg_1038]
		shr	edx, 8
		mov	[esp+14h+arg_105A], dl
		mov	edx, eax
		shr	edx, 18h
		mov	[esp+14h+arg_105C], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esp+14h+arg_105D], dl
		mov	edx, eax
		shr	edx, 8
		mov	[esp+14h+arg_105E], dl
		mov	[esp+14h+arg_105F], al
		mov	eax, [esp+14h+arg_103C]
		mov	edx, eax
		shr	edx, 18h
		mov	[esp+14h+arg_1060], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esp+14h+arg_1061], dl
		mov	edx, eax
		mov	[esp+14h+arg_1063], al
		mov	eax, [esp+14h+arg_8]
		shr	edx, 8
		cmp	eax, ds:_iob
		mov	[esp+14h+arg_1062], dl
		jz	short loc_401CC4
		mov	[esp+14h+Filename], eax	; File
		call	fclose

loc_401CC4:				; CODE XREF: sub_401910+3AAj
		movzx	edx, byte ptr [ebp+0]
		mov	edi, 1
		test	dl, dl
		jz	short loc_401D05
		mov	eax, edx
		mov	ecx, ebp
		xor	di, di
		jmp	short loc_401CED
; ---------------------------------------------------------------------------
		align 10h

loc_401CE0:				; CODE XREF: sub_401910+3DFj
					; sub_401910+3E3j
		add	ecx, 1
		add	edi, 2
		movzx	eax, byte ptr [ecx]
		test	al, al
		jz	short loc_401D02

loc_401CED:				; CODE XREF: sub_401910+3C8j
					; sub_401910+3F0j
		cmp	al, 0Dh
		jz	short loc_401CE0
		cmp	al, 0Ah
		jz	short loc_401CE0
		add	ecx, 1
		add	edi, 1
		movzx	eax, byte ptr [ecx]
		test	al, al
		jnz	short loc_401CED

loc_401D02:				; CODE XREF: sub_401910+3DBj
		add	edi, 1

loc_401D05:				; CODE XREF: sub_401910+3BFj
		mov	[esp+14h+arg_4], dl
		mov	[esp+14h+Filename], edi	; Size
		call	malloc
		movzx	edx, [esp+14h+arg_4]
		test	eax, eax
		mov	[esp+14h+arg_8], eax
		jz	loc_401FA8
		xor	edi, edi
		test	dl, dl
		jnz	short loc_401D56
		jmp	short loc_401D75
; ---------------------------------------------------------------------------
		align 10h

loc_401D30:				; CODE XREF: sub_401910+449j
		cmp	dl, 0Dh
		jz	loc_401E47
		cmp	dl, 5Ch
		lea	esi, [esi+0]
		jz	loc_401E60
		mov	[eax], dl
		add	eax, 1

loc_401D4B:				; CODE XREF: sub_401910+546j
					; sub_401910+556j
		add	ebp, 1
		movzx	edx, byte ptr [ebp+0]
		test	dl, dl
		jz	short loc_401D75

loc_401D56:				; CODE XREF: sub_401910+416j
					; sub_401910+463j
		cmp	dl, 0Ah
		jnz	short loc_401D30
		add	ebp, 1
		mov	edi, 1
		mov	byte ptr [eax],	5Ch
		mov	byte ptr [eax+1], 6Eh
		movzx	edx, byte ptr [ebp+0]
		add	eax, 2
		test	dl, dl
		jnz	short loc_401D56

loc_401D75:				; CODE XREF: sub_401910+418j
					; sub_401910+444j
		add	ds:dword_406030, 1
		xor	ebp, ebp
		mov	byte ptr [eax],	0

loc_401D81:				; CODE XREF: sub_401910+49Aj
		movzx	eax, byte ptr [esi+ebp]
		mov	[esp+14h+Count], offset	a02x ; "%02x"
		mov	[esp+14h+Mode],	0Ah ; size_t
		mov	[esp+14h+File],	eax ; char
		lea	eax, [ebx+ebp*2]
		add	ebp, 1
		mov	[esp+14h+Filename], eax	; char *
		call	sub_403770
		cmp	ebp, 20h
		jnz	short loc_401D81
		mov	ecx, [esp+14h+Str2]
		test	ecx, ecx
		jz	loc_401EA4
		mov	edx, [esp+14h+Str2]
		mov	[esp+14h+Filename], ebx	; Str1
		mov	[esp+14h+Mode],	edx ; Str2
		call	strcmp
		test	eax, eax
		mov	eax, [esp+14h+arg_8]
		mov	[esp+14h+Mode],	eax
		jnz	loc_401F41
		mov	[esp+14h+Filename], offset Format ; "%s: OK\n"
		call	printf

loc_401DE4:				; CODE XREF: sub_401910+5BFj
		mov	eax, [esp+14h+arg_8]
		mov	[esp+14h+Filename], eax	; Memory
		call	free
		xor	eax, eax

loc_401DF2:				; CODE XREF: sub_401910+62Cj
					; sub_401910+649j
		add	esp, 10ACh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401E00:				; CODE XREF: sub_401910+166j
		cmp	edx, 3Fh
		jg	short loc_401E20

loc_401E05:				; CODE XREF: sub_401910+503j
		mov	[esp+eax+14h+arg_1045],	0
		add	eax, 1
		cmp	eax, 3Fh
		jnz	short loc_401E05
		mov	[esp+14h+arg_1084], 40h

loc_401E20:				; CODE XREF: sub_401910+4F3j
		xor	ecx, ecx
		xor	edx, edx
		lea	eax, [esp+14h+arg_1020]
		lea	esi, [esp+14h+arg_1044]
		call	sub_401800
		mov	edi, esi
		mov	ecx, 0Eh
		xor	eax, eax
		rep stosd
		jmp	loc_401AB2
; ---------------------------------------------------------------------------

loc_401E47:				; CODE XREF: sub_401910+423j
		mov	byte ptr [eax],	5Ch
		mov	edi, 1
		mov	byte ptr [eax+1], 72h
		add	eax, 2
		jmp	loc_401D4B
; ---------------------------------------------------------------------------
		align 10h

loc_401E60:				; CODE XREF: sub_401910+430j
		mov	byte ptr [eax],	2Fh
		add	eax, 1
		jmp	loc_401D4B
; ---------------------------------------------------------------------------

loc_401E6B:				; CODE XREF: sub_401910+27j
		cmp	byte ptr [eax],	2Dh
		jnz	loc_40193D
		cmp	byte ptr [eax+1], 0
		jnz	loc_40193D
		mov	eax, ds:_iob
		mov	[esp+14h+arg_8], eax
		mov	[esp+14h+Filename], eax	; File
		call	_fileno
		mov	[esp+14h+Mode],	8000h
		mov	[esp+14h+Filename], eax
		call	_setmode
		jmp	loc_401951
; ---------------------------------------------------------------------------

loc_401EA4:				; CODE XREF: sub_401910+4A2j
		test	edi, edi
		mov	edx, offset byte_40508B
		mov	eax, offset asc_405089 ; "\\"
		cmovz	eax, edx
		mov	edx, [esp+14h+arg_8]
		mov	[esp+14h+Count], ebx
		mov	[esp+14h+Mode],	eax
		mov	[esp+14h+Filename], offset aSSS	; "%s%s	 %s\n"
		mov	[esp+14h+File],	edx
		call	printf
		jmp	loc_401DE4
; ---------------------------------------------------------------------------

loc_401ED4:				; CODE XREF: sub_401910+103j
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Count], ebp
		mov	[esp+14h+Mode],	offset aSha256sumError ; "sha256sum: error reading `%s': %s\n"
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	eax, [esp+14h+arg_8]
		cmp	eax, ds:_iob
		jz	short loc_401F18
		mov	[esp+14h+Filename], eax	; File
		call	fclose

loc_401F18:				; CODE XREF: sub_401910+5FEj
		mov	ebx, [esp+14h+Str2]
		test	ebx, ebx
		jz	short loc_401F30
		mov	[esp+14h+Mode],	ebp
		mov	[esp+14h+Filename], offset aSFailedRead	; "%s: FAILED read\n"
		call	printf

loc_401F30:				; CODE XREF: sub_401910+60Ej
					; sub_401910+684j ...
		add	ds:dword_406024, 1
		mov	eax, 0FFFFFFFFh
		jmp	loc_401DF2
; ---------------------------------------------------------------------------

loc_401F41:				; CODE XREF: sub_401910+4C2j
		mov	[esp+14h+Filename], offset aSFailed ; "%s: FAILED\n"
		call	printf
		mov	eax, 0FFFFFFFFh
		add	ds:dword_40602C, 1
		jmp	loc_401DF2
; ---------------------------------------------------------------------------

loc_401F5E:				; CODE XREF: sub_401910+47j
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Count], ebp
		mov	[esp+14h+Mode],	offset aSha256sumCanTO ; "sha256sum: can't open `%s': %s\n"
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	esi, [esp+14h+Str2]
		test	esi, esi
		jz	short loc_401F30
		mov	[esp+14h+Mode],	ebp
		mov	[esp+14h+Filename], offset aSFailedOpen	; "%s: FAILED open\n"
		call	printf
		jmp	short loc_401F30
; ---------------------------------------------------------------------------

loc_401FA8:				; CODE XREF: sub_401910+40Cj
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Mode],	offset aSha256sumCanTA ; "sha256sum: can't allocate buffer: %s\n"
		mov	[esp+14h+Count], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	[esp+14h+Filename], 2 ;	Code
		call	exit
sub_401910	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401FE0	proc near		; CODE XREF: sub_4038E0+123p

File		= dword	ptr -10h
Format		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_18		= dword	ptr  1Ch
arg_1C		= byte ptr  20h

		push	ebp
		mov	eax, 103Ch
		push	edi
		push	esi
		push	ebx
		call	sub_4036F0
		xor	ebx, ebx
		xor	ebp, ebp
		xor	edi, edi
		sub	esp, eax
		mov	eax, ds:_iob
		mov	[esp+10h+File],	eax ; File
		call	_fileno
		mov	[esp+10h+Format], 8000h
		mov	[esp+10h+File],	eax
		call	_setmode
		mov	[esp+10h+arg_18], 0
		jmp	short loc_402024
; ---------------------------------------------------------------------------
		align 10h

loc_402020:				; CODE XREF: sub_401FE0+6Cj
					; sub_401FE0+79j
		test	esi, esi
		jnz	short loc_402078

loc_402024:				; CODE XREF: sub_401FE0+3Bj
					; sub_401FE0+96j
		mov	eax, ds:_iob
		xor	esi, esi
		mov	[esp+10h+File],	eax ; File
		call	getc
		cmp	eax, 0FFFFFFFFh
		jz	short loc_402085
		cmp	ebp, 0FFFh
		ja	short loc_4020A5

loc_402040:				; CODE XREF: sub_401FE0+C3j
		mov	[esp+ebp+10h+arg_1C], al
		add	ebx, 1
		add	ebp, 1
		test	eax, eax
		jnz	short loc_402020
		xor	ebp, ebp
		cmp	[esp+10h+arg_1C], 0
		mov	[esp+10h+arg_18], ebx
		jz	short loc_402020
		xor	edx, edx
		lea	eax, [esp+10h+arg_1C]
		call	sub_401910
		mov	[esp+10h+arg_18], ebx
		test	eax, eax
		mov	eax, 0FFFFFFFFh
		cmovnz	edi, eax
		test	esi, esi
		jz	short loc_402024

loc_402078:				; CODE XREF: sub_401FE0+42j
					; sub_401FE0+F0j ...
		add	esp, 103Ch
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_402085:				; CODE XREF: sub_401FE0+56j
		mov	eax, ds:_iob
		mov	[esp+10h+File],	eax ; File
		call	ferror
		test	eax, eax
		jnz	short loc_4020D2
		xor	eax, eax
		cmp	ebp, 0FFFh
		mov	esi, 1
		jbe	short loc_402040

loc_4020A5:				; CODE XREF: sub_401FE0+5Ej
		mov	eax, [esp+10h+arg_18]
		or	edi, 0FFFFFFFFh
		mov	[esp+10h+var_8], offset	aStdin ; "[stdin]"
		mov	[esp+10h+Format], offset aSha256sumErr_0 ; "sha256sum: error reading `%s': filename"...
		mov	[esp+10h+var_4], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+10h+File],	eax ; File
		call	fprintf
		jmp	short loc_402078
; ---------------------------------------------------------------------------

loc_4020D2:				; CODE XREF: sub_401FE0+B4j
		call	ds:_errno
		or	edi, 0FFFFFFFFh
		mov	eax, [eax]
		mov	[esp+10h+File],	eax ; int
		call	strerror
		mov	[esp+10h+var_4], ebx
		mov	[esp+10h+var_8], offset	aStdin ; "[stdin]"
		mov	[esp+10h+Format], offset aSha256sumErr_1 ; "sha256sum:error reading `%s' at offset "...
		mov	[esp+10h], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+10h+File],	eax ; File
		call	fprintf
		jmp	loc_402078
sub_401FE0	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402120	proc near		; CODE XREF: sub_4038E0+159p

Filename	= dword	ptr -14h
Mode		= dword	ptr -10h
File		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Buf		= byte ptr  0Ch
arg_48		= byte ptr  4Ch
arg_1010	= dword	ptr  1014h

		push	ebp
		push	edi
		push	esi
		push	ebx
		push	eax
		mov	eax, 1028h
		call	sub_4036F0
		sub	esp, eax
		mov	eax, [esp+14h+arg_1010]
		cmp	byte ptr [eax],	2Dh
		mov	[esp+14h+arg_0], eax
		jz	loc_4022E8

loc_402145:				; CODE XREF: sub_402120+1D8j
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+Mode],	offset aR ; "r"
		mov	[esp+14h+Filename], eax	; Filename
		call	fopen
		mov	esi, eax

loc_40215B:				; CODE XREF: sub_402120+1D2j
		test	esi, esi
		jz	loc_4023FF
		mov	dword ptr [esp+14h], 0
		lea	ebx, [esp+14h+Buf]
		nop

loc_402170:				; CODE XREF: sub_402120+AEj
					; sub_402120+ECj ...
		mov	[esp+14h+File],	esi ; File
		mov	[esp+14h+Mode],	0FFFh ;	MaxCount
		mov	[esp+14h+Filename], ebx	; Buf
		call	fgets
		test	eax, eax
		jz	loc_4022B9
		xor	ecx, ecx
		cmp	[esp+14h+Buf], 5Ch
		setz	cl
		mov	ebp, ecx
		lea	edi, [ebx+ebp]
		mov	[esp+14h+Filename], edi	; Str
		call	strlen
		test	eax, eax
		jz	loc_402276
		cmp	byte ptr [edi+eax-1], 0Ah
		jnz	loc_402276
		mov	edx, eax
		sub	edx, 1
		mov	byte ptr [edi+eax-1], 0
		jz	short loc_4021C9
		cmp	byte ptr [edi+edx-1], 0Dh
		jz	short loc_402211

loc_4021C9:				; CODE XREF: sub_402120+A0j
					; sub_402120+F9j
		cmp	[esp+ebp+14h+Buf], 0
		jz	short loc_402170
		cmp	edx, 41h
		jbe	short loc_4021DC
		cmp	[esp+ebp+14h+arg_48], 20h
		jz	short loc_402220

loc_4021DC:				; CODE XREF: sub_402120+B3j
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+var_8], offset	aInvalidLine ; "invalid	line"
		mov	[esp+14h+Mode],	offset aSha256sumErr_2 ; "sha256sum: error parsing `%s': %s\n"
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	dword ptr [esp+14h], 0FFFFFFFFh
		jmp	loc_402170
; ---------------------------------------------------------------------------

loc_402211:				; CODE XREF: sub_402120+A7j
		lea	edx, [eax-2]
		mov	byte ptr [edi+eax-2], 0
		jmp	short loc_4021C9
; ---------------------------------------------------------------------------
		align 10h

loc_402220:				; CODE XREF: sub_402120+BAj
		mov	[esp+ebp+14h+arg_48], 0
		movzx	eax, byte ptr [edi]
		test	al, al
		jz	short loc_402247
		mov	edx, edi
		xchg	ax, ax

loc_402230:				; CODE XREF: sub_402120+125j
		lea	ecx, [eax-41h]
		cmp	cl, 19h
		ja	short loc_40223D
		or	eax, 20h
		mov	[edx], al

loc_40223D:				; CODE XREF: sub_402120+116j
		add	edx, 1
		movzx	eax, byte ptr [edx]
		test	al, al
		jnz	short loc_402230

loc_402247:				; CODE XREF: sub_402120+10Aj
		lea	eax, [edi+42h]
		test	ebp, ebp
		mov	[esp+14h+arg_4], eax
		jnz	loc_402300

loc_402256:				; CODE XREF: sub_402120+243j
		mov	eax, [esp+14h+arg_4]
		mov	edx, edi
		call	sub_401910
		test	eax, eax
		mov	eax, 0FFFFFFFFh
		cmovz	eax, [esp+14h]
		mov	[esp+14h], eax
		jmp	loc_402170
; ---------------------------------------------------------------------------

loc_402276:				; CODE XREF: sub_402120+85j
					; sub_402120+90j
		mov	[esp+14h+Filename], esi	; File
		call	feof
		mov	edx, offset aLastLinefeedMi ; "last linefeed missing"
		mov	[esp+14h+Mode],	offset aSha256sumError ; "sha256sum: error reading `%s': %s\n"
		test	eax, eax
		mov	eax, offset aLineTooLong ; "line too long"
		cmovz	edx, eax
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+var_8], edx
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	dword ptr [esp+14h], 0FFFFFFFFh

loc_4022B9:				; CODE XREF: sub_402120+66j
		mov	[esp+14h+Filename], esi	; File
		call	ferror
		test	eax, eax
		jnz	loc_402368

loc_4022C9:				; CODE XREF: sub_402120+284j
		cmp	esi, ds:_iob
		jz	short loc_4022D9
		mov	[esp+14h+Filename], esi	; File
		call	fclose

loc_4022D9:				; CODE XREF: sub_402120+1AFj
					; sub_402120+31Bj
		mov	eax, [esp+14h]
		add	esp, 102Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4022E8:				; CODE XREF: sub_402120+1Fj
		cmp	byte ptr [eax+1], 0
		mov	esi, ds:_iob
		jz	loc_40215B
		jmp	loc_402145
; ---------------------------------------------------------------------------
		align 10h

loc_402300:				; CODE XREF: sub_402120+130j
		movzx	edx, byte ptr [edi+42h]
		test	dl, dl
		jz	short loc_402360
		mov	[esp+14h+var_4], eax
		jmp	short loc_402328
; ---------------------------------------------------------------------------
		align 10h

loc_402310:				; CODE XREF: sub_402120+20Bj
					; sub_402120+219j
		mov	[eax], dl
		mov	edx, [esp+14h+var_4]
		add	eax, 1

loc_402319:				; CODE XREF: sub_402120+23Dj
					; sub_402120+2A3j ...
		lea	ecx, [edx+1]
		movzx	edx, byte ptr [edx+1]
		mov	[esp+14h+var_4], ecx
		test	dl, dl
		jz	short loc_402360

loc_402328:				; CODE XREF: sub_402120+1ECj
		cmp	dl, 5Ch
		jnz	short loc_402310
		mov	ecx, [esp+14h+var_4]
		movzx	ebp, byte ptr [ecx+1]
		mov	ecx, ebp
		test	cl, cl
		jz	short loc_402310
		mov	edx, [esp+14h+var_4]
		sub	ebp, 5Ch
		mov	ecx, ebp
		add	edx, 1
		cmp	cl, 1Ah
		jbe	short loc_4023B0

loc_40234C:				; CODE XREF: sub_402120+296j
					; DATA XREF: .rdata:off_405238o
		mov	ebp, [esp+14h+var_4] ; jumptable 004023B6 cases	1-5,7-9,11-17,19-21,23-25
		mov	byte ptr [eax],	5Ch
		movzx	ecx, byte ptr [ebp+1]
		mov	[eax+1], cl
		add	eax, 2
		jmp	short loc_402319
; ---------------------------------------------------------------------------
		align 10h

loc_402360:				; CODE XREF: sub_402120+1E6j
					; sub_402120+206j
		mov	byte ptr [eax],	0
		jmp	loc_402256
; ---------------------------------------------------------------------------

loc_402368:				; CODE XREF: sub_402120+1A3j
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Mode],	offset aSha256sumErr_3 ; "sha256sum:error reading `%s': %s\n"
		mov	[esp+14h+var_8], eax
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	dword ptr [esp+14h], 0FFFFFFFFh
		jmp	loc_4022C9
; ---------------------------------------------------------------------------
		align 10h

loc_4023B0:				; CODE XREF: sub_402120+22Aj
		and	ebp, 0FFh	; switch 256 cases
		jmp	ds:off_405238[ebp*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4023BD:				; CODE XREF: sub_402120+296j
					; DATA XREF: .rdata:off_405238o
		mov	byte ptr [eax],	0Bh ; jumptable	004023B6 case 26
		add	eax, 1
		jmp	loc_402319
; ---------------------------------------------------------------------------

loc_4023C8:				; CODE XREF: sub_402120+296j
					; DATA XREF: .rdata:off_405238o
		mov	byte ptr [eax],	0Dh ; jumptable	004023B6 case 22
		add	eax, 1
		jmp	loc_402319
; ---------------------------------------------------------------------------

loc_4023D3:				; CODE XREF: sub_402120+296j
					; DATA XREF: .rdata:off_405238o
		mov	byte ptr [eax],	0Ah ; jumptable	004023B6 case 18
		add	eax, 1
		jmp	loc_402319
; ---------------------------------------------------------------------------

loc_4023DE:				; CODE XREF: sub_402120+296j
					; DATA XREF: .rdata:off_405238o
		mov	byte ptr [eax],	0Ch ; jumptable	004023B6 case 10
		add	eax, 1
		jmp	loc_402319
; ---------------------------------------------------------------------------

loc_4023E9:				; CODE XREF: sub_402120+296j
					; DATA XREF: .rdata:off_405238o
		mov	byte ptr [eax],	8 ; jumptable 004023B6 case 6
		add	eax, 1
		jmp	loc_402319
; ---------------------------------------------------------------------------

loc_4023F4:				; CODE XREF: sub_402120+296j
					; DATA XREF: .rdata:off_405238o
		mov	byte ptr [eax],	5Ch ; jumptable	004023B6 case 0
		add	eax, 1
		jmp	loc_402319
; ---------------------------------------------------------------------------

loc_4023FF:				; CODE XREF: sub_402120+3Dj
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Mode],	offset aSha256sumCanTO ; "sha256sum: can't open `%s': %s\n"
		mov	[esp+14h+var_8], eax
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	dword ptr [esp+14h], 0FFFFFFFFh
		jmp	loc_4022D9
sub_402120	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00408024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_402460
		cmp	eax, 3
		jz	short loc_402460
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_402460:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_403650
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; jumptable 004023B6 case 209

		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; sub_402120+296j
					; DATA XREF: ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_4024D4
		cmp	dword_404010, 2
		jz	short loc_4024B6
		mov	dword_404010, 2

loc_4024B6:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_4025C3
		cmp	eax, 1
		jz	loc_402562

loc_4024C8:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4024D4:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_4063F8, 1
		mov	[esp+1Ch+lpLibFileName], (offset off_405238+308h) ; lpLibFileName
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_4025F3
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], (offset off_405238+315h) ; lpProcName
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_4063F4, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], (offset off_405238+330h) ; lpProcName
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_4063F0, eax
		jz	loc_4025F3
		mov	ecx, ds:dword_4063F4
		test	ecx, ecx
		jz	short loc_402583
		test	eax, eax
		jz	short loc_402583
		mov	dword_404010, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_402562:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_403650
		jmp	loc_4024C8
; ---------------------------------------------------------------------------

loc_402583:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_4063F0, 0
		mov	ds:dword_4063F4, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_4025A3:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_404010, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4025C3:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_408030
		cmp	ebx, offset dword_408030
		jz	loc_4024C8

loc_4025D4:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_4025DC
		call	eax

loc_4025DC:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_408030
		jnz	short loc_4025D4
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4025F3:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_4063F0, 0
		mov	ds:dword_4063F4, 0
		jmp	short loc_4025A3
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402620	proc near		; DATA XREF: .CRT:00408014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_402620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402630	proc near		; CODE XREF: sub_402650+10p
					; sub_402650+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_402630	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402640	proc near		; CODE XREF: sub_401060+59p
					; sub_402650+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_402640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402650(_onexit_t)
sub_402650	proc near		; CODE XREF: sub_402710+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_406400
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_402630
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_4026F0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_406400
		mov	[esp+2Ch+Func],	eax
		call	sub_402630
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_4063FC
		mov	[esp+2Ch+Func],	eax
		call	sub_402630
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_402640
		mov	ds:dword_406400, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_402640
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_4063FC, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4026F0:				; CODE XREF: sub_402650+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_402650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402710(_onexit_t)
sub_402710	proc near		; CODE XREF: sub_403330-27p
					; sub_403B50+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_402650
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_402710	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_402787
		cmp	eax, 0C000008Dh
		jb	short loc_4027B4

loc_40274B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_402750:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_402880
		test	eax, eax
		jz	short loc_40279C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_40277F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_402787:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_4027F5
		cmp	eax, 0C0000096h
		jz	short loc_4027C2
		cmp	eax, 0C0000093h
		jz	short loc_40274B

loc_40279C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_40605C
		test	eax, eax
		jz	loc_402873
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_4027B4:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_402800
		cmp	eax, 0C000001Dh
		jnz	short loc_40279C

loc_4027C2:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_402837
		test	eax, eax
		jz	short loc_40279C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4027F5:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_402750
; ---------------------------------------------------------------------------
		align 10h

loc_402800:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_402855
		test	eax, eax
		jz	loc_40279C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_402837:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40277F
; ---------------------------------------------------------------------------

loc_402855:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40277F
; ---------------------------------------------------------------------------

loc_402873:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_40277F
; ---------------------------------------------------------------------------
		align 10h

loc_402880:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_40277F
		mov	[esp+2Ch+var_10], eax
		call	sub_4032A0
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_40277F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_406060
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_402901
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_406060
		jmp	short loc_402907
; ---------------------------------------------------------------------------

loc_402901:				; CODE XREF: .text:004028D6j
		fstp	st
		fstp	st
		fstp	st

loc_402907:				; CODE XREF: .text:004028FFj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402910	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_406060, eax
		jmp	__setusermatherr
sub_402910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402920	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, 405580h
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_40293D
		mov	edx, ds:dword_40569C[ecx*4]

loc_40293D:				; CODE XREF: sub_402920+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], (offset off_405238+358h) ; Format
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_402920	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402980	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_402980	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_402990(char *Format, char ArgList)
sub_402990	proc near		; CODE XREF: sub_4029F0+1DDp
					; sub_4029F0+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_402990	endp

; ---------------------------------------------------------------------------
		jmp	short sub_4029F0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_4029F0(size_t Size)
sub_4029F0	proc near		; CODE XREF: .text:004029E1j
					; sub_402C30+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_40606C
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_402BD2
		mov	eax, ds:dword_406068
		xor	esi, esi

loc_402A14:				; CODE XREF: sub_4029F0+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_402A29
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_402B00

loc_402A29:				; CODE XREF: sub_4029F0+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_402A14

loc_402A33:				; CODE XREF: sub_4029F0+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_402FF0
		test	eax, eax
		mov	edi, eax
		jz	loc_402BF9
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_406068
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_4030D0
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_406068
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_402BD9
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_402B81

loc_402AAF:				; CODE XREF: sub_4029F0+194j
					; sub_4029F0+1C6j
		add	ds:dword_40606C, 1

loc_402AB6:				; CODE XREF: sub_4029F0+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_402C09
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_402B08

loc_402ADF:				; CODE XREF: sub_4029F0+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_402AF3:				; CODE XREF: sub_4029F0+162j
					; sub_4029F0+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402B00:				; CODE XREF: sub_4029F0+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_402AB6
; ---------------------------------------------------------------------------

loc_402B08:				; CODE XREF: sub_4029F0+EDj
		cmp	eax, 40h
		jz	short loc_402ADF
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_402AF3
		cmp	eax, 4
		jz	short loc_402AF3
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_402B81:				; CODE XREF: sub_4029F0+B9j
		cmp	eax, 40h
		jz	loc_402AAF
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_406068
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_402AAF
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_402990
; ---------------------------------------------------------------------------

loc_402BD2:				; CODE XREF: sub_4029F0+17j
		xor	esi, esi
		jmp	loc_402A33
; ---------------------------------------------------------------------------

loc_402BD9:				; CODE XREF: sub_4029F0+ACj
		mov	eax, ds:dword_406068
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_402990
; ---------------------------------------------------------------------------

loc_402BF9:				; CODE XREF: sub_4029F0+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_402990
; ---------------------------------------------------------------------------

loc_402C09:				; CODE XREF: sub_4029F0+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_402990
sub_4029F0	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402C30	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_406064
		test	eax, eax
		jz	short loc_402C50

loc_402C42:				; CODE XREF: sub_402C30+66j
					; sub_402C30+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402C50:				; CODE XREF: sub_402C30+10j
		mov	ds:dword_406064, 1
		call	sub_403030
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_4036F0
		mov	ds:dword_40606C, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_406068, eax
		mov	eax, offset dword_4057CC
		sub	eax, offset dword_4057CC
		cmp	eax, 7
		jle	short loc_402C42
		cmp	eax, 0Bh
		mov	ebx, offset dword_4057CC
		jle	loc_402D90
		mov	eax, ds:dword_4057CC
		test	eax, eax
		jnz	short loc_402CC0
		mov	eax, ds:dword_4057D0
		test	eax, eax
		jz	loc_402D7C
		lea	esi, [esi+0]

loc_402CC0:				; CODE XREF: sub_402C30+7Dj
					; sub_402C30+164j ...
		cmp	ebx, offset dword_4057CC
		jnb	loc_402C42
		mov	esi, 400000h

loc_402CD1:				; CODE XREF: sub_402C30+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_4029F0
		cmp	ebx, offset dword_4057CC
		jb	short loc_402CD1

loc_402CF5:				; CODE XREF: sub_402C30+24Bj
		mov	ecx, ds:dword_40606C
		test	ecx, ecx
		jle	loc_402C42
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_402D22
; ---------------------------------------------------------------------------
		align 10h

loc_402D10:				; CODE XREF: sub_402C30+FDj
					; sub_402C30+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_40606C
		jge	loc_402C42

loc_402D22:				; CODE XREF: sub_402C30+DDj
		mov	eax, ds:dword_406068
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_402D10
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_402EA2
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_406068
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_402D10
; ---------------------------------------------------------------------------

loc_402D7C:				; CODE XREF: sub_402C30+86j
		mov	eax, ds:dword_4057D4
		test	eax, eax
		jnz	short loc_402DA5
		mov	ebx, offset dword_4057D8
		lea	esi, [esi+0]

loc_402D90:				; CODE XREF: sub_402C30+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_402CC0
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_402CC0

loc_402DA5:				; CODE XREF: sub_402C30+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_402EC5
		add	ebx, 0Ch
		cmp	ebx, offset dword_4057CC
		jnb	loc_402C42

loc_402DC0:				; CODE XREF: sub_402C30+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_402E1A
		cmp	edx, 20h
		jz	short loc_402E50
		cmp	edx, 8
		jz	short loc_402DFA
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_402990
; ---------------------------------------------------------------------------

loc_402DFA:				; CODE XREF: sub_402C30+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_402E25
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_402E41
; ---------------------------------------------------------------------------

loc_402E1A:				; CODE XREF: sub_402C30+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_402E80

loc_402E25:				; CODE XREF: sub_402C30+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_402E93
		cmp	edx, 20h
		jz	short loc_402E5F
		cmp	edx, 8
		jnz	short loc_402E6C

loc_402E41:				; CODE XREF: sub_402C30+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_4029F0
		jmp	short loc_402E6C
; ---------------------------------------------------------------------------

loc_402E50:				; CODE XREF: sub_402C30+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_402E5F:				; CODE XREF: sub_402C30+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_4029F0

loc_402E6C:				; CODE XREF: sub_402C30+20Fj
					; sub_402C30+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_4057CC
		jb	loc_402DC0
		jmp	loc_402CF5
; ---------------------------------------------------------------------------

loc_402E80:				; CODE XREF: sub_402C30+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_402E93:				; CODE XREF: sub_402C30+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_4029F0
		jmp	short loc_402E6C
; ---------------------------------------------------------------------------

loc_402EA2:				; CODE XREF: sub_402C30+11Bj
		add	ebx, ds:dword_406068
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_402990
; ---------------------------------------------------------------------------

loc_402EC5:				; CODE XREF: sub_402C30+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_402990
sub_402C30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402EE0	proc near		; CODE XREF: .text:00402F81p
					; sub_402FF0+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_402EF0

locret_402EED:				; CODE XREF: sub_402EE0+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_402EF0:				; CODE XREF: sub_402EE0+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_402EED
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_402EE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402F10	proc near		; CODE XREF: sub_402FF0+2Bp
					; .text:00403134p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_402F4E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_402F34:				; CODE XREF: sub_402F10+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_402F42
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_402F4E

loc_402F42:				; CODE XREF: sub_402F10+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_402F34
		xor	eax, eax

loc_402F4E:				; CODE XREF: sub_402F10+19j
					; sub_402F10+30j
		pop	ebx
		pop	esi
		retn
sub_402F10	endp

; ---------------------------------------------------------------------------
		jmp	short loc_402F60
; ---------------------------------------------------------------------------
		align 10h

loc_402F60:				; CODE XREF: .text:00402F51j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_402FD3
		mov	dword ptr [esp], 400000h
		call	sub_402EE0
		test	eax, eax
		jz	short loc_402FD3
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_402FD3
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_402FBB
; ---------------------------------------------------------------------------

loc_402FB1:				; CODE XREF: .text:00402FD1j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_402FE0

loc_402FBB:				; CODE XREF: .text:00402FAFj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_402FB1

loc_402FD3:				; CODE XREF: .text:00402F78j
					; .text:00402F88j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402FE0:				; CODE XREF: .text:00402FB9j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402FF0	proc near		; CODE XREF: sub_4029F0+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_402EE0
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_403020
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_402F10

loc_403020:				; CODE XREF: sub_402FF0+15j
		add	esp, 8
		retn
sub_402FF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403030	proc near		; CODE XREF: sub_402C30+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_402EE0
		xor	edx, edx
		test	eax, eax
		jz	short loc_403051
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_403051:				; CODE XREF: sub_403030+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_403030	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_402EE0
		xor	edx, edx
		test	eax, eax
		jz	short loc_4030B9
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_4030B9
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_4030A0:				; CODE XREF: .text:004030B5j
		test	byte ptr [edx+27h], 20h
		jz	short loc_4030AD
		test	ebx, ebx
		jz	short loc_4030B9
		sub	ebx, 1

loc_4030AD:				; CODE XREF: .text:004030A4j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_4030A0
		xor	edx, edx

loc_4030B9:				; CODE XREF: .text:00403079j
					; .text:00403095j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_4030D0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4030D0	proc near		; CODE XREF: sub_4029F0+70p
					; .text:004030C1j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_402EE0
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_4030D0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_403100
; ---------------------------------------------------------------------------
		align 10h

loc_403100:				; CODE XREF: .text:004030F1j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_402EE0
		test	eax, eax
		jnz	short loc_403120

loc_403116:				; CODE XREF: .text:0040313Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403120:				; CODE XREF: .text:00403114j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_402F10
		test	eax, eax
		jz	short loc_403116
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403150	proc near		; CODE XREF: sub_4031E0+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_402EE0
		test	eax, eax
		jz	short loc_4031C1
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_4031C1
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_402F10
		test	eax, eax
		jz	short loc_4031C1
		add	esi, 400000h
		jnz	short loc_4031A6
		jmp	short loc_4031C1
; ---------------------------------------------------------------------------
		align 10h

loc_4031A0:				; CODE XREF: sub_403150+66j
		sub	ebx, 1
		add	esi, 14h

loc_4031A6:				; CODE XREF: sub_403150+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_4031B4
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_4031D0

loc_4031B4:				; CODE XREF: sub_403150+5Bj
		test	ebx, ebx
		jg	short loc_4031A0
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_4031C1:				; CODE XREF: sub_403150+1Aj
					; sub_403150+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4031D0:				; CODE XREF: sub_403150+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_403150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4031E0	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_406070
		test	eax, eax
		jz	short loc_4031F2

loc_4031ED:				; CODE XREF: sub_4031E0+97j
					; sub_4031E0+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4031F2:				; CODE XREF: sub_4031E0+Bj
		xor	eax, eax

loc_4031F4:				; CODE XREF: sub_4031E0+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_403150
		test	eax, eax
		jz	short loc_403280
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_403210
		cmp	dl, 6Dh
		jnz	short loc_403260

loc_403210:				; CODE XREF: sub_4031E0+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40321E
		cmp	dl, 73h
		jnz	short loc_403260

loc_40321E:				; CODE XREF: sub_4031E0+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40322C
		cmp	dl, 76h
		jnz	short loc_403260

loc_40322C:				; CODE XREF: sub_4031E0+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_40323A
		cmp	dl, 63h
		jnz	short loc_403260

loc_40323A:				; CODE XREF: sub_4031E0+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_403248
		cmp	dl, 72h
		jnz	short loc_403260

loc_403248:				; CODE XREF: sub_4031E0+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_403264
		cmp	dl, 74h
		jz	short loc_403264
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_403264
		xchg	ax, ax

loc_403260:				; CODE XREF: sub_4031E0+2Ej
					; sub_4031E0+3Cj ...
		mov	eax, ebx
		jmp	short loc_4031F4
; ---------------------------------------------------------------------------

loc_403264:				; CODE XREF: sub_4031E0+6Fj
					; sub_4031E0+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_406070, eax
		jnz	loc_4031ED
		lea	esi, [esi+0]

loc_403280:				; CODE XREF: sub_4031E0+21j
		mov	[esp+1Ch+lpModuleName],	offset LibFileName ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_406070, eax
		jmp	loc_4031ED
sub_4031E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4032A0	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_4032A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4032B0()
sub_4032B0	proc near		; DATA XREF: sub_403330:loc_403302o
		sub	esp, 0Ch
		mov	eax, off_40400C
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4032D7
		xchg	ax, ax

loc_4032C0:				; CODE XREF: sub_4032B0+25j
		call	eax
		mov	eax, off_40400C
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_40400C, edx
		test	eax, eax
		jnz	short loc_4032C0

loc_4032D7:				; CODE XREF: sub_4032B0+Cj
		add	esp, 0Ch
		retn
sub_4032B0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_403330

loc_4032E0:				; CODE XREF: sub_403330+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_403B70
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_403313

loc_4032EF:				; CODE XREF: sub_403330-9j
		test	ebx, ebx
		jz	short loc_403302

loc_4032F3:				; CODE XREF: sub_403330-30j
		call	ds:dword_403B70[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_4032F3

loc_403302:				; CODE XREF: sub_403330-3Fj
		mov	[esp+1Ch+var_1C], offset sub_4032B0 ; _onexit_t
		call	sub_402710
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403313:				; CODE XREF: sub_403330-43j
		xor	ebx, ebx
		jmp	short loc_403319
; ---------------------------------------------------------------------------

loc_403317:				; CODE XREF: sub_403330-Bj
		mov	ebx, eax

loc_403319:				; CODE XREF: sub_403330-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_403B70[eax*4]
		test	edx, edx
		jnz	short loc_403317
		jmp	short loc_4032EF
; END OF FUNCTION CHUNK	FOR sub_403330
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403330	proc near		; CODE XREF: sub_401180+239p
					; sub_4038E0+12p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 004032E0 SIZE 00000049 BYTES

		mov	ecx, ds:dword_406074
		test	ecx, ecx
		jz	short loc_403340
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_403340:				; CODE XREF: sub_403330+8j
		mov	ds:dword_406074, 1
		jmp	short loc_4032E0
sub_403330	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403350	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_404018
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_4033A0
		not	eax
		mov	dword_40401C, eax

loc_403386:				; CODE XREF: sub_403350+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4033A0:				; CODE XREF: sub_403350+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_403412

loc_403402:				; CODE XREF: sub_403350+CCj
		mov	dword_404018, ebp
		mov	dword_40401C, eax
		jmp	loc_403386
; ---------------------------------------------------------------------------

loc_403412:				; CODE XREF: sub_403350+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_403402
sub_403350	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_406144, edx
		mov	ds:dword_406360, 0C0000409h
		mov	ds:dword_406364, 1
		mov	ds:dword_406138, eax
		mov	ds:dword_40636C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_40612C, eax
		mov	eax, dword_404018
		mov	[ebp-10h], eax
		mov	eax, dword_40401C
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_4057C4
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4034B0	proc near		; CODE XREF: sub_403650+79p
					; sub_403650:loc_4036E2p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_4063DC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_403505
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_4034E0:				; CODE XREF: sub_4034B0+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_4034FE
		test	esi, esi
		jz	short loc_4034FE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_4034FE:				; CODE XREF: sub_4034B0+40j
					; sub_4034B0+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_4034E0

loc_403505:				; CODE XREF: sub_4034B0+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4034B0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_4063C0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_403544

loc_403536:				; CODE XREF: .text:004035ACj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_403544:				; CODE XREF: .text:00403534j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_4035A7
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_4063DC
		mov	ds:dword_4063DC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_4035A7:				; CODE XREF: .text:0040355Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_403536
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_4063C0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_4035C8
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4035C8:				; CODE XREF: .text:004035BFj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_4063DC
		sub	esp, 4
		test	edx, edx
		jz	short loc_4035FF
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_4035F8
		jmp	short loc_403636
; ---------------------------------------------------------------------------
		align 10h

loc_4035F0:				; CODE XREF: .text:004035FDj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_403616
		mov	edx, eax

loc_4035F8:				; CODE XREF: .text:004035E6j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_4035F0

loc_4035FF:				; CODE XREF: .text:004035E0j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_40360F:				; CODE XREF: .text:00403634j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403616:				; CODE XREF: .text:004035F4j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_40361C:				; CODE XREF: .text:00403640j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_40360F
; ---------------------------------------------------------------------------

loc_403636:				; CODE XREF: .text:004035E8j
		mov	eax, [edx+8]
		mov	ds:dword_4063DC, eax
		mov	eax, edx
		jmp	short loc_40361C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403650	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_4036A0
		jb	short loc_403670
		cmp	eax, 3
		jz	short loc_4036C0

loc_403663:				; CODE XREF: sub_403650+31j
					; sub_403650+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403670:				; CODE XREF: sub_403650+Cj
		mov	eax, ds:dword_4063C0
		test	eax, eax
		jnz	short loc_4036E2

loc_403679:				; CODE XREF: sub_403650+97j
		mov	eax, ds:dword_4063C0
		cmp	eax, 1
		jnz	short loc_403663
		mov	ds:dword_4063C0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_403663
; ---------------------------------------------------------------------------
		align 10h

loc_4036A0:				; CODE XREF: sub_403650+Aj
		mov	eax, ds:dword_4063C0
		test	eax, eax
		jz	short loc_4036D0

loc_4036A9:				; CODE XREF: sub_403650+90j
		mov	ds:dword_4063C0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4036C0:				; CODE XREF: sub_403650+11j
		mov	eax, ds:dword_4063C0
		test	eax, eax
		jz	short loc_403663
		call	sub_4034B0
		jmp	short loc_403663
; ---------------------------------------------------------------------------

loc_4036D0:				; CODE XREF: sub_403650+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_4036A9
; ---------------------------------------------------------------------------

loc_4036E2:				; CODE XREF: sub_403650+27j
		call	sub_4034B0
		jmp	short loc_403679
sub_403650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4036F0	proc near		; CODE XREF: sub_401180+19p
					; sub_401910+Ap ...

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_403712

loc_4036FD:				; CODE XREF: sub_4036F0+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_4036FD

loc_403712:				; CODE XREF: sub_4036F0+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_4036F0	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _setmode]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_403750
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403750	proc near		; CODE XREF: sub_401180+A7p
					; .text:00403741j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_403750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_403770(char *, size_t, char *, char)
sub_403770	proc near		; CODE XREF: sub_401910+492p

DstBuf		= dword	ptr -1Ch
MaxCount	= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 1Ch
		lea	eax, [esp+1Ch+arg_C]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+Format], eax ;	Format
		mov	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+MaxCount], eax	; MaxCount
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+DstBuf], eax ;	DstBuf
		call	_vsnprintf
		add	esp, 1Ch
		retn
sub_403770	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fgets]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION feof]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _vsnprintf]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_4038A0	proc near		; CODE XREF: sub_4038E0:loc_403B0Ap

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h

		sub	esp, 1Ch
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 28h ; Count
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aUsageSha1sumC0 ;	"usage:	sha1sum	[-c|-0]	[--] FILENAMES|-"...
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	[esp+1Ch+Str], 1 ; Code
		call	exit
sub_4038A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4038E0	proc near		; CODE XREF: sub_401180+265p

Str1		= dword	ptr -2Ch
Str2		= dword	ptr -28h
Count		= dword	ptr -24h
File		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 20h
		mov	ebx, [ebp+arg_0]
		mov	esi, [ebp+arg_4]
		call	sub_403330
		mov	ds:dword_406020, 0
		test	ebx, ebx
		jz	loc_403A67
		sub	ebx, 1
		lea	edi, [esi+4]
		mov	[esp+2Ch+var_10], ebx
		jz	loc_403A65
		mov	ebx, [esi+4]
		mov	[esp+2Ch+Str2],	(offset	off_405238+6Ch)	; Str2
		mov	[esp+2Ch+Str1],	ebx ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_403B0F
		cmp	byte ptr [ebx],	2Dh
		jnz	loc_403A71
		cmp	byte ptr [ebx+1], 0
		jz	loc_403A71
		mov	[esp+2Ch+var_18], 0
		mov	edx, edi
		mov	[esp+2Ch+var_14], 0
		jmp	short loc_403993
; ---------------------------------------------------------------------------
		align 10h

loc_403960:				; CODE XREF: sub_4038E0+C1j
		mov	edi, (offset off_405238+174h)
		mov	esi, ebx
		mov	ecx, 3
		repe cmpsb
		jnz	loc_403ADC
		add	edx, 4
		sub	[esp+2Ch+var_10], 1
		mov	[esp+2Ch+var_18], 1
		jz	short loc_4039B5

loc_403986:				; CODE XREF: sub_4038E0+D3j
		mov	ebx, [edx]
		cmp	byte ptr [ebx],	2Dh
		jnz	short loc_4039B5
		cmp	byte ptr [ebx+1], 0
		jz	short loc_4039B5

loc_403993:				; CODE XREF: sub_4038E0+79j
		mov	esi, ebx
		mov	edi, (offset off_405238+171h)
		mov	ecx, 3
		repe cmpsb
		jnz	short loc_403960
		add	edx, 4
		sub	[esp+2Ch+var_10], 1
		mov	[esp+2Ch+var_14], 1
		jnz	short loc_403986

loc_4039B5:				; CODE XREF: sub_4038E0+A4j
					; sub_4038E0+ABj ...
		mov	edi, edx

loc_4039B7:				; CODE XREF: sub_4038E0+21Aj
		mov	eax, [esp+2Ch+var_14]
		test	eax, eax
		jnz	loc_403AFF

loc_4039C3:				; CODE XREF: sub_4038E0+1A1j
					; sub_4038E0+224j
		mov	eax, [esp+2Ch+var_10]
		test	eax, eax
		jz	loc_403B0A
		mov	eax, [esp+2Ch+var_18]
		xor	ebx, ebx
		mov	esi, 1
		test	eax, eax
		jz	short loc_403A4D
		cmp	[esp+2Ch+var_10], 1
		jnz	loc_403B0A
		mov	[esp+2Ch+Str2],	(offset	off_405238+17Ah) ; Str2
		mov	eax, [edi]
		mov	[esp+2Ch+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_403B0A
		call	sub_401FE0
		xor	ebx, ebx
		test	eax, eax
		setnz	bl

loc_403A0F:				; CODE XREF: sub_4038E0+16Bj
		mov	eax, [esp+2Ch+var_14]
		test	eax, eax
		jz	short loc_403A2D
		mov	eax, ds:dword_406024
		test	eax, eax
		jnz	loc_403AB1

loc_403A24:				; CODE XREF: sub_4038E0+1F7j
		mov	eax, ds:dword_40602C
		test	eax, eax
		jnz	short loc_403A86

loc_403A2D:				; CODE XREF: sub_4038E0+135j
					; sub_4038E0+1CCj
		lea	esp, [ebp-0Ch]
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_403A37:				; CODE XREF: sub_4038E0+173j
		mov	eax, [edi]
		call	sub_402120
		test	eax, eax
		cmovnz	ebx, esi

loc_403A43:				; CODE XREF: sub_4038E0+183j
		add	edi, 4
		sub	[esp+2Ch+var_10], 1
		jz	short loc_403A0F

loc_403A4D:				; CODE XREF: sub_4038E0+FCj
		mov	eax, [esp+2Ch+var_14]
		test	eax, eax
		jnz	short loc_403A37
		mov	eax, [edi]
		xor	edx, edx
		call	sub_401910
		test	eax, eax
		cmovnz	ebx, esi
		jmp	short loc_403A43
; ---------------------------------------------------------------------------

loc_403A65:				; CODE XREF: sub_4038E0+33j
		mov	esi, edi

loc_403A67:				; CODE XREF: sub_4038E0+23j
		mov	edi, esi
		mov	[esp+2Ch+var_10], 0

loc_403A71:				; CODE XREF: sub_4038E0+57j
					; sub_4038E0+61j
		mov	[esp+2Ch+var_18], 0
		mov	[esp+2Ch+var_14], 0
		jmp	loc_4039C3
; ---------------------------------------------------------------------------

loc_403A86:				; CODE XREF: sub_4038E0+14Bj
		mov	[esp+2Ch+Count], eax
		mov	eax, ds:_iob
		mov	edx, ds:dword_406030
		mov	[esp+2Ch+Str2],	(offset	off_405238+1BCh) ; Format
		add	eax, 40h
		mov	[esp+2Ch+File],	edx
		mov	[esp+2Ch+Str1],	eax ; File
		call	fprintf
		jmp	loc_403A2D
; ---------------------------------------------------------------------------

loc_403AB1:				; CODE XREF: sub_4038E0+13Ej
		mov	[esp+2Ch+Count], eax
		mov	eax, ds:_iob
		mov	edx, ds:dword_406028
		mov	[esp+2Ch+Str2],	(offset	off_405238+17Ch) ; Format
		add	eax, 40h
		mov	[esp+2Ch+File],	edx
		mov	[esp+2Ch+Str1],	eax ; File
		call	fprintf
		jmp	loc_403A24
; ---------------------------------------------------------------------------

loc_403ADC:				; CODE XREF: sub_4038E0+8Ej
		mov	[esp+2Ch+Str2],	(offset	off_405238+177h) ; Str2
		mov	edi, edx
		mov	[esp+2Ch+Str1],	ebx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_403B0A
		sub	[esp+2Ch+var_10], 1
		add	edi, 4
		jmp	loc_4039B7
; ---------------------------------------------------------------------------

loc_403AFF:				; CODE XREF: sub_4038E0+DDj
		cmp	[esp+2Ch+var_18], 0
		jz	loc_4039C3

loc_403B0A:				; CODE XREF: sub_4038E0+E9j
					; sub_4038E0+103j ...
		call	sub_4038A0
; ---------------------------------------------------------------------------

loc_403B0F:				; CODE XREF: sub_4038E0+4Ej
		mov	eax, ds:_iob
		mov	[esp+2Ch+Count], 0F8h ;	Count
		mov	[esp+2Ch+Str2],	1 ; Size
		mov	[esp+2Ch+Str1],	(offset	off_405238+78h)	; Str
		add	eax, 20h
		mov	[esp+2Ch+File],	eax ; File
		call	fwrite
		mov	[esp+2Ch+Str1],	0 ; Code
		call	exit
sub_4038E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403B50	proc near		; DATA XREF: .text:00403B74o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_402710
		leave
		retn
sub_403B50	endp

; ---------------------------------------------------------------------------
		align 10h
dword_403B70	dd 0FFFFFFFFh		; DATA XREF: sub_403330-4Cr
					; sub_403330:loc_4032F3r ...
		dd offset sub_403B50
		dd 0
		dd 0FFFFFFFFh
dword_403B80	dd 20h dup(0)		; DATA XREF: .data:off_40400Co
		dd 100h	dup(?)
_text		ends

; Section 2. (virtual address 00004000)
; Virtual size			: 00000024 (	 36.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00003000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 404000h
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_40400C	dd offset dword_403B80	; DATA XREF: sub_4032B0+3r
					; sub_4032B0+12r ...
dword_404010	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_404014	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_404018	dd 0BB40E64Eh		; DATA XREF: sub_403350+3r
					; sub_403350:loc_403402w ...
dword_40401C	dd 44BF19B1h		; DATA XREF: sub_403350+31w
					; sub_403350+B8w ...
dword_404020	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00005000)
; Virtual size			: 000007CC (   1996.)
; Section size in file		: 00000800 (   2048.)
; Offset to raw	data for section: 00003200
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 405000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 20h
aUsageSha1sumC0	db 'usage: sha1sum [-c|-0] [--] FILENAMES|-',0Ah,0
					; DATA XREF: sub_4038A0+18o
asc_405089	db '\',0                ; DATA XREF: sub_401910+59Bo
byte_40508B	db 0			; DATA XREF: sub_401910+596o
; char Mode[3]
Mode		db 'rb',0               ; DATA XREF: sub_401910:loc_40193Do
		align 10h
; char aSha256sumCanTO[]
aSha256sumCanTO	db 'sha256sum: can',27h,'t open `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_401910+662o
					; sub_402120+2EFo
; char aSFailedOpen[]
aSFailedOpen	db '%s: FAILED open',0Ah,0 ; DATA XREF: sub_401910+68Ao
		align 4
; char aSha256sumError[]
aSha256sumError	db 'sha256sum: error reading `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_401910+5D8o
					; sub_402120+163o
; char aSFailedRead[]
aSFailedRead	db '%s: FAILED read',0Ah,0 ; DATA XREF: sub_401910+614o
; char aSha256sumCanTA[]
aSha256sumCanTA	db 'sha256sum: can',27h,'t allocate buffer: %s',0Ah,0
					; DATA XREF: sub_401910+6A8o
; char a02x[]
a02x		db '%02x',0             ; DATA XREF: sub_401910+475o
; char aSFailed[]
aSFailed	db '%s: FAILED',0Ah,0   ; DATA XREF: sub_401910:loc_401F41o
; char Format[]
Format		db '%s: OK',0Ah,0       ; DATA XREF: sub_401910+4C8o
; char aSSS[]
aSSS		db '%s%s  %s',0Ah,0     ; DATA XREF: sub_401910+5AFo
aStdin		db '[stdin]',0          ; DATA XREF: sub_401FE0+CCo
					; sub_401FE0+109o
		align 4
; char aSha256sumErr_1[]
aSha256sumErr_1	db 'sha256sum:error reading `%s',27h,' at offset %lu: %s',0Ah,0
					; DATA XREF: sub_401FE0+111o
; char aSha256sumErr_0[]
aSha256sumErr_0	db 'sha256sum: error reading `%s',27h,': filename at offset %lu too long'
					; DATA XREF: sub_401FE0+D4o
		db 0Ah,0
aLastLinefeedMi	db 'last linefeed missing',0 ; DATA XREF: sub_402120+15Eo
aLineTooLong	db 'line too long',0    ; DATA XREF: sub_402120+16Do
; char aR[]
aR		db 'r',0                ; DATA XREF: sub_402120+29o
aInvalidLine	db 'invalid line',0     ; DATA XREF: sub_402120+C0o
		align 10h
; char aSha256sumErr_2[]
aSha256sumErr_2	db 'sha256sum: error parsing `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_402120+C8o
		align 4
; char aSha256sumErr_3[]
aSha256sumErr_3	db 'sha256sum:error reading `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_402120+258o
		align 4
off_405238	dd offset loc_4023F4, offset loc_40234C, offset	loc_40234C
					; DATA XREF: sub_402120+296r
		dd offset loc_40234C, offset loc_40234C, offset	loc_40234C ; jump table	for switch statement
		dd offset loc_4023E9, offset loc_40234C, offset	loc_40234C
		dd offset loc_40234C, offset loc_4023DE, offset	loc_40234C
		dd offset loc_40234C, offset loc_40234C, offset	loc_40234C
		dd offset loc_40234C, offset loc_40234C, offset	loc_40234C
		dd offset loc_4023D3, offset loc_40234C, offset	loc_40234C
		dd offset loc_40234C, offset loc_4023C8, offset	loc_40234C
		dd offset loc_40234C, offset loc_40234C, offset	loc_4023BD
		dd 65762D2Dh, 6F697372h, 6Eh, 32616873h, 75733635h, 2E31206Dh
		dd 6F430A32h, 69727970h, 20746867h, 20294328h, 39303032h
		dd 30316720h, 646F4320h, 6D472065h, 4C0A4862h, 6E656369h
		dd 47206573h, 33764C50h, 47203A2Bh, 4720554Eh, 76204C50h
		dd 69737265h, 33206E6Fh, 20726F20h, 6574616Ch, 683C2072h
		dd 3A707474h, 6E672F2Fh, 726F2E75h, 696C2F67h, 736E6563h
		dd 672F7365h, 682E6C70h, 3E6C6D74h, 68540A2Eh, 69207369h
		dd 72662073h, 73206565h, 7774666Fh, 3A657261h, 756F7920h
		dd 65726120h, 65726620h, 6F742065h, 61686320h, 2065676Eh
		dd 20646E61h, 69646572h, 69727473h, 65747562h, 2E746920h
		dd 6568540Ah, 69206572h, 4F4E2073h, 52415720h, 544E4152h
		dd 74202C59h, 6874206Fh, 78652065h, 746E6574h, 72657020h
		dd 7474696Dh, 62206465h, 616C2079h, 0A0A2E77h, 632D00h
		dd 2D00302Dh, 2D002Dh, 32616873h, 75733635h, 57203A6Dh
		dd 494E5241h, 203A474Eh, 6F207525h, 75252066h, 73696C20h
		dd 20646574h, 656C6966h, 6F632073h, 20646C75h, 20746F6Eh
		dd 72206562h, 0A646165h, 0, 32616873h, 75733635h, 57203A6Dh
		dd 494E5241h, 203A474Eh, 6F207525h, 75252066h, 6D6F6320h
		dd 65747570h, 68632064h, 736B6365h, 20736D75h, 20646964h
		dd 20544F4Eh, 6374616Dh, 0A68h,	0, 0, 0, 428A2F98h, 71374491h
		dd 0B5C0FBCFh, 0E9B5DBA5h, 3956C25Bh, 59F111F1h, 923F82A4h
		dd 0AB1C5ED5h, 0D807AA98h, 12835B01h, 243185BEh, 550C7DC3h
		dd 72BE5D74h, 80DEB1FEh, 9BDC06A7h, 0C19BF174h,	0E49B69C1h
		dd 0EFBE4786h, 0FC19DC6h, 240CA1CCh, 2DE92C6Fh,	4A7484AAh
		dd 5CB0A9DCh, 76F988DAh, 983E5152h, 0A831C66Dh,	0B00327C8h
		dd 0BF597FC7h, 0C6E00BF3h, 0D5A79147h, 6CA6351h, 14292967h
		dd 27B70A85h, 2E1B2138h, 4D2C6DFCh, 53380D13h, 650A7354h
		dd 766A0ABBh, 81C2C92Eh, 92722C85h, 0A2BFE8A1h,	0A81A664Bh
		dd 0C24B8B70h, 0C76C51A3h, 0D192E819h, 0D6990624h, 0F40E3585h
		dd 106AA070h, 19A4C116h, 1E376C08h, 2748774Ch, 34B0BCB5h
		dd 391C0CB3h, 4ED8AA4Ah, 5B9CCA4Fh, 682E6FF3h, 748F82EEh
		dd 78A5636Fh, 84C87814h, 8CC70208h, 90BEFFFAh, 0A4506CEBh
		dd 0BEF9A3F7h, 0C67178F2h, 676E696Dh, 30316D77h, 6C6C642Eh
		dd 6D5F5F00h, 77676E69h, 5F726874h, 6F6D6572h, 6B5F6576h
		dd 645F7965h, 726F74h, 696D5F5Fh, 7477676Eh, 6B5F7268h
		dd 645F7965h, 726F74h, offset TlsCallback_0, 6E6B6E55h
		dd 206E776Fh, 6F727265h, 72h, 74616D5Fh, 72726568h, 203A2928h
		dd 69207325h, 7325206Eh, 2C672528h, 29672520h, 72282020h
		dd 61767465h, 67253D6Ch, 0A29h,	75677241h, 746E656Dh, 6D6F6420h
		dd 206E6961h, 6F727265h, 44282072h, 49414D4Fh, 4100294Eh
		dd 6D756772h, 20746E65h, 676E6973h, 72616C75h, 20797469h
		dd 47495328h, 294Eh, 7265764Fh,	776F6C66h, 6E617220h, 65206567h
		dd 726F7272h, 564F2820h, 4C465245h, 29574Fh, 20656854h
		dd 75736572h, 6920746Ch, 6F742073h, 6D73206Fh, 206C6C61h
		dd 62206F74h, 65722065h
aPresentedUnder	db 'presented (UNDERFLOW)',0
		align 10h
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:004056ACo
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:004056B0o
		align 4
dword_40569C	dd 4055BCh		; DATA XREF: sub_402920+16r
		dd offset off_405238+3A3h
		dd offset off_405238+3C0h
		dd offset off_405238+3E0h
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_402990+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_4029F0+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_4029F0+1F9o
					; sub_4029F0+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_4029F0+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_402C30+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_402C30+1B7o
		align 4
; const	WCHAR LibFileName
LibFileName:				; DATA XREF: sub_4031E0:loc_403280o
		unicode	0, <msvcrt.dll>,0
		align 4
off_4057C4	dd offset dword_406360	; DATA XREF: .text:00403478o
		dd offset dword_406080
dword_4057CC	dd 0			; DATA XREF: sub_402C30+59o
					; sub_402C30+5Eo ...
dword_4057D0	dd 0			; DATA XREF: sub_402C30+7Fr
dword_4057D4	dd 0			; DATA XREF: sub_402C30:loc_402D7Cr
dword_4057D8	dd 0Ah dup(0)		; DATA XREF: sub_402C30+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00006000)
; Virtual size			: 0000041C (   1052.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 406000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_406000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_406004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_406008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_40600C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_406010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_406014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_406018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_40601C	dd ?			; DATA XREF: sub_401010+3Aw
dword_406020	dd ?			; DATA XREF: sub_401550+59r
					; sub_4038E0+17w
dword_406024	dd ?			; DATA XREF: sub_401910:loc_401F30w
					; sub_4038E0+137r
dword_406028	dd ?			; DATA XREF: sub_401910+18w
					; sub_4038E0+1DAr
dword_40602C	dd ?			; DATA XREF: sub_401910+642w
					; sub_4038E0:loc_403A24r
dword_406030	dd ?			; DATA XREF: sub_401910:loc_401D75w
					; sub_4038E0+1AFr
dword_406034	dd ?			; DATA XREF: sub_401010+3r
dword_406038	dd ?			; DATA XREF: sub_401010+25r
dword_40603C	dd ?			; DATA XREF: sub_401060+22w
dword_406040	dd ?			; DATA XREF: sub_401060+18w
dword_406044	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_406050	dd ?			; DATA XREF: sub_401060+2Cw
dword_406054	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_406058	dd ?			; DATA XREF: sub_401060+5Er
dword_40605C	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_40279Cr
dword_406060	dd ?			; DATA XREF: .text:004028C3r
					; sub_402910+4w
dword_406064	dd ?			; DATA XREF: sub_402C30+9r
					; sub_402C30:loc_402C50w
dword_406068	dd ?			; DATA XREF: sub_4029F0+1Dr
					; sub_4029F0+58r ...
dword_40606C	dd ?			; DATA XREF: sub_4029F0+Br
					; sub_4029F0:loc_402AAFw ...
dword_406070	dd ?			; DATA XREF: sub_4031E0+4r
					; sub_4031E0+92w ...
dword_406074	dd ?			; DATA XREF: sub_403330r
					; sub_403330:loc_403340w
		align 10h
dword_406080	dd 2Bh dup(?)		; DATA XREF: .rdata:004057C8o
dword_40612C	dd ?			; DATA XREF: .text:0040345Aw
		dd 2 dup(?)
dword_406138	dd ?			; DATA XREF: .text:00403446w
		dd 2 dup(?)
dword_406144	dd ?			; DATA XREF: .text:0040342Cw
		dd 86h dup(?)
dword_406360	dd ?			; DATA XREF: .text:00403432w
					; .rdata:off_4057C4o
dword_406364	dd ?			; DATA XREF: .text:0040343Cw
		dd ?
dword_40636C	dd ?			; DATA XREF: .text:0040344Bw
		dd 14h dup(?)
dword_4063C0	dd ?			; DATA XREF: .text:00403523r
					; .text:004035B4r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_4034B0+7o
					; sub_4034B0:loc_403505o ...
dword_4063DC	dd ?			; DATA XREF: sub_4034B0+14r
					; .text:00403578r ...
		dd ?
dword_4063E4	dd ?			; DATA XREF: sub_401180+1A8w
dword_4063E8	dd ?			; DATA XREF: sub_401180+1BFw
dword_4063EC	dd ?			; DATA XREF: sub_401180+1B2w
dword_4063F0	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_402583w ...
dword_4063F4	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_4063F8	dd ?			; DATA XREF: TlsCallback_0:loc_4024D4w
dword_4063FC	dd ?			; DATA XREF: sub_401060+64w
					; sub_402650+3Fr ...
dword_406400	dd ?			; DATA XREF: sub_401060+69w
					; sub_402650+4r ...
dword_406404	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_406408	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 1000h
_bss		ends

;
; Imports from KERNEL32.dll
;
; Section 5. (virtual address 00007000)
; Virtual size			: 00000754 (   1876.)
; Section size in file		: 00000800 (   2048.)
; Offset to raw	data for section: 00003A00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_403650+44p
					; DATA XREF: sub_403650+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_4034B0+Ep
					; .text:00403572p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:00403488p
					; DATA XREF: .text:00403488r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_403350+6Cp
					; DATA XREF: sub_403350+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_403350+74p
					; DATA XREF: sub_403350+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_4029F0+1CCp
					; sub_4034B0+3Cp
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_4031E0+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_403350+57p
					; DATA XREF: sub_403350+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_403350+7Cp
					; DATA XREF: sub_403350+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_403650+87p
					; DATA XREF: sub_403650+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_4034B0+5Cp
					; .text:00403590p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: TlsCallback_0+55p
					; DATA XREF: TlsCallback_0+55r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_4031E0+A7p
					; DATA XREF: sub_4031E0+A7r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_403350+8Bp
					; DATA XREF: sub_403350+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0040346Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00403499p
					; DATA XREF: .text:00403499r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_4034B0+35p
					; DATA XREF: sub_4034B0+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0040347Fp
					; DATA XREF: .text:0040347Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_4029F0+142p
					; sub_4029F0+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_4029F0+A1p
					; sub_4029F0+D9p ...

;
; Imports from msvcrt.dll
;
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__setmode:dword ; DATA XREF:	_setmoder

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_402620r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_401910:loc_401ED4p
					; sub_401910:loc_401F5Ep ...
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
; FILE *iob
		extrn _iob:dword	; DATA XREF: sub_401910+39Dr
					; sub_401910+56Er ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_402650+A3p
					; DATA XREF: sub_402650+A3r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
; int __cdecl _vsnprintf(char *DstBuf, size_t MaxCount,	const char *Format, va_list ArgList)
		extrn __imp__vsnprintf:dword ; DATA XREF: _vsnprintfr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl feof(FILE	*File)
		extrn __imp_feof:dword	; DATA XREF: feofr
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; char *__cdecl	fgets(char *Buf, int MaxCount, FILE *File)
		extrn __imp_fgets:dword	; DATA XREF: fgetsr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr


; Section 6. (virtual address 00008000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00004200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 408000h
dword_408000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_408008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_40800C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_402620
dword_408018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
					; jumptable 004023B6 case 209
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_408030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_4025C3o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00009000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00004400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 409000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
