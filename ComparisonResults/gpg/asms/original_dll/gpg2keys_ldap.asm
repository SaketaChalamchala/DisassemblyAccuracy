;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	C9FE48E6FC43968BD8DA25B88CE9815D
; Input	CRC32 :	BCB61663

; File Name   :	C:\compspace\compare\gpg\dlls\original\gpg2keys_ldap.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 0000DFF4 (  57332.)
; Section size in file		: 0000E000 (  57344.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00415004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_413404
		mov	[esp+2Ch+var_1C], offset dword_413018
		mov	[esp+2Ch+var_24], offset dword_41300C
		mov	[esp+2Ch+var_28], offset dword_413008
		mov	ds:dword_413018, eax
		mov	eax, ds:dword_413408
		mov	[esp+2Ch+var_2C], offset dword_413004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_41301C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00415010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_413414, 1
		mov	ds:dword_413410, 1
		mov	ds:dword_41340C, 1
		mov	ds:dword_413420, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_413014, eax
		mov	eax, ds:dword_413424
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_40CEE0
		mov	edx, ds:dword_413428
		mov	ds:dword_4137DC, eax
		mov	ds:dword_4137E0, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_40D220
		cmp	dword_40F020, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_40D1C0
		call	sub_40D1B0
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_40DF90
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_413424
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_4137E4
		call	sub_40E010
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_4137E8
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_4137E8
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_413000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_4137E8
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_4137E4

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_411D7C
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_40D4D0
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_41342C, eax
		call	sub_40DA80
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_40DB40
		mov	eax, ds:dword_413424
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_4137C4, eax
		mov	eax, 0Ah
		mov	ds:dword_4137CC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_4137C8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_413004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_413008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_413008, eax
		call	sub_40DBD0
		mov	eax, ds:__initenv
		mov	edx, ds:dword_41300C
		mov	[eax], edx
		mov	eax, ds:dword_41300C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_413008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_413004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_4053E3
		mov	esi, ds:dword_413014
		test	esi, esi
		mov	ds:dword_413010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_413000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_413010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_4137E8
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_4137E8
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_415008
		mov	[esp+88h+dwMilliseconds], offset dword_415000
		call	_initterm
		mov	ds:dword_4137E8, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_4137E8, 1
		mov	[esp+88h+lpProcName], offset dword_415018
		mov	[esp+88h+dwMilliseconds], offset dword_41500C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_413424, 1
		call	sub_40DBF0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_413424, 0
		call	sub_40DBF0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_40EFC0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_40F048
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_40F048
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_40EFC0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015C8	proc near		; CODE XREF: sub_4015FC+2Cp
					; sub_40230E+7C8p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		cmp	eax, 44h
		jz	short loc_4015DD
		cmp	eax, 51h
		jz	short loc_4015E6
		jmp	short loc_4015EF
; ---------------------------------------------------------------------------

loc_4015DD:				; CODE XREF: sub_4015C8+Cj
		mov	[ebp+var_4], 7
		jmp	short loc_4015F7
; ---------------------------------------------------------------------------

loc_4015E6:				; CODE XREF: sub_4015C8+11j
		mov	[ebp+var_4], 9
		jmp	short loc_4015F7
; ---------------------------------------------------------------------------

loc_4015EF:				; CODE XREF: sub_4015C8+13j
		mov	[ebp+var_4], 4
		nop

loc_4015F7:				; CODE XREF: sub_4015C8+1Cj
					; sub_4015C8+25j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4015C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4015FC(LDAP *)
sub_4015FC	proc near		; CODE XREF: sub_4033A7+519p
					; sub_403A3F+4EEp

ld		= dword	ptr -28h
option		= dword	ptr -24h
outvalue	= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_C]
		mov	[esp+28h+outvalue], eax	; outvalue
		mov	[esp+28h+option], 31h ;	option
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+ld], eax ; ld
		mov	eax, ds:ldap_get_option
		call	eax ; ldap_get_option
		test	eax, eax
		jnz	short loc_40162F
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ld], eax
		call	sub_4015C8
		jmp	short locret_401634
; ---------------------------------------------------------------------------

loc_40162F:				; CODE XREF: sub_4015FC+24j
		mov	eax, 4

locret_401634:				; CODE XREF: sub_4015FC+31j
		leave
		retn
sub_4015FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401636(char *, int)
sub_401636	proc near		; CODE XREF: sub_4033A7+482p
					; sub_404077+672p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_40166F
; ---------------------------------------------------------------------------

loc_401644:				; CODE XREF: sub_401636+3Dj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_401663
		mov	eax, 1
		jmp	short locret_40167A
; ---------------------------------------------------------------------------

loc_401663:				; CODE XREF: sub_401636+24j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+408h]
		mov	[ebp+var_C], eax

loc_40166F:				; CODE XREF: sub_401636+Cj
		cmp	[ebp+var_C], 0
		jnz	short loc_401644
		mov	eax, 0

locret_40167A:				; CODE XREF: sub_401636+2Bj
		leave
		retn
sub_401636	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40167C(char *Source, int)
sub_40167C	proc near		; CODE XREF: sub_4033A7+49Ep
					; sub_404077+68Ap ...

Size		= dword	ptr -28h
var_24		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
Source		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Size],	40Ch ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_4016C5
		mov	edx, ds:File
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory when deduping ke"...
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 2Eh ; Count
		mov	[esp+28h+var_24], 1 ; Size
		mov	[esp+28h+Size],	eax ; Str
		call	fwrite
		mov	eax, 5
		jmp	short locret_401704
; ---------------------------------------------------------------------------

loc_4016C5:				; CODE XREF: sub_40167C+19j
		mov	eax, [ebp+Dest]
		mov	[esp+28h+Count], 408h ;	Count
		mov	edx, [ebp+Source]
		mov	[esp+28h+var_24], edx ;	Source
		mov	[esp+28h+Size],	eax ; Dest
		call	strncpy
		mov	eax, [ebp+Dest]
		mov	byte ptr [eax+407h], 0
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+Dest]
		mov	[eax+408h], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+Dest]
		mov	[eax], edx
		mov	eax, 0

locret_401704:				; CODE XREF: sub_40167C+47j
		leave
		retn
sub_40167C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401706	proc near		; CODE XREF: sub_4033A7+5EEp
					; sub_404077+6C2p ...

Memory		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_40172B
; ---------------------------------------------------------------------------

loc_40170E:				; CODE XREF: sub_401706+29j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+408h]
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free

loc_40172B:				; CODE XREF: sub_401706+6j
		cmp	[ebp+arg_0], 0
		jnz	short loc_40170E
		leave
		retn
sub_401706	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401733(char *)
sub_401733	proc near		; CODE XREF: sub_402FF3+1D1p
					; sub_402FF3+269p ...

Src		= dword	ptr -58h
Format		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= byte ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		lea	eax, [ebp+var_30]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 9
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, offset Format ; "%4d%2d%2d%2d%2d%2d"
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_3C], edx
		lea	edx, [ebp+var_30]
		add	edx, 4
		mov	[esp+58h+var_40], edx
		lea	edx, [ebp+var_30]
		add	edx, 8
		mov	[esp+58h+var_44], edx
		lea	edx, [ebp+var_30]
		add	edx, 0Ch
		mov	[esp+58h+var_48], edx
		lea	edx, [ebp+var_30]
		add	edx, 10h
		mov	[esp+58h+var_4C], edx
		lea	edx, [ebp+var_30]
		add	edx, 14h
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Src], eax ; Src
		call	sscanf
		mov	eax, [ebp+var_1C]
		sub	eax, 76Ch
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+var_20]
		sub	eax, 1
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_30]
		mov	[esp+58h+Src], eax
		call	sub_407D16
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_401733	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4017D0	proc near		; CODE XREF: sub_401C06+28Ap
					; sub_401C06+2FAp

Dest		= dword	ptr -68h
Format		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
Src		= byte ptr -2Ch
var_1C		= dword	ptr -1Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		lea	eax, [ebp+arg_0]
		mov	[esp+68h+Dest],	eax
		call	sub_40EB20
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		lea	edx, [eax+76Ch]
		mov	eax, [ebp+var_1C]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_1C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+10h]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+14h]
		mov	[ebp+var_40], offset a04d02d02d02d02 ; "%04d%02d%02d%02d%02d%02dZ"
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+var_4C], eax
		mov	[esp+68h+var_50], edi
		mov	[esp+68h+var_54], esi
		mov	[esp+68h+var_58], ebx
		mov	[esp+68h+var_5C], ecx
		mov	[esp+68h+var_60], edx
		mov	eax, [ebp+var_40]
		mov	[esp+68h+Format], eax ;	Format
		lea	eax, [ebp+Src]
		mov	[esp+68h+Dest],	eax ; Dest
		call	sprintf
		lea	eax, [ebp+Src]
		mov	[esp+68h+Dest],	eax ; Src
		call	_strdup
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4017D0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401875	proc near		; CODE XREF: sub_40230E+702p

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		jmp	short loc_40189B
; ---------------------------------------------------------------------------

loc_401893:				; CODE XREF: sub_401875+2Dj
		add	[ebp+var_10], 1
		add	[ebp+var_18], 4

loc_40189B:				; CODE XREF: sub_401875+1Cj
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_401893
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		jmp	short loc_4018B4
; ---------------------------------------------------------------------------

loc_4018AC:				; CODE XREF: sub_401875+46j
		add	[ebp+var_14], 1
		add	[ebp+var_18], 4

loc_4018B4:				; CODE XREF: sub_401875+35j
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4018AC
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	eax, edx
		add	eax, 1
		shl	eax, 2
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+NewSize], edx ; NewSize
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4018EE
		mov	eax, 0
		jmp	short locret_40193F
; ---------------------------------------------------------------------------

loc_4018EE:				; CODE XREF: sub_401875+70j
		mov	[ebp+var_C], 0
		jmp	short loc_401916
; ---------------------------------------------------------------------------

loc_4018F7:				; CODE XREF: sub_401875+A7j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shl	eax, 2
		add	eax, [ebp+var_18]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	edx, [ebp+arg_4]
		mov	edx, [edx]
		mov	[eax], edx
		add	[ebp+var_C], 1

loc_401916:				; CODE XREF: sub_401875+80j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_14]
		jl	short loc_4018F7
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shl	eax, 2
		add	eax, [ebp+var_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	eax, 1

locret_40193F:				; CODE XREF: sub_401875+77j
		leave
		retn
sub_401875	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401941(int, char *, char *Src)
sub_401941	proc near		; CODE XREF: sub_401C06+132p
					; sub_401C06+14Fp ...

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
Src		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	loc_401A6F
; ---------------------------------------------------------------------------

loc_40195C:				; CODE XREF: sub_401941+135j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	loc_401A67
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+Src], 0
		jnz	short loc_40199F
		mov	eax, 1
		jmp	loc_401C00
; ---------------------------------------------------------------------------

loc_40199F:				; CODE XREF: sub_401941+52j
		cmp	[ebp+var_14], 0
		jz	short loc_4019E5
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_4019DC
; ---------------------------------------------------------------------------

loc_4019B2:				; CODE XREF: sub_401941+A2j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	edx, [ebp+Src]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4019D4
		mov	eax, 1
		jmp	loc_401C00
; ---------------------------------------------------------------------------

loc_4019D4:				; CODE XREF: sub_401941+87j
		add	[ebp+var_18], 1
		add	[ebp+var_14], 4

loc_4019DC:				; CODE XREF: sub_401941+6Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4019B2

loc_4019E5:				; CODE XREF: sub_401941+62j
		mov	eax, [ebp+var_18]
		add	eax, 2
		shl	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	eax, [eax+8]
		mov	[esp+38h+Str2],	edx ; NewSize
		mov	[esp+38h+Str1],	eax ; Memory
		call	realloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_401A17
		mov	eax, 0
		jmp	loc_401C00
; ---------------------------------------------------------------------------

loc_401A17:				; CODE XREF: sub_401941+CAj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	edx, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp+var_14]
		mov	eax, [ebp+Src]
		mov	[esp+38h+Str1],	eax ; Src
		call	_strdup
		mov	[ebx], eax
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_401A53
		mov	eax, 0
		jmp	loc_401C00
; ---------------------------------------------------------------------------

loc_401A53:				; CODE XREF: sub_401941+106j
		mov	eax, [ebp+var_18]
		add	eax, 1
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	dword ptr [eax], 0
		jmp	short loc_401A7C
; ---------------------------------------------------------------------------

loc_401A67:				; CODE XREF: sub_401941+36j
		add	[ebp+var_10], 1
		add	[ebp+var_C], 4

loc_401A6F:				; CODE XREF: sub_401941+16j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40195C

loc_401A7C:				; CODE XREF: sub_401941+124j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_401BFB
		mov	eax, [ebp+var_10]
		add	eax, 2
		shl	eax, 2
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+38h+Str2],	edx ; NewSize
		mov	[esp+38h+Str1],	eax ; Memory
		call	realloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_401AB8
		mov	eax, 0
		jmp	loc_401C00
; ---------------------------------------------------------------------------

loc_401AB8:				; CODE XREF: sub_401941+16Bj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp+var_1C]
		mov	[esp+38h+Str1],	0Ch ; Size
		call	malloc
		mov	[ebx], eax
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_401AF2
		mov	eax, 0
		jmp	loc_401C00
; ---------------------------------------------------------------------------

loc_401AF2:				; CODE XREF: sub_401941+1A5j
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	dword ptr [eax], 2
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		cmp	[ebp+Src], 0
		jz	loc_401BD7
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	ebx, [eax]
		mov	[esp+38h+Str1],	8 ; Size
		call	malloc
		mov	[ebx+8], eax
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_401B63
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	dword ptr [eax], 0
		mov	eax, 0
		jmp	loc_401C00
; ---------------------------------------------------------------------------

loc_401B63:				; CODE XREF: sub_401941+207j
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	ebx, [eax+8]
		mov	eax, [ebp+Src]
		mov	[esp+38h+Str1],	eax ; Src
		call	_strdup
		mov	[ebx], eax
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	eax, [eax+8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_401BBE
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	eax, [eax+8]
		mov	[esp+38h+Str1],	eax ; Memory
		call	free
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	dword ptr [eax], 0
		mov	eax, 0
		jmp	short loc_401C00
; ---------------------------------------------------------------------------

loc_401BBE:				; CODE XREF: sub_401941+24Fj
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	eax, [eax+8]
		add	eax, 4
		mov	dword ptr [eax], 0
		jmp	short loc_401BE9
; ---------------------------------------------------------------------------

loc_401BD7:				; CODE XREF: sub_401941+1D7j
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	dword ptr [eax+8], 0

loc_401BE9:				; CODE XREF: sub_401941+294j
		mov	eax, [ebp+var_10]
		add	eax, 1
		shl	eax, 2
		add	eax, [ebp+var_1C]
		mov	dword ptr [eax], 0

loc_401BFB:				; CODE XREF: sub_401941+142j
		mov	eax, 1

loc_401C00:				; CODE XREF: sub_401941+59j
					; sub_401941+8Ej ...
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_401941	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C06	proc near		; CODE XREF: sub_40230E+455p

Str		= dword	ptr -78h
Format		= dword	ptr -74h
Src		= dword	ptr -70h
var_5C		= dword	ptr -5Ch
var_4C		= byte ptr -4Ch
Dest		= byte ptr -46h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
Memory		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 70h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_5C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_401C8C
; ---------------------------------------------------------------------------

loc_401C32:				; CODE XREF: sub_401C06+8Aj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		sub	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_401C7A
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		sub	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_401C7A
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		sub	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_401C7A
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		sub	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_401C92

loc_401C7A:				; CODE XREF: sub_401C06+3Cj
					; sub_401C06+4Ej ...
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		sub	edx, 1
		add	eax, edx
		mov	byte ptr [eax],	0
		sub	[ebp+var_C], 1

loc_401C8C:				; CODE XREF: sub_401C06+2Aj
		cmp	[ebp+var_C], 0
		jg	short loc_401C32

loc_401C92:				; CODE XREF: sub_401C06+72j
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_402297
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Format], eax
		mov	[esp+78h+Str], offset aPub ; "pub"
		call	sub_407934
		test	eax, eax
		jnz	loc_401FF0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_40229A
		mov	eax, [ebp+var_10]
		mov	[ebp+var_5C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 10h
		jnz	loc_40229D
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpcertid ; "pgpCertID"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpkeyid ; "pgpKeyID"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_4022A0
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		cmp	eax, 1
		jz	short loc_401D91
		cmp	eax, 11h
		jz	short loc_401DAE
		jmp	short loc_401DCA
; ---------------------------------------------------------------------------

loc_401D91:				; CODE XREF: sub_401C06+182j
		mov	[esp+78h+Src], offset off_4100C1 ; Src
		mov	[esp+78h+Format], offset aPgpkeytype ; "pgpKeyType"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		jmp	short loc_401DCA
; ---------------------------------------------------------------------------

loc_401DAE:				; CODE XREF: sub_401C06+187j
		mov	[esp+78h+Src], offset aDssDh ; "DSS/DH"
		mov	[esp+78h+Format], offset aPgpkeytype ; "pgpKeyType"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		nop

loc_401DCA:				; CODE XREF: sub_401C06+189j
					; sub_401C06+1A6j
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_4022A3
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		test	eax, eax
		jle	short loc_401E53
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 1869Eh
		jg	short loc_401E53
		cmp	[ebp+var_24], 0
		jle	short loc_401E53
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		mov	edx, offset a05u ; "%05u"
		mov	[esp+78h+Src], eax
		mov	[esp+78h+Format], edx ;	Format
		lea	eax, [ebp+Dest]
		mov	[esp+78h+Str], eax ; Dest
		call	sprintf
		lea	eax, [ebp+Dest]
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpkeysize ; "pgpKeySize"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941

loc_401E53:				; CODE XREF: sub_401C06+1F1j
					; sub_401C06+208j ...
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_4022A6
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		test	eax, eax
		jle	short loc_401EC3
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		mov	[esp+78h+Str], eax
		call	sub_4017D0
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jz	short loc_401EC3
		mov	eax, [ebp+Memory]
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpkeycreateti ; "pgpKeyCreateTime"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		mov	eax, [ebp+Memory]
		mov	[esp+78h+Str], eax ; Memory
		call	free

loc_401EC3:				; CODE XREF: sub_401C06+27Aj
					; sub_401C06+296j
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_4022A9
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		test	eax, eax
		jle	short loc_401F33
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		mov	[esp+78h+Str], eax
		call	sub_4017D0
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_401F33
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpkeyexpireti ; "pgpKeyExpireTime"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Str], eax ; Memory
		call	free

loc_401F33:				; CODE XREF: sub_401C06+2EAj
					; sub_401C06+306j
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_401F8E
		jmp	loc_4022BF
; ---------------------------------------------------------------------------

loc_401F54:				; CODE XREF: sub_401C06+391j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_10], 1
		cmp	eax, 52h
		jz	short loc_401F7C
		cmp	eax, 52h
		jg	short loc_401F72
		cmp	eax, 44h
		jz	short loc_401F85
		jmp	short loc_401F8F
; ---------------------------------------------------------------------------

loc_401F72:				; CODE XREF: sub_401C06+363j
		cmp	eax, 64h
		jz	short loc_401F85
		cmp	eax, 72h
		jnz	short loc_401F8F

loc_401F7C:				; CODE XREF: sub_401C06+35Ej
		mov	[ebp+var_18], 1
		jmp	short loc_401F8F
; ---------------------------------------------------------------------------

loc_401F85:				; CODE XREF: sub_401C06+368j
					; sub_401C06+36Fj
		mov	[ebp+var_14], 1
		jmp	short loc_401F8F
; ---------------------------------------------------------------------------

loc_401F8E:				; CODE XREF: sub_401C06+347j
		nop

loc_401F8F:				; CODE XREF: sub_401C06+36Aj
					; sub_401C06+374j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401F54
		cmp	[ebp+var_14], 0
		jz	short loc_401FA6
		mov	eax, offset a1	; "1"
		jmp	short loc_401FAB
; ---------------------------------------------------------------------------

loc_401FA6:				; CODE XREF: sub_401C06+397j
		mov	eax, offset a0	; "0"

loc_401FAB:				; CODE XREF: sub_401C06+39Ej
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpdisabled ;	"pgpDisabled"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		cmp	[ebp+var_18], 0
		jz	short loc_401FCF
		mov	eax, offset a1	; "1"
		jmp	short loc_401FD4
; ---------------------------------------------------------------------------

loc_401FCF:				; CODE XREF: sub_401C06+3C0j
		mov	eax, offset a0	; "0"

loc_401FD4:				; CODE XREF: sub_401C06+3C7j
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgprevoked ; "pgpRevoked"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		jmp	loc_4022BF
; ---------------------------------------------------------------------------

loc_401FF0:				; CODE XREF: sub_401C06+C1j
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Format], eax
		mov	[esp+78h+Str], offset aSub ; "sub"
		call	sub_407934
		test	eax, eax
		jnz	loc_402127
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	loc_4022AC
		mov	eax, [ebp+var_30]
		mov	[ebp+var_5C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 10h
		jnz	loc_4022AF
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpsubkeyid ;	"pgpSubKeyID"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	loc_4022B2
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	loc_4022B5
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		test	eax, eax
		jle	loc_4022BF
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 1869Eh
		jg	loc_4022BF
		cmp	[ebp+var_34], 0
		jle	loc_4022BF
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		mov	edx, offset a05u ; "%05u"
		mov	[esp+78h+Src], eax
		mov	[esp+78h+Format], edx ;	Format
		lea	eax, [ebp+var_4C]
		mov	[esp+78h+Str], eax ; Dest
		call	sprintf
		lea	eax, [ebp+var_4C]
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpkeysize ; "pgpKeySize"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		jmp	loc_4022BF
; ---------------------------------------------------------------------------

loc_402127:				; CODE XREF: sub_401C06+3FFj
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Format], eax
		mov	[esp+78h+Str], offset aUid ; "uid"
		call	sub_407934
		test	eax, eax
		jnz	loc_402220
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_4022B8
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4022BB
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_38], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4021EE
; ---------------------------------------------------------------------------

loc_40217F:				; CODE XREF: sub_401C06+5F0j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_4021D8
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4021D8
		mov	eax, [ebp+var_1C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4021D8
		mov	eax, [ebp+var_C]
		mov	ebx, eax
		add	ebx, [ebp+var_38]
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+78h+Str], eax
		call	sub_408873
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0FFFFFFFFh
		jz	short loc_4021C7
		mov	eax, [ebp+var_3C]
		jmp	short loc_4021CC
; ---------------------------------------------------------------------------

loc_4021C7:				; CODE XREF: sub_401C06+5BAj
		mov	eax, 3Fh

loc_4021CC:				; CODE XREF: sub_401C06+5BFj
		mov	[ebx], al
		add	[ebp+var_C], 1
		add	[ebp+var_1C], 3
		jmp	short loc_4021EE
; ---------------------------------------------------------------------------

loc_4021D8:				; CODE XREF: sub_401C06+581j
					; sub_401C06+58Ej ...
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_38]
		mov	edx, [ebp+var_1C]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1
		add	[ebp+var_1C], 1

loc_4021EE:				; CODE XREF: sub_401C06+577j
					; sub_401C06+5D0j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40217F
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_38]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_38]
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpuserid ; "pgpUserID"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		jmp	loc_4022BF
; ---------------------------------------------------------------------------

loc_402220:				; CODE XREF: sub_401C06+536j
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Format], eax
		mov	[esp+78h+Str], offset aSig ; "sig"
		call	sub_407934
		test	eax, eax
		jnz	loc_4022BF
		mov	[esp+78h+Format], offset asc_4100A8 ; ":"
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+Str], eax ; int
		call	sub_409332
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_4022BE
		mov	eax, [ebp+var_40]
		mov	[ebp+var_5C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 10h
		jnz	short loc_4022BF
		mov	eax, [ebp+var_40]
		mov	[esp+78h+Src], eax ; Src
		mov	[esp+78h+Format], offset aPgpsignerid ;	"pgpSignerID"
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; int
		call	sub_401941
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_402297:				; CODE XREF: sub_401C06+A6j
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_40229A:				; CODE XREF: sub_401C06+EFj
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_40229D:				; CODE XREF: sub_401C06+117j
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022A0:				; CODE XREF: sub_401C06+16Ej
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022A3:				; CODE XREF: sub_401C06+1DEj
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022A6:				; CODE XREF: sub_401C06+267j
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022A9:				; CODE XREF: sub_401C06+2D7j
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022AC:				; CODE XREF: sub_401C06+41Fj
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022AF:				; CODE XREF: sub_401C06+447j
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022B2:				; CODE XREF: sub_401C06+481j
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022B5:				; CODE XREF: sub_401C06+4A1j
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022B8:				; CODE XREF: sub_401C06+556j
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022BB:				; CODE XREF: sub_401C06+564j
		nop
		jmp	short loc_4022BF
; ---------------------------------------------------------------------------

loc_4022BE:				; CODE XREF: sub_401C06+64Fj
		nop

loc_4022BF:				; CODE XREF: sub_401C06+349j
					; sub_401C06+3E5j ...
		add	esp, 70h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_401C06	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4022C6	proc near		; CODE XREF: sub_40230E+7F6p

Memory		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40230B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		jmp	short loc_4022F2
; ---------------------------------------------------------------------------

loc_4022E1:				; CODE XREF: sub_4022C6+33j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free
		add	[ebp+var_C], 4

loc_4022F2:				; CODE XREF: sub_4022C6+19j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4022E1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free
		jmp	short locret_40230C
; ---------------------------------------------------------------------------

loc_40230B:				; CODE XREF: sub_4022C6+Ej
		nop

locret_40230C:				; CODE XREF: sub_4022C6+43j
		leave
		retn
sub_4022C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40230E	proc near		; CODE XREF: sub_4053E3+1132p

Size		= dword	ptr -478h
NewSize		= dword	ptr -474h
Count		= dword	ptr -470h
File		= dword	ptr -46Ch
var_45C		= dword	ptr -45Ch
attrs		= dword	ptr -454h
mods		= dword	ptr -450h
Str1		= byte ptr -44Bh
var_445		= byte ptr -445h
Src		= byte ptr -434h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
Memory		= dword	ptr -24h
Dest		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
err		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 474h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 1
		mov	[ebp+var_1C], 1
		mov	[ebp+Dest], 0
		mov	[ebp+Memory], 0
		mov	[esp+478h+Size], 4 ; Size
		call	malloc
		mov	[ebp+mods], eax
		mov	eax, [ebp+mods]
		test	eax, eax
		jnz	short loc_402391
		mov	edx, ds:File
		mov	eax, offset aGpgkeysCanTAll ; "gpgkeys:	can't allocate memory for keys"...
		mov	[esp+478h+File], edx ; File
		mov	[esp+478h+Count], 34h ;	Count
		mov	[esp+478h+NewSize], 1 ;	Size
		mov	[esp+478h+Size], eax ; Str
		call	fwrite
		mov	[ebp+var_1C], 5
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_402391:				; CODE XREF: sub_40230E+4Ej
		mov	eax, [ebp+mods]
		mov	dword ptr [eax], 0
		mov	[esp+478h+Size], 4 ; Size
		call	malloc
		mov	[ebp+attrs], eax
		mov	eax, [ebp+attrs]
		test	eax, eax
		jnz	short loc_4023EC
		mov	edx, ds:File
		mov	eax, offset aGpgkeysCanTAll ; "gpgkeys:	can't allocate memory for keys"...
		mov	[esp+478h+File], edx ; File
		mov	[esp+478h+Count], 34h ;	Count
		mov	[esp+478h+NewSize], 1 ;	Size
		mov	[esp+478h+Size], eax ; Str
		call	fwrite
		mov	[ebp+var_1C], 5
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_4023EC:				; CODE XREF: sub_40230E+A9j
		mov	eax, [ebp+attrs]
		mov	dword ptr [eax], 0
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpdisabled	; "pgpDisabled"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpkeyid ; "pgpKeyID"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpkeytype ; "pgpKeyType"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpuserid ;	"pgpUserID"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpkeycreateti ; "pgpKeyCreateTime"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpsignerid	; "pgpSignerID"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgprevoked ; "pgpRevoked"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpsubkeyid	; "pgpSubKeyID"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpkeysize ; "pgpKeySize"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpkeyexpireti ; "pgpKeyExpireTime"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	[esp+478h+Count], 0 ; Src
		mov	[esp+478h+NewSize], offset aPgpcertid ;	"pgpCertID"
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		jmp	short loc_402597
; ---------------------------------------------------------------------------

loc_402544:				; CODE XREF: sub_40230E+2AAj
		mov	edx, offset aInfo16s5s ; "INFO%*[ ]%16s%*[ ]%5s\n"
		lea	eax, [ebp+Src]
		lea	ecx, [ebp+Str1]
		mov	[esp+478h+File], ecx
		lea	ecx, [ebp+var_445]
		mov	[esp+478h+Count], ecx
		mov	[esp+478h+NewSize], edx	; Format
		mov	[esp+478h+Size], eax ; Src
		call	sscanf
		cmp	eax, 2
		jnz	short loc_402597
		mov	[esp+478h+NewSize], offset Str2	; "BEGIN"
		lea	eax, [ebp+Str1]
		mov	[esp+478h+Size], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_402597
		mov	[ebp+var_10], 1
		jmp	short loc_4025BA
; ---------------------------------------------------------------------------

loc_402597:				; CODE XREF: sub_40230E+234j
					; sub_40230E+264j ...
		mov	eax, ds:dword_413028
		mov	[esp+478h+Count], eax ;	File
		mov	[esp+478h+NewSize], 408h ; MaxCount
		lea	eax, [ebp+Src]
		mov	[esp+478h+Size], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	short loc_402544

loc_4025BA:				; CODE XREF: sub_40230E+287j
		cmp	[ebp+var_10], 0
		jnz	short loc_4025D5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 1
		mov	[ebp+var_1C], 0
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_4025D5:				; CODE XREF: sub_40230E+2B0j
		lea	eax, [ebp+var_445]
		mov	[ebp+var_45C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_45C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 10h
		jz	short loc_402617
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 1
		mov	[ebp+var_1C], 8
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_402617:				; CODE XREF: sub_40230E+2F2j
		mov	eax, ds:Source
		mov	[ebp+var_45C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_45C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1Ch
		mov	[esp+478h+Size], eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_402685
		mov	edx, ds:File
		mov	eax, offset aGpgkeysCanTAll ; "gpgkeys:	can't allocate memory for keys"...
		mov	[esp+478h+File], edx ; File
		mov	[esp+478h+Count], 34h ;	Count
		mov	[esp+478h+NewSize], 1 ;	Size
		mov	[esp+478h+Size], eax ; Str
		call	fwrite
		mov	[ebp+var_1C], 5
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_402685:				; CODE XREF: sub_40230E+342j
		mov	edx, ds:Source
		mov	eax, offset aPgpcertidSS ; "pgpCertID=%s,%s"
		mov	[esp+478h+File], edx
		lea	edx, [ebp+var_445]
		mov	[esp+478h+Count], edx
		mov	[esp+478h+NewSize], eax	; Format
		mov	eax, [ebp+Dest]
		mov	[esp+478h+Size], eax ; Dest
		call	sprintf
		mov	[esp+478h+Size], 1 ; Size
		call	malloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_4026F5
		mov	edx, ds:File
		mov	eax, offset aGpgkeysUnableT ; "gpgkeys:	unable to allocate memory for "...
		mov	[esp+478h+File], edx ; File
		mov	[esp+478h+Count], 2Bh ;	Count
		mov	[esp+478h+NewSize], 1 ;	Size
		mov	[esp+478h+Size], eax ; Str
		call	fwrite
		mov	[ebp+var_1C], 5
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_4026F5:				; CODE XREF: sub_40230E+3B2j
		mov	eax, [ebp+Memory]
		mov	byte ptr [eax],	0
		jmp	short loc_402768
; ---------------------------------------------------------------------------

loc_4026FD:				; CODE XREF: sub_40230E+47Bj
		mov	edx, offset aInfo16s3s ; "INFO%*[ ]%16s%*[ ]%3s\n"
		lea	eax, [ebp+Src]
		lea	ecx, [ebp+Str1]
		mov	[esp+478h+File], ecx
		lea	ecx, [ebp+var_445]
		mov	[esp+478h+Count], ecx
		mov	[esp+478h+NewSize], edx	; Format
		mov	[esp+478h+Size], eax ; Src
		call	sscanf
		cmp	eax, 2
		jnz	short loc_402750
		mov	[esp+478h+NewSize], offset aEnd	; "END"
		lea	eax, [ebp+Str1]
		mov	[esp+478h+Size], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_402750
		mov	[ebp+var_14], 1
		jmp	short loc_40278F
; ---------------------------------------------------------------------------

loc_402750:				; CODE XREF: sub_40230E+41Dj
					; sub_40230E+437j
		lea	eax, [ebp+Src]
		mov	[esp+478h+NewSize], eax
		lea	eax, [ebp+attrs]
		mov	[esp+478h+Size], eax
		call	sub_401C06

loc_402768:				; CODE XREF: sub_40230E+3EDj
		mov	eax, ds:dword_413028
		mov	[esp+478h+Count], eax ;	File
		mov	[esp+478h+NewSize], 408h ; MaxCount
		lea	eax, [ebp+Src]
		mov	[esp+478h+Size], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_4026FD

loc_40278F:				; CODE XREF: sub_40230E+440j
		cmp	[ebp+var_14], 0
		jnz	short loc_4027CA
		mov	edx, offset aGpgkeysNoInfoS ; "gpgkeys:	no INFO	%s END found\n"
		mov	eax, ds:File
		lea	ecx, [ebp+var_445]
		mov	[esp+478h+Count], ecx
		mov	[esp+478h+NewSize], edx	; Format
		mov	[esp+478h+Size], eax ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 1
		mov	[ebp+var_1C], 8
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_4027CA:				; CODE XREF: sub_40230E+485j
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		jmp	short loc_40282C
; ---------------------------------------------------------------------------

loc_4027D9:				; CODE XREF: sub_40230E+53Fj
		mov	edx, offset aKey16s5s ;	"KEY%*[	]%16s%*[ ]%5s\n"
		lea	eax, [ebp+Src]
		lea	ecx, [ebp+Str1]
		mov	[esp+478h+File], ecx
		lea	ecx, [ebp+var_445]
		mov	[esp+478h+Count], ecx
		mov	[esp+478h+NewSize], edx	; Format
		mov	[esp+478h+Size], eax ; Src
		call	sscanf
		cmp	eax, 2
		jnz	short loc_40282C
		mov	[esp+478h+NewSize], offset Str2	; "BEGIN"
		lea	eax, [ebp+Str1]
		mov	[esp+478h+Size], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40282C
		mov	[ebp+var_10], 1
		jmp	short loc_40284F
; ---------------------------------------------------------------------------

loc_40282C:				; CODE XREF: sub_40230E+4C9j
					; sub_40230E+4F9j ...
		mov	eax, ds:dword_413028
		mov	[esp+478h+Count], eax ;	File
		mov	[esp+478h+NewSize], 408h ; MaxCount
		lea	eax, [ebp+Src]
		mov	[esp+478h+Size], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	short loc_4027D9

loc_40284F:				; CODE XREF: sub_40230E+51Cj
		cmp	[ebp+var_10], 0
		jnz	loc_40295F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 1
		mov	[ebp+var_1C], 0
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_40286E:				; CODE XREF: sub_40230E+673j
		mov	edx, offset aKey16s3s ;	"KEY%*[	]%16s%*[ ]%3s\n"
		lea	eax, [ebp+Src]
		lea	ecx, [ebp+Str1]
		mov	[esp+478h+File], ecx
		lea	ecx, [ebp+var_445]
		mov	[esp+478h+Count], ecx
		mov	[esp+478h+NewSize], edx	; Format
		mov	[esp+478h+Size], eax ; Src
		call	sscanf
		cmp	eax, 2
		jnz	short loc_4028C4
		mov	[esp+478h+NewSize], offset aEnd	; "END"
		lea	eax, [ebp+Str1]
		mov	[esp+478h+Size], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4028C4
		mov	[ebp+var_14], 1
		jmp	loc_402987
; ---------------------------------------------------------------------------

loc_4028C4:				; CODE XREF: sub_40230E+58Ej
					; sub_40230E+5A8j
		lea	eax, [ebp+Src]
		mov	[ebp+var_45C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_45C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_18]
		add	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+478h+NewSize], eax	; NewSize
		mov	eax, [ebp+Memory]
		mov	[esp+478h+Size], eax ; Memory
		call	realloc
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_402942
		mov	edx, ds:File
		mov	eax, offset aGpgkeysUnabl_0 ; "gpgkeys:	unable to reallocate for key\n"
		mov	[esp+478h+File], edx ; File
		mov	[esp+478h+Count], 26h ;	Count
		mov	[esp+478h+NewSize], 1 ;	Size
		mov	[esp+478h+Size], eax ; Str
		call	fwrite
		mov	[ebp+var_1C], 5
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_402942:				; CODE XREF: sub_40230E+5FFj
		mov	eax, [ebp+var_2C]
		mov	[ebp+Memory], eax
		lea	eax, [ebp+Src]
		mov	[esp+478h+NewSize], eax	; Source
		mov	eax, [ebp+Memory]
		mov	[esp+478h+Size], eax ; Dest
		call	strcat
		jmp	short loc_402960
; ---------------------------------------------------------------------------

loc_40295F:				; CODE XREF: sub_40230E+545j
		nop

loc_402960:				; CODE XREF: sub_40230E+64Fj
		mov	eax, ds:dword_413028
		mov	[esp+478h+Count], eax ;	File
		mov	[esp+478h+NewSize], 408h ; MaxCount
		lea	eax, [ebp+Src]
		mov	[esp+478h+Size], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_40286E

loc_402987:				; CODE XREF: sub_40230E+5B1j
		cmp	[ebp+var_14], 0
		jnz	short loc_4029C2
		mov	edx, offset aGpgkeysNoKeySE ; "gpgkeys:	no KEY %s END found\n"
		mov	eax, ds:File
		lea	ecx, [ebp+var_445]
		mov	[esp+478h+Count], ecx
		mov	[esp+478h+NewSize], edx	; Format
		mov	[esp+478h+Size], eax ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 1
		mov	[ebp+var_1C], 8
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_4029C2:				; CODE XREF: sub_40230E+67Dj
		mov	[esp+478h+Count], offset aPgpkeyinfo ; "pgpKeyInfo"
		mov	[esp+478h+NewSize], offset aObjectclass	; "objectClass"
		lea	eax, [ebp+attrs]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	eax, [ebp+Memory]
		mov	[esp+478h+Count], eax ;	Src
		mov	[esp+478h+NewSize], offset aPgpkey ; "pgpKey"
		lea	eax, [ebp+attrs]
		mov	[esp+478h+Size], eax ; int
		call	sub_401941
		mov	eax, [ebp+attrs]
		mov	[esp+478h+NewSize], eax
		lea	eax, [ebp+mods]
		mov	[esp+478h+Size], eax
		call	sub_401875
		test	eax, eax
		jnz	short loc_402A4C
		mov	edx, ds:File
		mov	eax, offset aGpgkeysUnabl_1 ; "gpgkeys:	unable to merge	LDAP modificat"...
		mov	[esp+478h+File], edx ; File
		mov	[esp+478h+Count], 31h ;	Count
		mov	[esp+478h+NewSize], 1 ;	Size
		mov	[esp+478h+Size], eax ; Str
		call	fwrite
		mov	[ebp+var_1C], 5
		jmp	loc_402AE7
; ---------------------------------------------------------------------------

loc_402A4C:				; CODE XREF: sub_40230E+709j
		mov	edx, [ebp+mods]
		mov	eax, ds:ld
		mov	[esp+478h+Count], edx ;	mods
		mov	edx, [ebp+Dest]
		mov	[esp+478h+NewSize], edx	; dn
		mov	[esp+478h+Size], eax ; ld
		mov	eax, ds:ldap_modify_s
		call	eax ; ldap_modify_s
		mov	[ebp+err], eax
		cmp	[ebp+err], 20h
		jnz	short loc_402A98
		mov	edx, [ebp+attrs]
		mov	eax, ds:ld
		mov	[esp+478h+Count], edx ;	attrs
		mov	edx, [ebp+Dest]
		mov	[esp+478h+NewSize], edx	; dn
		mov	[esp+478h+Size], eax ; ld
		mov	eax, ds:ldap_add_s
		call	eax ; ldap_add_s
		mov	[ebp+err], eax

loc_402A98:				; CODE XREF: sub_40230E+765j
		cmp	[ebp+err], 0
		jz	short loc_402AE0
		mov	eax, [ebp+err]
		mov	[esp+478h+Size], eax ; err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		mov	ecx, offset aGpgkeysErrorAd ; "gpgkeys:	error adding key %s to keyserv"...
		mov	edx, ds:File
		mov	[esp+478h+File], eax
		lea	eax, [ebp+var_445]
		mov	[esp+478h+Count], eax
		mov	[esp+478h+NewSize], ecx	; Format
		mov	[esp+478h+Size], edx ; File
		call	fprintf
		mov	eax, [ebp+err]
		mov	[esp+478h+Size], eax
		call	sub_4015C8
		mov	[ebp+var_1C], eax
		jmp	short loc_402AE7
; ---------------------------------------------------------------------------

loc_402AE0:				; CODE XREF: sub_40230E+78Ej
		mov	[ebp+var_1C], 0

loc_402AE7:				; CODE XREF: sub_40230E+7Ej
					; sub_40230E+D9j ...
		mov	eax, [ebp+mods]
		test	eax, eax
		jz	short loc_402B31
		mov	eax, [ebp+mods]
		mov	[ebp+var_28], eax
		jmp	short loc_402B1A
; ---------------------------------------------------------------------------

loc_402AFC:				; CODE XREF: sub_40230E+813j
		mov	eax, [ebp+var_28]
		mov	eax, [eax]
		mov	[esp+478h+Size], eax
		call	sub_4022C6
		mov	eax, [ebp+var_28]
		mov	eax, [eax]
		mov	[esp+478h+Size], eax ; Memory
		call	free
		add	[ebp+var_28], 4

loc_402B1A:				; CODE XREF: sub_40230E+7ECj
		mov	eax, [ebp+var_28]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402AFC
		mov	eax, [ebp+mods]
		mov	[esp+478h+Size], eax ; Memory
		call	free

loc_402B31:				; CODE XREF: sub_40230E+7E1j
		mov	eax, [ebp+attrs]
		mov	[esp+478h+Size], eax ; Memory
		call	free
		mov	eax, [ebp+Dest]
		mov	[esp+478h+Size], eax ; Memory
		call	free
		mov	eax, [ebp+Memory]
		mov	[esp+478h+Size], eax ; Memory
		call	free
		cmp	[ebp+var_1C], 0
		jz	short loc_402B88
		cmp	[ebp+var_10], 0
		jz	short loc_402B88
		mov	edx, offset aKeySFailedD ; "KEY	%s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+var_1C]
		mov	[esp+478h+File], ecx
		lea	ecx, [ebp+var_445]
		mov	[esp+478h+Count], ecx
		mov	[esp+478h+NewSize], edx	; Format
		mov	[esp+478h+Size], eax ; File
		call	fprintf

loc_402B88:				; CODE XREF: sub_40230E+84Bj
					; sub_40230E+851j
		mov	eax, [ebp+var_1C]
		add	esp, 474h
		pop	edi
		pop	ebp
		retn
sub_40230E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402B94	proc near		; CODE XREF: sub_4053E3+114Fp

Size		= dword	ptr -488h
NewSize		= dword	ptr -484h
Count		= dword	ptr -480h
File		= dword	ptr -47Ch
var_46C		= dword	ptr -46Ch
attrs		= dword	ptr -45Ch
var_458		= dword	ptr -458h
var_454		= dword	ptr -454h
var_450		= dword	ptr -450h
var_44C		= dword	ptr -44Ch
Str1		= byte ptr -447h
var_441		= byte ptr -441h
Memory		= dword	ptr -430h
var_42C		= dword	ptr -42Ch
Src		= byte ptr -428h
err		= dword	ptr -20h
Dest		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 484h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 1
		mov	[ebp+Dest], 0
		mov	[ebp+Memory], 0
		mov	[ebp+var_42C], 0
		lea	eax, [ebp+var_454]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_454], 0
		mov	eax, off_40F000
		mov	[ebp+var_450], eax
		lea	eax, [ebp+Memory]
		mov	[ebp+var_44C], eax
		lea	eax, [ebp+var_454]
		mov	[ebp+attrs], eax
		mov	[ebp+var_458], 0
		mov	eax, ds:Source
		mov	[ebp+var_46C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_46C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 13h
		mov	[esp+488h+Size], eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_402C94
		mov	edx, ds:File
		mov	eax, offset aGpgkeysCanTAll ; "gpgkeys:	can't allocate memory for keys"...
		mov	[esp+488h+File], edx ; File
		mov	[esp+488h+Count], 34h ;	Count
		mov	[esp+488h+NewSize], 1 ;	Size
		mov	[esp+488h+Size], eax ; Str
		call	fwrite
		mov	[ebp+var_18], 5
		jmp	loc_402F8E
; ---------------------------------------------------------------------------

loc_402C94:				; CODE XREF: sub_402B94+CBj
		mov	edx, offset aPgpcertidVirtu ; "pgpCertid=virtual,"
		mov	eax, [ebp+Dest]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		movzx	ecx, word ptr [edx+10h]
		mov	[eax+10h], cx
		movzx	edx, byte ptr [edx+12h]
		mov	[eax+12h], dl
		mov	eax, ds:Source
		mov	[esp+488h+NewSize], eax	; Source
		mov	eax, [ebp+Dest]
		mov	[esp+488h+Size], eax ; Dest
		call	strcat
		mov	[esp+488h+Size], 1 ; Size
		call	malloc
		mov	[ebp+Memory], eax
		mov	eax, [ebp+Memory]
		test	eax, eax
		jnz	short loc_402D24
		mov	edx, ds:File
		mov	eax, offset aGpgkeysUnableT ; "gpgkeys:	unable to allocate memory for "...
		mov	[esp+488h+File], edx ; File
		mov	[esp+488h+Count], 2Bh ;	Count
		mov	[esp+488h+NewSize], 1 ;	Size
		mov	[esp+488h+Size], eax ; Str
		call	fwrite
		mov	[ebp+var_18], 5
		jmp	loc_402F8E
; ---------------------------------------------------------------------------

loc_402D24:				; CODE XREF: sub_402B94+15Bj
		mov	eax, [ebp+Memory]
		mov	byte ptr [eax],	0
		jmp	short loc_402D82
; ---------------------------------------------------------------------------

loc_402D2F:				; CODE XREF: sub_402B94+20Fj
		mov	edx, offset aKey16s5s ;	"KEY%*[	]%16s%*[ ]%5s\n"
		lea	eax, [ebp+Src]
		lea	ecx, [ebp+Str1]
		mov	[esp+488h+File], ecx
		lea	ecx, [ebp+var_441]
		mov	[esp+488h+Count], ecx
		mov	[esp+488h+NewSize], edx	; Format
		mov	[esp+488h+Size], eax ; Src
		call	sscanf
		cmp	eax, 2
		jnz	short loc_402D82
		mov	[esp+488h+NewSize], offset Str2	; "BEGIN"
		lea	eax, [ebp+Str1]
		mov	[esp+488h+Size], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_402D82
		mov	[ebp+var_C], 1
		jmp	short loc_402DA5
; ---------------------------------------------------------------------------

loc_402D82:				; CODE XREF: sub_402B94+199j
					; sub_402B94+1C9j ...
		mov	eax, ds:dword_413028
		mov	[esp+488h+Count], eax ;	File
		mov	[esp+488h+NewSize], 408h ; MaxCount
		lea	eax, [ebp+Src]
		mov	[esp+488h+Size], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	short loc_402D2F

loc_402DA5:				; CODE XREF: sub_402B94+1ECj
		cmp	[ebp+var_C], 0
		jnz	loc_402EBC
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 1
		mov	[ebp+var_18], 0
		jmp	loc_402F8E
; ---------------------------------------------------------------------------

loc_402DC4:				; CODE XREF: sub_402B94+34Aj
		mov	edx, offset aKey16s3s ;	"KEY%*[	]%16s%*[ ]%3s\n"
		lea	eax, [ebp+Src]
		lea	ecx, [ebp+Str1]
		mov	[esp+488h+File], ecx
		lea	ecx, [ebp+var_441]
		mov	[esp+488h+Count], ecx
		mov	[esp+488h+NewSize], edx	; Format
		mov	[esp+488h+Size], eax ; Src
		call	sscanf
		cmp	eax, 2
		jnz	short loc_402E1A
		mov	[esp+488h+NewSize], offset aEnd	; "END"
		lea	eax, [ebp+Str1]
		mov	[esp+488h+Size], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_402E1A
		mov	[ebp+var_10], 1
		jmp	loc_402EE4
; ---------------------------------------------------------------------------

loc_402E1A:				; CODE XREF: sub_402B94+25Ej
					; sub_402B94+278j
		lea	eax, [ebp+Src]
		mov	[ebp+var_46C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_46C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		add	eax, edx
		mov	[ebp+var_14], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+Memory]
		mov	[esp+488h+NewSize], edx	; NewSize
		mov	[esp+488h+Size], eax ; Memory
		call	realloc
		mov	[ebp+Memory], eax
		mov	eax, [ebp+Memory]
		test	eax, eax
		jnz	short loc_402EA2
		mov	edx, ds:File
		mov	eax, offset aGpgkeysUnabl_0 ; "gpgkeys:	unable to reallocate for key\n"
		mov	[esp+488h+File], edx ; File
		mov	[esp+488h+Count], 26h ;	Count
		mov	[esp+488h+NewSize], 1 ;	Size
		mov	[esp+488h+Size], eax ; Str
		call	fwrite
		mov	[ebp+var_18], 5
		jmp	loc_402F8E
; ---------------------------------------------------------------------------

loc_402EA2:				; CODE XREF: sub_402B94+2D9j
		lea	edx, [ebp+Src]
		mov	eax, [ebp+Memory]
		mov	[esp+488h+NewSize], edx	; Source
		mov	[esp+488h+Size], eax ; Dest
		call	strcat
		jmp	short loc_402EBD
; ---------------------------------------------------------------------------

loc_402EBC:				; CODE XREF: sub_402B94+215j
		nop

loc_402EBD:				; CODE XREF: sub_402B94+326j
		mov	eax, ds:dword_413028
		mov	[esp+488h+Count], eax ;	File
		mov	[esp+488h+NewSize], 408h ; MaxCount
		lea	eax, [ebp+Src]
		mov	[esp+488h+Size], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_402DC4

loc_402EE4:				; CODE XREF: sub_402B94+281j
		cmp	[ebp+var_10], 0
		jnz	short loc_402F1C
		mov	edx, offset aGpgkeysNoKeySE ; "gpgkeys:	no KEY %s END found\n"
		mov	eax, ds:File
		lea	ecx, [ebp+var_441]
		mov	[esp+488h+Count], ecx
		mov	[esp+488h+NewSize], edx	; Format
		mov	[esp+488h+Size], eax ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 1
		mov	[ebp+var_18], 8
		jmp	short loc_402F8E
; ---------------------------------------------------------------------------

loc_402F1C:				; CODE XREF: sub_402B94+354j
		mov	eax, ds:ld
		lea	edx, [ebp+attrs]
		mov	[esp+488h+Count], edx ;	attrs
		mov	edx, [ebp+Dest]
		mov	[esp+488h+NewSize], edx	; dn
		mov	[esp+488h+Size], eax ; ld
		mov	eax, ds:ldap_add_s
		call	eax ; ldap_add_s
		mov	[ebp+err], eax
		cmp	[ebp+err], 0
		jz	short loc_402F87
		mov	eax, [ebp+err]
		mov	[esp+488h+Size], eax ; err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		mov	ecx, offset aGpgkeysErrorAd ; "gpgkeys:	error adding key %s to keyserv"...
		mov	edx, ds:File
		mov	[esp+488h+File], eax
		lea	eax, [ebp+var_441]
		mov	[esp+488h+Count], eax
		mov	[esp+488h+NewSize], ecx	; Format
		mov	[esp+488h+Size], edx ; File
		call	fprintf
		mov	eax, [ebp+err]
		mov	[esp+488h+Size], eax
		call	sub_4015C8
		mov	[ebp+var_18], eax
		jmp	short loc_402F8E
; ---------------------------------------------------------------------------

loc_402F87:				; CODE XREF: sub_402B94+3AFj
		mov	[ebp+var_18], 0

loc_402F8E:				; CODE XREF: sub_402B94+FBj
					; sub_402B94+18Bj ...
		mov	eax, [ebp+Memory]
		mov	[esp+488h+Size], eax ; Memory
		call	free
		mov	eax, [ebp+Dest]
		mov	[esp+488h+Size], eax ; Memory
		call	free
		cmp	[ebp+var_18], 0
		jz	short loc_402FDA
		cmp	[ebp+var_C], 0
		jz	short loc_402FDA
		mov	edx, offset aKeySFailedD ; "KEY	%s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+var_18]
		mov	[esp+488h+File], ecx
		lea	ecx, [ebp+var_441]
		mov	[esp+488h+Count], ecx
		mov	[esp+488h+NewSize], edx	; Format
		mov	[esp+488h+Size], eax ; File
		call	fprintf

loc_402FDA:				; CODE XREF: sub_402B94+417j
					; sub_402B94+41Dj
		cmp	[ebp+var_18], 7
		jnz	short loc_402FE7
		mov	[ebp+var_18], 0

loc_402FE7:				; CODE XREF: sub_402B94+44Aj
		mov	eax, [ebp+var_18]
		add	esp, 484h
		pop	edi
		pop	ebp
		retn
sub_402B94	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402FF3(int, LDAPMessage *entry)
sub_402FF3	proc near		; CODE XREF: sub_4033A7+4C6p
					; sub_403A3F+49Bp

File		= dword	ptr -38h
Format		= dword	ptr -34h
attr		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
vals		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
entry		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	edx, offset aInfoSBegin	; "INFO	%s BEGIN\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+38h+attr],	ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf
		mov	edx, offset aPubS ; "pub:%s:"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+38h+attr],	ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf
		mov	eax, ds:ld
		mov	[esp+38h+attr],	offset attr ; "pgpkeytype"
		mov	edx, [ebp+entry]
		mov	[esp+38h+Format], edx ;	entry
		mov	[esp+38h+File],	eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	short loc_4030D8
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+38h+Format], offset off_4100C1 ; Str2
		mov	[esp+38h+File],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40308B
		mov	eax, ds:dword_41302C
		mov	[esp+38h+Format], eax ;	File
		mov	[esp+38h+File],	31h ; Ch
		call	fputc
		jmp	short loc_4030CB
; ---------------------------------------------------------------------------

loc_40308B:				; CODE XREF: sub_402FF3+7Fj
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+38h+Format], offset aDssDh	; "DSS/DH"
		mov	[esp+38h+File],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4030CB
		mov	edx, ds:dword_41302C
		mov	eax, offset a17	; "17"
		mov	[esp+38h+var_2C], edx ;	File
		mov	[esp+38h+attr],	2 ; Count
		mov	[esp+38h+Format], 1 ; Size
		mov	[esp+38h+File],	eax ; Str
		call	fwrite

loc_4030CB:				; CODE XREF: sub_402FF3+96j
					; sub_402FF3+AFj
		mov	eax, [ebp+vals]
		mov	[esp+38h+File],	eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_4030D8:				; CODE XREF: sub_402FF3+66j
		mov	eax, ds:dword_41302C
		mov	[esp+38h+Format], eax ;	File
		mov	[esp+38h+File],	3Ah ; Ch
		call	fputc
		mov	eax, ds:ld
		mov	[esp+38h+attr],	offset aPgpkeysize_0 ; "pgpkeysize"
		mov	edx, [ebp+entry]
		mov	[esp+38h+Format], edx ;	entry
		mov	[esp+38h+File],	eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	short loc_40315A
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+38h+File],	eax ; Str
		call	atoi
		test	eax, eax
		jle	short loc_40314D
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+38h+File],	eax ; Str
		call	atoi
		mov	ecx, offset aD	; "%d"
		mov	edx, ds:dword_41302C
		mov	[esp+38h+attr],	eax
		mov	[esp+38h+Format], ecx ;	Format
		mov	[esp+38h+File],	edx ; File
		call	fprintf

loc_40314D:				; CODE XREF: sub_402FF3+130j
		mov	eax, [ebp+vals]
		mov	[esp+38h+File],	eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_40315A:				; CODE XREF: sub_402FF3+11Fj
		mov	eax, ds:dword_41302C
		mov	[esp+38h+Format], eax ;	File
		mov	[esp+38h+File],	3Ah ; Ch
		call	fputc
		mov	eax, ds:ld
		mov	[esp+38h+attr],	offset aPgpkeycreate_0 ; "pgpkeycreatetime"
		mov	edx, [ebp+entry]
		mov	[esp+38h+Format], edx ;	entry
		mov	[esp+38h+File],	eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	short loc_4031F2
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Fh
		jnz	short loc_4031E5
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+38h+File],	eax ; char *
		call	sub_401733
		mov	ecx, eax
		mov	edx, offset aU	; "%u"
		mov	eax, ds:dword_41302C
		mov	[esp+38h+attr],	ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf

loc_4031E5:				; CODE XREF: sub_402FF3+1C7j
		mov	eax, [ebp+vals]
		mov	[esp+38h+File],	eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_4031F2:				; CODE XREF: sub_402FF3+1A1j
		mov	eax, ds:dword_41302C
		mov	[esp+38h+Format], eax ;	File
		mov	[esp+38h+File],	3Ah ; Ch
		call	fputc
		mov	eax, ds:ld
		mov	[esp+38h+attr],	offset aPgpkeyexpire_0 ; "pgpkeyexpiretime"
		mov	edx, [ebp+entry]
		mov	[esp+38h+Format], edx ;	entry
		mov	[esp+38h+File],	eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	short loc_40328A
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Fh
		jnz	short loc_40327D
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+38h+File],	eax ; char *
		call	sub_401733
		mov	ecx, eax
		mov	edx, offset aU	; "%u"
		mov	eax, ds:dword_41302C
		mov	[esp+38h+attr],	ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf

loc_40327D:				; CODE XREF: sub_402FF3+25Fj
		mov	eax, [ebp+vals]
		mov	[esp+38h+File],	eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_40328A:				; CODE XREF: sub_402FF3+239j
		mov	eax, ds:dword_41302C
		mov	[esp+38h+Format], eax ;	File
		mov	[esp+38h+File],	3Ah ; Ch
		call	fputc
		mov	eax, ds:ld
		mov	[esp+38h+attr],	offset aPgprevoked_0 ; "pgprevoked"
		mov	edx, [ebp+entry]
		mov	[esp+38h+Format], edx ;	entry
		mov	[esp+38h+File],	eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	short loc_4032FA
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+38h+File],	eax ; Str
		call	atoi
		cmp	eax, 1
		jnz	short loc_4032ED
		mov	eax, ds:dword_41302C
		mov	[esp+38h+Format], eax ;	File
		mov	[esp+38h+File],	72h ; Ch
		call	fputc

loc_4032ED:				; CODE XREF: sub_402FF3+2E3j
		mov	eax, [ebp+vals]
		mov	[esp+38h+File],	eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_4032FA:				; CODE XREF: sub_402FF3+2D1j
		mov	eax, ds:dword_41302C
		mov	[esp+38h+Format], eax ;	File
		mov	[esp+38h+File],	0Ah ; Ch
		call	fputc
		mov	eax, ds:ld
		mov	[esp+38h+attr],	offset aPgpuserid_0 ; "pgpuserid"
		mov	edx, [ebp+entry]
		mov	[esp+38h+Format], edx ;	entry
		mov	[esp+38h+File],	eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	short loc_403384
		mov	[ebp+var_C], 0
		jmp	short loc_403368
; ---------------------------------------------------------------------------

loc_40333F:				; CODE XREF: sub_402FF3+382j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+vals]
		mov	ecx, [eax]
		mov	edx, offset aUidS ; "uid:%s\n"
		mov	eax, ds:dword_41302C
		mov	[esp+38h+attr],	ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf
		add	[ebp+var_C], 1

loc_403368:				; CODE XREF: sub_402FF3+34Aj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+vals]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40333F
		mov	eax, [ebp+vals]
		mov	[esp+38h+File],	eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_403384:				; CODE XREF: sub_402FF3+341j
		mov	edx, offset aInfoSEnd ;	"INFO %s END\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+38h+attr],	ecx
		mov	[esp+38h+Format], edx ;	Format
		mov	[esp+38h+File],	eax ; File
		call	fprintf
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_402FF3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4033A7	proc near		; CODE XREF: sub_4053E3+105Ap

Str		= dword	ptr -0D8h
Size		= dword	ptr -0D4h
Count		= dword	ptr -0D0h
File		= dword	ptr -0CCh
attrs		= dword	ptr -0C8h
attrsonly	= dword	ptr -0C4h
res		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
Dest		= byte ptr -76h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
vals		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
err		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
entry		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 0D0h
		mov	[ebp+var_10], 1
		mov	[ebp+var_38], 0
		mov	[ebp+var_A4], offset aReplaceme	; "replaceme"
		mov	[ebp+var_A0], offset aPgpcertid_0 ; "pgpcertid"
		mov	[ebp+var_9C], offset aPgpuserid_0 ; "pgpuserid"
		mov	[ebp+var_98], offset aPgpkeyid_0 ; "pgpkeyid"
		mov	[ebp+var_94], offset aPgprevoked_0 ; "pgprevoked"
		mov	[ebp+var_90], offset aPgpdisabled_0 ; "pgpdisabled"
		mov	[ebp+var_8C], offset aPgpkeycreate_0 ; "pgpkeycreatetime"
		mov	[ebp+var_88], offset aModifytimestam ; "modifytimestamp"
		mov	[ebp+var_84], offset aPgpkeysize_0 ; "pgpkeysize"
		mov	[ebp+var_80], offset attr ; "pgpkeytype"
		mov	[ebp+var_7C], 0
		mov	eax, off_40F000
		mov	[ebp+var_A4], eax
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset a0x	; "0x"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40345F
		add	[ebp+arg_0], 2

loc_40345F:				; CODE XREF: sub_4033A7+B2j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 20h
		jnz	short loc_4034FC
		mov	edx, ds:File
		mov	eax, offset aGpgkeysLdapKey ; "gpgkeys:	LDAP keyservers	do not support"...
		mov	[esp+0D8h+File], edx ; File
		mov	[esp+0D8h+Count], 38h ;	Count
		mov	[esp+0D8h+Size], 1 ; Size
		mov	[esp+0D8h+Str],	eax ; Str
		call	fwrite
		mov	edx, offset aKey0xSBegin ; "KEY	0x%s BEGIN\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailedD ; "KEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	[esp+0D8h+File], 2
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		mov	eax, 2
		jmp	loc_40399D
; ---------------------------------------------------------------------------

loc_4034FC:				; CODE XREF: sub_4033A7+E0j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 10h
		jbe	loc_4035AF
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 10h
		add	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 4
		test	al, al
		jz	short loc_40358F
		mov	eax, offset aPgpcertid_16sP ; "(|(pgpcertid=%.16s)(pgpsubkeyid=%.16s))"
		mov	edx, [ebp+var_14]
		mov	[esp+0D8h+File], edx
		mov	edx, [ebp+var_14]
		mov	[esp+0D8h+Count], edx
		mov	[esp+0D8h+Size], eax ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+0D8h+Str],	eax ; Dest
		call	sprintf
		jmp	loc_403645
; ---------------------------------------------------------------------------

loc_40358F:				; CODE XREF: sub_4033A7+1BFj
		mov	eax, offset aPgpcertid_16s ; "(pgpcertid=%.16s)"
		mov	edx, [ebp+var_14]
		mov	[esp+0D8h+Count], edx
		mov	[esp+0D8h+Size], eax ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+0D8h+Str],	eax ; Dest
		call	sprintf
		jmp	loc_403645
; ---------------------------------------------------------------------------

loc_4035AF:				; CODE XREF: sub_4033A7+17Dj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 8
		jbe	short loc_40362A
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 4
		test	al, al
		jz	short loc_40360D
		mov	eax, offset aPgpcertid_16sP ; "(|(pgpcertid=%.16s)(pgpsubkeyid=%.16s))"
		mov	edx, [ebp+arg_0]
		mov	[esp+0D8h+File], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+0D8h+Count], edx
		mov	[esp+0D8h+Size], eax ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+0D8h+Str],	eax ; Dest
		call	sprintf
		jmp	short loc_403645
; ---------------------------------------------------------------------------

loc_40360D:				; CODE XREF: sub_4033A7+240j
		mov	eax, offset aPgpcertid_16s ; "(pgpcertid=%.16s)"
		mov	edx, [ebp+arg_0]
		mov	[esp+0D8h+Count], edx
		mov	[esp+0D8h+Size], eax ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+0D8h+Str],	eax ; Dest
		call	sprintf
		jmp	short loc_403645
; ---------------------------------------------------------------------------

loc_40362A:				; CODE XREF: sub_4033A7+230j
		mov	eax, offset aPgpkeyid_8s ; "(pgpkeyid=%.8s)"
		mov	edx, [ebp+arg_0]
		mov	[esp+0D8h+Count], edx
		mov	[esp+0D8h+Size], eax ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+0D8h+Str],	eax ; Dest
		call	sprintf

loc_403645:				; CODE XREF: sub_4033A7+1E3j
					; sub_4033A7+203j ...
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_40366F
		mov	edx, offset aGpgkeysLdapFet ; "gpgkeys:	LDAP fetch for:	%s\n"
		mov	eax, ds:File
		lea	ecx, [ebp+Dest]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf

loc_40366F:				; CODE XREF: sub_4033A7+2A9j
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_403685
		mov	[ebp+var_9C], 0

loc_403685:				; CODE XREF: sub_4033A7+2D2j
		mov	edx, ds:Source
		mov	eax, ds:ld
		lea	ecx, [ebp+var_34]
		mov	[esp+0D8h+res],	ecx ; res
		mov	[esp+0D8h+attrsonly], 0	; attrsonly
		lea	ecx, [ebp+var_A4]
		mov	[esp+0D8h+attrs], ecx ;	attrs
		lea	ecx, [ebp+Dest]
		mov	[esp+0D8h+File], ecx ; filter
		mov	[esp+0D8h+Count], 2 ; scope
		mov	[esp+0D8h+Size], edx ; base
		mov	[esp+0D8h+Str],	eax ; ld
		mov	eax, ds:ldap_search_s
		call	eax ; ldap_search_s
		mov	[ebp+err], eax
		cmp	[ebp+err], 0
		jz	short loc_40374E
		mov	eax, [ebp+err]
		mov	[esp+0D8h+Str],	eax
		call	sub_4015C8
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+err]
		mov	[esp+0D8h+Str],	eax ; err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		mov	ecx, offset aGpgkeysLdapSea ; "gpgkeys:	LDAP search error: %s\n"
		mov	edx, ds:File
		mov	[esp+0D8h+Count], eax
		mov	[esp+0D8h+Size], ecx ; Format
		mov	[esp+0D8h+Str],	edx ; File
		call	fprintf
		mov	edx, offset aKey0xSBegin ; "KEY	0x%s BEGIN\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailedD ; "KEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+var_1C]
		mov	[esp+0D8h+File], ecx
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+var_1C]
		jmp	loc_40399D
; ---------------------------------------------------------------------------

loc_40374E:				; CODE XREF: sub_4033A7+326j
		mov	edx, [ebp+var_34]
		mov	eax, ds:ld
		mov	[esp+0D8h+Size], edx ; res
		mov	[esp+0D8h+Str],	eax ; ld
		mov	eax, ds:ldap_count_entries
		call	eax ; ldap_count_entries
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jg	short loc_4037D1
		mov	edx, offset aGpgkeysKeySNot ; "gpgkeys:	key %s not found on keyserver\"...
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		mov	edx, offset aKey0xSBegin ; "KEY	0x%s BEGIN\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailedD ; "KEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	[esp+0D8h+File], 6
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		jmp	loc_40397B
; ---------------------------------------------------------------------------

loc_4037D1:				; CODE XREF: sub_4033A7+3C4j
		mov	edx, [ebp+var_34]
		mov	eax, ds:ld
		mov	[esp+0D8h+Size], edx ; res
		mov	[esp+0D8h+Str],	eax ; ld
		mov	eax, ds:ldap_first_entry
		call	eax ; ldap_first_entry
		mov	[ebp+entry], eax
		jmp	loc_403971
; ---------------------------------------------------------------------------

loc_4037EF:				; CODE XREF: sub_4033A7+5CEj
		mov	eax, ds:ld
		mov	[esp+0D8h+Count], offset aPgpcertid_0 ;	"pgpcertid"
		mov	edx, [ebp+entry]
		mov	[esp+0D8h+Size], edx ; entry
		mov	[esp+0D8h+Str],	eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	loc_403958
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		mov	[esp+0D8h+Size], edx ; int
		mov	[esp+0D8h+Str],	eax ; char *
		call	sub_401636
		test	eax, eax
		jnz	loc_40394B
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		lea	edx, [ebp+var_38]
		mov	[esp+0D8h+Size], edx ; int
		mov	[esp+0D8h+Str],	eax ; Source
		call	sub_40167C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_40385E
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		jmp	loc_403982
; ---------------------------------------------------------------------------

loc_40385E:				; CODE XREF: sub_4033A7+4AAj
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		mov	edx, [ebp+entry]
		mov	[esp+0D8h+Size], edx ; entry
		mov	[esp+0D8h+Str],	eax ; int
		call	sub_402FF3
		mov	edx, offset aKey0xSBegin ; "KEY	0x%s BEGIN\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		mov	edx, off_40F000
		mov	eax, ds:ld
		mov	[esp+0D8h+Count], edx ;	attr
		mov	edx, [ebp+entry]
		mov	[esp+0D8h+Size], edx ; entry
		mov	[esp+0D8h+Str],	eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jnz	short loc_40390B
		mov	eax, ds:ld
		mov	[esp+0D8h+Str],	eax ; LDAP *
		call	sub_4015FC
		mov	[ebp+var_30], eax
		mov	edx, offset aGpgkeysUnabl_2 ; "gpgkeys:	unable to retrieve key %s from"...
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailedD ; "KEY 0x%s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+var_30]
		mov	[esp+0D8h+File], ecx
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		jmp	short loc_40394B
; ---------------------------------------------------------------------------

loc_40390B:				; CODE XREF: sub_4033A7+50Fj
		mov	eax, [ebp+vals]
		mov	edx, [eax]
		mov	eax, ds:dword_41302C
		mov	[esp+0D8h+Size], edx ; int
		mov	[esp+0D8h+Str],	eax ; FILE *
		call	sub_407142
		mov	edx, offset aKey0xSEnd ; "\nKEY	0x%s END\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+0D8h+Count], ecx
		mov	[esp+0D8h+Size], edx ; Format
		mov	[esp+0D8h+Str],	eax ; File
		call	fprintf
		mov	eax, [ebp+vals]
		mov	[esp+0D8h+Str],	eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_40394B:				; CODE XREF: sub_4033A7+489j
					; sub_4033A7+562j
		mov	eax, [ebp+var_24]
		mov	[esp+0D8h+Str],	eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_403958:				; CODE XREF: sub_4033A7+46Dj
		mov	eax, ds:ld
		mov	edx, [ebp+entry]
		mov	[esp+0D8h+Size], edx ; entry
		mov	[esp+0D8h+Str],	eax ; ld
		mov	eax, ds:ldap_next_entry
		call	eax ; ldap_next_entry
		mov	[ebp+entry], eax

loc_403971:				; CODE XREF: sub_4033A7+443j
		cmp	[ebp+entry], 0
		jnz	loc_4037EF

loc_40397B:				; CODE XREF: sub_4033A7+425j
		mov	[ebp+var_10], 0

loc_403982:				; CODE XREF: sub_4033A7+4B2j
		mov	eax, [ebp+var_34]
		mov	[esp+0D8h+Str],	eax ; res
		mov	eax, ds:ldap_msgfree
		call	eax ; ldap_msgfree
		mov	eax, [ebp+var_38]
		mov	[esp+0D8h+Str],	eax
		call	sub_401706
		mov	eax, [ebp+var_10]

loc_40399D:				; CODE XREF: sub_4033A7+150j
					; sub_4033A7+3A2j
		add	esp, 0D0h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4033A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4039A7(char *Dest, int)
sub_4039A7	proc near		; CODE XREF: sub_403A3F+150p
					; sub_4053E3+128Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
Dest		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+Dest]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+Dest], eax
		jmp	short loc_403A29
; ---------------------------------------------------------------------------

loc_4039D2:				; CODE XREF: sub_4039A7+8Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	[esp+28h+Str], offset Str ; "*()\\"
		call	strchr
		test	eax, eax
		jz	short loc_403A16
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, offset a02x ; "\\%02X"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Val], eax ; Format
		mov	eax, [ebp+Dest]
		mov	[esp+28h+Str], eax ; Dest
		call	sprintf
		add	[ebp+Dest], 3
		jmp	short loc_403A25
; ---------------------------------------------------------------------------

loc_403A16:				; CODE XREF: sub_4039A7+46j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+Dest]
		mov	[eax], dl
		add	[ebp+Dest], 1

loc_403A25:				; CODE XREF: sub_4039A7+6Dj
		add	[ebp+arg_4], 1

loc_403A29:				; CODE XREF: sub_4039A7+29j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4039D2
		mov	eax, [ebp+Dest]
		mov	byte ptr [eax],	0
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_4039A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403A3F	proc near		; CODE XREF: sub_4053E3+10C4p

File		= dword	ptr -0CE8h
Format		= dword	ptr -0CE4h
scope		= dword	ptr -0CE0h
filter		= dword	ptr -0CDCh
attrs		= dword	ptr -0CD8h
attrsonly	= dword	ptr -0CD4h
res		= dword	ptr -0CD0h
var_CBC		= dword	ptr -0CBCh
var_CB4		= dword	ptr -0CB4h
var_CB0		= dword	ptr -0CB0h
var_CAC		= dword	ptr -0CACh
var_CA8		= dword	ptr -0CA8h
var_CA4		= dword	ptr -0CA4h
var_CA0		= dword	ptr -0CA0h
var_C9C		= dword	ptr -0C9Ch
var_C98		= dword	ptr -0C98h
var_C94		= dword	ptr -0C94h
var_C90		= dword	ptr -0C90h
var_C8C		= dword	ptr -0C8Ch
Dest		= byte ptr -0C87h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
vals		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
err		= dword	ptr -14h
var_10		= dword	ptr -10h
entry		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0CE0h
		mov	[ebp+var_10], 1
		mov	[ebp+var_CB4], offset aReplaceme ; "replaceme"
		mov	[ebp+var_CB0], offset aPgpcertid_0 ; "pgpcertid"
		mov	[ebp+var_CAC], offset aPgpuserid_0 ; "pgpuserid"
		mov	[ebp+var_CA8], offset aPgpkeyid_0 ; "pgpkeyid"
		mov	[ebp+var_CA4], offset aPgprevoked_0 ; "pgprevoked"
		mov	[ebp+var_CA0], offset aPgpdisabled_0 ; "pgpdisabled"
		mov	[ebp+var_C9C], offset aPgpkeycreate_0 ;	"pgpkeycreatetime"
		mov	[ebp+var_C98], offset aModifytimestam ;	"modifytimestamp"
		mov	[ebp+var_C94], offset aPgpkeysize_0 ; "pgpkeysize"
		mov	[ebp+var_C90], offset attr ; "pgpkeytype"
		mov	[ebp+var_C8C], 0
		mov	eax, off_40F000
		mov	[ebp+var_CB4], eax
		mov	[ebp+Dest], 0
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jz	short loc_403AF1
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 2
		test	al, al
		jnz	short loc_403B33

loc_403AF1:				; CODE XREF: sub_403A3F+A0j
		mov	edx, offset asc_41054D ; "(&"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_CBC], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_CBC]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		lea	eax, [ebp+Dest]
		add	eax, ecx
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl

loc_403B33:				; CODE XREF: sub_403A3F+B0j
		mov	edx, offset aPgpuserid_1 ; "(pgpUserID=*"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_CBC], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_CBC]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		lea	eax, [ebp+Dest]
		add	eax, ecx
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, byte ptr [edx+0Ch]
		mov	[eax+0Ch], dl
		mov	eax, [ebp+arg_0]
		mov	[esp+0CE8h+Format], eax	; int
		lea	eax, [ebp+Dest]
		mov	[esp+0CE8h+File], eax ;	Dest
		call	sub_4039A7
		mov	edx, offset asc_41055D ; "*)"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_CBC], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_CBC]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		lea	eax, [ebp+Dest]
		add	eax, ecx
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_403C31
		mov	edx, offset aPgpdisabled0 ; "(pgpDisabled=0)"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_CBC], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_CBC]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		lea	eax, [ebp+Dest]
		add	eax, ecx
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx

loc_403C31:				; CODE XREF: sub_403A3F+1A5j
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 2
		test	al, al
		jnz	short loc_403C95
		mov	edx, offset aPgprevoked0 ; "(pgpRevoked=0)"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_CBC], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_CBC]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		lea	eax, [ebp+Dest]
		add	eax, ecx
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	ecx, word ptr [edx+0Ch]
		mov	[eax+0Ch], cx
		movzx	edx, byte ptr [edx+0Eh]
		mov	[eax+0Eh], dl

loc_403C95:				; CODE XREF: sub_403A3F+200j
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jz	short loc_403CB5
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 2
		test	al, al
		jnz	short loc_403CF0

loc_403CB5:				; CODE XREF: sub_403A3F+264j
		mov	ebx, offset asc_41057F ; ")"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_CBC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_CBC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Dest]
		add	edx, eax
		movzx	eax, word ptr [ebx]
		mov	[edx], ax

loc_403CF0:				; CODE XREF: sub_403A3F+274j
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_403D1D
		mov	edx, offset aGpgkeysLdapFet ; "gpgkeys:	LDAP fetch for:	%s\n"
		mov	eax, ds:File
		lea	ecx, [ebp+Dest]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf

loc_403D1D:				; CODE XREF: sub_403A3F+2BCj
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_403D33
		mov	[ebp+var_CAC], 0

loc_403D33:				; CODE XREF: sub_403A3F+2E8j
		mov	edx, ds:Source
		mov	eax, ds:ld
		lea	ecx, [ebp+var_2C]
		mov	[esp+0CE8h+res], ecx ; res
		mov	[esp+0CE8h+attrsonly], 0 ; attrsonly
		lea	ecx, [ebp+var_CB4]
		mov	[esp+0CE8h+attrs], ecx ; attrs
		lea	ecx, [ebp+Dest]
		mov	[esp+0CE8h+filter], ecx	; filter
		mov	[esp+0CE8h+scope], 2 ; scope
		mov	[esp+0CE8h+Format], edx	; base
		mov	[esp+0CE8h+File], eax ;	ld
		mov	eax, ds:ldap_search_s
		call	eax ; ldap_search_s
		mov	[ebp+err], eax
		cmp	[ebp+err], 0
		jz	short loc_403DFF
		mov	eax, [ebp+err]
		mov	[esp+0CE8h+File], eax
		call	sub_4015C8
		mov	[ebp+var_18], eax
		mov	eax, [ebp+err]
		mov	[esp+0CE8h+File], eax ;	err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		mov	ecx, offset aGpgkeysLdapSea ; "gpgkeys:	LDAP search error: %s\n"
		mov	edx, ds:File
		mov	[esp+0CE8h+scope], eax
		mov	[esp+0CE8h+Format], ecx	; Format
		mov	[esp+0CE8h+File], edx ;	File
		call	fprintf
		mov	edx, offset aNameSBegin	; "NAME	%s BEGIN\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf
		mov	edx, offset aNameSFailedD ; "NAME %s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+var_18]
		mov	[esp+0CE8h+filter], ecx
		mov	ecx, [ebp+arg_0]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf
		mov	eax, [ebp+var_18]
		jmp	loc_403FFF
; ---------------------------------------------------------------------------

loc_403DFF:				; CODE XREF: sub_403A3F+33Fj
		mov	edx, [ebp+var_2C]
		mov	eax, ds:ld
		mov	[esp+0CE8h+Format], edx	; res
		mov	[esp+0CE8h+File], eax ;	ld
		mov	eax, ds:ldap_count_entries
		call	eax ; ldap_count_entries
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jg	short loc_403E82
		mov	edx, offset aGpgkeysKeySNot ; "gpgkeys:	key %s not found on keyserver\"...
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf
		mov	edx, offset aNameSBegin	; "NAME	%s BEGIN\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf
		mov	edx, offset aNameSFailedD ; "NAME %s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	[esp+0CE8h+filter], 6
		mov	ecx, [ebp+arg_0]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf
		jmp	loc_403FE8
; ---------------------------------------------------------------------------

loc_403E82:				; CODE XREF: sub_403A3F+3DDj
		mov	edx, [ebp+var_2C]
		mov	eax, ds:ld
		mov	[esp+0CE8h+Format], edx	; res
		mov	[esp+0CE8h+File], eax ;	ld
		mov	eax, ds:ldap_first_entry
		call	eax ; ldap_first_entry
		mov	[ebp+entry], eax
		jmp	loc_403FDE
; ---------------------------------------------------------------------------

loc_403EA0:				; CODE XREF: sub_403A3F+5A3j
		mov	eax, ds:ld
		mov	[esp+0CE8h+scope], offset aPgpcertid_0 ; "pgpcertid"
		mov	edx, [ebp+entry]
		mov	[esp+0CE8h+Format], edx	; entry
		mov	[esp+0CE8h+File], eax ;	ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_403FC5
		mov	eax, [ebp+var_20]
		mov	eax, [eax]
		mov	edx, [ebp+entry]
		mov	[esp+0CE8h+Format], edx	; entry
		mov	[esp+0CE8h+File], eax ;	int
		call	sub_402FF3
		mov	edx, offset aNameSBegin	; "NAME	%s BEGIN\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf
		mov	edx, off_40F000
		mov	eax, ds:ld
		mov	[esp+0CE8h+scope], edx ; attr
		mov	edx, [ebp+entry]
		mov	[esp+0CE8h+Format], edx	; entry
		mov	[esp+0CE8h+File], eax ;	ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jnz	short loc_403F78
		mov	eax, ds:ld
		mov	[esp+0CE8h+File], eax ;	LDAP *
		call	sub_4015FC
		mov	[ebp+var_28], eax
		mov	edx, offset aGpgkeysUnabl_2 ; "gpgkeys:	unable to retrieve key %s from"...
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf
		mov	edx, offset aNameSFailedD ; "NAME %s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+var_28]
		mov	[esp+0CE8h+filter], ecx
		mov	ecx, [ebp+arg_0]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf
		jmp	short loc_403FB8
; ---------------------------------------------------------------------------

loc_403F78:				; CODE XREF: sub_403A3F+4E4j
		mov	eax, [ebp+vals]
		mov	edx, [eax]
		mov	eax, ds:dword_41302C
		mov	[esp+0CE8h+Format], edx	; int
		mov	[esp+0CE8h+File], eax ;	FILE *
		call	sub_407142
		mov	edx, offset aNameSEnd ;	"\nNAME	%s END\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_0]
		mov	[esp+0CE8h+scope], ecx
		mov	[esp+0CE8h+Format], edx	; Format
		mov	[esp+0CE8h+File], eax ;	File
		call	fprintf
		mov	eax, [ebp+vals]
		mov	[esp+0CE8h+File], eax ;	vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_403FB8:				; CODE XREF: sub_403A3F+537j
		mov	eax, [ebp+var_20]
		mov	[esp+0CE8h+File], eax ;	vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_403FC5:				; CODE XREF: sub_403A3F+486j
		mov	eax, ds:ld
		mov	edx, [ebp+entry]
		mov	[esp+0CE8h+Format], edx	; entry
		mov	[esp+0CE8h+File], eax ;	ld
		mov	eax, ds:ldap_next_entry
		call	eax ; ldap_next_entry
		mov	[ebp+entry], eax

loc_403FDE:				; CODE XREF: sub_403A3F+45Cj
		cmp	[ebp+entry], 0
		jnz	loc_403EA0

loc_403FE8:				; CODE XREF: sub_403A3F+43Ej
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_2C]
		mov	[esp+0CE8h+File], eax ;	res
		mov	eax, ds:ldap_msgfree
		call	eax ; ldap_msgfree
		mov	eax, [ebp+var_10]

loc_403FFF:				; CODE XREF: sub_403A3F+3BBj
		add	esp, 0CE0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_403A3F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404009(FILE *, int, int)
sub_404009	proc near		; CODE XREF: sub_404077+C9Fp

File		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], al
		jmp	short loc_40406B
; ---------------------------------------------------------------------------

loc_404017:				; CODE XREF: sub_404009+6Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp+var_C]
		jz	short loc_40402C
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_40404F

loc_40402C:				; CODE XREF: sub_404009+17j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, offset a02x_0 ; "%%%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		call	fprintf
		jmp	short loc_404067
; ---------------------------------------------------------------------------

loc_40404F:				; CODE XREF: sub_404009+21j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	File
		mov	[esp+28h+File],	eax ; Ch
		call	fputc

loc_404067:				; CODE XREF: sub_404009+44j
		add	[ebp+arg_4], 1

loc_40406B:				; CODE XREF: sub_404009+Cj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404017
		leave
		retn
sub_404009	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404077(char *Source)
sub_404077	proc near		; CODE XREF: sub_4053E3+132Fp

Size		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
Count		= dword	ptr -0A0h
File		= dword	ptr -9Ch
attrs		= dword	ptr -98h
attrsonly	= dword	ptr -94h
res		= dword	ptr -90h
var_7C		= dword	ptr -7Ch
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
vals		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
err		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
entry		= dword	ptr -0Ch
Source		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0A0h
		mov	[ebp+var_10], 0
		mov	[ebp+var_44], 0
		mov	[ebp+var_6C], offset aPgpcertid_0 ; "pgpcertid"
		mov	[ebp+var_68], offset aPgpuserid_0 ; "pgpuserid"
		mov	[ebp+var_64], offset aPgprevoked_0 ; "pgprevoked"
		mov	[ebp+var_60], offset aPgpdisabled_0 ; "pgpdisabled"
		mov	[ebp+var_5C], offset aPgpkeycreate_0 ; "pgpkeycreatetime"
		mov	[ebp+var_58], offset aPgpkeyexpire_0 ; "pgpkeyexpiretime"
		mov	[ebp+var_54], offset aModifytimestam ; "modifytimestamp"
		mov	[ebp+var_50], offset aPgpkeysize_0 ; "pgpkeysize"
		mov	[ebp+var_4C], offset attr ; "pgpkeytype"
		mov	[ebp+var_48], 0
		mov	eax, [ebp+Source]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 47h
		mov	[esp+0A8h+Size], eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_40415F
		mov	edx, ds:File
		mov	eax, offset aGpgkeysOutOf_0 ; "gpgkeys:	out of memory when building se"...
		mov	[esp+0A8h+File], edx ; File
		mov	[esp+0A8h+Count], 31h ;	Count
		mov	[esp+0A8h+var_A4], 1 ; Size
		mov	[esp+0A8h+Size], eax ; Str
		call	fwrite
		mov	ecx, [ebp+Source]
		mov	edx, offset aSearchSFailedD ; "SEARCH %s FAILED	%d\n"
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+File], 5
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		mov	eax, 5
		jmp	loc_404DD7
; ---------------------------------------------------------------------------

loc_40415F:				; CODE XREF: sub_404077+90j
		mov	ecx, [ebp+Source]
		mov	edx, offset aSearchSBegin ; "SEARCH %s BEGIN\n"
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		lea	eax, [ebp+Source]
		mov	[esp+0A8h+Size], eax
		call	sub_40717C
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_413038
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4041BA
		mov	ecx, [ebp+Source]
		mov	edx, offset aSearchTypeIsDA ; "search type is %d, and key is \"%s\"\n"
		mov	eax, ds:File
		mov	[esp+0A8h+File], ecx
		mov	ecx, [ebp+var_1C]
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf

loc_4041BA:				; CODE XREF: sub_404077+11Dj
		mov	eax, [ebp+Dest]
		mov	byte ptr [eax],	0
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jz	short loc_4041E0
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 2
		test	al, al
		jnz	short loc_404214

loc_4041E0:				; CODE XREF: sub_404077+157j
		mov	edx, offset asc_41054D ; "(&"
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl

loc_404214:				; CODE XREF: sub_404077+167j
		mov	ebx, offset asc_410634 ; "(=*"
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		mov	eax, [ebp+var_1C]
		cmp	eax, 4
		jz	short loc_404288
		cmp	eax, 5
		jnz	short loc_4042C3
		mov	edx, offset aPgpkeyid ;	"pgpKeyID"
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		jmp	short loc_4042FD
; ---------------------------------------------------------------------------

loc_404288:				; CODE XREF: sub_404077+1D0j
		mov	edx, offset aPgpcertid ; "pgpCertID"
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, word ptr [edx+8]
		mov	[eax+8], dx
		jmp	short loc_4042FD
; ---------------------------------------------------------------------------

loc_4042C3:				; CODE XREF: sub_404077+1D5j
		mov	edx, offset aPgpuserid ; "pgpUserID"
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, word ptr [edx+8]
		mov	[eax+8], dx
		nop

loc_4042FD:				; CODE XREF: sub_404077+20Fj
					; sub_404077+24Aj
		mov	ebx, 410636h
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		cmp	[ebp+var_1C], 5	; switch 6 cases
		ja	loc_4043D6	; jumptable 00404341 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_410724
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_404343:				; CODE XREF: sub_404077+2CAj
					; DATA XREF: .rdata:off_410724o
		mov	ebx, 410638h	; jumptable 00404341 case 0
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		jmp	short loc_4043D6 ; jumptable 00404341 default case
; ---------------------------------------------------------------------------

loc_404372:				; CODE XREF: sub_404077+2CAj
					; DATA XREF: .rdata:off_410724o
		mov	edx, offset asc_41063A ; jumptable 00404341 case 2
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		jmp	short loc_4043D6 ; jumptable 00404341 default case
; ---------------------------------------------------------------------------

loc_4043A8:				; CODE XREF: sub_404077+2CAj
					; DATA XREF: .rdata:off_410724o
		mov	ebx, offset asc_41063D ; jumptable 00404341 case 3
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		mov	edx, [ebx]
		mov	[eax], edx
		jmp	short loc_4043D6 ; jumptable 00404341 default case
; ---------------------------------------------------------------------------

loc_4043D5:				; CODE XREF: sub_404077+2CAj
					; DATA XREF: .rdata:off_410724o
		nop			; jumptable 00404341 cases 1,4,5

loc_4043D6:				; CODE XREF: sub_404077+2B7j
					; sub_404077+2F9j ...
		mov	eax, [ebp+Source] ; jumptable 00404341 default case
		mov	[esp+0A8h+var_A4], eax ; Source
		mov	eax, [ebp+Dest]
		mov	[esp+0A8h+Size], eax ; Dest
		call	strcat
		cmp	[ebp+var_1C], 5	; switch 6 cases
		ja	loc_404494	; jumptable 004043FF default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_41073C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_404401:				; CODE XREF: sub_404077+388j
					; DATA XREF: .rdata:off_41073Co
		mov	ebx, 410638h	; jumptable 004043FF case 0
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		jmp	short loc_404494 ; jumptable 004043FF default case
; ---------------------------------------------------------------------------

loc_404430:				; CODE XREF: sub_404077+388j
					; DATA XREF: .rdata:off_41073Co
		mov	edx, offset asc_410641 ; jumptable 004043FF case 2
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		jmp	short loc_404494 ; jumptable 004043FF default case
; ---------------------------------------------------------------------------

loc_404466:				; CODE XREF: sub_404077+388j
					; DATA XREF: .rdata:off_41073Co
		mov	ebx, offset asc_410644 ; jumptable 004043FF case 3
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		mov	edx, [ebx]
		mov	[eax], edx
		jmp	short loc_404494 ; jumptable 004043FF default case
; ---------------------------------------------------------------------------

loc_404493:				; CODE XREF: sub_404077+388j
					; DATA XREF: .rdata:off_41073Co
		nop			; jumptable 004043FF cases 1,4,5

loc_404494:				; CODE XREF: sub_404077+375j
					; sub_404077+3B7j ...
		mov	ebx, offset asc_41057F ; jumptable 004043FF default case
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_40450E
		mov	edx, offset aPgpdisabled0 ; "(pgpDisabled=0)"
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx

loc_40450E:				; CODE XREF: sub_404077+458j
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 2
		test	al, al
		jnz	short loc_404564
		mov	edx, offset aPgprevoked0 ; "(pgpRevoked=0)"
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	ebx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, ebx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	ecx, word ptr [edx+0Ch]
		mov	[eax+0Ch], cx
		movzx	edx, byte ptr [edx+0Eh]
		mov	[eax+0Eh], dl

loc_404564:				; CODE XREF: sub_404077+4A5j
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jz	short loc_404584
		mov	eax, ds:dword_413038
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 2
		test	al, al
		jnz	short loc_4045B1

loc_404584:				; CODE XREF: sub_404077+4FBj
		mov	ebx, offset asc_41057F ; ")"
		mov	eax, [ebp+Dest]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx

loc_4045B1:				; CODE XREF: sub_404077+50Bj
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_4045DB
		mov	edx, offset aGpgkeysLdapS_0 ; "gpgkeys:	LDAP search for: %s\n"
		mov	eax, ds:File
		mov	ecx, [ebp+Dest]
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf

loc_4045DB:				; CODE XREF: sub_404077+545j
		mov	edx, ds:Source
		mov	eax, ds:ld
		lea	ecx, [ebp+var_40]
		mov	[esp+0A8h+res],	ecx ; res
		mov	[esp+0A8h+attrsonly], 0	; attrsonly
		lea	ecx, [ebp+var_6C]
		mov	[esp+0A8h+attrs], ecx ;	attrs
		mov	ecx, [ebp+Dest]
		mov	[esp+0A8h+File], ecx ; filter
		mov	[esp+0A8h+Count], 2 ; scope
		mov	[esp+0A8h+var_A4], edx ; base
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_search_s
		call	eax ; ldap_search_s
		mov	[ebp+err], eax
		mov	eax, [ebp+Dest]
		mov	[esp+0A8h+Size], eax ; Memory
		call	free
		cmp	[ebp+err], 0
		jz	short loc_404695
		cmp	[ebp+err], 4
		jz	short loc_404695
		mov	eax, [ebp+err]
		mov	[esp+0A8h+Size], eax
		call	sub_4015C8
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+Source]
		mov	edx, offset aSearchSFailedD ; "SEARCH %s FAILED	%d\n"
		mov	eax, ds:dword_41302C
		mov	ebx, [ebp+var_24]
		mov	[esp+0A8h+File], ebx
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		mov	eax, [ebp+err]
		mov	[esp+0A8h+Size], eax ; err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		mov	ecx, offset aGpgkeysLdapSea ; "gpgkeys:	LDAP search error: %s\n"
		mov	edx, ds:File
		mov	[esp+0A8h+Count], eax
		mov	[esp+0A8h+var_A4], ecx ; Format
		mov	[esp+0A8h+Size], edx ; File
		call	fprintf
		mov	eax, [ebp+var_24]
		jmp	loc_404DD7
; ---------------------------------------------------------------------------

loc_404695:				; CODE XREF: sub_404077+5B4j
					; sub_404077+5BAj
		mov	edx, [ebp+var_40]
		mov	eax, ds:ld
		mov	[esp+0A8h+var_A4], edx ; res
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_first_entry
		call	eax ; ldap_first_entry
		mov	[ebp+entry], eax
		jmp	loc_404763
; ---------------------------------------------------------------------------

loc_4046B3:				; CODE XREF: sub_404077+6F0j
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset aPgpcertid_0 ;	"pgpcertid"
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_40474A
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_28]
		mov	eax, [eax]
		mov	[esp+0A8h+var_A4], edx ; int
		mov	[esp+0A8h+Size], eax ; char *
		call	sub_401636
		test	eax, eax
		jnz	short loc_40474A
		mov	eax, [ebp+var_28]
		mov	eax, [eax]
		lea	edx, [ebp+var_44]
		mov	[esp+0A8h+var_A4], edx ; int
		mov	[esp+0A8h+Size], eax ; Source
		call	sub_40167C
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_404746
		mov	ecx, [ebp+Source]
		mov	edx, offset aSearchSFailedD ; "SEARCH %s FAILED	%d\n"
		mov	eax, ds:dword_41302C
		mov	ebx, [ebp+var_2C]
		mov	[esp+0A8h+File], ebx
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Size], eax
		call	sub_401706
		mov	eax, [ebp+var_2C]
		jmp	loc_404DD7
; ---------------------------------------------------------------------------

loc_404746:				; CODE XREF: sub_404077+696j
		add	[ebp+var_10], 1

loc_40474A:				; CODE XREF: sub_404077+661j
					; sub_404077+679j
		mov	eax, ds:ld
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_next_entry
		call	eax ; ldap_next_entry
		mov	[ebp+entry], eax

loc_404763:				; CODE XREF: sub_404077+637j
		cmp	[ebp+entry], 0
		jnz	loc_4046B3
		cmp	[ebp+err], 4
		jnz	short loc_4047B5
		cmp	[ebp+var_10], 1
		jnz	short loc_404798
		mov	edx, offset aGpgkeysSearchR ; "gpgkeys:	search results exceeded	server"...
		mov	eax, ds:File
		mov	ecx, [ebp+var_10]
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		jmp	short loc_4047B5
; ---------------------------------------------------------------------------

loc_404798:				; CODE XREF: sub_404077+700j
		mov	edx, offset aGpgkeysSearc_0 ; "gpgkeys:	search results exceeded	server"...
		mov	eax, ds:File
		mov	ecx, [ebp+var_10]
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf

loc_4047B5:				; CODE XREF: sub_404077+6FAj
					; sub_404077+71Fj
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Size], eax
		call	sub_401706
		mov	[ebp+var_44], 0
		cmp	[ebp+var_10], 0
		jg	short loc_4047F9
		mov	edx, ds:dword_41302C
		mov	eax, offset aInfo10 ; "info:1:0\n"
		mov	[esp+0A8h+File], edx ; File
		mov	[esp+0A8h+Count], 9 ; Count
		mov	[esp+0A8h+var_A4], 1 ; Size
		mov	[esp+0A8h+Size], eax ; Str
		call	fwrite
		jmp	loc_404D9D
; ---------------------------------------------------------------------------

loc_4047F9:				; CODE XREF: sub_404077+754j
		mov	edx, offset aInfo1D ; "info:1:%d\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+var_10]
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		mov	edx, [ebp+var_40]
		mov	eax, ds:ld
		mov	[esp+0A8h+var_A4], edx ; res
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_first_entry
		call	eax ; ldap_first_entry
		mov	[ebp+entry], eax
		jmp	loc_404D93
; ---------------------------------------------------------------------------

loc_404834:				; CODE XREF: sub_404077+D20j
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset aPgpcertid_0 ;	"pgpcertid"
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	loc_404D7A
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+0A8h+var_A4], edx ; int
		mov	[esp+0A8h+Size], eax ; char *
		call	sub_401636
		test	eax, eax
		jnz	loc_404D6D
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		lea	edx, [ebp+var_44]
		mov	[esp+0A8h+var_A4], edx ; int
		mov	[esp+0A8h+Size], eax ; Source
		call	sub_40167C
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_4048E9
		mov	ecx, [ebp+Source]
		mov	edx, offset aSearchSFailedD ; "SEARCH %s FAILED	%d\n"
		mov	eax, ds:dword_41302C
		mov	ebx, [ebp+var_34]
		mov	[esp+0A8h+File], ebx
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Size], eax
		call	sub_401706
		mov	eax, [ebp+vals]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free
		mov	eax, [ebp+var_40]
		mov	[esp+0A8h+Size], eax ; res
		mov	eax, ds:ldap_msgfree
		call	eax ; ldap_msgfree
		mov	eax, [ebp+var_34]
		jmp	loc_404DD7
; ---------------------------------------------------------------------------

loc_4048E9:				; CODE XREF: sub_404077+81Fj
		mov	eax, [ebp+vals]
		mov	ecx, [eax]
		mov	edx, offset aPubS ; "pub:%s:"
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset attr ;	"pgpkeytype"
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	loc_4049B4
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[esp+0A8h+var_A4], offset off_4100C1 ; Str2
		mov	[esp+0A8h+Size], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_404965
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+var_A4], eax ; File
		mov	[esp+0A8h+Size], 31h ; Ch
		call	fputc
		jmp	short loc_4049A7
; ---------------------------------------------------------------------------

loc_404965:				; CODE XREF: sub_404077+8D5j
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[esp+0A8h+var_A4], offset aDssDh ; "DSS/DH"
		mov	[esp+0A8h+Size], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_4049A7
		mov	edx, ds:dword_41302C
		mov	eax, offset a17	; "17"
		mov	[esp+0A8h+File], edx ; File
		mov	[esp+0A8h+Count], 2 ; Count
		mov	[esp+0A8h+var_A4], 1 ; Size
		mov	[esp+0A8h+Size], eax ; Str
		call	fwrite

loc_4049A7:				; CODE XREF: sub_404077+8ECj
					; sub_404077+907j
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_4049B4:				; CODE XREF: sub_404077+8B6j
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+var_A4], eax ; File
		mov	[esp+0A8h+Size], 3Ah ; Ch
		call	fputc
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset aPgpkeysize_0 ; "pgpkeysize"
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_404A36
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[esp+0A8h+Size], eax ; Str
		call	atoi
		test	eax, eax
		jle	short loc_404A29
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[esp+0A8h+Size], eax ; Str
		call	atoi
		mov	ecx, offset aD	; "%d"
		mov	edx, ds:dword_41302C
		mov	[esp+0A8h+Count], eax
		mov	[esp+0A8h+var_A4], ecx ; Format
		mov	[esp+0A8h+Size], edx ; File
		call	fprintf

loc_404A29:				; CODE XREF: sub_404077+988j
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_404A36:				; CODE XREF: sub_404077+977j
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+var_A4], eax ; File
		mov	[esp+0A8h+Size], 3Ah ; Ch
		call	fputc
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset aPgpkeycreate_0 ; "pgpkeycreatetime"
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_404ACE
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Fh
		jnz	short loc_404ACE
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[esp+0A8h+Size], eax ; char *
		call	sub_401733
		mov	ecx, eax
		mov	edx, offset aU	; "%u"
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_404ACE:				; CODE XREF: sub_404077+9F9j
					; sub_404077+A1Fj
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+var_A4], eax ; File
		mov	[esp+0A8h+Size], 3Ah ; Ch
		call	fputc
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset aPgpkeyexpire_0 ; "pgpkeyexpiretime"
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_404B66
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Fh
		jnz	short loc_404B66
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[esp+0A8h+Size], eax ; char *
		call	sub_401733
		mov	ecx, eax
		mov	edx, offset aU	; "%u"
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_404B66:				; CODE XREF: sub_404077+A91j
					; sub_404077+AB7j
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+var_A4], eax ; File
		mov	[esp+0A8h+Size], 3Ah ; Ch
		call	fputc
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset aPgprevoked_0 ; "pgprevoked"
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_404BD6
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[esp+0A8h+Size], eax ; Str
		call	atoi
		cmp	eax, 1
		jnz	short loc_404BC9
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+var_A4], eax ; File
		mov	[esp+0A8h+Size], 72h ; Ch
		call	fputc

loc_404BC9:				; CODE XREF: sub_404077+B3Bj
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_404BD6:				; CODE XREF: sub_404077+B29j
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset aPgpdisabled_0	; "pgpdisabled"
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_404C31
		mov	eax, [ebp+var_38]
		mov	eax, [eax]
		mov	[esp+0A8h+Size], eax ; Str
		call	atoi
		cmp	eax, 1
		jnz	short loc_404C24
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+var_A4], eax ; File
		mov	[esp+0A8h+Size], 64h ; Ch
		call	fputc

loc_404C24:				; CODE XREF: sub_404077+B96j
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_404C31:				; CODE XREF: sub_404077+B84j
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+var_A4], eax ; File
		mov	[esp+0A8h+Size], 0Ah ; Ch
		call	fputc
		mov	edx, [ebp+var_40]
		mov	eax, ds:ld
		mov	[esp+0A8h+var_A4], edx ; res
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_first_entry
		call	eax ; ldap_first_entry
		mov	[ebp+var_14], eax
		jmp	loc_404D63
; ---------------------------------------------------------------------------

loc_404C64:				; CODE XREF: sub_404077+CF0j
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset aPgpcertid_0 ;	"pgpcertid"
		mov	edx, [ebp+var_14]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	loc_404D4A
		mov	eax, [ebp+var_38]
		mov	edx, [eax]
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+0A8h+var_A4], edx ; Str2
		mov	[esp+0A8h+Size], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	loc_404D3D
		mov	edx, ds:dword_41302C
		mov	eax, offset aUid_0 ; "uid:"
		mov	[esp+0A8h+File], edx ; File
		mov	[esp+0A8h+Count], 4 ; Count
		mov	[esp+0A8h+var_A4], 1 ; Size
		mov	[esp+0A8h+Size], eax ; Str
		call	fwrite
		mov	eax, ds:ld
		mov	[esp+0A8h+Count], offset aPgpuserid_0 ;	"pgpuserid"
		mov	edx, [ebp+var_14]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_404D28
		mov	eax, [ebp+var_3C]
		mov	edx, [eax]
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+Count], 3Ah ;	int
		mov	[esp+0A8h+var_A4], edx ; int
		mov	[esp+0A8h+Size], eax ; FILE *
		call	sub_404009
		mov	eax, [ebp+var_3C]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_404D28:				; CODE XREF: sub_404077+C84j
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+var_A4], eax ; File
		mov	[esp+0A8h+Size], 0Ah ; Ch
		call	fputc

loc_404D3D:				; CODE XREF: sub_404077+C32j
		mov	eax, [ebp+var_38]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_404D4A:				; CODE XREF: sub_404077+C12j
		mov	eax, ds:ld
		mov	edx, [ebp+var_14]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_next_entry
		call	eax ; ldap_next_entry
		mov	[ebp+var_14], eax

loc_404D63:				; CODE XREF: sub_404077+BE8j
		cmp	[ebp+var_14], 0
		jnz	loc_404C64

loc_404D6D:				; CODE XREF: sub_404077+7FEj
		mov	eax, [ebp+vals]
		mov	[esp+0A8h+Size], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_404D7A:				; CODE XREF: sub_404077+7E2j
		mov	eax, ds:ld
		mov	edx, [ebp+entry]
		mov	[esp+0A8h+var_A4], edx ; entry
		mov	[esp+0A8h+Size], eax ; ld
		mov	eax, ds:ldap_next_entry
		call	eax ; ldap_next_entry
		mov	[ebp+entry], eax

loc_404D93:				; CODE XREF: sub_404077+7B8j
		cmp	[ebp+entry], 0
		jnz	loc_404834

loc_404D9D:				; CODE XREF: sub_404077+77Dj
		mov	eax, [ebp+var_40]
		mov	[esp+0A8h+Size], eax ; res
		mov	eax, ds:ldap_msgfree
		call	eax ; ldap_msgfree
		mov	eax, [ebp+var_44]
		mov	[esp+0A8h+Size], eax
		call	sub_401706
		mov	ecx, [ebp+Source]
		mov	edx, offset aSearchSEnd	; "SEARCH %s END\n"
		mov	eax, ds:dword_41302C
		mov	[esp+0A8h+Count], ecx
		mov	[esp+0A8h+var_A4], edx ; Format
		mov	[esp+0A8h+Size], eax ; File
		call	fprintf
		mov	eax, 0

loc_404DD7:				; CODE XREF: sub_404077+E3j
					; sub_404077+619j ...
		add	esp, 0A0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_404077	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404DE1	proc near		; CODE XREF: sub_4053E3+C3Bp
					; sub_4053E3+C7Fp ...

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		cmp	[ebp+arg_0], 0
		jz	loc_404EB1
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		cmp	eax, 4
		jnz	loc_404EA9
		mov	edx, ds:dword_41302C
		mov	eax, offset aSearch ; "SEARCH "
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 7 ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		jmp	short loc_404E54
; ---------------------------------------------------------------------------

loc_404E2B:				; CODE XREF: sub_404DE1+77j
		mov	ecx, [ebp+arg_0]
		mov	edx, offset aS	; "%s "
		mov	eax, ds:dword_41302C
		mov	[esp+18h+Count], ecx
		mov	[esp+18h+Size],	edx ; Format
		mov	[esp+18h+Str], eax ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+408h]
		mov	[ebp+arg_0], eax

loc_404E54:				; CODE XREF: sub_404DE1+48j
		cmp	[ebp+arg_0], 0
		jnz	short loc_404E2B
		mov	edx, offset aFailedD ; "FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	ecx, [ebp+arg_4]
		mov	[esp+18h+Count], ecx
		mov	[esp+18h+Size],	edx ; Format
		mov	[esp+18h+Str], eax ; File
		call	fprintf
		jmp	short loc_404EB2
; ---------------------------------------------------------------------------

loc_404E79:				; CODE XREF: sub_404DE1+CCj
		mov	ecx, [ebp+arg_0]
		mov	edx, offset aKeySFailedD ; "KEY	%s FAILED %d\n"
		mov	eax, ds:dword_41302C
		mov	ebx, [ebp+arg_4]
		mov	[esp+18h+File],	ebx
		mov	[esp+18h+Count], ecx
		mov	[esp+18h+Size],	edx ; Format
		mov	[esp+18h+Str], eax ; File
		call	fprintf
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+408h]
		mov	[ebp+arg_0], eax

loc_404EA9:				; CODE XREF: sub_404DE1+1Bj
		cmp	[ebp+arg_0], 0
		jnz	short loc_404E79
		jmp	short loc_404EB2
; ---------------------------------------------------------------------------

loc_404EB1:				; CODE XREF: sub_404DE1+Bj
		nop

loc_404EB2:				; CODE XREF: sub_404DE1+96j
					; sub_404DE1+CEj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_404DE1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404EB8	proc near		; CODE XREF: sub_4053E3+C96p

ld		= dword	ptr -78h
base		= dword	ptr -74h
scope		= dword	ptr -70h
filter		= dword	ptr -6Ch
attrs		= dword	ptr -68h
attrsonly	= dword	ptr -64h
res		= dword	ptr -60h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
entry		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
vals		= dword	ptr -1Ch
Dest		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 74h
		mov	[ebp+var_30], offset aNamingcontexts ; "namingContexts"
		mov	[ebp+var_2C], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_24], 0
		mov	eax, ds:ld
		lea	edx, [ebp+entry]
		mov	[esp+78h+res], edx ; res
		mov	[esp+78h+attrsonly], 0 ; attrsonly
		lea	edx, [ebp+var_30]
		mov	[esp+78h+attrs], edx ; attrs
		mov	[esp+78h+filter], offset filter	; "(objectClass=*)"
		mov	[esp+78h+scope], 0 ; scope
		mov	[esp+78h+base],	offset byte_41078A ; base
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_search_s
		call	eax ; ldap_search_s
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_4051AE
		mov	edx, [ebp+entry]
		mov	eax, ds:ld
		mov	[esp+78h+scope], offset	aNamingcontexts	; "namingContexts"
		mov	[esp+78h+base],	edx ; entry
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_40519C
		mov	[ebp+var_30], offset aPgpbasekeyspac ; "pgpBaseKeySpaceDN"
		mov	[ebp+var_2C], offset aPgpversion ; "pgpVersion"
		mov	[ebp+var_28], offset aPgpsoftware ; "pgpSoftware"
		mov	ds:dword_413020, 1
		mov	[ebp+var_C], 0
		jmp	loc_405173
; ---------------------------------------------------------------------------

loc_404F7B:				; CODE XREF: sub_404EB8+2D1j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 12h
		mov	[esp+78h+ld], eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_404FC0
		mov	eax, 0FFFFFFFFh
		jmp	loc_405345
; ---------------------------------------------------------------------------

loc_404FC0:				; CODE XREF: sub_404EB8+FCj
		mov	edx, offset aCnPgpserverinf ; "cn=pgpServerInfo,"
		mov	eax, [ebp+Dest]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		movzx	edx, word ptr [edx+10h]
		mov	[eax+10h], dx
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[esp+78h+base],	eax ; Source
		mov	eax, [ebp+Dest]
		mov	[esp+78h+ld], eax ; Dest
		call	strcat
		mov	eax, ds:ld
		lea	edx, [ebp+var_38]
		mov	[esp+78h+res], edx ; res
		mov	[esp+78h+attrsonly], 0 ; attrsonly
		lea	edx, [ebp+var_30]
		mov	[esp+78h+attrs], edx ; attrs
		mov	[esp+78h+filter], offset filter	; "(objectClass=*)"
		mov	[esp+78h+scope], 0 ; scope
		mov	edx, [ebp+Dest]
		mov	[esp+78h+base],	edx ; base
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_search_s
		call	eax ; ldap_search_s
		mov	[ebp+var_10], eax
		mov	eax, [ebp+Dest]
		mov	[esp+78h+ld], eax ; Memory
		call	free
		cmp	[ebp+var_10], 20h
		jz	loc_40516E
		cmp	[ebp+var_10], 0
		jz	short loc_405062
		mov	eax, [ebp+var_10]
		jmp	loc_405345
; ---------------------------------------------------------------------------

loc_405062:				; CODE XREF: sub_404EB8+1A0j
		mov	edx, [ebp+var_38]
		mov	eax, ds:ld
		mov	[esp+78h+scope], offset	aPgpbasekeyspac	; "pgpBaseKeySpaceDN"
		mov	[esp+78h+base],	edx ; entry
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	short loc_4050A8
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	[esp+78h+ld], eax ; Src
		call	_strdup
		mov	ds:Source, eax
		mov	eax, [ebp+vals]
		mov	[esp+78h+ld], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_4050A8:				; CODE XREF: sub_404EB8+1CFj
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 1
		jbe	loc_40515F
		mov	edx, [ebp+var_38]
		mov	eax, ds:ld
		mov	[esp+78h+scope], offset	aPgpsoftware ; "pgpSoftware"
		mov	[esp+78h+base],	edx ; entry
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	short loc_40510C
		mov	eax, [ebp+vals]
		mov	ecx, [eax]
		mov	edx, offset aServerS ; "Server:	\t%s\n"
		mov	eax, ds:File
		mov	[esp+78h+scope], ecx
		mov	[esp+78h+base],	edx ; Format
		mov	[esp+78h+ld], eax ; File
		call	fprintf
		mov	eax, [ebp+vals]
		mov	[esp+78h+ld], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_40510C:				; CODE XREF: sub_404EB8+226j
		mov	edx, [ebp+var_38]
		mov	eax, ds:ld
		mov	[esp+78h+scope], offset	aPgpversion ; "pgpVersion"
		mov	[esp+78h+base],	edx ; entry
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jz	short loc_40515F
		mov	eax, [ebp+vals]
		mov	ecx, [eax]
		mov	edx, offset aVersionS ;	"Version:\t%s\n"
		mov	eax, ds:File
		mov	[esp+78h+scope], ecx
		mov	[esp+78h+base],	edx ; Format
		mov	[esp+78h+ld], eax ; File
		call	fprintf
		mov	eax, [ebp+vals]
		mov	[esp+78h+ld], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_40515F:				; CODE XREF: sub_404EB8+1FBj
					; sub_404EB8+279j
		mov	eax, [ebp+var_38]
		mov	[esp+78h+ld], eax ; res
		mov	eax, ds:ldap_msgfree
		call	eax ; ldap_msgfree
		jmp	short loc_40516F
; ---------------------------------------------------------------------------

loc_40516E:				; CODE XREF: sub_404EB8+196j
		nop

loc_40516F:				; CODE XREF: sub_404EB8+2B4j
		add	[ebp+var_C], 1

loc_405173:				; CODE XREF: sub_404EB8+BEj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40518F
		mov	eax, ds:Source
		test	eax, eax
		jz	loc_404F7B

loc_40518F:				; CODE XREF: sub_404EB8+2C8j
		mov	eax, [ebp+var_14]
		mov	[esp+78h+ld], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_40519C:				; CODE XREF: sub_404EB8+92j
		mov	eax, [ebp+entry]
		mov	[esp+78h+ld], eax ; res
		mov	eax, ds:ldap_msgfree
		call	eax ; ldap_msgfree
		jmp	loc_405340
; ---------------------------------------------------------------------------

loc_4051AE:				; CODE XREF: sub_404EB8+67j
		mov	[ebp+var_30], offset aPgpbasekeyspac ; "pgpBaseKeySpaceDN"
		mov	[ebp+var_2C], offset aVersion ;	"version"
		mov	[ebp+var_28], offset aSoftware ; "software"
		mov	eax, ds:ld
		lea	edx, [ebp+var_3C]
		mov	[esp+78h+res], edx ; res
		mov	[esp+78h+attrsonly], 0 ; attrsonly
		lea	edx, [ebp+var_30]
		mov	[esp+78h+attrs], edx ; attrs
		mov	[esp+78h+filter], offset filter	; "(objectClass=*)"
		mov	[esp+78h+scope], 0 ; scope
		mov	[esp+78h+base],	offset aCnPgpserveri_0 ; "cn=pgpServerInfo"
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_search_s
		call	eax ; ldap_search_s
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_405211
		mov	eax, [ebp+var_10]
		jmp	loc_405345
; ---------------------------------------------------------------------------

loc_405211:				; CODE XREF: sub_404EB8+34Fj
		mov	edx, [ebp+var_3C]
		mov	eax, ds:ld
		mov	[esp+78h+scope], offset	aBasekeyspacedn	; "baseKeySpaceDN"
		mov	[esp+78h+base],	edx ; entry
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_405257
		mov	eax, [ebp+var_20]
		mov	eax, [eax]
		mov	[esp+78h+ld], eax ; Src
		call	_strdup
		mov	ds:Source, eax
		mov	eax, [ebp+var_20]
		mov	[esp+78h+ld], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_405257:				; CODE XREF: sub_404EB8+37Ej
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 1
		jbe	short loc_4052B7
		mov	edx, [ebp+var_3C]
		mov	eax, ds:ld
		mov	[esp+78h+scope], offset	aSoftware ; "software"
		mov	[esp+78h+base],	edx ; entry
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4052B7
		mov	eax, [ebp+var_20]
		mov	ecx, [eax]
		mov	edx, offset aServerS ; "Server:	\t%s\n"
		mov	eax, ds:File
		mov	[esp+78h+scope], ecx
		mov	[esp+78h+base],	edx ; Format
		mov	[esp+78h+ld], eax ; File
		call	fprintf
		mov	eax, [ebp+var_20]
		mov	[esp+78h+ld], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_4052B7:				; CODE XREF: sub_404EB8+3AAj
					; sub_404EB8+3D1j
		mov	edx, [ebp+var_3C]
		mov	eax, ds:ld
		mov	[esp+78h+scope], offset	aVersion ; "version"
		mov	[esp+78h+base],	edx ; entry
		mov	[esp+78h+ld], eax ; ld
		mov	eax, ds:ldap_get_values
		call	eax ; ldap_get_values
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_405333
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 1
		jbe	short loc_40530A
		mov	eax, [ebp+var_20]
		mov	ecx, [eax]
		mov	edx, offset aVersionS ;	"Version:\t%s\n"
		mov	eax, ds:File
		mov	[esp+78h+scope], ecx
		mov	[esp+78h+base],	edx ; Format
		mov	[esp+78h+ld], eax ; File
		call	fprintf

loc_40530A:				; CODE XREF: sub_404EB8+431j
		mov	eax, [ebp+var_20]
		mov	eax, [eax]
		mov	[esp+78h+ld], eax ; Str
		call	atoi
		cmp	eax, 1
		jle	short loc_405326
		mov	off_40F000, offset aPgpkeyv2 ; "pgpKeyV2"

loc_405326:				; CODE XREF: sub_404EB8+462j
		mov	eax, [ebp+var_20]
		mov	[esp+78h+ld], eax ; vals
		mov	eax, ds:ldap_value_free
		call	eax ; ldap_value_free

loc_405333:				; CODE XREF: sub_404EB8+424j
		mov	eax, [ebp+var_3C]
		mov	[esp+78h+ld], eax ; res
		mov	eax, ds:ldap_msgfree
		call	eax ; ldap_msgfree

loc_405340:				; CODE XREF: sub_404EB8+2F1j
		mov	eax, 0

loc_405345:				; CODE XREF: sub_404EB8+103j
					; sub_404EB8+1A5j ...
		add	esp, 74h
		pop	edi
		pop	ebp
		retn
sub_404EB8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40534B(FILE *)
sub_40534B	proc near		; CODE XREF: sub_4053E3+118p
					; sub_4053E3+140p

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, offset aHHelpHelp ; "-h, --help\thelp\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 10h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aVMachineReadab ; "-V\t\tmachine readable version\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 1Dh ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aVersionHumanRe ; "--version\thuman	readable version\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 21h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aOOutputToThisF ; "-o\t\toutput to this file\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 18h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		leave
		retn
sub_40534B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4053E3	proc near		; CODE XREF: sub_401180+265p

Str1		= dword	ptr -598h
Str2		= dword	ptr -594h
Count		= dword	ptr -590h
File		= dword	ptr -58Ch
ClientControls	= dword	ptr -588h
var_56C		= dword	ptr -56Ch
var_565		= byte ptr -565h
var_465		= byte ptr -465h
var_464		= dword	ptr -464h
var_460		= dword	ptr -460h
invalue		= dword	ptr -45Ch
Src		= byte ptr -458h
var_50		= dword	ptr -50h
Source		= dword	ptr -4Ch
Dest		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
passwd		= dword	ptr -1Ch
Memory		= dword	ptr -18h
var_14		= dword	ptr -14h
err		= dword	ptr -10h
PortNumber	= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 590h
		call	sub_40DBD0
		mov	[esp+598h+PortNumber], 0
		mov	[esp+598h+var_14], 1
		mov	[esp+598h+Memory], 0
		mov	[esp+598h+passwd], 0
		mov	[esp+598h+var_20], 0
		mov	[esp+598h+var_24], 0
		mov	[esp+598h+var_28], 0
		mov	[esp+598h+var_2C], 0
		mov	[esp+598h+var_30], 0
		mov	[esp+598h+var_34], 0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	ds:File, eax
		cmp	[ebp+arg_0], 1
		jle	short loc_4054C6
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	eax, [eax]
		mov	[esp+598h+Str2], offset	aVersion_0 ; "--version"
		mov	[esp+598h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4054C6
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aGpgkeys_ldapGn ; "gpgkeys_ldap (GnuPG) 2.0.30\n"
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 1Ch ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite
		mov	eax, 0
		jmp	loc_406821
; ---------------------------------------------------------------------------

loc_4054C6:				; CODE XREF: sub_4053E3+92j
					; sub_4053E3+AEj
		cmp	[ebp+arg_0], 1
		jle	loc_4055CB
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	eax, [eax]
		mov	[esp+598h+Str2], offset	aHelp ;	"--help"
		mov	[esp+598h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_4055CB
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+598h+Str1], eax ; FILE *
		call	sub_40534B
		mov	eax, 0
		jmp	loc_406821
; ---------------------------------------------------------------------------

loc_40550A:				; CODE XREF: sub_4053E3+211j
		mov	eax, [esp+598h+var_44]
		cmp	eax, 56h
		jz	short loc_405532
		cmp	eax, 6Fh
		jz	short loc_405566
		mov	eax, ds:File
		mov	[esp+598h+Str1], eax ; FILE *
		call	sub_40534B
		mov	eax, 0
		jmp	loc_406821
; ---------------------------------------------------------------------------

loc_405532:				; CODE XREF: sub_4053E3+131j
		mov	eax, offset aDS	; "%d\n%s\n"
		mov	edx, ds:_iob
		add	edx, 20h
		mov	[esp+598h+File], offset	a2_0_30	; "2.0.30"
		mov	[esp+598h+Count], 1
		mov	[esp+598h+Str2], eax ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf
		mov	eax, 0
		jmp	loc_406821
; ---------------------------------------------------------------------------

loc_405566:				; CODE XREF: sub_4053E3+136j
		mov	edx, offset Mode ; "w"
		mov	eax, ds:Filename
		mov	[esp+598h+Str2], edx ; Mode
		mov	[esp+598h+Str1], eax ; Filename
		call	fopen
		mov	ds:dword_41302C, eax
		mov	eax, ds:dword_41302C
		test	eax, eax
		jnz	short loc_4055CA
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+598h+Str1], eax ; int
		call	strerror
		mov	ebx, ds:Filename
		mov	ecx, offset aGpgkeysCannotO ; "gpgkeys:	Cannot open output file	`%s': "...
		mov	edx, ds:File
		mov	[esp+598h+File], eax
		mov	[esp+598h+Count], ebx
		mov	[esp+598h+Str2], ecx ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf
		mov	eax, 1
		jmp	loc_406821
; ---------------------------------------------------------------------------

loc_4055CA:				; CODE XREF: sub_4053E3+1A5j
		nop

loc_4055CB:				; CODE XREF: sub_4053E3+E7j
					; sub_4053E3+107j
		mov	[esp+598h+Count], offset aHvo ;	"hVo:"
		mov	eax, [ebp+arg_4]
		mov	[esp+598h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+598h+Str1], eax
		call	sub_40EA90
		mov	[esp+598h+var_44], eax
		cmp	[esp+598h+var_44], 0FFFFFFFFh
		jnz	loc_40550A
		mov	eax, dword_40F028
		cmp	[ebp+arg_0], eax
		jle	short loc_405678
		mov	edx, offset aR	; "r"
		mov	eax, dword_40F028
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+598h+Str2], edx ; Mode
		mov	[esp+598h+Str1], eax ; Filename
		call	fopen
		mov	ds:dword_413028, eax
		mov	eax, ds:dword_413028
		test	eax, eax
		jnz	short loc_405678
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+598h+Str1], eax ; int
		call	strerror
		mov	edx, dword_40F028
		shl	edx, 2
		add	edx, [ebp+arg_4]
		mov	ebx, [edx]
		mov	ecx, offset aGpgkeysCanno_0 ; "gpgkeys:	Cannot open input file `%s': %"...
		mov	edx, ds:File
		mov	[esp+598h+File], eax
		mov	[esp+598h+Count], ebx
		mov	[esp+598h+Str2], ecx ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf
		mov	eax, 1
		jmp	loc_406821
; ---------------------------------------------------------------------------

loc_405678:				; CODE XREF: sub_4053E3+21Fj
					; sub_4053E3+24Bj
		mov	eax, ds:dword_413028
		test	eax, eax
		jnz	short loc_40568B
		mov	eax, ds:_iob
		mov	ds:dword_413028, eax

loc_40568B:				; CODE XREF: sub_4053E3+29Cj
		mov	eax, ds:dword_41302C
		test	eax, eax
		jnz	short loc_4056A1
		mov	eax, ds:_iob
		add	eax, 20h
		mov	ds:dword_41302C, eax

loc_4056A1:				; CODE XREF: sub_4053E3+2AFj
		call	sub_4068E8
		mov	ds:dword_413038, eax
		mov	eax, ds:dword_413038
		test	eax, eax
		jnz	loc_405B79
		mov	eax, 5
		jmp	loc_406821
; ---------------------------------------------------------------------------

loc_4056C2:				; CODE XREF: sub_4053E3+7BFj
		movzx	eax, [esp+598h+Src]
		cmp	al, 0Ah
		jz	loc_405BAA
		mov	eax, ds:dword_413038
		mov	[esp+598h+Str2], eax ; int
		lea	eax, [esp+598h+Src]
		mov	[esp+598h+Str1], eax ; char *
		call	sub_4069F5
		mov	[esp+598h+err],	eax
		cmp	[esp+598h+err],	0
		jle	short loc_40570E
		mov	eax, [esp+598h+err]
		mov	[esp+598h+var_14], eax
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_40570E:				; CODE XREF: sub_4053E3+316j
		cmp	[esp+598h+err],	0
		jz	loc_405B7C
		mov	edx, offset aOption256 ; "OPTION %256[^\n]\n"
		lea	eax, [esp+598h+Src]
		lea	ecx, [esp+598h+var_565]
		mov	[esp+598h+Count], ecx
		mov	[esp+598h+Str2], edx ; Format
		mov	[esp+598h+Str1], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_405B80
		mov	[esp+598h+var_38], 0
		lea	eax, [esp+598h+var_565]
		mov	[esp+598h+var_3C], eax
		mov	[esp+598h+var_465], 0
		mov	[esp+598h+Count], 3 ; MaxCount
		mov	[esp+598h+Str2], offset	aNo ; "no-"
		lea	eax, [esp+598h+var_565]
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_40579E
		mov	[esp+598h+var_38], 1
		lea	eax, [esp+598h+var_565]
		add	eax, 3
		mov	[esp+598h+var_3C], eax

loc_40579E:				; CODE XREF: sub_4053E3+3A0j
		mov	[esp+598h+Count], 3 ; MaxCount
		mov	[esp+598h+Str2], offset	aTls ; "tls"
		mov	eax, [esp+598h+var_3C]
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	loc_4058EB
		cmp	[esp+598h+var_38], 0
		jz	short loc_4057E1
		mov	[esp+598h+var_28], 0
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_4057E1:				; CODE XREF: sub_4053E3+3ECj
		mov	eax, [esp+598h+var_3C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	loc_4058C6
		mov	eax, [esp+598h+var_3C]
		add	eax, 4
		mov	[esp+598h+Str2], offset	aNo_0 ;	"no"
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_405826
		mov	[esp+598h+var_28], 0
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_405826:				; CODE XREF: sub_4053E3+431j
		mov	eax, [esp+598h+var_3C]
		add	eax, 4
		mov	[esp+598h+Str2], offset	aTry ; "try"
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_405856
		mov	[esp+598h+var_28], 1
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_405856:				; CODE XREF: sub_4053E3+461j
		mov	eax, [esp+598h+var_3C]
		add	eax, 4
		mov	[esp+598h+Str2], offset	aWarn ;	"warn"
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_405886
		mov	[esp+598h+var_28], 2
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_405886:				; CODE XREF: sub_4053E3+491j
		mov	eax, [esp+598h+var_3C]
		add	eax, 4
		mov	[esp+598h+Str2], offset	aRequire ; "require"
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_4058B6
		mov	[esp+598h+var_28], 3
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_4058B6:				; CODE XREF: sub_4053E3+4C1j
		mov	[esp+598h+var_28], 1
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_4058C6:				; CODE XREF: sub_4053E3+40Dj
		mov	eax, [esp+598h+var_3C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_405B7F
		mov	[esp+598h+var_28], 1
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_4058EB:				; CODE XREF: sub_4053E3+3DEj
		mov	[esp+598h+Count], 6 ; MaxCount
		mov	[esp+598h+Str2], offset	aBasedn	; "basedn"
		mov	eax, [esp+598h+var_3C]
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	loc_4059C2
		cmp	[esp+598h+var_38], 0
		jz	short loc_40593A
		mov	eax, ds:Source
		mov	[esp+598h+Str1], eax ; Memory
		call	free
		mov	ds:Source, 0
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_40593A:				; CODE XREF: sub_4053E3+539j
		mov	eax, [esp+598h+var_3C]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	loc_405B7F
		mov	eax, ds:Source
		mov	[esp+598h+Str1], eax ; Memory
		call	free
		mov	eax, [esp+598h+var_3C]
		add	eax, 7
		mov	[esp+598h+Str1], eax ; Src
		call	_strdup
		mov	ds:Source, eax
		mov	eax, ds:Source
		test	eax, eax
		jnz	short loc_4059B3
		mov	edx, ds:File
		mov	eax, offset aGpgkeysOutOf_1 ; "gpgkeys:	out of memory while creating b"...
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 2Eh ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite
		mov	[esp+598h+var_14], 5
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_4059B3:				; CODE XREF: sub_4053E3+597j
		mov	ds:dword_413020, 1
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_4059C2:				; CODE XREF: sub_4053E3+52Bj
		mov	[esp+598h+Count], 6 ; MaxCount
		mov	[esp+598h+Str2], offset	aBinddn	; "binddn"
		mov	eax, [esp+598h+var_3C]
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	loc_405AA1
		cmp	[esp+598h+var_38], 0
		jz	short loc_405A14
		mov	eax, [esp+598h+Memory]
		mov	[esp+598h+Str1], eax ; Memory
		call	free
		mov	[esp+598h+Memory], 0
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_405A14:				; CODE XREF: sub_4053E3+610j
		mov	eax, [esp+598h+var_3C]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	loc_405B7F
		mov	eax, [esp+598h+Memory]
		mov	[esp+598h+Str1], eax ; Memory
		call	free
		mov	eax, [esp+598h+var_3C]
		add	eax, 7
		mov	[esp+598h+Str1], eax ; Src
		call	_strdup
		mov	[esp+598h+Memory], eax
		cmp	[esp+598h+Memory], 0
		jnz	short loc_405A92
		mov	edx, ds:File
		mov	eax, offset aGpgkeysOutOf_2 ; "gpgkeys:	out of memory while creating b"...
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 2Eh ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite
		mov	[esp+598h+var_14], 5
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_405A92:				; CODE XREF: sub_4053E3+676j
		mov	ds:dword_413020, 1
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_405AA1:				; CODE XREF: sub_4053E3+602j
		mov	[esp+598h+Count], 6 ; MaxCount
		mov	[esp+598h+Str2], offset	aBindpw	; "bindpw"
		mov	eax, [esp+598h+var_3C]
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	loc_405B7F
		cmp	[esp+598h+var_38], 0
		jz	short loc_405AF3
		mov	eax, [esp+598h+passwd]
		mov	[esp+598h+Str1], eax ; Memory
		call	free
		mov	[esp+598h+passwd], 0
		jmp	loc_405B7F
; ---------------------------------------------------------------------------

loc_405AF3:				; CODE XREF: sub_4053E3+6EFj
		mov	eax, [esp+598h+var_3C]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_405B7F
		mov	eax, [esp+598h+passwd]
		mov	[esp+598h+Str1], eax ; Memory
		call	free
		mov	eax, [esp+598h+var_3C]
		add	eax, 7
		mov	[esp+598h+Str1], eax ; Src
		call	_strdup
		mov	[esp+598h+passwd], eax
		cmp	[esp+598h+passwd], 0
		jnz	short loc_405B6D
		mov	edx, ds:File
		mov	eax, offset aGpgkeysOutOf_3 ; "gpgkeys:	out of memory while creating b"...
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 34h ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite
		mov	[esp+598h+var_14], 5
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_405B6D:				; CODE XREF: sub_4053E3+751j
		mov	ds:dword_413020, 1
		jmp	short loc_405B7F
; ---------------------------------------------------------------------------

loc_405B79:				; CODE XREF: sub_4053E3+2CFj
		nop
		jmp	short loc_405B80
; ---------------------------------------------------------------------------

loc_405B7C:				; CODE XREF: sub_4053E3+333j
		nop
		jmp	short loc_405B80
; ---------------------------------------------------------------------------

loc_405B7F:				; CODE XREF: sub_4053E3+3F9j
					; sub_4053E3+43Ej ...
		nop

loc_405B80:				; CODE XREF: sub_4053E3+35Cj
					; sub_4053E3+797j ...
		mov	eax, ds:dword_413028
		mov	[esp+598h+Count], eax ;	File
		mov	[esp+598h+Str2], 408h ;	MaxCount
		lea	eax, [esp+598h+Src]
		mov	[esp+598h+Str1], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_4056C2
		jmp	short loc_405BAB
; ---------------------------------------------------------------------------

loc_405BAA:				; CODE XREF: sub_4053E3+2E9j
		nop

loc_405BAB:				; CODE XREF: sub_4053E3+7C5j
		mov	eax, ds:dword_413038
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_405BEE
		mov	edx, ds:File
		mov	eax, offset aGpgkeysNoSchem ; "gpgkeys:	no scheme supplied!\n"
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 1Dh ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite
		mov	[esp+598h+var_14], 7Fh
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_405BEE:				; CODE XREF: sub_4053E3+7D2j
		mov	eax, ds:dword_413038
		mov	eax, [eax+0Ch]
		mov	[esp+598h+Str2], offset	aLdaps ; "ldaps"
		mov	[esp+598h+Str1], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_405C22
		mov	[esp+598h+PortNumber], 27Ch
		mov	[esp+598h+var_24], 1

loc_405C22:				; CODE XREF: sub_4053E3+827j
		mov	eax, ds:dword_413038
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_405C45
		mov	eax, ds:dword_413038
		mov	eax, [eax+8]
		mov	[esp+598h+Str1], eax ; Str
		call	atoi
		mov	[esp+598h+PortNumber], eax

loc_405C45:				; CODE XREF: sub_4053E3+849j
		mov	eax, ds:dword_413038
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_405C7D
		mov	edx, ds:File
		mov	eax, offset aGpgkeysNoKeyse ; "gpgkeys:	no keyserver host provided\n"
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 24h ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_405C7D:				; CODE XREF: sub_4053E3+86Cj
		mov	eax, ds:dword_413038
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_405CC4
		call	sub_4068AA
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_405CC4
		mov	edx, ds:File
		mov	eax, offset aGpgkeysUnabl_3 ; "gpgkeys:	unable to register timeout han"...
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 2Ch ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite
		mov	eax, 1
		jmp	loc_406821
; ---------------------------------------------------------------------------

loc_405CC4:				; CODE XREF: sub_4053E3+8A4j
					; sub_4053E3+8AEj
		cmp	[esp+598h+var_24], 0
		jz	short loc_405CD9
		mov	[esp+598h+var_28], 0

loc_405CD9:				; CODE XREF: sub_4053E3+8E9j
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_405D1F
		nop

loc_405CE6:				; CODE XREF: sub_4053E3+935j
		mov	eax, ds:dword_413028
		mov	[esp+598h+Count], eax ;	File
		mov	[esp+598h+Str2], 408h ;	MaxCount
		lea	eax, [esp+598h+Src]
		mov	[esp+598h+Str1], eax ; Buf
		call	fgets
		test	eax, eax
		jz	loc_405EB2
		movzx	eax, [esp+598h+Src]
		cmp	al, 0Ah
		jnz	short loc_405CE6
		jmp	loc_405EB2
; ---------------------------------------------------------------------------

loc_405D1F:				; CODE XREF: sub_4053E3+900j
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_405D47
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_405D47
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		cmp	eax, 4
		jnz	loc_405E85

loc_405D47:				; CODE XREF: sub_4053E3+946j
					; sub_4053E3+952j ...
		mov	eax, ds:dword_413028
		mov	[esp+598h+Count], eax ;	File
		mov	[esp+598h+Str2], 408h ;	MaxCount
		lea	eax, [esp+598h+Src]
		mov	[esp+598h+Str1], eax ; Buf
		call	fgets
		test	eax, eax
		jz	loc_405E82
		movzx	eax, [esp+598h+Src]
		cmp	al, 0Ah
		jz	loc_405EB1
		movzx	eax, [esp+598h+Src]
		test	al, al
		jz	loc_405EB1
		mov	[esp+598h+Str1], 40Ch ;	Size
		call	malloc
		mov	[esp+598h+Dest], eax
		cmp	[esp+598h+Dest], 0
		jnz	short loc_405DE3
		mov	edx, ds:File
		mov	eax, offset aGpgkeysOutOf_4 ; "gpgkeys:	out of memory while building k"...
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 2Fh ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite
		mov	[esp+598h+var_14], 5
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_405DE3:				; CODE XREF: sub_4053E3+9C7j
		lea	edx, [esp+598h+Src]
		mov	eax, [esp+598h+Dest]
		mov	[esp+598h+Str2], edx ; Source
		mov	[esp+598h+Str1], eax ; Dest
		call	strcpy
		lea	eax, [esp+598h+Src]
		mov	[esp+598h+var_56C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+598h+var_56C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		lea	edx, [eax-1]
		mov	eax, [esp+598h+Dest]
		mov	byte ptr [eax+edx], 0
		mov	eax, [esp+598h+Dest]
		mov	dword ptr [eax+408h], 0
		cmp	[esp+598h+var_30], 0
		jnz	short loc_405E5B
		mov	eax, [esp+598h+Dest]
		mov	[esp+598h+var_30], eax
		jmp	short loc_405E6F
; ---------------------------------------------------------------------------

loc_405E5B:				; CODE XREF: sub_4053E3+A66j
		mov	eax, [esp+598h+var_34]
		mov	edx, [esp+598h+Dest]
		mov	[eax+408h], edx

loc_405E6F:				; CODE XREF: sub_4053E3+A76j
		mov	eax, [esp+598h+Dest]
		mov	[esp+598h+var_34], eax
		jmp	loc_405D47
; ---------------------------------------------------------------------------

loc_405E82:				; CODE XREF: sub_4053E3+986j
		nop
		jmp	short loc_405EB1
; ---------------------------------------------------------------------------

loc_405E85:				; CODE XREF: sub_4053E3+95Ej
		mov	edx, ds:File
		mov	eax, offset aGpgkeysNoKey_0 ; "gpgkeys:	no keyserver command specified"...
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 28h ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_405EB1:				; CODE XREF: sub_4053E3+996j
					; sub_4053E3+9A6j ...
		nop

loc_405EB2:				; CODE XREF: sub_4053E3+925j
					; sub_4053E3+937j
		mov	edx, offset aVersionD ;	"VERSION %d\n"
		mov	eax, ds:dword_41302C
		mov	[esp+598h+Count], 1
		mov	[esp+598h+Str2], edx ; Format
		mov	[esp+598h+Str1], eax ; File
		call	fprintf
		mov	edx, offset aProgramS ;	"PROGRAM %s\n\n"
		mov	eax, ds:dword_41302C
		mov	[esp+598h+Count], offset a2_0_30 ; "2.0.30"
		mov	[esp+598h+Str2], edx ; Format
		mov	[esp+598h+Str1], eax ; File
		call	fprintf
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 1
		jbe	short loc_405F72
		mov	eax, ds:dword_413038
		mov	ecx, [eax+4]
		mov	edx, offset aHostS ; "Host:\t\t%s\n"
		mov	eax, ds:File
		mov	[esp+598h+Count], ecx
		mov	[esp+598h+Str2], edx ; Format
		mov	[esp+598h+Str1], eax ; File
		call	fprintf
		cmp	[esp+598h+PortNumber], 0
		jz	short loc_405F48
		mov	edx, offset aPortD ; "Port:\t\t%d\n"
		mov	eax, ds:File
		mov	ecx, [esp+598h+PortNumber]
		mov	[esp+598h+Count], ecx
		mov	[esp+598h+Str2], edx ; Format
		mov	[esp+598h+Str1], eax ; File
		call	fprintf

loc_405F48:				; CODE XREF: sub_4053E3+B42j
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		mov	[esp+598h+Str1], eax
		call	sub_407100
		mov	ecx, offset aCommandS ;	"Command:\t%s\n"
		mov	edx, ds:File
		mov	[esp+598h+Count], eax
		mov	[esp+598h+Str2], ecx ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf

loc_405F72:				; CODE XREF: sub_4053E3+B16j
		mov	eax, ds:dword_413038
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_405FA5
		mov	edx, ds:File
		mov	eax, offset aGpgkeysNotBuil ; "gpgkeys:	not built with debugging suppo"...
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 2Ah ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite

loc_405FA5:				; CODE XREF: sub_4053E3+B99j
		mov	eax, ds:dword_413038
		mov	eax, [eax+28h]
		mov	[esp+598h+Str1], eax
		call	sub_4068A0
		mov	edx, [esp+598h+PortNumber]
		mov	eax, ds:dword_413038
		mov	eax, [eax+4]
		mov	[esp+598h+Str2], edx ; PortNumber
		mov	[esp+598h+Str1], eax ; HostName
		mov	eax, ds:ldap_init
		call	eax ; ldap_init
		mov	ds:ld, eax
		mov	eax, ds:ld
		test	eax, eax
		jnz	short loc_406028
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+598h+Str1], eax ; int
		call	strerror
		mov	ecx, offset aGpgkeysInterna ; "gpgkeys:	internal LDAP init error: %s\n"
		mov	edx, ds:File
		mov	[esp+598h+Count], eax
		mov	[esp+598h+Str2], ecx ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf
		mov	[esp+598h+Str2], 1
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+Str1], eax
		call	sub_404DE1
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_406028:				; CODE XREF: sub_4053E3+BFBj
		cmp	[esp+598h+var_24], 0
		jz	short loc_40606C
		mov	edx, offset aGpgkeysUnabl_4 ; "gpgkeys:	unable to make SSL connection:"...
		mov	eax, ds:File
		mov	[esp+598h+Count], offset aNotBuiltWithLd ; "not	built with LDAPS support"
		mov	[esp+598h+Str2], edx ; Format
		mov	[esp+598h+Str1], eax ; File
		call	fprintf
		mov	[esp+598h+Str2], 1
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+Str1], eax
		call	sub_404DE1
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_40606C:				; CODE XREF: sub_4053E3+C4Dj
		mov	eax, ds:Source
		test	eax, eax
		jnz	loc_4060FC
		call	sub_404EB8
		mov	[esp+598h+err],	eax
		cmp	[esp+598h+err],	0
		jnz	short loc_406098
		mov	eax, ds:Source
		test	eax, eax
		jnz	short loc_4060FC

loc_406098:				; CODE XREF: sub_4053E3+CAAj
		cmp	[esp+598h+err],	0
		jz	short loc_4060B5
		mov	eax, [esp+598h+err]
		mov	[esp+598h+Str1], eax ; err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		jmp	short loc_4060BA
; ---------------------------------------------------------------------------

loc_4060B5:				; CODE XREF: sub_4053E3+CBDj
		mov	eax, offset aNotFound ;	"not found"

loc_4060BA:				; CODE XREF: sub_4053E3+CD0j
		mov	ecx, offset aGpgkeysUnabl_5 ; "gpgkeys:	unable to retrieve LDAP	base: "...
		mov	edx, ds:File
		mov	[esp+598h+Count], eax
		mov	[esp+598h+Str2], ecx ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf
		mov	eax, [esp+598h+err]
		mov	[esp+598h+Str1], eax
		call	sub_4015C8
		mov	[esp+598h+Str2], eax
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+Str1], eax
		call	sub_404DE1
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_4060FC:				; CODE XREF: sub_4053E3+C90j
					; sub_4053E3+CB3j
		cmp	[esp+598h+var_28], 0
		jz	loc_40628B
		mov	eax, ds:dword_413020
		test	eax, eax
		jnz	short loc_406165
		cmp	[esp+598h+var_28], 1
		jle	short loc_40613B
		mov	edx, offset aGpgkeysUnabl_6 ; "gpgkeys:	unable to start	TLS: %s\n"
		mov	eax, ds:File
		mov	[esp+598h+Count], offset aNotSupportedBy ; "not	supported by the NAI LDAP keyserver"
		mov	[esp+598h+Str2], edx ; Format
		mov	[esp+598h+Str1], eax ; File
		call	fprintf

loc_40613B:				; CODE XREF: sub_4053E3+D38j
		cmp	[esp+598h+var_28], 3
		jnz	loc_40628B
		mov	[esp+598h+Str2], 1
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+Str1], eax
		call	sub_404DE1
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_406165:				; CODE XREF: sub_4053E3+D2Ej
		mov	[esp+598h+invalue], 3
		mov	eax, ds:ld
		lea	edx, [esp+598h+invalue]
		mov	[esp+598h+Count], edx ;	invalue
		mov	[esp+598h+Str2], 11h ; option
		mov	[esp+598h+Str1], eax ; ld
		mov	eax, ds:ldap_set_option
		call	eax ; ldap_set_option
		mov	[esp+598h+err],	eax
		cmp	[esp+598h+err],	0
		jnz	short loc_4061D9
		mov	eax, ds:ld
		mov	[esp+598h+ClientControls], 0 ; ClientControls
		mov	[esp+598h+File], 0 ; ServerControls
		mov	[esp+598h+Count], 0 ; result
		mov	[esp+598h+Str2], 0 ; ServerReturnValue
		mov	[esp+598h+Str1], eax ; ExternalHandle
		mov	eax, ds:ldap_start_tls_sA
		call	eax ; ldap_start_tls_sA
		mov	[esp+598h+err],	eax

loc_4061D9:				; CODE XREF: sub_4053E3+DBEj
		cmp	[esp+598h+err],	0
		jz	short loc_406257
		cmp	[esp+598h+var_28], 1
		jg	short loc_4061FA
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_406226

loc_4061FA:				; CODE XREF: sub_4053E3+E08j
		mov	eax, [esp+598h+err]
		mov	[esp+598h+Str1], eax ; err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		mov	ecx, offset aGpgkeysUnabl_6 ; "gpgkeys:	unable to start	TLS: %s\n"
		mov	edx, ds:File
		mov	[esp+598h+Count], eax
		mov	[esp+598h+Str2], ecx ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf

loc_406226:				; CODE XREF: sub_4053E3+E15j
		cmp	[esp+598h+var_28], 3
		jnz	short loc_40628B
		mov	eax, [esp+598h+err]
		mov	[esp+598h+Str1], eax
		call	sub_4015C8
		mov	[esp+598h+Str2], eax
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+Str1], eax
		call	sub_404DE1
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_406257:				; CODE XREF: sub_4053E3+DFEj
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 1
		jbe	short loc_40628B
		mov	edx, ds:File
		mov	eax, offset aGpgkeysTlsStar ; "gpgkeys:	TLS started successfully.\n"
		mov	[esp+598h+File], edx ; File
		mov	[esp+598h+Count], 23h ;	Count
		mov	[esp+598h+Str2], 1 ; Size
		mov	[esp+598h+Str1], eax ; Str
		call	fwrite

loc_40628B:				; CODE XREF: sub_4053E3+D21j
					; sub_4053E3+D60j ...
		cmp	[esp+598h+Memory], 0
		jz	loc_406407
		mov	[esp+598h+var_460], 3
		mov	eax, ds:ld
		lea	edx, [esp+598h+var_460]
		mov	[esp+598h+Count], edx ;	invalue
		mov	[esp+598h+Str2], 11h ; option
		mov	[esp+598h+Str1], eax ; ld
		mov	eax, ds:ldap_set_option
		call	eax ; ldap_set_option
		mov	[esp+598h+err],	eax
		cmp	[esp+598h+err],	0
		jz	short loc_40632A
		mov	eax, [esp+598h+err]
		mov	[esp+598h+Str1], eax ; err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		mov	ecx, offset aGpgkeysUnabl_7 ; "gpgkeys:	unable to go to	LDAP 3:	%s\n"
		mov	edx, ds:File
		mov	[esp+598h+Count], eax
		mov	[esp+598h+Str2], ecx ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf
		mov	eax, [esp+598h+err]
		mov	[esp+598h+Str1], eax
		call	sub_4015C8
		mov	[esp+598h+Str2], eax
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+Str1], eax
		call	sub_404DE1
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_40632A:				; CODE XREF: sub_4053E3+EF2j
		mov	eax, ds:dword_413038
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	short loc_406373
		cmp	[esp+598h+passwd], 0
		jz	short loc_406348
		mov	eax, offset aNotShown ;	">not shown<"
		jmp	short loc_40634D
; ---------------------------------------------------------------------------

loc_406348:				; CODE XREF: sub_4053E3+F5Cj
		mov	eax, offset aNone ; ">none<"

loc_40634D:				; CODE XREF: sub_4053E3+F63j
		mov	ecx, offset aGpgkeysLdapBin ; "gpgkeys:	LDAP bind to %s, pw %s\n"
		mov	edx, ds:File
		mov	[esp+598h+File], eax
		mov	eax, [esp+598h+Memory]
		mov	[esp+598h+Count], eax
		mov	[esp+598h+Str2], ecx ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf

loc_406373:				; CODE XREF: sub_4053E3+F52j
		mov	eax, ds:ld
		mov	edx, [esp+598h+passwd]
		mov	[esp+598h+Count], edx ;	passwd
		mov	edx, [esp+598h+Memory]
		mov	[esp+598h+Str2], edx ; dn
		mov	[esp+598h+Str1], eax ; ld
		mov	eax, ds:ldap_simple_bind_s
		call	eax ; ldap_simple_bind_s
		mov	[esp+598h+err],	eax
		cmp	[esp+598h+err],	0
		jz	short loc_4063FC
		mov	eax, [esp+598h+err]
		mov	[esp+598h+Str1], eax ; err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		mov	ecx, offset aGpgkeysInter_0 ; "gpgkeys:	internal LDAP bind error: %s\n"
		mov	edx, ds:File
		mov	[esp+598h+Count], eax
		mov	[esp+598h+Str2], ecx ; Format
		mov	[esp+598h+Str1], edx ; File
		call	fprintf
		mov	eax, [esp+598h+err]
		mov	[esp+598h+Str1], eax
		call	sub_4015C8
		mov	[esp+598h+Str2], eax
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+Str1], eax
		call	sub_404DE1
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_4063FC:				; CODE XREF: sub_4053E3+FC4j
		mov	[esp+598h+var_2C], 1

loc_406407:				; CODE XREF: sub_4053E3+EB0j
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_406471
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+var_34], eax
		jmp	short loc_406462
; ---------------------------------------------------------------------------

loc_406423:				; CODE XREF: sub_4053E3+1087j
		mov	eax, ds:dword_413038
		mov	eax, [eax+28h]
		mov	[esp+598h+Str1], eax
		call	sub_4068A0
		mov	eax, [esp+598h+var_34]
		mov	[esp+598h+Str1], eax
		call	sub_4033A7
		test	eax, eax
		jz	short loc_40644E
		add	[esp+598h+var_20], 1

loc_40644E:				; CODE XREF: sub_4053E3+1061j
		mov	eax, [esp+598h+var_34]
		mov	eax, [eax+408h]
		mov	[esp+598h+var_34], eax

loc_406462:				; CODE XREF: sub_4053E3+103Ej
		cmp	[esp+598h+var_34], 0
		jnz	short loc_406423
		jmp	loc_406750
; ---------------------------------------------------------------------------

loc_406471:				; CODE XREF: sub_4053E3+102Ej
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_4064DB
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+var_34], eax
		jmp	short loc_4064CC
; ---------------------------------------------------------------------------

loc_40648D:				; CODE XREF: sub_4053E3+10F1j
		mov	eax, ds:dword_413038
		mov	eax, [eax+28h]
		mov	[esp+598h+Str1], eax
		call	sub_4068A0
		mov	eax, [esp+598h+var_34]
		mov	[esp+598h+Str1], eax
		call	sub_403A3F
		test	eax, eax
		jz	short loc_4064B8
		add	[esp+598h+var_20], 1

loc_4064B8:				; CODE XREF: sub_4053E3+10CBj
		mov	eax, [esp+598h+var_34]
		mov	eax, [eax+408h]
		mov	[esp+598h+var_34], eax

loc_4064CC:				; CODE XREF: sub_4053E3+10A8j
		cmp	[esp+598h+var_34], 0
		jnz	short loc_40648D
		jmp	loc_406750
; ---------------------------------------------------------------------------

loc_4064DB:				; CODE XREF: sub_4053E3+1098j
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_406553
		mov	[esp+598h+var_464], 0

loc_4064F2:				; CODE XREF: sub_4053E3+1169j
		mov	eax, ds:dword_413038
		mov	eax, [eax+28h]
		mov	[esp+598h+Str1], eax
		call	sub_4068A0
		mov	eax, ds:dword_413020
		test	eax, eax
		jz	short loc_406528
		lea	eax, [esp+598h+var_464]
		mov	[esp+598h+Str1], eax
		call	sub_40230E
		test	eax, eax
		jz	short loc_406543
		add	[esp+598h+var_20], 1
		jmp	short loc_406543
; ---------------------------------------------------------------------------

loc_406528:				; CODE XREF: sub_4053E3+1126j
		lea	eax, [esp+598h+var_464]
		mov	[esp+598h+Str1], eax
		call	sub_402B94
		test	eax, eax
		jz	short loc_406543
		add	[esp+598h+var_20], 1

loc_406543:				; CODE XREF: sub_4053E3+1139j
					; sub_4053E3+1143j ...
		mov	eax, [esp+598h+var_464]
		test	eax, eax
		jz	short loc_4064F2
		jmp	loc_406750
; ---------------------------------------------------------------------------

loc_406553:				; CODE XREF: sub_4053E3+1102j
		mov	eax, ds:dword_413038
		mov	eax, [eax]
		cmp	eax, 4
		jnz	loc_406734
		mov	[esp+598h+Source], 0
		mov	[esp+598h+var_40], 0
		mov	eax, ds:dword_413038
		mov	eax, [eax+28h]
		mov	[esp+598h+Str1], eax
		call	sub_4068A0
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+var_34], eax
		jmp	short loc_4065E5
; ---------------------------------------------------------------------------

loc_406599:				; CODE XREF: sub_4053E3+120Aj
		mov	eax, [esp+598h+var_34]
		mov	[esp+598h+var_56C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+598h+var_56C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [esp+598h+var_40]
		add	eax, edx
		add	eax, 1
		mov	[esp+598h+var_40], eax
		mov	eax, [esp+598h+var_34]
		mov	eax, [eax+408h]
		mov	[esp+598h+var_34], eax

loc_4065E5:				; CODE XREF: sub_4053E3+11B4j
		cmp	[esp+598h+var_34], 0
		jnz	short loc_406599
		mov	edx, [esp+598h+var_40]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		add	eax, 1
		mov	[esp+598h+Str1], eax ; Size
		call	malloc
		mov	[esp+598h+Source], eax
		cmp	[esp+598h+Source], 0
		jnz	short loc_40663F
		mov	[esp+598h+var_14], 5
		mov	[esp+598h+Str2], 5
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+Str1], eax
		call	sub_404DE1
		jmp	loc_406767
; ---------------------------------------------------------------------------

loc_40663F:				; CODE XREF: sub_4053E3+1233j
		mov	eax, [esp+598h+Source]
		mov	byte ptr [eax],	0
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+var_34], eax
		jmp	short loc_4066BE
; ---------------------------------------------------------------------------

loc_406659:				; CODE XREF: sub_4053E3+12E3j
		mov	eax, [esp+598h+var_34]
		mov	[esp+598h+Str2], eax ; int
		mov	eax, [esp+598h+Source]
		mov	[esp+598h+Str1], eax ; Dest
		call	sub_4039A7
		mov	ebx, 410638h
		mov	eax, [esp+598h+Source]
		mov	[esp+598h+var_56C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+598h+var_56C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [esp+598h+Source]
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		mov	eax, [esp+598h+var_34]
		mov	eax, [eax+408h]
		mov	[esp+598h+var_34], eax

loc_4066BE:				; CODE XREF: sub_4053E3+1274j
		cmp	[esp+598h+var_34], 0
		jnz	short loc_406659
		mov	eax, [esp+598h+Source]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406708
		mov	eax, [esp+598h+Source]
		mov	[esp+598h+var_56C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+598h+var_56C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [esp+598h+Source]
		mov	byte ptr [eax],	0

loc_406708:				; CODE XREF: sub_4053E3+12F1j
		mov	eax, [esp+598h+Source]
		mov	[esp+598h+Str1], eax ; Source
		call	sub_404077
		test	eax, eax
		jz	short loc_406723
		add	[esp+598h+var_20], 1

loc_406723:				; CODE XREF: sub_4053E3+1336j
		mov	eax, [esp+598h+Source]
		mov	[esp+598h+Str1], eax ; Memory
		call	free
		jmp	short loc_406750
; ---------------------------------------------------------------------------

loc_406734:				; CODE XREF: sub_4053E3+117Aj
		mov	[esp+598h+Count], 93Eh ; int
		mov	[esp+598h+Str2], offset	a____Gnupg22_0_	; "../../gnupg2-2.0.30/keyserver/gpgkeys_l"...
		mov	[esp+598h+Str1], offset	aBadAction ; "!\"bad action\""
		call	sub_40ED10

loc_406750:				; CODE XREF: sub_4053E3+1089j
					; sub_4053E3+10F3j ...
		cmp	[esp+598h+var_20], 0
		jnz	short loc_40679A
		mov	[esp+598h+var_14], 0
		jmp	short loc_40679A
; ---------------------------------------------------------------------------

loc_406767:				; CODE XREF: sub_4053E3+326j
					; sub_4053E3+5CBj ...
		jmp	short loc_40679A
; ---------------------------------------------------------------------------

loc_406769:				; CODE XREF: sub_4053E3+13BFj
		mov	eax, [esp+598h+var_30]
		mov	[esp+598h+var_50], eax
		mov	eax, [esp+598h+var_30]
		mov	eax, [eax+408h]
		mov	[esp+598h+var_30], eax
		mov	eax, [esp+598h+var_50]
		mov	[esp+598h+Str1], eax ; Memory
		call	free

loc_40679A:				; CODE XREF: sub_4053E3+1375j
					; sub_4053E3+1382j ...
		cmp	[esp+598h+var_30], 0
		jnz	short loc_406769
		mov	edx, ds:dword_413028
		mov	eax, ds:_iob
		cmp	edx, eax
		jz	short loc_4067C0
		mov	eax, ds:dword_413028
		mov	[esp+598h+Str1], eax ; File
		call	fclose

loc_4067C0:				; CODE XREF: sub_4053E3+13CEj
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:dword_41302C
		cmp	edx, eax
		jz	short loc_4067DE
		mov	eax, ds:dword_41302C
		mov	[esp+598h+Str1], eax ; File
		call	fclose

loc_4067DE:				; CODE XREF: sub_4053E3+13ECj
		mov	eax, ds:dword_413038
		mov	[esp+598h+Str1], eax ; void *
		call	sub_40697A
		mov	eax, ds:ld
		test	eax, eax
		jz	short loc_40680D
		cmp	[esp+598h+var_2C], 0
		jz	short loc_40680D
		mov	eax, ds:ld
		mov	[esp+598h+Str1], eax ; ld
		mov	eax, ds:ldap_unbind_s
		call	eax ; ldap_unbind_s

loc_40680D:				; CODE XREF: sub_4053E3+140Fj
					; sub_4053E3+1419j
		mov	eax, ds:Source
		mov	[esp+598h+Str1], eax ; Memory
		call	free
		mov	eax, [esp+598h+var_14]

loc_406821:				; CODE XREF: sub_4053E3+DEj
					; sub_4053E3+122j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4053E3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4068A0	proc near		; CODE XREF: sub_4053E3+BCDp
					; sub_4053E3+104Bp ...
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_4068A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4068AA	proc near		; CODE XREF: sub_4053E3+8A6p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_4068AA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_413040
		test	eax, eax
		jnz	short locret_4068E6
		mov	dword ptr [esp+4], offset dword_413060
		mov	dword ptr [esp], 202h
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		mov	ds:dword_413040, 1

locret_4068E6:				; CODE XREF: .text:004068C1j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4068E8	proc near		; CODE XREF: sub_4053E3:loc_4056A1p

NumOfElements	= dword	ptr -28h
SizeOfElements	= dword	ptr -24h
Memory		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+SizeOfElements], 30h ;	SizeOfElements
		mov	[esp+28h+NumOfElements], 1 ; NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jz	short loc_406975
		mov	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 2
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 4
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 8
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		mov	dword ptr [eax+28h], 78h
		mov	[esp+28h+NumOfElements], offset	Src ; "/"
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+Memory]
		mov	[eax+14h], edx
		mov	eax, [ebp+Memory]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_406975
		mov	eax, [ebp+Memory]
		mov	[esp+28h+NumOfElements], eax ; Memory
		call	free
		mov	[ebp+Memory], 0

loc_406975:				; CODE XREF: sub_4068E8+21j
					; sub_4068E8+79j
		mov	eax, [ebp+Memory]
		leave
		retn
sub_4068E8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40697A(void *)
sub_40697A	proc near		; CODE XREF: sub_4053E3+1403p

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_4069F3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_4069F3:				; CODE XREF: sub_40697A+Aj
		leave
		retn
sub_40697A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4069F5(char *, int)
sub_4069F5	proc near		; CODE XREF: sub_4053E3+302p

Src		= dword	ptr -0A28h
Format		= dword	ptr -0A24h
MaxCount	= dword	ptr -0A20h
var_A11		= byte ptr -0A11h
var_911		= byte ptr -911h
var_910		= byte ptr -910h
var_510		= byte ptr -510h
var_50F		= byte ptr -50Fh
var_10F		= byte ptr -10Fh
var_10E		= byte ptr -10Eh
var_8E		= byte ptr -8Eh
var_8D		= byte ptr -8Dh
var_79		= byte ptr -79h
var_78		= byte ptr -78h
var_6E		= byte ptr -6Eh
var_6D		= byte ptr -6Dh
var_1D		= byte ptr -1Dh
Str1		= byte ptr -1Ch
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0A28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jnz	short loc_406A12
		mov	eax, 0
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406A12:				; CODE XREF: sub_4069F5+11j
		mov	edx, offset aCommand7s ; "COMMAND %7s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+Str1]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_406AD2
		mov	[ebp+var_15], 0
		mov	[esp+0A28h+Format], offset aGet	; "get"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_406A5E
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1
		jmp	short loc_406AC8
; ---------------------------------------------------------------------------

loc_406A5E:				; CODE XREF: sub_4069F5+5Cj
		mov	[esp+0A28h+Format], offset aGetname ; "getname"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_406A82
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 2
		jmp	short loc_406AC8
; ---------------------------------------------------------------------------

loc_406A82:				; CODE XREF: sub_4069F5+80j
		mov	[esp+0A28h+Format], offset aSend ; "send"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_406AA6
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 3
		jmp	short loc_406AC8
; ---------------------------------------------------------------------------

loc_406AA6:				; CODE XREF: sub_4069F5+A4j
		mov	[esp+0A28h+Format], offset aSearch_0 ; "search"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_406AC8
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 4

loc_406AC8:				; CODE XREF: sub_4069F5+67j
					; sub_4069F5+8Bj ...
		mov	eax, 0
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406AD2:				; CODE XREF: sub_4069F5+3Bj
		mov	edx, offset aHost80s ; "HOST %80s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_6D]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_406B35
		mov	[ebp+var_1D], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_6D]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_406B2B
		mov	eax, 5
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406B2B:				; CODE XREF: sub_4069F5+12Aj
		mov	eax, 0
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406B35:				; CODE XREF: sub_4069F5+FBj
		mov	edx, offset aPort10s ; "PORT %10s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_78]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_406B98
		mov	[ebp+var_6E], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_78]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_406B8E
		mov	eax, 5
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406B8E:				; CODE XREF: sub_4069F5+18Dj
		mov	eax, 0
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406B98:				; CODE XREF: sub_4069F5+15Ej
		mov	edx, offset aScheme20s ; "SCHEME %20s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_8D]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_406C01
		mov	[ebp+var_79], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_8D]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_406BF7
		mov	eax, 5
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406BF7:				; CODE XREF: sub_4069F5+1F6j
		mov	eax, 0
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406C01:				; CODE XREF: sub_4069F5+1C4j
		mov	edx, offset aAuth128s ;	"AUTH %128s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_10E]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_406C6D
		mov	[ebp+var_8E], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_10E]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_406C63
		mov	eax, 5
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406C63:				; CODE XREF: sub_4069F5+262j
		mov	eax, 0
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406C6D:				; CODE XREF: sub_4069F5+22Dj
		mov	edx, offset aPath1024s ; "PATH %1024s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_50F]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_406CD9
		mov	[ebp+var_10F], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_50F]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_406CCF
		mov	eax, 5
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406CCF:				; CODE XREF: sub_4069F5+2CEj
		mov	eax, 0
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406CD9:				; CODE XREF: sub_4069F5+299j
		mov	edx, offset aOpaque1024s ; "OPAQUE %1024s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_910]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_406D45
		mov	[ebp+var_510], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+18h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_910]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	short loc_406D3B
		mov	eax, 5
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406D3B:				; CODE XREF: sub_4069F5+33Aj
		mov	eax, 0
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406D45:				; CODE XREF: sub_4069F5+305j
		mov	edx, offset aVersionD_0	; "VERSION %d\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_14]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_406D81
		mov	eax, [ebp+var_14]
		cmp	eax, 1
		jz	short loc_406D77
		mov	eax, 3
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406D77:				; CODE XREF: sub_4069F5+376j
		mov	eax, 0
		jmp	locret_4070FE
; ---------------------------------------------------------------------------

loc_406D81:				; CODE XREF: sub_4069F5+36Ej
		mov	edx, offset aOption256_0 ; "OPTION %256[^\n]\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_A11]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_4070F9
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_A11]
		mov	[ebp+var_10], eax
		mov	[ebp+var_911], 0
		mov	[esp+0A28h+MaxCount], 3	; MaxCount
		mov	[esp+0A28h+Format], offset aNo_1 ; "no-"
		lea	eax, [ebp+var_A11]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_406DF6
		mov	[ebp+var_C], 1
		lea	eax, [ebp+var_A11]
		add	eax, 3
		mov	[ebp+var_10], eax

loc_406DF6:				; CODE XREF: sub_4069F5+3ECj
		mov	[esp+0A28h+MaxCount], 7	; MaxCount
		mov	[esp+0A28h+Format], offset aVerbose ; "verbose"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_406E68
		cmp	[ebp+var_C], 0
		jz	short loc_406E2C
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+20h], 0
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406E2C:				; CODE XREF: sub_4069F5+426j
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_406E54
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+20h], edx
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406E54:				; CODE XREF: sub_4069F5+442j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_4]
		mov	[eax+20h], edx
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406E68:				; CODE XREF: sub_4069F5+420j
		mov	[esp+0A28h+Format], offset aIncludeDisable ; "include-disabled"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_406EAB
		cmp	[ebp+var_C], 0
		jz	short loc_406E99
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+1Ch], dl
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406E99:				; CODE XREF: sub_4069F5+490j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 1
		mov	[eax+1Ch], dl
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406EAB:				; CODE XREF: sub_4069F5+48Aj
		mov	[esp+0A28h+Format], offset aIncludeRevoked ; "include-revoked"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_406EEE
		cmp	[ebp+var_C], 0
		jz	short loc_406EDC
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+1Ch], dl
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406EDC:				; CODE XREF: sub_4069F5+4D3j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 2
		mov	[eax+1Ch], dl
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406EEE:				; CODE XREF: sub_4069F5+4CDj
		mov	[esp+0A28h+Format], offset aIncludeSubkeys ; "include-subkeys"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_406F31
		cmp	[ebp+var_C], 0
		jz	short loc_406F1F
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFBh
		mov	[eax+1Ch], dl
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406F1F:				; CODE XREF: sub_4069F5+516j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 4
		mov	[eax+1Ch], dl
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406F31:				; CODE XREF: sub_4069F5+510j
		mov	[esp+0A28h+Format], offset aCheckCert ;	"check-cert"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_406F74
		cmp	[ebp+var_C], 0
		jz	short loc_406F62
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFF7h
		mov	[eax+1Ch], dl
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406F62:				; CODE XREF: sub_4069F5+559j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 8
		mov	[eax+1Ch], dl
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406F74:				; CODE XREF: sub_4069F5+553j
		mov	[esp+0A28h+MaxCount], 5	; MaxCount
		mov	[esp+0A28h+Format], offset aDebug ; "debug"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_406FF2
		cmp	[ebp+var_C], 0
		jz	short loc_406FAA
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+24h], 0
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406FAA:				; CODE XREF: sub_4069F5+5A4j
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_406FD2
		mov	eax, [ebp+var_10]
		add	eax, 6
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+24h], edx
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406FD2:				; CODE XREF: sub_4069F5+5C0j
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4070F9
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+24h], 1
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_406FF2:				; CODE XREF: sub_4069F5+59Ej
		mov	[esp+0A28h+MaxCount], 7	; MaxCount
		mov	[esp+0A28h+Format], offset aTimeout ; "timeout"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_407070
		cmp	[ebp+var_C], 0
		jz	short loc_407028
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+28h], 0
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_407028:				; CODE XREF: sub_4069F5+622j
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_407050
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+28h], edx
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_407050:				; CODE XREF: sub_4069F5+63Ej
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4070F9
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+28h], 78h
		jmp	loc_4070F9
; ---------------------------------------------------------------------------

loc_407070:				; CODE XREF: sub_4069F5+61Cj
		mov	[esp+0A28h+MaxCount], 0Ch ; MaxCount
		mov	[esp+0A28h+Format], offset aCaCertFile ; "ca-cert-file"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_4070F9
		cmp	[ebp+var_C], 0
		jz	short loc_4070B1
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+2Ch], 0
		jmp	short loc_4070F9
; ---------------------------------------------------------------------------

loc_4070B1:				; CODE XREF: sub_4069F5+6A0j
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_4070F9
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_10]
		add	eax, 0Dh
		mov	[esp+0A28h+Format], 0
		mov	[esp+0A28h+Src], eax
		call	sub_408757
		mov	edx, [ebp+arg_4]
		mov	[edx+2Ch], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	short loc_4070F9
		mov	eax, 5
		jmp	short locret_4070FE
; ---------------------------------------------------------------------------

loc_4070F9:				; CODE XREF: sub_4069F5+3ADj
					; sub_4069F5+432j ...
		mov	eax, 0FFFFFFFFh

locret_4070FE:				; CODE XREF: sub_4069F5+18j
					; sub_4069F5+D8j ...
		leave
		retn
sub_4069F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407100	proc near		; CODE XREF: sub_4053E3+B6Fp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 4	; switch 5 cases
		ja	short loc_40713B ; jumptable 00407116 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_410E30
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407118:				; CODE XREF: sub_407100+16j
					; DATA XREF: .rdata:off_410E30o
		mov	eax, offset aUnknown ; jumptable 00407116 case 0
		jmp	short loc_407140
; ---------------------------------------------------------------------------

loc_40711F:				; CODE XREF: sub_407100+16j
					; DATA XREF: .rdata:off_410E30o
		mov	eax, offset aGet_0 ; jumptable 00407116	case 1
		jmp	short loc_407140
; ---------------------------------------------------------------------------

loc_407126:				; CODE XREF: sub_407100+16j
					; DATA XREF: .rdata:off_410E30o
		mov	eax, offset aGetname_0 ; jumptable 00407116 case 2
		jmp	short loc_407140
; ---------------------------------------------------------------------------

loc_40712D:				; CODE XREF: sub_407100+16j
					; DATA XREF: .rdata:off_410E30o
		mov	eax, offset aSend_0 ; jumptable	00407116 case 3
		jmp	short loc_407140
; ---------------------------------------------------------------------------

loc_407134:				; CODE XREF: sub_407100+16j
					; DATA XREF: .rdata:off_410E30o
		mov	eax, offset aSearch_1 ;	jumptable 00407116 case	4
		jmp	short loc_407140
; ---------------------------------------------------------------------------

loc_40713B:				; CODE XREF: sub_407100+7j
		mov	eax, offset a?	; jumptable 00407116 default case

loc_407140:				; CODE XREF: sub_407100+1Dj
					; sub_407100+24j ...
		pop	ebp
		retn
sub_407100	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407142(FILE *, int)
sub_407142	proc near		; CODE XREF: sub_4033A7+575p
					; sub_403A3F+54Ap

var_18		= dword	ptr -18h
File		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_407170
; ---------------------------------------------------------------------------

loc_40714A:				; CODE XREF: sub_407142+36j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_40716C
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+var_18], eax ;	Ch
		call	fputc

loc_40716C:				; CODE XREF: sub_407142+10j
		add	[ebp+arg_4], 1

loc_407170:				; CODE XREF: sub_407142+6j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40714A
		leave
		retn
sub_407142	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40717C	proc near		; CODE XREF: sub_404077+10Bp

Str		= dword	ptr -28h
Control		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 2Ah	; switch 23 cases
		cmp	eax, 16h
		ja	loc_4072BA	; jumptable 004071A1 default case
		mov	eax, ds:off_410E5C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4071A3:				; CODE XREF: sub_40717C+25j
					; DATA XREF: .rdata:off_410E5Co
		mov	eax, [ebp+arg_0] ; jumptable 004071A1 case 42
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_4072BF
; ---------------------------------------------------------------------------

loc_4071BA:				; CODE XREF: sub_40717C+25j
					; DATA XREF: .rdata:off_410E5Co
		mov	eax, [ebp+arg_0] ; jumptable 004071A1 case 61
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 1
		jmp	loc_4072BF
; ---------------------------------------------------------------------------

loc_4071D1:				; CODE XREF: sub_40717C+25j
					; DATA XREF: .rdata:off_410E5Co
		mov	eax, [ebp+arg_0] ; jumptable 004071A1 case 60
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 2
		jmp	loc_4072BF
; ---------------------------------------------------------------------------

loc_4071E8:				; CODE XREF: sub_40717C+25j
					; DATA XREF: .rdata:off_410E5Co
		mov	eax, [ebp+arg_0] ; jumptable 004071A1 case 64
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 3
		jmp	loc_4072BF
; ---------------------------------------------------------------------------

loc_4071FF:				; CODE XREF: sub_40717C+25j
					; DATA XREF: .rdata:off_410E5Co
		mov	eax, [ebp+arg_0] ; jumptable 004071A1 case 48
		mov	eax, [eax]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 78h
		jnz	loc_4072BA	; jumptable 004071A1 default case
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Ah
		jnz	short loc_407266
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+Control], offset Control ; "abcdefABCDEF1234567890x"
		mov	[esp+28h+Str], eax ; Str
		call	strspn
		cmp	eax, 0Ah
		jnz	short loc_407266
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 5
		jmp	short loc_4072BF
; ---------------------------------------------------------------------------

loc_407266:				; CODE XREF: sub_40717C+BAj
					; sub_40717C+D4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 12h
		jnz	short loc_4072BA ; jumptable 004071A1 default case
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+Control], offset Control ; "abcdefABCDEF1234567890x"
		mov	[esp+28h+Str], eax ; Str
		call	strspn
		cmp	eax, 12h
		jnz	short loc_4072BA ; jumptable 004071A1 default case
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 4
		jmp	short loc_4072BF
; ---------------------------------------------------------------------------

loc_4072BA:				; CODE XREF: sub_40717C+18j
					; sub_40717C+25j ...
		mov	eax, 0		; jumptable 004071A1 default case

loc_4072BF:				; CODE XREF: sub_40717C+39j
					; sub_40717C+50j ...
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_40717C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, 1
		jz	short loc_4072E8
		cmp	eax, 1
		jb	short loc_4072E1
		cmp	eax, 7
		jz	short loc_4072EF
		cmp	eax, 13h
		jz	short loc_4072F6
		jmp	short loc_4072FD
; ---------------------------------------------------------------------------

loc_4072E1:				; CODE XREF: .text:004072D3j
		mov	eax, 0
		jmp	short loc_407302
; ---------------------------------------------------------------------------

loc_4072E8:				; CODE XREF: .text:004072CEj
		mov	eax, 7Fh
		jmp	short loc_407302
; ---------------------------------------------------------------------------

loc_4072EF:				; CODE XREF: .text:004072D8j
		mov	eax, 9
		jmp	short loc_407302
; ---------------------------------------------------------------------------

loc_4072F6:				; CODE XREF: .text:004072DDj
		mov	eax, 6
		jmp	short loc_407302
; ---------------------------------------------------------------------------

loc_4072FD:				; CODE XREF: .text:004072DFj
		mov	eax, 1

loc_407302:				; CODE XREF: .text:004072E6j
					; .text:004072EDj ...
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407304	proc near		; CODE XREF: .text:00407545p

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	loc_40748B
; ---------------------------------------------------------------------------

loc_40731C:				; CODE XREF: sub_407304+57j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	ecx, [ebp+arg_0]
		add	edx, ecx
		movzx	ecx, byte ptr [edx]
		mov	edx, [ebp+var_10]
		mov	[edx+eax+8], cl
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		add	[ebp+var_C], 1
		jmp	short loc_40734A
; ---------------------------------------------------------------------------

loc_407349:				; CODE XREF: sub_407304+18Dj
		nop

loc_40734A:				; CODE XREF: sub_407304+43j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, 2
		jg	short loc_40735D
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	short loc_40731C

loc_40735D:				; CODE XREF: sub_407304+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, 3
		jnz	loc_40748B
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_410EB8[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		mov	ecx, eax
		and	ecx, 30h
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+9]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_410EB8[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+9]
		movzx	eax, al
		shl	eax, 2
		mov	ecx, eax
		and	ecx, 3Ch
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+0Ah]
		shr	al, 6
		movzx	eax, al
		and	eax, 3
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_410EB8[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+0Ah]
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_410EB8[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		lea	edx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, 45h
		jle	short loc_407481
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 0Ah ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0

loc_407481:				; CODE XREF: sub_407304+15Bj
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0

loc_40748B:				; CODE XREF: sub_407304+13j
					; sub_407304+62j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_407349
		leave
		retn
sub_407304	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+14h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 1
		test	al, al
		jnz	short loc_407520
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jnz	short loc_4074CD
		mov	eax, 0
		jmp	locret_407673
; ---------------------------------------------------------------------------

loc_4074CD:				; CODE XREF: .text:004074C1j
		mov	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40750B
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		or	edx, 8
		mov	[eax], dl
		mov	eax, [ebp-10h]
		mov	edx, [eax+18h]
		mov	eax, offset aBeginPgpPublic ; "-----BEGIN PGP PUBLIC KEY BLOCK-----\n\"...
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 26h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		jmp	short loc_407515
; ---------------------------------------------------------------------------

loc_40750B:				; CODE XREF: .text:004074D5j
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+14h], offset aBeginPgpPubl_0 ; "-----BEGIN PGP PUBLIC KEY BLOCK-----"

loc_407515:				; CODE XREF: .text:00407509j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		or	edx, 1
		mov	[eax], dl

loc_407520:				; CODE XREF: .text:004074B6j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 8
		test	al, al
		jz	short loc_40754F
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		mov	edx, [ebp+14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407304
		jmp	loc_40766C
; ---------------------------------------------------------------------------

loc_40754F:				; CODE XREF: .text:0040752Bj
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_40764F
; ---------------------------------------------------------------------------

loc_40755B:				; CODE XREF: .text:00407666j
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-14h]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-10h]
		mov	ecx, [eax+14h]
		mov	eax, [ebp-10h]
		mov	eax, [eax+0Ch]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	loc_407605
		mov	eax, [ebp-10h]
		mov	eax, [eax+0Ch]
		lea	edx, [eax+1]
		mov	eax, [ebp-10h]
		mov	[eax+0Ch], edx
		mov	eax, [ebp-10h]
		mov	edx, [eax+14h]
		mov	eax, [ebp-10h]
		mov	eax, [eax+0Ch]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40760F
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jz	short loc_4075BD
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl
		jmp	short loc_40760F
; ---------------------------------------------------------------------------

loc_4075BD:				; CODE XREF: .text:004075AEj
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		or	edx, 2
		mov	[eax], dl
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+14h], offset aEndPgpPublicKe ; "-----END	PGP PUBLIC KEY BLOCK-----"
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp-10h]
		mov	edx, [eax+18h]
		mov	eax, offset aBeginPgpPubl_0 ; "-----BEGIN PGP PUBLIC KEY BLOCK-----"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 24h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		jmp	short loc_40764B
; ---------------------------------------------------------------------------

loc_407605:				; CODE XREF: .text:00407579j
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+0Ch], 0

loc_40760F:				; CODE XREF: .text:004075A1j
					; .text:004075BBj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jz	short loc_40764B
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-14h]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_40764B
		mov	eax, [ebp-10h]
		mov	edx, [eax+18h]
		mov	eax, [ebp-0Ch]
		mov	ecx, [ebp-14h]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc

loc_40764B:				; CODE XREF: .text:00407603j
					; .text:0040761Aj ...
		add	dword ptr [ebp-0Ch], 1

loc_40764F:				; CODE XREF: .text:00407556j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		and	eax, 4
		test	al, al
		jnz	short loc_40766C
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		cmp	eax, [ebp-0Ch]
		ja	loc_40755B

loc_40766C:				; CODE XREF: .text:0040754Aj
					; .text:0040765Aj
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]

locret_407673:				; CODE XREF: .text:004074C8j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		and	eax, 8
		test	al, al
		jz	locret_407816
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	eax, 2
		jnz	loc_407751
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_410EB8[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		mov	ecx, eax
		and	ecx, 30h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+9]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_410EB8[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+9]
		movzx	eax, al
		shl	eax, 2
		and	eax, 3Ch
		movzx	eax, ds:byte_410EB8[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	eax, [eax+18h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3Dh
		call	fputc
		jmp	loc_4077E4
; ---------------------------------------------------------------------------

loc_407751:				; CODE XREF: .text:00407695j
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	eax, 1
		jnz	loc_4077E4
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_410EB8[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		and	eax, 30h
		movzx	eax, ds:byte_410EB8[eax]
		movsx	eax, al
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc
		mov	eax, [ebp+8]
		mov	eax, [eax+18h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3Dh
		call	fputc
		mov	eax, [ebp+8]
		mov	eax, [eax+18h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3Dh
		call	fputc

loc_4077E4:				; CODE XREF: .text:0040774Cj
					; .text:0040775Aj
		mov	eax, [ebp+8]
		mov	edx, [eax+18h]
		mov	eax, offset aEndPgpPublic_0 ; "\n-----END PGP PUBLIC KEY BLOCK-----"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 23h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl

locret_407816:				; CODE XREF: .text:00407686j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_407846
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_407846
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_40789D
; ---------------------------------------------------------------------------

loc_407846:				; CODE XREF: .text:00407826j
					; .text:00407830j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40786E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40786E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_40789D
; ---------------------------------------------------------------------------

loc_40786E:				; CODE XREF: .text:0040784Ej
					; .text:00407858j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_407896
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_407896
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_40789D
; ---------------------------------------------------------------------------

loc_407896:				; CODE XREF: .text:00407876j
					; .text:00407880j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40791A
; ---------------------------------------------------------------------------

loc_40789D:				; CODE XREF: .text:00407844j
					; .text:0040786Cj ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4078C6
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4078C6
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_407917
; ---------------------------------------------------------------------------

loc_4078C6:				; CODE XREF: .text:004078A9j
					; .text:004078B3j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4078EB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4078EB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_407917
; ---------------------------------------------------------------------------

loc_4078EB:				; CODE XREF: .text:004078CEj
					; .text:004078D8j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_407910
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_407910
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_407917
; ---------------------------------------------------------------------------

loc_407910:				; CODE XREF: .text:004078F3j
					; .text:004078FDj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40791A
; ---------------------------------------------------------------------------

loc_407917:				; CODE XREF: .text:004078C4j
					; .text:004078E9j ...
		mov	eax, [ebp-4]

locret_40791A:				; CODE XREF: .text:0040789Bj
					; .text:00407915j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40791C	proc near		; CODE XREF: sub_407934+35p
					; sub_407934+48p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_40792F
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_40792F
		and	[ebp+arg_0], 0FFFFFFDFh

loc_40792F:				; CODE XREF: sub_40791C+7j
					; sub_40791C+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_40791C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407934	proc near		; CODE XREF: sub_401C06+BAp
					; sub_401C06+3F8p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_40798F
		mov	eax, 0
		jmp	loc_4079E8
; ---------------------------------------------------------------------------

loc_40794D:				; CODE XREF: sub_407934+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_407985
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_40791C
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_40791C
		cmp	ebx, eax
		jnz	short loc_4079A6

loc_407985:				; CODE XREF: sub_407934+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_407990
; ---------------------------------------------------------------------------

loc_40798F:				; CODE XREF: sub_407934+Dj
		nop

loc_407990:				; CODE XREF: sub_407934+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4079A7
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40794D
		jmp	short loc_4079A7
; ---------------------------------------------------------------------------

loc_4079A6:				; CODE XREF: sub_407934+4Fj
		nop

loc_4079A7:				; CODE XREF: sub_407934+64j
					; sub_407934+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4079E3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_40791C
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_40791C
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_4079E8
; ---------------------------------------------------------------------------

loc_4079E3:				; CODE XREF: sub_407934+81j
		mov	eax, 0

loc_4079E8:				; CODE XREF: sub_407934+14j
					; sub_407934+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_407934	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4079F0	proc near		; CODE XREF: sub_407A44+1Ap
					; .text:00407AF8p ...

File		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+18h+File],	eax ; int
		call	strerror
		mov	edx, offset aErrorAllocatin ; "error allocating	enough memory: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+Format], edx ;	Format
		mov	[esp+18h+File],	ecx ; File
		call	fprintf
		mov	[esp+18h+File],	2 ; Code
		call	exit
sub_4079F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407A31(size_t)
sub_407A31	proc near		; CODE XREF: sub_4083C2+29Ap
					; sub_409439+A5p ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_407A31	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407A44(size_t)
sub_407A44	proc near		; CODE XREF: .text:0040800Cp
					; .text:00408381p ...

Size		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_407A63
		call	sub_4079F0
; ---------------------------------------------------------------------------

loc_407A63:				; CODE XREF: sub_407A44+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407A44	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407A68(char *)
sub_407A68	proc near		; CODE XREF: sub_4083C2+1B9p
					; .text:004097C2p

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jz	short loc_407AB4
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+Dest]
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy

loc_407AB4:				; CODE XREF: sub_407A68+38j
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_407A68	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407AFD
		call	sub_4079F0
; ---------------------------------------------------------------------------

loc_407AFD:				; CODE XREF: .text:00407AF6j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407B02(size_t, size_t)
sub_407B02	proc near		; CODE XREF: sub_40BD96+188p
					; sub_40BD96+2DEp

NumOfElements	= dword	ptr -18h
SizeOfElements	= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+SizeOfElements], eax ;	SizeOfElements
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+NumOfElements], eax ; NumOfElements
		call	calloc
		leave
		retn
sub_407B02	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	calloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407B42
		call	sub_4079F0
; ---------------------------------------------------------------------------

loc_407B42:				; CODE XREF: .text:00407B3Bj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407B47(char *)
sub_407B47	proc near		; CODE XREF: .text:004082EAp
					; .text:004082FAp ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_407B86
		call	sub_4079F0
; ---------------------------------------------------------------------------

loc_407B86:				; CODE XREF: sub_407B47+38j
		mov	eax, [ebp+Dest]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_407B47	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407BA1(void *)
sub_407BA1	proc near		; CODE XREF: sub_4083C2+23Fp
					; sub_4083C2+2AEp ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_407BB8
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_407BB8:				; CODE XREF: sub_407BA1+Aj
		leave
		retn
sub_407BA1	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 0A8h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408787
		test	eax, eax
		jnz	short loc_407BE7
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_407D11
; ---------------------------------------------------------------------------

loc_407BE7:				; CODE XREF: .text:00407BD9j
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_407C3C
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_407D11
; ---------------------------------------------------------------------------

loc_407C3C:				; CODE XREF: .text:00407C2Ej
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_407C8E
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_407D01
; ---------------------------------------------------------------------------

loc_407C8E:				; CODE XREF: .text:00407C83j
		lea	eax, [ebp-7Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_407CE9
		lea	eax, [ebp-48h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_407CE9
		mov	edx, [ebp-60h]
		mov	eax, [ebp-2Ch]
		cmp	edx, eax
		jnz	short loc_407CE9
		mov	edx, [ebp-50h]
		mov	eax, [ebp-1Ch]
		cmp	edx, eax
		jnz	short loc_407CE9
		mov	edx, [ebp-4Ch]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jnz	short loc_407CE9
		mov	eax, 1
		jmp	short loc_407CEE
; ---------------------------------------------------------------------------

loc_407CE9:				; CODE XREF: .text:00407CA7j
					; .text:00407CC2j ...
		mov	eax, 0

loc_407CEE:				; CODE XREF: .text:00407CE7j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_407D01:				; CODE XREF: .text:00407C8Cj
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_407D11:				; CODE XREF: .text:00407BE2j
					; .text:00407C37j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407D16	proc near		; CODE XREF: sub_401733+8Bp

VarName		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	[esp+38h+VarName], offset VarName ; "TZ"
		call	getenv
		mov	[ebp+var_C], eax
		mov	[esp+38h+VarName], offset EnvString ; "TZ=UTC"
		call	_putenv
		call	_tzset
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax
		call	sub_40EDE0
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jz	short loc_407DCC
		mov	eax, ds:Dest
		test	eax, eax
		jnz	short loc_407DB4
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 4
		mov	[esp+38h+VarName], eax ; Size
		call	malloc
		mov	ds:Dest, eax
		mov	eax, ds:Dest
		test	eax, eax
		jz	short loc_407DB4
		mov	edx, offset aTz_0 ; "TZ="
		mov	eax, ds:Dest
		mov	edx, [edx]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, ds:Dest
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+VarName], eax ; Dest
		call	strcat

loc_407DB4:				; CODE XREF: sub_407D16+42j
					; sub_407D16+7Aj
		mov	eax, ds:Dest
		test	eax, eax
		jz	short loc_407DD8
		mov	eax, ds:Dest
		mov	[esp+38h+VarName], eax ; EnvString
		call	_putenv
		jmp	short loc_407DD8
; ---------------------------------------------------------------------------

loc_407DCC:				; CODE XREF: sub_407D16+39j
		mov	[esp+38h+VarName], offset VarName ; "TZ"
		call	_putenv

loc_407DD8:				; CODE XREF: sub_407D16+A5j
					; sub_407D16+B4j
		call	_tzset
		mov	eax, [ebp+var_10]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_407D16	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407DE8(char *)
sub_407DE8	proc near		; CODE XREF: sub_4083C2+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_407E2B
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_407E21
; ---------------------------------------------------------------------------

loc_407E0D:				; CODE XREF: sub_407DE8+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_407E1D
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_407E1D:				; CODE XREF: sub_407DE8+2Dj
		add	[ebp+var_C], 1

loc_407E21:				; CODE XREF: sub_407DE8+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407E0D

loc_407E2B:				; CODE XREF: sub_407DE8+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_407DE8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_407F01
; ---------------------------------------------------------------------------

loc_407E54:				; CODE XREF: .text:00407F05j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_407EF9
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_407EA6
; ---------------------------------------------------------------------------

loc_407E9A:				; CODE XREF: .text:00407ED6j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_407EA6:				; CODE XREF: .text:00407E98j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_407ED8
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_407E9A

loc_407ED8:				; CODE XREF: .text:00407EAAj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407EE7
		mov	eax, [ebp-18h]
		jmp	short loc_407F10
; ---------------------------------------------------------------------------

loc_407EE7:				; CODE XREF: .text:00407EE0j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_407EF9:				; CODE XREF: .text:00407E7Ej
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_407F01:				; CODE XREF: .text:00407E4Fj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_407E54
		mov	eax, 0

loc_407F10:				; CODE XREF: .text:00407EE5j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_407FDF
; ---------------------------------------------------------------------------

loc_407F3A:				; CODE XREF: .text:00407FE3j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408FF9
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408FF9
		cmp	ebx, eax
		jnz	short loc_407FD7
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_407F88
; ---------------------------------------------------------------------------

loc_407F7C:				; CODE XREF: .text:00407FB4j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_407F88:				; CODE XREF: .text:00407F7Aj
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_407FB6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408FF9
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_408FF9
		cmp	ebx, eax
		jz	short loc_407F7C

loc_407FB6:				; CODE XREF: .text:00407F8Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407FC5
		mov	eax, [ebp-18h]
		jmp	short loc_407FEE
; ---------------------------------------------------------------------------

loc_407FC5:				; CODE XREF: .text:00407FBEj
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_407FD7:				; CODE XREF: .text:00407F60j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_407FDF:				; CODE XREF: .text:00407F35j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_407F3A
		mov	eax, 0

loc_407FEE:				; CODE XREF: .text:00407FC3j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_408053
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_408014
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_407A44
		mov	[ebp+8], eax

loc_408014:				; CODE XREF: .text:00408004j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_40803D
; ---------------------------------------------------------------------------

loc_408026:				; CODE XREF: .text:0040804Bj
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_40803D:				; CODE XREF: .text:00408024j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40804D
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408026

loc_40804D:				; CODE XREF: .text:00408041j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_408053:				; CODE XREF: .text:00407FFEj
		mov	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_408070
; ---------------------------------------------------------------------------

loc_40806C:				; CODE XREF: .text:0040808Fj
		add	dword ptr [ebp-10h], 1

loc_408070:				; CODE XREF: .text:0040806Aj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408091
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_40806C

loc_408091:				; CODE XREF: .text:00408078j
		mov	dword ptr [ebp-14h], 0
		jmp	short loc_4080CE
; ---------------------------------------------------------------------------

loc_40809A:				; CODE XREF: .text:004080E1j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_4080BF
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_4080C6
		mov	eax, [ebp-0Ch]
		mov	[ebp-14h], eax
		jmp	short loc_4080C6
; ---------------------------------------------------------------------------

loc_4080BF:				; CODE XREF: .text:004080AFj
		mov	dword ptr [ebp-14h], 0

loc_4080C6:				; CODE XREF: .text:004080B5j
					; .text:004080BDj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1

loc_4080CE:				; CODE XREF: .text:00408098j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40809A
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_4080EF
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0

loc_4080EF:				; CODE XREF: .text:004080E7j
		mov	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_408139
; ---------------------------------------------------------------------------

loc_408109:				; CODE XREF: .text:00408141j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_40812E
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_408135
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_408135
; ---------------------------------------------------------------------------

loc_40812E:				; CODE XREF: .text:0040811Ej
		mov	dword ptr [ebp-10h], 0

loc_408135:				; CODE XREF: .text:00408124j
					; .text:0040812Cj
		add	dword ptr [ebp-0Ch], 1

loc_408139:				; CODE XREF: .text:00408107j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408109
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40814F
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_40814F:				; CODE XREF: .text:00408147j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408154(int, int, char	*)
sub_408154	proc near		; CODE XREF: .text:004081EBp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4081A9
; ---------------------------------------------------------------------------

loc_408170:				; CODE XREF: sub_408154+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_40819A
		cmp	[ebp+var_10], 0
		jnz	short loc_4081A1
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_4081A1
; ---------------------------------------------------------------------------

loc_40819A:				; CODE XREF: sub_408154+36j
		mov	[ebp+var_10], 0

loc_4081A1:				; CODE XREF: sub_408154+3Cj
					; sub_408154+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_4081A9:				; CODE XREF: sub_408154+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_408170
		cmp	[ebp+var_10], 0
		jz	short loc_4081CB
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_4081CE
; ---------------------------------------------------------------------------

loc_4081CB:				; CODE XREF: sub_408154+61j
		mov	eax, [ebp+arg_4]

locret_4081CE:				; CODE XREF: sub_408154+75j
		leave
		retn
sub_408154	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_410FC8 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408154
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4081F2(int, int, char	*)
sub_4081F2	proc near		; CODE XREF: .text:00408283p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_408247
; ---------------------------------------------------------------------------

loc_40820E:				; CODE XREF: sub_4081F2+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_408238
		cmp	[ebp+var_10], 0
		jnz	short loc_40823F
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_40823F
; ---------------------------------------------------------------------------

loc_408238:				; CODE XREF: sub_4081F2+36j
		mov	[ebp+var_10], 0

loc_40823F:				; CODE XREF: sub_4081F2+3Cj
					; sub_4081F2+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_408247:				; CODE XREF: sub_4081F2+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_40820E
		cmp	[ebp+var_10], 0
		jz	short loc_408263
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_408266
; ---------------------------------------------------------------------------

loc_408263:				; CODE XREF: sub_4081F2+61j
		mov	eax, [ebp+arg_4]

locret_408266:				; CODE XREF: sub_4081F2+6Fj
		leave
		retn
sub_4081F2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_410FC8 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4081F2
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4082F1
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4082F1
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4082F1
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407B47
		jmp	short locret_4082FF
; ---------------------------------------------------------------------------

loc_4082F1:				; CODE XREF: .text:004082AAj
					; .text:004082C6j ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_407B47

locret_4082FF:				; CODE XREF: .text:004082EFj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_408369
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_408369
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_408369
		mov	dword ptr [esp], offset	a_ ; "."
		call	sub_407B47
		jmp	short locret_4083AE
; ---------------------------------------------------------------------------

loc_408369:				; CODE XREF: .text:00408321j
					; .text:0040833Dj ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	sub_407A44
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_4083AE:				; CODE XREF: .text:00408367j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4083B0	proc near		; CODE XREF: sub_4083C2+144p
					; sub_4083C2+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4083B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4083C2	proc near		; CODE XREF: .text:0040874Ap
					; sub_408757+23p

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_408489
; ---------------------------------------------------------------------------

loc_40840F:				; CODE XREF: sub_4083C2+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_408485
		cmp	[ebp+arg_0], 0
		jz	short loc_40846E
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_40A280
; ---------------------------------------------------------------------------

loc_40846E:				; CODE XREF: sub_4083C2+8Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_40871D
; ---------------------------------------------------------------------------

loc_408485:				; CODE XREF: sub_4083C2+88j
		add	[ebp+var_C], 1

loc_408489:				; CODE XREF: sub_4083C2+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_40840F
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_408640
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_4084E3
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408559

loc_4084E3:				; CODE XREF: sub_4083C2+112j
		mov	[esp+0C8h+VarName], offset aHome ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_408514
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_4083B0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_408514:				; CODE XREF: sub_4083C2+134j
		cmp	[ebp+var_20], 0
		jz	loc_40863F
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40863F
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_40863F
; ---------------------------------------------------------------------------

loc_408559:				; CODE XREF: sub_4083C2+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_408572
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_407B47
		mov	[ebp+Str], eax
		jmp	short loc_408593
; ---------------------------------------------------------------------------

loc_408572:				; CODE XREF: sub_4083C2+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_407A68
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_408593
		mov	eax, 0
		jmp	loc_40871D
; ---------------------------------------------------------------------------

loc_408593:				; CODE XREF: sub_4083C2+1AEj
					; sub_4083C2+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_4085B5
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_4085B5:				; CODE XREF: sub_4083C2+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_4083B0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_407BA1
		cmp	[ebp+var_20], 0
		jz	short loc_408636
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_408640
; ---------------------------------------------------------------------------

loc_408636:				; CODE XREF: sub_4083C2+248j
		mov	[ebp+var_14], 1
		jmp	short loc_408640
; ---------------------------------------------------------------------------

loc_40863F:				; CODE XREF: sub_4083C2+156j
					; sub_4083C2+164j ...
		nop

loc_408640:				; CODE XREF: sub_4083C2+101j
					; sub_4083C2+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_408656
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_407A44
		mov	[ebp+var_1C], eax
		jmp	short loc_40867F
; ---------------------------------------------------------------------------

loc_408656:				; CODE XREF: sub_4083C2+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_407A31
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40867F
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_407BA1
		mov	eax, 0
		jmp	loc_40871D
; ---------------------------------------------------------------------------

loc_40867F:				; CODE XREF: sub_4083C2+292j
					; sub_4083C2+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_4086B0
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_409305
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_409305
		mov	[ebp+var_24], eax
		jmp	short loc_4086C5
; ---------------------------------------------------------------------------

loc_4086B0:				; CODE XREF: sub_4083C2+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_409305
		mov	[ebp+var_24], eax

loc_4086C5:				; CODE XREF: sub_4083C2+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_407BA1
		mov	[ebp+var_C], 0
		jmp	short loc_408704
; ---------------------------------------------------------------------------

loc_4086D9:				; CODE XREF: sub_4083C2+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_409305
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_408704:				; CODE XREF: sub_4083C2+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_4086D9
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_407DE8

loc_40871D:				; CODE XREF: sub_4083C2+BEj
					; sub_4083C2+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4083C2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 1
		call	sub_4083C2
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408757	proc near		; CODE XREF: sub_4069F5+6E8p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 0
		call	sub_4083C2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408757	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408787	proc near		; CODE XREF: .text:00407BD2p

C		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_4087FC
; ---------------------------------------------------------------------------

loc_408790:				; CODE XREF: sub_408787+87j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4087F4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_4087F4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4087E0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4087F4

loc_4087E0:				; CODE XREF: sub_408787+4Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_408810
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_408810

loc_4087F4:				; CODE XREF: sub_408787+17j
					; sub_408787+43j ...
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_4087FC:				; CODE XREF: sub_408787+7j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408810
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408790

loc_408810:				; CODE XREF: sub_408787+61j
					; sub_408787+6Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_408824
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_408838

loc_408824:				; CODE XREF: sub_408787+91j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_40883F
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40883F

loc_408838:				; CODE XREF: sub_408787+9Bj
		mov	eax, 0
		jmp	short loc_40886D
; ---------------------------------------------------------------------------

loc_40883F:				; CODE XREF: sub_408787+A5j
					; sub_408787+AFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_40886D:				; CODE XREF: sub_408787+B6j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_408787	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408873	proc near		; CODE XREF: sub_401C06+5AEp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4088A1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4088A1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp+var_4], eax
		jmp	short loc_4088F8
; ---------------------------------------------------------------------------

loc_4088A1:				; CODE XREF: sub_408873+Ej
					; sub_408873+18j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4088C9
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4088C9
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp+var_4], eax
		jmp	short loc_4088F8
; ---------------------------------------------------------------------------

loc_4088C9:				; CODE XREF: sub_408873+36j
					; sub_408873+40j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4088F1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4088F1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp+var_4], eax
		jmp	short loc_4088F8
; ---------------------------------------------------------------------------

loc_4088F1:				; CODE XREF: sub_408873+5Ej
					; sub_408873+68j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_408975
; ---------------------------------------------------------------------------

loc_4088F8:				; CODE XREF: sub_408873+2Cj
					; sub_408873+54j ...
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_408921
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_408921
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp+var_4], eax
		jmp	short loc_408972
; ---------------------------------------------------------------------------

loc_408921:				; CODE XREF: sub_408873+91j
					; sub_408873+9Bj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_408946
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_408946
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp+var_4], eax
		jmp	short loc_408972
; ---------------------------------------------------------------------------

loc_408946:				; CODE XREF: sub_408873+B6j
					; sub_408873+C0j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40896B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_40896B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp+var_4], eax
		jmp	short loc_408972
; ---------------------------------------------------------------------------

loc_40896B:				; CODE XREF: sub_408873+DBj
					; sub_408873+E5j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_408975
; ---------------------------------------------------------------------------

loc_408972:				; CODE XREF: sub_408873+ACj
					; sub_408873+D1j ...
		mov	eax, [ebp+var_4]

locret_408975:				; CODE XREF: sub_408873+83j
					; sub_408873+FDj
		leave
		retn
sub_408873	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408977(FILE *, int, int, int,	int)
sub_408977	proc near		; CODE XREF: sub_408B30+29p
					; .text:00408C6Dp

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_408B21
; ---------------------------------------------------------------------------

loc_40898F:				; CODE XREF: sub_408977+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4089DD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_4089DD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_4089DD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_4089DD
		cmp	[ebp+arg_C], 0
		jnz	short loc_4089CF
		cmp	[ebp+arg_10], 0
		jz	loc_408AF9

loc_4089CF:				; CODE XREF: sub_408977+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_408AF9

loc_4089DD:				; CODE XREF: sub_408977+20j
					; sub_408977+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_408A1A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_408B15
; ---------------------------------------------------------------------------

loc_408A1A:				; CODE XREF: sub_408977+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_408A40
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_408B15
; ---------------------------------------------------------------------------

loc_408A40:				; CODE XREF: sub_408977+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_408A66
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_408B15
; ---------------------------------------------------------------------------

loc_408A66:				; CODE XREF: sub_408977+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_408A8C
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_408B15
; ---------------------------------------------------------------------------

loc_408A8C:				; CODE XREF: sub_408977+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_408AAF
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_408B15
; ---------------------------------------------------------------------------

loc_408AAF:				; CODE XREF: sub_408977+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408AD2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_408B15
; ---------------------------------------------------------------------------

loc_408AD2:				; CODE XREF: sub_408977+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_408B15
; ---------------------------------------------------------------------------

loc_408AF9:				; CODE XREF: sub_408977+52j
					; sub_408977+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_408B15:				; CODE XREF: sub_408977+9Ej
					; sub_408977+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_408B21:				; CODE XREF: sub_408977+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_40898F
		mov	eax, [ebp+var_10]
		leave
		retn
sub_408977	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408B30(FILE *, int, int, int)
sub_408B30	proc near		; CODE XREF: sub_408B60+B7p
					; .text:00408CC3p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_408977
		leave
		retn
sub_408B30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408B60(FILE *, int, int, int)
sub_408B60	proc near		; CODE XREF: .text:00408D19p

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_408B89
; ---------------------------------------------------------------------------

loc_408B76:				; CODE XREF: sub_408B60+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_408B93
		add	[ebp+var_C], 1

loc_408B89:				; CODE XREF: sub_408B60+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_408B76
		jmp	short loc_408B94
; ---------------------------------------------------------------------------

loc_408B93:				; CODE XREF: sub_408B60+23j
		nop

loc_408B94:				; CODE XREF: sub_408B60+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_408BFC
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_40B0E7
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; void *
		call	sub_407BA1
		mov	eax, [ebp+var_C]
		jmp	short loc_408C1C
; ---------------------------------------------------------------------------

loc_408BFC:				; CODE XREF: sub_408B60+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_408B30

loc_408C1C:				; CODE XREF: sub_408B60+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_408B60	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_408C74
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408977
		jmp	short loc_408C79
; ---------------------------------------------------------------------------

loc_408C74:				; CODE XREF: .text:00408C2Dj
		mov	eax, 0

loc_408C79:				; CODE XREF: .text:00408C72j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_408CCA
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408B30
		jmp	short loc_408CCF
; ---------------------------------------------------------------------------

loc_408CCA:				; CODE XREF: .text:00408C8Aj
		mov	eax, 0

loc_408CCF:				; CODE XREF: .text:00408CC8j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_408D20
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408B60
		jmp	short loc_408D25
; ---------------------------------------------------------------------------

loc_408D20:				; CODE XREF: .text:00408CE0j
		mov	eax, 0

loc_408D25:				; CODE XREF: .text:00408D1Ej
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 1
		jmp	loc_408DD5
; ---------------------------------------------------------------------------

loc_408D4F:				; CODE XREF: .text:00408DD9j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_408D81
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_408D81
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_408D81
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_408DC9
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_408DC9

loc_408D81:				; CODE XREF: .text:00408D57j
					; .text:00408D61j ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_408DBD
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_408DBD
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_408DBD
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_408DBD
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_408DBD
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408DC3

loc_408DBD:				; CODE XREF: .text:00408D89j
					; .text:00408D93j ...
		add	dword ptr [ebp-10h], 2
		jmp	short loc_408DCD
; ---------------------------------------------------------------------------

loc_408DC3:				; CODE XREF: .text:00408DBBj
		add	dword ptr [ebp-10h], 5
		jmp	short loc_408DCD
; ---------------------------------------------------------------------------

loc_408DC9:				; CODE XREF: .text:00408D75j
					; .text:00408D7Fj
		add	dword ptr [ebp-10h], 1

loc_408DCD:				; CODE XREF: .text:00408DC1j
					; .text:00408DC7j
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_408DD5:				; CODE XREF: .text:00408D4Aj
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_408D4F
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-18h]
		mov	[ebp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_407A44
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-14h], eax
		jmp	loc_408F12
; ---------------------------------------------------------------------------

loc_408E04:				; CODE XREF: .text:00408F16j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_408E3E
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_408E3E
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_408E3E
		cmp	dword ptr [ebp+10h], 0
		jz	loc_408EF9
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_408EF9

loc_408E3E:				; CODE XREF: .text:00408E0Cj
					; .text:00408E16j ...
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_408E61
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	6Eh
		add	dword ptr [ebp-14h], 1
		jmp	loc_408F0A
; ---------------------------------------------------------------------------

loc_408E61:				; CODE XREF: .text:00408E50j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_408E7A
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	72h
		add	dword ptr [ebp-14h], 1
		jmp	loc_408F0A
; ---------------------------------------------------------------------------

loc_408E7A:				; CODE XREF: .text:00408E69j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_408E90
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	66h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_408F0A
; ---------------------------------------------------------------------------

loc_408E90:				; CODE XREF: .text:00408E82j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_408EA6
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	76h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_408F0A
; ---------------------------------------------------------------------------

loc_408EA6:				; CODE XREF: .text:00408E98j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_408EBC
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	62h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_408F0A
; ---------------------------------------------------------------------------

loc_408EBC:				; CODE XREF: .text:00408EAEj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408ED2
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	30h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_408F0A
; ---------------------------------------------------------------------------

loc_408ED2:				; CODE XREF: .text:00408EC4j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sprintf
		add	dword ptr [ebp-14h], 3
		jmp	short loc_408F0A
; ---------------------------------------------------------------------------

loc_408EF9:				; CODE XREF: .text:00408E2Aj
					; .text:00408E38j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1

loc_408F0A:				; CODE XREF: .text:00408E5Cj
					; .text:00408E75j ...
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_408F12:				; CODE XREF: .text:00408DFFj
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_408E04
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_408F53
; ---------------------------------------------------------------------------

loc_408F36:				; CODE XREF: .text:00408F5Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_408F4F
		add	dword ptr [ebp-4], 1

loc_408F4F:				; CODE XREF: .text:00408F49j
		add	dword ptr [ebp+8], 1

loc_408F53:				; CODE XREF: .text:00408F34j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408F36
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jnz	short loc_408F78
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+8], eax

loc_408F78:				; CODE XREF: .text:00408F6Cj
		mov	eax, [ebp+8]
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0FFh
		mov	dword ptr [esp+10h], offset dword_413220
		mov	dword ptr [esp+0Ch], 400h
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 1000h
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset dword_413220
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_408FD5
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_408FD5
		mov	eax, 1
		jmp	short loc_408FDA
; ---------------------------------------------------------------------------

loc_408FD5:				; CODE XREF: .text:00408FC6j
					; .text:00408FCCj
		mov	eax, 0

loc_408FDA:				; CODE XREF: .text:00408FD3j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_408FF2
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_408FF2
		mov	eax, 1
		jmp	short loc_408FF7
; ---------------------------------------------------------------------------

loc_408FF2:				; CODE XREF: .text:00408FE3j
					; .text:00408FE9j
		mov	eax, 0

loc_408FF7:				; CODE XREF: .text:00408FF0j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408FF9	proc near		; CODE XREF: .text:00407F46p
					; .text:00407F59p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_40900C
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_40900C
		and	[ebp+arg_0], 0FFFFFFDFh

loc_40900C:				; CODE XREF: sub_408FF9+7j
					; sub_408FF9+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_408FF9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409011	proc near		; CODE XREF: .text:00409116p
					; .text:0040912Ap

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_409024
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_409024
		or	[ebp+arg_0], 20h

loc_409024:				; CODE XREF: sub_409011+7j
					; sub_409011+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_409011	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409029	proc near		; CODE XREF: .text:0040A53Ap
					; .text:0040A551p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_409084
		mov	eax, 0
		jmp	loc_4090DD
; ---------------------------------------------------------------------------

loc_409042:				; CODE XREF: sub_409029+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_40907A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_408FF9
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_408FF9
		cmp	ebx, eax
		jnz	short loc_40909B

loc_40907A:				; CODE XREF: sub_409029+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_409085
; ---------------------------------------------------------------------------

loc_409084:				; CODE XREF: sub_409029+Dj
		nop

loc_409085:				; CODE XREF: sub_409029+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40909C
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_409042
		jmp	short loc_40909C
; ---------------------------------------------------------------------------

loc_40909B:				; CODE XREF: sub_409029+4Fj
		nop

loc_40909C:				; CODE XREF: sub_409029+64j
					; sub_409029+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4090D8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_408FF9
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_408FF9
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_4090DD
; ---------------------------------------------------------------------------

loc_4090D8:				; CODE XREF: sub_409029+81j
		mov	eax, 0

loc_4090DD:				; CODE XREF: sub_409029+14j
					; sub_409029+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_409029	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_409103
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_40910A

loc_409103:				; CODE XREF: .text:004090FBj
		mov	eax, 0
		jmp	short locret_409161
; ---------------------------------------------------------------------------

loc_40910A:				; CODE XREF: .text:00409101j
					; .text:00409151j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_409011
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_409011
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_409153
		cmp	byte ptr [ebp-9], 0
		jz	short loc_409153
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_40910A

loc_409153:				; CODE XREF: .text:0040913Aj
					; .text:00409140j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_409161:				; CODE XREF: .text:00409108j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409163	proc near		; CODE XREF: .text:004092E4p
					; .text:0040A4FDp

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_409213
		mov	eax, 0
		jmp	loc_409222
; ---------------------------------------------------------------------------

loc_40918C:				; CODE XREF: sub_409163+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_409207
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_408FF9
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_408FF9
		cmp	ebx, eax
		jz	short loc_409207
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_409200
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_408FF9
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_408FF9
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_409205
; ---------------------------------------------------------------------------

loc_409200:				; CODE XREF: sub_409163+6Fj
		mov	eax, 0

loc_409205:				; CODE XREF: sub_409163+9Bj
		jmp	short loc_409222
; ---------------------------------------------------------------------------

loc_409207:				; CODE XREF: sub_409163+37j
					; sub_409163+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_409213:				; CODE XREF: sub_409163+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_40918C
		mov	eax, 0

loc_409222:				; CODE XREF: sub_409163+24j
					; sub_409163:loc_409205j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_409163	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_409254
		mov	eax, 0
		jmp	short loc_40929B
; ---------------------------------------------------------------------------

loc_40923A:				; CODE XREF: .text:00409267j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_40926B
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_409255
; ---------------------------------------------------------------------------

loc_409254:				; CODE XREF: .text:00409231j
		nop

loc_409255:				; CODE XREF: .text:00409252j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40926C
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40923A
		jmp	short loc_40926C
; ---------------------------------------------------------------------------

loc_40926B:				; CODE XREF: .text:00409248j
		nop

loc_40926C:				; CODE XREF: .text:0040925Dj
					; .text:00409269j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_409296
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_40929B
; ---------------------------------------------------------------------------

loc_409296:				; CODE XREF: .text:0040927Aj
		mov	eax, 0

loc_40929B:				; CODE XREF: .text:00409238j
					; .text:00409294j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_4092AE
		mov	eax, [ebp+8]
		jmp	short locret_409303
; ---------------------------------------------------------------------------

loc_4092AE:				; CODE XREF: .text:004092A7j
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_4092FE
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_4092F6
; ---------------------------------------------------------------------------

loc_4092D0:				; CODE XREF: .text:004092FCj
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_409163
		test	eax, eax
		jnz	short loc_4092F2
		mov	eax, [ebp-4]
		jmp	short locret_409303
; ---------------------------------------------------------------------------

loc_4092F2:				; CODE XREF: .text:004092EBj
		add	dword ptr [ebp-4], 1

loc_4092F6:				; CODE XREF: .text:004092CEj
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_4092D0

loc_4092FE:				; CODE XREF: .text:004092B4j
		mov	eax, 0

locret_409303:				; CODE XREF: .text:004092ACj
					; .text:004092F0j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409305	proc near		; CODE XREF: sub_4083C2+2D8p
					; sub_4083C2+2E4p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_40931D
; ---------------------------------------------------------------------------

loc_40930A:				; CODE XREF: sub_409305+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_40931D:				; CODE XREF: sub_409305+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40930A
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_409305	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409332(int, char *Control)
sub_409332	proc near		; CODE XREF: sub_401C06+9Ap
					; sub_401C06+E3p ...

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_11		= byte ptr -11h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Control		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_409350
		mov	eax, 0
		jmp	locret_4093FB
; ---------------------------------------------------------------------------

loc_409350:				; CODE XREF: sub_409332+12j
		mov	eax, [ebp+Control]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_409367
		mov	eax, [ebp+Control]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4093C0

loc_409367:				; CODE XREF: sub_409332+26j
		mov	eax, [ebp+Control]
		movzx	eax, byte ptr [eax]
		mov	[ebp+var_11], al
		cmp	[ebp+var_11], 0
		jnz	short loc_40937F
		mov	[ebp+var_C], 0
		jmp	short loc_4093D5
; ---------------------------------------------------------------------------

loc_40937F:				; CODE XREF: sub_409332+42j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp+var_11]
		jnz	short loc_409392
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_4093D5
; ---------------------------------------------------------------------------

loc_409392:				; CODE XREF: sub_409332+56j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4093A5
		mov	[ebp+var_C], 0
		jmp	short loc_4093D5
; ---------------------------------------------------------------------------

loc_4093A5:				; CODE XREF: sub_409332+68j
		movsx	eax, [ebp+var_11]
		mov	edx, [ebp+var_10]
		add	edx, 1
		mov	[esp+28h+Val], eax ; Val
		mov	[esp+28h+Str], edx ; Str
		call	strchr
		mov	[ebp+var_C], eax
		jmp	short loc_4093D5
; ---------------------------------------------------------------------------

loc_4093C0:				; CODE XREF: sub_409332+33j
		mov	eax, [ebp+Control]
		mov	[esp+28h+Val], eax ; Control
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	strpbrk
		mov	[ebp+var_C], eax

loc_4093D5:				; CODE XREF: sub_409332+4Bj
					; sub_409332+5Ej ...
		cmp	[ebp+var_C], 0
		jz	short loc_4093EF
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	short loc_4093F8
; ---------------------------------------------------------------------------

loc_4093EF:				; CODE XREF: sub_409332+A7j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

loc_4093F8:				; CODE XREF: sub_409332+BBj
		mov	eax, [ebp+var_10]

locret_4093FB:				; CODE XREF: sub_409332+19j
		leave
		retn
sub_409332	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+10h]
		add	[ebp-4], eax
		jmp	short loc_40942C
; ---------------------------------------------------------------------------

loc_409411:				; CODE XREF: .text:00409430j
		sub	dword ptr [ebp-4], 1
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+0Ch]
		jnz	short loc_409428
		mov	eax, [ebp-4]
		jmp	short locret_409437
; ---------------------------------------------------------------------------

loc_409428:				; CODE XREF: .text:00409421j
		sub	dword ptr [ebp+10h], 1

loc_40942C:				; CODE XREF: .text:0040940Fj
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_409411
		mov	eax, 0

locret_409437:				; CODE XREF: .text:00409426j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409439(int, char *, int)
sub_409439	proc near		; CODE XREF: .text:00409669p
					; .text:0040968Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40944F
		mov	eax, 0
		jmp	locret_40964C
; ---------------------------------------------------------------------------

loc_40944F:				; CODE XREF: sub_409439+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_4094A5
; ---------------------------------------------------------------------------

loc_40945E:				; CODE XREF: sub_409439+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_40949D
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_40949D
		cmp	[ebp+arg_4], 0
		jz	short loc_4094A1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4094A1

loc_40949D:				; CODE XREF: sub_409439+30j
					; sub_409439+3Dj
		add	[ebp+var_10], 1

loc_4094A1:				; CODE XREF: sub_409439+43j
					; sub_409439+62j
		add	[ebp+var_C], 1

loc_4094A5:				; CODE XREF: sub_409439+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40945E
		cmp	[ebp+arg_8], 0
		jz	short loc_4094D0
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_407A44
		mov	[ebp+var_14], eax
		jmp	short loc_4094F6
; ---------------------------------------------------------------------------

loc_4094D0:				; CODE XREF: sub_409439+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_407A31
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4094F6
		mov	eax, 0
		jmp	locret_40964C
; ---------------------------------------------------------------------------

loc_4094F6:				; CODE XREF: sub_409439+95j
					; sub_409439+B1j
		mov	[ebp+var_C], 0
		jmp	loc_409632
; ---------------------------------------------------------------------------

loc_409502:				; CODE XREF: sub_409439+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_409538
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_40962E
; ---------------------------------------------------------------------------

loc_409538:				; CODE XREF: sub_409439+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_40956E
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_40962E
; ---------------------------------------------------------------------------

loc_40956E:				; CODE XREF: sub_409439+107j
		cmp	[ebp+arg_4], 0
		jz	loc_40961C
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_40961C
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4095CF
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_4095DB
; ---------------------------------------------------------------------------

loc_4095CF:				; CODE XREF: sub_409439+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_4095DB:				; CODE XREF: sub_409439+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_409608
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_409614
; ---------------------------------------------------------------------------

loc_409608:				; CODE XREF: sub_409439+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_409614:				; CODE XREF: sub_409439+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_40962E
; ---------------------------------------------------------------------------

loc_40961C:				; CODE XREF: sub_409439+139j
					; sub_409439+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_40962E:				; CODE XREF: sub_409439+FAj
					; sub_409439+130j ...
		add	[ebp+arg_0], 1

loc_409632:				; CODE XREF: sub_409439+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_409502
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_40964C:				; CODE XREF: sub_409439+11j
					; sub_409439+B8j
		leave
		retn
sub_409439	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409439
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409439
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409692	proc near		; CODE XREF: .text:004097E1p
					; .text:00409820p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_40972B
; ---------------------------------------------------------------------------

loc_4096DE:				; CODE XREF: sub_409692+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_409727
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_4097A6
; ---------------------------------------------------------------------------

loc_409727:				; CODE XREF: sub_409692+7Fj
		add	[ebp+var_C], 1

loc_40972B:				; CODE XREF: sub_409692+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_4096DE
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax ; size_t
		call	sub_407A31
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4097A3
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_409795
; ---------------------------------------------------------------------------

loc_409775:				; CODE XREF: sub_409692+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_409305
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_409795:				; CODE XREF: sub_409692+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_409775

loc_4097A3:				; CODE XREF: sub_409692+D2j
		mov	eax, [ebp+var_18]

loc_4097A6:				; CODE XREF: sub_409692+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_409692	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4097CC
		mov	dword ptr [esp], offset	word_411002
		call	sub_407A68
		mov	[ebp-0Ch], eax
		jmp	short loc_4097E9
; ---------------------------------------------------------------------------

loc_4097CC:				; CODE XREF: .text:004097B9j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409692
		mov	[ebp-0Ch], eax

loc_4097E9:				; CODE XREF: .text:004097CAj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_40980B
		mov	dword ptr [esp], offset	word_411002
		call	sub_407B47
		mov	[ebp-0Ch], eax
		jmp	short loc_409828
; ---------------------------------------------------------------------------

loc_40980B:				; CODE XREF: .text:004097F8j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409692
		mov	[ebp-0Ch], eax

loc_409828:				; CODE XREF: .text:00409809j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40989C
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_409867
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 25h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		jmp	short loc_409890
; ---------------------------------------------------------------------------

loc_409867:				; CODE XREF: .text:0040983Aj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 16h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite

loc_409890:				; CODE XREF: .text:00409865j
		mov	dword ptr [esp], 2
		call	exit
; ---------------------------------------------------------------------------

loc_40989C:				; CODE XREF: .text:0040982Cj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_4133AC
		mov	[ebp-4], eax
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4098C2
		mov	ds:dword_4133AC, 0

loc_4098C2:				; CODE XREF: .text:004098B6j
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4133AC
		add	eax, 1
		mov	ds:dword_4133AC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4098D9(char *Filename, int FileHandle)
sub_4098D9	proc near		; CODE XREF: sub_409B38+21p
					; .text:00409B74p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_413320
		test	eax, eax
		jz	short loc_409923
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:dword_413320
		cmp	edx, eax
		jz	short loc_409919
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:dword_413320
		cmp	edx, eax
		jz	short loc_409919
		mov	eax, ds:dword_413320
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_409919:				; CODE XREF: sub_4098D9+20j
					; sub_4098D9+31j
		mov	ds:dword_413320, 0

loc_409923:				; CODE XREF: sub_4098D9+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_40996B
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_411054 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40996B
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_40996B:				; CODE XREF: sub_4098D9+4Ej
					; sub_4098D9+76j
		cmp	[ebp+Filename],	0
		jz	short loc_4099C1
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4099AD
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4099AD
		mov	eax, 1
		jmp	short loc_4099B2
; ---------------------------------------------------------------------------

loc_4099AD:				; CODE XREF: sub_4098D9+BEj
					; sub_4098D9+CBj
		mov	eax, 0

loc_4099B2:				; CODE XREF: sub_4098D9+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4099C8
		add	[ebp+Filename],	9
		jmp	short loc_4099C8
; ---------------------------------------------------------------------------

loc_4099C1:				; CODE XREF: sub_4098D9+96j
		mov	[ebp+var_10], 0

loc_4099C8:				; CODE XREF: sub_4098D9+E0j
					; sub_4098D9+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_409A04
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_409A5F
; ---------------------------------------------------------------------------

loc_409A04:				; CODE XREF: sub_4098D9+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_409A23
		mov	eax, offset aA	; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_409A5F
; ---------------------------------------------------------------------------

loc_409A23:				; CODE XREF: sub_4098D9+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_409A36
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_409A5F
; ---------------------------------------------------------------------------

loc_409A36:				; CODE XREF: sub_4098D9+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_409A49
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_409A5F
; ---------------------------------------------------------------------------

loc_409A49:				; CODE XREF: sub_4098D9+161j
		mov	[esp+28h+Size],	offset aA ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_409A5F:				; CODE XREF: sub_4098D9+129j
					; sub_4098D9+148j ...
		mov	dword_40F004, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_409AF4
		cmp	[ebp+Filename],	0
		jz	short loc_409AB1
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_409AE7
; ---------------------------------------------------------------------------

loc_409AB1:				; CODE XREF: sub_4098D9+19Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_409AE7:				; CODE XREF: sub_4098D9+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_409B17
; ---------------------------------------------------------------------------

loc_409AF4:				; CODE XREF: sub_4098D9+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_409B17:				; CODE XREF: sub_4098D9+219j
		mov	eax, [ebp+var_C]
		mov	ds:dword_413320, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_4133A4, eax
		mov	ds:dword_4133A8, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4098D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409B38(char *)
sub_409B38	proc near		; CODE XREF: sub_409CFA+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_409B49
		mov	eax, [ebp+arg_0]
		jmp	short loc_409B4E
; ---------------------------------------------------------------------------

loc_409B49:				; CODE XREF: sub_409B38+Aj
		mov	eax, offset asc_411054 ; "-"

loc_409B4E:				; CODE XREF: sub_409B38+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_4098D9
		leave
		retn
sub_409B38	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_4098D9
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_41339C, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_409BB6
		mov	dword ptr [esp+8], 4Fh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	byte_413340
		call	strncpy
		mov	ds:byte_41338F,	0

loc_409BB6:				; CODE XREF: .text:00409B92j
		mov	eax, [ebp+0Ch]
		and	eax, 1
		mov	ds:dword_413394, eax
		mov	eax, [ebp+0Ch]
		and	eax, 2
		mov	ds:dword_413390, eax
		mov	eax, [ebp+0Ch]
		and	eax, 4
		mov	ds:dword_413398, eax
		mov	eax, [ebp+0Ch]
		and	eax, 100h
		mov	ds:dword_4133A0, eax
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_409C58
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_413394
		test	eax, eax
		jz	short loc_409C10
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_409C10:				; CODE XREF: .text:00409BFFj
		mov	eax, ds:dword_413390
		test	eax, eax
		jz	short loc_409C28
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_409C28:				; CODE XREF: .text:00409C17j
		mov	eax, ds:dword_413398
		test	eax, eax
		jz	short loc_409C40
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_409C40:				; CODE XREF: .text:00409C2Fj
		mov	eax, ds:dword_4133A0
		test	eax, eax
		jz	short loc_409C58
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_409C58:				; CODE XREF: .text:00409BEDj
					; .text:00409C47j
		mov	eax, offset byte_413340
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_413320
		test	eax, eax
		jz	short loc_409C93
		mov	eax, ds:dword_413320
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_409C93
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_409C93
		mov	eax, 1
		jmp	short locret_409CB3
; ---------------------------------------------------------------------------

loc_409C93:				; CODE XREF: .text:00409C6Cj
					; .text:00409C82j ...
		mov	eax, dword_40F004
		cmp	eax, 0FFFFFFFFh
		jz	short loc_409CAE
		mov	eax, dword_40F004
		cmp	eax, [ebp+8]
		jnz	short loc_409CAE
		mov	eax, 1
		jmp	short locret_409CB3
; ---------------------------------------------------------------------------

loc_409CAE:				; CODE XREF: .text:00409C9Bj
					; .text:00409CA5j
		mov	eax, 0

locret_409CB3:				; CODE XREF: .text:00409C91j
					; .text:00409CACj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_413320
		test	eax, eax
		jnz	short loc_409CCE
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_409CD3
; ---------------------------------------------------------------------------

loc_409CCE:				; CODE XREF: .text:00409CC2j
		mov	eax, ds:dword_413320

loc_409CD3:				; CODE XREF: .text:00409CCCj
		mov	[esp], eax
		call	_fileno
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_413320
		test	eax, eax
		jnz	short loc_409CF3
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_409CF8
; ---------------------------------------------------------------------------

loc_409CF3:				; CODE XREF: .text:00409CE7j
		mov	eax, ds:dword_413320

loc_409CF8:				; CODE XREF: .text:00409CF1j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409CFA(int, char *Format, va_list ArgList)
sub_409CFA	proc near		; CODE XREF: sub_40A07D+22p
					; .text:0040A0C0p ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_413320
		test	eax, eax
		jnz	short loc_409D3D
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_409B38
		mov	eax, ds:dword_413320
		test	eax, eax
		jnz	short loc_409D3D
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_40ED10

loc_409D3D:				; CODE XREF: sub_409CFA+10j
					; sub_409CFA+25j
		mov	eax, ds:dword_4133A8
		test	eax, eax
		jz	short loc_409D61
		cmp	[ebp+arg_0], 1
		jz	short loc_409D61
		mov	eax, ds:dword_413320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_409D61:				; CODE XREF: sub_409CFA+4Aj
					; sub_409CFA+50j
		mov	ds:dword_4133A8, 0
		cmp	[ebp+arg_0], 1
		jz	loc_409EF8
		mov	eax, ds:dword_413390
		test	eax, eax
		jz	loc_409E11
		mov	eax, ds:dword_4133A4
		test	eax, eax
		jnz	loc_409E11
		mov	[esp+58h+var_58], 0
		call	sub_40EDF0
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_40EE00
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d_0 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:dword_413320
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_409E11:				; CODE XREF: sub_409CFA+82j
					; sub_409CFA+8Fj
		mov	eax, ds:dword_413394
		test	eax, eax
		jnz	short loc_409E23
		mov	eax, ds:dword_4133A4
		test	eax, eax
		jz	short loc_409E3A

loc_409E23:				; CODE XREF: sub_409CFA+11Ej
		mov	edx, ds:dword_413320
		mov	eax, offset byte_413340
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_409E3A:				; CODE XREF: sub_409CFA+127j
		mov	eax, ds:dword_413398
		test	eax, eax
		jnz	short loc_409E4C
		mov	eax, ds:dword_4133A4
		test	eax, eax
		jz	short loc_409EA6

loc_409E4C:				; CODE XREF: sub_409CFA+147j
		mov	eax, ds:dword_41339C
		test	eax, eax
		jz	short loc_409E85
		mov	eax, ds:dword_41339C
		call	eax ; dword_41339C
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:dword_413320
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_409EA6
; ---------------------------------------------------------------------------

loc_409E85:				; CODE XREF: sub_409CFA+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_0 ; "[%u]"
		mov	eax, ds:dword_413320
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_409EA6:				; CODE XREF: sub_409CFA+150j
					; sub_409CFA+189j
		mov	eax, ds:dword_413390
		test	eax, eax
		jz	short loc_409EB8
		mov	eax, ds:dword_4133A4
		test	eax, eax
		jz	short loc_409ECD

loc_409EB8:				; CODE XREF: sub_409CFA+1B3j
		mov	eax, ds:dword_413320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_409ECD:				; CODE XREF: sub_409CFA+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_409EE3
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_409EE3
		add	[ebp+Format], 1
		jmp	short loc_409EF8
; ---------------------------------------------------------------------------

loc_409EE3:				; CODE XREF: sub_409CFA+1D7j
					; sub_409CFA+1E1j
		mov	eax, ds:dword_413320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_409EF8:				; CODE XREF: sub_409CFA+75j
					; sub_409CFA+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_409F8C	; jumptable 00409F0F default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_411184
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_409F11:				; CODE XREF: sub_409CFA+215j
					; DATA XREF: .rdata:off_411184o
		mov	edx, ds:dword_413320 ; jumptable 00409F0F case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_409FAC
; ---------------------------------------------------------------------------

loc_409F3A:				; CODE XREF: sub_409CFA+215j
					; DATA XREF: .rdata:off_411184o
		mov	edx, ds:dword_413320 ; jumptable 00409F0F case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_409FAC
; ---------------------------------------------------------------------------

loc_409F63:				; CODE XREF: sub_409CFA+215j
					; DATA XREF: .rdata:off_411184o
		mov	edx, ds:dword_413320 ; jumptable 00409F0F case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_409FAC
; ---------------------------------------------------------------------------

loc_409F8C:				; CODE XREF: sub_409CFA+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	00409F0F default case
		mov	eax, ds:dword_413320
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_409FAC
; ---------------------------------------------------------------------------

loc_409FAB:				; CODE XREF: sub_409CFA+215j
					; DATA XREF: .rdata:off_411184o
		nop			; jumptable 00409F0F cases 0-4

loc_409FAC:				; CODE XREF: sub_409CFA+23Ej
					; sub_409CFA+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_40A01C
		mov	eax, ds:dword_413320
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40A00F
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_40A00F
		mov	ds:dword_4133A8, 1
		jmp	short loc_40A01C
; ---------------------------------------------------------------------------

loc_40A00F:				; CODE XREF: sub_409CFA+2DBj
					; sub_409CFA+307j
		mov	eax, ds:dword_413320
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_40A01C:				; CODE XREF: sub_409CFA+2B6j
					; sub_409CFA+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_40A04C
		mov	eax, ds:dword_4133A8
		test	eax, eax
		jz	short loc_40A040
		mov	eax, ds:dword_413320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_40A040:				; CODE XREF: sub_409CFA+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40A04C:				; CODE XREF: sub_409CFA+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_40A075
		mov	eax, ds:dword_4133A8
		test	eax, eax
		jz	short loc_40A070
		mov	eax, ds:dword_413320
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_40A070:				; CODE XREF: sub_409CFA+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_40A075:				; CODE XREF: sub_409CFA+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_409CFA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A07D(int, char *, char)
sub_40A07D	proc near		; CODE XREF: sub_40A280+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_409CFA
		leave
		retn
sub_40A07D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409CFA
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A0C7(char *, char)
sub_40A0C7	proc near		; CODE XREF: sub_40A2B4+8Ep
					; sub_40A2B4+C4p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_409CFA
		leave
		retn
sub_40A0C7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 4
		call	sub_409CFA
		mov	eax, ds:dword_4133AC
		cmp	eax, 752Fh
		jg	short locret_40A132
		mov	eax, ds:dword_4133AC
		add	eax, 1
		mov	ds:dword_4133AC, eax

locret_40A132:				; CODE XREF: .text:0040A123j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 5
		call	sub_409CFA
		call	abort
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 6
		call	sub_409CFA
		call	abort

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A18E(char *, char)
sub_40A18E	proc near		; CODE XREF: .text:0040A20Cp

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_409CFA
		leave
		retn
sub_40A18E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A1B8(char *, char)
sub_40A1B8	proc near		; CODE XREF: .text:0040A231p
					; .text:0040A254p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_409CFA
		leave
		retn
sub_40A1B8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40A211
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40A211
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4111A4
		call	sub_40A18E

loc_40A211:				; CODE XREF: .text:0040A1F2j
					; .text:0040A1FCj
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40A26C
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_1 ; "%02X"
		call	sub_40A1B8
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_40A25D
; ---------------------------------------------------------------------------

loc_40A240:				; CODE XREF: .text:0040A26Aj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_2 ; " %02X"
		call	sub_40A1B8
		add	dword ptr [ebp-0Ch], 1

loc_40A25D:				; CODE XREF: .text:0040A23Ej
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_40A240

loc_40A26C:				; CODE XREF: .text:0040A215j
		cmp	dword ptr [ebp+8], 0
		jz	short locret_40A27E
		mov	dword ptr [esp], offset	asc_4111B3 ; "\n"
		call	sub_40A1B8

locret_40A27E:				; CODE XREF: .text:0040A270j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_40A280	proc near		; CODE XREF: sub_4083C2+A7p
					; sub_40A915+6C5p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_40A07D
		call	abort
sub_40A280	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A2B4	proc near		; CODE XREF: .text:0040A62Ep
					; .text:0040A677p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_40A349
		cmp	[ebp+arg_0], 0
		jz	short loc_40A30D
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40A30D
		mov	eax, ds:dword_4133F0
		mov	[ebp+var_1C], eax
		mov	ds:dword_4133F0, 1
		jmp	short loc_40A31F
; ---------------------------------------------------------------------------

loc_40A30D:				; CODE XREF: sub_40A2B4+1Bj
					; sub_40A2B4+43j
		mov	eax, ds:dword_4133F4
		mov	[ebp+var_1C], eax
		mov	ds:dword_4133F4, 1

loc_40A31F:				; CODE XREF: sub_40A2B4+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_40A387
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_40CC20
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40A0C7
		jmp	short loc_40A387
; ---------------------------------------------------------------------------

loc_40A349:				; CODE XREF: sub_40A2B4+15j
		mov	eax, ds:dword_4133F8
		test	eax, eax
		jnz	short loc_40A37D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_40CC20
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40A0C7

loc_40A37D:				; CODE XREF: sub_40A2B4+9Cj
		mov	ds:dword_4133F8, 1

loc_40A387:				; CODE XREF: sub_40A2B4+6Fj
					; sub_40A2B4+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_40A3AB
		mov	off_40F008, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_4133C0, 0
		mov	ds:dword_4133C4, 0

loc_40A3AB:				; CODE XREF: sub_40A2B4+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40A2B4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jnz	loc_40A4BD
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40A3DE
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp-0Ch], eax

loc_40A3DE:				; CODE XREF: .text:0040A3D2j
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp-0Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4133D0
		call	sprintf
		mov	dword ptr [ebp+8], offset dword_4133D0
		mov	dword ptr [ebp-10h], offset aCp936 ; "CP936"
		jmp	loc_40A4AF
; ---------------------------------------------------------------------------

loc_40A40D:				; CODE XREF: .text:0040A4B7j
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4133D0
		call	strcmp
		test	eax, eax
		jz	short loc_40A43B
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_40A465
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A465

loc_40A43B:				; CODE XREF: .text:0040A422j
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp-10h]
		mov	[ebp+8], eax
		jmp	short loc_40A4BD
; ---------------------------------------------------------------------------

loc_40A465:				; CODE XREF: .text:0040A42Cj
					; .text:0040A439j
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax

loc_40A4AF:				; CODE XREF: .text:0040A408j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40A40D

loc_40A4BD:				; CODE XREF: .text:0040A3BEj
					; .text:0040A463j
		mov	eax, [ebp+8]
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_40A522
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], offset aIso ; "iso"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409163
		test	eax, eax
		jnz	short loc_40A522
		add	dword ptr [ebp+8], 3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_40A51E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_40A522

loc_40A51E:				; CODE XREF: .text:0040A512j
		add	dword ptr [ebp+8], 1

loc_40A522:				; CODE XREF: .text:0040A4E5j
					; .text:0040A504j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40A588
		mov	dword ptr [esp+4], offset a88591 ; "8859-1"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409029
		test	eax, eax
		jz	short loc_40A588
		mov	dword ptr [esp+4], offset a646 ; "646"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409029
		test	eax, eax
		jz	short loc_40A588
		mov	dword ptr [esp+4], offset aAscii ; "ASCII"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409029
		test	eax, eax
		jz	short loc_40A588
		mov	dword ptr [esp+4], offset aAnsi_x3_41968 ; "ANSI_X3.4-1968"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409029
		test	eax, eax
		jnz	short loc_40A5AB

loc_40A588:				; CODE XREF: .text:0040A52Aj
					; .text:0040A541j ...
		mov	off_40F008, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_4133C0, 0
		mov	ds:dword_4133C4, 0
		jmp	loc_40A6AA
; ---------------------------------------------------------------------------

loc_40A5AB:				; CODE XREF: .text:0040A586j
		mov	dword ptr [esp+4], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409029
		test	eax, eax
		jz	short loc_40A5D9
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409029
		test	eax, eax
		jnz	short loc_40A5FC

loc_40A5D9:				; CODE XREF: .text:0040A5C0j
		mov	off_40F008, offset aUtf8 ; "utf-8"
		mov	ds:dword_4133C0, 1
		mov	ds:dword_4133C4, 0
		jmp	loc_40A6AA
; ---------------------------------------------------------------------------

loc_40A5FC:				; CODE XREF: .text:0040A5D7j
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	libiconv_open
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_40A63A
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40A2B4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40A6AF
; ---------------------------------------------------------------------------

loc_40A63A:				; CODE XREF: .text:0040A616j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	libiconv_close
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	libiconv_open
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_40A683
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	sub_40A2B4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40A6AF
; ---------------------------------------------------------------------------

loc_40A683:				; CODE XREF: .text:0040A65Fj
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	libiconv_close
		mov	eax, [ebp-14h]
		mov	off_40F008, eax
		mov	ds:dword_4133C0, 0
		mov	ds:dword_4133C4, 1

loc_40A6AA:				; CODE XREF: .text:0040A5A6j
					; .text:0040A5F7j
		mov	eax, 0

loc_40A6AF:				; CODE XREF: .text:0040A638j
					; .text:0040A681j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_40F008
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4133C0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A6C9(char *)
sub_40A6C9	proc near		; CODE XREF: sub_40A6C9+129p

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_4133C0
		test	eax, eax
		jz	short loc_40A6FB
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_407B47
		mov	[ebp+var_20], eax
		jmp	loc_40A90A
; ---------------------------------------------------------------------------

loc_40A6FB:				; CODE XREF: sub_40A6C9+1Dj
		mov	eax, ds:dword_4133C4
		test	eax, eax
		jnz	loc_40A7B1
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_40A726
; ---------------------------------------------------------------------------

loc_40A710:				; CODE XREF: sub_40A6C9+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40A722
		add	[ebp+var_28], 1

loc_40A722:				; CODE XREF: sub_40A6C9+53j
		add	[ebp+var_1C], 1

loc_40A726:				; CODE XREF: sub_40A6C9+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A710
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_407A44
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_40A79C
; ---------------------------------------------------------------------------

loc_40A74F:				; CODE XREF: sub_40A6C9+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40A789
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_40A798
; ---------------------------------------------------------------------------

loc_40A789:				; CODE XREF: sub_40A6C9+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_40A798:				; CODE XREF: sub_40A6C9+BEj
		add	[ebp+var_1C], 1

loc_40A79C:				; CODE XREF: sub_40A6C9+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A74F
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_40A90A
; ---------------------------------------------------------------------------

loc_40A7B1:				; CODE XREF: sub_40A6C9+39j
		mov	eax, off_40F008
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_40A7FC
		mov	eax, off_40F008
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_40A2B4
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_40A6C9
		jmp	loc_40A90D
; ---------------------------------------------------------------------------

loc_40A7FC:				; CODE XREF: sub_40A6C9+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_40A81A
; ---------------------------------------------------------------------------

loc_40A804:				; CODE XREF: sub_40A6C9+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40A816
		add	[ebp+var_28], 5

loc_40A816:				; CODE XREF: sub_40A6C9+147j
		add	[ebp+var_1C], 1

loc_40A81A:				; CODE XREF: sub_40A6C9+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A804
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_407A44
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40A8F9
		mov	eax, ds:dword_4133CC
		test	eax, eax
		jnz	short loc_40A8DB
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_40F008
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_40CC20
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_40A0C7

loc_40A8DB:				; CODE XREF: sub_40A6C9+1D3j
		mov	ds:dword_4133CC, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_40A8FF
; ---------------------------------------------------------------------------

loc_40A8F9:				; CODE XREF: sub_40A6C9+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_40A8FF:				; CODE XREF: sub_40A6C9+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_40A90A:				; CODE XREF: sub_40A6C9+2Dj
					; sub_40A6C9+E3j
		mov	eax, [ebp+var_20]

loc_40A90D:				; CODE XREF: sub_40A6C9+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40A6C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A915	proc near		; CODE XREF: sub_40A915+797p
					; sub_40B0E7+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_40A939:				; CODE XREF: sub_40A915+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_40AEDB
; ---------------------------------------------------------------------------

loc_40A95E:				; CODE XREF: sub_40A915+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_40A9BD
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40A9B6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_40A982
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_40A9B6

loc_40A982:				; CODE XREF: sub_40A915+61j
		cmp	[ebp+var_24], 0
		jz	short loc_40A9AD
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_40A9AD:				; CODE XREF: sub_40A915+71j
		add	[ebp+var_1C], 4
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40A9B6:				; CODE XREF: sub_40A915+57j
					; sub_40A915+6Bj
		mov	[ebp+var_30], 0

loc_40A9BD:				; CODE XREF: sub_40A915+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_40ACF0
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_40AB48
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_40AB28
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_40AA19
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_40AA19
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_40AA19
		cmp	[ebp+arg_8], 0
		jz	loc_40AB28
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_40AB28

loc_40AA19:				; CODE XREF: sub_40A915+D2j
					; sub_40A915+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_40AA2D
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_40AA2D:				; CODE XREF: sub_40A915+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_40AADE	; jumptable 0040AA46 default case
		mov	eax, ds:off_4113CC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40AA48:				; CODE XREF: sub_40A915+131j
					; DATA XREF: .rdata:off_4113CCo
		add	[ebp+var_1C], 1	; jumptable 0040AA46 case 10
		cmp	[ebp+var_24], 0
		jz	loc_40AB0F
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_40AB0F
; ---------------------------------------------------------------------------

loc_40AA65:				; CODE XREF: sub_40A915+131j
					; DATA XREF: .rdata:off_4113CCo
		add	[ebp+var_1C], 1	; jumptable 0040AA46 case 13
		cmp	[ebp+var_24], 0
		jz	loc_40AB12
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_40AB12
; ---------------------------------------------------------------------------

loc_40AA82:				; CODE XREF: sub_40A915+131j
					; DATA XREF: .rdata:off_4113CCo
		add	[ebp+var_1C], 1	; jumptable 0040AA46 case 12
		cmp	[ebp+var_24], 0
		jz	loc_40AB15
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_40AB15
; ---------------------------------------------------------------------------

loc_40AA9C:				; CODE XREF: sub_40A915+131j
					; DATA XREF: .rdata:off_4113CCo
		add	[ebp+var_1C], 1	; jumptable 0040AA46 case 11
		cmp	[ebp+var_24], 0
		jz	short loc_40AB18
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_40AB18
; ---------------------------------------------------------------------------

loc_40AAB2:				; CODE XREF: sub_40A915+131j
					; DATA XREF: .rdata:off_4113CCo
		add	[ebp+var_1C], 1	; jumptable 0040AA46 case 8
		cmp	[ebp+var_24], 0
		jz	short loc_40AB1B
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_40AB1B
; ---------------------------------------------------------------------------

loc_40AAC8:				; CODE XREF: sub_40A915+131j
					; DATA XREF: .rdata:off_4113CCo
		add	[ebp+var_1C], 1	; jumptable 0040AA46 case 0
		cmp	[ebp+var_24], 0
		jz	short loc_40AB1E
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_40AB1E
; ---------------------------------------------------------------------------

loc_40AADE:				; CODE XREF: sub_40A915+124j
					; sub_40A915+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 0040AA46 default case
		cmp	[ebp+var_24], 0
		jz	short loc_40AB21
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_40AB21
; ---------------------------------------------------------------------------

loc_40AB0F:				; CODE XREF: sub_40A915+13Bj
					; sub_40A915+14Bj
		nop
		jmp	short loc_40AB22
; ---------------------------------------------------------------------------

loc_40AB12:				; CODE XREF: sub_40A915+158j
					; sub_40A915+168j
		nop
		jmp	short loc_40AB22
; ---------------------------------------------------------------------------

loc_40AB15:				; CODE XREF: sub_40A915+175j
					; sub_40A915+185j
		nop
		jmp	short loc_40AB22
; ---------------------------------------------------------------------------

loc_40AB18:				; CODE XREF: sub_40A915+18Fj
					; sub_40A915+19Bj
		nop
		jmp	short loc_40AB22
; ---------------------------------------------------------------------------

loc_40AB1B:				; CODE XREF: sub_40A915+1A5j
					; sub_40A915+1B1j
		nop
		jmp	short loc_40AB22
; ---------------------------------------------------------------------------

loc_40AB1E:				; CODE XREF: sub_40A915+1BBj
					; sub_40A915+1C7j
		nop
		jmp	short loc_40AB22
; ---------------------------------------------------------------------------

loc_40AB21:				; CODE XREF: sub_40A915+1D1j
					; sub_40A915+1F8j
		nop

loc_40AB22:				; CODE XREF: sub_40A915+1FBj
					; sub_40A915+1FEj ...
		nop
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40AB28:				; CODE XREF: sub_40A915+C4j
					; sub_40A915+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_40AB3F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_40AB3F:				; CODE XREF: sub_40A915+217j
		add	[ebp+var_1C], 1
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40AB48:				; CODE XREF: sub_40A915+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_40AB91
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40AB91:				; CODE XREF: sub_40A915+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_40ABDA
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40ABDA:				; CODE XREF: sub_40A915+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_40AC23
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40AC23:				; CODE XREF: sub_40A915+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_40AC6C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40AC6C:				; CODE XREF: sub_40A915+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_40ACB5
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40ACB5:				; CODE XREF: sub_40A915+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_40ACE0
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_40ACE0:				; CODE XREF: sub_40A915+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40ACF0:				; CODE XREF: sub_40A915+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40AD08
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_40AD96

loc_40AD08:				; CODE XREF: sub_40A915+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_40AD70
		mov	[ebp+var_10], 0
		jmp	short loc_40AD43
; ---------------------------------------------------------------------------

loc_40AD17:				; CODE XREF: sub_40A915+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_40AD43:				; CODE XREF: sub_40A915+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40AD17
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_40AD70:				; CODE XREF: sub_40A915+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40AD96:				; CODE XREF: sub_40A915+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_40AED3
		mov	eax, ds:dword_4133C0
		test	eax, eax
		jz	short loc_40AE13
		cmp	[ebp+var_24], 0
		jz	short loc_40AE01
		mov	[ebp+var_10], 0
		jmp	short loc_40ADF9
; ---------------------------------------------------------------------------

loc_40ADE1:				; CODE XREF: sub_40A915+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_40ADF9:				; CODE XREF: sub_40A915+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40ADE1

loc_40AE01:				; CODE XREF: sub_40A915+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40AE13:				; CODE XREF: sub_40A915+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_40AE57
		cmp	[ebp+var_24], 0
		jz	short loc_40AE48
		mov	[ebp+var_10], 0
		jmp	short loc_40AE40
; ---------------------------------------------------------------------------

loc_40AE28:				; CODE XREF: sub_40A915+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_40AE40:				; CODE XREF: sub_40A915+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40AE28

loc_40AE48:				; CODE XREF: sub_40A915+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_40AED3
; ---------------------------------------------------------------------------

loc_40AE57:				; CODE XREF: sub_40A915+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_40AE80
		cmp	[ebp+var_28], 0FFh
		ja	short loc_40AE80
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_40AED3
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_40AED3
; ---------------------------------------------------------------------------

loc_40AE80:				; CODE XREF: sub_40A915+546j
					; sub_40A915+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_40AEC3
		mov	[ebp+var_10], 0
		jmp	short loc_40AEBB
; ---------------------------------------------------------------------------

loc_40AE8F:				; CODE XREF: sub_40A915+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_40AEBB:				; CODE XREF: sub_40A915+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40AE8F

loc_40AEC3:				; CODE XREF: sub_40A915+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_40AED3:				; CODE XREF: sub_40A915+9Cj
					; sub_40A915+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_40AEDB:				; CODE XREF: sub_40A915+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_40A95E
		cmp	[ebp+var_20], 0
		jnz	short loc_40AF07
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_407A44
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_40A939
; ---------------------------------------------------------------------------

loc_40AF07:				; CODE XREF: sub_40A915+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_40B0D7
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_40F008
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_40AF7B
		mov	eax, off_40F008
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_40A2B4
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_407BA1
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_40B0E7
		jmp	loc_40B0E0
; ---------------------------------------------------------------------------

loc_40AF7B:				; CODE XREF: sub_40A915+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_40AFDF
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_40A280
; ---------------------------------------------------------------------------

loc_40AFDF:				; CODE XREF: sub_40A915+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_407A44
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_40B0B6
		mov	eax, ds:dword_4133C8
		test	eax, eax
		jnz	short loc_40B069
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_40F008
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_40CC20
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_40A0C7

loc_40B069:				; CODE XREF: sub_40A915+715j
		mov	ds:dword_4133C8, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_407BA1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_407BA1
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_40A915
		mov	[ebp+var_34], eax
		jmp	short loc_40B0C7
; ---------------------------------------------------------------------------

loc_40B0B6:				; CODE XREF: sub_40A915+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_407BA1

loc_40B0C7:				; CODE XREF: sub_40A915+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_40B0E0
; ---------------------------------------------------------------------------

loc_40B0D7:				; CODE XREF: sub_40A915+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_40B0E0:				; CODE XREF: sub_40A915+661j
					; sub_40A915+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40A915	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B0E7	proc near		; CODE XREF: sub_408B60+50p
					; sub_40A915+65Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4133C4
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40A915
		leave
		retn
sub_40B0E7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_open
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_close
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B170(char *)
sub_40B170	proc near		; CODE XREF: .text:0040C357p
					; .text:0040CC94p

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B19D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40B19D
		mov	eax, [ebp+var_C]
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B19D:				; CODE XREF: sub_40B170+19j
					; sub_40B170+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B1C3
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40B1C3
		mov	eax, [ebp+var_C]
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B1C3:				; CODE XREF: sub_40B170+3Fj
					; sub_40B170+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B1EA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40B1EA
		mov	eax, [ebp+var_C]
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B1EA:				; CODE XREF: sub_40B170+66j
					; sub_40B170+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_40BCB0	; jumptable 0040B22C default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_411980
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B22E:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aAf_za ; jumptable 0040B22C	case 54
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B238:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSq_al ; jumptable 0040B22C	case 28
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B242:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aAm_et ; jumptable 0040B22C	case 94
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B24C:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		cmp	[ebp+var_1C], 10h ; jumptable 0040B22C case 1
		ja	loc_40B305	; jumptable 0040B263 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_411B68
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B265:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_sa ; jumptable 0040B263	case 1
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B26F:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_iq ; jumptable 0040B263	case 2
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B279:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_eg ; jumptable 0040B263	case 3
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B283:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_ly ; jumptable 0040B263	case 4
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B28D:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_dz ; jumptable 0040B263	case 5
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B297:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_ma ; jumptable 0040B263	case 6
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2A1:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_tn ; jumptable 0040B263	case 7
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2AB:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_om ; jumptable 0040B263	case 8
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2B5:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_ye ; jumptable 0040B263	case 9
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2BF:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_sy ; jumptable 0040B263	case 10
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2C9:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_jo ; jumptable 0040B263	case 11
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2D3:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_lb ; jumptable 0040B263	case 12
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2DD:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_kw ; jumptable 0040B263	case 13
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2E7:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_ae ; jumptable 0040B263	case 14
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2F1:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_bh ; jumptable 0040B263	case 15
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B2FB:				; CODE XREF: sub_40B170+F3j
					; DATA XREF: .rdata:off_411B68o
		mov	eax, offset aAr_qa ; jumptable 0040B263	case 16
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B305:				; CODE XREF: sub_40B170+E0j
					; sub_40B170+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 0040B263 default case
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B30F:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aHy_am ; jumptable 0040B22C	case 43
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B319:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aAs_in ; jumptable 0040B22C	case 77
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B323:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 44
		cmp	eax, 1
		jz	short loc_40B332
		cmp	eax, 2
		jz	short loc_40B33C
		jmp	short loc_40B346
; ---------------------------------------------------------------------------

loc_40B332:				; CODE XREF: sub_40B170+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B33C:				; CODE XREF: sub_40B170+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B346:				; CODE XREF: sub_40B170+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B350:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aEu	; jumptable 0040B22C case 45
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B35A:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aBe_by ; jumptable 0040B22C	case 35
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B364:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 69
		cmp	eax, 1
		jz	short loc_40B373
		cmp	eax, 2
		jz	short loc_40B37D
		jmp	short loc_40B387
; ---------------------------------------------------------------------------

loc_40B373:				; CODE XREF: sub_40B170+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B37D:				; CODE XREF: sub_40B170+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B387:				; CODE XREF: sub_40B170+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B391:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aBg_bg ; jumptable 0040B22C	case 2
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B39B:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aMy_mm ; jumptable 0040B22C	case 85
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B3A5:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aKm_kh ; jumptable 0040B22C	case 83
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B3AF:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aCa_es ; jumptable 0040B22C	case 3
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B3B9:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aChr_us ; jumptable	0040B22C case 92
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B3C3:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		cmp	[ebp+var_1C], 5	; jumptable 0040B22C case 4
		ja	short loc_40B40A ; jumptable 0040B3D6 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_411BAC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B3D8:				; CODE XREF: sub_40B170+266j
					; DATA XREF: .rdata:off_411BACo
		mov	eax, offset aZh_tw ; jumptable 0040B3D6	case 1
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B3E2:				; CODE XREF: sub_40B170+266j
					; DATA XREF: .rdata:off_411BACo
		mov	eax, offset aZh_cn ; jumptable 0040B3D6	case 2
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B3EC:				; CODE XREF: sub_40B170+266j
					; DATA XREF: .rdata:off_411BACo
		mov	eax, offset aZh_hk ; jumptable 0040B3D6	case 3
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B3F6:				; CODE XREF: sub_40B170+266j
					; DATA XREF: .rdata:off_411BACo
		mov	eax, offset aZh_sg ; jumptable 0040B3D6	case 4
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B400:				; CODE XREF: sub_40B170+266j
					; DATA XREF: .rdata:off_411BACo
		mov	eax, offset aZh_mo ; jumptable 0040B3D6	case 5
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B40A:				; CODE XREF: sub_40B170+257j
					; sub_40B170+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 0040B3D6 default case
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B414:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 26
		cmp	eax, 2
		jz	short loc_40B430
		cmp	eax, 3
		jz	short loc_40B43A
		cmp	eax, 1
		jnz	short loc_40B444
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B430:				; CODE XREF: sub_40B170+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B43A:				; CODE XREF: sub_40B170+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B444:				; CODE XREF: sub_40B170+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B44E:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aCs_cz ; jumptable 0040B22C	case 5
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B458:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aDa_dk ; jumptable 0040B22C	case 6
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B462:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aDiv_mv ; jumptable	0040B22C case 101
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B46C:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 19
		cmp	eax, 1
		jz	short loc_40B47B
		cmp	eax, 2
		jz	short loc_40B485
		jmp	short loc_40B48F
; ---------------------------------------------------------------------------

loc_40B47B:				; CODE XREF: sub_40B170+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B485:				; CODE XREF: sub_40B170+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B48F:				; CODE XREF: sub_40B170+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B499:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aBin_ng ; jumptable	0040B22C case 102
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B4A3:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		cmp	[ebp+var_1C], 12h ; jumptable 0040B22C case 9
		ja	loc_40B570	; jumptable 0040B4BA default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_411BC4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B4BC:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_us ; jumptable 0040B4BA	case 1
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B4C6:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_gb ; jumptable 0040B4BA	case 2
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B4D0:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_au ; jumptable 0040B4BA	case 3
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B4DA:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_ca ; jumptable 0040B4BA	case 4
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B4E4:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_nz ; jumptable 0040B4BA	case 5
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B4EE:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_ie ; jumptable 0040B4BA	case 6
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B4F8:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_za ; jumptable 0040B4BA	case 7
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B502:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_jm ; jumptable 0040B4BA	case 8
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B50C:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_gd ; jumptable 0040B4BA	case 9
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B516:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_bz ; jumptable 0040B4BA	case 10
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B520:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_tt ; jumptable 0040B4BA	case 11
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B52A:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_zw ; jumptable 0040B4BA	case 12
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B534:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_ph ; jumptable 0040B4BA	case 13
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B53E:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_id ; jumptable 0040B4BA	case 14
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B548:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_hk ; jumptable 0040B4BA	case 15
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B552:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_in ; jumptable 0040B4BA	case 16
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B55C:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_my ; jumptable 0040B4BA	case 17
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B566:				; CODE XREF: sub_40B170+34Aj
					; DATA XREF: .rdata:off_411BC4o
		mov	eax, offset aEn_sg ; jumptable 0040B4BA	case 18
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B570:				; CODE XREF: sub_40B170+337j
					; sub_40B170+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn	; jumptable 0040B4BA default case
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B57A:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aEt_ee ; jumptable 0040B22C	case 37
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B584:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aFo_fo ; jumptable 0040B22C	case 56
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B58E:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aFa_ir ; jumptable 0040B22C	case 41
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B598:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aFi_fi ; jumptable 0040B22C	case 11
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B5A2:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		cmp	[ebp+var_1C], 0Fh ; jumptable 0040B22C case 12
		ja	loc_40B651	; jumptable 0040B5B9 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_411C10
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B5BB:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_fr ; jumptable 0040B5B9	case 1
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B5C5:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_be ; jumptable 0040B5B9	case 2
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B5CF:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_ca ; jumptable 0040B5B9	case 3
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B5D9:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_ch ; jumptable 0040B5B9	case 4
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B5E3:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_lu ; jumptable 0040B5B9	case 5
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B5ED:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_mc ; jumptable 0040B5B9	case 6
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B5F7:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr	; jumptable 0040B5B9 case 7
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B601:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_re ; jumptable 0040B5B9	case 8
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B60B:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_cg ; jumptable 0040B5B9	case 9
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B615:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_sn ; jumptable 0040B5B9	case 10
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B61F:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_cm ; jumptable 0040B5B9	case 11
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B629:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_ci ; jumptable 0040B5B9	case 12
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B633:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_ml ; jumptable 0040B5B9	case 13
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B63D:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_ma ; jumptable 0040B5B9	case 14
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B647:				; CODE XREF: sub_40B170+449j
					; DATA XREF: .rdata:off_411C10o
		mov	eax, offset aFr_ht ; jumptable 0040B5B9	case 15
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B651:				; CODE XREF: sub_40B170+436j
					; sub_40B170+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 0040B5B9 default case
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B65B:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aFy_nl ; jumptable 0040B22C	case 98
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B665:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aFul_ng ; jumptable	0040B22C case 103
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B66F:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 60
		cmp	eax, 1
		jz	short loc_40B67E
		cmp	eax, 2
		jz	short loc_40B688
		jmp	short loc_40B692
; ---------------------------------------------------------------------------

loc_40B67E:				; CODE XREF: sub_40B170+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B688:				; CODE XREF: sub_40B170+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B692:				; CODE XREF: sub_40B170+50Cj
		mov	eax, offset aC	; "C"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B69C:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aGl_es ; jumptable 0040B22C	case 86
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B6A6:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aKa_ge ; jumptable 0040B22C	case 55
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B6B0:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		cmp	[ebp+var_1C], 5	; jumptable 0040B22C case 7
		ja	short loc_40B6F7 ; jumptable 0040B6C3 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_411C50
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40B6C5:				; CODE XREF: sub_40B170+553j
					; DATA XREF: .rdata:off_411C50o
		mov	eax, offset aDe_de ; jumptable 0040B6C3	case 1
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B6CF:				; CODE XREF: sub_40B170+553j
					; DATA XREF: .rdata:off_411C50o
		mov	eax, offset aDe_ch ; jumptable 0040B6C3	case 2
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B6D9:				; CODE XREF: sub_40B170+553j
					; DATA XREF: .rdata:off_411C50o
		mov	eax, offset aDe_at ; jumptable 0040B6C3	case 3
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B6E3:				; CODE XREF: sub_40B170+553j
					; DATA XREF: .rdata:off_411C50o
		mov	eax, offset aDe_lu ; jumptable 0040B6C3	case 4
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B6ED:				; CODE XREF: sub_40B170+553j
					; DATA XREF: .rdata:off_411C50o
		mov	eax, offset aDe_li ; jumptable 0040B6C3	case 5
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B6F7:				; CODE XREF: sub_40B170+544j
					; sub_40B170+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 0040B6C3 default case
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B701:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aEl_gr ; jumptable 0040B22C	case 8
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B70B:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aGn_py ; jumptable 0040B22C	case 116
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B715:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aGu_in ; jumptable 0040B22C	case 71
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B71F:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aHa_ng ; jumptable 0040B22C	case 104
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B729:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aCpe_us ; jumptable	0040B22C case 117
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B733:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aHe_il ; jumptable 0040B22C	case 13
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B73D:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aHi_in ; jumptable 0040B22C	case 57
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B747:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aHu_hu ; jumptable 0040B22C	case 14
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B751:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aNic_ng ; jumptable	0040B22C case 105
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B75B:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aIs_is ; jumptable 0040B22C	case 15
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B765:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aIbo_ng ; jumptable	0040B22C case 112
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B76F:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aId_id ; jumptable 0040B22C	case 33
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B779:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aIu_ca ; jumptable 0040B22C	case 93
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B783:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 16
		cmp	eax, 1
		jz	short loc_40B792
		cmp	eax, 2
		jz	short loc_40B79C
		jmp	short loc_40B7A6
; ---------------------------------------------------------------------------

loc_40B792:				; CODE XREF: sub_40B170+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B79C:				; CODE XREF: sub_40B170+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B7A6:				; CODE XREF: sub_40B170+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B7B0:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aJa_jp ; jumptable 0040B22C	case 17
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B7BA:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aKn_in ; jumptable 0040B22C	case 75
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B7C4:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aKau_ng ; jumptable	0040B22C case 113
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B7CE:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 96
		cmp	eax, 1
		jz	short loc_40B7DD
		cmp	eax, 2
		jz	short loc_40B7E7
		jmp	short loc_40B7F1
; ---------------------------------------------------------------------------

loc_40B7DD:				; CODE XREF: sub_40B170+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B7E7:				; CODE XREF: sub_40B170+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B7F1:				; CODE XREF: sub_40B170+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B7FB:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aKk_kz ; jumptable 0040B22C	case 63
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B805:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aKok_in ; jumptable	0040B22C case 87
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B80F:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aKo_kr ; jumptable 0040B22C	case 18
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B819:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aKy_kg ; jumptable 0040B22C	case 64
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B823:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aLo_la ; jumptable 0040B22C	case 84
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B82D:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aLa_va ; jumptable 0040B22C	case 118
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B837:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aLv_lv ; jumptable 0040B22C	case 38
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B841:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aLt_lt ; jumptable 0040B22C	case 39
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B84B:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aMk_mk ; jumptable 0040B22C	case 47
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B855:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 62
		cmp	eax, 1
		jz	short loc_40B864
		cmp	eax, 2
		jz	short loc_40B86E
		jmp	short loc_40B878
; ---------------------------------------------------------------------------

loc_40B864:				; CODE XREF: sub_40B170+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B86E:				; CODE XREF: sub_40B170+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B878:				; CODE XREF: sub_40B170+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B882:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aMl_in ; jumptable 0040B22C	case 76
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B88C:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aMt_mt ; jumptable 0040B22C	case 58
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B896:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aMni_in ; jumptable	0040B22C case 88
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B8A0:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aMr_in ; jumptable 0040B22C	case 78
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B8AA:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aMn	; jumptable 0040B22C case 80
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B8B4:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 97
		cmp	eax, 1
		jz	short loc_40B8C3
		cmp	eax, 2
		jz	short loc_40B8CD
		jmp	short loc_40B8D7
; ---------------------------------------------------------------------------

loc_40B8C3:				; CODE XREF: sub_40B170+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B8CD:				; CODE XREF: sub_40B170+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B8D7:				; CODE XREF: sub_40B170+751j
		mov	eax, offset aNe	; "ne"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B8E1:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 20
		cmp	eax, 1
		jz	short loc_40B8F0
		cmp	eax, 2
		jz	short loc_40B8FA
		jmp	short loc_40B904
; ---------------------------------------------------------------------------

loc_40B8F0:				; CODE XREF: sub_40B170+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B8FA:				; CODE XREF: sub_40B170+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B904:				; CODE XREF: sub_40B170+77Ej
		mov	eax, offset aNo_2 ; "no"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B90E:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aOr_in ; jumptable 0040B22C	case 72
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B918:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aOm_et ; jumptable 0040B22C	case 114
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B922:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aPap_an ; jumptable	0040B22C case 121
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B92C:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aPs	; jumptable 0040B22C case 99
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B936:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aPl_pl ; jumptable 0040B22C	case 21
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B940:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 22
		cmp	eax, 1
		jz	short loc_40B957
		cmp	eax, 2
		jnz	short loc_40B961
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B957:				; CODE XREF: sub_40B170+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B961:				; CODE XREF: sub_40B170+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B96B:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 70
		cmp	eax, 1
		jnz	short loc_40B97D
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B97D:				; CODE XREF: sub_40B170+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B987:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aRm_ch ; jumptable 0040B22C	case 23
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B991:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 24
		cmp	eax, 1
		jnz	short loc_40B9A3
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B9A3:				; CODE XREF: sub_40B170+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B9AD:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aRu	; jumptable 0040B22C case 25
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B9B7:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSe_no ; jumptable 0040B22C	case 59
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B9C1:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSa_in ; jumptable 0040B22C	case 79
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B9CB:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 89
		test	eax, eax
		jz	short loc_40B9D9
		cmp	eax, 1
		jz	short loc_40B9E3
		jmp	short loc_40B9ED
; ---------------------------------------------------------------------------

loc_40B9D9:				; CODE XREF: sub_40B170+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B9E3:				; CODE XREF: sub_40B170+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B9ED:				; CODE XREF: sub_40B170+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40B9F7:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSi_lk ; jumptable 0040B22C	case 91
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA01:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSk_sk ; jumptable 0040B22C	case 27
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA0B:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSl_si ; jumptable 0040B22C	case 36
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA15:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSo_so ; jumptable 0040B22C	case 119
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA1F:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aWen_de ; jumptable	0040B22C case 46
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA29:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		cmp	[ebp+var_1C], 14h ; jumptable 0040B22C case 10
		ja	loc_40BB0A	; jumptable 0040BA40 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_411C68
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40BA42:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_es ; jumptable 0040BA40	case 1
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA4C:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_mx ; jumptable 0040BA40	case 2
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA56:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_es@modern ; jumptable 0040BA40 case 3
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA60:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_gt ; jumptable 0040BA40	case 4
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA6A:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_cr ; jumptable 0040BA40	case 5
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA74:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_pa ; jumptable 0040BA40	case 6
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA7E:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_do ; jumptable 0040BA40	case 7
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA88:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_ve ; jumptable 0040BA40	case 8
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA92:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_co ; jumptable 0040BA40	case 9
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BA9C:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_pe ; jumptable 0040BA40	case 10
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BAA6:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_ar ; jumptable 0040BA40	case 11
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BAB0:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_ec ; jumptable 0040BA40	case 12
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BABA:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_cl ; jumptable 0040BA40	case 13
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BAC4:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_uy ; jumptable 0040BA40	case 14
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BACE:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_py ; jumptable 0040BA40	case 15
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BAD8:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_bo ; jumptable 0040BA40	case 16
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BAE2:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_sv ; jumptable 0040BA40	case 17
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BAEC:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_hn ; jumptable 0040BA40	case 18
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BAF6:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_ni ; jumptable 0040BA40	case 19
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB00:				; CODE XREF: sub_40B170+8D0j
					; DATA XREF: .rdata:off_411C68o
		mov	eax, offset aEs_pr ; jumptable 0040BA40	case 20
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB0A:				; CODE XREF: sub_40B170+8BDj
					; sub_40B170+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 0040BA40 default case
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB14:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aBnt_tz ; jumptable	0040B22C case 48
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB1E:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSw_ke ; jumptable 0040B22C	case 65
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB28:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 29
		cmp	eax, 1
		jz	short loc_40BB37
		cmp	eax, 2
		jz	short loc_40BB41
		jmp	short loc_40BB4B
; ---------------------------------------------------------------------------

loc_40BB37:				; CODE XREF: sub_40B170+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB41:				; CODE XREF: sub_40B170+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB4B:				; CODE XREF: sub_40B170+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB55:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSyr_tr ; jumptable	0040B22C case 90
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB5F:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTl_ph ; jumptable 0040B22C	case 100
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB69:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTg_tj ; jumptable 0040B22C	case 40
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB73:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 95
		cmp	eax, 1
		jz	short loc_40BB82
		cmp	eax, 2
		jz	short loc_40BB8C
		jmp	short loc_40BB96
; ---------------------------------------------------------------------------

loc_40BB82:				; CODE XREF: sub_40B170+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB8C:				; CODE XREF: sub_40B170+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BB96:				; CODE XREF: sub_40B170+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BBA0:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTa	; jumptable 0040B22C case 73
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BBAA:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTt_ru ; jumptable 0040B22C	case 68
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BBB4:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTe_in ; jumptable 0040B22C	case 74
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BBBE:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTh_th ; jumptable 0040B22C	case 30
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BBC8:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aBo_cn ; jumptable 0040B22C	case 81
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BBD2:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 115
		test	eax, eax
		jz	short loc_40BBE0
		cmp	eax, 1
		jz	short loc_40BBEA
		jmp	short loc_40BBF4
; ---------------------------------------------------------------------------

loc_40BBE0:				; CODE XREF: sub_40B170+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BBEA:				; CODE XREF: sub_40B170+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BBF4:				; CODE XREF: sub_40B170+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BBFE:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTs_za ; jumptable 0040B22C	case 49
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC08:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTn_bw ; jumptable 0040B22C	case 50
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC12:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTr_tr ; jumptable 0040B22C	case 31
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC1C:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aTk_tm ; jumptable 0040B22C	case 66
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC26:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aUk_ua ; jumptable 0040B22C	case 34
		jmp	locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC30:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 32
		cmp	eax, 1
		jz	short loc_40BC3F
		cmp	eax, 2
		jz	short loc_40BC46
		jmp	short loc_40BC4D
; ---------------------------------------------------------------------------

loc_40BC3F:				; CODE XREF: sub_40B170+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC46:				; CODE XREF: sub_40B170+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC4D:				; CODE XREF: sub_40B170+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC54:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, [ebp+var_1C] ; jumptable 0040B22C case 67
		cmp	eax, 1
		jz	short loc_40BC63
		cmp	eax, 2
		jz	short loc_40BC6A
		jmp	short loc_40BC71
; ---------------------------------------------------------------------------

loc_40BC63:				; CODE XREF: sub_40B170+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC6A:				; CODE XREF: sub_40B170+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC71:				; CODE XREF: sub_40B170+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC78:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aVen_za ; jumptable	0040B22C case 51
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC7F:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aVi_vn ; jumptable 0040B22C	case 42
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC86:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aCy_gb ; jumptable 0040B22C	case 82
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC8D:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aXh_za ; jumptable 0040B22C	case 52
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC94:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aSit_cn ; jumptable	0040B22C case 120
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BC9B:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aYi_il ; jumptable 0040B22C	case 61
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BCA2:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aYo_ng ; jumptable 0040B22C	case 106
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BCA9:				; CODE XREF: sub_40B170+BCj
					; DATA XREF: .rdata:off_411980o
		mov	eax, offset aZu_za ; jumptable 0040B22C	case 53
		jmp	short locret_40BCB5
; ---------------------------------------------------------------------------

loc_40BCB0:				; CODE XREF: sub_40B170+A9j
					; sub_40B170+BCj
					; DATA XREF: ...
		mov	eax, offset aC	; jumptable 0040B22C default case

locret_40BCB5:				; CODE XREF: sub_40B170+28j
					; sub_40B170+4Ej ...
		leave
		retn
sub_40B170	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BCB7	proc near		; CODE XREF: sub_40BD96+1EAp
					; sub_40BD96+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_40BCB7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BCE6	proc near		; CODE XREF: sub_40C965+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_40BD2F
; ---------------------------------------------------------------------------

loc_40BCFB:				; CODE XREF: sub_40BCE6+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40BD2F
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_40BD2F:				; CODE XREF: sub_40BCE6+13j
					; sub_40BCE6+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40BCFB
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40BCE6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BD3E(void *)
sub_40BD3E	proc near		; CODE XREF: .text:0040C57Dp

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407BA1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407BA1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_40BD83
; ---------------------------------------------------------------------------

loc_40BD6A:				; CODE XREF: sub_40BD3E+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407BA1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_40BD83:				; CODE XREF: sub_40BD3E+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_40BD6A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407BA1
		leave
		retn
sub_40BD3E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BD96(char *)
sub_40BD96	proc near		; CODE XREF: .text:0040C54Ep

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset aRb	; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_40BDD3
		mov	eax, 0
		jmp	loc_40C0CA
; ---------------------------------------------------------------------------

loc_40BDD3:				; CODE XREF: sub_40BD96+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_40BE1C
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_40BE1C
		cmp	[ebp+var_20], 1Bh
		ja	short loc_40BE31

loc_40BE1C:				; CODE XREF: sub_40BD96+5Bj
					; sub_40BD96+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_40C0CA
; ---------------------------------------------------------------------------

loc_40BE31:				; CODE XREF: sub_40BD96+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_40BE4A
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_407A31
		jmp	short loc_40BE4F
; ---------------------------------------------------------------------------

loc_40BE4A:				; CODE XREF: sub_40BD96+A3j
		mov	eax, 0

loc_40BE4F:				; CODE XREF: sub_40BD96+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40BE6D
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_40C0CA
; ---------------------------------------------------------------------------

loc_40BE6D:				; CODE XREF: sub_40BD96+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_40BE79:				; CODE XREF: sub_40BD96+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_40BEC5
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_407BA1
		mov	eax, 0
		jmp	loc_40C0CA
; ---------------------------------------------------------------------------

loc_40BEC5:				; CODE XREF: sub_40BD96+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BE79
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_40BF0F
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_40BF0F
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_407BA1
		mov	eax, 0
		jmp	loc_40C0CA
; ---------------------------------------------------------------------------

loc_40BF0F:				; CODE XREF: sub_40BD96+156j
					; sub_40BD96+162j
		mov	[esp+68h+Mode],	28h ; size_t
		mov	[esp+68h+Filename], 1 ;	size_t
		call	sub_407B02
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40BF41
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_407BA1
		mov	eax, 0
		jmp	loc_40C0CA
; ---------------------------------------------------------------------------

loc_40BF41:				; CODE XREF: sub_40BD96+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40BF87
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_40BCB7
		jmp	short loc_40BF8D
; ---------------------------------------------------------------------------

loc_40BF87:				; CODE XREF: sub_40BD96+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_40BF8D:				; CODE XREF: sub_40BD96+1EFj
		test	eax, eax
		jnz	loc_40C08D
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40BFAF
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_40BCB7
		jmp	short loc_40BFB5
; ---------------------------------------------------------------------------

loc_40BFAF:				; CODE XREF: sub_40BD96+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_40BFB5:				; CODE XREF: sub_40BD96+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40BFD5
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_40BCB7
		jmp	short loc_40BFDB
; ---------------------------------------------------------------------------

loc_40BFD5:				; CODE XREF: sub_40BD96+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_40BFDB:				; CODE XREF: sub_40BD96+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C000
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_40BCB7
		jmp	short loc_40C006
; ---------------------------------------------------------------------------

loc_40C000:				; CODE XREF: sub_40BD96+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_40C006:				; CODE XREF: sub_40BD96+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C02B
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_40BCB7
		jmp	short loc_40C031
; ---------------------------------------------------------------------------

loc_40C02B:				; CODE XREF: sub_40BD96+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_40C031:				; CODE XREF: sub_40BD96+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C051
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_40BCB7
		jmp	short loc_40C057
; ---------------------------------------------------------------------------

loc_40C051:				; CODE XREF: sub_40BD96+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_40C057:				; CODE XREF: sub_40BD96+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4 ; size_t
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_407B02
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40C0C7
		jmp	short loc_40C0AA
; ---------------------------------------------------------------------------

loc_40C08D:				; CODE XREF: sub_40BD96+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_407BA1
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_407BA1
		mov	eax, 0
		jmp	short loc_40C0CA
; ---------------------------------------------------------------------------

loc_40C0AA:				; CODE XREF: sub_40BD96+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_407BA1
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_407BA1
		mov	eax, 0
		jmp	short loc_40C0CA
; ---------------------------------------------------------------------------

loc_40C0C7:				; CODE XREF: sub_40BD96+2F3j
		mov	eax, [ebp+var_18]

loc_40C0CA:				; CODE XREF: sub_40BD96+38j
					; sub_40BD96+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40BD96	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C0D1(LPCSTR, int, int)
sub_40C0D1	proc near		; CODE XREF: sub_40C2C8+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_40C121
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_40C12B

loc_40C121:				; CODE XREF: sub_40C0D1+44j
		mov	eax, 0
		jmp	locret_40C1D1
; ---------------------------------------------------------------------------

loc_40C12B:				; CODE XREF: sub_40C0D1+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_40C15B
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_40C1D1
; ---------------------------------------------------------------------------

loc_40C15B:				; CODE XREF: sub_40C0D1+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_407A31
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40C176
		mov	eax, 0
		jmp	short locret_40C1D1
; ---------------------------------------------------------------------------

loc_40C176:				; CODE XREF: sub_40C0D1+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40C1C6
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_407BA1
		mov	eax, 0
		jmp	short locret_40C1D1
; ---------------------------------------------------------------------------

loc_40C1C6:				; CODE XREF: sub_40C0D1+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_40C1D1:				; CODE XREF: sub_40C0D1+55j
					; sub_40C0D1+88j ...
		leave
		retn
sub_40C0D1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C1D3(LPCWSTR, int, int)
sub_40C1D3	proc near		; CODE XREF: sub_40C2C8+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_40C233
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_40C23D

loc_40C233:				; CODE XREF: sub_40C1D3+54j
		mov	eax, 0
		jmp	locret_40C2C6
; ---------------------------------------------------------------------------

loc_40C23D:				; CODE XREF: sub_40C1D3+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_407A31
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40C25B
		mov	eax, 0
		jmp	short locret_40C2C6
; ---------------------------------------------------------------------------

loc_40C25B:				; CODE XREF: sub_40C1D3+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40C2BB
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_407BA1
		mov	eax, 0
		jmp	short locret_40C2C6
; ---------------------------------------------------------------------------

loc_40C2BB:				; CODE XREF: sub_40C1D3+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_40C2C6:				; CODE XREF: sub_40C1D3+65j
					; sub_40C1D3+86j ...
		leave
		retn
sub_40C1D3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C2C8(LPCSTR, int, int)
sub_40C2C8	proc near		; CODE XREF: sub_40C5FA+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_40C0D1
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40C319
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_40C1D3
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407BA1
		jmp	short loc_40C320
; ---------------------------------------------------------------------------

loc_40C319:				; CODE XREF: sub_40C2C8+26j
		mov	[ebp+var_C], 0

loc_40C320:				; CODE XREF: sub_40C2C8+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_40C32B
		mov	eax, [ebp+var_14]
		jmp	short loc_40C330
; ---------------------------------------------------------------------------

loc_40C32B:				; CODE XREF: sub_40C2C8+5Cj
		mov	eax, 0

loc_40C330:				; CODE XREF: sub_40C2C8+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40C2C8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_40B170
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40C3CC
		mov	eax, [ebp-14h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp], eax
		call	sub_407A31
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40C3CC
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strcpy
		mov	dword ptr [esp+4], 5Fh
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strchr
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_40C3CC
		mov	eax, [ebp-18h]
		mov	byte ptr [eax],	0

loc_40C3CC:				; CODE XREF: .text:0040C363j
					; .text:0040C396j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40C3DC
		mov	eax, 0
		jmp	loc_40C58D
; ---------------------------------------------------------------------------

loc_40C3DC:				; CODE XREF: .text:0040C3D0j
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_407A31
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_40C46C
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_407BA1
		mov	eax, 0
		jmp	loc_40C58D
; ---------------------------------------------------------------------------

loc_40C46C:				; CODE XREF: .text:0040C455j
		mov	eax, [ebp-20h]
		mov	[ebp-24h], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	eax, [ebp-24h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-24h], 1
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	edx, offset aLc_messages_0 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp-24h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	dword ptr [ebp-24h], 0Dh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp-24h]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_40BD96
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_407BA1
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_407BA1
		mov	eax, ds:dword_4133FC
		test	eax, eax
		jz	short loc_40C582
		mov	eax, ds:dword_4133FC
		mov	[esp], eax
		call	sub_40BD3E

loc_40C582:				; CODE XREF: .text:0040C573j
		mov	eax, [ebp-10h]
		mov	ds:dword_4133FC, eax
		mov	eax, [ebp+0Ch]

loc_40C58D:				; CODE XREF: .text:0040C3D7j
					; .text:0040C467j
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C594(char *, int, int)
sub_40C594	proc near		; CODE XREF: sub_40C5FA+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_40C5EF
; ---------------------------------------------------------------------------

loc_40C5A9:				; CODE XREF: sub_40C594+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_40C5D6
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_40C5F8
; ---------------------------------------------------------------------------

loc_40C5D6:				; CODE XREF: sub_40C594+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_40C5EF:				; CODE XREF: sub_40C594+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_40C5A9
		mov	eax, [ebp+arg_0]

locret_40C5F8:				; CODE XREF: sub_40C594+40j
		leave
		retn
sub_40C594	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C5FA	proc near		; CODE XREF: sub_40C965+158p
					; sub_40C965+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_413400
		test	eax, eax
		jz	short loc_40C686
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C634
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40BCB7
		jmp	short loc_40C645
; ---------------------------------------------------------------------------

loc_40C634:				; CODE XREF: sub_40C5FA+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C645:				; CODE XREF: sub_40C5FA+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C66E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_40BCB7
		jmp	short loc_40C67E
; ---------------------------------------------------------------------------

loc_40C66E:				; CODE XREF: sub_40C5FA+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40C67E:				; CODE XREF: sub_40C5FA+72j
		mov	[ebp+var_14], eax
		jmp	loc_40C935
; ---------------------------------------------------------------------------

loc_40C686:				; CODE XREF: sub_40C5FA+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40C87B
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C6C8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40BCB7
		jmp	short loc_40C6D9
; ---------------------------------------------------------------------------

loc_40C6C8:				; CODE XREF: sub_40C5FA+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C6D9:				; CODE XREF: sub_40C5FA+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C702
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_40BCB7
		jmp	short loc_40C712
; ---------------------------------------------------------------------------

loc_40C702:				; CODE XREF: sub_40C5FA+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40C712:				; CODE XREF: sub_40C5FA+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_40C2C8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40C74A
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_40C86B
; ---------------------------------------------------------------------------

loc_40C74A:				; CODE XREF: sub_40C5FA+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_40C7DC
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_40C7DC
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C789
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40BCB7
		jmp	short loc_40C79A
; ---------------------------------------------------------------------------

loc_40C789:				; CODE XREF: sub_40C5FA+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C79A:				; CODE XREF: sub_40C5FA+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_40C86B
; ---------------------------------------------------------------------------

loc_40C7DC:				; CODE XREF: sub_40C5FA+156j
					; sub_40C5FA+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_407A31
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C85D
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_40C86B
; ---------------------------------------------------------------------------

loc_40C85D:				; CODE XREF: sub_40C5FA+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_40C86B:				; CODE XREF: sub_40C5FA+14Bj
					; sub_40C5FA+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_407BA1
		jmp	loc_40C935
; ---------------------------------------------------------------------------

loc_40C87B:				; CODE XREF: sub_40C5FA+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_40C8E1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_40C8AE
; ---------------------------------------------------------------------------

loc_40C89B:				; CODE XREF: sub_40C5FA+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_40C8B6
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40C8AE:				; CODE XREF: sub_40C5FA+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_40C89B
		jmp	short loc_40C8B7
; ---------------------------------------------------------------------------

loc_40C8B6:				; CODE XREF: sub_40C5FA+2AAj
		nop

loc_40C8B7:				; CODE XREF: sub_40C5FA+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_40C8D1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_40C935
; ---------------------------------------------------------------------------

loc_40C8D1:				; CODE XREF: sub_40C5FA+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_40C935
; ---------------------------------------------------------------------------

loc_40C8E1:				; CODE XREF: sub_40C5FA+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40C90C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40BCB7
		jmp	short loc_40C91D
; ---------------------------------------------------------------------------

loc_40C90C:				; CODE XREF: sub_40C5FA+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40C91D:				; CODE XREF: sub_40C5FA+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_40C935:				; CODE XREF: sub_40C5FA+87j
					; sub_40C5FA+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_40C95C
		cmp	[ebp+var_14], 0
		jz	short loc_40C95C
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_40C594
		jmp	short loc_40C95F
; ---------------------------------------------------------------------------

loc_40C95C:				; CODE XREF: sub_40C5FA+33Fj
					; sub_40C5FA+345j
		mov	eax, [ebp+var_10]

loc_40C95F:				; CODE XREF: sub_40C5FA+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_40C5FA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C965(char *, int, int)
sub_40C965	proc near		; CODE XREF: sub_40CC20+1Cp
					; .text:0040CC5Fp ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_4133FC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_40CBF7
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_40CB30
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_40CB30
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_40BCE6
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_40CAEF
; ---------------------------------------------------------------------------

loc_40C9FF:				; CODE XREF: sub_40C965+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_40CAC7
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40CA36
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_40BCB7
		jmp	short loc_40CA46
; ---------------------------------------------------------------------------

loc_40CA36:				; CODE XREF: sub_40C965+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40CA46:				; CODE XREF: sub_40C965+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_40CAC7
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40CA75
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_40BCB7
		jmp	short loc_40CA86
; ---------------------------------------------------------------------------

loc_40CA75:				; CODE XREF: sub_40C965+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40CA86:				; CODE XREF: sub_40C965+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40CAC7
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_40C5FA
		jmp	loc_40CC11
; ---------------------------------------------------------------------------

loc_40CAC7:				; CODE XREF: sub_40C965+A7j
					; sub_40C965+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_40CAE9
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_40CAEF
; ---------------------------------------------------------------------------

loc_40CAE9:				; CODE XREF: sub_40C965+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_40CAEF:				; CODE XREF: sub_40C965+95j
					; sub_40C965+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40CB13
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_40BCB7
		jmp	short loc_40CB23
; ---------------------------------------------------------------------------

loc_40CB13:				; CODE XREF: sub_40C965+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_40CB23:				; CODE XREF: sub_40C965+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_40C9FF

loc_40CB30:				; CODE XREF: sub_40C965+23j
					; sub_40C965+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_40CBE9
; ---------------------------------------------------------------------------

loc_40CB45:				; CODE XREF: sub_40C965+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40CB7C
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_40BCB7
		jmp	short loc_40CB8D
; ---------------------------------------------------------------------------

loc_40CB7C:				; CODE XREF: sub_40C965+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40CB8D:				; CODE XREF: sub_40C965+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_40CBAF
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_40CBE9
; ---------------------------------------------------------------------------

loc_40CBAF:				; CODE XREF: sub_40C965+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_40CBC0
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_40CBE9
; ---------------------------------------------------------------------------

loc_40CBC0:				; CODE XREF: sub_40C965+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_40C5FA
		jmp	short loc_40CC11
; ---------------------------------------------------------------------------

loc_40CBE9:				; CODE XREF: sub_40C965+1DBj
					; sub_40C965+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_40CB45
		jmp	short loc_40CBF8
; ---------------------------------------------------------------------------

loc_40CBF7:				; CODE XREF: sub_40C965+14j
		nop

loc_40CBF8:				; CODE XREF: sub_40C965+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_40CC0E
		cmp	[ebp+arg_8], 1
		jnz	short loc_40CC09
		mov	eax, [ebp+arg_0]
		jmp	short loc_40CC0C
; ---------------------------------------------------------------------------

loc_40CC09:				; CODE XREF: sub_40C965+29Dj
		mov	eax, [ebp+arg_4]

loc_40CC0C:				; CODE XREF: sub_40C965+2A2j
		jmp	short loc_40CC11
; ---------------------------------------------------------------------------

loc_40CC0E:				; CODE XREF: sub_40C965+297j
		mov	eax, [ebp+arg_0]

loc_40CC11:				; CODE XREF: sub_40C965+15Dj
					; sub_40C965+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C965	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40CC20(char *)
sub_40CC20	proc near		; CODE XREF: sub_40A2B4+78p
					; sub_40A2B4+B8p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_40C965
		leave
		retn
sub_40CC20	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40C965
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40C965
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_40B170
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40CCA7
		mov	eax, [ebp-0Ch]
		jmp	short locret_40CCAC
; ---------------------------------------------------------------------------

loc_40CCA7:				; CODE XREF: .text:0040CCA0j
		mov	eax, offset byte_411D3F

locret_40CCAC:				; CODE XREF: .text:0040CCA5j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_413400, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00415024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_40CD00
		cmp	eax, 3
		jz	short loc_40CD00
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_40CD00:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_40DEF0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_411D7Co ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_40CD74
		cmp	dword_40F01C, 2
		jz	short loc_40CD56
		mov	dword_40F01C, 2

loc_40CD56:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_40CE63
		cmp	eax, 1
		jz	loc_40CE02

loc_40CD68:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40CD74:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_4137D8, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_40CE93
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_4137D4, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_4137D0, eax
		jz	loc_40CE93
		mov	ecx, ds:dword_4137D4
		test	ecx, ecx
		jz	short loc_40CE23
		test	eax, eax
		jz	short loc_40CE23
		mov	dword_40F01C, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40CE02:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_40DEF0
		jmp	loc_40CD68
; ---------------------------------------------------------------------------

loc_40CE23:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_4137D0, 0
		mov	ds:dword_4137D4, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_40CE43:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_40F01C, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40CE63:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_415030
		cmp	ebx, offset dword_415030
		jz	loc_40CD68

loc_40CE74:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_40CE7C
		call	eax

loc_40CE7C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_415030
		jnz	short loc_40CE74
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_40CE93:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_4137D0, 0
		mov	ds:dword_4137D4, 0
		jmp	short loc_40CE43
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CEC0	proc near		; DATA XREF: .CRT:00415014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_40CEC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CED0	proc near		; CODE XREF: sub_40CEF0+10p
					; sub_40CEF0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_40CED0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CEE0	proc near		; CODE XREF: sub_401060+59p
					; sub_40CEF0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_40CEE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40CEF0(_onexit_t)
sub_40CEF0	proc near		; CODE XREF: sub_40CFB0+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_4137E0
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_40CED0
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_40CF90
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_4137E0
		mov	[esp+2Ch+Func],	eax
		call	sub_40CED0
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_4137DC
		mov	[esp+2Ch+Func],	eax
		call	sub_40CED0
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_40CEE0
		mov	ds:dword_4137E0, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_40CEE0
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_4137DC, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40CF90:				; CODE XREF: sub_40CEF0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_40CEF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40CFB0(_onexit_t)
sub_40CFB0	proc near		; CODE XREF: sub_40DBD0-27p
					; sub_40EFC0+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_40CEF0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_40CFB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_40D027
		cmp	eax, 0C000008Dh
		jb	short loc_40D054

loc_40CFEB:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_40CFF0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_40D120
		test	eax, eax
		jz	short loc_40D03C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_40D01F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40D027:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_40D095
		cmp	eax, 0C0000096h
		jz	short loc_40D062
		cmp	eax, 0C0000093h
		jz	short loc_40CFEB

loc_40D03C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_41342C
		test	eax, eax
		jz	loc_40D113
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_40D054:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_40D0A0
		cmp	eax, 0C000001Dh
		jnz	short loc_40D03C

loc_40D062:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_40D0D7
		test	eax, eax
		jz	short loc_40D03C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40D095:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_40CFF0
; ---------------------------------------------------------------------------
		align 10h

loc_40D0A0:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_40D0F5
		test	eax, eax
		jz	loc_40D03C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_40D0D7:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40D01F
; ---------------------------------------------------------------------------

loc_40D0F5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_40D01F
; ---------------------------------------------------------------------------

loc_40D113:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_40D01F
; ---------------------------------------------------------------------------
		align 10h

loc_40D120:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_40D01F
		mov	[esp+2Ch+var_10], eax
		call	sub_40DB40
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_40D01F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_413430
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_40D1A1
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_413430
		jmp	short loc_40D1A7
; ---------------------------------------------------------------------------

loc_40D1A1:				; CODE XREF: .text:0040D176j
		fstp	st
		fstp	st
		fstp	st

loc_40D1A7:				; CODE XREF: .text:0040D19Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D1B0	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_413430, eax
		jmp	__setusermatherr
sub_40D1B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D1C0	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_40D1DD
		mov	edx, ds:off_411E9C[ecx*4]

loc_40D1DD:				; CODE XREF: sub_40D1C0+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_40D1C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D220	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_40D220	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_40D230(char *Format, char ArgList)
sub_40D230	proc near		; CODE XREF: sub_40D290+1DDp
					; sub_40D290+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_40D230	endp

; ---------------------------------------------------------------------------
		jmp	short sub_40D290
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_40D290(size_t Size)
sub_40D290	proc near		; CODE XREF: .text:0040D281j
					; sub_40D4D0+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_41343C
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_40D472
		mov	eax, ds:dword_413438
		xor	esi, esi

loc_40D2B4:				; CODE XREF: sub_40D290+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_40D2C9
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_40D3A0

loc_40D2C9:				; CODE XREF: sub_40D290+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_40D2B4

loc_40D2D3:				; CODE XREF: sub_40D290+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_40D890
		test	eax, eax
		mov	edi, eax
		jz	loc_40D499
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_413438
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_40D970
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_413438
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_40D479
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_40D421

loc_40D34F:				; CODE XREF: sub_40D290+194j
					; sub_40D290+1C6j
		add	ds:dword_41343C, 1

loc_40D356:				; CODE XREF: sub_40D290+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40D4A9
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_40D3A8

loc_40D37F:				; CODE XREF: sub_40D290+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_40D393:				; CODE XREF: sub_40D290+162j
					; sub_40D290+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D3A0:				; CODE XREF: sub_40D290+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_40D356
; ---------------------------------------------------------------------------

loc_40D3A8:				; CODE XREF: sub_40D290+EDj
		cmp	eax, 40h
		jz	short loc_40D37F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_40D393
		cmp	eax, 4
		jz	short loc_40D393
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40D421:				; CODE XREF: sub_40D290+B9j
		cmp	eax, 40h
		jz	loc_40D34F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_413438
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_40D34F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_40D230
; ---------------------------------------------------------------------------

loc_40D472:				; CODE XREF: sub_40D290+17j
		xor	esi, esi
		jmp	loc_40D2D3
; ---------------------------------------------------------------------------

loc_40D479:				; CODE XREF: sub_40D290+ACj
		mov	eax, ds:dword_413438
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_40D230
; ---------------------------------------------------------------------------

loc_40D499:				; CODE XREF: sub_40D290+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_40D230
; ---------------------------------------------------------------------------

loc_40D4A9:				; CODE XREF: sub_40D290+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_40D230
sub_40D290	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D4D0	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_413434
		test	eax, eax
		jz	short loc_40D4F0

loc_40D4E2:				; CODE XREF: sub_40D4D0+66j
					; sub_40D4D0+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D4F0:				; CODE XREF: sub_40D4D0+10j
		mov	ds:dword_413434, 1
		call	sub_40D8D0
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_40DF90
		mov	ds:dword_41343C, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_413438, eax
		mov	eax, offset dword_412140
		sub	eax, offset dword_412140
		cmp	eax, 7
		jle	short loc_40D4E2
		cmp	eax, 0Bh
		mov	ebx, offset dword_412140
		jle	loc_40D630
		mov	eax, ds:dword_412140
		test	eax, eax
		jnz	short loc_40D560
		mov	eax, ds:dword_412144
		test	eax, eax
		jz	loc_40D61C
		lea	esi, [esi+0]

loc_40D560:				; CODE XREF: sub_40D4D0+7Dj
					; sub_40D4D0+164j ...
		cmp	ebx, offset dword_412140
		jnb	loc_40D4E2
		mov	esi, 400000h

loc_40D571:				; CODE XREF: sub_40D4D0+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_40D290
		cmp	ebx, offset dword_412140
		jb	short loc_40D571

loc_40D595:				; CODE XREF: sub_40D4D0+24Bj
		mov	ecx, ds:dword_41343C
		test	ecx, ecx
		jle	loc_40D4E2
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_40D5C2
; ---------------------------------------------------------------------------
		align 10h

loc_40D5B0:				; CODE XREF: sub_40D4D0+FDj
					; sub_40D4D0+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_41343C
		jge	loc_40D4E2

loc_40D5C2:				; CODE XREF: sub_40D4D0+DDj
		mov	eax, ds:dword_413438
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_40D5B0
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40D742
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_413438
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_40D5B0
; ---------------------------------------------------------------------------

loc_40D61C:				; CODE XREF: sub_40D4D0+86j
		mov	eax, ds:dword_412148
		test	eax, eax
		jnz	short loc_40D645
		mov	ebx, offset dword_41214C
		lea	esi, [esi+0]

loc_40D630:				; CODE XREF: sub_40D4D0+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_40D560
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_40D560

loc_40D645:				; CODE XREF: sub_40D4D0+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_40D765
		add	ebx, 0Ch
		cmp	ebx, offset dword_412140
		jnb	loc_40D4E2

loc_40D660:				; CODE XREF: sub_40D4D0+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_40D6BA
		cmp	edx, 20h
		jz	short loc_40D6F0
		cmp	edx, 8
		jz	short loc_40D69A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_40D230
; ---------------------------------------------------------------------------

loc_40D69A:				; CODE XREF: sub_40D4D0+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_40D6C5
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_40D6E1
; ---------------------------------------------------------------------------

loc_40D6BA:				; CODE XREF: sub_40D4D0+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_40D720

loc_40D6C5:				; CODE XREF: sub_40D4D0+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_40D733
		cmp	edx, 20h
		jz	short loc_40D6FF
		cmp	edx, 8
		jnz	short loc_40D70C

loc_40D6E1:				; CODE XREF: sub_40D4D0+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_40D290
		jmp	short loc_40D70C
; ---------------------------------------------------------------------------

loc_40D6F0:				; CODE XREF: sub_40D4D0+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_40D6FF:				; CODE XREF: sub_40D4D0+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_40D290

loc_40D70C:				; CODE XREF: sub_40D4D0+20Fj
					; sub_40D4D0+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_412140
		jb	loc_40D660
		jmp	loc_40D595
; ---------------------------------------------------------------------------

loc_40D720:				; CODE XREF: sub_40D4D0+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_40D733:				; CODE XREF: sub_40D4D0+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_40D290
		jmp	short loc_40D70C
; ---------------------------------------------------------------------------

loc_40D742:				; CODE XREF: sub_40D4D0+11Bj
		add	ebx, ds:dword_413438
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_40D230
; ---------------------------------------------------------------------------

loc_40D765:				; CODE XREF: sub_40D4D0+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_40D230
sub_40D4D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D780	proc near		; CODE XREF: .text:0040D821p
					; sub_40D890+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_40D790

locret_40D78D:				; CODE XREF: sub_40D780+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D790:				; CODE XREF: sub_40D780+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_40D78D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_40D780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D7B0	proc near		; CODE XREF: sub_40D890+2Bp
					; .text:0040D9D4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_40D7EE
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_40D7D4:				; CODE XREF: sub_40D7B0+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_40D7E2
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40D7EE

loc_40D7E2:				; CODE XREF: sub_40D7B0+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_40D7D4
		xor	eax, eax

loc_40D7EE:				; CODE XREF: sub_40D7B0+19j
					; sub_40D7B0+30j
		pop	ebx
		pop	esi
		retn
sub_40D7B0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40D800
; ---------------------------------------------------------------------------
		align 10h

loc_40D800:				; CODE XREF: .text:0040D7F1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_40D873
		mov	dword ptr [esp], 400000h
		call	sub_40D780
		test	eax, eax
		jz	short loc_40D873
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_40D873
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_40D85B
; ---------------------------------------------------------------------------

loc_40D851:				; CODE XREF: .text:0040D871j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_40D880

loc_40D85B:				; CODE XREF: .text:0040D84Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_40D851

loc_40D873:				; CODE XREF: .text:0040D818j
					; .text:0040D828j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D880:				; CODE XREF: .text:0040D859j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D890	proc near		; CODE XREF: sub_40D290+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_40D780
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_40D8C0
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_40D7B0

loc_40D8C0:				; CODE XREF: sub_40D890+15j
		add	esp, 8
		retn
sub_40D890	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D8D0	proc near		; CODE XREF: sub_40D4D0+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_40D780
		xor	edx, edx
		test	eax, eax
		jz	short loc_40D8F1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_40D8F1:				; CODE XREF: sub_40D8D0+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_40D8D0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_40D780
		xor	edx, edx
		test	eax, eax
		jz	short loc_40D959
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_40D959
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_40D940:				; CODE XREF: .text:0040D955j
		test	byte ptr [edx+27h], 20h
		jz	short loc_40D94D
		test	ebx, ebx
		jz	short loc_40D959
		sub	ebx, 1

loc_40D94D:				; CODE XREF: .text:0040D944j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_40D940
		xor	edx, edx

loc_40D959:				; CODE XREF: .text:0040D919j
					; .text:0040D935j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40D970
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D970	proc near		; CODE XREF: sub_40D290+70p
					; .text:0040D961j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_40D780
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_40D970	endp

; ---------------------------------------------------------------------------
		jmp	short loc_40D9A0
; ---------------------------------------------------------------------------
		align 10h

loc_40D9A0:				; CODE XREF: .text:0040D991j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_40D780
		test	eax, eax
		jnz	short loc_40D9C0

loc_40D9B6:				; CODE XREF: .text:0040D9DBj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40D9C0:				; CODE XREF: .text:0040D9B4j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_40D7B0
		test	eax, eax
		jz	short loc_40D9B6
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40D9F0	proc near		; CODE XREF: sub_40DA80+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_40D780
		test	eax, eax
		jz	short loc_40DA61
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_40DA61
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_40D7B0
		test	eax, eax
		jz	short loc_40DA61
		add	esi, 400000h
		jnz	short loc_40DA46
		jmp	short loc_40DA61
; ---------------------------------------------------------------------------
		align 10h

loc_40DA40:				; CODE XREF: sub_40D9F0+66j
		sub	ebx, 1
		add	esi, 14h

loc_40DA46:				; CODE XREF: sub_40D9F0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_40DA54
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_40DA70

loc_40DA54:				; CODE XREF: sub_40D9F0+5Bj
		test	ebx, ebx
		jg	short loc_40DA40
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_40DA61:				; CODE XREF: sub_40D9F0+1Aj
					; sub_40D9F0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40DA70:				; CODE XREF: sub_40D9F0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_40D9F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DA80	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_413440
		test	eax, eax
		jz	short loc_40DA92

loc_40DA8D:				; CODE XREF: sub_40DA80+97j
					; sub_40DA80+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40DA92:				; CODE XREF: sub_40DA80+Bj
		xor	eax, eax

loc_40DA94:				; CODE XREF: sub_40DA80+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_40D9F0
		test	eax, eax
		jz	short loc_40DB20
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_40DAB0
		cmp	dl, 6Dh
		jnz	short loc_40DB00

loc_40DAB0:				; CODE XREF: sub_40DA80+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40DABE
		cmp	dl, 73h
		jnz	short loc_40DB00

loc_40DABE:				; CODE XREF: sub_40DA80+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40DACC
		cmp	dl, 76h
		jnz	short loc_40DB00

loc_40DACC:				; CODE XREF: sub_40DA80+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_40DADA
		cmp	dl, 63h
		jnz	short loc_40DB00

loc_40DADA:				; CODE XREF: sub_40DA80+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_40DAE8
		cmp	dl, 72h
		jnz	short loc_40DB00

loc_40DAE8:				; CODE XREF: sub_40DA80+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_40DB04
		cmp	dl, 74h
		jz	short loc_40DB04
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_40DB04
		xchg	ax, ax

loc_40DB00:				; CODE XREF: sub_40DA80+2Ej
					; sub_40DA80+3Cj ...
		mov	eax, ebx
		jmp	short loc_40DA94
; ---------------------------------------------------------------------------

loc_40DB04:				; CODE XREF: sub_40DA80+6Fj
					; sub_40DA80+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_413440, eax
		jnz	loc_40DA8D
		lea	esi, [esi+0]

loc_40DB20:				; CODE XREF: sub_40DA80+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_413440, eax
		jmp	loc_40DA8D
sub_40DA80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DB40	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_40DB40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40DB50()
sub_40DB50	proc near		; DATA XREF: sub_40DBD0:loc_40DBA2o
		sub	esp, 0Ch
		mov	eax, off_40F018
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40DB77
		xchg	ax, ax

loc_40DB60:				; CODE XREF: sub_40DB50+25j
		call	eax
		mov	eax, off_40F018
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_40F018, edx
		test	eax, eax
		jnz	short loc_40DB60

loc_40DB77:				; CODE XREF: sub_40DB50+Cj
		add	esp, 0Ch
		retn
sub_40DB50	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_40DBD0

loc_40DB80:				; CODE XREF: sub_40DBD0+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_40EFE0
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_40DBB3

loc_40DB8F:				; CODE XREF: sub_40DBD0-9j
		test	ebx, ebx
		jz	short loc_40DBA2

loc_40DB93:				; CODE XREF: sub_40DBD0-30j
		call	ds:dword_40EFE0[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_40DB93

loc_40DBA2:				; CODE XREF: sub_40DBD0-3Fj
		mov	[esp+1Ch+var_1C], offset sub_40DB50 ; _onexit_t
		call	sub_40CFB0
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40DBB3:				; CODE XREF: sub_40DBD0-43j
		xor	ebx, ebx
		jmp	short loc_40DBB9
; ---------------------------------------------------------------------------

loc_40DBB7:				; CODE XREF: sub_40DBD0-Bj
		mov	ebx, eax

loc_40DBB9:				; CODE XREF: sub_40DBD0-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_40EFE0[eax*4]
		test	edx, edx
		jnz	short loc_40DBB7
		jmp	short loc_40DB8F
; END OF FUNCTION CHUNK	FOR sub_40DBD0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DBD0	proc near		; CODE XREF: sub_401180+239p
					; sub_4053E3+Ep

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 0040DB80 SIZE 00000049 BYTES

		mov	ecx, ds:dword_413444
		test	ecx, ecx
		jz	short loc_40DBE0
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_40DBE0:				; CODE XREF: sub_40DBD0+8j
		mov	ds:dword_413444, 1
		jmp	short loc_40DB80
sub_40DBD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DBF0	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_40F040
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_40DC40
		not	eax
		mov	dword_40F044, eax

loc_40DC26:				; CODE XREF: sub_40DBF0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40DC40:				; CODE XREF: sub_40DBF0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_40DCB2

loc_40DCA2:				; CODE XREF: sub_40DBF0+CCj
		mov	dword_40F040, ebp
		mov	dword_40F044, eax
		jmp	loc_40DC26
; ---------------------------------------------------------------------------

loc_40DCB2:				; CODE XREF: sub_40DBF0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_40DCA2
sub_40DBF0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_413524, edx
		mov	ds:dword_413740, 0C0000409h
		mov	ds:dword_413744, 1
		mov	ds:dword_413518, eax
		mov	ds:dword_41374C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_41350C, eax
		mov	eax, dword_40F040
		mov	[ebp-10h], eax
		mov	eax, dword_40F044
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_411FC4
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DD50	proc near		; CODE XREF: sub_40DEF0+79p
					; sub_40DEF0:loc_40DF82p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_4137BC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_40DDA5
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_40DD80:				; CODE XREF: sub_40DD50+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_40DD9E
		test	esi, esi
		jz	short loc_40DD9E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_40DD9E:				; CODE XREF: sub_40DD50+40j
					; sub_40DD50+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_40DD80

loc_40DDA5:				; CODE XREF: sub_40DD50+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40DD50	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_4137A0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_40DDE4

loc_40DDD6:				; CODE XREF: .text:0040DE4Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40DDE4:				; CODE XREF: .text:0040DDD4j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_40DE47
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_4137BC
		mov	ds:dword_4137BC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40DE47:				; CODE XREF: .text:0040DDFCj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_40DDD6
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_4137A0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_40DE68
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40DE68:				; CODE XREF: .text:0040DE5Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_4137BC
		sub	esp, 4
		test	edx, edx
		jz	short loc_40DE9F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_40DE98
		jmp	short loc_40DED6
; ---------------------------------------------------------------------------
		align 10h

loc_40DE90:				; CODE XREF: .text:0040DE9Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_40DEB6
		mov	edx, eax

loc_40DE98:				; CODE XREF: .text:0040DE86j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_40DE90

loc_40DE9F:				; CODE XREF: .text:0040DE80j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_40DEAF:				; CODE XREF: .text:0040DED4j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40DEB6:				; CODE XREF: .text:0040DE94j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_40DEBC:				; CODE XREF: .text:0040DEE0j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_40DEAF
; ---------------------------------------------------------------------------

loc_40DED6:				; CODE XREF: .text:0040DE88j
		mov	eax, [edx+8]
		mov	ds:dword_4137BC, eax
		mov	eax, edx
		jmp	short loc_40DEBC
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DEF0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_40DF40
		jb	short loc_40DF10
		cmp	eax, 3
		jz	short loc_40DF60

loc_40DF03:				; CODE XREF: sub_40DEF0+31j
					; sub_40DEF0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40DF10:				; CODE XREF: sub_40DEF0+Cj
		mov	eax, ds:dword_4137A0
		test	eax, eax
		jnz	short loc_40DF82

loc_40DF19:				; CODE XREF: sub_40DEF0+97j
		mov	eax, ds:dword_4137A0
		cmp	eax, 1
		jnz	short loc_40DF03
		mov	ds:dword_4137A0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_40DF03
; ---------------------------------------------------------------------------
		align 10h

loc_40DF40:				; CODE XREF: sub_40DEF0+Aj
		mov	eax, ds:dword_4137A0
		test	eax, eax
		jz	short loc_40DF70

loc_40DF49:				; CODE XREF: sub_40DEF0+90j
		mov	ds:dword_4137A0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40DF60:				; CODE XREF: sub_40DEF0+11j
		mov	eax, ds:dword_4137A0
		test	eax, eax
		jz	short loc_40DF03
		call	sub_40DD50
		jmp	short loc_40DF03
; ---------------------------------------------------------------------------

loc_40DF70:				; CODE XREF: sub_40DEF0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_40DF49
; ---------------------------------------------------------------------------

loc_40DF82:				; CODE XREF: sub_40DEF0+27j
		call	sub_40DD50
		jmp	short loc_40DF19
sub_40DEF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40DF90	proc near		; CODE XREF: sub_401180+19p
					; sub_40D4D0+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_40DFB2

loc_40DF9D:				; CODE XREF: sub_40DF90+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_40DF9D

loc_40DFB2:				; CODE XREF: sub_40DF90+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_40DF90	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _putenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _tzset]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_40E010
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40E010	proc near		; CODE XREF: sub_401180+A7p
					; .text:0040E001j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_40E010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40E030	proc near		; CODE XREF: sub_40E4B0+EDp
					; sub_40E4B0+2EFp

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4

		push	ebp
		push	edi
		mov	edi, eax
		push	esi
		mov	esi, ecx
		push	ebx
		sub	esp, 14h
		mov	[esp+24h+var_20], edx
		sub	edx, eax
		mov	eax, esi
		sub	eax, [esp+24h+var_20]
		mov	[esp+24h+var_18], edx
		mov	ecx, [esp+24h+arg_0]
		mov	[esp+24h+var_1C], eax
		mov	eax, edx
		sar	edx, 1Fh
		idiv	[esp+24h+var_1C]
		mov	eax, [esp+24h+var_1C]
		test	edx, edx
		mov	ebx, edx
		jnz	short loc_40E06C
		jmp	short loc_40E0DD
; ---------------------------------------------------------------------------

loc_40E068:				; CODE XREF: sub_40E030+45j
		mov	eax, ebx
		mov	ebx, edx

loc_40E06C:				; CODE XREF: sub_40E030+34j
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	edx, edx
		jnz	short loc_40E068

loc_40E077:				; CODE XREF: sub_40E030+B1j
		mov	eax, esi
		sub	eax, edi
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	ebx, ebx
		mov	[esp+24h+var_24], eax
		jle	short loc_40E0D5
		mov	ebp, [esp+24h+var_20]
		add	ebx, ebp
		mov	[esp+24h+var_14], ebx

loc_40E093:				; CODE XREF: sub_40E030+A3j
		mov	eax, [esp+24h+var_24]
		test	eax, eax
		jle	short loc_40E0CC
		mov	edi, [ecx+ebp*4]
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_40E0A5
; ---------------------------------------------------------------------------

loc_40E0A3:				; CODE XREF: sub_40E030+9Aj
		mov	edi, esi

loc_40E0A5:				; CODE XREF: sub_40E030+71j
		mov	esi, [esp+24h+var_1C]
		mov	ebx, eax
		sub	ebx, [esp+24h+var_18]
		add	esi, eax
		cmp	[esp+24h+var_20], eax
		mov	eax, ebx
		cmovg	eax, esi
		add	edx, 1
		lea	ebx, [ecx+eax*4]
		mov	esi, [ebx]
		cmp	edx, [esp+24h+var_24]
		mov	[ebx], edi
		mov	[ecx+ebp*4], esi
		jnz	short loc_40E0A3

loc_40E0CC:				; CODE XREF: sub_40E030+68j
		add	ebp, 1
		cmp	ebp, [esp+24h+var_14]
		jnz	short loc_40E093

loc_40E0D5:				; CODE XREF: sub_40E030+57j
		add	esp, 14h
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40E0DD:				; CODE XREF: sub_40E030+36j
		mov	ebx, [esp+24h+var_1C]
		jmp	short loc_40E077
sub_40E030	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40E0F0(char *, char)
sub_40E0F0	proc near		; CODE XREF: sub_40E160+152p
					; sub_40E160+1E8p ...

File		= dword	ptr -1Ch
Format		= dword	ptr -18h
ArgList		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:__argv
		mov	ebx, [esp+1Ch+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[esp+1Ch+Format], offset aS_0 ;	"%s: "
		mov	[esp+1Ch+ArgList], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fprintf
		test	ebx, ebx
		jz	short loc_40E13D
		lea	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, ds:_iob
		mov	[esp+1Ch+Format], ebx ;	Format
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	vfprintf

loc_40E13D:				; CODE XREF: sub_40E0F0+2Fj
		mov	eax, ds:_iob
		mov	[esp+1Ch+File],	0Ah ; Ch
		add	eax, 40h
		mov	[esp+1Ch+Format], eax ;	File
		call	fputc
		add	esp, 18h
		pop	ebx
		retn
sub_40E0F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40E160	proc near		; CODE XREF: sub_40E4B0+220p
					; sub_40E4B0+5BBp

Str		= dword	ptr -5Ch
Val		= dword	ptr -58h
MaxCount	= dword	ptr -54h
var_44		= dword	ptr -44h
Str1		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	[esp+5Ch+var_24], edx
		mov	edx, off_40F03C
		mov	[esp+5Ch+var_38], ecx
		mov	ecx, dword_40F028
		mov	[esp+5Ch+Val], 3Dh ; Val
		mov	[esp+5Ch+var_20], eax
		mov	[esp+5Ch+Str], edx ; Str
		mov	[esp+5Ch+var_2C], ecx
		add	ecx, 1
		mov	[esp+5Ch+Str1],	edx
		mov	[esp+5Ch+var_28], ecx
		mov	dword_40F028, ecx
		call	strchr
		test	eax, eax
		mov	[esp+5Ch+var_34], eax
		jz	loc_40E380
		mov	ebp, eax
		add	eax, 1
		sub	ebp, [esp+5Ch+Str1]
		mov	[esp+5Ch+var_34], eax

loc_40E1BD:				; CODE XREF: sub_40E160+22Ej
		mov	ecx, [esp+5Ch+var_38]
		mov	esi, [ecx]
		test	esi, esi
		jz	loc_40E39E
		mov	ebx, ecx
		xor	edi, edi
		add	ebx, 10h
		mov	[esp+5Ch+var_44], ecx
		mov	[esp+5Ch+var_3C], 0FFFFFFFFh
		mov	[esp+5Ch+var_30], 0
		jmp	short loc_40E218
; ---------------------------------------------------------------------------

loc_40E1E8:				; CODE XREF: sub_40E160+F2j
		mov	eax, [esp+5Ch+var_3C]
		mov	ecx, [esp+5Ch+var_44]
		shl	eax, 4
		add	eax, [esp+5Ch+var_38]
		mov	edx, [eax+4]
		cmp	[ecx+4], edx
		jz	short loc_40E260

loc_40E1FF:				; CODE XREF: sub_40E160+106j
		mov	[esp+5Ch+var_30], 1

loc_40E207:				; CODE XREF: sub_40E160+CEj
					; sub_40E160+EBj ...
		mov	[esp+5Ch+var_44], ebx
		add	ebx, 10h
		add	edi, 1
		mov	esi, [ebx-10h]
		test	esi, esi
		jz	short loc_40E280

loc_40E218:				; CODE XREF: sub_40E160+86j
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+MaxCount], ebp	; MaxCount
		mov	[esp+5Ch+Val], esi ; Str2
		mov	[esp+5Ch+Str], edx ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_40E207
		mov	[esp+5Ch+Str], esi ; Str
		call	strlen
		cmp	eax, ebp
		jz	loc_40E2D0
		cmp	ebp, 1
		jnz	short loc_40E24D
		mov	esi, [esp+5Ch+arg_4]
		test	esi, esi
		jnz	short loc_40E207

loc_40E24D:				; CODE XREF: sub_40E160+E3j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	short loc_40E1E8
		mov	[esp+5Ch+var_3C], edi
		jmp	short loc_40E207
; ---------------------------------------------------------------------------
		align 10h

loc_40E260:				; CODE XREF: sub_40E160+9Dj
		mov	edx, [eax+8]
		cmp	[ecx+8], edx
		jnz	short loc_40E1FF
		mov	edx, [eax+0Ch]
		mov	eax, 1
		cmp	[ecx+0Ch], edx
		cmovz	eax, [esp+5Ch+var_30]
		mov	[esp+5Ch+var_30], eax
		jmp	short loc_40E207
; ---------------------------------------------------------------------------
		align 10h

loc_40E280:				; CODE XREF: sub_40E160+B6j
		mov	ebx, [esp+5Ch+var_30]
		test	ebx, ebx
		jz	loc_40E393
		mov	ecx, dword_40F02C
		test	ecx, ecx
		jz	short loc_40E2B7
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40E2B7
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aAmbiguousOptio ;	"ambiguous option -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_40E0F0

loc_40E2B7:				; CODE XREF: sub_40E160+134j
					; sub_40E160+13Dj ...
		mov	dword_40F024, 0
		mov	eax, 3Fh

loc_40E2C6:				; CODE XREF: sub_40E160+1BDj
					; sub_40E160+2EAj ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40E2D0:				; CODE XREF: sub_40E160+DAj
		mov	[esp+5Ch+var_3C], edi

loc_40E2D4:				; CODE XREF: sub_40E160+238j
		mov	ebx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+var_34]
		shl	ebx, 4
		add	ebx, [esp+5Ch+var_38]
		test	edx, edx
		setnz	dl
		mov	eax, [ebx+4]
		jnz	short loc_40E31F

loc_40E2ED:				; CODE XREF: sub_40E160+1C1j
		lea	ecx, [eax-1]
		cmp	ecx, 1
		jbe	loc_40E3DE

loc_40E2F9:				; CODE XREF: sub_40E160+28Fj
					; sub_40E160+29Dj ...
		mov	edx, [esp+5Ch+arg_0]
		test	edx, edx
		jz	short loc_40E30B
		mov	ecx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+arg_0]
		mov	[edx], ecx

loc_40E30B:				; CODE XREF: sub_40E160+19Fj
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_40E447
		mov	edx, [ebx+0Ch]
		mov	[eax], edx
		xor	eax, eax
		jmp	short loc_40E2C6
; ---------------------------------------------------------------------------

loc_40E31F:				; CODE XREF: sub_40E160+18Bj
		test	eax, eax
		jnz	short loc_40E2ED
		mov	eax, dword_40F02C
		test	eax, eax
		jz	short loc_40E34D
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40E34D
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aOptionDoesnTTa ;	"option	doesn't take an argument -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_40E0F0

loc_40E34D:				; CODE XREF: sub_40E160+1CAj
					; sub_40E160+1D3j
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_40E44F
		mov	dword_40F024, 0

loc_40E362:				; CODE XREF: sub_40E160+2E2j
					; sub_40E160+2F7j
		mov	edx, [esp+5Ch+var_24]
		xor	eax, eax
		cmp	byte ptr [edx],	3Ah
		setnz	al
		add	esp, 4Ch
		pop	ebx
		lea	eax, [eax+eax*4+3Ah]
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_40E380:				; CODE XREF: sub_40E160+4Aj
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], edx ; Str
		call	strlen
		mov	ebp, eax
		jmp	loc_40E1BD
; ---------------------------------------------------------------------------

loc_40E393:				; CODE XREF: sub_40E160+126j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	loc_40E2D4

loc_40E39E:				; CODE XREF: sub_40E160+65j
		mov	ebx, [esp+5Ch+arg_4]
		test	ebx, ebx
		jnz	loc_40E486
		mov	ecx, dword_40F02C
		test	ecx, ecx
		jz	loc_40E2B7
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	loc_40E2B7
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aUnknownOptionS ;	"unknown option	-- %s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_40E0F0
		jmp	loc_40E2B7
; ---------------------------------------------------------------------------

loc_40E3DE:				; CODE XREF: sub_40E160+193j
		test	dl, dl
		jz	short loc_40E45C
		mov	ecx, [esp+5Ch+var_34]
		cmp	eax, 1
		mov	ds:Filename, ecx
		jnz	loc_40E2F9

loc_40E3F5:				; CODE XREF: sub_40E160+321j
		mov	ebp, ds:Filename
		test	ebp, ebp
		jnz	loc_40E2F9
		mov	edi, dword_40F02C
		test	edi, edi
		jz	short loc_40E42A
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_40E42A
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aOptionRequires ;	"option	requires an argument --	%s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_40E0F0

loc_40E42A:				; CODE XREF: sub_40E160+2ABj
					; sub_40E160+2B4j
		mov	esi, [ebx+8]
		test	esi, esi
		jz	short loc_40E49A
		mov	dword_40F024, 0

loc_40E43B:				; CODE XREF: sub_40E160+342j
		sub	dword_40F028, 1
		jmp	loc_40E362
; ---------------------------------------------------------------------------

loc_40E447:				; CODE XREF: sub_40E160+1B0j
		mov	eax, [ebx+0Ch]
		jmp	loc_40E2C6
; ---------------------------------------------------------------------------

loc_40E44F:				; CODE XREF: sub_40E160+1F2j
		mov	eax, [ebx+0Ch]
		mov	dword_40F024, eax
		jmp	loc_40E362
; ---------------------------------------------------------------------------

loc_40E45C:				; CODE XREF: sub_40E160+280j
		cmp	eax, 1
		jnz	loc_40E2F9
		mov	edx, [esp+5Ch+var_28]
		mov	ecx, [esp+5Ch+var_20]
		mov	eax, [ecx+edx*4]
		mov	ds:Filename, eax
		mov	eax, [esp+5Ch+var_2C]
		add	eax, 2
		mov	dword_40F028, eax
		jmp	loc_40E3F5
; ---------------------------------------------------------------------------

loc_40E486:				; CODE XREF: sub_40E160+244j
		mov	ecx, [esp+5Ch+var_2C]
		mov	eax, 0FFFFFFFFh
		mov	dword_40F028, ecx
		jmp	loc_40E2C6
; ---------------------------------------------------------------------------

loc_40E49A:				; CODE XREF: sub_40E160+2CFj
		mov	eax, [ebx+0Ch]
		mov	dword_40F024, eax
		jmp	short loc_40E43B
sub_40E160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40E4B0	proc near		; CODE XREF: sub_40EA90+24j
					; .text:0040EAE6j ...

Str		= dword	ptr -4Ch
Val		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		test	ecx, ecx
		mov	[esp+4Ch+var_24], eax
		mov	edi, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_28], edx
		mov	[esp+4Ch+var_20], ecx
		jz	loc_40E7E2
		mov	ecx, dword_40F028
		test	ecx, ecx
		jz	loc_40E730

loc_40E4DD:				; CODE XREF: sub_40E4B0+294j
		cmp	dword_40F030, 0FFFFFFFFh
		jz	loc_40E6F0
		mov	edx, ds:dword_4137FC
		xor	eax, eax
		test	edx, edx
		jnz	loc_40E6F0
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		cmp	dl, 2Dh
		jz	loc_40E71E

loc_40E50A:				; CODE XREF: sub_40E4B0+268j
		mov	ebp, dword_40F030
		test	ebp, ebp
		jnz	loc_40E750
		cmp	dl, 2Bh
		jz	loc_40E907

loc_40E521:				; CODE XREF: sub_40E4B0+276j
					; sub_40E4B0+2A6j ...
		test	eax, eax
		mov	ds:Filename, 0
		jz	loc_40E5CC
		mov	dword_40F034, 0FFFFFFFFh
		mov	dword_40F038, 0FFFFFFFFh
		jmp	short loc_40E5C8
; ---------------------------------------------------------------------------
		align 10h

loc_40E550:				; CODE XREF: sub_40E4B0+159j
					; sub_40E4B0+18Ej
		test	edi, 2
		mov	off_40F03C, offset byte_411FF5
		jnz	loc_40E7F1
		test	edi, 1
		jz	loc_40E7E2
		mov	ebx, dword_40F038
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40E766
		mov	esi, dword_40F034
		xor	eax, eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_40E5BF
		mov	edx, [esp+4Ch+var_28]
		mov	eax, ebx
		mov	ecx, ebp
		sub	ebx, esi
		mov	[esp+4Ch+Str], edx
		mov	edx, esi
		call	sub_40E030
		mov	edx, dword_40F028
		mov	eax, ds:dword_4137FC
		mov	dword_40F034, 0FFFFFFFFh
		add	ebx, edx
		mov	dword_40F038, ebx

loc_40E5BF:				; CODE XREF: sub_40E4B0+DCj
					; sub_40E4B0+2BEj
		add	edx, 1
		mov	dword_40F028, edx

loc_40E5C8:				; CODE XREF: sub_40E4B0+97j
		test	eax, eax
		jnz	short loc_40E5DD

loc_40E5CC:				; CODE XREF: sub_40E4B0+7Dj
		mov	ebx, off_40F03C
		movzx	ecx, byte ptr [ebx]
		test	cl, cl
		jnz	loc_40E667

loc_40E5DD:				; CODE XREF: sub_40E4B0+11Aj
		mov	ebp, dword_40F028
		cmp	ebp, [esp+4Ch+var_24]
		mov	ds:dword_4137FC, 0
		mov	edx, ebp
		jge	loc_40E773
		mov	ecx, [esp+4Ch+var_28]
		mov	ebx, [ecx+ebp*4]
		cmp	byte ptr [ebx],	2Dh
		mov	off_40F03C, ebx
		jnz	loc_40E550
		movzx	ecx, byte ptr [ebx+1]
		test	cl, cl
		jnz	short loc_40E644
		mov	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], 2Dh ; Val
		mov	[esp+4Ch+var_2C], cl
		mov	[esp+4Ch+var_30], ebp
		mov	[esp+4Ch+Str], eax ; Str
		call	strchr
		mov	edx, [esp+4Ch+var_30]
		movzx	ecx, [esp+4Ch+var_2C]
		test	eax, eax
		jz	loc_40E550

loc_40E644:				; CODE XREF: sub_40E4B0+165j
		cmp	dword_40F038, 0FFFFFFFFh
		mov	eax, ebx
		jz	short loc_40E65C
		cmp	dword_40F034, 0FFFFFFFFh
		jz	loc_40E9C3

loc_40E65C:				; CODE XREF: sub_40E4B0+19Dj
					; sub_40E4B0+519j
		test	cl, cl
		jnz	loc_40E954
		movzx	ecx, byte ptr [ebx]

loc_40E667:				; CODE XREF: sub_40E4B0+127j
					; sub_40E4B0+4B0j ...
		mov	esi, [esp+4Ch+arg_0]
		test	esi, esi
		jz	loc_40E829
		mov	eax, dword_40F028
		mov	edx, [esp+4Ch+var_28]
		cmp	ebx, [edx+eax*4]
		jz	loc_40E829
		cmp	cl, 2Dh
		jz	loc_40E9B3
		and	edi, 4
		jz	loc_40E829
		xor	eax, eax
		cmp	cl, 3Ah
		jz	short loc_40E6B9
		movsx	ecx, cl
		mov	[esp+4Ch+Val], ecx ; Val
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		setnz	al
		movzx	eax, al

loc_40E6B9:				; CODE XREF: sub_40E4B0+1ECj
					; sub_40E4B0+50Ej
		mov	[esp+4Ch+Val], eax
		mov	eax, [esp+4Ch+arg_4]
		mov	ecx, [esp+4Ch+arg_0]
		mov	edx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], eax
		mov	eax, [esp+4Ch+var_28]
		call	sub_40E160
		cmp	eax, 0FFFFFFFFh
		mov	esi, eax
		jz	loc_40E820

loc_40E6E0:				; CODE XREF: sub_40E4B0+5C2j
		mov	off_40F03C, offset byte_411FF5
		jmp	loc_40E7E7
; ---------------------------------------------------------------------------
		align 10h

loc_40E6F0:				; CODE XREF: sub_40E4B0+34j
					; sub_40E4B0+44j
		mov	[esp+4Ch+Str], offset aPosixly_correc ;	"POSIXLY_CORRECT"
		call	getenv
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		test	eax, eax
		setnz	al
		movzx	eax, al
		cmp	dl, 2Dh
		mov	dword_40F030, eax
		mov	eax, ds:dword_4137FC
		jnz	loc_40E50A

loc_40E71E:				; CODE XREF: sub_40E4B0+54j
		or	edi, 2
		add	[esp+4Ch+var_20], 1
		jmp	loc_40E521
; ---------------------------------------------------------------------------
		align 10h

loc_40E730:				; CODE XREF: sub_40E4B0+27j
		mov	ds:dword_4137FC, 1
		mov	dword_40F028, 1
		jmp	loc_40E4DD
; ---------------------------------------------------------------------------
		align 10h

loc_40E750:				; CODE XREF: sub_40E4B0+62j
		and	edi, 0FFFFFFFEh
		cmp	dl, 2Bh
		jnz	loc_40E521
		add	[esp+4Ch+var_20], 1
		jmp	loc_40E521
; ---------------------------------------------------------------------------

loc_40E766:				; CODE XREF: sub_40E4B0+CBj
		mov	dword_40F038, ebp
		xor	eax, eax
		jmp	loc_40E5BF
; ---------------------------------------------------------------------------

loc_40E773:				; CODE XREF: sub_40E4B0+143j
		mov	ebx, dword_40F034
		mov	off_40F03C, offset byte_411FF5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40E80F
		mov	edx, [esp+4Ch+var_28]
		mov	ecx, ebp
		mov	esi, dword_40F038
		mov	[esp+4Ch+Str], edx

loc_40E79B:				; CODE XREF: sub_40E4B0+4EFj
		mov	eax, esi
		mov	edx, ebx
		call	sub_40E030
		sub	esi, ebx
		add	dword_40F028, esi

loc_40E7AC:				; CODE XREF: sub_40E4B0+367j
					; sub_40E4B0+36Ej ...
		mov	esi, 0FFFFFFFFh
		mov	dword_40F034, 0FFFFFFFFh
		mov	eax, esi
		mov	dword_40F038, 0FFFFFFFFh
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40E7CF:				; CODE XREF: sub_40E4B0+3A9j
		cmp	esi, 2Dh
		jnz	loc_40E914
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40E921

loc_40E7E2:				; CODE XREF: sub_40E4B0+19j
					; sub_40E4B0+BCj
		mov	esi, 0FFFFFFFFh

loc_40E7E7:				; CODE XREF: sub_40E4B0+23Aj
					; sub_40E4B0+3CDj ...
		add	esp, 3Ch
		mov	eax, esi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40E7F1:				; CODE XREF: sub_40E4B0+B0j
		add	ebp, 1
		mov	esi, 1
		mov	ds:Filename, ebx
		mov	eax, esi
		mov	dword_40F028, ebp
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40E80F:				; CODE XREF: sub_40E4B0+2D6j
		mov	eax, dword_40F038
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40E7AC
		mov	dword_40F028, eax
		jmp	short loc_40E7AC
; ---------------------------------------------------------------------------

loc_40E820:				; CODE XREF: sub_40E4B0+22Aj
		mov	ebx, off_40F03C
		movzx	ecx, byte ptr [ebx]

loc_40E829:				; CODE XREF: sub_40E4B0+1BDj
					; sub_40E4B0+1CFj ...
		movsx	esi, cl
		lea	edi, [ebx+1]
		cmp	esi, 3Ah
		mov	off_40F03C, edi
		jz	loc_40E914
		cmp	esi, 2Dh
		jz	loc_40E9A4

loc_40E847:				; CODE XREF: sub_40E4B0+4FEj
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], esi ; Val
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		jz	loc_40E7CF
		cmp	esi, 57h
		movzx	edx, byte ptr [eax+1]
		jnz	short loc_40E870
		mov	ecx, [esp+4Ch+arg_0]
		test	ecx, ecx
		jnz	short loc_40E88F

loc_40E870:				; CODE XREF: sub_40E4B0+3B6j
					; sub_40E4B0+3E2j
		cmp	dl, 3Ah
		jz	loc_40E9CE
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40E7E7

loc_40E883:				; CODE XREF: sub_40E4B0+53Ej
		add	dword_40F028, 1
		jmp	loc_40E7E7
; ---------------------------------------------------------------------------

loc_40E88F:				; CODE XREF: sub_40E4B0+3BEj
		cmp	dl, 3Bh
		jnz	short loc_40E870
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40EA50
		mov	eax, dword_40F028
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_40F028, eax
		jg	loc_40EA44
		mov	ebp, dword_40F02C
		mov	off_40F03C, offset byte_411FF5
		test	ebp, ebp
		jz	short loc_40E8E6
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40E8E6
		mov	[esp+4Ch+Val], 57h ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_40E0F0

loc_40E8E6:				; CODE XREF: sub_40E4B0+417j
					; sub_40E4B0+420j
		mov	dword_40F024, 57h

loc_40E8F0:				; CODE XREF: sub_40E4B0+58Fj
		mov	ecx, [esp+4Ch+var_20]
		xor	eax, eax
		cmp	byte ptr [ecx],	3Ah
		setnz	al
		mov	esi, eax
		lea	esi, [esi+esi*4+3Ah]
		jmp	loc_40E7E7
; ---------------------------------------------------------------------------

loc_40E907:				; CODE XREF: sub_40E4B0+6Bj
		and	edi, 0FFFFFFFEh
		add	[esp+4Ch+var_20], 1
		jmp	loc_40E521
; ---------------------------------------------------------------------------

loc_40E914:				; CODE XREF: sub_40E4B0+322j
					; sub_40E4B0+388j
		cmp	byte ptr [ebx+1], 0
		jnz	short loc_40E921
		add	dword_40F028, 1

loc_40E921:				; CODE XREF: sub_40E4B0+32Cj
					; sub_40E4B0+468j ...
		mov	ebx, dword_40F02C
		test	ebx, ebx
		jz	short loc_40E944
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40E944
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aUnknownOptionC ;	"unknown option	-- %c"
		call	sub_40E0F0

loc_40E944:				; CODE XREF: sub_40E4B0+479j
					; sub_40E4B0+482j
		mov	dword_40F024, esi
		mov	esi, 3Fh
		jmp	loc_40E7E7
; ---------------------------------------------------------------------------

loc_40E954:				; CODE XREF: sub_40E4B0+1AEj
		add	ebx, 1
		cmp	cl, 2Dh
		mov	off_40F03C, ebx
		jnz	loc_40E667
		cmp	byte ptr [eax+2], 0
		jnz	loc_40E667
		mov	ebx, dword_40F034
		lea	ecx, [ebp+1]
		mov	dword_40F028, ecx
		mov	off_40F03C, offset byte_411FF5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40E7AC
		mov	edx, [esp+4Ch+var_28]
		mov	esi, dword_40F038
		mov	[esp+4Ch+Str], edx
		jmp	loc_40E79B
; ---------------------------------------------------------------------------

loc_40E9A4:				; CODE XREF: sub_40E4B0+391j
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40E921
		jmp	loc_40E847
; ---------------------------------------------------------------------------

loc_40E9B3:				; CODE XREF: sub_40E4B0+1D8j
		add	ebx, 1
		xor	eax, eax
		mov	off_40F03C, ebx
		jmp	loc_40E6B9
; ---------------------------------------------------------------------------

loc_40E9C3:				; CODE XREF: sub_40E4B0+1A6j
		mov	dword_40F034, ebp
		jmp	loc_40E65C
; ---------------------------------------------------------------------------

loc_40E9CE:				; CODE XREF: sub_40E4B0+3C3j
		mov	ds:Filename, 0
		cmp	byte ptr [ebx+1], 0
		jz	short loc_40E9F3
		mov	ds:Filename, edi

loc_40E9E4:				; CODE XREF: sub_40E4B0+547j
					; sub_40E4B0+5D3j
		mov	off_40F03C, offset byte_411FF5
		jmp	loc_40E883
; ---------------------------------------------------------------------------

loc_40E9F3:				; CODE XREF: sub_40E4B0+52Cj
		cmp	byte ptr [eax+2], 3Ah
		jz	short loc_40E9E4
		mov	eax, dword_40F028
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_40F028, eax
		jg	short loc_40EA77
		mov	edi, dword_40F02C
		mov	off_40F03C, offset byte_411FF5
		test	edi, edi
		jz	short loc_40EA39
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40EA39
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_40E0F0

loc_40EA39:				; CODE XREF: sub_40E4B0+56Ej
					; sub_40E4B0+577j
		mov	dword_40F024, esi
		jmp	loc_40E8F0
; ---------------------------------------------------------------------------

loc_40EA44:				; CODE XREF: sub_40E4B0+3FFj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	off_40F03C, eax

loc_40EA50:				; CODE XREF: sub_40E4B0+3E8j
		mov	ecx, [esp+4Ch+arg_4]
		mov	edx, [esp+4Ch+var_20]
		mov	eax, [esp+4Ch+var_28]
		mov	[esp+4Ch+Val], 0
		mov	[esp+4Ch+Str], ecx
		mov	ecx, [esp+4Ch+arg_0]
		call	sub_40E160
		mov	esi, eax
		jmp	loc_40E6E0
; ---------------------------------------------------------------------------

loc_40EA77:				; CODE XREF: sub_40E4B0+55Aj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	ds:Filename, eax
		jmp	loc_40E9E4
sub_40E4B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40EA90	proc near		; CODE XREF: sub_4053E3+1FDp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_8]
		mov	[esp+arg_4], 0
		mov	[esp+arg_8], 0
		mov	[esp+arg_0], 0
		jmp	sub_40E4B0
sub_40EA90	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+18h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		mov	[esp+0Ch], ebx
		mov	ebx, [esp+14h]
		mov	dword ptr [esp+10h], 1
		mov	[esp+8], ebx
		pop	ebx
		jmp	sub_40E4B0
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+18h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		mov	[esp+0Ch], ebx
		mov	ebx, [esp+14h]
		mov	dword ptr [esp+10h], 5
		mov	[esp+8], ebx
		pop	ebx
		jmp	sub_40E4B0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40EB20	proc near		; CODE XREF: sub_4017D0+Fp
		jmp	sub_40EE10
sub_40EB20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_40EB30	proc near		; CODE XREF: sub_40ED10+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_40EB7C
		jmp	short loc_40EB84
; ---------------------------------------------------------------------------
		align 10h

loc_40EB70:				; CODE XREF: sub_40EB30+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_40EB84

loc_40EB7C:				; CODE XREF: sub_40EB30+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_40EB70

loc_40EB84:				; CODE XREF: sub_40EB30+39j
					; sub_40EB30+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_40EBAC
		jmp	short loc_40EBB4
; ---------------------------------------------------------------------------
		align 10h

loc_40EBA0:				; CODE XREF: sub_40EB30+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_40EBB4

loc_40EBAC:				; CODE XREF: sub_40EB30+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_40EBA0

loc_40EBB4:				; CODE XREF: sub_40EB30+6Aj
					; sub_40EB30+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_40EC70
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_40EC9E

loc_40EBD3:				; CODE XREF: sub_40EB30+168j
					; sub_40EB30+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40ECB0

loc_40EC03:				; CODE XREF: sub_40EB30+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_413424
		test	eax, eax
		jz	loc_40ECE9
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_40ECD1
		cmp	eax, 5
		jnz	short loc_40ECCC
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40EC70:				; CODE XREF: sub_40EB30+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_40EBD3

loc_40EC9E:				; CODE XREF: sub_40EB30+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_40EBD3
; ---------------------------------------------------------------------------
		align 10h

loc_40ECB0:				; CODE XREF: sub_40EB30+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_40EC03
; ---------------------------------------------------------------------------

loc_40ECCC:				; CODE XREF: sub_40EB30+133j
		call	abort
; ---------------------------------------------------------------------------

loc_40ECD1:				; CODE XREF: sub_40EB30+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_40ECE9:				; CODE XREF: sub_40EB30+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_1 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_40EB30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40ED10(char *, char *, int)
sub_40ED10	proc near		; CODE XREF: sub_4053E3+1368p
					; sub_409CFA+3Ep

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40ED76
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_40ED60:				; CODE XREF: sub_40ED10+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_40ED60
		add	edx, edx

loc_40ED76:				; CODE XREF: sub_40ED10+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40ED9D
		xor	edi, edi

loc_40ED87:				; CODE XREF: sub_40ED10+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_40ED87
		add	edx, edx

loc_40ED9D:				; CODE XREF: sub_40ED10+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_40EB30
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_40ED10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40EDE0	proc near		; CODE XREF: sub_407D16+2Dp
		jmp	sub_40EE20
sub_40EDE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40EDF0	proc near		; CODE XREF: sub_409CFA+9Cp
		jmp	sub_40EE30
sub_40EDF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40EE00	proc near		; CODE XREF: sub_409CFA+AAp
		jmp	sub_40EE40
sub_40EE00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40EE10	proc near		; CODE XREF: sub_40EB20j
		mov	eax, ds:gmtime
		jmp	eax
sub_40EE10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40EE20	proc near		; CODE XREF: sub_40EDE0j
		mov	eax, ds:mktime
		jmp	eax
sub_40EE20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40EE30	proc near		; CODE XREF: sub_40EDF0j
		mov	eax, ds:time
		jmp	eax
sub_40EE30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40EE40	proc near		; CODE XREF: sub_40EE00j
		mov	eax, ds:localtime
		jmp	eax
sub_40EE40	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sscanf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fgets]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strspn]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EFC0	proc near		; DATA XREF: .text:0040EFE4o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_40CFB0
		leave
		retn
sub_40EFC0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_40EFE0	dd 0FFFFFFFFh		; DATA XREF: sub_40DBD0-4Cr
					; sub_40DBD0:loc_40DB93r ...
		dd offset sub_40EFC0
		dd 0
		dd 0FFFFFFFFh
dword_40EFF0	dd 4 dup(0)		; DATA XREF: .data:off_40F018o
_text		ends

; Section 2. (virtual address 0000F000)
; Virtual size			: 0000004C (	 76.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000E400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 40F000h
; PCHAR	off_40F000
off_40F000	dd offset aPgpkey	; DATA XREF: sub_402B94+65r
					; sub_4033A7+81r ...
					; "pgpKey"
dword_40F004	dd 0FFFFFFFFh		; DATA XREF: sub_4098D9:loc_409A5Fw
					; .text:loc_409C93r ...
; char off_40F008[]
off_40F008	dd offset aIso88591	; DATA XREF: sub_40A2B4+D9w
					; .text:loc_40A588w ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_40F018	dd offset dword_40EFF0	; DATA XREF: sub_40DB50+3r
					; sub_40DB50+12r ...
dword_40F01C	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_40F020	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_40F024	dd 3Fh			; DATA XREF: sub_40E160:loc_40E2B7w
					; sub_40E160+1F8w ...
dword_40F028	dd 1			; DATA XREF: sub_4053E3+217r
					; sub_4053E3+226r ...
dword_40F02C	dd 1			; DATA XREF: sub_40E160+12Cr
					; sub_40E160+1C3r ...
dword_40F030	dd 0FFFFFFFFh		; DATA XREF: sub_40E4B0:loc_40E4DDr
					; sub_40E4B0:loc_40E50Ar ...
dword_40F034	dd 0FFFFFFFFh		; DATA XREF: sub_40E4B0+83w
					; sub_40E4B0+D1r ...
dword_40F038	dd 0FFFFFFFFh		; DATA XREF: sub_40E4B0+8Dw
					; sub_40E4B0+C2r ...
; char *off_40F03C
off_40F03C	dd offset byte_411FF5	; DATA XREF: sub_40E160+Br
					; sub_40E4B0+A6w ...
dword_40F040	dd 0BB40E64Eh		; DATA XREF: sub_40DBF0+3r
					; sub_40DBF0:loc_40DCA2w ...
dword_40F044	dd 44BF19B1h		; DATA XREF: sub_40DBF0+31w
					; sub_40DBF0+B8w ...
dword_40F048	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00010000)
; Virtual size			: 00002140 (   8512.)
; Section size in file		: 00002200 (   8704.)
; Offset to raw	data for section: 0000E600
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 410000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
; char aPgpkey[]
aPgpkey		db 'pgpKey',0           ; DATA XREF: sub_40230E+6D9o
					; .data:off_40F000o
		align 4
aGpgkeysOutOfMe	db 'gpgkeys: out of memory when deduping key list',0Ah,0
					; DATA XREF: sub_40167C+21o
; char Format[]
Format		db '%4d%2d%2d%2d%2d%2d',0 ; DATA XREF: sub_401733+1Do
a04d02d02d02d02	db '%04d%02d%02d%02d%02d%02dZ',0 ; DATA XREF: sub_4017D0+5Eo
; char asc_4100A8[]
asc_4100A8	db ':',0                ; DATA XREF: sub_401C06:loc_401C92o
					; sub_401C06+D5o ...
aPub		db 'pub',0              ; DATA XREF: sub_401C06+B3o
; char aPgpcertid[]
aPgpcertid	db 'pgpCertID',0        ; DATA XREF: sub_401C06+124o
					; sub_40230E+21Eo ...
; char aPgpkeyid[]
aPgpkeyid	db 'pgpKeyID',0         ; DATA XREF: sub_401C06+141o
					; sub_40230E+110o ...
; char off_4100C1[]
off_4100C1	dd offset word_415352	; DATA XREF: sub_401C06:loc_401D91o
					; sub_402FF3+6Do ...
; char aPgpkeytype[]
aPgpkeytype	db 'pgpKeyType',0       ; DATA XREF: sub_401C06+193o
					; sub_401C06+1B0o ...
; char aDssDh[]
aDssDh		db 'DSS/DH',0           ; DATA XREF: sub_401C06:loc_401DAEo
					; sub_402FF3+9Do ...
; char a05u[]
a05u		db '%05u',0             ; DATA XREF: sub_401C06+21Bo
					; sub_401C06+4EAo
; char aPgpkeysize[]
aPgpkeysize	db 'pgpKeySize',0       ; DATA XREF: sub_401C06+23Ao
					; sub_401C06+509o ...
; char aPgpkeycreateti[]
aPgpkeycreateti	db 'pgpKeyCreateTime',0 ; DATA XREF: sub_401C06+29Fo
					; sub_40230E+16Ao
; char aPgpkeyexpireti[]
aPgpkeyexpireti	db 'pgpKeyExpireTime',0 ; DATA XREF: sub_401C06+30Fo
					; sub_40230E+200o
; char a1[]
a1		db '1',0                ; DATA XREF: sub_401C06+399o
					; sub_401C06+3C2o
a0		db '0',0                ; DATA XREF: sub_401C06:loc_401FA6o
					; sub_401C06:loc_401FCFo
; char aPgpdisabled[]
aPgpdisabled	db 'pgpDisabled',0      ; DATA XREF: sub_401C06+3A9o
					; sub_40230E+F2o
; char aPgprevoked[]
aPgprevoked	db 'pgpRevoked',0       ; DATA XREF: sub_401C06+3D2o
					; sub_40230E+1A6o
aSub		db 'sub',0              ; DATA XREF: sub_401C06+3F1o
; char aPgpsubkeyid[]
aPgpsubkeyid	db 'pgpSubKeyID',0      ; DATA XREF: sub_401C06+454o
					; sub_40230E+1C4o
aUid		db 'uid',0              ; DATA XREF: sub_401C06+528o
; char aPgpuserid[]
aPgpuserid	db 'pgpUserID',0        ; DATA XREF: sub_401C06+602o
					; sub_40230E+14Co ...
aSig		db 'sig',0              ; DATA XREF: sub_401C06+621o
; char aPgpsignerid[]
aPgpsignerid	db 'pgpSignerID',0      ; DATA XREF: sub_401C06+67Co
					; sub_40230E+188o
		align 4
aGpgkeysCanTAll	db 'gpgkeys: can',27h,'t allocate memory for keyserver record',0Ah,0
					; DATA XREF: sub_40230E+56o
					; sub_40230E+B1o ...
; char aInfo16s5s[]
aInfo16s5s	db 'INFO%*[ ]%16s%*[ ]%5s',0Ah,0 ; DATA XREF: sub_40230E:loc_402544o
; char Str2[]
Str2		db 'BEGIN',0            ; DATA XREF: sub_40230E+266o
					; sub_40230E+4FBo ...
; char aPgpcertidSS[]
aPgpcertidSS	db 'pgpCertID=%s,%s',0  ; DATA XREF: sub_40230E+37Do
		align 4
aGpgkeysUnableT	db 'gpgkeys: unable to allocate memory for key',0Ah,0
					; DATA XREF: sub_40230E+3BAo
					; sub_402B94+163o
; char aInfo16s3s[]
aInfo16s3s	db 'INFO%*[ ]%16s%*[ ]%3s',0Ah,0 ; DATA XREF: sub_40230E:loc_4026FDo
; char aEnd[]
aEnd		db 'END',0              ; DATA XREF: sub_40230E+41Fo
					; sub_40230E+590o ...
		align 10h
; char aGpgkeysNoInfoS[]
aGpgkeysNoInfoS	db 'gpgkeys: no INFO %s END found',0Ah,0 ; DATA XREF: sub_40230E+487o
; char aKey16s5s[]
aKey16s5s	db 'KEY%*[ ]%16s%*[ ]%5s',0Ah,0 ; DATA XREF: sub_40230E:loc_4027D9o
					; sub_402B94:loc_402D2Fo
; char aKey16s3s[]
aKey16s3s	db 'KEY%*[ ]%16s%*[ ]%3s',0Ah,0 ; DATA XREF: sub_40230E:loc_40286Eo
					; sub_402B94:loc_402DC4o
		align 4
aGpgkeysUnabl_0	db 'gpgkeys: unable to reallocate for key',0Ah,0
					; DATA XREF: sub_40230E+607o
					; sub_402B94+2E1o
; char aGpgkeysNoKeySE[]
aGpgkeysNoKeySE	db 'gpgkeys: no KEY %s END found',0Ah,0 ; DATA XREF: sub_40230E+67Fo
					; sub_402B94+356o
; char aPgpkeyinfo[]
aPgpkeyinfo	db 'pgpKeyInfo',0       ; DATA XREF: sub_40230E:loc_4029C2o
; char aObjectclass[]
aObjectclass	db 'objectClass',0      ; DATA XREF: sub_40230E+6BCo
aGpgkeysUnabl_1	db 'gpgkeys: unable to merge LDAP modification lists',0Ah,0
					; DATA XREF: sub_40230E+711o
		align 4
; char aGpgkeysErrorAd[]
aGpgkeysErrorAd	db 'gpgkeys: error adding key %s to keyserver: %s',0Ah,0
					; DATA XREF: sub_40230E+79Do
					; sub_402B94+3BEo
; char aKeySFailedD[]
aKeySFailedD	db 'KEY %s FAILED %d',0Ah,0 ; DATA XREF: sub_40230E+853o
					; sub_402B94+41Fo ...
aPgpcertidVirtu	db 'pgpCertid=virtual,',0 ; DATA XREF: sub_402B94:loc_402C94o
; char aInfoSBegin[]
aInfoSBegin	db 'INFO %s BEGIN',0Ah,0 ; DATA XREF: sub_402FF3+7o
; char aPubS[]
aPubS		db 'pub:%s:',0          ; DATA XREF: sub_402FF3+24o
					; sub_404077+877o
; CHAR attr[]
attr		db 'pgpkeytype',0       ; DATA XREF: sub_402FF3+46o
					; sub_4033A7+73o ...
a17		db '17',0               ; DATA XREF: sub_402FF3+B7o
					; sub_404077+90Fo
; CHAR aPgpkeysize_0[]
aPgpkeysize_0	db 'pgpkeysize',0       ; DATA XREF: sub_402FF3+FFo
					; sub_4033A7+69o ...
; char aD[]
aD		db '%d',0               ; DATA XREF: sub_402FF3+13Fo
					; sub_404077+997o
; CHAR aPgpkeycreate_0[]
aPgpkeycreate_0	db 'pgpkeycreatetime',0 ; DATA XREF: sub_402FF3+181o
					; sub_4033A7+55o ...
; char aU[]
aU		db '%u',0               ; DATA XREF: sub_402FF3+1D8o
					; sub_402FF3+270o ...
; CHAR aPgpkeyexpire_0[]
aPgpkeyexpire_0	db 'pgpkeyexpiretime',0 ; DATA XREF: sub_402FF3+219o
					; sub_404077+3Co ...
; CHAR aPgprevoked_0[]
aPgprevoked_0	db 'pgprevoked',0       ; DATA XREF: sub_402FF3+2B1o
					; sub_4033A7+41o ...
; CHAR aPgpuserid_0[]
aPgpuserid_0	db 'pgpuserid',0        ; DATA XREF: sub_402FF3+321o
					; sub_4033A7+2Do ...
; char aUidS[]
aUidS		db 'uid:%s',0Ah,0       ; DATA XREF: sub_402FF3+357o
; char aInfoSEnd[]
aInfoSEnd	db 'INFO %s END',0Ah,0  ; DATA XREF: sub_402FF3:loc_403384o
aReplaceme	db 'replaceme',0        ; DATA XREF: sub_4033A7+19o
					; sub_403A3F+12o
; CHAR aPgpcertid_0[]
aPgpcertid_0	db 'pgpcertid',0        ; DATA XREF: sub_4033A7+23o
					; sub_4033A7+44Do ...
aPgpkeyid_0	db 'pgpkeyid',0         ; DATA XREF: sub_4033A7+37o
					; sub_403A3F+30o
; CHAR aPgpdisabled_0[]
aPgpdisabled_0	db 'pgpdisabled',0      ; DATA XREF: sub_4033A7+4Bo
					; sub_403A3F+44o ...
aModifytimestam	db 'modifytimestamp',0  ; DATA XREF: sub_4033A7+5Fo
					; sub_403A3F+58o ...
a0x		db '0x',0               ; DATA XREF: sub_4033A7+91o
		align 10h
aGpgkeysLdapKey	db 'gpgkeys: LDAP keyservers do not support v3 fingerprints',0Ah,0
					; DATA XREF: sub_4033A7+E8o
; char aKey0xSBegin[]
aKey0xSBegin	db 'KEY 0x%s BEGIN',0Ah,0 ; DATA XREF: sub_4033A7+109o
					; sub_4033A7+35Eo ...
; char aKey0xSFailedD[]
aKey0xSFailedD	db 'KEY 0x%s FAILED %d',0Ah,0 ; DATA XREF: sub_4033A7+126o
					; sub_4033A7+37Bo ...
		align 10h
; char aPgpcertid_16sP[]
aPgpcertid_16sP	db '(|(pgpcertid=%.16s)(pgpsubkeyid=%.16s))',0 ; DATA XREF: sub_4033A7+1C1o
					; sub_4033A7+242o
; char aPgpcertid_16s[]
aPgpcertid_16s	db '(pgpcertid=%.16s)',0 ; DATA XREF: sub_4033A7:loc_40358Fo
					; sub_4033A7:loc_40360Do
; char aPgpkeyid_8s[]
aPgpkeyid_8s	db '(pgpkeyid=%.8s)',0  ; DATA XREF: sub_4033A7:loc_40362Ao
; char aGpgkeysLdapFet[]
aGpgkeysLdapFet	db 'gpgkeys: LDAP fetch for: %s',0Ah,0 ; DATA XREF: sub_4033A7+2ABo
					; sub_403A3F+2BEo
		align 4
; char aGpgkeysLdapSea[]
aGpgkeysLdapSea	db 'gpgkeys: LDAP search error: %s',0Ah,0 ; DATA XREF: sub_4033A7+343o
					; sub_403A3F+35Co ...
; char aGpgkeysKeySNot[]
aGpgkeysKeySNot	db 'gpgkeys: key %s not found on keyserver',0Ah,0
					; DATA XREF: sub_4033A7+3C6o
					; sub_403A3F+3DFo
; char aGpgkeysUnabl_2[]
aGpgkeysUnabl_2	db 'gpgkeys: unable to retrieve key %s from keyserver',0Ah,0
					; DATA XREF: sub_4033A7+521o
					; sub_403A3F+4F6o
; char aKey0xSEnd[]
aKey0xSEnd	db 0Ah			; DATA XREF: sub_4033A7+57Ao
		db 'KEY 0x%s END',0Ah,0
; char Str[]
Str		db '*()\',0             ; DATA XREF: sub_4039A7+38o
; char a02x[]
a02x		db '\%02X',0            ; DATA XREF: sub_4039A7+51o
asc_41054D	db '(&',0               ; DATA XREF: sub_403A3F:loc_403AF1o
					; sub_404077:loc_4041E0o
aPgpuserid_1	db '(pgpUserID=*',0     ; DATA XREF: sub_403A3F:loc_403B33o
asc_41055D	db '*)',0               ; DATA XREF: sub_403A3F+155o
aPgpdisabled0	db '(pgpDisabled=0)',0  ; DATA XREF: sub_403A3F+1A7o
					; sub_404077+45Ao
aPgprevoked0	db '(pgpRevoked=0)',0   ; DATA XREF: sub_403A3F+202o
					; sub_404077+4A7o
asc_41057F	db ')',0                ; DATA XREF: sub_403A3F:loc_403CB5o
					; sub_404077:loc_404494o ...
; char aNameSBegin[]
aNameSBegin	db 'NAME %s BEGIN',0Ah,0 ; DATA XREF: sub_403A3F+377o
					; sub_403A3F+3FCo ...
; char aNameSFailedD[]
aNameSFailedD	db 'NAME %s FAILED %d',0Ah,0 ; DATA XREF: sub_403A3F+394o
					; sub_403A3F+419o ...
; char aNameSEnd[]
aNameSEnd	db 0Ah			; DATA XREF: sub_403A3F+54Fo
		db 'NAME %s END',0Ah,0
; char a02x_0[]
a02x_0		db '%%%02x',0           ; DATA XREF: sub_404009+2Co
aGpgkeysOutOf_0	db 'gpgkeys: out of memory when building search list',0Ah,0
					; DATA XREF: sub_404077+98o
; char aSearchSFailedD[]
aSearchSFailedD	db 'SEARCH %s FAILED %d',0Ah,0 ; DATA XREF: sub_404077+BCo
					; sub_404077+5CDo ...
; char aSearchSBegin[]
aSearchSBegin	db 'SEARCH %s BEGIN',0Ah,0 ; DATA XREF: sub_404077+EBo
; char aSearchTypeIsDA[]
aSearchTypeIsDA	db 'search type is %d, and key is "%s"',0Ah,0 ; DATA XREF: sub_404077+122o
asc_410634:				; DATA XREF: sub_404077:loc_404214o
		unicode	0, <(=*>
asc_41063A	db '*<',0               ; DATA XREF: sub_404077:loc_404372o
asc_41063D	db '*<*',0              ; DATA XREF: sub_404077:loc_4043A8o
asc_410641	db '>*',0               ; DATA XREF: sub_404077:loc_404430o
asc_410644	db '*>*',0              ; DATA XREF: sub_404077:loc_404466o
; char aGpgkeysLdapS_0[]
aGpgkeysLdapS_0	db 'gpgkeys: LDAP search for: %s',0Ah,0 ; DATA XREF: sub_404077+547o
		align 4
; char aGpgkeysSearchR[]
aGpgkeysSearchR	db 'gpgkeys: search results exceeded server limit.  First %d result s'
					; DATA XREF: sub_404077+702o
		db 'hown.',0Ah,0
; char aGpgkeysSearc_0[]
aGpgkeysSearc_0	db 'gpgkeys: search results exceeded server limit.  First %d results '
					; DATA XREF: sub_404077:loc_404798o
		db 'shown.',0Ah,0
aInfo10		db 'info:1:0',0Ah,0     ; DATA XREF: sub_404077+75Co
; char aInfo1D[]
aInfo1D		db 'info:1:%d',0Ah,0    ; DATA XREF: sub_404077:loc_4047F9o
aUid_0		db 'uid:',0             ; DATA XREF: sub_404077+C3Eo
; char aSearchSEnd[]
aSearchSEnd	db 'SEARCH %s END',0Ah,0 ; DATA XREF: sub_404077+D41o
		align 4
off_410724	dd offset loc_404343	; DATA XREF: sub_404077+2C3o
		dd offset loc_4043D5	; jump table for switch	statement
		dd offset loc_404372
		dd offset loc_4043A8
		dd offset loc_4043D5
		dd offset loc_4043D5
off_41073C	dd offset loc_404401	; DATA XREF: sub_404077+381o
		dd offset loc_404493	; jump table for switch	statement
		dd offset loc_404430
		dd offset loc_404466
		dd offset loc_404493
		dd offset loc_404493
aSearch		db 'SEARCH ',0          ; DATA XREF: sub_404DE1+27o
; char aS[]
aS		db '%s ',0              ; DATA XREF: sub_404DE1+4Do
; char aFailedD[]
aFailedD	db 'FAILED %d',0Ah,0    ; DATA XREF: sub_404DE1+79o
; CHAR aNamingcontexts[]
aNamingcontexts	db 'namingContexts',0   ; DATA XREF: sub_404EB8+7o
					; sub_404EB8+75o
; CHAR filter[]
filter		db '(objectClass=*)',0  ; DATA XREF: sub_404EB8+3Eo
					; sub_404EB8+163o ...
; CHAR byte_41078A
byte_41078A	db 0			; DATA XREF: sub_404EB8+4Eo
; CHAR aPgpbasekeyspac[]
aPgpbasekeyspac	db 'pgpBaseKeySpaceDN',0 ; DATA XREF: sub_404EB8+98o
					; sub_404EB8+1B2o ...
; CHAR aPgpversion[]
aPgpversion	db 'pgpVersion',0       ; DATA XREF: sub_404EB8+9Fo
					; sub_404EB8+25Co
; CHAR aPgpsoftware[]
aPgpsoftware	db 'pgpSoftware',0      ; DATA XREF: sub_404EB8+A6o
					; sub_404EB8+209o
aCnPgpserverinf	db 'cn=pgpServerInfo,',0 ; DATA XREF: sub_404EB8:loc_404FC0o
; char aServerS[]
aServerS	db 'Server: ',9,'%s',0Ah,0 ; DATA XREF: sub_404EB8+22Do
					; sub_404EB8+3D8o
; char aVersionS[]
aVersionS	db 'Version:',9,'%s',0Ah,0 ; DATA XREF: sub_404EB8+280o
					; sub_404EB8+438o
; CHAR aVersion[]
aVersion	db 'version',0          ; DATA XREF: sub_404EB8+2FDo
					; sub_404EB8+407o
; CHAR aSoftware[]
aSoftware	db 'software',0         ; DATA XREF: sub_404EB8+304o
					; sub_404EB8+3B4o
; CHAR aCnPgpserveri_0[]
aCnPgpserveri_0	db 'cn=pgpServerInfo',0 ; DATA XREF: sub_404EB8+336o
; CHAR aBasekeyspacedn[]
aBasekeyspacedn	db 'baseKeySpaceDN',0   ; DATA XREF: sub_404EB8+361o
aPgpkeyv2	db 'pgpKeyV2',0         ; DATA XREF: sub_404EB8+464o
aHHelpHelp	db '-h, --help',9,'help',0Ah,0 ; DATA XREF: sub_40534B+6o
aVMachineReadab	db '-V',9,9,'machine readable version',0Ah,0 ; DATA XREF: sub_40534B+2Ao
		align 4
aVersionHumanRe	db '--version',9,'human readable version',0Ah,0 ; DATA XREF: sub_40534B+4Eo
aOOutputToThisF	db '-o',9,9,'output to this file',0Ah,0 ; DATA XREF: sub_40534B+72o
; char aVersion_0[]
aVersion_0	db '--version',0        ; DATA XREF: sub_4053E3+9Co
aGpgkeys_ldapGn	db 'gpgkeys_ldap (GnuPG) 2.0.30',0Ah,0 ; DATA XREF: sub_4053E3+B8o
; char aHelp[]
aHelp		db '--help',0           ; DATA XREF: sub_4053E3+F5o
; char aDS[]
aDS		db '%d',0Ah             ; DATA XREF: sub_4053E3:loc_405532o
		db '%s',0Ah,0
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_4053E3+15Do
					; sub_4053E3+AF7o
; char Mode[]
Mode		db 'w',0                ; DATA XREF: sub_4053E3:loc_405566o
		align 4
; char aGpgkeysCannotO[]
aGpgkeysCannotO	db 'gpgkeys: Cannot open output file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_4053E3+1BEo
aHvo		db 'hVo:',0             ; DATA XREF: sub_4053E3:loc_4055CBo
; char aR[]
aR		db 'r',0                ; DATA XREF: sub_4053E3+221o
		align 4
; char aGpgkeysCanno_0[]
aGpgkeysCanno_0	db 'gpgkeys: Cannot open input file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_4053E3+26Co
; char aOption256[]
aOption256	db 'OPTION %256[^',0Ah  ; DATA XREF: sub_4053E3+339o
		db ']',0Ah,0
; char aNo[]
aNo		db 'no-',0              ; DATA XREF: sub_4053E3+388o
; char aTls[]
aTls		db 'tls',0              ; DATA XREF: sub_4053E3+3C3o
; char aNo_0[]
aNo_0		db 'no',0               ; DATA XREF: sub_4053E3+41Do
; char aTry[]
aTry		db 'try',0              ; DATA XREF: sub_4053E3+44Do
; char aWarn[]
aWarn		db 'warn',0             ; DATA XREF: sub_4053E3+47Do
; char aRequire[]
aRequire	db 'require',0          ; DATA XREF: sub_4053E3+4ADo
; char aBasedn[]
aBasedn		db 'basedn',0           ; DATA XREF: sub_4053E3+510o
		align 4
aGpgkeysOutOf_1	db 'gpgkeys: out of memory while creating base DN',0Ah,0
					; DATA XREF: sub_4053E3+59Fo
; char aBinddn[]
aBinddn		db 'binddn',0           ; DATA XREF: sub_4053E3+5E7o
		align 4
aGpgkeysOutOf_2	db 'gpgkeys: out of memory while creating bind DN',0Ah,0
					; DATA XREF: sub_4053E3+67Eo
; char aBindpw[]
aBindpw		db 'bindpw',0           ; DATA XREF: sub_4053E3+6C6o
		align 4
aGpgkeysOutOf_3	db 'gpgkeys: out of memory while creating bind password',0Ah,0
					; DATA XREF: sub_4053E3+759o
aGpgkeysNoSchem	db 'gpgkeys: no scheme supplied!',0Ah,0 ; DATA XREF: sub_4053E3+7DAo
; char aLdaps[]
aLdaps		db 'ldaps',0            ; DATA XREF: sub_4053E3+813o
		align 4
aGpgkeysNoKeyse	db 'gpgkeys: no keyserver host provided',0Ah,0 ; DATA XREF: sub_4053E3+874o
		align 10h
aGpgkeysUnabl_3	db 'gpgkeys: unable to register timeout handler',0Ah,0
					; DATA XREF: sub_4053E3+8B6o
		align 10h
aGpgkeysOutOf_4	db 'gpgkeys: out of memory while building key list',0Ah,0
					; DATA XREF: sub_4053E3+9CFo
aGpgkeysNoKey_0	db 'gpgkeys: no keyserver command specified',0Ah,0
					; DATA XREF: sub_4053E3+AA8o
; char aVersionD[]
aVersionD	db 'VERSION %d',0Ah,0   ; DATA XREF: sub_4053E3:loc_405EB2o
; char aProgramS[]
aProgramS	db 'PROGRAM %s',0Ah     ; DATA XREF: sub_4053E3+AEDo
		db 0Ah,0
; char aHostS[]
aHostS		db 'Host:',9,9,'%s',0Ah,0 ; DATA XREF: sub_4053E3+B20o
; char aPortD[]
aPortD		db 'Port:',9,9,'%d',0Ah,0 ; DATA XREF: sub_4053E3+B44o
; char aCommandS[]
aCommandS	db 'Command:',9,'%s',0Ah,0 ; DATA XREF: sub_4053E3+B74o
		align 4
aGpgkeysNotBuil	db 'gpgkeys: not built with debugging support',0Ah,0
					; DATA XREF: sub_4053E3+BA1o
		align 4
; char aGpgkeysInterna[]
aGpgkeysInterna	db 'gpgkeys: internal LDAP init error: %s',0Ah,0
					; DATA XREF: sub_4053E3+C0Eo
		align 4
; char aGpgkeysUnabl_4[]
aGpgkeysUnabl_4	db 'gpgkeys: unable to make SSL connection: %s',0Ah,0
					; DATA XREF: sub_4053E3+C4Fo
aNotBuiltWithLd	db 'not built with LDAPS support',0 ; DATA XREF: sub_4053E3+C59o
aNotFound	db 'not found',0        ; DATA XREF: sub_4053E3:loc_4060B5o
		align 10h
; char aGpgkeysUnabl_5[]
aGpgkeysUnabl_5	db 'gpgkeys: unable to retrieve LDAP base: %s',0Ah,0
					; DATA XREF: sub_4053E3:loc_4060BAo
		align 4
; char aGpgkeysUnabl_6[]
aGpgkeysUnabl_6	db 'gpgkeys: unable to start TLS: %s',0Ah,0 ; DATA XREF: sub_4053E3+D3Ao
					; sub_4053E3+E28o
		align 10h
aNotSupportedBy	db 'not supported by the NAI LDAP keyserver',0 ; DATA XREF: sub_4053E3+D44o
aGpgkeysTlsStar	db 'gpgkeys: TLS started successfully.',0Ah,0 ; DATA XREF: sub_4053E3+E87o
; char aGpgkeysUnabl_7[]
aGpgkeysUnabl_7	db 'gpgkeys: unable to go to LDAP 3: %s',0Ah,0 ; DATA XREF: sub_4053E3+F05o
aNotShown	db '>not shown<',0      ; DATA XREF: sub_4053E3+F5Eo
aNone		db '>none<',0           ; DATA XREF: sub_4053E3:loc_406348o
; char aGpgkeysLdapBin[]
aGpgkeysLdapBin	db 'gpgkeys: LDAP bind to %s, pw %s',0Ah,0
					; DATA XREF: sub_4053E3:loc_40634Do
		align 4
; char aGpgkeysInter_0[]
aGpgkeysInter_0	db 'gpgkeys: internal LDAP bind error: %s',0Ah,0
					; DATA XREF: sub_4053E3+FD7o
		align 10h
; char a____Gnupg22_0_[]
a____Gnupg22_0_	db '../../gnupg2-2.0.30/keyserver/gpgkeys_ldap.c',0
					; DATA XREF: sub_4053E3+1359o
; char aBadAction[]
aBadAction	db '!"bad action"',0    ; DATA XREF: sub_4053E3+1361o
		align 4
; char Src[]
Src		db '/',0                ; DATA XREF: sub_4068E8+5Do
; char aCommand7s[]
aCommand7s	db 'COMMAND %7s',0Ah,0  ; DATA XREF: sub_4069F5:loc_406A12o
; char aGet[]
aGet		db 'get',0              ; DATA XREF: sub_4069F5+45o
; char aGetname[]
aGetname	db 'getname',0          ; DATA XREF: sub_4069F5:loc_406A5Eo
; char aSend[]
aSend		db 'send',0             ; DATA XREF: sub_4069F5:loc_406A82o
; char aSearch_0[]
aSearch_0	db 'search',0           ; DATA XREF: sub_4069F5:loc_406AA6o
; char aHost80s[]
aHost80s	db 'HOST %80s',0Ah,0    ; DATA XREF: sub_4069F5:loc_406AD2o
; char aPort10s[]
aPort10s	db 'PORT %10s',0Ah,0    ; DATA XREF: sub_4069F5:loc_406B35o
; char aScheme20s[]
aScheme20s	db 'SCHEME %20s',0Ah,0  ; DATA XREF: sub_4069F5:loc_406B98o
; char aAuth128s[]
aAuth128s	db 'AUTH %128s',0Ah,0   ; DATA XREF: sub_4069F5:loc_406C01o
; char aPath1024s[]
aPath1024s	db 'PATH %1024s',0Ah,0  ; DATA XREF: sub_4069F5:loc_406C6Do
; char aOpaque1024s[]
aOpaque1024s	db 'OPAQUE %1024s',0Ah,0 ; DATA XREF: sub_4069F5:loc_406CD9o
; char aVersionD_0[]
aVersionD_0	db 'VERSION %d',0Ah,0   ; DATA XREF: sub_4069F5:loc_406D45o
; char aOption256_0[]
aOption256_0	db 'OPTION %256[^',0Ah  ; DATA XREF: sub_4069F5:loc_406D81o
		db ']',0Ah,0
; char aNo_1[]
aNo_1		db 'no-',0              ; DATA XREF: sub_4069F5+3D2o
; char aVerbose[]
aVerbose	db 'verbose',0          ; DATA XREF: sub_4069F5+409o
; char aIncludeDisable[]
aIncludeDisable	db 'include-disabled',0 ; DATA XREF: sub_4069F5:loc_406E68o
; char aIncludeRevoked[]
aIncludeRevoked	db 'include-revoked',0  ; DATA XREF: sub_4069F5:loc_406EABo
; char aIncludeSubkeys[]
aIncludeSubkeys	db 'include-subkeys',0  ; DATA XREF: sub_4069F5:loc_406EEEo
; char aCheckCert[]
aCheckCert	db 'check-cert',0       ; DATA XREF: sub_4069F5:loc_406F31o
; char aDebug[]
aDebug		db 'debug',0            ; DATA XREF: sub_4069F5+587o
; char aTimeout[]
aTimeout	db 'timeout',0          ; DATA XREF: sub_4069F5+605o
; char aCaCertFile[]
aCaCertFile	db 'ca-cert-file',0     ; DATA XREF: sub_4069F5+683o
aUnknown	db 'UNKNOWN',0          ; DATA XREF: sub_407100:loc_407118o
aGet_0		db 'GET',0              ; DATA XREF: sub_407100:loc_40711Fo
aGetname_0	db 'GETNAME',0          ; DATA XREF: sub_407100:loc_407126o
aSend_0		db 'SEND',0             ; DATA XREF: sub_407100:loc_40712Do
aSearch_1	db 'SEARCH',0           ; DATA XREF: sub_407100:loc_407134o
a?		db '?',0                ; DATA XREF: sub_407100:loc_40713Bo
off_410E30	dd offset loc_407118	; DATA XREF: sub_407100+Fo
		dd offset loc_40711F	; jump table for switch	statement
		dd offset loc_407126
		dd offset loc_40712D
		dd offset loc_407134
; char Control[]
Control		db 'abcdefABCDEF1234567890x',0 ; DATA XREF: sub_40717C+C1o
					; sub_40717C+115o
off_410E5C	dd offset loc_4071A3	; DATA XREF: sub_40717C+1Er
		dd offset loc_4072BA	; jump table for switch	statement
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4071FF
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4071D1
		dd offset loc_4071BA
		dd offset loc_4072BA
		dd offset loc_4072BA
		dd offset loc_4071E8
byte_410EB8	db 41h			; DATA XREF: sub_407304+7Er
					; sub_407304+C1r ...
aBcdefghijklmno	db 'BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',0
		align 4
aBeginPgpPublic	db '-----BEGIN PGP PUBLIC KEY BLOCK-----',0Ah ; DATA XREF: .text:004074E8o
		db 0Ah,0
		align 4
aBeginPgpPubl_0	db '-----BEGIN PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: .text:0040750Eo
					; .text:004075E2o
		align 4
aEndPgpPublicKe	db '-----END PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: .text:004075CBo
		align 10h
aEndPgpPublic_0	db 0Ah			; DATA XREF: .text:004077EAo
		db '-----END PGP PUBLIC KEY BLOCK-----',0
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating enough memory: %s',0Ah,0 ; DATA XREF: sub_4079F0+17o
; char VarName[]
VarName		db 'TZ',0               ; DATA XREF: sub_407D16+7o
					; sub_407D16:loc_407DCCo
; char EnvString[]
EnvString	db 'TZ=UTC',0           ; DATA XREF: sub_407D16+16o
aTz_0		db 'TZ=',0              ; DATA XREF: sub_407D16+7Co
		align 4
asc_410FC8	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:004081D6o
					; .text:0040826Eo
a_		db '.',0                ; DATA XREF: .text:0040835Bo
		align 10h
a____Gnupg22__0	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_4083C2+A0o
; char aHome[]
aHome		db 'HOME',0             ; DATA XREF: sub_4083C2:loc_4084E3o
; char aX02x[]
aX02x		db 'x%02x',0            ; DATA XREF: sub_408977+164o
					; .text:00408EDBo
word_411002	dw 0			; DATA XREF: .text:004097BBo
					; .text:004097FAo
aFatalTooManyAr	db 0Ah			; DATA XREF: .text:00409844o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: .text:0040986Fo
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_4083C2+90o
		align 4
asc_411054	db '-',0                ; DATA XREF: sub_4098D9+55o
					; sub_409B38:loc_409B49o
aSocket		db 'socket://',0        ; DATA XREF: sub_4098D9+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_4098D9+FDo
; char aA[]
aA		db 'a',0                ; DATA XREF: sub_4098D9+131o
					; sub_4098D9:loc_409A49o
		align 10h
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_4098D9+1B1o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_4098D9+1E9o
		align 10h
; char a____Gnupg22__1[]
a____Gnupg22__1	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_409CFA+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_409CFA+37o
		align 10h
; char a04d02d02d02d_0[]
a04d02d02d02d_0	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_409CFA+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_409CFA+16Bo
; char aU_0[]
aU_0		db '[%u]',0             ; DATA XREF: sub_409CFA+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_409CFA+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_409CFA+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_409CFA+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_409CFA:loc_409F8Co
		align 4
off_411184	dd offset loc_409FAB	; DATA XREF: sub_409CFA+20Eo
		dd offset loc_409FAB	; jump table for switch	statement
		dd offset loc_409FAB
		dd offset loc_409FAB
		dd offset loc_409FAB
		dd offset loc_409F11
		dd offset loc_409F3A
		dd offset loc_409F63
dword_4111A4	dd 207325h		; DATA XREF: .text:0040A205o
a02x_1		db '%02X',0             ; DATA XREF: .text:0040A22Ao
a02x_2		db ' %02X',0            ; DATA XREF: .text:0040A24Do
asc_4111B3	db 0Ah,0		; DATA XREF: .text:0040A272o
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_40A280+1Bo
		align 4
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_40A2B4+D9o
					; .text:loc_40A588o ...
aUtf8		db 'utf-8',0            ; DATA XREF: sub_40A2B4+22o
					; .text:0040A5C2o ...
		align 4
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_40A2B4+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_40A2B4+B1o
aCpU		db 'CP%u',0             ; DATA XREF: .text:loc_40A3DEo
aCp936		db 'CP936',0            ; DATA XREF: .text:0040A401o
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: .text:0040A4EFo
a88591		db '8859-1',0           ; DATA XREF: .text:0040A52Co
a646		db '646',0              ; DATA XREF: .text:0040A543o
aAscii		db 'ASCII',0            ; DATA XREF: .text:0040A55Ao
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: .text:0040A571o
aUtf8_0		db 'utf8',0             ; DATA XREF: .text:loc_40A5ABo
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_40A6C9+1EEo
					; sub_40A915+730o
; char aX02x_0[]
aX02x_0		db '\x%02x',0           ; DATA XREF: sub_40A915+7Co
					; sub_40A915+3AFo ...
; char aX02x_1[]
aX02x_1		db 'x%02x',0            ; DATA XREF: sub_40A915+1DCo
		align 4
a____Gnupg22__2	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_40A915+6BEo
		align 4
off_4113CC	dd offset loc_40AAC8	; DATA XREF: sub_40A915+12Ar
		dd offset loc_40AADE	; jump table for switch	statement
		dd offset loc_40AADE
		dd offset loc_40AADE
		dd offset loc_40AADE
		dd offset loc_40AADE
		dd offset loc_40AADE
		dd offset loc_40AADE
		dd offset loc_40AAB2
		dd offset loc_40AADE
		dd offset loc_40AA48
		dd offset loc_40AA9C
		dd offset loc_40AA82
		dd offset loc_40AA65
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_40A915+6AEo
		align 4
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: sub_40B170+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_40B170:loc_40B1C3o
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_40B170:loc_40B22Eo
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_40B170:loc_40B238o
aAm_et		db 'am_ET',0            ; DATA XREF: sub_40B170:loc_40B242o
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_40B170:loc_40B265o
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_40B170:loc_40B26Fo
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_40B170:loc_40B279o
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_40B170:loc_40B283o
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_40B170:loc_40B28Do
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_40B170:loc_40B297o
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_40B170:loc_40B2A1o
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_40B170:loc_40B2ABo
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_40B170:loc_40B2B5o
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_40B170:loc_40B2BFo
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_40B170:loc_40B2C9o
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_40B170:loc_40B2D3o
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_40B170:loc_40B2DDo
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_40B170:loc_40B2E7o
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_40B170:loc_40B2F1o
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_40B170:loc_40B2FBo
aAr		db 'ar',0               ; DATA XREF: sub_40B170:loc_40B305o
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_40B170:loc_40B30Fo
aAs_in		db 'as_IN',0            ; DATA XREF: sub_40B170:loc_40B319o
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_40B170:loc_40B332o
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_40B170:loc_40B33Co
aAz		db 'az',0               ; DATA XREF: sub_40B170:loc_40B346o
aEu		db 'eu',0               ; DATA XREF: sub_40B170:loc_40B350o
aBe_by		db 'be_BY',0            ; DATA XREF: sub_40B170:loc_40B35Ao
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_40B170:loc_40B373o
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_40B170:loc_40B37Do
aBn		db 'bn',0               ; DATA XREF: sub_40B170:loc_40B387o
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_40B170:loc_40B391o
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_40B170:loc_40B39Bo
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_40B170:loc_40B3A5o
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_40B170:loc_40B3AFo
aChr_us		db 'chr_US',0           ; DATA XREF: sub_40B170:loc_40B3B9o
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_40B170:loc_40B3D8o
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_40B170:loc_40B3E2o
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_40B170:loc_40B3ECo
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_40B170:loc_40B3F6o
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_40B170:loc_40B400o
aZh		db 'zh',0               ; DATA XREF: sub_40B170:loc_40B40Ao
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_40B170+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_40B170:loc_40B430o
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_40B170:loc_40B43Ao
aHr		db 'hr',0               ; DATA XREF: sub_40B170:loc_40B444o
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_40B170:loc_40B44Eo
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_40B170:loc_40B458o
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_40B170:loc_40B462o
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_40B170:loc_40B47Bo
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_40B170:loc_40B485o
aNl		db 'nl',0               ; DATA XREF: sub_40B170:loc_40B48Fo
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_40B170:loc_40B499o
aEn_us		db 'en_US',0            ; DATA XREF: sub_40B170:loc_40B4BCo
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_40B170:loc_40B4C6o
aEn_au		db 'en_AU',0            ; DATA XREF: sub_40B170:loc_40B4D0o
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_40B170:loc_40B4DAo
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_40B170:loc_40B4E4o
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_40B170:loc_40B4EEo
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_40B170:loc_40B4F8o
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_40B170:loc_40B502o
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_40B170:loc_40B50Co
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_40B170:loc_40B516o
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_40B170:loc_40B520o
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_40B170:loc_40B52Ao
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_40B170:loc_40B534o
aEn_id		db 'en_ID',0            ; DATA XREF: sub_40B170:loc_40B53Eo
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_40B170:loc_40B548o
aEn_in		db 'en_IN',0            ; DATA XREF: sub_40B170:loc_40B552o
aEn_my		db 'en_MY',0            ; DATA XREF: sub_40B170:loc_40B55Co
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_40B170:loc_40B566o
aEn		db 'en',0               ; DATA XREF: sub_40B170:loc_40B570o
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_40B170:loc_40B57Ao
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_40B170:loc_40B584o
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_40B170:loc_40B58Eo
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_40B170:loc_40B598o
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_40B170:loc_40B5BBo
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_40B170:loc_40B5C5o
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_40B170:loc_40B5CFo
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_40B170:loc_40B5D9o
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_40B170:loc_40B5E3o
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_40B170:loc_40B5EDo
aFr		db 'fr',0               ; DATA XREF: sub_40B170:loc_40B5F7o
					; sub_40B170:loc_40B651o
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_40B170:loc_40B601o
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_40B170:loc_40B60Bo
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_40B170:loc_40B615o
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_40B170:loc_40B61Fo
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_40B170:loc_40B629o
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_40B170:loc_40B633o
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_40B170:loc_40B63Do
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_40B170:loc_40B647o
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_40B170:loc_40B65Bo
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_40B170:loc_40B665o
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_40B170:loc_40B67Eo
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_40B170:loc_40B688o
aC		db 'C',0                ; DATA XREF: sub_40B170:loc_40B692o
					; sub_40B170:loc_40BCB0o
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_40B170:loc_40B69Co
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_40B170:loc_40B6A6o
aDe_de		db 'de_DE',0            ; DATA XREF: sub_40B170:loc_40B6C5o
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_40B170:loc_40B6CFo
aDe_at		db 'de_AT',0            ; DATA XREF: sub_40B170:loc_40B6D9o
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_40B170:loc_40B6E3o
aDe_li		db 'de_LI',0            ; DATA XREF: sub_40B170:loc_40B6EDo
aDe		db 'de',0               ; DATA XREF: sub_40B170:loc_40B6F7o
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_40B170:loc_40B701o
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_40B170:loc_40B70Bo
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_40B170:loc_40B715o
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_40B170:loc_40B71Fo
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_40B170:loc_40B729o
aHe_il		db 'he_IL',0            ; DATA XREF: sub_40B170:loc_40B733o
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_40B170:loc_40B73Do
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_40B170:loc_40B747o
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_40B170:loc_40B751o
aIs_is		db 'is_IS',0            ; DATA XREF: sub_40B170:loc_40B75Bo
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_40B170:loc_40B765o
aId_id		db 'id_ID',0            ; DATA XREF: sub_40B170:loc_40B76Fo
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_40B170:loc_40B779o
aIt_it		db 'it_IT',0            ; DATA XREF: sub_40B170:loc_40B792o
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_40B170:loc_40B79Co
aIt		db 'it',0               ; DATA XREF: sub_40B170:loc_40B7A6o
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_40B170:loc_40B7B0o
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_40B170:loc_40B7BAo
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_40B170:loc_40B7C4o
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_40B170:loc_40B7DDo
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_40B170:loc_40B7E7o
aKs		db 'ks',0               ; DATA XREF: sub_40B170:loc_40B7F1o
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_40B170:loc_40B7FBo
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_40B170:loc_40B805o
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_40B170:loc_40B80Fo
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_40B170:loc_40B819o
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_40B170:loc_40B823o
aLa_va		db 'la_VA',0            ; DATA XREF: sub_40B170:loc_40B82Do
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_40B170:loc_40B837o
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_40B170:loc_40B841o
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_40B170:loc_40B84Bo
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_40B170:loc_40B864o
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_40B170:loc_40B86Eo
aMs		db 'ms',0               ; DATA XREF: sub_40B170:loc_40B878o
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_40B170:loc_40B882o
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_40B170:loc_40B88Co
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_40B170:loc_40B896o
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_40B170:loc_40B8A0o
aMn		db 'mn',0               ; DATA XREF: sub_40B170:loc_40B8AAo
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_40B170:loc_40B8C3o
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_40B170:loc_40B8CDo
aNe		db 'ne',0               ; DATA XREF: sub_40B170:loc_40B8D7o
aNo_no		db 'no_NO',0            ; DATA XREF: sub_40B170:loc_40B8F0o
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_40B170:loc_40B8FAo
aNo_2		db 'no',0               ; DATA XREF: sub_40B170:loc_40B904o
aOr_in		db 'or_IN',0            ; DATA XREF: sub_40B170:loc_40B90Eo
aOm_et		db 'om_ET',0            ; DATA XREF: sub_40B170:loc_40B918o
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_40B170:loc_40B922o
aPs		db 'ps',0               ; DATA XREF: sub_40B170:loc_40B92Co
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_40B170:loc_40B936o
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_40B170+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_40B170:loc_40B957o
aPt		db 'pt',0               ; DATA XREF: sub_40B170:loc_40B961o
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_40B170+803o
aPa		db 'pa',0               ; DATA XREF: sub_40B170:loc_40B97Do
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_40B170:loc_40B987o
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_40B170+829o
aRo		db 'ro',0               ; DATA XREF: sub_40B170:loc_40B9A3o
aRu		db 'ru',0               ; DATA XREF: sub_40B170:loc_40B9ADo
aSe_no		db 'se_NO',0            ; DATA XREF: sub_40B170:loc_40B9B7o
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_40B170:loc_40B9C1o
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_40B170:loc_40B9D9o
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_40B170:loc_40B9E3o
aSd		db 'sd',0               ; DATA XREF: sub_40B170:loc_40B9EDo
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_40B170:loc_40B9F7o
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_40B170:loc_40BA01o
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_40B170:loc_40BA0Bo
aSo_so		db 'so_SO',0            ; DATA XREF: sub_40B170:loc_40BA15o
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_40B170:loc_40BA1Fo
aEs_es		db 'es_ES',0            ; DATA XREF: sub_40B170:loc_40BA42o
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_40B170:loc_40BA4Co
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_40B170:loc_40BA56o
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_40B170:loc_40BA60o
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_40B170:loc_40BA6Ao
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_40B170:loc_40BA74o
aEs_do		db 'es_DO',0            ; DATA XREF: sub_40B170:loc_40BA7Eo
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_40B170:loc_40BA88o
aEs_co		db 'es_CO',0            ; DATA XREF: sub_40B170:loc_40BA92o
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_40B170:loc_40BA9Co
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_40B170:loc_40BAA6o
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_40B170:loc_40BAB0o
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_40B170:loc_40BABAo
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_40B170:loc_40BAC4o
aEs_py		db 'es_PY',0            ; DATA XREF: sub_40B170:loc_40BACEo
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_40B170:loc_40BAD8o
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_40B170:loc_40BAE2o
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_40B170:loc_40BAECo
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_40B170:loc_40BAF6o
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_40B170:loc_40BB00o
aEs		db 'es',0               ; DATA XREF: sub_40B170:loc_40BB0Ao
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_40B170:loc_40BB14o
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_40B170:loc_40BB1Eo
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_40B170:loc_40BB37o
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_40B170:loc_40BB41o
aSv		db 'sv',0               ; DATA XREF: sub_40B170:loc_40BB4Bo
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_40B170:loc_40BB55o
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_40B170:loc_40BB5Fo
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_40B170:loc_40BB69o
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_40B170:loc_40BB82o
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_40B170:loc_40BB8Co
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_40B170:loc_40BB96o
aTa		db 'ta',0               ; DATA XREF: sub_40B170:loc_40BBA0o
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_40B170:loc_40BBAAo
aTe_in		db 'te_IN',0            ; DATA XREF: sub_40B170:loc_40BBB4o
aTh_th		db 'th_TH',0            ; DATA XREF: sub_40B170:loc_40BBBEo
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_40B170:loc_40BBC8o
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_40B170:loc_40BBE0o
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_40B170:loc_40BBEAo
aTi		db 'ti',0               ; DATA XREF: sub_40B170:loc_40BBF4o
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_40B170:loc_40BBFEo
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_40B170:loc_40BC08o
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_40B170:loc_40BC12o
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_40B170:loc_40BC1Co
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_40B170:loc_40BC26o
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_40B170:loc_40BC3Fo
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_40B170:loc_40BC46o
aUr		db 'ur',0               ; DATA XREF: sub_40B170:loc_40BC4Do
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_40B170:loc_40BC63o
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_40B170:loc_40BC6Ao
aUz		db 'uz',0               ; DATA XREF: sub_40B170:loc_40BC71o
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_40B170:loc_40BC78o
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_40B170:loc_40BC7Fo
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_40B170:loc_40BC86o
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_40B170:loc_40BC8Do
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_40B170:loc_40BC94o
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_40B170:loc_40BC9Bo
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_40B170:loc_40BCA2o
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_40B170:loc_40BCA9o
		align 10h
off_411980	dd offset loc_40BCB0, offset loc_40B24C, offset	loc_40B391
					; DATA XREF: sub_40B170+B5o
		dd offset loc_40B3AF, offset loc_40B3C3, offset	loc_40B44E ; jump table	for switch statement
		dd offset loc_40B458, offset loc_40B6B0, offset	loc_40B701
		dd offset loc_40B4A3, offset loc_40BA29, offset	loc_40B598
		dd offset loc_40B5A2, offset loc_40B733, offset	loc_40B747
		dd offset loc_40B75B, offset loc_40B783, offset	loc_40B7B0
		dd offset loc_40B80F, offset loc_40B46C, offset	loc_40B8E1
		dd offset loc_40B936, offset loc_40B940, offset	loc_40B987
		dd offset loc_40B991, offset loc_40B9AD, offset	loc_40B414
		dd offset loc_40BA01, offset loc_40B238, offset	loc_40BB28
		dd offset loc_40BBBE, offset loc_40BC12, offset	loc_40BC30
		dd offset loc_40B76F, offset loc_40BC26, offset	loc_40B35A
		dd offset loc_40BA0B, offset loc_40B57A, offset	loc_40B837
		dd offset loc_40B841, offset loc_40BB69, offset	loc_40B58E
		dd offset loc_40BC7F, offset loc_40B30F, offset	loc_40B323
		dd offset loc_40B350, offset loc_40BA1F, offset	loc_40B84B
		dd offset loc_40BB14, offset loc_40BBFE, offset	loc_40BC08
		dd offset loc_40BC78, offset loc_40BC8D, offset	loc_40BCA9
		dd offset loc_40B22E, offset loc_40B6A6, offset	loc_40B584
		dd offset loc_40B73D, offset loc_40B88C, offset	loc_40B9B7
		dd offset loc_40B66F, offset loc_40BC9B, offset	loc_40B855
		dd offset loc_40B7FB, offset loc_40B819, offset	loc_40BB1E
		dd offset loc_40BC1C, offset loc_40BC54, offset	loc_40BBAA
		dd offset loc_40B364, offset loc_40B96B, offset	loc_40B715
		dd offset loc_40B90E, offset loc_40BBA0, offset	loc_40BBB4
		dd offset loc_40B7BA, offset loc_40B882, offset	loc_40B319
		dd offset loc_40B8A0, offset loc_40B9C1, offset	loc_40B8AA
		dd offset loc_40BBC8, offset loc_40BC86, offset	loc_40B3A5
		dd offset loc_40B823, offset loc_40B39B, offset	loc_40B69C
		dd offset loc_40B805, offset loc_40B896, offset	loc_40B9CB
		dd offset loc_40BB55, offset loc_40B9F7, offset	loc_40B3B9
		dd offset loc_40B779, offset loc_40B242, offset	loc_40BB73
		dd offset loc_40B7CE, offset loc_40B8B4, offset	loc_40B65B
		dd offset loc_40B92C, offset loc_40BB5F, offset	loc_40B462
		dd offset loc_40B499, offset loc_40B665, offset	loc_40B71F
		dd offset loc_40B751, offset loc_40BCA2, offset	loc_40BCB0
		dd offset loc_40BCB0, offset loc_40BCB0, offset	loc_40BCB0
		dd offset loc_40BCB0, offset loc_40B765, offset	loc_40B7C4
		dd offset loc_40B918, offset loc_40BBD2, offset	loc_40B70B
		dd offset loc_40B729, offset loc_40B82D, offset	loc_40BA15
		dd offset loc_40BC94, offset loc_40B922
off_411B68	dd offset loc_40B305	; DATA XREF: sub_40B170+ECo
		dd offset loc_40B265	; jump table for switch	statement
		dd offset loc_40B26F
		dd offset loc_40B279
		dd offset loc_40B283
		dd offset loc_40B28D
		dd offset loc_40B297
		dd offset loc_40B2A1
		dd offset loc_40B2AB
		dd offset loc_40B2B5
		dd offset loc_40B2BF
		dd offset loc_40B2C9
		dd offset loc_40B2D3
		dd offset loc_40B2DD
		dd offset loc_40B2E7
		dd offset loc_40B2F1
		dd offset loc_40B2FB
off_411BAC	dd offset loc_40B40A	; DATA XREF: sub_40B170+25Fo
		dd offset loc_40B3D8	; jump table for switch	statement
		dd offset loc_40B3E2
		dd offset loc_40B3EC
		dd offset loc_40B3F6
		dd offset loc_40B400
off_411BC4	dd offset loc_40B570	; DATA XREF: sub_40B170+343o
		dd offset loc_40B4BC	; jump table for switch	statement
		dd offset loc_40B4C6
		dd offset loc_40B4D0
		dd offset loc_40B4DA
		dd offset loc_40B4E4
		dd offset loc_40B4EE
		dd offset loc_40B4F8
		dd offset loc_40B502
		dd offset loc_40B50C
		dd offset loc_40B516
		dd offset loc_40B520
		dd offset loc_40B52A
		dd offset loc_40B534
		dd offset loc_40B53E
		dd offset loc_40B548
		dd offset loc_40B552
		dd offset loc_40B55C
		dd offset loc_40B566
off_411C10	dd offset loc_40B651	; DATA XREF: sub_40B170+442o
		dd offset loc_40B5BB	; jump table for switch	statement
		dd offset loc_40B5C5
		dd offset loc_40B5CF
		dd offset loc_40B5D9
		dd offset loc_40B5E3
		dd offset loc_40B5ED
		dd offset loc_40B5F7
		dd offset loc_40B601
		dd offset loc_40B60B
		dd offset loc_40B615
		dd offset loc_40B61F
		dd offset loc_40B629
		dd offset loc_40B633
		dd offset loc_40B63D
		dd offset loc_40B647
off_411C50	dd offset loc_40B6F7	; DATA XREF: sub_40B170+54Co
		dd offset loc_40B6C5	; jump table for switch	statement
		dd offset loc_40B6CF
		dd offset loc_40B6D9
		dd offset loc_40B6E3
		dd offset loc_40B6ED
off_411C68	dd offset loc_40BB0A	; DATA XREF: sub_40B170+8C9o
		dd offset loc_40BA42	; jump table for switch	statement
		dd offset loc_40BA4C
		dd offset loc_40BA56
		dd offset loc_40BA60
		dd offset loc_40BA6A
		dd offset loc_40BA74
		dd offset loc_40BA7E
		dd offset loc_40BA88
		dd offset loc_40BA92
		dd offset loc_40BA9C
		dd offset loc_40BAA6
		dd offset loc_40BAB0
		dd offset loc_40BABA
		dd offset loc_40BAC4
		dd offset loc_40BACE
		dd offset loc_40BAD8
		dd offset loc_40BAE2
		dd offset loc_40BAEC
		dd offset loc_40BAF6
		dd offset loc_40BB00
; char aRb[3]
aRb		db 'rb',0               ; DATA XREF: sub_40BD96+16o
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: .text:0040C350o
					; .text:0040CC8Do
aLc_messages_0	db '\LC_MESSAGES\',0    ; DATA XREF: .text:0040C4E4o
a_mo		db '.mo',0              ; DATA XREF: .text:0040C53Co
		align 10h
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_40C594+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_40C5FA+13Do
					; sub_40C5FA:loc_40C85Do
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_40C5FA:loc_40C8D1o
byte_411D3F	db 0			; DATA XREF: .text:loc_40CCA7o
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_411D7C	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_40D1C0+3o
		align 10h
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_40D1C0+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_411E9Co
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:00411EA0o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:00411EA4o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:00411EA8o
		align 10h
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:00411EACo
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:00411EB0o
		align 4
off_411E9C	dd offset aArgumentDomain ; DATA XREF: sub_40D1C0+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_40D230+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_40D290+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_40D290+1F9o
					; sub_40D290+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_40D290+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_40D4D0+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_40D4D0+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_40DA80:loc_40DB20o
		unicode	0, <msvcrt.dll>,0
		align 4
off_411FC4	dd offset dword_413740	; DATA XREF: .text:0040DD18o
		dd offset dword_413460
		align 20h
; char aS_0[]
aS_0		db '%s: ',0             ; DATA XREF: sub_40E0F0+11o
; char aPosixly_correc[]
aPosixly_correc	db 'POSIXLY_CORRECT',0  ; DATA XREF: sub_40E4B0:loc_40E6F0o
byte_411FF5	db 0			; DATA XREF: sub_40E4B0+A6o
					; sub_40E4B0:loc_40E6E0o ...
; char aUnknownOptionC[]
aUnknownOptionC	db 'unknown option -- %c',0 ; DATA XREF: sub_40E4B0+488o
		align 20h
; char aOptionRequir_0[]
aOptionRequir_0	db 'option requires an argument -- %c',0 ; DATA XREF: sub_40E4B0+42Ao
					; sub_40E4B0+57Do
; char aAmbiguousOptio[]
aAmbiguousOptio	db 'ambiguous option -- %.*s',0 ; DATA XREF: sub_40E160+147o
		align 10h
; char aOptionDoesnTTa[]
aOptionDoesnTTa	db 'option doesn',27h,'t take an argument -- %.*s',0
					; DATA XREF: sub_40E160+1DDo
		align 20h
; char aOptionRequires[]
aOptionRequires	db 'option requires an argument -- %s',0 ; DATA XREF: sub_40E160+2BAo
; char aUnknownOptionS[]
aUnknownOptionS	db 'unknown option -- %s',0 ; DATA XREF: sub_40E160+269o
		align 10h
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_40EB30+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_1[]
aS_1		db '%s',0Ah,0           ; DATA XREF: sub_40EB30+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_40EB30+10Fo
		align 10h
dword_412140	dd 0			; DATA XREF: sub_40D4D0+59o
					; sub_40D4D0+5Eo ...
dword_412144	dd 0			; DATA XREF: sub_40D4D0+7Fr
dword_412148	dd 0			; DATA XREF: sub_40D4D0:loc_40D61Cr
dword_41214C	dd 2Dh dup(0)		; DATA XREF: sub_40D4D0+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00013000)
; Virtual size			: 00000804 (   2052.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 413000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_413000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_413004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_413008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_41300C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_413010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_413014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_413018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_41301C	dd ?			; DATA XREF: sub_401010+3Aw
dword_413020	dd ?			; DATA XREF: sub_404EB8+ADw
					; sub_4053E3:loc_4059B3w ...
; PCHAR	Source
Source		dd ?			; DATA XREF: sub_40230E:loc_402617r
					; sub_40230E:loc_402685r ...
; FILE *dword_413028
dword_413028	dd ?			; DATA XREF: sub_40230E:loc_402597r
					; sub_40230E:loc_402768r ...
; FILE *dword_41302C
dword_41302C	dd ?			; DATA XREF: sub_40230E+858r
					; sub_402B94+424r ...
; FILE *File
File		dd ?			; DATA XREF: sub_40167C+1Br
					; sub_40230E+50r ...
; PLDAP	ld
ld		dd ?			; DATA XREF: sub_40230E+744r
					; sub_40230E+76Dr ...
; void *dword_413038
dword_413038	dd ?			; DATA XREF: sub_4033A7+1B1r
					; sub_4033A7+232r ...
		align 10h
dword_413040	dd ?			; DATA XREF: .text:004068BAr
					; .text:004068DCw
		align 20h
dword_413060	dd 68h dup(?)		; DATA XREF: .text:004068C3o
; char *Dest
Dest		dd ?			; DATA XREF: sub_407D16+3Br
					; sub_407D16+6Ew ...
		align 20h
dword_413220	dd 40h dup(?)		; DATA XREF: .text:00408F8Bo
					; .text:00408FB8o
; FILE *dword_413320
dword_413320	dd ?			; DATA XREF: sub_4098D9+8r
					; sub_4098D9+19r ...
		align 20h
; char byte_413340[79]
byte_413340	db 4Fh dup(?)		; DATA XREF: .text:00409BA3o
					; .text:loc_409C58o ...
byte_41338F	db ?			; DATA XREF: .text:00409BAFw
dword_413390	dd ?			; DATA XREF: .text:00409BC7w
					; .text:loc_409C10r ...
dword_413394	dd ?			; DATA XREF: .text:00409BBCw
					; .text:00409BF8r ...
dword_413398	dd ?			; DATA XREF: .text:00409BD2w
					; .text:loc_409C28r ...
dword_41339C	dd ?			; DATA XREF: .text:00409B81w
					; sub_409CFA:loc_409E4Cr ...
dword_4133A0	dd ?			; DATA XREF: .text:00409BDFw
					; .text:loc_409C40r
dword_4133A4	dd ?			; DATA XREF: sub_4098D9+249w
					; sub_409CFA+88r ...
dword_4133A8	dd ?			; DATA XREF: sub_4098D9+24Ew
					; sub_409CFA:loc_409D3Dr ...
dword_4133AC	dd ?			; DATA XREF: .text:004098AAr
					; .text:004098B8w ...
		align 20h
dword_4133C0	dd ?			; DATA XREF: sub_40A2B4+E3w
					; .text:0040A592w ...
dword_4133C4	dd ?			; DATA XREF: sub_40A2B4+EDw
					; .text:0040A59Cw ...
dword_4133C8	dd ?			; DATA XREF: sub_40A915+70Er
					; sub_40A915:loc_40B069w
dword_4133CC	dd ?			; DATA XREF: sub_40A6C9+1CCr
					; sub_40A6C9:loc_40A8DBw
dword_4133D0	dd 8 dup(?)		; DATA XREF: .text:0040A3EEo
					; .text:0040A3FAo ...
dword_4133F0	dd ?			; DATA XREF: sub_40A2B4+45r
					; sub_40A2B4+4Dw
dword_4133F4	dd ?			; DATA XREF: sub_40A2B4:loc_40A30Dr
					; sub_40A2B4+61w
dword_4133F8	dd ?			; DATA XREF: sub_40A2B4:loc_40A349r
					; sub_40A2B4:loc_40A37Dw
dword_4133FC	dd ?			; DATA XREF: .text:0040C56Cr
					; .text:0040C575r ...
dword_413400	dd ?			; DATA XREF: sub_40C5FA+7r
					; .text:0040CCB4w
dword_413404	dd ?			; DATA XREF: sub_401010+3r
dword_413408	dd ?			; DATA XREF: sub_401010+25r
dword_41340C	dd ?			; DATA XREF: sub_401060+22w
dword_413410	dd ?			; DATA XREF: sub_401060+18w
dword_413414	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_413420	dd ?			; DATA XREF: sub_401060+2Cw
dword_413424	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_413428	dd ?			; DATA XREF: sub_401060+5Er
dword_41342C	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_40D03Cr
dword_413430	dd ?			; DATA XREF: .text:0040D163r
					; sub_40D1B0+4w
dword_413434	dd ?			; DATA XREF: sub_40D4D0+9r
					; sub_40D4D0:loc_40D4F0w
dword_413438	dd ?			; DATA XREF: sub_40D290+1Dr
					; sub_40D290+58r ...
dword_41343C	dd ?			; DATA XREF: sub_40D290+Br
					; sub_40D290:loc_40D34Fw ...
dword_413440	dd ?			; DATA XREF: sub_40DA80+4r
					; sub_40DA80+92w ...
dword_413444	dd ?			; DATA XREF: sub_40DBD0r
					; sub_40DBD0:loc_40DBE0w
		align 20h
dword_413460	dd 2Bh dup(?)		; DATA XREF: .rdata:00411FC8o
dword_41350C	dd ?			; DATA XREF: .text:0040DCFAw
		dd 2 dup(?)
dword_413518	dd ?			; DATA XREF: .text:0040DCE6w
		dd 2 dup(?)
dword_413524	dd ?			; DATA XREF: .text:0040DCCCw
		dd 86h dup(?)
dword_413740	dd ?			; DATA XREF: .text:0040DCD2w
					; .rdata:off_411FC4o
dword_413744	dd ?			; DATA XREF: .text:0040DCDCw
		dd ?
dword_41374C	dd ?			; DATA XREF: .text:0040DCEBw
		dd 14h dup(?)
dword_4137A0	dd ?			; DATA XREF: .text:0040DDC3r
					; .text:0040DE54r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_40DD50+7o
					; sub_40DD50:loc_40DDA5o ...
dword_4137BC	dd ?			; DATA XREF: sub_40DD50+14r
					; .text:0040DE18r ...
		dd ?
dword_4137C4	dd ?			; DATA XREF: sub_401180+1A8w
dword_4137C8	dd ?			; DATA XREF: sub_401180+1BFw
dword_4137CC	dd ?			; DATA XREF: sub_401180+1B2w
dword_4137D0	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_40CE23w ...
dword_4137D4	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_4137D8	dd ?			; DATA XREF: TlsCallback_0:loc_40CD74w
dword_4137DC	dd ?			; DATA XREF: sub_401060+64w
					; sub_40CEF0+3Fr ...
dword_4137E0	dd ?			; DATA XREF: sub_401060+69w
					; sub_40CEF0+4r ...
dword_4137E4	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_4137E8	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		dd 4 dup(?)
dword_4137FC	dd ?			; DATA XREF: sub_40E4B0+3Ar
					; sub_40E4B0+F8r ...
; char *Filename
Filename	dd ?			; DATA XREF: sub_4053E3+188r
					; sub_4053E3+1B8r ...
		align 800h
_bss		ends

;
; Imports from libiconv-2.dll
;
; Section 5. (virtual address 00014000)
; Virtual size			: 00000DF0 (   3568.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 00010800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: .text:00407CFCp
					; .text:00407D0Cp
					; DATA XREF: ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: .text:00407C22p
					; .text:00407C77p
					; DATA XREF: ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_40DEF0+44p
					; DATA XREF: sub_40DEF0+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_40DD50+Ep
					; .text:0040DE12p ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	.text:00408FB3p
					; DATA XREF: .text:00408FAEr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: .text:0040A3D9p
					; DATA XREF: .text:0040A3D4r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: .text:0040A3C9p
					; DATA XREF: .text:0040A3C4r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:0040DD28p
					; DATA XREF: .text:0040DD28r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_40DBF0+6Cp
					; DATA XREF: sub_40DBF0+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_40DBF0+74p
					; DATA XREF: sub_40DBF0+74r
; BOOL __stdcall GetFileInformationByHandle(HANDLE hFile, LPBY_HANDLE_FILE_INFORMATION lpFileInformation)
		extrn GetFileInformationByHandle:dword ; CODE XREF: .text:00407CA0p
					; .text:00407CBBp
					; DATA XREF: ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: .text:00408F73p
					; sub_40D290+1CCp ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_40EB30+C2p
					; DATA XREF: sub_40EB30+C2r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_40DA80+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_40DBF0+57p
					; DATA XREF: sub_40DBF0+57r
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_40B170+7Fp
					; DATA XREF: sub_40B170:loc_40B1EAr
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_40DBF0+7Cp
					; DATA XREF: sub_40DBF0+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_40DEF0+87p
					; DATA XREF: sub_40DEF0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_40DD50+5Cp
					; .text:0040DE30p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: TlsCallback_0+55p
					; DATA XREF: TlsCallback_0+55r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_40DA80+A7p
					; DATA XREF: sub_40DA80+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_40C0D1+38p
					; sub_40C0D1+D5p
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_40DBF0+8Bp
					; DATA XREF: sub_40DBF0+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0040DD0Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:0040DD39p
					; DATA XREF: .text:0040DD39r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_40DD50+35p
					; DATA XREF: sub_40DD50+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0040DD1Fp
					; DATA XREF: .text:0040DD1Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_40D290+142p
					; sub_40D290+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_40D290+A1p
					; sub_40D290+D9p ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_40C1D3+48p
					; sub_40C1D3+C8p
					; DATA XREF: ...

;
; Imports from msvcrt.dll
;
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
; int __cdecl _putenv(const char *EnvString)
		extrn __imp__putenv:dword ; DATA XREF: _putenvr
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr
; void __cdecl _tzset()
		extrn __imp__tzset:dword ; DATA	XREF: _tzsetr

;
; Imports from msvcrt.dll
;
; char **_argv
		extrn __argv:dword	; DATA XREF: sub_40E0F0+4r
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_40CEC0r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_4053E3+1ACp
					; sub_4053E3+252p ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: sub_40BD96+57p
					; DATA XREF: sub_40BD96+52r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_4053E3+81r
					; sub_4053E3+B0r ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_40CEF0+A3p
					; DATA XREF: sub_40CEF0+A3r
; int __cdecl stricmp(const char *Str1,	const char *Str2)
		extrn _stricmp:dword	; CODE XREF: sub_401636+20p
					; sub_401941+32p ...
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: sub_4053E3+39Cp
					; sub_4053E3+3DAp ...
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; char *__cdecl	fgets(char *Buf, int MaxCount, FILE *File)
		extrn __imp_fgets:dword	; DATA XREF: fgetsr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputc(int	Ch, FILE *File)
		extrn __imp_fputc:dword	; DATA XREF: fputcr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; struct tm *__cdecl static gmtime(const time_t	*Time)
		extrn gmtime:dword	; DATA XREF: sub_40EE10r
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: .text:0040808Bp
					; .text:004080ABp ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_40EE40r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; time_t __cdecl static	mktime(struct tm *Tm)
		extrn mktime:dword	; DATA XREF: sub_40EE20r
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; int sscanf(const char	*Src, const char *Format, ...)
		extrn __imp_sscanf:dword ; DATA	XREF: sscanfr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; size_t __cdecl strspn(const char *Str, const char *Control)
		extrn __imp_strspn:dword ; DATA	XREF: strspnr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_40EE30r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:00407E65p
					; .text:00407E7Ap ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_40EB30+122p
					; DATA XREF: sub_40EB30+122r

;
; Imports from wldap32.dll
;
; ULONG	__cdecl	ldap_add_s(LDAP	*ld, PCHAR dn, LDAPModA	*attrs[])
		extrn ldap_add_s:dword	; CODE XREF: sub_40230E+785p
					; sub_402B94+3A6p
					; DATA XREF: ...
; ULONG	__cdecl	ldap_count_entries(LDAP	*ld, LDAPMessage *res)
		extrn ldap_count_entries:dword ; CODE XREF: sub_4033A7+3BBp
					; sub_403A3F+3D4p
					; DATA XREF: ...
; PCHAR	__cdecl	ldap_err2string(ULONG err)
		extrn ldap_err2string:dword ; CODE XREF: sub_40230E+79Bp
					; sub_402B94+3BCp ...
; LDAPMessage *__cdecl ldap_first_entry(LDAP *ld, LDAPMessage *res)
		extrn ldap_first_entry:dword ; CODE XREF: sub_4033A7+43Ep
					; sub_403A3F+457p ...
; ULONG	__cdecl	ldap_get_option(LDAP *ld, int option, void *outvalue)
		extrn ldap_get_option:dword ; CODE XREF: sub_4015FC+20p
					; DATA XREF: sub_4015FC+1Br
; PCHAR	*__cdecl ldap_get_values(LDAP *ld, LDAPMessage *entry, const PCHAR attr)
		extrn ldap_get_values:dword ; CODE XREF: sub_402FF3+5Dp
					; sub_402FF3+116p ...
; LDAP *__cdecl	ldap_init(PCHAR	HostName, ULONG	PortNumber)
		extrn ldap_init:dword	; CODE XREF: sub_4053E3+BEDp
					; DATA XREF: sub_4053E3+BE8r
; ULONG	__cdecl	ldap_modify_s(LDAP *ld,	PCHAR dn, LDAPModA *mods[])
		extrn ldap_modify_s:dword ; CODE XREF: sub_40230E+75Cp
					; DATA XREF: sub_40230E+757r
; ULONG	__cdecl	ldap_msgfree(LDAPMessage *res)
		extrn ldap_msgfree:dword ; CODE	XREF: sub_4033A7+5E6p
					; sub_403A3F+5BBp ...
; LDAPMessage *__cdecl ldap_next_entry(LDAP *ld, LDAPMessage *entry)
		extrn ldap_next_entry:dword ; CODE XREF: sub_4033A7+5C5p
					; sub_403A3F+59Ap ...
; ULONG	__cdecl	ldap_search_s(LDAP *ld,	PCHAR base, ULONG scope, PCHAR filter, PCHAR attrs[], ULONG attrsonly, LDAPMessage **res)
		extrn ldap_search_s:dword ; CODE XREF: sub_4033A7+31Dp
					; sub_403A3F+336p ...
; ULONG	__cdecl	ldap_set_option(LDAP *ld, int option, const void *invalue)
		extrn ldap_set_option:dword ; CODE XREF: sub_4053E3+DADp
					; sub_4053E3+EE1p
					; DATA XREF: ...
; ULONG	__cdecl	ldap_simple_bind_s(LDAP	*ld, const PCHAR dn, const PCHAR passwd)
		extrn ldap_simple_bind_s:dword ; CODE XREF: sub_4053E3+FB3p
					; DATA XREF: sub_4053E3+FAEr
; ULONG	__cdecl	ldap_start_tls_sA(PLDAP	ExternalHandle,	PULONG ServerReturnValue, LDAPMessage **result,	PLDAPControlA *ServerControls, PLDAPControlA *ClientControls)
		extrn ldap_start_tls_sA:dword ;	CODE XREF: sub_4053E3+DEDp
					; DATA XREF: sub_4053E3+DE8r
; ULONG	__cdecl	ldap_unbind_s(LDAP *ld)
		extrn ldap_unbind_s:dword ; CODE XREF: sub_4053E3+1428p
					; DATA XREF: sub_4053E3+1423r
; ULONG	__cdecl	ldap_value_free(PCHAR *vals)
		extrn ldap_value_free:dword ; CODE XREF: sub_402FF3+E3p
					; sub_402FF3+165p ...

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: .text:004068D7p
					; DATA XREF: .text:004068D2r


; Section 6. (virtual address 00015000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00011600
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 415000h
dword_415000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_415008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_41500C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_40CEC0
dword_415018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_415030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_40CE63o
					; TlsCallback_0+138o ...
		dd 54h dup(?)
		db 2 dup(?)
word_415352	dw ?			; DATA XREF: .rdata:off_4100C1o
		align 1000h
_CRT		ends

; Section 7. (virtual address 00016000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00011800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 416000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
