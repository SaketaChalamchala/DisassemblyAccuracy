;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	DB0C03A02726CE897F0B172234008180
; Input	CRC32 :	5A08C58E

; File Name   :	C:\compspace\compare\gpg\dlls\original\md5sum.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00003084 (  12420.)
; Section size in file		: 00003200 (  12800.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00409004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_407034
		mov	[esp+2Ch+var_1C], offset dword_407018
		mov	[esp+2Ch+var_24], offset dword_40700C
		mov	[esp+2Ch+var_28], offset dword_407008
		mov	ds:dword_407018, eax
		mov	eax, ds:dword_407038
		mov	[esp+2Ch+var_2C], offset dword_407004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_40701C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00409010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_407044, 1
		mov	ds:dword_407040, 1
		mov	ds:dword_40703C, 1
		mov	ds:dword_407050, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_407014, eax
		mov	eax, ds:dword_407054
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_402B40
		mov	edx, ds:dword_407058
		mov	ds:dword_4073FC, eax
		mov	ds:dword_407400, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_402E80
		cmp	dword_405014, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_402E20
		call	sub_402E10
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_403BF0
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_407054
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_407404
		call	sub_403C50
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_407408
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_407408
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_407000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_407408
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_407404

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_406208+230h
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0 ; jumptable	004028B6 case 140
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_403130
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_40705C, eax
		call	sub_4036E0
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_4037A0
		mov	eax, ds:dword_407054
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_4073E4, eax
		mov	eax, 0Ah
		mov	ds:dword_4073EC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_4073E8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_407004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_407008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_407008, eax
		call	sub_403830
		mov	eax, ds:__initenv
		mov	edx, ds:dword_40700C
		mov	[eax], edx
		mov	eax, ds:dword_40700C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_407008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_407004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_403DE0
		mov	esi, ds:dword_407014
		test	esi, esi
		mov	ds:dword_407010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_407000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_407010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_407408
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_407408
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_409008
		mov	[esp+88h+dwMilliseconds], offset dword_409000
		call	_initterm
		mov	ds:dword_407408, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_407408, 1
		mov	[esp+88h+lpProcName], offset dword_409018
		mov	[esp+88h+dwMilliseconds], offset dword_40900C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_407054, 1
		call	sub_403850
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_407054, 0
		call	sub_403850
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_404050+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_405020
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_405020
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_404050+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401550	proc near		; CODE XREF: sub_401DF0+64p
					; sub_401DF0+A2p ...

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 58h
		mov	[esp+68h+var_64], eax
		mov	eax, [eax]
		mov	[esp+68h+var_54], eax
		mov	eax, [esp+68h+var_64]
		mov	eax, [eax+4]
		mov	[esp+68h+var_60], eax
		mov	eax, [esp+68h+var_64]
		mov	eax, [eax+8]
		mov	[esp+68h+var_5C], eax
		mov	eax, [esp+68h+var_64]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+var_58], eax
		mov	eax, ds:dword_407020
		test	eax, eax
		jz	loc_401D70
		lea	ebx, [esp+68h+var_10]
		lea	eax, [esp+68h+var_50]

loc_401597:				; CODE XREF: sub_401550+69j
		movzx	ecx, byte ptr [edx]
		mov	[eax+3], cl
		movzx	ecx, byte ptr [edx+1]
		mov	[eax+2], cl
		movzx	ecx, byte ptr [edx+2]
		mov	[eax+1], cl
		movzx	ecx, byte ptr [edx+3]
		add	edx, 4
		mov	[eax], cl
		add	eax, 4
		cmp	eax, ebx
		jnz	short loc_401597

loc_4015BB:				; CODE XREF: sub_401550+88Fj
		mov	edi, [esp+68h+var_54]
		mov	edx, [esp+68h+var_50]
		mov	eax, [esp+68h+var_58]
		xor	eax, [esp+68h+var_5C]
		and	eax, [esp+68h+var_60]
		xor	eax, [esp+68h+var_58]
		lea	esi, [edi+edx-28955B88h]
		mov	ebp, [esp+68h+var_4C]
		mov	edi, 7
		mov	ecx, edi
		add	esi, eax
		mov	eax, [esp+68h+var_58]
		rol	esi, cl
		add	esi, [esp+68h+var_60]
		lea	ebx, [eax+ebp-173848AAh]
		mov	eax, [esp+68h+var_5C]
		mov	ebp, 0Ch
		xor	eax, [esp+68h+var_60]
		mov	ecx, ebp
		and	eax, esi
		xor	eax, [esp+68h+var_5C]
		add	ebx, eax
		mov	eax, [esp+68h+var_48]
		rol	ebx, cl
		mov	ecx, [esp+68h+var_5C]
		add	ebx, esi
		lea	edx, [ecx+eax+242070DBh]
		mov	eax, [esp+68h+var_60]
		mov	ecx, 11h
		xor	eax, esi
		and	eax, ebx
		xor	eax, [esp+68h+var_60]
		add	edx, eax
		mov	eax, [esp+68h+var_44]
		rol	edx, cl
		mov	ecx, [esp+68h+var_60]
		add	edx, ebx
		lea	eax, [ecx+eax-3E423112h]
		mov	ecx, 16h
		mov	[esp+68h+var_68], eax
		mov	eax, ebx
		xor	eax, esi
		and	eax, edx
		xor	eax, esi
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		mov	ecx, [esp+68h+var_40]
		add	eax, edx
		lea	esi, [esi+ecx-0A83F051h]
		mov	ecx, edx
		xor	ecx, ebx
		and	ecx, eax
		xor	ecx, ebx
		add	esi, ecx
		mov	ecx, edi
		rol	esi, cl
		mov	ecx, [esp+68h+var_3C]
		add	esi, eax
		lea	ebx, [ebx+ecx+4787C62Ah]
		mov	ecx, eax
		xor	ecx, edx
		and	ecx, esi
		xor	ecx, edx
		add	ebx, ecx
		mov	ecx, ebp
		rol	ebx, cl
		mov	ecx, [esp+68h+var_38]
		add	ebx, esi
		lea	edx, [edx+ecx-57CFB9EDh]
		mov	ecx, 11h
		mov	[esp+68h+var_68], edx
		mov	edx, esi
		xor	edx, eax
		and	edx, ebx
		xor	edx, eax
		add	edx, [esp+68h+var_68]
		rol	edx, cl
		mov	ecx, [esp+68h+var_34]
		add	edx, ebx
		lea	eax, [eax+ecx-2B96AFFh]
		mov	ecx, 16h
		mov	[esp+68h+var_68], eax
		mov	eax, ebx
		xor	eax, esi
		and	eax, edx
		xor	eax, esi
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		mov	ecx, [esp+68h+var_30]
		add	eax, edx
		lea	esi, [esi+ecx+698098D8h]
		mov	ecx, edx
		xor	ecx, ebx
		and	ecx, eax
		xor	ecx, ebx
		add	esi, ecx
		mov	ecx, edi
		rol	esi, cl
		mov	ecx, [esp+68h+var_2C]
		add	esi, eax
		lea	ebx, [ebx+ecx-74BB0851h]
		mov	ecx, eax
		xor	ecx, edx
		and	ecx, esi
		xor	ecx, edx
		add	ebx, ecx
		mov	ecx, ebp
		rol	ebx, cl
		mov	ecx, [esp+68h+var_28]
		add	ebx, esi
		lea	edx, [edx+ecx-0A44Fh]
		mov	ecx, 11h
		mov	[esp+68h+var_68], edx
		mov	edx, esi
		xor	edx, eax
		and	edx, ebx
		xor	edx, eax
		add	edx, [esp+68h+var_68]
		rol	edx, cl
		mov	ecx, [esp+68h+var_24]
		add	edx, ebx
		lea	eax, [eax+ecx-76A32842h]
		mov	ecx, 16h
		mov	[esp+68h+var_68], eax
		mov	eax, ebx
		xor	eax, esi
		and	eax, edx
		xor	eax, esi
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		mov	ecx, [esp+68h+var_20]
		add	eax, edx
		lea	esi, [esi+ecx+6B901122h]
		mov	ecx, edx
		xor	ecx, ebx
		and	ecx, eax
		xor	ecx, ebx
		add	esi, ecx
		mov	ecx, edi
		mov	edi, [esp+68h+var_1C]
		rol	esi, cl
		mov	ecx, eax
		add	esi, eax
		xor	ecx, edx
		lea	ebx, [ebx+edi-2678E6Dh]
		mov	edi, [esp+68h+var_18]
		and	ecx, esi
		xor	ecx, edx
		add	ebx, ecx
		mov	ecx, ebp
		mov	ebp, [esp+68h+var_14]
		rol	ebx, cl
		lea	ecx, [edx+edi-5986BC72h]
		mov	edx, esi
		add	ebx, esi
		xor	edx, eax
		and	edx, ebx
		xor	edx, eax
		lea	edi, [eax+ebp+49B40821h]
		mov	eax, ebx
		mov	ebp, [esp+68h+var_4C]
		add	edx, ecx
		xor	eax, esi
		mov	ecx, 11h
		rol	edx, cl
		add	edx, ebx
		mov	cl, 16h
		and	eax, edx
		xor	eax, esi
		add	edi, eax
		rol	edi, cl
		add	edi, edx
		mov	eax, edi
		xor	eax, edx
		and	eax, ebx
		lea	ecx, [ebp+esi-9E1DA9Eh]
		xor	eax, edx
		mov	ebp, [esp+68h+var_38]
		mov	esi, 5
		add	eax, ecx
		mov	ecx, esi
		rol	eax, cl
		add	eax, edi
		mov	ecx, eax
		xor	ecx, edi
		and	ecx, edx
		xor	ecx, edi
		lea	ebx, [ebp+ebx-3FBF4CC0h]
		mov	ebp, 9
		add	ebx, ecx
		mov	ecx, ebp
		rol	ebx, cl
		mov	ecx, [esp+68h+var_24]
		add	ebx, eax
		lea	edx, [ecx+edx+265E5A51h]
		mov	ecx, 0Eh
		mov	[esp+68h+var_68], edx
		mov	edx, ebx
		xor	edx, eax
		and	edx, edi
		xor	edx, eax
		add	edx, [esp+68h+var_68]
		rol	edx, cl
		mov	ecx, [esp+68h+var_50]
		add	edx, ebx
		lea	edi, [ecx+edi-16493856h]
		mov	ecx, edx
		xor	ecx, ebx
		and	ecx, eax
		xor	ecx, ebx
		add	edi, ecx
		mov	ecx, 14h
		rol	edi, cl
		mov	ecx, [esp+68h+var_3C]
		add	edi, edx
		lea	eax, [ecx+eax-29D0EFA3h]
		mov	ecx, esi
		mov	[esp+68h+var_68], eax
		mov	eax, edi
		xor	eax, edx
		and	eax, ebx
		xor	eax, edx
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		mov	ecx, [esp+68h+var_28]
		add	eax, edi
		lea	ebx, [ecx+ebx+2441453h]
		mov	ecx, eax
		xor	ecx, edi
		and	ecx, edx
		xor	ecx, edi
		add	ebx, ecx
		mov	ecx, ebp
		rol	ebx, cl
		mov	ecx, [esp+68h+var_14]
		add	ebx, eax
		lea	edx, [ecx+edx-275E197Fh]
		mov	ecx, 0Eh
		mov	[esp+68h+var_68], edx
		mov	edx, ebx
		xor	edx, eax
		and	edx, edi
		xor	edx, eax
		add	edx, [esp+68h+var_68]
		rol	edx, cl
		mov	ecx, [esp+68h+var_40]
		add	edx, ebx
		lea	edi, [ecx+edi-182C0438h]
		mov	ecx, edx
		xor	ecx, ebx
		and	ecx, eax
		xor	ecx, ebx
		add	edi, ecx
		mov	ecx, 14h
		rol	edi, cl
		mov	ecx, [esp+68h+var_2C]
		add	edi, edx
		lea	eax, [ecx+eax+21E1CDE6h]
		mov	ecx, esi
		mov	[esp+68h+var_68], eax
		mov	eax, edi
		xor	eax, edx
		and	eax, ebx
		xor	eax, edx
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		mov	ecx, [esp+68h+var_18]
		add	eax, edi
		lea	ebx, [ecx+ebx-3CC8F82Ah]
		mov	ecx, eax
		xor	ecx, edi
		and	ecx, edx
		xor	ecx, edi
		add	ebx, ecx
		mov	ecx, ebp
		rol	ebx, cl
		mov	ecx, [esp+68h+var_44]
		add	ebx, eax
		lea	edx, [ecx+edx-0B2AF279h]
		mov	ecx, 0Eh
		mov	[esp+68h+var_68], edx
		mov	edx, ebx
		xor	edx, eax
		and	edx, edi
		xor	edx, eax
		add	edx, [esp+68h+var_68]
		rol	edx, cl
		mov	ecx, [esp+68h+var_30]
		add	edx, ebx
		lea	edi, [ecx+edi+455A14EDh]
		mov	ecx, edx
		xor	ecx, ebx
		and	ecx, eax
		xor	ecx, ebx
		add	edi, ecx
		mov	ecx, 14h
		rol	edi, cl
		mov	ecx, [esp+68h+var_1C]
		add	edi, edx
		lea	eax, [ecx+eax-561C16FBh]
		mov	ecx, esi
		mov	esi, [esp+68h+var_48]
		mov	[esp+68h+var_68], eax
		mov	eax, edi
		xor	eax, edx
		and	eax, ebx
		xor	eax, edx
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		add	eax, edi
		mov	ecx, eax
		xor	ecx, edi
		lea	ebx, [esi+ebx-3105C08h]
		mov	esi, [esp+68h+var_34]
		and	ecx, edx
		xor	ecx, edi
		add	ebx, ecx
		mov	ecx, ebp
		mov	ebp, [esp+68h+var_20]
		rol	ebx, cl
		add	ebx, eax
		lea	ecx, [esi+edx+676F02D9h]
		mov	edx, ebx
		xor	edx, eax
		and	edx, edi
		xor	edx, eax
		add	edx, ecx
		mov	ecx, 0Eh
		rol	edx, cl
		add	edx, ebx
		mov	esi, edx
		xor	esi, ebx
		lea	edi, [ebp+edi-72D5B376h]
		mov	ecx, esi
		mov	ebp, [esp+68h+var_3C]
		and	ecx, eax
		xor	ecx, ebx
		add	edi, ecx
		mov	ecx, 14h
		rol	edi, cl
		add	edi, edx
		lea	eax, [ebp+eax-5C6BEh]
		xor	esi, edi
		add	esi, eax
		mov	eax, [esp+68h+var_30]
		mov	ebp, 4
		mov	ecx, ebp
		rol	esi, cl
		add	esi, edi
		mov	cl, 0Bh
		lea	ebx, [eax+ebx-788E097Fh]
		mov	eax, edi
		xor	eax, edx
		xor	eax, esi
		add	ebx, eax
		mov	eax, [esp+68h+var_24]
		rol	ebx, cl
		add	ebx, esi
		mov	cl, 10h
		lea	edx, [eax+edx+6D9D6122h]
		mov	eax, esi
		xor	eax, edi
		xor	eax, ebx
		add	edx, eax
		mov	eax, [esp+68h+var_18]
		rol	edx, cl
		add	edx, ebx
		lea	ecx, [eax+edi-21AC7F4h]
		mov	eax, ebx
		xor	eax, esi
		mov	edi, 17h
		xor	eax, edx
		add	eax, ecx
		mov	ecx, edi
		rol	eax, cl
		mov	ecx, [esp+68h+var_4C]
		add	eax, edx
		lea	esi, [ecx+esi-5B4115BCh]
		mov	ecx, edx
		xor	ecx, ebx
		xor	ecx, eax
		add	esi, ecx
		mov	ecx, ebp
		rol	esi, cl
		mov	ecx, [esp+68h+var_40]
		add	esi, eax
		lea	ebx, [ecx+ebx+4BDECFA9h]
		mov	ecx, eax
		xor	ecx, edx
		xor	ecx, esi
		add	ebx, ecx
		mov	ecx, 0Bh
		rol	ebx, cl
		mov	ecx, [esp+68h+var_34]
		add	ebx, esi
		lea	edx, [ecx+edx-944B4A0h]
		mov	ecx, 10h
		mov	[esp+68h+var_68], edx
		mov	edx, esi
		xor	edx, eax
		xor	edx, ebx
		add	edx, [esp+68h+var_68]
		rol	edx, cl
		mov	ecx, [esp+68h+var_28]
		add	edx, ebx
		lea	eax, [ecx+eax-41404390h]
		mov	ecx, edi
		mov	[esp+68h+var_68], eax
		mov	eax, ebx
		xor	eax, esi
		xor	eax, edx
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		mov	ecx, [esp+68h+var_1C]
		add	eax, edx
		lea	esi, [ecx+esi+289B7EC6h]
		mov	ecx, edx
		xor	ecx, ebx
		xor	ecx, eax
		add	esi, ecx
		mov	ecx, ebp
		rol	esi, cl
		mov	ecx, [esp+68h+var_50]
		add	esi, eax
		lea	ebx, [ecx+ebx-155ED806h]
		mov	ecx, eax
		xor	ecx, edx
		xor	ecx, esi
		add	ebx, ecx
		mov	ecx, 0Bh
		rol	ebx, cl
		mov	ecx, [esp+68h+var_44]
		add	ebx, esi
		lea	edx, [ecx+edx-2B10CF7Bh]
		mov	ecx, 10h
		mov	[esp+68h+var_68], edx
		mov	edx, esi
		xor	edx, eax
		xor	edx, ebx
		add	edx, [esp+68h+var_68]
		rol	edx, cl
		mov	ecx, [esp+68h+var_38]
		add	edx, ebx
		lea	eax, [ecx+eax+4881D05h]
		mov	ecx, edi
		mov	[esp+68h+var_68], eax
		mov	eax, ebx
		xor	eax, esi
		xor	eax, edx
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		mov	ecx, [esp+68h+var_2C]
		add	eax, edx
		lea	esi, [ecx+esi-262B2FC7h]
		mov	ecx, edx
		xor	ecx, ebx
		xor	ecx, eax
		add	esi, ecx
		mov	ecx, ebp
		mov	ebp, [esp+68h+var_20]
		rol	esi, cl
		mov	ecx, eax
		add	esi, eax
		xor	ecx, edx
		lea	ebx, [ebp+ebx-1924661Bh]
		mov	ebp, [esp+68h+var_14]
		xor	ecx, esi
		add	ebx, ecx
		mov	ecx, 0Bh
		rol	ebx, cl
		add	ebx, esi
		lea	ecx, [ebp+edx+1FA27CF8h]
		mov	ebp, [esp+68h+var_48]
		mov	edx, esi
		xor	edx, eax
		xor	edx, ebx
		add	edx, ecx
		mov	ecx, 10h
		rol	edx, cl
		lea	ecx, [ebp+eax-3B53A99Bh]
		mov	eax, ebx
		add	edx, ebx
		xor	eax, esi
		xor	eax, edx
		mov	ebp, 6
		add	eax, ecx
		mov	ecx, edi
		mov	edi, [esp+68h+var_50]
		rol	eax, cl
		mov	ecx, ebx
		add	eax, edx
		not	ecx
		lea	esi, [edi+esi-0BD6DDBCh]
		mov	edi, [esp+68h+var_34]
		or	ecx, eax
		xor	ecx, edx
		add	esi, ecx
		mov	ecx, ebp
		rol	esi, cl
		lea	ebx, [edi+ebx+432AFF97h]
		mov	ecx, edx
		mov	edi, [esp+68h+var_18]
		add	esi, eax
		not	ecx
		or	ecx, esi
		xor	ecx, eax
		add	ebx, ecx
		mov	ecx, 0Ah
		rol	ebx, cl
		lea	ecx, [edi+edx-546BDC59h]
		mov	edi, [esp+68h+var_3C]
		mov	edx, eax
		add	ebx, esi
		not	edx
		or	edx, ebx
		xor	edx, esi
		add	edx, ecx
		mov	ecx, 0Fh
		rol	edx, cl
		lea	ecx, [edi+eax-36C5FC7h]
		mov	eax, esi
		add	edx, ebx
		not	eax
		or	eax, edx
		mov	edi, 15h
		xor	eax, ebx
		add	eax, ecx
		mov	ecx, edi
		rol	eax, cl
		mov	ecx, [esp+68h+var_20]
		add	eax, edx
		lea	esi, [ecx+esi+655B59C3h]
		mov	ecx, ebx
		not	ecx
		or	ecx, eax
		xor	ecx, edx
		add	esi, ecx
		mov	ecx, ebp
		rol	esi, cl
		mov	ecx, [esp+68h+var_44]
		add	esi, eax
		lea	ebx, [ecx+ebx-70F3336Eh]
		mov	ecx, edx
		not	ecx
		or	ecx, esi
		xor	ecx, eax
		add	ebx, ecx
		mov	ecx, 0Ah
		rol	ebx, cl
		mov	ecx, [esp+68h+var_28]
		add	ebx, esi
		lea	edx, [ecx+edx-100B83h]
		mov	ecx, 0Fh
		mov	[esp+68h+var_68], edx
		mov	edx, eax
		not	edx
		or	edx, ebx
		xor	edx, esi
		add	edx, [esp+68h+var_68]
		rol	edx, cl
		mov	ecx, [esp+68h+var_4C]
		add	edx, ebx
		lea	eax, [ecx+eax-7A7BA22Fh]
		mov	ecx, edi
		mov	[esp+68h+var_68], eax
		mov	eax, esi
		not	eax
		or	eax, edx
		xor	eax, ebx
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		mov	ecx, [esp+68h+var_30]
		add	eax, edx
		lea	esi, [ecx+esi+6FA87E4Fh]
		mov	ecx, ebx
		not	ecx
		or	ecx, eax
		xor	ecx, edx
		add	esi, ecx
		mov	ecx, ebp
		rol	esi, cl
		mov	ecx, [esp+68h+var_14]
		add	esi, eax
		lea	ebx, [ecx+ebx-1D31920h]
		mov	ecx, edx
		not	ecx
		or	ecx, esi
		xor	ecx, eax
		add	ebx, ecx
		mov	ecx, 0Ah
		rol	ebx, cl
		mov	ecx, [esp+68h+var_38]
		add	ebx, esi
		lea	edx, [ecx+edx-5CFEBCECh]
		mov	ecx, 0Fh
		mov	[esp+68h+var_68], edx
		mov	edx, eax
		not	edx
		or	edx, ebx
		xor	edx, esi
		add	edx, [esp+68h+var_68]
		rol	edx, cl
		mov	ecx, [esp+68h+var_1C]
		add	edx, ebx
		lea	eax, [ecx+eax+4E0811A1h]
		mov	ecx, edi
		mov	[esp+68h+var_68], eax
		mov	eax, esi
		not	eax
		or	eax, edx
		xor	eax, ebx
		add	eax, [esp+68h+var_68]
		rol	eax, cl
		mov	ecx, [esp+68h+var_40]
		add	eax, edx
		lea	esi, [ecx+esi-8AC817Eh]
		mov	ecx, ebx
		not	ecx
		or	ecx, eax
		xor	ecx, edx
		add	esi, ecx
		mov	ecx, ebp
		mov	ebp, [esp+68h+var_24]
		rol	esi, cl
		mov	ecx, edx
		add	esi, eax
		not	ecx
		lea	ebx, [ebp+ebx-42C50DCBh]
		mov	ebp, [esp+68h+var_48]
		or	ecx, esi
		xor	ecx, eax
		add	ebx, ecx
		mov	ecx, 0Ah
		rol	ebx, cl
		lea	ecx, [ebp+edx+2AD7D2BBh]
		mov	ebp, [esp+68h+var_2C]
		mov	edx, eax
		add	ebx, esi
		not	edx
		or	edx, ebx
		xor	edx, esi
		add	edx, ecx
		mov	ecx, 0Fh
		rol	edx, cl
		lea	ecx, [ebp+eax-14792C6Fh]
		mov	eax, esi
		add	edx, ebx
		not	eax
		or	eax, edx
		xor	eax, ebx
		add	eax, ecx
		mov	ecx, edi
		mov	edi, [esp+68h+var_64]
		rol	eax, cl
		add	eax, [esp+68h+var_60]
		add	esi, [esp+68h+var_54]
		add	ebx, [esp+68h+var_58]
		add	eax, edx
		add	edx, [esp+68h+var_5C]
		mov	[edi], esi
		mov	[edi+4], eax
		mov	[edi+8], edx
		mov	[edi+0Ch], ebx
		add	esp, 58h
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401D70:				; CODE XREF: sub_401550+39j
		mov	eax, [edx]
		mov	[esp+68h+var_50], eax
		mov	eax, [edx+4]
		mov	[esp+68h+var_4C], eax
		mov	eax, [edx+8]
		mov	[esp+68h+var_48], eax
		mov	eax, [edx+0Ch]
		mov	[esp+68h+var_44], eax
		mov	eax, [edx+10h]
		mov	[esp+68h+var_40], eax
		mov	eax, [edx+14h]
		mov	[esp+68h+var_3C], eax
		mov	eax, [edx+18h]
		mov	[esp+68h+var_38], eax
		mov	eax, [edx+1Ch]
		mov	[esp+68h+var_34], eax
		mov	eax, [edx+20h]
		mov	[esp+68h+var_30], eax
		mov	eax, [edx+24h]
		mov	[esp+68h+var_2C], eax
		mov	eax, [edx+28h]
		mov	[esp+68h+var_28], eax
		mov	eax, [edx+2Ch]
		mov	[esp+68h+var_24], eax
		mov	eax, [edx+30h]
		mov	[esp+68h+var_20], eax
		mov	eax, [edx+34h]
		mov	[esp+68h+var_1C], eax
		mov	eax, [edx+38h]
		mov	[esp+68h+var_18], eax
		mov	eax, [edx+3Ch]
		mov	[esp+68h+var_14], eax
		jmp	loc_4015BB
sub_401550	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401DF0	proc near		; CODE XREF: sub_401DF0+86p
					; sub_401F00+ABp ...

var_20		= dword	ptr -20h

		push	ebp
		mov	ebp, edx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 1Ch
		mov	eax, [eax+54h]
		mov	[esp+2Ch+var_20], ecx
		lea	esi, [ebx+14h]
		cmp	eax, 40h
		jz	short loc_401E50

loc_401E0A:				; CODE XREF: sub_401DF0+5Ej
		test	ebp, ebp
		jz	short loc_401E68

loc_401E0E:				; CODE XREF: sub_401DF0+76j
		mov	eax, [ebx+54h]
		test	eax, eax
		jz	short loc_401E7B
		mov	edx, [esp+2Ch+var_20]
		test	edx, edx
		jz	short loc_401E41
		cmp	eax, 3Fh
		jle	short loc_401E2C
		jmp	short loc_401E70
; ---------------------------------------------------------------------------

loc_401E24:				; CODE XREF: sub_401DF0+4Fj
		add	ebp, 1
		cmp	eax, 40h
		jz	short loc_401E70

loc_401E2C:				; CODE XREF: sub_401DF0+30j
		movzx	edx, byte ptr [ebp+0]
		mov	[ebx+eax+14h], dl
		add	eax, 1
		sub	[esp+2Ch+var_20], 1
		mov	[ebx+54h], eax
		jnz	short loc_401E24

loc_401E41:				; CODE XREF: sub_401DF0+2Bj
		xor	ebp, ebp
		cmp	eax, 40h
		mov	[esp+2Ch+var_20], 0
		jnz	short loc_401E0A

loc_401E50:				; CODE XREF: sub_401DF0+18j
		mov	edx, esi
		mov	eax, ebx
		call	sub_401550
		add	dword ptr [ebx+10h], 1
		test	ebp, ebp
		mov	dword ptr [ebx+54h], 0
		jnz	short loc_401E0E

loc_401E68:				; CODE XREF: sub_401DF0+1Cj
					; sub_401DF0+CEj ...
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_401E70:				; CODE XREF: sub_401DF0+32j
					; sub_401DF0+3Aj
		xor	ecx, ecx
		xor	edx, edx
		mov	eax, ebx
		call	sub_401DF0

loc_401E7B:				; CODE XREF: sub_401DF0+23j
		mov	esi, [esp+2Ch+var_20]
		mov	edi, ebp
		cmp	esi, 3Fh
		mov	ecx, esi
		jbe	short loc_401EBC

loc_401E88:				; CODE XREF: sub_401DF0+B5j
		mov	edx, edi
		mov	eax, ebx
		sub	esi, 40h
		add	edi, 40h
		call	sub_401550
		add	dword ptr [ebx+10h], 1
		cmp	esi, 3Fh
		mov	dword ptr [ebx+54h], 0
		ja	short loc_401E88
		mov	eax, [esp+2Ch+var_20]
		mov	ecx, [esp+2Ch+var_20]
		sub	eax, 40h
		and	eax, 0FFFFFFC0h
		and	ecx, 3Fh
		lea	ebp, [ebp+eax+40h]

loc_401EBC:				; CODE XREF: sub_401DF0+96j
		test	ecx, ecx
		jz	short loc_401E68
		mov	edx, [ebx+54h]
		cmp	edx, 3Fh
		jg	short loc_401E68
		lea	eax, [edx+1]
		add	ecx, edx
		sub	ebp, edx
		jmp	short loc_401ED9
; ---------------------------------------------------------------------------

loc_401ED1:				; CODE XREF: sub_401DF0+F7j
		add	eax, 1
		cmp	eax, 41h
		jz	short loc_401E68

loc_401ED9:				; CODE XREF: sub_401DF0+DFj
		movzx	edx, byte ptr [ebp+eax-1]
		cmp	eax, ecx
		mov	[ebx+eax+13h], dl
		mov	[ebx+54h], eax
		jnz	short loc_401ED1
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401DF0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_401F00
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401F00	proc near		; CODE XREF: .text:00401EF1j
					; sub_4024E0+81p ...

Filename	= dword	ptr -14h
Mode		= dword	ptr -10h
Count		= dword	ptr -0Ch
File		= dword	ptr -8
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
Str2		= dword	ptr  18h
DstBuf		= byte ptr  24h
arg_1020	= dword	ptr  1024h
arg_1024	= dword	ptr  1028h
arg_1028	= dword	ptr  102Ch
arg_102C	= dword	ptr  1030h
arg_1030	= dword	ptr  1034h
arg_1034	= byte ptr  1038h
arg_1035	= byte ptr  1039h
arg_1036	= byte ptr  103Ah
arg_1037	= byte ptr  103Bh
arg_1038	= byte ptr  103Ch
arg_1039	= byte ptr  103Dh
arg_103A	= byte ptr  103Eh
arg_103B	= byte ptr  103Fh
arg_103C	= byte ptr  1040h
arg_103D	= byte ptr  1041h
arg_103E	= byte ptr  1042h
arg_103F	= byte ptr  1043h
arg_1040	= byte ptr  1044h
arg_1041	= byte ptr  1045h
arg_1042	= byte ptr  1046h
arg_1043	= byte ptr  1047h
arg_106C	= byte ptr  1070h
arg_106D	= byte ptr  1071h
arg_106E	= byte ptr  1072h
arg_106F	= byte ptr  1073h
arg_1070	= byte ptr  1074h
arg_1071	= byte ptr  1075h
arg_1072	= byte ptr  1076h
arg_1073	= byte ptr  1077h
arg_1074	= dword	ptr  1078h
arg_1080	= dword	ptr  1084h

		push	ebp
		push	edi
		push	esi
		push	ebx
		push	eax
		mov	eax, 1098h
		call	sub_403BF0
		sub	esp, eax
		mov	eax, [esp+14h+arg_1080]
		add	ds:dword_407028, 1
		test	edx, edx
		mov	[esp+14h+Str2],	edx
		mov	esi, eax
		jz	loc_402360

loc_401F2D:				; CODE XREF: sub_401F00+463j
					; sub_401F00+46Dj
		mov	[esp+14h+Mode],	offset Mode ; "rb"
		mov	[esp+14h+Filename], esi	; Filename
		call	fopen
		mov	[esp+14h+arg_8], eax

loc_401F41:				; CODE XREF: sub_401F00+494j
		mov	ebp, [esp+14h+arg_8]
		test	ebp, ebp
		jz	loc_402453
		mov	edi, esi
		mov	esi, [esp+14h+arg_8]
		mov	[esp+14h+arg_1020], 67452301h
		lea	ebx, [esp+14h+DstBuf]
		mov	[esp+14h+arg_1024], 0EFCDAB89h
		mov	[esp+14h+arg_1028], 98BADCFEh
		mov	[esp+14h+arg_102C], 10325476h
		mov	[esp+14h+arg_1030], 0
		mov	[esp+14h+arg_1074], 0
		jmp	short loc_401FB0
; ---------------------------------------------------------------------------
		align 10h

loc_401FA0:				; CODE XREF: sub_401F00+CEj
		mov	ecx, eax
		mov	edx, ebx
		lea	eax, [esp+14h+arg_1020]
		call	sub_401DF0

loc_401FB0:				; CODE XREF: sub_401F00+99j
		mov	[esp+14h+File],	esi ; File
		mov	[esp+14h+Count], 1000h ; Count
		mov	[esp+14h+Mode],	1 ; ElementSize
		mov	[esp+14h+Filename], ebx	; DstBuf
		call	fread
		test	eax, eax
		jnz	short loc_401FA0
		mov	eax, [esp+14h+arg_8]
		mov	esi, edi
		mov	[esp+14h+Filename], eax	; File
		call	ferror
		test	eax, eax
		jnz	loc_4023C9
		xor	ecx, ecx
		xor	edx, edx
		lea	eax, [esp+14h+arg_1020]
		call	sub_401DF0
		mov	ecx, [esp+14h+arg_1030]
		mov	eax, [esp+14h+arg_1074]
		mov	edx, ecx
		shl	edx, 6
		mov	edi, edx
		shr	ecx, 1Ah
		add	edi, eax
		adc	ecx, 0
		lea	edx, ds:0[edi*8]
		shl	ecx, 3
		mov	[esp+14h+arg_C], edx
		mov	edx, edi
		shr	edx, 1Dh
		mov	[esp+14h+arg_10], ecx
		or	[esp+14h+arg_10], edx
		cmp	eax, 37h
		lea	edx, [eax+1]
		mov	[esp+eax+14h+arg_1034],	80h
		mov	[esp+14h+arg_1074], edx
		jg	loc_4022F0
		cmp	edx, 38h
		lea	ebp, [esp+14h+arg_1034]
		jz	short loc_40207F
		lea	eax, [esp+eax+14h+arg_1035]
		lea	edx, [esp+14h+arg_106C]

loc_402063:				; CODE XREF: sub_401F00+16Bj
		mov	byte ptr [eax],	0
		add	eax, 1
		cmp	eax, edx
		jnz	short loc_402063
		mov	[esp+14h+arg_1074], 38h
		lea	ebp, [esp+14h+arg_1034]

loc_40207F:				; CODE XREF: sub_401F00+153j
					; sub_401F00+432j
		movzx	eax, byte ptr [esp+14h+arg_C]
		movzx	edx, byte ptr [esp+14h+arg_10]
		mov	[esp+14h+arg_1072], 0
		mov	[esp+14h+arg_1073], 0
		mov	[esp+14h+arg_106C], al
		mov	eax, [esp+14h+arg_C]
		mov	[esp+14h+arg_1070], dl
		mov	edx, ebp
		shr	eax, 8
		mov	[esp+14h+arg_106D], al
		mov	eax, [esp+14h+arg_C]
		shr	eax, 10h
		mov	[esp+14h+arg_106E], al
		mov	eax, [esp+14h+arg_C]
		shr	eax, 18h
		mov	[esp+14h+arg_106F], al
		mov	eax, [esp+14h+arg_10]
		shr	eax, 8
		mov	[esp+14h+arg_1071], al
		lea	eax, [esp+14h+arg_1020]
		call	sub_401550
		mov	eax, [esp+14h+arg_1020]
		mov	edx, eax
		shr	edx, 8
		mov	[esp+14h+arg_1034], al
		mov	[esp+14h+arg_1035], dl
		mov	edx, eax
		shr	eax, 18h
		mov	[esp+14h+arg_1037], al
		mov	eax, [esp+14h+arg_1024]
		shr	edx, 10h
		mov	[esp+14h+arg_1036], dl
		mov	edx, eax
		shr	edx, 8
		mov	[esp+14h+arg_1038], al
		mov	[esp+14h+arg_1039], dl
		mov	edx, eax
		shr	eax, 18h
		mov	[esp+14h+arg_103B], al
		mov	eax, [esp+14h+arg_1028]
		shr	edx, 10h
		mov	[esp+14h+arg_103A], dl
		mov	edx, eax
		shr	edx, 8
		mov	[esp+14h+arg_103C], al
		mov	[esp+14h+arg_103D], dl
		mov	edx, eax
		shr	eax, 18h
		mov	[esp+14h+arg_103F], al
		mov	eax, [esp+14h+arg_102C]
		shr	edx, 10h
		mov	[esp+14h+arg_103E], dl
		mov	edx, eax
		shr	edx, 8
		mov	[esp+14h+arg_1040], al
		mov	[esp+14h+arg_1041], dl
		mov	edx, eax
		shr	eax, 18h
		mov	[esp+14h+arg_1043], al
		mov	eax, [esp+14h+arg_8]
		shr	edx, 10h
		cmp	eax, ds:_iob
		mov	[esp+14h+arg_1042], dl
		jz	short loc_4021C1
		mov	[esp+14h+Filename], eax	; File
		call	fclose

loc_4021C1:				; CODE XREF: sub_401F00+2B7j
		movzx	edx, byte ptr [esi]
		mov	edi, 1
		test	dl, dl
		jz	short loc_4021FB
		mov	eax, edx
		mov	ecx, esi
		xor	di, di
		jmp	short loc_4021E3
; ---------------------------------------------------------------------------

loc_4021D6:				; CODE XREF: sub_401F00+2E5j
					; sub_401F00+2E9j
		add	ecx, 1
		add	edi, 2
		movzx	eax, byte ptr [ecx]
		test	al, al
		jz	short loc_4021F8

loc_4021E3:				; CODE XREF: sub_401F00+2D4j
					; sub_401F00+2F6j
		cmp	al, 0Dh
		jz	short loc_4021D6
		cmp	al, 0Ah
		jz	short loc_4021D6
		add	ecx, 1
		add	edi, 1
		movzx	eax, byte ptr [ecx]
		test	al, al
		jnz	short loc_4021E3

loc_4021F8:				; CODE XREF: sub_401F00+2E1j
		add	edi, 1

loc_4021FB:				; CODE XREF: sub_401F00+2CBj
		mov	[esp+14h+arg_4], dl
		mov	[esp+14h+Filename], edi	; Size
		call	malloc
		movzx	edx, [esp+14h+arg_4]
		test	eax, eax
		mov	[esp+14h+arg_8], eax
		jz	loc_40249D
		xor	edi, edi
		test	dl, dl
		jnz	short loc_402245
		jmp	short loc_402263
; ---------------------------------------------------------------------------

loc_402220:				; CODE XREF: sub_401F00+348j
		cmp	dl, 0Dh
		jz	loc_402337
		cmp	dl, 5Ch
		lea	esi, [esi+0]
		jz	loc_402350
		mov	[eax], dl
		add	eax, 1

loc_40223B:				; CODE XREF: sub_401F00+446j
					; sub_401F00+456j
		add	esi, 1
		movzx	edx, byte ptr [esi]
		test	dl, dl
		jz	short loc_402263

loc_402245:				; CODE XREF: sub_401F00+31Cj
					; sub_401F00+361j
		cmp	dl, 0Ah
		jnz	short loc_402220
		add	esi, 1
		mov	edi, 1
		mov	byte ptr [eax],	5Ch
		mov	byte ptr [eax+1], 6Eh
		movzx	edx, byte ptr [esi]
		add	eax, 2
		test	dl, dl
		jnz	short loc_402245

loc_402263:				; CODE XREF: sub_401F00+31Ej
					; sub_401F00+343j
		add	ds:dword_407030, 1
		xor	esi, esi
		mov	byte ptr [eax],	0
		nop

loc_402270:				; CODE XREF: sub_401F00+39Aj
		movzx	eax, byte ptr [ebp+esi+0]
		mov	[esp+14h+Count], offset	a02x ; "%02x"
		mov	[esp+14h+Mode],	0Ah ; size_t
		mov	[esp+14h+File],	eax ; char
		lea	eax, [ebx+esi*2]
		add	esi, 1
		mov	[esp+14h+Filename], eax	; char *
		call	sub_403C70
		cmp	esi, 10h
		jnz	short loc_402270
		mov	ecx, [esp+14h+Str2]
		test	ecx, ecx
		jz	loc_402399
		mov	edx, [esp+14h+Str2]
		mov	[esp+14h+Filename], ebx	; Str1
		mov	[esp+14h+Mode],	edx ; Str2
		call	strcmp
		test	eax, eax
		mov	eax, [esp+14h+arg_8]
		mov	[esp+14h+Mode],	eax
		jnz	loc_402436
		mov	[esp+14h+Filename], offset Format ; "%s: OK\n"
		call	printf

loc_4022D4:				; CODE XREF: sub_401F00+4C4j
		mov	eax, [esp+14h+arg_8]
		mov	[esp+14h+Filename], eax	; Memory
		call	free
		xor	eax, eax

loc_4022E2:				; CODE XREF: sub_401F00+531j
					; sub_401F00+54Ej
		add	esp, 109Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4022F0:				; CODE XREF: sub_401F00+143j
		cmp	edx, 3Fh
		jg	short loc_402310

loc_4022F5:				; CODE XREF: sub_401F00+403j
		mov	[esp+eax+14h+arg_1035],	0
		add	eax, 1
		cmp	eax, 3Fh
		jnz	short loc_4022F5
		mov	[esp+14h+arg_1074], 40h

loc_402310:				; CODE XREF: sub_401F00+3F3j
		xor	ecx, ecx
		xor	edx, edx
		lea	eax, [esp+14h+arg_1020]
		lea	ebp, [esp+14h+arg_1034]
		call	sub_401DF0
		mov	edi, ebp
		mov	ecx, 0Eh
		xor	eax, eax
		rep stosd
		jmp	loc_40207F
; ---------------------------------------------------------------------------

loc_402337:				; CODE XREF: sub_401F00+323j
		mov	byte ptr [eax],	5Ch
		mov	edi, 1
		mov	byte ptr [eax+1], 72h
		add	eax, 2
		jmp	loc_40223B
; ---------------------------------------------------------------------------
		align 10h

loc_402350:				; CODE XREF: sub_401F00+330j
		mov	byte ptr [eax],	2Fh
		add	eax, 1
		jmp	loc_40223B
; ---------------------------------------------------------------------------
		align 10h

loc_402360:				; CODE XREF: sub_401F00+27j
		cmp	byte ptr [eax],	2Dh
		jnz	loc_401F2D
		cmp	byte ptr [eax+1], 0
		jnz	loc_401F2D
		mov	eax, ds:_iob
		mov	[esp+14h+arg_8], eax
		mov	[esp+14h+Filename], eax	; File
		call	_fileno
		mov	[esp+14h+Mode],	8000h
		mov	[esp+14h+Filename], eax
		call	_setmode
		jmp	loc_401F41
; ---------------------------------------------------------------------------

loc_402399:				; CODE XREF: sub_401F00+3A2j
		test	edi, edi
		mov	edx, offset byte_40606F
		mov	eax, offset asc_40606D ; "\\"
		cmovz	eax, edx
		mov	edx, [esp+14h+arg_8]
		mov	[esp+14h+Count], ebx
		mov	[esp+14h+Mode],	eax
		mov	[esp+14h+Filename], offset aSSS	; "%s%s	 %s\n"
		mov	[esp+14h+File],	edx
		call	printf
		jmp	loc_4022D4
; ---------------------------------------------------------------------------

loc_4023C9:				; CODE XREF: sub_401F00+E0j
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Count], edi
		mov	[esp+14h+Mode],	offset aMd5sumErrorRea ; "md5sum: error	reading	`%s': %s\n"
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	eax, [esp+14h+arg_8]
		cmp	eax, ds:_iob
		jz	short loc_40240D
		mov	[esp+14h+Filename], eax	; File
		call	fclose

loc_40240D:				; CODE XREF: sub_401F00+503j
		mov	ebx, [esp+14h+Str2]
		test	ebx, ebx
		jz	short loc_402425
		mov	[esp+14h+Mode],	esi
		mov	[esp+14h+Filename], offset aSFailedRead	; "%s: FAILED read\n"
		call	printf

loc_402425:				; CODE XREF: sub_401F00+513j
					; sub_401F00+589j ...
		add	ds:dword_407024, 1
		mov	eax, 0FFFFFFFFh
		jmp	loc_4022E2
; ---------------------------------------------------------------------------

loc_402436:				; CODE XREF: sub_401F00+3C2j
		mov	[esp+14h+Filename], offset aSFailed ; "%s: FAILED\n"
		call	printf
		mov	eax, 0FFFFFFFFh
		add	ds:dword_40702C, 1
		jmp	loc_4022E2
; ---------------------------------------------------------------------------

loc_402453:				; CODE XREF: sub_401F00+47j
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Count], esi
		mov	[esp+14h+Mode],	offset aMd5sumCanTOpen ; "md5sum: can't open `%s': %s\n"
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	edi, [esp+14h+Str2]
		test	edi, edi
		jz	short loc_402425
		mov	[esp+14h+Mode],	esi
		mov	[esp+14h+Filename], offset aSFailedOpen	; "%s: FAILED open\n"
		call	printf
		jmp	short loc_402425
; ---------------------------------------------------------------------------

loc_40249D:				; CODE XREF: sub_401F00+312j
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Mode],	offset aMd5sumCanTAllo ; "md5sum: can't allocate buffer: %s\n"
		mov	[esp+14h+Count], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	[esp+14h+Filename], 2 ;	Code
		call	exit
sub_401F00	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4024E0	proc near		; CODE XREF: sub_403DE0+123p

File		= dword	ptr -10h
Format		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_18		= dword	ptr  1Ch
arg_1C		= byte ptr  20h

		push	ebp
		mov	eax, 103Ch
		push	edi
		push	esi
		push	ebx
		call	sub_403BF0
		xor	ebx, ebx
		xor	ebp, ebp
		xor	edi, edi
		sub	esp, eax
		mov	eax, ds:_iob
		mov	[esp+10h+File],	eax ; File
		call	_fileno
		mov	[esp+10h+Format], 8000h
		mov	[esp+10h+File],	eax
		call	_setmode
		mov	[esp+10h+arg_18], 0
		jmp	short loc_402524
; ---------------------------------------------------------------------------
		align 10h

loc_402520:				; CODE XREF: sub_4024E0+6Cj
					; sub_4024E0+79j
		test	esi, esi
		jnz	short loc_402578

loc_402524:				; CODE XREF: sub_4024E0+3Bj
					; sub_4024E0+96j
		mov	eax, ds:_iob
		xor	esi, esi
		mov	[esp+10h+File],	eax ; File
		call	getc
		cmp	eax, 0FFFFFFFFh
		jz	short loc_402585
		cmp	ebp, 0FFFh
		ja	short loc_4025A5

loc_402540:				; CODE XREF: sub_4024E0+C3j
		mov	[esp+ebp+10h+arg_1C], al
		add	ebx, 1
		add	ebp, 1
		test	eax, eax
		jnz	short loc_402520
		xor	ebp, ebp
		cmp	[esp+10h+arg_1C], 0
		mov	[esp+10h+arg_18], ebx
		jz	short loc_402520
		xor	edx, edx
		lea	eax, [esp+10h+arg_1C]
		call	sub_401F00
		mov	[esp+10h+arg_18], ebx
		test	eax, eax
		mov	eax, 0FFFFFFFFh
		cmovnz	edi, eax
		test	esi, esi
		jz	short loc_402524

loc_402578:				; CODE XREF: sub_4024E0+42j
					; sub_4024E0+F0j ...
		add	esp, 103Ch
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_402585:				; CODE XREF: sub_4024E0+56j
		mov	eax, ds:_iob
		mov	[esp+10h+File],	eax ; File
		call	ferror
		test	eax, eax
		jnz	short loc_4025D2
		xor	eax, eax
		cmp	ebp, 0FFFh
		mov	esi, 1
		jbe	short loc_402540

loc_4025A5:				; CODE XREF: sub_4024E0+5Ej
		mov	eax, [esp+10h+arg_18]
		or	edi, 0FFFFFFFFh
		mov	[esp+10h+var_8], offset	aStdin ; "[stdin]"
		mov	[esp+10h+Format], offset aMd5sumErrorR_0 ; "md5sum: error reading `%s': filename at"...
		mov	[esp+10h+var_4], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+10h+File],	eax ; File
		call	fprintf
		jmp	short loc_402578
; ---------------------------------------------------------------------------

loc_4025D2:				; CODE XREF: sub_4024E0+B4j
		call	ds:_errno
		or	edi, 0FFFFFFFFh
		mov	eax, [eax]
		mov	[esp+10h+File],	eax ; int
		call	strerror
		mov	[esp+10h+var_4], ebx
		mov	[esp+10h+var_8], offset	aStdin ; "[stdin]"
		mov	[esp+10h+Format], offset aMd5sumErrorR_1 ; "md5sum:error reading `%s' at offset %lu"...
		mov	[esp+10h], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+10h+File],	eax ; File
		call	fprintf
		jmp	loc_402578
sub_4024E0	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402620	proc near		; CODE XREF: sub_403DE0+159p

Filename	= dword	ptr -14h
Mode		= dword	ptr -10h
File		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Buf		= byte ptr  0Ch
arg_28		= byte ptr  2Ch
arg_1010	= dword	ptr  1014h

		push	ebp
		push	edi
		push	esi
		push	ebx
		push	eax
		mov	eax, 1028h
		call	sub_403BF0
		sub	esp, eax
		mov	eax, [esp+14h+arg_1010]
		cmp	byte ptr [eax],	2Dh
		mov	[esp+14h+arg_0], eax
		jz	loc_4027E8

loc_402645:				; CODE XREF: sub_402620+1D8j
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+Mode],	offset aR ; "r"
		mov	[esp+14h+Filename], eax	; Filename
		call	fopen
		mov	esi, eax

loc_40265B:				; CODE XREF: sub_402620+1D2j
		test	esi, esi
		jz	loc_4028FF
		mov	dword ptr [esp+14h], 0
		lea	ebx, [esp+14h+Buf]
		nop

loc_402670:				; CODE XREF: sub_402620+AEj
					; sub_402620+ECj ...
		mov	[esp+14h+File],	esi ; File
		mov	[esp+14h+Mode],	0FFFh ;	MaxCount
		mov	[esp+14h+Filename], ebx	; Buf
		call	fgets
		test	eax, eax
		jz	loc_4027B9
		xor	ecx, ecx
		cmp	[esp+14h+Buf], 5Ch
		setz	cl
		mov	ebp, ecx
		lea	edi, [ebx+ebp]
		mov	[esp+14h+Filename], edi	; Str
		call	strlen
		test	eax, eax
		jz	loc_402776
		cmp	byte ptr [edi+eax-1], 0Ah
		jnz	loc_402776
		mov	edx, eax
		sub	edx, 1
		mov	byte ptr [edi+eax-1], 0
		jz	short loc_4026C9
		cmp	byte ptr [edi+edx-1], 0Dh
		jz	short loc_402711

loc_4026C9:				; CODE XREF: sub_402620+A0j
					; sub_402620+F9j
		cmp	[esp+ebp+14h+Buf], 0
		jz	short loc_402670
		cmp	edx, 21h
		jbe	short loc_4026DC
		cmp	[esp+ebp+14h+arg_28], 20h
		jz	short loc_402720

loc_4026DC:				; CODE XREF: sub_402620+B3j
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+var_8], offset	aInvalidLine ; "invalid	line"
		mov	[esp+14h+Mode],	offset aMd5sumErrorPar ; "md5sum: error	parsing	`%s': %s\n"
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	dword ptr [esp+14h], 0FFFFFFFFh
		jmp	loc_402670
; ---------------------------------------------------------------------------

loc_402711:				; CODE XREF: sub_402620+A7j
		lea	edx, [eax-2]
		mov	byte ptr [edi+eax-2], 0
		jmp	short loc_4026C9
; ---------------------------------------------------------------------------
		align 10h

loc_402720:				; CODE XREF: sub_402620+BAj
		mov	[esp+ebp+14h+arg_28], 0
		movzx	eax, byte ptr [edi]
		test	al, al
		jz	short loc_402747
		mov	edx, edi
		xchg	ax, ax

loc_402730:				; CODE XREF: sub_402620+125j
		lea	ecx, [eax-41h]
		cmp	cl, 19h
		ja	short loc_40273D
		or	eax, 20h
		mov	[edx], al

loc_40273D:				; CODE XREF: sub_402620+116j
		add	edx, 1
		movzx	eax, byte ptr [edx]
		test	al, al
		jnz	short loc_402730

loc_402747:				; CODE XREF: sub_402620+10Aj
		lea	eax, [edi+22h]
		test	ebp, ebp
		mov	[esp+14h+arg_4], eax
		jnz	loc_402800

loc_402756:				; CODE XREF: sub_402620+243j
		mov	eax, [esp+14h+arg_4]
		mov	edx, edi
		call	sub_401F00
		test	eax, eax
		mov	eax, 0FFFFFFFFh
		cmovz	eax, [esp+14h]
		mov	[esp+14h], eax
		jmp	loc_402670
; ---------------------------------------------------------------------------

loc_402776:				; CODE XREF: sub_402620+85j
					; sub_402620+90j
		mov	[esp+14h+Filename], esi	; File
		call	feof
		mov	edx, offset aLastLinefeedMi ; "last linefeed missing"
		mov	[esp+14h+Mode],	offset aMd5sumErrorRea ; "md5sum: error	reading	`%s': %s\n"
		test	eax, eax
		mov	eax, offset aLineTooLong ; "line too long"
		cmovz	edx, eax
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+var_8], edx
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	dword ptr [esp+14h], 0FFFFFFFFh

loc_4027B9:				; CODE XREF: sub_402620+66j
		mov	[esp+14h+Filename], esi	; File
		call	ferror
		test	eax, eax
		jnz	loc_402868

loc_4027C9:				; CODE XREF: sub_402620+284j
		cmp	esi, ds:_iob
		jz	short loc_4027D9
		mov	[esp+14h+Filename], esi	; File
		call	fclose

loc_4027D9:				; CODE XREF: sub_402620+1AFj
					; sub_402620+31Bj
		mov	eax, [esp+14h]
		add	esp, 102Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4027E8:				; CODE XREF: sub_402620+1Fj
		cmp	byte ptr [eax+1], 0
		mov	esi, ds:_iob
		jz	loc_40265B
		jmp	loc_402645
; ---------------------------------------------------------------------------
		align 10h

loc_402800:				; CODE XREF: sub_402620+130j
		movzx	edx, byte ptr [edi+22h]
		test	dl, dl
		jz	short loc_402860
		mov	[esp+14h+var_4], eax
		jmp	short loc_402828
; ---------------------------------------------------------------------------
		align 10h

loc_402810:				; CODE XREF: sub_402620+20Bj
					; sub_402620+219j
		mov	[eax], dl
		mov	edx, [esp+14h+var_4]
		add	eax, 1

loc_402819:				; CODE XREF: sub_402620+23Dj
					; sub_402620+2A3j ...
		lea	ecx, [edx+1]
		movzx	edx, byte ptr [edx+1]
		mov	[esp+14h+var_4], ecx
		test	dl, dl
		jz	short loc_402860

loc_402828:				; CODE XREF: sub_402620+1ECj
		cmp	dl, 5Ch
		jnz	short loc_402810
		mov	ecx, [esp+14h+var_4]
		movzx	ebp, byte ptr [ecx+1]
		mov	ecx, ebp
		test	cl, cl
		jz	short loc_402810
		mov	edx, [esp+14h+var_4]
		sub	ebp, 5Ch
		mov	ecx, ebp
		add	edx, 1
		cmp	cl, 1Ah
		jbe	short loc_4028B0

loc_40284C:				; CODE XREF: sub_402620+296j
					; DATA XREF: .rdata:off_406208o
		mov	ebp, [esp+14h+var_4] ; jumptable 004028B6 cases	1-5,7-9,11-17,19-21,23-25
		mov	byte ptr [eax],	5Ch
		movzx	ecx, byte ptr [ebp+1]
		mov	[eax+1], cl
		add	eax, 2
		jmp	short loc_402819
; ---------------------------------------------------------------------------
		align 10h

loc_402860:				; CODE XREF: sub_402620+1E6j
					; sub_402620+206j
		mov	byte ptr [eax],	0
		jmp	loc_402756
; ---------------------------------------------------------------------------

loc_402868:				; CODE XREF: sub_402620+1A3j
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Mode],	offset aMd5sumErrorR_2 ; "md5sum:error reading `%s': %s\n"
		mov	[esp+14h+var_8], eax
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	dword ptr [esp+14h], 0FFFFFFFFh
		jmp	loc_4027C9
; ---------------------------------------------------------------------------
		align 10h

loc_4028B0:				; CODE XREF: sub_402620+22Aj
		and	ebp, 0FFh	; switch 256 cases
		jmp	ds:off_406208[ebp*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4028BD:				; CODE XREF: sub_402620+296j
					; DATA XREF: .rdata:off_406208o
		mov	byte ptr [eax],	0Bh ; jumptable	004028B6 case 26
		add	eax, 1
		jmp	loc_402819
; ---------------------------------------------------------------------------

loc_4028C8:				; CODE XREF: sub_402620+296j
					; DATA XREF: .rdata:off_406208o
		mov	byte ptr [eax],	0Dh ; jumptable	004028B6 case 22
		add	eax, 1
		jmp	loc_402819
; ---------------------------------------------------------------------------

loc_4028D3:				; CODE XREF: sub_402620+296j
					; DATA XREF: .rdata:off_406208o
		mov	byte ptr [eax],	0Ah ; jumptable	004028B6 case 18
		add	eax, 1
		jmp	loc_402819
; ---------------------------------------------------------------------------

loc_4028DE:				; CODE XREF: sub_402620+296j
					; DATA XREF: .rdata:off_406208o
		mov	byte ptr [eax],	0Ch ; jumptable	004028B6 case 10
		add	eax, 1
		jmp	loc_402819
; ---------------------------------------------------------------------------

loc_4028E9:				; CODE XREF: sub_402620+296j
					; DATA XREF: .rdata:off_406208o
		mov	byte ptr [eax],	8 ; jumptable 004028B6 case 6
		add	eax, 1
		jmp	loc_402819
; ---------------------------------------------------------------------------

loc_4028F4:				; CODE XREF: sub_402620+296j
					; DATA XREF: .rdata:off_406208o
		mov	byte ptr [eax],	5Ch ; jumptable	004028B6 case 0
		add	eax, 1
		jmp	loc_402819
; ---------------------------------------------------------------------------

loc_4028FF:				; CODE XREF: sub_402620+3Dj
		call	ds:_errno
		mov	eax, [eax]
		mov	[esp+14h+Filename], eax	; int
		call	strerror
		mov	[esp+14h+Mode],	offset aMd5sumCanTOpen ; "md5sum: can't open `%s': %s\n"
		mov	[esp+14h+var_8], eax
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+File],	eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+14h+Filename], eax	; File
		call	fprintf
		mov	dword ptr [esp+14h], 0FFFFFFFFh
		jmp	loc_4027D9
sub_402620	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00409024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_402960
		cmp	eax, 3
		jz	short loc_402960
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_402960:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_403B50
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; jumptable 004028B6 case 140

		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; sub_402620+296j
					; DATA XREF: ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_4029D4
		cmp	dword_405010, 2
		jz	short loc_4029B6
		mov	dword_405010, 2

loc_4029B6:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_402AC3
		cmp	eax, 1
		jz	loc_402A62

loc_4029C8:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4029D4:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_4073F8, 1
		mov	[esp+1Ch+lpLibFileName], (offset off_406208+1F4h) ; lpLibFileName
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_402AF3
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], (offset off_406208+201h) ; lpProcName
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_4073F4, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], (offset off_406208+21Ch) ; lpProcName
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_4073F0, eax
		jz	loc_402AF3
		mov	ecx, ds:dword_4073F4
		test	ecx, ecx
		jz	short loc_402A83
		test	eax, eax
		jz	short loc_402A83
		mov	dword_405010, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_402A62:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_403B50
		jmp	loc_4029C8
; ---------------------------------------------------------------------------

loc_402A83:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_4073F0, 0
		mov	ds:dword_4073F4, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_402AA3:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_405010, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_402AC3:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_409030
		cmp	ebx, offset dword_409030
		jz	loc_4029C8

loc_402AD4:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_402ADC
		call	eax

loc_402ADC:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_409030
		jnz	short loc_402AD4
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_402AF3:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_4073F0, 0
		mov	ds:dword_4073F4, 0
		jmp	short loc_402AA3
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402B20	proc near		; DATA XREF: .CRT:00409014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_402B20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402B30	proc near		; CODE XREF: sub_402B50+10p
					; sub_402B50+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_402B30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402B40	proc near		; CODE XREF: sub_401060+59p
					; sub_402B50+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_402B40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402B50(_onexit_t)
sub_402B50	proc near		; CODE XREF: sub_402C10+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_407400
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_402B30
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_402BF0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_407400
		mov	[esp+2Ch+Func],	eax
		call	sub_402B30
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_4073FC
		mov	[esp+2Ch+Func],	eax
		call	sub_402B30
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_402B40
		mov	ds:dword_407400, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_402B40
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_4073FC, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402BF0:				; CODE XREF: sub_402B50+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_402B50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402C10(_onexit_t)
sub_402C10	proc near		; CODE XREF: sub_403830-27p
					; sub_404050+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_402B50
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_402C10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_402C87
		cmp	eax, 0C000008Dh
		jb	short loc_402CB4

loc_402C4B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_402C50:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_402D80
		test	eax, eax
		jz	short loc_402C9C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_402C7F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_402C87:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_402CF5
		cmp	eax, 0C0000096h
		jz	short loc_402CC2
		cmp	eax, 0C0000093h
		jz	short loc_402C4B

loc_402C9C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_40705C
		test	eax, eax
		jz	loc_402D73
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_402CB4:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_402D00
		cmp	eax, 0C000001Dh
		jnz	short loc_402C9C

loc_402CC2:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_402D37
		test	eax, eax
		jz	short loc_402C9C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_402CF5:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_402C50
; ---------------------------------------------------------------------------
		align 10h

loc_402D00:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_402D55
		test	eax, eax
		jz	loc_402C9C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_402D37:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_402C7F
; ---------------------------------------------------------------------------

loc_402D55:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_402C7F
; ---------------------------------------------------------------------------

loc_402D73:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_402C7F
; ---------------------------------------------------------------------------
		align 10h

loc_402D80:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_402C7F
		mov	[esp+2Ch+var_10], eax
		call	sub_4037A0
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_402C7F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_407060
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_402E01
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_407060
		jmp	short loc_402E07
; ---------------------------------------------------------------------------

loc_402E01:				; CODE XREF: .text:00402DD6j
		fstp	st
		fstp	st
		fstp	st

loc_402E07:				; CODE XREF: .text:00402DFFj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402E10	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_407060, eax
		jmp	__setusermatherr
sub_402E10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402E20	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, 40643Ch
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_402E3D
		mov	edx, ds:off_406208+350h[ecx*4]

loc_402E3D:				; CODE XREF: sub_402E20+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], (offset off_406208+244h) ; Format
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_402E20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402E80	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_402E80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_402E90(char *Format, char ArgList)
sub_402E90	proc near		; CODE XREF: sub_402EF0+1DDp
					; sub_402EF0+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], (offset off_406208+368h)	; Str
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_402E90	endp

; ---------------------------------------------------------------------------
		jmp	short sub_402EF0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_402EF0(size_t Size)
sub_402EF0	proc near		; CODE XREF: .text:00402EE1j
					; sub_403130+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_40706C
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_4030D2
		mov	eax, ds:dword_407068
		xor	esi, esi

loc_402F14:				; CODE XREF: sub_402EF0+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_402F29
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_403000

loc_402F29:				; CODE XREF: sub_402EF0+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_402F14

loc_402F33:				; CODE XREF: sub_402EF0+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_4034F0
		test	eax, eax
		mov	edi, eax
		jz	loc_4030F9
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_407068
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_4035D0
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_407068
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_4030D9
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_403081

loc_402FAF:				; CODE XREF: sub_402EF0+194j
					; sub_402EF0+1C6j
		add	ds:dword_40706C, 1

loc_402FB6:				; CODE XREF: sub_402EF0+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_403109
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_403008

loc_402FDF:				; CODE XREF: sub_402EF0+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_402FF3:				; CODE XREF: sub_402EF0+162j
					; sub_402EF0+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403000:				; CODE XREF: sub_402EF0+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_402FB6
; ---------------------------------------------------------------------------

loc_403008:				; CODE XREF: sub_402EF0+EDj
		cmp	eax, 40h
		jz	short loc_402FDF
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_402FF3
		cmp	eax, 4
		jz	short loc_402FF3
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_403081:				; CODE XREF: sub_402EF0+B9j
		cmp	eax, 40h
		jz	loc_402FAF
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_407068
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_402FAF
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], (offset off_406208+3D8h) ;	Format
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_402E90
; ---------------------------------------------------------------------------

loc_4030D2:				; CODE XREF: sub_402EF0+17j
		xor	esi, esi
		jmp	loc_402F33
; ---------------------------------------------------------------------------

loc_4030D9:				; CODE XREF: sub_402EF0+ACj
		mov	eax, ds:dword_407068
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], (offset off_406208+3A4h) ;	Format
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_402E90
; ---------------------------------------------------------------------------

loc_4030F9:				; CODE XREF: sub_402EF0+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], (offset off_406208+384h) ;	Format
		call	sub_402E90
; ---------------------------------------------------------------------------

loc_403109:				; CODE XREF: sub_402EF0+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], (offset off_406208+3A4h) ;	Format
		call	sub_402E90
sub_402EF0	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403130	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_407064
		test	eax, eax
		jz	short loc_403150

loc_403142:				; CODE XREF: sub_403130+66j
					; sub_403130+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403150:				; CODE XREF: sub_403130+10j
		mov	ds:dword_407064, 1
		call	sub_403530
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_403BF0
		mov	ds:dword_40706C, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_407068, eax
		mov	eax, offset dword_406688
		sub	eax, offset dword_406688
		cmp	eax, 7
		jle	short loc_403142
		cmp	eax, 0Bh
		mov	ebx, offset dword_406688
		jle	loc_403290
		mov	eax, ds:dword_406688
		test	eax, eax
		jnz	short loc_4031C0
		mov	eax, ds:dword_40668C
		test	eax, eax
		jz	loc_40327C
		lea	esi, [esi+0]

loc_4031C0:				; CODE XREF: sub_403130+7Dj
					; sub_403130+164j ...
		cmp	ebx, offset dword_406688
		jnb	loc_403142
		mov	esi, 400000h

loc_4031D1:				; CODE XREF: sub_403130+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_402EF0
		cmp	ebx, offset dword_406688
		jb	short loc_4031D1

loc_4031F5:				; CODE XREF: sub_403130+24Bj
		mov	ecx, ds:dword_40706C
		test	ecx, ecx
		jle	loc_403142
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_403222
; ---------------------------------------------------------------------------
		align 10h

loc_403210:				; CODE XREF: sub_403130+FDj
					; sub_403130+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_40706C
		jge	loc_403142

loc_403222:				; CODE XREF: sub_403130+DDj
		mov	eax, ds:dword_407068
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_403210
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_4033A2
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_407068
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_403210
; ---------------------------------------------------------------------------

loc_40327C:				; CODE XREF: sub_403130+86j
		mov	eax, ds:dword_406690
		test	eax, eax
		jnz	short loc_4032A5
		mov	ebx, offset dword_406694
		lea	esi, [esi+0]

loc_403290:				; CODE XREF: sub_403130+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_4031C0
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_4031C0

loc_4032A5:				; CODE XREF: sub_403130+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_4033C5
		add	ebx, 0Ch
		cmp	ebx, offset dword_406688
		jnb	loc_403142

loc_4032C0:				; CODE XREF: sub_403130+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_40331A
		cmp	edx, 20h
		jz	short loc_403350
		cmp	edx, 8
		jz	short loc_4032FA
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_402E90
; ---------------------------------------------------------------------------

loc_4032FA:				; CODE XREF: sub_403130+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_403325
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_403341
; ---------------------------------------------------------------------------

loc_40331A:				; CODE XREF: sub_403130+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_403380

loc_403325:				; CODE XREF: sub_403130+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_403393
		cmp	edx, 20h
		jz	short loc_40335F
		cmp	edx, 8
		jnz	short loc_40336C

loc_403341:				; CODE XREF: sub_403130+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_402EF0
		jmp	short loc_40336C
; ---------------------------------------------------------------------------

loc_403350:				; CODE XREF: sub_403130+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_40335F:				; CODE XREF: sub_403130+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_402EF0

loc_40336C:				; CODE XREF: sub_403130+20Fj
					; sub_403130+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_406688
		jb	loc_4032C0
		jmp	loc_4031F5
; ---------------------------------------------------------------------------

loc_403380:				; CODE XREF: sub_403130+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_403393:				; CODE XREF: sub_403130+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_402EF0
		jmp	short loc_40336C
; ---------------------------------------------------------------------------

loc_4033A2:				; CODE XREF: sub_403130+11Bj
		add	ebx, ds:dword_407068
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], (offset off_406208+3A4h) ;	Format
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_402E90
; ---------------------------------------------------------------------------

loc_4033C5:				; CODE XREF: sub_403130+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_402E90
sub_403130	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4033E0	proc near		; CODE XREF: .text:00403481p
					; sub_4034F0+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_4033F0

locret_4033ED:				; CODE XREF: sub_4033E0+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_4033F0:				; CODE XREF: sub_4033E0+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_4033ED
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_4033E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403410	proc near		; CODE XREF: sub_4034F0+2Bp
					; .text:00403634p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_40344E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_403434:				; CODE XREF: sub_403410+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_403442
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40344E

loc_403442:				; CODE XREF: sub_403410+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_403434
		xor	eax, eax

loc_40344E:				; CODE XREF: sub_403410+19j
					; sub_403410+30j
		pop	ebx
		pop	esi
		retn
sub_403410	endp

; ---------------------------------------------------------------------------
		jmp	short loc_403460
; ---------------------------------------------------------------------------
		align 10h

loc_403460:				; CODE XREF: .text:00403451j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_4034D3
		mov	dword ptr [esp], 400000h
		call	sub_4033E0
		test	eax, eax
		jz	short loc_4034D3
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_4034D3
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_4034BB
; ---------------------------------------------------------------------------

loc_4034B1:				; CODE XREF: .text:004034D1j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_4034E0

loc_4034BB:				; CODE XREF: .text:004034AFj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_4034B1

loc_4034D3:				; CODE XREF: .text:00403478j
					; .text:00403488j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4034E0:				; CODE XREF: .text:004034B9j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4034F0	proc near		; CODE XREF: sub_402EF0+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_4033E0
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_403520
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_403410

loc_403520:				; CODE XREF: sub_4034F0+15j
		add	esp, 8
		retn
sub_4034F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403530	proc near		; CODE XREF: sub_403130+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_4033E0
		xor	edx, edx
		test	eax, eax
		jz	short loc_403551
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_403551:				; CODE XREF: sub_403530+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_403530	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_4033E0
		xor	edx, edx
		test	eax, eax
		jz	short loc_4035B9
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_4035B9
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_4035A0:				; CODE XREF: .text:004035B5j
		test	byte ptr [edx+27h], 20h
		jz	short loc_4035AD
		test	ebx, ebx
		jz	short loc_4035B9
		sub	ebx, 1

loc_4035AD:				; CODE XREF: .text:004035A4j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_4035A0
		xor	edx, edx

loc_4035B9:				; CODE XREF: .text:00403579j
					; .text:00403595j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_4035D0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4035D0	proc near		; CODE XREF: sub_402EF0+70p
					; .text:004035C1j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_4033E0
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_4035D0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_403600
; ---------------------------------------------------------------------------
		align 10h

loc_403600:				; CODE XREF: .text:004035F1j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_4033E0
		test	eax, eax
		jnz	short loc_403620

loc_403616:				; CODE XREF: .text:0040363Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403620:				; CODE XREF: .text:00403614j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_403410
		test	eax, eax
		jz	short loc_403616
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403650	proc near		; CODE XREF: sub_4036E0+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_4033E0
		test	eax, eax
		jz	short loc_4036C1
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_4036C1
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_403410
		test	eax, eax
		jz	short loc_4036C1
		add	esi, 400000h
		jnz	short loc_4036A6
		jmp	short loc_4036C1
; ---------------------------------------------------------------------------
		align 10h

loc_4036A0:				; CODE XREF: sub_403650+66j
		sub	ebx, 1
		add	esi, 14h

loc_4036A6:				; CODE XREF: sub_403650+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_4036B4
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_4036D0

loc_4036B4:				; CODE XREF: sub_403650+5Bj
		test	ebx, ebx
		jg	short loc_4036A0
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_4036C1:				; CODE XREF: sub_403650+1Aj
					; sub_403650+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4036D0:				; CODE XREF: sub_403650+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_403650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4036E0	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_407070
		test	eax, eax
		jz	short loc_4036F2

loc_4036ED:				; CODE XREF: sub_4036E0+97j
					; sub_4036E0+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4036F2:				; CODE XREF: sub_4036E0+Bj
		xor	eax, eax

loc_4036F4:				; CODE XREF: sub_4036E0+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_403650
		test	eax, eax
		jz	short loc_403780
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_403710
		cmp	dl, 6Dh
		jnz	short loc_403760

loc_403710:				; CODE XREF: sub_4036E0+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40371E
		cmp	dl, 73h
		jnz	short loc_403760

loc_40371E:				; CODE XREF: sub_4036E0+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40372C
		cmp	dl, 76h
		jnz	short loc_403760

loc_40372C:				; CODE XREF: sub_4036E0+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_40373A
		cmp	dl, 63h
		jnz	short loc_403760

loc_40373A:				; CODE XREF: sub_4036E0+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_403748
		cmp	dl, 72h
		jnz	short loc_403760

loc_403748:				; CODE XREF: sub_4036E0+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_403764
		cmp	dl, 74h
		jz	short loc_403764
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_403764
		xchg	ax, ax

loc_403760:				; CODE XREF: sub_4036E0+2Ej
					; sub_4036E0+3Cj ...
		mov	eax, ebx
		jmp	short loc_4036F4
; ---------------------------------------------------------------------------

loc_403764:				; CODE XREF: sub_4036E0+6Fj
					; sub_4036E0+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_407070, eax
		jnz	loc_4036ED
		lea	esi, [esi+0]

loc_403780:				; CODE XREF: sub_4036E0+21j
		mov	[esp+1Ch+lpModuleName],	offset LibFileName ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_407070, eax
		jmp	loc_4036ED
sub_4036E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4037A0	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_4037A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4037B0()
sub_4037B0	proc near		; DATA XREF: sub_403830:loc_403802o
		sub	esp, 0Ch
		mov	eax, off_40500C
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4037D7
		xchg	ax, ax

loc_4037C0:				; CODE XREF: sub_4037B0+25j
		call	eax
		mov	eax, off_40500C
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_40500C, edx
		test	eax, eax
		jnz	short loc_4037C0

loc_4037D7:				; CODE XREF: sub_4037B0+Cj
		add	esp, 0Ch
		retn
sub_4037B0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_403830

loc_4037E0:				; CODE XREF: sub_403830+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_404070
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_403813

loc_4037EF:				; CODE XREF: sub_403830-9j
		test	ebx, ebx
		jz	short loc_403802

loc_4037F3:				; CODE XREF: sub_403830-30j
		call	ds:dword_404070[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_4037F3

loc_403802:				; CODE XREF: sub_403830-3Fj
		mov	[esp+1Ch+var_1C], offset sub_4037B0 ; _onexit_t
		call	sub_402C10
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403813:				; CODE XREF: sub_403830-43j
		xor	ebx, ebx
		jmp	short loc_403819
; ---------------------------------------------------------------------------

loc_403817:				; CODE XREF: sub_403830-Bj
		mov	ebx, eax

loc_403819:				; CODE XREF: sub_403830-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_404070[eax*4]
		test	edx, edx
		jnz	short loc_403817
		jmp	short loc_4037EF
; END OF FUNCTION CHUNK	FOR sub_403830
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403830	proc near		; CODE XREF: sub_401180+239p
					; sub_403DE0+12p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 004037E0 SIZE 00000049 BYTES

		mov	ecx, ds:dword_407074
		test	ecx, ecx
		jz	short loc_403840
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_403840:				; CODE XREF: sub_403830+8j
		mov	ds:dword_407074, 1
		jmp	short loc_4037E0
sub_403830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403850	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_405018
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_4038A0
		not	eax
		mov	dword_40501C, eax

loc_403886:				; CODE XREF: sub_403850+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4038A0:				; CODE XREF: sub_403850+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_403912

loc_403902:				; CODE XREF: sub_403850+CCj
		mov	dword_405018, ebp
		mov	dword_40501C, eax
		jmp	loc_403886
; ---------------------------------------------------------------------------

loc_403912:				; CODE XREF: sub_403850+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_403902
sub_403850	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_407144, edx
		mov	ds:dword_407360, 0C0000409h
		mov	ds:dword_407364, 1
		mov	ds:dword_407138, eax
		mov	ds:dword_40736C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_40712C, eax
		mov	eax, dword_405018
		mov	[ebp-10h], eax
		mov	eax, dword_40501C
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_406680
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4039B0	proc near		; CODE XREF: sub_403B50+79p
					; sub_403B50:loc_403BE2p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_4073DC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_403A05
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_4039E0:				; CODE XREF: sub_4039B0+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_4039FE
		test	esi, esi
		jz	short loc_4039FE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_4039FE:				; CODE XREF: sub_4039B0+40j
					; sub_4039B0+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_4039E0

loc_403A05:				; CODE XREF: sub_4039B0+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4039B0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_4073C0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_403A44

loc_403A36:				; CODE XREF: .text:00403AACj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_403A44:				; CODE XREF: .text:00403A34j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_403AA7
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_4073DC
		mov	ds:dword_4073DC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_403AA7:				; CODE XREF: .text:00403A5Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_403A36
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_4073C0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_403AC8
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403AC8:				; CODE XREF: .text:00403ABFj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_4073DC
		sub	esp, 4
		test	edx, edx
		jz	short loc_403AFF
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_403AF8
		jmp	short loc_403B36
; ---------------------------------------------------------------------------
		align 10h

loc_403AF0:				; CODE XREF: .text:00403AFDj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_403B16
		mov	edx, eax

loc_403AF8:				; CODE XREF: .text:00403AE6j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_403AF0

loc_403AFF:				; CODE XREF: .text:00403AE0j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_403B0F:				; CODE XREF: .text:00403B34j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403B16:				; CODE XREF: .text:00403AF4j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_403B1C:				; CODE XREF: .text:00403B40j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_403B0F
; ---------------------------------------------------------------------------

loc_403B36:				; CODE XREF: .text:00403AE8j
		mov	eax, [edx+8]
		mov	ds:dword_4073DC, eax
		mov	eax, edx
		jmp	short loc_403B1C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403B50	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_403BA0
		jb	short loc_403B70
		cmp	eax, 3
		jz	short loc_403BC0

loc_403B63:				; CODE XREF: sub_403B50+31j
					; sub_403B50+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403B70:				; CODE XREF: sub_403B50+Cj
		mov	eax, ds:dword_4073C0
		test	eax, eax
		jnz	short loc_403BE2

loc_403B79:				; CODE XREF: sub_403B50+97j
		mov	eax, ds:dword_4073C0
		cmp	eax, 1
		jnz	short loc_403B63
		mov	ds:dword_4073C0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_403B63
; ---------------------------------------------------------------------------
		align 10h

loc_403BA0:				; CODE XREF: sub_403B50+Aj
		mov	eax, ds:dword_4073C0
		test	eax, eax
		jz	short loc_403BD0

loc_403BA9:				; CODE XREF: sub_403B50+90j
		mov	ds:dword_4073C0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403BC0:				; CODE XREF: sub_403B50+11j
		mov	eax, ds:dword_4073C0
		test	eax, eax
		jz	short loc_403B63
		call	sub_4039B0
		jmp	short loc_403B63
; ---------------------------------------------------------------------------

loc_403BD0:				; CODE XREF: sub_403B50+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_403BA9
; ---------------------------------------------------------------------------

loc_403BE2:				; CODE XREF: sub_403B50+27j
		call	sub_4039B0
		jmp	short loc_403B79
sub_403B50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403BF0	proc near		; CODE XREF: sub_401180+19p
					; sub_401F00+Ap ...

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_403C12

loc_403BFD:				; CODE XREF: sub_403BF0+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_403BFD

loc_403C12:				; CODE XREF: sub_403BF0+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_403BF0	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _setmode]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_403C50
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403C50	proc near		; CODE XREF: sub_401180+A7p
					; .text:00403C41j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_403C50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_403C70(char *, size_t, char *, char)
sub_403C70	proc near		; CODE XREF: sub_401F00+392p

DstBuf		= dword	ptr -1Ch
MaxCount	= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 1Ch
		lea	eax, [esp+1Ch+arg_C]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+Format], eax ;	Format
		mov	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+MaxCount], eax	; MaxCount
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+DstBuf], eax ;	DstBuf
		call	_vsnprintf
		add	esp, 1Ch
		retn
sub_403C70	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fgets]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION feof]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _vsnprintf]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_403DA0	proc near		; CODE XREF: sub_403DE0:loc_40400Ap

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h

		sub	esp, 1Ch
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 28h ; Count
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aUsageSha1sumC0 ;	"usage:	sha1sum	[-c|-0]	[--] FILENAMES|-"...
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	[esp+1Ch+Str], 1 ; Code
		call	exit
sub_403DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403DE0	proc near		; CODE XREF: sub_401180+265p

Str1		= dword	ptr -2Ch
Str2		= dword	ptr -28h
Count		= dword	ptr -24h
File		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 20h
		mov	ebx, [ebp+arg_0]
		mov	esi, [ebp+arg_4]
		call	sub_403830
		mov	ds:dword_407020, 0
		test	ebx, ebx
		jz	loc_403F67
		sub	ebx, 1
		lea	edi, [esi+4]
		mov	[esp+2Ch+var_10], ebx
		jz	loc_403F65
		mov	ebx, [esi+4]
		mov	[esp+2Ch+Str2],	(offset	off_406208+6Ch)	; Str2
		mov	[esp+2Ch+Str1],	ebx ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_40400F
		cmp	byte ptr [ebx],	2Dh
		jnz	loc_403F71
		cmp	byte ptr [ebx+1], 0
		jz	loc_403F71
		mov	[esp+2Ch+var_18], 0
		mov	edx, edi
		mov	[esp+2Ch+var_14], 0
		jmp	short loc_403E93
; ---------------------------------------------------------------------------
		align 10h

loc_403E60:				; CODE XREF: sub_403DE0+C1j
		mov	edi, (offset off_406208+171h)
		mov	esi, ebx
		mov	ecx, 3
		repe cmpsb
		jnz	loc_403FDC
		add	edx, 4
		sub	[esp+2Ch+var_10], 1
		mov	[esp+2Ch+var_18], 1
		jz	short loc_403EB5

loc_403E86:				; CODE XREF: sub_403DE0+D3j
		mov	ebx, [edx]
		cmp	byte ptr [ebx],	2Dh
		jnz	short loc_403EB5
		cmp	byte ptr [ebx+1], 0
		jz	short loc_403EB5

loc_403E93:				; CODE XREF: sub_403DE0+79j
		mov	esi, ebx
		mov	edi, (offset off_406208+16Eh)
		mov	ecx, 3
		repe cmpsb
		jnz	short loc_403E60
		add	edx, 4
		sub	[esp+2Ch+var_10], 1
		mov	[esp+2Ch+var_14], 1
		jnz	short loc_403E86

loc_403EB5:				; CODE XREF: sub_403DE0+A4j
					; sub_403DE0+ABj ...
		mov	edi, edx

loc_403EB7:				; CODE XREF: sub_403DE0+21Aj
		mov	eax, [esp+2Ch+var_14]
		test	eax, eax
		jnz	loc_403FFF

loc_403EC3:				; CODE XREF: sub_403DE0+1A1j
					; sub_403DE0+224j
		mov	eax, [esp+2Ch+var_10]
		test	eax, eax
		jz	loc_40400A
		mov	eax, [esp+2Ch+var_18]
		xor	ebx, ebx
		mov	esi, 1
		test	eax, eax
		jz	short loc_403F4D
		cmp	[esp+2Ch+var_10], 1
		jnz	loc_40400A
		mov	[esp+2Ch+Str2],	(offset	off_406208+177h) ; Str2
		mov	eax, [edi]
		mov	[esp+2Ch+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_40400A
		call	sub_4024E0
		xor	ebx, ebx
		test	eax, eax
		setnz	bl

loc_403F0F:				; CODE XREF: sub_403DE0+16Bj
		mov	eax, [esp+2Ch+var_14]
		test	eax, eax
		jz	short loc_403F2D
		mov	eax, ds:dword_407024
		test	eax, eax
		jnz	loc_403FB1

loc_403F24:				; CODE XREF: sub_403DE0+1F7j
		mov	eax, ds:dword_40702C
		test	eax, eax
		jnz	short loc_403F86

loc_403F2D:				; CODE XREF: sub_403DE0+135j
					; sub_403DE0+1CCj
		lea	esp, [ebp-0Ch]
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_403F37:				; CODE XREF: sub_403DE0+173j
		mov	eax, [edi]
		call	sub_402620
		test	eax, eax
		cmovnz	ebx, esi

loc_403F43:				; CODE XREF: sub_403DE0+183j
		add	edi, 4
		sub	[esp+2Ch+var_10], 1
		jz	short loc_403F0F

loc_403F4D:				; CODE XREF: sub_403DE0+FCj
		mov	eax, [esp+2Ch+var_14]
		test	eax, eax
		jnz	short loc_403F37
		mov	eax, [edi]
		xor	edx, edx
		call	sub_401F00
		test	eax, eax
		cmovnz	ebx, esi
		jmp	short loc_403F43
; ---------------------------------------------------------------------------

loc_403F65:				; CODE XREF: sub_403DE0+33j
		mov	esi, edi

loc_403F67:				; CODE XREF: sub_403DE0+23j
		mov	edi, esi
		mov	[esp+2Ch+var_10], 0

loc_403F71:				; CODE XREF: sub_403DE0+57j
					; sub_403DE0+61j
		mov	[esp+2Ch+var_18], 0
		mov	[esp+2Ch+var_14], 0
		jmp	loc_403EC3
; ---------------------------------------------------------------------------

loc_403F86:				; CODE XREF: sub_403DE0+14Bj
		mov	[esp+2Ch+Count], eax
		mov	eax, ds:_iob
		mov	edx, ds:dword_407030
		mov	[esp+2Ch+Str2],	(offset	off_406208+1B8h) ; Format
		add	eax, 40h
		mov	[esp+2Ch+File],	edx
		mov	[esp+2Ch+Str1],	eax ; File
		call	fprintf
		jmp	loc_403F2D
; ---------------------------------------------------------------------------

loc_403FB1:				; CODE XREF: sub_403DE0+13Ej
		mov	[esp+2Ch+Count], eax
		mov	eax, ds:_iob
		mov	edx, ds:dword_407028
		mov	[esp+2Ch+Str2],	(offset	off_406208+17Ch) ; Format
		add	eax, 40h
		mov	[esp+2Ch+File],	edx
		mov	[esp+2Ch+Str1],	eax ; File
		call	fprintf
		jmp	loc_403F24
; ---------------------------------------------------------------------------

loc_403FDC:				; CODE XREF: sub_403DE0+8Ej
		mov	[esp+2Ch+Str2],	(offset	off_406208+174h) ; Str2
		mov	edi, edx
		mov	[esp+2Ch+Str1],	ebx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40400A
		sub	[esp+2Ch+var_10], 1
		add	edi, 4
		jmp	loc_403EB7
; ---------------------------------------------------------------------------

loc_403FFF:				; CODE XREF: sub_403DE0+DDj
		cmp	[esp+2Ch+var_18], 0
		jz	loc_403EC3

loc_40400A:				; CODE XREF: sub_403DE0+E9j
					; sub_403DE0+103j ...
		call	sub_403DA0
; ---------------------------------------------------------------------------

loc_40400F:				; CODE XREF: sub_403DE0+4Ej
		mov	eax, ds:_iob
		mov	[esp+2Ch+Count], 0F5h ;	Count
		mov	[esp+2Ch+Str2],	1 ; Size
		mov	[esp+2Ch+Str1],	(offset	off_406208+78h)	; Str
		add	eax, 20h
		mov	[esp+2Ch+File],	eax ; File
		call	fwrite
		mov	[esp+2Ch+Str1],	0 ; Code
		call	exit
sub_403DE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404050	proc near		; DATA XREF: .text:00404074o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_402C10
		leave
		retn
sub_404050	endp

; ---------------------------------------------------------------------------
		align 10h
dword_404070	dd 0FFFFFFFFh		; DATA XREF: sub_403830-4Cr
					; sub_403830:loc_4037F3r ...
		dd offset sub_404050
		dd 0
		dd 0FFFFFFFFh
dword_404080	dd 60h dup(0)		; DATA XREF: .data:off_40500Co
		dd 380h	dup(?)
_text		ends

; Section 2. (virtual address 00005000)
; Virtual size			: 00000024 (	 36.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00003600
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 405000h
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_40500C	dd offset dword_404080	; DATA XREF: sub_4037B0+3r
					; sub_4037B0+12r ...
dword_405010	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_405014	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_405018	dd 0BB40E64Eh		; DATA XREF: sub_403850+3r
					; sub_403850:loc_403902w ...
dword_40501C	dd 44BF19B1h		; DATA XREF: sub_403850+31w
					; sub_403850+B8w ...
dword_405020	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00006000)
; Virtual size			: 00000688 (   1672.)
; Section size in file		: 00000800 (   2048.)
; Offset to raw	data for section: 00003800
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 406000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
aUsageSha1sumC0	db 'usage: sha1sum [-c|-0] [--] FILENAMES|-',0Ah,0
					; DATA XREF: sub_403DA0+18o
asc_40606D	db '\',0                ; DATA XREF: sub_401F00+4A0o
byte_40606F	db 0			; DATA XREF: sub_401F00+49Bo
; char Mode[]
Mode		db 'rb',0               ; DATA XREF: sub_401F00:loc_401F2Do
; char aMd5sumCanTOpen[]
aMd5sumCanTOpen	db 'md5sum: can',27h,'t open `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_401F00+567o
					; sub_402620+2EFo
; char aSFailedOpen[]
aSFailedOpen	db '%s: FAILED open',0Ah,0 ; DATA XREF: sub_401F00+58Fo
		align 4
; char aMd5sumErrorRea[]
aMd5sumErrorRea	db 'md5sum: error reading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_401F00+4DDo
					; sub_402620+163o
; char aSFailedRead[]
aSFailedRead	db '%s: FAILED read',0Ah,0 ; DATA XREF: sub_401F00+519o
		align 4
; char aMd5sumCanTAllo[]
aMd5sumCanTAllo	db 'md5sum: can',27h,'t allocate buffer: %s',0Ah,0
					; DATA XREF: sub_401F00+5ADo
; char a02x[]
a02x		db '%02x',0             ; DATA XREF: sub_401F00+375o
; char aSFailed[]
aSFailed	db '%s: FAILED',0Ah,0   ; DATA XREF: sub_401F00:loc_402436o
; char Format[]
Format		db '%s: OK',0Ah,0       ; DATA XREF: sub_401F00+3C8o
; char aSSS[]
aSSS		db '%s%s  %s',0Ah,0     ; DATA XREF: sub_401F00+4B4o
aStdin		db '[stdin]',0          ; DATA XREF: sub_4024E0+CCo
					; sub_4024E0+109o
		align 4
; char aMd5sumErrorR_1[]
aMd5sumErrorR_1	db 'md5sum:error reading `%s',27h,' at offset %lu: %s',0Ah,0
					; DATA XREF: sub_4024E0+111o
		align 4
; char aMd5sumErrorR_0[]
aMd5sumErrorR_0	db 'md5sum: error reading `%s',27h,': filename at offset %lu too long',0Ah,0
					; DATA XREF: sub_4024E0+D4o
aLastLinefeedMi	db 'last linefeed missing',0 ; DATA XREF: sub_402620+15Eo
aLineTooLong	db 'line too long',0    ; DATA XREF: sub_402620+16Do
; char aR[]
aR		db 'r',0                ; DATA XREF: sub_402620+29o
aInvalidLine	db 'invalid line',0     ; DATA XREF: sub_402620+C0o
; char aMd5sumErrorPar[]
aMd5sumErrorPar	db 'md5sum: error parsing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_402620+C8o
; char aMd5sumErrorR_2[]
aMd5sumErrorR_2	db 'md5sum:error reading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_402620+258o
		align 4
off_406208	dd offset loc_4028F4, offset loc_40284C, offset	loc_40284C
					; DATA XREF: sub_402620+296r
		dd offset loc_40284C, offset loc_40284C, offset	loc_40284C ; jump table	for switch statement
		dd offset loc_4028E9, offset loc_40284C, offset	loc_40284C
		dd offset loc_40284C, offset loc_4028DE, offset	loc_40284C
		dd offset loc_40284C, offset loc_40284C, offset	loc_40284C
		dd offset loc_40284C, offset loc_40284C, offset	loc_40284C
		dd offset loc_4028D3, offset loc_40284C, offset	loc_40284C
		dd offset loc_40284C, offset loc_4028C8, offset	loc_40284C
		dd offset loc_40284C, offset loc_40284C, offset	loc_4028BD
		dd 65762D2Dh, 6F697372h, 6Eh, 7335646Dh, 31206D75h, 430A322Eh
		dd 7279706Fh, 74686769h, 29432820h, 30303220h, 31672039h
		dd 6F432030h, 47206564h, 0A48626Dh, 6563694Ch, 2065736Eh
		dd 764C5047h, 203A2B33h, 20554E47h, 204C5047h, 73726576h
		dd 206E6F69h, 726F2033h, 74616C20h, 3C207265h, 70747468h
		dd 672F2F3Ah, 6F2E756Eh, 6C2F6772h, 6E656369h, 2F736573h
		dd 2E6C7067h, 6C6D7468h, 540A2E3Eh, 20736968h, 66207369h
		dd 20656572h, 74666F73h, 65726177h, 6F79203Ah, 72612075h
		dd 72662065h, 74206565h, 6863206Fh, 65676E61h, 646E6120h
		dd 64657220h, 72747369h, 74756269h, 74692065h, 68540A2Eh
		dd 20657265h, 4E207369h, 4157204Fh, 4E415252h, 202C5954h
		dd 74206F74h, 65206568h, 6E657478h, 65702074h, 74696D72h
		dd 20646574h, 6C207962h, 0A2E7761h, 632D000Ah, 302D00h
		dd 2D002D2Dh, 0, 7335646Dh, 203A6D75h, 4E524157h, 3A474E49h
		dd 20752520h, 2520666Fh, 696C2075h, 64657473h, 6C696620h
		dd 63207365h, 646C756Fh, 746F6E20h, 20656220h, 64616572h
		dd 0Ah,	7335646Dh, 203A6D75h, 4E524157h, 3A474E49h, 20752520h
		dd 2520666Fh, 6F632075h, 7475706Dh, 63206465h, 6B636568h
		dd 736D7573h, 64696420h, 544F4E20h, 74616D20h, 0A6863h
		dd 676E696Dh, 30316D77h, 6C6C642Eh, 6D5F5F00h, 77676E69h
		dd 5F726874h, 6F6D6572h, 6B5F6576h, 645F7965h, 726F74h
		dd 696D5F5Fh, 7477676Eh, 6B5F7268h, 645F7965h, 726F74h
		dd offset TlsCallback_0, 6E6B6E55h, 206E776Fh, 6F727265h
		dd 72h,	74616D5Fh, 72726568h, 203A2928h, 69207325h, 7325206Eh
		dd 2C672528h, 29672520h, 72282020h, 61767465h, 67253D6Ch
		dd 0A29h, 75677241h, 746E656Dh,	6D6F6420h, 206E6961h, 6F727265h
		dd 44282072h, 49414D4Fh, 4100294Eh, 6D756772h, 20746E65h
		dd 676E6973h, 72616C75h, 20797469h, 47495328h, 294Eh, 7265764Fh
		dd 776F6C66h, 6E617220h, 65206567h, 726F7272h, 564F2820h
		dd 4C465245h, 29574Fh, 20656854h, 75736572h, 6920746Ch
		dd 6F742073h, 6D73206Fh, 206C6C61h, 62206F74h, 65722065h
		dd 73657270h, 65746E65h, 55282064h, 5245444Eh, 574F4C46h
		dd 29h,	61746F54h, 6F6C206Ch, 6F207373h, 69732066h, 66696E67h
		dd 6E616369h, 28206563h, 534F4C54h, 2953h, 74726150h, 206C6169h
		dd 73736F6Ch, 20666F20h, 6E676973h, 63696669h, 65636E61h
		dd 4C502820h, 2953534Fh, 0, offset off_406208+270h, offset off_406208+28Fh
		dd offset off_406208+2ACh, offset off_406208+2CCh, offset off_406208+304h
		dd offset off_406208+328h, 676E694Dh, 36772D77h, 75722034h
		dd 6D69746Eh, 61662065h, 72756C69h, 0A3A65h, 72646441h
		dd 20737365h, 68207025h, 6E207361h, 6D69206Fh, 2D656761h
		dd 74636573h, 6E6F69h, 69562020h, 61757472h, 6575516Ch
		dd 66207972h, 656C6961h, 6F662064h, 64252072h, 74796220h
		dd 61207365h, 64612074h, 73657264h, 70252073h, 0, 69562020h
		dd 61757472h, 6F72506Ch, 74636574h, 69616620h, 2064656Ch
		dd 68746977h, 646F6320h, 78302065h, 7825h
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_403130+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_403130+1B7o
		align 4
; const	WCHAR LibFileName
LibFileName:				; DATA XREF: sub_4036E0:loc_403780o
		unicode	0, <msvcrt.dll>,0
		align 10h
off_406680	dd offset dword_407360	; DATA XREF: .text:00403978o
		dd offset dword_407080
dword_406688	dd 0			; DATA XREF: sub_403130+59o
					; sub_403130+5Eo ...
dword_40668C	dd 0			; DATA XREF: sub_403130+7Fr
dword_406690	dd 0			; DATA XREF: sub_403130:loc_40327Cr
dword_406694	dd 5Bh dup(0)		; DATA XREF: sub_403130+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00007000)
; Virtual size			: 0000041C (   1052.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 407000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_407000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_407004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_407008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_40700C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_407010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_407014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_407018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_40701C	dd ?			; DATA XREF: sub_401010+3Aw
dword_407020	dd ?			; DATA XREF: sub_401550+32r
					; sub_403DE0+17w
dword_407024	dd ?			; DATA XREF: sub_401F00:loc_402425w
					; sub_403DE0+137r
dword_407028	dd ?			; DATA XREF: sub_401F00+18w
					; sub_403DE0+1DAr
dword_40702C	dd ?			; DATA XREF: sub_401F00+547w
					; sub_403DE0:loc_403F24r
dword_407030	dd ?			; DATA XREF: sub_401F00:loc_402263w
					; sub_403DE0+1AFr
dword_407034	dd ?			; DATA XREF: sub_401010+3r
dword_407038	dd ?			; DATA XREF: sub_401010+25r
dword_40703C	dd ?			; DATA XREF: sub_401060+22w
dword_407040	dd ?			; DATA XREF: sub_401060+18w
dword_407044	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_407050	dd ?			; DATA XREF: sub_401060+2Cw
dword_407054	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_407058	dd ?			; DATA XREF: sub_401060+5Er
dword_40705C	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_402C9Cr
dword_407060	dd ?			; DATA XREF: .text:00402DC3r
					; sub_402E10+4w
dword_407064	dd ?			; DATA XREF: sub_403130+9r
					; sub_403130:loc_403150w
dword_407068	dd ?			; DATA XREF: sub_402EF0+1Dr
					; sub_402EF0+58r ...
dword_40706C	dd ?			; DATA XREF: sub_402EF0+Br
					; sub_402EF0:loc_402FAFw ...
dword_407070	dd ?			; DATA XREF: sub_4036E0+4r
					; sub_4036E0+92w ...
dword_407074	dd ?			; DATA XREF: sub_403830r
					; sub_403830:loc_403840w
		align 10h
dword_407080	dd 2Bh dup(?)		; DATA XREF: .rdata:00406684o
dword_40712C	dd ?			; DATA XREF: .text:0040395Aw
		dd 2 dup(?)
dword_407138	dd ?			; DATA XREF: .text:00403946w
		dd 2 dup(?)
dword_407144	dd ?			; DATA XREF: .text:0040392Cw
		dd 86h dup(?)
dword_407360	dd ?			; DATA XREF: .text:00403932w
					; .rdata:off_406680o
dword_407364	dd ?			; DATA XREF: .text:0040393Cw
		dd ?
dword_40736C	dd ?			; DATA XREF: .text:0040394Bw
		dd 14h dup(?)
dword_4073C0	dd ?			; DATA XREF: .text:00403A23r
					; .text:00403AB4r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_4039B0+7o
					; sub_4039B0:loc_403A05o ...
dword_4073DC	dd ?			; DATA XREF: sub_4039B0+14r
					; .text:00403A78r ...
		dd ?
dword_4073E4	dd ?			; DATA XREF: sub_401180+1A8w
dword_4073E8	dd ?			; DATA XREF: sub_401180+1BFw
dword_4073EC	dd ?			; DATA XREF: sub_401180+1B2w
dword_4073F0	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_402A83w ...
dword_4073F4	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_4073F8	dd ?			; DATA XREF: TlsCallback_0:loc_4029D4w
dword_4073FC	dd ?			; DATA XREF: sub_401060+64w
					; sub_402B50+3Fr ...
dword_407400	dd ?			; DATA XREF: sub_401060+69w
					; sub_402B50+4r ...
dword_407404	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_407408	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 1000h
_bss		ends

;
; Imports from KERNEL32.dll
;
; Section 5. (virtual address 00008000)
; Virtual size			: 00000754 (   1876.)
; Section size in file		: 00000800 (   2048.)
; Offset to raw	data for section: 00004000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_403B50+44p
					; DATA XREF: sub_403B50+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_4039B0+Ep
					; .text:00403A72p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:00403988p
					; DATA XREF: .text:00403988r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_403850+6Cp
					; DATA XREF: sub_403850+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_403850+74p
					; DATA XREF: sub_403850+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_402EF0+1CCp
					; sub_4039B0+3Cp
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_4036E0+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_403850+57p
					; DATA XREF: sub_403850+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_403850+7Cp
					; DATA XREF: sub_403850+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_403B50+87p
					; DATA XREF: sub_403B50+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_4039B0+5Cp
					; .text:00403A90p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: TlsCallback_0+55p
					; DATA XREF: TlsCallback_0+55r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_4036E0+A7p
					; DATA XREF: sub_4036E0+A7r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_403850+8Bp
					; DATA XREF: sub_403850+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0040396Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00403999p
					; DATA XREF: .text:00403999r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_4039B0+35p
					; DATA XREF: sub_4039B0+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0040397Fp
					; DATA XREF: .text:0040397Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_402EF0+142p
					; sub_402EF0+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_402EF0+A1p
					; sub_402EF0+D9p ...

;
; Imports from msvcrt.dll
;
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__setmode:dword ; DATA XREF:	_setmoder

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_402B20r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_401F00:loc_4023C9p
					; sub_401F00:loc_402453p ...
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
; FILE *iob
		extrn _iob:dword	; DATA XREF: sub_401F00+2AAr
					; sub_401F00+473r ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_402B50+A3p
					; DATA XREF: sub_402B50+A3r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
; int __cdecl _vsnprintf(char *DstBuf, size_t MaxCount,	const char *Format, va_list ArgList)
		extrn __imp__vsnprintf:dword ; DATA XREF: _vsnprintfr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl feof(FILE	*File)
		extrn __imp_feof:dword	; DATA XREF: feofr
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; char *__cdecl	fgets(char *Buf, int MaxCount, FILE *File)
		extrn __imp_fgets:dword	; DATA XREF: fgetsr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr


; Section 6. (virtual address 00009000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00004800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 409000h
dword_409000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_409008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_40900C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_402B20
dword_409018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
					; jumptable 004028B6 case 140
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_409030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_402AC3o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 0000A000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00004A00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 40A000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
