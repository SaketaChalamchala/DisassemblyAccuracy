;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	84C423E80C011D4E5170BA9565C2A415
; Input	CRC32 :	3E844A7D

; File Name   :	C:\compspace\compare\gpg\dlls\original\gpgme-w32spawn.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00002824 (  10276.)
; Section size in file		: 00002A00 (  10752.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00408004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_406028
		mov	[esp+2Ch+var_1C], offset dword_406018
		mov	[esp+2Ch+var_24], offset dword_40600C
		mov	[esp+2Ch+var_28], offset dword_406008
		mov	ds:dword_406018, eax
		mov	eax, ds:dword_40602C
		mov	[esp+2Ch+var_2C], offset dword_406004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_40601C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00408010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_406038, 1
		mov	ds:dword_406034, 1
		mov	ds:dword_406030, 1
		mov	ds:dword_406044, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_406014, eax
		mov	eax, ds:dword_406048
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_4025B0
		mov	edx, ds:dword_40604C
		mov	ds:dword_4063FC, eax
		mov	ds:dword_406400, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_4028F0
		cmp	dword_404014, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_402890
		call	sub_402880
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_403660
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_406048
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_406404
		call	sub_4036D0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_406408
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_406408
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_406000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_406408
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_406404

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_405248
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_402BA0
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_406050, eax
		call	sub_403150
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_403210
		mov	eax, ds:dword_406048
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_4063E4, eax
		mov	eax, 0Ah
		mov	ds:dword_4063EC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_4063E8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_406004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_406008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_406008, eax
		call	sub_4032A0
		mov	eax, ds:__initenv
		mov	edx, ds:dword_40600C
		mov	[eax], edx
		mov	eax, ds:dword_40600C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_406008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_406004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_40223C
		mov	esi, ds:dword_406014
		test	esi, esi
		mov	ds:dword_406010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_406000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_406010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_406408
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_406408
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_408008
		mov	[esp+88h+dwMilliseconds], offset dword_408000
		call	_initterm
		mov	ds:dword_406408, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_406408, 1
		mov	[esp+88h+lpProcName], offset dword_408018
		mov	[esp+88h+dwMilliseconds], offset dword_40800C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_406048, 1
		call	sub_4032C0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_406048, 0
		call	sub_4032C0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_4037F0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_404020
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_404020
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_4037F0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_401677+E4p

Size		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_4015AC
; ---------------------------------------------------------------------------

loc_401566:				; CODE XREF: sub_401550+69j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		add	[ebp+var_10], 1
		jmp	short loc_40159A
; ---------------------------------------------------------------------------

loc_40157A:				; CODE XREF: sub_401550+52j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_40158E
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_401592

loc_40158E:				; CODE XREF: sub_401550+32j
		add	[ebp+var_10], 1

loc_401592:				; CODE XREF: sub_401550+3Cj
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1

loc_40159A:				; CODE XREF: sub_401550+28j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40157A
		add	[ebp+var_10], 2
		add	[ebp+var_C], 1

loc_4015AC:				; CODE XREF: sub_401550+14j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_401566
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4015E3
		mov	eax, 0
		jmp	locret_401675
; ---------------------------------------------------------------------------

loc_4015E3:				; CODE XREF: sub_401550+87j
		mov	[ebp+var_C], 0
		jmp	short loc_401659
; ---------------------------------------------------------------------------

loc_4015EC:				; CODE XREF: sub_401550+116j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	22h
		add	[ebp+var_14], 1
		jmp	short loc_401637
; ---------------------------------------------------------------------------

loc_401606:				; CODE XREF: sub_401550+EFj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_40161A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_401624

loc_40161A:				; CODE XREF: sub_401550+BEj
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_14], 1

loc_401624:				; CODE XREF: sub_401550+C8j
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		add	[ebp+var_18], 1

loc_401637:				; CODE XREF: sub_401550+B4j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401606
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	22h
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	20h
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_401659:				; CODE XREF: sub_401550+9Aj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4015EC
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_1C]

locret_401675:				; CODE XREF: sub_401550+8Ej
		leave
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401677	proc near		; CODE XREF: sub_40223C+8Fp

hProcess	= dword	ptr -0D8h
Format		= dword	ptr -0D4h
dwShareMode	= dword	ptr -0D0h
lpSecurityAttributes= dword ptr	-0CCh
dwCreationDisposition= dword ptr -0C8h
dwFlagsAndAttributes= dword ptr	-0C4h
hTemplateFile	= dword	ptr -0C0h
lpCurrentDirectory= dword ptr -0BCh
lpStartupInfo	= dword	ptr -0B8h
lpProcessInformation= dword ptr	-0B4h
SecurityAttributes= _SECURITY_ATTRIBUTES ptr -0A0h
StartupInfo	= _STARTUPINFOA	ptr -94h
ProcessInformation= _PROCESS_INFORMATION ptr -50h
ProcessAttributes= _SECURITY_ATTRIBUTES	ptr -40h
var_34		= dword	ptr -34h
hModule		= dword	ptr -30h
Memory		= dword	ptr -2Ch
var_28		= dword	ptr -28h
dwCreationFlags	= dword	ptr -24h
lpEnvironment	= dword	ptr -20h
hObject		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0D0h
		mov	[ebp+ProcessInformation.hProcess], 0
		mov	[ebp+ProcessInformation.hThread], 0
		mov	[ebp+ProcessInformation.dwProcessId], 0
		mov	[ebp+ProcessInformation.dwThreadId], 0
		mov	[ebp+lpEnvironment], 0
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+0D8h+hProcess], eax ; hProcess
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, 4000000h
		mov	[ebp+dwCreationFlags], eax
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+hObject], 0FFFFFFFFh
		mov	[ebp+var_28], 0
		mov	[ebp+var_C], 0
		jmp	short loc_401721
; ---------------------------------------------------------------------------

loc_4016ED:				; CODE XREF: sub_401677+B7j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset Format ; "gpgme-w32spawn: argv[%2i]	= %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0D8h+lpSecurityAttributes], edx
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+dwShareMode],	edx
		mov	[esp+0D8h+Format], eax ; Format
		mov	[esp+0D8h+hProcess], ecx ; File
		call	fprintf
		add	[ebp+var_C], 1

loc_401721:				; CODE XREF: sub_401677+74j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4016ED
		lea	eax, [ebp+ProcessAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+ProcessAttributes.nLength], 0Ch
		mov	[ebp+ProcessAttributes.bInheritHandle],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+hProcess], eax
		call	sub_401550
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_401773
		mov	eax, 0FFFFFFFFh
		jmp	loc_401BC9
; ---------------------------------------------------------------------------

loc_401773:				; CODE XREF: sub_401677+F0j
		lea	eax, [ebp+StartupInfo]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+StartupInfo.cb], 44h
		mov	[ebp+StartupInfo.dwFlags], 101h
		cmp	[ebp+var_28], 0
		jz	short loc_4017A9
		mov	eax, 5
		jmp	short loc_4017AE
; ---------------------------------------------------------------------------

loc_4017A9:				; CODE XREF: sub_401677+129j
		mov	eax, 0

loc_4017AE:				; CODE XREF: sub_401677+130j
		mov	[ebp+StartupInfo.wShowWindow], ax
		mov	[esp+0D8h+hProcess], 0FFFFFFF6h	; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+StartupInfo.hStdInput], eax
		mov	[esp+0D8h+hProcess], 0FFFFFFF5h	; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+StartupInfo.hStdOutput], eax
		mov	[esp+0D8h+hProcess], 0FFFFFFF4h	; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+StartupInfo.hStdError], eax
		mov	eax, offset aGpgmeW32spawnS ; "gpgme-w32spawn: spawning: %s\n"
		mov	edx, ds:_iob
		lea	ecx, [edx+40h]
		mov	edx, [ebp+Memory]
		mov	[esp+0D8h+dwShareMode],	edx
		mov	[esp+0D8h+Format], eax ; Format
		mov	[esp+0D8h+hProcess], ecx ; File
		call	fprintf
		mov	[ebp+var_C], 0
		jmp	loc_401918
; ---------------------------------------------------------------------------

loc_40181B:				; CODE XREF: sub_401677+2AFj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_401870
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[ebp+StartupInfo.hStdInput], eax
		mov	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		mov	eax, offset aGpgmeW32spawnD ; "gpgme-w32spawn: dup 0x%x	to stdin\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0D8h+dwShareMode],	edx
		mov	[esp+0D8h+Format], eax ; Format
		mov	[esp+0D8h+hProcess], ecx ; File
		call	fprintf
		jmp	loc_401914
; ---------------------------------------------------------------------------

loc_401870:				; CODE XREF: sub_401677+1B2j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		cmp	eax, 1
		jnz	short loc_4018C3
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[ebp+StartupInfo.hStdOutput], eax
		mov	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		mov	eax, offset aGpgmeW32spaw_0 ; "gpgme-w32spawn: dup 0x%x	to stdout\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0D8h+dwShareMode],	edx
		mov	[esp+0D8h+Format], eax ; Format
		mov	[esp+0D8h+hProcess], ecx ; File
		call	fprintf
		jmp	short loc_401914
; ---------------------------------------------------------------------------

loc_4018C3:				; CODE XREF: sub_401677+208j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		cmp	eax, 2
		jnz	short loc_401914
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[ebp+StartupInfo.hStdError], eax
		mov	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		mov	eax, offset aGpgmeW32spaw_1 ; "gpgme-w32spawn:dup 0x%x to stderr\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0D8h+dwShareMode],	edx
		mov	[esp+0D8h+Format], eax ; Format
		mov	[esp+0D8h+hProcess], ecx ; File
		call	fprintf

loc_401914:				; CODE XREF: sub_401677+1F4j
					; sub_401677+24Aj ...
		add	[ebp+var_C], 1

loc_401918:				; CODE XREF: sub_401677+19Fj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	loc_40181B
		cmp	[ebp+var_10], 0
		jz	short loc_401942
		cmp	[ebp+var_14], 0
		jz	short loc_401942
		cmp	[ebp+var_18], 0
		jnz	loc_401A02

loc_401942:				; CODE XREF: sub_401677+2B9j
					; sub_401677+2BFj
		lea	eax, [ebp+SecurityAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+SecurityAttributes.nLength], 0Ch
		mov	[ebp+SecurityAttributes.bInheritHandle], 1
		mov	[esp+0D8h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+0D8h+dwFlagsAndAttributes], 80h ; dwFlagsAndAttributes
		mov	[esp+0D8h+dwCreationDisposition], 3 ; dwCreationDisposition
		lea	eax, [ebp+SecurityAttributes]
		mov	[esp+0D8h+lpSecurityAttributes], eax ; lpSecurityAttributes
		mov	[esp+0D8h+dwShareMode],	3 ; dwShareMode
		mov	[esp+0D8h+Format], 0C0000000h ;	dwDesiredAccess
		mov	[esp+0D8h+hProcess], offset FileName ; "nul"
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jnz	short loc_4019DE
		mov	eax, [ebp+Memory]
		mov	[esp+0D8h+hProcess], eax ; Memory
		call	free
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 5
		mov	eax, 0FFFFFFFFh
		jmp	loc_401BC9
; ---------------------------------------------------------------------------

loc_4019DE:				; CODE XREF: sub_401677+343j
		cmp	[ebp+var_10], 0
		jnz	short loc_4019EA
		mov	eax, [ebp+hObject]
		mov	[ebp+StartupInfo.hStdInput], eax

loc_4019EA:				; CODE XREF: sub_401677+36Bj
		cmp	[ebp+var_14], 0
		jnz	short loc_4019F6
		mov	eax, [ebp+hObject]
		mov	[ebp+StartupInfo.hStdOutput], eax

loc_4019F6:				; CODE XREF: sub_401677+377j
		cmp	[ebp+var_18], 0
		jnz	short loc_401A02
		mov	eax, [ebp+hObject]
		mov	[ebp+StartupInfo.hStdError], eax

loc_401A02:				; CODE XREF: sub_401677+2C5j
					; sub_401677+383j
		or	[ebp+dwCreationFlags], 4
		or	[ebp+dwCreationFlags], 8
		mov	edx, [ebp+dwCreationFlags]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		lea	ecx, [ebp+ProcessInformation]
		mov	[esp+0D8h+lpProcessInformation], ecx ; lpProcessInformation
		lea	ecx, [ebp+StartupInfo]
		mov	[esp+0D8h+lpStartupInfo], ecx ;	lpStartupInfo
		mov	[esp+0D8h+lpCurrentDirectory], 0 ; lpCurrentDirectory
		mov	ecx, [ebp+lpEnvironment]
		mov	[esp+0D8h+hTemplateFile], ecx ;	lpEnvironment
		mov	[esp+0D8h+dwFlagsAndAttributes], edx ; dwCreationFlags
		mov	[esp+0D8h+dwCreationDisposition], 1 ; bInheritHandles
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0D8h+lpSecurityAttributes], edx ; lpThreadAttributes
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0D8h+dwShareMode],	edx ; lpProcessAttributes
		mov	edx, [ebp+Memory]
		mov	[esp+0D8h+Format], edx ; lpCommandLine
		mov	[esp+0D8h+hProcess], eax ; lpApplicationName
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_401A86
		mov	eax, [ebp+Memory]
		mov	[esp+0D8h+hProcess], eax ; Memory
		call	free
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 5
		mov	eax, 0FFFFFFFFh
		jmp	loc_401BC9
; ---------------------------------------------------------------------------

loc_401A86:				; CODE XREF: sub_401677+3EBj
		mov	eax, [ebp+Memory]
		mov	[esp+0D8h+hProcess], eax ; Memory
		call	free
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_401AA7
		mov	eax, [ebp+hObject]
		mov	[esp+0D8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_401AA7:				; CODE XREF: sub_401677+41Ej
		mov	[ebp+var_C], 0
		jmp	short loc_401ACC
; ---------------------------------------------------------------------------

loc_401AB0:				; CODE XREF: sub_401677+463j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+0D8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		add	[ebp+var_C], 1

loc_401ACC:				; CODE XREF: sub_401677+437j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_401AB0
		mov	eax, [ebp+arg_8]
		and	eax, 2
		test	eax, eax
		jz	loc_401B94
		mov	eax, ds:dword_406020
		test	eax, eax
		jnz	short loc_401B4D
		mov	ds:dword_406020, 1
		mov	[esp+0D8h+hProcess], offset LibFileName	; "user32.dll"
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+hModule], eax
		cmp	[ebp+hModule], 0
		jz	short loc_401B4D
		mov	[esp+0D8h+Format], offset aAllowsetforegr ; "AllowSetForegroundWindow"
		mov	eax, [ebp+hModule]
		mov	[esp+0D8h+hProcess], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	ds:dword_406024, eax
		mov	eax, ds:dword_406024
		test	eax, eax
		jnz	short loc_401B4D
		mov	eax, [ebp+hModule]
		mov	[esp+0D8h+hProcess], eax ; hLibModule
		mov	eax, ds:FreeLibrary
		call	eax ; FreeLibrary
		sub	esp, 4

loc_401B4D:				; CODE XREF: sub_401677+47Aj
					; sub_401677+49Ej ...
		mov	eax, ds:dword_406024
		test	eax, eax
		jz	short loc_401B94
		mov	edx, ds:dword_406024
		mov	eax, [ebp+ProcessInformation.dwProcessId]
		mov	[esp+0D8h+hProcess], eax
		call	edx ; dword_406024
		sub	esp, 4
		mov	[ebp+var_34], eax
		mov	eax, [ebp+ProcessInformation.dwProcessId]
		mov	edx, eax
		mov	eax, offset aGpgmeW32spaw_2 ; "gpgme-w32spawn: AllowSetForegroundWindo"...
		mov	ecx, ds:_iob
		lea	ebx, [ecx+40h]
		mov	ecx, [ebp+var_34]
		mov	[esp+0D8h+lpSecurityAttributes], ecx
		mov	[esp+0D8h+dwShareMode],	edx
		mov	[esp+0D8h+Format], eax ; Format
		mov	[esp+0D8h+hProcess], ebx ; File
		call	fprintf

loc_401B94:				; CODE XREF: sub_401677+46Dj
					; sub_401677+4DDj
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0D8h+hProcess], eax ; hThread
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0D8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hProcess]
		mov	[esp+0D8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0

loc_401BC9:				; CODE XREF: sub_401677+F7j
					; sub_401677+362j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_401677	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BD0	proc near		; CODE XREF: sub_402017+1Bp

Str		= dword	ptr -368h
Val		= dword	ptr -364h
Radix		= dword	ptr -360h
EndPtr		= dword	ptr -358h
var_353		= byte ptr -353h
var_29		= byte ptr -29h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 368h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[esp+368h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+368h+Str],	eax
		call	_open
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jns	short loc_401C08
		mov	eax, 0FFFFFFFFh
		jmp	locret_402015
; ---------------------------------------------------------------------------

loc_401C08:				; CODE XREF: sub_401BD0+2Cj
		mov	[esp+368h+Radix], 32Ah
		lea	eax, [ebp+var_353]
		mov	[esp+368h+Val],	eax
		mov	eax, [ebp+var_14]
		mov	[esp+368h+Str],	eax
		call	_read
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	[esp+368h+Str],	eax
		call	_close
		cmp	[ebp+var_18], 0
		jns	short loc_401C43
		mov	eax, 0FFFFFFFFh
		jmp	locret_402015
; ---------------------------------------------------------------------------

loc_401C43:				; CODE XREF: sub_401BD0+67j
		mov	[ebp+var_29], 0
		mov	[esp+368h+Val],	0Ah ; Val
		lea	eax, [ebp+var_353]
		mov	[esp+368h+Str],	eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401C88
		lea	eax, [ebp+var_353]
		cmp	[ebp+var_C], eax
		jbe	short loc_401C82
		mov	eax, [ebp+var_C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_401C82
		sub	[ebp+var_C], 1

loc_401C82:				; CODE XREF: sub_401BD0+9Fj
					; sub_401BD0+ACj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0

loc_401C88:				; CODE XREF: sub_401BD0+94j
		lea	eax, [ebp+var_353]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_401FB8
; ---------------------------------------------------------------------------

loc_401C9D:				; CODE XREF: sub_401BD0+E9j
		add	[ebp+var_C], 1
		jmp	short loc_401CA4
; ---------------------------------------------------------------------------

loc_401CA3:				; CODE XREF: sub_401BD0+3ECj
		nop

loc_401CA4:				; CODE XREF: sub_401BD0+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_401C9D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401FC4
		cmp	[ebp+var_10], 0
		jnz	loc_401D74
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_401D74
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	[esp+368h+Radix], 0 ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+368h+Val],	edx ; EndPtr
		mov	[esp+368h+Str],	eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+EndPtr]
		test	eax, eax
		jz	loc_401FD1
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401D40
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_401FD1

loc_401D40:				; CODE XREF: sub_401BD0+150j
		mov	eax, [ebp+EndPtr]
		mov	[ebp+var_C], eax
		jmp	short loc_401D4F
; ---------------------------------------------------------------------------

loc_401D4B:				; CODE XREF: sub_401BD0+194j
		add	[ebp+var_C], 1

loc_401D4F:				; CODE XREF: sub_401BD0+179j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_401D4B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401FC7

loc_401D74:				; CODE XREF: sub_401BD0+FDj
					; sub_401BD0+10Bj
		mov	eax, [ebp+var_C]
		mov	[esp+368h+Radix], 0 ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+368h+Val],	edx ; EndPtr
		mov	[esp+368h+Str],	eax ; Str
		call	strtoul
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+EndPtr]
		test	eax, eax
		jz	loc_401FD1
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401DCD
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_401FD1

loc_401DCD:				; CODE XREF: sub_401BD0+1DDj
		mov	eax, [ebp+EndPtr]
		mov	[ebp+var_C], eax
		jmp	short loc_401DDC
; ---------------------------------------------------------------------------

loc_401DD8:				; CODE XREF: sub_401BD0+221j
		add	[ebp+var_C], 1

loc_401DDC:				; CODE XREF: sub_401BD0+206j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_401DD8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401FCA
		mov	eax, [ebp+var_C]
		mov	[esp+368h+Radix], 0 ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+368h+Val],	edx ; EndPtr
		mov	[esp+368h+Str],	eax ; Str
		call	strtol
		mov	[ebp+var_20], eax
		mov	eax, [ebp+EndPtr]
		test	eax, eax
		jz	loc_401FD1
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401E5A
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_401FD1

loc_401E5A:				; CODE XREF: sub_401BD0+26Aj
		mov	eax, [ebp+EndPtr]
		mov	[ebp+var_C], eax
		jmp	short loc_401E69
; ---------------------------------------------------------------------------

loc_401E65:				; CODE XREF: sub_401BD0+2AEj
		add	[ebp+var_C], 1

loc_401E69:				; CODE XREF: sub_401BD0+293j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_401E65
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401FCD
		mov	eax, [ebp+var_C]
		mov	[esp+368h+Radix], 0 ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+368h+Val],	edx ; EndPtr
		mov	[esp+368h+Str],	eax ; Str
		call	strtoul
		mov	[ebp+var_24], eax
		mov	eax, [ebp+EndPtr]
		test	eax, eax
		jz	loc_401FD1
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401EE7
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_401FD1

loc_401EE7:				; CODE XREF: sub_401BD0+2F7j
		mov	eax, [ebp+EndPtr]
		mov	[ebp+var_C], eax
		jmp	short loc_401EF6
; ---------------------------------------------------------------------------

loc_401EF2:				; CODE XREF: sub_401BD0+33Bj
		add	[ebp+var_C], 1

loc_401EF6:				; CODE XREF: sub_401BD0+320j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_401EF2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401FD0
		mov	eax, [ebp+var_C]
		mov	[esp+368h+Radix], 0 ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+368h+Val],	edx ; EndPtr
		mov	[esp+368h+Str],	eax ; Str
		call	strtoul
		mov	[ebp+var_28], eax
		mov	eax, [ebp+EndPtr]
		test	eax, eax
		jz	loc_401FD1
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401F70
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+368h+Str],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_401FD1

loc_401F70:				; CODE XREF: sub_401BD0+384j
		mov	eax, [ebp+EndPtr]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [ebp+var_20]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [ebp+var_24]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [ebp+var_28]
		mov	[eax+0Ch], edx
		add	[ebp+var_10], 1

loc_401FB8:				; CODE XREF: sub_401BD0+C8j
		cmp	[ebp+var_10], 9
		jle	loc_401CA3
		jmp	short loc_401FD1
; ---------------------------------------------------------------------------

loc_401FC4:				; CODE XREF: sub_401BD0+F3j
		nop
		jmp	short loc_401FD1
; ---------------------------------------------------------------------------

loc_401FC7:				; CODE XREF: sub_401BD0+19Ej
		nop
		jmp	short loc_401FD1
; ---------------------------------------------------------------------------

loc_401FCA:				; CODE XREF: sub_401BD0+22Bj
		nop
		jmp	short loc_401FD1
; ---------------------------------------------------------------------------

loc_401FCD:				; CODE XREF: sub_401BD0+2B8j
		nop
		jmp	short loc_401FD1
; ---------------------------------------------------------------------------

loc_401FD0:				; CODE XREF: sub_401BD0+345j
		nop

loc_401FD1:				; CODE XREF: sub_401BD0+13Fj
					; sub_401BD0+16Aj ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	dword ptr [eax+8], 0FFFFFFFFh
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, 0

locret_402015:				; CODE XREF: sub_401BD0+33j
					; sub_401BD0+6Ej
		leave
		retn
sub_401BD0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402017	proc near		; CODE XREF: sub_40223C+5Ep

Size		= dword	ptr -48h
var_44		= dword	ptr -44h
Count		= dword	ptr -40h
File		= dword	ptr -3Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+Count], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Size],	eax
		call	sub_401BD0
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_40204A
		mov	eax, 0
		jmp	loc_402236
; ---------------------------------------------------------------------------

loc_40204A:				; CODE XREF: sub_402017+27j
		mov	[ebp+var_C], 0
		jmp	short loc_402057
; ---------------------------------------------------------------------------

loc_402053:				; CODE XREF: sub_402017+4Dj
		add	[ebp+var_C], 1

loc_402057:				; CODE XREF: sub_402017+3Aj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402053
		mov	eax, [ebp+var_C]
		add	eax, 1
		shl	eax, 2
		mov	[esp+48h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4020C0
; ---------------------------------------------------------------------------

loc_402083:				; CODE XREF: sub_402017+B6j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp+var_14]
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+48h+Size],	eax ; Src
		call	_strdup
		mov	[ebx], eax
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4020BC
		mov	eax, 0
		jmp	loc_402236
; ---------------------------------------------------------------------------

loc_4020BC:				; CODE XREF: sub_402017+99j
		add	[ebp+var_C], 1

loc_4020C0:				; CODE XREF: sub_402017+6Aj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402083
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		mov	[ebp+var_C], 0
		jmp	loc_40221F
; ---------------------------------------------------------------------------

loc_4020F0:				; CODE XREF: sub_402017+216j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_40221A
		mov	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_18]
		jl	short loc_402144
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aGpgmeW32spawnT ; "gpgme-w32spawn: translation file	does n"...
		mov	[esp+48h+File],	edx ; File
		mov	[esp+48h+Count], 35h ; Count
		mov	[esp+48h+var_44], 1 ; Size
		mov	[esp+48h+Size],	eax ; Str
		call	fwrite
		mov	eax, 0
		jmp	loc_402236
; ---------------------------------------------------------------------------

loc_402144:				; CODE XREF: sub_402017+F8j
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp+var_14]
		mov	[esp+48h+Size],	19h ; Size
		call	malloc
		mov	[ebx], eax
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40217D
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_402187

loc_40217D:				; CODE XREF: sub_402017+153j
		mov	eax, 0
		jmp	loc_402236
; ---------------------------------------------------------------------------

loc_402187:				; CODE XREF: sub_402017+164j
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4021E4
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 26h
		jnz	short loc_4021E4
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_8]
		mov	ecx, [eax+8]
		mov	edx, offset aD	; "-&%d"
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[esp+48h+File],	ecx ; char
		mov	[esp+48h+Count], edx ; char *
		mov	[esp+48h+var_44], 19h ;	size_t
		mov	[esp+48h+Size],	eax ; char *
		call	sub_4036F0
		jmp	short loc_40221B
; ---------------------------------------------------------------------------

loc_4021E4:				; CODE XREF: sub_402017+180j
					; sub_402017+195j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_8]
		mov	ecx, [eax+8]
		mov	edx, offset aD_0 ; "%d"
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[esp+48h+File],	ecx ; char
		mov	[esp+48h+Count], edx ; char *
		mov	[esp+48h+var_44], 19h ;	size_t
		mov	[esp+48h+Size],	eax ; char *
		call	sub_4036F0
		jmp	short loc_40221B
; ---------------------------------------------------------------------------

loc_40221A:				; CODE XREF: sub_402017+ECj
		nop

loc_40221B:				; CODE XREF: sub_402017+1CBj
					; sub_402017+201j
		add	[ebp+var_C], 1

loc_40221F:				; CODE XREF: sub_402017+D4j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_8]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	loc_4020F0
		mov	eax, [ebp+var_14]

loc_402236:				; CODE XREF: sub_402017+2Ej
					; sub_402017+A0j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_402017	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40223C	proc near		; CODE XREF: sub_401180+265p

File		= dword	ptr -0E4h
Format		= dword	ptr -0E0h
Count		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= byte ptr -0D0h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= byte ptr  0Ch

		lea	ecx, [esp-8+arg_0]
		and	esp, 0FFFFFFF0h
		push	dword ptr [ecx-4]
		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		push	ecx
		sub	esp, 0DCh
		mov	ebx, ecx
		call	sub_4032A0
		mov	[ebp+var_1C], 0
		cmp	dword ptr [ebx], 2
		jg	short loc_402271
		mov	[ebp+var_1C], 2
		jmp	loc_402319
; ---------------------------------------------------------------------------

loc_402271:				; CODE XREF: sub_40223C+27j
		mov	eax, [ebx+4]
		lea	ecx, [eax+8]
		mov	eax, [ebx+4]
		add	eax, 4
		mov	eax, [eax]
		lea	edx, [ebp+var_D4]
		mov	[esp+0E4h+var_D8], edx
		lea	edx, [ebp+var_D0]
		mov	[esp+0E4h+Count], edx
		mov	[esp+0E4h+Format], ecx
		mov	[esp+0E4h+File], eax
		call	sub_402017
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4022B1
		mov	[ebp+var_1C], 2
		jmp	short loc_402319
; ---------------------------------------------------------------------------

loc_4022B1:				; CODE XREF: sub_40223C+6Aj
		mov	eax, [ebp+var_D4]
		mov	[esp+0E4h+Count], eax
		lea	eax, [ebp+var_D0]
		mov	[esp+0E4h+Format], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0E4h+File], eax
		call	sub_401677
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jns	short loc_402319
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+0E4h+File], eax ; int
		call	strerror
		mov	edx, [ebx+4]
		mov	ecx, [edx]
		mov	edx, offset aGpgmeW32spawnE ; "gpgme-w32spawn: executing `%s' failed: "...
		mov	esi, ds:_iob
		add	esi, 40h
		mov	[esp+0E4h+var_D8], eax
		mov	[esp+0E4h+Count], ecx
		mov	[esp+0E4h+Format], edx ; Format
		mov	[esp+0E4h+File], esi ; File
		call	fprintf
		mov	[ebp+var_1C], 2
		nop

loc_402319:				; CODE XREF: sub_40223C+30j
					; sub_40223C+73j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_402348
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aGpgmeW32spawnI ; "gpgme-w32spawn: internal	error\n"
		mov	[esp+0E4h+var_D8], edx ; File
		mov	[esp+0E4h+Count], 1Fh ;	Count
		mov	[esp+0E4h+Format], 1 ; Size
		mov	[esp+0E4h+File], eax ; Str
		call	fwrite

loc_402348:				; CODE XREF: sub_40223C+E1j
		cmp	dword ptr [ebx], 1
		jle	short loc_402397
		mov	eax, [ebx+4]
		add	eax, 4
		mov	eax, [eax]
		mov	[esp+0E4h+File], eax ; lpFileName
		mov	eax, ds:DeleteFileA
		call	eax ; DeleteFileA
		sub	esp, 4
		test	eax, eax
		jnz	short loc_402397
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, [ebx+4]
		add	edx, 4
		mov	ecx, [edx]
		mov	edx, offset aGpgmeW32spawnF ; "gpgme-w32spawn: failed to delete	%s: ec"...
		mov	ebx, ds:_iob
		add	ebx, 40h
		mov	[esp+0E4h+var_D8], eax
		mov	[esp+0E4h+Count], ecx
		mov	[esp+0E4h+Format], edx ; Format
		mov	[esp+0E4h+File], ebx ; File
		call	fprintf

loc_402397:				; CODE XREF: sub_40223C+10Fj
					; sub_40223C+128j
		mov	eax, [ebp+var_1C]
		lea	esp, [ebp-0Ch]
		pop	ecx
		pop	ebx
		pop	esi
		pop	ebp
		lea	esp, [ecx-4]
		retn
sub_40223C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00408024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_4023D0
		cmp	eax, 3
		jz	short loc_4023D0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_4023D0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_4035C0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_405248o ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_402444
		cmp	dword_404010, 2
		jz	short loc_402426
		mov	dword_404010, 2

loc_402426:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_402533
		cmp	eax, 1
		jz	loc_4024D2

loc_402438:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_402444:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_4063F8, 1
		mov	[esp+1Ch+lpLibFileName], offset	aMingwm10_dll ;	"mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_402563
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_4063F4, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_4063F0, eax
		jz	loc_402563
		mov	ecx, ds:dword_4063F4
		test	ecx, ecx
		jz	short loc_4024F3
		test	eax, eax
		jz	short loc_4024F3
		mov	dword_404010, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4024D2:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_4035C0
		jmp	loc_402438
; ---------------------------------------------------------------------------

loc_4024F3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_4063F0, 0
		mov	ds:dword_4063F4, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_402513:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_404010, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_402533:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_408030
		cmp	ebx, offset dword_408030
		jz	loc_402438

loc_402544:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_40254C
		call	eax

loc_40254C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_408030
		jnz	short loc_402544
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_402563:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_4063F0, 0
		mov	ds:dword_4063F4, 0
		jmp	short loc_402513
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402590	proc near		; DATA XREF: .CRT:00408014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_402590	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4025A0	proc near		; CODE XREF: sub_4025C0+10p
					; sub_4025C0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_4025A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4025B0	proc near		; CODE XREF: sub_401060+59p
					; sub_4025C0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_4025B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4025C0(_onexit_t)
sub_4025C0	proc near		; CODE XREF: sub_402680+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_406400
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_4025A0
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_402660
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_406400
		mov	[esp+2Ch+Func],	eax
		call	sub_4025A0
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_4063FC
		mov	[esp+2Ch+Func],	eax
		call	sub_4025A0
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_4025B0
		mov	ds:dword_406400, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_4025B0
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_4063FC, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402660:				; CODE XREF: sub_4025C0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_4025C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402680(_onexit_t)
sub_402680	proc near		; CODE XREF: sub_4032A0-27p
					; sub_4037F0+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_4025C0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_402680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_4026F7
		cmp	eax, 0C000008Dh
		jb	short loc_402724

loc_4026BB:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_4026C0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_4027F0
		test	eax, eax
		jz	short loc_40270C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_4026EF:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4026F7:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_402765
		cmp	eax, 0C0000096h
		jz	short loc_402732
		cmp	eax, 0C0000093h
		jz	short loc_4026BB

loc_40270C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_406050
		test	eax, eax
		jz	loc_4027E3
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_402724:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_402770
		cmp	eax, 0C000001Dh
		jnz	short loc_40270C

loc_402732:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_4027A7
		test	eax, eax
		jz	short loc_40270C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_402765:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_4026C0
; ---------------------------------------------------------------------------
		align 10h

loc_402770:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_4027C5
		test	eax, eax
		jz	loc_40270C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4027A7:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_4026EF
; ---------------------------------------------------------------------------

loc_4027C5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_4026EF
; ---------------------------------------------------------------------------

loc_4027E3:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_4026EF
; ---------------------------------------------------------------------------
		align 10h

loc_4027F0:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_4026EF
		mov	[esp+2Ch+var_10], eax
		call	sub_403210
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_4026EF
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_406054
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_402871
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_406054
		jmp	short loc_402877
; ---------------------------------------------------------------------------

loc_402871:				; CODE XREF: .text:00402846j
		fstp	st
		fstp	st
		fstp	st

loc_402877:				; CODE XREF: .text:0040286Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402880	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_406054, eax
		jmp	__setusermatherr
sub_402880	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402890	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_4028AD
		mov	edx, ds:off_405368[ecx*4]

loc_4028AD:				; CODE XREF: sub_402890+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_402890	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4028F0	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_4028F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_402900(char *Format, char ArgList)
sub_402900	proc near		; CODE XREF: sub_402960+1DDp
					; sub_402960+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_402900	endp

; ---------------------------------------------------------------------------
		jmp	short sub_402960
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_402960(size_t Size)
sub_402960	proc near		; CODE XREF: .text:00402951j
					; sub_402BA0+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_406060
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_402B42
		mov	eax, ds:dword_40605C
		xor	esi, esi

loc_402984:				; CODE XREF: sub_402960+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_402999
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_402A70

loc_402999:				; CODE XREF: sub_402960+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_402984

loc_4029A3:				; CODE XREF: sub_402960+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_402F60
		test	eax, eax
		mov	edi, eax
		jz	loc_402B69
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_40605C
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_403040
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_40605C
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_402B49
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_402AF1

loc_402A1F:				; CODE XREF: sub_402960+194j
					; sub_402960+1C6j
		add	ds:dword_406060, 1

loc_402A26:				; CODE XREF: sub_402960+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_402B79
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_402A78

loc_402A4F:				; CODE XREF: sub_402960+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_402A63:				; CODE XREF: sub_402960+162j
					; sub_402960+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402A70:				; CODE XREF: sub_402960+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_402A26
; ---------------------------------------------------------------------------

loc_402A78:				; CODE XREF: sub_402960+EDj
		cmp	eax, 40h
		jz	short loc_402A4F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_402A63
		cmp	eax, 4
		jz	short loc_402A63
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_402AF1:				; CODE XREF: sub_402960+B9j
		cmp	eax, 40h
		jz	loc_402A1F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_40605C
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_402A1F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_402900
; ---------------------------------------------------------------------------

loc_402B42:				; CODE XREF: sub_402960+17j
		xor	esi, esi
		jmp	loc_4029A3
; ---------------------------------------------------------------------------

loc_402B49:				; CODE XREF: sub_402960+ACj
		mov	eax, ds:dword_40605C
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_402900
; ---------------------------------------------------------------------------

loc_402B69:				; CODE XREF: sub_402960+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_402900
; ---------------------------------------------------------------------------

loc_402B79:				; CODE XREF: sub_402960+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_402900
sub_402960	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402BA0	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_406058
		test	eax, eax
		jz	short loc_402BC0

loc_402BB2:				; CODE XREF: sub_402BA0+66j
					; sub_402BA0+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402BC0:				; CODE XREF: sub_402BA0+10j
		mov	ds:dword_406058, 1
		call	sub_402FA0
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_403660
		mov	ds:dword_406060, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_40605C, eax
		mov	eax, offset dword_405498
		sub	eax, offset dword_405498
		cmp	eax, 7
		jle	short loc_402BB2
		cmp	eax, 0Bh
		mov	ebx, offset dword_405498
		jle	loc_402D00
		mov	eax, ds:dword_405498
		test	eax, eax
		jnz	short loc_402C30
		mov	eax, ds:dword_40549C
		test	eax, eax
		jz	loc_402CEC
		lea	esi, [esi+0]

loc_402C30:				; CODE XREF: sub_402BA0+7Dj
					; sub_402BA0+164j ...
		cmp	ebx, offset dword_405498
		jnb	loc_402BB2
		mov	esi, 400000h

loc_402C41:				; CODE XREF: sub_402BA0+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_402960
		cmp	ebx, offset dword_405498
		jb	short loc_402C41

loc_402C65:				; CODE XREF: sub_402BA0+24Bj
		mov	ecx, ds:dword_406060
		test	ecx, ecx
		jle	loc_402BB2
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_402C92
; ---------------------------------------------------------------------------
		align 10h

loc_402C80:				; CODE XREF: sub_402BA0+FDj
					; sub_402BA0+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_406060
		jge	loc_402BB2

loc_402C92:				; CODE XREF: sub_402BA0+DDj
		mov	eax, ds:dword_40605C
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_402C80
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_402E12
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_40605C
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_402C80
; ---------------------------------------------------------------------------

loc_402CEC:				; CODE XREF: sub_402BA0+86j
		mov	eax, ds:dword_4054A0
		test	eax, eax
		jnz	short loc_402D15
		mov	ebx, offset dword_4054A4
		lea	esi, [esi+0]

loc_402D00:				; CODE XREF: sub_402BA0+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_402C30
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_402C30

loc_402D15:				; CODE XREF: sub_402BA0+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_402E35
		add	ebx, 0Ch
		cmp	ebx, offset dword_405498
		jnb	loc_402BB2

loc_402D30:				; CODE XREF: sub_402BA0+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_402D8A
		cmp	edx, 20h
		jz	short loc_402DC0
		cmp	edx, 8
		jz	short loc_402D6A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_402900
; ---------------------------------------------------------------------------

loc_402D6A:				; CODE XREF: sub_402BA0+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_402D95
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_402DB1
; ---------------------------------------------------------------------------

loc_402D8A:				; CODE XREF: sub_402BA0+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_402DF0

loc_402D95:				; CODE XREF: sub_402BA0+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_402E03
		cmp	edx, 20h
		jz	short loc_402DCF
		cmp	edx, 8
		jnz	short loc_402DDC

loc_402DB1:				; CODE XREF: sub_402BA0+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_402960
		jmp	short loc_402DDC
; ---------------------------------------------------------------------------

loc_402DC0:				; CODE XREF: sub_402BA0+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_402DCF:				; CODE XREF: sub_402BA0+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_402960

loc_402DDC:				; CODE XREF: sub_402BA0+20Fj
					; sub_402BA0+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_405498
		jb	loc_402D30
		jmp	loc_402C65
; ---------------------------------------------------------------------------

loc_402DF0:				; CODE XREF: sub_402BA0+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_402E03:				; CODE XREF: sub_402BA0+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_402960
		jmp	short loc_402DDC
; ---------------------------------------------------------------------------

loc_402E12:				; CODE XREF: sub_402BA0+11Bj
		add	ebx, ds:dword_40605C
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_402900
; ---------------------------------------------------------------------------

loc_402E35:				; CODE XREF: sub_402BA0+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_402900
sub_402BA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402E50	proc near		; CODE XREF: .text:00402EF1p
					; sub_402F60+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_402E60

locret_402E5D:				; CODE XREF: sub_402E50+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_402E60:				; CODE XREF: sub_402E50+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_402E5D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_402E50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402E80	proc near		; CODE XREF: sub_402F60+2Bp
					; .text:004030A4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_402EBE
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_402EA4:				; CODE XREF: sub_402E80+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_402EB2
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_402EBE

loc_402EB2:				; CODE XREF: sub_402E80+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_402EA4
		xor	eax, eax

loc_402EBE:				; CODE XREF: sub_402E80+19j
					; sub_402E80+30j
		pop	ebx
		pop	esi
		retn
sub_402E80	endp

; ---------------------------------------------------------------------------
		jmp	short loc_402ED0
; ---------------------------------------------------------------------------
		align 10h

loc_402ED0:				; CODE XREF: .text:00402EC1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_402F43
		mov	dword ptr [esp], 400000h
		call	sub_402E50
		test	eax, eax
		jz	short loc_402F43
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_402F43
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_402F2B
; ---------------------------------------------------------------------------

loc_402F21:				; CODE XREF: .text:00402F41j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_402F50

loc_402F2B:				; CODE XREF: .text:00402F1Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_402F21

loc_402F43:				; CODE XREF: .text:00402EE8j
					; .text:00402EF8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402F50:				; CODE XREF: .text:00402F29j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402F60	proc near		; CODE XREF: sub_402960+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_402E50
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_402F90
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_402E80

loc_402F90:				; CODE XREF: sub_402F60+15j
		add	esp, 8
		retn
sub_402F60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402FA0	proc near		; CODE XREF: sub_402BA0+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_402E50
		xor	edx, edx
		test	eax, eax
		jz	short loc_402FC1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_402FC1:				; CODE XREF: sub_402FA0+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_402FA0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_402E50
		xor	edx, edx
		test	eax, eax
		jz	short loc_403029
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_403029
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_403010:				; CODE XREF: .text:00403025j
		test	byte ptr [edx+27h], 20h
		jz	short loc_40301D
		test	ebx, ebx
		jz	short loc_403029
		sub	ebx, 1

loc_40301D:				; CODE XREF: .text:00403014j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_403010
		xor	edx, edx

loc_403029:				; CODE XREF: .text:00402FE9j
					; .text:00403005j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_403040
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403040	proc near		; CODE XREF: sub_402960+70p
					; .text:00403031j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_402E50
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_403040	endp

; ---------------------------------------------------------------------------
		jmp	short loc_403070
; ---------------------------------------------------------------------------
		align 10h

loc_403070:				; CODE XREF: .text:00403061j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_402E50
		test	eax, eax
		jnz	short loc_403090

loc_403086:				; CODE XREF: .text:004030ABj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403090:				; CODE XREF: .text:00403084j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_402E80
		test	eax, eax
		jz	short loc_403086
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4030C0	proc near		; CODE XREF: sub_403150+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_402E50
		test	eax, eax
		jz	short loc_403131
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_403131
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_402E80
		test	eax, eax
		jz	short loc_403131
		add	esi, 400000h
		jnz	short loc_403116
		jmp	short loc_403131
; ---------------------------------------------------------------------------
		align 10h

loc_403110:				; CODE XREF: sub_4030C0+66j
		sub	ebx, 1
		add	esi, 14h

loc_403116:				; CODE XREF: sub_4030C0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_403124
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_403140

loc_403124:				; CODE XREF: sub_4030C0+5Bj
		test	ebx, ebx
		jg	short loc_403110
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_403131:				; CODE XREF: sub_4030C0+1Aj
					; sub_4030C0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403140:				; CODE XREF: sub_4030C0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_4030C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403150	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_406064
		test	eax, eax
		jz	short loc_403162

loc_40315D:				; CODE XREF: sub_403150+97j
					; sub_403150+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403162:				; CODE XREF: sub_403150+Bj
		xor	eax, eax

loc_403164:				; CODE XREF: sub_403150+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_4030C0
		test	eax, eax
		jz	short loc_4031F0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_403180
		cmp	dl, 6Dh
		jnz	short loc_4031D0

loc_403180:				; CODE XREF: sub_403150+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40318E
		cmp	dl, 73h
		jnz	short loc_4031D0

loc_40318E:				; CODE XREF: sub_403150+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40319C
		cmp	dl, 76h
		jnz	short loc_4031D0

loc_40319C:				; CODE XREF: sub_403150+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_4031AA
		cmp	dl, 63h
		jnz	short loc_4031D0

loc_4031AA:				; CODE XREF: sub_403150+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_4031B8
		cmp	dl, 72h
		jnz	short loc_4031D0

loc_4031B8:				; CODE XREF: sub_403150+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_4031D4
		cmp	dl, 74h
		jz	short loc_4031D4
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_4031D4
		xchg	ax, ax

loc_4031D0:				; CODE XREF: sub_403150+2Ej
					; sub_403150+3Cj ...
		mov	eax, ebx
		jmp	short loc_403164
; ---------------------------------------------------------------------------

loc_4031D4:				; CODE XREF: sub_403150+6Fj
					; sub_403150+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_406064, eax
		jnz	loc_40315D
		lea	esi, [esi+0]

loc_4031F0:				; CODE XREF: sub_403150+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_406064, eax
		jmp	loc_40315D
sub_403150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403210	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_403210	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_403220()
sub_403220	proc near		; DATA XREF: sub_4032A0:loc_403272o
		sub	esp, 0Ch
		mov	eax, off_40400C
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_403247
		xchg	ax, ax

loc_403230:				; CODE XREF: sub_403220+25j
		call	eax
		mov	eax, off_40400C
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_40400C, edx
		test	eax, eax
		jnz	short loc_403230

loc_403247:				; CODE XREF: sub_403220+Cj
		add	esp, 0Ch
		retn
sub_403220	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_4032A0

loc_403250:				; CODE XREF: sub_4032A0+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_403810
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_403283

loc_40325F:				; CODE XREF: sub_4032A0-9j
		test	ebx, ebx
		jz	short loc_403272

loc_403263:				; CODE XREF: sub_4032A0-30j
		call	ds:dword_403810[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_403263

loc_403272:				; CODE XREF: sub_4032A0-3Fj
		mov	[esp+1Ch+var_1C], offset sub_403220 ; _onexit_t
		call	sub_402680
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403283:				; CODE XREF: sub_4032A0-43j
		xor	ebx, ebx
		jmp	short loc_403289
; ---------------------------------------------------------------------------

loc_403287:				; CODE XREF: sub_4032A0-Bj
		mov	ebx, eax

loc_403289:				; CODE XREF: sub_4032A0-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_403810[eax*4]
		test	edx, edx
		jnz	short loc_403287
		jmp	short loc_40325F
; END OF FUNCTION CHUNK	FOR sub_4032A0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4032A0	proc near		; CODE XREF: sub_401180+239p
					; sub_40223C+18p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00403250 SIZE 00000049 BYTES

		mov	ecx, ds:dword_406068
		test	ecx, ecx
		jz	short loc_4032B0
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_4032B0:				; CODE XREF: sub_4032A0+8j
		mov	ds:dword_406068, 1
		jmp	short loc_403250
sub_4032A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4032C0	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_404018
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_403310
		not	eax
		mov	dword_40401C, eax

loc_4032F6:				; CODE XREF: sub_4032C0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403310:				; CODE XREF: sub_4032C0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_403382

loc_403372:				; CODE XREF: sub_4032C0+CCj
		mov	dword_404018, ebp
		mov	dword_40401C, eax
		jmp	loc_4032F6
; ---------------------------------------------------------------------------

loc_403382:				; CODE XREF: sub_4032C0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_403372
sub_4032C0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_406144, edx
		mov	ds:dword_406360, 0C0000409h
		mov	ds:dword_406364, 1
		mov	ds:dword_406138, eax
		mov	ds:dword_40636C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_40612C, eax
		mov	eax, dword_404018
		mov	[ebp-10h], eax
		mov	eax, dword_40401C
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_405490
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403420	proc near		; CODE XREF: sub_4035C0+79p
					; sub_4035C0:loc_403652p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_4063DC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_403475
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_403450:				; CODE XREF: sub_403420+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_40346E
		test	esi, esi
		jz	short loc_40346E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_40346E:				; CODE XREF: sub_403420+40j
					; sub_403420+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_403450

loc_403475:				; CODE XREF: sub_403420+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_403420	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_4063C0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_4034B4

loc_4034A6:				; CODE XREF: .text:0040351Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_4034B4:				; CODE XREF: .text:004034A4j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_403517
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_4063DC
		mov	ds:dword_4063DC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_403517:				; CODE XREF: .text:004034CCj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_4034A6
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_4063C0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_403538
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403538:				; CODE XREF: .text:0040352Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_4063DC
		sub	esp, 4
		test	edx, edx
		jz	short loc_40356F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_403568
		jmp	short loc_4035A6
; ---------------------------------------------------------------------------
		align 10h

loc_403560:				; CODE XREF: .text:0040356Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_403586
		mov	edx, eax

loc_403568:				; CODE XREF: .text:00403556j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_403560

loc_40356F:				; CODE XREF: .text:00403550j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_40357F:				; CODE XREF: .text:004035A4j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403586:				; CODE XREF: .text:00403564j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_40358C:				; CODE XREF: .text:004035B0j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_40357F
; ---------------------------------------------------------------------------

loc_4035A6:				; CODE XREF: .text:00403558j
		mov	eax, [edx+8]
		mov	ds:dword_4063DC, eax
		mov	eax, edx
		jmp	short loc_40358C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4035C0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_403610
		jb	short loc_4035E0
		cmp	eax, 3
		jz	short loc_403630

loc_4035D3:				; CODE XREF: sub_4035C0+31j
					; sub_4035C0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4035E0:				; CODE XREF: sub_4035C0+Cj
		mov	eax, ds:dword_4063C0
		test	eax, eax
		jnz	short loc_403652

loc_4035E9:				; CODE XREF: sub_4035C0+97j
		mov	eax, ds:dword_4063C0
		cmp	eax, 1
		jnz	short loc_4035D3
		mov	ds:dword_4063C0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_4035D3
; ---------------------------------------------------------------------------
		align 10h

loc_403610:				; CODE XREF: sub_4035C0+Aj
		mov	eax, ds:dword_4063C0
		test	eax, eax
		jz	short loc_403640

loc_403619:				; CODE XREF: sub_4035C0+90j
		mov	ds:dword_4063C0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403630:				; CODE XREF: sub_4035C0+11j
		mov	eax, ds:dword_4063C0
		test	eax, eax
		jz	short loc_4035D3
		call	sub_403420
		jmp	short loc_4035D3
; ---------------------------------------------------------------------------

loc_403640:				; CODE XREF: sub_4035C0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_403619
; ---------------------------------------------------------------------------

loc_403652:				; CODE XREF: sub_4035C0+27j
		call	sub_403420
		jmp	short loc_4035E9
sub_4035C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403660	proc near		; CODE XREF: sub_401180+19p
					; sub_402BA0+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_403682

loc_40366D:				; CODE XREF: sub_403660+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_40366D

loc_403682:				; CODE XREF: sub_403660+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_403660	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_4036D0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4036D0	proc near		; CODE XREF: sub_401180+A7p
					; .text:004036C1j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_4036D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4036F0(char *, size_t, char *, char)
sub_4036F0	proc near		; CODE XREF: sub_402017+1C6p
					; sub_402017+1FCp

DstBuf		= dword	ptr -1Ch
MaxCount	= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 1Ch
		lea	eax, [esp+1Ch+arg_C]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+Format], eax ;	Format
		mov	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+MaxCount], eax	; MaxCount
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+DstBuf], eax ;	DstBuf
		call	_vsnprintf
		add	esp, 1Ch
		retn
sub_4036F0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _vsnprintf]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4037F0	proc near		; DATA XREF: .text:00403814o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_402680
		leave
		retn
sub_4037F0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_403810	dd 0FFFFFFFFh		; DATA XREF: sub_4032A0-4Cr
					; sub_4032A0:loc_403263r ...
		dd offset sub_4037F0
		dd 0
		dd 0FFFFFFFFh
dword_403820	dd 78h dup(0)		; DATA XREF: .data:off_40400Co
		dd 180h	dup(?)
_text		ends

; Section 2. (virtual address 00004000)
; Virtual size			: 00000024 (	 36.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00002E00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 404000h
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_40400C	dd offset dword_403820	; DATA XREF: sub_403220+3r
					; sub_403220+12r ...
dword_404010	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_404014	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_404018	dd 0BB40E64Eh		; DATA XREF: sub_4032C0+3r
					; sub_4032C0:loc_403372w ...
dword_40401C	dd 44BF19B1h		; DATA XREF: sub_4032C0+31w
					; sub_4032C0+B8w ...
dword_404020	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00005000)
; Virtual size			: 00000498 (   1176.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00003000
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 405000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
; char Format[]
Format		db 'gpgme-w32spawn: argv[%2i] = %s',0Ah,0 ; DATA XREF: sub_401677+81o
; char aGpgmeW32spawnS[]
aGpgmeW32spawnS	db 'gpgme-w32spawn: spawning: %s',0Ah,0 ; DATA XREF: sub_401677+177o
		align 4
; char aGpgmeW32spawnD[]
aGpgmeW32spawnD	db 'gpgme-w32spawn: dup 0x%x to stdin',0Ah,0 ; DATA XREF: sub_401677+1D6o
		align 4
; char aGpgmeW32spaw_0[]
aGpgmeW32spaw_0	db 'gpgme-w32spawn: dup 0x%x to stdout',0Ah,0 ; DATA XREF: sub_401677+22Co
; char aGpgmeW32spaw_1[]
aGpgmeW32spaw_1	db 'gpgme-w32spawn:dup 0x%x to stderr',0Ah,0 ; DATA XREF: sub_401677+27Fo
; CHAR FileName[]
FileName	db 'nul',0              ; DATA XREF: sub_401677+32Bo
; CHAR LibFileName[]
LibFileName	db 'user32.dll',0       ; DATA XREF: sub_401677+486o
; CHAR aAllowsetforegr[]
aAllowsetforegr	db 'AllowSetForegroundWindow',0 ; DATA XREF: sub_401677+4A0o
		align 4
; char aGpgmeW32spaw_2[]
aGpgmeW32spaw_2	db 'gpgme-w32spawn: AllowSetForegroundWindow(%d): rc=%d',0Ah,0
					; DATA XREF: sub_401677+4F8o
		align 10h
aGpgmeW32spawnT	db 'gpgme-w32spawn: translation file does not match args',0Ah,0
					; DATA XREF: sub_402017+102o
; char aD[]
aD		db '-&%d',0             ; DATA XREF: sub_402017+1A3o
; char aD_0[]
aD_0		db '%d',0               ; DATA XREF: sub_402017+1D9o
		align 10h
; char aGpgmeW32spawnE[]
aGpgmeW32spawnE	db 'gpgme-w32spawn: executing `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_40223C+B3o
		align 4
aGpgmeW32spawnI	db 'gpgme-w32spawn: internal error',0Ah,0 ; DATA XREF: sub_40223C+EBo
; char aGpgmeW32spawnF[]
aGpgmeW32spawnF	db 'gpgme-w32spawn: failed to delete %s: ec=%ld',0Ah,0
					; DATA XREF: sub_40223C+139o
		align 4
; CHAR aMingwm10_dll[]
aMingwm10_dll	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_405248	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_402890+3o
		align 4
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_402890+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_405368o
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0040536Co
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:00405370o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:00405374o
		align 4
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:00405378o
		align 10h
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0040537Co
		align 4
off_405368	dd offset aArgumentDomain ; DATA XREF: sub_402890+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_402900+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_402960+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_402960+1F9o
					; sub_402960+225o ...
		align 10h
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_402960+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_402BA0+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_402BA0+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_403150:loc_4031F0o
		unicode	0, <msvcrt.dll>,0
		align 10h
off_405490	dd offset dword_406360	; DATA XREF: .text:004033E8o
		dd offset dword_406080
dword_405498	dd 0			; DATA XREF: sub_402BA0+59o
					; sub_402BA0+5Eo ...
dword_40549C	dd 0			; DATA XREF: sub_402BA0+7Fr
dword_4054A0	dd 0			; DATA XREF: sub_402BA0:loc_402CECr
dword_4054A4	dd 57h dup(0)		; DATA XREF: sub_402BA0+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00006000)
; Virtual size			: 0000041C (   1052.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 406000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_406000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_406004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_406008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_40600C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_406010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_406014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_406018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_40601C	dd ?			; DATA XREF: sub_401010+3Aw
dword_406020	dd ?			; DATA XREF: sub_401677+473r
					; sub_401677+47Cw
dword_406024	dd ?			; DATA XREF: sub_401677+4B8w
					; sub_401677+4BDr ...
dword_406028	dd ?			; DATA XREF: sub_401010+3r
dword_40602C	dd ?			; DATA XREF: sub_401010+25r
dword_406030	dd ?			; DATA XREF: sub_401060+22w
dword_406034	dd ?			; DATA XREF: sub_401060+18w
dword_406038	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_406044	dd ?			; DATA XREF: sub_401060+2Cw
dword_406048	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_40604C	dd ?			; DATA XREF: sub_401060+5Er
dword_406050	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_40270Cr
dword_406054	dd ?			; DATA XREF: .text:00402833r
					; sub_402880+4w
dword_406058	dd ?			; DATA XREF: sub_402BA0+9r
					; sub_402BA0:loc_402BC0w
dword_40605C	dd ?			; DATA XREF: sub_402960+1Dr
					; sub_402960+58r ...
dword_406060	dd ?			; DATA XREF: sub_402960+Br
					; sub_402960:loc_402A1Fw ...
dword_406064	dd ?			; DATA XREF: sub_403150+4r
					; sub_403150+92w ...
dword_406068	dd ?			; DATA XREF: sub_4032A0r
					; sub_4032A0:loc_4032B0w
		align 20h
dword_406080	dd 2Bh dup(?)		; DATA XREF: .rdata:00405494o
dword_40612C	dd ?			; DATA XREF: .text:004033CAw
		dd 2 dup(?)
dword_406138	dd ?			; DATA XREF: .text:004033B6w
		dd 2 dup(?)
dword_406144	dd ?			; DATA XREF: .text:0040339Cw
		dd 86h dup(?)
dword_406360	dd ?			; DATA XREF: .text:004033A2w
					; .rdata:off_405490o
dword_406364	dd ?			; DATA XREF: .text:004033ACw
		dd ?
dword_40636C	dd ?			; DATA XREF: .text:004033BBw
		dd 14h dup(?)
dword_4063C0	dd ?			; DATA XREF: .text:00403493r
					; .text:00403524r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_403420+7o
					; sub_403420:loc_403475o ...
dword_4063DC	dd ?			; DATA XREF: sub_403420+14r
					; .text:004034E8r ...
		dd ?
dword_4063E4	dd ?			; DATA XREF: sub_401180+1A8w
dword_4063E8	dd ?			; DATA XREF: sub_401180+1BFw
dword_4063EC	dd ?			; DATA XREF: sub_401180+1B2w
dword_4063F0	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_4024F3w ...
dword_4063F4	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_4063F8	dd ?			; DATA XREF: TlsCallback_0:loc_402444w
dword_4063FC	dd ?			; DATA XREF: sub_401060+64w
					; sub_4025C0+3Fr ...
dword_406400	dd ?			; DATA XREF: sub_401060+69w
					; sub_4025C0+4r ...
dword_406404	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_406408	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 1000h
_bss		ends

;
; Imports from KERNEL32.dll
;
; Section 5. (virtual address 00007000)
; Virtual size			: 000007D8 (   2008.)
; Section size in file		: 00000800 (   2048.)
; Offset to raw	data for section: 00003600
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_401677+42Bp
					; sub_401677+44Cp ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_401677+337p
					; DATA XREF: sub_401677+332r
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	sub_401677+3E4p
					; DATA XREF: sub_401677+3DFr
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_4035C0+44p
					; DATA XREF: sub_4035C0+44r
; BOOL __stdcall DeleteFileA(LPCSTR lpFileName)
		extrn DeleteFileA:dword	; CODE XREF: sub_40223C+121p
					; DATA XREF: sub_40223C+11Cr
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_403420+Ep
					; .text:004034E2p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: sub_401677+4D1p
					; TlsCallback_0+10Ap
					; DATA XREF: ...
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_401677+33p
					; .text:004033F8p
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_4032C0+6Cp
					; DATA XREF: sub_4032C0+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_4032C0+74p
					; DATA XREF: sub_4032C0+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_40223C+12Fp
					; sub_402960+1CCp ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_403150+87p
					; DATA XREF: ...
; DWORD	__stdcall GetPriorityClass(HANDLE hProcess)
		extrn GetPriorityClass:dword ; CODE XREF: sub_401677+3Dp
					; DATA XREF: sub_401677+38r
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: sub_401677+147p
					; sub_401677+15Bp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_4032C0+57p
					; DATA XREF: sub_4032C0+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_4032C0+7Cp
					; DATA XREF: sub_4032C0+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_4035C0+87p
					; DATA XREF: sub_4035C0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_403420+5Cp
					; .text:00403500p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_401677+492p
					; TlsCallback_0+55p
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_403150+A7p
					; DATA XREF: sub_403150+A7r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_4032C0+8Bp
					; DATA XREF: sub_4032C0+8Br
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword ; CODE	XREF: sub_401677+528p
					; DATA XREF: sub_401677+523r
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:004033DFp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00403409p
					; DATA XREF: .text:00403409r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_403420+35p
					; DATA XREF: sub_403420+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:004033EFp
					; DATA XREF: .text:004033EFr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_402960+142p
					; sub_402960+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_402960+A1p
					; sub_402960+D9p ...

;
; Imports from msvcrt.dll
;
		extrn __imp__close:dword ; DATA	XREF: _closer
		extrn __imp__open:dword	; DATA XREF: _openr
		extrn __imp__read:dword	; DATA XREF: _readr
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_402590r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_401677+355p
					; sub_401677+3FDp ...
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_401677+86r
					; sub_401677+17Cr ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_4025C0+A3p
					; DATA XREF: sub_4025C0+A3r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
; int __cdecl _vsnprintf(char *DstBuf, size_t MaxCount,	const char *Format, va_list ArgList)
		extrn __imp__vsnprintf:dword ; DATA XREF: _vsnprintfr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: sub_401BD0+E5p
					; sub_401BD0+166p ...
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr


; Section 6. (virtual address 00008000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00003E00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 408000h
dword_408000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_408008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_40800C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_402590
dword_408018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_408030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_402533o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00009000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00004000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 409000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
